<div id="Robinson_Arithmetic">
<div class="head">
<h1>Theory Robinson_Arithmetic</h1>
</div>
<pre class="source"><span class="comment1">(*&lt;*)</span>
<span class="keyword1"><span class="command">theory</span></span> Robinson_Arithmetic
<span class="keyword2"><span class="keyword">imports</span></span> <a href="../Nominal2/Nominal2.html">Nominal2.Nominal2</a>
<span class="keyword2"><span class="keyword">begin</span></span>
<span class="comment1">(*&gt;*)</span>

<span class="keyword1"><span class="command">section</span></span> <span class="quoted"><span class="plain_text">‹Terms and Formulas›</span></span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹nat is a pure permutation type›</span></span>

<span class="keyword1"><span class="command">instance</span></span> nat <span class="main">::</span> <span class="quoted">pure</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">standard</span>

<span class="keyword1"><span class="command">atom_decl</span></span> name

<span class="keyword1"><span class="command">declare</span></span> fresh_set_empty <span class="main">[</span><span class="operator">simp</span><span class="main">]</span>

<span class="keyword1"><span class="command">lemma</span></span> supp_name <span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> <span class="keyword2"><span class="keyword">fixes</span></span> <span class="free">i</span><span class="main">::</span><span class="quoted">name</span> <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"supp <span class="free">i</span> <span class="main">=</span> <span class="main">{</span>atom <span class="free">i</span><span class="main">}</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> supp_at_base<span class="main">)</span>

<span class="keyword1"><span class="command">subsection</span></span> <span class="quoted"><span class="plain_text">‹The datatypes›</span></span>

<span class="keyword1"><span class="command">nominal_datatype</span></span> trm <span class="main">=</span> zer <span class="main">|</span> Var <span class="quoted">name</span> <span class="main">|</span> suc <span class="quoted">trm</span> <span class="main">|</span> pls <span class="quoted">trm</span> <span class="quoted">trm</span> <span class="main">|</span> tms <span class="quoted">trm</span> <span class="quoted">trm</span>

<span class="keyword1"><span class="command">nominal_datatype</span></span> fmla <span class="main">=</span>
    eql <span class="quoted">trm</span> <span class="quoted">trm</span>     <span class="main">(</span><span class="keyword2"><span class="keyword">infixr</span></span> <span class="quoted">"<span class="keyword1"><span class="keyword1">EQ</span></span>"</span> 150<span class="main">)</span>
  <span class="main">|</span> dsj <span class="quoted">fmla</span> <span class="quoted">fmla</span>   <span class="main">(</span><span class="keyword2"><span class="keyword">infixr</span></span> <span class="quoted">"<span class="keyword1"><span class="keyword1">OR</span></span>"</span> 130<span class="main">)</span>
  <span class="main">|</span> neg <span class="quoted">fmla</span>
  <span class="main">|</span> exi x<span class="main">::</span><span class="quoted">name</span> f<span class="main">::</span><span class="quoted">fmla</span> <span class="keyword2"><span class="keyword">binds</span></span> <span class="quoted"><span class="free">x</span></span> <span class="keyword2"><span class="keyword">in</span></span> f

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹eql are atomic formulas; dsj, neg, exi are non-atomic›</span></span>

<span class="keyword1"><span class="command">declare</span></span> trm.supp <span class="main">[</span><span class="operator">simp</span><span class="main">]</span> fmla.supp <span class="main">[</span><span class="operator">simp</span><span class="main">]</span>

<span class="keyword1"><span class="command">subsection</span></span> <span class="quoted"><span class="plain_text">‹Substitution›</span></span>

<span class="keyword1"><span class="command">nominal_function</span></span> <span class="entity">subst</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"name <span class="main">⇒</span> trm <span class="main">⇒</span> trm <span class="main">⇒</span> trm"</span></span>
  <span class="keyword2"><span class="keyword">where</span></span>
   <span class="quoted"><span class="quoted">"<span class="free">subst</span> <span class="free"><span class="bound"><span class="entity">i</span></span></span> <span class="free"><span class="bound"><span class="entity">x</span></span></span> zer       <span class="main">=</span> zer"</span></span>
 <span class="main">|</span> <span class="quoted"><span class="quoted">"<span class="free">subst</span> <span class="free"><span class="bound"><span class="entity">i</span></span></span> <span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="main">(</span>Var <span class="free"><span class="bound"><span class="entity">k</span></span></span><span class="main">)</span>    <span class="main">=</span> <span class="main">(</span><span class="keyword1">if</span> <span class="free"><span class="bound"><span class="entity">i</span></span></span><span class="main">=</span><span class="free"><span class="bound"><span class="entity">k</span></span></span> <span class="keyword1">then</span> <span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="keyword1">else</span> Var <span class="free"><span class="bound"><span class="entity">k</span></span></span><span class="main">)</span>"</span></span>
 <span class="main">|</span> <span class="quoted"><span class="quoted">"<span class="free">subst</span> <span class="free"><span class="bound"><span class="entity">i</span></span></span> <span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="main">(</span>suc <span class="free"><span class="bound"><span class="entity">t</span></span></span><span class="main">)</span> <span class="main">=</span> suc <span class="main">(</span><span class="free">subst</span> <span class="free"><span class="bound"><span class="entity">i</span></span></span> <span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="free"><span class="bound"><span class="entity">t</span></span></span><span class="main">)</span>"</span></span>
 <span class="main">|</span> <span class="quoted"><span class="quoted">"<span class="free">subst</span> <span class="free"><span class="bound"><span class="entity">i</span></span></span> <span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="main">(</span>pls <span class="free"><span class="bound"><span class="entity">t</span></span></span> <span class="free"><span class="bound"><span class="entity">u</span></span></span><span class="main">)</span> <span class="main">=</span> pls <span class="main">(</span><span class="free">subst</span> <span class="free"><span class="bound"><span class="entity">i</span></span></span> <span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="free"><span class="bound"><span class="entity">t</span></span></span><span class="main">)</span> <span class="main">(</span><span class="free">subst</span> <span class="free"><span class="bound"><span class="entity">i</span></span></span> <span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="free"><span class="bound"><span class="entity">u</span></span></span><span class="main">)</span>"</span></span>
 <span class="main">|</span> <span class="quoted"><span class="quoted">"<span class="free">subst</span> <span class="free"><span class="bound"><span class="entity">i</span></span></span> <span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="main">(</span>tms <span class="free"><span class="bound"><span class="entity">t</span></span></span> <span class="free"><span class="bound"><span class="entity">u</span></span></span><span class="main">)</span> <span class="main">=</span> tms <span class="main">(</span><span class="free">subst</span> <span class="free"><span class="bound"><span class="entity">i</span></span></span> <span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="free"><span class="bound"><span class="entity">t</span></span></span><span class="main">)</span> <span class="main">(</span><span class="free">subst</span> <span class="free"><span class="bound"><span class="entity">i</span></span></span> <span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="free"><span class="bound"><span class="entity">u</span></span></span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> eqvt_def subst_graph_aux_def<span class="main">)</span> <span class="main">(</span><span class="operator">metis</span> trm.strong_exhaust<span class="main">)</span>

<span class="keyword1"><span class="command">nominal_termination</span></span> <span class="main">(</span>eqvt<span class="main">)</span>
  <span class="keyword1"><span class="command">by</span></span> <span class="operator">lexicographic_order</span>

<span class="keyword1"><span class="command">lemma</span></span> fresh_subst_if <span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span>
  <span class="quoted"><span class="quoted">"<span class="free">j</span> <span class="main">♯</span> subst <span class="free">i</span> <span class="free">x</span> <span class="free">t</span> <span class="main">⟷</span> <span class="main">(</span>atom <span class="free">i</span> <span class="main">♯</span> <span class="free">t</span> <span class="main">∧</span> <span class="free">j</span> <span class="main">♯</span> <span class="free">t</span><span class="main">)</span> <span class="main">∨</span> <span class="main">(</span><span class="free">j</span> <span class="main">♯</span> <span class="free">x</span> <span class="main">∧</span> <span class="main">(</span><span class="free">j</span> <span class="main">♯</span> <span class="free">t</span> <span class="main">∨</span> <span class="free">j</span> <span class="main">=</span> atom <span class="free">i</span><span class="main">)</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">induct</span> <span class="quoted"><span class="free">t</span></span> <span class="quasi_keyword">rule</span><span class="main"><span class="main">:</span></span> trm.induct<span class="main">)</span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> fresh_at_base<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> forget_subst_trm <span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"atom <span class="free">a</span> <span class="main">♯</span> <span class="free">trm</span> <span class="main">⟹</span> subst <span class="free">a</span> <span class="free">x</span> <span class="free">trm</span> <span class="main">=</span> <span class="free">trm</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">induct</span> <span class="quoted"><span class="free">trm</span></span> <span class="quasi_keyword">rule</span><span class="main"><span class="main">:</span></span> trm.induct<span class="main">)</span> <span class="main">(</span><span class="operator">simp_all</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> fresh_at_base<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> subst_trm_id <span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"subst <span class="free">a</span> <span class="main">(</span>Var <span class="free">a</span><span class="main">)</span> <span class="free">trm</span> <span class="main">=</span> <span class="free">trm</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">induct</span> <span class="quoted"><span class="free">trm</span></span> <span class="quasi_keyword">rule</span><span class="main"><span class="main">:</span></span> trm.induct<span class="main">)</span> <span class="operator">simp_all</span>

<span class="keyword1"><span class="command">lemma</span></span> subst_trm_commute <span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span>
  <span class="quoted"><span class="quoted">"atom <span class="free">j</span> <span class="main">♯</span> <span class="free">trm</span> <span class="main">⟹</span> subst <span class="free">j</span> <span class="free">u</span> <span class="main">(</span>subst <span class="free">i</span> <span class="free">t</span> <span class="free">trm</span><span class="main">)</span> <span class="main">=</span> subst <span class="free">i</span> <span class="main">(</span>subst <span class="free">j</span> <span class="free">u</span> <span class="free">t</span><span class="main">)</span> <span class="free">trm</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">induct</span> <span class="quoted"><span class="free">trm</span></span> <span class="quasi_keyword">rule</span><span class="main"><span class="main">:</span></span> trm.induct<span class="main">)</span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> fresh_Pair<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> subst_trm_commute2 <span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span>
  <span class="quoted"><span class="quoted">"atom <span class="free">j</span> <span class="main">♯</span> <span class="free">t</span> <span class="main">⟹</span> atom <span class="free">i</span> <span class="main">♯</span> <span class="free">u</span> <span class="main">⟹</span> <span class="free">i</span> <span class="main">≠</span> <span class="free">j</span> <span class="main">⟹</span> subst <span class="free">j</span> <span class="free">u</span> <span class="main">(</span>subst <span class="free">i</span> <span class="free">t</span> <span class="free">trm</span><span class="main">)</span> <span class="main">=</span> subst <span class="free">i</span> <span class="free">t</span> <span class="main">(</span>subst <span class="free">j</span> <span class="free">u</span> <span class="free">trm</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">induct</span> <span class="quoted"><span class="free">trm</span></span> <span class="quasi_keyword">rule</span><span class="main"><span class="main">:</span></span> trm.induct<span class="main">)</span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">lemma</span></span> repeat_subst_trm <span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"subst <span class="free">i</span> <span class="free">u</span> <span class="main">(</span>subst <span class="free">i</span> <span class="free">t</span> <span class="free">trm</span><span class="main">)</span> <span class="main">=</span> subst <span class="free">i</span> <span class="main">(</span>subst <span class="free">i</span> <span class="free">u</span> <span class="free">t</span><span class="main">)</span> <span class="free">trm</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">induct</span> <span class="quoted"><span class="free">trm</span></span> <span class="quasi_keyword">rule</span><span class="main"><span class="main">:</span></span> trm.induct<span class="main">)</span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">nominal_function</span></span>  <span class="entity">subst_fmla</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"fmla <span class="main">⇒</span> name <span class="main">⇒</span> trm <span class="main">⇒</span> fmla"</span></span> <span class="main">(</span><span class="quoted">"_<span class="keyword1">'(</span>_<span class="keyword1">::=</span>_<span class="keyword1">')</span>"</span> <span class="main">[</span>1000<span class="main">,</span> 0<span class="main">,</span> 0<span class="main">]</span> 200<span class="main">)</span>
  <span class="keyword2"><span class="keyword">where</span></span>
    eql<span class="main">:</span>   <span class="quoted"><span class="quoted">"<span class="main">(</span>eql <span class="free"><span class="bound"><span class="entity">t</span></span></span> <span class="free"><span class="bound"><span class="entity">u</span></span></span><span class="main">)</span><span class="main"><span class="free">(</span></span><span class="free"><span class="bound"><span class="entity">i</span></span></span><span class="main"><span class="free">::=</span></span><span class="free"><span class="bound"><span class="entity">x</span></span></span><span class="main"><span class="free">)</span></span>   <span class="main">=</span> eql  <span class="main">(</span>subst <span class="free"><span class="bound"><span class="entity">i</span></span></span> <span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="free"><span class="bound"><span class="entity">t</span></span></span><span class="main">)</span> <span class="main">(</span>subst <span class="free"><span class="bound"><span class="entity">i</span></span></span> <span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="free"><span class="bound"><span class="entity">u</span></span></span><span class="main">)</span>"</span></span>
  <span class="main">|</span> dsj<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span>dsj <span class="free"><span class="bound"><span class="entity">A</span></span></span> <span class="free"><span class="bound"><span class="entity">B</span></span></span><span class="main">)</span><span class="main"><span class="free">(</span></span><span class="free"><span class="bound"><span class="entity">i</span></span></span><span class="main"><span class="free">::=</span></span><span class="free"><span class="bound"><span class="entity">x</span></span></span><span class="main"><span class="free">)</span></span> <span class="main">=</span> dsj <span class="main">(</span><span class="free"><span class="bound"><span class="entity">A</span></span></span><span class="main"><span class="free">(</span></span><span class="free"><span class="bound"><span class="entity">i</span></span></span><span class="main"><span class="free">::=</span></span><span class="free"><span class="bound"><span class="entity">x</span></span></span><span class="main"><span class="free">)</span></span><span class="main">)</span> <span class="main">(</span><span class="free"><span class="bound"><span class="entity">B</span></span></span><span class="main"><span class="free">(</span></span><span class="free"><span class="bound"><span class="entity">i</span></span></span><span class="main"><span class="free">::=</span></span><span class="free"><span class="bound"><span class="entity">x</span></span></span><span class="main"><span class="free">)</span></span><span class="main">)</span>"</span></span>
  <span class="main">|</span> neg<span class="main">:</span>  <span class="quoted"><span class="quoted">"<span class="main">(</span>neg <span class="free"><span class="bound"><span class="entity">A</span></span></span><span class="main">)</span><span class="main"><span class="free">(</span></span><span class="free"><span class="bound"><span class="entity">i</span></span></span><span class="main"><span class="free">::=</span></span><span class="free"><span class="bound"><span class="entity">x</span></span></span><span class="main"><span class="free">)</span></span>    <span class="main">=</span> neg  <span class="main">(</span><span class="free"><span class="bound"><span class="entity">A</span></span></span><span class="main"><span class="free">(</span></span><span class="free"><span class="bound"><span class="entity">i</span></span></span><span class="main"><span class="free">::=</span></span><span class="free"><span class="bound"><span class="entity">x</span></span></span><span class="main"><span class="free">)</span></span><span class="main">)</span>"</span></span>
  <span class="main">|</span> exi<span class="main">:</span>   <span class="quoted"><span class="quoted">"atom <span class="free"><span class="bound"><span class="entity">j</span></span></span> <span class="main">♯</span> <span class="main">(</span><span class="free"><span class="bound"><span class="entity">i</span></span></span><span class="main">,</span> <span class="free"><span class="bound"><span class="entity">x</span></span></span><span class="main">)</span> <span class="main">⟹</span> <span class="main">(</span>exi <span class="free"><span class="bound"><span class="entity">j</span></span></span> <span class="free"><span class="bound"><span class="entity">A</span></span></span><span class="main">)</span><span class="main"><span class="free">(</span></span><span class="free"><span class="bound"><span class="entity">i</span></span></span><span class="main"><span class="free">::=</span></span><span class="free"><span class="bound"><span class="entity">x</span></span></span><span class="main"><span class="free">)</span></span> <span class="main">=</span> exi <span class="free"><span class="bound"><span class="entity">j</span></span></span> <span class="main">(</span><span class="free"><span class="bound"><span class="entity">A</span></span></span><span class="main"><span class="free">(</span></span><span class="free"><span class="bound"><span class="entity">i</span></span></span><span class="main"><span class="free">::=</span></span><span class="free"><span class="bound"><span class="entity">x</span></span></span><span class="main"><span class="free">)</span></span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">subgoal</span></span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> eqvt_def subst_fmla_graph_aux_def<span class="main">)</span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">subgoal</span></span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">subgoal</span></span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> fmla.strong_exhaust fresh_star_insert old.prod.exhaust<span class="main">)</span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">subgoal</span></span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">subgoal</span></span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">subgoal</span></span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">subgoal</span></span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">subgoal</span></span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">subgoal</span></span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">subgoal</span></span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">subgoal</span></span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">subgoal</span></span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">subgoal</span></span></span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> eqvt_at_def fresh_star_def fresh_Pair fresh_at_base<span class="main">)</span>
     <span class="main">(</span><span class="operator">metis</span> flip_at_base_simps<span class="main"><span class="main">(</span></span>3<span class="main"><span class="main">)</span></span> flip_fresh_fresh<span class="main">)</span> <span class="keyword1"><span class="command">.</span></span>

<span class="keyword1"><span class="command">nominal_termination</span></span> <span class="main">(</span>eqvt<span class="main">)</span>
  <span class="keyword1"><span class="command">by</span></span> <span class="operator">lexicographic_order</span>

<span class="keyword1"><span class="command">lemma</span></span> size_subst_fmla <span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"size <span class="main">(</span><span class="free">A</span><span class="main">(</span><span class="free">i</span><span class="main">::=</span><span class="free">x</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> size <span class="free">A</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">nominal_induct</span> <span class="quoted"><span class="free">A</span></span> <span class="quasi_keyword">avoiding</span><span class="main"><span class="main">:</span></span> <span class="quoted"><span class="free">i</span></span> <span class="quoted"><span class="free">x</span></span> <span class="quasi_keyword">rule</span><span class="main"><span class="main">:</span></span> fmla.strong_induct<span class="main">)</span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">lemma</span></span> forget_subst_fmla <span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"atom <span class="free">a</span> <span class="main">♯</span> <span class="free">A</span> <span class="main">⟹</span> <span class="free">A</span><span class="main">(</span><span class="free">a</span><span class="main">::=</span><span class="free">x</span><span class="main">)</span> <span class="main">=</span> <span class="free">A</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">nominal_induct</span> <span class="quoted"><span class="free">A</span></span> <span class="quasi_keyword">avoiding</span><span class="main"><span class="main">:</span></span> <span class="quoted"><span class="free">a</span></span> <span class="quoted"><span class="free">x</span></span> <span class="quasi_keyword">rule</span><span class="main"><span class="main">:</span></span> fmla.strong_induct<span class="main">)</span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> fresh_at_base<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> subst_fmla_id <span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">A</span><span class="main">(</span><span class="free">a</span><span class="main">::=</span>Var <span class="free">a</span><span class="main">)</span> <span class="main">=</span> <span class="free">A</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">nominal_induct</span> <span class="quoted"><span class="free">A</span></span> <span class="quasi_keyword">avoiding</span><span class="main"><span class="main">:</span></span> <span class="quoted"><span class="free">a</span></span> <span class="quasi_keyword">rule</span><span class="main"><span class="main">:</span></span> fmla.strong_induct<span class="main">)</span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> fresh_at_base<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> fresh_subst_fmla_if <span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span>
  <span class="quoted"><span class="quoted">"<span class="free">j</span> <span class="main">♯</span> <span class="main">(</span><span class="free">A</span><span class="main">(</span><span class="free">i</span><span class="main">::=</span><span class="free">x</span><span class="main">)</span><span class="main">)</span> <span class="main">⟷</span> <span class="main">(</span>atom <span class="free">i</span> <span class="main">♯</span> <span class="free">A</span> <span class="main">∧</span> <span class="free">j</span> <span class="main">♯</span> <span class="free">A</span><span class="main">)</span> <span class="main">∨</span> <span class="main">(</span><span class="free">j</span> <span class="main">♯</span> <span class="free">x</span> <span class="main">∧</span> <span class="main">(</span><span class="free">j</span> <span class="main">♯</span> <span class="free">A</span> <span class="main">∨</span> <span class="free">j</span> <span class="main">=</span> atom <span class="free">i</span><span class="main">)</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">nominal_induct</span> <span class="quoted"><span class="free">A</span></span> <span class="quasi_keyword">avoiding</span><span class="main"><span class="main">:</span></span> <span class="quoted"><span class="free">i</span></span> <span class="quoted"><span class="free">x</span></span> <span class="quasi_keyword">rule</span><span class="main"><span class="main">:</span></span> fmla.strong_induct<span class="main">)</span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> fresh_at_base<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> subst_fmla_commute <span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span>
  <span class="quoted"><span class="quoted">"atom <span class="free">j</span> <span class="main">♯</span> <span class="free">A</span> <span class="main">⟹</span> <span class="main">(</span><span class="free">A</span><span class="main">(</span><span class="free">i</span><span class="main">::=</span><span class="free">t</span><span class="main">)</span><span class="main">)</span><span class="main">(</span><span class="free">j</span><span class="main">::=</span><span class="free">u</span><span class="main">)</span> <span class="main">=</span> <span class="free">A</span><span class="main">(</span><span class="free">i</span> <span class="main">::=</span> subst <span class="free">j</span> <span class="free">u</span> <span class="free">t</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">nominal_induct</span> <span class="quoted"><span class="free">A</span></span> <span class="quasi_keyword">avoiding</span><span class="main"><span class="main">:</span></span> <span class="quoted"><span class="free">i</span></span> <span class="quoted"><span class="free">j</span></span> <span class="quoted"><span class="free">t</span></span> <span class="quoted"><span class="free">u</span></span> <span class="quasi_keyword">rule</span><span class="main"><span class="main">:</span></span> fmla.strong_induct<span class="main">)</span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> fresh_at_base<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> repeat_subst_fmla <span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">A</span><span class="main">(</span><span class="free">i</span><span class="main">::=</span><span class="free">t</span><span class="main">)</span><span class="main">)</span><span class="main">(</span><span class="free">i</span><span class="main">::=</span><span class="free">u</span><span class="main">)</span> <span class="main">=</span> <span class="free">A</span><span class="main">(</span><span class="free">i</span> <span class="main">::=</span> subst <span class="free">i</span> <span class="free">u</span> <span class="free">t</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">nominal_induct</span> <span class="quoted"><span class="free">A</span></span> <span class="quasi_keyword">avoiding</span><span class="main"><span class="main">:</span></span> <span class="quoted"><span class="free">i</span></span> <span class="quoted"><span class="free">t</span></span> <span class="quoted"><span class="free">u</span></span> <span class="quasi_keyword">rule</span><span class="main"><span class="main">:</span></span> fmla.strong_induct<span class="main">)</span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">lemma</span></span> subst_fmla_exi_with_renaming<span class="main">:</span>
  <span class="quoted"><span class="quoted">"atom <span class="free">i'</span> <span class="main">♯</span> <span class="main">(</span><span class="free">A</span><span class="main">,</span> <span class="free">i</span><span class="main">,</span> <span class="free">j</span><span class="main">,</span> <span class="free">t</span><span class="main">)</span> <span class="main">⟹</span> <span class="main">(</span>exi <span class="free">i</span> <span class="free">A</span><span class="main">)</span><span class="main">(</span><span class="free">j</span> <span class="main">::=</span> <span class="free">t</span><span class="main">)</span> <span class="main">=</span> exi <span class="free">i'</span> <span class="main">(</span><span class="main">(</span><span class="main">(</span><span class="free">i</span> <span class="main">↔</span> <span class="free">i'</span><span class="main">)</span> <span class="main">∙</span> <span class="free">A</span><span class="main">)</span><span class="main">(</span><span class="free">j</span> <span class="main">::=</span> <span class="free">t</span><span class="main">)</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> subst <span class="main"><span class="main">[</span></span><span class="operator">of</span> <span class="quoted"><span class="quoted"><span class="quoted"><span class="quoted">"exi <span class="free"><span class="free"><span class="free">i'</span></span></span> <span class="main"><span class="main"><span class="main">(</span></span></span><span class="main"><span class="main"><span class="main">(</span></span></span><span class="free"><span class="free"><span class="free">i</span></span></span> <span class="main"><span class="main"><span class="main">↔</span></span></span> <span class="free"><span class="free"><span class="free">i'</span></span></span><span class="main"><span class="main"><span class="main">)</span></span></span> <span class="main"><span class="main"><span class="main">∙</span></span></span> <span class="free"><span class="free"><span class="free">A</span></span></span><span class="main"><span class="main"><span class="main">)</span></span></span>"</span></span></span></span> <span class="quoted"><span class="quoted"><span class="quoted"><span class="quoted">"exi <span class="free"><span class="free"><span class="free">i</span></span></span> <span class="free"><span class="free"><span class="free">A</span></span></span>"</span></span></span></span><span class="main"><span class="main">]</span></span><span class="main">)</span>
     <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> Abs1_eq_iff flip_def swap_commute<span class="main">)</span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹the simplifier cannot apply the rule above, because
it introduces a new variable at the right hand side.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> flip_subst_trm<span class="main">:</span> <span class="quoted"><span class="quoted">"atom <span class="free">y</span> <span class="main">♯</span> <span class="free">t</span> <span class="main">⟹</span> <span class="main">(</span><span class="free">x</span> <span class="main">↔</span> <span class="free">y</span><span class="main">)</span> <span class="main">∙</span> <span class="free">t</span> <span class="main">=</span> subst <span class="free">x</span> <span class="main">(</span>Var <span class="free">y</span><span class="main">)</span> <span class="free">t</span>"</span></span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="main">(</span><span class="operator">nominal_induct</span> <span class="quoted"><span class="free">t</span></span> <span class="quasi_keyword">avoiding</span><span class="main"><span class="main">:</span></span> <span class="quoted"><span class="free">x</span></span> <span class="quoted"><span class="free">y</span></span> <span class="quasi_keyword">rule</span><span class="main"><span class="main">:</span></span> trm.strong_induct<span class="main">)</span>
<span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">lemma</span></span> flip_subst_fmla<span class="main">:</span> <span class="quoted"><span class="quoted">"atom <span class="free">y</span> <span class="main">♯</span> <span class="free">φ</span> <span class="main">⟹</span> <span class="main">(</span><span class="free">x</span> <span class="main">↔</span> <span class="free">y</span><span class="main">)</span> <span class="main">∙</span> <span class="free">φ</span> <span class="main">=</span> <span class="free">φ</span><span class="main">(</span><span class="free">x</span><span class="main">::=</span>Var <span class="free">y</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="main">(</span><span class="operator">nominal_induct</span> <span class="quoted"><span class="free">φ</span></span> <span class="quasi_keyword">avoiding</span><span class="main"><span class="main">:</span></span> <span class="quoted"><span class="free">x</span></span> <span class="quoted"><span class="free">y</span></span> <span class="quasi_keyword">rule</span><span class="main"><span class="main">:</span></span> fmla.strong_induct<span class="main">)</span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> flip_subst_trm<span class="main">)</span>
<span class="keyword1"><span class="command">using</span></span> fresh_at_base<span class="main">(</span>2<span class="main">)</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>

<span class="keyword1"><span class="command">lemma</span></span> exi_ren_subst_fresh<span class="main">:</span> <span class="quoted"><span class="quoted">"atom <span class="free">y</span> <span class="main">♯</span> <span class="free">φ</span> <span class="main">⟹</span> exi <span class="free">x</span> <span class="free">φ</span> <span class="main">=</span> exi <span class="free">y</span> <span class="main">(</span><span class="free">φ</span><span class="main">(</span><span class="free">x</span><span class="main">::=</span>Var <span class="free">y</span><span class="main">)</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> flip_subst_fmla <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>


<span class="keyword1"><span class="command">subsection</span></span><span class="quoted"><span class="plain_text">‹Semantics›</span></span>

<span class="keyword1"><span class="command">definition</span></span> <span class="entity">e0</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="main">(</span>name<span class="main">,</span> nat<span class="main">)</span> finfun"</span></span>    <span class="comment1">― ‹the null environment›</span>
  <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="free">e0</span> <span class="main">≡</span> finfun_const <span class="main">0</span>"</span></span>

<span class="keyword1"><span class="command">nominal_function</span></span> <span class="entity">eval_trm</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="main">(</span>name<span class="main">,</span> nat<span class="main">)</span> finfun <span class="main">⇒</span> trm <span class="main">⇒</span> nat"</span></span>
  <span class="keyword2"><span class="keyword">where</span></span>
   <span class="quoted"><span class="quoted">"<span class="free">eval_trm</span> <span class="free"><span class="bound"><span class="entity">e</span></span></span> zer <span class="main">=</span> <span class="main">0</span>"</span></span>
 <span class="main">|</span> <span class="quoted"><span class="quoted">"<span class="free">eval_trm</span> <span class="free"><span class="bound"><span class="entity">e</span></span></span> <span class="main">(</span>Var <span class="free"><span class="bound"><span class="entity">k</span></span></span><span class="main">)</span> <span class="main">=</span> finfun_apply <span class="free"><span class="bound"><span class="entity">e</span></span></span> <span class="free"><span class="bound"><span class="entity">k</span></span></span>"</span></span>
 <span class="main">|</span> <span class="quoted"><span class="quoted">"<span class="free">eval_trm</span> <span class="free"><span class="bound"><span class="entity">e</span></span></span> <span class="main">(</span>suc <span class="free"><span class="bound"><span class="entity">t</span></span></span><span class="main">)</span> <span class="main">=</span> Suc <span class="main">(</span><span class="free">eval_trm</span> <span class="free"><span class="bound"><span class="entity">e</span></span></span> <span class="free"><span class="bound"><span class="entity">t</span></span></span><span class="main">)</span>"</span></span>
 <span class="main">|</span> <span class="quoted"><span class="quoted">"<span class="free">eval_trm</span> <span class="free"><span class="bound"><span class="entity">e</span></span></span> <span class="main">(</span>pls <span class="free"><span class="bound"><span class="entity">t</span></span></span> <span class="free"><span class="bound"><span class="entity">u</span></span></span><span class="main">)</span> <span class="main">=</span> <span class="free">eval_trm</span> <span class="free"><span class="bound"><span class="entity">e</span></span></span> <span class="free"><span class="bound"><span class="entity">t</span></span></span> <span class="main">+</span> <span class="free">eval_trm</span> <span class="free"><span class="bound"><span class="entity">e</span></span></span> <span class="free"><span class="bound"><span class="entity">u</span></span></span>"</span></span>
 <span class="main">|</span> <span class="quoted"><span class="quoted">"<span class="free">eval_trm</span> <span class="free"><span class="bound"><span class="entity">e</span></span></span> <span class="main">(</span>tms <span class="free"><span class="bound"><span class="entity">t</span></span></span> <span class="free"><span class="bound"><span class="entity">u</span></span></span><span class="main">)</span> <span class="main">=</span> <span class="free">eval_trm</span> <span class="free"><span class="bound"><span class="entity">e</span></span></span> <span class="free"><span class="bound"><span class="entity">t</span></span></span> <span class="main">*</span> <span class="free">eval_trm</span> <span class="free"><span class="bound"><span class="entity">e</span></span></span> <span class="free"><span class="bound"><span class="entity">u</span></span></span>"</span></span>
<span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> eqvt_def eval_trm_graph_aux_def<span class="main">)</span> <span class="main">(</span><span class="operator">metis</span> trm.strong_exhaust<span class="main">)</span>

<span class="keyword1"><span class="command">nominal_termination</span></span> <span class="main">(</span>eqvt<span class="main">)</span>
  <span class="keyword1"><span class="command">by</span></span> <span class="operator">lexicographic_order</span>

<span class="keyword1"><span class="command">nominal_function</span></span> <span class="entity">eval_fmla</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="main">(</span>name<span class="main">,</span> nat<span class="main">)</span> finfun <span class="main">⇒</span> fmla <span class="main">⇒</span> bool"</span></span>
  <span class="keyword2"><span class="keyword">where</span></span>
   <span class="quoted"><span class="quoted">"<span class="free">eval_fmla</span> <span class="free"><span class="bound"><span class="entity">e</span></span></span> <span class="main">(</span><span class="free"><span class="bound"><span class="entity">t</span></span></span> <span class="keyword1">EQ</span> <span class="free"><span class="bound"><span class="entity">u</span></span></span><span class="main">)</span> <span class="main">⟷</span> eval_trm <span class="free"><span class="bound"><span class="entity">e</span></span></span> <span class="free"><span class="bound"><span class="entity">t</span></span></span> <span class="main">=</span> eval_trm <span class="free"><span class="bound"><span class="entity">e</span></span></span> <span class="free"><span class="bound"><span class="entity">u</span></span></span>"</span></span>
 <span class="main">|</span> <span class="quoted"><span class="quoted">"<span class="free">eval_fmla</span> <span class="free"><span class="bound"><span class="entity">e</span></span></span> <span class="main">(</span><span class="free"><span class="bound"><span class="entity">A</span></span></span> <span class="keyword1">OR</span> <span class="free"><span class="bound"><span class="entity">B</span></span></span><span class="main">)</span> <span class="main">⟷</span> <span class="free">eval_fmla</span> <span class="free"><span class="bound"><span class="entity">e</span></span></span> <span class="free"><span class="bound"><span class="entity">A</span></span></span> <span class="main">∨</span> <span class="free">eval_fmla</span> <span class="free"><span class="bound"><span class="entity">e</span></span></span> <span class="free"><span class="bound"><span class="entity">B</span></span></span>"</span></span>
 <span class="main">|</span> <span class="quoted"><span class="quoted">"<span class="free">eval_fmla</span> <span class="free"><span class="bound"><span class="entity">e</span></span></span> <span class="main">(</span>neg <span class="free"><span class="bound"><span class="entity">A</span></span></span><span class="main">)</span> <span class="main">⟷</span> <span class="main">(</span><span class="main">~</span> <span class="free">eval_fmla</span> <span class="free"><span class="bound"><span class="entity">e</span></span></span> <span class="free"><span class="bound"><span class="entity">A</span></span></span><span class="main">)</span>"</span></span>
 <span class="main">|</span> <span class="quoted"><span class="quoted">"atom <span class="free"><span class="bound"><span class="entity">k</span></span></span> <span class="main">♯</span> <span class="free"><span class="bound"><span class="entity">e</span></span></span> <span class="main">⟹</span> <span class="free">eval_fmla</span> <span class="free"><span class="bound"><span class="entity">e</span></span></span> <span class="main">(</span>exi <span class="free"><span class="bound"><span class="entity">k</span></span></span> <span class="free"><span class="bound"><span class="entity">A</span></span></span><span class="main">)</span> <span class="main">⟷</span> <span class="main">(</span><span class="main">∃</span><span class="bound">x</span><span class="main">.</span> <span class="free">eval_fmla</span> <span class="main">(</span>finfun_update <span class="free"><span class="bound"><span class="entity">e</span></span></span> <span class="free"><span class="bound"><span class="entity">k</span></span></span> <span class="bound">x</span><span class="main">)</span> <span class="free"><span class="bound"><span class="entity">A</span></span></span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">supply</span></span></span></span> <span class="main">[</span><span class="main">[</span><span class="operator">simproc</span> <span class="quasi_keyword">del</span><span class="main"><span class="main">:</span></span> defined_all<span class="main">]</span><span class="main">]</span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> eqvt_def eval_fmla_graph_aux_def<span class="main">)</span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">del</span><span class="main"><span class="main">:</span></span> iffI<span class="main">)</span> <span class="main"><span class="keyword3">[</span></span>11<span class="main"><span class="keyword3">]</span></span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="main">(</span><span class="operator">rule_tac</span> y<span class="main"><span class="main">=</span></span><span class="quoted"><span class="improper">b</span></span> <span class="keyword2"><span class="keyword"><span class="quasi_keyword">and</span></span></span> c<span class="main"><span class="main">=</span></span><span class="quoted"><span class="quoted">"<span class="main">(</span><span class="improper">a</span><span class="main">)</span>"</span></span> <span class="keyword2"><span class="keyword"><span class="quasi_keyword">in</span></span></span> fmla.strong_exhaust<span class="main">)</span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> fresh_star_def<span class="main">)</span><span class="main"><span class="keyword3">[</span></span>4<span class="main"><span class="keyword3">]</span></span>
<span class="keyword1"><span class="command">using</span></span> <span class="main">[</span><span class="main">[</span><span class="operator">simproc</span> <span class="quasi_keyword">del</span><span class="main"><span class="main">:</span></span> alpha_lst<span class="main">]</span><span class="main">]</span> <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="operator">clarsimp</span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="main">(</span><span class="operator">erule_tac</span> c<span class="main"><span class="main">=</span></span><span class="quoted"><span class="quoted">"<span class="main">(</span><span class="improper">ea</span><span class="main">)</span>"</span></span> <span class="keyword2"><span class="keyword"><span class="quasi_keyword">in</span></span></span> Abs_lst1_fcb2'<span class="main">)</span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="main">(</span><span class="operator">rule</span> pure_fresh<span class="main">)</span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> fresh_star_def<span class="main">)</span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">simp_all</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> eqvt_at_def<span class="main">)</span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">simp_all</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> perm_supp_eq<span class="main">)</span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">done</span></span></span></span>

<span class="keyword1"><span class="command">nominal_termination</span></span> <span class="main">(</span>eqvt<span class="main">)</span>
  <span class="keyword1"><span class="command">by</span></span> <span class="operator">lexicographic_order</span>

<span class="keyword1"><span class="command">lemma</span></span> eval_trm_rename<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"atom <span class="free">k'</span> <span class="main">♯</span> <span class="free">t</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"eval_trm <span class="main">(</span>finfun_update <span class="free">e</span> <span class="free">k</span> <span class="free">x</span><span class="main">)</span> <span class="free">t</span> <span class="main">=</span>
         eval_trm <span class="main">(</span>finfun_update <span class="free">e</span> <span class="free">k'</span> <span class="free">x</span><span class="main">)</span> <span class="main">(</span><span class="main">(</span><span class="free">k'</span> <span class="main">↔</span> <span class="free">k</span><span class="main">)</span> <span class="main">∙</span> <span class="free">t</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">using</span></span> assms
<span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">induct</span> <span class="quoted"><span class="free">t</span></span> <span class="quasi_keyword">rule</span><span class="main"><span class="main">:</span></span> trm.induct<span class="main">)</span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> permute_flip_at<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> eval_fmla_rename<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"atom <span class="free">k'</span> <span class="main">♯</span> <span class="free">A</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"eval_fmla <span class="main">(</span>finfun_update <span class="free">e</span> <span class="free">k</span> <span class="free">x</span><span class="main">)</span> <span class="free">A</span> <span class="main">=</span> eval_fmla <span class="main">(</span>finfun_update <span class="free">e</span> <span class="free">k'</span> <span class="free">x</span><span class="main">)</span> <span class="main">(</span><span class="main">(</span><span class="free">k'</span> <span class="main">↔</span> <span class="free">k</span><span class="main">)</span> <span class="main">∙</span> <span class="free">A</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">using</span></span> assms
<span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">nominal_induct</span> <span class="quoted"><span class="free">A</span></span> <span class="quasi_keyword">avoiding</span><span class="main"><span class="main">:</span></span> <span class="quoted"><span class="free">e</span></span> <span class="quoted"><span class="free">k</span></span> <span class="quoted"><span class="free">k'</span></span> <span class="quoted"><span class="free">x</span></span> <span class="quasi_keyword">rule</span><span class="main"><span class="main">:</span></span> fmla.strong_induct<span class="main">)</span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">simp_all</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> eval_trm_rename<span class="main"><span class="main">[</span></span><span class="operator">symmetric</span><span class="main"><span class="main">]</span></span><span class="main"><span class="keyword3">,</span></span> <span class="operator">metis</span><span class="main">)</span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> fresh_finfun_update fresh_at_base finfun_update_twist<span class="main">)</span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">done</span></span></span></span>

<span class="keyword1"><span class="command">lemma</span></span> better_ex_eval_fmla<span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span>
  <span class="quoted"><span class="quoted">"eval_fmla <span class="free">e</span> <span class="main">(</span>exi <span class="free">k</span> <span class="free">A</span><span class="main">)</span> <span class="main">⟷</span> <span class="main">(</span><span class="main">∃</span><span class="bound">x</span><span class="main">.</span> eval_fmla <span class="main">(</span>finfun_update <span class="free">e</span> <span class="free">k</span> <span class="bound">x</span><span class="main">)</span> <span class="free">A</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">k'</span></span><span class="main">::</span><span class="quoted">name</span> <span class="keyword2"><span class="keyword">where</span></span> k'<span class="main">:</span> <span class="quoted"><span class="quoted">"atom <span class="skolem">k'</span> <span class="main">♯</span> <span class="main">(</span><span class="free">k</span><span class="main">,</span> <span class="free">e</span><span class="main">,</span> <span class="free">A</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> obtain_fresh<span class="main">)</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> eq<span class="main">:</span> <span class="quoted"><span class="quoted">"exi <span class="skolem">k'</span> <span class="main">(</span><span class="main">(</span><span class="skolem">k'</span> <span class="main">↔</span> <span class="free">k</span><span class="main">)</span> <span class="main">∙</span> <span class="free">A</span><span class="main">)</span> <span class="main">=</span> exi <span class="free">k</span> <span class="free">A</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> Abs1_eq_iff flip_def<span class="main">)</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"eval_fmla <span class="free">e</span> <span class="main">(</span>exi <span class="skolem">k'</span> <span class="main">(</span><span class="main">(</span><span class="skolem">k'</span> <span class="main">↔</span> <span class="free">k</span><span class="main">)</span> <span class="main">∙</span> <span class="free">A</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="main">∃</span><span class="bound">x</span><span class="main">.</span> eval_fmla <span class="main">(</span>finfun_update <span class="free">e</span> <span class="skolem">k'</span> <span class="bound">x</span><span class="main">)</span> <span class="main">(</span><span class="main">(</span><span class="skolem">k'</span> <span class="main">↔</span> <span class="free">k</span><span class="main">)</span> <span class="main">∙</span> <span class="free">A</span><span class="main">)</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> k' <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> <span class="main">(</span><span class="main">∃</span><span class="bound">x</span><span class="main">.</span> eval_fmla <span class="main">(</span>finfun_update <span class="free">e</span> <span class="free">k</span> <span class="bound">x</span><span class="main">)</span> <span class="free">A</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> eval_fmla_rename k' fresh_Pair<span class="main">)</span>
  <span class="keyword1"><span class="command">finally</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> eq<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">lemma</span></span> forget_eval_trm <span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"atom <span class="free">i</span> <span class="main">♯</span> <span class="free">t</span> <span class="main">⟹</span>
    eval_trm <span class="main">(</span>finfun_update <span class="free">e</span> <span class="free">i</span> <span class="free">x</span><span class="main">)</span> <span class="free">t</span> <span class="main">=</span> eval_trm <span class="free">e</span> <span class="free">t</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">induct</span> <span class="quoted"><span class="free">t</span></span> <span class="quasi_keyword">rule</span><span class="main"><span class="main">:</span></span> trm.induct<span class="main">)</span> <span class="main">(</span><span class="operator">simp_all</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> fresh_at_base<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> forget_eval_fmla <span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span>
   <span class="quoted"><span class="quoted">"atom <span class="free">k</span> <span class="main">♯</span> <span class="free">A</span> <span class="main">⟹</span> eval_fmla <span class="main">(</span>finfun_update <span class="free">e</span> <span class="free">k</span> <span class="free">x</span><span class="main">)</span> <span class="free">A</span> <span class="main">=</span> eval_fmla <span class="free">e</span> <span class="free">A</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">nominal_induct</span> <span class="quoted"><span class="free">A</span></span> <span class="quasi_keyword">avoiding</span><span class="main"><span class="main">:</span></span> <span class="quoted"><span class="free">k</span></span> <span class="quoted"><span class="free">e</span></span> <span class="quasi_keyword">rule</span><span class="main"><span class="main">:</span></span> fmla.strong_induct<span class="main">)</span>
     <span class="main">(</span><span class="operator">simp_all</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> fresh_at_base finfun_update_twist<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> eval_subst_trm<span class="main">:</span> <span class="quoted"><span class="quoted">"eval_trm <span class="free">e</span> <span class="main">(</span>subst <span class="free">i</span> <span class="free">t</span> <span class="free">u</span><span class="main">)</span> <span class="main">=</span>
   eval_trm <span class="main">(</span>finfun_update <span class="free">e</span> <span class="free">i</span> <span class="main">(</span>eval_trm <span class="free">e</span> <span class="free">t</span><span class="main">)</span><span class="main">)</span> <span class="free">u</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">induct</span> <span class="quoted"><span class="free">u</span></span> <span class="quasi_keyword">rule</span><span class="main"><span class="main">:</span></span> trm.induct<span class="main">)</span> <span class="main">(</span><span class="operator">auto</span><span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> eval_subst_fmla<span class="main">:</span> <span class="quoted"><span class="quoted">"eval_fmla <span class="free">e</span> <span class="main">(</span><span class="free">fmla</span><span class="main">(</span><span class="free">i</span><span class="main">::=</span> <span class="free">t</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span>
   eval_fmla <span class="main">(</span>finfun_update <span class="free">e</span> <span class="free">i</span> <span class="main">(</span>eval_trm <span class="free">e</span> <span class="free">t</span><span class="main">)</span><span class="main">)</span> <span class="free">fmla</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">nominal_induct</span> <span class="quoted"><span class="free">fmla</span></span> <span class="quasi_keyword">avoiding</span><span class="main"><span class="main">:</span></span> <span class="quoted"><span class="free">i</span></span> <span class="quoted"><span class="free">t</span></span> <span class="quoted"><span class="free">e</span></span> <span class="quasi_keyword">rule</span><span class="main"><span class="main">:</span></span> fmla.strong_induct<span class="main">)</span>
     <span class="main">(</span><span class="operator">simp_all</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> eval_subst_trm finfun_update_twist fresh_at_base<span class="main">)</span>

<span class="keyword1"><span class="command">subsection</span></span> <span class="quoted"><span class="plain_text">‹Derived logical connectives›</span></span>

<span class="keyword1"><span class="command">abbreviation</span></span> <span class="entity">imp</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"fmla <span class="main">⇒</span> fmla <span class="main">⇒</span> fmla"</span></span>   <span class="main">(</span><span class="keyword2"><span class="keyword">infixr</span></span> <span class="quoted">"<span class="keyword1">IMP</span>"</span> 125<span class="main">)</span>
  <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="free">imp</span> <span class="free"><span class="bound"><span class="entity">A</span></span></span> <span class="free"><span class="bound"><span class="entity">B</span></span></span> <span class="main">≡</span> dsj <span class="main">(</span>neg <span class="free"><span class="bound"><span class="entity">A</span></span></span><span class="main">)</span> <span class="free"><span class="bound"><span class="entity">B</span></span></span>"</span></span>

<span class="keyword1"><span class="command">abbreviation</span></span> <span class="entity">all</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"name <span class="main">⇒</span> fmla <span class="main">⇒</span> fmla"</span></span>
  <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="free">all</span> <span class="free"><span class="bound"><span class="entity">i</span></span></span> <span class="free"><span class="bound"><span class="entity">A</span></span></span> <span class="main">≡</span> neg <span class="main">(</span>exi <span class="free"><span class="bound"><span class="entity">i</span></span></span> <span class="main">(</span>neg <span class="free"><span class="bound"><span class="entity">A</span></span></span><span class="main">)</span><span class="main">)</span>"</span></span>

<span class="keyword1"><span class="command">subsubsection</span></span> <span class="quoted"><span class="plain_text">‹Conjunction›</span></span>

<span class="keyword1"><span class="command">definition</span></span> <span class="entity">cnj</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"fmla <span class="main">⇒</span> fmla <span class="main">⇒</span> fmla"</span></span>   <span class="main">(</span><span class="keyword2"><span class="keyword">infixr</span></span> <span class="quoted">"<span class="keyword1">AND</span>"</span> 135<span class="main">)</span>
  <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="free">cnj</span> <span class="free"><span class="bound"><span class="entity">A</span></span></span> <span class="free"><span class="bound"><span class="entity">B</span></span></span> <span class="main">≡</span> neg <span class="main">(</span>dsj <span class="main">(</span>neg <span class="free"><span class="bound"><span class="entity">A</span></span></span><span class="main">)</span> <span class="main">(</span>neg <span class="free"><span class="bound"><span class="entity">B</span></span></span><span class="main">)</span><span class="main">)</span>"</span></span>

<span class="keyword1"><span class="command">lemma</span></span> cnj_eqvt <span class="main">[</span><span class="operator">eqvt</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">p</span> <span class="main">∙</span> <span class="main">(</span><span class="free">A</span> <span class="keyword1">AND</span> <span class="free">B</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="free">p</span> <span class="main">∙</span> <span class="free">A</span><span class="main">)</span> <span class="keyword1">AND</span> <span class="main">(</span><span class="free">p</span> <span class="main">∙</span> <span class="free">B</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> cnj_def<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> fresh_cnj <span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">a</span> <span class="main">♯</span> <span class="free">A</span> <span class="keyword1">AND</span> <span class="free">B</span> <span class="main">⟷</span> <span class="main">(</span><span class="free">a</span> <span class="main">♯</span> <span class="free">A</span> <span class="main">∧</span> <span class="free">a</span> <span class="main">♯</span> <span class="free">B</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> cnj_def<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> supp_cnj <span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"supp <span class="main">(</span><span class="free">A</span> <span class="keyword1">AND</span> <span class="free">B</span><span class="main">)</span> <span class="main">=</span> supp <span class="free">A</span> <span class="main">∪</span> supp <span class="free">B</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> cnj_def<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> size_cnj <span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"size <span class="main">(</span><span class="free">A</span> <span class="keyword1">AND</span> <span class="free">B</span><span class="main">)</span> <span class="main">=</span> size <span class="free">A</span> <span class="main">+</span> size <span class="free">B</span> <span class="main">+</span> <span class="numeral">4</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> cnj_def<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> cnj_injective_iff <span class="main">[</span><span class="operator">iff</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">A</span> <span class="keyword1">AND</span> <span class="free">B</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="free">A'</span> <span class="keyword1">AND</span> <span class="free">B'</span><span class="main">)</span> <span class="main">⟷</span> <span class="main">(</span><span class="free">A</span> <span class="main">=</span> <span class="free">A'</span> <span class="main">∧</span> <span class="free">B</span> <span class="main">=</span> <span class="free">B'</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> cnj_def<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> subst_fmla_cnj <span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">A</span> <span class="keyword1">AND</span> <span class="free">B</span><span class="main">)</span><span class="main">(</span><span class="free">i</span><span class="main">::=</span><span class="free">x</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="free">A</span><span class="main">(</span><span class="free">i</span><span class="main">::=</span><span class="free">x</span><span class="main">)</span><span class="main">)</span> <span class="keyword1">AND</span> <span class="main">(</span><span class="free">B</span><span class="main">(</span><span class="free">i</span><span class="main">::=</span><span class="free">x</span><span class="main">)</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> cnj_def<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> eval_fmla_cnj <span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"eval_fmla <span class="free">e</span> <span class="main">(</span>cnj <span class="free">A</span> <span class="free">B</span><span class="main">)</span> <span class="main">⟷</span> <span class="main">(</span>eval_fmla <span class="free">e</span> <span class="free">A</span> <span class="main">∧</span> eval_fmla <span class="free">e</span> <span class="free">B</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> cnj_def<span class="main">)</span>

<span class="keyword1"><span class="command">subsubsection</span></span> <span class="quoted"><span class="plain_text">‹If and only if›</span></span>

<span class="keyword1"><span class="command">definition</span></span> <span class="entity">Iff</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"fmla <span class="main">⇒</span> fmla <span class="main">⇒</span> fmla"</span></span>   <span class="main">(</span><span class="keyword2"><span class="keyword">infixr</span></span> <span class="quoted">"<span class="keyword1">IFF</span>"</span> 125<span class="main">)</span>
  <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="free">Iff</span> <span class="free"><span class="bound"><span class="entity">A</span></span></span> <span class="free"><span class="bound"><span class="entity">B</span></span></span> <span class="main">=</span> cnj <span class="main">(</span>imp <span class="free"><span class="bound"><span class="entity">A</span></span></span> <span class="free"><span class="bound"><span class="entity">B</span></span></span><span class="main">)</span> <span class="main">(</span>imp <span class="free"><span class="bound"><span class="entity">B</span></span></span> <span class="free"><span class="bound"><span class="entity">A</span></span></span><span class="main">)</span>"</span></span>

<span class="keyword1"><span class="command">lemma</span></span> Iff_eqvt <span class="main">[</span><span class="operator">eqvt</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">p</span> <span class="main">∙</span> <span class="main">(</span><span class="free">A</span> <span class="keyword1">IFF</span> <span class="free">B</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="free">p</span> <span class="main">∙</span> <span class="free">A</span><span class="main">)</span> <span class="keyword1">IFF</span> <span class="main">(</span><span class="free">p</span> <span class="main">∙</span> <span class="free">B</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> Iff_def<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> fresh_Iff <span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">a</span> <span class="main">♯</span> <span class="free">A</span> <span class="keyword1">IFF</span> <span class="free">B</span> <span class="main">⟷</span> <span class="main">(</span><span class="free">a</span> <span class="main">♯</span> <span class="free">A</span> <span class="main">∧</span> <span class="free">a</span> <span class="main">♯</span> <span class="free">B</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> cnj_def Iff_def<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> size_Iff <span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"size <span class="main">(</span><span class="free">A</span> <span class="keyword1">IFF</span> <span class="free">B</span><span class="main">)</span> <span class="main">=</span> <span class="numeral">2</span><span class="main">*</span><span class="main">(</span>size <span class="free">A</span> <span class="main">+</span> size <span class="free">B</span><span class="main">)</span> <span class="main">+</span> <span class="numeral">8</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> Iff_def<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> Iff_injective_iff <span class="main">[</span><span class="operator">iff</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">A</span> <span class="keyword1">IFF</span> <span class="free">B</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="free">A'</span> <span class="keyword1">IFF</span> <span class="free">B'</span><span class="main">)</span> <span class="main">⟷</span> <span class="main">(</span><span class="free">A</span> <span class="main">=</span> <span class="free">A'</span> <span class="main">∧</span> <span class="free">B</span> <span class="main">=</span> <span class="free">B'</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> Iff_def<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> subst_fmla_Iff <span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">A</span> <span class="keyword1">IFF</span> <span class="free">B</span><span class="main">)</span><span class="main">(</span><span class="free">i</span><span class="main">::=</span><span class="free">x</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="free">A</span><span class="main">(</span><span class="free">i</span><span class="main">::=</span><span class="free">x</span><span class="main">)</span><span class="main">)</span> <span class="keyword1">IFF</span> <span class="main">(</span><span class="free">B</span><span class="main">(</span><span class="free">i</span><span class="main">::=</span><span class="free">x</span><span class="main">)</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> Iff_def<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> eval_fmla_Iff <span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"eval_fmla <span class="free">e</span> <span class="main">(</span>Iff <span class="free">A</span> <span class="free">B</span><span class="main">)</span> <span class="main">⟷</span> <span class="main">(</span>eval_fmla <span class="free">e</span> <span class="free">A</span>  <span class="main">⟷</span>  eval_fmla <span class="free">e</span> <span class="free">B</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> Iff_def<span class="main">)</span>

<span class="keyword1"><span class="command">subsubsection</span></span> <span class="quoted"><span class="plain_text">‹False›</span></span>

<span class="keyword1"><span class="command">definition</span></span> <span class="entity">fls</span>  <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="free">fls</span> <span class="main">≡</span> neg <span class="main">(</span>zer <span class="keyword1">EQ</span> zer<span class="main">)</span>"</span></span>

<span class="keyword1"><span class="command">lemma</span></span> fls_eqvt <span class="main">[</span><span class="operator">eqvt</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">p</span> <span class="main">∙</span> fls<span class="main">)</span> <span class="main">=</span> fls"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> fls_def<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> fls_fresh <span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">a</span> <span class="main">♯</span> fls"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> fls_def<span class="main">)</span>

<span class="keyword1"><span class="command">section</span></span> <span class="quoted"><span class="plain_text">‹Axioms and Theorems›</span></span>

<span class="keyword1"><span class="command">subsection</span></span> <span class="quoted"><span class="plain_text">‹Logical axioms›</span></span>

<span class="keyword1"><span class="command">inductive_set</span></span> <span class="entity">boolean_axioms</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"fmla set"</span></span>
  <span class="keyword2"><span class="keyword">where</span></span>
    Ident<span class="main">:</span>     <span class="quoted"><span class="quoted">"<span class="free"><span class="bound"><span class="entity">A</span></span></span> <span class="keyword1">IMP</span> <span class="free"><span class="bound"><span class="entity">A</span></span></span> <span class="main">∈</span> <span class="free">boolean_axioms</span>"</span></span>
  <span class="main">|</span> dsjI1<span class="main">:</span>    <span class="quoted"><span class="quoted">"<span class="free"><span class="bound"><span class="entity">A</span></span></span> <span class="keyword1">IMP</span> <span class="main">(</span><span class="free"><span class="bound"><span class="entity">A</span></span></span> <span class="keyword1">OR</span> <span class="free"><span class="bound"><span class="entity">B</span></span></span><span class="main">)</span> <span class="main">∈</span> <span class="free">boolean_axioms</span>"</span></span>
  <span class="main">|</span> dsjCont<span class="main">:</span>  <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free"><span class="bound"><span class="entity">A</span></span></span> <span class="keyword1">OR</span> <span class="free"><span class="bound"><span class="entity">A</span></span></span><span class="main">)</span> <span class="keyword1">IMP</span> <span class="free"><span class="bound"><span class="entity">A</span></span></span> <span class="main">∈</span> <span class="free">boolean_axioms</span>"</span></span>
  <span class="main">|</span> dsjAssoc<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free"><span class="bound"><span class="entity">A</span></span></span> <span class="keyword1">OR</span> <span class="main">(</span><span class="free"><span class="bound"><span class="entity">B</span></span></span> <span class="keyword1">OR</span> <span class="free"><span class="bound"><span class="entity">C</span></span></span><span class="main">)</span><span class="main">)</span> <span class="keyword1">IMP</span> <span class="main">(</span><span class="main">(</span><span class="free"><span class="bound"><span class="entity">A</span></span></span> <span class="keyword1">OR</span> <span class="free"><span class="bound"><span class="entity">B</span></span></span><span class="main">)</span> <span class="keyword1">OR</span> <span class="free"><span class="bound"><span class="entity">C</span></span></span><span class="main">)</span> <span class="main">∈</span> <span class="free">boolean_axioms</span>"</span></span>
  <span class="main">|</span> dsjcnj<span class="main">:</span>  <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free"><span class="bound"><span class="entity">C</span></span></span> <span class="keyword1">OR</span> <span class="free"><span class="bound"><span class="entity">A</span></span></span><span class="main">)</span> <span class="keyword1">IMP</span> <span class="main">(</span><span class="main">(</span><span class="main">(</span>neg <span class="free"><span class="bound"><span class="entity">C</span></span></span><span class="main">)</span> <span class="keyword1">OR</span> <span class="free"><span class="bound"><span class="entity">B</span></span></span><span class="main">)</span> <span class="keyword1">IMP</span> <span class="main">(</span><span class="free"><span class="bound"><span class="entity">A</span></span></span> <span class="keyword1">OR</span> <span class="free"><span class="bound"><span class="entity">B</span></span></span><span class="main">)</span><span class="main">)</span> <span class="main">∈</span> <span class="free">boolean_axioms</span>"</span></span>

<span class="keyword1"><span class="command">lemma</span></span> boolean_axioms_hold<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">A</span> <span class="main">∈</span> boolean_axioms <span class="main">⟹</span> eval_fmla <span class="free">e</span> <span class="free">A</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">induct</span> <span class="quasi_keyword">rule</span><span class="main"><span class="main">:</span></span> boolean_axioms.induct<span class="main"><span class="keyword3">,</span></span> <span class="operator">auto</span><span class="main">)</span>

<span class="keyword1"><span class="command">inductive_set</span></span> <span class="entity">special_axioms</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"fmla set"</span></span> <span class="keyword2"><span class="keyword">where</span></span>
  I<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free"><span class="bound"><span class="entity">A</span></span></span><span class="main">(</span><span class="free"><span class="bound"><span class="entity">i</span></span></span><span class="main">::=</span><span class="free"><span class="bound"><span class="entity">x</span></span></span><span class="main">)</span> <span class="keyword1">IMP</span> <span class="main">(</span>exi <span class="free"><span class="bound"><span class="entity">i</span></span></span> <span class="free"><span class="bound"><span class="entity">A</span></span></span><span class="main">)</span> <span class="main">∈</span> <span class="free">special_axioms</span>"</span></span>

<span class="keyword1"><span class="command">lemma</span></span> special_axioms_hold<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">A</span> <span class="main">∈</span> special_axioms <span class="main">⟹</span> eval_fmla <span class="free">e</span> <span class="free">A</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">induct</span> <span class="quasi_keyword">rule</span><span class="main"><span class="main">:</span></span> special_axioms.induct<span class="main"><span class="keyword3">,</span></span> <span class="operator">auto</span><span class="main">)</span> <span class="main">(</span><span class="operator">metis</span> eval_subst_fmla<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> twist_forget_eval_fmla <span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span>
   <span class="quoted"><span class="quoted">"atom <span class="free">j</span> <span class="main">♯</span> <span class="main">(</span><span class="free">i</span><span class="main">,</span> <span class="free">A</span><span class="main">)</span>
    <span class="main">⟹</span> eval_fmla <span class="main">(</span>finfun_update <span class="main">(</span>finfun_update <span class="main">(</span>finfun_update <span class="free">e</span> <span class="free">i</span> <span class="free">x</span><span class="main">)</span> <span class="free">j</span> <span class="free">y</span><span class="main">)</span> <span class="free">i</span> <span class="free">z</span><span class="main">)</span> <span class="free">A</span> <span class="main">=</span>
        eval_fmla <span class="main">(</span>finfun_update <span class="free">e</span> <span class="free">i</span> <span class="free">z</span><span class="main">)</span> <span class="free">A</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> finfun_update_twice finfun_update_twist forget_eval_fmla fresh_Pair<span class="main">)</span>

<span class="keyword1"><span class="command">subsection</span></span> <span class="quoted"><span class="plain_text">‹Concrete variables›</span></span>

<span class="keyword1"><span class="command">declare</span></span> Abs_name_inject<span class="main">[</span><span class="operator">simp</span><span class="main">]</span>

<span class="keyword1"><span class="command">abbreviation</span></span>
  <span class="quoted"><span class="quoted">"<span class="free">X0</span> <span class="main">≡</span> Abs_name <span class="main">(</span>Atom <span class="main">(</span>Sort <span class="inner_quoted">''Theory_Syntax_Q.name''</span> <span class="main">[]</span><span class="main">)</span> <span class="main">0</span><span class="main">)</span>"</span></span>

<span class="keyword1"><span class="command">abbreviation</span></span>
  <span class="quoted"><span class="quoted">"<span class="free">X1</span> <span class="main">≡</span> Abs_name <span class="main">(</span>Atom <span class="main">(</span>Sort <span class="inner_quoted">''Robinson_Arithmetic.name''</span> <span class="main">[]</span><span class="main">)</span> <span class="main">(</span>Suc <span class="main">0</span><span class="main">)</span><span class="main">)</span>"</span></span>
   <span class="comment1">― ‹We prefer <span class="antiquoted"><span class="antiquote">@{</span><span class="operator">term</span> <span class="quoted">"Suc <span class="main">0</span>"</span><span class="antiquote">}</span></span> because simplification will transform 1 to that form anyway.›</span>

<span class="keyword1"><span class="command">abbreviation</span></span>
  <span class="quoted"><span class="quoted">"<span class="free">X2</span> <span class="main">≡</span> Abs_name <span class="main">(</span>Atom <span class="main">(</span>Sort <span class="inner_quoted">''Robinson_Arithmetic.name''</span> <span class="main">[]</span><span class="main">)</span> <span class="numeral">2</span><span class="main">)</span>"</span></span>

<span class="keyword1"><span class="command">abbreviation</span></span>
  <span class="quoted"><span class="quoted">"<span class="free">X3</span> <span class="main">≡</span> Abs_name <span class="main">(</span>Atom <span class="main">(</span>Sort <span class="inner_quoted">''Robinson_Arithmetic.name''</span> <span class="main">[]</span><span class="main">)</span> <span class="numeral">3</span><span class="main">)</span>"</span></span>

<span class="keyword1"><span class="command">abbreviation</span></span>
  <span class="quoted"><span class="quoted">"<span class="free">X4</span> <span class="main">≡</span> Abs_name <span class="main">(</span>Atom <span class="main">(</span>Sort <span class="inner_quoted">''Robinson_Arithmetic.name''</span> <span class="main">[]</span><span class="main">)</span> <span class="numeral">4</span><span class="main">)</span>"</span></span>

<span class="keyword1"><span class="command">subsection</span></span> <span class="quoted"><span class="plain_text">‹Equality axioms›</span></span>

<span class="keyword1"><span class="command">definition</span></span> <span class="entity">refl_ax</span> <span class="main">::</span> <span class="quoted">fmla</span> <span class="keyword2"><span class="keyword">where</span></span>
  <span class="quoted"><span class="quoted">"<span class="free">refl_ax</span> <span class="main">=</span> Var X1 <span class="keyword1">EQ</span> Var X1"</span></span>

<span class="keyword1"><span class="command">lemma</span></span> refl_ax_holds<span class="main">:</span> <span class="quoted"><span class="quoted">"eval_fmla <span class="free">e</span> refl_ax"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> refl_ax_def<span class="main">)</span>

<span class="keyword1"><span class="command">definition</span></span> <span class="entity">eq_cong_ax</span> <span class="main">::</span> <span class="quoted">fmla</span> <span class="keyword2"><span class="keyword">where</span></span>
  <span class="quoted"><span class="quoted">"<span class="free">eq_cong_ax</span> <span class="main">=</span> <span class="main">(</span><span class="main">(</span>Var X1 <span class="keyword1">EQ</span> Var X2<span class="main">)</span> <span class="keyword1">AND</span> <span class="main">(</span>Var X3 <span class="keyword1">EQ</span> Var X4<span class="main">)</span><span class="main">)</span> <span class="keyword1">IMP</span>
                <span class="main">(</span><span class="main">(</span>Var X1 <span class="keyword1">EQ</span> Var X3<span class="main">)</span> <span class="keyword1">IMP</span> <span class="main">(</span>Var X2 <span class="keyword1">EQ</span> Var X4<span class="main">)</span><span class="main">)</span>"</span></span>

<span class="keyword1"><span class="command">lemma</span></span> eq_cong_ax_holds<span class="main">:</span> <span class="quoted"><span class="quoted">"eval_fmla <span class="free">e</span> eq_cong_ax"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> cnj_def eq_cong_ax_def<span class="main">)</span>

<span class="keyword1"><span class="command">definition</span></span> <span class="entity">syc_cong_ax</span> <span class="main">::</span> <span class="quoted">fmla</span> <span class="keyword2"><span class="keyword">where</span></span>
  <span class="quoted"><span class="quoted">"<span class="free">syc_cong_ax</span> <span class="main">=</span> <span class="main">(</span><span class="main">(</span>Var X1 <span class="keyword1">EQ</span> Var X2<span class="main">)</span><span class="main">)</span> <span class="keyword1">IMP</span>
                <span class="main">(</span><span class="main">(</span>suc <span class="main">(</span>Var X1<span class="main">)</span><span class="main">)</span> <span class="keyword1">EQ</span> <span class="main">(</span>suc <span class="main">(</span>Var X2<span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span>

<span class="keyword1"><span class="command">lemma</span></span> syc_cong_ax_holds<span class="main">:</span> <span class="quoted"><span class="quoted">"eval_fmla <span class="free">e</span> syc_cong_ax"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> cnj_def syc_cong_ax_def<span class="main">)</span>

<span class="keyword1"><span class="command">definition</span></span> <span class="entity">pls_cong_ax</span> <span class="main">::</span> <span class="quoted">fmla</span> <span class="keyword2"><span class="keyword">where</span></span>
  <span class="quoted"><span class="quoted">"<span class="free">pls_cong_ax</span> <span class="main">=</span> <span class="main">(</span><span class="main">(</span>Var X1 <span class="keyword1">EQ</span> Var X2<span class="main">)</span> <span class="keyword1">AND</span> <span class="main">(</span>Var X3 <span class="keyword1">EQ</span> Var X4<span class="main">)</span><span class="main">)</span> <span class="keyword1">IMP</span>
                  <span class="main">(</span><span class="main">(</span>pls <span class="main">(</span>Var X1<span class="main">)</span> <span class="main">(</span>Var X3<span class="main">)</span><span class="main">)</span> <span class="keyword1">EQ</span> <span class="main">(</span>pls <span class="main">(</span>Var X2<span class="main">)</span> <span class="main">(</span>Var X4<span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span>

<span class="keyword1"><span class="command">lemma</span></span> pls_cong_ax_holds<span class="main">:</span> <span class="quoted"><span class="quoted">"eval_fmla <span class="free">e</span> pls_cong_ax"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> cnj_def pls_cong_ax_def<span class="main">)</span>

<span class="keyword1"><span class="command">definition</span></span> <span class="entity">tms_cong_ax</span> <span class="main">::</span> <span class="quoted">fmla</span> <span class="keyword2"><span class="keyword">where</span></span>
  <span class="quoted"><span class="quoted">"<span class="free">tms_cong_ax</span> <span class="main">=</span> <span class="main">(</span><span class="main">(</span>Var X1 <span class="keyword1">EQ</span> Var X2<span class="main">)</span> <span class="keyword1">AND</span> <span class="main">(</span>Var X3 <span class="keyword1">EQ</span> Var X4<span class="main">)</span><span class="main">)</span> <span class="keyword1">IMP</span>
                  <span class="main">(</span><span class="main">(</span>tms <span class="main">(</span>Var X1<span class="main">)</span> <span class="main">(</span>Var X3<span class="main">)</span><span class="main">)</span> <span class="keyword1">EQ</span> <span class="main">(</span>tms <span class="main">(</span>Var X2<span class="main">)</span> <span class="main">(</span>Var X4<span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span>

<span class="keyword1"><span class="command">lemma</span></span> tms_cong_ax_holds<span class="main">:</span> <span class="quoted"><span class="quoted">"eval_fmla <span class="free">e</span> tms_cong_ax"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> cnj_def tms_cong_ax_def<span class="main">)</span>

<span class="keyword1"><span class="command">definition</span></span> <span class="entity">equality_axioms</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"fmla set"</span></span> <span class="keyword2"><span class="keyword">where</span></span>
  <span class="quoted"><span class="quoted">"<span class="free">equality_axioms</span> <span class="main">=</span> <span class="main">{</span>refl_ax<span class="main">,</span> eq_cong_ax<span class="main">,</span> syc_cong_ax<span class="main">,</span> pls_cong_ax<span class="main">,</span> tms_cong_ax<span class="main">}</span>"</span></span>

<span class="keyword1"><span class="command">lemma</span></span> equality_axioms_hold<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">A</span> <span class="main">∈</span> equality_axioms <span class="main">⟹</span> eval_fmla <span class="free">e</span> <span class="free">A</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> equality_axioms_def refl_ax_holds eq_cong_ax_holds
       syc_cong_ax_holds pls_cong_ax_holds tms_cong_ax_holds<span class="main">)</span>

<span class="keyword1"><span class="command">subsection</span></span> <span class="quoted"><span class="plain_text">‹The Q (Robinson-arithmetic-specific) axioms›</span></span>

<span class="keyword1"><span class="command">definition</span></span> <span class="quoted"><span class="quoted">"<span class="free">Q_axioms</span> <span class="main">≡</span>
 <span class="main">{</span><span class="bound">A</span> <span class="main">|</span> <span class="bound">A</span> <span class="bound">X1</span> <span class="bound">X2</span><span class="main">.</span>
   <span class="bound">X1</span> <span class="main">≠</span> <span class="bound">X2</span> <span class="main">∧</span>
   <span class="main">(</span><span class="bound">A</span> <span class="main">=</span> neg <span class="main">(</span>zer <span class="keyword1">EQ</span> suc <span class="main">(</span>Var <span class="bound">X1</span><span class="main">)</span><span class="main">)</span> <span class="main">∨</span>
    <span class="bound">A</span> <span class="main">=</span> suc <span class="main">(</span>Var <span class="bound">X1</span><span class="main">)</span> <span class="keyword1">EQ</span> suc <span class="main">(</span>Var <span class="bound">X2</span><span class="main">)</span> <span class="keyword1">IMP</span> Var <span class="bound">X1</span> <span class="keyword1">EQ</span> Var <span class="bound">X2</span> <span class="main">∨</span>
    <span class="bound">A</span> <span class="main">=</span> Var <span class="bound">X2</span> <span class="keyword1">EQ</span> zer <span class="keyword1">OR</span> exi <span class="bound">X1</span> <span class="main">(</span>Var <span class="bound">X2</span> <span class="keyword1">EQ</span> suc <span class="main">(</span>Var <span class="bound">X1</span><span class="main">)</span><span class="main">)</span> <span class="main">∨</span>
    <span class="bound">A</span> <span class="main">=</span> pls <span class="main">(</span>Var <span class="bound">X1</span><span class="main">)</span> zer <span class="keyword1">EQ</span> Var <span class="bound">X1</span> <span class="main">∨</span>
    <span class="bound">A</span> <span class="main">=</span> pls <span class="main">(</span>Var <span class="bound">X1</span><span class="main">)</span> <span class="main">(</span>suc <span class="main">(</span>Var <span class="bound">X2</span><span class="main">)</span><span class="main">)</span> <span class="keyword1">EQ</span> suc <span class="main">(</span>pls <span class="main">(</span>Var <span class="bound">X1</span><span class="main">)</span> <span class="main">(</span>Var <span class="bound">X2</span><span class="main">)</span><span class="main">)</span> <span class="main">∨</span>
    <span class="bound">A</span> <span class="main">=</span> tms <span class="main">(</span>Var <span class="bound">X1</span><span class="main">)</span> zer <span class="keyword1">EQ</span> zer <span class="main">∨</span>
    <span class="bound">A</span> <span class="main">=</span> tms <span class="main">(</span>Var <span class="bound">X1</span><span class="main">)</span> <span class="main">(</span>suc <span class="main">(</span>Var <span class="bound">X2</span><span class="main">)</span><span class="main">)</span> <span class="keyword1">EQ</span> pls <span class="main">(</span>tms <span class="main">(</span>Var <span class="bound">X1</span><span class="main">)</span> <span class="main">(</span>Var <span class="bound">X2</span><span class="main">)</span><span class="main">)</span> <span class="main">(</span>Var <span class="bound">X1</span><span class="main">)</span><span class="main">)</span><span class="main">}</span>"</span></span>


<span class="keyword1"><span class="command">subsection</span></span> <span class="quoted"><span class="plain_text">‹The proof system›</span></span>

<span class="keyword1"><span class="command">inductive</span></span> <span class="entity">nprv</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"fmla set <span class="main">⇒</span> fmla <span class="main">⇒</span> bool"</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">infixl</span></span> <span class="quoted">"<span class="keyword1">⊢</span>"</span> 55<span class="main">)</span>
  <span class="keyword2"><span class="keyword">where</span></span>
    Hyp<span class="main">:</span>    <span class="quoted"><span class="quoted">"<span class="free"><span class="bound"><span class="entity">A</span></span></span> <span class="main">∈</span> <span class="free"><span class="bound"><span class="entity">H</span></span></span> <span class="main">⟹</span> <span class="free"><span class="bound"><span class="entity">H</span></span></span> <span class="main"><span class="free">⊢</span></span> <span class="free"><span class="bound"><span class="entity">A</span></span></span>"</span></span>
  <span class="main">|</span> Q<span class="main">:</span>  <span class="quoted"><span class="quoted">"<span class="free"><span class="bound"><span class="entity">A</span></span></span> <span class="main">∈</span> Q_axioms <span class="main">⟹</span> <span class="free"><span class="bound"><span class="entity">H</span></span></span> <span class="main"><span class="free">⊢</span></span> <span class="free"><span class="bound"><span class="entity">A</span></span></span>"</span></span>
  <span class="main">|</span> Bool<span class="main">:</span>   <span class="quoted"><span class="quoted">"<span class="free"><span class="bound"><span class="entity">A</span></span></span> <span class="main">∈</span> boolean_axioms <span class="main">⟹</span> <span class="free"><span class="bound"><span class="entity">H</span></span></span> <span class="main"><span class="free">⊢</span></span> <span class="free"><span class="bound"><span class="entity">A</span></span></span>"</span></span>
  <span class="main">|</span> eql<span class="main">:</span>     <span class="quoted"><span class="quoted">"<span class="free"><span class="bound"><span class="entity">A</span></span></span> <span class="main">∈</span> equality_axioms <span class="main">⟹</span> <span class="free"><span class="bound"><span class="entity">H</span></span></span> <span class="main"><span class="free">⊢</span></span> <span class="free"><span class="bound"><span class="entity">A</span></span></span>"</span></span>
  <span class="main">|</span> Spec<span class="main">:</span>   <span class="quoted"><span class="quoted">"<span class="free"><span class="bound"><span class="entity">A</span></span></span> <span class="main">∈</span> special_axioms <span class="main">⟹</span> <span class="free"><span class="bound"><span class="entity">H</span></span></span> <span class="main"><span class="free">⊢</span></span> <span class="free"><span class="bound"><span class="entity">A</span></span></span>"</span></span>
  <span class="main">|</span> MP<span class="main">:</span>     <span class="quoted"><span class="quoted">"<span class="free"><span class="bound"><span class="entity">H</span></span></span> <span class="main"><span class="free">⊢</span></span> <span class="free"><span class="bound"><span class="entity">A</span></span></span> <span class="keyword1">IMP</span> <span class="free"><span class="bound"><span class="entity">B</span></span></span> <span class="main">⟹</span> <span class="free"><span class="bound"><span class="entity">H'</span></span></span> <span class="main"><span class="free">⊢</span></span> <span class="free"><span class="bound"><span class="entity">A</span></span></span> <span class="main">⟹</span> <span class="free"><span class="bound"><span class="entity">H</span></span></span> <span class="main">∪</span> <span class="free"><span class="bound"><span class="entity">H'</span></span></span> <span class="main"><span class="free">⊢</span></span> <span class="free"><span class="bound"><span class="entity">B</span></span></span>"</span></span>
  <span class="main">|</span> exiists<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free"><span class="bound"><span class="entity">H</span></span></span> <span class="main"><span class="free">⊢</span></span> <span class="free"><span class="bound"><span class="entity">A</span></span></span> <span class="keyword1">IMP</span> <span class="free"><span class="bound"><span class="entity">B</span></span></span> <span class="main">⟹</span> atom <span class="free"><span class="bound"><span class="entity">i</span></span></span> <span class="main">♯</span> <span class="free"><span class="bound"><span class="entity">B</span></span></span> <span class="main">⟹</span> <span class="main">∀</span><span class="bound">C</span> <span class="main">∈</span> <span class="free"><span class="bound"><span class="entity">H</span></span></span><span class="main">.</span> atom <span class="free"><span class="bound"><span class="entity">i</span></span></span> <span class="main">♯</span> <span class="bound">C</span> <span class="main">⟹</span> <span class="free"><span class="bound"><span class="entity">H</span></span></span> <span class="main"><span class="free">⊢</span></span> <span class="main">(</span>exi <span class="free"><span class="bound"><span class="entity">i</span></span></span> <span class="free"><span class="bound"><span class="entity">A</span></span></span><span class="main">)</span> <span class="keyword1">IMP</span> <span class="free"><span class="bound"><span class="entity">B</span></span></span>"</span></span>


<span class="keyword1"><span class="command">subsection</span></span><span class="quoted"><span class="plain_text">‹Derived rules of inference›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> contraction<span class="main">:</span> <span class="quoted"><span class="quoted">"insert <span class="free">A</span> <span class="main">(</span>insert <span class="free">A</span> <span class="free">H</span><span class="main">)</span> <span class="main">⊢</span> <span class="free">B</span> <span class="main">⟹</span> insert <span class="free">A</span> <span class="free">H</span> <span class="main">⊢</span> <span class="free">B</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> insert_absorb2<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> thin_Un<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">H</span> <span class="main">⊢</span> <span class="free">A</span> <span class="main">⟹</span> <span class="free">H</span> <span class="main">∪</span> <span class="free">H'</span> <span class="main">⊢</span> <span class="free">A</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> Bool MP boolean_axioms.Ident sup_commute<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> thin<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">H</span> <span class="main">⊢</span> <span class="free">A</span> <span class="main">⟹</span> <span class="free">H</span> <span class="main">⊆</span> <span class="free">H'</span> <span class="main">⟹</span> <span class="free">H'</span> <span class="main">⊢</span> <span class="free">A</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> Un_absorb1 thin_Un<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> thin0<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">{}</span> <span class="main">⊢</span> <span class="free">A</span> <span class="main">⟹</span> <span class="free">H</span> <span class="main">⊢</span> <span class="free">A</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> sup_bot_left thin_Un<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> thin1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">H</span> <span class="main">⊢</span> <span class="free">B</span> <span class="main">⟹</span> insert <span class="free">A</span> <span class="free">H</span> <span class="main">⊢</span> <span class="free">B</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> subset_insertI thin<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> thin2<span class="main">:</span> <span class="quoted"><span class="quoted">"insert <span class="free">A1</span> <span class="free">H</span> <span class="main">⊢</span> <span class="free">B</span> <span class="main">⟹</span> insert <span class="free">A1</span> <span class="main">(</span>insert <span class="free">A2</span> <span class="free">H</span><span class="main">)</span> <span class="main">⊢</span> <span class="free">B</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">blast</span> <span class="quasi_keyword">intro</span><span class="main"><span class="main">:</span></span> thin<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> thin3<span class="main">:</span> <span class="quoted"><span class="quoted">"insert <span class="free">A1</span> <span class="main">(</span>insert <span class="free">A2</span> <span class="free">H</span><span class="main">)</span> <span class="main">⊢</span> <span class="free">B</span> <span class="main">⟹</span> insert <span class="free">A1</span> <span class="main">(</span>insert <span class="free">A2</span> <span class="main">(</span>insert <span class="free">A3</span> <span class="free">H</span><span class="main">)</span><span class="main">)</span> <span class="main">⊢</span> <span class="free">B</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">blast</span> <span class="quasi_keyword">intro</span><span class="main"><span class="main">:</span></span> thin<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> thin4<span class="main">:</span>
  <span class="quoted"><span class="quoted">"insert <span class="free">A1</span> <span class="main">(</span>insert <span class="free">A2</span> <span class="main">(</span>insert <span class="free">A3</span> <span class="free">H</span><span class="main">)</span><span class="main">)</span> <span class="main">⊢</span> <span class="free">B</span>
   <span class="main">⟹</span> insert <span class="free">A1</span> <span class="main">(</span>insert <span class="free">A2</span> <span class="main">(</span>insert <span class="free">A3</span> <span class="main">(</span>insert <span class="free">A4</span> <span class="free">H</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">⊢</span> <span class="free">B</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">blast</span> <span class="quasi_keyword">intro</span><span class="main"><span class="main">:</span></span> thin<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> rotate2<span class="main">:</span> <span class="quoted"><span class="quoted">"insert <span class="free">A2</span> <span class="main">(</span>insert <span class="free">A1</span> <span class="free">H</span><span class="main">)</span> <span class="main">⊢</span> <span class="free">B</span> <span class="main">⟹</span> insert <span class="free">A1</span> <span class="main">(</span>insert <span class="free">A2</span> <span class="free">H</span><span class="main">)</span> <span class="main">⊢</span> <span class="free">B</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">blast</span> <span class="quasi_keyword">intro</span><span class="main"><span class="main">:</span></span> thin<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> rotate3<span class="main">:</span> <span class="quoted"><span class="quoted">"insert <span class="free">A3</span> <span class="main">(</span>insert <span class="free">A1</span> <span class="main">(</span>insert <span class="free">A2</span> <span class="free">H</span><span class="main">)</span><span class="main">)</span> <span class="main">⊢</span> <span class="free">B</span> <span class="main">⟹</span> insert <span class="free">A1</span> <span class="main">(</span>insert <span class="free">A2</span> <span class="main">(</span>insert <span class="free">A3</span> <span class="free">H</span><span class="main">)</span><span class="main">)</span> <span class="main">⊢</span> <span class="free">B</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">blast</span> <span class="quasi_keyword">intro</span><span class="main"><span class="main">:</span></span> thin<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> rotate4<span class="main">:</span>
  <span class="quoted"><span class="quoted">"insert <span class="free">A4</span> <span class="main">(</span>insert <span class="free">A1</span> <span class="main">(</span>insert <span class="free">A2</span> <span class="main">(</span>insert <span class="free">A3</span> <span class="free">H</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">⊢</span> <span class="free">B</span>
   <span class="main">⟹</span> insert <span class="free">A1</span> <span class="main">(</span>insert <span class="free">A2</span> <span class="main">(</span>insert <span class="free">A3</span> <span class="main">(</span>insert <span class="free">A4</span> <span class="free">H</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">⊢</span> <span class="free">B</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">blast</span> <span class="quasi_keyword">intro</span><span class="main"><span class="main">:</span></span> thin<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> rotate5<span class="main">:</span>
  <span class="quoted"><span class="quoted">"insert <span class="free">A5</span> <span class="main">(</span>insert <span class="free">A1</span> <span class="main">(</span>insert <span class="free">A2</span> <span class="main">(</span>insert <span class="free">A3</span> <span class="main">(</span>insert <span class="free">A4</span> <span class="free">H</span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">⊢</span> <span class="free">B</span>
   <span class="main">⟹</span> insert <span class="free">A1</span> <span class="main">(</span>insert <span class="free">A2</span> <span class="main">(</span>insert <span class="free">A3</span> <span class="main">(</span>insert <span class="free">A4</span> <span class="main">(</span>insert <span class="free">A5</span> <span class="free">H</span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">⊢</span> <span class="free">B</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">blast</span> <span class="quasi_keyword">intro</span><span class="main"><span class="main">:</span></span> thin<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> rotate6<span class="main">:</span>
  <span class="quoted"><span class="quoted">"insert <span class="free">A6</span> <span class="main">(</span>insert <span class="free">A1</span> <span class="main">(</span>insert <span class="free">A2</span> <span class="main">(</span>insert <span class="free">A3</span> <span class="main">(</span>insert <span class="free">A4</span> <span class="main">(</span>insert <span class="free">A5</span> <span class="free">H</span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">⊢</span> <span class="free">B</span>
   <span class="main">⟹</span> insert <span class="free">A1</span> <span class="main">(</span>insert <span class="free">A2</span> <span class="main">(</span>insert <span class="free">A3</span> <span class="main">(</span>insert <span class="free">A4</span> <span class="main">(</span>insert <span class="free">A5</span> <span class="main">(</span>insert <span class="free">A6</span> <span class="free">H</span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">⊢</span> <span class="free">B</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">blast</span> <span class="quasi_keyword">intro</span><span class="main"><span class="main">:</span></span> thin<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> rotate7<span class="main">:</span>
  <span class="quoted"><span class="quoted">"insert <span class="free">A7</span> <span class="main">(</span>insert <span class="free">A1</span> <span class="main">(</span>insert <span class="free">A2</span> <span class="main">(</span>insert <span class="free">A3</span> <span class="main">(</span>insert <span class="free">A4</span> <span class="main">(</span>insert <span class="free">A5</span> <span class="main">(</span>insert <span class="free">A6</span> <span class="free">H</span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">⊢</span> <span class="free">B</span>
   <span class="main">⟹</span> insert <span class="free">A1</span> <span class="main">(</span>insert <span class="free">A2</span> <span class="main">(</span>insert <span class="free">A3</span> <span class="main">(</span>insert <span class="free">A4</span> <span class="main">(</span>insert <span class="free">A5</span> <span class="main">(</span>insert <span class="free">A6</span> <span class="main">(</span>insert <span class="free">A7</span> <span class="free">H</span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">⊢</span> <span class="free">B</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">blast</span> <span class="quasi_keyword">intro</span><span class="main"><span class="main">:</span></span> thin<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> rotate8<span class="main">:</span>
  <span class="quoted"><span class="quoted">"insert <span class="free">A8</span> <span class="main">(</span>insert <span class="free">A1</span> <span class="main">(</span>insert <span class="free">A2</span> <span class="main">(</span>insert <span class="free">A3</span> <span class="main">(</span>insert <span class="free">A4</span> <span class="main">(</span>insert <span class="free">A5</span> <span class="main">(</span>insert <span class="free">A6</span> <span class="main">(</span>insert <span class="free">A7</span> <span class="free">H</span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">⊢</span> <span class="free">B</span>
   <span class="main">⟹</span> insert <span class="free">A1</span> <span class="main">(</span>insert <span class="free">A2</span> <span class="main">(</span>insert <span class="free">A3</span> <span class="main">(</span>insert <span class="free">A4</span> <span class="main">(</span>insert <span class="free">A5</span> <span class="main">(</span>insert <span class="free">A6</span> <span class="main">(</span>insert <span class="free">A7</span> <span class="main">(</span>insert <span class="free">A8</span> <span class="free">H</span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">⊢</span> <span class="free">B</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">blast</span> <span class="quasi_keyword">intro</span><span class="main"><span class="main">:</span></span> thin<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> rotate9<span class="main">:</span>
  <span class="quoted"><span class="quoted">"insert <span class="free">A9</span> <span class="main">(</span>insert <span class="free">A1</span> <span class="main">(</span>insert <span class="free">A2</span> <span class="main">(</span>insert <span class="free">A3</span> <span class="main">(</span>insert <span class="free">A4</span> <span class="main">(</span>insert <span class="free">A5</span> <span class="main">(</span>insert <span class="free">A6</span> <span class="main">(</span>insert <span class="free">A7</span> <span class="main">(</span>insert <span class="free">A8</span> <span class="free">H</span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">⊢</span> <span class="free">B</span>
   <span class="main">⟹</span> insert <span class="free">A1</span> <span class="main">(</span>insert <span class="free">A2</span> <span class="main">(</span>insert <span class="free">A3</span> <span class="main">(</span>insert <span class="free">A4</span> <span class="main">(</span>insert <span class="free">A5</span> <span class="main">(</span>insert <span class="free">A6</span> <span class="main">(</span>insert <span class="free">A7</span> <span class="main">(</span>insert <span class="free">A8</span> <span class="main">(</span>insert <span class="free">A9</span> <span class="free">H</span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">⊢</span> <span class="free">B</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">blast</span> <span class="quasi_keyword">intro</span><span class="main"><span class="main">:</span></span> thin<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> rotate10<span class="main">:</span>
  <span class="quoted"><span class="quoted">"insert <span class="free">A10</span> <span class="main">(</span>insert <span class="free">A1</span> <span class="main">(</span>insert <span class="free">A2</span> <span class="main">(</span>insert <span class="free">A3</span> <span class="main">(</span>insert <span class="free">A4</span> <span class="main">(</span>insert <span class="free">A5</span> <span class="main">(</span>insert <span class="free">A6</span> <span class="main">(</span>insert <span class="free">A7</span> <span class="main">(</span>insert <span class="free">A8</span> <span class="main">(</span>insert <span class="free">A9</span> <span class="free">H</span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">⊢</span> <span class="free">B</span>
   <span class="main">⟹</span> insert <span class="free">A1</span> <span class="main">(</span>insert <span class="free">A2</span> <span class="main">(</span>insert <span class="free">A3</span> <span class="main">(</span>insert <span class="free">A4</span> <span class="main">(</span>insert <span class="free">A5</span> <span class="main">(</span>insert <span class="free">A6</span> <span class="main">(</span>insert <span class="free">A7</span> <span class="main">(</span>insert <span class="free">A8</span> <span class="main">(</span>insert <span class="free">A9</span> <span class="main">(</span>insert <span class="free">A10</span> <span class="free">H</span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">⊢</span> <span class="free">B</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">blast</span> <span class="quasi_keyword">intro</span><span class="main"><span class="main">:</span></span> thin<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> rotate11<span class="main">:</span>
  <span class="quoted"><span class="quoted">"insert <span class="free">A11</span> <span class="main">(</span>insert <span class="free">A1</span> <span class="main">(</span>insert <span class="free">A2</span> <span class="main">(</span>insert <span class="free">A3</span> <span class="main">(</span>insert <span class="free">A4</span> <span class="main">(</span>insert <span class="free">A5</span> <span class="main">(</span>insert <span class="free">A6</span> <span class="main">(</span>insert <span class="free">A7</span> <span class="main">(</span>insert <span class="free">A8</span> <span class="main">(</span>insert <span class="free">A9</span> <span class="main">(</span>insert <span class="free">A10</span> <span class="free">H</span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">⊢</span> <span class="free">B</span>
   <span class="main">⟹</span> insert <span class="free">A1</span> <span class="main">(</span>insert <span class="free">A2</span> <span class="main">(</span>insert <span class="free">A3</span> <span class="main">(</span>insert <span class="free">A4</span> <span class="main">(</span>insert <span class="free">A5</span> <span class="main">(</span>insert <span class="free">A6</span> <span class="main">(</span>insert <span class="free">A7</span> <span class="main">(</span>insert <span class="free">A8</span> <span class="main">(</span>insert <span class="free">A9</span> <span class="main">(</span>insert <span class="free">A10</span> <span class="main">(</span>insert <span class="free">A11</span> <span class="free">H</span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">⊢</span> <span class="free">B</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">blast</span> <span class="quasi_keyword">intro</span><span class="main"><span class="main">:</span></span> thin<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> rotate12<span class="main">:</span>
  <span class="quoted"><span class="quoted">"insert <span class="free">A12</span> <span class="main">(</span>insert <span class="free">A1</span> <span class="main">(</span>insert <span class="free">A2</span> <span class="main">(</span>insert <span class="free">A3</span> <span class="main">(</span>insert <span class="free">A4</span> <span class="main">(</span>insert <span class="free">A5</span> <span class="main">(</span>insert <span class="free">A6</span> <span class="main">(</span>insert <span class="free">A7</span> <span class="main">(</span>insert <span class="free">A8</span> <span class="main">(</span>insert <span class="free">A9</span> <span class="main">(</span>insert <span class="free">A10</span> <span class="main">(</span>insert <span class="free">A11</span> <span class="free">H</span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">⊢</span> <span class="free">B</span>
   <span class="main">⟹</span> insert <span class="free">A1</span> <span class="main">(</span>insert <span class="free">A2</span> <span class="main">(</span>insert <span class="free">A3</span> <span class="main">(</span>insert <span class="free">A4</span> <span class="main">(</span>insert <span class="free">A5</span> <span class="main">(</span>insert <span class="free">A6</span> <span class="main">(</span>insert <span class="free">A7</span> <span class="main">(</span>insert <span class="free">A8</span> <span class="main">(</span>insert <span class="free">A9</span> <span class="main">(</span>insert <span class="free">A10</span> <span class="main">(</span>insert <span class="free">A11</span> <span class="main">(</span>insert <span class="free">A12</span> <span class="free">H</span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">⊢</span> <span class="free">B</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">blast</span> <span class="quasi_keyword">intro</span><span class="main"><span class="main">:</span></span> thin<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> rotate13<span class="main">:</span>
  <span class="quoted"><span class="quoted">"insert <span class="free">A13</span> <span class="main">(</span>insert <span class="free">A1</span> <span class="main">(</span>insert <span class="free">A2</span> <span class="main">(</span>insert <span class="free">A3</span> <span class="main">(</span>insert <span class="free">A4</span> <span class="main">(</span>insert <span class="free">A5</span> <span class="main">(</span>insert <span class="free">A6</span> <span class="main">(</span>insert <span class="free">A7</span> <span class="main">(</span>insert <span class="free">A8</span> <span class="main">(</span>insert <span class="free">A9</span> <span class="main">(</span>insert <span class="free">A10</span> <span class="main">(</span>insert <span class="free">A11</span> <span class="main">(</span>insert <span class="free">A12</span> <span class="free">H</span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">⊢</span> <span class="free">B</span>
   <span class="main">⟹</span> insert <span class="free">A1</span> <span class="main">(</span>insert <span class="free">A2</span> <span class="main">(</span>insert <span class="free">A3</span> <span class="main">(</span>insert <span class="free">A4</span> <span class="main">(</span>insert <span class="free">A5</span> <span class="main">(</span>insert <span class="free">A6</span> <span class="main">(</span>insert <span class="free">A7</span> <span class="main">(</span>insert <span class="free">A8</span> <span class="main">(</span>insert <span class="free">A9</span> <span class="main">(</span>insert <span class="free">A10</span> <span class="main">(</span>insert <span class="free">A11</span> <span class="main">(</span>insert <span class="free">A12</span> <span class="main">(</span>insert <span class="free">A13</span> <span class="free">H</span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">⊢</span> <span class="free">B</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">blast</span> <span class="quasi_keyword">intro</span><span class="main"><span class="main">:</span></span> thin<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> rotate14<span class="main">:</span>
  <span class="quoted"><span class="quoted">"insert <span class="free">A14</span> <span class="main">(</span>insert <span class="free">A1</span> <span class="main">(</span>insert <span class="free">A2</span> <span class="main">(</span>insert <span class="free">A3</span> <span class="main">(</span>insert <span class="free">A4</span> <span class="main">(</span>insert <span class="free">A5</span> <span class="main">(</span>insert <span class="free">A6</span> <span class="main">(</span>insert <span class="free">A7</span> <span class="main">(</span>insert <span class="free">A8</span> <span class="main">(</span>insert <span class="free">A9</span> <span class="main">(</span>insert <span class="free">A10</span> <span class="main">(</span>insert <span class="free">A11</span> <span class="main">(</span>insert <span class="free">A12</span> <span class="main">(</span>insert <span class="free">A13</span> <span class="free">H</span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">⊢</span> <span class="free">B</span>
   <span class="main">⟹</span> insert <span class="free">A1</span> <span class="main">(</span>insert <span class="free">A2</span> <span class="main">(</span>insert <span class="free">A3</span> <span class="main">(</span>insert <span class="free">A4</span> <span class="main">(</span>insert <span class="free">A5</span> <span class="main">(</span>insert <span class="free">A6</span> <span class="main">(</span>insert <span class="free">A7</span> <span class="main">(</span>insert <span class="free">A8</span> <span class="main">(</span>insert <span class="free">A9</span> <span class="main">(</span>insert <span class="free">A10</span> <span class="main">(</span>insert <span class="free">A11</span> <span class="main">(</span>insert <span class="free">A12</span> <span class="main">(</span>insert <span class="free">A13</span> <span class="main">(</span>insert <span class="free">A14</span> <span class="free">H</span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">⊢</span> <span class="free">B</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">blast</span> <span class="quasi_keyword">intro</span><span class="main"><span class="main">:</span></span> thin<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> rotate15<span class="main">:</span>
  <span class="quoted"><span class="quoted">"insert <span class="free">A15</span> <span class="main">(</span>insert <span class="free">A1</span> <span class="main">(</span>insert <span class="free">A2</span> <span class="main">(</span>insert <span class="free">A3</span> <span class="main">(</span>insert <span class="free">A4</span> <span class="main">(</span>insert <span class="free">A5</span> <span class="main">(</span>insert <span class="free">A6</span> <span class="main">(</span>insert <span class="free">A7</span> <span class="main">(</span>insert <span class="free">A8</span> <span class="main">(</span>insert <span class="free">A9</span> <span class="main">(</span>insert <span class="free">A10</span> <span class="main">(</span>insert <span class="free">A11</span> <span class="main">(</span>insert <span class="free">A12</span> <span class="main">(</span>insert <span class="free">A13</span> <span class="main">(</span>insert <span class="free">A14</span> <span class="free">H</span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">⊢</span> <span class="free">B</span>
   <span class="main">⟹</span> insert <span class="free">A1</span> <span class="main">(</span>insert <span class="free">A2</span> <span class="main">(</span>insert <span class="free">A3</span> <span class="main">(</span>insert <span class="free">A4</span> <span class="main">(</span>insert <span class="free">A5</span> <span class="main">(</span>insert <span class="free">A6</span> <span class="main">(</span>insert <span class="free">A7</span> <span class="main">(</span>insert <span class="free">A8</span> <span class="main">(</span>insert <span class="free">A9</span> <span class="main">(</span>insert <span class="free">A10</span> <span class="main">(</span>insert <span class="free">A11</span> <span class="main">(</span>insert <span class="free">A12</span> <span class="main">(</span>insert <span class="free">A13</span> <span class="main">(</span>insert <span class="free">A14</span> <span class="main">(</span>insert <span class="free">A15</span> <span class="free">H</span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">⊢</span> <span class="free">B</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">blast</span> <span class="quasi_keyword">intro</span><span class="main"><span class="main">:</span></span> thin<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> MP_same<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">H</span> <span class="main">⊢</span> <span class="free">A</span> <span class="keyword1">IMP</span> <span class="free">B</span> <span class="main">⟹</span> <span class="free">H</span> <span class="main">⊢</span> <span class="free">A</span> <span class="main">⟹</span> <span class="free">H</span> <span class="main">⊢</span> <span class="free">B</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> MP Un_absorb<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> MP_thin<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">HA</span> <span class="main">⊢</span> <span class="free">A</span> <span class="keyword1">IMP</span> <span class="free">B</span> <span class="main">⟹</span> <span class="free">HB</span> <span class="main">⊢</span> <span class="free">A</span> <span class="main">⟹</span> <span class="free">HA</span> <span class="main">∪</span> <span class="free">HB</span> <span class="main">⊆</span> <span class="free">H</span> <span class="main">⟹</span> <span class="free">H</span> <span class="main">⊢</span> <span class="free">B</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> MP_same le_sup_iff thin<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> MP_null<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">{}</span> <span class="main">⊢</span> <span class="free">A</span> <span class="keyword1">IMP</span> <span class="free">B</span> <span class="main">⟹</span> <span class="free">H</span> <span class="main">⊢</span> <span class="free">A</span> <span class="main">⟹</span> <span class="free">H</span> <span class="main">⊢</span> <span class="free">B</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> MP_same thin0<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> dsj_commute<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">H</span> <span class="main">⊢</span> <span class="free">B</span> <span class="keyword1">OR</span> <span class="free">A</span> <span class="main">⟹</span> <span class="free">H</span> <span class="main">⊢</span> <span class="free">A</span> <span class="keyword1">OR</span> <span class="free">B</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> dsjcnj <span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="free">B</span></span> <span class="quoted"><span class="free">A</span></span> <span class="quoted"><span class="free">B</span></span><span class="main">]</span> Ident <span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="free">B</span></span><span class="main">]</span>
<span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> Bool MP_same<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> S<span class="main">:</span> <span class="keyword2"><span class="keyword">assumes</span></span>  <span class="quoted"><span class="quoted">"<span class="free">H</span> <span class="main">⊢</span> <span class="free">A</span> <span class="keyword1">IMP</span> <span class="main">(</span><span class="free">B</span> <span class="keyword1">IMP</span> <span class="free">C</span><span class="main">)</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="free">H'</span> <span class="main">⊢</span> <span class="free">A</span> <span class="keyword1">IMP</span> <span class="free">B</span>"</span></span> <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">H</span> <span class="main">∪</span> <span class="free">H'</span> <span class="main">⊢</span> <span class="free">A</span> <span class="keyword1">IMP</span> <span class="free">C</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">H'</span> <span class="main">∪</span> <span class="free">H</span> <span class="main">⊢</span> <span class="main">(</span>neg <span class="free">A</span><span class="main">)</span> <span class="keyword1">OR</span> <span class="main">(</span><span class="free">C</span> <span class="keyword1">OR</span> <span class="main">(</span>neg <span class="free">A</span><span class="main">)</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> Bool MP MP_same boolean_axioms.dsjcnj dsj_commute dsjAssoc assms<span class="main">)</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> Bool dsj_commute Un_commute MP_same dsjAssoc dsjCont dsjI1<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">lemma</span></span> Assume<span class="main">:</span> <span class="quoted"><span class="quoted">"insert <span class="free">A</span> <span class="free">H</span> <span class="main">⊢</span> <span class="free">A</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> Hyp insertI1<span class="main">)</span>

<span class="keyword1"><span class="command">lemmas</span></span> AssumeH <span class="main">=</span> Assume Assume <span class="main">[</span><span class="operator">THEN</span> rotate2<span class="main">]</span> Assume <span class="main">[</span><span class="operator">THEN</span> rotate3<span class="main">]</span> Assume <span class="main">[</span><span class="operator">THEN</span> rotate4<span class="main">]</span> Assume <span class="main">[</span><span class="operator">THEN</span> rotate5<span class="main">]</span>
                 Assume <span class="main">[</span><span class="operator">THEN</span> rotate6<span class="main">]</span> Assume <span class="main">[</span><span class="operator">THEN</span> rotate7<span class="main">]</span> Assume <span class="main">[</span><span class="operator">THEN</span> rotate8<span class="main">]</span> Assume <span class="main">[</span><span class="operator">THEN</span> rotate9<span class="main">]</span> Assume <span class="main">[</span><span class="operator">THEN</span> rotate10<span class="main">]</span>
                 Assume <span class="main">[</span><span class="operator">THEN</span> rotate11<span class="main">]</span> Assume <span class="main">[</span><span class="operator">THEN</span> rotate12<span class="main">]</span>
<span class="keyword1"><span class="command">declare</span></span> AssumeH <span class="main">[</span><span class="operator">intro</span><span class="main"><span class="main"><span class="main"><span class="main"><span class="main"><span class="main"><span class="main"><span class="main"><span class="main"><span class="main"><span class="main"><span class="main"><span class="main">!</span></span></span></span></span></span></span></span></span></span></span></span></span><span class="main">]</span>

<span class="keyword1"><span class="command">lemma</span></span> imp_triv_I<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">H</span> <span class="main">⊢</span> <span class="free">B</span> <span class="main">⟹</span> <span class="free">H</span> <span class="main">⊢</span> <span class="free">A</span> <span class="keyword1">IMP</span> <span class="free">B</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> Bool dsj_commute MP_same boolean_axioms.dsjI1<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> dsjAssoc1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">H</span> <span class="main">⊢</span> <span class="free">A</span> <span class="keyword1">OR</span> <span class="main">(</span><span class="free">B</span> <span class="keyword1">OR</span> <span class="free">C</span><span class="main">)</span> <span class="main">⟹</span> <span class="free">H</span> <span class="main">⊢</span> <span class="main">(</span><span class="free">A</span> <span class="keyword1">OR</span> <span class="free">B</span><span class="main">)</span> <span class="keyword1">OR</span> <span class="free">C</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> Bool MP_same boolean_axioms.dsjAssoc<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> dsjAssoc2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">H</span> <span class="main">⊢</span> <span class="main">(</span><span class="free">A</span> <span class="keyword1">OR</span> <span class="free">B</span><span class="main">)</span> <span class="keyword1">OR</span> <span class="free">C</span> <span class="main">⟹</span> <span class="free">H</span> <span class="main">⊢</span> <span class="free">A</span> <span class="keyword1">OR</span> <span class="main">(</span><span class="free">B</span> <span class="keyword1">OR</span> <span class="free">C</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> dsjAssoc1 dsj_commute<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> dsj_commute_imp<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">H</span> <span class="main">⊢</span> <span class="main">(</span><span class="free">B</span> <span class="keyword1">OR</span> <span class="free">A</span><span class="main">)</span> <span class="keyword1">IMP</span> <span class="main">(</span><span class="free">A</span> <span class="keyword1">OR</span> <span class="free">B</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> dsjcnj <span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="free">B</span></span> <span class="quoted"><span class="free">A</span></span> <span class="quoted"><span class="free">B</span></span><span class="main">]</span> Ident <span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="free">B</span></span><span class="main">]</span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> Bool dsjAssoc2 dsj_commute MP_same<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> dsj_Semicong_1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">H</span> <span class="main">⊢</span> <span class="free">A</span> <span class="keyword1">OR</span> <span class="free">C</span> <span class="main">⟹</span> <span class="free">H</span> <span class="main">⊢</span> <span class="free">A</span> <span class="keyword1">IMP</span> <span class="free">B</span> <span class="main">⟹</span> <span class="free">H</span> <span class="main">⊢</span> <span class="free">B</span> <span class="keyword1">OR</span> <span class="free">C</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> dsjcnj <span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="free">A</span></span> <span class="quoted"><span class="free">C</span></span> <span class="quoted"><span class="free">B</span></span><span class="main">]</span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> Bool dsj_commute MP_same<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> imp_imp_commute<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">H</span> <span class="main">⊢</span> <span class="free">B</span> <span class="keyword1">IMP</span> <span class="main">(</span><span class="free">A</span> <span class="keyword1">IMP</span> <span class="free">C</span><span class="main">)</span> <span class="main">⟹</span> <span class="free">H</span> <span class="main">⊢</span> <span class="free">A</span> <span class="keyword1">IMP</span> <span class="main">(</span><span class="free">B</span> <span class="keyword1">IMP</span> <span class="free">C</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> dsjAssoc1 dsjAssoc2 dsj_Semicong_1 dsj_commute_imp<span class="main">)</span>


<span class="keyword1"><span class="command">subsection</span></span><span class="quoted"><span class="plain_text">‹The deduction theorem›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> deduction_Diff<span class="main">:</span> <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">H</span> <span class="main">⊢</span> <span class="free">B</span>"</span></span> <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">H</span> <span class="main">-</span> <span class="main">{</span><span class="free">C</span><span class="main">}</span> <span class="main">⊢</span> <span class="free">C</span> <span class="keyword1">IMP</span> <span class="free">B</span>"</span></span>
<span class="keyword1"><span class="command">using</span></span> assms
<span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">induct</span><span class="main">)</span>
  <span class="keyword3"><span class="command">case</span></span> <span class="main">(</span>Hyp <span class="skolem">A</span> <span class="skolem">H</span><span class="main">)</span> <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?case</span></span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> Bool imp_triv_I boolean_axioms.Ident nprv.Hyp member_remove remove_def<span class="main">)</span>
<span class="keyword1"><span class="command">next</span></span>
  <span class="keyword3"><span class="command">case</span></span> <span class="main">(</span>Q <span class="skolem">H</span><span class="main">)</span> <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?case</span></span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> imp_triv_I nprv.Q<span class="main">)</span>
<span class="keyword1"><span class="command">next</span></span>
  <span class="keyword3"><span class="command">case</span></span> <span class="main">(</span>Bool <span class="skolem">A</span> <span class="skolem">H</span><span class="main">)</span> <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?case</span></span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> imp_triv_I nprv.Bool<span class="main">)</span>
<span class="keyword1"><span class="command">next</span></span>
  <span class="keyword3"><span class="command">case</span></span> <span class="main">(</span>eql <span class="skolem">A</span> <span class="skolem">H</span><span class="main">)</span> <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?case</span></span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> imp_triv_I nprv.eql<span class="main">)</span>
<span class="keyword1"><span class="command">next</span></span>
  <span class="keyword3"><span class="command">case</span></span> <span class="main">(</span>Spec <span class="skolem">A</span> <span class="skolem">H</span><span class="main">)</span> <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?case</span></span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> imp_triv_I nprv.Spec<span class="main">)</span>
<span class="keyword1"><span class="command">next</span></span>
  <span class="keyword3"><span class="command">case</span></span> <span class="main">(</span>MP <span class="skolem">H</span> <span class="skolem">A</span> <span class="skolem">B</span> <span class="skolem">H'</span><span class="main">)</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">H</span><span class="main">-</span><span class="main">{</span><span class="free">C</span><span class="main">}</span><span class="main">)</span> <span class="main">∪</span> <span class="main">(</span><span class="skolem">H'</span><span class="main">-</span><span class="main">{</span><span class="free">C</span><span class="main">}</span><span class="main">)</span> <span class="main">⊢</span> imp <span class="free">C</span> <span class="skolem">B</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> S<span class="main">)</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?case</span></span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> Un_Diff<span class="main">)</span>
<span class="keyword1"><span class="command">next</span></span>
  <span class="keyword3"><span class="command">case</span></span> <span class="main">(</span>exiists <span class="skolem">H</span> <span class="skolem">A</span> <span class="skolem">B</span> <span class="skolem">i</span><span class="main">)</span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?case</span></span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">cases</span> <span class="quoted"><span class="quoted">"<span class="free">C</span> <span class="main">∈</span> <span class="skolem">H</span>"</span></span><span class="main">)</span>
    <span class="keyword3"><span class="command">case</span></span> True
    <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"atom <span class="skolem">i</span> <span class="main">♯</span> <span class="free">C</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> exiists <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">H</span> <span class="main">-</span> <span class="main">{</span><span class="free">C</span><span class="main">}</span> <span class="main">⊢</span> <span class="skolem">A</span> <span class="keyword1">IMP</span> <span class="free">C</span> <span class="keyword1">IMP</span> <span class="skolem">B</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> exiists
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> imp_imp_commute<span class="main">)</span>
    <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">H</span> <span class="main">-</span> <span class="main">{</span><span class="free">C</span><span class="main">}</span> <span class="main">⊢</span> <span class="main">(</span>exi <span class="skolem">i</span> <span class="skolem">A</span><span class="main">)</span> <span class="keyword1">IMP</span> <span class="free">C</span> <span class="keyword1">IMP</span> <span class="skolem">B</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> exiists
      <span class="keyword1"><span class="command">using</span></span> nprv.eql
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> nprv.exiists<span class="main">)</span>
    <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> imp_imp_commute<span class="main">)</span>
  <span class="keyword1"><span class="command">next</span></span>
    <span class="keyword3"><span class="command">case</span></span> False
    <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">H</span> <span class="main">-</span> <span class="main">{</span><span class="free">C</span><span class="main">}</span> <span class="main">=</span> <span class="skolem">H</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> exiists
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> imp_triv_I nprv.exiists<span class="main">)</span>
  <span class="keyword1"><span class="command">qed</span></span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">theorem</span></span> imp_I <span class="main">[</span><span class="operator">intro</span><span class="main"><span class="main"><span class="main"><span class="main">!</span></span></span></span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"insert <span class="free">A</span> <span class="free">H</span> <span class="main">⊢</span> <span class="free">B</span> <span class="main">⟹</span> <span class="free">H</span> <span class="main">⊢</span> <span class="free">A</span> <span class="keyword1">IMP</span> <span class="free">B</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> Diff_insert_absorb imp_triv_I deduction_Diff insert_absorb<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> anti_deduction<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">H</span> <span class="main">⊢</span> <span class="free">A</span> <span class="keyword1">IMP</span> <span class="free">B</span> <span class="main">⟹</span> insert <span class="free">A</span> <span class="free">H</span> <span class="main">⊢</span> <span class="free">B</span>"</span></span>
   <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> Assume MP_same thin1<span class="main">)</span>

<span class="keyword1"><span class="command">subsection</span></span><span class="quoted"><span class="plain_text">‹Cut rules›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> cut<span class="main">:</span>  <span class="quoted"><span class="quoted">"<span class="free">H</span> <span class="main">⊢</span> <span class="free">A</span> <span class="main">⟹</span> insert <span class="free">A</span> <span class="free">H'</span> <span class="main">⊢</span> <span class="free">B</span> <span class="main">⟹</span> <span class="free">H</span> <span class="main">∪</span> <span class="free">H'</span> <span class="main">⊢</span> <span class="free">B</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> MP Un_commute imp_I<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> cut_same<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">H</span> <span class="main">⊢</span> <span class="free">A</span> <span class="main">⟹</span> insert <span class="free">A</span> <span class="free">H</span> <span class="main">⊢</span> <span class="free">B</span> <span class="main">⟹</span> <span class="free">H</span> <span class="main">⊢</span> <span class="free">B</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> Un_absorb cut<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> cut_thin<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">HA</span> <span class="main">⊢</span> <span class="free">A</span> <span class="main">⟹</span> insert <span class="free">A</span> <span class="free">HB</span> <span class="main">⊢</span> <span class="free">B</span> <span class="main">⟹</span> <span class="free">HA</span> <span class="main">∪</span> <span class="free">HB</span> <span class="main">⊆</span> <span class="free">H</span> <span class="main">⟹</span> <span class="free">H</span> <span class="main">⊢</span> <span class="free">B</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> thin cut<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> cut0<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">{}</span> <span class="main">⊢</span> <span class="free">A</span> <span class="main">⟹</span> insert <span class="free">A</span> <span class="free">H</span> <span class="main">⊢</span> <span class="free">B</span> <span class="main">⟹</span> <span class="free">H</span> <span class="main">⊢</span> <span class="free">B</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> cut_same thin0<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> cut1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">{</span><span class="free">A</span><span class="main">}</span> <span class="main">⊢</span> <span class="free">B</span> <span class="main">⟹</span> <span class="free">H</span> <span class="main">⊢</span> <span class="free">A</span> <span class="main">⟹</span> <span class="free">H</span> <span class="main">⊢</span> <span class="free">B</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> cut sup_bot_right<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> rcut1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">{</span><span class="free">A</span><span class="main">}</span> <span class="main">⊢</span> <span class="free">B</span> <span class="main">⟹</span> insert <span class="free">B</span> <span class="free">H</span> <span class="main">⊢</span> <span class="free">C</span> <span class="main">⟹</span> insert <span class="free">A</span> <span class="free">H</span> <span class="main">⊢</span> <span class="free">C</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> Assume cut1 cut_same rotate2 thin1<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> cut2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">⟦</span><span class="main">{</span><span class="free">A</span><span class="main">,</span><span class="free">B</span><span class="main">}</span> <span class="main">⊢</span> <span class="free">C</span><span class="main">;</span> <span class="free">H</span> <span class="main">⊢</span> <span class="free">A</span><span class="main">;</span> <span class="free">H</span> <span class="main">⊢</span> <span class="free">B</span><span class="main">⟧</span> <span class="main">⟹</span> <span class="free">H</span> <span class="main">⊢</span> <span class="free">C</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> Un_empty_right Un_insert_right cut cut_same<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> rcut2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">{</span><span class="free">A</span><span class="main">,</span><span class="free">B</span><span class="main">}</span> <span class="main">⊢</span> <span class="free">C</span> <span class="main">⟹</span> insert <span class="free">C</span> <span class="free">H</span> <span class="main">⊢</span> <span class="free">D</span> <span class="main">⟹</span> <span class="free">H</span> <span class="main">⊢</span> <span class="free">B</span> <span class="main">⟹</span> insert <span class="free">A</span> <span class="free">H</span> <span class="main">⊢</span> <span class="free">D</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> Assume cut2 cut_same insert_commute thin1<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> cut3<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">⟦</span><span class="main">{</span><span class="free">A</span><span class="main">,</span><span class="free">B</span><span class="main">,</span><span class="free">C</span><span class="main">}</span> <span class="main">⊢</span> <span class="free">D</span><span class="main">;</span> <span class="free">H</span> <span class="main">⊢</span> <span class="free">A</span><span class="main">;</span> <span class="free">H</span> <span class="main">⊢</span> <span class="free">B</span><span class="main">;</span> <span class="free">H</span> <span class="main">⊢</span> <span class="free">C</span><span class="main">⟧</span> <span class="main">⟹</span> <span class="free">H</span> <span class="main">⊢</span> <span class="free">D</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> MP_same cut2 imp_I<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> cut4<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">⟦</span><span class="main">{</span><span class="free">A</span><span class="main">,</span><span class="free">B</span><span class="main">,</span><span class="free">C</span><span class="main">,</span><span class="free">D</span><span class="main">}</span> <span class="main">⊢</span> <span class="free">E</span><span class="main">;</span> <span class="free">H</span> <span class="main">⊢</span> <span class="free">A</span><span class="main">;</span> <span class="free">H</span> <span class="main">⊢</span> <span class="free">B</span><span class="main">;</span> <span class="free">H</span> <span class="main">⊢</span> <span class="free">C</span><span class="main">;</span> <span class="free">H</span> <span class="main">⊢</span> <span class="free">D</span><span class="main">⟧</span> <span class="main">⟹</span> <span class="free">H</span> <span class="main">⊢</span> <span class="free">E</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> MP_same cut3 <span class="main"><span class="main">[</span></span><span class="operator">of</span> <span class="quoted"><span class="free"><span class="quoted"><span class="free"><span class="quoted"><span class="free">B</span></span></span></span></span></span> <span class="quoted"><span class="free"><span class="quoted"><span class="free"><span class="quoted"><span class="free">C</span></span></span></span></span></span> <span class="quoted"><span class="free"><span class="quoted"><span class="free"><span class="quoted"><span class="free">D</span></span></span></span></span></span><span class="main"><span class="main">]</span></span> imp_I<span class="main">)</span>


<span class="keyword1"><span class="command">section</span></span><span class="quoted"><span class="plain_text">‹Miscellaneous Logical Rules›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> dsj_I1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">H</span> <span class="main">⊢</span> <span class="free">A</span> <span class="main">⟹</span> <span class="free">H</span> <span class="main">⊢</span> <span class="free">A</span> <span class="keyword1">OR</span> <span class="free">B</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> Bool MP_same boolean_axioms.dsjI1<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> dsj_I2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">H</span> <span class="main">⊢</span> <span class="free">B</span> <span class="main">⟹</span> <span class="free">H</span> <span class="main">⊢</span> <span class="free">A</span> <span class="keyword1">OR</span> <span class="free">B</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> dsj_commute dsj_I1<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> Peirce<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">H</span> <span class="main">⊢</span> <span class="main">(</span>neg <span class="free">A</span><span class="main">)</span> <span class="keyword1">IMP</span> <span class="free">A</span> <span class="main">⟹</span> <span class="free">H</span> <span class="main">⊢</span> <span class="free">A</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> dsjcnj <span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="quoted">"neg <span class="free">A</span>"</span></span> <span class="quoted"><span class="free">A</span></span> <span class="quoted"><span class="free">A</span></span><span class="main">]</span>  dsjCont <span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="free">A</span></span><span class="main">]</span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> Bool MP_same boolean_axioms.Ident<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> Contra<span class="main">:</span> <span class="quoted"><span class="quoted">"insert <span class="main">(</span>neg <span class="free">A</span><span class="main">)</span> <span class="free">H</span> <span class="main">⊢</span> <span class="free">A</span> <span class="main">⟹</span> <span class="free">H</span> <span class="main">⊢</span> <span class="free">A</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> Peirce imp_I<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> imp_neg_I<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">H</span> <span class="main">⊢</span> <span class="free">A</span> <span class="keyword1">IMP</span> <span class="free">B</span> <span class="main">⟹</span> <span class="free">H</span> <span class="main">⊢</span> <span class="free">A</span> <span class="keyword1">IMP</span> <span class="main">(</span>neg <span class="free">B</span><span class="main">)</span> <span class="main">⟹</span> <span class="free">H</span> <span class="main">⊢</span> neg <span class="free">A</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> dsjcnj <span class="main"><span class="main">[</span></span><span class="operator">of</span> <span class="quoted"><span class="free"><span class="quoted"><span class="free"><span class="quoted"><span class="free">B</span></span></span></span></span></span> <span class="quoted"><span class="quoted"><span class="quoted"><span class="quoted">"neg <span class="free"><span class="free"><span class="free">A</span></span></span>"</span></span></span></span> <span class="quoted"><span class="quoted"><span class="quoted"><span class="quoted">"neg <span class="free"><span class="free"><span class="free">A</span></span></span>"</span></span></span></span><span class="main"><span class="main">]</span></span> dsjCont Bool dsj_commute MP_same<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> negneg_I<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">H</span> <span class="main">⊢</span> <span class="free">A</span> <span class="main">⟹</span> <span class="free">H</span> <span class="main">⊢</span> neg <span class="main">(</span>neg <span class="free">A</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> dsjcnj <span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="quoted">"neg <span class="main">(</span>neg <span class="free">A</span><span class="main">)</span>"</span></span> <span class="quoted"><span class="quoted">"neg <span class="free">A</span>"</span></span> <span class="quoted"><span class="quoted">"neg <span class="main">(</span>neg <span class="free">A</span><span class="main">)</span>"</span></span><span class="main">]</span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> Bool Ident MP_same<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> negneg_D<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">H</span> <span class="main">⊢</span> neg <span class="main">(</span>neg <span class="free">A</span><span class="main">)</span> <span class="main">⟹</span> <span class="free">H</span> <span class="main">⊢</span> <span class="free">A</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> dsj_I1 Peirce<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> neg_D<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">H</span> <span class="main">⊢</span> neg <span class="free">A</span> <span class="main">⟹</span> <span class="free">H</span> <span class="main">⊢</span> <span class="free">A</span> <span class="main">⟹</span> <span class="free">H</span> <span class="main">⊢</span> <span class="free">B</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> imp_neg_I imp_triv_I negneg_D<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> dsj_neg_1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">H</span> <span class="main">⊢</span> <span class="free">A</span> <span class="keyword1">OR</span> <span class="free">B</span> <span class="main">⟹</span> <span class="free">H</span> <span class="main">⊢</span> neg <span class="free">B</span> <span class="main">⟹</span> <span class="free">H</span> <span class="main">⊢</span> <span class="free">A</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> dsj_I1 dsj_Semicong_1 dsj_commute Peirce<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> dsj_neg_2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">H</span> <span class="main">⊢</span> <span class="free">A</span> <span class="keyword1">OR</span> <span class="free">B</span> <span class="main">⟹</span> <span class="free">H</span> <span class="main">⊢</span> neg <span class="free">A</span> <span class="main">⟹</span> <span class="free">H</span> <span class="main">⊢</span> <span class="free">B</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> dsj_neg_1 dsj_commute<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> neg_dsj_I<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">H</span> <span class="main">⊢</span> neg <span class="free">A</span> <span class="main">⟹</span> <span class="free">H</span> <span class="main">⊢</span> neg <span class="free">B</span> <span class="main">⟹</span> <span class="free">H</span> <span class="main">⊢</span> neg <span class="main">(</span><span class="free">A</span> <span class="keyword1">OR</span> <span class="free">B</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> Bool dsj_neg_1 MP_same boolean_axioms.Ident dsjAssoc<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> cnj_I <span class="main">[</span><span class="operator">intro</span><span class="main"><span class="main"><span class="main"><span class="main">!</span></span></span></span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">H</span> <span class="main">⊢</span> <span class="free">A</span> <span class="main">⟹</span> <span class="free">H</span> <span class="main">⊢</span> <span class="free">B</span> <span class="main">⟹</span> <span class="free">H</span> <span class="main">⊢</span> <span class="free">A</span> <span class="keyword1">AND</span> <span class="free">B</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> cnj_def negneg_I neg_dsj_I<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> cnj_E1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">H</span> <span class="main">⊢</span> <span class="free">A</span> <span class="keyword1">AND</span> <span class="free">B</span> <span class="main">⟹</span> <span class="free">H</span> <span class="main">⊢</span> <span class="free">A</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> cnj_def Bool dsj_neg_1 negneg_D boolean_axioms.dsjI1<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> cnj_E2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">H</span> <span class="main">⊢</span> <span class="free">A</span> <span class="keyword1">AND</span> <span class="free">B</span> <span class="main">⟹</span> <span class="free">H</span> <span class="main">⊢</span> <span class="free">B</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> cnj_def Bool dsj_I2 dsj_neg_2 MP_same dsjAssoc Ident<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> cnj_commute<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">H</span> <span class="main">⊢</span> <span class="free">B</span> <span class="keyword1">AND</span> <span class="free">A</span> <span class="main">⟹</span> <span class="free">H</span> <span class="main">⊢</span> <span class="free">A</span> <span class="keyword1">AND</span> <span class="free">B</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> cnj_E1 cnj_E2 cnj_I<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> cnj_E<span class="main">:</span> <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"insert <span class="free">A</span> <span class="main">(</span>insert <span class="free">B</span> <span class="free">H</span><span class="main">)</span> <span class="main">⊢</span> <span class="free">C</span>"</span></span> <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"insert <span class="main">(</span><span class="free">A</span> <span class="keyword1">AND</span> <span class="free">B</span><span class="main">)</span> <span class="free">H</span> <span class="main">⊢</span> <span class="free">C</span>"</span></span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">rule</span> cut_same <span class="main"><span class="main">[</span></span><span class="keyword2"><span class="keyword"><span class="operator">where</span></span></span> A<span class="main"><span class="main"><span class="main">=</span></span></span><span class="quoted"><span class="free"><span class="quoted"><span class="free">A</span></span></span></span><span class="main"><span class="main">]</span></span><span class="main"><span class="keyword3">,</span></span> <span class="operator">metis</span> cnj_E1 Hyp insertI1<span class="main">)</span>
<span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> <span class="main"><span class="main">(</span></span>full_types<span class="main"><span class="main">)</span></span> AssumeH<span class="main"><span class="main">(</span></span>2<span class="main"><span class="main">)</span></span> cnj_E2 assms cut_same <span class="main"><span class="main">[</span></span><span class="keyword2"><span class="keyword"><span class="operator">where</span></span></span> A<span class="main"><span class="main"><span class="main">=</span></span></span><span class="quoted"><span class="free"><span class="quoted"><span class="free"><span class="quoted"><span class="free">B</span></span></span></span></span></span><span class="main"><span class="main">]</span></span> insert_commute thin2<span class="main">)</span>

<span class="keyword1"><span class="command">lemmas</span></span> cnj_EH <span class="main">=</span> cnj_E cnj_E <span class="main">[</span><span class="operator">THEN</span> rotate2<span class="main">]</span> cnj_E <span class="main">[</span><span class="operator">THEN</span> rotate3<span class="main">]</span> cnj_E <span class="main">[</span><span class="operator">THEN</span> rotate4<span class="main">]</span> cnj_E <span class="main">[</span><span class="operator">THEN</span> rotate5<span class="main">]</span>
                 cnj_E <span class="main">[</span><span class="operator">THEN</span> rotate6<span class="main">]</span> cnj_E <span class="main">[</span><span class="operator">THEN</span> rotate7<span class="main">]</span> cnj_E <span class="main">[</span><span class="operator">THEN</span> rotate8<span class="main">]</span> cnj_E <span class="main">[</span><span class="operator">THEN</span> rotate9<span class="main">]</span> cnj_E <span class="main">[</span><span class="operator">THEN</span> rotate10<span class="main">]</span>
<span class="keyword1"><span class="command">declare</span></span> cnj_EH <span class="main">[</span><span class="operator">intro</span><span class="main"><span class="main"><span class="main"><span class="main"><span class="main"><span class="main"><span class="main"><span class="main"><span class="main"><span class="main"><span class="main">!</span></span></span></span></span></span></span></span></span></span></span><span class="main">]</span>

<span class="keyword1"><span class="command">lemma</span></span> neg_I0<span class="main">:</span> <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">⋀</span><span class="bound">B</span><span class="main">.</span> atom <span class="free">i</span> <span class="main">♯</span> <span class="bound">B</span> <span class="main">⟹</span> insert <span class="free">A</span> <span class="free">H</span> <span class="main">⊢</span> <span class="bound">B</span><span class="main">)</span>"</span></span> <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">H</span> <span class="main">⊢</span> neg <span class="free">A</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">meson</span> fls_fresh imp_I imp_neg_I assms fmla.fresh<span class="main"><span class="main">(</span></span>3<span class="main"><span class="main">)</span></span><span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> neg_mono<span class="main">:</span> <span class="quoted"><span class="quoted">"insert <span class="free">A</span> <span class="free">H</span> <span class="main">⊢</span> <span class="free">B</span> <span class="main">⟹</span> insert <span class="main">(</span>neg <span class="free">B</span><span class="main">)</span> <span class="free">H</span> <span class="main">⊢</span> neg <span class="free">A</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> neg_I0<span class="main">)</span> <span class="main">(</span><span class="operator">metis</span> Hyp neg_D insert_commute insertI1 thin1<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> cnj_mono<span class="main">:</span> <span class="quoted"><span class="quoted">"insert <span class="free">A</span> <span class="free">H</span> <span class="main">⊢</span> <span class="free">B</span> <span class="main">⟹</span> insert <span class="free">C</span> <span class="free">H</span> <span class="main">⊢</span> <span class="free">D</span> <span class="main">⟹</span> insert <span class="main">(</span><span class="free">A</span> <span class="keyword1">AND</span> <span class="free">C</span><span class="main">)</span> <span class="free">H</span> <span class="main">⊢</span> <span class="free">B</span> <span class="keyword1">AND</span> <span class="free">D</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> cnj_E1 cnj_E2 cnj_I Hyp Un_absorb2 cut insertI1 subset_insertI<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> dsj_mono<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"insert <span class="free">A</span> <span class="free">H</span> <span class="main">⊢</span> <span class="free">B</span>"</span></span> <span class="quoted"><span class="quoted">"insert <span class="free">C</span> <span class="free">H</span> <span class="main">⊢</span> <span class="free">D</span>"</span></span> <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"insert <span class="main">(</span><span class="free">A</span> <span class="keyword1">OR</span> <span class="free">C</span><span class="main">)</span> <span class="free">H</span> <span class="main">⊢</span> <span class="free">B</span> <span class="keyword1">OR</span> <span class="free">D</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">A</span> <span class="skolem">B</span> <span class="skolem">C</span> <span class="skolem">H</span>
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"insert <span class="main">(</span><span class="skolem">A</span> <span class="keyword1">OR</span> <span class="skolem">C</span><span class="main">)</span> <span class="skolem">H</span> <span class="main">⊢</span> <span class="main">(</span><span class="skolem">A</span> <span class="keyword1">IMP</span> <span class="skolem">B</span><span class="main">)</span> <span class="keyword1">IMP</span> <span class="skolem">C</span> <span class="keyword1">OR</span> <span class="skolem">B</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> Bool Hyp MP_same boolean_axioms.dsjcnj insertI1<span class="main">)</span>
    <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"insert <span class="skolem">A</span> <span class="skolem">H</span> <span class="main">⊢</span> <span class="skolem">B</span> <span class="main">⟹</span> insert <span class="main">(</span><span class="skolem">A</span> <span class="keyword1">OR</span> <span class="skolem">C</span><span class="main">)</span> <span class="skolem">H</span> <span class="main">⊢</span> <span class="skolem">C</span> <span class="keyword1">OR</span> <span class="skolem">B</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> MP_same Un_absorb Un_insert_right imp_I thin_Un<span class="main">)</span>
  <span class="keyword1"><span class="command">}</span></span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> cut_same assms thin2<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">lemma</span></span> dsj_E<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> A<span class="main">:</span> <span class="quoted"><span class="quoted">"insert <span class="free">A</span> <span class="free">H</span> <span class="main">⊢</span> <span class="free">C</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> B<span class="main">:</span> <span class="quoted"><span class="quoted">"insert <span class="free">B</span> <span class="free">H</span> <span class="main">⊢</span> <span class="free">C</span>"</span></span> <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"insert <span class="main">(</span><span class="free">A</span> <span class="keyword1">OR</span> <span class="free">B</span><span class="main">)</span> <span class="free">H</span> <span class="main">⊢</span> <span class="free">C</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> A B dsj_mono negneg_I Peirce<span class="main">)</span>

<span class="keyword1"><span class="command">lemmas</span></span> dsj_EH <span class="main">=</span> dsj_E dsj_E <span class="main">[</span><span class="operator">THEN</span> rotate2<span class="main">]</span> dsj_E <span class="main">[</span><span class="operator">THEN</span> rotate3<span class="main">]</span> dsj_E <span class="main">[</span><span class="operator">THEN</span> rotate4<span class="main">]</span> dsj_E <span class="main">[</span><span class="operator">THEN</span> rotate5<span class="main">]</span>
                 dsj_E <span class="main">[</span><span class="operator">THEN</span> rotate6<span class="main">]</span> dsj_E <span class="main">[</span><span class="operator">THEN</span> rotate7<span class="main">]</span> dsj_E <span class="main">[</span><span class="operator">THEN</span> rotate8<span class="main">]</span> dsj_E <span class="main">[</span><span class="operator">THEN</span> rotate9<span class="main">]</span> dsj_E <span class="main">[</span><span class="operator">THEN</span> rotate10<span class="main">]</span>
<span class="keyword1"><span class="command">declare</span></span> dsj_EH <span class="main">[</span><span class="operator">intro</span><span class="main"><span class="main"><span class="main"><span class="main"><span class="main"><span class="main"><span class="main"><span class="main"><span class="main"><span class="main"><span class="main">!</span></span></span></span></span></span></span></span></span></span></span><span class="main">]</span>

<span class="keyword1"><span class="command">lemma</span></span> Contra'<span class="main">:</span> <span class="quoted"><span class="quoted">"insert <span class="free">A</span> <span class="free">H</span> <span class="main">⊢</span> neg <span class="free">A</span> <span class="main">⟹</span> <span class="free">H</span> <span class="main">⊢</span> neg <span class="free">A</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> Contra neg_mono<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> negneg_E <span class="main">[</span><span class="operator">intro</span><span class="main"><span class="main"><span class="main"><span class="main">!</span></span></span></span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"insert <span class="free">A</span> <span class="free">H</span> <span class="main">⊢</span> <span class="free">B</span> <span class="main">⟹</span> insert <span class="main">(</span>neg <span class="main">(</span>neg <span class="free">A</span><span class="main">)</span><span class="main">)</span> <span class="free">H</span> <span class="main">⊢</span> <span class="free">B</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> negneg_D neg_mono<span class="main">)</span>

<span class="keyword1"><span class="command">declare</span></span> negneg_E <span class="main">[</span><span class="operator">THEN</span> rotate2<span class="main">,</span> <span class="operator">intro</span><span class="main"><span class="main">!</span></span><span class="main">]</span>
<span class="keyword1"><span class="command">declare</span></span> negneg_E <span class="main">[</span><span class="operator">THEN</span> rotate3<span class="main">,</span> <span class="operator">intro</span><span class="main"><span class="main">!</span></span><span class="main">]</span>
<span class="keyword1"><span class="command">declare</span></span> negneg_E <span class="main">[</span><span class="operator">THEN</span> rotate4<span class="main">,</span> <span class="operator">intro</span><span class="main"><span class="main">!</span></span><span class="main">]</span>
<span class="keyword1"><span class="command">declare</span></span> negneg_E <span class="main">[</span><span class="operator">THEN</span> rotate5<span class="main">,</span> <span class="operator">intro</span><span class="main"><span class="main">!</span></span><span class="main">]</span>
<span class="keyword1"><span class="command">declare</span></span> negneg_E <span class="main">[</span><span class="operator">THEN</span> rotate6<span class="main">,</span> <span class="operator">intro</span><span class="main"><span class="main">!</span></span><span class="main">]</span>
<span class="keyword1"><span class="command">declare</span></span> negneg_E <span class="main">[</span><span class="operator">THEN</span> rotate7<span class="main">,</span> <span class="operator">intro</span><span class="main"><span class="main">!</span></span><span class="main">]</span>
<span class="keyword1"><span class="command">declare</span></span> negneg_E <span class="main">[</span><span class="operator">THEN</span> rotate8<span class="main">,</span> <span class="operator">intro</span><span class="main"><span class="main">!</span></span><span class="main">]</span>

<span class="keyword1"><span class="command">lemma</span></span> imp_E<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> A<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">H</span> <span class="main">⊢</span> <span class="free">A</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> B<span class="main">:</span> <span class="quoted"><span class="quoted">"insert <span class="free">B</span> <span class="free">H</span> <span class="main">⊢</span> <span class="free">C</span>"</span></span> <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"insert <span class="main">(</span><span class="free">A</span> <span class="keyword1">IMP</span> <span class="free">B</span><span class="main">)</span> <span class="free">H</span> <span class="main">⊢</span> <span class="free">C</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"insert <span class="main">(</span><span class="free">A</span> <span class="keyword1">IMP</span> <span class="free">B</span><span class="main">)</span> <span class="free">H</span> <span class="main">⊢</span> <span class="free">B</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> Hyp A thin1 MP_same insertI1<span class="main">)</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> cut <span class="main"><span class="main">[</span></span><span class="keyword2"><span class="keyword"><span class="operator">where</span></span></span> B<span class="main"><span class="main"><span class="main">=</span></span></span><span class="quoted"><span class="free"><span class="quoted"><span class="free"><span class="quoted"><span class="free">C</span></span></span></span></span></span><span class="main"><span class="main">]</span></span> Un_insert_right sup_commute sup_idem B<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">lemma</span></span> imp_cut<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"insert <span class="free">C</span> <span class="free">H</span> <span class="main">⊢</span> <span class="free">A</span> <span class="keyword1">IMP</span> <span class="free">B</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="main">{</span><span class="free">A</span><span class="main">}</span> <span class="main">⊢</span> <span class="free">C</span>"</span></span>
    <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">H</span> <span class="main">⊢</span> <span class="free">A</span> <span class="keyword1">IMP</span> <span class="free">B</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> Contra dsj_I1 neg_mono assms rcut1<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> Iff_I <span class="main">[</span><span class="operator">intro</span><span class="main"><span class="main"><span class="main"><span class="main">!</span></span></span></span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"insert <span class="free">A</span> <span class="free">H</span> <span class="main">⊢</span> <span class="free">B</span> <span class="main">⟹</span> insert <span class="free">B</span> <span class="free">H</span> <span class="main">⊢</span> <span class="free">A</span> <span class="main">⟹</span> <span class="free">H</span> <span class="main">⊢</span> <span class="free">A</span> <span class="keyword1">IFF</span> <span class="free">B</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> Iff_def cnj_I imp_I<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> Iff_MP_same<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">H</span> <span class="main">⊢</span> <span class="free">A</span> <span class="keyword1">IFF</span> <span class="free">B</span> <span class="main">⟹</span> <span class="free">H</span> <span class="main">⊢</span> <span class="free">A</span> <span class="main">⟹</span> <span class="free">H</span> <span class="main">⊢</span> <span class="free">B</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> Iff_def cnj_E1 MP_same<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> Iff_MP2_same<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">H</span> <span class="main">⊢</span> <span class="free">A</span> <span class="keyword1">IFF</span> <span class="free">B</span> <span class="main">⟹</span> <span class="free">H</span> <span class="main">⊢</span> <span class="free">B</span> <span class="main">⟹</span> <span class="free">H</span> <span class="main">⊢</span> <span class="free">A</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> Iff_def cnj_E2 MP_same<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> Iff_refl <span class="main">[</span><span class="operator">intro</span><span class="main"><span class="main"><span class="main"><span class="main">!</span></span></span></span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">H</span> <span class="main">⊢</span> <span class="free">A</span> <span class="keyword1">IFF</span> <span class="free">A</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> Hyp Iff_I insertI1<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> Iff_sym<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">H</span> <span class="main">⊢</span> <span class="free">A</span> <span class="keyword1">IFF</span> <span class="free">B</span> <span class="main">⟹</span> <span class="free">H</span> <span class="main">⊢</span> <span class="free">B</span> <span class="keyword1">IFF</span> <span class="free">A</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> Iff_def cnj_commute<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> Iff_trans<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">H</span> <span class="main">⊢</span> <span class="free">A</span> <span class="keyword1">IFF</span> <span class="free">B</span> <span class="main">⟹</span> <span class="free">H</span> <span class="main">⊢</span> <span class="free">B</span> <span class="keyword1">IFF</span> <span class="free">C</span> <span class="main">⟹</span> <span class="free">H</span> <span class="main">⊢</span> <span class="free">A</span> <span class="keyword1">IFF</span> <span class="free">C</span>"</span></span>
  <span class="keyword1"><span class="command">unfolding</span></span> Iff_def
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> cnj_E1 cnj_E2 cnj_I dsj_Semicong_1 dsj_commute<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> Iff_E<span class="main">:</span>
  <span class="quoted"><span class="quoted">"insert <span class="free">A</span> <span class="main">(</span>insert <span class="free">B</span> <span class="free">H</span><span class="main">)</span> <span class="main">⊢</span> <span class="free">C</span> <span class="main">⟹</span> insert <span class="main">(</span>neg <span class="free">A</span><span class="main">)</span> <span class="main">(</span>insert <span class="main">(</span>neg <span class="free">B</span><span class="main">)</span> <span class="free">H</span><span class="main">)</span> <span class="main">⊢</span> <span class="free">C</span> <span class="main">⟹</span> insert <span class="main">(</span><span class="free">A</span> <span class="keyword1">IFF</span> <span class="free">B</span><span class="main">)</span> <span class="free">H</span> <span class="main">⊢</span> <span class="free">C</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> Assume Iff_def anti_deduction cnj_E dsj_EH<span class="main"><span class="main">(</span></span>2<span class="main"><span class="main">)</span></span> dsj_I1 insert_commute<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> Iff_E1<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> A<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">H</span> <span class="main">⊢</span> <span class="free">A</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> B<span class="main">:</span> <span class="quoted"><span class="quoted">"insert <span class="free">B</span> <span class="free">H</span> <span class="main">⊢</span> <span class="free">C</span>"</span></span> <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"insert <span class="main">(</span><span class="free">A</span> <span class="keyword1">IFF</span> <span class="free">B</span><span class="main">)</span> <span class="free">H</span> <span class="main">⊢</span> <span class="free">C</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> Iff_def A B cnj_E imp_E insert_commute thin1<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> Iff_E2<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> A<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">H</span> <span class="main">⊢</span> <span class="free">A</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> B<span class="main">:</span> <span class="quoted"><span class="quoted">"insert <span class="free">B</span> <span class="free">H</span> <span class="main">⊢</span> <span class="free">C</span>"</span></span> <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"insert <span class="main">(</span><span class="free">B</span> <span class="keyword1">IFF</span> <span class="free">A</span><span class="main">)</span> <span class="free">H</span> <span class="main">⊢</span> <span class="free">C</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> Iff_def A B Bool cnj_E2 cnj_mono imp_E boolean_axioms.Ident<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> Iff_MP_left<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">H</span> <span class="main">⊢</span> <span class="free">A</span> <span class="keyword1">IFF</span> <span class="free">B</span> <span class="main">⟹</span> insert <span class="free">A</span> <span class="free">H</span> <span class="main">⊢</span> <span class="free">C</span> <span class="main">⟹</span> insert <span class="free">B</span> <span class="free">H</span> <span class="main">⊢</span> <span class="free">C</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> Hyp Iff_E2 cut_same insertI1 insert_commute thin1<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> Iff_MP_left'<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">H</span> <span class="main">⊢</span> <span class="free">A</span> <span class="keyword1">IFF</span> <span class="free">B</span> <span class="main">⟹</span> insert <span class="free">B</span> <span class="free">H</span> <span class="main">⊢</span> <span class="free">C</span> <span class="main">⟹</span> insert <span class="free">A</span> <span class="free">H</span> <span class="main">⊢</span> <span class="free">C</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> Iff_MP_left Iff_sym<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> Swap<span class="main">:</span> <span class="quoted"><span class="quoted">"insert <span class="main">(</span>neg <span class="free">B</span><span class="main">)</span> <span class="free">H</span> <span class="main">⊢</span> <span class="free">A</span> <span class="main">⟹</span> insert <span class="main">(</span>neg <span class="free">A</span><span class="main">)</span> <span class="free">H</span> <span class="main">⊢</span> <span class="free">B</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> negneg_D neg_mono<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> Cases<span class="main">:</span> <span class="quoted"><span class="quoted">"insert <span class="free">A</span> <span class="free">H</span> <span class="main">⊢</span> <span class="free">B</span> <span class="main">⟹</span> insert <span class="main">(</span>neg <span class="free">A</span><span class="main">)</span> <span class="free">H</span> <span class="main">⊢</span> <span class="free">B</span> <span class="main">⟹</span> <span class="free">H</span> <span class="main">⊢</span> <span class="free">B</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> Contra neg_D neg_mono<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> neg_cnj_E<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">H</span> <span class="main">⊢</span> <span class="free">B</span> <span class="main">⟹</span> insert <span class="main">(</span>neg <span class="free">A</span><span class="main">)</span> <span class="free">H</span> <span class="main">⊢</span> <span class="free">C</span> <span class="main">⟹</span> insert <span class="main">(</span>neg <span class="main">(</span><span class="free">A</span> <span class="keyword1">AND</span> <span class="free">B</span><span class="main">)</span><span class="main">)</span> <span class="free">H</span> <span class="main">⊢</span> <span class="free">C</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> cnj_I Swap thin1<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> dsj_CI<span class="main">:</span> <span class="quoted"><span class="quoted">"insert <span class="main">(</span>neg <span class="free">B</span><span class="main">)</span> <span class="free">H</span> <span class="main">⊢</span> <span class="free">A</span> <span class="main">⟹</span> <span class="free">H</span> <span class="main">⊢</span> <span class="free">A</span> <span class="keyword1">OR</span> <span class="free">B</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> Contra dsj_I1 dsj_I2 Swap<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> dsj_3I<span class="main">:</span> <span class="quoted"><span class="quoted">"insert <span class="main">(</span>neg <span class="free">A</span><span class="main">)</span> <span class="main">(</span>insert <span class="main">(</span>neg <span class="free">C</span><span class="main">)</span> <span class="free">H</span><span class="main">)</span> <span class="main">⊢</span> <span class="free">B</span> <span class="main">⟹</span> <span class="free">H</span> <span class="main">⊢</span> <span class="free">A</span> <span class="keyword1">OR</span> <span class="free">B</span> <span class="keyword1">OR</span> <span class="free">C</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> dsj_CI dsj_commute insert_commute<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> Contrapos1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">H</span> <span class="main">⊢</span> <span class="free">A</span> <span class="keyword1">IMP</span> <span class="free">B</span> <span class="main">⟹</span> <span class="free">H</span> <span class="main">⊢</span> neg <span class="free">B</span> <span class="keyword1">IMP</span> neg <span class="free">A</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> Bool MP_same boolean_axioms.dsjcnj boolean_axioms.Ident<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> Contrapos2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">H</span> <span class="main">⊢</span> <span class="main">(</span>neg <span class="free">B</span><span class="main">)</span> <span class="keyword1">IMP</span> <span class="main">(</span>neg <span class="free">A</span><span class="main">)</span> <span class="main">⟹</span> <span class="free">H</span> <span class="main">⊢</span> <span class="free">A</span> <span class="keyword1">IMP</span> <span class="free">B</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> Bool MP_same boolean_axioms.dsjcnj boolean_axioms.Ident<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> ContraAssumeN <span class="main">[</span><span class="operator">intro</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">B</span> <span class="main">∈</span> <span class="free">H</span> <span class="main">⟹</span> insert <span class="main">(</span>neg <span class="free">B</span><span class="main">)</span> <span class="free">H</span> <span class="main">⊢</span> <span class="free">A</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> Hyp Swap thin1<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> ContraAssume<span class="main">:</span> <span class="quoted"><span class="quoted">"neg <span class="free">B</span> <span class="main">∈</span> <span class="free">H</span> <span class="main">⟹</span> insert <span class="free">B</span> <span class="free">H</span> <span class="main">⊢</span> <span class="free">A</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> dsj_I1 Hyp anti_deduction<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> ContraProve<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">H</span> <span class="main">⊢</span> <span class="free">B</span> <span class="main">⟹</span> insert <span class="main">(</span>neg <span class="free">B</span><span class="main">)</span> <span class="free">H</span> <span class="main">⊢</span> <span class="free">A</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> Swap thin1<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> dsj_IE1<span class="main">:</span> <span class="quoted"><span class="quoted">"insert <span class="free">B</span> <span class="free">H</span> <span class="main">⊢</span> <span class="free">C</span> <span class="main">⟹</span> insert <span class="main">(</span><span class="free">A</span> <span class="keyword1">OR</span> <span class="free">B</span><span class="main">)</span> <span class="free">H</span> <span class="main">⊢</span> <span class="free">A</span> <span class="keyword1">OR</span> <span class="free">C</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> Assume dsj_mono<span class="main">)</span>

<span class="keyword1"><span class="command">lemmas</span></span> dsj_IE1H <span class="main">=</span> dsj_IE1 dsj_IE1 <span class="main">[</span><span class="operator">THEN</span> rotate2<span class="main">]</span> dsj_IE1 <span class="main">[</span><span class="operator">THEN</span> rotate3<span class="main">]</span> dsj_IE1 <span class="main">[</span><span class="operator">THEN</span> rotate4<span class="main">]</span> dsj_IE1 <span class="main">[</span><span class="operator">THEN</span> rotate5<span class="main">]</span>
                 dsj_IE1 <span class="main">[</span><span class="operator">THEN</span> rotate6<span class="main">]</span> dsj_IE1 <span class="main">[</span><span class="operator">THEN</span> rotate7<span class="main">]</span> dsj_IE1 <span class="main">[</span><span class="operator">THEN</span> rotate8<span class="main">]</span>
<span class="keyword1"><span class="command">declare</span></span> dsj_IE1H <span class="main">[</span><span class="operator">intro</span><span class="main"><span class="main"><span class="main"><span class="main"><span class="main"><span class="main"><span class="main"><span class="main"><span class="main">!</span></span></span></span></span></span></span></span></span><span class="main">]</span>

<span class="keyword1"><span class="command">subsection</span></span><span class="quoted"><span class="plain_text">‹Quantifier reasoning›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> exi_I<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">H</span> <span class="main">⊢</span> <span class="free">A</span><span class="main">(</span><span class="free">i</span><span class="main">::=</span><span class="free">x</span><span class="main">)</span> <span class="main">⟹</span> <span class="free">H</span> <span class="main">⊢</span> exi <span class="free">i</span> <span class="free">A</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> MP_same Spec special_axioms.intros<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> exi_E<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"insert <span class="free">A</span> <span class="free">H</span> <span class="main">⊢</span> <span class="free">B</span>"</span></span> <span class="quoted"><span class="quoted">"atom <span class="free">i</span> <span class="main">♯</span> <span class="free">B</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">C</span> <span class="main">∈</span> <span class="free">H</span><span class="main">.</span> atom <span class="free">i</span> <span class="main">♯</span> <span class="bound">C</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"insert <span class="main">(</span>exi <span class="free">i</span> <span class="free">A</span><span class="main">)</span> <span class="free">H</span> <span class="main">⊢</span> <span class="free">B</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> exiists imp_I anti_deduction assms<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> exi_E_with_renaming<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"insert <span class="main">(</span><span class="main">(</span><span class="free">i</span> <span class="main">↔</span> <span class="free">i'</span><span class="main">)</span> <span class="main">∙</span> <span class="free">A</span><span class="main">)</span> <span class="free">H</span> <span class="main">⊢</span> <span class="free">B</span>"</span></span> <span class="quoted"><span class="quoted">"atom <span class="free">i'</span> <span class="main">♯</span> <span class="main">(</span><span class="free">A</span><span class="main">,</span><span class="free">i</span><span class="main">,</span><span class="free">B</span><span class="main">)</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">C</span> <span class="main">∈</span> <span class="free">H</span><span class="main">.</span> atom <span class="free">i'</span> <span class="main">♯</span> <span class="bound">C</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"insert <span class="main">(</span>exi <span class="free">i</span> <span class="free">A</span><span class="main">)</span> <span class="free">H</span> <span class="main">⊢</span> <span class="free">B</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"exi <span class="free">i</span> <span class="free">A</span> <span class="main">=</span> exi <span class="free">i'</span> <span class="main">(</span><span class="main">(</span><span class="free">i</span> <span class="main">↔</span> <span class="free">i'</span><span class="main">)</span> <span class="main">∙</span> <span class="free">A</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">using</span></span> flip_subst_fmla <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> exi_E assms fresh_Pair<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">lemmas</span></span> exi_EH <span class="main">=</span> exi_E exi_E <span class="main">[</span><span class="operator">THEN</span> rotate2<span class="main">]</span> exi_E <span class="main">[</span><span class="operator">THEN</span> rotate3<span class="main">]</span> exi_E <span class="main">[</span><span class="operator">THEN</span> rotate4<span class="main">]</span> exi_E <span class="main">[</span><span class="operator">THEN</span> rotate5<span class="main">]</span>
                 exi_E <span class="main">[</span><span class="operator">THEN</span> rotate6<span class="main">]</span> exi_E <span class="main">[</span><span class="operator">THEN</span> rotate7<span class="main">]</span> exi_E <span class="main">[</span><span class="operator">THEN</span> rotate8<span class="main">]</span> exi_E <span class="main">[</span><span class="operator">THEN</span> rotate9<span class="main">]</span> exi_E <span class="main">[</span><span class="operator">THEN</span> rotate10<span class="main">]</span>
<span class="keyword1"><span class="command">declare</span></span> exi_EH <span class="main">[</span><span class="operator">intro</span><span class="main"><span class="main"><span class="main"><span class="main"><span class="main"><span class="main"><span class="main"><span class="main"><span class="main"><span class="main"><span class="main">!</span></span></span></span></span></span></span></span></span></span></span><span class="main">]</span>

<span class="keyword1"><span class="command">lemma</span></span> exi_mono<span class="main">:</span> <span class="quoted"><span class="quoted">"insert <span class="free">A</span> <span class="free">H</span> <span class="main">⊢</span> <span class="free">B</span> <span class="main">⟹</span> <span class="main">∀</span><span class="bound">C</span> <span class="main">∈</span> <span class="free">H</span><span class="main">.</span> atom <span class="free">i</span> <span class="main">♯</span> <span class="bound">C</span> <span class="main">⟹</span> insert <span class="main">(</span>exi <span class="free">i</span> <span class="free">A</span><span class="main">)</span> <span class="free">H</span> <span class="main">⊢</span> <span class="main">(</span>exi <span class="free">i</span> <span class="free">B</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> <span class="quasi_keyword">intro</span><span class="main"><span class="main">:</span></span> exi_I <span class="main"><span class="main">[</span></span><span class="keyword2"><span class="keyword"><span class="operator">where</span></span></span> x<span class="main"><span class="main"><span class="main">=</span></span></span><span class="quoted"><span class="quoted">"Var <span class="free">i</span>"</span></span><span class="main"><span class="main">]</span></span><span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> all_I <span class="main">[</span><span class="operator">intro</span><span class="main"><span class="main"><span class="main"><span class="main">!</span></span></span></span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">H</span> <span class="main">⊢</span> <span class="free">A</span> <span class="main">⟹</span> <span class="main">∀</span><span class="bound">C</span> <span class="main">∈</span> <span class="free">H</span><span class="main">.</span> atom <span class="free">i</span> <span class="main">♯</span> <span class="bound">C</span> <span class="main">⟹</span> <span class="free">H</span> <span class="main">⊢</span> all <span class="free">i</span> <span class="free">A</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">intro</span><span class="main"><span class="main">:</span></span> ContraProve neg_I0<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> all_D<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">H</span> <span class="main">⊢</span> all <span class="free">i</span> <span class="free">A</span> <span class="main">⟹</span> <span class="free">H</span> <span class="main">⊢</span> <span class="free">A</span><span class="main">(</span><span class="free">i</span><span class="main">::=</span><span class="free">x</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> Assume exi_I negneg_D neg_mono neg cut_same<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> all_E<span class="main">:</span> <span class="quoted"><span class="quoted">"insert <span class="main">(</span><span class="free">A</span><span class="main">(</span><span class="free">i</span><span class="main">::=</span><span class="free">x</span><span class="main">)</span><span class="main">)</span> <span class="free">H</span> <span class="main">⊢</span> <span class="free">B</span> <span class="main">⟹</span> insert <span class="main">(</span>all <span class="free">i</span> <span class="free">A</span><span class="main">)</span> <span class="free">H</span> <span class="main">⊢</span> <span class="free">B</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> exi_I negneg_D neg_mono neg<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> all_E'<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">H</span> <span class="main">⊢</span> all <span class="free">i</span> <span class="free">A</span> <span class="main">⟹</span> insert <span class="main">(</span><span class="free">A</span><span class="main">(</span><span class="free">i</span><span class="main">::=</span><span class="free">x</span><span class="main">)</span><span class="main">)</span> <span class="free">H</span> <span class="main">⊢</span> <span class="free">B</span> <span class="main">⟹</span> <span class="free">H</span> <span class="main">⊢</span> <span class="free">B</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> all_D cut_same<span class="main">)</span>

<span class="keyword1"><span class="command">subsection</span></span><span class="quoted"><span class="plain_text">‹Congruence rules›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> neg_cong<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">H</span> <span class="main">⊢</span> <span class="free">A</span> <span class="keyword1">IFF</span> <span class="free">A'</span> <span class="main">⟹</span> <span class="free">H</span> <span class="main">⊢</span> neg <span class="free">A</span> <span class="keyword1">IFF</span> neg <span class="free">A'</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> Iff_def cnj_E1 cnj_E2 cnj_I Contrapos1<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> dsj_cong<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">H</span> <span class="main">⊢</span> <span class="free">A</span> <span class="keyword1">IFF</span> <span class="free">A'</span> <span class="main">⟹</span> <span class="free">H</span> <span class="main">⊢</span> <span class="free">B</span> <span class="keyword1">IFF</span> <span class="free">B'</span> <span class="main">⟹</span> <span class="free">H</span> <span class="main">⊢</span> <span class="free">A</span> <span class="keyword1">OR</span> <span class="free">B</span> <span class="keyword1">IFF</span> <span class="free">A'</span> <span class="keyword1">OR</span> <span class="free">B'</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> cnj_E1 cnj_E2 dsj_mono Iff_I Iff_def anti_deduction<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> cnj_cong<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">H</span> <span class="main">⊢</span> <span class="free">A</span> <span class="keyword1">IFF</span> <span class="free">A'</span> <span class="main">⟹</span> <span class="free">H</span> <span class="main">⊢</span> <span class="free">B</span> <span class="keyword1">IFF</span> <span class="free">B'</span> <span class="main">⟹</span> <span class="free">H</span> <span class="main">⊢</span> <span class="free">A</span> <span class="keyword1">AND</span> <span class="free">B</span> <span class="keyword1">IFF</span> <span class="free">A'</span> <span class="keyword1">AND</span> <span class="free">B'</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> cnj_def dsj_cong neg_cong<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> imp_cong<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">H</span> <span class="main">⊢</span> <span class="free">A</span> <span class="keyword1">IFF</span> <span class="free">A'</span> <span class="main">⟹</span> <span class="free">H</span> <span class="main">⊢</span> <span class="free">B</span> <span class="keyword1">IFF</span> <span class="free">B'</span> <span class="main">⟹</span> <span class="free">H</span> <span class="main">⊢</span> <span class="main">(</span><span class="free">A</span> <span class="keyword1">IMP</span> <span class="free">B</span><span class="main">)</span> <span class="keyword1">IFF</span> <span class="main">(</span><span class="free">A'</span> <span class="keyword1">IMP</span> <span class="free">B'</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> dsj_cong neg_cong<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> Iff_cong<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">H</span> <span class="main">⊢</span> <span class="free">A</span> <span class="keyword1">IFF</span> <span class="free">A'</span> <span class="main">⟹</span> <span class="free">H</span> <span class="main">⊢</span> <span class="free">B</span> <span class="keyword1">IFF</span> <span class="free">B'</span> <span class="main">⟹</span> <span class="free">H</span> <span class="main">⊢</span> <span class="main">(</span><span class="free">A</span> <span class="keyword1">IFF</span> <span class="free">B</span><span class="main">)</span> <span class="keyword1">IFF</span> <span class="main">(</span><span class="free">A'</span> <span class="keyword1">IFF</span> <span class="free">B'</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> Iff_def cnj_cong imp_cong<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> exi_cong<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">H</span> <span class="main">⊢</span> <span class="free">A</span> <span class="keyword1">IFF</span> <span class="free">A'</span> <span class="main">⟹</span> <span class="main">∀</span><span class="bound">C</span> <span class="main">∈</span> <span class="free">H</span><span class="main">.</span> atom <span class="free">i</span> <span class="main">♯</span> <span class="bound">C</span> <span class="main">⟹</span> <span class="free">H</span> <span class="main">⊢</span> <span class="main">(</span>exi <span class="free">i</span> <span class="free">A</span><span class="main">)</span> <span class="keyword1">IFF</span> <span class="main">(</span>exi <span class="free">i</span> <span class="free">A'</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">rule</span> Iff_I<span class="main">)</span>
   <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">metis</span> exi_mono Hyp Iff_MP_same Un_absorb Un_insert_right insertI1 thin_Un<span class="main">)</span>
  <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">metis</span> exi_mono Hyp Iff_MP2_same Un_absorb Un_insert_right insertI1 thin_Un<span class="main">)</span>
  <span class="keyword1"><span class="command"><span class="improper"><span class="command">done</span></span></span></span>

<span class="keyword1"><span class="command">lemma</span></span> all_cong<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">H</span> <span class="main">⊢</span> <span class="free">A</span> <span class="keyword1">IFF</span> <span class="free">A'</span> <span class="main">⟹</span> <span class="main">∀</span><span class="bound">C</span> <span class="main">∈</span> <span class="free">H</span><span class="main">.</span> atom <span class="free">i</span> <span class="main">♯</span> <span class="bound">C</span> <span class="main">⟹</span> <span class="free">H</span> <span class="main">⊢</span> <span class="main">(</span>all <span class="free">i</span> <span class="free">A</span><span class="main">)</span> <span class="keyword1">IFF</span> <span class="main">(</span>all <span class="free">i</span> <span class="free">A'</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> exi_cong neg_cong<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> Subst<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">H</span> <span class="main">⊢</span> <span class="free">A</span> <span class="main">⟹</span> <span class="main">∀</span><span class="bound">B</span> <span class="main">∈</span> <span class="free">H</span><span class="main">.</span> atom <span class="free">i</span> <span class="main">♯</span> <span class="bound">B</span> <span class="main">⟹</span> <span class="free">H</span> <span class="main">⊢</span> <span class="free">A</span> <span class="main">(</span><span class="free">i</span><span class="main">::=</span><span class="free">x</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> all_D all_I<span class="main">)</span>


<span class="keyword1"><span class="command">section</span></span><span class="quoted"><span class="plain_text">‹Eqluality Reasoning›</span></span>

<span class="keyword1"><span class="command">subsection</span></span><span class="quoted"><span class="plain_text">‹The congruence property for <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">term</span></span> <span class="quoted"><span class="quoted">eql</span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span>, and other basic properties of equality›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> eql_cong1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">{}</span> <span class="main">⊢</span> <span class="main">(</span><span class="free">t</span> <span class="keyword1">EQ</span> <span class="free">t'</span> <span class="keyword1">AND</span> <span class="free">u</span> <span class="keyword1">EQ</span> <span class="free">u'</span><span class="main">)</span> <span class="keyword1">IMP</span> <span class="main">(</span><span class="free">t</span> <span class="keyword1">EQ</span> <span class="free">u</span> <span class="keyword1">IMP</span> <span class="free">t'</span> <span class="keyword1">EQ</span> <span class="free">u'</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">v2</span></span><span class="main">::</span><span class="quoted">name</span> <span class="keyword2"><span class="keyword">and</span></span> <span class="skolem"><span class="skolem">v3</span></span><span class="main">::</span><span class="quoted">name</span> <span class="keyword2"><span class="keyword">and</span></span> <span class="skolem"><span class="skolem">v4</span></span><span class="main">::</span><span class="quoted">name</span>
    <span class="keyword2"><span class="keyword">where</span></span> v2<span class="main">:</span> <span class="quoted"><span class="quoted">"atom <span class="skolem">v2</span> <span class="main">♯</span> <span class="main">(</span><span class="free">t</span><span class="main">,</span>X1<span class="main">,</span>X3<span class="main">,</span>X4<span class="main">)</span>"</span></span>
      <span class="keyword2"><span class="keyword">and</span></span> v3<span class="main">:</span> <span class="quoted"><span class="quoted">"atom <span class="skolem">v3</span> <span class="main">♯</span> <span class="main">(</span><span class="free">t</span><span class="main">,</span><span class="free">t'</span><span class="main">,</span>X1<span class="main">,</span><span class="skolem">v2</span><span class="main">,</span>X4<span class="main">)</span>"</span></span>
      <span class="keyword2"><span class="keyword">and</span></span> v4<span class="main">:</span> <span class="quoted"><span class="quoted">"atom <span class="skolem">v4</span> <span class="main">♯</span> <span class="main">(</span><span class="free">t</span><span class="main">,</span><span class="free">t'</span><span class="main">,</span><span class="free">u</span><span class="main">,</span>X1<span class="main">,</span><span class="skolem">v2</span><span class="main">,</span><span class="skolem">v3</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> obtain_fresh<span class="main">)</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">{}</span> <span class="main">⊢</span> <span class="main">(</span>Var X1 <span class="keyword1">EQ</span> Var X2 <span class="keyword1">AND</span> Var X3 <span class="keyword1">EQ</span> Var X4<span class="main">)</span> <span class="keyword1">IMP</span> <span class="main">(</span>Var X1 <span class="keyword1">EQ</span> Var X3 <span class="keyword1">IMP</span> Var X2 <span class="keyword1">EQ</span> Var X4<span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> eql<span class="main">)</span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> eq_cong_ax_def equality_axioms_def<span class="main">)</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="main">{}</span> <span class="main">⊢</span> <span class="main">(</span>Var X1 <span class="keyword1">EQ</span> Var X2 <span class="keyword1">AND</span> Var X3 <span class="keyword1">EQ</span> Var X4<span class="main">)</span> <span class="keyword1">IMP</span> <span class="main">(</span>Var X1 <span class="keyword1">EQ</span> Var X3 <span class="keyword1">IMP</span> Var X2 <span class="keyword1">EQ</span> Var X4<span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">drule_tac</span> i<span class="main"><span class="main">=</span></span><span class="quoted">X1</span> <span class="keyword2"><span class="keyword"><span class="quasi_keyword">and</span></span></span> x<span class="main"><span class="main">=</span></span><span class="quoted"><span class="quoted">"Var X1"</span></span> <span class="keyword2"><span class="keyword"><span class="quasi_keyword">in</span></span></span> Subst<span class="main">)</span> <span class="operator">simp_all</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="main">{}</span> <span class="main">⊢</span> <span class="main">(</span>Var X1 <span class="keyword1">EQ</span> Var <span class="skolem">v2</span> <span class="keyword1">AND</span> Var X3 <span class="keyword1">EQ</span> Var X4<span class="main">)</span> <span class="keyword1">IMP</span> <span class="main">(</span>Var X1 <span class="keyword1">EQ</span> Var X3 <span class="keyword1">IMP</span> Var <span class="skolem">v2</span> <span class="keyword1">EQ</span> Var X4<span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">drule_tac</span> i<span class="main"><span class="main">=</span></span><span class="quoted">X2</span> <span class="keyword2"><span class="keyword"><span class="quasi_keyword">and</span></span></span> x<span class="main"><span class="main">=</span></span><span class="quoted"><span class="quoted">"Var <span class="skolem">v2</span>"</span></span> <span class="keyword2"><span class="keyword"><span class="quasi_keyword">in</span></span></span> Subst<span class="main">)</span> <span class="operator">simp_all</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="main">{}</span> <span class="main">⊢</span> <span class="main">(</span>Var X1 <span class="keyword1">EQ</span> Var <span class="skolem">v2</span> <span class="keyword1">AND</span> Var <span class="skolem">v3</span> <span class="keyword1">EQ</span> Var X4<span class="main">)</span> <span class="keyword1">IMP</span> <span class="main">(</span>Var X1 <span class="keyword1">EQ</span> Var <span class="skolem">v3</span> <span class="keyword1">IMP</span> Var <span class="skolem">v2</span> <span class="keyword1">EQ</span> Var X4<span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> v2
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">drule_tac</span> i<span class="main"><span class="main">=</span></span><span class="quoted">X3</span> <span class="keyword2"><span class="keyword"><span class="quasi_keyword">and</span></span></span> x<span class="main"><span class="main">=</span></span><span class="quoted"><span class="quoted">"Var <span class="skolem">v3</span>"</span></span> <span class="keyword2"><span class="keyword"><span class="quasi_keyword">in</span></span></span> Subst<span class="main">)</span> <span class="operator">simp_all</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="main">{}</span> <span class="main">⊢</span> <span class="main">(</span>Var X1 <span class="keyword1">EQ</span> Var <span class="skolem">v2</span> <span class="keyword1">AND</span> Var <span class="skolem">v3</span> <span class="keyword1">EQ</span> Var <span class="skolem">v4</span><span class="main">)</span> <span class="keyword1">IMP</span> <span class="main">(</span>Var X1 <span class="keyword1">EQ</span> Var <span class="skolem">v3</span> <span class="keyword1">IMP</span> Var <span class="skolem">v2</span> <span class="keyword1">EQ</span> Var <span class="skolem">v4</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> v2 v3
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">drule_tac</span> i<span class="main"><span class="main">=</span></span><span class="quoted">X4</span> <span class="keyword2"><span class="keyword"><span class="quasi_keyword">and</span></span></span> x<span class="main"><span class="main">=</span></span><span class="quoted"><span class="quoted">"Var <span class="skolem">v4</span>"</span></span> <span class="keyword2"><span class="keyword"><span class="quasi_keyword">in</span></span></span> Subst<span class="main">)</span> <span class="operator">simp_all</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="main">{}</span> <span class="main">⊢</span> <span class="main">(</span><span class="free">t</span> <span class="keyword1">EQ</span> Var <span class="skolem">v2</span> <span class="keyword1">AND</span> Var <span class="skolem">v3</span> <span class="keyword1">EQ</span> Var <span class="skolem">v4</span><span class="main">)</span> <span class="keyword1">IMP</span> <span class="main">(</span><span class="free">t</span> <span class="keyword1">EQ</span> Var <span class="skolem">v3</span> <span class="keyword1">IMP</span> Var <span class="skolem">v2</span> <span class="keyword1">EQ</span> Var <span class="skolem">v4</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> v2 v3 v4
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">drule_tac</span> i<span class="main"><span class="main">=</span></span><span class="quoted">X1</span> <span class="keyword2"><span class="keyword"><span class="quasi_keyword">and</span></span></span> x<span class="main"><span class="main">=</span></span><span class="quoted"><span class="free">t</span></span> <span class="keyword2"><span class="keyword"><span class="quasi_keyword">in</span></span></span> Subst<span class="main">)</span> <span class="operator">simp_all</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="main">{}</span> <span class="main">⊢</span> <span class="main">(</span><span class="free">t</span> <span class="keyword1">EQ</span> <span class="free">t'</span> <span class="keyword1">AND</span> Var <span class="skolem">v3</span> <span class="keyword1">EQ</span> Var <span class="skolem">v4</span><span class="main">)</span> <span class="keyword1">IMP</span> <span class="main">(</span><span class="free">t</span> <span class="keyword1">EQ</span> Var <span class="skolem">v3</span> <span class="keyword1">IMP</span> <span class="free">t'</span> <span class="keyword1">EQ</span> Var <span class="skolem">v4</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> v2 v3 v4
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">drule_tac</span> i<span class="main"><span class="main">=</span></span><span class="quoted"><span class="skolem">v2</span></span> <span class="keyword2"><span class="keyword"><span class="quasi_keyword">and</span></span></span> x<span class="main"><span class="main">=</span></span><span class="quoted"><span class="quoted">"<span class="free">t'</span>"</span></span> <span class="keyword2"><span class="keyword"><span class="quasi_keyword">in</span></span></span> Subst<span class="main">)</span> <span class="operator">simp_all</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="main">{}</span> <span class="main">⊢</span> <span class="main">(</span><span class="free">t</span> <span class="keyword1">EQ</span> <span class="free">t'</span> <span class="keyword1">AND</span> <span class="free">u</span> <span class="keyword1">EQ</span> Var <span class="skolem">v4</span><span class="main">)</span> <span class="keyword1">IMP</span> <span class="main">(</span><span class="free">t</span> <span class="keyword1">EQ</span> <span class="free">u</span> <span class="keyword1">IMP</span> <span class="free">t'</span> <span class="keyword1">EQ</span> Var <span class="skolem">v4</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> v3 v4
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">drule_tac</span> i<span class="main"><span class="main">=</span></span><span class="quoted"><span class="skolem">v3</span></span> <span class="keyword2"><span class="keyword"><span class="quasi_keyword">and</span></span></span> x<span class="main"><span class="main">=</span></span><span class="quoted"><span class="free">u</span></span> <span class="keyword2"><span class="keyword"><span class="quasi_keyword">in</span></span></span> Subst<span class="main">)</span> <span class="operator">simp_all</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
    <span class="keyword1"><span class="command">using</span></span> v4
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">drule_tac</span> i<span class="main"><span class="main">=</span></span><span class="quoted"><span class="skolem">v4</span></span> <span class="keyword2"><span class="keyword"><span class="quasi_keyword">and</span></span></span> x<span class="main"><span class="main">=</span></span><span class="quoted"><span class="quoted">"<span class="free">u'</span>"</span></span> <span class="keyword2"><span class="keyword"><span class="quasi_keyword">in</span></span></span> Subst<span class="main">)</span> <span class="operator">simp_all</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">lemma</span></span> Refl <span class="main">[</span><span class="operator">iff</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">H</span> <span class="main">⊢</span> <span class="free">t</span> <span class="keyword1">EQ</span> <span class="free">t</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">{}</span> <span class="main">⊢</span> Var X1 <span class="keyword1">EQ</span> Var X1"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> eql<span class="main">)</span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> equality_axioms_def refl_ax_def<span class="main">)</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="main">{}</span> <span class="main">⊢</span> <span class="free">t</span> <span class="keyword1">EQ</span> <span class="free">t</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">drule_tac</span> i<span class="main"><span class="main">=</span></span><span class="quoted">X1</span> <span class="keyword2"><span class="keyword"><span class="quasi_keyword">and</span></span></span> x<span class="main"><span class="main">=</span></span><span class="quoted"><span class="free">t</span></span> <span class="keyword2"><span class="keyword"><span class="quasi_keyword">in</span></span></span> Subst<span class="main">)</span> <span class="operator">simp_all</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> empty_subsetI thin<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹Apparently necessary in order to prove the congruence property.›</span></span>
<span class="keyword1"><span class="command">lemma</span></span> Sym<span class="main">:</span> <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">H</span> <span class="main">⊢</span> <span class="free">t</span> <span class="keyword1">EQ</span> <span class="free">u</span>"</span></span> <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">H</span> <span class="main">⊢</span> <span class="free">u</span> <span class="keyword1">EQ</span> <span class="free">t</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">{}</span> <span class="main">⊢</span>  <span class="main">(</span><span class="free">t</span> <span class="keyword1">EQ</span> <span class="free">u</span> <span class="keyword1">AND</span> <span class="free">t</span> <span class="keyword1">EQ</span> <span class="free">t</span><span class="main">)</span> <span class="keyword1">IMP</span> <span class="main">(</span><span class="free">t</span> <span class="keyword1">EQ</span> <span class="free">t</span> <span class="keyword1">IMP</span> <span class="free">u</span> <span class="keyword1">EQ</span> <span class="free">t</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> eql_cong1<span class="main">)</span>
   <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">{</span><span class="free">t</span> <span class="keyword1">EQ</span> <span class="free">u</span><span class="main">}</span> <span class="main">⊢</span> <span class="free">t</span> <span class="keyword1">EQ</span> <span class="free">u</span> <span class="keyword1">AND</span> <span class="free">t</span> <span class="keyword1">EQ</span> <span class="free">t</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> Assume cnj_I Refl<span class="main">)</span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">{</span><span class="free">t</span> <span class="keyword1">EQ</span> <span class="free">u</span><span class="main">}</span> <span class="main">⊢</span> <span class="free">u</span> <span class="keyword1">EQ</span> <span class="free">t</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> MP_same MP Refl sup_bot_left<span class="main">)</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"<span class="free">H</span> <span class="main">⊢</span> <span class="free">u</span> <span class="keyword1">EQ</span> <span class="free">t</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> assms cut1<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">lemma</span></span> Sym_L<span class="main">:</span> <span class="quoted"><span class="quoted">"insert <span class="main">(</span><span class="free">t</span> <span class="keyword1">EQ</span> <span class="free">u</span><span class="main">)</span> <span class="free">H</span> <span class="main">⊢</span> <span class="free">A</span> <span class="main">⟹</span> insert <span class="main">(</span><span class="free">u</span> <span class="keyword1">EQ</span> <span class="free">t</span><span class="main">)</span> <span class="free">H</span> <span class="main">⊢</span> <span class="free">A</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> Assume Sym Un_empty_left Un_insert_left cut<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> Trans<span class="main">:</span> <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">H</span> <span class="main">⊢</span> <span class="free">x</span> <span class="keyword1">EQ</span> <span class="free">y</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="free">H</span> <span class="main">⊢</span> <span class="free">y</span> <span class="keyword1">EQ</span> <span class="free">z</span>"</span></span> <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">H</span> <span class="main">⊢</span> <span class="free">x</span> <span class="keyword1">EQ</span> <span class="free">z</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">⋀</span><span class="bound">H</span><span class="main">.</span> <span class="bound">H</span> <span class="main">⊢</span> <span class="main">(</span><span class="free">x</span> <span class="keyword1">EQ</span> <span class="free">x</span> <span class="keyword1">AND</span> <span class="free">y</span> <span class="keyword1">EQ</span> <span class="free">z</span><span class="main">)</span> <span class="keyword1">IMP</span> <span class="main">(</span><span class="free">x</span> <span class="keyword1">EQ</span> <span class="free">y</span> <span class="keyword1">IMP</span> <span class="free">x</span> <span class="keyword1">EQ</span> <span class="free">z</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> eql_cong1 bot_least thin<span class="main">)</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">{</span><span class="free">x</span> <span class="keyword1">EQ</span> <span class="free">y</span><span class="main">,</span> <span class="free">y</span> <span class="keyword1">EQ</span> <span class="free">z</span><span class="main">}</span> <span class="main">⊢</span> <span class="free">x</span> <span class="keyword1">EQ</span> <span class="free">x</span> <span class="keyword1">AND</span> <span class="free">y</span> <span class="keyword1">EQ</span> <span class="free">z</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> Assume cnj_I Refl thin1<span class="main">)</span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">{</span><span class="free">x</span> <span class="keyword1">EQ</span> <span class="free">y</span><span class="main">,</span> <span class="free">y</span> <span class="keyword1">EQ</span> <span class="free">z</span><span class="main">}</span> <span class="main">⊢</span> <span class="free">x</span> <span class="keyword1">EQ</span> <span class="free">z</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> Hyp MP_same insertI1<span class="main">)</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> assms cut2<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">lemma</span></span> eql_cong<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">H</span> <span class="main">⊢</span> <span class="free">t</span> <span class="keyword1">EQ</span> <span class="free">t'</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="free">H</span> <span class="main">⊢</span> <span class="free">u</span> <span class="keyword1">EQ</span> <span class="free">u'</span>"</span></span> <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">H</span> <span class="main">⊢</span> <span class="free">t</span> <span class="keyword1">EQ</span> <span class="free">u</span> <span class="keyword1">IFF</span> <span class="free">t'</span> <span class="keyword1">EQ</span> <span class="free">u'</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">t</span> <span class="skolem">t'</span> <span class="skolem">u</span> <span class="skolem">u'</span>
    <span class="keyword3"><span class="command">assume</span></span>  <span class="quoted"><span class="quoted">"<span class="free">H</span> <span class="main">⊢</span> <span class="skolem">t</span> <span class="keyword1">EQ</span> <span class="skolem">t'</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="free">H</span> <span class="main">⊢</span> <span class="skolem">u</span> <span class="keyword1">EQ</span> <span class="skolem">u'</span>"</span></span>
    <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">{</span><span class="skolem">t</span> <span class="keyword1">EQ</span> <span class="skolem">t'</span><span class="main">,</span> <span class="skolem">u</span> <span class="keyword1">EQ</span> <span class="skolem">u'</span><span class="main">}</span> <span class="main">⊢</span> <span class="skolem">t</span> <span class="keyword1">EQ</span> <span class="skolem">u</span> <span class="keyword1">IMP</span> <span class="skolem">t'</span> <span class="keyword1">EQ</span> <span class="skolem">u'</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> eql_cong1
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> Assume cnj_I MP_null insert_commute<span class="main">)</span>
    <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">H</span> <span class="main">⊢</span> <span class="skolem">t</span> <span class="keyword1">EQ</span> <span class="skolem">u</span> <span class="keyword1">IMP</span> <span class="skolem">t'</span> <span class="keyword1">EQ</span> <span class="skolem">u'</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> cut2<span class="main">)</span>
  <span class="keyword1"><span class="command">}</span></span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> Iff_def cnj_I assms Sym<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">lemma</span></span> eql_Trans_E<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">H</span> <span class="main">⊢</span> <span class="free">x</span> <span class="keyword1">EQ</span> <span class="free">u</span> <span class="main">⟹</span> insert <span class="main">(</span><span class="free">t</span> <span class="keyword1">EQ</span> <span class="free">u</span><span class="main">)</span> <span class="free">H</span> <span class="main">⊢</span> <span class="free">A</span> <span class="main">⟹</span> insert <span class="main">(</span><span class="free">x</span> <span class="keyword1">EQ</span> <span class="free">t</span><span class="main">)</span> <span class="free">H</span> <span class="main">⊢</span> <span class="free">A</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> Assume Sym_L Trans cut_same thin1 thin2<span class="main">)</span>

<span class="keyword1"><span class="command">subsection</span></span><span class="quoted"><span class="plain_text">‹The congruence properties for <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">term</span></span> <span class="quoted"><span class="quoted">suc</span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span>, <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">term</span></span> <span class="quoted"><span class="quoted">pls</span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span> and <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">term</span></span> <span class="quoted"><span class="quoted">tms</span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span>›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> suc_cong1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">{}</span> <span class="main">⊢</span> <span class="main">(</span><span class="free">t</span> <span class="keyword1">EQ</span> <span class="free">t'</span><span class="main">)</span> <span class="keyword1">IMP</span> <span class="main">(</span>suc <span class="free">t</span> <span class="keyword1">EQ</span> suc <span class="free">t'</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">v2</span></span><span class="main">::</span><span class="quoted">name</span> <span class="keyword2"><span class="keyword">and</span></span> <span class="skolem"><span class="skolem">v3</span></span><span class="main">::</span><span class="quoted">name</span> <span class="keyword2"><span class="keyword">and</span></span> <span class="skolem"><span class="skolem">v4</span></span><span class="main">::</span><span class="quoted">name</span>
    <span class="keyword2"><span class="keyword">where</span></span> v2<span class="main">:</span> <span class="quoted"><span class="quoted">"atom <span class="skolem">v2</span> <span class="main">♯</span> <span class="main">(</span><span class="free">t</span><span class="main">,</span>X1<span class="main">,</span>X3<span class="main">,</span>X4<span class="main">)</span>"</span></span>
      <span class="keyword2"><span class="keyword">and</span></span> v3<span class="main">:</span> <span class="quoted"><span class="quoted">"atom <span class="skolem">v3</span> <span class="main">♯</span> <span class="main">(</span><span class="free">t</span><span class="main">,</span><span class="free">t'</span><span class="main">,</span>X1<span class="main">,</span><span class="skolem">v2</span><span class="main">,</span>X4<span class="main">)</span>"</span></span>
      <span class="keyword2"><span class="keyword">and</span></span> v4<span class="main">:</span> <span class="quoted"><span class="quoted">"atom <span class="skolem">v4</span> <span class="main">♯</span> <span class="main">(</span><span class="free">t</span><span class="main">,</span><span class="free">t'</span><span class="main">,</span>X1<span class="main">,</span><span class="skolem">v2</span><span class="main">,</span><span class="skolem">v3</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> obtain_fresh<span class="main">)</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">{}</span> <span class="main">⊢</span> <span class="main">(</span>Var X1 <span class="keyword1">EQ</span> Var X2<span class="main">)</span> <span class="keyword1">IMP</span> <span class="main">(</span>suc <span class="main">(</span>Var X1<span class="main">)</span> <span class="keyword1">EQ</span> suc <span class="main">(</span>Var X2<span class="main">)</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> syc_cong_ax_def equality_axioms_def insert_iff eql<span class="main">)</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="main">{}</span> <span class="main">⊢</span> <span class="main">(</span>Var X1 <span class="keyword1">EQ</span> Var <span class="skolem">v2</span><span class="main">)</span> <span class="keyword1">IMP</span> <span class="main">(</span>suc <span class="main">(</span>Var X1<span class="main">)</span> <span class="keyword1">EQ</span> suc <span class="main">(</span>Var <span class="skolem">v2</span><span class="main">)</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">drule_tac</span> i<span class="main"><span class="main">=</span></span><span class="quoted">X2</span> <span class="keyword2"><span class="keyword"><span class="quasi_keyword">and</span></span></span> x<span class="main"><span class="main">=</span></span><span class="quoted"><span class="quoted">"Var <span class="skolem">v2</span>"</span></span> <span class="keyword2"><span class="keyword"><span class="quasi_keyword">in</span></span></span> Subst<span class="main">)</span> <span class="operator">simp_all</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="main">{}</span> <span class="main">⊢</span> <span class="main">(</span><span class="free">t</span> <span class="keyword1">EQ</span> Var <span class="skolem">v2</span><span class="main">)</span> <span class="keyword1">IMP</span> <span class="main">(</span>suc <span class="free">t</span> <span class="keyword1">EQ</span> suc <span class="main">(</span>Var <span class="skolem">v2</span><span class="main">)</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> v2 v3 v4
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">drule_tac</span> i<span class="main"><span class="main">=</span></span><span class="quoted">X1</span> <span class="keyword2"><span class="keyword"><span class="quasi_keyword">and</span></span></span> x<span class="main"><span class="main">=</span></span><span class="quoted"><span class="free">t</span></span> <span class="keyword2"><span class="keyword"><span class="quasi_keyword">in</span></span></span> Subst<span class="main">)</span> <span class="operator">simp_all</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="main">{}</span> <span class="main">⊢</span> <span class="main">(</span><span class="free">t</span> <span class="keyword1">EQ</span> <span class="free">t'</span><span class="main">)</span> <span class="keyword1">IMP</span> <span class="main">(</span>suc <span class="free">t</span> <span class="keyword1">EQ</span> suc <span class="free">t'</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> v2 v3 v4
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">drule_tac</span> i<span class="main"><span class="main">=</span></span><span class="quoted"><span class="skolem">v2</span></span> <span class="keyword2"><span class="keyword"><span class="quasi_keyword">and</span></span></span> x<span class="main"><span class="main">=</span></span><span class="quoted"><span class="free">t'</span></span> <span class="keyword2"><span class="keyword"><span class="quasi_keyword">in</span></span></span> Subst<span class="main">)</span> <span class="operator">simp_all</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
    <span class="keyword1"><span class="command">using</span></span> v4
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">drule_tac</span> i<span class="main"><span class="main">=</span></span><span class="quoted"><span class="skolem">v4</span></span> <span class="keyword2"><span class="keyword"><span class="quasi_keyword">in</span></span></span> Subst<span class="main">)</span> <span class="operator">simp_all</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">lemma</span></span> suc_cong<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">⟦</span><span class="free">H</span> <span class="main">⊢</span> <span class="free">t</span> <span class="keyword1">EQ</span> <span class="free">t'</span><span class="main">⟧</span> <span class="main">⟹</span> <span class="free">H</span> <span class="main">⊢</span> suc <span class="free">t</span> <span class="keyword1">EQ</span> suc <span class="free">t'</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> anti_deduction suc_cong1 cut1<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> pls_cong1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">{}</span> <span class="main">⊢</span> <span class="main">(</span><span class="free">t</span> <span class="keyword1">EQ</span> <span class="free">t'</span> <span class="keyword1">AND</span> <span class="free">u</span> <span class="keyword1">EQ</span> <span class="free">u'</span><span class="main">)</span> <span class="keyword1">IMP</span> <span class="main">(</span>pls <span class="free">t</span> <span class="free">u</span> <span class="keyword1">EQ</span> pls <span class="free">t'</span> <span class="free">u'</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">v2</span></span><span class="main">::</span><span class="quoted">name</span> <span class="keyword2"><span class="keyword">and</span></span> <span class="skolem"><span class="skolem">v3</span></span><span class="main">::</span><span class="quoted">name</span> <span class="keyword2"><span class="keyword">and</span></span> <span class="skolem"><span class="skolem">v4</span></span><span class="main">::</span><span class="quoted">name</span>
    <span class="keyword2"><span class="keyword">where</span></span> v2<span class="main">:</span> <span class="quoted"><span class="quoted">"atom <span class="skolem">v2</span> <span class="main">♯</span> <span class="main">(</span><span class="free">t</span><span class="main">,</span>X1<span class="main">,</span>X3<span class="main">,</span>X4<span class="main">)</span>"</span></span>
      <span class="keyword2"><span class="keyword">and</span></span> v3<span class="main">:</span> <span class="quoted"><span class="quoted">"atom <span class="skolem">v3</span> <span class="main">♯</span> <span class="main">(</span><span class="free">t</span><span class="main">,</span><span class="free">t'</span><span class="main">,</span>X1<span class="main">,</span><span class="skolem">v2</span><span class="main">,</span>X4<span class="main">)</span>"</span></span>
      <span class="keyword2"><span class="keyword">and</span></span> v4<span class="main">:</span> <span class="quoted"><span class="quoted">"atom <span class="skolem">v4</span> <span class="main">♯</span> <span class="main">(</span><span class="free">t</span><span class="main">,</span><span class="free">t'</span><span class="main">,</span><span class="free">u</span><span class="main">,</span>X1<span class="main">,</span><span class="skolem">v2</span><span class="main">,</span><span class="skolem">v3</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> obtain_fresh<span class="main">)</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">{}</span> <span class="main">⊢</span> <span class="main">(</span>Var X1 <span class="keyword1">EQ</span> Var X2 <span class="keyword1">AND</span> Var X3 <span class="keyword1">EQ</span> Var X4<span class="main">)</span> <span class="keyword1">IMP</span> <span class="main">(</span>pls <span class="main">(</span>Var X1<span class="main">)</span> <span class="main">(</span>Var X3<span class="main">)</span> <span class="keyword1">EQ</span> pls <span class="main">(</span>Var X2<span class="main">)</span> <span class="main">(</span>Var X4<span class="main">)</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> pls_cong_ax_def equality_axioms_def insert_iff eql<span class="main">)</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="main">{}</span> <span class="main">⊢</span> <span class="main">(</span>Var X1 <span class="keyword1">EQ</span> Var <span class="skolem">v2</span> <span class="keyword1">AND</span> Var X3 <span class="keyword1">EQ</span> Var X4<span class="main">)</span> <span class="keyword1">IMP</span> <span class="main">(</span>pls <span class="main">(</span>Var X1<span class="main">)</span> <span class="main">(</span>Var X3<span class="main">)</span> <span class="keyword1">EQ</span> pls <span class="main">(</span>Var <span class="skolem">v2</span><span class="main">)</span> <span class="main">(</span>Var X4<span class="main">)</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">drule_tac</span> i<span class="main"><span class="main">=</span></span><span class="quoted">X2</span> <span class="keyword2"><span class="keyword"><span class="quasi_keyword">and</span></span></span> x<span class="main"><span class="main">=</span></span><span class="quoted"><span class="quoted">"Var <span class="skolem">v2</span>"</span></span> <span class="keyword2"><span class="keyword"><span class="quasi_keyword">in</span></span></span> Subst<span class="main">)</span> <span class="operator">simp_all</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="main">{}</span> <span class="main">⊢</span> <span class="main">(</span>Var X1 <span class="keyword1">EQ</span> Var <span class="skolem">v2</span> <span class="keyword1">AND</span> Var <span class="skolem">v3</span> <span class="keyword1">EQ</span> Var X4<span class="main">)</span> <span class="keyword1">IMP</span> <span class="main">(</span>pls <span class="main">(</span>Var X1<span class="main">)</span> <span class="main">(</span>Var <span class="skolem">v3</span><span class="main">)</span> <span class="keyword1">EQ</span> pls <span class="main">(</span>Var <span class="skolem">v2</span><span class="main">)</span> <span class="main">(</span>Var X4<span class="main">)</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> v2
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">drule_tac</span> i<span class="main"><span class="main">=</span></span><span class="quoted">X3</span> <span class="keyword2"><span class="keyword"><span class="quasi_keyword">and</span></span></span> x<span class="main"><span class="main">=</span></span><span class="quoted"><span class="quoted">"Var <span class="skolem">v3</span>"</span></span> <span class="keyword2"><span class="keyword"><span class="quasi_keyword">in</span></span></span> Subst<span class="main">)</span> <span class="operator">simp_all</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="main">{}</span> <span class="main">⊢</span> <span class="main">(</span>Var X1 <span class="keyword1">EQ</span> Var <span class="skolem">v2</span> <span class="keyword1">AND</span> Var <span class="skolem">v3</span> <span class="keyword1">EQ</span> Var <span class="skolem">v4</span><span class="main">)</span> <span class="keyword1">IMP</span> <span class="main">(</span>pls <span class="main">(</span>Var X1<span class="main">)</span> <span class="main">(</span>Var <span class="skolem">v3</span><span class="main">)</span> <span class="keyword1">EQ</span> pls <span class="main">(</span>Var <span class="skolem">v2</span><span class="main">)</span> <span class="main">(</span>Var <span class="skolem">v4</span><span class="main">)</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> v2 v3
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">drule_tac</span> i<span class="main"><span class="main">=</span></span><span class="quoted">X4</span> <span class="keyword2"><span class="keyword"><span class="quasi_keyword">and</span></span></span> x<span class="main"><span class="main">=</span></span><span class="quoted"><span class="quoted">"Var <span class="skolem">v4</span>"</span></span> <span class="keyword2"><span class="keyword"><span class="quasi_keyword">in</span></span></span> Subst<span class="main">)</span> <span class="operator">simp_all</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="main">{}</span> <span class="main">⊢</span> <span class="main">(</span><span class="free">t</span> <span class="keyword1">EQ</span> Var <span class="skolem">v2</span> <span class="keyword1">AND</span> Var <span class="skolem">v3</span> <span class="keyword1">EQ</span> Var <span class="skolem">v4</span><span class="main">)</span> <span class="keyword1">IMP</span> <span class="main">(</span>pls <span class="free">t</span> <span class="main">(</span>Var <span class="skolem">v3</span><span class="main">)</span> <span class="keyword1">EQ</span> pls <span class="main">(</span>Var <span class="skolem">v2</span><span class="main">)</span> <span class="main">(</span>Var <span class="skolem">v4</span><span class="main">)</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> v2 v3 v4
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">drule_tac</span> i<span class="main"><span class="main">=</span></span><span class="quoted">X1</span> <span class="keyword2"><span class="keyword"><span class="quasi_keyword">and</span></span></span> x<span class="main"><span class="main">=</span></span><span class="quoted"><span class="free">t</span></span> <span class="keyword2"><span class="keyword"><span class="quasi_keyword">in</span></span></span> Subst<span class="main">)</span> <span class="operator">simp_all</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="main">{}</span> <span class="main">⊢</span> <span class="main">(</span><span class="free">t</span> <span class="keyword1">EQ</span> <span class="free">t'</span> <span class="keyword1">AND</span> Var <span class="skolem">v3</span> <span class="keyword1">EQ</span> Var <span class="skolem">v4</span><span class="main">)</span> <span class="keyword1">IMP</span> <span class="main">(</span>pls <span class="free">t</span> <span class="main">(</span>Var <span class="skolem">v3</span><span class="main">)</span> <span class="keyword1">EQ</span> pls <span class="free">t'</span> <span class="main">(</span>Var <span class="skolem">v4</span><span class="main">)</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> v2 v3 v4
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">drule_tac</span> i<span class="main"><span class="main">=</span></span><span class="quoted"><span class="skolem">v2</span></span> <span class="keyword2"><span class="keyword"><span class="quasi_keyword">and</span></span></span> x<span class="main"><span class="main">=</span></span><span class="quoted"><span class="free">t'</span></span> <span class="keyword2"><span class="keyword"><span class="quasi_keyword">in</span></span></span> Subst<span class="main">)</span> <span class="operator">simp_all</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="main">{}</span> <span class="main">⊢</span> <span class="main">(</span><span class="free">t</span> <span class="keyword1">EQ</span> <span class="free">t'</span> <span class="keyword1">AND</span> <span class="free">u</span> <span class="keyword1">EQ</span> Var <span class="skolem">v4</span><span class="main">)</span> <span class="keyword1">IMP</span> <span class="main">(</span>pls <span class="free">t</span> <span class="free">u</span> <span class="keyword1">EQ</span> pls <span class="free">t'</span> <span class="main">(</span>Var <span class="skolem">v4</span><span class="main">)</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> v3 v4
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">drule_tac</span> i<span class="main"><span class="main">=</span></span><span class="quoted"><span class="skolem">v3</span></span> <span class="keyword2"><span class="keyword"><span class="quasi_keyword">and</span></span></span> x<span class="main"><span class="main">=</span></span><span class="quoted"><span class="free">u</span></span> <span class="keyword2"><span class="keyword"><span class="quasi_keyword">in</span></span></span> Subst<span class="main">)</span> <span class="operator">simp_all</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
    <span class="keyword1"><span class="command">using</span></span> v4
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">drule_tac</span> i<span class="main"><span class="main">=</span></span><span class="quoted"><span class="skolem">v4</span></span> <span class="keyword2"><span class="keyword"><span class="quasi_keyword">and</span></span></span> x<span class="main"><span class="main">=</span></span><span class="quoted"><span class="free">u'</span></span> <span class="keyword2"><span class="keyword"><span class="quasi_keyword">in</span></span></span> Subst<span class="main">)</span> <span class="operator">simp_all</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">lemma</span></span> pls_cong<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">⟦</span><span class="free">H</span> <span class="main">⊢</span> <span class="free">t</span> <span class="keyword1">EQ</span> <span class="free">t'</span><span class="main">;</span> <span class="free">H</span> <span class="main">⊢</span> <span class="free">u</span> <span class="keyword1">EQ</span> <span class="free">u'</span><span class="main">⟧</span> <span class="main">⟹</span> <span class="free">H</span> <span class="main">⊢</span> pls <span class="free">t</span> <span class="free">u</span> <span class="keyword1">EQ</span> pls <span class="free">t'</span> <span class="free">u'</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> cnj_I anti_deduction pls_cong1 cut1<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> tms_cong1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">{}</span> <span class="main">⊢</span> <span class="main">(</span><span class="free">t</span> <span class="keyword1">EQ</span> <span class="free">t'</span> <span class="keyword1">AND</span> <span class="free">u</span> <span class="keyword1">EQ</span> <span class="free">u'</span><span class="main">)</span> <span class="keyword1">IMP</span> <span class="main">(</span>tms <span class="free">t</span> <span class="free">u</span> <span class="keyword1">EQ</span> tms <span class="free">t'</span> <span class="free">u'</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">v2</span></span><span class="main">::</span><span class="quoted">name</span> <span class="keyword2"><span class="keyword">and</span></span> <span class="skolem"><span class="skolem">v3</span></span><span class="main">::</span><span class="quoted">name</span> <span class="keyword2"><span class="keyword">and</span></span> <span class="skolem"><span class="skolem">v4</span></span><span class="main">::</span><span class="quoted">name</span>
    <span class="keyword2"><span class="keyword">where</span></span> v2<span class="main">:</span> <span class="quoted"><span class="quoted">"atom <span class="skolem">v2</span> <span class="main">♯</span> <span class="main">(</span><span class="free">t</span><span class="main">,</span>X1<span class="main">,</span>X3<span class="main">,</span>X4<span class="main">)</span>"</span></span>
      <span class="keyword2"><span class="keyword">and</span></span> v3<span class="main">:</span> <span class="quoted"><span class="quoted">"atom <span class="skolem">v3</span> <span class="main">♯</span> <span class="main">(</span><span class="free">t</span><span class="main">,</span><span class="free">t'</span><span class="main">,</span>X1<span class="main">,</span><span class="skolem">v2</span><span class="main">,</span>X4<span class="main">)</span>"</span></span>
      <span class="keyword2"><span class="keyword">and</span></span> v4<span class="main">:</span> <span class="quoted"><span class="quoted">"atom <span class="skolem">v4</span> <span class="main">♯</span> <span class="main">(</span><span class="free">t</span><span class="main">,</span><span class="free">t'</span><span class="main">,</span><span class="free">u</span><span class="main">,</span>X1<span class="main">,</span><span class="skolem">v2</span><span class="main">,</span><span class="skolem">v3</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> obtain_fresh<span class="main">)</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">{}</span> <span class="main">⊢</span> <span class="main">(</span>Var X1 <span class="keyword1">EQ</span> Var X2 <span class="keyword1">AND</span> Var X3 <span class="keyword1">EQ</span> Var X4<span class="main">)</span> <span class="keyword1">IMP</span> <span class="main">(</span>tms <span class="main">(</span>Var X1<span class="main">)</span> <span class="main">(</span>Var X3<span class="main">)</span> <span class="keyword1">EQ</span> tms <span class="main">(</span>Var X2<span class="main">)</span> <span class="main">(</span>Var X4<span class="main">)</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> tms_cong_ax_def equality_axioms_def insert_iff eql<span class="main">)</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="main">{}</span> <span class="main">⊢</span> <span class="main">(</span>Var X1 <span class="keyword1">EQ</span> Var <span class="skolem">v2</span> <span class="keyword1">AND</span> Var X3 <span class="keyword1">EQ</span> Var X4<span class="main">)</span> <span class="keyword1">IMP</span> <span class="main">(</span>tms <span class="main">(</span>Var X1<span class="main">)</span> <span class="main">(</span>Var X3<span class="main">)</span> <span class="keyword1">EQ</span> tms <span class="main">(</span>Var <span class="skolem">v2</span><span class="main">)</span> <span class="main">(</span>Var X4<span class="main">)</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">drule_tac</span> i<span class="main"><span class="main">=</span></span><span class="quoted">X2</span> <span class="keyword2"><span class="keyword"><span class="quasi_keyword">and</span></span></span> x<span class="main"><span class="main">=</span></span><span class="quoted"><span class="quoted">"Var <span class="skolem">v2</span>"</span></span> <span class="keyword2"><span class="keyword"><span class="quasi_keyword">in</span></span></span> Subst<span class="main">)</span> <span class="operator">simp_all</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="main">{}</span> <span class="main">⊢</span> <span class="main">(</span>Var X1 <span class="keyword1">EQ</span> Var <span class="skolem">v2</span> <span class="keyword1">AND</span> Var <span class="skolem">v3</span> <span class="keyword1">EQ</span> Var X4<span class="main">)</span> <span class="keyword1">IMP</span> <span class="main">(</span>tms <span class="main">(</span>Var X1<span class="main">)</span> <span class="main">(</span>Var <span class="skolem">v3</span><span class="main">)</span> <span class="keyword1">EQ</span> tms <span class="main">(</span>Var <span class="skolem">v2</span><span class="main">)</span> <span class="main">(</span>Var X4<span class="main">)</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> v2
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">drule_tac</span> i<span class="main"><span class="main">=</span></span><span class="quoted">X3</span> <span class="keyword2"><span class="keyword"><span class="quasi_keyword">and</span></span></span> x<span class="main"><span class="main">=</span></span><span class="quoted"><span class="quoted">"Var <span class="skolem">v3</span>"</span></span> <span class="keyword2"><span class="keyword"><span class="quasi_keyword">in</span></span></span> Subst<span class="main">)</span> <span class="operator">simp_all</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="main">{}</span> <span class="main">⊢</span> <span class="main">(</span>Var X1 <span class="keyword1">EQ</span> Var <span class="skolem">v2</span> <span class="keyword1">AND</span> Var <span class="skolem">v3</span> <span class="keyword1">EQ</span> Var <span class="skolem">v4</span><span class="main">)</span> <span class="keyword1">IMP</span> <span class="main">(</span>tms <span class="main">(</span>Var X1<span class="main">)</span> <span class="main">(</span>Var <span class="skolem">v3</span><span class="main">)</span> <span class="keyword1">EQ</span> tms <span class="main">(</span>Var <span class="skolem">v2</span><span class="main">)</span> <span class="main">(</span>Var <span class="skolem">v4</span><span class="main">)</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> v2 v3
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">drule_tac</span> i<span class="main"><span class="main">=</span></span><span class="quoted">X4</span> <span class="keyword2"><span class="keyword"><span class="quasi_keyword">and</span></span></span> x<span class="main"><span class="main">=</span></span><span class="quoted"><span class="quoted">"Var <span class="skolem">v4</span>"</span></span> <span class="keyword2"><span class="keyword"><span class="quasi_keyword">in</span></span></span> Subst<span class="main">)</span> <span class="operator">simp_all</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="main">{}</span> <span class="main">⊢</span> <span class="main">(</span><span class="free">t</span> <span class="keyword1">EQ</span> Var <span class="skolem">v2</span> <span class="keyword1">AND</span> Var <span class="skolem">v3</span> <span class="keyword1">EQ</span> Var <span class="skolem">v4</span><span class="main">)</span> <span class="keyword1">IMP</span> <span class="main">(</span>tms <span class="free">t</span> <span class="main">(</span>Var <span class="skolem">v3</span><span class="main">)</span> <span class="keyword1">EQ</span> tms <span class="main">(</span>Var <span class="skolem">v2</span><span class="main">)</span> <span class="main">(</span>Var <span class="skolem">v4</span><span class="main">)</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> v2 v3 v4
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">drule_tac</span> i<span class="main"><span class="main">=</span></span><span class="quoted">X1</span> <span class="keyword2"><span class="keyword"><span class="quasi_keyword">and</span></span></span> x<span class="main"><span class="main">=</span></span><span class="quoted"><span class="free">t</span></span> <span class="keyword2"><span class="keyword"><span class="quasi_keyword">in</span></span></span> Subst<span class="main">)</span> <span class="operator">simp_all</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="main">{}</span> <span class="main">⊢</span> <span class="main">(</span><span class="free">t</span> <span class="keyword1">EQ</span> <span class="free">t'</span> <span class="keyword1">AND</span> Var <span class="skolem">v3</span> <span class="keyword1">EQ</span> Var <span class="skolem">v4</span><span class="main">)</span> <span class="keyword1">IMP</span> <span class="main">(</span>tms <span class="free">t</span> <span class="main">(</span>Var <span class="skolem">v3</span><span class="main">)</span> <span class="keyword1">EQ</span> tms <span class="free">t'</span> <span class="main">(</span>Var <span class="skolem">v4</span><span class="main">)</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> v2 v3 v4
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">drule_tac</span> i<span class="main"><span class="main">=</span></span><span class="quoted"><span class="skolem">v2</span></span> <span class="keyword2"><span class="keyword"><span class="quasi_keyword">and</span></span></span> x<span class="main"><span class="main">=</span></span><span class="quoted"><span class="free">t'</span></span> <span class="keyword2"><span class="keyword"><span class="quasi_keyword">in</span></span></span> Subst<span class="main">)</span> <span class="operator">simp_all</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="main">{}</span> <span class="main">⊢</span> <span class="main">(</span><span class="free">t</span> <span class="keyword1">EQ</span> <span class="free">t'</span> <span class="keyword1">AND</span> <span class="free">u</span> <span class="keyword1">EQ</span> Var <span class="skolem">v4</span><span class="main">)</span> <span class="keyword1">IMP</span> <span class="main">(</span>tms <span class="free">t</span> <span class="free">u</span> <span class="keyword1">EQ</span> tms <span class="free">t'</span> <span class="main">(</span>Var <span class="skolem">v4</span><span class="main">)</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> v3 v4
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">drule_tac</span> i<span class="main"><span class="main">=</span></span><span class="quoted"><span class="skolem">v3</span></span> <span class="keyword2"><span class="keyword"><span class="quasi_keyword">and</span></span></span> x<span class="main"><span class="main">=</span></span><span class="quoted"><span class="free">u</span></span> <span class="keyword2"><span class="keyword"><span class="quasi_keyword">in</span></span></span> Subst<span class="main">)</span> <span class="operator">simp_all</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
    <span class="keyword1"><span class="command">using</span></span> v4
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">drule_tac</span> i<span class="main"><span class="main">=</span></span><span class="quoted"><span class="skolem">v4</span></span> <span class="keyword2"><span class="keyword"><span class="quasi_keyword">and</span></span></span> x<span class="main"><span class="main">=</span></span><span class="quoted"><span class="free">u'</span></span> <span class="keyword2"><span class="keyword"><span class="quasi_keyword">in</span></span></span> Subst<span class="main">)</span> <span class="operator">simp_all</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">lemma</span></span> tms_cong<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">⟦</span><span class="free">H</span> <span class="main">⊢</span> <span class="free">t</span> <span class="keyword1">EQ</span> <span class="free">t'</span><span class="main">;</span> <span class="free">H</span> <span class="main">⊢</span> <span class="free">u</span> <span class="keyword1">EQ</span> <span class="free">u'</span><span class="main">⟧</span> <span class="main">⟹</span> <span class="free">H</span> <span class="main">⊢</span> tms <span class="free">t</span> <span class="free">u</span> <span class="keyword1">EQ</span> tms <span class="free">t'</span> <span class="free">u'</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> cnj_I anti_deduction tms_cong1 cut1<span class="main">)</span>


<span class="keyword1"><span class="command">subsection</span></span><span class="quoted"><span class="plain_text">‹Substitution for eqlualities›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> eql_subst_trm_Iff<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">{</span><span class="free">t</span> <span class="keyword1">EQ</span> <span class="free">u</span><span class="main">}</span> <span class="main">⊢</span> subst <span class="free">i</span> <span class="free">t</span> <span class="free">trm</span> <span class="keyword1">EQ</span> subst <span class="free">i</span> <span class="free">u</span> <span class="free">trm</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">induct</span> <span class="quoted"><span class="free">trm</span></span> <span class="quasi_keyword">rule</span><span class="main"><span class="main">:</span></span> trm.induct<span class="main">)</span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> suc_cong pls_cong tms_cong<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> eql_subst_fmla_Iff<span class="main">:</span> <span class="quoted"><span class="quoted">"insert <span class="main">(</span><span class="free">t</span> <span class="keyword1">EQ</span> <span class="free">u</span><span class="main">)</span> <span class="free">H</span> <span class="main">⊢</span> <span class="free">A</span><span class="main">(</span><span class="free">i</span><span class="main">::=</span><span class="free">t</span><span class="main">)</span> <span class="keyword1">IFF</span> <span class="free">A</span><span class="main">(</span><span class="free">i</span><span class="main">::=</span><span class="free">u</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">{</span> <span class="free">t</span> <span class="keyword1">EQ</span> <span class="free">u</span> <span class="main">}</span> <span class="main">⊢</span> <span class="free">A</span><span class="main">(</span><span class="free">i</span><span class="main">::=</span><span class="free">t</span><span class="main">)</span> <span class="keyword1">IFF</span> <span class="free">A</span><span class="main">(</span><span class="free">i</span><span class="main">::=</span><span class="free">u</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">nominal_induct</span> <span class="quoted"><span class="free">A</span></span> <span class="quasi_keyword">avoiding</span><span class="main"><span class="main">:</span></span> <span class="quoted"><span class="free">i</span></span> <span class="quoted"><span class="free">t</span></span> <span class="quoted"><span class="free">u</span></span> <span class="quasi_keyword">rule</span><span class="main"><span class="main">:</span></span> fmla.strong_induct<span class="main">)</span>
       <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> dsj_cong neg_cong exi_cong eql_cong eql_subst_trm_Iff<span class="main">)</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> Assume cut1<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">lemma</span></span> Var_eql_subst_Iff<span class="main">:</span> <span class="quoted"><span class="quoted">"insert <span class="main">(</span>Var <span class="free">i</span> <span class="keyword1">EQ</span> <span class="free">t</span><span class="main">)</span> <span class="free">H</span> <span class="main">⊢</span> <span class="free">A</span><span class="main">(</span><span class="free">i</span><span class="main">::=</span><span class="free">t</span><span class="main">)</span> <span class="keyword1">IFF</span> <span class="free">A</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> eql_subst_fmla_Iff Iff_sym subst_fmla_id<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> Var_eql_imp_subst_Iff<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">H</span> <span class="main">⊢</span> Var <span class="free">i</span> <span class="keyword1">EQ</span> <span class="free">t</span> <span class="main">⟹</span> <span class="free">H</span> <span class="main">⊢</span> <span class="free">A</span><span class="main">(</span><span class="free">i</span><span class="main">::=</span><span class="free">t</span><span class="main">)</span> <span class="keyword1">IFF</span> <span class="free">A</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> Var_eql_subst_Iff cut_same<span class="main">)</span>

<span class="keyword1"><span class="command">subsection</span></span><span class="quoted"><span class="plain_text">‹Congruence rules for predicates›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> P1_cong<span class="main">:</span>
  <span class="keyword2"><span class="keyword">fixes</span></span> <span class="free">tms</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"trm list"</span></span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="main">⋀</span><span class="bound">i</span> <span class="bound">t</span> <span class="bound">x</span><span class="main">.</span> atom <span class="bound">i</span> <span class="main">♯</span> <span class="free">tms</span> <span class="main">⟹</span> <span class="main">(</span><span class="free">P</span> <span class="bound">t</span><span class="main">)</span><span class="main">(</span><span class="bound">i</span><span class="main">::=</span><span class="bound">x</span><span class="main">)</span> <span class="main">=</span> <span class="free">P</span> <span class="main">(</span>subst <span class="bound">i</span> <span class="bound">x</span> <span class="bound">t</span><span class="main">)</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">H</span> <span class="main">⊢</span> <span class="free">x</span> <span class="keyword1">EQ</span> <span class="free">x'</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">H</span> <span class="main">⊢</span> <span class="free">P</span> <span class="free">x</span> <span class="keyword1">IFF</span> <span class="free">P</span> <span class="free">x'</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">i</span></span><span class="main">::</span><span class="quoted">name</span> <span class="keyword2"><span class="keyword">where</span></span> i<span class="main">:</span> <span class="quoted"><span class="quoted">"atom <span class="skolem">i</span> <span class="main">♯</span> <span class="free">tms</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> obtain_fresh<span class="main">)</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"insert <span class="main">(</span><span class="free">x</span> <span class="keyword1">EQ</span> <span class="free">x'</span><span class="main">)</span> <span class="free">H</span>  <span class="main">⊢</span> <span class="main">(</span><span class="free">P</span> <span class="main">(</span>Var <span class="skolem">i</span><span class="main">)</span><span class="main">)</span><span class="main">(</span><span class="skolem">i</span><span class="main">::=</span><span class="free">x</span><span class="main">)</span> <span class="keyword1">IFF</span> <span class="main">(</span><span class="free">P</span><span class="main">(</span>Var <span class="skolem">i</span><span class="main">)</span><span class="main">)</span><span class="main">(</span><span class="skolem">i</span><span class="main">::=</span><span class="free">x'</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> eql_subst_fmla_Iff<span class="main">)</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> assms i
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> cut_same subst.simps<span class="main"><span class="main">(</span></span>2<span class="main"><span class="main">)</span></span><span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">lemma</span></span> P2_cong<span class="main">:</span>
  <span class="keyword2"><span class="keyword">fixes</span></span> <span class="free">tms</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"trm list"</span></span>
  <span class="keyword2"><span class="keyword">assumes</span></span> sub<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">⋀</span><span class="bound">i</span> <span class="bound">t</span> <span class="bound">u</span> <span class="bound">x</span><span class="main">.</span> atom <span class="bound">i</span> <span class="main">♯</span> <span class="free">tms</span> <span class="main">⟹</span> <span class="main">(</span><span class="free">P</span> <span class="bound">t</span> <span class="bound">u</span><span class="main">)</span><span class="main">(</span><span class="bound">i</span><span class="main">::=</span><span class="bound">x</span><span class="main">)</span> <span class="main">=</span> <span class="free">P</span> <span class="main">(</span>subst <span class="bound">i</span> <span class="bound">x</span> <span class="bound">t</span><span class="main">)</span> <span class="main">(</span>subst <span class="bound">i</span> <span class="bound">x</span> <span class="bound">u</span><span class="main">)</span>"</span></span>
      <span class="keyword2"><span class="keyword">and</span></span> eq<span class="main">:</span>  <span class="quoted"><span class="quoted">"<span class="free">H</span> <span class="main">⊢</span> <span class="free">x</span> <span class="keyword1">EQ</span> <span class="free">x'</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="free">H</span> <span class="main">⊢</span> <span class="free">y</span> <span class="keyword1">EQ</span> <span class="free">y'</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">H</span> <span class="main">⊢</span> <span class="free">P</span> <span class="free">x</span> <span class="free">y</span> <span class="keyword1">IFF</span> <span class="free">P</span> <span class="free">x'</span> <span class="free">y'</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> yy'<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">{</span> <span class="free">y</span> <span class="keyword1">EQ</span> <span class="free">y'</span> <span class="main">}</span> <span class="main">⊢</span> <span class="free">P</span> <span class="free">x'</span> <span class="free">y</span> <span class="keyword1">IFF</span> <span class="free">P</span> <span class="free">x'</span> <span class="free">y'</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> P1_cong <span class="main"><span class="main">[</span></span><span class="keyword2"><span class="keyword"><span class="operator">where</span></span></span> tms<span class="main"><span class="main"><span class="main">=</span></span></span><span class="quoted"><span class="quoted"><span class="quoted"><span class="quoted">"<span class="main"><span class="main"><span class="main">[</span></span></span><span class="free"><span class="free"><span class="free">y</span></span></span><span class="main"><span class="main"><span class="main">,</span></span></span><span class="free"><span class="free"><span class="free">x'</span></span></span><span class="main"><span class="main"><span class="main">]</span></span></span><span class="main"><span class="main"><span class="main">@</span></span></span><span class="free"><span class="free"><span class="free">tms</span></span></span>"</span></span></span></span><span class="main"><span class="main">]</span></span><span class="main">)</span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> fresh_Cons sub<span class="main">)</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">{</span> <span class="free">x</span> <span class="keyword1">EQ</span> <span class="free">x'</span> <span class="main">}</span> <span class="main">⊢</span> <span class="free">P</span> <span class="free">x</span> <span class="free">y</span> <span class="keyword1">IFF</span> <span class="free">P</span> <span class="free">x'</span> <span class="free">y</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> P1_cong <span class="main"><span class="main">[</span></span><span class="keyword2"><span class="keyword"><span class="operator">where</span></span></span> tms<span class="main"><span class="main"><span class="main">=</span></span></span><span class="quoted"><span class="quoted"><span class="quoted"><span class="quoted">"<span class="main"><span class="main"><span class="main">[</span></span></span><span class="free"><span class="free"><span class="free">y</span></span></span><span class="main"><span class="main"><span class="main">,</span></span></span><span class="free"><span class="free"><span class="free">x'</span></span></span><span class="main"><span class="main"><span class="main">]</span></span></span><span class="main"><span class="main"><span class="main">@</span></span></span><span class="free"><span class="free"><span class="free">tms</span></span></span>"</span></span></span></span><span class="main"><span class="main">]</span></span><span class="main">)</span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> fresh_Cons sub<span class="main">)</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="main">{</span><span class="free">x</span> <span class="keyword1">EQ</span> <span class="free">x'</span><span class="main">,</span> <span class="free">y</span> <span class="keyword1">EQ</span> <span class="free">y'</span><span class="main">}</span> <span class="main">⊢</span> <span class="free">P</span> <span class="free">x</span> <span class="free">y</span> <span class="keyword1">IFF</span> <span class="free">P</span> <span class="free">x'</span> <span class="free">y'</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> Assume Iff_trans cut1 rotate2 yy'<span class="main">)</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> cut2 eq<span class="main">)</span>
 <span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">lemma</span></span> P3_cong<span class="main">:</span>
  <span class="keyword2"><span class="keyword">fixes</span></span> <span class="free">tms</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"trm list"</span></span>
  <span class="keyword2"><span class="keyword">assumes</span></span> sub<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">⋀</span><span class="bound">i</span> <span class="bound">t</span> <span class="bound">u</span> <span class="bound">v</span> <span class="bound">x</span><span class="main">.</span> atom <span class="bound">i</span> <span class="main">♯</span> <span class="free">tms</span> <span class="main">⟹</span>
                   <span class="main">(</span><span class="free">P</span> <span class="bound">t</span> <span class="bound">u</span> <span class="bound">v</span><span class="main">)</span><span class="main">(</span><span class="bound">i</span><span class="main">::=</span><span class="bound">x</span><span class="main">)</span> <span class="main">=</span> <span class="free">P</span> <span class="main">(</span>subst <span class="bound">i</span> <span class="bound">x</span> <span class="bound">t</span><span class="main">)</span> <span class="main">(</span>subst <span class="bound">i</span> <span class="bound">x</span> <span class="bound">u</span><span class="main">)</span> <span class="main">(</span>subst <span class="bound">i</span> <span class="bound">x</span> <span class="bound">v</span><span class="main">)</span>"</span></span>
      <span class="keyword2"><span class="keyword">and</span></span> eq<span class="main">:</span>  <span class="quoted"><span class="quoted">"<span class="free">H</span> <span class="main">⊢</span> <span class="free">x</span> <span class="keyword1">EQ</span> <span class="free">x'</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="free">H</span> <span class="main">⊢</span> <span class="free">y</span> <span class="keyword1">EQ</span> <span class="free">y'</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="free">H</span> <span class="main">⊢</span> <span class="free">z</span> <span class="keyword1">EQ</span> <span class="free">z'</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">H</span> <span class="main">⊢</span> <span class="free">P</span> <span class="free">x</span> <span class="free">y</span> <span class="free">z</span> <span class="keyword1">IFF</span> <span class="free">P</span> <span class="free">x'</span> <span class="free">y'</span> <span class="free">z'</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">i</span></span><span class="main">::</span><span class="quoted">name</span> <span class="keyword2"><span class="keyword">where</span></span> i<span class="main">:</span> <span class="quoted"><span class="quoted">"atom <span class="skolem">i</span> <span class="main">♯</span> <span class="main">(</span><span class="free">z</span><span class="main">,</span><span class="free">z'</span><span class="main">,</span><span class="free">y</span><span class="main">,</span><span class="free">y'</span><span class="main">,</span><span class="free">x</span><span class="main">,</span><span class="free">x'</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> obtain_fresh<span class="main">)</span>
  <span class="keyword1"><span class="command">have</span></span> tl<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">{</span> <span class="free">y</span> <span class="keyword1">EQ</span> <span class="free">y'</span><span class="main">,</span> <span class="free">z</span> <span class="keyword1">EQ</span> <span class="free">z'</span> <span class="main">}</span> <span class="main">⊢</span> <span class="free">P</span> <span class="free">x'</span> <span class="free">y</span> <span class="free">z</span> <span class="keyword1">IFF</span> <span class="free">P</span> <span class="free">x'</span> <span class="free">y'</span> <span class="free">z'</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> P2_cong <span class="main"><span class="main">[</span></span><span class="keyword2"><span class="keyword"><span class="operator">where</span></span></span> tms<span class="main"><span class="main"><span class="main">=</span></span></span><span class="quoted"><span class="quoted"><span class="quoted"><span class="quoted">"<span class="main"><span class="main"><span class="main">[</span></span></span><span class="free"><span class="free"><span class="free">z</span></span></span><span class="main"><span class="main"><span class="main">,</span></span></span><span class="free"><span class="free"><span class="free">z'</span></span></span><span class="main"><span class="main"><span class="main">,</span></span></span><span class="free"><span class="free"><span class="free">y</span></span></span><span class="main"><span class="main"><span class="main">,</span></span></span><span class="free"><span class="free"><span class="free">y'</span></span></span><span class="main"><span class="main"><span class="main">,</span></span></span><span class="free"><span class="free"><span class="free">x</span></span></span><span class="main"><span class="main"><span class="main">,</span></span></span><span class="free"><span class="free"><span class="free">x'</span></span></span><span class="main"><span class="main"><span class="main">]</span></span></span><span class="main"><span class="main"><span class="main">@</span></span></span><span class="free"><span class="free"><span class="free">tms</span></span></span>"</span></span></span></span><span class="main"><span class="main">]</span></span><span class="main">)</span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> fresh_Cons sub<span class="main">)</span>
  <span class="keyword1"><span class="command">have</span></span> hd<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">{</span> <span class="free">x</span> <span class="keyword1">EQ</span> <span class="free">x'</span> <span class="main">}</span> <span class="main">⊢</span> <span class="free">P</span> <span class="free">x</span> <span class="free">y</span> <span class="free">z</span> <span class="keyword1">IFF</span> <span class="free">P</span> <span class="free">x'</span> <span class="free">y</span> <span class="free">z</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> P1_cong <span class="main"><span class="main">[</span></span><span class="keyword2"><span class="keyword"><span class="operator">where</span></span></span> tms<span class="main"><span class="main"><span class="main">=</span></span></span><span class="quoted"><span class="quoted"><span class="quoted"><span class="quoted">"<span class="main"><span class="main"><span class="main">[</span></span></span><span class="free"><span class="free"><span class="free">z</span></span></span><span class="main"><span class="main"><span class="main">,</span></span></span><span class="free"><span class="free"><span class="free">y</span></span></span><span class="main"><span class="main"><span class="main">,</span></span></span><span class="free"><span class="free"><span class="free">x'</span></span></span><span class="main"><span class="main"><span class="main">]</span></span></span><span class="main"><span class="main"><span class="main">@</span></span></span><span class="free"><span class="free"><span class="free">tms</span></span></span>"</span></span></span></span><span class="main"><span class="main">]</span></span><span class="main">)</span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> fresh_Cons sub<span class="main">)</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">{</span><span class="free">x</span> <span class="keyword1">EQ</span> <span class="free">x'</span><span class="main">,</span> <span class="free">y</span> <span class="keyword1">EQ</span> <span class="free">y'</span><span class="main">,</span> <span class="free">z</span> <span class="keyword1">EQ</span> <span class="free">z'</span><span class="main">}</span> <span class="main">⊢</span> <span class="free">P</span> <span class="free">x</span> <span class="free">y</span> <span class="free">z</span> <span class="keyword1">IFF</span> <span class="free">P</span> <span class="free">x'</span> <span class="free">y'</span> <span class="free">z'</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> Assume thin1 hd <span class="main"><span class="main">[</span></span><span class="operator">THEN</span> cut1<span class="main"><span class="main">]</span></span> tl Iff_trans<span class="main">)</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> cut3<span class="main">)</span> <span class="main">(</span><span class="operator">rule</span> eq<span class="main">)</span><span class="main"><span class="keyword3">+</span></span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">lemma</span></span> P4_cong<span class="main">:</span>
  <span class="keyword2"><span class="keyword">fixes</span></span> <span class="free">tms</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"trm list"</span></span>
  <span class="keyword2"><span class="keyword">assumes</span></span> sub<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">⋀</span><span class="bound">i</span> <span class="bound">t1</span> <span class="bound">t2</span> <span class="bound">t3</span> <span class="bound">t4</span> <span class="bound">x</span><span class="main">.</span> atom <span class="bound">i</span> <span class="main">♯</span> <span class="free">tms</span> <span class="main">⟹</span>
                 <span class="main">(</span><span class="free">P</span> <span class="bound">t1</span> <span class="bound">t2</span> <span class="bound">t3</span> <span class="bound">t4</span><span class="main">)</span><span class="main">(</span><span class="bound">i</span><span class="main">::=</span><span class="bound">x</span><span class="main">)</span> <span class="main">=</span> <span class="free">P</span> <span class="main">(</span>subst <span class="bound">i</span> <span class="bound">x</span> <span class="bound">t1</span><span class="main">)</span> <span class="main">(</span>subst <span class="bound">i</span> <span class="bound">x</span> <span class="bound">t2</span><span class="main">)</span> <span class="main">(</span>subst <span class="bound">i</span> <span class="bound">x</span> <span class="bound">t3</span><span class="main">)</span> <span class="main">(</span>subst <span class="bound">i</span> <span class="bound">x</span> <span class="bound">t4</span><span class="main">)</span>"</span></span>
      <span class="keyword2"><span class="keyword">and</span></span> eq<span class="main">:</span>  <span class="quoted"><span class="quoted">"<span class="free">H</span> <span class="main">⊢</span> <span class="free">x1</span> <span class="keyword1">EQ</span> <span class="free">x1'</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="free">H</span> <span class="main">⊢</span> <span class="free">x2</span> <span class="keyword1">EQ</span> <span class="free">x2'</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="free">H</span> <span class="main">⊢</span> <span class="free">x3</span> <span class="keyword1">EQ</span> <span class="free">x3'</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="free">H</span> <span class="main">⊢</span> <span class="free">x4</span> <span class="keyword1">EQ</span> <span class="free">x4'</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">H</span> <span class="main">⊢</span> <span class="free">P</span> <span class="free">x1</span> <span class="free">x2</span> <span class="free">x3</span> <span class="free">x4</span> <span class="keyword1">IFF</span> <span class="free">P</span> <span class="free">x1'</span> <span class="free">x2'</span> <span class="free">x3'</span> <span class="free">x4'</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">i</span></span><span class="main">::</span><span class="quoted">name</span> <span class="keyword2"><span class="keyword">where</span></span> i<span class="main">:</span> <span class="quoted"><span class="quoted">"atom <span class="skolem">i</span> <span class="main">♯</span> <span class="main">(</span><span class="free">x4</span><span class="main">,</span><span class="free">x4'</span><span class="main">,</span><span class="free">x3</span><span class="main">,</span><span class="free">x3'</span><span class="main">,</span><span class="free">x2</span><span class="main">,</span><span class="free">x2'</span><span class="main">,</span><span class="free">x1</span><span class="main">,</span><span class="free">x1'</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> obtain_fresh<span class="main">)</span>
  <span class="keyword1"><span class="command">have</span></span> tl<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">{</span> <span class="free">x2</span> <span class="keyword1">EQ</span> <span class="free">x2'</span><span class="main">,</span> <span class="free">x3</span> <span class="keyword1">EQ</span> <span class="free">x3'</span><span class="main">,</span> <span class="free">x4</span> <span class="keyword1">EQ</span> <span class="free">x4'</span> <span class="main">}</span> <span class="main">⊢</span> <span class="free">P</span> <span class="free">x1'</span> <span class="free">x2</span> <span class="free">x3</span> <span class="free">x4</span> <span class="keyword1">IFF</span> <span class="free">P</span> <span class="free">x1'</span> <span class="free">x2'</span> <span class="free">x3'</span> <span class="free">x4'</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> P3_cong <span class="main"><span class="main">[</span></span><span class="keyword2"><span class="keyword"><span class="operator">where</span></span></span> tms<span class="main"><span class="main"><span class="main">=</span></span></span><span class="quoted"><span class="quoted"><span class="quoted"><span class="quoted">"<span class="main"><span class="main"><span class="main">[</span></span></span><span class="free"><span class="free"><span class="free">x4</span></span></span><span class="main"><span class="main"><span class="main">,</span></span></span><span class="free"><span class="free"><span class="free">x4'</span></span></span><span class="main"><span class="main"><span class="main">,</span></span></span><span class="free"><span class="free"><span class="free">x3</span></span></span><span class="main"><span class="main"><span class="main">,</span></span></span><span class="free"><span class="free"><span class="free">x3'</span></span></span><span class="main"><span class="main"><span class="main">,</span></span></span><span class="free"><span class="free"><span class="free">x2</span></span></span><span class="main"><span class="main"><span class="main">,</span></span></span><span class="free"><span class="free"><span class="free">x2'</span></span></span><span class="main"><span class="main"><span class="main">,</span></span></span><span class="free"><span class="free"><span class="free">x1</span></span></span><span class="main"><span class="main"><span class="main">,</span></span></span><span class="free"><span class="free"><span class="free">x1'</span></span></span><span class="main"><span class="main"><span class="main">]</span></span></span><span class="main"><span class="main"><span class="main">@</span></span></span><span class="free"><span class="free"><span class="free">tms</span></span></span>"</span></span></span></span><span class="main"><span class="main">]</span></span><span class="main">)</span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> fresh_Cons sub<span class="main">)</span>
  <span class="keyword1"><span class="command">have</span></span> hd<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">{</span> <span class="free">x1</span> <span class="keyword1">EQ</span> <span class="free">x1'</span> <span class="main">}</span> <span class="main">⊢</span> <span class="free">P</span> <span class="free">x1</span> <span class="free">x2</span> <span class="free">x3</span> <span class="free">x4</span> <span class="keyword1">IFF</span> <span class="free">P</span> <span class="free">x1'</span> <span class="free">x2</span> <span class="free">x3</span> <span class="free">x4</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> fresh_Cons sub <span class="quasi_keyword">intro</span><span class="main"><span class="main">!</span></span><span class="main"><span class="main">:</span></span> P1_cong <span class="main"><span class="main">[</span></span><span class="keyword2"><span class="keyword"><span class="operator">where</span></span></span> tms<span class="main"><span class="main"><span class="main">=</span></span></span><span class="quoted"><span class="quoted">"<span class="main">[</span><span class="free">x4</span><span class="main">,</span><span class="free">x3</span><span class="main">,</span><span class="free">x2</span><span class="main">,</span><span class="free">x1'</span><span class="main">]</span><span class="main">@</span><span class="free">tms</span>"</span></span><span class="main"><span class="main">]</span></span><span class="main">)</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">{</span><span class="free">x1</span> <span class="keyword1">EQ</span> <span class="free">x1'</span><span class="main">,</span> <span class="free">x2</span> <span class="keyword1">EQ</span> <span class="free">x2'</span><span class="main">,</span> <span class="free">x3</span> <span class="keyword1">EQ</span> <span class="free">x3'</span><span class="main">,</span> <span class="free">x4</span> <span class="keyword1">EQ</span> <span class="free">x4'</span><span class="main">}</span> <span class="main">⊢</span> <span class="free">P</span> <span class="free">x1</span> <span class="free">x2</span> <span class="free">x3</span> <span class="free">x4</span> <span class="keyword1">IFF</span> <span class="free">P</span> <span class="free">x1'</span> <span class="free">x2'</span> <span class="free">x3'</span> <span class="free">x4'</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> Assume thin1 hd <span class="main"><span class="main">[</span></span><span class="operator">THEN</span> cut1<span class="main"><span class="main">]</span></span> tl Iff_trans<span class="main">)</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> cut4<span class="main">)</span> <span class="main">(</span><span class="operator">rule</span> eq<span class="main">)</span><span class="main"><span class="keyword3">+</span></span>
<span class="keyword1"><span class="command">qed</span></span>



<span class="keyword1"><span class="command">subsection</span></span><span class="quoted"><span class="plain_text">‹The formula <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">term</span></span> <span class="quoted"><span class="quoted">fls</span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span>›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> neg_I <span class="main">[</span><span class="operator">intro</span><span class="main"><span class="main"><span class="main"><span class="main">!</span></span></span></span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"insert <span class="free">A</span> <span class="free">H</span> <span class="main">⊢</span> fls <span class="main">⟹</span> <span class="free">H</span> <span class="main">⊢</span> neg <span class="free">A</span>"</span></span>
  <span class="keyword1"><span class="command">unfolding</span></span> fls_def
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">meson</span> neg_D neg_I0 Refl<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> neg_E <span class="main">[</span><span class="operator">intro</span><span class="main"><span class="main"><span class="main"><span class="main">!</span></span></span></span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">H</span> <span class="main">⊢</span> <span class="free">A</span> <span class="main">⟹</span> insert <span class="main">(</span>neg <span class="free">A</span><span class="main">)</span> <span class="free">H</span> <span class="main">⊢</span> fls"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> ContraProve<span class="main">)</span>

<span class="keyword1"><span class="command">declare</span></span> neg_E <span class="main">[</span><span class="operator">THEN</span> rotate2<span class="main">,</span> <span class="operator">intro</span><span class="main"><span class="main">!</span></span><span class="main">]</span>
<span class="keyword1"><span class="command">declare</span></span> neg_E <span class="main">[</span><span class="operator">THEN</span> rotate3<span class="main">,</span> <span class="operator">intro</span><span class="main"><span class="main">!</span></span><span class="main">]</span>
<span class="keyword1"><span class="command">declare</span></span> neg_E <span class="main">[</span><span class="operator">THEN</span> rotate4<span class="main">,</span> <span class="operator">intro</span><span class="main"><span class="main">!</span></span><span class="main">]</span>
<span class="keyword1"><span class="command">declare</span></span> neg_E <span class="main">[</span><span class="operator">THEN</span> rotate5<span class="main">,</span> <span class="operator">intro</span><span class="main"><span class="main">!</span></span><span class="main">]</span>
<span class="keyword1"><span class="command">declare</span></span> neg_E <span class="main">[</span><span class="operator">THEN</span> rotate6<span class="main">,</span> <span class="operator">intro</span><span class="main"><span class="main">!</span></span><span class="main">]</span>
<span class="keyword1"><span class="command">declare</span></span> neg_E <span class="main">[</span><span class="operator">THEN</span> rotate7<span class="main">,</span> <span class="operator">intro</span><span class="main"><span class="main">!</span></span><span class="main">]</span>
<span class="keyword1"><span class="command">declare</span></span> neg_E <span class="main">[</span><span class="operator">THEN</span> rotate8<span class="main">,</span> <span class="operator">intro</span><span class="main"><span class="main">!</span></span><span class="main">]</span>

<span class="keyword1"><span class="command">lemma</span></span> neg_imp_I <span class="main">[</span><span class="operator">intro</span><span class="main"><span class="main"><span class="main"><span class="main">!</span></span></span></span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">H</span> <span class="main">⊢</span> <span class="free">A</span> <span class="main">⟹</span> insert <span class="free">B</span> <span class="free">H</span> <span class="main">⊢</span> fls <span class="main">⟹</span> <span class="free">H</span> <span class="main">⊢</span> neg <span class="main">(</span><span class="free">A</span> <span class="keyword1">IMP</span> <span class="free">B</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> negneg_I neg_dsj_I neg_I<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> neg_imp_E <span class="main">[</span><span class="operator">intro</span><span class="main"><span class="main"><span class="main"><span class="main">!</span></span></span></span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"insert <span class="main">(</span>neg <span class="free">B</span><span class="main">)</span> <span class="main">(</span>insert <span class="free">A</span> <span class="free">H</span><span class="main">)</span> <span class="main">⊢</span> <span class="free">C</span> <span class="main">⟹</span> insert <span class="main">(</span>neg <span class="main">(</span><span class="free">A</span> <span class="keyword1">IMP</span> <span class="free">B</span><span class="main">)</span><span class="main">)</span> <span class="free">H</span> <span class="main">⊢</span> <span class="free">C</span>"</span></span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">rule</span> cut_same <span class="main"><span class="main">[</span></span><span class="keyword2"><span class="keyword"><span class="operator">where</span></span></span> A<span class="main"><span class="main"><span class="main">=</span></span></span><span class="quoted"><span class="free"><span class="quoted"><span class="free">A</span></span></span></span><span class="main"><span class="main">]</span></span><span class="main">)</span>
 <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">metis</span> Assume dsj_I1 negneg_D neg_mono<span class="main">)</span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">metis</span> Swap imp_I rotate2 thin1<span class="main">)</span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">done</span></span></span></span>

<span class="keyword1"><span class="command">declare</span></span> neg_imp_E <span class="main">[</span><span class="operator">THEN</span> rotate2<span class="main">,</span> <span class="operator">intro</span><span class="main"><span class="main">!</span></span><span class="main">]</span>
<span class="keyword1"><span class="command">declare</span></span> neg_imp_E <span class="main">[</span><span class="operator">THEN</span> rotate3<span class="main">,</span> <span class="operator">intro</span><span class="main"><span class="main">!</span></span><span class="main">]</span>
<span class="keyword1"><span class="command">declare</span></span> neg_imp_E <span class="main">[</span><span class="operator">THEN</span> rotate4<span class="main">,</span> <span class="operator">intro</span><span class="main"><span class="main">!</span></span><span class="main">]</span>
<span class="keyword1"><span class="command">declare</span></span> neg_imp_E <span class="main">[</span><span class="operator">THEN</span> rotate5<span class="main">,</span> <span class="operator">intro</span><span class="main"><span class="main">!</span></span><span class="main">]</span>
<span class="keyword1"><span class="command">declare</span></span> neg_imp_E <span class="main">[</span><span class="operator">THEN</span> rotate6<span class="main">,</span> <span class="operator">intro</span><span class="main"><span class="main">!</span></span><span class="main">]</span>
<span class="keyword1"><span class="command">declare</span></span> neg_imp_E <span class="main">[</span><span class="operator">THEN</span> rotate7<span class="main">,</span> <span class="operator">intro</span><span class="main"><span class="main">!</span></span><span class="main">]</span>
<span class="keyword1"><span class="command">declare</span></span> neg_imp_E <span class="main">[</span><span class="operator">THEN</span> rotate8<span class="main">,</span> <span class="operator">intro</span><span class="main"><span class="main">!</span></span><span class="main">]</span>

<span class="keyword1"><span class="command">lemma</span></span> fls_E <span class="main">[</span><span class="operator">intro</span><span class="main"><span class="main"><span class="main"><span class="main">!</span></span></span></span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"insert fls <span class="free">H</span> <span class="main">⊢</span> <span class="free">A</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> ContraProve fls_def<span class="main">)</span>

<span class="keyword1"><span class="command">declare</span></span> fls_E <span class="main">[</span><span class="operator">THEN</span> rotate2<span class="main">,</span> <span class="operator">intro</span><span class="main"><span class="main">!</span></span><span class="main">]</span>
<span class="keyword1"><span class="command">declare</span></span> fls_E <span class="main">[</span><span class="operator">THEN</span> rotate3<span class="main">,</span> <span class="operator">intro</span><span class="main"><span class="main">!</span></span><span class="main">]</span>
<span class="keyword1"><span class="command">declare</span></span> fls_E <span class="main">[</span><span class="operator">THEN</span> rotate4<span class="main">,</span> <span class="operator">intro</span><span class="main"><span class="main">!</span></span><span class="main">]</span>
<span class="keyword1"><span class="command">declare</span></span> fls_E <span class="main">[</span><span class="operator">THEN</span> rotate5<span class="main">,</span> <span class="operator">intro</span><span class="main"><span class="main">!</span></span><span class="main">]</span>
<span class="keyword1"><span class="command">declare</span></span> fls_E <span class="main">[</span><span class="operator">THEN</span> rotate6<span class="main">,</span> <span class="operator">intro</span><span class="main"><span class="main">!</span></span><span class="main">]</span>
<span class="keyword1"><span class="command">declare</span></span> fls_E <span class="main">[</span><span class="operator">THEN</span> rotate7<span class="main">,</span> <span class="operator">intro</span><span class="main"><span class="main">!</span></span><span class="main">]</span>
<span class="keyword1"><span class="command">declare</span></span> fls_E <span class="main">[</span><span class="operator">THEN</span> rotate8<span class="main">,</span> <span class="operator">intro</span><span class="main"><span class="main">!</span></span><span class="main">]</span>

<span class="keyword1"><span class="command">lemma</span></span> truth_provable<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">H</span> <span class="main">⊢</span> <span class="main">(</span>neg fls<span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> fls_E neg_I<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> exFalso<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">H</span> <span class="main">⊢</span> fls <span class="main">⟹</span> <span class="free">H</span> <span class="main">⊢</span> <span class="free">A</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> neg_D truth_provable<span class="main">)</span>


<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹Soundness of the provability relation›</span></span>

<span class="keyword1"><span class="command">theorem</span></span> nprv_sound<span class="main">:</span> <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">H</span> <span class="main">⊢</span> <span class="free">A</span>"</span></span> <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">∀</span><span class="bound">B</span><span class="main">∈</span><span class="free">H</span><span class="main">.</span> eval_fmla <span class="free">e</span> <span class="bound">B</span><span class="main">)</span> <span class="main">⟹</span> eval_fmla <span class="free">e</span> <span class="free">A</span>"</span></span>
<span class="keyword1"><span class="command">using</span></span> assms
<span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">induct</span> <span class="quasi_keyword">arbitrary</span><span class="main"><span class="main">:</span></span> <span class="quoted"><span class="free">e</span></span><span class="main">)</span>
  <span class="keyword3"><span class="command">case</span></span> <span class="main">(</span>Hyp <span class="skolem">A</span> <span class="skolem">H</span><span class="main">)</span> <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?case</span></span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">next</span></span>
  <span class="keyword3"><span class="command">case</span></span> <span class="main">(</span>Q <span class="skolem">H</span><span class="main">)</span> <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?case</span></span></span>
     <span class="keyword1"><span class="command">unfolding</span></span> Q_axioms_def
     <span class="keyword1"><span class="command">using</span></span> not0_implies_Suc <span class="keyword1"><span class="command">by</span></span> <span class="operator">fastforce</span>
<span class="keyword1"><span class="command">next</span></span>
  <span class="keyword3"><span class="command">case</span></span> <span class="main">(</span>Bool <span class="skolem">A</span> <span class="skolem">H</span><span class="main">)</span> <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?case</span></span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> boolean_axioms_hold<span class="main">)</span>
<span class="keyword1"><span class="command">next</span></span>
  <span class="keyword3"><span class="command">case</span></span> <span class="main">(</span>eql <span class="skolem">A</span> <span class="skolem">H</span><span class="main">)</span> <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?case</span></span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> equality_axioms_hold<span class="main">)</span>
<span class="keyword1"><span class="command">next</span></span>
  <span class="keyword3"><span class="command">case</span></span> <span class="main">(</span>Spec <span class="skolem">A</span> <span class="skolem">H</span><span class="main">)</span> <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?case</span></span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> special_axioms_hold<span class="main">)</span>
<span class="keyword1"><span class="command">next</span></span>
  <span class="keyword3"><span class="command">case</span></span> <span class="main">(</span>MP <span class="skolem">H</span> <span class="skolem">A</span> <span class="skolem">B</span> <span class="skolem">H'</span><span class="main">)</span> <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?case</span></span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">next</span></span>
  <span class="keyword3"><span class="command">case</span></span> <span class="main">(</span>exiists <span class="skolem">H</span> <span class="skolem">A</span> <span class="skolem">B</span> <span class="skolem">i</span> <span class="skolem">e</span><span class="main">)</span> <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?case</span></span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span> <span class="main">(</span><span class="operator">metis</span> forget_eval_fmla<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="comment1">(*&lt;*)</span>
<span class="keyword2"><span class="keyword">end</span></span>
<span class="comment1">(*&gt;*)</span>
</pre>
</div><div id="Instance">
<div class="head">
<h1>Theory Instance</h1>
</div>
<pre class="source"><span class="keyword1"><span class="command">section</span></span> <span class="quoted"><span class="plain_text">‹Instantiation of Syntax-Independent Logic Infrastructure›</span></span>

<span class="comment1">(*&lt;*)</span>
<span class="keyword1"><span class="command">theory</span></span> Instance
<span class="keyword2"><span class="keyword">imports</span></span> <span class="quoted">"<a href="../Syntax_Independent_Logic/Standard_Model.html">Syntax_Independent_Logic.Standard_Model</a>"</span> <span class="quoted">"<a href="../Syntax_Independent_Logic/Deduction_Q.html">Syntax_Independent_Logic.Deduction_Q</a>"</span> <a href="Robinson_Arithmetic.html">Robinson_Arithmetic</a>
<span class="keyword2"><span class="keyword">begin</span></span>
<span class="comment1">(*&gt;*)</span>

<span class="keyword1"><span class="command">subsection</span></span> <span class="quoted"><span class="plain_text">‹Preliminaries›</span></span>

<span class="keyword1"><span class="command">inductive_set</span></span> <span class="entity">num</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"trm set"</span></span> <span class="keyword2"><span class="keyword">where</span></span>
 zer<span class="main">[</span><span class="operator">intro</span><span class="main"><span class="main"><span class="main"><span class="main"><span class="main"><span class="main"><span class="main">!</span></span></span></span></span></span></span><span class="main">,</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"zer <span class="main">∈</span> <span class="free">num</span>"</span></span>
<span class="main">|</span>suc<span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free"><span class="bound"><span class="entity">t</span></span></span> <span class="main">∈</span> <span class="free">num</span> <span class="main">⟹</span> suc <span class="free"><span class="bound"><span class="entity">t</span></span></span> <span class="main">∈</span> <span class="free">num</span>"</span></span>

<span class="keyword1"><span class="command">definition</span></span> <span class="entity">ground_aux</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"trm <span class="main">⇒</span> atom set <span class="main">⇒</span> bool"</span></span>
  <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="free">ground_aux</span> <span class="free"><span class="bound"><span class="entity">t</span></span></span> <span class="free"><span class="bound"><span class="entity">S</span></span></span> <span class="main">≡</span> <span class="main">(</span>supp <span class="free"><span class="bound"><span class="entity">t</span></span></span> <span class="main">⊆</span> <span class="free"><span class="bound"><span class="entity">S</span></span></span><span class="main">)</span>"</span></span>

<span class="keyword1"><span class="command">abbreviation</span></span> <span class="entity">ground</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"trm <span class="main">⇒</span> bool"</span></span>
  <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="free">ground</span> <span class="free"><span class="bound"><span class="entity">t</span></span></span> <span class="main">≡</span> ground_aux <span class="free"><span class="bound"><span class="entity">t</span></span></span> <span class="main">{}</span>"</span></span>

<span class="keyword1"><span class="command">definition</span></span> <span class="entity">ground_fmla_aux</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"fmla <span class="main">⇒</span> atom set <span class="main">⇒</span> bool"</span></span>
  <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="free">ground_fmla_aux</span> <span class="free"><span class="bound"><span class="entity">A</span></span></span> <span class="free"><span class="bound"><span class="entity">S</span></span></span> <span class="main">≡</span> <span class="main">(</span>supp <span class="free"><span class="bound"><span class="entity">A</span></span></span> <span class="main">⊆</span> <span class="free"><span class="bound"><span class="entity">S</span></span></span><span class="main">)</span>"</span></span>

<span class="keyword1"><span class="command">abbreviation</span></span> <span class="entity">ground_fmla</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"fmla <span class="main">⇒</span> bool"</span></span>
  <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="free">ground_fmla</span> <span class="free"><span class="bound"><span class="entity">A</span></span></span> <span class="main">≡</span> ground_fmla_aux <span class="free"><span class="bound"><span class="entity">A</span></span></span> <span class="main">{}</span>"</span></span>

<span class="keyword1"><span class="command">lemma</span></span> ground_aux_simps<span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span>
  <span class="quoted"><span class="quoted">"ground_aux zer <span class="free">S</span> <span class="main">=</span> True"</span></span>
  <span class="quoted"><span class="quoted">"ground_aux <span class="main">(</span>Var <span class="free">k</span><span class="main">)</span> <span class="free">S</span> <span class="main">=</span> <span class="main">(</span><span class="keyword1">if</span> atom <span class="free">k</span> <span class="main">∈</span> <span class="free">S</span> <span class="keyword1">then</span> True <span class="keyword1">else</span> False<span class="main">)</span>"</span></span>
  <span class="quoted"><span class="quoted">"ground_aux <span class="main">(</span>suc <span class="free">t</span><span class="main">)</span> <span class="free">S</span> <span class="main">=</span> <span class="main">(</span>ground_aux <span class="free">t</span> <span class="free">S</span><span class="main">)</span>"</span></span>
  <span class="quoted"><span class="quoted">"ground_aux <span class="main">(</span>pls <span class="free">t</span> <span class="free">u</span><span class="main">)</span> <span class="free">S</span> <span class="main">=</span> <span class="main">(</span>ground_aux <span class="free">t</span> <span class="free">S</span> <span class="main">∧</span> ground_aux <span class="free">u</span> <span class="free">S</span><span class="main">)</span>"</span></span>
  <span class="quoted"><span class="quoted">"ground_aux <span class="main">(</span>tms <span class="free">t</span> <span class="free">u</span><span class="main">)</span> <span class="free">S</span> <span class="main">=</span> <span class="main">(</span>ground_aux <span class="free">t</span> <span class="free">S</span> <span class="main">∧</span> ground_aux <span class="free">u</span> <span class="free">S</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">unfolding</span></span> ground_aux_def
<span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp_all</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> supp_at_base<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> ground_fmla_aux_simps<span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span>
  <span class="quoted"><span class="quoted">"ground_fmla_aux fls <span class="free">S</span> <span class="main">=</span> True"</span></span>
  <span class="quoted"><span class="quoted">"ground_fmla_aux <span class="main">(</span><span class="free">t</span> <span class="keyword1">EQ</span> <span class="free">u</span><span class="main">)</span> <span class="free">S</span> <span class="main">=</span> <span class="main">(</span>ground_aux <span class="free">t</span> <span class="free">S</span> <span class="main">∧</span> ground_aux <span class="free">u</span> <span class="free">S</span><span class="main">)</span>"</span></span>
  <span class="quoted"><span class="quoted">"ground_fmla_aux <span class="main">(</span><span class="free">A</span> <span class="keyword1">OR</span> <span class="free">B</span><span class="main">)</span> <span class="free">S</span> <span class="main">=</span> <span class="main">(</span>ground_fmla_aux <span class="free">A</span> <span class="free">S</span> <span class="main">∧</span> ground_fmla_aux <span class="free">B</span> <span class="free">S</span><span class="main">)</span>"</span></span>
  <span class="quoted"><span class="quoted">"ground_fmla_aux <span class="main">(</span><span class="free">A</span> <span class="keyword1">AND</span> <span class="free">B</span><span class="main">)</span> <span class="free">S</span> <span class="main">=</span> <span class="main">(</span>ground_fmla_aux <span class="free">A</span> <span class="free">S</span> <span class="main">∧</span> ground_fmla_aux <span class="free">B</span> <span class="free">S</span><span class="main">)</span>"</span></span>
  <span class="quoted"><span class="quoted">"ground_fmla_aux <span class="main">(</span><span class="free">A</span> <span class="keyword1">IFF</span> <span class="free">B</span><span class="main">)</span> <span class="free">S</span> <span class="main">=</span> <span class="main">(</span>ground_fmla_aux <span class="free">A</span> <span class="free">S</span> <span class="main">∧</span> ground_fmla_aux <span class="free">B</span> <span class="free">S</span><span class="main">)</span>"</span></span>
  <span class="quoted"><span class="quoted">"ground_fmla_aux <span class="main">(</span>neg <span class="free">A</span><span class="main">)</span> <span class="free">S</span> <span class="main">=</span>  <span class="main">(</span>ground_fmla_aux <span class="free">A</span> <span class="free">S</span><span class="main">)</span>"</span></span>
  <span class="quoted"><span class="quoted">"ground_fmla_aux <span class="main">(</span>exi <span class="free">x</span> <span class="free">A</span><span class="main">)</span> <span class="free">S</span> <span class="main">=</span> <span class="main">(</span>ground_fmla_aux <span class="free">A</span> <span class="main">(</span><span class="free">S</span> <span class="main">∪</span> <span class="main">{</span>atom <span class="free">x</span><span class="main">}</span><span class="main">)</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> ground_fmla_aux_def ground_aux_def supp_conv_fresh<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> ground_fresh<span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span>
  <span class="quoted"><span class="quoted">"ground <span class="free">t</span> <span class="main">⟹</span> atom <span class="free">i</span> <span class="main">♯</span> <span class="free">t</span>"</span></span>
  <span class="quoted"><span class="quoted">"ground_fmla <span class="free">A</span> <span class="main">⟹</span> atom <span class="free">i</span> <span class="main">♯</span> <span class="free">A</span>"</span></span>
<span class="keyword1"><span class="command">unfolding</span></span> ground_aux_def ground_fmla_aux_def fresh_def
<span class="keyword1"><span class="command">by</span></span> <span class="operator">simp_all</span>

<span class="comment1">(* This applies to all nominal types, including terms and formulas: *)</span>
<span class="keyword1"><span class="command">definition</span></span> <span class="quoted"><span class="quoted">"<span class="free">Fvars</span> <span class="free"><span class="bound"><span class="entity">t</span></span></span> <span class="main">=</span> <span class="main">{</span><span class="bound">a</span> <span class="main">::</span> name<span class="main">.</span> <span class="main">¬</span> atom <span class="bound">a</span> <span class="main">♯</span> <span class="free"><span class="bound"><span class="entity">t</span></span></span><span class="main">}</span>"</span></span>

<span class="keyword1"><span class="command">lemma</span></span> Fvars_trm_simps<span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span>
  <span class="quoted"><span class="quoted">"Fvars zer <span class="main">=</span> <span class="main">{}</span>"</span></span>
  <span class="quoted"><span class="quoted">"Fvars <span class="main">(</span>Var <span class="free">a</span><span class="main">)</span> <span class="main">=</span> <span class="main">{</span><span class="free">a</span><span class="main">}</span>"</span></span>
  <span class="quoted"><span class="quoted">"Fvars <span class="main">(</span>suc <span class="free">x</span> <span class="main">)</span> <span class="main">=</span> Fvars <span class="free">x</span>"</span></span>
  <span class="quoted"><span class="quoted">"Fvars <span class="main">(</span>pls <span class="free">x</span> <span class="free">y</span><span class="main">)</span> <span class="main">=</span> Fvars <span class="free">x</span> <span class="main">∪</span> Fvars <span class="free">y</span>"</span></span>
  <span class="quoted"><span class="quoted">"Fvars <span class="main">(</span>tms <span class="free">x</span> <span class="free">y</span><span class="main">)</span> <span class="main">=</span> Fvars <span class="free">x</span> <span class="main">∪</span> Fvars <span class="free">y</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> Fvars_def fresh_at_base<span class="main"><span class="main">(</span></span>2<span class="main"><span class="main">)</span></span><span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> finite_Fvars_trm<span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span>
  <span class="keyword2"><span class="keyword">fixes</span></span> <span class="free">t</span> <span class="main">::</span> <span class="quoted">trm</span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"finite <span class="main">(</span>Fvars <span class="free">t</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">induct</span> <span class="quoted"><span class="free">t</span></span> <span class="quasi_keyword">rule</span><span class="main"><span class="main">:</span></span> trm.induct<span class="main">)</span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">lemma</span></span> Fvars_fmla_simps<span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span>
  <span class="quoted"><span class="quoted">"Fvars <span class="main">(</span><span class="free">x</span> <span class="keyword1">EQ</span> <span class="free">y</span><span class="main">)</span> <span class="main">=</span> Fvars <span class="free">x</span> <span class="main">∪</span> Fvars <span class="free">y</span>"</span></span>
  <span class="quoted"><span class="quoted">"Fvars <span class="main">(</span><span class="free">A</span> <span class="keyword1">OR</span> <span class="free">B</span><span class="main">)</span> <span class="main">=</span> Fvars <span class="free">A</span> <span class="main">∪</span> Fvars <span class="free">B</span>"</span></span>
  <span class="quoted"><span class="quoted">"Fvars <span class="main">(</span><span class="free">A</span> <span class="keyword1">AND</span> <span class="free">B</span><span class="main">)</span> <span class="main">=</span> Fvars <span class="free">A</span> <span class="main">∪</span> Fvars <span class="free">B</span>"</span></span>
  <span class="quoted"><span class="quoted">"Fvars <span class="main">(</span><span class="free">A</span> <span class="keyword1">IMP</span> <span class="free">B</span><span class="main">)</span> <span class="main">=</span> Fvars <span class="free">A</span> <span class="main">∪</span> Fvars <span class="free">B</span>"</span></span>
  <span class="quoted"><span class="quoted">"Fvars fls <span class="main">=</span> <span class="main">{}</span>"</span></span>
  <span class="quoted"><span class="quoted">"Fvars <span class="main">(</span>neg <span class="free">A</span><span class="main">)</span> <span class="main">=</span> Fvars <span class="free">A</span>"</span></span>
  <span class="quoted"><span class="quoted">"Fvars <span class="main">(</span>exi <span class="free">a</span> <span class="free">A</span><span class="main">)</span> <span class="main">=</span> Fvars <span class="free">A</span> <span class="main">-</span> <span class="main">{</span><span class="free">a</span><span class="main">}</span>"</span></span>
  <span class="quoted"><span class="quoted">"Fvars <span class="main">(</span>all <span class="free">a</span> <span class="free">A</span><span class="main">)</span> <span class="main">=</span> Fvars <span class="free">A</span> <span class="main">-</span> <span class="main">{</span><span class="free">a</span><span class="main">}</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> Fvars_def fresh_at_base<span class="main"><span class="main">(</span></span>2<span class="main"><span class="main">)</span></span><span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> finite_Fvars_fmla<span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span>
  <span class="keyword2"><span class="keyword">fixes</span></span> <span class="free">A</span> <span class="main">::</span> <span class="quoted">fmla</span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"finite <span class="main">(</span>Fvars <span class="free">A</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">induct</span> <span class="quoted"><span class="free">A</span></span> <span class="quasi_keyword">rule</span><span class="main"><span class="main">:</span></span> fmla.induct<span class="main">)</span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">lemma</span></span> subst_trm_subst_trm<span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span>
  <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main">≠</span> <span class="free">y</span> <span class="main">⟹</span> atom <span class="free">x</span> <span class="main">♯</span> <span class="free">u</span> <span class="main">⟹</span> subst <span class="free">y</span> <span class="free">u</span> <span class="main">(</span>subst <span class="free">x</span> <span class="free">t</span> <span class="free">v</span><span class="main">)</span> <span class="main">=</span> subst <span class="free">x</span> <span class="main">(</span>subst <span class="free">y</span> <span class="free">u</span> <span class="free">t</span><span class="main">)</span> <span class="main">(</span>subst <span class="free">y</span> <span class="free">u</span> <span class="free">v</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">induct</span> <span class="quoted"><span class="free">v</span></span> <span class="quasi_keyword">rule</span><span class="main"><span class="main">:</span></span> trm.induct<span class="main">)</span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">lemma</span></span> subst_fmla_subst_fmla<span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span>
  <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main">≠</span> <span class="free">y</span> <span class="main">⟹</span> atom <span class="free">x</span> <span class="main">♯</span> <span class="free">u</span> <span class="main">⟹</span> <span class="main">(</span><span class="free">A</span><span class="main">(</span><span class="free">x</span><span class="main">::=</span><span class="free">t</span><span class="main">)</span><span class="main">)</span><span class="main">(</span><span class="free">y</span><span class="main">::=</span><span class="free">u</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="free">A</span><span class="main">(</span><span class="free">y</span><span class="main">::=</span><span class="free">u</span><span class="main">)</span><span class="main">)</span><span class="main">(</span><span class="free">x</span><span class="main">::=</span>subst <span class="free">y</span> <span class="free">u</span> <span class="free">t</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">nominal_induct</span> <span class="quoted"><span class="free">A</span></span> <span class="quasi_keyword">avoiding</span><span class="main"><span class="main">:</span></span> <span class="quoted"><span class="free">x</span></span> <span class="quoted"><span class="free">t</span></span> <span class="quoted"><span class="free">y</span></span> <span class="quoted"><span class="free">u</span></span> <span class="quasi_keyword">rule</span><span class="main"><span class="main">:</span></span> fmla.strong_induct<span class="main">)</span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">lemma</span></span> Fvars_empty_ground<span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"Fvars <span class="free">t</span> <span class="main">=</span> <span class="main">{}</span> <span class="main">⟹</span> ground <span class="free">t</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">induct</span> <span class="quoted"><span class="free">t</span></span> <span class="quasi_keyword">rule</span><span class="main"><span class="main">:</span></span> trm.induct<span class="main">)</span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">lemma</span></span> Fvars_ground_aux<span class="main">:</span> <span class="quoted"><span class="quoted">"Fvars <span class="free">t</span> <span class="main">⊆</span> <span class="free">B</span> <span class="main">⟹</span> ground_aux <span class="free">t</span> <span class="main">(</span>atom <span class="main">`</span> <span class="free">B</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">induct</span> <span class="quoted"><span class="free">t</span></span> <span class="quasi_keyword">rule</span><span class="main"><span class="main">:</span></span> trm.induct<span class="main">)</span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">lemma</span></span> ground_Fvars<span class="main">:</span> <span class="quoted"><span class="quoted">"ground <span class="free">t</span> <span class="main">⟷</span> Fvars <span class="free">t</span> <span class="main">=</span> <span class="main">{}</span>"</span></span>
  <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">rule</span> iffI<span class="main">)</span>
  <span class="keyword1"><span class="command"><span class="improper"><span class="command">subgoal</span></span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">only</span><span class="main"><span class="main">:</span></span> Fvars_def ground_fresh<span class="main">)</span> <span class="main"><span class="keyword3">[</span></span><span class="main"><span class="keyword3">]</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">lemma</span></span> Fvars_ground_fmla_aux<span class="main">:</span> <span class="quoted"><span class="quoted">"Fvars <span class="free">A</span> <span class="main">⊆</span> <span class="free">B</span> <span class="main">⟹</span> ground_fmla_aux <span class="free">A</span> <span class="main">(</span>atom <span class="main">`</span> <span class="free">B</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">induct</span> <span class="quoted"><span class="free">A</span></span> <span class="quasi_keyword">arbitrary</span><span class="main"><span class="main">:</span></span> <span class="quoted"><span class="free">B</span></span> <span class="quasi_keyword">rule</span><span class="main"><span class="main">:</span></span> fmla.induct<span class="main">)</span>
  <span class="keyword1"><span class="command"><span class="improper"><span class="command">subgoal</span></span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> Diff_subset_conv Fvars_ground_aux<span class="main">)</span>
  <span class="keyword1"><span class="command"><span class="improper"><span class="command">subgoal</span></span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> Diff_subset_conv Fvars_ground_aux<span class="main">)</span>
  <span class="keyword1"><span class="command"><span class="improper"><span class="command">subgoal</span></span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> Diff_subset_conv Fvars_ground_aux<span class="main">)</span>
  <span class="keyword1"><span class="command"><span class="improper"><span class="command">subgoal</span></span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> Diff_subset_conv Fvars_fmla_simps<span class="main"><span class="main">(</span></span>7<span class="main"><span class="main">)</span></span> Un_insert_left
              Un_insert_right ground_fmla_aux_simps<span class="main"><span class="main">(</span></span>7<span class="main"><span class="main">)</span></span>
              image_insert sup_bot.left_neutral sup_bot.right_neutral<span class="main">)</span> <span class="keyword1"><span class="command">.</span></span>

<span class="keyword1"><span class="command">lemma</span></span> ground_fmla_Fvars<span class="main">:</span> <span class="quoted"><span class="quoted">"ground_fmla <span class="free">A</span> <span class="main">⟷</span> Fvars <span class="free">A</span> <span class="main">=</span> <span class="main">{}</span>"</span></span>
  <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">rule</span> iffI<span class="main">)</span>
  <span class="keyword1"><span class="command"><span class="improper"><span class="command">subgoal</span></span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">only</span><span class="main"><span class="main">:</span></span> Fvars_def ground_fresh<span class="main">)</span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">intro</span><span class="main"><span class="main">:</span></span> Fvars_ground_fmla_aux<span class="main"><span class="main">[</span></span><span class="operator">of</span> <span class="quoted"><span class="free">A</span></span> <span class="quoted"><span class="quoted">"<span class="main">{}</span>"</span></span><span class="main"><span class="main">,</span></span> <span class="operator">simplified</span><span class="main"><span class="main">]</span></span><span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> obtain_const_trm<span class="main">:</span>
<span class="keyword2"><span class="keyword">obtains</span></span> <span class="free">t</span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"eval_trm <span class="free">e</span> <span class="free">t</span> <span class="main">=</span> <span class="free">x</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="free">t</span> <span class="main">∈</span> num"</span></span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">induct</span> <span class="quoted"><span class="free">x</span></span><span class="main">)</span>
<span class="keyword1"><span class="command">using</span></span> eval_trm.simps<span class="main">(</span>1<span class="main">)</span> eval_trm.simps<span class="main">(</span>3<span class="main">)</span> num.suc <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span><span class="main"><span class="keyword3">+</span></span>

<span class="keyword1"><span class="command">lemma</span></span> ex_eval_fmla_iff_exists_num<span class="main">:</span>
  <span class="quoted"><span class="quoted">"eval_fmla <span class="free">e</span> <span class="main">(</span>exi <span class="free">k</span> <span class="free">A</span><span class="main">)</span> <span class="main">⟷</span> <span class="main">(</span><span class="main">∃</span><span class="bound">t</span><span class="main">.</span> eval_fmla <span class="free">e</span> <span class="main">(</span><span class="free">A</span><span class="main">(</span><span class="free">k</span><span class="main">::=</span><span class="bound">t</span><span class="main">)</span><span class="main">)</span> <span class="main">∧</span> <span class="bound">t</span> <span class="main">∈</span> num<span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> eval_subst_fmla<span class="main">)</span> <span class="main">(</span><span class="operator">metis</span> obtain_const_trm<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> exi_ren<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">y</span> <span class="main">∉</span> Fvars <span class="free">φ</span> <span class="main">⟹</span> exi <span class="free">x</span> <span class="free">φ</span> <span class="main">=</span> exi <span class="free">y</span> <span class="main">(</span><span class="free">φ</span><span class="main">(</span><span class="free">x</span><span class="main">::=</span>Var <span class="free">y</span><span class="main">)</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">using</span></span> exi_ren_subst_fresh Fvars_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>

<span class="keyword1"><span class="command">lemma</span></span> all_ren<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">y</span> <span class="main">∉</span> Fvars <span class="free">φ</span> <span class="main">⟹</span> all <span class="free">x</span> <span class="free">φ</span> <span class="main">=</span> all <span class="free">y</span> <span class="main">(</span><span class="free">φ</span><span class="main">(</span><span class="free">x</span><span class="main">::=</span>Var <span class="free">y</span><span class="main">)</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> exi_ren<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> Fvars_num<span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">t</span> <span class="main">∈</span> num <span class="main">⟹</span> Fvars <span class="free">t</span> <span class="main">=</span> <span class="main">{}</span>"</span></span>
<span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">induct</span> <span class="quoted"><span class="free">t</span></span> <span class="quasi_keyword">rule</span><span class="main"><span class="main">:</span></span> trm.induct<span class="main">)</span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">elim</span><span class="main"><span class="main">:</span></span> num.cases<span class="main">)</span>

<span class="keyword1"><span class="command">subsection</span></span> <span class="quoted"><span class="plain_text">‹Instantiation of the generic syntax and deduction relation›</span></span>

<span class="keyword1"><span class="command">interpretation</span></span> Generic_Syntax <span class="keyword2"><span class="keyword">where</span></span>
      var <span class="main">=</span> <span class="quoted"><span class="quoted">"UNIV <span class="main">::</span> name set"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> trm <span class="main">=</span> <span class="quoted"><span class="quoted">"UNIV <span class="main">::</span> trm set"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> fmla <span class="main">=</span> <span class="quoted"><span class="quoted">"UNIV <span class="main">::</span> fmla set"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> Var <span class="main">=</span> <span class="quoted">Var</span>
  <span class="keyword2"><span class="keyword">and</span></span> FvarsT <span class="main">=</span> <span class="quoted">Fvars</span>
  <span class="keyword2"><span class="keyword">and</span></span> substT <span class="main">=</span> <span class="quoted"><span class="quoted">"<span class="main">λ</span><span class="bound">t</span> <span class="bound">u</span> <span class="bound">x</span><span class="main">.</span> subst <span class="bound">x</span> <span class="bound">u</span> <span class="bound">t</span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> Fvars <span class="main">=</span> <span class="quoted">Fvars</span>
  <span class="keyword2"><span class="keyword">and</span></span> subst <span class="main">=</span> <span class="quoted"><span class="quoted">"<span class="main">λ</span><span class="bound">A</span> <span class="bound">u</span> <span class="bound">x</span><span class="main">.</span> subst_fmla <span class="bound">A</span> <span class="bound">x</span> <span class="bound">u</span>"</span></span>
  <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="operator">unfold_locales</span>
  <span class="keyword1"><span class="command"><span class="improper"><span class="command">subgoal</span></span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command"><span class="improper"><span class="command">subgoal</span></span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command"><span class="improper"><span class="command">subgoal</span></span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command"><span class="improper"><span class="command">subgoal</span></span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command"><span class="improper"><span class="command">subgoal</span></span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command"><span class="improper"><span class="command">subgoal</span></span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command"><span class="improper"><span class="command">subgoal</span></span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command"><span class="improper"><span class="command">subgoal</span></span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command"><span class="improper"><span class="command">subgoal</span></span></span></span> <span class="keyword2"><span class="keyword">for</span></span> t <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">induct</span> <span class="quoted"><span class="skolem">t</span></span> <span class="quasi_keyword">rule</span><span class="main"><span class="main">:</span></span> trm.induct<span class="main">)</span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command"><span class="improper"><span class="command">subgoal</span></span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command"><span class="improper"><span class="command">subgoal</span></span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command"><span class="improper"><span class="command">subgoal</span></span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command"><span class="improper"><span class="command">subgoal</span></span></span></span> <span class="keyword1"><span class="command">unfolding</span></span> Fvars_def fresh_subst_fmla_if <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command"><span class="improper"><span class="command">subgoal</span></span></span></span> <span class="keyword1"><span class="command">unfolding</span></span> Fvars_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command"><span class="improper"><span class="command">subgoal</span></span></span></span> <span class="keyword1"><span class="command">unfolding</span></span> Fvars_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command"><span class="improper"><span class="command">subgoal</span></span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command"><span class="improper"><span class="command">subgoal</span></span></span></span> <span class="keyword1"><span class="command">unfolding</span></span> Fvars_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span> <span class="keyword1"><span class="command">.</span></span>

<span class="keyword1"><span class="command">interpretation</span></span> Syntax_with_Numerals <span class="keyword2"><span class="keyword">where</span></span>
      var <span class="main">=</span> <span class="quoted"><span class="quoted">"UNIV <span class="main">::</span> name set"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> trm <span class="main">=</span> <span class="quoted"><span class="quoted">"UNIV <span class="main">::</span> trm set"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> fmla <span class="main">=</span> <span class="quoted"><span class="quoted">"UNIV <span class="main">::</span> fmla set"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> num <span class="main">=</span> <span class="quoted">num</span>
  <span class="keyword2"><span class="keyword">and</span></span> Var <span class="main">=</span> <span class="quoted">Var</span>
  <span class="keyword2"><span class="keyword">and</span></span> FvarsT <span class="main">=</span> <span class="quoted">Fvars</span>
  <span class="keyword2"><span class="keyword">and</span></span> substT <span class="main">=</span> <span class="quoted"><span class="quoted">"<span class="main">λ</span><span class="bound">t</span> <span class="bound">u</span> <span class="bound">x</span><span class="main">.</span> subst <span class="bound">x</span> <span class="bound">u</span> <span class="bound">t</span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> Fvars <span class="main">=</span> <span class="quoted">Fvars</span>
  <span class="keyword2"><span class="keyword">and</span></span> subst <span class="main">=</span> <span class="quoted"><span class="quoted">"<span class="main">λ</span><span class="bound">A</span> <span class="bound">u</span> <span class="bound">x</span><span class="main">.</span> subst_fmla <span class="bound">A</span> <span class="bound">x</span> <span class="bound">u</span>"</span></span>
  <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="operator">unfold_locales</span>
  <span class="keyword1"><span class="command"><span class="improper"><span class="command">subgoal</span></span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">intro</span><span class="main"><span class="main">!</span></span><span class="main"><span class="main">:</span></span> exI<span class="main"><span class="main">[</span></span><span class="operator">of</span> <span class="main"><span class="main">_</span></span> <span class="quoted">zer</span><span class="main"><span class="main">]</span></span><span class="main">)</span>
  <span class="keyword1"><span class="command"><span class="improper"><span class="command">subgoal</span></span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command"><span class="improper"><span class="command">subgoal</span></span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> ground_Fvars<span class="main">)</span> <span class="keyword1"><span class="command">.</span></span>

<span class="keyword1"><span class="command">interpretation</span></span> Deduct_with_False <span class="keyword2"><span class="keyword">where</span></span>
      var <span class="main">=</span> <span class="quoted"><span class="quoted">"UNIV <span class="main">::</span> name set"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> trm <span class="main">=</span> <span class="quoted"><span class="quoted">"UNIV <span class="main">::</span> trm set"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> fmla <span class="main">=</span> <span class="quoted"><span class="quoted">"UNIV <span class="main">::</span> fmla set"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> num <span class="main">=</span> <span class="quoted">num</span>
  <span class="keyword2"><span class="keyword">and</span></span> Var <span class="main">=</span> <span class="quoted">Var</span>
  <span class="keyword2"><span class="keyword">and</span></span> FvarsT <span class="main">=</span> <span class="quoted">Fvars</span>
  <span class="keyword2"><span class="keyword">and</span></span> substT <span class="main">=</span> <span class="quoted"><span class="quoted">"<span class="main">λ</span><span class="bound">t</span> <span class="bound">u</span> <span class="bound">x</span><span class="main">.</span> subst <span class="bound">x</span> <span class="bound">u</span> <span class="bound">t</span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> Fvars <span class="main">=</span> <span class="quoted">Fvars</span>
  <span class="keyword2"><span class="keyword">and</span></span> subst <span class="main">=</span> <span class="quoted"><span class="quoted">"<span class="main">λ</span><span class="bound">A</span> <span class="bound">u</span> <span class="bound">x</span><span class="main">.</span> subst_fmla <span class="bound">A</span> <span class="bound">x</span> <span class="bound">u</span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> eql <span class="main">=</span> <span class="quoted">eql</span> <span class="keyword2"><span class="keyword">and</span></span> cnj <span class="main">=</span> <span class="quoted">cnj</span> <span class="keyword2"><span class="keyword">and</span></span> imp <span class="main">=</span> <span class="quoted">imp</span> <span class="keyword2"><span class="keyword">and</span></span> all <span class="main">=</span> <span class="quoted">all</span>
  <span class="keyword2"><span class="keyword">and</span></span> exi <span class="main">=</span> <span class="quoted">exi</span> <span class="keyword2"><span class="keyword">and</span></span> fls <span class="main">=</span> <span class="quoted">fls</span>
  <span class="keyword2"><span class="keyword">and</span></span> prv <span class="main">=</span> <span class="quoted"><span class="quoted">"<span class="main">(⊢)</span> <span class="main">{}</span>"</span></span>
  <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="operator">unfold_locales</span>
  <span class="keyword1"><span class="command"><span class="improper"><span class="command">subgoal</span></span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command"><span class="improper"><span class="command">subgoal</span></span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command"><span class="improper"><span class="command">subgoal</span></span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command"><span class="improper"><span class="command">subgoal</span></span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command"><span class="improper"><span class="command">subgoal</span></span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command"><span class="improper"><span class="command">subgoal</span></span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command"><span class="improper"><span class="command">subgoal</span></span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command"><span class="improper"><span class="command">subgoal</span></span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command"><span class="improper"><span class="command">subgoal</span></span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command"><span class="improper"><span class="command">subgoal</span></span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command"><span class="improper"><span class="command">subgoal</span></span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command"><span class="improper"><span class="command">subgoal</span></span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command"><span class="improper"><span class="command">subgoal</span></span></span></span> <span class="keyword1"><span class="command">unfolding</span></span> Fvars_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command"><span class="improper"><span class="command">subgoal</span></span></span></span> <span class="keyword1"><span class="command">unfolding</span></span> Fvars_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command"><span class="improper"><span class="command">subgoal</span></span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command"><span class="improper"><span class="command">subgoal</span></span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command"><span class="improper"><span class="command">subgoal</span></span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command"><span class="improper"><span class="command">subgoal</span></span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command"><span class="improper"><span class="command">subgoal</span></span></span></span> <span class="keyword1"><span class="command">using</span></span> MP_null <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command"><span class="improper"><span class="command">subgoal</span></span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command"><span class="improper"><span class="command">subgoal</span></span></span></span> <span class="keyword2"><span class="keyword">for</span></span> A B C
    <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">rule</span> imp_I<span class="main">)</span><span class="main"><span class="keyword3">+</span></span>
    <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">rule</span> MP_same<span class="main"><span class="main">[</span></span><span class="operator">of</span> <span class="main"><span class="main">_</span></span> <span class="quoted"><span class="skolem">B</span></span><span class="main"><span class="main">]</span></span><span class="main">)</span>
     <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">rule</span> MP_same<span class="main"><span class="main">[</span></span><span class="operator">of</span> <span class="main"><span class="main">_</span></span> <span class="quoted"><span class="skolem">C</span></span><span class="main"><span class="main">]</span></span><span class="main">)</span>
      <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">intro</span><span class="main"><span class="main">:</span></span> neg_D<span class="main">)</span> <span class="keyword1"><span class="command">.</span></span>
  <span class="keyword1"><span class="command"><span class="improper"><span class="command">subgoal</span></span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command"><span class="improper"><span class="command">subgoal</span></span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command"><span class="improper"><span class="command">subgoal</span></span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command"><span class="improper"><span class="command">subgoal</span></span></span></span> <span class="keyword1"><span class="command">unfolding</span></span> Fvars_def <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">intro</span><span class="main"><span class="main">:</span></span> MP_null<span class="main">)</span>
  <span class="keyword1"><span class="command"><span class="improper"><span class="command">subgoal</span></span></span></span> <span class="keyword1"><span class="command">unfolding</span></span> Fvars_def <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">intro</span><span class="main"><span class="main">:</span></span> MP_null<span class="main">)</span>
  <span class="keyword1"><span class="command"><span class="improper"><span class="command">subgoal</span></span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">intro</span><span class="main"><span class="main">:</span></span> all_D<span class="main">)</span>
  <span class="keyword1"><span class="command"><span class="improper"><span class="command">subgoal</span></span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">intro</span><span class="main"><span class="main">:</span></span> exi_I<span class="main">)</span>
  <span class="keyword1"><span class="command"><span class="improper"><span class="command">subgoal</span></span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command"><span class="improper"><span class="command">subgoal</span></span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> cnj_E2 Iff_def imp_I Var_eql_subst_Iff<span class="main">)</span>
  <span class="keyword1"><span class="command"><span class="improper"><span class="command">subgoal</span></span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span> <span class="keyword1"><span class="command">.</span></span>

<span class="keyword1"><span class="command">interpretation</span></span> Deduct_with_False_Disj <span class="keyword2"><span class="keyword">where</span></span>
      var <span class="main">=</span> <span class="quoted"><span class="quoted">"UNIV <span class="main">::</span> name set"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> trm <span class="main">=</span> <span class="quoted"><span class="quoted">"UNIV <span class="main">::</span> trm set"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> fmla <span class="main">=</span> <span class="quoted"><span class="quoted">"UNIV <span class="main">::</span> fmla set"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> num <span class="main">=</span> <span class="quoted">num</span>
  <span class="keyword2"><span class="keyword">and</span></span> Var <span class="main">=</span> <span class="quoted">Var</span>
  <span class="keyword2"><span class="keyword">and</span></span> FvarsT <span class="main">=</span> <span class="quoted">Fvars</span>
  <span class="keyword2"><span class="keyword">and</span></span> substT <span class="main">=</span> <span class="quoted"><span class="quoted">"<span class="main">λ</span><span class="bound">t</span> <span class="bound">u</span> <span class="bound">x</span><span class="main">.</span> subst <span class="bound">x</span> <span class="bound">u</span> <span class="bound">t</span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> Fvars <span class="main">=</span> <span class="quoted">Fvars</span>
  <span class="keyword2"><span class="keyword">and</span></span> subst <span class="main">=</span> <span class="quoted"><span class="quoted">"<span class="main">λ</span><span class="bound">A</span> <span class="bound">u</span> <span class="bound">x</span><span class="main">.</span> subst_fmla <span class="bound">A</span> <span class="bound">x</span> <span class="bound">u</span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> eql <span class="main">=</span> <span class="quoted">eql</span> <span class="keyword2"><span class="keyword">and</span></span> cnj <span class="main">=</span> <span class="quoted">cnj</span> <span class="keyword2"><span class="keyword">and</span></span> dsj <span class="main">=</span> <span class="quoted">dsj</span> <span class="keyword2"><span class="keyword">and</span></span> imp <span class="main">=</span> <span class="quoted">imp</span>
  <span class="keyword2"><span class="keyword">and</span></span> all <span class="main">=</span> <span class="quoted">all</span> <span class="keyword2"><span class="keyword">and</span></span> exi <span class="main">=</span> <span class="quoted">exi</span> <span class="keyword2"><span class="keyword">and</span></span> fls <span class="main">=</span> <span class="quoted">fls</span>
  <span class="keyword2"><span class="keyword">and</span></span> prv <span class="main">=</span> <span class="quoted"><span class="quoted">"<span class="main">(⊢)</span> <span class="main">{}</span>"</span></span>
  <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="operator">unfold_locales</span>
  <span class="keyword1"><span class="command"><span class="improper"><span class="command">subgoal</span></span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command"><span class="improper"><span class="command">subgoal</span></span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command"><span class="improper"><span class="command">subgoal</span></span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command"><span class="improper"><span class="command">subgoal</span></span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">intro</span><span class="main"><span class="main">:</span></span> dsj_I1<span class="main">)</span>
  <span class="keyword1"><span class="command"><span class="improper"><span class="command">subgoal</span></span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">intro</span><span class="main"><span class="main">:</span></span> dsj_I2<span class="main">)</span>
  <span class="keyword1"><span class="command"><span class="improper"><span class="command">subgoal</span></span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">intro</span><span class="main"><span class="main">:</span></span> ContraAssume<span class="main">)</span> <span class="keyword1"><span class="command">.</span></span>


<span class="keyword1"><span class="command">subsection</span></span> <span class="quoted"><span class="plain_text">‹Instantiation of the arithmetic-enriched generic syntax and deduction relation›</span></span>

<span class="keyword1"><span class="command">interpretation</span></span> Syntax_Arith_aux <span class="keyword2"><span class="keyword">where</span></span>
      var <span class="main">=</span> <span class="quoted"><span class="quoted">"UNIV <span class="main">::</span> name set"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> trm <span class="main">=</span> <span class="quoted"><span class="quoted">"UNIV <span class="main">::</span> trm set"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> fmla <span class="main">=</span> <span class="quoted"><span class="quoted">"UNIV <span class="main">::</span> fmla set"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> num <span class="main">=</span> <span class="quoted">num</span>
  <span class="keyword2"><span class="keyword">and</span></span> Var <span class="main">=</span> <span class="quoted">Var</span>
  <span class="keyword2"><span class="keyword">and</span></span> FvarsT <span class="main">=</span> <span class="quoted">Fvars</span>
  <span class="keyword2"><span class="keyword">and</span></span> substT <span class="main">=</span> <span class="quoted"><span class="quoted">"<span class="main">λ</span><span class="bound">t</span> <span class="bound">u</span> <span class="bound">x</span><span class="main">.</span> subst <span class="bound">x</span> <span class="bound">u</span> <span class="bound">t</span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> Fvars <span class="main">=</span> <span class="quoted">Fvars</span>
  <span class="keyword2"><span class="keyword">and</span></span> subst <span class="main">=</span> <span class="quoted"><span class="quoted">"<span class="main">λ</span><span class="bound">A</span> <span class="bound">u</span> <span class="bound">x</span><span class="main">.</span> subst_fmla <span class="bound">A</span> <span class="bound">x</span> <span class="bound">u</span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> eql <span class="main">=</span> <span class="quoted">eql</span> <span class="keyword2"><span class="keyword">and</span></span> cnj <span class="main">=</span> <span class="quoted">cnj</span> <span class="keyword2"><span class="keyword">and</span></span> imp <span class="main">=</span> <span class="quoted">imp</span> <span class="keyword2"><span class="keyword">and</span></span> all <span class="main">=</span> <span class="quoted">all</span>
  <span class="keyword2"><span class="keyword">and</span></span> exi <span class="main">=</span> <span class="quoted">exi</span> <span class="keyword2"><span class="keyword">and</span></span> dsj <span class="main">=</span> <span class="quoted">dsj</span> <span class="keyword2"><span class="keyword">and</span></span> fls <span class="main">=</span> <span class="quoted">fls</span>
  <span class="keyword2"><span class="keyword">and</span></span> zer <span class="main">=</span> <span class="quoted">zer</span> <span class="keyword2"><span class="keyword">and</span></span> suc <span class="main">=</span> <span class="quoted">suc</span> <span class="keyword2"><span class="keyword">and</span></span> pls <span class="main">=</span> <span class="quoted">pls</span> <span class="keyword2"><span class="keyword">and</span></span> tms <span class="main">=</span> <span class="quoted">tms</span>
  <span class="keyword1"><span class="command">by</span></span> <span class="operator">unfold_locales</span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> exi_ren all_ren<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> num_range_Num<span class="main">:</span> <span class="quoted"><span class="quoted">"num <span class="main">=</span> range Num"</span></span>
<span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
  <span class="keyword1"><span class="command">{</span></span><span class="keyword3"><span class="command">fix</span></span> <span class="skolem">t</span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">t</span> <span class="main">∈</span> num"</span></span>
   <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound">n</span><span class="main">.</span> <span class="skolem">t</span> <span class="main">=</span> Num <span class="bound">n</span>"</span></span>
   <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="main">(</span><span class="operator">induct</span> <span class="quoted"><span class="skolem">t</span></span> <span class="quasi_keyword">rule</span><span class="main"><span class="main">:</span></span> trm.induct<span class="main">)</span>
   <span class="keyword1"><span class="command"><span class="improper"><span class="command">subgoal</span></span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">intro</span><span class="main"><span class="main">:</span></span> exI<span class="main"><span class="main">[</span></span><span class="operator">of</span> <span class="main"><span class="main">_</span></span> <span class="quoted"><span class="main">0</span></span><span class="main"><span class="main">]</span></span><span class="main">)</span>
   <span class="keyword1"><span class="command"><span class="improper"><span class="command">subgoal</span></span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">elim</span><span class="main"><span class="main">:</span></span> num.cases<span class="main">)</span>
   <span class="keyword1"><span class="command"><span class="improper"><span class="command">subgoal</span></span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> Num.simps<span class="main"><span class="main">(</span></span>2<span class="main"><span class="main">)</span></span> num.cases trm.distinct<span class="main"><span class="main">(</span></span>3<span class="main"><span class="main">)</span></span> trm.eq_iff<span class="main"><span class="main">(</span></span>3<span class="main"><span class="main">)</span></span><span class="main">)</span>
   <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">elim</span><span class="main"><span class="main">:</span></span> num.cases<span class="main">)</span>
  <span class="keyword1"><span class="command">}</span></span>
  <span class="keyword1"><span class="command">moreover</span></span>
  <span class="keyword1"><span class="command">{</span></span><span class="keyword3"><span class="command">fix</span></span> <span class="skolem">n</span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"Num <span class="skolem">n</span> <span class="main">∈</span> num"</span></span>
   <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">induct</span> <span class="quoted"><span class="skolem">n</span></span><span class="main">)</span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">}</span></span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">{}</span> <span class="main">⊢</span> neg <span class="main">(</span>zer <span class="keyword1">EQ</span> suc <span class="main">(</span>Var xx<span class="main">)</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> 0<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">{}</span> <span class="main">⊢</span> Robinson_Arithmetic.neg <span class="main">(</span>zer <span class="keyword1">EQ</span> suc <span class="main">(</span>Var xx<span class="main">)</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">intro</span> nprv.Q<span class="main">)</span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">intro</span><span class="main"><span class="main">!</span></span><span class="main"><span class="main">:</span></span> exI<span class="main"><span class="main">[</span></span><span class="operator">of</span> <span class="main"><span class="main">_</span></span> <span class="quoted">zz</span><span class="main"><span class="main">]</span></span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> Q_axioms_def<span class="main">)</span>
  <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">unfolding</span></span> neg_def
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> 0 dsj_I1<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">{}</span> <span class="main">⊢</span> Var yy <span class="keyword1">EQ</span> zer <span class="keyword1">OR</span> exi xx <span class="main">(</span>Var yy <span class="keyword1">EQ</span> suc <span class="main">(</span>Var xx<span class="main">)</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">intro</span> nprv.Q<span class="main">)</span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">intro</span><span class="main"><span class="main">!</span></span><span class="main"><span class="main">:</span></span> exI<span class="main"><span class="main">[</span></span><span class="operator">of</span> <span class="main"><span class="main">_</span></span> <span class="quoted">zz</span><span class="main"><span class="main">]</span></span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> Q_axioms_def<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">{}</span> <span class="main">⊢</span> pls <span class="main">(</span>Var xx<span class="main">)</span> zer <span class="keyword1">EQ</span> Var xx"</span></span>
<span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">intro</span> nprv.Q<span class="main">)</span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">intro</span><span class="main"><span class="main">!</span></span><span class="main"><span class="main">:</span></span> exI<span class="main"><span class="main">[</span></span><span class="operator">of</span> <span class="main"><span class="main">_</span></span> <span class="quoted">zz</span><span class="main"><span class="main">]</span></span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> Q_axioms_def<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">{}</span> <span class="main">⊢</span> tms <span class="main">(</span>Var xx<span class="main">)</span> zer <span class="keyword1">EQ</span> zer"</span></span>
<span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">intro</span> nprv.Q<span class="main">)</span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">intro</span><span class="main"><span class="main">!</span></span><span class="main"><span class="main">:</span></span> exI<span class="main"><span class="main">[</span></span><span class="operator">of</span> <span class="main"><span class="main">_</span></span> <span class="quoted">zz</span><span class="main"><span class="main">]</span></span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> Q_axioms_def<span class="main">)</span>

<span class="keyword1"><span class="command">interpretation</span></span> S<span class="main">:</span> Syntax_Arith <span class="keyword2"><span class="keyword">where</span></span>
      var <span class="main">=</span> <span class="quoted"><span class="quoted">"UNIV <span class="main">::</span> name set"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> trm <span class="main">=</span> <span class="quoted"><span class="quoted">"UNIV <span class="main">::</span> trm set"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> fmla <span class="main">=</span> <span class="quoted"><span class="quoted">"UNIV <span class="main">::</span> fmla set"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> num <span class="main">=</span> <span class="quoted">num</span>
  <span class="keyword2"><span class="keyword">and</span></span> Var <span class="main">=</span> <span class="quoted">Var</span>
  <span class="keyword2"><span class="keyword">and</span></span> FvarsT <span class="main">=</span> <span class="quoted">Fvars</span>
  <span class="keyword2"><span class="keyword">and</span></span> substT <span class="main">=</span> <span class="quoted"><span class="quoted">"<span class="main">λ</span><span class="bound">t</span> <span class="bound">u</span> <span class="bound">x</span><span class="main">.</span> subst <span class="bound">x</span> <span class="bound">u</span> <span class="bound">t</span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> Fvars <span class="main">=</span> <span class="quoted">Fvars</span>
  <span class="keyword2"><span class="keyword">and</span></span> subst <span class="main">=</span> <span class="quoted"><span class="quoted">"<span class="main">λ</span><span class="bound">A</span> <span class="bound">u</span> <span class="bound">x</span><span class="main">.</span> subst_fmla <span class="bound">A</span> <span class="bound">x</span> <span class="bound">u</span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> eql <span class="main">=</span> <span class="quoted">eql</span> <span class="keyword2"><span class="keyword">and</span></span> cnj <span class="main">=</span> <span class="quoted">cnj</span> <span class="keyword2"><span class="keyword">and</span></span> imp <span class="main">=</span> <span class="quoted">imp</span> <span class="keyword2"><span class="keyword">and</span></span> all <span class="main">=</span> <span class="quoted">all</span>
  <span class="keyword2"><span class="keyword">and</span></span> exi <span class="main">=</span> <span class="quoted">exi</span> <span class="keyword2"><span class="keyword">and</span></span> dsj <span class="main">=</span> <span class="quoted">dsj</span> <span class="keyword2"><span class="keyword">and</span></span> fls <span class="main">=</span> <span class="quoted">fls</span> <span class="keyword2"><span class="keyword">and</span></span> zer <span class="main">=</span> <span class="quoted">zer</span>
  <span class="keyword2"><span class="keyword">and</span></span> suc <span class="main">=</span> <span class="quoted">suc</span> <span class="keyword2"><span class="keyword">and</span></span> pls <span class="main">=</span> <span class="quoted">pls</span> <span class="keyword2"><span class="keyword">and</span></span> tms <span class="main">=</span> <span class="quoted">tms</span>
  <span class="keyword1"><span class="command">using</span></span> num_range_Num <span class="keyword1"><span class="command">by</span></span> <span class="operator">unfold_locales</span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">interpretation</span></span> Deduct_Q <span class="keyword2"><span class="keyword">where</span></span>
      var <span class="main">=</span> <span class="quoted"><span class="quoted">"UNIV <span class="main">::</span> name set"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> trm <span class="main">=</span> <span class="quoted"><span class="quoted">"UNIV <span class="main">::</span> trm set"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> fmla <span class="main">=</span> <span class="quoted"><span class="quoted">"UNIV <span class="main">::</span> fmla set"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> num <span class="main">=</span> <span class="quoted">num</span>
  <span class="keyword2"><span class="keyword">and</span></span> Var <span class="main">=</span> <span class="quoted">Var</span>
  <span class="keyword2"><span class="keyword">and</span></span> FvarsT <span class="main">=</span> <span class="quoted">Fvars</span>
  <span class="keyword2"><span class="keyword">and</span></span> substT <span class="main">=</span> <span class="quoted"><span class="quoted">"<span class="main">λ</span><span class="bound">t</span> <span class="bound">u</span> <span class="bound">x</span><span class="main">.</span> subst <span class="bound">x</span> <span class="bound">u</span> <span class="bound">t</span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> Fvars <span class="main">=</span> <span class="quoted">Fvars</span>
  <span class="keyword2"><span class="keyword">and</span></span> subst <span class="main">=</span> <span class="quoted"><span class="quoted">"<span class="main">λ</span><span class="bound">A</span> <span class="bound">u</span> <span class="bound">x</span><span class="main">.</span> subst_fmla <span class="bound">A</span> <span class="bound">x</span> <span class="bound">u</span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> eql <span class="main">=</span> <span class="quoted">eql</span> <span class="keyword2"><span class="keyword">and</span></span> cnj <span class="main">=</span> <span class="quoted">cnj</span> <span class="keyword2"><span class="keyword">and</span></span> imp <span class="main">=</span> <span class="quoted">imp</span> <span class="keyword2"><span class="keyword">and</span></span> all <span class="main">=</span> <span class="quoted">all</span>
  <span class="keyword2"><span class="keyword">and</span></span> exi <span class="main">=</span> <span class="quoted">exi</span> <span class="keyword2"><span class="keyword">and</span></span> dsj <span class="main">=</span> <span class="quoted">dsj</span> <span class="keyword2"><span class="keyword">and</span></span> fls <span class="main">=</span> <span class="quoted">fls</span> <span class="keyword2"><span class="keyword">and</span></span> zer <span class="main">=</span> <span class="quoted">zer</span>
  <span class="keyword2"><span class="keyword">and</span></span> suc <span class="main">=</span> <span class="quoted">suc</span> <span class="keyword2"><span class="keyword">and</span></span> pls <span class="main">=</span> <span class="quoted">pls</span> <span class="keyword2"><span class="keyword">and</span></span> tms <span class="main">=</span> <span class="quoted">tms</span>
  <span class="keyword2"><span class="keyword">and</span></span> prv <span class="main">=</span> <span class="quoted"><span class="quoted">"<span class="main">(⊢)</span> <span class="main">{}</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="operator">unfold_locales</span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> Q Q_axioms_def<span class="main">)</span>

<span class="keyword1"><span class="command">subsection</span></span> <span class="quoted"><span class="plain_text">‹Instantiation of the abstract notion of standard model and truth›</span></span>

<span class="keyword1"><span class="command">interpretation</span></span> Minimal_Truth_Soundness <span class="keyword2"><span class="keyword">where</span></span>
      var <span class="main">=</span> <span class="quoted"><span class="quoted">"UNIV <span class="main">::</span> name set"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> trm <span class="main">=</span> <span class="quoted"><span class="quoted">"UNIV <span class="main">::</span> trm set"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> fmla <span class="main">=</span> <span class="quoted"><span class="quoted">"UNIV <span class="main">::</span> fmla set"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> num <span class="main">=</span> <span class="quoted">num</span>
  <span class="keyword2"><span class="keyword">and</span></span> Var <span class="main">=</span> <span class="quoted">Var</span>
  <span class="keyword2"><span class="keyword">and</span></span> FvarsT <span class="main">=</span> <span class="quoted">Fvars</span>
  <span class="keyword2"><span class="keyword">and</span></span> substT <span class="main">=</span> <span class="quoted"><span class="quoted">"<span class="main">λ</span><span class="bound">t</span> <span class="bound">u</span> <span class="bound">x</span><span class="main">.</span> subst <span class="bound">x</span> <span class="bound">u</span> <span class="bound">t</span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> Fvars <span class="main">=</span> <span class="quoted">Fvars</span>
  <span class="keyword2"><span class="keyword">and</span></span> subst <span class="main">=</span> <span class="quoted"><span class="quoted">"<span class="main">λ</span><span class="bound">A</span> <span class="bound">u</span> <span class="bound">x</span><span class="main">.</span> subst_fmla <span class="bound">A</span> <span class="bound">x</span> <span class="bound">u</span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> eql <span class="main">=</span> <span class="quoted">eql</span> <span class="keyword2"><span class="keyword">and</span></span> cnj <span class="main">=</span> <span class="quoted">cnj</span> <span class="keyword2"><span class="keyword">and</span></span> dsj <span class="main">=</span> <span class="quoted">dsj</span> <span class="keyword2"><span class="keyword">and</span></span> imp <span class="main">=</span> <span class="quoted">imp</span>
  <span class="keyword2"><span class="keyword">and</span></span> all <span class="main">=</span> <span class="quoted">all</span> <span class="keyword2"><span class="keyword">and</span></span> exi <span class="main">=</span> <span class="quoted">exi</span> <span class="keyword2"><span class="keyword">and</span></span> fls <span class="main">=</span> <span class="quoted">fls</span>
  <span class="keyword2"><span class="keyword">and</span></span> prv <span class="main">=</span> <span class="quoted"><span class="quoted">"<span class="main">(⊢)</span> <span class="main">{}</span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> isTrue <span class="main">=</span> <span class="quoted"><span class="quoted">"eval_fmla e0"</span></span>
  <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="operator">unfold_locales</span>
  <span class="keyword1"><span class="command"><span class="improper"><span class="command">subgoal</span></span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> fls_def<span class="main">)</span>
  <span class="keyword1"><span class="command"><span class="improper"><span class="command">subgoal</span></span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command"><span class="improper"><span class="command">subgoal</span></span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">only</span><span class="main"><span class="main">:</span></span> ex_eval_fmla_iff_exists_num eval_fmla.simps  subst_fmla.simps<span class="main">)</span>
  <span class="keyword1"><span class="command"><span class="improper"><span class="command">subgoal</span></span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">only</span><span class="main"><span class="main">:</span></span> ex_eval_fmla_iff_exists_num<span class="main">)</span>
  <span class="keyword1"><span class="command"><span class="improper"><span class="command">subgoal</span></span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> neg_def<span class="main">)</span>
  <span class="keyword1"><span class="command"><span class="improper"><span class="command">subgoal</span></span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">dest</span><span class="main"><span class="main">:</span></span> nprv_sound<span class="main">)</span> <span class="keyword1"><span class="command">.</span></span>

<span class="comment1">(*&lt;*)</span>
<span class="keyword2"><span class="keyword">end</span></span>
<span class="comment1">(*&gt;*)</span>
</pre>
</div>
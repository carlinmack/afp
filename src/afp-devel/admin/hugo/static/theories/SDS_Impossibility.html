<div id="SDS_Impossibility">
<div class="head">
<h1>Theory SDS_Impossibility</h1>
</div>
<pre class="source"><span class="comment1">(*
  File:   SDS_Impossibility.thy
  Author: Manuel Eberl &lt;eberlm@in.tum.de&gt;

  The proof that there exists no anonymous and neutral SDS for at least 
  four voters and alternatives that satisfies SD-Efficiency and 
  SD-Strategy-Proofness.
*)</span>

<span class="keyword1"><span class="command">section</span></span> <span class="quoted"><span class="plain_text">‹Incompatibility of SD-Efficiency and SD-Strategy-Proofness›</span></span>

<span class="keyword1"><span class="command">theory</span></span> SDS_Impossibility
<span class="keyword2"><span class="keyword">imports</span></span>
  <a href="../Randomised_Social_Choice/SDS_Automation.html">Randomised_Social_Choice.SDS_Automation</a>
  <a href="../Randomised_Social_Choice/Randomised_Social_Choice.html">Randomised_Social_Choice.Randomised_Social_Choice</a>
<span class="keyword2"><span class="keyword">begin</span></span>

<span class="keyword1"><span class="command">subsection</span></span> <span class="quoted"><span class="plain_text">‹Preliminary Definitions›</span></span>

<span class="keyword1"><span class="command">locale</span></span> sds_impossibility <span class="main">=</span> 
  anonymous_sds <span class="quoted"><span class="free">agents</span></span> <span class="quoted"><span class="free">alts</span></span> <span class="quoted"><span class="free">sds</span></span> <span class="main">+</span>
  neutral_sds <span class="quoted"><span class="free">agents</span></span> <span class="quoted"><span class="free">alts</span></span> <span class="quoted"><span class="free">sds</span></span> <span class="main">+</span>
  sd_efficient_sds <span class="quoted"><span class="free">agents</span></span> <span class="quoted"><span class="free">alts</span></span> <span class="quoted"><span class="free">sds</span></span> <span class="main">+</span>
  strategyproof_sds <span class="quoted"><span class="free">agents</span></span> <span class="quoted"><span class="free">alts</span></span> <span class="quoted"><span class="free">sds</span></span>
  <span class="keyword2"><span class="keyword">for</span></span> <span class="free">agents</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'agent</span> set"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="free">alts</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'alt</span> set"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="free">sds</span> <span class="main">+</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> agents_ge_4<span class="main">:</span> <span class="quoted"><span class="quoted">"card <span class="free">agents</span> <span class="main">≥</span> <span class="numeral">4</span>"</span></span>
      <span class="keyword2"><span class="keyword">and</span></span> alts_ge_4<span class="main">:</span>   <span class="quoted"><span class="quoted">"card <span class="free">alts</span> <span class="main">≥</span> <span class="numeral">4</span>"</span></span>

<span class="keyword1"><span class="command">locale</span></span> sds_impossibility_4_4 <span class="main">=</span> sds_impossibility <span class="quoted"><span class="free">agents</span></span> <span class="quoted"><span class="free">alts</span></span> <span class="quoted"><span class="free">sds</span></span>
  <span class="keyword2"><span class="keyword">for</span></span> <span class="free">agents</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'agent</span> set"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="free">alts</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'alt</span> set"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="free">sds</span> <span class="main">+</span>
  <span class="keyword2"><span class="keyword">fixes</span></span> <span class="free">A1</span> <span class="free">A2</span> <span class="free">A3</span> <span class="free">A4</span> <span class="main">::</span> <span class="tfree"><span class="quoted"><span class="tfree">'agent</span></span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="free">a</span> <span class="free">b</span> <span class="free">c</span> <span class="free">d</span> <span class="main">::</span> <span class="tfree"><span class="quoted"><span class="tfree">'alt</span></span></span>
  <span class="keyword2"><span class="keyword">assumes</span></span> distinct_agents<span class="main">:</span> <span class="quoted"><span class="quoted">"distinct <span class="main">[</span><span class="free">A1</span><span class="main">,</span> <span class="free">A2</span><span class="main">,</span> <span class="free">A3</span><span class="main">,</span> <span class="free">A4</span><span class="main">]</span>"</span></span>
      <span class="keyword2"><span class="keyword">and</span></span> distinct_alts<span class="main">:</span> <span class="quoted"><span class="quoted">"distinct <span class="main">[</span><span class="free">a</span><span class="main">,</span> <span class="free">b</span><span class="main">,</span> <span class="free">c</span><span class="main">,</span> <span class="free">d</span><span class="main">]</span>"</span></span>
      <span class="keyword2"><span class="keyword">and</span></span> agents<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">agents</span> <span class="main">=</span> <span class="main">{</span><span class="free">A1</span><span class="main">,</span> <span class="free">A2</span><span class="main">,</span> <span class="free">A3</span><span class="main">,</span> <span class="free">A4</span><span class="main">}</span>"</span></span>
      <span class="keyword2"><span class="keyword">and</span></span> alts<span class="main">:</span>   <span class="quoted"><span class="quoted">"<span class="free">alts</span>   <span class="main">=</span> <span class="main">{</span><span class="free">a</span><span class="main">,</span> <span class="free">b</span><span class="main">,</span> <span class="free">c</span><span class="main">,</span> <span class="free">d</span><span class="main">}</span>"</span></span>
<span class="keyword2"><span class="keyword">begin</span></span>

<span class="keyword1"><span class="command">lemma</span></span> an_sds<span class="main">:</span> <span class="quoted"><span class="quoted">"an_sds <span class="free">agents</span> <span class="free">alts</span> <span class="free">sds</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">unfold_locales</span>
<span class="keyword1"><span class="command">lemma</span></span> ex_post_efficient_sds<span class="main">:</span> <span class="quoted"><span class="quoted">"ex_post_efficient_sds <span class="free">agents</span> <span class="free">alts</span> <span class="free">sds</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">unfold_locales</span>
<span class="keyword1"><span class="command">lemma</span></span> sd_efficient_sds<span class="main">:</span> <span class="quoted"><span class="quoted">"sd_efficient_sds <span class="free">agents</span> <span class="free">alts</span> <span class="free">sds</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">unfold_locales</span>
<span class="keyword1"><span class="command">lemma</span></span> strategyproof_an_sds<span class="main">:</span> <span class="quoted"><span class="quoted">"strategyproof_an_sds <span class="free">agents</span> <span class="free">alts</span> <span class="free">sds</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">unfold_locales</span>

<span class="keyword1"><span class="command">lemma</span></span> distinct_agents' <span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> 
  <span class="quoted"><span class="quoted">"<span class="free">A1</span> <span class="main">≠</span> <span class="free">A2</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="free">A1</span> <span class="main">≠</span> <span class="free">A3</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="free">A1</span> <span class="main">≠</span> <span class="free">A4</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="free">A2</span> <span class="main">≠</span> <span class="free">A1</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="free">A2</span> <span class="main">≠</span> <span class="free">A3</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="free">A2</span> <span class="main">≠</span> <span class="free">A4</span>"</span></span> 
  <span class="quoted"><span class="quoted">"<span class="free">A3</span> <span class="main">≠</span> <span class="free">A1</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="free">A3</span> <span class="main">≠</span> <span class="free">A2</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="free">A3</span> <span class="main">≠</span> <span class="free">A4</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="free">A4</span> <span class="main">≠</span> <span class="free">A1</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="free">A4</span> <span class="main">≠</span> <span class="free">A2</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="free">A4</span> <span class="main">≠</span> <span class="free">A3</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> distinct_agents <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  
<span class="keyword1"><span class="command">lemma</span></span> distinct_alts' <span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span>
  <span class="quoted"><span class="quoted">"<span class="free">a</span> <span class="main">≠</span> <span class="free">b</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span> <span class="main">≠</span> <span class="free">c</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span> <span class="main">≠</span> <span class="free">d</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="free">b</span> <span class="main">≠</span> <span class="free">a</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="free">b</span> <span class="main">≠</span> <span class="free">c</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="free">b</span> <span class="main">≠</span> <span class="free">d</span>"</span></span> 
  <span class="quoted"><span class="quoted">"<span class="free">c</span> <span class="main">≠</span> <span class="free">a</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="free">c</span> <span class="main">≠</span> <span class="free">b</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="free">c</span> <span class="main">≠</span> <span class="free">d</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="free">d</span> <span class="main">≠</span> <span class="free">a</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="free">d</span> <span class="main">≠</span> <span class="free">b</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="free">d</span> <span class="main">≠</span> <span class="free">c</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> distinct_alts <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">lemma</span></span> card_agents <span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"card <span class="free">agents</span> <span class="main">=</span> <span class="numeral">4</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> card_alts <span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"card <span class="free">alts</span> <span class="main">=</span> <span class="numeral">4</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> distinct_agents distinct_alts <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp_all</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> agents alts<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> in_agents <span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">A1</span> <span class="main">∈</span> <span class="free">agents</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="free">A2</span> <span class="main">∈</span> <span class="free">agents</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="free">A3</span> <span class="main">∈</span> <span class="free">agents</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="free">A4</span> <span class="main">∈</span> <span class="free">agents</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp_all</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> agents<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> in_alts <span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">a</span> <span class="main">∈</span> <span class="free">alts</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="free">b</span> <span class="main">∈</span> <span class="free">alts</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="free">c</span> <span class="main">∈</span> <span class="free">alts</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="free">d</span> <span class="main">∈</span> <span class="free">alts</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp_all</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> alts<span class="main">)</span>
  
<span class="keyword1"><span class="command">lemma</span></span> agent_iff<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main">∈</span> <span class="free">agents</span> <span class="main">⟷</span> <span class="free">x</span> <span class="main">∈</span> <span class="main">{</span><span class="free">A1</span><span class="main">,</span> <span class="free">A2</span><span class="main">,</span> <span class="free">A3</span><span class="main">,</span> <span class="free">A4</span><span class="main">}</span>"</span></span>
                 <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">∀</span><span class="bound">x</span><span class="main">∈</span><span class="free">agents</span><span class="main">.</span> <span class="free">P</span> <span class="bound">x</span><span class="main">)</span> <span class="main">⟷</span> <span class="free">P</span> <span class="free">A1</span> <span class="main">∧</span> <span class="free">P</span> <span class="free">A2</span> <span class="main">∧</span> <span class="free">P</span> <span class="free">A3</span> <span class="main">∧</span> <span class="free">P</span> <span class="free">A4</span>"</span></span>
                 <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">∃</span><span class="bound">x</span><span class="main">∈</span><span class="free">agents</span><span class="main">.</span> <span class="free">P</span> <span class="bound">x</span><span class="main">)</span> <span class="main">⟷</span> <span class="free">P</span> <span class="free">A1</span> <span class="main">∨</span> <span class="free">P</span> <span class="free">A2</span> <span class="main">∨</span> <span class="free">P</span> <span class="free">A3</span> <span class="main">∨</span> <span class="free">P</span> <span class="free">A4</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> agents<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> alt_iff<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main">∈</span> <span class="free">alts</span> <span class="main">⟷</span> <span class="free">x</span> <span class="main">∈</span> <span class="main">{</span><span class="free">a</span><span class="main">,</span><span class="free">b</span><span class="main">,</span><span class="free">c</span><span class="main">,</span><span class="free">d</span><span class="main">}</span>"</span></span>
               <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">∀</span><span class="bound">x</span><span class="main">∈</span><span class="free">alts</span><span class="main">.</span> <span class="free">P</span> <span class="bound">x</span><span class="main">)</span> <span class="main">⟷</span> <span class="free">P</span> <span class="free">a</span> <span class="main">∧</span> <span class="free">P</span> <span class="free">b</span> <span class="main">∧</span> <span class="free">P</span> <span class="free">c</span> <span class="main">∧</span> <span class="free">P</span> <span class="free">d</span>"</span></span>
               <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">∃</span><span class="bound">x</span><span class="main">∈</span><span class="free">alts</span><span class="main">.</span> <span class="free">P</span> <span class="bound">x</span><span class="main">)</span> <span class="main">⟷</span> <span class="free">P</span> <span class="free">a</span> <span class="main">∨</span> <span class="free">P</span> <span class="free">b</span> <span class="main">∨</span> <span class="free">P</span> <span class="free">c</span> <span class="main">∨</span> <span class="free">P</span> <span class="free">d</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> alts<span class="main">)</span>




<span class="keyword1"><span class="command">subsection</span></span> <span class="quoted"><span class="plain_text">‹Definition of Preference Profiles and Fact Gathering›</span></span>

<span class="keyword1"><span class="command">preference_profile</span></span> 
  agents<span class="main">:</span> <span class="quoted"><span class="free">agents</span></span>
  alts<span class="main">:</span>   <span class="quoted"><span class="free">alts</span></span>
<span class="keyword2"><span class="keyword">where</span></span> R1  <span class="main">=</span> <span class="quoted"><span class="free">A1</span></span><span class="main">:</span> <span class="main">[</span><span class="quoted"><span class="free">c</span></span><span class="main">,</span> <span class="quoted"><span class="free">d</span></span><span class="main">]</span><span class="main">,</span> <span class="main">[</span><span class="quoted"><span class="free">a</span></span><span class="main">,</span> <span class="quoted"><span class="free">b</span></span><span class="main">]</span>    <span class="quoted"><span class="free">A2</span></span><span class="main">:</span> <span class="main">[</span><span class="quoted"><span class="free">b</span></span><span class="main">,</span> <span class="quoted"><span class="free">d</span></span><span class="main">]</span><span class="main">,</span> <span class="quoted"><span class="free">a</span></span><span class="main">,</span> <span class="quoted"><span class="free">c</span></span>      <span class="quoted"><span class="free">A3</span></span><span class="main">:</span> <span class="quoted"><span class="free">a</span></span><span class="main">,</span> <span class="quoted"><span class="free">b</span></span><span class="main">,</span> <span class="main">[</span><span class="quoted"><span class="free">c</span></span><span class="main">,</span> <span class="quoted"><span class="free">d</span></span><span class="main">]</span>      <span class="quoted"><span class="free">A4</span></span><span class="main">:</span> <span class="main">[</span><span class="quoted"><span class="free">a</span></span><span class="main">,</span> <span class="quoted"><span class="free">c</span></span><span class="main">]</span><span class="main">,</span> <span class="main">[</span><span class="quoted"><span class="free">b</span></span><span class="main">,</span> <span class="quoted"><span class="free">d</span></span><span class="main">]</span>
  <span class="keyword2"><span class="keyword">and</span></span> R2  <span class="main">=</span> <span class="quoted"><span class="free">A1</span></span><span class="main">:</span> <span class="main">[</span><span class="quoted"><span class="free">a</span></span><span class="main">,</span> <span class="quoted"><span class="free">c</span></span><span class="main">]</span><span class="main">,</span> <span class="main">[</span><span class="quoted"><span class="free">b</span></span><span class="main">,</span> <span class="quoted"><span class="free">d</span></span><span class="main">]</span>    <span class="quoted"><span class="free">A2</span></span><span class="main">:</span> <span class="main">[</span><span class="quoted"><span class="free">c</span></span><span class="main">,</span> <span class="quoted"><span class="free">d</span></span><span class="main">]</span><span class="main">,</span> <span class="quoted"><span class="free">a</span></span><span class="main">,</span> <span class="quoted"><span class="free">b</span></span>      <span class="quoted"><span class="free">A3</span></span><span class="main">:</span> <span class="main">[</span><span class="quoted"><span class="free">b</span></span><span class="main">,</span> <span class="quoted"><span class="free">d</span></span><span class="main">]</span><span class="main">,</span> <span class="quoted"><span class="free">a</span></span><span class="main">,</span> <span class="quoted"><span class="free">c</span></span>      <span class="quoted"><span class="free">A4</span></span><span class="main">:</span> <span class="quoted"><span class="free">a</span></span><span class="main">,</span> <span class="quoted"><span class="free">b</span></span><span class="main">,</span> <span class="main">[</span><span class="quoted"><span class="free">c</span></span><span class="main">,</span> <span class="quoted"><span class="free">d</span></span><span class="main">]</span>
  <span class="keyword2"><span class="keyword">and</span></span> R3  <span class="main">=</span> <span class="quoted"><span class="free">A1</span></span><span class="main">:</span> <span class="main">[</span><span class="quoted"><span class="free">a</span></span><span class="main">,</span> <span class="quoted"><span class="free">b</span></span><span class="main">]</span><span class="main">,</span> <span class="main">[</span><span class="quoted"><span class="free">c</span></span><span class="main">,</span> <span class="quoted"><span class="free">d</span></span><span class="main">]</span>    <span class="quoted"><span class="free">A2</span></span><span class="main">:</span> <span class="main">[</span><span class="quoted"><span class="free">c</span></span><span class="main">,</span> <span class="quoted"><span class="free">d</span></span><span class="main">]</span><span class="main">,</span> <span class="main">[</span><span class="quoted"><span class="free">a</span></span><span class="main">,</span> <span class="quoted"><span class="free">b</span></span><span class="main">]</span>    <span class="quoted"><span class="free">A3</span></span><span class="main">:</span> <span class="quoted"><span class="free">d</span></span><span class="main">,</span> <span class="main">[</span><span class="quoted"><span class="free">a</span></span><span class="main">,</span> <span class="quoted"><span class="free">b</span></span><span class="main">]</span><span class="main">,</span> <span class="quoted"><span class="free">c</span></span>      <span class="quoted"><span class="free">A4</span></span><span class="main">:</span> <span class="quoted"><span class="free">c</span></span><span class="main">,</span> <span class="quoted"><span class="free">a</span></span><span class="main">,</span> <span class="main">[</span><span class="quoted"><span class="free">b</span></span><span class="main">,</span> <span class="quoted"><span class="free">d</span></span><span class="main">]</span>
  <span class="keyword2"><span class="keyword">and</span></span> R4  <span class="main">=</span> <span class="quoted"><span class="free">A1</span></span><span class="main">:</span> <span class="main">[</span><span class="quoted"><span class="free">a</span></span><span class="main">,</span> <span class="quoted"><span class="free">b</span></span><span class="main">]</span><span class="main">,</span> <span class="main">[</span><span class="quoted"><span class="free">c</span></span><span class="main">,</span> <span class="quoted"><span class="free">d</span></span><span class="main">]</span>    <span class="quoted"><span class="free">A2</span></span><span class="main">:</span> <span class="main">[</span><span class="quoted"><span class="free">a</span></span><span class="main">,</span> <span class="quoted"><span class="free">d</span></span><span class="main">]</span><span class="main">,</span> <span class="main">[</span><span class="quoted"><span class="free">b</span></span><span class="main">,</span> <span class="quoted"><span class="free">c</span></span><span class="main">]</span>    <span class="quoted"><span class="free">A3</span></span><span class="main">:</span> <span class="quoted"><span class="free">c</span></span><span class="main">,</span> <span class="main">[</span><span class="quoted"><span class="free">a</span></span><span class="main">,</span> <span class="quoted"><span class="free">b</span></span><span class="main">]</span><span class="main">,</span> <span class="quoted"><span class="free">d</span></span>      <span class="quoted"><span class="free">A4</span></span><span class="main">:</span> <span class="quoted"><span class="free">d</span></span><span class="main">,</span> <span class="quoted"><span class="free">c</span></span><span class="main">,</span> <span class="main">[</span><span class="quoted"><span class="free">a</span></span><span class="main">,</span> <span class="quoted"><span class="free">b</span></span><span class="main">]</span>
  <span class="keyword2"><span class="keyword">and</span></span> R5  <span class="main">=</span> <span class="quoted"><span class="free">A1</span></span><span class="main">:</span> <span class="main">[</span><span class="quoted"><span class="free">c</span></span><span class="main">,</span> <span class="quoted"><span class="free">d</span></span><span class="main">]</span><span class="main">,</span> <span class="main">[</span><span class="quoted"><span class="free">a</span></span><span class="main">,</span> <span class="quoted"><span class="free">b</span></span><span class="main">]</span>    <span class="quoted"><span class="free">A2</span></span><span class="main">:</span> <span class="main">[</span><span class="quoted"><span class="free">a</span></span><span class="main">,</span> <span class="quoted"><span class="free">b</span></span><span class="main">]</span><span class="main">,</span> <span class="main">[</span><span class="quoted"><span class="free">c</span></span><span class="main">,</span> <span class="quoted"><span class="free">d</span></span><span class="main">]</span>    <span class="quoted"><span class="free">A3</span></span><span class="main">:</span> <span class="main">[</span><span class="quoted"><span class="free">a</span></span><span class="main">,</span> <span class="quoted"><span class="free">c</span></span><span class="main">]</span><span class="main">,</span> <span class="quoted"><span class="free">d</span></span><span class="main">,</span> <span class="quoted"><span class="free">b</span></span>      <span class="quoted"><span class="free">A4</span></span><span class="main">:</span> <span class="quoted"><span class="free">d</span></span><span class="main">,</span> <span class="main">[</span><span class="quoted"><span class="free">a</span></span><span class="main">,</span> <span class="quoted"><span class="free">b</span></span><span class="main">]</span><span class="main">,</span> <span class="quoted"><span class="free">c</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> R6  <span class="main">=</span> <span class="quoted"><span class="free">A1</span></span><span class="main">:</span> <span class="main">[</span><span class="quoted"><span class="free">a</span></span><span class="main">,</span> <span class="quoted"><span class="free">b</span></span><span class="main">]</span><span class="main">,</span> <span class="main">[</span><span class="quoted"><span class="free">c</span></span><span class="main">,</span> <span class="quoted"><span class="free">d</span></span><span class="main">]</span>    <span class="quoted"><span class="free">A2</span></span><span class="main">:</span> <span class="main">[</span><span class="quoted"><span class="free">c</span></span><span class="main">,</span> <span class="quoted"><span class="free">d</span></span><span class="main">]</span><span class="main">,</span> <span class="main">[</span><span class="quoted"><span class="free">a</span></span><span class="main">,</span> <span class="quoted"><span class="free">b</span></span><span class="main">]</span>    <span class="quoted"><span class="free">A3</span></span><span class="main">:</span> <span class="main">[</span><span class="quoted"><span class="free">a</span></span><span class="main">,</span> <span class="quoted"><span class="free">c</span></span><span class="main">]</span><span class="main">,</span> <span class="main">[</span><span class="quoted"><span class="free">b</span></span><span class="main">,</span> <span class="quoted"><span class="free">d</span></span><span class="main">]</span>    <span class="quoted"><span class="free">A4</span></span><span class="main">:</span> <span class="quoted"><span class="free">d</span></span><span class="main">,</span> <span class="quoted"><span class="free">b</span></span><span class="main">,</span> <span class="quoted"><span class="free">a</span></span><span class="main">,</span> <span class="quoted"><span class="free">c</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> R7  <span class="main">=</span> <span class="quoted"><span class="free">A1</span></span><span class="main">:</span> <span class="main">[</span><span class="quoted"><span class="free">a</span></span><span class="main">,</span> <span class="quoted"><span class="free">b</span></span><span class="main">]</span><span class="main">,</span> <span class="main">[</span><span class="quoted"><span class="free">c</span></span><span class="main">,</span> <span class="quoted"><span class="free">d</span></span><span class="main">]</span>    <span class="quoted"><span class="free">A2</span></span><span class="main">:</span> <span class="main">[</span><span class="quoted"><span class="free">c</span></span><span class="main">,</span> <span class="quoted"><span class="free">d</span></span><span class="main">]</span><span class="main">,</span> <span class="main">[</span><span class="quoted"><span class="free">a</span></span><span class="main">,</span> <span class="quoted"><span class="free">b</span></span><span class="main">]</span>    <span class="quoted"><span class="free">A3</span></span><span class="main">:</span> <span class="quoted"><span class="free">a</span></span><span class="main">,</span> <span class="quoted"><span class="free">c</span></span><span class="main">,</span> <span class="quoted"><span class="free">d</span></span><span class="main">,</span> <span class="quoted"><span class="free">b</span></span>        <span class="quoted"><span class="free">A4</span></span><span class="main">:</span> <span class="quoted"><span class="free">d</span></span><span class="main">,</span> <span class="main">[</span><span class="quoted"><span class="free">a</span></span><span class="main">,</span> <span class="quoted"><span class="free">b</span></span><span class="main">]</span><span class="main">,</span> <span class="quoted"><span class="free">c</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> R8  <span class="main">=</span> <span class="quoted"><span class="free">A1</span></span><span class="main">:</span> <span class="main">[</span><span class="quoted"><span class="free">a</span></span><span class="main">,</span> <span class="quoted"><span class="free">b</span></span><span class="main">]</span><span class="main">,</span> <span class="main">[</span><span class="quoted"><span class="free">c</span></span><span class="main">,</span> <span class="quoted"><span class="free">d</span></span><span class="main">]</span>    <span class="quoted"><span class="free">A2</span></span><span class="main">:</span> <span class="main">[</span><span class="quoted"><span class="free">a</span></span><span class="main">,</span> <span class="quoted"><span class="free">c</span></span><span class="main">]</span><span class="main">,</span> <span class="main">[</span><span class="quoted"><span class="free">b</span></span><span class="main">,</span> <span class="quoted"><span class="free">d</span></span><span class="main">]</span>    <span class="quoted"><span class="free">A3</span></span><span class="main">:</span> <span class="quoted"><span class="free">d</span></span><span class="main">,</span> <span class="main">[</span><span class="quoted"><span class="free">a</span></span><span class="main">,</span> <span class="quoted"><span class="free">b</span></span><span class="main">]</span><span class="main">,</span> <span class="quoted"><span class="free">c</span></span>      <span class="quoted"><span class="free">A4</span></span><span class="main">:</span> <span class="quoted"><span class="free">d</span></span><span class="main">,</span> <span class="quoted"><span class="free">c</span></span><span class="main">,</span> <span class="main">[</span><span class="quoted"><span class="free">a</span></span><span class="main">,</span> <span class="quoted"><span class="free">b</span></span><span class="main">]</span>
  <span class="keyword2"><span class="keyword">and</span></span> R9  <span class="main">=</span> <span class="quoted"><span class="free">A1</span></span><span class="main">:</span> <span class="main">[</span><span class="quoted"><span class="free">a</span></span><span class="main">,</span> <span class="quoted"><span class="free">b</span></span><span class="main">]</span><span class="main">,</span> <span class="main">[</span><span class="quoted"><span class="free">c</span></span><span class="main">,</span> <span class="quoted"><span class="free">d</span></span><span class="main">]</span>    <span class="quoted"><span class="free">A2</span></span><span class="main">:</span> <span class="main">[</span><span class="quoted"><span class="free">a</span></span><span class="main">,</span> <span class="quoted"><span class="free">d</span></span><span class="main">]</span><span class="main">,</span> <span class="quoted"><span class="free">c</span></span><span class="main">,</span> <span class="quoted"><span class="free">b</span></span>      <span class="quoted"><span class="free">A3</span></span><span class="main">:</span> <span class="quoted"><span class="free">d</span></span><span class="main">,</span> <span class="quoted"><span class="free">c</span></span><span class="main">,</span> <span class="main">[</span><span class="quoted"><span class="free">a</span></span><span class="main">,</span> <span class="quoted"><span class="free">b</span></span><span class="main">]</span>      <span class="quoted"><span class="free">A4</span></span><span class="main">:</span> <span class="main">[</span><span class="quoted"><span class="free">a</span></span><span class="main">,</span> <span class="quoted"><span class="free">b</span></span><span class="main">,</span> <span class="quoted"><span class="free">c</span></span><span class="main">]</span><span class="main">,</span> <span class="quoted"><span class="free">d</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> R10 <span class="main">=</span> <span class="quoted"><span class="free">A1</span></span><span class="main">:</span> <span class="main">[</span><span class="quoted"><span class="free">a</span></span><span class="main">,</span> <span class="quoted"><span class="free">b</span></span><span class="main">]</span><span class="main">,</span> <span class="main">[</span><span class="quoted"><span class="free">c</span></span><span class="main">,</span> <span class="quoted"><span class="free">d</span></span><span class="main">]</span>    <span class="quoted"><span class="free">A2</span></span><span class="main">:</span> <span class="main">[</span><span class="quoted"><span class="free">c</span></span><span class="main">,</span> <span class="quoted"><span class="free">d</span></span><span class="main">]</span><span class="main">,</span> <span class="main">[</span><span class="quoted"><span class="free">a</span></span><span class="main">,</span> <span class="quoted"><span class="free">b</span></span><span class="main">]</span>    <span class="quoted"><span class="free">A3</span></span><span class="main">:</span> <span class="main">[</span><span class="quoted"><span class="free">a</span></span><span class="main">,</span> <span class="quoted"><span class="free">c</span></span><span class="main">]</span><span class="main">,</span> <span class="quoted"><span class="free">d</span></span><span class="main">,</span> <span class="quoted"><span class="free">b</span></span>      <span class="quoted"><span class="free">A4</span></span><span class="main">:</span> <span class="main">[</span><span class="quoted"><span class="free">b</span></span><span class="main">,</span> <span class="quoted"><span class="free">d</span></span><span class="main">]</span><span class="main">,</span> <span class="quoted"><span class="free">a</span></span><span class="main">,</span> <span class="quoted"><span class="free">c</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> R11 <span class="main">=</span> <span class="quoted"><span class="free">A1</span></span><span class="main">:</span> <span class="main">[</span><span class="quoted"><span class="free">a</span></span><span class="main">,</span> <span class="quoted"><span class="free">b</span></span><span class="main">]</span><span class="main">,</span> <span class="main">[</span><span class="quoted"><span class="free">c</span></span><span class="main">,</span> <span class="quoted"><span class="free">d</span></span><span class="main">]</span>    <span class="quoted"><span class="free">A2</span></span><span class="main">:</span> <span class="main">[</span><span class="quoted"><span class="free">c</span></span><span class="main">,</span> <span class="quoted"><span class="free">d</span></span><span class="main">]</span><span class="main">,</span> <span class="main">[</span><span class="quoted"><span class="free">a</span></span><span class="main">,</span> <span class="quoted"><span class="free">b</span></span><span class="main">]</span>    <span class="quoted"><span class="free">A3</span></span><span class="main">:</span> <span class="quoted"><span class="free">d</span></span><span class="main">,</span> <span class="main">[</span><span class="quoted"><span class="free">a</span></span><span class="main">,</span> <span class="quoted"><span class="free">b</span></span><span class="main">]</span><span class="main">,</span> <span class="quoted"><span class="free">c</span></span>      <span class="quoted"><span class="free">A4</span></span><span class="main">:</span> <span class="quoted"><span class="free">c</span></span><span class="main">,</span> <span class="quoted"><span class="free">a</span></span><span class="main">,</span> <span class="quoted"><span class="free">b</span></span><span class="main">,</span> <span class="quoted"><span class="free">d</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> R12 <span class="main">=</span> <span class="quoted"><span class="free">A1</span></span><span class="main">:</span> <span class="main">[</span><span class="quoted"><span class="free">c</span></span><span class="main">,</span> <span class="quoted"><span class="free">d</span></span><span class="main">]</span><span class="main">,</span> <span class="main">[</span><span class="quoted"><span class="free">a</span></span><span class="main">,</span> <span class="quoted"><span class="free">b</span></span><span class="main">]</span>    <span class="quoted"><span class="free">A2</span></span><span class="main">:</span> <span class="main">[</span><span class="quoted"><span class="free">a</span></span><span class="main">,</span> <span class="quoted"><span class="free">b</span></span><span class="main">]</span><span class="main">,</span> <span class="main">[</span><span class="quoted"><span class="free">c</span></span><span class="main">,</span> <span class="quoted"><span class="free">d</span></span><span class="main">]</span>    <span class="quoted"><span class="free">A3</span></span><span class="main">:</span> <span class="main">[</span><span class="quoted"><span class="free">a</span></span><span class="main">,</span> <span class="quoted"><span class="free">c</span></span><span class="main">]</span><span class="main">,</span> <span class="quoted"><span class="free">d</span></span><span class="main">,</span> <span class="quoted"><span class="free">b</span></span>      <span class="quoted"><span class="free">A4</span></span><span class="main">:</span> <span class="main">[</span><span class="quoted"><span class="free">a</span></span><span class="main">,</span> <span class="quoted"><span class="free">b</span></span><span class="main">,</span> <span class="quoted"><span class="free">d</span></span><span class="main">]</span><span class="main">,</span> <span class="quoted"><span class="free">c</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> R13 <span class="main">=</span> <span class="quoted"><span class="free">A1</span></span><span class="main">:</span> <span class="main">[</span><span class="quoted"><span class="free">a</span></span><span class="main">,</span> <span class="quoted"><span class="free">c</span></span><span class="main">]</span><span class="main">,</span> <span class="main">[</span><span class="quoted"><span class="free">b</span></span><span class="main">,</span> <span class="quoted"><span class="free">d</span></span><span class="main">]</span>    <span class="quoted"><span class="free">A2</span></span><span class="main">:</span> <span class="main">[</span><span class="quoted"><span class="free">c</span></span><span class="main">,</span> <span class="quoted"><span class="free">d</span></span><span class="main">]</span><span class="main">,</span> <span class="quoted"><span class="free">a</span></span><span class="main">,</span> <span class="quoted"><span class="free">b</span></span>      <span class="quoted"><span class="free">A3</span></span><span class="main">:</span> <span class="main">[</span><span class="quoted"><span class="free">b</span></span><span class="main">,</span> <span class="quoted"><span class="free">d</span></span><span class="main">]</span><span class="main">,</span> <span class="quoted"><span class="free">a</span></span><span class="main">,</span> <span class="quoted"><span class="free">c</span></span>      <span class="quoted"><span class="free">A4</span></span><span class="main">:</span> <span class="quoted"><span class="free">a</span></span><span class="main">,</span> <span class="quoted"><span class="free">b</span></span><span class="main">,</span> <span class="quoted"><span class="free">d</span></span><span class="main">,</span> <span class="quoted"><span class="free">c</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> R14 <span class="main">=</span> <span class="quoted"><span class="free">A1</span></span><span class="main">:</span> <span class="main">[</span><span class="quoted"><span class="free">a</span></span><span class="main">,</span> <span class="quoted"><span class="free">b</span></span><span class="main">]</span><span class="main">,</span> <span class="main">[</span><span class="quoted"><span class="free">c</span></span><span class="main">,</span> <span class="quoted"><span class="free">d</span></span><span class="main">]</span>    <span class="quoted"><span class="free">A2</span></span><span class="main">:</span> <span class="quoted"><span class="free">d</span></span><span class="main">,</span> <span class="quoted"><span class="free">c</span></span><span class="main">,</span> <span class="main">[</span><span class="quoted"><span class="free">a</span></span><span class="main">,</span> <span class="quoted"><span class="free">b</span></span><span class="main">]</span>      <span class="quoted"><span class="free">A3</span></span><span class="main">:</span> <span class="main">[</span><span class="quoted"><span class="free">a</span></span><span class="main">,</span> <span class="quoted"><span class="free">b</span></span><span class="main">,</span> <span class="quoted"><span class="free">c</span></span><span class="main">]</span><span class="main">,</span> <span class="quoted"><span class="free">d</span></span>      <span class="quoted"><span class="free">A4</span></span><span class="main">:</span> <span class="quoted"><span class="free">a</span></span><span class="main">,</span> <span class="quoted"><span class="free">d</span></span><span class="main">,</span> <span class="quoted"><span class="free">c</span></span><span class="main">,</span> <span class="quoted"><span class="free">b</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> R15 <span class="main">=</span> <span class="quoted"><span class="free">A1</span></span><span class="main">:</span> <span class="main">[</span><span class="quoted"><span class="free">a</span></span><span class="main">,</span> <span class="quoted"><span class="free">b</span></span><span class="main">]</span><span class="main">,</span> <span class="main">[</span><span class="quoted"><span class="free">c</span></span><span class="main">,</span> <span class="quoted"><span class="free">d</span></span><span class="main">]</span>    <span class="quoted"><span class="free">A2</span></span><span class="main">:</span> <span class="main">[</span><span class="quoted"><span class="free">c</span></span><span class="main">,</span> <span class="quoted"><span class="free">d</span></span><span class="main">]</span><span class="main">,</span> <span class="main">[</span><span class="quoted"><span class="free">a</span></span><span class="main">,</span> <span class="quoted"><span class="free">b</span></span><span class="main">]</span>    <span class="quoted"><span class="free">A3</span></span><span class="main">:</span> <span class="main">[</span><span class="quoted"><span class="free">b</span></span><span class="main">,</span> <span class="quoted"><span class="free">d</span></span><span class="main">]</span><span class="main">,</span> <span class="quoted"><span class="free">a</span></span><span class="main">,</span> <span class="quoted"><span class="free">c</span></span>      <span class="quoted"><span class="free">A4</span></span><span class="main">:</span> <span class="quoted"><span class="free">a</span></span><span class="main">,</span> <span class="quoted"><span class="free">c</span></span><span class="main">,</span> <span class="quoted"><span class="free">d</span></span><span class="main">,</span> <span class="quoted"><span class="free">b</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> R16 <span class="main">=</span> <span class="quoted"><span class="free">A1</span></span><span class="main">:</span> <span class="main">[</span><span class="quoted"><span class="free">a</span></span><span class="main">,</span> <span class="quoted"><span class="free">b</span></span><span class="main">]</span><span class="main">,</span> <span class="main">[</span><span class="quoted"><span class="free">c</span></span><span class="main">,</span> <span class="quoted"><span class="free">d</span></span><span class="main">]</span>    <span class="quoted"><span class="free">A2</span></span><span class="main">:</span> <span class="main">[</span><span class="quoted"><span class="free">c</span></span><span class="main">,</span> <span class="quoted"><span class="free">d</span></span><span class="main">]</span><span class="main">,</span> <span class="main">[</span><span class="quoted"><span class="free">a</span></span><span class="main">,</span> <span class="quoted"><span class="free">b</span></span><span class="main">]</span>    <span class="quoted"><span class="free">A3</span></span><span class="main">:</span> <span class="quoted"><span class="free">a</span></span><span class="main">,</span> <span class="quoted"><span class="free">c</span></span><span class="main">,</span> <span class="quoted"><span class="free">d</span></span><span class="main">,</span> <span class="quoted"><span class="free">b</span></span>        <span class="quoted"><span class="free">A4</span></span><span class="main">:</span> <span class="main">[</span><span class="quoted"><span class="free">a</span></span><span class="main">,</span> <span class="quoted"><span class="free">b</span></span><span class="main">,</span> <span class="quoted"><span class="free">d</span></span><span class="main">]</span><span class="main">,</span> <span class="quoted"><span class="free">c</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> R17 <span class="main">=</span> <span class="quoted"><span class="free">A1</span></span><span class="main">:</span> <span class="main">[</span><span class="quoted"><span class="free">a</span></span><span class="main">,</span> <span class="quoted"><span class="free">b</span></span><span class="main">]</span><span class="main">,</span> <span class="main">[</span><span class="quoted"><span class="free">c</span></span><span class="main">,</span> <span class="quoted"><span class="free">d</span></span><span class="main">]</span>    <span class="quoted"><span class="free">A2</span></span><span class="main">:</span> <span class="main">[</span><span class="quoted"><span class="free">c</span></span><span class="main">,</span> <span class="quoted"><span class="free">d</span></span><span class="main">]</span><span class="main">,</span> <span class="main">[</span><span class="quoted"><span class="free">a</span></span><span class="main">,</span> <span class="quoted"><span class="free">b</span></span><span class="main">]</span>    <span class="quoted"><span class="free">A3</span></span><span class="main">:</span> <span class="main">[</span><span class="quoted"><span class="free">a</span></span><span class="main">,</span> <span class="quoted"><span class="free">c</span></span><span class="main">]</span><span class="main">,</span> <span class="main">[</span><span class="quoted"><span class="free">b</span></span><span class="main">,</span> <span class="quoted"><span class="free">d</span></span><span class="main">]</span>    <span class="quoted"><span class="free">A4</span></span><span class="main">:</span> <span class="quoted"><span class="free">d</span></span><span class="main">,</span> <span class="main">[</span><span class="quoted"><span class="free">a</span></span><span class="main">,</span> <span class="quoted"><span class="free">b</span></span><span class="main">]</span><span class="main">,</span> <span class="quoted"><span class="free">c</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> R18 <span class="main">=</span> <span class="quoted"><span class="free">A1</span></span><span class="main">:</span> <span class="main">[</span><span class="quoted"><span class="free">a</span></span><span class="main">,</span> <span class="quoted"><span class="free">b</span></span><span class="main">]</span><span class="main">,</span> <span class="main">[</span><span class="quoted"><span class="free">c</span></span><span class="main">,</span> <span class="quoted"><span class="free">d</span></span><span class="main">]</span>    <span class="quoted"><span class="free">A2</span></span><span class="main">:</span> <span class="main">[</span><span class="quoted"><span class="free">a</span></span><span class="main">,</span> <span class="quoted"><span class="free">d</span></span><span class="main">]</span><span class="main">,</span> <span class="main">[</span><span class="quoted"><span class="free">b</span></span><span class="main">,</span> <span class="quoted"><span class="free">c</span></span><span class="main">]</span>    <span class="quoted"><span class="free">A3</span></span><span class="main">:</span> <span class="main">[</span><span class="quoted"><span class="free">a</span></span><span class="main">,</span> <span class="quoted"><span class="free">b</span></span><span class="main">,</span> <span class="quoted"><span class="free">c</span></span><span class="main">]</span><span class="main">,</span> <span class="quoted"><span class="free">d</span></span>      <span class="quoted"><span class="free">A4</span></span><span class="main">:</span> <span class="quoted"><span class="free">d</span></span><span class="main">,</span> <span class="quoted"><span class="free">c</span></span><span class="main">,</span> <span class="main">[</span><span class="quoted"><span class="free">a</span></span><span class="main">,</span> <span class="quoted"><span class="free">b</span></span><span class="main">]</span>
  <span class="keyword2"><span class="keyword">and</span></span> R19 <span class="main">=</span> <span class="quoted"><span class="free">A1</span></span><span class="main">:</span> <span class="main">[</span><span class="quoted"><span class="free">a</span></span><span class="main">,</span> <span class="quoted"><span class="free">b</span></span><span class="main">]</span><span class="main">,</span> <span class="main">[</span><span class="quoted"><span class="free">c</span></span><span class="main">,</span> <span class="quoted"><span class="free">d</span></span><span class="main">]</span>    <span class="quoted"><span class="free">A2</span></span><span class="main">:</span> <span class="main">[</span><span class="quoted"><span class="free">c</span></span><span class="main">,</span> <span class="quoted"><span class="free">d</span></span><span class="main">]</span><span class="main">,</span> <span class="main">[</span><span class="quoted"><span class="free">a</span></span><span class="main">,</span> <span class="quoted"><span class="free">b</span></span><span class="main">]</span>    <span class="quoted"><span class="free">A3</span></span><span class="main">:</span> <span class="main">[</span><span class="quoted"><span class="free">b</span></span><span class="main">,</span> <span class="quoted"><span class="free">d</span></span><span class="main">]</span><span class="main">,</span> <span class="quoted"><span class="free">a</span></span><span class="main">,</span> <span class="quoted"><span class="free">c</span></span>      <span class="quoted"><span class="free">A4</span></span><span class="main">:</span> <span class="main">[</span><span class="quoted"><span class="free">a</span></span><span class="main">,</span> <span class="quoted"><span class="free">c</span></span><span class="main">]</span><span class="main">,</span> <span class="main">[</span><span class="quoted"><span class="free">b</span></span><span class="main">,</span> <span class="quoted"><span class="free">d</span></span><span class="main">]</span>
  <span class="keyword2"><span class="keyword">and</span></span> R20 <span class="main">=</span> <span class="quoted"><span class="free">A1</span></span><span class="main">:</span> <span class="main">[</span><span class="quoted"><span class="free">b</span></span><span class="main">,</span> <span class="quoted"><span class="free">d</span></span><span class="main">]</span><span class="main">,</span> <span class="quoted"><span class="free">a</span></span><span class="main">,</span> <span class="quoted"><span class="free">c</span></span>      <span class="quoted"><span class="free">A2</span></span><span class="main">:</span> <span class="quoted"><span class="free">b</span></span><span class="main">,</span> <span class="quoted"><span class="free">a</span></span><span class="main">,</span> <span class="main">[</span><span class="quoted"><span class="free">c</span></span><span class="main">,</span> <span class="quoted"><span class="free">d</span></span><span class="main">]</span>      <span class="quoted"><span class="free">A3</span></span><span class="main">:</span> <span class="quoted"><span class="free">a</span></span><span class="main">,</span> <span class="quoted"><span class="free">c</span></span><span class="main">,</span> <span class="main">[</span><span class="quoted"><span class="free">b</span></span><span class="main">,</span> <span class="quoted"><span class="free">d</span></span><span class="main">]</span>      <span class="quoted"><span class="free">A4</span></span><span class="main">:</span> <span class="quoted"><span class="free">d</span></span><span class="main">,</span> <span class="quoted"><span class="free">c</span></span><span class="main">,</span> <span class="main">[</span><span class="quoted"><span class="free">a</span></span><span class="main">,</span> <span class="quoted"><span class="free">b</span></span><span class="main">]</span>
  <span class="keyword2"><span class="keyword">and</span></span> R21 <span class="main">=</span> <span class="quoted"><span class="free">A1</span></span><span class="main">:</span> <span class="main">[</span><span class="quoted"><span class="free">a</span></span><span class="main">,</span> <span class="quoted"><span class="free">d</span></span><span class="main">]</span><span class="main">,</span> <span class="quoted"><span class="free">c</span></span><span class="main">,</span> <span class="quoted"><span class="free">b</span></span>      <span class="quoted"><span class="free">A2</span></span><span class="main">:</span> <span class="quoted"><span class="free">d</span></span><span class="main">,</span> <span class="quoted"><span class="free">c</span></span><span class="main">,</span> <span class="main">[</span><span class="quoted"><span class="free">a</span></span><span class="main">,</span> <span class="quoted"><span class="free">b</span></span><span class="main">]</span>      <span class="quoted"><span class="free">A3</span></span><span class="main">:</span> <span class="quoted"><span class="free">c</span></span><span class="main">,</span> <span class="main">[</span><span class="quoted"><span class="free">a</span></span><span class="main">,</span> <span class="quoted"><span class="free">b</span></span><span class="main">]</span><span class="main">,</span> <span class="quoted"><span class="free">d</span></span>      <span class="quoted"><span class="free">A4</span></span><span class="main">:</span> <span class="quoted"><span class="free">a</span></span><span class="main">,</span> <span class="quoted"><span class="free">b</span></span><span class="main">,</span> <span class="main">[</span><span class="quoted"><span class="free">c</span></span><span class="main">,</span> <span class="quoted"><span class="free">d</span></span><span class="main">]</span>
  <span class="keyword2"><span class="keyword">and</span></span> R22 <span class="main">=</span> <span class="quoted"><span class="free">A1</span></span><span class="main">:</span> <span class="main">[</span><span class="quoted"><span class="free">a</span></span><span class="main">,</span> <span class="quoted"><span class="free">c</span></span><span class="main">]</span><span class="main">,</span> <span class="quoted"><span class="free">d</span></span><span class="main">,</span> <span class="quoted"><span class="free">b</span></span>      <span class="quoted"><span class="free">A2</span></span><span class="main">:</span> <span class="quoted"><span class="free">d</span></span><span class="main">,</span> <span class="quoted"><span class="free">c</span></span><span class="main">,</span> <span class="main">[</span><span class="quoted"><span class="free">a</span></span><span class="main">,</span> <span class="quoted"><span class="free">b</span></span><span class="main">]</span>      <span class="quoted"><span class="free">A3</span></span><span class="main">:</span> <span class="quoted"><span class="free">d</span></span><span class="main">,</span> <span class="main">[</span><span class="quoted"><span class="free">a</span></span><span class="main">,</span> <span class="quoted"><span class="free">b</span></span><span class="main">]</span><span class="main">,</span> <span class="quoted"><span class="free">c</span></span>      <span class="quoted"><span class="free">A4</span></span><span class="main">:</span> <span class="quoted"><span class="free">a</span></span><span class="main">,</span> <span class="quoted"><span class="free">b</span></span><span class="main">,</span> <span class="main">[</span><span class="quoted"><span class="free">c</span></span><span class="main">,</span> <span class="quoted"><span class="free">d</span></span><span class="main">]</span>
  <span class="keyword2"><span class="keyword">and</span></span> R23 <span class="main">=</span> <span class="quoted"><span class="free">A1</span></span><span class="main">:</span> <span class="main">[</span><span class="quoted"><span class="free">a</span></span><span class="main">,</span> <span class="quoted"><span class="free">b</span></span><span class="main">]</span><span class="main">,</span> <span class="main">[</span><span class="quoted"><span class="free">c</span></span><span class="main">,</span> <span class="quoted"><span class="free">d</span></span><span class="main">]</span>    <span class="quoted"><span class="free">A2</span></span><span class="main">:</span> <span class="main">[</span><span class="quoted"><span class="free">c</span></span><span class="main">,</span> <span class="quoted"><span class="free">d</span></span><span class="main">]</span><span class="main">,</span> <span class="main">[</span><span class="quoted"><span class="free">a</span></span><span class="main">,</span> <span class="quoted"><span class="free">b</span></span><span class="main">]</span>    <span class="quoted"><span class="free">A3</span></span><span class="main">:</span> <span class="main">[</span><span class="quoted"><span class="free">a</span></span><span class="main">,</span> <span class="quoted"><span class="free">c</span></span><span class="main">]</span><span class="main">,</span> <span class="main">[</span><span class="quoted"><span class="free">b</span></span><span class="main">,</span> <span class="quoted"><span class="free">d</span></span><span class="main">]</span>    <span class="quoted"><span class="free">A4</span></span><span class="main">:</span> <span class="main">[</span><span class="quoted"><span class="free">a</span></span><span class="main">,</span> <span class="quoted"><span class="free">b</span></span><span class="main">,</span> <span class="quoted"><span class="free">d</span></span><span class="main">]</span><span class="main">,</span> <span class="quoted"><span class="free">c</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> R24 <span class="main">=</span> <span class="quoted"><span class="free">A1</span></span><span class="main">:</span> <span class="main">[</span><span class="quoted"><span class="free">c</span></span><span class="main">,</span> <span class="quoted"><span class="free">d</span></span><span class="main">]</span><span class="main">,</span> <span class="main">[</span><span class="quoted"><span class="free">a</span></span><span class="main">,</span> <span class="quoted"><span class="free">b</span></span><span class="main">]</span>    <span class="quoted"><span class="free">A2</span></span><span class="main">:</span> <span class="quoted"><span class="free">d</span></span><span class="main">,</span> <span class="quoted"><span class="free">b</span></span><span class="main">,</span> <span class="quoted"><span class="free">a</span></span><span class="main">,</span> <span class="quoted"><span class="free">c</span></span>        <span class="quoted"><span class="free">A3</span></span><span class="main">:</span> <span class="quoted"><span class="free">c</span></span><span class="main">,</span> <span class="quoted"><span class="free">a</span></span><span class="main">,</span> <span class="main">[</span><span class="quoted"><span class="free">b</span></span><span class="main">,</span> <span class="quoted"><span class="free">d</span></span><span class="main">]</span>      <span class="quoted"><span class="free">A4</span></span><span class="main">:</span> <span class="quoted"><span class="free">b</span></span><span class="main">,</span> <span class="quoted"><span class="free">a</span></span><span class="main">,</span> <span class="main">[</span><span class="quoted"><span class="free">c</span></span><span class="main">,</span> <span class="quoted"><span class="free">d</span></span><span class="main">]</span>
  <span class="keyword2"><span class="keyword">and</span></span> R25 <span class="main">=</span> <span class="quoted"><span class="free">A1</span></span><span class="main">:</span> <span class="main">[</span><span class="quoted"><span class="free">c</span></span><span class="main">,</span> <span class="quoted"><span class="free">d</span></span><span class="main">]</span><span class="main">,</span> <span class="main">[</span><span class="quoted"><span class="free">a</span></span><span class="main">,</span> <span class="quoted"><span class="free">b</span></span><span class="main">]</span>    <span class="quoted"><span class="free">A2</span></span><span class="main">:</span> <span class="main">[</span><span class="quoted"><span class="free">b</span></span><span class="main">,</span> <span class="quoted"><span class="free">d</span></span><span class="main">]</span><span class="main">,</span> <span class="quoted"><span class="free">a</span></span><span class="main">,</span> <span class="quoted"><span class="free">c</span></span>      <span class="quoted"><span class="free">A3</span></span><span class="main">:</span> <span class="quoted"><span class="free">a</span></span><span class="main">,</span> <span class="quoted"><span class="free">b</span></span><span class="main">,</span> <span class="main">[</span><span class="quoted"><span class="free">c</span></span><span class="main">,</span> <span class="quoted"><span class="free">d</span></span><span class="main">]</span>      <span class="quoted"><span class="free">A4</span></span><span class="main">:</span> <span class="quoted"><span class="free">a</span></span><span class="main">,</span> <span class="quoted"><span class="free">c</span></span><span class="main">,</span> <span class="main">[</span><span class="quoted"><span class="free">b</span></span><span class="main">,</span> <span class="quoted"><span class="free">d</span></span><span class="main">]</span>
  <span class="keyword2"><span class="keyword">and</span></span> R26 <span class="main">=</span> <span class="quoted"><span class="free">A1</span></span><span class="main">:</span> <span class="main">[</span><span class="quoted"><span class="free">b</span></span><span class="main">,</span> <span class="quoted"><span class="free">d</span></span><span class="main">]</span><span class="main">,</span> <span class="main">[</span><span class="quoted"><span class="free">a</span></span><span class="main">,</span> <span class="quoted"><span class="free">c</span></span><span class="main">]</span>    <span class="quoted"><span class="free">A2</span></span><span class="main">:</span> <span class="main">[</span><span class="quoted"><span class="free">c</span></span><span class="main">,</span> <span class="quoted"><span class="free">d</span></span><span class="main">]</span><span class="main">,</span> <span class="main">[</span><span class="quoted"><span class="free">a</span></span><span class="main">,</span> <span class="quoted"><span class="free">b</span></span><span class="main">]</span>    <span class="quoted"><span class="free">A3</span></span><span class="main">:</span> <span class="quoted"><span class="free">a</span></span><span class="main">,</span> <span class="quoted"><span class="free">b</span></span><span class="main">,</span> <span class="main">[</span><span class="quoted"><span class="free">c</span></span><span class="main">,</span> <span class="quoted"><span class="free">d</span></span><span class="main">]</span>      <span class="quoted"><span class="free">A4</span></span><span class="main">:</span> <span class="quoted"><span class="free">a</span></span><span class="main">,</span> <span class="quoted"><span class="free">c</span></span><span class="main">,</span> <span class="main">[</span><span class="quoted"><span class="free">b</span></span><span class="main">,</span> <span class="quoted"><span class="free">d</span></span><span class="main">]</span>
  <span class="keyword2"><span class="keyword">and</span></span> R27 <span class="main">=</span> <span class="quoted"><span class="free">A1</span></span><span class="main">:</span> <span class="main">[</span><span class="quoted"><span class="free">a</span></span><span class="main">,</span> <span class="quoted"><span class="free">b</span></span><span class="main">]</span><span class="main">,</span> <span class="main">[</span><span class="quoted"><span class="free">c</span></span><span class="main">,</span> <span class="quoted"><span class="free">d</span></span><span class="main">]</span>    <span class="quoted"><span class="free">A2</span></span><span class="main">:</span> <span class="main">[</span><span class="quoted"><span class="free">b</span></span><span class="main">,</span> <span class="quoted"><span class="free">d</span></span><span class="main">]</span><span class="main">,</span> <span class="quoted"><span class="free">a</span></span><span class="main">,</span> <span class="quoted"><span class="free">c</span></span>      <span class="quoted"><span class="free">A3</span></span><span class="main">:</span> <span class="main">[</span><span class="quoted"><span class="free">a</span></span><span class="main">,</span> <span class="quoted"><span class="free">c</span></span><span class="main">]</span><span class="main">,</span> <span class="main">[</span><span class="quoted"><span class="free">b</span></span><span class="main">,</span> <span class="quoted"><span class="free">d</span></span><span class="main">]</span>    <span class="quoted"><span class="free">A4</span></span><span class="main">:</span> <span class="main">[</span><span class="quoted"><span class="free">c</span></span><span class="main">,</span> <span class="quoted"><span class="free">d</span></span><span class="main">]</span><span class="main">,</span> <span class="quoted"><span class="free">a</span></span><span class="main">,</span> <span class="quoted"><span class="free">b</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> R28 <span class="main">=</span> <span class="quoted"><span class="free">A1</span></span><span class="main">:</span> <span class="main">[</span><span class="quoted"><span class="free">c</span></span><span class="main">,</span> <span class="quoted"><span class="free">d</span></span><span class="main">]</span><span class="main">,</span> <span class="quoted"><span class="free">a</span></span><span class="main">,</span> <span class="quoted"><span class="free">b</span></span>      <span class="quoted"><span class="free">A2</span></span><span class="main">:</span> <span class="main">[</span><span class="quoted"><span class="free">b</span></span><span class="main">,</span> <span class="quoted"><span class="free">d</span></span><span class="main">]</span><span class="main">,</span> <span class="quoted"><span class="free">a</span></span><span class="main">,</span> <span class="quoted"><span class="free">c</span></span>      <span class="quoted"><span class="free">A3</span></span><span class="main">:</span> <span class="quoted"><span class="free">a</span></span><span class="main">,</span> <span class="quoted"><span class="free">b</span></span><span class="main">,</span> <span class="main">[</span><span class="quoted"><span class="free">c</span></span><span class="main">,</span> <span class="quoted"><span class="free">d</span></span><span class="main">]</span>      <span class="quoted"><span class="free">A4</span></span><span class="main">:</span> <span class="quoted"><span class="free">a</span></span><span class="main">,</span> <span class="quoted"><span class="free">c</span></span><span class="main">,</span> <span class="main">[</span><span class="quoted"><span class="free">b</span></span><span class="main">,</span> <span class="quoted"><span class="free">d</span></span><span class="main">]</span>
  <span class="keyword2"><span class="keyword">and</span></span> R29 <span class="main">=</span> <span class="quoted"><span class="free">A1</span></span><span class="main">:</span> <span class="main">[</span><span class="quoted"><span class="free">a</span></span><span class="main">,</span> <span class="quoted"><span class="free">c</span></span><span class="main">]</span><span class="main">,</span> <span class="quoted"><span class="free">d</span></span><span class="main">,</span> <span class="quoted"><span class="free">b</span></span>      <span class="quoted"><span class="free">A2</span></span><span class="main">:</span> <span class="main">[</span><span class="quoted"><span class="free">b</span></span><span class="main">,</span> <span class="quoted"><span class="free">d</span></span><span class="main">]</span><span class="main">,</span> <span class="quoted"><span class="free">a</span></span><span class="main">,</span> <span class="quoted"><span class="free">c</span></span>      <span class="quoted"><span class="free">A3</span></span><span class="main">:</span> <span class="quoted"><span class="free">a</span></span><span class="main">,</span> <span class="quoted"><span class="free">b</span></span><span class="main">,</span> <span class="main">[</span><span class="quoted"><span class="free">c</span></span><span class="main">,</span> <span class="quoted"><span class="free">d</span></span><span class="main">]</span>      <span class="quoted"><span class="free">A4</span></span><span class="main">:</span> <span class="quoted"><span class="free">d</span></span><span class="main">,</span> <span class="quoted"><span class="free">c</span></span><span class="main">,</span> <span class="main">[</span><span class="quoted"><span class="free">a</span></span><span class="main">,</span> <span class="quoted"><span class="free">b</span></span><span class="main">]</span>
  <span class="keyword2"><span class="keyword">and</span></span> R30 <span class="main">=</span> <span class="quoted"><span class="free">A1</span></span><span class="main">:</span> <span class="main">[</span><span class="quoted"><span class="free">a</span></span><span class="main">,</span> <span class="quoted"><span class="free">d</span></span><span class="main">]</span><span class="main">,</span> <span class="quoted"><span class="free">c</span></span><span class="main">,</span> <span class="quoted"><span class="free">b</span></span>      <span class="quoted"><span class="free">A2</span></span><span class="main">:</span> <span class="quoted"><span class="free">d</span></span><span class="main">,</span> <span class="quoted"><span class="free">c</span></span><span class="main">,</span> <span class="main">[</span><span class="quoted"><span class="free">a</span></span><span class="main">,</span> <span class="quoted"><span class="free">b</span></span><span class="main">]</span>      <span class="quoted"><span class="free">A3</span></span><span class="main">:</span> <span class="quoted"><span class="free">c</span></span><span class="main">,</span> <span class="main">[</span><span class="quoted"><span class="free">a</span></span><span class="main">,</span> <span class="quoted"><span class="free">b</span></span><span class="main">]</span><span class="main">,</span> <span class="quoted"><span class="free">d</span></span>      <span class="quoted"><span class="free">A4</span></span><span class="main">:</span> <span class="main">[</span><span class="quoted"><span class="free">a</span></span><span class="main">,</span> <span class="quoted"><span class="free">b</span></span><span class="main">]</span><span class="main">,</span> <span class="quoted"><span class="free">d</span></span><span class="main">,</span> <span class="quoted"><span class="free">c</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> R31 <span class="main">=</span> <span class="quoted"><span class="free">A1</span></span><span class="main">:</span> <span class="main">[</span><span class="quoted"><span class="free">b</span></span><span class="main">,</span> <span class="quoted"><span class="free">d</span></span><span class="main">]</span><span class="main">,</span> <span class="quoted"><span class="free">a</span></span><span class="main">,</span> <span class="quoted"><span class="free">c</span></span>      <span class="quoted"><span class="free">A2</span></span><span class="main">:</span> <span class="main">[</span><span class="quoted"><span class="free">a</span></span><span class="main">,</span> <span class="quoted"><span class="free">c</span></span><span class="main">]</span><span class="main">,</span> <span class="quoted"><span class="free">d</span></span><span class="main">,</span> <span class="quoted"><span class="free">b</span></span>      <span class="quoted"><span class="free">A3</span></span><span class="main">:</span> <span class="quoted"><span class="free">c</span></span><span class="main">,</span> <span class="quoted"><span class="free">d</span></span><span class="main">,</span> <span class="main">[</span><span class="quoted"><span class="free">a</span></span><span class="main">,</span> <span class="quoted"><span class="free">b</span></span><span class="main">]</span>      <span class="quoted"><span class="free">A4</span></span><span class="main">:</span> <span class="main">[</span><span class="quoted"><span class="free">a</span></span><span class="main">,</span> <span class="quoted"><span class="free">b</span></span><span class="main">]</span><span class="main">,</span> <span class="quoted"><span class="free">c</span></span><span class="main">,</span> <span class="quoted"><span class="free">d</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> R32 <span class="main">=</span> <span class="quoted"><span class="free">A1</span></span><span class="main">:</span> <span class="main">[</span><span class="quoted"><span class="free">a</span></span><span class="main">,</span> <span class="quoted"><span class="free">c</span></span><span class="main">]</span><span class="main">,</span> <span class="quoted"><span class="free">d</span></span><span class="main">,</span> <span class="quoted"><span class="free">b</span></span>      <span class="quoted"><span class="free">A2</span></span><span class="main">:</span> <span class="quoted"><span class="free">d</span></span><span class="main">,</span> <span class="quoted"><span class="free">c</span></span><span class="main">,</span> <span class="main">[</span><span class="quoted"><span class="free">a</span></span><span class="main">,</span> <span class="quoted"><span class="free">b</span></span><span class="main">]</span>      <span class="quoted"><span class="free">A3</span></span><span class="main">:</span> <span class="quoted"><span class="free">d</span></span><span class="main">,</span> <span class="main">[</span><span class="quoted"><span class="free">a</span></span><span class="main">,</span> <span class="quoted"><span class="free">b</span></span><span class="main">]</span><span class="main">,</span> <span class="quoted"><span class="free">c</span></span>      <span class="quoted"><span class="free">A4</span></span><span class="main">:</span> <span class="main">[</span><span class="quoted"><span class="free">a</span></span><span class="main">,</span> <span class="quoted"><span class="free">b</span></span><span class="main">]</span><span class="main">,</span> <span class="quoted"><span class="free">d</span></span><span class="main">,</span> <span class="quoted"><span class="free">c</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> R33 <span class="main">=</span> <span class="quoted"><span class="free">A1</span></span><span class="main">:</span> <span class="main">[</span><span class="quoted"><span class="free">c</span></span><span class="main">,</span> <span class="quoted"><span class="free">d</span></span><span class="main">]</span><span class="main">,</span> <span class="main">[</span><span class="quoted"><span class="free">a</span></span><span class="main">,</span> <span class="quoted"><span class="free">b</span></span><span class="main">]</span>    <span class="quoted"><span class="free">A2</span></span><span class="main">:</span> <span class="main">[</span><span class="quoted"><span class="free">a</span></span><span class="main">,</span> <span class="quoted"><span class="free">c</span></span><span class="main">]</span><span class="main">,</span> <span class="quoted"><span class="free">d</span></span><span class="main">,</span> <span class="quoted"><span class="free">b</span></span>      <span class="quoted"><span class="free">A3</span></span><span class="main">:</span> <span class="quoted"><span class="free">a</span></span><span class="main">,</span> <span class="quoted"><span class="free">b</span></span><span class="main">,</span> <span class="main">[</span><span class="quoted"><span class="free">c</span></span><span class="main">,</span> <span class="quoted"><span class="free">d</span></span><span class="main">]</span>      <span class="quoted"><span class="free">A4</span></span><span class="main">:</span> <span class="quoted"><span class="free">d</span></span><span class="main">,</span> <span class="main">[</span><span class="quoted"><span class="free">a</span></span><span class="main">,</span> <span class="quoted"><span class="free">b</span></span><span class="main">]</span><span class="main">,</span> <span class="quoted"><span class="free">c</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> R34 <span class="main">=</span> <span class="quoted"><span class="free">A1</span></span><span class="main">:</span> <span class="main">[</span><span class="quoted"><span class="free">a</span></span><span class="main">,</span> <span class="quoted"><span class="free">b</span></span><span class="main">]</span><span class="main">,</span> <span class="main">[</span><span class="quoted"><span class="free">c</span></span><span class="main">,</span> <span class="quoted"><span class="free">d</span></span><span class="main">]</span>    <span class="quoted"><span class="free">A2</span></span><span class="main">:</span> <span class="quoted"><span class="free">a</span></span><span class="main">,</span> <span class="quoted"><span class="free">c</span></span><span class="main">,</span> <span class="quoted"><span class="free">d</span></span><span class="main">,</span> <span class="quoted"><span class="free">b</span></span>        <span class="quoted"><span class="free">A3</span></span><span class="main">:</span> <span class="quoted"><span class="free">b</span></span><span class="main">,</span> <span class="main">[</span><span class="quoted"><span class="free">a</span></span><span class="main">,</span> <span class="quoted"><span class="free">d</span></span><span class="main">]</span><span class="main">,</span> <span class="quoted"><span class="free">c</span></span>      <span class="quoted"><span class="free">A4</span></span><span class="main">:</span> <span class="quoted"><span class="free">c</span></span><span class="main">,</span> <span class="quoted"><span class="free">d</span></span><span class="main">,</span> <span class="main">[</span><span class="quoted"><span class="free">a</span></span><span class="main">,</span> <span class="quoted"><span class="free">b</span></span><span class="main">]</span>
  <span class="keyword2"><span class="keyword">and</span></span> R35 <span class="main">=</span> <span class="quoted"><span class="free">A1</span></span><span class="main">:</span> <span class="main">[</span><span class="quoted"><span class="free">a</span></span><span class="main">,</span> <span class="quoted"><span class="free">d</span></span><span class="main">]</span><span class="main">,</span> <span class="quoted"><span class="free">c</span></span><span class="main">,</span> <span class="quoted"><span class="free">b</span></span>      <span class="quoted"><span class="free">A2</span></span><span class="main">:</span> <span class="quoted"><span class="free">a</span></span><span class="main">,</span> <span class="quoted"><span class="free">b</span></span><span class="main">,</span> <span class="main">[</span><span class="quoted"><span class="free">c</span></span><span class="main">,</span> <span class="quoted"><span class="free">d</span></span><span class="main">]</span>      <span class="quoted"><span class="free">A3</span></span><span class="main">:</span> <span class="main">[</span><span class="quoted"><span class="free">a</span></span><span class="main">,</span> <span class="quoted"><span class="free">b</span></span><span class="main">,</span> <span class="quoted"><span class="free">c</span></span><span class="main">]</span><span class="main">,</span> <span class="quoted"><span class="free">d</span></span>      <span class="quoted"><span class="free">A4</span></span><span class="main">:</span> <span class="quoted"><span class="free">d</span></span><span class="main">,</span> <span class="quoted"><span class="free">c</span></span><span class="main">,</span> <span class="main">[</span><span class="quoted"><span class="free">a</span></span><span class="main">,</span> <span class="quoted"><span class="free">b</span></span><span class="main">]</span>
  <span class="keyword2"><span class="keyword">and</span></span> R36 <span class="main">=</span> <span class="quoted"><span class="free">A1</span></span><span class="main">:</span> <span class="main">[</span><span class="quoted"><span class="free">c</span></span><span class="main">,</span> <span class="quoted"><span class="free">d</span></span><span class="main">]</span><span class="main">,</span> <span class="main">[</span><span class="quoted"><span class="free">a</span></span><span class="main">,</span> <span class="quoted"><span class="free">b</span></span><span class="main">]</span>    <span class="quoted"><span class="free">A2</span></span><span class="main">:</span> <span class="main">[</span><span class="quoted"><span class="free">a</span></span><span class="main">,</span> <span class="quoted"><span class="free">c</span></span><span class="main">]</span><span class="main">,</span> <span class="quoted"><span class="free">d</span></span><span class="main">,</span> <span class="quoted"><span class="free">b</span></span>      <span class="quoted"><span class="free">A3</span></span><span class="main">:</span> <span class="main">[</span><span class="quoted"><span class="free">b</span></span><span class="main">,</span> <span class="quoted"><span class="free">d</span></span><span class="main">]</span><span class="main">,</span> <span class="quoted"><span class="free">a</span></span><span class="main">,</span> <span class="quoted"><span class="free">c</span></span>      <span class="quoted"><span class="free">A4</span></span><span class="main">:</span> <span class="quoted"><span class="free">a</span></span><span class="main">,</span> <span class="quoted"><span class="free">b</span></span><span class="main">,</span> <span class="main">[</span><span class="quoted"><span class="free">c</span></span><span class="main">,</span> <span class="quoted"><span class="free">d</span></span><span class="main">]</span>
  <span class="keyword2"><span class="keyword">and</span></span> R37 <span class="main">=</span> <span class="quoted"><span class="free">A1</span></span><span class="main">:</span> <span class="main">[</span><span class="quoted"><span class="free">a</span></span><span class="main">,</span> <span class="quoted"><span class="free">c</span></span><span class="main">]</span><span class="main">,</span> <span class="main">[</span><span class="quoted"><span class="free">b</span></span><span class="main">,</span> <span class="quoted"><span class="free">d</span></span><span class="main">]</span>    <span class="quoted"><span class="free">A2</span></span><span class="main">:</span> <span class="main">[</span><span class="quoted"><span class="free">b</span></span><span class="main">,</span> <span class="quoted"><span class="free">d</span></span><span class="main">]</span><span class="main">,</span> <span class="main">[</span><span class="quoted"><span class="free">a</span></span><span class="main">,</span> <span class="quoted"><span class="free">c</span></span><span class="main">]</span>    <span class="quoted"><span class="free">A3</span></span><span class="main">:</span> <span class="quoted"><span class="free">a</span></span><span class="main">,</span> <span class="quoted"><span class="free">b</span></span><span class="main">,</span> <span class="main">[</span><span class="quoted"><span class="free">c</span></span><span class="main">,</span> <span class="quoted"><span class="free">d</span></span><span class="main">]</span>      <span class="quoted"><span class="free">A4</span></span><span class="main">:</span> <span class="quoted"><span class="free">c</span></span><span class="main">,</span> <span class="quoted"><span class="free">d</span></span><span class="main">,</span> <span class="main">[</span><span class="quoted"><span class="free">a</span></span><span class="main">,</span> <span class="quoted"><span class="free">b</span></span><span class="main">]</span>
  <span class="keyword2"><span class="keyword">and</span></span> R38 <span class="main">=</span> <span class="quoted"><span class="free">A1</span></span><span class="main">:</span> <span class="main">[</span><span class="quoted"><span class="free">c</span></span><span class="main">,</span> <span class="quoted"><span class="free">d</span></span><span class="main">]</span><span class="main">,</span> <span class="quoted"><span class="free">a</span></span><span class="main">,</span> <span class="quoted"><span class="free">b</span></span>      <span class="quoted"><span class="free">A2</span></span><span class="main">:</span> <span class="main">[</span><span class="quoted"><span class="free">b</span></span><span class="main">,</span> <span class="quoted"><span class="free">d</span></span><span class="main">]</span><span class="main">,</span> <span class="quoted"><span class="free">a</span></span><span class="main">,</span> <span class="quoted"><span class="free">c</span></span>      <span class="quoted"><span class="free">A3</span></span><span class="main">:</span> <span class="quoted"><span class="free">a</span></span><span class="main">,</span> <span class="quoted"><span class="free">b</span></span><span class="main">,</span> <span class="main">[</span><span class="quoted"><span class="free">c</span></span><span class="main">,</span> <span class="quoted"><span class="free">d</span></span><span class="main">]</span>      <span class="quoted"><span class="free">A4</span></span><span class="main">:</span> <span class="main">[</span><span class="quoted"><span class="free">a</span></span><span class="main">,</span> <span class="quoted"><span class="free">c</span></span><span class="main">]</span><span class="main">,</span> <span class="quoted"><span class="free">b</span></span><span class="main">,</span> <span class="quoted"><span class="free">d</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> R39 <span class="main">=</span> <span class="quoted"><span class="free">A1</span></span><span class="main">:</span> <span class="main">[</span><span class="quoted"><span class="free">a</span></span><span class="main">,</span> <span class="quoted"><span class="free">c</span></span><span class="main">]</span><span class="main">,</span> <span class="quoted"><span class="free">d</span></span><span class="main">,</span> <span class="quoted"><span class="free">b</span></span>      <span class="quoted"><span class="free">A2</span></span><span class="main">:</span> <span class="main">[</span><span class="quoted"><span class="free">b</span></span><span class="main">,</span> <span class="quoted"><span class="free">d</span></span><span class="main">]</span><span class="main">,</span> <span class="quoted"><span class="free">a</span></span><span class="main">,</span> <span class="quoted"><span class="free">c</span></span>      <span class="quoted"><span class="free">A3</span></span><span class="main">:</span> <span class="quoted"><span class="free">a</span></span><span class="main">,</span> <span class="quoted"><span class="free">b</span></span><span class="main">,</span> <span class="main">[</span><span class="quoted"><span class="free">c</span></span><span class="main">,</span> <span class="quoted"><span class="free">d</span></span><span class="main">]</span>      <span class="quoted"><span class="free">A4</span></span><span class="main">:</span> <span class="main">[</span><span class="quoted"><span class="free">c</span></span><span class="main">,</span> <span class="quoted"><span class="free">d</span></span><span class="main">]</span><span class="main">,</span> <span class="quoted"><span class="free">a</span></span><span class="main">,</span> <span class="quoted"><span class="free">b</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> R40 <span class="main">=</span> <span class="quoted"><span class="free">A1</span></span><span class="main">:</span> <span class="main">[</span><span class="quoted"><span class="free">a</span></span><span class="main">,</span> <span class="quoted"><span class="free">d</span></span><span class="main">]</span><span class="main">,</span> <span class="quoted"><span class="free">c</span></span><span class="main">,</span> <span class="quoted"><span class="free">b</span></span>      <span class="quoted"><span class="free">A2</span></span><span class="main">:</span> <span class="main">[</span><span class="quoted"><span class="free">a</span></span><span class="main">,</span> <span class="quoted"><span class="free">b</span></span><span class="main">]</span><span class="main">,</span> <span class="quoted"><span class="free">c</span></span><span class="main">,</span> <span class="quoted"><span class="free">d</span></span>      <span class="quoted"><span class="free">A3</span></span><span class="main">:</span> <span class="main">[</span><span class="quoted"><span class="free">a</span></span><span class="main">,</span> <span class="quoted"><span class="free">b</span></span><span class="main">,</span> <span class="quoted"><span class="free">c</span></span><span class="main">]</span><span class="main">,</span> <span class="quoted"><span class="free">d</span></span>      <span class="quoted"><span class="free">A4</span></span><span class="main">:</span> <span class="quoted"><span class="free">d</span></span><span class="main">,</span> <span class="quoted"><span class="free">c</span></span><span class="main">,</span> <span class="main">[</span><span class="quoted"><span class="free">a</span></span><span class="main">,</span> <span class="quoted"><span class="free">b</span></span><span class="main">]</span>
  <span class="keyword2"><span class="keyword">and</span></span> R41 <span class="main">=</span> <span class="quoted"><span class="free">A1</span></span><span class="main">:</span> <span class="main">[</span><span class="quoted"><span class="free">a</span></span><span class="main">,</span> <span class="quoted"><span class="free">d</span></span><span class="main">]</span><span class="main">,</span> <span class="quoted"><span class="free">c</span></span><span class="main">,</span> <span class="quoted"><span class="free">b</span></span>      <span class="quoted"><span class="free">A2</span></span><span class="main">:</span> <span class="main">[</span><span class="quoted"><span class="free">a</span></span><span class="main">,</span> <span class="quoted"><span class="free">b</span></span><span class="main">]</span><span class="main">,</span> <span class="quoted"><span class="free">d</span></span><span class="main">,</span> <span class="quoted"><span class="free">c</span></span>      <span class="quoted"><span class="free">A3</span></span><span class="main">:</span> <span class="main">[</span><span class="quoted"><span class="free">a</span></span><span class="main">,</span> <span class="quoted"><span class="free">b</span></span><span class="main">,</span> <span class="quoted"><span class="free">c</span></span><span class="main">]</span><span class="main">,</span> <span class="quoted"><span class="free">d</span></span>      <span class="quoted"><span class="free">A4</span></span><span class="main">:</span> <span class="quoted"><span class="free">d</span></span><span class="main">,</span> <span class="quoted"><span class="free">c</span></span><span class="main">,</span> <span class="main">[</span><span class="quoted"><span class="free">a</span></span><span class="main">,</span> <span class="quoted"><span class="free">b</span></span><span class="main">]</span>
  <span class="keyword2"><span class="keyword">and</span></span> R42 <span class="main">=</span> <span class="quoted"><span class="free">A1</span></span><span class="main">:</span> <span class="main">[</span><span class="quoted"><span class="free">c</span></span><span class="main">,</span> <span class="quoted"><span class="free">d</span></span><span class="main">]</span><span class="main">,</span> <span class="main">[</span><span class="quoted"><span class="free">a</span></span><span class="main">,</span> <span class="quoted"><span class="free">b</span></span><span class="main">]</span>    <span class="quoted"><span class="free">A2</span></span><span class="main">:</span> <span class="main">[</span><span class="quoted"><span class="free">a</span></span><span class="main">,</span> <span class="quoted"><span class="free">b</span></span><span class="main">]</span><span class="main">,</span> <span class="main">[</span><span class="quoted"><span class="free">c</span></span><span class="main">,</span> <span class="quoted"><span class="free">d</span></span><span class="main">]</span>    <span class="quoted"><span class="free">A3</span></span><span class="main">:</span> <span class="quoted"><span class="free">d</span></span><span class="main">,</span> <span class="quoted"><span class="free">b</span></span><span class="main">,</span> <span class="quoted"><span class="free">a</span></span><span class="main">,</span> <span class="quoted"><span class="free">c</span></span>        <span class="quoted"><span class="free">A4</span></span><span class="main">:</span> <span class="quoted"><span class="free">c</span></span><span class="main">,</span> <span class="quoted"><span class="free">a</span></span><span class="main">,</span> <span class="main">[</span><span class="quoted"><span class="free">b</span></span><span class="main">,</span> <span class="quoted"><span class="free">d</span></span><span class="main">]</span>
  <span class="keyword2"><span class="keyword">and</span></span> R43 <span class="main">=</span> <span class="quoted"><span class="free">A1</span></span><span class="main">:</span> <span class="main">[</span><span class="quoted"><span class="free">a</span></span><span class="main">,</span> <span class="quoted"><span class="free">b</span></span><span class="main">]</span><span class="main">,</span> <span class="main">[</span><span class="quoted"><span class="free">c</span></span><span class="main">,</span> <span class="quoted"><span class="free">d</span></span><span class="main">]</span>    <span class="quoted"><span class="free">A2</span></span><span class="main">:</span> <span class="main">[</span><span class="quoted"><span class="free">c</span></span><span class="main">,</span> <span class="quoted"><span class="free">d</span></span><span class="main">]</span><span class="main">,</span> <span class="main">[</span><span class="quoted"><span class="free">a</span></span><span class="main">,</span> <span class="quoted"><span class="free">b</span></span><span class="main">]</span>    <span class="quoted"><span class="free">A3</span></span><span class="main">:</span> <span class="quoted"><span class="free">d</span></span><span class="main">,</span> <span class="main">[</span><span class="quoted"><span class="free">a</span></span><span class="main">,</span> <span class="quoted"><span class="free">b</span></span><span class="main">]</span><span class="main">,</span> <span class="quoted"><span class="free">c</span></span>      <span class="quoted"><span class="free">A4</span></span><span class="main">:</span> <span class="quoted"><span class="free">a</span></span><span class="main">,</span> <span class="main">[</span><span class="quoted"><span class="free">c</span></span><span class="main">,</span> <span class="quoted"><span class="free">d</span></span><span class="main">]</span><span class="main">,</span> <span class="quoted"><span class="free">b</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> R44 <span class="main">=</span> <span class="quoted"><span class="free">A1</span></span><span class="main">:</span> <span class="main">[</span><span class="quoted"><span class="free">c</span></span><span class="main">,</span> <span class="quoted"><span class="free">d</span></span><span class="main">]</span><span class="main">,</span> <span class="main">[</span><span class="quoted"><span class="free">a</span></span><span class="main">,</span> <span class="quoted"><span class="free">b</span></span><span class="main">]</span>    <span class="quoted"><span class="free">A2</span></span><span class="main">:</span> <span class="main">[</span><span class="quoted"><span class="free">a</span></span><span class="main">,</span> <span class="quoted"><span class="free">c</span></span><span class="main">]</span><span class="main">,</span> <span class="quoted"><span class="free">d</span></span><span class="main">,</span> <span class="quoted"><span class="free">b</span></span>      <span class="quoted"><span class="free">A3</span></span><span class="main">:</span> <span class="main">[</span><span class="quoted"><span class="free">a</span></span><span class="main">,</span> <span class="quoted"><span class="free">b</span></span><span class="main">]</span><span class="main">,</span> <span class="quoted"><span class="free">d</span></span><span class="main">,</span> <span class="quoted"><span class="free">c</span></span>      <span class="quoted"><span class="free">A4</span></span><span class="main">:</span> <span class="main">[</span><span class="quoted"><span class="free">a</span></span><span class="main">,</span> <span class="quoted"><span class="free">b</span></span><span class="main">,</span> <span class="quoted"><span class="free">d</span></span><span class="main">]</span><span class="main">,</span> <span class="quoted"><span class="free">c</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> R45 <span class="main">=</span> <span class="quoted"><span class="free">A1</span></span><span class="main">:</span> <span class="main">[</span><span class="quoted"><span class="free">a</span></span><span class="main">,</span> <span class="quoted"><span class="free">c</span></span><span class="main">]</span><span class="main">,</span> <span class="quoted"><span class="free">d</span></span><span class="main">,</span> <span class="quoted"><span class="free">b</span></span>      <span class="quoted"><span class="free">A2</span></span><span class="main">:</span> <span class="main">[</span><span class="quoted"><span class="free">b</span></span><span class="main">,</span> <span class="quoted"><span class="free">d</span></span><span class="main">]</span><span class="main">,</span> <span class="quoted"><span class="free">a</span></span><span class="main">,</span> <span class="quoted"><span class="free">c</span></span>      <span class="quoted"><span class="free">A3</span></span><span class="main">:</span> <span class="main">[</span><span class="quoted"><span class="free">a</span></span><span class="main">,</span> <span class="quoted"><span class="free">b</span></span><span class="main">]</span><span class="main">,</span> <span class="quoted"><span class="free">c</span></span><span class="main">,</span> <span class="quoted"><span class="free">d</span></span>      <span class="quoted"><span class="free">A4</span></span><span class="main">:</span> <span class="main">[</span><span class="quoted"><span class="free">c</span></span><span class="main">,</span> <span class="quoted"><span class="free">d</span></span><span class="main">]</span><span class="main">,</span> <span class="quoted"><span class="free">b</span></span><span class="main">,</span> <span class="quoted"><span class="free">a</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> R46 <span class="main">=</span> <span class="quoted"><span class="free">A1</span></span><span class="main">:</span> <span class="main">[</span><span class="quoted"><span class="free">b</span></span><span class="main">,</span> <span class="quoted"><span class="free">d</span></span><span class="main">]</span><span class="main">,</span> <span class="quoted"><span class="free">a</span></span><span class="main">,</span> <span class="quoted"><span class="free">c</span></span>      <span class="quoted"><span class="free">A2</span></span><span class="main">:</span> <span class="quoted"><span class="free">d</span></span><span class="main">,</span> <span class="quoted"><span class="free">c</span></span><span class="main">,</span> <span class="main">[</span><span class="quoted"><span class="free">a</span></span><span class="main">,</span> <span class="quoted"><span class="free">b</span></span><span class="main">]</span>      <span class="quoted"><span class="free">A3</span></span><span class="main">:</span> <span class="main">[</span><span class="quoted"><span class="free">a</span></span><span class="main">,</span> <span class="quoted"><span class="free">c</span></span><span class="main">]</span><span class="main">,</span> <span class="main">[</span><span class="quoted"><span class="free">b</span></span><span class="main">,</span> <span class="quoted"><span class="free">d</span></span><span class="main">]</span>    <span class="quoted"><span class="free">A4</span></span><span class="main">:</span> <span class="quoted"><span class="free">b</span></span><span class="main">,</span> <span class="quoted"><span class="free">a</span></span><span class="main">,</span> <span class="main">[</span><span class="quoted"><span class="free">c</span></span><span class="main">,</span> <span class="quoted"><span class="free">d</span></span><span class="main">]</span>
  <span class="keyword2"><span class="keyword">and</span></span> R47 <span class="main">=</span> <span class="quoted"><span class="free">A1</span></span><span class="main">:</span> <span class="main">[</span><span class="quoted"><span class="free">a</span></span><span class="main">,</span> <span class="quoted"><span class="free">b</span></span><span class="main">]</span><span class="main">,</span> <span class="main">[</span><span class="quoted"><span class="free">c</span></span><span class="main">,</span> <span class="quoted"><span class="free">d</span></span><span class="main">]</span>    <span class="quoted"><span class="free">A2</span></span><span class="main">:</span> <span class="main">[</span><span class="quoted"><span class="free">a</span></span><span class="main">,</span> <span class="quoted"><span class="free">d</span></span><span class="main">]</span><span class="main">,</span> <span class="quoted"><span class="free">c</span></span><span class="main">,</span> <span class="quoted"><span class="free">b</span></span>      <span class="quoted"><span class="free">A3</span></span><span class="main">:</span> <span class="quoted"><span class="free">d</span></span><span class="main">,</span> <span class="quoted"><span class="free">c</span></span><span class="main">,</span> <span class="main">[</span><span class="quoted"><span class="free">a</span></span><span class="main">,</span> <span class="quoted"><span class="free">b</span></span><span class="main">]</span>      <span class="quoted"><span class="free">A4</span></span><span class="main">:</span> <span class="quoted"><span class="free">c</span></span><span class="main">,</span> <span class="main">[</span><span class="quoted"><span class="free">a</span></span><span class="main">,</span> <span class="quoted"><span class="free">b</span></span><span class="main">]</span><span class="main">,</span> <span class="quoted"><span class="free">d</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp_all</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> agents alts<span class="main">)</span>

<span class="keyword1"><span class="command">derive_orbit_equations</span></span> <span class="main">(</span>an_sds<span class="main">)</span>
  <span class="quoted">R10</span> <span class="quoted">R26</span> <span class="quoted">R27</span> <span class="quoted">R28</span> <span class="quoted">R29</span> <span class="quoted">R43</span> <span class="quoted">R45</span>
  <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp_all</span>

<span class="keyword1"><span class="command">prove_inefficient_supports</span></span> <span class="main">(</span>ex_post_efficient_sds sd_efficient_sds<span class="main">)</span>
  <span class="quoted"><span class="quoted">R3</span></span> <span class="main">[</span><span class="quoted"><span class="free">b</span></span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">R4</span></span> <span class="main">[</span><span class="quoted"><span class="free">b</span></span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">R5</span></span> <span class="main">[</span><span class="quoted"><span class="free">b</span></span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">R7</span></span> <span class="main">[</span><span class="quoted"><span class="free">b</span></span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">R8</span></span> <span class="main">[</span><span class="quoted"><span class="free">b</span></span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span>
  <span class="quoted"><span class="quoted">R9</span></span> <span class="main">[</span><span class="quoted"><span class="free">b</span></span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">R11</span></span> <span class="main">[</span><span class="quoted"><span class="free">b</span></span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">R12</span></span> <span class="main">[</span><span class="quoted"><span class="free">b</span></span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">R14</span></span> <span class="main">[</span><span class="quoted"><span class="free">b</span></span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">R16</span></span> <span class="main">[</span><span class="quoted"><span class="free">b</span></span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span>
  <span class="quoted"><span class="quoted">R17</span></span> <span class="main">[</span><span class="quoted"><span class="free">b</span></span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">R18</span></span> <span class="main">[</span><span class="quoted"><span class="free">b</span></span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">R21</span></span> <span class="main">[</span><span class="quoted"><span class="free">b</span></span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">R22</span></span> <span class="main">[</span><span class="quoted"><span class="free">b</span></span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">R23</span></span> <span class="main">[</span><span class="quoted"><span class="free">b</span></span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span>
  <span class="quoted"><span class="quoted">R30</span></span> <span class="main">[</span><span class="quoted"><span class="free">b</span></span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">R32</span></span> <span class="main">[</span><span class="quoted"><span class="free">b</span></span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">R33</span></span> <span class="main">[</span><span class="quoted"><span class="free">b</span></span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">R35</span></span> <span class="main">[</span><span class="quoted"><span class="free">b</span></span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">R40</span></span> <span class="main">[</span><span class="quoted"><span class="free">b</span></span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span>
  <span class="quoted"><span class="quoted">R41</span></span> <span class="main">[</span><span class="quoted"><span class="free">b</span></span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">R43</span></span> <span class="main">[</span><span class="quoted"><span class="free">b</span></span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">R44</span></span> <span class="main">[</span><span class="quoted"><span class="free">b</span></span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">R47</span></span> <span class="main">[</span><span class="quoted"><span class="free">b</span></span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span>
  <span class="quoted"><span class="quoted">R10</span></span> <span class="main">[</span><span class="quoted"><span class="free">c</span></span><span class="main">,</span> <span class="quoted"><span class="free">b</span></span><span class="main">]</span> witness<span class="main">:</span> <span class="main">[</span><span class="quoted"><span class="free">a</span></span><span class="main">:</span> 1 <span class="main">/</span> 2<span class="main">,</span> <span class="quoted"><span class="free">b</span></span><span class="main">:</span> 0<span class="main">,</span> <span class="quoted"><span class="free">c</span></span><span class="main">:</span> 0<span class="main">,</span> <span class="quoted"><span class="free">d</span></span><span class="main">:</span> 1 <span class="main">/</span> 2<span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span>
  <span class="quoted"><span class="quoted">R15</span></span> <span class="main">[</span><span class="quoted"><span class="free">c</span></span><span class="main">,</span> <span class="quoted"><span class="free">b</span></span><span class="main">]</span> witness<span class="main">:</span> <span class="main">[</span><span class="quoted"><span class="free">a</span></span><span class="main">:</span> 1 <span class="main">/</span> 2<span class="main">,</span> <span class="quoted"><span class="free">b</span></span><span class="main">:</span> 0<span class="main">,</span> <span class="quoted"><span class="free">c</span></span><span class="main">:</span> 0<span class="main">,</span> <span class="quoted"><span class="free">d</span></span><span class="main">:</span> 1 <span class="main">/</span> 2<span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span>
  <span class="quoted"><span class="quoted">R19</span></span> <span class="main">[</span><span class="quoted"><span class="free">c</span></span><span class="main">,</span> <span class="quoted"><span class="free">b</span></span><span class="main">]</span> witness<span class="main">:</span> <span class="main">[</span><span class="quoted"><span class="free">a</span></span><span class="main">:</span> 1 <span class="main">/</span> 2<span class="main">,</span> <span class="quoted"><span class="free">b</span></span><span class="main">:</span> 0<span class="main">,</span> <span class="quoted"><span class="free">c</span></span><span class="main">:</span> 0<span class="main">,</span> <span class="quoted"><span class="free">d</span></span><span class="main">:</span> 1 <span class="main">/</span> 2<span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span>
  <span class="quoted"><span class="quoted">R25</span></span> <span class="main">[</span><span class="quoted"><span class="free">b</span></span><span class="main">,</span> <span class="quoted"><span class="free">c</span></span><span class="main">]</span> witness<span class="main">:</span> <span class="main">[</span><span class="quoted"><span class="free">c</span></span><span class="main">:</span> 0<span class="main">,</span> <span class="quoted"><span class="free">d</span></span><span class="main">:</span> 1 <span class="main">/</span> 2<span class="main">,</span> <span class="quoted"><span class="free">a</span></span><span class="main">:</span> 1 <span class="main">/</span> 2<span class="main">,</span> <span class="quoted"><span class="free">b</span></span><span class="main">:</span> 0<span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span>
  <span class="quoted"><span class="quoted">R26</span></span> <span class="main">[</span><span class="quoted"><span class="free">c</span></span><span class="main">,</span> <span class="quoted"><span class="free">b</span></span><span class="main">]</span> witness<span class="main">:</span> <span class="main">[</span><span class="quoted"><span class="free">b</span></span><span class="main">:</span> 0<span class="main">,</span> <span class="quoted"><span class="free">d</span></span><span class="main">:</span> 1 <span class="main">/</span> 2<span class="main">,</span> <span class="quoted"><span class="free">a</span></span><span class="main">:</span> 1 <span class="main">/</span> 2<span class="main">,</span> <span class="quoted"><span class="free">c</span></span><span class="main">:</span> 0<span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span>
  <span class="quoted"><span class="quoted">R27</span></span> <span class="main">[</span><span class="quoted"><span class="free">c</span></span><span class="main">,</span> <span class="quoted"><span class="free">b</span></span><span class="main">]</span> witness<span class="main">:</span> <span class="main">[</span><span class="quoted"><span class="free">a</span></span><span class="main">:</span> 1 <span class="main">/</span> 2<span class="main">,</span> <span class="quoted"><span class="free">b</span></span><span class="main">:</span> 0<span class="main">,</span> <span class="quoted"><span class="free">c</span></span><span class="main">:</span> 0<span class="main">,</span> <span class="quoted"><span class="free">d</span></span><span class="main">:</span> 1 <span class="main">/</span> 2<span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span>
  <span class="quoted"><span class="quoted">R28</span></span> <span class="main">[</span><span class="quoted"><span class="free">b</span></span><span class="main">,</span> <span class="quoted"><span class="free">c</span></span><span class="main">]</span> witness<span class="main">:</span> <span class="main">[</span><span class="quoted"><span class="free">c</span></span><span class="main">:</span> 0<span class="main">,</span> <span class="quoted"><span class="free">d</span></span><span class="main">:</span> 1 <span class="main">/</span> 2<span class="main">,</span> <span class="quoted"><span class="free">a</span></span><span class="main">:</span> 1 <span class="main">/</span> 2<span class="main">,</span> <span class="quoted"><span class="free">b</span></span><span class="main">:</span> 0<span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span>
  <span class="quoted"><span class="quoted">R29</span></span> <span class="main">[</span><span class="quoted"><span class="free">b</span></span><span class="main">,</span> <span class="quoted"><span class="free">c</span></span><span class="main">]</span> witness<span class="main">:</span> <span class="main">[</span><span class="quoted"><span class="free">a</span></span><span class="main">:</span> 1 <span class="main">/</span> 2<span class="main">,</span> <span class="quoted"><span class="free">c</span></span><span class="main">:</span> 0<span class="main">,</span> <span class="quoted"><span class="free">d</span></span><span class="main">:</span> 1 <span class="main">/</span> 2<span class="main">,</span> <span class="quoted"><span class="free">b</span></span><span class="main">:</span> 0<span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span>
  <span class="quoted"><span class="quoted">R39</span></span> <span class="main">[</span><span class="quoted"><span class="free">b</span></span><span class="main">,</span> <span class="quoted"><span class="free">c</span></span><span class="main">]</span> witness<span class="main">:</span> <span class="main">[</span><span class="quoted"><span class="free">a</span></span><span class="main">:</span> 1 <span class="main">/</span> 2<span class="main">,</span> <span class="quoted"><span class="free">c</span></span><span class="main">:</span> 0<span class="main">,</span> <span class="quoted"><span class="free">d</span></span><span class="main">:</span> 1 <span class="main">/</span> 2<span class="main">,</span> <span class="quoted"><span class="free">b</span></span><span class="main">:</span> 0<span class="main">]</span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp_all</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> agent_iff alt_iff<span class="main">)</span>

<span class="keyword1"><span class="command">derive_strategyproofness_conditions</span></span> <span class="main">(</span>strategyproof_an_sds<span class="main">)</span>
  distance<span class="main">:</span> 2
  <span class="quoted">R1</span> <span class="quoted">R2</span> <span class="quoted">R3</span> <span class="quoted">R4</span> <span class="quoted">R5</span> <span class="quoted">R6</span> <span class="quoted">R7</span> <span class="quoted">R8</span> <span class="quoted">R9</span> <span class="quoted">R10</span> <span class="quoted">R11</span> <span class="quoted">R12</span> <span class="quoted">R13</span> <span class="quoted">R14</span> <span class="quoted">R15</span> <span class="quoted">R16</span> <span class="quoted">R17</span> <span class="quoted">R18</span> <span class="quoted">R19</span> <span class="quoted">R20</span>
  <span class="quoted">R21</span> <span class="quoted">R22</span> <span class="quoted">R23</span> <span class="quoted">R24</span> <span class="quoted">R25</span> <span class="quoted">R26</span> <span class="quoted">R27</span> <span class="quoted">R28</span> <span class="quoted">R29</span> <span class="quoted">R30</span> <span class="quoted">R31</span> <span class="quoted">R32</span> <span class="quoted">R33</span> <span class="quoted">R34</span> <span class="quoted">R35</span> <span class="quoted">R36</span> <span class="quoted">R37</span> <span class="quoted">R38</span> <span class="quoted">R39</span> <span class="quoted">R40</span>
  <span class="quoted">R41</span> <span class="quoted">R42</span> <span class="quoted">R43</span> <span class="quoted">R44</span> <span class="quoted">R45</span> <span class="quoted">R46</span> <span class="quoted">R47</span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp_all</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> agent_iff alt_iff<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> lottery_conditions<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"is_pref_profile <span class="free">R</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span>   <span class="quoted"><span class="quoted">"pmf <span class="main">(</span><span class="free">sds</span> <span class="free">R</span><span class="main">)</span> <span class="free">a</span> <span class="main">≥</span> <span class="main">0</span>"</span></span> <span class="quoted"><span class="quoted">"pmf <span class="main">(</span><span class="free">sds</span> <span class="free">R</span><span class="main">)</span> <span class="free">b</span> <span class="main">≥</span> <span class="main">0</span>"</span></span> <span class="quoted"><span class="quoted">"pmf <span class="main">(</span><span class="free">sds</span> <span class="free">R</span><span class="main">)</span> <span class="free">c</span> <span class="main">≥</span> <span class="main">0</span>"</span></span> <span class="quoted"><span class="quoted">"pmf <span class="main">(</span><span class="free">sds</span> <span class="free">R</span><span class="main">)</span> <span class="free">d</span> <span class="main">≥</span> <span class="main">0</span>"</span></span>
          <span class="quoted"><span class="quoted">"pmf <span class="main">(</span><span class="free">sds</span> <span class="free">R</span><span class="main">)</span> <span class="free">a</span> <span class="main">+</span> pmf <span class="main">(</span><span class="free">sds</span> <span class="free">R</span><span class="main">)</span> <span class="free">b</span> <span class="main">+</span> pmf <span class="main">(</span><span class="free">sds</span> <span class="free">R</span><span class="main">)</span> <span class="free">c</span> <span class="main">+</span> pmf <span class="main">(</span><span class="free">sds</span> <span class="free">R</span><span class="main">)</span> <span class="free">d</span> <span class="main">=</span> <span class="main">1</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> lottery_prob_alts<span class="main">[</span><span class="operator">OF</span> sds_wf<span class="main"><span class="main">[</span></span><span class="operator">OF</span> assms<span class="main"><span class="main">]</span></span><span class="main">]</span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp_all</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> alts pmf_nonneg measure_measure_pmf_finite<span class="main">)</span>


<span class="keyword1"><span class="command">subsection</span></span> <span class="quoted"><span class="plain_text">‹Main Proof›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> R45 <span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"pmf <span class="main">(</span><span class="free">sds</span> R45<span class="main">)</span> <span class="free">a</span> <span class="main">=</span> <span class="main">1</span><span class="main">/</span><span class="numeral">4</span>"</span></span> <span class="quoted"><span class="quoted">"pmf <span class="main">(</span><span class="free">sds</span> R45<span class="main">)</span> <span class="free">b</span> <span class="main">=</span> <span class="main">1</span><span class="main">/</span><span class="numeral">4</span>"</span></span> 
           <span class="quoted"><span class="quoted">"pmf <span class="main">(</span><span class="free">sds</span> R45<span class="main">)</span> <span class="free">c</span> <span class="main">=</span> <span class="main">1</span><span class="main">/</span><span class="numeral">4</span>"</span></span> <span class="quoted"><span class="quoted">"pmf <span class="main">(</span><span class="free">sds</span> R45<span class="main">)</span> <span class="free">d</span> <span class="main">=</span> <span class="main">1</span><span class="main">/</span><span class="numeral">4</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> R45.orbits lottery_conditions<span class="main">[</span><span class="operator">OF</span> R45.wf<span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp_all</span>

<span class="keyword1"><span class="command">lemma</span></span> R10_bc <span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"pmf <span class="main">(</span><span class="free">sds</span> R10<span class="main">)</span> <span class="free">b</span> <span class="main">=</span> <span class="main">0</span>"</span></span> <span class="quoted"><span class="quoted">"pmf <span class="main">(</span><span class="free">sds</span> R10<span class="main">)</span> <span class="free">c</span> <span class="main">=</span> <span class="main">0</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> R10.support R10.orbits <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">lemma</span></span> R10_ad <span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"pmf <span class="main">(</span><span class="free">sds</span> R10<span class="main">)</span> <span class="free">a</span> <span class="main">=</span> <span class="main">1</span><span class="main">/</span><span class="numeral">2</span>"</span></span> <span class="quoted"><span class="quoted">"pmf <span class="main">(</span><span class="free">sds</span> R10<span class="main">)</span> <span class="free">d</span> <span class="main">=</span> <span class="main">1</span><span class="main">/</span><span class="numeral">2</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> lottery_conditions<span class="main">[</span><span class="operator">OF</span> R10.wf<span class="main">]</span> R10_bc R10.orbits <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp_all</span>


<span class="keyword1"><span class="command">lemma</span></span> R26_bc <span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"pmf <span class="main">(</span><span class="free">sds</span> R26<span class="main">)</span> <span class="free">b</span> <span class="main">=</span> <span class="main">0</span>"</span></span> <span class="quoted"><span class="quoted">"pmf <span class="main">(</span><span class="free">sds</span> R26<span class="main">)</span> <span class="free">c</span> <span class="main">=</span> <span class="main">0</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> R26.support R26.orbits <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">lemma</span></span> R26_d <span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"pmf <span class="main">(</span><span class="free">sds</span> R26<span class="main">)</span> <span class="free">d</span> <span class="main">=</span> <span class="main">1</span> <span class="main">-</span> pmf <span class="main">(</span><span class="free">sds</span> R26<span class="main">)</span> <span class="free">a</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> lottery_conditions<span class="main">[</span><span class="operator">OF</span> R26.wf<span class="main">]</span> R26_bc <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>


<span class="keyword1"><span class="command">lemma</span></span> R27_bc <span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"pmf <span class="main">(</span><span class="free">sds</span> R27<span class="main">)</span> <span class="free">b</span> <span class="main">=</span> <span class="main">0</span>"</span></span> <span class="quoted"><span class="quoted">"pmf <span class="main">(</span><span class="free">sds</span> R27<span class="main">)</span> <span class="free">c</span> <span class="main">=</span> <span class="main">0</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> R27.support R27.orbits <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">lemma</span></span> R27_d <span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"pmf <span class="main">(</span><span class="free">sds</span> R27<span class="main">)</span> <span class="free">d</span> <span class="main">=</span> <span class="main">1</span> <span class="main">-</span> pmf <span class="main">(</span><span class="free">sds</span> R27<span class="main">)</span> <span class="free">a</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> lottery_conditions<span class="main">[</span><span class="operator">OF</span> R27.wf<span class="main">]</span> R27_bc <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>


<span class="keyword1"><span class="command">lemma</span></span> R28_bc <span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"pmf <span class="main">(</span><span class="free">sds</span> R28<span class="main">)</span> <span class="free">b</span> <span class="main">=</span> <span class="main">0</span>"</span></span> <span class="quoted"><span class="quoted">"pmf <span class="main">(</span><span class="free">sds</span> R28<span class="main">)</span> <span class="free">c</span> <span class="main">=</span> <span class="main">0</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> R28.support R28.orbits <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">lemma</span></span> R28_d <span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"pmf <span class="main">(</span><span class="free">sds</span> R28<span class="main">)</span> <span class="free">d</span> <span class="main">=</span> <span class="main">1</span> <span class="main">-</span> pmf <span class="main">(</span><span class="free">sds</span> R28<span class="main">)</span> <span class="free">a</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> lottery_conditions<span class="main">[</span><span class="operator">OF</span> R28.wf<span class="main">]</span> R28_bc <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>


<span class="keyword1"><span class="command">lemma</span></span> R29_bc <span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"pmf <span class="main">(</span><span class="free">sds</span> R29<span class="main">)</span> <span class="free">b</span> <span class="main">=</span> <span class="main">0</span>"</span></span> <span class="quoted"><span class="quoted">"pmf <span class="main">(</span><span class="free">sds</span> R29<span class="main">)</span> <span class="free">c</span> <span class="main">=</span> <span class="main">0</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> R29.support R29.orbits <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">lemma</span></span> R29_ac <span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"pmf <span class="main">(</span><span class="free">sds</span> R29<span class="main">)</span> <span class="free">a</span> <span class="main">=</span> <span class="main">1</span><span class="main">/</span><span class="numeral">2</span>"</span></span> <span class="quoted"><span class="quoted">"pmf <span class="main">(</span><span class="free">sds</span> R29<span class="main">)</span> <span class="free">d</span> <span class="main">=</span> <span class="main">1</span><span class="main">/</span><span class="numeral">2</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> lottery_conditions<span class="main">[</span><span class="operator">OF</span> R29.wf<span class="main">]</span> R29_bc R29.orbits <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp_all</span>


<span class="keyword1"><span class="command">lemmas</span></span> R43_bc <span class="main">[</span><span class="operator">simp</span><span class="main">]</span> <span class="main">=</span> R43.support

<span class="keyword1"><span class="command">lemma</span></span> R43_ad <span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"pmf <span class="main">(</span><span class="free">sds</span> R43<span class="main">)</span> <span class="free">a</span> <span class="main">=</span> <span class="main">1</span><span class="main">/</span><span class="numeral">2</span>"</span></span> <span class="quoted"><span class="quoted">"pmf <span class="main">(</span><span class="free">sds</span> R43<span class="main">)</span> <span class="free">d</span> <span class="main">=</span> <span class="main">1</span><span class="main">/</span><span class="numeral">2</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> lottery_conditions<span class="main">[</span><span class="operator">OF</span> R43.wf<span class="main">]</span> R43_bc R43.orbits <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp_all</span>


<span class="keyword1"><span class="command">lemma</span></span> R39_b <span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"pmf <span class="main">(</span><span class="free">sds</span> R39<span class="main">)</span> <span class="free">b</span> <span class="main">=</span> <span class="main">0</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">{</span></span>
    <span class="keyword3"><span class="command">assume</span></span> <span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"pmf <span class="main">(</span><span class="free">sds</span> R39<span class="main">)</span> <span class="free">c</span> <span class="main">=</span> <span class="main">0</span>"</span></span>
    <span class="keyword1"><span class="command">with</span></span> R29_R39.strategyproofness<span class="main">(</span>1<span class="main">)</span>
      <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"pmf <span class="main">(</span><span class="free">sds</span> R39<span class="main">)</span> <span class="free">d</span> <span class="main">≤</span> <span class="main">1</span><span class="main">/</span><span class="numeral">2</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">with</span></span> R39_R29.strategyproofness<span class="main">(</span>1<span class="main">)</span> lottery_conditions<span class="main">[</span><span class="operator">OF</span> R39.wf<span class="main">]</span> 
      <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"pmf <span class="main">(</span><span class="free">sds</span> R39<span class="main">)</span> <span class="free">b</span> <span class="main">=</span> <span class="main">0</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">}</span></span>
  <span class="keyword1"><span class="command">with</span></span> R39.support <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">lemma</span></span> R36_a <span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"pmf <span class="main">(</span><span class="free">sds</span> R36<span class="main">)</span> <span class="free">a</span> <span class="main">=</span> <span class="main">1</span><span class="main">/</span><span class="numeral">2</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> R36_b <span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"pmf <span class="main">(</span><span class="free">sds</span> R36<span class="main">)</span> <span class="free">b</span> <span class="main">=</span> <span class="main">0</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">from</span></span> R10_R36.strategyproofness<span class="main">(</span>1<span class="main">)</span> lottery_conditions<span class="main">[</span><span class="operator">OF</span> R36.wf<span class="main">]</span> 
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"pmf <span class="main">(</span><span class="free">sds</span> R36<span class="main">)</span> <span class="free">a</span> <span class="main">+</span> pmf <span class="main">(</span><span class="free">sds</span> R36<span class="main">)</span> <span class="free">b</span> <span class="main">≤</span> <span class="main">1</span><span class="main">/</span><span class="numeral">2</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">with</span></span> R36_R10.strategyproofness<span class="main">(</span>1<span class="main">)</span> lottery_conditions<span class="main">[</span><span class="operator">OF</span> R36.wf<span class="main">]</span>
    <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"pmf <span class="main">(</span><span class="free">sds</span> R36<span class="main">)</span> <span class="free">a</span> <span class="main">=</span> <span class="main">1</span><span class="main">/</span><span class="numeral">2</span>"</span></span> <span class="quoted"><span class="quoted">"pmf <span class="main">(</span><span class="free">sds</span> R36<span class="main">)</span> <span class="free">b</span> <span class="main">=</span> <span class="main">0</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">lemma</span></span> R36_d <span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"pmf <span class="main">(</span><span class="free">sds</span> R36<span class="main">)</span> <span class="free">d</span> <span class="main">=</span> <span class="main">1</span><span class="main">/</span><span class="numeral">2</span> <span class="main">-</span> pmf <span class="main">(</span><span class="free">sds</span> R36<span class="main">)</span> <span class="free">c</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> lottery_conditions<span class="main">[</span><span class="operator">OF</span> R36.wf<span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>

<span class="keyword1"><span class="command">lemma</span></span> R39_a <span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"pmf <span class="main">(</span><span class="free">sds</span> R39<span class="main">)</span> <span class="free">a</span> <span class="main">=</span> <span class="main">1</span><span class="main">/</span><span class="numeral">2</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">from</span></span> R36_R39.strategyproofness<span class="main">(</span>1<span class="main">)</span> lottery_conditions<span class="main">[</span><span class="operator">OF</span> R39.wf<span class="main">]</span>
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"pmf <span class="main">(</span><span class="free">sds</span> R39<span class="main">)</span> <span class="free">a</span> <span class="main">≥</span> <span class="main">1</span><span class="main">/</span><span class="numeral">2</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">with</span></span> R39_R36.strategyproofness<span class="main">(</span>1<span class="main">)</span> lottery_conditions<span class="main">[</span><span class="operator">OF</span> R39.wf<span class="main">]</span>
    <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">lemma</span></span> R39_d <span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"pmf <span class="main">(</span><span class="free">sds</span> R39<span class="main">)</span> <span class="free">d</span> <span class="main">=</span> <span class="main">1</span><span class="main">/</span><span class="numeral">2</span> <span class="main">-</span> pmf <span class="main">(</span><span class="free">sds</span> R39<span class="main">)</span> <span class="free">c</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> lottery_conditions<span class="main">[</span><span class="operator">OF</span> R39.wf<span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>



<span class="keyword1"><span class="command">lemmas</span></span> R12_b <span class="main">[</span><span class="operator">simp</span><span class="main">]</span> <span class="main">=</span> R12.support

<span class="keyword1"><span class="command">lemma</span></span> R12_c <span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"pmf <span class="main">(</span><span class="free">sds</span> R12<span class="main">)</span> <span class="free">c</span> <span class="main">=</span> <span class="main">0</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> R12_R10.strategyproofness<span class="main">(</span>1<span class="main">)</span> lottery_conditions<span class="main">[</span><span class="operator">OF</span> R12.wf<span class="main">]</span> 
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">del</span><span class="main"><span class="main">:</span></span> pmf_nonneg<span class="main">)</span>
  

<span class="keyword1"><span class="command">lemma</span></span> R12_d <span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"pmf <span class="main">(</span><span class="free">sds</span> R12<span class="main">)</span> <span class="free">d</span> <span class="main">=</span> <span class="main">1</span> <span class="main">-</span> pmf <span class="main">(</span><span class="free">sds</span> R12<span class="main">)</span> <span class="free">a</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> lottery_conditions<span class="main">[</span><span class="operator">OF</span> R12.wf<span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>

<span class="keyword1"><span class="command">lemma</span></span> R12_a_ge_one_half<span class="main">:</span> <span class="quoted"><span class="quoted">"pmf <span class="main">(</span><span class="free">sds</span> R12<span class="main">)</span> <span class="free">a</span> <span class="main">≥</span> <span class="main">1</span><span class="main">/</span><span class="numeral">2</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> R10_R12.strategyproofness<span class="main">(</span>1<span class="main">)</span> lottery_conditions<span class="main">[</span><span class="operator">OF</span> R12.wf<span class="main">]</span>
  <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>


<span class="keyword1"><span class="command">lemma</span></span> R44 <span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> 
  <span class="quoted"><span class="quoted">"pmf <span class="main">(</span><span class="free">sds</span> R44<span class="main">)</span> <span class="free">a</span> <span class="main">=</span> pmf <span class="main">(</span><span class="free">sds</span> R12<span class="main">)</span> <span class="free">a</span>"</span></span> <span class="quoted"><span class="quoted">"pmf <span class="main">(</span><span class="free">sds</span> R44<span class="main">)</span> <span class="free">d</span> <span class="main">=</span> <span class="main">1</span> <span class="main">-</span> pmf <span class="main">(</span><span class="free">sds</span> R12<span class="main">)</span> <span class="free">a</span>"</span></span>
  <span class="quoted"><span class="quoted">"pmf <span class="main">(</span><span class="free">sds</span> R44<span class="main">)</span> <span class="free">b</span> <span class="main">=</span> <span class="main">0</span>"</span></span> <span class="quoted"><span class="quoted">"pmf <span class="main">(</span><span class="free">sds</span> R44<span class="main">)</span> <span class="free">c</span> <span class="main">=</span> <span class="main">0</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">from</span></span> R12_R44.strategyproofness<span class="main">(</span>1<span class="main">)</span> R44.support <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"pmf <span class="main">(</span><span class="free">sds</span> R44<span class="main">)</span> <span class="free">a</span> <span class="main">≤</span> pmf <span class="main">(</span><span class="free">sds</span> R12<span class="main">)</span> <span class="free">a</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">with</span></span> R44_R12.strategyproofness<span class="main">(</span>1<span class="main">)</span> R44.support lottery_conditions<span class="main">[</span><span class="operator">OF</span> R44.wf<span class="main">]</span>
    <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"pmf <span class="main">(</span><span class="free">sds</span> R44<span class="main">)</span> <span class="free">a</span> <span class="main">=</span> pmf <span class="main">(</span><span class="free">sds</span> R12<span class="main">)</span> <span class="free">a</span>"</span></span> <span class="quoted"><span class="quoted">"pmf <span class="main">(</span><span class="free">sds</span> R44<span class="main">)</span> <span class="free">c</span> <span class="main">=</span> <span class="main">0</span>"</span></span>
         <span class="quoted"><span class="quoted">"pmf <span class="main">(</span><span class="free">sds</span> R44<span class="main">)</span> <span class="free">d</span> <span class="main">=</span> <span class="main">1</span> <span class="main">-</span> pmf <span class="main">(</span><span class="free">sds</span> R12<span class="main">)</span> <span class="free">a</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">del</span><span class="main"><span class="main">:</span></span> pmf_nonneg<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span> <span class="main">(</span><span class="operator">insert</span> R44.support<span class="main"><span class="keyword3">,</span></span> <span class="operator">simp_all</span><span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> R9_a <span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"pmf <span class="main">(</span><span class="free">sds</span> R9<span class="main">)</span> <span class="free">a</span> <span class="main">=</span> pmf <span class="main">(</span><span class="free">sds</span> R35<span class="main">)</span> <span class="free">a</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">from</span></span> R9_R35.strategyproofness<span class="main">(</span>1<span class="main">)</span> R35.support R9.support 
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"pmf <span class="main">(</span><span class="free">sds</span> R35<span class="main">)</span> <span class="free">a</span> <span class="main">≤</span> pmf <span class="main">(</span><span class="free">sds</span> R9<span class="main">)</span> <span class="free">a</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">with</span></span> R35_R9.strategyproofness<span class="main">(</span>1<span class="main">)</span> R9.support R35.support <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">lemma</span></span> R18_c <span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"pmf <span class="main">(</span><span class="free">sds</span> R18<span class="main">)</span> <span class="free">c</span> <span class="main">=</span> pmf <span class="main">(</span><span class="free">sds</span> R9<span class="main">)</span> <span class="free">c</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">from</span></span> R18_R9.strategyproofness<span class="main">(</span>1<span class="main">)</span> R18.support R9.support
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"pmf <span class="main">(</span><span class="free">sds</span> R18<span class="main">)</span> <span class="free">d</span> <span class="main">+</span> pmf <span class="main">(</span><span class="free">sds</span> R18<span class="main">)</span> <span class="free">a</span> <span class="main">≥</span> pmf <span class="main">(</span><span class="free">sds</span> R9<span class="main">)</span> <span class="free">d</span> <span class="main">+</span> pmf <span class="main">(</span><span class="free">sds</span> R9<span class="main">)</span> <span class="free">a</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">with</span></span> R9_R18.strategyproofness<span class="main">(</span>1<span class="main">)</span> R18.support R9.support
        lottery_conditions<span class="main">[</span><span class="operator">OF</span> R9.wf<span class="main">]</span> lottery_conditions<span class="main">[</span><span class="operator">OF</span> R18.wf<span class="main">]</span>
    <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">lemma</span></span> R5_d_ge_one_half<span class="main">:</span> <span class="quoted"><span class="quoted">"pmf <span class="main">(</span><span class="free">sds</span> R5<span class="main">)</span> <span class="free">d</span> <span class="main">≥</span> <span class="main">1</span><span class="main">/</span><span class="numeral">2</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> R5_R10.strategyproofness<span class="main">(</span>1<span class="main">)</span> R5.support lottery_conditions<span class="main">[</span><span class="operator">OF</span> R5.wf<span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">lemma</span></span> R7 <span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"pmf <span class="main">(</span><span class="free">sds</span> R7<span class="main">)</span> <span class="free">a</span> <span class="main">=</span> <span class="main">1</span><span class="main">/</span><span class="numeral">2</span>"</span></span> <span class="quoted"><span class="quoted">"pmf <span class="main">(</span><span class="free">sds</span> R7<span class="main">)</span> <span class="free">b</span> <span class="main">=</span> <span class="main">0</span>"</span></span> <span class="quoted"><span class="quoted">"pmf <span class="main">(</span><span class="free">sds</span> R7<span class="main">)</span> <span class="free">c</span> <span class="main">=</span> <span class="main">0</span>"</span></span> <span class="quoted"><span class="quoted">"pmf <span class="main">(</span><span class="free">sds</span> R7<span class="main">)</span> <span class="free">d</span> <span class="main">=</span> <span class="main">1</span><span class="main">/</span><span class="numeral">2</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">from</span></span> R5_d_ge_one_half <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">1</span><span class="main">/</span><span class="numeral">2</span> <span class="main">≤</span> pmf <span class="main">(</span><span class="free">sds</span> R5<span class="main">)</span> <span class="free">d</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">from</span></span> R5_R17.strategyproofness<span class="main">(</span>1<span class="main">)</span> R17.support lottery_conditions<span class="main">[</span><span class="operator">OF</span> R5.wf<span class="main">]</span> lottery_conditions<span class="main">[</span><span class="operator">OF</span> R17.wf<span class="main">]</span> 
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">…</span> <span class="main">≤</span> pmf <span class="main">(</span><span class="free">sds</span> R17<span class="main">)</span> <span class="free">d</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">del</span><span class="main"><span class="main">:</span></span> pmf_nonneg<span class="main">)</span>
  <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">from</span></span> R17_R7.strategyproofness<span class="main">(</span>1<span class="main">)</span> lottery_conditions<span class="main">[</span><span class="operator">OF</span> R7.wf<span class="main">]</span> lottery_conditions<span class="main">[</span><span class="operator">OF</span> R17.wf<span class="main">]</span> R7.support
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"pmf <span class="main">(</span><span class="free">sds</span> R17<span class="main">)</span> <span class="free">d</span> <span class="main">≤</span> pmf <span class="main">(</span><span class="free">sds</span> R7<span class="main">)</span> <span class="free">d</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">del</span><span class="main"><span class="main">:</span></span> pmf_nonneg<span class="main">)</span>
  <span class="keyword1"><span class="command">finally</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"pmf <span class="main">(</span><span class="free">sds</span> R7<span class="main">)</span> <span class="free">d</span> <span class="main">≥</span> <span class="main">1</span><span class="main">/</span><span class="numeral">2</span>"</span></span> <span class="keyword1"><span class="command">.</span></span>
  <span class="keyword1"><span class="command">with</span></span> R7_R43.strategyproofness<span class="main">(</span>1<span class="main">)</span> lottery_conditions<span class="main">[</span><span class="operator">OF</span> R7.wf<span class="main">]</span> R7.support
    <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"pmf <span class="main">(</span><span class="free">sds</span> R7<span class="main">)</span> <span class="free">a</span> <span class="main">=</span> <span class="main">1</span><span class="main">/</span><span class="numeral">2</span>"</span></span> <span class="quoted"><span class="quoted">"pmf <span class="main">(</span><span class="free">sds</span> R7<span class="main">)</span> <span class="free">b</span> <span class="main">=</span> <span class="main">0</span>"</span></span> <span class="quoted"><span class="quoted">"pmf <span class="main">(</span><span class="free">sds</span> R7<span class="main">)</span> <span class="free">c</span> <span class="main">=</span> <span class="main">0</span>"</span></span> <span class="quoted"><span class="quoted">"pmf <span class="main">(</span><span class="free">sds</span> R7<span class="main">)</span> <span class="free">d</span> <span class="main">=</span> <span class="main">1</span><span class="main">/</span><span class="numeral">2</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">lemma</span></span> R5 <span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"pmf <span class="main">(</span><span class="free">sds</span> R5<span class="main">)</span> <span class="free">a</span> <span class="main">=</span> <span class="main">1</span><span class="main">/</span><span class="numeral">2</span>"</span></span> <span class="quoted"><span class="quoted">"pmf <span class="main">(</span><span class="free">sds</span> R5<span class="main">)</span> <span class="free">b</span> <span class="main">=</span> <span class="main">0</span>"</span></span> <span class="quoted"><span class="quoted">"pmf <span class="main">(</span><span class="free">sds</span> R5<span class="main">)</span> <span class="free">c</span> <span class="main">=</span> <span class="main">0</span>"</span></span> <span class="quoted"><span class="quoted">"pmf <span class="main">(</span><span class="free">sds</span> R5<span class="main">)</span> <span class="free">d</span> <span class="main">=</span> <span class="main">1</span><span class="main">/</span><span class="numeral">2</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">from</span></span> R5_R7.strategyproofness<span class="main">(</span>1<span class="main">)</span> lottery_conditions<span class="main">[</span><span class="operator">OF</span> R5.wf<span class="main">]</span> R5.support 
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"pmf <span class="main">(</span><span class="free">sds</span> R5<span class="main">)</span> <span class="free">d</span> <span class="main">≤</span> <span class="main">1</span><span class="main">/</span><span class="numeral">2</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">with</span></span> R5_d_ge_one_half <span class="keyword3"><span class="command">show</span></span> d<span class="main">:</span> <span class="quoted"><span class="quoted">"pmf <span class="main">(</span><span class="free">sds</span> R5<span class="main">)</span> <span class="free">d</span> <span class="main">=</span> <span class="main">1</span> <span class="main">/</span> <span class="numeral">2</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">with</span></span> R5_R10.strategyproofness<span class="main">(</span>1<span class="main">)</span> lottery_conditions<span class="main">[</span><span class="operator">OF</span> R5.wf<span class="main">]</span> R5.support
    <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"pmf <span class="main">(</span><span class="free">sds</span> R5<span class="main">)</span> <span class="free">c</span> <span class="main">=</span> <span class="main">0</span>"</span></span> <span class="quoted"><span class="quoted">"pmf <span class="main">(</span><span class="free">sds</span> R5<span class="main">)</span> <span class="free">a</span> <span class="main">=</span> <span class="main">1</span><span class="main">/</span><span class="numeral">2</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp_all</span>
<span class="keyword1"><span class="command">qed</span></span> <span class="main">(</span><span class="operator">simp_all</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> R5.support<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> R15 <span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"pmf <span class="main">(</span><span class="free">sds</span> R15<span class="main">)</span> <span class="free">a</span> <span class="main">=</span> <span class="main">1</span><span class="main">/</span><span class="numeral">2</span>"</span></span> <span class="quoted"><span class="quoted">"pmf <span class="main">(</span><span class="free">sds</span> R15<span class="main">)</span> <span class="free">b</span> <span class="main">=</span> <span class="main">0</span>"</span></span> <span class="quoted"><span class="quoted">"pmf <span class="main">(</span><span class="free">sds</span> R15<span class="main">)</span> <span class="free">c</span> <span class="main">=</span> <span class="main">0</span>"</span></span> <span class="quoted"><span class="quoted">"pmf <span class="main">(</span><span class="free">sds</span> R15<span class="main">)</span> <span class="free">d</span> <span class="main">=</span> <span class="main">1</span><span class="main">/</span><span class="numeral">2</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">{</span></span>
    <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"pmf <span class="main">(</span><span class="free">sds</span> R15<span class="main">)</span> <span class="free">b</span> <span class="main">=</span> <span class="main">0</span>"</span></span>
    <span class="keyword1"><span class="command">with</span></span> R10_R15.strategyproofness<span class="main">(</span>1<span class="main">)</span> lottery_conditions<span class="main">[</span><span class="operator">OF</span> R15.wf<span class="main">]</span>
      <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"pmf <span class="main">(</span><span class="free">sds</span> R15<span class="main">)</span> <span class="free">a</span> <span class="main">+</span> pmf <span class="main">(</span><span class="free">sds</span> R15<span class="main">)</span> <span class="free">c</span> <span class="main">≤</span> <span class="main">1</span><span class="main">/</span><span class="numeral">2</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">with</span></span> R15_R10.strategyproofness<span class="main">(</span>1<span class="main">)</span> lottery_conditions<span class="main">[</span><span class="operator">OF</span> R15.wf<span class="main">]</span> 
      <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"pmf <span class="main">(</span><span class="free">sds</span> R15<span class="main">)</span> <span class="free">c</span> <span class="main">=</span> <span class="main">0</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">}</span></span>
  <span class="keyword1"><span class="command">with</span></span> R15.support <span class="keyword3"><span class="command">show</span></span> <span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"pmf <span class="main">(</span><span class="free">sds</span> R15<span class="main">)</span> <span class="free">c</span> <span class="main">=</span> <span class="main">0</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">with</span></span> R15_R5.strategyproofness<span class="main">(</span>1<span class="main">)</span> lottery_conditions<span class="main">[</span><span class="operator">OF</span> R15.wf<span class="main">]</span> 
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"pmf <span class="main">(</span><span class="free">sds</span> R15<span class="main">)</span> <span class="free">a</span> <span class="main">≥</span> <span class="main">1</span><span class="main">/</span><span class="numeral">2</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> R15_R7.strategyproofness<span class="main">(</span>1<span class="main">)</span> lottery_conditions<span class="main">[</span><span class="operator">OF</span> R15.wf<span class="main">]</span>
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"pmf <span class="main">(</span><span class="free">sds</span> R15<span class="main">)</span> <span class="free">b</span> <span class="main">+</span> pmf <span class="main">(</span><span class="free">sds</span> R15<span class="main">)</span> <span class="free">d</span> <span class="main">≥</span> <span class="main">1</span><span class="main">/</span><span class="numeral">2</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"pmf <span class="main">(</span><span class="free">sds</span> R15<span class="main">)</span> <span class="free">a</span> <span class="main">=</span> <span class="main">1</span><span class="main">/</span><span class="numeral">2</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> lottery_conditions<span class="main">[</span><span class="operator">OF</span> R15.wf<span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">with</span></span> R15_R5.strategyproofness<span class="main">(</span>1<span class="main">)</span> lottery_conditions<span class="main">[</span><span class="operator">OF</span> R15.wf<span class="main">]</span>
    <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"pmf <span class="main">(</span><span class="free">sds</span> R15<span class="main">)</span> <span class="free">d</span> <span class="main">=</span> <span class="main">1</span><span class="main">/</span><span class="numeral">2</span>"</span></span> <span class="quoted"><span class="quoted">"pmf <span class="main">(</span><span class="free">sds</span> R15<span class="main">)</span> <span class="free">b</span> <span class="main">=</span> <span class="main">0</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">lemma</span></span> R13_aux<span class="main">:</span> <span class="quoted"><span class="quoted">"pmf <span class="main">(</span><span class="free">sds</span> R13<span class="main">)</span> <span class="free">b</span> <span class="main">=</span> <span class="main">0</span>"</span></span> <span class="quoted"><span class="quoted">"pmf <span class="main">(</span><span class="free">sds</span> R13<span class="main">)</span> <span class="free">c</span> <span class="main">=</span> <span class="main">0</span>"</span></span> <span class="quoted"><span class="quoted">"pmf <span class="main">(</span><span class="free">sds</span> R13<span class="main">)</span> <span class="free">d</span> <span class="main">=</span> <span class="main">1</span> <span class="main">-</span> pmf <span class="main">(</span><span class="free">sds</span> R13<span class="main">)</span> <span class="free">a</span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> R27_R13 <span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"pmf <span class="main">(</span><span class="free">sds</span> R27<span class="main">)</span> <span class="free">a</span> <span class="main">=</span> pmf <span class="main">(</span><span class="free">sds</span> R13<span class="main">)</span> <span class="free">a</span>"</span></span> 
  <span class="keyword1"><span class="command">using</span></span> R27_R13.strategyproofness<span class="main">(</span>1<span class="main">)</span> R13_R27.strategyproofness<span class="main">(</span>1<span class="main">)</span> lottery_conditions<span class="main">[</span><span class="operator">OF</span> R13.wf<span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">lemma</span></span> R13 <span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"pmf <span class="main">(</span><span class="free">sds</span> R13<span class="main">)</span> <span class="free">a</span> <span class="main">=</span> <span class="main">1</span><span class="main">/</span><span class="numeral">2</span>"</span></span> <span class="quoted"><span class="quoted">"pmf <span class="main">(</span><span class="free">sds</span> R13<span class="main">)</span> <span class="free">b</span> <span class="main">=</span> <span class="main">0</span>"</span></span> <span class="quoted"><span class="quoted">"pmf <span class="main">(</span><span class="free">sds</span> R13<span class="main">)</span> <span class="free">c</span> <span class="main">=</span> <span class="main">0</span>"</span></span> <span class="quoted"><span class="quoted">"pmf <span class="main">(</span><span class="free">sds</span> R13<span class="main">)</span> <span class="free">d</span> <span class="main">=</span> <span class="main">1</span><span class="main">/</span><span class="numeral">2</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> R15_R13.strategyproofness<span class="main">(</span>1<span class="main">)</span> R13_R15.strategyproofness<span class="main">(</span>1<span class="main">)</span> R13_aux <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp_all</span>

<span class="keyword1"><span class="command">lemma</span></span> R27 <span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"pmf <span class="main">(</span><span class="free">sds</span> R27<span class="main">)</span> <span class="free">a</span> <span class="main">=</span> <span class="main">1</span><span class="main">/</span><span class="numeral">2</span>"</span></span> <span class="quoted"><span class="quoted">"pmf <span class="main">(</span><span class="free">sds</span> R27<span class="main">)</span> <span class="free">b</span> <span class="main">=</span> <span class="main">0</span>"</span></span> <span class="quoted"><span class="quoted">"pmf <span class="main">(</span><span class="free">sds</span> R27<span class="main">)</span> <span class="free">c</span> <span class="main">=</span> <span class="main">0</span>"</span></span> <span class="quoted"><span class="quoted">"pmf <span class="main">(</span><span class="free">sds</span> R27<span class="main">)</span> <span class="free">d</span> <span class="main">=</span> <span class="main">1</span><span class="main">/</span><span class="numeral">2</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp_all</span>

<span class="keyword1"><span class="command">lemma</span></span> R19 <span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"pmf <span class="main">(</span><span class="free">sds</span> R19<span class="main">)</span> <span class="free">a</span> <span class="main">=</span> <span class="main">1</span><span class="main">/</span><span class="numeral">2</span>"</span></span> <span class="quoted"><span class="quoted">"pmf <span class="main">(</span><span class="free">sds</span> R19<span class="main">)</span> <span class="free">b</span> <span class="main">=</span> <span class="main">0</span>"</span></span> <span class="quoted"><span class="quoted">"pmf <span class="main">(</span><span class="free">sds</span> R19<span class="main">)</span> <span class="free">c</span> <span class="main">=</span> <span class="main">0</span>"</span></span> <span class="quoted"><span class="quoted">"pmf <span class="main">(</span><span class="free">sds</span> R19<span class="main">)</span> <span class="free">d</span> <span class="main">=</span> <span class="main">1</span><span class="main">/</span><span class="numeral">2</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"pmf <span class="main">(</span><span class="free">sds</span> R19<span class="main">)</span> <span class="free">a</span> <span class="main">=</span> <span class="main">1</span><span class="main">/</span><span class="numeral">2</span> <span class="main">∧</span> pmf <span class="main">(</span><span class="free">sds</span> R19<span class="main">)</span> <span class="free">b</span> <span class="main">=</span> <span class="main">0</span> <span class="main">∧</span> pmf <span class="main">(</span><span class="free">sds</span> R19<span class="main">)</span> <span class="free">c</span> <span class="main">=</span> <span class="main">0</span> <span class="main">∧</span> pmf <span class="main">(</span><span class="free">sds</span> R19<span class="main">)</span> <span class="free">d</span> <span class="main">=</span> <span class="main">1</span><span class="main">/</span><span class="numeral">2</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">rule</span> disjE<span class="main"><span class="main">[</span></span><span class="operator">OF</span> R19.support<span class="main"><span class="main">]</span></span><span class="main"><span class="keyword3">;</span></span> <span class="operator">safe</span><span class="main">)</span>
    <span class="keyword3"><span class="command">assume</span></span> <span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"pmf <span class="main">(</span><span class="free">sds</span> R19<span class="main">)</span> <span class="free">b</span> <span class="main">=</span> <span class="main">0</span>"</span></span>
    <span class="keyword1"><span class="command">from</span></span> R10_R19.strategyproofness<span class="main">(</span>1<span class="main">)</span> lottery_conditions<span class="main">[</span><span class="operator">OF</span> R19.wf<span class="main">]</span> 
      <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"pmf <span class="main">(</span><span class="free">sds</span> R19<span class="main">)</span> <span class="free">a</span> <span class="main">+</span> pmf <span class="main">(</span><span class="free">sds</span> R19<span class="main">)</span> <span class="free">c</span> <span class="main">≤</span> <span class="main">1</span><span class="main">/</span><span class="numeral">2</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> R19_R10.strategyproofness<span class="main">(</span>1<span class="main">)</span> 
      <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"pmf <span class="main">(</span><span class="free">sds</span> R19<span class="main">)</span> <span class="free">a</span> <span class="main">+</span> pmf <span class="main">(</span><span class="free">sds</span> R19<span class="main">)</span> <span class="free">c</span> <span class="main">≥</span> <span class="main">1</span><span class="main">/</span><span class="numeral">2</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"pmf <span class="main">(</span><span class="free">sds</span> R19<span class="main">)</span> <span class="free">d</span> <span class="main">=</span> <span class="main">1</span><span class="main">/</span><span class="numeral">2</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> lottery_conditions<span class="main">[</span><span class="operator">OF</span> R19.wf<span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">with</span></span> R27_R19.strategyproofness<span class="main">(</span>1<span class="main">)</span> lottery_conditions<span class="main">[</span><span class="operator">OF</span> R19.wf<span class="main">]</span> 
      <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"pmf <span class="main">(</span><span class="free">sds</span> R19<span class="main">)</span> <span class="free">a</span> <span class="main">=</span> <span class="main">1</span><span class="main">/</span><span class="numeral">2</span>"</span></span> <span class="quoted"><span class="quoted">"pmf <span class="main">(</span><span class="free">sds</span> R19<span class="main">)</span> <span class="free">c</span> <span class="main">=</span> <span class="main">0</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">next</span></span>
    <span class="keyword3"><span class="command">assume</span></span> <span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"pmf <span class="main">(</span><span class="free">sds</span> R19<span class="main">)</span> <span class="free">c</span> <span class="main">=</span> <span class="main">0</span>"</span></span>
    <span class="keyword1"><span class="command">from</span></span> R19_R10.strategyproofness<span class="main">(</span>1<span class="main">)</span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"pmf <span class="main">(</span><span class="free">sds</span> R19<span class="main">)</span> <span class="free">a</span> <span class="main">≥</span> <span class="main">1</span><span class="main">/</span><span class="numeral">2</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> R19_R27.strategyproofness<span class="main">(</span>1<span class="main">)</span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"pmf <span class="main">(</span><span class="free">sds</span> R19<span class="main">)</span> <span class="free">d</span> <span class="main">≥</span> <span class="main">1</span><span class="main">/</span><span class="numeral">2</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"pmf <span class="main">(</span><span class="free">sds</span> R19<span class="main">)</span> <span class="free">a</span> <span class="main">=</span> <span class="main">1</span><span class="main">/</span><span class="numeral">2</span>"</span></span> <span class="quoted"><span class="quoted">"pmf <span class="main">(</span><span class="free">sds</span> R19<span class="main">)</span> <span class="free">d</span> <span class="main">=</span> <span class="main">1</span><span class="main">/</span><span class="numeral">2</span>"</span></span> <span class="quoted"><span class="quoted">"pmf <span class="main">(</span><span class="free">sds</span> R19<span class="main">)</span> <span class="free">b</span> <span class="main">=</span> <span class="main">0</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> lottery_conditions<span class="main">[</span><span class="operator">OF</span> R19.wf<span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">del</span><span class="main"><span class="main">:</span></span> pmf_nonneg<span class="main">)</span>
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"pmf <span class="main">(</span><span class="free">sds</span> R19<span class="main">)</span> <span class="free">a</span> <span class="main">=</span> <span class="main">1</span><span class="main">/</span><span class="numeral">2</span>"</span></span> <span class="quoted"><span class="quoted">"pmf <span class="main">(</span><span class="free">sds</span> R19<span class="main">)</span> <span class="free">b</span> <span class="main">=</span> <span class="main">0</span>"</span></span> <span class="quoted"><span class="quoted">"pmf <span class="main">(</span><span class="free">sds</span> R19<span class="main">)</span> <span class="free">c</span> <span class="main">=</span> <span class="main">0</span>"</span></span> <span class="quoted"><span class="quoted">"pmf <span class="main">(</span><span class="free">sds</span> R19<span class="main">)</span> <span class="free">d</span> <span class="main">=</span> <span class="main">1</span><span class="main">/</span><span class="numeral">2</span>"</span></span> 
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span><span class="main"><span class="keyword3">+</span></span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">lemma</span></span> R1 <span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"pmf <span class="main">(</span><span class="free">sds</span> R1<span class="main">)</span> <span class="free">a</span> <span class="main">=</span> <span class="main">1</span><span class="main">/</span><span class="numeral">2</span>"</span></span> <span class="quoted"><span class="quoted">"pmf <span class="main">(</span><span class="free">sds</span> R1<span class="main">)</span> <span class="free">b</span> <span class="main">=</span> <span class="main">0</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">from</span></span> R19_R1.strategyproofness<span class="main">(</span>1<span class="main">)</span> lottery_conditions<span class="main">[</span><span class="operator">OF</span> R1.wf<span class="main">]</span>
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"pmf <span class="main">(</span><span class="free">sds</span> R1<span class="main">)</span> <span class="free">a</span> <span class="main">+</span> pmf <span class="main">(</span><span class="free">sds</span> R1<span class="main">)</span> <span class="free">b</span> <span class="main">≤</span> <span class="main">1</span><span class="main">/</span><span class="numeral">2</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">with</span></span> R1_R19.strategyproofness<span class="main">(</span>1<span class="main">)</span> lottery_conditions<span class="main">[</span><span class="operator">OF</span> R1.wf<span class="main">]</span>
    <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"pmf <span class="main">(</span><span class="free">sds</span> R1<span class="main">)</span> <span class="free">a</span> <span class="main">=</span> <span class="main">1</span><span class="main">/</span><span class="numeral">2</span>"</span></span> <span class="quoted"><span class="quoted">"pmf <span class="main">(</span><span class="free">sds</span> R1<span class="main">)</span> <span class="free">b</span> <span class="main">=</span> <span class="main">0</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">lemma</span></span> R22 <span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"pmf <span class="main">(</span><span class="free">sds</span> R22<span class="main">)</span> <span class="free">a</span> <span class="main">=</span> <span class="main">1</span><span class="main">/</span><span class="numeral">2</span>"</span></span> <span class="quoted"><span class="quoted">"pmf <span class="main">(</span><span class="free">sds</span> R22<span class="main">)</span> <span class="free">b</span> <span class="main">=</span> <span class="main">0</span>"</span></span> <span class="quoted"><span class="quoted">"pmf <span class="main">(</span><span class="free">sds</span> R22<span class="main">)</span> <span class="free">c</span> <span class="main">=</span> <span class="main">0</span>"</span></span> <span class="quoted"><span class="quoted">"pmf <span class="main">(</span><span class="free">sds</span> R22<span class="main">)</span> <span class="free">d</span> <span class="main">=</span> <span class="main">1</span><span class="main">/</span><span class="numeral">2</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">from</span></span> R33_R5.strategyproofness<span class="main">(</span>1<span class="main">)</span> R33.support
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">1</span><span class="main">/</span><span class="numeral">2</span> <span class="main">≤</span> pmf <span class="main">(</span><span class="free">sds</span> R33<span class="main">)</span> <span class="free">a</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">from</span></span> R33_R22.strategyproofness<span class="main">(</span>1<span class="main">)</span> R22.support R33.support 
    lottery_conditions<span class="main">[</span><span class="operator">OF</span> R22.wf<span class="main">]</span> lottery_conditions<span class="main">[</span><span class="operator">OF</span> R33.wf<span class="main">]</span>
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">…</span> <span class="main">≤</span> pmf <span class="main">(</span><span class="free">sds</span> R22<span class="main">)</span> <span class="free">a</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">finally</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"pmf <span class="main">(</span><span class="free">sds</span> R22<span class="main">)</span> <span class="free">a</span> <span class="main">=</span> <span class="main">1</span><span class="main">/</span><span class="numeral">2</span>"</span></span> <span class="quoted"><span class="quoted">"pmf <span class="main">(</span><span class="free">sds</span> R22<span class="main">)</span> <span class="free">b</span> <span class="main">=</span> <span class="main">0</span>"</span></span> <span class="quoted"><span class="quoted">"pmf <span class="main">(</span><span class="free">sds</span> R22<span class="main">)</span> <span class="free">c</span> <span class="main">=</span> <span class="main">0</span>"</span></span> <span class="quoted"><span class="quoted">"pmf <span class="main">(</span><span class="free">sds</span> R22<span class="main">)</span> <span class="free">d</span> <span class="main">=</span> <span class="main">1</span><span class="main">/</span><span class="numeral">2</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> R22_R29.strategyproofness<span class="main">(</span>1<span class="main">)</span> lottery_conditions<span class="main">[</span><span class="operator">OF</span> R22.wf<span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">del</span><span class="main"><span class="main">:</span></span> pmf_nonneg<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">lemma</span></span> R28 <span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"pmf <span class="main">(</span><span class="free">sds</span> R28<span class="main">)</span> <span class="free">a</span> <span class="main">=</span> <span class="main">1</span><span class="main">/</span><span class="numeral">2</span>"</span></span> <span class="quoted"><span class="quoted">"pmf <span class="main">(</span><span class="free">sds</span> R28<span class="main">)</span> <span class="free">b</span> <span class="main">=</span> <span class="main">0</span>"</span></span> <span class="quoted"><span class="quoted">"pmf <span class="main">(</span><span class="free">sds</span> R28<span class="main">)</span> <span class="free">c</span> <span class="main">=</span> <span class="main">0</span>"</span></span> <span class="quoted"><span class="quoted">"pmf <span class="main">(</span><span class="free">sds</span> R28<span class="main">)</span> <span class="free">d</span> <span class="main">=</span> <span class="main">1</span><span class="main">/</span><span class="numeral">2</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"pmf <span class="main">(</span><span class="free">sds</span> R28<span class="main">)</span> <span class="free">a</span> <span class="main">≤</span> pmf <span class="main">(</span><span class="free">sds</span> R32<span class="main">)</span> <span class="free">d</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> R32_R28.strategyproofness<span class="main">(</span>1<span class="main">)</span> lottery_conditions<span class="main">[</span><span class="operator">OF</span> R32.wf<span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">hence</span></span> R32_d<span class="main">:</span> <span class="quoted"><span class="quoted">"pmf <span class="main">(</span><span class="free">sds</span> R32<span class="main">)</span> <span class="free">d</span> <span class="main">=</span> pmf <span class="main">(</span><span class="free">sds</span> R28<span class="main">)</span> <span class="free">a</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> R28_R32.strategyproofness<span class="main">(</span>1<span class="main">)</span> lottery_conditions<span class="main">[</span><span class="operator">OF</span> R32.wf<span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

  <span class="keyword1"><span class="command">from</span></span> R22_R32.strategyproofness<span class="main">(</span>1<span class="main">)</span> lottery_conditions<span class="main">[</span><span class="operator">OF</span> R32.wf<span class="main">]</span> R32.support 
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"pmf <span class="main">(</span><span class="free">sds</span> R32<span class="main">)</span> <span class="free">a</span> <span class="main">≤</span> <span class="main">1</span><span class="main">/</span><span class="numeral">2</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">with</span></span> R32_R22.strategyproofness<span class="main">(</span>1<span class="main">)</span> lottery_conditions<span class="main">[</span><span class="operator">OF</span> R32.wf<span class="main">]</span> R32.support 
    <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"pmf <span class="main">(</span><span class="free">sds</span> R28<span class="main">)</span> <span class="free">a</span> <span class="main">=</span> <span class="main">1</span><span class="main">/</span><span class="numeral">2</span>"</span></span> <span class="quoted"><span class="quoted">"pmf <span class="main">(</span><span class="free">sds</span> R28<span class="main">)</span> <span class="free">b</span> <span class="main">=</span> <span class="main">0</span>"</span></span> <span class="quoted"><span class="quoted">"pmf <span class="main">(</span><span class="free">sds</span> R28<span class="main">)</span> <span class="free">c</span> <span class="main">=</span> <span class="main">0</span>"</span></span> <span class="quoted"><span class="quoted">"pmf <span class="main">(</span><span class="free">sds</span> R28<span class="main">)</span> <span class="free">d</span> <span class="main">=</span> <span class="main">1</span><span class="main">/</span><span class="numeral">2</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> R32_d <span class="quasi_keyword">simp</span> <span class="quasi_keyword">del</span><span class="main"><span class="main">:</span></span> pmf_nonneg<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">lemma</span></span> R39 <span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"pmf <span class="main">(</span><span class="free">sds</span> R39<span class="main">)</span> <span class="free">a</span> <span class="main">=</span> <span class="main">1</span><span class="main">/</span><span class="numeral">2</span>"</span></span> <span class="quoted"><span class="quoted">"pmf <span class="main">(</span><span class="free">sds</span> R39<span class="main">)</span> <span class="free">b</span> <span class="main">=</span> <span class="main">0</span>"</span></span> <span class="quoted"><span class="quoted">"pmf <span class="main">(</span><span class="free">sds</span> R39<span class="main">)</span> <span class="free">c</span> <span class="main">=</span> <span class="main">0</span>"</span></span> <span class="quoted"><span class="quoted">"pmf <span class="main">(</span><span class="free">sds</span> R39<span class="main">)</span> <span class="free">d</span> <span class="main">=</span> <span class="main">1</span><span class="main">/</span><span class="numeral">2</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">from</span></span> R28_R39.strategyproofness<span class="main">(</span>1<span class="main">)</span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"pmf <span class="main">(</span><span class="free">sds</span> R39<span class="main">)</span> <span class="free">c</span> <span class="main">=</span> <span class="main">0</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"pmf <span class="main">(</span><span class="free">sds</span> R39<span class="main">)</span> <span class="free">a</span> <span class="main">=</span> <span class="main">1</span><span class="main">/</span><span class="numeral">2</span>"</span></span> <span class="quoted"><span class="quoted">"pmf <span class="main">(</span><span class="free">sds</span> R39<span class="main">)</span> <span class="free">b</span> <span class="main">=</span> <span class="main">0</span>"</span></span> <span class="quoted"><span class="quoted">"pmf <span class="main">(</span><span class="free">sds</span> R39<span class="main">)</span> <span class="free">d</span> <span class="main">=</span> <span class="main">1</span><span class="main">/</span><span class="numeral">2</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp_all</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">lemma</span></span> R2 <span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"pmf <span class="main">(</span><span class="free">sds</span> R2<span class="main">)</span> <span class="free">a</span> <span class="main">=</span> <span class="main">1</span><span class="main">/</span><span class="numeral">2</span>"</span></span> <span class="quoted"><span class="quoted">"pmf <span class="main">(</span><span class="free">sds</span> R2<span class="main">)</span> <span class="free">b</span> <span class="main">=</span> <span class="main">0</span>"</span></span> <span class="quoted"><span class="quoted">"pmf <span class="main">(</span><span class="free">sds</span> R2<span class="main">)</span> <span class="free">c</span> <span class="main">=</span> <span class="main">0</span>"</span></span> <span class="quoted"><span class="quoted">"pmf <span class="main">(</span><span class="free">sds</span> R2<span class="main">)</span> <span class="free">d</span> <span class="main">=</span> <span class="main">1</span><span class="main">/</span><span class="numeral">2</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">from</span></span> R1_R2.strategyproofness<span class="main">(</span>1<span class="main">)</span> R2_R1.strategyproofness<span class="main">(</span>1<span class="main">)</span> lottery_conditions<span class="main">[</span><span class="operator">OF</span> R2.wf<span class="main">]</span> lottery_conditions<span class="main">[</span><span class="operator">OF</span> R1.wf<span class="main">]</span>
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"pmf <span class="main">(</span><span class="free">sds</span> R2<span class="main">)</span> <span class="free">a</span> <span class="main">=</span> <span class="main">1</span><span class="main">/</span><span class="numeral">2</span>"</span></span> <span class="quoted"><span class="quoted">"pmf <span class="main">(</span><span class="free">sds</span> R2<span class="main">)</span> <span class="free">c</span> <span class="main">+</span> pmf <span class="main">(</span><span class="free">sds</span> R2<span class="main">)</span> <span class="free">d</span> <span class="main">=</span> <span class="main">1</span><span class="main">/</span><span class="numeral">2</span>"</span></span> 
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> <span class="dynamic"><span class="dynamic">algebra_simps</span></span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">del</span><span class="main"><span class="main">:</span></span> pmf_nonneg<span class="main">)</span>
  <span class="keyword1"><span class="command">with</span></span> R39_R2.strategyproofness<span class="main">(</span>1<span class="main">)</span> lottery_conditions<span class="main">[</span><span class="operator">OF</span> R2.wf<span class="main">]</span>
    <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"pmf <span class="main">(</span><span class="free">sds</span> R2<span class="main">)</span> <span class="free">a</span> <span class="main">=</span> <span class="main">1</span><span class="main">/</span><span class="numeral">2</span>"</span></span> <span class="quoted"><span class="quoted">"pmf <span class="main">(</span><span class="free">sds</span> R2<span class="main">)</span> <span class="free">b</span> <span class="main">=</span> <span class="main">0</span>"</span></span> <span class="quoted"><span class="quoted">"pmf <span class="main">(</span><span class="free">sds</span> R2<span class="main">)</span> <span class="free">c</span> <span class="main">=</span> <span class="main">0</span>"</span></span> <span class="quoted"><span class="quoted">"pmf <span class="main">(</span><span class="free">sds</span> R2<span class="main">)</span> <span class="free">d</span> <span class="main">=</span> <span class="main">1</span><span class="main">/</span><span class="numeral">2</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">lemma</span></span> R42 <span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"pmf <span class="main">(</span><span class="free">sds</span> R42<span class="main">)</span> <span class="free">a</span> <span class="main">=</span> <span class="main">0</span>"</span></span> <span class="quoted"><span class="quoted">"pmf <span class="main">(</span><span class="free">sds</span> R42<span class="main">)</span> <span class="free">b</span> <span class="main">=</span> <span class="main">0</span>"</span></span> <span class="quoted"><span class="quoted">"pmf <span class="main">(</span><span class="free">sds</span> R42<span class="main">)</span> <span class="free">c</span> <span class="main">=</span> <span class="main">1</span><span class="main">/</span><span class="numeral">2</span>"</span></span> <span class="quoted"><span class="quoted">"pmf <span class="main">(</span><span class="free">sds</span> R42<span class="main">)</span> <span class="free">d</span> <span class="main">=</span> <span class="main">1</span><span class="main">/</span><span class="numeral">2</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">from</span></span> R17_R5.strategyproofness<span class="main">(</span>1<span class="main">)</span> lottery_conditions<span class="main">[</span><span class="operator">OF</span> R17.wf<span class="main">]</span> R17.support 
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"pmf <span class="main">(</span><span class="free">sds</span> R17<span class="main">)</span> <span class="free">d</span> <span class="main">≤</span> <span class="main">1</span><span class="main">/</span><span class="numeral">2</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> R5_R17.strategyproofness<span class="main">(</span>1<span class="main">)</span> R17.support lottery_conditions<span class="main">[</span><span class="operator">OF</span> R17.wf<span class="main">]</span> 
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"pmf <span class="main">(</span><span class="free">sds</span> R17<span class="main">)</span> <span class="free">d</span> <span class="main">≥</span> <span class="main">1</span><span class="main">/</span><span class="numeral">2</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> R17_d<span class="main">:</span> <span class="quoted"><span class="quoted">"pmf <span class="main">(</span><span class="free">sds</span> R17<span class="main">)</span> <span class="free">d</span> <span class="main">=</span> <span class="main">1</span><span class="main">/</span><span class="numeral">2</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>

  <span class="keyword1"><span class="command">from</span></span> R6_R42.strategyproofness<span class="main">(</span>1<span class="main">)</span> 
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"pmf <span class="main">(</span><span class="free">sds</span> R42<span class="main">)</span> <span class="free">a</span> <span class="main">+</span> pmf <span class="main">(</span><span class="free">sds</span> R42<span class="main">)</span> <span class="free">c</span> <span class="main">≤</span> pmf <span class="main">(</span><span class="free">sds</span> R6<span class="main">)</span> <span class="free">a</span> <span class="main">+</span> pmf <span class="main">(</span><span class="free">sds</span> R6<span class="main">)</span> <span class="free">c</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">from</span></span> R6_R19.strategyproofness<span class="main">(</span>1<span class="main">)</span> lottery_conditions<span class="main">[</span><span class="operator">OF</span> R6.wf<span class="main">]</span> 
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"pmf <span class="main">(</span><span class="free">sds</span> R6<span class="main">)</span> <span class="free">a</span> <span class="main">+</span> pmf <span class="main">(</span><span class="free">sds</span> R6<span class="main">)</span> <span class="free">c</span> <span class="main">≤</span> <span class="main">1</span><span class="main">/</span><span class="numeral">2</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">del</span><span class="main"><span class="main">:</span></span> pmf_nonneg<span class="main">)</span>
  <span class="keyword1"><span class="command">finally</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"pmf <span class="main">(</span><span class="free">sds</span> R42<span class="main">)</span> <span class="free">a</span> <span class="main">+</span> pmf <span class="main">(</span><span class="free">sds</span> R42<span class="main">)</span> <span class="free">c</span> <span class="main">≤</span> <span class="main">1</span> <span class="main">/</span> <span class="numeral">2</span>"</span></span> <span class="keyword1"><span class="command">.</span></span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> R17_R11.strategyproofness<span class="main">(</span>1<span class="main">)</span> R11.support R17.support
       lottery_conditions<span class="main">[</span><span class="operator">OF</span> R11.wf<span class="main">]</span> lottery_conditions<span class="main">[</span><span class="operator">OF</span> R17.wf<span class="main">]</span>
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"pmf <span class="main">(</span><span class="free">sds</span> R11<span class="main">)</span> <span class="free">d</span> <span class="main">≥</span> <span class="main">1</span><span class="main">/</span><span class="numeral">2</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> R17_d<span class="main">)</span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"pmf <span class="main">(</span><span class="free">sds</span> R42<span class="main">)</span> <span class="free">a</span> <span class="main">+</span> pmf <span class="main">(</span><span class="free">sds</span> R42<span class="main">)</span> <span class="free">c</span> <span class="main">≤</span> pmf <span class="main">(</span><span class="free">sds</span> R11<span class="main">)</span> <span class="free">d</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">with</span></span> R42_R11.strategyproofness<span class="main">(</span>1<span class="main">)</span> R11.support
    <span class="keyword1"><span class="command">have</span></span> E<span class="main">:</span> <span class="quoted"><span class="quoted">"pmf <span class="main">(</span><span class="free">sds</span> R11<span class="main">)</span> <span class="free">d</span> <span class="main">≤</span> pmf <span class="main">(</span><span class="free">sds</span> R42<span class="main">)</span> <span class="free">c</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">with</span></span> <span class="quoted"><span class="quoted">‹pmf <span class="main">(</span><span class="free">sds</span> R11<span class="main">)</span> <span class="free">d</span> <span class="main">≥</span> <span class="main">1</span><span class="main">/</span><span class="numeral">2</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"pmf <span class="main">(</span><span class="free">sds</span> R42<span class="main">)</span> <span class="free">c</span> <span class="main">≥</span> <span class="main">1</span><span class="main">/</span><span class="numeral">2</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> R17_R3.strategyproofness<span class="main">(</span>1<span class="main">)</span> R3.support R17.support
       lottery_conditions<span class="main">[</span><span class="operator">OF</span> R17.wf<span class="main">]</span> lottery_conditions<span class="main">[</span><span class="operator">OF</span> R3.wf<span class="main">]</span> 
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"pmf <span class="main">(</span><span class="free">sds</span> R3<span class="main">)</span> <span class="free">d</span> <span class="main">≥</span> <span class="main">1</span><span class="main">/</span><span class="numeral">2</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> R17_d<span class="main">)</span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"pmf <span class="main">(</span><span class="free">sds</span> R42<span class="main">)</span> <span class="free">a</span> <span class="main">=</span> <span class="main">0</span>"</span></span> <span class="quoted"><span class="quoted">"pmf <span class="main">(</span><span class="free">sds</span> R42<span class="main">)</span> <span class="free">b</span> <span class="main">=</span> <span class="main">0</span>"</span></span> <span class="quoted"><span class="quoted">"pmf <span class="main">(</span><span class="free">sds</span> R42<span class="main">)</span> <span class="free">c</span> <span class="main">=</span> <span class="main">1</span><span class="main">/</span><span class="numeral">2</span>"</span></span> <span class="quoted"><span class="quoted">"pmf <span class="main">(</span><span class="free">sds</span> R42<span class="main">)</span> <span class="free">d</span> <span class="main">=</span> <span class="main">1</span><span class="main">/</span><span class="numeral">2</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> R42_R3.strategyproofness<span class="main">(</span>1<span class="main">)</span> lottery_conditions<span class="main">[</span><span class="operator">OF</span> R3.wf<span class="main">]</span> lottery_conditions<span class="main">[</span><span class="operator">OF</span> R42.wf<span class="main">]</span>
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">linarith</span><span class="main"><span class="keyword3">+</span></span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">lemma</span></span> R37 <span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"pmf <span class="main">(</span><span class="free">sds</span> R37<span class="main">)</span> <span class="free">a</span> <span class="main">=</span> <span class="main">1</span><span class="main">/</span><span class="numeral">2</span>"</span></span> <span class="quoted"><span class="quoted">"pmf <span class="main">(</span><span class="free">sds</span> R37<span class="main">)</span> <span class="free">b</span> <span class="main">=</span> <span class="main">0</span>"</span></span> <span class="quoted"><span class="quoted">"pmf <span class="main">(</span><span class="free">sds</span> R37<span class="main">)</span> <span class="free">c</span> <span class="main">=</span> <span class="main">1</span><span class="main">/</span><span class="numeral">2</span>"</span></span> <span class="quoted"><span class="quoted">"pmf <span class="main">(</span><span class="free">sds</span> R37<span class="main">)</span> <span class="free">d</span> <span class="main">=</span> <span class="main">0</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">from</span></span> R37_R42.strategyproofness<span class="main">(</span>1<span class="main">)</span> lottery_conditions<span class="main">[</span><span class="operator">OF</span> R37.wf<span class="main">]</span>
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"pmf <span class="main">(</span><span class="free">sds</span> R37<span class="main">)</span> <span class="free">a</span> <span class="main">=</span> <span class="main">1</span><span class="main">/</span><span class="numeral">2</span> <span class="main">∨</span> pmf <span class="main">(</span><span class="free">sds</span> R37<span class="main">)</span> <span class="free">a</span> <span class="main">+</span> pmf <span class="main">(</span><span class="free">sds</span> R37<span class="main">)</span> <span class="free">b</span> <span class="main">&gt;</span> <span class="main">1</span><span class="main">/</span><span class="numeral">2</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">del</span><span class="main"><span class="main">:</span></span> pmf_nonneg<span class="main">)</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> R37_R42.strategyproofness<span class="main">(</span>2<span class="main">)</span> lottery_conditions<span class="main">[</span><span class="operator">OF</span> R37.wf<span class="main">]</span>
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"pmf <span class="main">(</span><span class="free">sds</span> R37<span class="main">)</span> <span class="free">c</span> <span class="main">=</span> <span class="main">1</span><span class="main">/</span><span class="numeral">2</span> <span class="main">∨</span> pmf <span class="main">(</span><span class="free">sds</span> R37<span class="main">)</span> <span class="free">c</span> <span class="main">+</span> pmf <span class="main">(</span><span class="free">sds</span> R37<span class="main">)</span> <span class="free">d</span> <span class="main">&gt;</span> <span class="main">1</span><span class="main">/</span><span class="numeral">2</span>"</span></span> 
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">del</span><span class="main"><span class="main">:</span></span> pmf_nonneg<span class="main">)</span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"pmf <span class="main">(</span><span class="free">sds</span> R37<span class="main">)</span> <span class="free">a</span> <span class="main">=</span> <span class="main">1</span><span class="main">/</span><span class="numeral">2</span>"</span></span> <span class="quoted"><span class="quoted">"pmf <span class="main">(</span><span class="free">sds</span> R37<span class="main">)</span> <span class="free">b</span> <span class="main">=</span> <span class="main">0</span>"</span></span> <span class="quoted"><span class="quoted">"pmf <span class="main">(</span><span class="free">sds</span> R37<span class="main">)</span> <span class="free">c</span> <span class="main">=</span> <span class="main">1</span><span class="main">/</span><span class="numeral">2</span>"</span></span> <span class="quoted"><span class="quoted">"pmf <span class="main">(</span><span class="free">sds</span> R37<span class="main">)</span> <span class="free">d</span> <span class="main">=</span> <span class="main">0</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> lottery_conditions<span class="main">[</span><span class="operator">OF</span> R37.wf<span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">del</span><span class="main"><span class="main">:</span></span> pmf_nonneg<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">lemma</span></span> R24 <span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"pmf <span class="main">(</span><span class="free">sds</span> R24<span class="main">)</span> <span class="free">a</span> <span class="main">=</span> <span class="main">0</span>"</span></span> <span class="quoted"><span class="quoted">"pmf <span class="main">(</span><span class="free">sds</span> R24<span class="main">)</span> <span class="free">b</span> <span class="main">=</span> <span class="main">0</span>"</span></span> <span class="quoted"><span class="quoted">"pmf <span class="main">(</span><span class="free">sds</span> R24<span class="main">)</span> <span class="free">d</span> <span class="main">=</span> <span class="main">1</span> <span class="main">-</span> pmf <span class="main">(</span><span class="free">sds</span> R24<span class="main">)</span> <span class="free">c</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> R42_R24.strategyproofness<span class="main">(</span>1<span class="main">)</span> lottery_conditions<span class="main">[</span><span class="operator">OF</span> R24.wf<span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">del</span><span class="main"><span class="main">:</span></span> pmf_nonneg<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> R34 <span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span>
  <span class="quoted"><span class="quoted">"pmf <span class="main">(</span><span class="free">sds</span> R34<span class="main">)</span> <span class="free">a</span> <span class="main">=</span> <span class="main">1</span> <span class="main">-</span> pmf <span class="main">(</span><span class="free">sds</span> R24<span class="main">)</span> <span class="free">c</span>"</span></span> <span class="quoted"><span class="quoted">"pmf <span class="main">(</span><span class="free">sds</span> R34<span class="main">)</span> <span class="free">b</span> <span class="main">=</span> pmf <span class="main">(</span><span class="free">sds</span> R24<span class="main">)</span> <span class="free">c</span>"</span></span>
  <span class="quoted"><span class="quoted">"pmf <span class="main">(</span><span class="free">sds</span> R34<span class="main">)</span> <span class="free">c</span> <span class="main">=</span> <span class="main">0</span>"</span></span> <span class="quoted"><span class="quoted">"pmf <span class="main">(</span><span class="free">sds</span> R34<span class="main">)</span> <span class="free">d</span> <span class="main">=</span> <span class="main">0</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">from</span></span> R24_R34.strategyproofness<span class="main">(</span>1<span class="main">)</span> lottery_conditions<span class="main">[</span><span class="operator">OF</span> R34.wf<span class="main">]</span> 
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"pmf <span class="main">(</span><span class="free">sds</span> R34<span class="main">)</span> <span class="free">b</span> <span class="main">≤</span> pmf <span class="main">(</span><span class="free">sds</span> R24<span class="main">)</span> <span class="free">c</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">del</span><span class="main"><span class="main">:</span></span> pmf_nonneg<span class="main">)</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> R34_R24.strategyproofness<span class="main">(</span>1<span class="main">)</span> lottery_conditions<span class="main">[</span><span class="operator">OF</span> R34.wf<span class="main">]</span> 
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"pmf <span class="main">(</span><span class="free">sds</span> R34<span class="main">)</span> <span class="free">b</span> <span class="main">≥</span> pmf <span class="main">(</span><span class="free">sds</span> R24<span class="main">)</span> <span class="free">c</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> bc<span class="main">:</span> <span class="quoted"><span class="quoted">"pmf <span class="main">(</span><span class="free">sds</span> R34<span class="main">)</span> <span class="free">b</span> <span class="main">=</span> pmf <span class="main">(</span><span class="free">sds</span> R24<span class="main">)</span> <span class="free">c</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">from</span></span> R34_R24.strategyproofness<span class="main">(</span>1<span class="main">)</span> bc lottery_conditions<span class="main">[</span><span class="operator">OF</span> R34.wf<span class="main">]</span> 
    <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"pmf <span class="main">(</span><span class="free">sds</span> R34<span class="main">)</span> <span class="free">c</span> <span class="main">=</span> <span class="main">0</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> R24_R34.strategyproofness<span class="main">(</span>1<span class="main">)</span> bc <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"pmf <span class="main">(</span><span class="free">sds</span> R34<span class="main">)</span> <span class="free">d</span> <span class="main">=</span> <span class="main">0</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"pmf <span class="main">(</span><span class="free">sds</span> R34<span class="main">)</span> <span class="free">a</span> <span class="main">=</span> <span class="main">1</span> <span class="main">-</span> pmf <span class="main">(</span><span class="free">sds</span> R24<span class="main">)</span> <span class="free">c</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> bc lottery_conditions<span class="main">[</span><span class="operator">OF</span> R34.wf<span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">lemma</span></span> R14 <span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"pmf <span class="main">(</span><span class="free">sds</span> R14<span class="main">)</span> <span class="free">b</span> <span class="main">=</span> <span class="main">0</span>"</span></span> <span class="quoted"><span class="quoted">"pmf <span class="main">(</span><span class="free">sds</span> R14<span class="main">)</span> <span class="free">d</span> <span class="main">=</span> <span class="main">0</span>"</span></span> <span class="quoted"><span class="quoted">"pmf <span class="main">(</span><span class="free">sds</span> R14<span class="main">)</span> <span class="free">c</span> <span class="main">=</span> <span class="main">1</span> <span class="main">-</span> pmf <span class="main">(</span><span class="free">sds</span> R14<span class="main">)</span> <span class="free">a</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> R14_R34.strategyproofness<span class="main">(</span>1<span class="main">)</span> R14.support lottery_conditions<span class="main">[</span><span class="operator">OF</span> R14.wf<span class="main">]</span> 
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">del</span><span class="main"><span class="main">:</span></span> pmf_nonneg<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> R46 <span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"pmf <span class="main">(</span><span class="free">sds</span> R46<span class="main">)</span> <span class="free">a</span> <span class="main">=</span> <span class="main">0</span>"</span></span> <span class="quoted"><span class="quoted">"pmf <span class="main">(</span><span class="free">sds</span> R46<span class="main">)</span> <span class="free">c</span> <span class="main">=</span> <span class="main">0</span>"</span></span> <span class="quoted"><span class="quoted">"pmf <span class="main">(</span><span class="free">sds</span> R46<span class="main">)</span> <span class="free">d</span> <span class="main">=</span> <span class="main">1</span> <span class="main">-</span> pmf <span class="main">(</span><span class="free">sds</span> R46<span class="main">)</span> <span class="free">b</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> R46_R37.strategyproofness<span class="main">(</span>1<span class="main">)</span> lottery_conditions<span class="main">[</span><span class="operator">OF</span> R46.wf<span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">lemma</span></span> R20 <span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"pmf <span class="main">(</span><span class="free">sds</span> R20<span class="main">)</span> <span class="free">a</span> <span class="main">=</span> <span class="main">0</span>"</span></span> <span class="quoted"><span class="quoted">"pmf <span class="main">(</span><span class="free">sds</span> R20<span class="main">)</span> <span class="free">c</span> <span class="main">=</span> <span class="main">0</span>"</span></span> <span class="quoted"><span class="quoted">"pmf <span class="main">(</span><span class="free">sds</span> R20<span class="main">)</span> <span class="free">d</span> <span class="main">=</span> <span class="main">1</span> <span class="main">-</span> pmf <span class="main">(</span><span class="free">sds</span> R20<span class="main">)</span> <span class="free">b</span>"</span></span> 
  <span class="keyword1"><span class="command">using</span></span> R46_R20.strategyproofness<span class="main">(</span>1<span class="main">)</span> lottery_conditions<span class="main">[</span><span class="operator">OF</span> R20.wf<span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">del</span><span class="main"><span class="main">:</span></span> pmf_nonneg<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> R21 <span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"pmf <span class="main">(</span><span class="free">sds</span> R21<span class="main">)</span> <span class="free">d</span> <span class="main">=</span> <span class="main">1</span> <span class="main">-</span> pmf <span class="main">(</span><span class="free">sds</span> R21<span class="main">)</span> <span class="free">a</span>"</span></span> <span class="quoted"><span class="quoted">"pmf <span class="main">(</span><span class="free">sds</span> R21<span class="main">)</span> <span class="free">b</span> <span class="main">=</span> <span class="main">0</span>"</span></span> <span class="quoted"><span class="quoted">"pmf <span class="main">(</span><span class="free">sds</span> R21<span class="main">)</span> <span class="free">c</span> <span class="main">=</span> <span class="main">0</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> R20_R21.strategyproofness<span class="main">(</span>1<span class="main">)</span> lottery_conditions<span class="main">[</span><span class="operator">OF</span> R21.wf<span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>


<span class="keyword1"><span class="command">lemma</span></span> R16_R12<span class="main">:</span> <span class="quoted"><span class="quoted">"pmf <span class="main">(</span><span class="free">sds</span> R16<span class="main">)</span> <span class="free">c</span> <span class="main">+</span> pmf <span class="main">(</span><span class="free">sds</span> R16<span class="main">)</span> <span class="free">a</span> <span class="main">≤</span> pmf <span class="main">(</span><span class="free">sds</span> R12<span class="main">)</span> <span class="free">a</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> R12_R16.strategyproofness<span class="main">(</span>1<span class="main">)</span> R16.support lottery_conditions<span class="main">[</span><span class="operator">OF</span> R16.wf<span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">lemma</span></span> R16 <span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"pmf <span class="main">(</span><span class="free">sds</span> R16<span class="main">)</span> <span class="free">b</span> <span class="main">=</span> <span class="main">0</span>"</span></span> <span class="quoted"><span class="quoted">"pmf <span class="main">(</span><span class="free">sds</span> R16<span class="main">)</span> <span class="free">c</span> <span class="main">=</span> <span class="main">0</span>"</span></span> <span class="quoted"><span class="quoted">"pmf <span class="main">(</span><span class="free">sds</span> R16<span class="main">)</span> <span class="free">d</span> <span class="main">=</span> <span class="main">1</span> <span class="main">-</span> pmf <span class="main">(</span><span class="free">sds</span> R16<span class="main">)</span> <span class="free">a</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">from</span></span> R16_R12 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"pmf <span class="main">(</span><span class="free">sds</span> R16<span class="main">)</span> <span class="free">c</span> <span class="main">+</span> pmf <span class="main">(</span><span class="free">sds</span> R16<span class="main">)</span> <span class="free">a</span> <span class="main">≤</span> pmf <span class="main">(</span><span class="free">sds</span> R12<span class="main">)</span> <span class="free">a</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">from</span></span> R44_R40.strategyproofness<span class="main">(</span>1<span class="main">)</span> lottery_conditions<span class="main">[</span><span class="operator">OF</span> R40.wf<span class="main">]</span> R40.support
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"pmf <span class="main">(</span><span class="free">sds</span> R12<span class="main">)</span> <span class="free">a</span> <span class="main">≤</span> pmf <span class="main">(</span><span class="free">sds</span> R40<span class="main">)</span> <span class="free">a</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">from</span></span> R9_R40.strategyproofness<span class="main">(</span>1<span class="main">)</span> R9.support R40.support 
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"pmf <span class="main">(</span><span class="free">sds</span> R40<span class="main">)</span> <span class="free">a</span> <span class="main">≤</span> pmf <span class="main">(</span><span class="free">sds</span> R9<span class="main">)</span> <span class="free">a</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">finally</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"pmf <span class="main">(</span><span class="free">sds</span> R16<span class="main">)</span> <span class="free">c</span> <span class="main">+</span> pmf <span class="main">(</span><span class="free">sds</span> R16<span class="main">)</span> <span class="free">a</span> <span class="main">≤</span> pmf <span class="main">(</span><span class="free">sds</span> R9<span class="main">)</span> <span class="free">a</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> R14_R16.strategyproofness<span class="main">(</span>1<span class="main">)</span> R16.support lottery_conditions<span class="main">[</span><span class="operator">OF</span> R16.wf<span class="main">]</span> 
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"pmf <span class="main">(</span><span class="free">sds</span> R16<span class="main">)</span> <span class="free">a</span> <span class="main">≥</span> pmf <span class="main">(</span><span class="free">sds</span> R14<span class="main">)</span> <span class="free">a</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"pmf <span class="main">(</span><span class="free">sds</span> R16<span class="main">)</span> <span class="free">c</span> <span class="main">≤</span> pmf <span class="main">(</span><span class="free">sds</span> R9<span class="main">)</span> <span class="free">a</span> <span class="main">-</span> pmf <span class="main">(</span><span class="free">sds</span> R14<span class="main">)</span> <span class="free">a</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">from</span></span> R14_R9.strategyproofness<span class="main">(</span>1<span class="main">)</span> R9.support lottery_conditions<span class="main">[</span><span class="operator">OF</span> R9.wf<span class="main">]</span>
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"pmf <span class="main">(</span><span class="free">sds</span> R9<span class="main">)</span> <span class="free">a</span> <span class="main">-</span> pmf <span class="main">(</span><span class="free">sds</span> R14<span class="main">)</span> <span class="free">a</span> <span class="main">≤</span> <span class="main">0</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">del</span><span class="main"><span class="main">:</span></span> pmf_nonneg<span class="main">)</span>
  <span class="keyword1"><span class="command">finally</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"pmf <span class="main">(</span><span class="free">sds</span> R16<span class="main">)</span> <span class="free">b</span> <span class="main">=</span> <span class="main">0</span>"</span></span> <span class="quoted"><span class="quoted">"pmf <span class="main">(</span><span class="free">sds</span> R16<span class="main">)</span> <span class="free">c</span> <span class="main">=</span> <span class="main">0</span>"</span></span> <span class="quoted"><span class="quoted">"pmf <span class="main">(</span><span class="free">sds</span> R16<span class="main">)</span> <span class="free">d</span> <span class="main">=</span> <span class="main">1</span> <span class="main">-</span> pmf <span class="main">(</span><span class="free">sds</span> R16<span class="main">)</span> <span class="free">a</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> lottery_conditions<span class="main">[</span><span class="operator">OF</span> R16.wf<span class="main">]</span> R16.support <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">lemma</span></span> R12_R14<span class="main">:</span> <span class="quoted"><span class="quoted">"pmf <span class="main">(</span><span class="free">sds</span> R14<span class="main">)</span> <span class="free">a</span> <span class="main">≤</span> pmf <span class="main">(</span><span class="free">sds</span> R12<span class="main">)</span> <span class="free">a</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> R14_R16.strategyproofness<span class="main">(</span>1<span class="main">)</span> R16_R12 <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">lemma</span></span> R12_a <span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"pmf <span class="main">(</span><span class="free">sds</span> R12<span class="main">)</span> <span class="free">a</span> <span class="main">=</span> pmf <span class="main">(</span><span class="free">sds</span> R9<span class="main">)</span> <span class="free">a</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">from</span></span> R44_R40.strategyproofness<span class="main">(</span>1<span class="main">)</span> R40.support lottery_conditions<span class="main">[</span><span class="operator">OF</span> R40.wf<span class="main">]</span> 
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"pmf <span class="main">(</span><span class="free">sds</span> R12<span class="main">)</span> <span class="free">a</span> <span class="main">≤</span> pmf <span class="main">(</span><span class="free">sds</span> R40<span class="main">)</span> <span class="free">a</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">from</span></span> R9_R40.strategyproofness<span class="main">(</span>1<span class="main">)</span> R9.support R40.support 
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"pmf <span class="main">(</span><span class="free">sds</span> R40<span class="main">)</span> <span class="free">a</span> <span class="main">≤</span> pmf <span class="main">(</span><span class="free">sds</span> R9<span class="main">)</span> <span class="free">a</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">finally</span></span> <span class="keyword1"><span class="command">have</span></span> B<span class="main">:</span> <span class="quoted"><span class="quoted">"pmf <span class="main">(</span><span class="free">sds</span> R12<span class="main">)</span> <span class="free">a</span> <span class="main">≤</span> pmf <span class="main">(</span><span class="free">sds</span> R9<span class="main">)</span> <span class="free">a</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> R14_R9.strategyproofness<span class="main">(</span>1<span class="main">)</span> lottery_conditions<span class="main">[</span><span class="operator">OF</span> R9.wf<span class="main">]</span> R9.support 
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"pmf <span class="main">(</span><span class="free">sds</span> R9<span class="main">)</span> <span class="free">a</span> <span class="main">≤</span> pmf <span class="main">(</span><span class="free">sds</span> R14<span class="main">)</span> <span class="free">a</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">del</span><span class="main"><span class="main">:</span></span> pmf_nonneg<span class="main">)</span>
  <span class="keyword1"><span class="command">with</span></span> R12_R14 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"pmf <span class="main">(</span><span class="free">sds</span> R9<span class="main">)</span> <span class="free">a</span> <span class="main">≤</span> pmf <span class="main">(</span><span class="free">sds</span> R12<span class="main">)</span> <span class="free">a</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"pmf <span class="main">(</span><span class="free">sds</span> R12<span class="main">)</span> <span class="free">a</span> <span class="main">=</span> pmf <span class="main">(</span><span class="free">sds</span> R9<span class="main">)</span> <span class="free">a</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">lemma</span></span> R9 <span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"pmf <span class="main">(</span><span class="free">sds</span> R9<span class="main">)</span> <span class="free">b</span> <span class="main">=</span> <span class="main">0</span>"</span></span> <span class="quoted"><span class="quoted">"pmf <span class="main">(</span><span class="free">sds</span> R9<span class="main">)</span> <span class="free">d</span> <span class="main">=</span> <span class="main">0</span>"</span></span> <span class="quoted"><span class="quoted">"pmf <span class="main">(</span><span class="free">sds</span> R14<span class="main">)</span> <span class="free">a</span> <span class="main">=</span> pmf <span class="main">(</span><span class="free">sds</span> R35<span class="main">)</span> <span class="free">a</span>"</span></span> <span class="quoted"><span class="quoted">"pmf <span class="main">(</span><span class="free">sds</span> R9<span class="main">)</span> <span class="free">c</span> <span class="main">=</span> <span class="main">1</span> <span class="main">-</span> pmf <span class="main">(</span><span class="free">sds</span> R35<span class="main">)</span> <span class="free">a</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> R12_R14 R14_R9.strategyproofness<span class="main">(</span>1<span class="main">)</span> lottery_conditions<span class="main">[</span><span class="operator">OF</span> R9.wf<span class="main">]</span> R9.support
  <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">lemma</span></span> R23 <span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"pmf <span class="main">(</span><span class="free">sds</span> R23<span class="main">)</span> <span class="free">b</span> <span class="main">=</span> <span class="main">0</span>"</span></span> <span class="quoted"><span class="quoted">"pmf <span class="main">(</span><span class="free">sds</span> R23<span class="main">)</span> <span class="free">c</span> <span class="main">=</span> <span class="main">0</span>"</span></span> <span class="quoted"><span class="quoted">"pmf <span class="main">(</span><span class="free">sds</span> R23<span class="main">)</span> <span class="free">d</span> <span class="main">=</span> <span class="main">1</span> <span class="main">-</span> pmf <span class="main">(</span><span class="free">sds</span> R23<span class="main">)</span> <span class="free">a</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> R23_R19.strategyproofness<span class="main">(</span>1<span class="main">)</span> lottery_conditions<span class="main">[</span><span class="operator">OF</span> R23.wf<span class="main">]</span> R23.support 
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">del</span><span class="main"><span class="main">:</span></span> pmf_nonneg<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> R35 <span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"pmf <span class="main">(</span><span class="free">sds</span> R35<span class="main">)</span> <span class="free">a</span> <span class="main">=</span> pmf <span class="main">(</span><span class="free">sds</span> R21<span class="main">)</span> <span class="free">a</span>"</span></span> <span class="quoted"><span class="quoted">"pmf <span class="main">(</span><span class="free">sds</span> R35<span class="main">)</span> <span class="free">b</span> <span class="main">=</span> <span class="main">0</span>"</span></span> <span class="quoted"><span class="quoted">"pmf <span class="main">(</span><span class="free">sds</span> R35<span class="main">)</span> <span class="free">c</span> <span class="main">=</span> <span class="main">0</span>"</span></span> <span class="quoted"><span class="quoted">"pmf <span class="main">(</span><span class="free">sds</span> R35<span class="main">)</span> <span class="free">d</span> <span class="main">=</span> <span class="main">1</span> <span class="main">-</span> pmf <span class="main">(</span><span class="free">sds</span> R21<span class="main">)</span> <span class="free">a</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">from</span></span> R35_R21.strategyproofness<span class="main">(</span>1<span class="main">)</span> R35.support
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"pmf <span class="main">(</span><span class="free">sds</span> R21<span class="main">)</span> <span class="free">a</span> <span class="main">≤</span> pmf <span class="main">(</span><span class="free">sds</span> R35<span class="main">)</span> <span class="free">a</span> <span class="main">+</span> pmf <span class="main">(</span><span class="free">sds</span> R35<span class="main">)</span> <span class="free">c</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">with</span></span> R21_R35.strategyproofness<span class="main">(</span>1<span class="main">)</span> R35.support lottery_conditions<span class="main">[</span><span class="operator">OF</span> R35.wf<span class="main">]</span>
    <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"pmf <span class="main">(</span><span class="free">sds</span> R35<span class="main">)</span> <span class="free">a</span> <span class="main">=</span> pmf <span class="main">(</span><span class="free">sds</span> R21<span class="main">)</span> <span class="free">a</span>"</span></span> <span class="quoted"><span class="quoted">"pmf <span class="main">(</span><span class="free">sds</span> R35<span class="main">)</span> <span class="free">b</span> <span class="main">=</span> <span class="main">0</span>"</span></span> 
         <span class="quoted"><span class="quoted">"pmf <span class="main">(</span><span class="free">sds</span> R35<span class="main">)</span> <span class="free">c</span> <span class="main">=</span> <span class="main">0</span>"</span></span> <span class="quoted"><span class="quoted">"pmf <span class="main">(</span><span class="free">sds</span> R35<span class="main">)</span> <span class="free">d</span> <span class="main">=</span> <span class="main">1</span> <span class="main">-</span> pmf <span class="main">(</span><span class="free">sds</span> R21<span class="main">)</span> <span class="free">a</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp_all</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">lemma</span></span> R18 <span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"pmf <span class="main">(</span><span class="free">sds</span> R18<span class="main">)</span> <span class="free">a</span> <span class="main">=</span> pmf <span class="main">(</span><span class="free">sds</span> R14<span class="main">)</span> <span class="free">a</span>"</span></span> <span class="quoted"><span class="quoted">"pmf <span class="main">(</span><span class="free">sds</span> R18<span class="main">)</span> <span class="free">b</span> <span class="main">=</span> <span class="main">0</span>"</span></span>
                  <span class="quoted"><span class="quoted">"pmf <span class="main">(</span><span class="free">sds</span> R18<span class="main">)</span> <span class="free">d</span> <span class="main">=</span> <span class="main">0</span>"</span></span> <span class="quoted"><span class="quoted">"pmf <span class="main">(</span><span class="free">sds</span> R18<span class="main">)</span> <span class="free">c</span> <span class="main">=</span> <span class="main">1</span> <span class="main">-</span> pmf <span class="main">(</span><span class="free">sds</span> R14<span class="main">)</span> <span class="free">a</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
 <span class="keyword1"><span class="command">from</span></span> R23_R12.strategyproofness<span class="main">(</span>1<span class="main">)</span>
    <span class="keyword1"><span class="command">have</span></span> R21_R23<span class="main">:</span> <span class="quoted"><span class="quoted">"pmf <span class="main">(</span><span class="free">sds</span> R21<span class="main">)</span> <span class="free">a</span> <span class="main">≤</span> pmf <span class="main">(</span><span class="free">sds</span> R23<span class="main">)</span> <span class="free">a</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>

  <span class="keyword1"><span class="command">from</span></span> R23_R18.strategyproofness<span class="main">(</span>1<span class="main">)</span> 
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"pmf <span class="main">(</span><span class="free">sds</span> R18<span class="main">)</span> <span class="free">d</span> <span class="main">≤</span> pmf <span class="main">(</span><span class="free">sds</span> R21<span class="main">)</span> <span class="free">a</span> <span class="main">-</span> pmf <span class="main">(</span><span class="free">sds</span> R23<span class="main">)</span> <span class="free">a</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">from</span></span> R21_R23 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">…</span> <span class="main">≤</span> <span class="main">0</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">finally</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"pmf <span class="main">(</span><span class="free">sds</span> R18<span class="main">)</span> <span class="free">d</span> <span class="main">=</span> <span class="main">0</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">with</span></span> lottery_conditions<span class="main">[</span><span class="operator">OF</span> R18.wf<span class="main">]</span> R18.support
    <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"pmf <span class="main">(</span><span class="free">sds</span> R18<span class="main">)</span> <span class="free">a</span> <span class="main">=</span> pmf <span class="main">(</span><span class="free">sds</span> R14<span class="main">)</span> <span class="free">a</span>"</span></span>
         <span class="quoted"><span class="quoted">"pmf <span class="main">(</span><span class="free">sds</span> R18<span class="main">)</span> <span class="free">c</span> <span class="main">=</span> <span class="main">1</span> <span class="main">-</span> pmf <span class="main">(</span><span class="free">sds</span> R14<span class="main">)</span> <span class="free">a</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span> <span class="main">(</span><span class="operator">insert</span> R18.support<span class="main"><span class="keyword3">,</span></span> <span class="operator">simp_all</span><span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> R4 <span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"pmf <span class="main">(</span><span class="free">sds</span> R4<span class="main">)</span> <span class="free">a</span> <span class="main">=</span> pmf <span class="main">(</span><span class="free">sds</span> R21<span class="main">)</span> <span class="free">a</span>"</span></span> <span class="quoted"><span class="quoted">"pmf <span class="main">(</span><span class="free">sds</span> R4<span class="main">)</span> <span class="free">b</span> <span class="main">=</span> <span class="main">0</span>"</span></span>
                 <span class="quoted"><span class="quoted">"pmf <span class="main">(</span><span class="free">sds</span> R4<span class="main">)</span> <span class="free">c</span> <span class="main">=</span> <span class="main">1</span> <span class="main">-</span> pmf <span class="main">(</span><span class="free">sds</span> R4<span class="main">)</span> <span class="free">a</span>"</span></span> <span class="quoted"><span class="quoted">"pmf <span class="main">(</span><span class="free">sds</span> R4<span class="main">)</span> <span class="free">d</span> <span class="main">=</span> <span class="main">0</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">from</span></span> R30_R21.strategyproofness<span class="main">(</span>1<span class="main">)</span> R30.support lottery_conditions<span class="main">[</span><span class="operator">OF</span> R30.wf<span class="main">]</span> 
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"pmf <span class="main">(</span><span class="free">sds</span> R4<span class="main">)</span> <span class="free">c</span> <span class="main">+</span> pmf <span class="main">(</span><span class="free">sds</span> R21<span class="main">)</span> <span class="free">a</span> <span class="main">≤</span> pmf <span class="main">(</span><span class="free">sds</span> R4<span class="main">)</span> <span class="free">c</span> <span class="main">+</span> pmf <span class="main">(</span><span class="free">sds</span> R30<span class="main">)</span> <span class="free">a</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">{</span></span>
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"pmf <span class="main">(</span><span class="free">sds</span> R30<span class="main">)</span> <span class="free">a</span> <span class="main">≤</span> pmf <span class="main">(</span><span class="free">sds</span> R47<span class="main">)</span> <span class="free">a</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> R47_R30.strategyproofness<span class="main">(</span>1<span class="main">)</span> R30.support R47.support 
             lottery_conditions<span class="main">[</span><span class="operator">OF</span> R4.wf<span class="main">]</span> lottery_conditions<span class="main">[</span><span class="operator">OF</span> R47.wf<span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> R4_R47.strategyproofness<span class="main">(</span>1<span class="main">)</span> R4.support R47.support
           lottery_conditions<span class="main">[</span><span class="operator">OF</span> R4.wf<span class="main">]</span> lottery_conditions<span class="main">[</span><span class="operator">OF</span> R47.wf<span class="main">]</span>
      <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"pmf <span class="main">(</span><span class="free">sds</span> R4<span class="main">)</span> <span class="free">c</span> <span class="main">≤</span> pmf <span class="main">(</span><span class="free">sds</span> R47<span class="main">)</span> <span class="free">c</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"pmf <span class="main">(</span><span class="free">sds</span> R4<span class="main">)</span> <span class="free">c</span> <span class="main">+</span> pmf <span class="main">(</span><span class="free">sds</span> R30<span class="main">)</span> <span class="free">a</span> <span class="main">≤</span> <span class="main">1</span> <span class="main">-</span> pmf <span class="main">(</span><span class="free">sds</span> R47<span class="main">)</span> <span class="free">d</span>"</span></span> 
      <span class="keyword1"><span class="command">using</span></span> lottery_conditions<span class="main">[</span><span class="operator">OF</span> R47.wf<span class="main">]</span> R47.support <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">}</span></span>
  <span class="keyword1"><span class="command">finally</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"pmf <span class="main">(</span><span class="free">sds</span> R4<span class="main">)</span> <span class="free">c</span> <span class="main">+</span> pmf <span class="main">(</span><span class="free">sds</span> R14<span class="main">)</span> <span class="free">a</span> <span class="main">≤</span> <span class="main">1</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> lottery_conditions<span class="main">[</span><span class="operator">OF</span> R47.wf<span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">del</span><span class="main"><span class="main">:</span></span> pmf_nonneg<span class="main">)</span>
  <span class="keyword1"><span class="command">with</span></span> R4_R18.strategyproofness<span class="main">(</span>1<span class="main">)</span> lottery_conditions<span class="main">[</span><span class="operator">OF</span> R4.wf<span class="main">]</span> R4.support
    <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"pmf <span class="main">(</span><span class="free">sds</span> R4<span class="main">)</span> <span class="free">a</span> <span class="main">=</span> pmf <span class="main">(</span><span class="free">sds</span> R21<span class="main">)</span> <span class="free">a</span>"</span></span> <span class="quoted"><span class="quoted">"pmf <span class="main">(</span><span class="free">sds</span> R4<span class="main">)</span> <span class="free">b</span> <span class="main">=</span> <span class="main">0</span>"</span></span>
         <span class="quoted"><span class="quoted">"pmf <span class="main">(</span><span class="free">sds</span> R4<span class="main">)</span> <span class="free">c</span> <span class="main">=</span> <span class="main">1</span> <span class="main">-</span> pmf <span class="main">(</span><span class="free">sds</span> R4<span class="main">)</span> <span class="free">a</span>"</span></span> <span class="quoted"><span class="quoted">"pmf <span class="main">(</span><span class="free">sds</span> R4<span class="main">)</span> <span class="free">d</span> <span class="main">=</span> <span class="main">0</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">lemma</span></span> R8_d <span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"pmf <span class="main">(</span><span class="free">sds</span> R8<span class="main">)</span> <span class="free">d</span> <span class="main">=</span> <span class="main">1</span> <span class="main">-</span> pmf <span class="main">(</span><span class="free">sds</span> R8<span class="main">)</span> <span class="free">a</span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> R8_c <span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"pmf <span class="main">(</span><span class="free">sds</span> R8<span class="main">)</span> <span class="free">c</span> <span class="main">=</span> <span class="main">0</span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> R26_a <span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"pmf <span class="main">(</span><span class="free">sds</span> R26<span class="main">)</span> <span class="free">a</span> <span class="main">=</span> <span class="main">1</span> <span class="main">-</span> pmf <span class="main">(</span><span class="free">sds</span> R8<span class="main">)</span> <span class="free">a</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">from</span></span> R8_R26.strategyproofness<span class="main">(</span>2<span class="main">)</span> R8.support lottery_conditions<span class="main">[</span><span class="operator">OF</span> R8.wf<span class="main">]</span> 
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"pmf <span class="main">(</span><span class="free">sds</span> R26<span class="main">)</span> <span class="free">a</span> <span class="main">≤</span> pmf <span class="main">(</span><span class="free">sds</span> R8<span class="main">)</span> <span class="free">d</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">with</span></span> R26_R8.strategyproofness<span class="main">(</span>2<span class="main">)</span> R8.support lottery_conditions<span class="main">[</span><span class="operator">OF</span> R8.wf<span class="main">]</span> 
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"pmf <span class="main">(</span><span class="free">sds</span> R26<span class="main">)</span> <span class="free">a</span> <span class="main">=</span> pmf <span class="main">(</span><span class="free">sds</span> R8<span class="main">)</span> <span class="free">d</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">with</span></span> R8_R26.strategyproofness<span class="main">(</span>2<span class="main">)</span> R8.support lottery_conditions<span class="main">[</span><span class="operator">OF</span> R8.wf<span class="main">]</span>
    <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"pmf <span class="main">(</span><span class="free">sds</span> R8<span class="main">)</span> <span class="free">c</span> <span class="main">=</span> <span class="main">0</span>"</span></span> <span class="quoted"><span class="quoted">"pmf <span class="main">(</span><span class="free">sds</span> R8<span class="main">)</span> <span class="free">d</span> <span class="main">=</span> <span class="main">1</span> <span class="main">-</span> pmf <span class="main">(</span><span class="free">sds</span> R8<span class="main">)</span> <span class="free">a</span>"</span></span> 
         <span class="quoted"><span class="quoted">"pmf <span class="main">(</span><span class="free">sds</span> R26<span class="main">)</span> <span class="free">a</span> <span class="main">=</span> <span class="main">1</span> <span class="main">-</span> pmf <span class="main">(</span><span class="free">sds</span> R8<span class="main">)</span> <span class="free">a</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">del</span><span class="main"><span class="main">:</span></span> pmf_nonneg<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">lemma</span></span> R21_R47<span class="main">:</span> <span class="quoted"><span class="quoted">"pmf <span class="main">(</span><span class="free">sds</span> R21<span class="main">)</span> <span class="free">d</span> <span class="main">≤</span> pmf <span class="main">(</span><span class="free">sds</span> R47<span class="main">)</span> <span class="free">c</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> R4_R47.strategyproofness<span class="main">(</span>1<span class="main">)</span> R4.support R47.support
         lottery_conditions<span class="main">[</span><span class="operator">OF</span> R4.wf<span class="main">]</span> lottery_conditions<span class="main">[</span><span class="operator">OF</span> R47.wf<span class="main">]</span> 
  <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">lemma</span></span> R30 <span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"pmf <span class="main">(</span><span class="free">sds</span> R30<span class="main">)</span> <span class="free">a</span> <span class="main">=</span> pmf <span class="main">(</span><span class="free">sds</span> R47<span class="main">)</span> <span class="free">a</span>"</span></span> <span class="quoted"><span class="quoted">"pmf <span class="main">(</span><span class="free">sds</span> R30<span class="main">)</span> <span class="free">b</span> <span class="main">=</span> <span class="main">0</span>"</span></span> 
  <span class="quoted"><span class="quoted">"pmf <span class="main">(</span><span class="free">sds</span> R30<span class="main">)</span> <span class="free">c</span> <span class="main">=</span> <span class="main">0</span>"</span></span> <span class="quoted"><span class="quoted">"pmf <span class="main">(</span><span class="free">sds</span> R30<span class="main">)</span> <span class="free">d</span> <span class="main">=</span> <span class="main">1</span> <span class="main">-</span> pmf <span class="main">(</span><span class="free">sds</span> R47<span class="main">)</span> <span class="free">a</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> A<span class="main">:</span> <span class="quoted"><span class="quoted">"pmf <span class="main">(</span><span class="free">sds</span> R30<span class="main">)</span> <span class="free">a</span> <span class="main">≤</span> pmf <span class="main">(</span><span class="free">sds</span> R47<span class="main">)</span> <span class="free">a</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> R47_R30.strategyproofness<span class="main">(</span>1<span class="main">)</span> R30.support R47.support 
           lottery_conditions<span class="main">[</span><span class="operator">OF</span> R4.wf<span class="main">]</span> lottery_conditions<span class="main">[</span><span class="operator">OF</span> R47.wf<span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">with</span></span> R21_R47 R30_R21.strategyproofness<span class="main">(</span>1<span class="main">)</span> 
    lottery_conditions<span class="main">[</span><span class="operator">OF</span> R30.wf<span class="main">]</span> lottery_conditions<span class="main">[</span><span class="operator">OF</span> R47.wf<span class="main">]</span>
    <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"pmf <span class="main">(</span><span class="free">sds</span> R30<span class="main">)</span> <span class="free">a</span> <span class="main">=</span> pmf <span class="main">(</span><span class="free">sds</span> R47<span class="main">)</span> <span class="free">a</span>"</span></span> <span class="quoted"><span class="quoted">"pmf <span class="main">(</span><span class="free">sds</span> R30<span class="main">)</span> <span class="free">b</span> <span class="main">=</span> <span class="main">0</span>"</span></span> 
         <span class="quoted"><span class="quoted">"pmf <span class="main">(</span><span class="free">sds</span> R30<span class="main">)</span> <span class="free">c</span> <span class="main">=</span> <span class="main">0</span>"</span></span> <span class="quoted"><span class="quoted">"pmf <span class="main">(</span><span class="free">sds</span> R30<span class="main">)</span> <span class="free">d</span> <span class="main">=</span> <span class="main">1</span> <span class="main">-</span> pmf <span class="main">(</span><span class="free">sds</span> R47<span class="main">)</span> <span class="free">a</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> R30.support R47.support <span class="quasi_keyword">simp</span> <span class="quasi_keyword">del</span><span class="main"><span class="main">:</span></span> pmf_nonneg<span class="main">)</span> <span class="comment1">(* tricky step! *)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">lemma</span></span> R31_c_ge_one_half<span class="main">:</span> <span class="quoted"><span class="quoted">"pmf <span class="main">(</span><span class="free">sds</span> R31<span class="main">)</span> <span class="free">c</span> <span class="main">≥</span> <span class="main">1</span><span class="main">/</span><span class="numeral">2</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">from</span></span> R25.support <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"pmf <span class="main">(</span><span class="free">sds</span> R25<span class="main">)</span> <span class="free">a</span> <span class="main">≥</span> <span class="main">1</span><span class="main">/</span><span class="numeral">2</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span>
    <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"pmf <span class="main">(</span><span class="free">sds</span> R25<span class="main">)</span> <span class="free">c</span> <span class="main">=</span> <span class="main">0</span>"</span></span>
    <span class="keyword1"><span class="command">with</span></span> R25_R36.strategyproofness<span class="main">(</span>1<span class="main">)</span> lottery_conditions<span class="main">[</span><span class="operator">OF</span> R36.wf<span class="main">]</span>
       <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"pmf <span class="main">(</span><span class="free">sds</span> R25<span class="main">)</span> <span class="free">a</span> <span class="main">≥</span> <span class="main">1</span><span class="main">/</span><span class="numeral">2</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">del</span><span class="main"><span class="main">:</span></span> pmf_nonneg<span class="main">)</span>
  <span class="keyword1"><span class="command">next</span></span>
    <span class="keyword3"><span class="command">assume</span></span> <span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"pmf <span class="main">(</span><span class="free">sds</span> R25<span class="main">)</span> <span class="free">b</span> <span class="main">=</span> <span class="main">0</span>"</span></span>
    <span class="keyword1"><span class="command">from</span></span> R36_R25.strategyproofness<span class="main">(</span>1<span class="main">)</span> lottery_conditions<span class="main">[</span><span class="operator">OF</span> R25.wf<span class="main">]</span>
      <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"pmf <span class="main">(</span><span class="free">sds</span> R25<span class="main">)</span> <span class="free">c</span> <span class="main">+</span> pmf <span class="main">(</span><span class="free">sds</span> R25<span class="main">)</span> <span class="free">a</span> <span class="main">≤</span> pmf <span class="main">(</span><span class="free">sds</span> R36<span class="main">)</span> <span class="free">c</span> <span class="main">+</span> <span class="main">1</span> <span class="main">/</span> <span class="numeral">2</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">with</span></span> R25_R36.strategyproofness<span class="main">(</span>1<span class="main">)</span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"pmf <span class="main">(</span><span class="free">sds</span> R25<span class="main">)</span> <span class="free">a</span> <span class="main">≥</span> <span class="main">1</span><span class="main">/</span><span class="numeral">2</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"pmf <span class="main">(</span><span class="free">sds</span> R26<span class="main">)</span> <span class="free">a</span> <span class="main">≥</span> <span class="main">1</span><span class="main">/</span><span class="numeral">2</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> R25_R26.strategyproofness<span class="main">(</span>1<span class="main">)</span> lottery_conditions<span class="main">[</span><span class="operator">OF</span> R25.wf<span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">del</span><span class="main"><span class="main">:</span></span> pmf_nonneg<span class="main">)</span>
  <span class="keyword1"><span class="command">with</span></span> lottery_conditions<span class="main">[</span><span class="operator">OF</span> R47.wf<span class="main">]</span>
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">1</span><span class="main">/</span><span class="numeral">2</span> <span class="main">≤</span> pmf <span class="main">(</span><span class="free">sds</span> R26<span class="main">)</span> <span class="free">a</span> <span class="main">+</span> pmf <span class="main">(</span><span class="free">sds</span> R47<span class="main">)</span> <span class="free">d</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">del</span><span class="main"><span class="main">:</span></span> pmf_nonneg<span class="main">)</span>
  <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">…</span> <span class="main">=</span> <span class="main">1</span> <span class="main">-</span> pmf <span class="main">(</span><span class="free">sds</span> R8<span class="main">)</span> <span class="free">a</span> <span class="main">+</span> pmf <span class="main">(</span><span class="free">sds</span> R47<span class="main">)</span> <span class="free">d</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">from</span></span> R4_R8.strategyproofness<span class="main">(</span>1<span class="main">)</span> 
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">1</span> <span class="main">-</span> pmf <span class="main">(</span><span class="free">sds</span> R8<span class="main">)</span> <span class="free">a</span> <span class="main">≤</span> pmf <span class="main">(</span><span class="free">sds</span> R21<span class="main">)</span> <span class="free">d</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">note</span></span> R21_R47
  <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">from</span></span> R30_R41.strategyproofness<span class="main">(</span>1<span class="main">)</span> R41.support 
            lottery_conditions<span class="main">[</span><span class="operator">OF</span> R41.wf<span class="main">]</span> lottery_conditions<span class="main">[</span><span class="operator">OF</span> R47.wf<span class="main">]</span> 
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"pmf <span class="main">(</span><span class="free">sds</span> R47<span class="main">)</span> <span class="free">c</span> <span class="main">+</span> pmf <span class="main">(</span><span class="free">sds</span> R47<span class="main">)</span> <span class="free">d</span> <span class="main">≤</span> pmf <span class="main">(</span><span class="free">sds</span> R41<span class="main">)</span> <span class="free">d</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">del</span><span class="main"><span class="main">:</span></span> pmf_nonneg<span class="main">)</span>
  <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">from</span></span> R41_R31.strategyproofness<span class="main">(</span>1<span class="main">)</span> R41.support lottery_conditions<span class="main">[</span><span class="operator">OF</span> R31.wf<span class="main">]</span> 
       lottery_conditions<span class="main">[</span><span class="operator">OF</span> R41.wf<span class="main">]</span>  
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"pmf <span class="main">(</span><span class="free">sds</span> R41<span class="main">)</span> <span class="free">d</span> <span class="main">≤</span> pmf <span class="main">(</span><span class="free">sds</span> R31<span class="main">)</span> <span class="free">c</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">finally</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"pmf <span class="main">(</span><span class="free">sds</span> R31<span class="main">)</span> <span class="free">c</span> <span class="main">≥</span> <span class="main">1</span><span class="main">/</span><span class="numeral">2</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">lemma</span></span> R31<span class="main">:</span> <span class="quoted"><span class="quoted">"pmf <span class="main">(</span><span class="free">sds</span> R31<span class="main">)</span> <span class="free">a</span> <span class="main">=</span> <span class="main">0</span>"</span></span> <span class="quoted"><span class="quoted">"pmf <span class="main">(</span><span class="free">sds</span> R31<span class="main">)</span> <span class="free">c</span> <span class="main">=</span> <span class="main">1</span><span class="main">/</span><span class="numeral">2</span>"</span></span> <span class="quoted"><span class="quoted">"pmf <span class="main">(</span><span class="free">sds</span> R31<span class="main">)</span> <span class="free">b</span> <span class="main">+</span> pmf <span class="main">(</span><span class="free">sds</span> R31<span class="main">)</span> <span class="free">d</span> <span class="main">=</span> <span class="main">1</span><span class="main">/</span><span class="numeral">2</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">from</span></span> R2_R38.strategyproofness<span class="main">(</span>1<span class="main">)</span> lottery_conditions<span class="main">[</span><span class="operator">OF</span> R38.wf<span class="main">]</span> 
    <span class="keyword1"><span class="command">have</span></span> A<span class="main">:</span> <span class="quoted"><span class="quoted">"pmf <span class="main">(</span><span class="free">sds</span> R38<span class="main">)</span> <span class="free">b</span> <span class="main">+</span> pmf <span class="main">(</span><span class="free">sds</span> R38<span class="main">)</span> <span class="free">d</span> <span class="main">≥</span> <span class="main">1</span><span class="main">/</span><span class="numeral">2</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">with</span></span> R31_c_ge_one_half R31_R38.strategyproofness<span class="main">(</span>1<span class="main">)</span> 
        lottery_conditions<span class="main">[</span><span class="operator">OF</span> R31.wf<span class="main">]</span> lottery_conditions<span class="main">[</span><span class="operator">OF</span> R38.wf<span class="main">]</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"pmf <span class="main">(</span><span class="free">sds</span> R38<span class="main">)</span> <span class="free">b</span> <span class="main">+</span> pmf <span class="main">(</span><span class="free">sds</span> R38<span class="main">)</span> <span class="free">d</span> <span class="main">=</span> pmf <span class="main">(</span><span class="free">sds</span> R31<span class="main">)</span> <span class="free">d</span> <span class="main">+</span> pmf <span class="main">(</span><span class="free">sds</span> R31<span class="main">)</span> <span class="free">b</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">with</span></span> R31_c_ge_one_half A lottery_conditions<span class="main">[</span><span class="operator">OF</span> R31.wf<span class="main">]</span> lottery_conditions<span class="main">[</span><span class="operator">OF</span> R38.wf<span class="main">]</span>
    <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"pmf <span class="main">(</span><span class="free">sds</span> R31<span class="main">)</span> <span class="free">a</span> <span class="main">=</span> <span class="main">0</span>"</span></span> <span class="quoted"><span class="quoted">"pmf <span class="main">(</span><span class="free">sds</span> R31<span class="main">)</span> <span class="free">c</span> <span class="main">=</span> <span class="main">1</span><span class="main">/</span><span class="numeral">2</span>"</span></span> <span class="quoted"><span class="quoted">"pmf <span class="main">(</span><span class="free">sds</span> R31<span class="main">)</span> <span class="free">b</span> <span class="main">+</span> pmf <span class="main">(</span><span class="free">sds</span> R31<span class="main">)</span> <span class="free">d</span> <span class="main">=</span> <span class="main">1</span><span class="main">/</span><span class="numeral">2</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">linarith</span><span class="main"><span class="keyword3">+</span></span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">lemma</span></span> absurd<span class="main">:</span> <span class="quoted">False</span>
  <span class="keyword1"><span class="command">using</span></span> R31 R45_R31.strategyproofness<span class="main">(</span>2<span class="main">)</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>


<span class="comment1">(* TODO (Re-)move *)</span>
<span class="comment1">(* This is just to output a list of all the Strategy-Proofness conditions used in the proof *)</span>
<span class="comment1">(*
ML_val ‹
let
val thms = @{thms
R1_R2.strategyproofness(1)
R1_R19.strategyproofness(1)
R2_R1.strategyproofness(1)
R2_R38.strategyproofness(1)
R4_R8.strategyproofness(1)
R4_R18.strategyproofness(1)
R4_R47.strategyproofness(1)
R5_R7.strategyproofness(1)
R5_R10.strategyproofness(1)
R5_R17.strategyproofness(1)
R6_R19.strategyproofness(1)
R6_R42.strategyproofness(1)
R7_R43.strategyproofness(1)
R8_R26.strategyproofness(2)
R9_R18.strategyproofness(1)
R9_R35.strategyproofness(1)
R9_R40.strategyproofness(1)
R10_R12.strategyproofness(1)
R10_R15.strategyproofness(1)
R10_R19.strategyproofness(1)
R10_R36.strategyproofness(1)
R12_R10.strategyproofness(1)
R12_R16.strategyproofness(1)
R12_R44.strategyproofness(1)
R13_R15.strategyproofness(1)
R13_R27.strategyproofness(1)
R14_R9.strategyproofness(1)
R14_R16.strategyproofness(1)
R14_R34.strategyproofness(1)
R15_R5.strategyproofness(1)
R15_R7.strategyproofness(1)
R15_R10.strategyproofness(1)
R15_R13.strategyproofness(1)
R17_R3.strategyproofness(1)
R17_R5.strategyproofness(1)
R17_R7.strategyproofness(1)
R17_R11.strategyproofness(1)
R18_R9.strategyproofness(1)
R19_R1.strategyproofness(1)
R19_R10.strategyproofness(1)
R19_R27.strategyproofness(1)
R20_R21.strategyproofness(1)
R21_R35.strategyproofness(1)
R22_R29.strategyproofness(1)
R22_R32.strategyproofness(1)
R23_R12.strategyproofness(1)
R23_R18.strategyproofness(1)
R23_R19.strategyproofness(1)
R24_R34.strategyproofness(1)
R25_R26.strategyproofness(1)
R25_R36.strategyproofness(1)
R26_R8.strategyproofness(2)
R27_R13.strategyproofness(1)
R27_R19.strategyproofness(1)
R28_R32.strategyproofness(1)
R28_R39.strategyproofness(1)
R29_R39.strategyproofness(1)
R30_R21.strategyproofness(1)
R30_R41.strategyproofness(1)
R31_R38.strategyproofness(1)
R32_R22.strategyproofness(1)
R32_R28.strategyproofness(1)
R33_R5.strategyproofness(1)
R33_R22.strategyproofness(1)
R34_R24.strategyproofness(1)
R35_R9.strategyproofness(1)
R35_R21.strategyproofness(1)
R36_R10.strategyproofness(1)
R36_R25.strategyproofness(1)
R36_R39.strategyproofness(1)
R37_R42.strategyproofness(1)
R37_R42.strategyproofness(2)
R39_R2.strategyproofness(1)
R39_R29.strategyproofness(1)
R39_R36.strategyproofness(1)
R41_R31.strategyproofness(1)
R42_R3.strategyproofness(1)
R42_R11.strategyproofness(1)
R42_R24.strategyproofness(1)
R44_R12.strategyproofness(1)
R44_R40.strategyproofness(1)
R45_R31.strategyproofness(2)
R46_R20.strategyproofness(1)
R46_R37.strategyproofness(1)
R47_R30.strategyproofness(1)
};
in
 thms
 |&gt; map (Pretty.quote o Pretty.str o Pretty.unformatted_string_of o Syntax.pretty_term @{context} o Thm.prop_of)
 |&gt; Pretty.list "[" "]"
 |&gt; (fn x =&gt; Pretty.block [Pretty.str "thms = ", x])
 |&gt; Pretty.string_of
 |&gt; writeln
end
›*)</span>

<span class="keyword2"><span class="keyword">end</span></span>


<span class="keyword1"><span class="command">subsection</span></span> <span class="quoted"><span class="plain_text">‹Lifting to more than 4 agents and alternatives›</span></span>

<span class="comment1">(* TODO: Move? *)</span>
<span class="keyword1"><span class="command">lemma</span></span> finite_list'<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"finite <span class="free">A</span>"</span></span>
  <span class="keyword2"><span class="keyword">obtains</span></span> <span class="free">xs</span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="free">A</span> <span class="main">=</span> set <span class="free">xs</span>"</span></span> <span class="quoted"><span class="quoted">"distinct <span class="free">xs</span>"</span></span> <span class="quoted"><span class="quoted">"length <span class="free">xs</span> <span class="main">=</span> card <span class="free">A</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">from</span></span> assms <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">xs</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"set <span class="skolem">xs</span> <span class="main">=</span> <span class="free">A</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> finite_list <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> distinct_card<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="quoted">"remdups <span class="skolem">xs</span>"</span></span><span class="main">]</span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">intro</span> that<span class="main"><span class="main">[</span></span><span class="operator">of</span> <span class="quoted"><span class="quoted"><span class="quoted"><span class="quoted">"remdups <span class="skolem"><span class="skolem"><span class="skolem">xs</span></span></span>"</span></span></span></span><span class="main"><span class="main">]</span></span><span class="main">)</span> <span class="operator">simp_all</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">lemma</span></span> finite_list_subset<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"finite <span class="free">A</span>"</span></span> <span class="quoted"><span class="quoted">"card <span class="free">A</span> <span class="main">≥</span> <span class="free">n</span>"</span></span>
  <span class="keyword2"><span class="keyword">obtains</span></span> <span class="free">xs</span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"set <span class="free">xs</span> <span class="main">⊆</span> <span class="free">A</span>"</span></span> <span class="quoted"><span class="quoted">"distinct <span class="free">xs</span>"</span></span> <span class="quoted"><span class="quoted">"length <span class="free">xs</span> <span class="main">=</span> <span class="free">n</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">xs</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="free">A</span> <span class="main">=</span> set <span class="skolem">xs</span>"</span></span> <span class="quoted"><span class="quoted">"distinct <span class="skolem">xs</span>"</span></span> <span class="quoted"><span class="quoted">"length <span class="skolem">xs</span> <span class="main">=</span> card <span class="free">A</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> finite_list'<span class="main">[</span><span class="operator">OF</span> assms<span class="main"><span class="main">(</span></span>1<span class="main"><span class="main">)</span></span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">with</span></span> assms <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">intro</span> that<span class="main"><span class="main">[</span></span><span class="operator">of</span> <span class="quoted"><span class="quoted"><span class="quoted"><span class="quoted">"take <span class="free"><span class="free"><span class="free">n</span></span></span> <span class="skolem"><span class="skolem"><span class="skolem">xs</span></span></span>"</span></span></span></span><span class="main"><span class="main">]</span></span><span class="main">)</span> <span class="main">(</span><span class="operator">simp_all</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> set_take_subset<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">lemma</span></span> card_ge_4E<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"finite <span class="free">A</span>"</span></span> <span class="quoted"><span class="quoted">"card <span class="free">A</span> <span class="main">≥</span> <span class="numeral">4</span>"</span></span>
  <span class="keyword2"><span class="keyword">obtains</span></span> <span class="free">a</span> <span class="free">b</span> <span class="free">c</span> <span class="free">d</span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"distinct <span class="main">[</span><span class="free">a</span><span class="main">,</span><span class="free">b</span><span class="main">,</span><span class="free">c</span><span class="main">,</span><span class="free">d</span><span class="main">]</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="main">{</span><span class="free">a</span><span class="main">,</span><span class="free">b</span><span class="main">,</span><span class="free">c</span><span class="main">,</span><span class="free">d</span><span class="main">}</span> <span class="main">⊆</span> <span class="free">A</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">from</span></span> finite_list_subset<span class="main">[</span><span class="operator">OF</span> assms<span class="main">]</span> <span class="keyword1"><span class="command"><span class="improper"><span class="command">guess</span></span></span></span> xs <span class="keyword1"><span class="command">.</span></span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command"><span class="improper">then</span></span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">a</span></span> <span class="skolem"><span class="skolem">b</span></span> <span class="skolem"><span class="skolem">c</span></span> <span class="skolem"><span class="skolem">d</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">xs</span> <span class="main">=</span> <span class="main">[</span><span class="skolem">a</span><span class="main">,</span> <span class="skolem">b</span><span class="main">,</span> <span class="skolem">c</span><span class="main">,</span> <span class="skolem">d</span><span class="main">]</span>"</span></span> 
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> eval_nat_numeral length_Suc_conv<span class="main">)</span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">intro</span> that<span class="main"><span class="main">[</span></span><span class="operator">of</span> <span class="quoted"><span class="skolem"><span class="quoted"><span class="skolem"><span class="quoted"><span class="skolem">a</span></span></span></span></span></span> <span class="quoted"><span class="skolem"><span class="quoted"><span class="skolem"><span class="quoted"><span class="skolem">b</span></span></span></span></span></span> <span class="quoted"><span class="skolem"><span class="quoted"><span class="skolem"><span class="quoted"><span class="skolem">c</span></span></span></span></span></span> <span class="quoted"><span class="skolem"><span class="quoted"><span class="skolem"><span class="quoted"><span class="skolem">d</span></span></span></span></span></span><span class="main"><span class="main">]</span></span><span class="main">)</span> <span class="operator">simp_all</span>
<span class="keyword1"><span class="command">qed</span></span>


<span class="keyword1"><span class="command">context</span></span> sds_impossibility
<span class="keyword2"><span class="keyword">begin</span></span>

<span class="keyword1"><span class="command">lemma</span></span> absurd<span class="main">:</span> <span class="quoted">False</span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">from</span></span> card_ge_4E<span class="main">[</span><span class="operator">OF</span> finite_agents agents_ge_4<span class="main">]</span> <span class="keyword1"><span class="command"><span class="improper"><span class="command">guess</span></span></span></span> A1 A2 A3 A4 <span class="keyword1"><span class="command">.</span></span>
  <span class="keyword1"><span class="command">note</span></span> agents <span class="main">=</span> this
  <span class="keyword1"><span class="command">from</span></span> card_ge_4E<span class="main">[</span><span class="operator">OF</span> finite_alts alts_ge_4<span class="main">]</span> <span class="keyword1"><span class="command"><span class="improper"><span class="command">guess</span></span></span></span> a b c d <span class="keyword1"><span class="command">.</span></span>
  <span class="keyword1"><span class="command">note</span></span> alts <span class="main">=</span> this
  <span class="keyword3"><span class="command">define</span></span> <span class="skolem"><span class="skolem">agents'</span></span> <span class="skolem"><span class="skolem">alts'</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">agents'</span> <span class="main">=</span> <span class="main">{</span><span class="skolem">A1</span><span class="main">,</span><span class="skolem">A2</span><span class="main">,</span><span class="skolem">A3</span><span class="main">,</span><span class="skolem">A4</span><span class="main">}</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">alts'</span> <span class="main">=</span> <span class="main">{</span><span class="skolem">a</span><span class="main">,</span><span class="skolem">b</span><span class="main">,</span><span class="skolem">c</span><span class="main">,</span><span class="skolem">d</span><span class="main">}</span>"</span></span>
  <span class="keyword1"><span class="command">from</span></span> agents alts 
    <span class="keyword1"><span class="command">interpret</span></span> sds_lowering_anonymous_neutral_sdeff_stratproof <span class="quoted"><span class="free">agents</span></span> <span class="quoted"><span class="free">alts</span></span> <span class="quoted"><span class="free">sds</span></span> <span class="quoted"><span class="skolem">agents'</span></span> <span class="quoted"><span class="skolem">alts'</span></span>
    <span class="keyword1"><span class="command">unfolding</span></span> agents'_def alts'_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">unfold_locales</span> <span class="operator">simp_all</span>
  <span class="keyword1"><span class="command">from</span></span> agents alts 
    <span class="keyword1"><span class="command">interpret</span></span> sds_impossibility_4_4 <span class="quoted"><span class="skolem">agents'</span></span> <span class="quoted"><span class="skolem">alts'</span></span> <span class="quoted">lowered</span> <span class="quoted"><span class="skolem">A1</span></span> <span class="quoted"><span class="skolem">A2</span></span> <span class="quoted"><span class="skolem">A3</span></span> <span class="quoted"><span class="skolem">A4</span></span> <span class="quoted"><span class="skolem">a</span></span> <span class="quoted"><span class="skolem">b</span></span> <span class="quoted"><span class="skolem">c</span></span> <span class="quoted"><span class="skolem">d</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">unfold_locales</span> <span class="main">(</span><span class="operator">simp_all</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> agents'_def alts'_def<span class="main">)</span>
  <span class="keyword1"><span class="command">from</span></span> absurd <span class="keyword3"><span class="command">show</span></span> <span class="quoted">False</span> <span class="keyword1"><span class="command">.</span></span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword2"><span class="keyword">end</span></span>

<span class="keyword2"><span class="keyword">end</span></span>
</pre>
</div>
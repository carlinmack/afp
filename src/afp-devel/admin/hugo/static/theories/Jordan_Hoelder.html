<div id="SndIsomorphismGrp">
<div class="head">
<h1>Theory SndIsomorphismGrp</h1>
</div>
<pre class="source"><span class="comment1">(*  Title:      The Second Isomorphism Theorem for Groups
    Author:     Jakob von Raumer, Karlsruhe Institute of Technology
    Maintainer: Jakob von Raumer &lt;jakob.raumer@student.kit.edu&gt;
*)</span>

<span class="keyword1"><span class="command">theory</span></span> SndIsomorphismGrp
<span class="keyword2"><span class="keyword">imports</span></span>
    <span class="quoted">"<a href="../../HOL/HOL-Algebra/Coset.html">HOL-Algebra.Coset</a>"</span>
    <a href="../Secondary_Sylow/SubgroupConjugation.html">Secondary_Sylow.SubgroupConjugation</a>
<span class="keyword2"><span class="keyword">begin</span></span>

<span class="keyword1"><span class="command">section</span></span> <span class="quoted"><span class="plain_text">â€¹The Second Isomorphism Theorem for Groupsâ€º</span></span>

<span class="keyword1"><span class="command">subsection</span></span> <span class="quoted"><span class="plain_text">â€¹Preliminariesâ€º</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> group<span class="main">)</span> triv_subgroup<span class="main">:</span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"subgroup <span class="main">{</span><span class="main">ğŸ­</span><span class="main">}</span> <span class="free">G</span>"</span></span>
<span class="keyword1"><span class="command">unfolding</span></span> subgroup_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> group<span class="main">)</span> triv_normal_subgroup<span class="main">:</span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">{</span><span class="main">ğŸ­</span><span class="main">}</span> <span class="main">âŠ²</span> <span class="free">G</span>"</span></span>
<span class="keyword1"><span class="command">unfolding</span></span> normal_def normal_axioms_def l_coset_def r_coset_def
<span class="keyword1"><span class="command">using</span></span> is_group triv_subgroup <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> group<span class="main">)</span> normal_restrict_supergroup<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> SsubG<span class="main">:</span><span class="quoted"><span class="quoted">"subgroup <span class="free">S</span> <span class="free">G</span>"</span></span>
  <span class="keyword2"><span class="keyword">assumes</span></span> Nnormal<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="free">N</span> <span class="main">âŠ²</span> <span class="free">G</span>"</span></span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">N</span> <span class="main">âŠ†</span> <span class="free">S</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">N</span> <span class="main">âŠ²</span> <span class="main">(</span><span class="free">G</span><span class="main">â¦‡</span>carrier <span class="main">:=</span> <span class="free">S</span><span class="main">â¦ˆ</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">interpret</span></span> Sgrp<span class="main">:</span> group <span class="quoted"><span class="quoted">"<span class="free">G</span><span class="main">â¦‡</span>carrier <span class="main">:=</span> <span class="free">S</span><span class="main">â¦ˆ</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> SsubG <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> subgroup_imp_group<span class="main">)</span>
  <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
  <span class="keyword1"><span class="command">proof</span></span><span class="main">(</span><span class="operator">rule</span> Sgrp.normalI<span class="main">)</span>
    <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"subgroup <span class="free">N</span> <span class="main">(</span><span class="free">G</span><span class="main">â¦‡</span>carrier <span class="main">:=</span> <span class="free">S</span><span class="main">â¦ˆ</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms is_group <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> subgroup.subgroup_of_subset normal_inv_iff<span class="main">)</span>
  <span class="keyword1"><span class="command">next</span></span>
    <span class="keyword1"><span class="command">from</span></span> SsubG <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">S</span> <span class="main">âŠ†</span> carrier <span class="free">G</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> subgroup.subset<span class="main">)</span>
    <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"<span class="main">âˆ€</span><span class="bound">x</span><span class="main">âˆˆ</span>carrier <span class="main">(</span><span class="free">G</span><span class="main">â¦‡</span>carrier <span class="main">:=</span> <span class="free">S</span><span class="main">â¦ˆ</span><span class="main">)</span><span class="main">.</span> <span class="free">N</span> <span class="main">#&gt;</span><span class="hidden">â‡˜</span><sub><span class="free">G</span><span class="main">â¦‡</span>carrier <span class="main">:=</span> <span class="free">S</span><span class="main">â¦ˆ</span></sub><span class="hidden">â‡™</span> <span class="bound">x</span> <span class="main">=</span> <span class="bound">x</span> <span class="main">&lt;#</span><span class="hidden">â‡˜</span><sub><span class="free">G</span><span class="main">â¦‡</span>carrier <span class="main">:=</span> <span class="free">S</span><span class="main">â¦ˆ</span></sub><span class="hidden">â‡™</span> <span class="free">N</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> Nnormal <span class="keyword1"><span class="command">unfolding</span></span> normal_def normal_axioms_def l_coset_def r_coset_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">fastforce</span>
  <span class="keyword1"><span class="command">qed</span></span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">â€¹As this is maybe the best place this fits in: Factorizing by the trivial subgroup
is an isomorphism.â€º</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> group<span class="main">)</span> trivial_factor_iso<span class="main">:</span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"the_elem <span class="main">âˆˆ</span> iso <span class="main">(</span><span class="free">G</span> <span class="keyword1">Mod</span> <span class="main">{</span><span class="main">ğŸ­</span><span class="main">}</span><span class="main">)</span> <span class="free">G</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"group_hom <span class="free">G</span> <span class="free">G</span> <span class="main">(</span><span class="main">Î»</span><span class="bound">x</span><span class="main">.</span> <span class="bound">x</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> group_hom_def group_hom_axioms_def hom_def <span class="keyword1"><span class="command">using</span></span> is_group <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">Î»</span><span class="bound">x</span><span class="main">.</span> <span class="bound">x</span><span class="main">)</span> <span class="main">`</span> carrier <span class="free">G</span> <span class="main">=</span> carrier <span class="free">G</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"kernel <span class="free">G</span> <span class="free">G</span> <span class="main">(</span><span class="main">Î»</span><span class="bound">x</span><span class="main">.</span> <span class="bound">x</span><span class="main">)</span> <span class="main">=</span> <span class="main">{</span><span class="main">ğŸ­</span><span class="main">}</span>"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> kernel_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> group_hom.FactGroup_iso_set <span class="keyword1"><span class="command">by</span></span> <span class="operator">force</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">â€¹And the dual theorem to the previous one: Factorizing by the group itself gives the trivial groupâ€º</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> group<span class="main">)</span> self_factor_iso<span class="main">:</span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">Î»</span><span class="bound">X</span><span class="main">.</span> the_elem <span class="main">(</span><span class="main">(</span><span class="main">Î»</span><span class="bound">x</span><span class="main">.</span> <span class="main">ğŸ­</span><span class="main">)</span> <span class="main">`</span> <span class="bound">X</span><span class="main">)</span><span class="main">)</span> <span class="main">âˆˆ</span> iso <span class="main">(</span><span class="free">G</span> <span class="keyword1">Mod</span> <span class="main">(</span>carrier <span class="free">G</span><span class="main">)</span><span class="main">)</span> <span class="main">(</span><span class="free">G</span><span class="main">â¦‡</span> carrier <span class="main">:=</span> <span class="main">{</span><span class="main">ğŸ­</span><span class="main">}</span> <span class="main">â¦ˆ</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"group <span class="main">(</span><span class="free">G</span><span class="main">â¦‡</span>carrier <span class="main">:=</span> <span class="main">{</span><span class="main">ğŸ­</span><span class="main">}</span><span class="main">â¦ˆ</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> subgroup_imp_group triv_subgroup<span class="main">)</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"group_hom <span class="free">G</span> <span class="main">(</span><span class="free">G</span><span class="main">â¦‡</span>carrier <span class="main">:=</span> <span class="main">{</span><span class="main">ğŸ­</span><span class="main">}</span><span class="main">â¦ˆ</span><span class="main">)</span> <span class="main">(</span><span class="main">Î»</span><span class="bound">x</span><span class="main">.</span> <span class="main">ğŸ­</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> group_hom_def group_hom_axioms_def hom_def <span class="keyword1"><span class="command">using</span></span> is_group <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">Î»</span><span class="bound">x</span><span class="main">.</span> <span class="main">ğŸ­</span><span class="main">)</span> <span class="main">`</span> carrier <span class="free">G</span> <span class="main">=</span> carrier <span class="main">(</span><span class="free">G</span><span class="main">â¦‡</span>carrier <span class="main">:=</span> <span class="main">{</span><span class="main">ğŸ­</span><span class="main">}</span><span class="main">â¦ˆ</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"kernel <span class="free">G</span> <span class="main">(</span><span class="free">G</span><span class="main">â¦‡</span>carrier <span class="main">:=</span> <span class="main">{</span><span class="main">ğŸ­</span><span class="main">}</span><span class="main">â¦ˆ</span><span class="main">)</span> <span class="main">(</span><span class="main">Î»</span><span class="bound">x</span><span class="main">.</span> <span class="main">ğŸ­</span><span class="main">)</span> <span class="main">=</span> carrier <span class="free">G</span>"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> kernel_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> group_hom.FactGroup_iso_set <span class="keyword1"><span class="command">by</span></span> <span class="operator">force</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">â€¹This theory provides a proof of the second isomorphism theorems for groups. 
The theorems consist of several facts about normal subgroups.â€º</span></span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">â€¹The first lemma states that whenever we have a subgroup <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">term</span></span> <span class="quoted"><span class="free"><span class="quoted"><span class="free">S</span></span></span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span> and
a normal subgroup <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">term</span></span> <span class="quoted"><span class="free"><span class="quoted"><span class="free">H</span></span></span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span> of a group <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">term</span></span> <span class="quoted"><span class="free"><span class="quoted"><span class="free">G</span></span></span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span>, their intersection is normal
in <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">term</span></span> <span class="quoted"><span class="free"><span class="quoted"><span class="free">G</span></span></span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span>â€º</span></span>

<span class="keyword1"><span class="command">locale</span></span> second_isomorphism_grp <span class="main">=</span> normal <span class="main">+</span>
  <span class="keyword2"><span class="keyword">fixes</span></span> <span class="free">S</span><span class="main">::</span><span class="quoted"><span class="quoted">"<span class="tfree">'a</span> set"</span></span>
  <span class="keyword2"><span class="keyword">assumes</span></span> subgrpS<span class="main">:</span><span class="quoted"><span class="quoted">"subgroup <span class="free">S</span> <span class="free">G</span>"</span></span>

<span class="keyword1"><span class="command">context</span></span> second_isomorphism_grp
<span class="keyword2"><span class="keyword">begin</span></span>

<span class="keyword1"><span class="command">interpretation</span></span> groupS<span class="main">:</span> group <span class="quoted"><span class="quoted">"<span class="free">G</span><span class="main">â¦‡</span>carrier <span class="main">:=</span> <span class="free">S</span><span class="main">â¦ˆ</span>"</span></span>
<span class="keyword1"><span class="command">using</span></span> subgrpS <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> subgroup_imp_group<span class="main">)</span>

<span class="keyword1" id="SndIsomorphismGrp-normal_subgrp_intersection_normal"><span class="command">lemma</span></span> normal_subgrp_intersection_normal<span class="main">:</span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">S</span> <span class="main">âˆ©</span> <span class="free">H</span> <span class="main">âŠ²</span> <span class="main">(</span><span class="free">G</span><span class="main">â¦‡</span>carrier <span class="main">:=</span> <span class="free">S</span><span class="main">â¦ˆ</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span><span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> groupS.normal_inv_iff<span class="main">)</span>
  <span class="keyword1"><span class="command">from</span></span> subgrpS is_subgroup <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">â‹€</span><span class="bound">x</span><span class="main">.</span> <span class="bound">x</span> <span class="main">âˆˆ</span> <span class="main">{</span><span class="free">S</span><span class="main">,</span> <span class="free">H</span><span class="main">}</span> <span class="main">âŸ¹</span> subgroup <span class="bound">x</span> <span class="free">G</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"subgroup <span class="main">(</span><span class="main">â‹‚</span> <span class="main">{</span><span class="free">S</span><span class="main">,</span> <span class="free">H</span><span class="main">}</span><span class="main">)</span> <span class="free">G</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> subgroups_Inter <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"subgroup <span class="main">(</span><span class="free">S</span> <span class="main">âˆ©</span> <span class="free">H</span><span class="main">)</span> <span class="free">G</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">S</span> <span class="main">âˆ©</span> <span class="free">H</span> <span class="main">âŠ†</span> <span class="free">S</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"subgroup <span class="main">(</span><span class="free">S</span> <span class="main">âˆ©</span> <span class="free">H</span><span class="main">)</span> <span class="main">(</span><span class="free">G</span><span class="main">â¦‡</span>carrier <span class="main">:=</span> <span class="free">S</span><span class="main">â¦ˆ</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> is_group subgroup.subgroup_of_subset subgrpS <span class="keyword1"><span class="command">by</span></span> <span class="operator">metis</span>
<span class="keyword1"><span class="command">next</span></span>
  <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">g</span> <span class="skolem">h</span>
  <span class="keyword3"><span class="command">assume</span></span> g<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">g</span> <span class="main">âˆˆ</span> <span class="free">S</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> hH<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">h</span> <span class="main">âˆˆ</span> <span class="free">H</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> hS<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">h</span> <span class="main">âˆˆ</span> <span class="free">S</span>"</span></span> <span class="keyword1"><span class="command">{</span></span>
    <span class="keyword1"><span class="command">from</span></span> g hH subgrpS <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">g</span> <span class="main">âŠ—</span> <span class="skolem">h</span> <span class="main">âŠ—</span> <span class="keyword1">inv</span><span class="hidden">â‡˜</span><sub><span class="free">G</span><span class="main">â¦‡</span>carrier <span class="main">:=</span> <span class="free">S</span><span class="main">â¦ˆ</span></sub><span class="hidden">â‡™</span> <span class="skolem">g</span> <span class="main">âˆˆ</span> <span class="free">H</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> inv_op_closed2 subgroup.mem_carrier m_inv_consistent<span class="main">)</span>
  <span class="keyword1"><span class="command">}</span></span> <span class="keyword1"><span class="command">{</span></span>
    <span class="keyword1"><span class="command">from</span></span> g hS subgrpS <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">g</span> <span class="main">âŠ—</span> <span class="skolem">h</span> <span class="main">âŠ—</span> <span class="keyword1">inv</span><span class="hidden">â‡˜</span><sub><span class="free">G</span><span class="main">â¦‡</span>carrier <span class="main">:=</span> <span class="free">S</span><span class="main">â¦ˆ</span></sub><span class="hidden">â‡™</span> <span class="skolem">g</span> <span class="main">âˆˆ</span> <span class="free">S</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> subgroup.m_closed subgroup.m_inv_closed m_inv_consistent<span class="main">)</span>
  <span class="keyword1"><span class="command">}</span></span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="SndIsomorphismGrp-normal_set_mult_subgroup"><span class="command">lemma</span></span> normal_set_mult_subgroup<span class="main">:</span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"subgroup <span class="main">(</span><span class="free">H</span> <span class="main">&lt;#&gt;</span> <span class="free">S</span><span class="main">)</span> <span class="free">G</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span><span class="main">(</span><span class="operator">rule</span> subgroupI<span class="main">)</span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="free">H</span> <span class="main">&lt;#&gt;</span> <span class="free">S</span> <span class="main">âŠ†</span> carrier <span class="free">G</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> setmult_subset_G subgroup.subset subgrpS subset<span class="main">)</span>
<span class="keyword1"><span class="command">next</span></span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">ğŸ­</span> <span class="main">âˆˆ</span> <span class="free">H</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="main">ğŸ­</span> <span class="main">âˆˆ</span> <span class="free">S</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> is_subgroup subgrpS subgroup.one_closed <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="main">ğŸ­</span> <span class="main">âŠ—</span> <span class="main">ğŸ­</span> <span class="main">âˆˆ</span> <span class="free">H</span> <span class="main">&lt;#&gt;</span> <span class="free">S</span>"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> set_mult_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"<span class="free">H</span> <span class="main">&lt;#&gt;</span> <span class="free">S</span> <span class="main">â‰ </span> <span class="main">{}</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">next</span></span>
  <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">g</span>
  <span class="keyword3"><span class="command">assume</span></span> g<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">g</span> <span class="main">âˆˆ</span> <span class="free">H</span> <span class="main">&lt;#&gt;</span> <span class="free">S</span>"</span></span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">h</span></span> <span class="skolem"><span class="skolem">s</span></span> <span class="keyword2"><span class="keyword">where</span></span> h<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">h</span> <span class="main">âˆˆ</span> <span class="free">H</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> s<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">s</span> <span class="main">âˆˆ</span> <span class="free">S</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> ghs<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">g</span> <span class="main">=</span> <span class="skolem">h</span> <span class="main">âŠ—</span> <span class="skolem">s</span>"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> set_mult_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">s</span> <span class="main">âˆˆ</span> carrier <span class="free">G</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> subgroup.mem_carrier subgrpS<span class="main">)</span>
  <span class="keyword1"><span class="command">with</span></span> h ghs <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">h'</span></span> <span class="keyword2"><span class="keyword">where</span></span> h'<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">h'</span> <span class="main">âˆˆ</span> <span class="free">H</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">g</span> <span class="main">=</span> <span class="skolem">s</span> <span class="main">âŠ—</span> <span class="skolem">h'</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> coset_eq <span class="keyword1"><span class="command">unfolding</span></span> r_coset_def l_coset_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">with</span></span> s <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">inv</span> <span class="skolem">g</span> <span class="main">=</span> <span class="main">(</span><span class="keyword1">inv</span> <span class="skolem">h'</span><span class="main">)</span> <span class="main">âŠ—</span> <span class="main">(</span><span class="keyword1">inv</span> <span class="skolem">s</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> inv_mult_group mem_carrier subgroup.mem_carrier subgrpS<span class="main">)</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> h' s subgrpS <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">inv</span> <span class="skolem">h'</span> <span class="main">âˆˆ</span> <span class="free">H</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">inv</span> <span class="skolem">s</span> <span class="main">âˆˆ</span> <span class="free">S</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> subgroup.m_inv_closed m_inv_closed <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">inv</span> <span class="skolem">g</span> <span class="main">âˆˆ</span> <span class="free">H</span> <span class="main">&lt;#&gt;</span> <span class="free">S</span>"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> set_mult_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">next</span></span>
  <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">g</span> <span class="skolem">g'</span>
  <span class="keyword3"><span class="command">assume</span></span> g<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">g</span> <span class="main">âˆˆ</span> <span class="free">H</span> <span class="main">&lt;#&gt;</span> <span class="free">S</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> h<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">g'</span> <span class="main">âˆˆ</span> <span class="free">H</span> <span class="main">&lt;#&gt;</span> <span class="free">S</span>"</span></span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">h</span></span> <span class="skolem"><span class="skolem">h'</span></span> <span class="skolem"><span class="skolem">s</span></span> <span class="skolem"><span class="skolem">s'</span></span> <span class="keyword2"><span class="keyword">where</span></span> hh'ss'<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">h</span> <span class="main">âˆˆ</span> <span class="free">H</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">h'</span> <span class="main">âˆˆ</span> <span class="free">H</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">s</span> <span class="main">âˆˆ</span> <span class="free">S</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">s'</span> <span class="main">âˆˆ</span> <span class="free">S</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">g</span> <span class="main">=</span> <span class="skolem">h</span> <span class="main">âŠ—</span> <span class="skolem">s</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">g'</span> <span class="main">=</span> <span class="skolem">h'</span> <span class="main">âŠ—</span> <span class="skolem">s'</span>"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> set_mult_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">g</span> <span class="main">âŠ—</span> <span class="skolem">g'</span> <span class="main">=</span> <span class="main">(</span><span class="skolem">h</span> <span class="main">âŠ—</span> <span class="skolem">s</span><span class="main">)</span> <span class="main">âŠ—</span> <span class="main">(</span><span class="skolem">h'</span> <span class="main">âŠ—</span> <span class="skolem">s'</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">metis</span>
  <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">from</span></span> hh'ss' <span class="keyword1"><span class="command">have</span></span> inG<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">h</span> <span class="main">âˆˆ</span> carrier <span class="free">G</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">h'</span> <span class="main">âˆˆ</span> carrier <span class="free">G</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">s</span> <span class="main">âˆˆ</span> carrier <span class="free">G</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">s'</span> <span class="main">âˆˆ</span> carrier <span class="free">G</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> subgrpS mem_carrier subgroup.mem_carrier <span class="keyword1"><span class="command">by</span></span> <span class="operator">force</span><span class="main"><span class="keyword3">+</span></span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">h</span> <span class="main">âŠ—</span> <span class="skolem">s</span><span class="main">)</span> <span class="main">âŠ—</span> <span class="main">(</span><span class="skolem">h'</span> <span class="main">âŠ—</span> <span class="skolem">s'</span><span class="main">)</span> <span class="main">=</span> <span class="skolem">h</span> <span class="main">âŠ—</span> <span class="main">(</span><span class="skolem">s</span> <span class="main">âŠ—</span> <span class="skolem">h'</span><span class="main">)</span> <span class="main">âŠ—</span> <span class="skolem">s'</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> m_assoc <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">from</span></span> hh'ss' inG <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">h''</span></span> <span class="keyword2"><span class="keyword">where</span></span> h''<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">h''</span> <span class="main">âˆˆ</span> <span class="free">H</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">s</span> <span class="main">âŠ—</span> <span class="skolem">h'</span> <span class="main">=</span> <span class="skolem">h''</span> <span class="main">âŠ—</span> <span class="skolem">s</span>"</span></span><span class="keyword1"><span class="command">using</span></span> coset_eq <span class="keyword1"><span class="command">unfolding</span></span> r_coset_def l_coset_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">fastforce</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">h</span> <span class="main">âŠ—</span> <span class="main">(</span><span class="skolem">s</span> <span class="main">âŠ—</span> <span class="skolem">h'</span><span class="main">)</span> <span class="main">âŠ—</span> <span class="skolem">s'</span> <span class="main">=</span> <span class="skolem">h</span> <span class="main">âŠ—</span> <span class="main">(</span><span class="skolem">h''</span> <span class="main">âŠ—</span> <span class="skolem">s</span><span class="main">)</span> <span class="main">âŠ—</span> <span class="skolem">s'</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">from</span></span> h'' inG <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> <span class="main">(</span><span class="skolem">h</span> <span class="main">âŠ—</span> <span class="skolem">h''</span><span class="main">)</span> <span class="main">âŠ—</span> <span class="main">(</span><span class="skolem">s</span> <span class="main">âŠ—</span> <span class="skolem">s'</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> m_assoc mem_carrier <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">finally</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">g</span> <span class="main">âŠ—</span> <span class="skolem">g'</span> <span class="main">=</span> <span class="skolem">h</span> <span class="main">âŠ—</span> <span class="skolem">h''</span> <span class="main">âŠ—</span> <span class="main">(</span><span class="skolem">s</span> <span class="main">âŠ—</span> <span class="skolem">s'</span><span class="main">)</span>"</span></span><span class="keyword1"><span class="command">.</span></span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command"><span class="improper">with</span></span></span> h'' hh'ss' <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">âˆˆ</span> <span class="free">H</span> <span class="main">&lt;#&gt;</span> <span class="free">S</span>"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> set_mult_def <span class="keyword1"><span class="command">using</span></span> subgrpS subgroup.m_closed <span class="keyword1"><span class="command">by</span></span> <span class="operator">fastforce</span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">g</span> <span class="main">âŠ—</span> <span class="skolem">g'</span> <span class="main">âˆˆ</span> <span class="free">H</span> <span class="main">&lt;#&gt;</span> <span class="free">S</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="SndIsomorphismGrp-oneH"><span class="command">lemma</span></span> oneH<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="main">ğŸ­</span> <span class="main">âˆˆ</span> <span class="free">H</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> is_subgroup subgroup.one_closed<span class="main">)</span>

<span class="keyword1" id="SndIsomorphismGrp-H_contained_in_set_mult"><span class="command">lemma</span></span> H_contained_in_set_mult<span class="main">:</span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">H</span> <span class="main">âŠ†</span> <span class="free">H</span> <span class="main">&lt;#&gt;</span> <span class="free">S</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">ğŸ­</span> <span class="main">âˆˆ</span> <span class="free">S</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> subgroup.one_closed subgrpS<span class="main">)</span>
  <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">x</span>
  <span class="keyword3"><span class="command">assume</span></span> x<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">âˆˆ</span> <span class="free">H</span>"</span></span>
  <span class="keyword1"><span class="command">with</span></span> <span class="quoted"><span class="quoted">â€¹<span class="main">ğŸ­</span> <span class="main">âˆˆ</span> <span class="free">S</span>â€º</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">âŠ—</span> <span class="main">ğŸ­</span> <span class="main">âˆˆ</span> <span class="free">H</span> <span class="main">&lt;#&gt;</span> <span class="free">S</span>"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> set_mult_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">force</span>
  <span class="keyword1"><span class="command">with</span></span> x <span class="keyword3"><span class="command">show</span></span>  <span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">âˆˆ</span> <span class="free">H</span> <span class="main">&lt;#&gt;</span> <span class="free">S</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> mem_carrier r_one<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="SndIsomorphismGrp-S_contained_in_set_mult"><span class="command">lemma</span></span> S_contained_in_set_mult<span class="main">:</span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">S</span> <span class="main">âŠ†</span> <span class="free">H</span> <span class="main">&lt;#&gt;</span> <span class="free">S</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">auto</span>
  <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">s</span>
  <span class="keyword3"><span class="command">assume</span></span> s<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">s</span> <span class="main">âˆˆ</span> <span class="free">S</span>"</span></span>
  <span class="keyword1"><span class="command">with</span></span> oneH <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">ğŸ­</span> <span class="main">âŠ—</span> <span class="skolem">s</span> <span class="main">âˆˆ</span> <span class="free">H</span> <span class="main">&lt;#&gt;</span> <span class="free">S</span>"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> set_mult_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">force</span>
  <span class="keyword1"><span class="command">with</span></span> s <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">s</span> <span class="main">âˆˆ</span> <span class="free">H</span> <span class="main">&lt;#&gt;</span> <span class="free">S</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> subgrpS subgroup.mem_carrier l_one <span class="keyword1"><span class="command">by</span></span> <span class="operator">force</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="SndIsomorphismGrp-normal_intersection_hom"><span class="command">lemma</span></span> normal_intersection_hom<span class="main">:</span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"group_hom <span class="main">(</span><span class="free">G</span><span class="main">â¦‡</span>carrier <span class="main">:=</span> <span class="free">S</span><span class="main">â¦ˆ</span><span class="main">)</span> <span class="main">(</span><span class="main">(</span><span class="free">G</span><span class="main">â¦‡</span>carrier <span class="main">:=</span> <span class="free">H</span> <span class="main">&lt;#&gt;</span> <span class="free">S</span><span class="main">â¦ˆ</span><span class="main">)</span> <span class="keyword1">Mod</span> <span class="free">H</span><span class="main">)</span> <span class="main">(</span><span class="main">Î»</span><span class="bound">g</span><span class="main">.</span> <span class="free">H</span> <span class="main">#&gt;</span> <span class="bound">g</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">del</span><span class="main"><span class="main">:</span></span> equalityI <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> group_hom_def group_hom_axioms_def hom_def groupS.is_group<span class="main">)</span>
  <span class="keyword1"><span class="command">have</span></span>  gr<span class="main">:</span><span class="quoted"><span class="quoted">"group <span class="main">(</span><span class="free">G</span><span class="main">â¦‡</span>carrier <span class="main">:=</span> <span class="free">H</span> <span class="main">&lt;#&gt;</span> <span class="free">S</span><span class="main">â¦ˆ</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> normal_set_mult_subgroup subgroup_imp_group<span class="main">)</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">H</span> <span class="main">âŠ†</span> <span class="free">H</span> <span class="main">&lt;#&gt;</span> <span class="free">S</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> H_contained_in_set_mult<span class="main">)</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"subgroup <span class="main">(</span><span class="free">H</span> <span class="main">&lt;#&gt;</span> <span class="free">S</span><span class="main">)</span> <span class="free">G</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> normal_set_mult_subgroup<span class="main">)</span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">H</span> <span class="main">âŠ²</span> <span class="main">(</span><span class="free">G</span><span class="main">â¦‡</span>carrier <span class="main">:=</span> <span class="free">H</span> <span class="main">&lt;#&gt;</span> <span class="free">S</span><span class="main">â¦ˆ</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> normal_restrict_supergroup <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> inv_op_closed2 is_subgroup normal_inv_iff<span class="main">)</span>
  <span class="keyword1"><span class="command">with</span></span> gr <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"group <span class="main">(</span><span class="main">(</span><span class="free">G</span><span class="main">â¦‡</span>carrier <span class="main">:=</span> <span class="free">H</span> <span class="main">&lt;#&gt;</span> <span class="free">S</span><span class="main">â¦ˆ</span><span class="main">)</span> <span class="keyword1">Mod</span> <span class="free">H</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> normal.factorgroup_is_group<span class="main">)</span>
<span class="keyword1"><span class="command">next</span></span>
  <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">g</span>
  <span class="keyword3"><span class="command">assume</span></span> g<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">g</span> <span class="main">âˆˆ</span> <span class="free">S</span>"</span></span>
  <span class="keyword1"><span class="command">with</span></span> subgrpS <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">ğŸ­</span> <span class="main">âŠ—</span> <span class="skolem">g</span> <span class="main">âˆˆ</span> <span class="free">H</span> <span class="main">&lt;#&gt;</span> <span class="free">S</span>"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> set_mult_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">fastforce</span>
  <span class="keyword1"><span class="command">with</span></span> g <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">g</span> <span class="main">âˆˆ</span> <span class="free">H</span> <span class="main">&lt;#&gt;</span> <span class="free">S</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> l_one subgroup.mem_carrier subgrpS<span class="main">)</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"<span class="free">H</span> <span class="main">#&gt;</span> <span class="skolem">g</span> <span class="main">âˆˆ</span> carrier <span class="main">(</span><span class="main">(</span><span class="free">G</span><span class="main">â¦‡</span>carrier <span class="main">:=</span> <span class="free">H</span> <span class="main">&lt;#&gt;</span> <span class="free">S</span><span class="main">â¦ˆ</span><span class="main">)</span> <span class="keyword1">Mod</span> <span class="free">H</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> FactGroup_def RCOSETS_def r_coset_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">next</span></span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">â‹€</span><span class="bound">x</span> <span class="bound">y</span><span class="main">.</span> <span class="main">âŸ¦</span><span class="bound">x</span> <span class="main">âˆˆ</span> <span class="free">S</span><span class="main">;</span> <span class="bound">y</span> <span class="main">âˆˆ</span> <span class="free">S</span><span class="main">âŸ§</span> <span class="main">âŸ¹</span> <span class="free">H</span> <span class="main">#&gt;</span> <span class="bound">x</span> <span class="main">âŠ—</span> <span class="bound">y</span> <span class="main">=</span> <span class="free">H</span> <span class="main">#&gt;</span> <span class="bound">x</span> <span class="main">&lt;#&gt;</span> <span class="main">(</span><span class="free">H</span> <span class="main">#&gt;</span> <span class="bound">y</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> normal.rcos_sum normal_axioms subgroup.mem_carrier subgrpS <span class="keyword1"><span class="command">by</span></span> <span class="operator">fastforce</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="SndIsomorphismGrp-normal_intersection_hom_kernel"><span class="command">lemma</span></span> normal_intersection_hom_kernel<span class="main">:</span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"kernel <span class="main">(</span><span class="free">G</span><span class="main">â¦‡</span>carrier <span class="main">:=</span> <span class="free">S</span><span class="main">â¦ˆ</span><span class="main">)</span> <span class="main">(</span><span class="main">(</span><span class="free">G</span><span class="main">â¦‡</span>carrier <span class="main">:=</span> <span class="free">H</span> <span class="main">&lt;#&gt;</span> <span class="free">S</span><span class="main">â¦ˆ</span><span class="main">)</span> <span class="keyword1">Mod</span> <span class="free">H</span><span class="main">)</span> <span class="main">(</span><span class="main">Î»</span><span class="bound">g</span><span class="main">.</span> <span class="free">H</span> <span class="main">#&gt;</span> <span class="bound">g</span><span class="main">)</span> <span class="main">=</span> <span class="free">H</span> <span class="main">âˆ©</span> <span class="free">S</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"kernel <span class="main">(</span><span class="free">G</span><span class="main">â¦‡</span>carrier <span class="main">:=</span> <span class="free">S</span><span class="main">â¦ˆ</span><span class="main">)</span> <span class="main">(</span><span class="main">(</span><span class="free">G</span><span class="main">â¦‡</span>carrier <span class="main">:=</span> <span class="free">H</span> <span class="main">&lt;#&gt;</span> <span class="free">S</span><span class="main">â¦ˆ</span><span class="main">)</span> <span class="keyword1">Mod</span> <span class="free">H</span><span class="main">)</span> <span class="main">(</span><span class="main">Î»</span><span class="bound">g</span><span class="main">.</span> <span class="free">H</span> <span class="main">#&gt;</span> <span class="bound">g</span><span class="main">)</span>
                 <span class="main">=</span> <span class="main">{</span><span class="bound"><span class="bound">g</span></span> <span class="main">âˆˆ</span> <span class="free">S</span><span class="main">.</span> <span class="free">H</span> <span class="main">#&gt;</span> <span class="bound">g</span> <span class="main">=</span> <span class="main">ğŸ­</span><span class="hidden">â‡˜</span><sub><span class="main">(</span><span class="free">G</span><span class="main">â¦‡</span>carrier <span class="main">:=</span> <span class="free">H</span> <span class="main">&lt;#&gt;</span> <span class="free">S</span><span class="main">â¦ˆ</span><span class="main">)</span> <span class="keyword1">Mod</span> <span class="free">H</span></sub><span class="hidden">â‡™</span><span class="main">}</span>"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> kernel_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> <span class="main">{</span><span class="bound"><span class="bound">g</span></span> <span class="main">âˆˆ</span> <span class="free">S</span><span class="main">.</span> <span class="free">H</span> <span class="main">#&gt;</span> <span class="bound">g</span> <span class="main">=</span> <span class="free">H</span><span class="main">}</span>"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> FactGroup_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> <span class="main">{</span><span class="bound"><span class="bound">g</span></span> <span class="main">âˆˆ</span> <span class="free">S</span><span class="main">.</span> <span class="bound">g</span> <span class="main">âˆˆ</span> <span class="free">H</span><span class="main">}</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> coset_eq is_subgroup lcoset_join2 rcos_self subgroup.mem_carrier subgrpS<span class="main">)</span>
  <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> <span class="free">H</span> <span class="main">âˆ©</span> <span class="free">S</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">finally</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span><span class="keyword1"><span class="command">.</span></span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="SndIsomorphismGrp-normal_intersection_hom_surj"><span class="command">lemma</span></span> normal_intersection_hom_surj<span class="main">:</span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">Î»</span><span class="bound">g</span><span class="main">.</span> <span class="free">H</span> <span class="main">#&gt;</span> <span class="bound">g</span><span class="main">)</span> <span class="main">`</span> carrier <span class="main">(</span><span class="free">G</span><span class="main">â¦‡</span>carrier <span class="main">:=</span> <span class="free">S</span><span class="main">â¦ˆ</span><span class="main">)</span> <span class="main">=</span> carrier <span class="main">(</span><span class="main">(</span><span class="free">G</span><span class="main">â¦‡</span>carrier <span class="main">:=</span> <span class="free">H</span> <span class="main">&lt;#&gt;</span> <span class="free">S</span><span class="main">â¦ˆ</span><span class="main">)</span> <span class="keyword1">Mod</span> <span class="free">H</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">auto</span>
  <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">g</span>
  <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">g</span> <span class="main">âˆˆ</span> <span class="free">S</span>"</span></span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">g</span> <span class="main">âˆˆ</span> <span class="free">H</span> <span class="main">&lt;#&gt;</span> <span class="free">S</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> S_contained_in_set_mult <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"<span class="free">H</span> <span class="main">#&gt;</span> <span class="skolem">g</span> <span class="main">âˆˆ</span> carrier <span class="main">(</span><span class="main">(</span><span class="free">G</span><span class="main">â¦‡</span>carrier <span class="main">:=</span> <span class="free">H</span> <span class="main">&lt;#&gt;</span> <span class="free">S</span><span class="main">â¦ˆ</span><span class="main">)</span> <span class="keyword1">Mod</span> <span class="free">H</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> FactGroup_def RCOSETS_def r_coset_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">next</span></span>
  <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">x</span>
  <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">âˆˆ</span> carrier <span class="main">(</span><span class="free">G</span><span class="main">â¦‡</span>carrier <span class="main">:=</span> <span class="free">H</span> <span class="main">&lt;#&gt;</span> <span class="free">S</span><span class="main">â¦ˆ</span> <span class="keyword1">Mod</span> <span class="free">H</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">h</span></span> <span class="skolem"><span class="skolem">s</span></span> <span class="keyword2"><span class="keyword">where</span></span> h<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">h</span> <span class="main">âˆˆ</span> <span class="free">H</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> s<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">s</span> <span class="main">âˆˆ</span> <span class="free">S</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">=</span> <span class="free">H</span> <span class="main">#&gt;</span> <span class="main">(</span><span class="skolem">h</span> <span class="main">âŠ—</span> <span class="skolem">s</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">unfolding</span></span> FactGroup_def RCOSETS_def r_coset_def set_mult_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">=</span> <span class="main">(</span><span class="free">H</span> <span class="main">#&gt;</span> <span class="skolem">h</span><span class="main">)</span> <span class="main">#&gt;</span> <span class="skolem">s</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> h s coset_mult_assoc mem_carrier subgroup.mem_carrier subgrpS subset<span class="main">)</span>
  <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> <span class="free">H</span> <span class="main">#&gt;</span> <span class="skolem">s</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> h is_group rcos_const<span class="main">)</span>
  <span class="keyword1"><span class="command">finally</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">=</span> <span class="free">H</span> <span class="main">#&gt;</span> <span class="skolem">s</span>"</span></span><span class="keyword1"><span class="command">.</span></span>
  <span class="keyword1"><span class="command">with</span></span> s <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">âˆˆ</span> <span class="main">(#&gt;</span><span class="main">)</span> <span class="free">H</span> <span class="main">`</span> <span class="free">S</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">â€¹Finally we can prove the actual isomorphism theorem:â€º</span></span>

<span class="keyword1"><span class="command">theorem</span></span> normal_intersection_quotient_isom<span class="main">:</span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">Î»</span><span class="bound">X</span><span class="main">.</span> the_elem <span class="main">(</span><span class="main">(</span><span class="main">Î»</span><span class="bound">g</span><span class="main">.</span> <span class="free">H</span> <span class="main">#&gt;</span> <span class="bound">g</span><span class="main">)</span> <span class="main">`</span> <span class="bound">X</span><span class="main">)</span><span class="main">)</span> <span class="main">âˆˆ</span> iso <span class="main">(</span><span class="main">(</span><span class="free">G</span><span class="main">â¦‡</span>carrier <span class="main">:=</span> <span class="free">S</span><span class="main">â¦ˆ</span><span class="main">)</span> <span class="keyword1">Mod</span> <span class="main">(</span><span class="free">H</span> <span class="main">âˆ©</span> <span class="free">S</span><span class="main">)</span><span class="main">)</span> <span class="main">(</span><span class="main">(</span><span class="main">(</span><span class="free">G</span><span class="main">â¦‡</span>carrier <span class="main">:=</span> <span class="free">H</span> <span class="main">&lt;#&gt;</span> <span class="free">S</span><span class="main">â¦ˆ</span><span class="main">)</span><span class="main">)</span> <span class="keyword1">Mod</span> <span class="free">H</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">using</span></span> normal_intersection_hom_kernel<span class="main">[</span><span class="operator">symmetric</span><span class="main">]</span> normal_intersection_hom normal_intersection_hom_surj
<span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> group_hom.FactGroup_iso_set<span class="main">)</span>

<span class="keyword2"><span class="keyword">end</span></span>

<span class="keyword2"><span class="keyword">end</span></span>
</pre>
</div><div id="SubgroupsAndNormalSubgroups">
<div class="head">
<h1>Theory SubgroupsAndNormalSubgroups</h1>
</div>
<pre class="source"><span class="comment1">(*  Title:      Additional Facts about Subgroups and Normal Subgroups
    Author:     Jakob von Raumer, Karlsruhe Institute of Technology
    Maintainer: Jakob von Raumer &lt;jakob.raumer@student.kit.edu&gt;
*)</span>

<span class="keyword1"><span class="command">theory</span></span> SubgroupsAndNormalSubgroups
  <span class="keyword2"><span class="keyword">imports</span></span>
  <a href="../Secondary_Sylow/SndSylow.html">Secondary_Sylow.SndSylow</a>
  <a href="SndIsomorphismGrp.html">SndIsomorphismGrp</a>
  <span class="quoted">"<a href="../../HOL/HOL-Algebra/Coset.html">HOL-Algebra.Coset</a>"</span>
<span class="keyword2"><span class="keyword">begin</span></span>

<span class="keyword1"><span class="command">section</span></span> <span class="quoted"><span class="plain_text">â€¹Preliminary lemmasâ€º</span></span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">â€¹A group of order 1 is always the trivial group.â€º</span></span>


<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> group<span class="main">)</span> order_one_triv_iff<span class="main">:</span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span>order <span class="free">G</span> <span class="main">=</span> <span class="main">1</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span>carrier <span class="free">G</span> <span class="main">=</span> <span class="main">{</span><span class="main">ğŸ­</span><span class="main">}</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span>
  <span class="keyword3"><span class="command">assume</span></span> order<span class="main">:</span><span class="quoted"><span class="quoted">"order <span class="free">G</span> <span class="main">=</span> <span class="main">1</span>"</span></span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">x</span></span> <span class="keyword2"><span class="keyword">where</span></span> x<span class="main">:</span><span class="quoted"><span class="quoted">"carrier <span class="free">G</span> <span class="main">=</span> <span class="main">{</span><span class="skolem">x</span><span class="main">}</span>"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> order_def <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> card_Suc_eq<span class="main">)</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="main">ğŸ­</span> <span class="main">=</span> <span class="skolem">x</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> one_closed <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">with</span></span> x <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"carrier <span class="free">G</span> <span class="main">=</span> <span class="main">{</span><span class="main">ğŸ­</span><span class="main">}</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">next</span></span>
  <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"carrier <span class="free">G</span> <span class="main">=</span> <span class="main">{</span><span class="main">ğŸ­</span><span class="main">}</span>"</span></span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"order <span class="free">G</span> <span class="main">=</span> <span class="main">1</span>"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> order_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> group<span class="main">)</span> finite_pos_order<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> finite<span class="main">:</span><span class="quoted"><span class="quoted">"finite <span class="main">(</span>carrier <span class="free">G</span><span class="main">)</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">0</span> <span class="main">&lt;</span> order <span class="free">G</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">from</span></span> one_closed finite <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">unfolding</span></span> order_def <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> card_gt_0_iff subgroup_nonempty subgroup_self<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="SubgroupsAndNormalSubgroups-iso_order_closed"><span class="command">lemma</span></span> iso_order_closed<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">Ï†</span> <span class="main">âˆˆ</span> iso <span class="free">G</span> <span class="free">H</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"order <span class="free">G</span> <span class="main">=</span> order <span class="free">H</span>"</span></span>
<span class="keyword1"><span class="command">using</span></span> assms
<span class="keyword1"><span class="command">unfolding</span></span> order_def iso_def <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> <span class="main"><span class="main">(</span></span>no_types<span class="main"><span class="main">)</span></span> bij_betw_same_card mem_Collect_eq<span class="main">)</span>

<span class="keyword1"><span class="command">section</span></span> <span class="quoted"><span class="plain_text">â€¹More Facts about Subgroupsâ€º</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> subgroup<span class="main">)</span> subgroup_of_restricted_group<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"subgroup <span class="free">U</span> <span class="main">(</span><span class="free">G</span><span class="main">â¦‡</span> carrier <span class="main">:=</span> <span class="free">H</span><span class="main">â¦ˆ</span><span class="main">)</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">U</span> <span class="main">âŠ†</span> <span class="free">H</span>"</span></span>
<span class="keyword1"><span class="command">using</span></span> assms subgroup.subset <span class="keyword1"><span class="command">by</span></span> <span class="operator">force</span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> subgroup<span class="main">)</span> subgroup_of_subgroup<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"group <span class="free">G</span>"</span></span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"subgroup <span class="free">U</span> <span class="main">(</span><span class="free">G</span><span class="main">â¦‡</span> carrier <span class="main">:=</span> <span class="free">H</span><span class="main">â¦ˆ</span><span class="main">)</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"subgroup <span class="free">U</span> <span class="free">G</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span>
  <span class="keyword1"><span class="command">from</span></span> assms<span class="main">(</span>2<span class="main">)</span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">U</span> <span class="main">âŠ†</span> <span class="free">H</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> subgroup_of_restricted_group<span class="main">)</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"<span class="free">U</span> <span class="main">âŠ†</span> carrier <span class="free">G</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span>subset<span class="main">)</span>
<span class="keyword1"><span class="command">next</span></span>
  <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">x</span> <span class="skolem">y</span>
  <span class="keyword1"><span class="command">have</span></span> a<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">âŠ—</span> <span class="skolem">y</span> <span class="main">=</span> <span class="skolem">x</span> <span class="main">âŠ—</span><span class="hidden">â‡˜</span><sub><span class="free">G</span><span class="main">â¦‡</span> carrier <span class="main">:=</span> <span class="free">H</span><span class="main">â¦ˆ</span></sub><span class="hidden">â‡™</span> <span class="skolem">y</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">âˆˆ</span> <span class="free">U</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">y</span> <span class="main">âˆˆ</span> <span class="free">U</span>"</span></span>
  <span class="keyword1"><span class="command">with</span></span> assms a <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">" <span class="skolem">x</span> <span class="main">âŠ—</span> <span class="skolem">y</span> <span class="main">âˆˆ</span> <span class="free">U</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> subgroup.m_closed<span class="main">)</span>
<span class="keyword1"><span class="command">next</span></span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">ğŸ­</span><span class="hidden">â‡˜</span><sub><span class="free">G</span><span class="main">â¦‡</span> carrier <span class="main">:=</span> <span class="free">H</span><span class="main">â¦ˆ</span></sub><span class="hidden">â‡™</span> <span class="main">=</span> <span class="main">ğŸ­</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">with</span></span> assms <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">ğŸ­</span> <span class="main">âˆˆ</span> <span class="free">U</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> subgroup.one_closed<span class="main">)</span>
<span class="keyword1"><span class="command">next</span></span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"subgroup <span class="free">H</span> <span class="free">G</span>"</span></span><span class="keyword1"><span class="command">..</span></span>
  <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">x</span>
  <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">âˆˆ</span> <span class="free">U</span>"</span></span>
  <span class="keyword1"><span class="command">with</span></span> assms<span class="main">(</span>2<span class="main">)</span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">inv</span><span class="hidden">â‡˜</span><sub><span class="free">G</span><span class="main">â¦‡</span> carrier <span class="main">:=</span> <span class="free">H</span><span class="main">â¦ˆ</span></sub><span class="hidden">â‡™</span> <span class="skolem">x</span> <span class="main">âˆˆ</span> <span class="free">U</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> subgroup.m_inv_closed<span class="main">)</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> assms <span class="quoted"><span class="quoted">â€¹<span class="skolem">x</span> <span class="main">âˆˆ</span> <span class="free">U</span>â€º</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">âˆˆ</span> <span class="free">H</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> in_mono subgroup_of_restricted_group<span class="main">)</span>
  <span class="keyword1"><span class="command">with</span></span> assms<span class="main">(</span>1<span class="main">)</span> <span class="quoted"><span class="quoted">â€¹subgroup <span class="free">H</span> <span class="free">G</span>â€º</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">inv</span><span class="hidden">â‡˜</span><sub><span class="free">G</span><span class="main">â¦‡</span> carrier <span class="main">:=</span> <span class="free">H</span><span class="main">â¦ˆ</span></sub><span class="hidden">â‡™</span> <span class="skolem">x</span> <span class="main">=</span> <span class="keyword1">inv</span> <span class="skolem">x</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> group.m_inv_consistent<span class="main">)</span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">inv</span> <span class="skolem">x</span> <span class="main">âˆˆ</span> <span class="free">U</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">â€¹Being a subgroup is preserved by surjective homomorphismsâ€º</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> subgroup<span class="main">)</span> surj_hom_subgroup<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> Ï†<span class="main">:</span><span class="quoted"><span class="quoted">"group_hom <span class="free">G</span> <span class="free">F</span> <span class="free">Ï†</span>"</span></span>
  <span class="keyword2"><span class="keyword">assumes</span></span> Ï†surj<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="free">Ï†</span> <span class="main">`</span> <span class="main">(</span>carrier <span class="free">G</span><span class="main">)</span> <span class="main">=</span> carrier <span class="free">F</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"subgroup <span class="main">(</span><span class="free">Ï†</span> <span class="main">`</span> <span class="free">H</span><span class="main">)</span> <span class="free">F</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span>
  <span class="keyword1"><span class="command">from</span></span> Ï†surj <span class="keyword3"><span class="command">show</span></span> img_subset<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="free">Ï†</span> <span class="main">`</span> <span class="free">H</span> <span class="main">âŠ†</span> carrier <span class="free">F</span>"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> iso_def bij_betw_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">next</span></span>
  <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">f</span> <span class="skolem">f'</span>
  <span class="keyword3"><span class="command">assume</span></span> h<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">f</span> <span class="main">âˆˆ</span> <span class="free">Ï†</span> <span class="main">`</span> <span class="free">H</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> h'<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">f'</span> <span class="main">âˆˆ</span> <span class="free">Ï†</span> <span class="main">`</span> <span class="free">H</span>"</span></span>
  <span class="keyword1"><span class="command">with</span></span> Ï†surj <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">g</span></span> <span class="skolem"><span class="skolem">g'</span></span> <span class="keyword2"><span class="keyword">where</span></span> g<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">g</span> <span class="main">âˆˆ</span> <span class="free">H</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">f</span> <span class="main">=</span> <span class="free">Ï†</span> <span class="skolem">g</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> g'<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">g'</span> <span class="main">âˆˆ</span> <span class="free">H</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">f'</span> <span class="main">=</span> <span class="free">Ï†</span> <span class="skolem">g'</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">g</span> <span class="main">âŠ—</span><span class="hidden">â‡˜</span><sub><span class="free">G</span></sub><span class="hidden">â‡™</span> <span class="skolem">g'</span> <span class="main">âˆˆ</span> <span class="free">H</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> m_closed<span class="main">)</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="free">Ï†</span> <span class="main">(</span><span class="skolem">g</span> <span class="main">âŠ—</span><span class="hidden">â‡˜</span><sub><span class="free">G</span></sub><span class="hidden">â‡™</span> <span class="skolem">g'</span><span class="main">)</span> <span class="main">âˆˆ</span> <span class="free">Ï†</span> <span class="main">`</span> <span class="free">H</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">with</span></span> g g' Ï† <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">f</span> <span class="main">âŠ—</span><span class="hidden">â‡˜</span><sub><span class="free">F</span></sub><span class="hidden">â‡™</span> <span class="skolem">f'</span> <span class="main">âˆˆ</span> <span class="free">Ï†</span> <span class="main">`</span> <span class="free">H</span>"</span></span>  <span class="keyword1"><span class="command">using</span></span> group_hom.hom_mult <span class="keyword1"><span class="command">by</span></span> <span class="operator">fastforce</span>
<span class="keyword1"><span class="command">next</span></span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">Ï†</span> <span class="main">ğŸ­</span> <span class="main">âˆˆ</span> <span class="free">Ï†</span> <span class="main">`</span> <span class="free">H</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">with</span></span> Ï† <span class="keyword3"><span class="command">show</span></span>  <span class="quoted"><span class="quoted">"<span class="main">ğŸ­</span><span class="hidden">â‡˜</span><sub><span class="free">F</span></sub><span class="hidden">â‡™</span> <span class="main">âˆˆ</span> <span class="free">Ï†</span> <span class="main">`</span> <span class="free">H</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> group_hom.hom_one<span class="main">)</span>
<span class="keyword1"><span class="command">next</span></span>
  <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">f</span>
  <span class="keyword3"><span class="command">assume</span></span> f<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">f</span> <span class="main">âˆˆ</span> <span class="free">Ï†</span> <span class="main">`</span> <span class="free">H</span>"</span></span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">g</span></span> <span class="keyword2"><span class="keyword">where</span></span> g<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">g</span> <span class="main">âˆˆ</span> <span class="free">H</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">f</span> <span class="main">=</span> <span class="free">Ï†</span> <span class="skolem">g</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">inv</span> <span class="skolem">g</span> <span class="main">âˆˆ</span> <span class="free">H</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="free">Ï†</span> <span class="main">(</span><span class="keyword1">inv</span> <span class="skolem">g</span><span class="main">)</span> <span class="main">âˆˆ</span> <span class="free">Ï†</span> <span class="main">`</span> <span class="free">H</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">with</span></span> Ï† g subset <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">inv</span><span class="hidden">â‡˜</span><sub><span class="free">F</span></sub><span class="hidden">â‡™</span> <span class="skolem">f</span> <span class="main">âˆˆ</span> <span class="free">Ï†</span> <span class="main">`</span> <span class="free">H</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> group_hom.hom_inv <span class="keyword1"><span class="command">by</span></span> <span class="operator">fastforce</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">â€¹... and thus of course by isomorphisms of groups.â€º</span></span>

<span class="keyword1" id="SubgroupsAndNormalSubgroups-iso_subgroup"><span class="command">lemma</span></span> iso_subgroup<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> groups<span class="main">:</span><span class="quoted"><span class="quoted">"group <span class="free">G</span>"</span></span> <span class="quoted"><span class="quoted">"group <span class="free">F</span>"</span></span>
  <span class="keyword2"><span class="keyword">assumes</span></span> HG<span class="main">:</span><span class="quoted"><span class="quoted">"subgroup <span class="free">H</span> <span class="free">G</span>"</span></span>
  <span class="keyword2"><span class="keyword">assumes</span></span> Ï†<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="free">Ï†</span> <span class="main">âˆˆ</span> iso <span class="free">G</span> <span class="free">F</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"subgroup <span class="main">(</span><span class="free">Ï†</span> <span class="main">`</span> <span class="free">H</span><span class="main">)</span> <span class="free">F</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">from</span></span> groups Ï† <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"group_hom <span class="free">G</span> <span class="free">F</span> <span class="free">Ï†</span>"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> group_hom_def group_hom_axioms_def iso_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> Ï† <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">Ï†</span> <span class="main">`</span> <span class="main">(</span>carrier <span class="free">G</span><span class="main">)</span> <span class="main">=</span> carrier <span class="free">F</span>"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> iso_def bij_betw_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">note</span></span> HG
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> subgroup.surj_hom_subgroup<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">â€¹An isomorphism restricts to an isomorphism of subgroups.â€º</span></span>

<span class="keyword1" id="SubgroupsAndNormalSubgroups-iso_restrict"><span class="command">lemma</span></span> iso_restrict<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> groups<span class="main">:</span><span class="quoted"><span class="quoted">"group <span class="free">G</span>"</span></span> <span class="quoted"><span class="quoted">"group <span class="free">F</span>"</span></span>
  <span class="keyword2"><span class="keyword">assumes</span></span> HG<span class="main">:</span><span class="quoted"><span class="quoted">"subgroup <span class="free">H</span> <span class="free">G</span>"</span></span>
  <span class="keyword2"><span class="keyword">assumes</span></span> Ï†<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="free">Ï†</span> <span class="main">âˆˆ</span> iso <span class="free">G</span> <span class="free">F</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span>restrict <span class="free">Ï†</span> <span class="free">H</span><span class="main">)</span> <span class="main">âˆˆ</span> iso <span class="main">(</span><span class="free">G</span><span class="main">â¦‡</span>carrier <span class="main">:=</span> <span class="free">H</span><span class="main">â¦ˆ</span><span class="main">)</span> <span class="main">(</span><span class="free">F</span><span class="main">â¦‡</span>carrier <span class="main">:=</span> <span class="free">Ï†</span> <span class="main">`</span> <span class="free">H</span><span class="main">â¦ˆ</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">unfolding</span></span> iso_def hom_def bij_betw_def inj_on_def
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">auto</span>
  <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">g</span> <span class="skolem">h</span>
  <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">g</span> <span class="main">âˆˆ</span> <span class="free">H</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">h</span> <span class="main">âˆˆ</span> <span class="free">H</span>"</span></span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">g</span> <span class="main">âˆˆ</span> carrier <span class="free">G</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">h</span> <span class="main">âˆˆ</span> carrier <span class="free">G</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> HG subgroup.mem_carrier<span class="main">)</span><span class="main"><span class="keyword3">+</span></span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"<span class="free">Ï†</span> <span class="main">(</span><span class="skolem">g</span> <span class="main">âŠ—</span><span class="hidden">â‡˜</span><sub><span class="free">G</span></sub><span class="hidden">â‡™</span> <span class="skolem">h</span><span class="main">)</span> <span class="main">=</span> <span class="free">Ï†</span> <span class="skolem">g</span> <span class="main">âŠ—</span><span class="hidden">â‡˜</span><sub><span class="free">F</span></sub><span class="hidden">â‡™</span> <span class="free">Ï†</span> <span class="skolem">h</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> Ï† <span class="keyword1"><span class="command">unfolding</span></span> iso_def hom_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">next</span></span>
  <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">g</span> <span class="skolem">h</span>
  <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">g</span> <span class="main">âˆˆ</span> <span class="free">H</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">h</span> <span class="main">âˆˆ</span> <span class="free">H</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">g</span> <span class="main">âŠ—</span><span class="hidden">â‡˜</span><sub><span class="free">G</span></sub><span class="hidden">â‡™</span> <span class="skolem">h</span> <span class="main">âˆ‰</span> <span class="free">H</span>"</span></span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"False"</span></span> <span class="keyword1"><span class="command">using</span></span> HG <span class="keyword1"><span class="command">unfolding</span></span> subgroup_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"undefined <span class="main">=</span> <span class="free">Ï†</span> <span class="skolem">g</span> <span class="main">âŠ—</span><span class="hidden">â‡˜</span><sub><span class="free">F</span></sub><span class="hidden">â‡™</span> <span class="free">Ï†</span> <span class="skolem">h</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">next</span></span>
  <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">g</span> <span class="skolem">h</span>
  <span class="keyword3"><span class="command">assume</span></span> g<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">g</span> <span class="main">âˆˆ</span> <span class="free">H</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> h<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">h</span> <span class="main">âˆˆ</span> <span class="free">H</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> eq<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="free">Ï†</span> <span class="skolem">g</span> <span class="main">=</span> <span class="free">Ï†</span> <span class="skolem">h</span>"</span></span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">g</span> <span class="main">âˆˆ</span> carrier <span class="free">G</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">h</span> <span class="main">âˆˆ</span> carrier <span class="free">G</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> HG subgroup.mem_carrier<span class="main">)</span><span class="main"><span class="keyword3">+</span></span>
  <span class="keyword1"><span class="command">with</span></span> eq <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">g</span> <span class="main">=</span> <span class="skolem">h</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> Ï† <span class="keyword1"><span class="command">unfolding</span></span> iso_def bij_betw_def inj_on_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">â€¹The intersection of two subgroups is, again, a subgroupâ€º</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> group<span class="main">)</span> subgroup_intersect<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"subgroup <span class="free">H</span> <span class="free">G</span>"</span></span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"subgroup <span class="free">H'</span> <span class="free">G</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"subgroup <span class="main">(</span><span class="free">H</span> <span class="main">âˆ©</span> <span class="free">H'</span><span class="main">)</span> <span class="free">G</span>"</span></span>
<span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">unfolding</span></span> subgroup_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">section</span></span> <span class="quoted"><span class="plain_text">â€¹Facts about Normal Subgroupsâ€º</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> normal<span class="main">)</span> is_normal<span class="main">:</span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">H</span> <span class="main">âŠ²</span> <span class="free">G</span>"</span></span>
<span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> coset_eq is_subgroup normalI<span class="main">)</span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">â€¹Being a normal subgroup is preserved by surjective homomorphisms.â€º</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> normal<span class="main">)</span> surj_hom_normal_subgroup<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> Ï†<span class="main">:</span><span class="quoted"><span class="quoted">"group_hom <span class="free">G</span> <span class="free">F</span> <span class="free">Ï†</span>"</span></span>
  <span class="keyword2"><span class="keyword">assumes</span></span> Ï†surj<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="free">Ï†</span> <span class="main">`</span> <span class="main">(</span>carrier <span class="free">G</span><span class="main">)</span> <span class="main">=</span> carrier <span class="free">F</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">Ï†</span> <span class="main">`</span> <span class="free">H</span><span class="main">)</span> <span class="main">âŠ²</span> <span class="free">F</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">rule</span> group.normalI<span class="main">)</span>
  <span class="keyword1"><span class="command">from</span></span> Ï† <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"group <span class="free">F</span>"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> group_hom_def group_hom_axioms_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">next</span></span>
  <span class="keyword1"><span class="command">from</span></span> Ï† Ï†surj <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"subgroup <span class="main">(</span><span class="free">Ï†</span> <span class="main">`</span> <span class="free">H</span><span class="main">)</span> <span class="free">F</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> surj_hom_subgroup<span class="main">)</span>
<span class="keyword1"><span class="command">next</span></span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">âˆ€</span><span class="bound">x</span><span class="main">âˆˆ</span>carrier <span class="free">F</span><span class="main">.</span> <span class="free">Ï†</span> <span class="main">`</span> <span class="free">H</span> <span class="main">#&gt;</span><span class="hidden">â‡˜</span><sub><span class="free">F</span></sub><span class="hidden">â‡™</span> <span class="bound">x</span> <span class="main">=</span> <span class="bound">x</span> <span class="main">&lt;#</span><span class="hidden">â‡˜</span><sub><span class="free">F</span></sub><span class="hidden">â‡™</span> <span class="free">Ï†</span> <span class="main">`</span> <span class="free">H</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span>
    <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">f</span>
    <span class="keyword3"><span class="command">assume</span></span> f<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">f</span> <span class="main">âˆˆ</span> carrier <span class="free">F</span>"</span></span>
    <span class="keyword1"><span class="command">with</span></span> Ï†surj <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">g</span></span> <span class="keyword2"><span class="keyword">where</span></span> g<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">g</span> <span class="main">âˆˆ</span> carrier <span class="free">G</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">f</span> <span class="main">=</span> <span class="free">Ï†</span> <span class="skolem">g</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="free">Ï†</span> <span class="main">`</span> <span class="free">H</span> <span class="main">#&gt;</span><span class="hidden">â‡˜</span><sub><span class="free">F</span></sub><span class="hidden">â‡™</span> <span class="skolem">f</span> <span class="main">=</span> <span class="free">Ï†</span> <span class="main">`</span> <span class="free">H</span> <span class="main">#&gt;</span><span class="hidden">â‡˜</span><sub><span class="free">F</span></sub><span class="hidden">â‡™</span> <span class="free">Ï†</span> <span class="skolem">g</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> <span class="main">(</span><span class="main">Î»</span><span class="bound">x</span><span class="main">.</span> <span class="main">(</span><span class="free">Ï†</span> <span class="bound">x</span><span class="main">)</span> <span class="main">âŠ—</span><span class="hidden">â‡˜</span><sub><span class="free">F</span></sub><span class="hidden">â‡™</span> <span class="main">(</span><span class="free">Ï†</span> <span class="skolem">g</span><span class="main">)</span><span class="main">)</span> <span class="main">`</span> <span class="free">H</span>"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> r_coset_def image_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> <span class="main">(</span><span class="main">Î»</span><span class="bound">x</span><span class="main">.</span> <span class="free">Ï†</span> <span class="main">(</span><span class="bound">x</span> <span class="main">âŠ—</span> <span class="skolem">g</span><span class="main">)</span><span class="main">)</span> <span class="main">`</span> <span class="free">H</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> subset g Ï† group_hom.hom_mult <span class="keyword1"><span class="command">unfolding</span></span> image_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">fastforce</span>
    <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> <span class="free">Ï†</span> <span class="main">`</span> <span class="main">(</span><span class="free">H</span> <span class="main">#&gt;</span> <span class="skolem">g</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> Ï† <span class="keyword1"><span class="command">unfolding</span></span> r_coset_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> <span class="free">Ï†</span> <span class="main">`</span> <span class="main">(</span><span class="skolem">g</span> <span class="main">&lt;#</span> <span class="free">H</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> coset_eq g<span class="main"><span class="main">(</span></span>1<span class="main"><span class="main">)</span></span><span class="main">)</span>
    <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> <span class="main">(</span><span class="main">Î»</span><span class="bound">x</span><span class="main">.</span> <span class="free">Ï†</span> <span class="main">(</span><span class="skolem">g</span> <span class="main">âŠ—</span> <span class="bound">x</span><span class="main">)</span><span class="main">)</span> <span class="main">`</span> <span class="free">H</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> Ï† <span class="keyword1"><span class="command">unfolding</span></span> l_coset_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> <span class="main">(</span><span class="main">Î»</span><span class="bound">x</span><span class="main">.</span> <span class="main">(</span><span class="free">Ï†</span> <span class="skolem">g</span><span class="main">)</span> <span class="main">âŠ—</span><span class="hidden">â‡˜</span><sub><span class="free">F</span></sub><span class="hidden">â‡™</span> <span class="main">(</span><span class="free">Ï†</span> <span class="bound">x</span><span class="main">)</span><span class="main">)</span> <span class="main">`</span> <span class="free">H</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> subset g Ï† group_hom.hom_mult <span class="keyword1"><span class="command">by</span></span> <span class="operator">fastforce</span>
    <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> <span class="free">Ï†</span> <span class="skolem">g</span> <span class="main">&lt;#</span><span class="hidden">â‡˜</span><sub><span class="free">F</span></sub><span class="hidden">â‡™</span> <span class="free">Ï†</span> <span class="main">`</span> <span class="free">H</span>"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> l_coset_def image_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> <span class="skolem">f</span> <span class="main">&lt;#</span><span class="hidden">â‡˜</span><sub><span class="free">F</span></sub><span class="hidden">â‡™</span> <span class="free">Ï†</span> <span class="main">`</span> <span class="free">H</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> g <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">finally</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="free">Ï†</span> <span class="main">`</span> <span class="free">H</span> <span class="main">#&gt;</span><span class="hidden">â‡˜</span><sub><span class="free">F</span></sub><span class="hidden">â‡™</span> <span class="skolem">f</span> <span class="main">=</span> <span class="skolem">f</span> <span class="main">&lt;#</span><span class="hidden">â‡˜</span><sub><span class="free">F</span></sub><span class="hidden">â‡™</span> <span class="free">Ï†</span> <span class="main">`</span> <span class="free">H</span>"</span></span><span class="keyword1"><span class="command">.</span></span>
  <span class="keyword1"><span class="command">qed</span></span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">â€¹Being a normal subgroup is preserved by group isomorphisms.â€º</span></span>

<span class="keyword1" id="SubgroupsAndNormalSubgroups-iso_normal_subgroup"><span class="command">lemma</span></span> iso_normal_subgroup<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> groups<span class="main">:</span><span class="quoted"><span class="quoted">"group <span class="free">G</span>"</span></span> <span class="quoted"><span class="quoted">"group <span class="free">F</span>"</span></span>
  <span class="keyword2"><span class="keyword">assumes</span></span> HG<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="free">H</span> <span class="main">âŠ²</span> <span class="free">G</span>"</span></span>
  <span class="keyword2"><span class="keyword">assumes</span></span> Ï†<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="free">Ï†</span> <span class="main">âˆˆ</span> iso <span class="free">G</span> <span class="free">F</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">Ï†</span> <span class="main">`</span> <span class="free">H</span><span class="main">)</span> <span class="main">âŠ²</span> <span class="free">F</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">from</span></span> groups Ï† <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"group_hom <span class="free">G</span> <span class="free">F</span> <span class="free">Ï†</span>"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> group_hom_def group_hom_axioms_def iso_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> Ï† <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">Ï†</span> <span class="main">`</span> <span class="main">(</span>carrier <span class="free">G</span><span class="main">)</span> <span class="main">=</span> carrier <span class="free">F</span>"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> iso_def bij_betw_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">note</span></span> HG
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> normal.surj_hom_normal_subgroup <span class="keyword1"><span class="command">by</span></span> <span class="operator">metis</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">â€¹The trivial subgroup is a subgroup:â€º</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> group<span class="main">)</span> triv_subgroup<span class="main">:</span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"subgroup <span class="main">{</span><span class="main">ğŸ­</span><span class="main">}</span> <span class="free">G</span>"</span></span>
<span class="keyword1"><span class="command">unfolding</span></span> subgroup_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">â€¹The cardinality of the right cosets of the trivial subgroup is the cardinality of the group itself:â€º</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> group<span class="main">)</span> card_rcosets_triv<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"finite <span class="main">(</span>carrier <span class="free">G</span><span class="main">)</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"card <span class="main">(</span><span class="keyword1">rcosets</span> <span class="main">{</span><span class="main">ğŸ­</span><span class="main">}</span><span class="main">)</span> <span class="main">=</span> order <span class="free">G</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"subgroup <span class="main">{</span><span class="main">ğŸ­</span><span class="main">}</span> <span class="free">G</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> triv_subgroup<span class="main">)</span>
  <span class="keyword1"><span class="command">with</span></span> assms <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"card <span class="main">(</span><span class="keyword1">rcosets</span> <span class="main">{</span><span class="main">ğŸ­</span><span class="main">}</span><span class="main">)</span> <span class="main">*</span> card <span class="main">{</span><span class="main">ğŸ­</span><span class="main">}</span> <span class="main">=</span> order <span class="free">G</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> lagrange <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span>card_Suc_eq<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">â€¹The intersection of two normal subgroups is, again, a normal subgroup.â€º</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> group<span class="main">)</span> normal_subgroup_intersect<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">M</span> <span class="main">âŠ²</span> <span class="free">G</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">N</span> <span class="main">âŠ²</span> <span class="free">G</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">M</span> <span class="main">âˆ©</span> <span class="free">N</span> <span class="main">âŠ²</span> <span class="free">G</span>"</span></span>
<span class="keyword1"><span class="command">using</span></span> assms subgroup_intersect is_group normal_inv_iff <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">â€¹The set product of two normal subgroups is a normal subgroup.â€º</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> group<span class="main">)</span> setmult_lcos_assoc<span class="main">:</span>
     <span class="quoted"><span class="quoted">"<span class="main">âŸ¦</span><span class="free">H</span> <span class="main">âŠ†</span> carrier <span class="free">G</span><span class="main">;</span> <span class="free">K</span> <span class="main">âŠ†</span> carrier <span class="free">G</span><span class="main">;</span> <span class="free">x</span> <span class="main">âˆˆ</span> carrier <span class="free">G</span><span class="main">âŸ§</span>
      <span class="main">âŸ¹</span> <span class="main">(</span><span class="free">x</span> <span class="main">&lt;#</span> <span class="free">H</span><span class="main">)</span> <span class="main">&lt;#&gt;</span> <span class="free">K</span> <span class="main">=</span> <span class="free">x</span> <span class="main">&lt;#</span> <span class="main">(</span><span class="free">H</span> <span class="main">&lt;#&gt;</span> <span class="free">K</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">force</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> l_coset_def set_mult_def m_assoc<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> group<span class="main">)</span> normal_subgroup_set_mult_closed<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">M</span> <span class="main">âŠ²</span> <span class="free">G</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">N</span> <span class="main">âŠ²</span> <span class="free">G</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">M</span> <span class="main">&lt;#&gt;</span> <span class="free">N</span> <span class="main">âŠ²</span> <span class="free">G</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">rule</span> normalI<span class="main">)</span>
  <span class="keyword1"><span class="command">from</span></span> assms <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"subgroup <span class="main">(</span><span class="free">M</span> <span class="main">&lt;#&gt;</span> <span class="free">N</span><span class="main">)</span> <span class="free">G</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> second_isomorphism_grp.normal_set_mult_subgroup normal_imp_subgroup
    <span class="keyword1"><span class="command">unfolding</span></span> second_isomorphism_grp_def second_isomorphism_grp_axioms_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">force</span>
<span class="keyword1"><span class="command">next</span></span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">âˆ€</span><span class="bound">x</span><span class="main">âˆˆ</span>carrier <span class="free">G</span><span class="main">.</span> <span class="free">M</span> <span class="main">&lt;#&gt;</span> <span class="free">N</span> <span class="main">#&gt;</span> <span class="bound">x</span> <span class="main">=</span> <span class="bound">x</span> <span class="main">&lt;#</span> <span class="main">(</span><span class="free">M</span> <span class="main">&lt;#&gt;</span> <span class="free">N</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span>
    <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">x</span>
    <span class="keyword3"><span class="command">assume</span></span> x<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">âˆˆ</span> carrier <span class="free">G</span>"</span></span>
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">M</span> <span class="main">&lt;#&gt;</span> <span class="free">N</span> <span class="main">#&gt;</span> <span class="skolem">x</span> <span class="main">=</span> <span class="free">M</span> <span class="main">&lt;#&gt;</span> <span class="main">(</span><span class="free">N</span> <span class="main">#&gt;</span> <span class="skolem">x</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> assms<span class="main"><span class="main">(</span></span>1<span class="main"><span class="main">,</span></span>2<span class="main"><span class="main">)</span></span> normal_inv_iff setmult_rcos_assoc subgroup.subset x<span class="main">)</span>
    <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">â€¦</span> <span class="main">=</span> <span class="free">M</span> <span class="main">&lt;#&gt;</span> <span class="main">(</span><span class="skolem">x</span> <span class="main">&lt;#</span> <span class="free">N</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> assms<span class="main"><span class="main">(</span></span>2<span class="main"><span class="main">)</span></span> normal.coset_eq x<span class="main">)</span>
    <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">â€¦</span> <span class="main">=</span> <span class="main">(</span><span class="free">M</span> <span class="main">#&gt;</span> <span class="skolem">x</span><span class="main">)</span> <span class="main">&lt;#&gt;</span> <span class="free">N</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> assms<span class="main"><span class="main">(</span></span>1<span class="main"><span class="main">,</span></span>2<span class="main"><span class="main">)</span></span> normal_imp_subgroup rcos_assoc_lcos subgroup.subset x<span class="main">)</span>
    <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">â€¦</span> <span class="main">=</span> <span class="main">(</span><span class="skolem">x</span> <span class="main">&lt;#</span> <span class="free">M</span><span class="main">)</span> <span class="main">&lt;#&gt;</span> <span class="free">N</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> assms<span class="main"><span class="main">(</span></span>1<span class="main"><span class="main">)</span></span> normal.coset_eq x<span class="main">)</span>
    <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">â€¦</span> <span class="main">=</span> <span class="skolem">x</span> <span class="main">&lt;#</span> <span class="main">(</span><span class="free">M</span> <span class="main">&lt;#&gt;</span> <span class="free">N</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> assms<span class="main"><span class="main">(</span></span>1<span class="main"><span class="main">,</span></span>2<span class="main"><span class="main">)</span></span> normal_imp_subgroup setmult_lcos_assoc subgroup.subset x<span class="main">)</span>
    <span class="keyword1"><span class="command">finally</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="free">M</span> <span class="main">&lt;#&gt;</span> <span class="free">N</span> <span class="main">#&gt;</span> <span class="skolem">x</span> <span class="main">=</span> <span class="skolem">x</span> <span class="main">&lt;#</span> <span class="main">(</span><span class="free">M</span> <span class="main">&lt;#&gt;</span> <span class="free">N</span><span class="main">)</span>"</span></span><span class="keyword1"><span class="command">.</span></span>
  <span class="keyword1"><span class="command">qed</span></span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">â€¹The following is a very basic lemma about subgroups: If restricting the carrier of
  a group yields a group it's a subgroup of the group we've started with.â€º</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> group<span class="main">)</span> restrict_group_imp_subgroup<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">H</span> <span class="main">âŠ†</span> carrier <span class="free">G</span>"</span></span> <span class="quoted"><span class="quoted">"group <span class="main">(</span><span class="free">G</span><span class="main">â¦‡</span>carrier <span class="main">:=</span> <span class="free">H</span><span class="main">â¦ˆ</span><span class="main">)</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"subgroup <span class="free">H</span> <span class="free">G</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span>
  <span class="keyword1"><span class="command">from</span></span> assms<span class="main">(</span>1<span class="main">)</span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="free">H</span> <span class="main">âŠ†</span> carrier <span class="free">G</span>"</span></span> <span class="keyword1"><span class="command">.</span></span>
<span class="keyword1"><span class="command">next</span></span>
  <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">x</span> <span class="skolem">y</span>
  <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">âˆˆ</span> <span class="free">H</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">y</span> <span class="main">âˆˆ</span> <span class="free">H</span>"</span></span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">âˆˆ</span> carrier <span class="main">(</span><span class="free">G</span><span class="main">â¦‡</span>carrier <span class="main">:=</span> <span class="free">H</span><span class="main">â¦ˆ</span><span class="main">)</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">y</span> <span class="main">âˆˆ</span> carrier <span class="main">(</span><span class="free">G</span><span class="main">â¦‡</span>carrier <span class="main">:=</span> <span class="free">H</span><span class="main">â¦ˆ</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">with</span></span> assms<span class="main">(</span>2<span class="main">)</span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">âŠ—</span> <span class="skolem">y</span> <span class="main">âˆˆ</span> <span class="free">H</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>2<span class="main">)</span> group.is_monoid monoid.m_closed <span class="keyword1"><span class="command">by</span></span> <span class="operator">fastforce</span>
<span class="keyword1"><span class="command">next</span></span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">ğŸ­</span> <span class="main">âˆˆ</span> <span class="free">H</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>2<span class="main">)</span> group.is_monoid monoid.one_closed <span class="keyword1"><span class="command">by</span></span> <span class="operator">fastforce</span>
<span class="keyword1"><span class="command">next</span></span>
  <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">x</span>
  <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">âˆˆ</span> <span class="free">H</span>"</span></span>
  <span class="keyword1"><span class="command">hence</span></span> x<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">âˆˆ</span> carrier <span class="main">(</span><span class="free">G</span><span class="main">â¦‡</span>carrier <span class="main">:=</span> <span class="free">H</span><span class="main">â¦ˆ</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">inv</span><span class="hidden">â‡˜</span><sub><span class="free">G</span><span class="main">â¦‡</span>carrier <span class="main">:=</span> <span class="free">H</span><span class="main">â¦ˆ</span></sub><span class="hidden">â‡™</span> <span class="skolem">x</span> <span class="main">âˆˆ</span> carrier <span class="main">(</span><span class="free">G</span><span class="main">â¦‡</span>carrier <span class="main">:=</span> <span class="free">H</span><span class="main">â¦ˆ</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>2<span class="main">)</span> group.inv_closed <span class="keyword1"><span class="command">by</span></span> <span class="operator">fastforce</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">inv</span><span class="hidden">â‡˜</span><sub><span class="free">G</span><span class="main">â¦‡</span>carrier <span class="main">:=</span> <span class="free">H</span><span class="main">â¦ˆ</span></sub><span class="hidden">â‡™</span> <span class="skolem">x</span> <span class="main">âˆˆ</span> carrier <span class="free">G</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> x assms<span class="main">(</span>1<span class="main">)</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">inv</span><span class="hidden">â‡˜</span><sub><span class="free">G</span><span class="main">â¦‡</span>carrier <span class="main">:=</span> <span class="free">H</span><span class="main">â¦ˆ</span></sub><span class="hidden">â‡™</span> <span class="skolem">x</span> <span class="main">âŠ—</span> <span class="skolem">x</span> <span class="main">=</span> <span class="main">ğŸ­</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>2<span class="main">)</span> group.l_inv x <span class="keyword1"><span class="command">by</span></span> <span class="operator">fastforce</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">âˆˆ</span> carrier <span class="free">G</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> x assms<span class="main">(</span>1<span class="main">)</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">inv</span><span class="hidden">â‡˜</span><sub><span class="free">G</span><span class="main">â¦‡</span>carrier <span class="main">:=</span> <span class="free">H</span><span class="main">â¦ˆ</span></sub><span class="hidden">â‡™</span> <span class="skolem">x</span> <span class="main">=</span> <span class="keyword1">inv</span> <span class="skolem">x</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> inv_equality<span class="main">[</span><span class="operator">symmetric</span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">inv</span> <span class="skolem">x</span> <span class="main">âˆˆ</span> <span class="free">H</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>2<span class="main">)</span> group.inv_closed x <span class="keyword1"><span class="command">by</span></span> <span class="operator">fastforce</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">â€¹A subgroup relation survives factoring by a normal subgroup.â€º</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> group<span class="main">)</span> normal_subgroup_factorize<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">N</span> <span class="main">âŠ²</span> <span class="free">G</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">N</span> <span class="main">âŠ†</span> <span class="free">H</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"subgroup <span class="free">H</span> <span class="free">G</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"subgroup <span class="main">(</span><span class="keyword1">rcosets</span><span class="hidden">â‡˜</span><sub><span class="free">G</span><span class="main">â¦‡</span>carrier <span class="main">:=</span> <span class="free">H</span><span class="main">â¦ˆ</span></sub><span class="hidden">â‡™</span> <span class="free">N</span><span class="main">)</span> <span class="main">(</span><span class="free">G</span> <span class="keyword1">Mod</span> <span class="free">N</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">interpret</span></span> GModN<span class="main">:</span> group <span class="quoted"><span class="quoted">"<span class="free">G</span> <span class="keyword1">Mod</span> <span class="free">N</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>1<span class="main">)</span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> normal.factorgroup_is_group<span class="main">)</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">N</span> <span class="main">âŠ²</span> <span class="free">G</span><span class="main">â¦‡</span>carrier <span class="main">:=</span> <span class="free">H</span><span class="main">â¦ˆ</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> normal_restrict_supergroup<span class="main">)</span>
  <span class="keyword1"><span class="command">hence</span></span> grpHN<span class="main">:</span><span class="quoted"><span class="quoted">"group <span class="main">(</span><span class="free">G</span><span class="main">â¦‡</span>carrier <span class="main">:=</span> <span class="free">H</span><span class="main">â¦ˆ</span> <span class="keyword1">Mod</span> <span class="free">N</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> normal.factorgroup_is_group<span class="main">)</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(&lt;#&gt;</span><span class="hidden">â‡˜</span><sub><span class="free">G</span><span class="main">â¦‡</span>carrier<span class="main">:=</span><span class="free">H</span><span class="main">â¦ˆ</span></sub><span class="hidden">â‡™</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="main">Î»</span><span class="bound">U</span> <span class="bound">K</span><span class="main">.</span> <span class="main">(</span><span class="main">â‹ƒ</span><span class="bound">h</span><span class="main">âˆˆ</span><span class="bound">U</span><span class="main">.</span> <span class="main">â‹ƒ</span><span class="bound">k</span><span class="main">âˆˆ</span><span class="bound">K</span><span class="main">.</span> <span class="main">{</span><span class="bound">h</span> <span class="main">âŠ—</span><span class="hidden">â‡˜</span><sub><span class="free">G</span><span class="main">â¦‡</span>carrier <span class="main">:=</span> <span class="free">H</span><span class="main">â¦ˆ</span></sub><span class="hidden">â‡™</span> <span class="bound">k</span><span class="main">}</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> set_mult_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">metis</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">â€¦</span> <span class="main">=</span> <span class="main">(</span><span class="main">Î»</span><span class="bound">U</span> <span class="bound">K</span><span class="main">.</span> <span class="main">(</span><span class="main">â‹ƒ</span><span class="bound">h</span><span class="main">âˆˆ</span><span class="bound">U</span><span class="main">.</span> <span class="main">â‹ƒ</span><span class="bound">k</span><span class="main">âˆˆ</span><span class="bound">K</span><span class="main">.</span> <span class="main">{</span><span class="bound">h</span> <span class="main">âŠ—</span><span class="hidden">â‡˜</span><sub><span class="free">G</span></sub><span class="hidden">â‡™</span> <span class="bound">k</span><span class="main">}</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(&lt;#&gt;</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="main">Î»</span><span class="bound">U</span> <span class="bound">K</span><span class="main">.</span> <span class="main">(</span><span class="main">â‹ƒ</span><span class="bound">h</span><span class="main">âˆˆ</span><span class="bound">U</span><span class="main">.</span> <span class="main">â‹ƒ</span><span class="bound">k</span><span class="main">âˆˆ</span><span class="bound">K</span><span class="main">.</span> <span class="main">{</span><span class="bound">h</span> <span class="main">âŠ—</span> <span class="bound">k</span><span class="main">}</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> set_mult_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">metis</span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(&lt;#&gt;</span><span class="hidden">â‡˜</span><sub><span class="free">G</span><span class="main">â¦‡</span>carrier<span class="main">:=</span><span class="free">H</span><span class="main">â¦ˆ</span></sub><span class="hidden">â‡™</span><span class="main">)</span> <span class="main">=</span> <span class="main">(&lt;#&gt;</span><span class="hidden">â‡˜</span><sub><span class="free">G</span></sub><span class="hidden">â‡™</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">with</span></span> grpHN <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"group <span class="main">(</span><span class="main">(</span><span class="free">G</span> <span class="keyword1">Mod</span> <span class="free">N</span><span class="main">)</span><span class="main">â¦‡</span>carrier <span class="main">:=</span> <span class="main">(</span><span class="keyword1">rcosets</span><span class="hidden">â‡˜</span><sub><span class="free">G</span><span class="main">â¦‡</span>carrier <span class="main">:=</span> <span class="free">H</span><span class="main">â¦ˆ</span></sub><span class="hidden">â‡™</span> <span class="free">N</span><span class="main">)</span><span class="main">â¦ˆ</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> FactGroup_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">rcosets</span><span class="hidden">â‡˜</span><sub><span class="free">G</span><span class="main">â¦‡</span>carrier <span class="main">:=</span> <span class="free">H</span><span class="main">â¦ˆ</span></sub><span class="hidden">â‡™</span> <span class="free">N</span> <span class="main">âŠ†</span> carrier <span class="main">(</span><span class="free">G</span> <span class="keyword1">Mod</span> <span class="free">N</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> FactGroup_def RCOSETS_def r_coset_def
    <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>3<span class="main">)</span> subgroup.subset <span class="keyword1"><span class="command">by</span></span> <span class="operator">fastforce</span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> GModN.is_group group.restrict_group_imp_subgroup <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">â€¹A normality relation survives factoring by a normal subgroup.â€º</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> group<span class="main">)</span> normality_factorization<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> NG<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="free">N</span> <span class="main">âŠ²</span> <span class="free">G</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> NH<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="free">N</span> <span class="main">âŠ†</span> <span class="free">H</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> HG<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="free">H</span> <span class="main">âŠ²</span> <span class="free">G</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="keyword1">rcosets</span><span class="hidden">â‡˜</span><sub><span class="free">G</span><span class="main">â¦‡</span>carrier <span class="main">:=</span> <span class="free">H</span><span class="main">â¦ˆ</span></sub><span class="hidden">â‡™</span> <span class="free">N</span><span class="main">)</span> <span class="main">âŠ²</span> <span class="main">(</span><span class="free">G</span> <span class="keyword1">Mod</span> <span class="free">N</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">from</span></span> assms<span class="main">(</span>1<span class="main">)</span> <span class="keyword1"><span class="command">interpret</span></span> GModN<span class="main">:</span> group <span class="quoted"><span class="quoted">"<span class="free">G</span> <span class="keyword1">Mod</span> <span class="free">N</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> normal.factorgroup_is_group<span class="main">)</span>
  <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> GModN.normal_inv_iff<span class="main">)</span>
    <span class="keyword1"><span class="command">from</span></span> assms <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"subgroup <span class="main">(</span><span class="keyword1">rcosets</span><span class="hidden">â‡˜</span><sub><span class="free">G</span><span class="main">â¦‡</span>carrier <span class="main">:=</span> <span class="free">H</span><span class="main">â¦ˆ</span></sub><span class="hidden">â‡™</span> <span class="free">N</span><span class="main">)</span> <span class="main">(</span><span class="free">G</span> <span class="keyword1">Mod</span> <span class="free">N</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> normal_imp_subgroup normal_subgroup_factorize <span class="keyword1"><span class="command">by</span></span> <span class="operator">force</span>
  <span class="keyword1"><span class="command">next</span></span>
    <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">U</span> <span class="skolem">V</span>
    <span class="keyword3"><span class="command">assume</span></span> U<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">U</span> <span class="main">âˆˆ</span> carrier <span class="main">(</span><span class="free">G</span> <span class="keyword1">Mod</span> <span class="free">N</span><span class="main">)</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> V<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">V</span> <span class="main">âˆˆ</span> <span class="keyword1">rcosets</span><span class="hidden">â‡˜</span><sub><span class="free">G</span><span class="main">â¦‡</span>carrier <span class="main">:=</span> <span class="free">H</span><span class="main">â¦ˆ</span></sub><span class="hidden">â‡™</span> <span class="free">N</span>"</span></span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">g</span></span> <span class="keyword2"><span class="keyword">where</span></span> g<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">g</span> <span class="main">âˆˆ</span> carrier <span class="free">G</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">U</span> <span class="main">=</span> <span class="free">N</span> <span class="main">#&gt;</span> <span class="skolem">g</span>"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> FactGroup_def RCOSETS_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">from</span></span> V <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">h</span></span> <span class="keyword2"><span class="keyword">where</span></span> h<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">h</span> <span class="main">âˆˆ</span> <span class="free">H</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">V</span> <span class="main">=</span> <span class="free">N</span> <span class="main">#&gt;</span> <span class="skolem">h</span>"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> FactGroup_def RCOSETS_def r_coset_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">hence</span></span> hG<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">h</span> <span class="main">âˆˆ</span> carrier <span class="free">G</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> HG normal_imp_subgroup subgroup.mem_carrier <span class="keyword1"><span class="command">by</span></span> <span class="operator">force</span>
    <span class="keyword1"><span class="command">hence</span></span> ghG<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">g</span> <span class="main">âŠ—</span> <span class="skolem">h</span> <span class="main">âˆˆ</span> carrier <span class="free">G</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> g m_closed <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">from</span></span> g h <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">g</span> <span class="main">âŠ—</span> <span class="skolem">h</span> <span class="main">âŠ—</span> <span class="keyword1">inv</span> <span class="skolem">g</span> <span class="main">âˆˆ</span> <span class="free">H</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> HG normal_inv_iff <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">U</span> <span class="main">&lt;#&gt;</span> <span class="skolem">V</span> <span class="main">&lt;#&gt;</span> <span class="keyword1">inv</span><span class="hidden">â‡˜</span><sub><span class="free">G</span> <span class="keyword1">Mod</span> <span class="free">N</span></sub><span class="hidden">â‡™</span> <span class="skolem">U</span> <span class="main">=</span> <span class="free">N</span> <span class="main">#&gt;</span> <span class="main">(</span><span class="skolem">g</span> <span class="main">âŠ—</span> <span class="skolem">h</span> <span class="main">âŠ—</span> <span class="keyword1">inv</span> <span class="skolem">g</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
      <span class="keyword1"><span class="command">from</span></span> g U <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">inv</span><span class="hidden">â‡˜</span><sub><span class="free">G</span> <span class="keyword1">Mod</span> <span class="free">N</span></sub><span class="hidden">â‡™</span> <span class="skolem">U</span> <span class="main">=</span> <span class="free">N</span> <span class="main">#&gt;</span> <span class="keyword1">inv</span> <span class="skolem">g</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> NG normal.inv_FactGroup normal.rcos_inv <span class="keyword1"><span class="command">by</span></span> <span class="operator">fastforce</span>
      <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">U</span> <span class="main">&lt;#&gt;</span> <span class="skolem">V</span> <span class="main">&lt;#&gt;</span> <span class="keyword1">inv</span><span class="hidden">â‡˜</span><sub><span class="free">G</span> <span class="keyword1">Mod</span> <span class="free">N</span></sub><span class="hidden">â‡™</span> <span class="skolem">U</span> <span class="main">=</span> <span class="main">(</span><span class="free">N</span> <span class="main">#&gt;</span> <span class="skolem">g</span><span class="main">)</span> <span class="main">&lt;#&gt;</span> <span class="main">(</span><span class="free">N</span> <span class="main">#&gt;</span> <span class="skolem">h</span><span class="main">)</span> <span class="main">&lt;#&gt;</span> <span class="main">(</span><span class="free">N</span> <span class="main">#&gt;</span> <span class="keyword1">inv</span> <span class="skolem">g</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> g h <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
      <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">â€¦</span> <span class="main">=</span> <span class="free">N</span> <span class="main">#&gt;</span> <span class="main">(</span><span class="skolem">g</span> <span class="main">âŠ—</span> <span class="skolem">h</span><span class="main">)</span> <span class="main">&lt;#&gt;</span> <span class="main">(</span><span class="free">N</span> <span class="main">#&gt;</span> <span class="keyword1">inv</span> <span class="skolem">g</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> g hG NG normal.rcos_sum <span class="keyword1"><span class="command">by</span></span> <span class="operator">force</span>
      <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">â€¦</span> <span class="main">=</span> <span class="free">N</span> <span class="main">#&gt;</span> <span class="main">(</span><span class="skolem">g</span> <span class="main">âŠ—</span> <span class="skolem">h</span> <span class="main">âŠ—</span> <span class="keyword1">inv</span> <span class="skolem">g</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> g inv_closed ghG NG normal.rcos_sum <span class="keyword1"><span class="command">by</span></span> <span class="operator">force</span>
      <span class="keyword1"><span class="command">finally</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">.</span></span>
    <span class="keyword1"><span class="command">qed</span></span>
    <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">U</span> <span class="main">&lt;#&gt;</span> <span class="skolem">V</span> <span class="main">&lt;#&gt;</span> <span class="keyword1">inv</span><span class="hidden">â‡˜</span><sub><span class="free">G</span> <span class="keyword1">Mod</span> <span class="free">N</span></sub><span class="hidden">â‡™</span> <span class="skolem">U</span> <span class="main">âˆˆ</span> <span class="keyword1">rcosets</span><span class="hidden">â‡˜</span><sub><span class="free">G</span><span class="main">â¦‡</span>carrier <span class="main">:=</span> <span class="free">H</span><span class="main">â¦ˆ</span></sub><span class="hidden">â‡™</span> <span class="free">N</span>"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> RCOSETS_def r_coset_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">qed</span></span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">â€¹Factoring by a normal subgroups yields the trivial group iff the subgroup is the whole group.â€º</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> normal<span class="main">)</span> fact_group_trivial_iff<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"finite <span class="main">(</span>carrier <span class="free">G</span><span class="main">)</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span>carrier <span class="main">(</span><span class="free">G</span> <span class="keyword1">Mod</span> <span class="free">H</span><span class="main">)</span> <span class="main">=</span> <span class="main">{</span><span class="main">ğŸ­</span><span class="hidden">â‡˜</span><sub><span class="free">G</span> <span class="keyword1">Mod</span> <span class="free">H</span></sub><span class="hidden">â‡™</span><span class="main">}</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="free">H</span> <span class="main">=</span> carrier <span class="free">G</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span>
  <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"carrier <span class="main">(</span><span class="free">G</span> <span class="keyword1">Mod</span> <span class="free">H</span><span class="main">)</span> <span class="main">=</span> <span class="main">{</span><span class="main">ğŸ­</span><span class="hidden">â‡˜</span><sub><span class="free">G</span> <span class="keyword1">Mod</span> <span class="free">H</span></sub><span class="hidden">â‡™</span><span class="main">}</span>"</span></span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command"><span class="improper">with</span></span></span> assms lagrange <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"order <span class="main">(</span><span class="free">G</span> <span class="keyword1">Mod</span> <span class="free">H</span><span class="main">)</span> <span class="main">*</span> card <span class="free">H</span> <span class="main">=</span> order <span class="free">G</span>"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> FactGroup_def order_def <span class="keyword1"><span class="command">using</span></span> is_subgroup <span class="keyword1"><span class="command">by</span></span> <span class="operator">force</span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"card <span class="free">H</span> <span class="main">=</span> order <span class="free">G</span>"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> order_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"<span class="free">H</span> <span class="main">=</span> carrier <span class="free">G</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> subgroup.subset is_subgroup assms card_subset_eq <span class="keyword1"><span class="command">unfolding</span></span> order_def
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">metis</span>
<span class="keyword1"><span class="command">next</span></span>
  <span class="keyword1"><span class="command">from</span></span> assms <span class="keyword1"><span class="command">have</span></span> ordergt0<span class="main">:</span><span class="quoted"><span class="quoted">"order <span class="free">G</span> <span class="main">&gt;</span> <span class="main">0</span>"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> order_def <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> subgroup.finite_imp_card_positive subgroup_self<span class="main">)</span>
  <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="free">H</span> <span class="main">=</span> carrier <span class="free">G</span>"</span></span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"card <span class="free">H</span> <span class="main">=</span> order <span class="free">G</span>"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> order_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">with</span></span> assms is_subgroup lagrange <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"card <span class="main">(</span><span class="keyword1">rcosets</span> <span class="free">H</span><span class="main">)</span> <span class="main">*</span> order <span class="free">G</span> <span class="main">=</span> order <span class="free">G</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">metis</span>
  <span class="keyword1"><span class="command">with</span></span> ordergt0 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"card <span class="main">(</span><span class="keyword1">rcosets</span> <span class="free">H</span><span class="main">)</span> <span class="main">=</span> <span class="main">1</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> mult_eq_self_implies_10 mult.commute neq0_conv<span class="main">)</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"order <span class="main">(</span><span class="free">G</span> <span class="keyword1">Mod</span> <span class="free">H</span><span class="main">)</span> <span class="main">=</span> <span class="main">1</span>"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> order_def FactGroup_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"carrier <span class="main">(</span><span class="free">G</span> <span class="keyword1">Mod</span> <span class="free">H</span><span class="main">)</span> <span class="main">=</span> <span class="main">{</span><span class="main">ğŸ­</span><span class="hidden">â‡˜</span><sub><span class="free">G</span> <span class="keyword1">Mod</span> <span class="free">H</span></sub><span class="hidden">â‡™</span><span class="main">}</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> factorgroup_is_group <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> group.order_one_triv_iff<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">â€¹Finite groups have finite quotients.â€º</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> normal<span class="main">)</span> factgroup_finite<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"finite <span class="main">(</span>carrier <span class="free">G</span><span class="main">)</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"finite <span class="main">(</span><span class="keyword1">rcosets</span> <span class="free">H</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">unfolding</span></span> RCOSETS_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">â€¹The union of all the cosets contained in a subgroup of a quotient group acts as a represenation for that subgroup.â€º</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> normal<span class="main">)</span> factgroup_subgroup_union_char<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"subgroup <span class="free">A</span> <span class="main">(</span><span class="free">G</span> <span class="keyword1">Mod</span> <span class="free">H</span><span class="main">)</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">â‹ƒ</span><span class="free">A</span><span class="main">)</span> <span class="main">=</span> <span class="main">{</span><span class="bound"><span class="bound">x</span></span> <span class="main">âˆˆ</span> carrier <span class="free">G</span><span class="main">.</span> <span class="free">H</span> <span class="main">#&gt;</span> <span class="bound">x</span> <span class="main">âˆˆ</span> <span class="free">A</span><span class="main">}</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">â‹ƒ</span><span class="free">A</span> <span class="main">âŠ†</span> <span class="main">{</span><span class="bound"><span class="bound">x</span></span> <span class="main">âˆˆ</span> carrier <span class="free">G</span><span class="main">.</span> <span class="free">H</span> <span class="main">#&gt;</span> <span class="bound">x</span> <span class="main">âˆˆ</span> <span class="free">A</span><span class="main">}</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span>
    <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">x</span>
    <span class="keyword3"><span class="command">assume</span></span> x<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">âˆˆ</span> <span class="main">â‹ƒ</span><span class="free">A</span>"</span></span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">a</span></span> <span class="keyword2"><span class="keyword">where</span></span> a<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">a</span> <span class="main">âˆˆ</span> <span class="free">A</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">âˆˆ</span> <span class="skolem">a</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">with</span></span> assms <span class="keyword1"><span class="command">have</span></span> xx<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">âˆˆ</span> carrier <span class="free">G</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> subgroup.subset <span class="keyword1"><span class="command">unfolding</span></span> FactGroup_def RCOSETS_def r_coset_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">force</span>
    <span class="keyword1"><span class="command">from</span></span> assms a <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">y</span></span> <span class="keyword2"><span class="keyword">where</span></span> y<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">y</span> <span class="main">âˆˆ</span> carrier <span class="free">G</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">a</span> <span class="main">=</span> <span class="free">H</span> <span class="main">#&gt;</span> <span class="skolem">y</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> subgroup.subset <span class="keyword1"><span class="command">unfolding</span></span> FactGroup_def RCOSETS_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">force</span>
    <span class="keyword1"><span class="command">with</span></span> a <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">âˆˆ</span> <span class="free">H</span> <span class="main">#&gt;</span> <span class="skolem">y</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="free">H</span> <span class="main">#&gt;</span> <span class="skolem">y</span> <span class="main">=</span> <span class="free">H</span> <span class="main">#&gt;</span> <span class="skolem">x</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> y is_subgroup repr_independence <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">with</span></span> y<span class="main">(</span>2<span class="main">)</span> a<span class="main">(</span>1<span class="main">)</span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">H</span> <span class="main">#&gt;</span> <span class="skolem">x</span> <span class="main">âˆˆ</span> <span class="free">A</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">with</span></span> xx <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">âˆˆ</span> <span class="main">{</span><span class="bound"><span class="bound">x</span></span> <span class="main">âˆˆ</span> carrier <span class="free">G</span><span class="main">.</span> <span class="free">H</span> <span class="main">#&gt;</span> <span class="bound">x</span> <span class="main">âˆˆ</span> <span class="free">A</span><span class="main">}</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">qed</span></span>
<span class="keyword1"><span class="command">next</span></span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">{</span><span class="bound"><span class="bound">x</span></span> <span class="main">âˆˆ</span> carrier <span class="free">G</span><span class="main">.</span> <span class="free">H</span> <span class="main">#&gt;</span> <span class="bound">x</span> <span class="main">âˆˆ</span> <span class="free">A</span><span class="main">}</span> <span class="main">âŠ†</span> <span class="main">â‹ƒ</span><span class="free">A</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span>
    <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">x</span>
    <span class="keyword3"><span class="command">assume</span></span> x<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">âˆˆ</span> <span class="main">{</span><span class="bound"><span class="bound">x</span></span> <span class="main">âˆˆ</span> carrier <span class="free">G</span><span class="main">.</span> <span class="free">H</span> <span class="main">#&gt;</span> <span class="bound">x</span> <span class="main">âˆˆ</span> <span class="free">A</span><span class="main">}</span>"</span></span>
    <span class="keyword1"><span class="command">hence</span></span> xx<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">âˆˆ</span> carrier <span class="free">G</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="free">H</span> <span class="main">#&gt;</span> <span class="skolem">x</span> <span class="main">âˆˆ</span> <span class="free">A</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">âˆˆ</span> <span class="free">H</span> <span class="main">#&gt;</span> <span class="skolem">x</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> is_subgroup rcos_self xx<span class="main"><span class="main">(</span></span>1<span class="main"><span class="main">)</span></span><span class="main">)</span>
    <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">âˆˆ</span> <span class="main">â‹ƒ</span><span class="free">A</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">qed</span></span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> normal<span class="main">)</span> factgroup_subgroup_union_subgroup<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"subgroup <span class="free">A</span> <span class="main">(</span><span class="free">G</span> <span class="keyword1">Mod</span> <span class="free">H</span><span class="main">)</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"subgroup <span class="main">(</span><span class="main">â‹ƒ</span><span class="free">A</span><span class="main">)</span> <span class="free">G</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"subgroup <span class="main">{</span><span class="bound"><span class="bound">x</span></span> <span class="main">âˆˆ</span> carrier <span class="free">G</span><span class="main">.</span> <span class="free">H</span> <span class="main">#&gt;</span> <span class="bound">x</span> <span class="main">âˆˆ</span> <span class="free">A</span><span class="main">}</span> <span class="free">G</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span>
    <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">{</span><span class="bound"><span class="bound">x</span></span> <span class="main">âˆˆ</span> carrier <span class="free">G</span><span class="main">.</span> <span class="free">H</span> <span class="main">#&gt;</span> <span class="bound">x</span> <span class="main">âˆˆ</span> <span class="free">A</span><span class="main">}</span> <span class="main">âŠ†</span> carrier <span class="free">G</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">next</span></span>
    <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">x</span> <span class="skolem">y</span>
    <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">âˆˆ</span> <span class="main">{</span><span class="bound"><span class="bound">x</span></span> <span class="main">âˆˆ</span> carrier <span class="free">G</span><span class="main">.</span> <span class="free">H</span> <span class="main">#&gt;</span> <span class="bound">x</span> <span class="main">âˆˆ</span> <span class="free">A</span><span class="main">}</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">y</span> <span class="main">âˆˆ</span> <span class="main">{</span><span class="bound"><span class="bound">x</span></span> <span class="main">âˆˆ</span> carrier <span class="free">G</span><span class="main">.</span> <span class="free">H</span> <span class="main">#&gt;</span> <span class="bound">x</span> <span class="main">âˆˆ</span> <span class="free">A</span><span class="main">}</span>"</span></span>
    <span class="keyword1"><span class="command">hence</span></span> x<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">âˆˆ</span> carrier <span class="free">G</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="free">H</span> <span class="main">#&gt;</span> <span class="skolem">x</span> <span class="main">âˆˆ</span> <span class="free">A</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> y<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">y</span> <span class="main">âˆˆ</span> carrier <span class="free">G</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="free">H</span> <span class="main">#&gt;</span> <span class="skolem">y</span> <span class="main">âˆˆ</span> <span class="free">A</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">hence</span></span> xyG<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">âŠ—</span> <span class="skolem">y</span> <span class="main">âˆˆ</span> carrier <span class="free">G</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> m_closed<span class="main">)</span>
    <span class="keyword1"><span class="command">from</span></span> assms x y <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">H</span> <span class="main">#&gt;</span> <span class="skolem">x</span><span class="main">)</span> <span class="main">&lt;#&gt;</span> <span class="main">(</span><span class="free">H</span> <span class="main">#&gt;</span> <span class="skolem">y</span><span class="main">)</span> <span class="main">âˆˆ</span> <span class="free">A</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> subgroup.m_closed <span class="keyword1"><span class="command">unfolding</span></span> FactGroup_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">fastforce</span>
    <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="free">H</span> <span class="main">#&gt;</span> <span class="main">(</span><span class="skolem">x</span> <span class="main">âŠ—</span> <span class="skolem">y</span><span class="main">)</span> <span class="main">âˆˆ</span> <span class="free">A</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> rcos_sum x<span class="main"><span class="main">(</span></span>1<span class="main"><span class="main">)</span></span> y<span class="main"><span class="main">(</span></span>1<span class="main"><span class="main">)</span></span><span class="main">)</span>
    <span class="keyword1"><span class="command">with</span></span> xyG <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">âŠ—</span> <span class="skolem">y</span> <span class="main">âˆˆ</span> <span class="main">{</span><span class="bound"><span class="bound">x</span></span> <span class="main">âˆˆ</span> carrier <span class="free">G</span><span class="main">.</span> <span class="free">H</span> <span class="main">#&gt;</span> <span class="bound">x</span> <span class="main">âˆˆ</span> <span class="free">A</span><span class="main">}</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">next</span></span>
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">H</span> <span class="main">#&gt;</span> <span class="main">ğŸ­</span> <span class="main">âˆˆ</span> <span class="free">A</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms subgroup.one_closed <span class="keyword1"><span class="command">unfolding</span></span> FactGroup_def <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> coset_mult_one monoid.select_convs<span class="main"><span class="main">(</span></span>2<span class="main"><span class="main">)</span></span> subset<span class="main">)</span>
    <span class="keyword1"><span class="command">with</span></span> assms one_closed <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">ğŸ­</span> <span class="main">âˆˆ</span> <span class="main">{</span><span class="bound"><span class="bound">x</span></span> <span class="main">âˆˆ</span> carrier <span class="free">G</span><span class="main">.</span> <span class="free">H</span> <span class="main">#&gt;</span> <span class="bound">x</span> <span class="main">âˆˆ</span> <span class="free">A</span><span class="main">}</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">next</span></span>
    <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">x</span>
    <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">âˆˆ</span> <span class="main">{</span><span class="bound"><span class="bound">x</span></span> <span class="main">âˆˆ</span> carrier <span class="free">G</span><span class="main">.</span> <span class="free">H</span> <span class="main">#&gt;</span> <span class="bound">x</span> <span class="main">âˆˆ</span> <span class="free">A</span><span class="main">}</span>"</span></span>
    <span class="keyword1"><span class="command">hence</span></span> x<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">âˆˆ</span> carrier <span class="free">G</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="free">H</span> <span class="main">#&gt;</span> <span class="skolem">x</span> <span class="main">âˆˆ</span> <span class="free">A</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">hence</span></span> invx<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="keyword1">inv</span> <span class="skolem">x</span> <span class="main">âˆˆ</span> carrier <span class="free">G</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> inv_closed <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">from</span></span> assms x <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">set_inv</span> <span class="main">(</span><span class="free">H</span> <span class="main">#&gt;</span> <span class="skolem">x</span><span class="main">)</span> <span class="main">âˆˆ</span> <span class="free">A</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> subgroup.m_inv_closed <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> inv_FactGroup subgroup.mem_carrier<span class="main">)</span>
    <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="free">H</span> <span class="main">#&gt;</span> <span class="main">(</span><span class="keyword1">inv</span> <span class="skolem">x</span><span class="main">)</span> <span class="main">âˆˆ</span> <span class="free">A</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> rcos_inv x<span class="main"><span class="main">(</span></span>1<span class="main"><span class="main">)</span></span><span class="main">)</span>
    <span class="keyword1"><span class="command">with</span></span> invx <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">inv</span> <span class="skolem">x</span> <span class="main">âˆˆ</span> <span class="main">{</span><span class="bound"><span class="bound">x</span></span> <span class="main">âˆˆ</span> carrier <span class="free">G</span><span class="main">.</span> <span class="free">H</span> <span class="main">#&gt;</span> <span class="bound">x</span> <span class="main">âˆˆ</span> <span class="free">A</span><span class="main">}</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">with</span></span> assms factgroup_subgroup_union_char <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> normal<span class="main">)</span> factgroup_subgroup_union_normal<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">A</span> <span class="main">âŠ²</span> <span class="main">(</span><span class="free">G</span> <span class="keyword1">Mod</span> <span class="free">H</span><span class="main">)</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">â‹ƒ</span><span class="free">A</span> <span class="main">âŠ²</span> <span class="free">G</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span> 
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">{</span><span class="bound"><span class="bound">x</span></span> <span class="main">âˆˆ</span> carrier <span class="free">G</span><span class="main">.</span> <span class="free">H</span> <span class="main">#&gt;</span> <span class="bound">x</span> <span class="main">âˆˆ</span> <span class="free">A</span><span class="main">}</span> <span class="main">âŠ²</span> <span class="free">G</span>"</span></span>
  <span class="keyword1"><span class="command">unfolding</span></span> normal_def normal_axioms_def
  <span class="keyword1"><span class="command">proof</span></span> <span class="operator">auto</span> <span class="comment1">(*(auto del: equalityI)*)</span>
    <span class="keyword1"><span class="command">from</span></span> assms <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"subgroup <span class="main">{</span><span class="bound"><span class="bound">x</span></span> <span class="main">âˆˆ</span> carrier <span class="free">G</span><span class="main">.</span> <span class="free">H</span> <span class="main">#&gt;</span> <span class="bound">x</span> <span class="main">âˆˆ</span> <span class="free">A</span><span class="main">}</span> <span class="free">G</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> <span class="main"><span class="main">(</span></span>full_types<span class="main"><span class="main">)</span></span> factgroup_subgroup_union_char factgroup_subgroup_union_subgroup normal_imp_subgroup<span class="main">)</span>
  <span class="keyword1"><span class="command">next</span></span>
    <span class="keyword1"><span class="command">interpret</span></span> Anormal<span class="main">:</span> normal <span class="quoted"><span class="free">A</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">G</span> <span class="keyword1">Mod</span> <span class="free">H</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">x</span> <span class="skolem">y</span>
    <span class="keyword3"><span class="command">assume</span></span> x<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">âˆˆ</span> carrier <span class="free">G</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">y</span> <span class="main">âˆˆ</span> <span class="main">{</span><span class="bound"><span class="bound">x</span></span> <span class="main">âˆˆ</span> carrier <span class="free">G</span><span class="main">.</span> <span class="free">H</span> <span class="main">#&gt;</span> <span class="bound">x</span> <span class="main">âˆˆ</span> <span class="free">A</span><span class="main">}</span> <span class="main">#&gt;</span> <span class="skolem">x</span>"</span></span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">x'</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x'</span> <span class="main">âˆˆ</span> <span class="main">{</span><span class="bound"><span class="bound">x</span></span> <span class="main">âˆˆ</span> carrier <span class="free">G</span><span class="main">.</span> <span class="free">H</span> <span class="main">#&gt;</span> <span class="bound">x</span> <span class="main">âˆˆ</span> <span class="free">A</span><span class="main">}</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">y</span> <span class="main">=</span> <span class="skolem">x'</span> <span class="main">âŠ—</span> <span class="skolem">x</span>"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> r_coset_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">hence</span></span> x'<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">x'</span> <span class="main">âˆˆ</span> carrier <span class="free">G</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="free">H</span> <span class="main">#&gt;</span> <span class="skolem">x'</span> <span class="main">âˆˆ</span> <span class="free">A</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">from</span></span> x<span class="main">(</span>1<span class="main">)</span> <span class="keyword1"><span class="command">have</span></span> Hx<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="free">H</span> <span class="main">#&gt;</span> <span class="skolem">x</span> <span class="main">âˆˆ</span> carrier <span class="main">(</span><span class="free">G</span> <span class="keyword1">Mod</span> <span class="free">H</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> FactGroup_def RCOSETS_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">force</span>
    <span class="keyword1"><span class="command">with</span></span> x' <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="keyword1">inv</span><span class="hidden">â‡˜</span><sub><span class="free">G</span> <span class="keyword1">Mod</span> <span class="free">H</span></sub><span class="hidden">â‡™</span> <span class="main">(</span><span class="free">H</span> <span class="main">#&gt;</span> <span class="skolem">x</span><span class="main">)</span><span class="main">)</span> <span class="main">âŠ—</span><span class="hidden">â‡˜</span><sub><span class="free">G</span> <span class="keyword1">Mod</span> <span class="free">H</span></sub><span class="hidden">â‡™</span> <span class="main">(</span><span class="free">H</span> <span class="main">#&gt;</span> <span class="skolem">x'</span><span class="main">)</span> <span class="main">âŠ—</span><span class="hidden">â‡˜</span><sub><span class="free">G</span> <span class="keyword1">Mod</span> <span class="free">H</span></sub><span class="hidden">â‡™</span> <span class="main">(</span><span class="free">H</span> <span class="main">#&gt;</span> <span class="skolem">x</span><span class="main">)</span> <span class="main">âˆˆ</span> <span class="free">A</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> Anormal.inv_op_closed1 <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="keyword1">set_inv</span> <span class="main">(</span><span class="free">H</span> <span class="main">#&gt;</span> <span class="skolem">x</span><span class="main">)</span><span class="main">)</span> <span class="main">&lt;#&gt;</span> <span class="main">(</span><span class="free">H</span> <span class="main">#&gt;</span> <span class="skolem">x'</span><span class="main">)</span> <span class="main">&lt;#&gt;</span> <span class="main">(</span><span class="free">H</span> <span class="main">#&gt;</span> <span class="skolem">x</span><span class="main">)</span> <span class="main">âˆˆ</span> <span class="free">A</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> inv_FactGroup Hx <span class="keyword1"><span class="command">unfolding</span></span> FactGroup_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">H</span> <span class="main">#&gt;</span> <span class="main">(</span><span class="keyword1">inv</span> <span class="skolem">x</span><span class="main">)</span><span class="main">)</span> <span class="main">&lt;#&gt;</span> <span class="main">(</span><span class="free">H</span> <span class="main">#&gt;</span> <span class="skolem">x'</span><span class="main">)</span> <span class="main">&lt;#&gt;</span> <span class="main">(</span><span class="free">H</span> <span class="main">#&gt;</span> <span class="skolem">x</span><span class="main">)</span> <span class="main">âˆˆ</span> <span class="free">A</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> x<span class="main">(</span>1<span class="main">)</span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> rcos_inv<span class="main">)</span>
    <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">H</span> <span class="main">#&gt;</span> <span class="main">(</span><span class="keyword1">inv</span> <span class="skolem">x</span> <span class="main">âŠ—</span> <span class="skolem">x'</span><span class="main">)</span><span class="main">)</span> <span class="main">&lt;#&gt;</span> <span class="main">(</span><span class="free">H</span> <span class="main">#&gt;</span> <span class="skolem">x</span><span class="main">)</span> <span class="main">âˆˆ</span> <span class="free">A</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> inv_closed rcos_sum x'<span class="main"><span class="main">(</span></span>1<span class="main"><span class="main">)</span></span> x<span class="main"><span class="main">(</span></span>1<span class="main"><span class="main">)</span></span><span class="main">)</span>
    <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="free">H</span> <span class="main">#&gt;</span> <span class="main">(</span><span class="keyword1">inv</span> <span class="skolem">x</span> <span class="main">âŠ—</span> <span class="skolem">x'</span> <span class="main">âŠ—</span> <span class="skolem">x</span><span class="main">)</span> <span class="main">âˆˆ</span> <span class="free">A</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> inv_closed m_closed rcos_sum x'<span class="main"><span class="main">(</span></span>1<span class="main"><span class="main">)</span></span> x<span class="main"><span class="main">(</span></span>1<span class="main"><span class="main">)</span></span><span class="main">)</span>
    <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">inv</span> <span class="skolem">x</span> <span class="main">âŠ—</span> <span class="skolem">x'</span> <span class="main">âŠ—</span> <span class="skolem">x</span> <span class="main">âˆˆ</span> carrier <span class="free">G</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> x x' <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> inv_closed m_closed<span class="main">)</span>
    <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">inv</span> <span class="skolem">x</span> <span class="main">âŠ—</span> <span class="skolem">x'</span> <span class="main">âŠ—</span> <span class="skolem">x</span> <span class="main">âˆˆ</span> <span class="main">{</span><span class="bound"><span class="bound">x</span></span> <span class="main">âˆˆ</span> carrier <span class="free">G</span><span class="main">.</span> <span class="free">H</span> <span class="main">#&gt;</span> <span class="bound">x</span> <span class="main">âˆˆ</span> <span class="free">A</span><span class="main">}</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">hence</span></span> xcoset<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">âŠ—</span> <span class="main">(</span><span class="keyword1">inv</span> <span class="skolem">x</span> <span class="main">âŠ—</span> <span class="skolem">x'</span> <span class="main">âŠ—</span> <span class="skolem">x</span><span class="main">)</span> <span class="main">âˆˆ</span> <span class="skolem">x</span> <span class="main">&lt;#</span> <span class="main">{</span><span class="bound"><span class="bound">x</span></span> <span class="main">âˆˆ</span> carrier <span class="free">G</span><span class="main">.</span> <span class="free">H</span> <span class="main">#&gt;</span> <span class="bound">x</span> <span class="main">âˆˆ</span> <span class="free">A</span><span class="main">}</span>"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> l_coset_def <span class="keyword1"><span class="command">using</span></span> x<span class="main">(</span>1<span class="main">)</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">âŠ—</span> <span class="main">(</span><span class="keyword1">inv</span> <span class="skolem">x</span> <span class="main">âŠ—</span> <span class="skolem">x'</span> <span class="main">âŠ—</span> <span class="skolem">x</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="skolem">x</span> <span class="main">âŠ—</span> <span class="keyword1">inv</span> <span class="skolem">x</span><span class="main">)</span> <span class="main">âŠ—</span> <span class="skolem">x'</span> <span class="main">âŠ—</span> <span class="skolem">x</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> Units_eq Units_inv_Units m_assoc m_closed x'<span class="main"><span class="main">(</span></span>1<span class="main"><span class="main">)</span></span> x<span class="main"><span class="main">(</span></span>1<span class="main"><span class="main">)</span></span><span class="main">)</span>
    <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">â€¦</span> <span class="main">=</span> <span class="skolem">x'</span> <span class="main">âŠ—</span> <span class="skolem">x</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> l_one r_inv x'<span class="main"><span class="main">(</span></span>1<span class="main"><span class="main">)</span></span> x<span class="main"><span class="main">(</span></span>1<span class="main"><span class="main">)</span></span><span class="main">)</span>
    <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">â€¦</span> <span class="main">=</span> <span class="skolem">y</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> <span class="quoted"><span class="quoted">â€¹<span class="skolem">y</span> <span class="main">=</span> <span class="skolem">x'</span> <span class="main">âŠ—</span> <span class="skolem">x</span>â€º</span></span><span class="main">)</span>
    <span class="keyword1"><span class="command">finally</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">âŠ—</span> <span class="main">(</span><span class="keyword1">inv</span> <span class="skolem">x</span> <span class="main">âŠ—</span> <span class="skolem">x'</span> <span class="main">âŠ—</span> <span class="skolem">x</span><span class="main">)</span> <span class="main">=</span> <span class="skolem">y</span>"</span></span><span class="keyword1"><span class="command">.</span></span>
    <span class="keyword1"><span class="command">with</span></span> xcoset <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">y</span> <span class="main">âˆˆ</span> <span class="skolem">x</span> <span class="main">&lt;#</span> <span class="main">{</span><span class="bound"><span class="bound">x</span></span> <span class="main">âˆˆ</span> carrier <span class="free">G</span><span class="main">.</span> <span class="free">H</span> <span class="main">#&gt;</span> <span class="bound">x</span> <span class="main">âˆˆ</span> <span class="free">A</span><span class="main">}</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">next</span></span>
    <span class="keyword1"><span class="command">interpret</span></span> Anormal<span class="main">:</span> normal <span class="quoted"><span class="free">A</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">G</span> <span class="keyword1">Mod</span> <span class="free">H</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">x</span> <span class="skolem">y</span>
    <span class="keyword3"><span class="command">assume</span></span> x<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">âˆˆ</span> carrier <span class="free">G</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">y</span> <span class="main">âˆˆ</span> <span class="skolem">x</span> <span class="main">&lt;#</span> <span class="main">{</span><span class="bound"><span class="bound">x</span></span> <span class="main">âˆˆ</span> carrier <span class="free">G</span><span class="main">.</span> <span class="free">H</span> <span class="main">#&gt;</span> <span class="bound">x</span> <span class="main">âˆˆ</span> <span class="free">A</span><span class="main">}</span>"</span></span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">x'</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x'</span> <span class="main">âˆˆ</span> <span class="main">{</span><span class="bound"><span class="bound">x</span></span> <span class="main">âˆˆ</span> carrier <span class="free">G</span><span class="main">.</span> <span class="free">H</span> <span class="main">#&gt;</span> <span class="bound">x</span> <span class="main">âˆˆ</span> <span class="free">A</span><span class="main">}</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">y</span> <span class="main">=</span> <span class="skolem">x</span> <span class="main">âŠ—</span> <span class="skolem">x'</span>"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> l_coset_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">hence</span></span> x'<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">x'</span> <span class="main">âˆˆ</span> carrier <span class="free">G</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="free">H</span> <span class="main">#&gt;</span> <span class="skolem">x'</span> <span class="main">âˆˆ</span> <span class="free">A</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">from</span></span> x<span class="main">(</span>1<span class="main">)</span> <span class="keyword1"><span class="command">have</span></span> invx<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="keyword1">inv</span> <span class="skolem">x</span> <span class="main">âˆˆ</span> carrier <span class="free">G</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> inv_closed<span class="main">)</span>
    <span class="keyword1"><span class="command">hence</span></span> Hinvx<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="free">H</span> <span class="main">#&gt;</span> <span class="main">(</span><span class="keyword1">inv</span> <span class="skolem">x</span><span class="main">)</span> <span class="main">âˆˆ</span> carrier <span class="main">(</span><span class="free">G</span> <span class="keyword1">Mod</span> <span class="free">H</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> FactGroup_def RCOSETS_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">force</span>
    <span class="keyword1"><span class="command">with</span></span> x' <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="keyword1">inv</span><span class="hidden">â‡˜</span><sub><span class="free">G</span> <span class="keyword1">Mod</span> <span class="free">H</span></sub><span class="hidden">â‡™</span> <span class="main">(</span><span class="free">H</span> <span class="main">#&gt;</span> <span class="keyword1">inv</span> <span class="skolem">x</span><span class="main">)</span><span class="main">)</span> <span class="main">âŠ—</span><span class="hidden">â‡˜</span><sub><span class="free">G</span> <span class="keyword1">Mod</span> <span class="free">H</span></sub><span class="hidden">â‡™</span> <span class="main">(</span><span class="free">H</span> <span class="main">#&gt;</span> <span class="skolem">x'</span><span class="main">)</span> <span class="main">âŠ—</span><span class="hidden">â‡˜</span><sub><span class="free">G</span> <span class="keyword1">Mod</span> <span class="free">H</span></sub><span class="hidden">â‡™</span> <span class="main">(</span><span class="free">H</span> <span class="main">#&gt;</span> <span class="keyword1">inv</span> <span class="skolem">x</span><span class="main">)</span> <span class="main">âˆˆ</span> <span class="free">A</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> invx Anormal.inv_op_closed1 <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="keyword1">set_inv</span> <span class="main">(</span><span class="free">H</span> <span class="main">#&gt;</span> <span class="keyword1">inv</span> <span class="skolem">x</span><span class="main">)</span><span class="main">)</span> <span class="main">&lt;#&gt;</span> <span class="main">(</span><span class="free">H</span> <span class="main">#&gt;</span> <span class="skolem">x'</span><span class="main">)</span> <span class="main">&lt;#&gt;</span> <span class="main">(</span><span class="free">H</span> <span class="main">#&gt;</span> <span class="keyword1">inv</span> <span class="skolem">x</span><span class="main">)</span> <span class="main">âˆˆ</span> <span class="free">A</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> inv_FactGroup Hinvx <span class="keyword1"><span class="command">unfolding</span></span> FactGroup_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">H</span> <span class="main">#&gt;</span> <span class="keyword1">inv</span> <span class="main">(</span><span class="keyword1">inv</span> <span class="skolem">x</span><span class="main">)</span><span class="main">)</span> <span class="main">&lt;#&gt;</span> <span class="main">(</span><span class="free">H</span> <span class="main">#&gt;</span> <span class="skolem">x'</span><span class="main">)</span> <span class="main">&lt;#&gt;</span> <span class="main">(</span><span class="free">H</span> <span class="main">#&gt;</span> <span class="keyword1">inv</span> <span class="skolem">x</span><span class="main">)</span> <span class="main">âˆˆ</span> <span class="free">A</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> invx <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> rcos_inv<span class="main">)</span>
    <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">H</span> <span class="main">#&gt;</span> <span class="skolem">x</span><span class="main">)</span> <span class="main">&lt;#&gt;</span> <span class="main">(</span><span class="free">H</span> <span class="main">#&gt;</span> <span class="skolem">x'</span><span class="main">)</span> <span class="main">&lt;#&gt;</span> <span class="main">(</span><span class="free">H</span> <span class="main">#&gt;</span> <span class="keyword1">inv</span> <span class="skolem">x</span><span class="main">)</span> <span class="main">âˆˆ</span> <span class="free">A</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> inv_inv x<span class="main"><span class="main">(</span></span>1<span class="main"><span class="main">)</span></span><span class="main">)</span>
    <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">H</span> <span class="main">#&gt;</span> <span class="main">(</span><span class="skolem">x</span> <span class="main">âŠ—</span> <span class="skolem">x'</span><span class="main">)</span><span class="main">)</span> <span class="main">&lt;#&gt;</span> <span class="main">(</span><span class="free">H</span> <span class="main">#&gt;</span> <span class="keyword1">inv</span> <span class="skolem">x</span><span class="main">)</span> <span class="main">âˆˆ</span> <span class="free">A</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> rcos_sum x'<span class="main"><span class="main">(</span></span>1<span class="main"><span class="main">)</span></span> x<span class="main"><span class="main">(</span></span>1<span class="main"><span class="main">)</span></span><span class="main">)</span>
    <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="free">H</span> <span class="main">#&gt;</span> <span class="main">(</span><span class="skolem">x</span> <span class="main">âŠ—</span> <span class="skolem">x'</span> <span class="main">âŠ—</span> <span class="keyword1">inv</span> <span class="skolem">x</span><span class="main">)</span> <span class="main">âˆˆ</span> <span class="free">A</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> inv_closed m_closed rcos_sum x'<span class="main"><span class="main">(</span></span>1<span class="main"><span class="main">)</span></span> x<span class="main"><span class="main">(</span></span>1<span class="main"><span class="main">)</span></span><span class="main">)</span>
    <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">âŠ—</span> <span class="skolem">x'</span> <span class="main">âŠ—</span> <span class="keyword1">inv</span> <span class="skolem">x</span> <span class="main">âˆˆ</span> carrier <span class="free">G</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> x x' <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> inv_closed m_closed<span class="main">)</span>
    <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">âŠ—</span> <span class="skolem">x'</span> <span class="main">âŠ—</span> <span class="keyword1">inv</span> <span class="skolem">x</span> <span class="main">âˆˆ</span> <span class="main">{</span><span class="bound"><span class="bound">x</span></span> <span class="main">âˆˆ</span> carrier <span class="free">G</span><span class="main">.</span> <span class="free">H</span> <span class="main">#&gt;</span> <span class="bound">x</span> <span class="main">âˆˆ</span> <span class="free">A</span><span class="main">}</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">hence</span></span> xcoset<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">x</span> <span class="main">âŠ—</span> <span class="skolem">x'</span> <span class="main">âŠ—</span> <span class="keyword1">inv</span> <span class="skolem">x</span><span class="main">)</span> <span class="main">âŠ—</span> <span class="skolem">x</span> <span class="main">âˆˆ</span> <span class="main">{</span><span class="bound"><span class="bound">x</span></span> <span class="main">âˆˆ</span> carrier <span class="free">G</span><span class="main">.</span> <span class="free">H</span> <span class="main">#&gt;</span> <span class="bound">x</span> <span class="main">âˆˆ</span> <span class="free">A</span><span class="main">}</span> <span class="main">#&gt;</span> <span class="skolem">x</span>"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> r_coset_def <span class="keyword1"><span class="command">using</span></span> invx <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">x</span> <span class="main">âŠ—</span> <span class="skolem">x'</span> <span class="main">âŠ—</span> <span class="keyword1">inv</span> <span class="skolem">x</span><span class="main">)</span> <span class="main">âŠ—</span> <span class="skolem">x</span> <span class="main">=</span> <span class="main">(</span><span class="skolem">x</span> <span class="main">âŠ—</span> <span class="skolem">x'</span><span class="main">)</span> <span class="main">âŠ—</span> <span class="main">(</span><span class="keyword1">inv</span> <span class="skolem">x</span> <span class="main">âŠ—</span> <span class="skolem">x</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> Units_eq Units_inv_Units m_assoc m_closed x'<span class="main"><span class="main">(</span></span>1<span class="main"><span class="main">)</span></span> x<span class="main"><span class="main">(</span></span>1<span class="main"><span class="main">)</span></span><span class="main">)</span>
    <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">â€¦</span> <span class="main">=</span> <span class="skolem">x</span> <span class="main">âŠ—</span> <span class="skolem">x'</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> x<span class="main">(</span>1<span class="main">)</span> l_inv x'<span class="main">(</span>1<span class="main">)</span> m_closed r_one <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">â€¦</span> <span class="main">=</span> <span class="skolem">y</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> <span class="quoted"><span class="quoted">â€¹<span class="skolem">y</span> <span class="main">=</span> <span class="skolem">x</span> <span class="main">âŠ—</span> <span class="skolem">x'</span>â€º</span></span><span class="main">)</span>
    <span class="keyword1"><span class="command">finally</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">âŠ—</span> <span class="skolem">x'</span> <span class="main">âŠ—</span> <span class="keyword1">inv</span> <span class="skolem">x</span> <span class="main">âŠ—</span> <span class="skolem">x</span> <span class="main">=</span> <span class="skolem">y</span>"</span></span><span class="keyword1"><span class="command">.</span></span>
    <span class="keyword1"><span class="command">with</span></span> xcoset <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">y</span> <span class="main">âˆˆ</span> <span class="main">{</span><span class="bound"><span class="bound">x</span></span> <span class="main">âˆˆ</span> carrier <span class="free">G</span><span class="main">.</span> <span class="free">H</span> <span class="main">#&gt;</span> <span class="bound">x</span> <span class="main">âˆˆ</span> <span class="free">A</span><span class="main">}</span> <span class="main">#&gt;</span> <span class="skolem">x</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">with</span></span> assms <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> <span class="main"><span class="main">(</span></span>full_types<span class="main"><span class="main">)</span></span> factgroup_subgroup_union_char normal_imp_subgroup<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> normal<span class="main">)</span> factgroup_subgroup_union_factor<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"subgroup <span class="free">A</span> <span class="main">(</span><span class="free">G</span> <span class="keyword1">Mod</span> <span class="free">H</span><span class="main">)</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">A</span> <span class="main">=</span> <span class="keyword1">rcosets</span><span class="hidden">â‡˜</span><sub><span class="free">G</span><span class="main">â¦‡</span>carrier <span class="main">:=</span> <span class="main">â‹ƒ</span><span class="free">A</span><span class="main">â¦ˆ</span></sub><span class="hidden">â‡™</span> <span class="free">H</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">A</span> <span class="main">=</span> <span class="keyword1">rcosets</span><span class="hidden">â‡˜</span><sub><span class="free">G</span><span class="main">â¦‡</span>carrier <span class="main">:=</span> <span class="main">{</span><span class="bound"><span class="bound">x</span></span> <span class="main">âˆˆ</span> carrier <span class="free">G</span><span class="main">.</span> <span class="free">H</span> <span class="main">#&gt;</span> <span class="bound">x</span> <span class="main">âˆˆ</span> <span class="free">A</span><span class="main">}</span><span class="main">â¦ˆ</span></sub><span class="hidden">â‡™</span> <span class="free">H</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="operator">auto</span>
    <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">U</span>
    <span class="keyword3"><span class="command">assume</span></span> U<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">U</span> <span class="main">âˆˆ</span> <span class="free">A</span>"</span></span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">x'</span></span> <span class="keyword2"><span class="keyword">where</span></span> x'<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">x'</span> <span class="main">âˆˆ</span> carrier <span class="free">G</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">U</span> <span class="main">=</span> <span class="free">H</span> <span class="main">#&gt;</span> <span class="skolem">x'</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms subgroup.subset <span class="keyword1"><span class="command">unfolding</span></span> FactGroup_def RCOSETS_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">force</span>
    <span class="keyword1"><span class="command">with</span></span> U <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">H</span> <span class="main">#&gt;</span> <span class="skolem">x'</span> <span class="main">âˆˆ</span> <span class="free">A</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">with</span></span> x' <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">U</span> <span class="main">âˆˆ</span> <span class="keyword1">rcosets</span><span class="hidden">â‡˜</span><sub><span class="free">G</span><span class="main">â¦‡</span>carrier <span class="main">:=</span> <span class="main">{</span><span class="bound"><span class="bound">x</span></span> <span class="main">âˆˆ</span> carrier <span class="free">G</span><span class="main">.</span> <span class="free">H</span> <span class="main">#&gt;</span> <span class="bound">x</span> <span class="main">âˆˆ</span> <span class="free">A</span><span class="main">}</span><span class="main">â¦ˆ</span></sub><span class="hidden">â‡™</span> <span class="free">H</span>"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> RCOSETS_def r_coset_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">next</span></span>
    <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">U</span>
    <span class="keyword3"><span class="command">assume</span></span> U<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">U</span> <span class="main">âˆˆ</span> <span class="keyword1">rcosets</span><span class="hidden">â‡˜</span><sub><span class="free">G</span><span class="main">â¦‡</span>carrier <span class="main">:=</span> <span class="main">{</span><span class="bound"><span class="bound">x</span></span> <span class="main">âˆˆ</span> carrier <span class="free">G</span><span class="main">.</span> <span class="free">H</span> <span class="main">#&gt;</span> <span class="bound">x</span> <span class="main">âˆˆ</span> <span class="free">A</span><span class="main">}</span><span class="main">â¦ˆ</span></sub><span class="hidden">â‡™</span> <span class="free">H</span>"</span></span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">x'</span></span> <span class="keyword2"><span class="keyword">where</span></span> x'<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">x'</span> <span class="main">âˆˆ</span> <span class="main">{</span><span class="bound"><span class="bound">x</span></span> <span class="main">âˆˆ</span> carrier <span class="free">G</span><span class="main">.</span> <span class="free">H</span> <span class="main">#&gt;</span> <span class="bound">x</span> <span class="main">âˆˆ</span> <span class="free">A</span><span class="main">}</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">U</span> <span class="main">=</span> <span class="free">H</span> <span class="main">#&gt;</span> <span class="skolem">x'</span>"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> RCOSETS_def r_coset_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x'</span> <span class="main">âˆˆ</span> carrier <span class="free">G</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="free">H</span> <span class="main">#&gt;</span> <span class="skolem">x'</span> <span class="main">âˆˆ</span> <span class="free">A</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">with</span></span> x' <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">U</span> <span class="main">âˆˆ</span> <span class="free">A</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">with</span></span> assms <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> factgroup_subgroup_union_char <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>


<span class="keyword1"><span class="command">section</span></span>  <span class="quoted"><span class="plain_text">â€¹Flattening the type of group carriersâ€º</span></span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">â€¹Flattening here means to convert the type of group elements from 'a set to 'a.
This is possible whenever the empty set is not an element of the group.â€º</span></span>


<span class="keyword1"><span class="command">definition</span></span> <span class="entity">flatten</span> <span class="keyword2"><span class="keyword">where</span></span>
  <span class="quoted"><span class="quoted">"<span class="free">flatten</span> <span class="main">(</span><span class="free"><span class="bound"><span class="entity">G</span></span></span><span class="main">::</span><span class="main">(</span><span class="tfree">'a</span> set<span class="main">,</span> <span class="tfree">'b</span><span class="main">)</span> monoid_scheme<span class="main">)</span> <span class="free"><span class="bound"><span class="entity">rep</span></span></span> <span class="main">=</span> <span class="main">â¦‡</span>carrier<span class="main">=</span><span class="main">(</span><span class="free"><span class="bound"><span class="entity">rep</span></span></span> <span class="main">`</span> <span class="main">(</span>carrier <span class="free"><span class="bound"><span class="entity">G</span></span></span><span class="main">)</span><span class="main">)</span><span class="main">,</span>
      monoid.mult<span class="main">=</span><span class="main">(</span><span class="main">Î»</span> <span class="bound">x</span> <span class="bound">y</span><span class="main">.</span> <span class="free"><span class="bound"><span class="entity">rep</span></span></span> <span class="main">(</span><span class="main">(</span>the_inv_into <span class="main">(</span>carrier <span class="free"><span class="bound"><span class="entity">G</span></span></span><span class="main">)</span> <span class="free"><span class="bound"><span class="entity">rep</span></span></span> <span class="bound">x</span><span class="main">)</span> <span class="main">âŠ—</span><span class="hidden">â‡˜</span><sub><span class="free"><span class="bound"><span class="entity">G</span></span></span></sub><span class="hidden">â‡™</span> <span class="main">(</span>the_inv_into <span class="main">(</span>carrier <span class="free"><span class="bound"><span class="entity">G</span></span></span><span class="main">)</span> <span class="free"><span class="bound"><span class="entity">rep</span></span></span> <span class="bound">y</span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">,</span> 
      one<span class="main">=</span><span class="free"><span class="bound"><span class="entity">rep</span></span></span> <span class="main">ğŸ­</span><span class="hidden">â‡˜</span><sub><span class="free"><span class="bound"><span class="entity">G</span></span></span></sub><span class="hidden">â‡™</span> <span class="main">â¦ˆ</span>"</span></span>

<span class="keyword1" id="SubgroupsAndNormalSubgroups-flatten_set_group_hom"><span class="command">lemma</span></span> flatten_set_group_hom<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> group<span class="main">:</span><span class="quoted"><span class="quoted">"group <span class="free">G</span>"</span></span>
  <span class="keyword2"><span class="keyword">assumes</span></span> inj<span class="main">:</span><span class="quoted"><span class="quoted">"inj_on <span class="free">rep</span> <span class="main">(</span>carrier <span class="free">G</span><span class="main">)</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">rep</span> <span class="main">âˆˆ</span> hom <span class="free">G</span> <span class="main">(</span>flatten <span class="free">G</span> <span class="free">rep</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">unfolding</span></span> hom_def
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">auto</span>
  <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">g</span>
  <span class="keyword3"><span class="command">assume</span></span> g<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">g</span> <span class="main">âˆˆ</span> carrier <span class="free">G</span>"</span></span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"<span class="free">rep</span> <span class="skolem">g</span> <span class="main">âˆˆ</span> carrier <span class="main">(</span>flatten <span class="free">G</span> <span class="free">rep</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> flatten_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">next</span></span>
  <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">g</span> <span class="skolem">h</span>
  <span class="keyword3"><span class="command">assume</span></span> g<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">g</span> <span class="main">âˆˆ</span> carrier <span class="free">G</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> h<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">h</span> <span class="main">âˆˆ</span> carrier <span class="free">G</span>"</span></span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="free">rep</span> <span class="skolem">g</span> <span class="main">âˆˆ</span> carrier <span class="main">(</span>flatten <span class="free">G</span> <span class="free">rep</span><span class="main">)</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="free">rep</span> <span class="skolem">h</span> <span class="main">âˆˆ</span> carrier <span class="main">(</span>flatten <span class="free">G</span> <span class="free">rep</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> flatten_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="free">rep</span> <span class="skolem">g</span> <span class="main">âŠ—</span><span class="hidden">â‡˜</span><sub>flatten <span class="free">G</span> <span class="free">rep</span></sub><span class="hidden">â‡™</span> <span class="free">rep</span> <span class="skolem">h</span>
    <span class="main">=</span> <span class="free">rep</span> <span class="main">(</span>the_inv_into <span class="main">(</span>carrier <span class="free">G</span><span class="main">)</span> <span class="free">rep</span> <span class="main">(</span><span class="free">rep</span> <span class="skolem">g</span><span class="main">)</span> <span class="main">âŠ—</span><span class="hidden">â‡˜</span><sub><span class="free">G</span></sub><span class="hidden">â‡™</span> the_inv_into <span class="main">(</span>carrier <span class="free">G</span><span class="main">)</span> <span class="free">rep</span> <span class="main">(</span><span class="free">rep</span> <span class="skolem">h</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> flatten_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">â€¦</span> <span class="main">=</span> <span class="free">rep</span> <span class="main">(</span><span class="skolem">g</span> <span class="main">âŠ—</span><span class="hidden">â‡˜</span><sub><span class="free">G</span></sub><span class="hidden">â‡™</span> <span class="skolem">h</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> inj g h <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> the_inv_into_f_f<span class="main">)</span>
  <span class="keyword1"><span class="command">finally</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="free">rep</span> <span class="main">(</span><span class="skolem">g</span> <span class="main">âŠ—</span><span class="hidden">â‡˜</span><sub><span class="free">G</span></sub><span class="hidden">â‡™</span> <span class="skolem">h</span><span class="main">)</span> <span class="main">=</span> <span class="free">rep</span> <span class="skolem">g</span> <span class="main">âŠ—</span><span class="hidden">â‡˜</span><sub>flatten <span class="free">G</span> <span class="free">rep</span></sub><span class="hidden">â‡™</span> <span class="free">rep</span> <span class="skolem">h</span>"</span></span><span class="keyword1"><span class="command">..</span></span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="SubgroupsAndNormalSubgroups-flatten_set_group"><span class="command">lemma</span></span> flatten_set_group<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> group<span class="main">:</span><span class="quoted"><span class="quoted">"group <span class="free">G</span>"</span></span>
  <span class="keyword2"><span class="keyword">assumes</span></span> inj<span class="main">:</span><span class="quoted"><span class="quoted">"inj_on <span class="free">rep</span> <span class="main">(</span>carrier <span class="free">G</span><span class="main">)</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"group <span class="main">(</span>flatten <span class="free">G</span> <span class="free">rep</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">rule</span> groupI<span class="main">)</span>
  <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">x</span> <span class="skolem">y</span>
  <span class="keyword3"><span class="command">assume</span></span> x<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">âˆˆ</span> carrier <span class="main">(</span>flatten <span class="free">G</span> <span class="free">rep</span><span class="main">)</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> y<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">y</span> <span class="main">âˆˆ</span> carrier <span class="main">(</span>flatten <span class="free">G</span> <span class="free">rep</span><span class="main">)</span>"</span></span>
  <span class="keyword3"><span class="command">define</span></span> <span class="skolem"><span class="skolem">g</span></span> <span class="skolem"><span class="skolem">h</span></span>
    <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">g</span> <span class="main">=</span> the_inv_into <span class="main">(</span>carrier <span class="free">G</span><span class="main">)</span> <span class="free">rep</span> <span class="skolem">x</span>"</span></span>
      <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">h</span> <span class="main">=</span> the_inv_into <span class="main">(</span>carrier <span class="free">G</span><span class="main">)</span> <span class="free">rep</span> <span class="skolem">y</span>"</span></span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">âŠ—</span><span class="hidden">â‡˜</span><sub>flatten <span class="free">G</span> <span class="free">rep</span></sub><span class="hidden">â‡™</span> <span class="skolem">y</span> <span class="main">=</span> <span class="free">rep</span> <span class="main">(</span><span class="skolem">g</span> <span class="main">âŠ—</span><span class="hidden">â‡˜</span><sub><span class="free">G</span></sub><span class="hidden">â‡™</span> <span class="skolem">h</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> flatten_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> g_def h_def <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">g</span> <span class="main">âˆˆ</span> carrier <span class="free">G</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">h</span> <span class="main">âˆˆ</span> carrier <span class="free">G</span>"</span></span> 
    <span class="keyword1"><span class="command">using</span></span> inj x y the_inv_into_into <span class="keyword1"><span class="command">unfolding</span></span> flatten_def <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> partial_object.select_convs<span class="main"><span class="main">(</span></span>1<span class="main"><span class="main">)</span></span> subset_refl<span class="main">)</span><span class="main"><span class="keyword3">+</span></span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">g</span> <span class="main">âŠ—</span><span class="hidden">â‡˜</span><sub><span class="free">G</span></sub><span class="hidden">â‡™</span> <span class="skolem">h</span> <span class="main">âˆˆ</span> carrier <span class="free">G</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> group group.is_monoid monoid.m_closed<span class="main">)</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="free">rep</span> <span class="main">(</span><span class="skolem">g</span> <span class="main">âŠ—</span><span class="hidden">â‡˜</span><sub><span class="free">G</span></sub><span class="hidden">â‡™</span> <span class="skolem">h</span><span class="main">)</span> <span class="main">âˆˆ</span> carrier <span class="main">(</span>flatten <span class="free">G</span> <span class="free">rep</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> flatten_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">âŠ—</span><span class="hidden">â‡˜</span><sub>flatten <span class="free">G</span> <span class="free">rep</span></sub><span class="hidden">â‡™</span> <span class="skolem">y</span> <span class="main">âˆˆ</span> carrier <span class="main">(</span>flatten <span class="free">G</span> <span class="free">rep</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">next</span></span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">ğŸ­</span><span class="hidden">â‡˜</span><sub>flatten <span class="free">G</span> <span class="free">rep</span></sub><span class="hidden">â‡™</span> <span class="main">âˆˆ</span> carrier <span class="main">(</span>flatten <span class="free">G</span> <span class="free">rep</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> flatten_def <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> group group.is_monoid<span class="main">)</span>
<span class="keyword1"><span class="command">next</span></span>
  <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">x</span> <span class="skolem">y</span> <span class="skolem">z</span>
  <span class="keyword3"><span class="command">assume</span></span> x<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">âˆˆ</span> carrier <span class="main">(</span>flatten <span class="free">G</span> <span class="free">rep</span><span class="main">)</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> y<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">y</span> <span class="main">âˆˆ</span> carrier <span class="main">(</span>flatten <span class="free">G</span> <span class="free">rep</span><span class="main">)</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> z<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">z</span> <span class="main">âˆˆ</span> carrier <span class="main">(</span>flatten <span class="free">G</span> <span class="free">rep</span><span class="main">)</span>"</span></span>
  <span class="keyword3"><span class="command">define</span></span> <span class="skolem"><span class="skolem">g</span></span> <span class="skolem"><span class="skolem">h</span></span> <span class="skolem"><span class="skolem">k</span></span>
    <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">g</span> <span class="main">=</span> the_inv_into <span class="main">(</span>carrier <span class="free">G</span><span class="main">)</span> <span class="free">rep</span> <span class="skolem">x</span>"</span></span>
      <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">h</span> <span class="main">=</span> the_inv_into <span class="main">(</span>carrier <span class="free">G</span><span class="main">)</span> <span class="free">rep</span> <span class="skolem">y</span>"</span></span>
      <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">k</span> <span class="main">=</span> the_inv_into <span class="main">(</span>carrier <span class="free">G</span><span class="main">)</span> <span class="free">rep</span> <span class="skolem">z</span>"</span></span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">âŠ—</span><span class="hidden">â‡˜</span><sub>flatten <span class="free">G</span> <span class="free">rep</span></sub><span class="hidden">â‡™</span> <span class="skolem">y</span> <span class="main">âŠ—</span><span class="hidden">â‡˜</span><sub>flatten <span class="free">G</span> <span class="free">rep</span></sub><span class="hidden">â‡™</span> <span class="skolem">z</span> <span class="main">=</span> <span class="main">(</span><span class="free">rep</span> <span class="main">(</span><span class="skolem">g</span> <span class="main">âŠ—</span><span class="hidden">â‡˜</span><sub><span class="free">G</span></sub><span class="hidden">â‡™</span> <span class="skolem">h</span><span class="main">)</span><span class="main">)</span> <span class="main">âŠ—</span> <span class="hidden">â‡˜</span><sub>flatten <span class="free">G</span> <span class="free">rep</span></sub><span class="hidden">â‡™</span> <span class="skolem">z</span>"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> flatten_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">â€¦</span> <span class="main">=</span> <span class="free">rep</span> <span class="main">(</span>the_inv_into <span class="main">(</span>carrier <span class="free">G</span><span class="main">)</span> <span class="free">rep</span> <span class="main">(</span><span class="free">rep</span> <span class="main">(</span><span class="skolem">g</span> <span class="main">âŠ—</span><span class="hidden">â‡˜</span><sub><span class="free">G</span></sub><span class="hidden">â‡™</span> <span class="skolem">h</span><span class="main">)</span><span class="main">)</span> <span class="main">âŠ—</span><span class="hidden">â‡˜</span><sub><span class="free">G</span></sub><span class="hidden">â‡™</span> <span class="skolem">k</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> k_def <span class="keyword1"><span class="command">unfolding</span></span> flatten_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">from</span></span> g_def h_def k_def <span class="keyword1"><span class="command">have</span></span> ghkG<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">g</span> <span class="main">âˆˆ</span> carrier <span class="free">G</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">h</span> <span class="main">âˆˆ</span> carrier <span class="free">G</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">k</span> <span class="main">âˆˆ</span> carrier <span class="free">G</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> inj x y z the_inv_into_into <span class="keyword1"><span class="command">unfolding</span></span> flatten_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">fastforce</span><span class="main"><span class="keyword3">+</span></span>
  <span class="keyword1"><span class="command">hence</span></span> gh<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">g</span> <span class="main">âŠ—</span><span class="hidden">â‡˜</span><sub><span class="free">G</span></sub><span class="hidden">â‡™</span> <span class="skolem">h</span> <span class="main">âˆˆ</span> carrier <span class="free">G</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> hk<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">h</span> <span class="main">âŠ—</span><span class="hidden">â‡˜</span><sub><span class="free">G</span></sub><span class="hidden">â‡™</span> <span class="skolem">k</span> <span class="main">âˆˆ</span> carrier <span class="free">G</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> group group.is_monoid monoid.m_closed<span class="main">)</span><span class="main"><span class="keyword3">+</span></span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="free">rep</span> <span class="main">(</span>the_inv_into <span class="main">(</span>carrier <span class="free">G</span><span class="main">)</span> <span class="free">rep</span> <span class="main">(</span><span class="free">rep</span> <span class="main">(</span><span class="skolem">g</span> <span class="main">âŠ—</span><span class="hidden">â‡˜</span><sub><span class="free">G</span></sub><span class="hidden">â‡™</span> <span class="skolem">h</span><span class="main">)</span><span class="main">)</span> <span class="main">âŠ—</span><span class="hidden">â‡˜</span><sub><span class="free">G</span></sub><span class="hidden">â‡™</span> <span class="skolem">k</span><span class="main">)</span> <span class="main">=</span> <span class="free">rep</span> <span class="main">(</span><span class="main">(</span><span class="skolem">g</span> <span class="main">âŠ—</span><span class="hidden">â‡˜</span><sub><span class="free">G</span></sub><span class="hidden">â‡™</span> <span class="skolem">h</span><span class="main">)</span> <span class="main">âŠ—</span><span class="hidden">â‡˜</span><sub><span class="free">G</span></sub><span class="hidden">â‡™</span> <span class="skolem">k</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">unfolding</span></span> flatten_def <span class="keyword1"><span class="command">using</span></span> inj the_inv_into_f_f <span class="keyword1"><span class="command">by</span></span> <span class="operator">fastforce</span>
  <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">â€¦</span> <span class="main">=</span> <span class="free">rep</span> <span class="main">(</span><span class="skolem">g</span> <span class="main">âŠ—</span><span class="hidden">â‡˜</span><sub><span class="free">G</span></sub><span class="hidden">â‡™</span> <span class="main">(</span><span class="skolem">h</span> <span class="main">âŠ—</span><span class="hidden">â‡˜</span><sub><span class="free">G</span></sub><span class="hidden">â‡™</span> <span class="skolem">k</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> group group.is_monoid ghkG monoid.m_assoc <span class="keyword1"><span class="command">by</span></span> <span class="operator">fastforce</span>
  <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">â€¦</span> <span class="main">=</span> <span class="skolem">x</span> <span class="main">âŠ—</span><span class="hidden">â‡˜</span><sub>flatten <span class="free">G</span> <span class="free">rep</span></sub><span class="hidden">â‡™</span> <span class="main">(</span><span class="free">rep</span> <span class="main">(</span><span class="skolem">h</span> <span class="main">âŠ—</span><span class="hidden">â‡˜</span><sub><span class="free">G</span></sub><span class="hidden">â‡™</span> <span class="skolem">k</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> g_def flatten_def <span class="keyword1"><span class="command">using</span></span> hk inj the_inv_into_f_f <span class="keyword1"><span class="command">by</span></span> <span class="operator">fastforce</span>
  <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">â€¦</span> <span class="main">=</span> <span class="skolem">x</span> <span class="main">âŠ—</span><span class="hidden">â‡˜</span><sub>flatten <span class="free">G</span> <span class="free">rep</span></sub><span class="hidden">â‡™</span> <span class="main">(</span><span class="skolem">y</span> <span class="main">âŠ—</span><span class="hidden">â‡˜</span><sub>flatten <span class="free">G</span> <span class="free">rep</span></sub><span class="hidden">â‡™</span> <span class="skolem">z</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> h_def k_def flatten_def <span class="keyword1"><span class="command">using</span></span> x y <span class="keyword1"><span class="command">by</span></span> <span class="operator">force</span>
  <span class="keyword1"><span class="command">finally</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">âŠ—</span><span class="hidden">â‡˜</span><sub>flatten <span class="free">G</span> <span class="free">rep</span></sub><span class="hidden">â‡™</span> <span class="skolem">y</span> <span class="main">âŠ—</span><span class="hidden">â‡˜</span><sub>flatten <span class="free">G</span> <span class="free">rep</span></sub><span class="hidden">â‡™</span> <span class="skolem">z</span> <span class="main">=</span> <span class="skolem">x</span> <span class="main">âŠ—</span><span class="hidden">â‡˜</span><sub>flatten <span class="free">G</span> <span class="free">rep</span></sub><span class="hidden">â‡™</span> <span class="main">(</span><span class="skolem">y</span> <span class="main">âŠ—</span><span class="hidden">â‡˜</span><sub>flatten <span class="free">G</span> <span class="free">rep</span></sub><span class="hidden">â‡™</span> <span class="skolem">z</span><span class="main">)</span>"</span></span><span class="keyword1"><span class="command">.</span></span>
<span class="keyword1"><span class="command">next</span></span>
  <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">x</span>
  <span class="keyword3"><span class="command">assume</span></span> x<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">âˆˆ</span> carrier <span class="main">(</span>flatten <span class="free">G</span> <span class="free">rep</span><span class="main">)</span>"</span></span>
  <span class="keyword3"><span class="command">define</span></span> <span class="skolem"><span class="skolem">g</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">g</span> <span class="main">=</span> the_inv_into <span class="main">(</span>carrier <span class="free">G</span><span class="main">)</span> <span class="free">rep</span> <span class="skolem">x</span>"</span></span>
  <span class="keyword1"><span class="command">hence</span></span> gG<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">g</span> <span class="main">âˆˆ</span> carrier <span class="free">G</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> inj x <span class="keyword1"><span class="command">unfolding</span></span> flatten_def <span class="keyword1"><span class="command">using</span></span> the_inv_into_into <span class="keyword1"><span class="command">by</span></span> <span class="operator">force</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">ğŸ­</span><span class="hidden">â‡˜</span><sub><span class="free">G</span></sub><span class="hidden">â‡™</span> <span class="main">âˆˆ</span> <span class="main">(</span>carrier <span class="free">G</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> group group.is_monoid<span class="main">)</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"the_inv_into <span class="main">(</span>carrier <span class="free">G</span><span class="main">)</span> <span class="free">rep</span> <span class="main">(</span><span class="main">ğŸ­</span><span class="hidden">â‡˜</span><sub>flatten <span class="free">G</span> <span class="free">rep</span></sub><span class="hidden">â‡™</span><span class="main">)</span> <span class="main">=</span> <span class="main">ğŸ­</span><span class="hidden">â‡˜</span><sub><span class="free">G</span></sub><span class="hidden">â‡™</span>"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> flatten_def <span class="keyword1"><span class="command">using</span></span> the_inv_into_f_f inj <span class="keyword1"><span class="command">by</span></span> <span class="operator">force</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="main">ğŸ­</span><span class="hidden">â‡˜</span><sub>flatten <span class="free">G</span> <span class="free">rep</span></sub><span class="hidden">â‡™</span> <span class="main">âŠ—</span><span class="hidden">â‡˜</span><sub>flatten <span class="free">G</span> <span class="free">rep</span></sub><span class="hidden">â‡™</span> <span class="skolem">x</span> <span class="main">=</span> <span class="free">rep</span> <span class="main">(</span><span class="main">ğŸ­</span><span class="hidden">â‡˜</span><sub><span class="free">G</span></sub><span class="hidden">â‡™</span> <span class="main">âŠ—</span><span class="hidden">â‡˜</span><sub><span class="free">G</span></sub><span class="hidden">â‡™</span> <span class="skolem">g</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> flatten_def g_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">â€¦</span> <span class="main">=</span> <span class="free">rep</span> <span class="skolem">g</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> gG group <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> group.is_monoid monoid.l_one<span class="main">)</span>
  <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">â€¦</span> <span class="main">=</span> <span class="skolem">x</span>"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> g_def <span class="keyword1"><span class="command">using</span></span> inj x f_the_inv_into_f <span class="keyword1"><span class="command">unfolding</span></span> flatten_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">force</span>
  <span class="keyword1"><span class="command">finally</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">ğŸ­</span><span class="hidden">â‡˜</span><sub>flatten <span class="free">G</span> <span class="free">rep</span></sub><span class="hidden">â‡™</span> <span class="main">âŠ—</span><span class="hidden">â‡˜</span><sub>flatten <span class="free">G</span> <span class="free">rep</span></sub><span class="hidden">â‡™</span> <span class="skolem">x</span> <span class="main">=</span> <span class="skolem">x</span>"</span></span><span class="keyword1"><span class="command">.</span></span>
<span class="keyword1"><span class="command">next</span></span>
  <span class="keyword1"><span class="command">from</span></span> group inj <span class="keyword1"><span class="command">have</span></span> hom<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="free">rep</span> <span class="main">âˆˆ</span> hom <span class="free">G</span> <span class="main">(</span>flatten <span class="free">G</span> <span class="free">rep</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> flatten_set_group_hom <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">x</span>
  <span class="keyword3"><span class="command">assume</span></span> x<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">âˆˆ</span> carrier <span class="main">(</span>flatten <span class="free">G</span> <span class="free">rep</span><span class="main">)</span>"</span></span>
  <span class="keyword3"><span class="command">define</span></span> <span class="skolem"><span class="skolem">g</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">g</span> <span class="main">=</span> the_inv_into <span class="main">(</span>carrier <span class="free">G</span><span class="main">)</span> <span class="free">rep</span> <span class="skolem">x</span>"</span></span>
  <span class="keyword1"><span class="command">hence</span></span> gG<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">g</span> <span class="main">âˆˆ</span> carrier <span class="free">G</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> inj x <span class="keyword1"><span class="command">unfolding</span></span> flatten_def <span class="keyword1"><span class="command">using</span></span> the_inv_into_into <span class="keyword1"><span class="command">by</span></span> <span class="operator">force</span>
  <span class="keyword1"><span class="command">hence</span></span> invG<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="keyword1">inv</span><span class="hidden">â‡˜</span><sub><span class="free">G</span></sub><span class="hidden">â‡™</span> <span class="skolem">g</span> <span class="main">âˆˆ</span> carrier <span class="free">G</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> group group.inv_closed<span class="main">)</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="free">rep</span> <span class="main">(</span><span class="keyword1">inv</span><span class="hidden">â‡˜</span><sub><span class="free">G</span></sub><span class="hidden">â‡™</span> <span class="skolem">g</span><span class="main">)</span> <span class="main">âˆˆ</span> carrier <span class="main">(</span>flatten <span class="free">G</span> <span class="free">rep</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> flatten_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">rep</span> <span class="main">(</span><span class="keyword1">inv</span><span class="hidden">â‡˜</span><sub><span class="free">G</span></sub><span class="hidden">â‡™</span> <span class="skolem">g</span><span class="main">)</span> <span class="main">âŠ—</span><span class="hidden">â‡˜</span><sub>flatten <span class="free">G</span> <span class="free">rep</span></sub><span class="hidden">â‡™</span> <span class="skolem">x</span> <span class="main">=</span> <span class="free">rep</span> <span class="main">(</span><span class="keyword1">inv</span><span class="hidden">â‡˜</span><sub><span class="free">G</span></sub><span class="hidden">â‡™</span> <span class="skolem">g</span><span class="main">)</span> <span class="main">âŠ—</span><span class="hidden">â‡˜</span><sub>flatten <span class="free">G</span> <span class="free">rep</span></sub><span class="hidden">â‡™</span> <span class="main">(</span><span class="free">rep</span> <span class="skolem">g</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">unfolding</span></span> g_def <span class="keyword1"><span class="command">using</span></span> f_the_inv_into_f inj x <span class="keyword1"><span class="command">unfolding</span></span> flatten_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">fastforce</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="free">rep</span> <span class="main">(</span><span class="keyword1">inv</span><span class="hidden">â‡˜</span><sub><span class="free">G</span></sub><span class="hidden">â‡™</span> <span class="skolem">g</span><span class="main">)</span> <span class="main">âŠ—</span><span class="hidden">â‡˜</span><sub>flatten <span class="free">G</span> <span class="free">rep</span></sub><span class="hidden">â‡™</span> <span class="skolem">x</span> <span class="main">=</span> <span class="free">rep</span> <span class="main">(</span><span class="keyword1">inv</span><span class="hidden">â‡˜</span><sub><span class="free">G</span></sub><span class="hidden">â‡™</span> <span class="skolem">g</span> <span class="main">âŠ—</span><span class="hidden">â‡˜</span><sub><span class="free">G</span></sub><span class="hidden">â‡™</span> <span class="skolem">g</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> hom <span class="keyword1"><span class="command">unfolding</span></span> hom_def <span class="keyword1"><span class="command">using</span></span> gG invG hom_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="free">rep</span> <span class="main">(</span><span class="keyword1">inv</span><span class="hidden">â‡˜</span><sub><span class="free">G</span></sub><span class="hidden">â‡™</span> <span class="skolem">g</span><span class="main">)</span> <span class="main">âŠ—</span><span class="hidden">â‡˜</span><sub>flatten <span class="free">G</span> <span class="free">rep</span></sub><span class="hidden">â‡™</span> <span class="skolem">x</span> <span class="main">=</span> <span class="free">rep</span> <span class="main">ğŸ­</span><span class="hidden">â‡˜</span><sub><span class="free">G</span></sub><span class="hidden">â‡™</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> invG gG <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> group group.l_inv<span class="main">)</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="free">rep</span> <span class="main">(</span><span class="keyword1">inv</span><span class="hidden">â‡˜</span><sub><span class="free">G</span></sub><span class="hidden">â‡™</span> <span class="skolem">g</span><span class="main">)</span> <span class="main">âŠ—</span><span class="hidden">â‡˜</span><sub>flatten <span class="free">G</span> <span class="free">rep</span></sub><span class="hidden">â‡™</span> <span class="skolem">x</span> <span class="main">=</span> <span class="main">ğŸ­</span><span class="hidden">â‡˜</span><sub>flatten <span class="free">G</span> <span class="free">rep</span></sub><span class="hidden">â‡™</span>"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> flatten_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">âˆƒ</span><span class="bound">y</span><span class="main">âˆˆ</span>carrier <span class="main">(</span>flatten <span class="free">G</span> <span class="free">rep</span><span class="main">)</span><span class="main">.</span> <span class="bound">y</span> <span class="main">âŠ—</span><span class="hidden">â‡˜</span><sub>flatten <span class="free">G</span> <span class="free">rep</span></sub><span class="hidden">â‡™</span> <span class="skolem">x</span> <span class="main">=</span> <span class="main">ğŸ­</span><span class="hidden">â‡˜</span><sub>flatten <span class="free">G</span> <span class="free">rep</span></sub><span class="hidden">â‡™</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> normal<span class="main">)</span> flatten_set_group_mod_inj<span class="main">:</span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"inj_on <span class="main">(</span><span class="main">Î»</span><span class="bound">U</span><span class="main">.</span> <span class="keyword1">SOME</span> <span class="bound">g</span><span class="main">.</span> <span class="bound">g</span> <span class="main">âˆˆ</span> <span class="bound">U</span><span class="main">)</span> <span class="main">(</span>carrier <span class="main">(</span><span class="free">G</span> <span class="keyword1">Mod</span> <span class="free">H</span><span class="main">)</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">rule</span> inj_onI<span class="main">)</span>
  <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">U</span> <span class="skolem">V</span>
  <span class="keyword3"><span class="command">assume</span></span> U<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">U</span> <span class="main">âˆˆ</span> carrier <span class="main">(</span><span class="free">G</span> <span class="keyword1">Mod</span> <span class="free">H</span><span class="main">)</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> V<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">V</span> <span class="main">âˆˆ</span> carrier <span class="main">(</span><span class="free">G</span> <span class="keyword1">Mod</span> <span class="free">H</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">g</span></span> <span class="skolem"><span class="skolem">h</span></span> <span class="keyword2"><span class="keyword">where</span></span> g<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">U</span> <span class="main">=</span> <span class="free">H</span> <span class="main">#&gt;</span> <span class="skolem">g</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">g</span> <span class="main">âˆˆ</span> carrier <span class="free">G</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> h<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">V</span> <span class="main">=</span> <span class="free">H</span> <span class="main">#&gt;</span> <span class="skolem">h</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">h</span> <span class="main">âˆˆ</span> carrier <span class="free">G</span>"</span></span>
    <span class="keyword1"><span class="command">unfolding</span></span> FactGroup_def RCOSETS_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">hence</span></span> notempty<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">U</span> <span class="main">â‰ </span> <span class="main">{}</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">V</span> <span class="main">â‰ </span> <span class="main">{}</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> empty_iff is_subgroup rcos_self<span class="main">)</span><span class="main"><span class="keyword3">+</span></span>
  <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="keyword1">SOME</span> <span class="bound">g</span><span class="main">.</span> <span class="bound">g</span> <span class="main">âˆˆ</span> <span class="skolem">U</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="keyword1">SOME</span> <span class="bound">g</span><span class="main">.</span> <span class="bound">g</span> <span class="main">âˆˆ</span> <span class="skolem">V</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">with</span></span> notempty <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="keyword1">SOME</span> <span class="bound">g</span><span class="main">.</span> <span class="bound">g</span> <span class="main">âˆˆ</span> <span class="skolem">U</span><span class="main">)</span> <span class="main">âˆˆ</span> <span class="skolem">U</span> <span class="main">âˆ©</span> <span class="skolem">V</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> IntI ex_in_conv someI<span class="main">)</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">U</span> <span class="main">=</span> <span class="skolem">V</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> Int_iff g h is_subgroup repr_independence<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> normal<span class="main">)</span> flatten_set_group_mod<span class="main">:</span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"group <span class="main">(</span>flatten <span class="main">(</span><span class="free">G</span> <span class="keyword1">Mod</span> <span class="free">H</span><span class="main">)</span> <span class="main">(</span><span class="main">Î»</span><span class="bound">U</span><span class="main">.</span> <span class="keyword1">SOME</span> <span class="bound">g</span><span class="main">.</span> <span class="bound">g</span> <span class="main">âˆˆ</span> <span class="bound">U</span><span class="main">)</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">using</span></span> factorgroup_is_group flatten_set_group_mod_inj <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> flatten_set_group<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> normal<span class="main">)</span> flatten_set_group_mod_iso<span class="main">:</span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">Î»</span><span class="bound">U</span><span class="main">.</span> <span class="keyword1">SOME</span> <span class="bound">g</span><span class="main">.</span> <span class="bound">g</span> <span class="main">âˆˆ</span> <span class="bound">U</span><span class="main">)</span> <span class="main">âˆˆ</span> iso <span class="main">(</span><span class="free">G</span> <span class="keyword1">Mod</span> <span class="free">H</span><span class="main">)</span> <span class="main">(</span>flatten <span class="main">(</span><span class="free">G</span> <span class="keyword1">Mod</span> <span class="free">H</span><span class="main">)</span> <span class="main">(</span><span class="main">Î»</span><span class="bound">U</span><span class="main">.</span> <span class="keyword1">SOME</span> <span class="bound">g</span><span class="main">.</span> <span class="bound">g</span> <span class="main">âˆˆ</span> <span class="bound">U</span><span class="main">)</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">unfolding</span></span> iso_def bij_betw_def
<span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">auto</span><span class="main">)</span>
 <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">metis</span> flatten_set_group_mod_inj factorgroup_is_group flatten_set_group_hom<span class="main">)</span>
 <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">rule</span> flatten_set_group_mod_inj<span class="main">)</span>
 <span class="keyword1"><span class="command">unfolding</span></span> flatten_def <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">auto</span><span class="main">)</span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">done</span></span></span></span>

<span class="keyword2"><span class="keyword">end</span></span>
</pre>
</div><div id="SimpleGroups">
<div class="head">
<h1>Theory SimpleGroups</h1>
</div>
<pre class="source"><span class="comment1">(*  Title:      Simple Groups
    Author:     Jakob von Raumer, Karlsruhe Institute of Technology
    Maintainer: Jakob von Raumer &lt;jakob.raumer@student.kit.edu&gt;
*)</span>

<span class="keyword1"><span class="command">theory</span></span> SimpleGroups
<span class="keyword2"><span class="keyword">imports</span></span>
  <a href="SubgroupsAndNormalSubgroups.html">SubgroupsAndNormalSubgroups</a>
  <a href="../Secondary_Sylow/SndSylow.html">Secondary_Sylow.SndSylow</a>
  <a href="SndIsomorphismGrp.html">SndIsomorphismGrp</a>
<span class="keyword2"><span class="keyword">begin</span></span>

<span class="keyword1"><span class="command">section</span></span> <span class="quoted"><span class="plain_text">â€¹Simple Groupsâ€º</span></span>

<span class="keyword1"><span class="command">locale</span></span> simple_group <span class="main">=</span> group <span class="main">+</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> order_gt_one<span class="main">:</span><span class="quoted"><span class="quoted">"order <span class="free">G</span> <span class="main">&gt;</span> <span class="main">1</span>"</span></span>
  <span class="keyword2"><span class="keyword">assumes</span></span> no_real_normal_subgroup<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="main">â‹€</span><span class="bound">H</span><span class="main">.</span> <span class="bound">H</span> <span class="main">âŠ²</span> <span class="free">G</span> <span class="main">âŸ¹</span> <span class="main">(</span><span class="bound">H</span> <span class="main">=</span> carrier <span class="free">G</span> <span class="main">âˆ¨</span> <span class="bound">H</span> <span class="main">=</span> <span class="main">{</span><span class="main">ğŸ­</span><span class="main">}</span><span class="main">)</span>"</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> simple_group<span class="main">)</span> is_simple_group<span class="main">:</span> <span class="quoted"><span class="quoted">"simple_group <span class="free">G</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> simple_group_axioms<span class="main">)</span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">â€¹Simple groups are non-trivial.â€º</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> simple_group<span class="main">)</span> simple_not_triv<span class="main">:</span> <span class="quoted"><span class="quoted">"carrier <span class="free">G</span> <span class="main">â‰ </span> <span class="main">{</span><span class="main">ğŸ­</span><span class="main">}</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> order_gt_one <span class="keyword1"><span class="command">unfolding</span></span> order_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">â€¹Every group of prime order is simpleâ€º</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> group<span class="main">)</span> prime_order_simple<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> prime<span class="main">:</span><span class="quoted"><span class="quoted">"prime <span class="main">(</span>order <span class="free">G</span><span class="main">)</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"simple_group <span class="free">G</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span>
  <span class="keyword1"><span class="command">from</span></span> prime <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">1</span> <span class="main">&lt;</span> order <span class="free">G</span>"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> prime_nat_iff <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">next</span></span>
  <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">H</span>
  <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">H</span> <span class="main">âŠ²</span> <span class="free">G</span>"</span></span>
  <span class="keyword1"><span class="command">hence</span></span> HG<span class="main">:</span><span class="quoted"><span class="quoted">"subgroup <span class="skolem">H</span> <span class="free">G</span>"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> normal_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"card <span class="skolem">H</span> <span class="keyword1">dvd</span> order <span class="free">G</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> card_subgrp_dvd<span class="main">)</span>
  <span class="keyword1"><span class="command">with</span></span> prime <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"card <span class="skolem">H</span> <span class="main">=</span> <span class="main">1</span> <span class="main">âˆ¨</span> card <span class="skolem">H</span> <span class="main">=</span> order <span class="free">G</span>"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> prime_nat_iff <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">H</span> <span class="main">=</span> carrier <span class="free">G</span> <span class="main">âˆ¨</span> <span class="skolem">H</span> <span class="main">=</span> <span class="main">{</span><span class="main">ğŸ­</span><span class="main">}</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span>
    <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"card <span class="skolem">H</span> <span class="main">=</span> <span class="main">1</span>"</span></span>
    <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> HG <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">ğŸ­</span> <span class="main">âˆˆ</span> <span class="skolem">H</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> subgroup.one_closed<span class="main">)</span>
    <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> card_Suc_eq<span class="main">)</span>
  <span class="keyword1"><span class="command">next</span></span>
    <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"card <span class="skolem">H</span> <span class="main">=</span> order <span class="free">G</span>"</span></span>
    <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> HG <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">H</span> <span class="main">âŠ†</span> carrier <span class="free">G</span>"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> subgroup_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> prime <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"card <span class="main">(</span>carrier <span class="free">G</span><span class="main">)</span> <span class="main">&gt;</span> <span class="main">1</span>"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> order_def prime_nat_iff <span class="keyword1"><span class="command">..</span></span>
    <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"finite <span class="main">(</span>carrier <span class="free">G</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span>card_ge_0_finite<span class="main">)</span>
    <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">unfolding</span></span> order_def <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> card_subset_eq<span class="main">)</span>
  <span class="keyword1"><span class="command">qed</span></span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">â€¹Being simple is a property that is preserved by isomorphisms.â€º</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> simple_group<span class="main">)</span> iso_simple<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> H<span class="main">:</span><span class="quoted"><span class="quoted">"group <span class="free">H</span>"</span></span>
  <span class="keyword2"><span class="keyword">assumes</span></span> iso<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="free">Ï†</span> <span class="main">âˆˆ</span> iso <span class="free">G</span> <span class="free">H</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"simple_group <span class="free">H</span>"</span></span>
<span class="keyword1"><span class="command">unfolding</span></span> simple_group_def simple_group_axioms_def <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>1<span class="main">)</span>
<span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">del</span><span class="main"><span class="main">:</span></span> equalityI<span class="main">)</span>
  <span class="keyword1"><span class="command">from</span></span> iso <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"order <span class="free">G</span> <span class="main">=</span> order <span class="free">H</span>"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> iso_def order_def <span class="keyword1"><span class="command">using</span></span> bij_betw_same_card <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">with</span></span> order_gt_one <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"Suc <span class="main">0</span> <span class="main">&lt;</span> order <span class="free">H</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">next</span></span>
  <span class="keyword1"><span class="command">have</span></span> inv_iso<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="main">(</span>inv_into <span class="main">(</span>carrier <span class="free">G</span><span class="main">)</span> <span class="free">Ï†</span><span class="main">)</span> <span class="main">âˆˆ</span> iso <span class="free">H</span> <span class="free">G</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> iso
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> iso_set_sym<span class="main">)</span>    
  <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">N</span>
  <span class="keyword3"><span class="command">assume</span></span> NH<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">N</span> <span class="main">âŠ²</span> <span class="free">H</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> Nneq1<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">N</span> <span class="main">â‰ </span> <span class="main">{</span><span class="main">ğŸ­</span><span class="hidden">â‡˜</span><sub><span class="free">H</span></sub><span class="hidden">â‡™</span><span class="main">}</span>"</span></span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">interpret</span></span> Nnormal<span class="main">:</span> normal <span class="quoted"><span class="skolem">N</span></span> <span class="quoted"><span class="free">H</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword3"><span class="command">define</span></span> <span class="skolem"><span class="skolem">M</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">M</span> <span class="main">=</span> <span class="main">(</span>inv_into <span class="main">(</span>carrier <span class="free">G</span><span class="main">)</span> <span class="free">Ï†</span><span class="main">)</span> <span class="main">`</span> <span class="skolem">N</span>"</span></span>
  <span class="keyword1"><span class="command">hence</span></span> MG<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">M</span> <span class="main">âŠ²</span> <span class="free">G</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> inv_iso NH H <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> is_group iso_normal_subgroup<span class="main">)</span>
  <span class="keyword1"><span class="command">have</span></span> surj<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="free">Ï†</span> <span class="main">`</span> carrier <span class="free">G</span> <span class="main">=</span> carrier <span class="free">H</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> iso <span class="keyword1"><span class="command">unfolding</span></span> iso_def bij_betw_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">hence</span></span> MN<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="free">Ï†</span> <span class="main">`</span> <span class="skolem">M</span> <span class="main">=</span> <span class="skolem">N</span>"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> M_def <span class="keyword1"><span class="command">using</span></span> Nnormal.subset image_inv_into_cancel <span class="keyword1"><span class="command">by</span></span> <span class="operator">metis</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">M</span> <span class="main">â‰ </span> <span class="main">{</span><span class="main">ğŸ­</span><span class="main">}</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span><span class="main">(</span><span class="operator">rule</span> notI<span class="main">)</span>
    <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">M</span> <span class="main">=</span> <span class="main">{</span><span class="main">ğŸ­</span><span class="main">}</span>"</span></span>
    <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="free">Ï†</span> <span class="main">`</span> <span class="skolem">M</span> <span class="main">=</span> <span class="main">{</span><span class="free">Ï†</span> <span class="main">ğŸ­</span><span class="main">}</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> <span class="main"><span class="main">(</span></span>full_types<span class="main"><span class="main">)</span></span> image_empty image_insert<span class="main">)</span>
    <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="free">Ï†</span> <span class="main">`</span> <span class="skolem">M</span> <span class="main">=</span> <span class="main">{</span><span class="main">ğŸ­</span><span class="hidden">â‡˜</span><sub><span class="free">H</span></sub><span class="hidden">â‡™</span><span class="main">}</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> <span class="main"><span class="main">(</span></span>lifting<span class="main"><span class="main">)</span></span> Nnormal.is_subgroup MN calculation singleton_iff subgroup.one_closed<span class="main">)</span>
    <span class="keyword3"><span class="command">thus</span></span> <span class="quoted">False</span> <span class="keyword1"><span class="command">using</span></span> Nneq1 MN <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">M</span> <span class="main">=</span> carrier <span class="free">G</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> no_real_normal_subgroup MG <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">N</span> <span class="main">=</span> carrier <span class="free">H</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> surj <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">â€¹As a corollary of this: Factorizing a group by itself does not result in a simple group!â€º</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> group<span class="main">)</span> self_factor_not_simple<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="main">Â¬</span> simple_group <span class="main">(</span><span class="free">G</span> <span class="keyword1">Mod</span> <span class="main">(</span>carrier <span class="free">G</span><span class="main">)</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span>
  <span class="keyword3"><span class="command">assume</span></span> assm<span class="main">:</span><span class="quoted"><span class="quoted">"simple_group <span class="main">(</span><span class="free">G</span> <span class="keyword1">Mod</span> <span class="main">(</span>carrier <span class="free">G</span><span class="main">)</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"group <span class="main">(</span><span class="free">G</span><span class="main">â¦‡</span>carrier <span class="main">:=</span>  <span class="main">{</span><span class="main">ğŸ­</span><span class="main">}</span><span class="main">â¦ˆ</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> subgroup_imp_group triv_subgroup<span class="main">)</span>
  <span class="keyword1"><span class="command">with</span></span> assm self_factor_iso simple_group.iso_simple <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"simple_group <span class="main">(</span><span class="free">G</span><span class="main">â¦‡</span>carrier <span class="main">:=</span> <span class="main">{</span><span class="main">ğŸ­</span><span class="main">}</span><span class="main">â¦ˆ</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"False"</span></span> <span class="keyword1"><span class="command">using</span></span> simple_group.simple_not_triv <span class="keyword1"><span class="command">by</span></span> <span class="operator">force</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword2"><span class="keyword">end</span></span>
</pre>
</div><div id="MaximalNormalSubgroups">
<div class="head">
<h1>Theory MaximalNormalSubgroups</h1>
</div>
<pre class="source"><span class="comment1">(*  Title:      A locale for and a characterization of maximal normal subgroups
    Author:     Jakob von Raumer, Karlsruhe Institute of Technology
    Maintainer: Jakob von Raumer &lt;jakob.raumer@student.kit.edu&gt;
*)</span>

<span class="keyword1"><span class="command">theory</span></span> MaximalNormalSubgroups
<span class="keyword2"><span class="keyword">imports</span></span>
  <a href="SubgroupsAndNormalSubgroups.html">SubgroupsAndNormalSubgroups</a>
  <a href="SimpleGroups.html">SimpleGroups</a>
<span class="keyword2"><span class="keyword">begin</span></span>

<span class="keyword1"><span class="command">section</span></span> <span class="quoted"><span class="plain_text">â€¹Facts about maximal normal subgroupsâ€º</span></span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">â€¹A maximal normal subgroup of $G$ is a normal subgroup which is not contained in other any proper
  normal subgroup of $G$.â€º</span></span>

<span class="keyword1"><span class="command">locale</span></span> max_normal_subgroup <span class="main">=</span> normal <span class="main">+</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> proper<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="free">H</span> <span class="main">â‰ </span> carrier <span class="free">G</span>"</span></span>
  <span class="keyword2"><span class="keyword">assumes</span></span> max_normal<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="main">â‹€</span><span class="bound">J</span><span class="main">.</span> <span class="bound">J</span> <span class="main">âŠ²</span> <span class="free">G</span> <span class="main">âŸ¹</span> <span class="bound">J</span> <span class="main">â‰ </span> <span class="free">H</span> <span class="main">âŸ¹</span> <span class="bound">J</span> <span class="main">â‰ </span> carrier <span class="free">G</span> <span class="main">âŸ¹</span> <span class="main">Â¬</span> <span class="main">(</span><span class="free">H</span> <span class="main">âŠ†</span> <span class="bound">J</span><span class="main">)</span>"</span></span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">â€¹Another characterization of maximal normal subgroups: The factor group is simple.â€º</span></span>

<span class="keyword1"><span class="command">theorem</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> normal<span class="main">)</span> max_normal_simple_quotient<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> finite<span class="main">:</span><span class="quoted"><span class="quoted">"finite <span class="main">(</span>carrier <span class="free">G</span><span class="main">)</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"max_normal_subgroup <span class="free">H</span> <span class="free">G</span> <span class="main">=</span> simple_group <span class="main">(</span><span class="free">G</span> <span class="keyword1">Mod</span> <span class="free">H</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span>
  <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"max_normal_subgroup <span class="free">H</span> <span class="free">G</span>"</span></span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">interpret</span></span> maxH<span class="main">:</span> max_normal_subgroup <span class="quoted"><span class="free">H</span></span> <span class="quoted"><span class="free">G</span></span><span class="keyword1"><span class="command">.</span></span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"simple_group <span class="main">(</span><span class="free">G</span> <span class="keyword1">Mod</span> <span class="free">H</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> simple_group_def simple_group_axioms_def
  <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">intro</span> conjI factorgroup_is_group allI impI disjCI<span class="main">)</span>
    <span class="keyword1"><span class="command">from</span></span> finite factgroup_finite factorgroup_is_group group.finite_pos_order <span class="keyword1"><span class="command">have</span></span> gt0<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="main">0</span> <span class="main">&lt;</span> card <span class="main">(</span><span class="keyword1">rcosets</span> <span class="free">H</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">unfolding</span></span> FactGroup_def order_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">force</span>
    <span class="keyword1"><span class="command">from</span></span> maxH.proper finite <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"carrier <span class="main">(</span><span class="free">G</span> <span class="keyword1">Mod</span> <span class="free">H</span><span class="main">)</span> <span class="main">â‰ </span> <span class="main">{</span><span class="main">ğŸ­</span><span class="hidden">â‡˜</span><sub><span class="free">G</span> <span class="keyword1">Mod</span> <span class="free">H</span></sub><span class="hidden">â‡™</span><span class="main">}</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> fact_group_trivial_iff <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="main">1</span> <span class="main">â‰ </span> order <span class="main">(</span><span class="free">G</span> <span class="keyword1">Mod</span> <span class="free">H</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> factorgroup_is_group group.order_one_triv_iff <span class="keyword1"><span class="command">by</span></span> <span class="operator">metis</span>
    <span class="keyword1"><span class="command">with</span></span> gt0 <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">1</span> <span class="main">&lt;</span> order <span class="main">(</span><span class="free">G</span> <span class="keyword1">Mod</span> <span class="free">H</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> order_def FactGroup_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">next</span></span>
    <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">A'</span>
    <span class="keyword3"><span class="command">assume</span></span> A'normal<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">A'</span> <span class="main">âŠ²</span> <span class="free">G</span> <span class="keyword1">Mod</span> <span class="free">H</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> A'nottriv<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">A'</span> <span class="main">â‰ </span> <span class="main">{</span><span class="main">ğŸ­</span><span class="hidden">â‡˜</span><sub><span class="free">G</span> <span class="keyword1">Mod</span> <span class="free">H</span></sub><span class="hidden">â‡™</span><span class="main">}</span>"</span></span>
    <span class="keyword3"><span class="command">define</span></span> <span class="skolem"><span class="skolem">A</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">A</span> <span class="main">=</span> <span class="main">â‹ƒ</span><span class="skolem">A'</span>"</span></span>
    <span class="keyword1"><span class="command">have</span></span> A2<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">A</span> <span class="main">âŠ²</span> <span class="free">G</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> A'normal <span class="keyword1"><span class="command">unfolding</span></span> A_def <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> factgroup_subgroup_union_normal<span class="main">)</span>
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">H</span> <span class="main">âˆˆ</span> <span class="skolem">A'</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> A'normal normal_imp_subgroup subgroup.one_closed <span class="keyword1"><span class="command">unfolding</span></span> FactGroup_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">force</span>
    <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="free">H</span> <span class="main">âŠ†</span> <span class="skolem">A</span>"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> A_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">hence</span></span> A1<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="free">H</span> <span class="main">âŠ²</span> <span class="main">(</span><span class="free">G</span><span class="main">â¦‡</span>carrier <span class="main">:=</span> <span class="skolem">A</span><span class="main">â¦ˆ</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> A2 is_normal <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> is_subgroup maxH.max_normal normal_restrict_supergroup subgroup_self<span class="main">)</span>
    <span class="keyword1"><span class="command">have</span></span> A3<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">A'</span> <span class="main">=</span> <span class="keyword1">rcosets</span><span class="hidden">â‡˜</span><sub><span class="free">G</span><span class="main">â¦‡</span>carrier <span class="main">:=</span> <span class="skolem">A</span><span class="main">â¦ˆ</span></sub><span class="hidden">â‡™</span> <span class="free">H</span>"</span></span>
      <span class="keyword1"><span class="command">unfolding</span></span> A_def <span class="keyword1"><span class="command">using</span></span> factgroup_subgroup_union_factor A'normal normal_imp_subgroup <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">from</span></span> A1 <span class="keyword1"><span class="command">interpret</span></span> normalHA<span class="main">:</span> normal <span class="quoted"><span class="free">H</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">G</span><span class="main">â¦‡</span>carrier <span class="main">:=</span> <span class="skolem">A</span><span class="main">â¦ˆ</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">metis</span>
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">H</span> <span class="main">âŠ†</span> <span class="skolem">A</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> normalHA.is_subgroup subgroup.subset <span class="keyword1"><span class="command">by</span></span> <span class="operator">force</span>
    <span class="keyword1"><span class="command">with</span></span> A2 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">A</span> <span class="main">=</span> <span class="free">H</span> <span class="main">âˆ¨</span> <span class="skolem">A</span> <span class="main">=</span> carrier <span class="free">G</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> maxH.max_normal <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">A'</span> <span class="main">=</span> carrier <span class="main">(</span><span class="free">G</span> <span class="keyword1">Mod</span> <span class="free">H</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">proof</span></span> 
      <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">A</span> <span class="main">=</span> <span class="free">H</span>"</span></span>
      <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"carrier <span class="main">(</span><span class="free">G</span><span class="main">â¦‡</span>carrier <span class="main">:=</span> <span class="skolem">A</span><span class="main">â¦ˆ</span> <span class="keyword1">Mod</span> <span class="free">H</span><span class="main">)</span> <span class="main">=</span> <span class="main">{</span><span class="main">ğŸ­</span><span class="hidden">â‡˜</span><sub><span class="main">(</span><span class="free">G</span><span class="main">â¦‡</span>carrier <span class="main">:=</span> <span class="skolem">A</span><span class="main">â¦ˆ</span> <span class="keyword1">Mod</span> <span class="free">H</span><span class="main">)</span></sub><span class="hidden">â‡™</span><span class="main">}</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> finite is_group normalHA.fact_group_trivial_iff normalHA.subgroup_self normalHA.subset subgroup_finite subgroup_of_restricted_group subgroup_of_subgroup subset_antisym<span class="main">)</span>
      <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> <span class="main">{</span><span class="main">ğŸ­</span><span class="hidden">â‡˜</span><sub><span class="free">G</span> <span class="keyword1">Mod</span> <span class="free">H</span></sub><span class="hidden">â‡™</span><span class="main">}</span>"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> FactGroup_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">finally</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">A'</span> <span class="main">=</span> <span class="main">{</span><span class="main">ğŸ­</span><span class="hidden">â‡˜</span><sub><span class="free">G</span> <span class="keyword1">Mod</span> <span class="free">H</span></sub><span class="hidden">â‡™</span><span class="main">}</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> A3 <span class="keyword1"><span class="command">unfolding</span></span> FactGroup_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
      <span class="keyword1"><span class="command">with</span></span> A'nottriv <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span><span class="keyword1"><span class="command">..</span></span>
    <span class="keyword1"><span class="command">next</span></span>
      <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">A</span> <span class="main">=</span> carrier <span class="free">G</span>"</span></span>
      <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">G</span><span class="main">â¦‡</span>carrier <span class="main">:=</span> <span class="skolem">A</span><span class="main">â¦ˆ</span> <span class="keyword1">Mod</span> <span class="free">H</span><span class="main">)</span> <span class="main">=</span> <span class="free">G</span> <span class="keyword1">Mod</span> <span class="free">H</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">A'</span> <span class="main">=</span> carrier <span class="main">(</span><span class="free">G</span> <span class="keyword1">Mod</span> <span class="free">H</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> A3 <span class="keyword1"><span class="command">unfolding</span></span> FactGroup_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">qed</span></span>
<span class="keyword1"><span class="command">next</span></span>
  <span class="keyword3"><span class="command">assume</span></span> simple<span class="main">:</span><span class="quoted"><span class="quoted">"simple_group <span class="main">(</span><span class="free">G</span> <span class="keyword1">Mod</span> <span class="free">H</span><span class="main">)</span>"</span></span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"max_normal_subgroup <span class="free">H</span> <span class="free">G</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span>
    <span class="keyword1"><span class="command">from</span></span> simple <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"carrier <span class="main">(</span><span class="free">G</span> <span class="keyword1">Mod</span> <span class="free">H</span><span class="main">)</span> <span class="main">â‰ </span> <span class="main">{</span><span class="main">ğŸ­</span><span class="hidden">â‡˜</span><sub><span class="free">G</span> <span class="keyword1">Mod</span> <span class="free">H</span></sub><span class="hidden">â‡™</span><span class="main">}</span>"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> simple_group_def simple_group_axioms_def order_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">with</span></span> finite fact_group_trivial_iff <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="free">H</span> <span class="main">â‰ </span> carrier <span class="free">G</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">next</span></span>
    <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">A</span>
    <span class="keyword3"><span class="command">assume</span></span> A<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">A</span> <span class="main">âŠ²</span> <span class="free">G</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">A</span> <span class="main">â‰ </span> <span class="free">H</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">A</span> <span class="main">â‰ </span> carrier <span class="free">G</span>"</span></span>
    <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">Â¬</span> <span class="free">H</span> <span class="main">âŠ†</span> <span class="skolem">A</span>"</span></span>
    <span class="keyword1"><span class="command">proof</span></span>
      <span class="keyword3"><span class="command">assume</span></span> HA<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="free">H</span> <span class="main">âŠ†</span> <span class="skolem">A</span>"</span></span>
      <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="free">H</span> <span class="main">âŠ²</span> <span class="main">(</span><span class="free">G</span><span class="main">â¦‡</span>carrier <span class="main">:=</span> <span class="skolem">A</span><span class="main">â¦ˆ</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> A<span class="main"><span class="main">(</span></span>1<span class="main"><span class="main">)</span></span> inv_op_closed2 is_subgroup normal_inv_iff normal_restrict_supergroup<span class="main">)</span>
      <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">interpret</span></span> normalHA<span class="main">:</span> normal <span class="quoted"><span class="free">H</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">G</span><span class="main">â¦‡</span>carrier <span class="main">:=</span> <span class="skolem">A</span><span class="main">â¦ˆ</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
      <span class="keyword1"><span class="command">from</span></span> finite <span class="keyword1"><span class="command">have</span></span> finiteA<span class="main">:</span><span class="quoted"><span class="quoted">"finite <span class="skolem">A</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> A<span class="main">(</span>1<span class="main">)</span> normal_imp_subgroup <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> subgroup_finite<span class="main">)</span>
      <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">rcosets</span><span class="hidden">â‡˜</span><sub><span class="main">(</span><span class="free">G</span><span class="main">â¦‡</span>carrier <span class="main">:=</span> <span class="skolem">A</span><span class="main">â¦ˆ</span><span class="main">)</span></sub><span class="hidden">â‡™</span> <span class="free">H</span> <span class="main">âŠ²</span> <span class="free">G</span> <span class="keyword1">Mod</span> <span class="free">H</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> normality_factorization is_normal HA A<span class="main">(</span>1<span class="main">)</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">with</span></span> simple <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">rcosets</span><span class="hidden">â‡˜</span><sub><span class="main">(</span><span class="free">G</span><span class="main">â¦‡</span>carrier <span class="main">:=</span> <span class="skolem">A</span><span class="main">â¦ˆ</span><span class="main">)</span></sub><span class="hidden">â‡™</span> <span class="free">H</span> <span class="main">=</span> <span class="main">{</span><span class="main">ğŸ­</span><span class="hidden">â‡˜</span><sub><span class="free">G</span> <span class="keyword1">Mod</span> <span class="free">H</span></sub><span class="hidden">â‡™</span><span class="main">}</span> <span class="main">âˆ¨</span> <span class="keyword1">rcosets</span><span class="hidden">â‡˜</span><sub><span class="main">(</span><span class="free">G</span><span class="main">â¦‡</span>carrier <span class="main">:=</span> <span class="skolem">A</span><span class="main">â¦ˆ</span><span class="main">)</span></sub><span class="hidden">â‡™</span> <span class="free">H</span> <span class="main">=</span> carrier <span class="main">(</span><span class="free">G</span> <span class="keyword1">Mod</span> <span class="free">H</span><span class="main">)</span>"</span></span>
        <span class="keyword1"><span class="command">unfolding</span></span> simple_group_def simple_group_axioms_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"False"</span></span>
      <span class="keyword1"><span class="command">proof</span></span>
        <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">rcosets</span><span class="hidden">â‡˜</span><sub><span class="free">G</span><span class="main">â¦‡</span>carrier <span class="main">:=</span> <span class="skolem">A</span><span class="main">â¦ˆ</span></sub><span class="hidden">â‡™</span> <span class="free">H</span> <span class="main">=</span> <span class="main">{</span><span class="main">ğŸ­</span><span class="hidden">â‡˜</span><sub><span class="free">G</span> <span class="keyword1">Mod</span> <span class="free">H</span></sub><span class="hidden">â‡™</span><span class="main">}</span>"</span></span>
        <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">rcosets</span><span class="hidden">â‡˜</span><sub><span class="free">G</span><span class="main">â¦‡</span>carrier <span class="main">:=</span> <span class="skolem">A</span><span class="main">â¦ˆ</span></sub><span class="hidden">â‡™</span> <span class="free">H</span> <span class="main">=</span> <span class="main">{</span><span class="main">ğŸ­</span><span class="hidden">â‡˜</span><sub><span class="main">(</span><span class="free">G</span><span class="main">â¦‡</span>carrier <span class="main">:=</span> <span class="skolem">A</span><span class="main">â¦ˆ</span><span class="main">)</span> <span class="keyword1">Mod</span> <span class="free">H</span></sub><span class="hidden">â‡™</span><span class="main">}</span>"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> FactGroup_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword1"><span class="command">with</span></span> finiteA <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">H</span> <span class="main">=</span> <span class="skolem">A</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> normalHA.fact_group_trivial_iff <span class="keyword1"><span class="command">unfolding</span></span> FactGroup_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword1"><span class="command">with</span></span> A<span class="main">(</span>2<span class="main">)</span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
      <span class="keyword1"><span class="command">next</span></span>
        <span class="keyword3"><span class="command">assume</span></span> AHGH<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="keyword1">rcosets</span><span class="hidden">â‡˜</span><sub><span class="free">G</span><span class="main">â¦‡</span>carrier <span class="main">:=</span> <span class="skolem">A</span><span class="main">â¦ˆ</span></sub><span class="hidden">â‡™</span> <span class="free">H</span> <span class="main">=</span> carrier <span class="main">(</span><span class="free">G</span> <span class="keyword1">Mod</span> <span class="free">H</span><span class="main">)</span>"</span></span>
        <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">A</span> <span class="main">=</span> carrier <span class="free">G</span>"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> FactGroup_def RCOSETS_def
        <span class="keyword1"><span class="command">proof</span></span>
          <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">A</span> <span class="main">âŠ†</span> carrier <span class="free">G</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> A<span class="main">(</span>1<span class="main">)</span> normal_imp_subgroup subgroup.subset <span class="keyword1"><span class="command">by</span></span> <span class="operator">metis</span>
        <span class="keyword1"><span class="command">next</span></span>
          <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"carrier <span class="free">G</span> <span class="main">âŠ†</span> <span class="skolem">A</span>"</span></span>
          <span class="keyword1"><span class="command">proof</span></span>
            <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">x</span>
            <span class="keyword3"><span class="command">assume</span></span> x<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">âˆˆ</span> carrier <span class="free">G</span>"</span></span>
            <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="free">H</span> <span class="main">#&gt;</span> <span class="skolem">x</span> <span class="main">âˆˆ</span> <span class="keyword1">rcosets</span> <span class="free">H</span>"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> RCOSETS_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
            <span class="keyword1"><span class="command">with</span></span> AHGH <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">H</span> <span class="main">#&gt;</span> <span class="skolem">x</span> <span class="main">âˆˆ</span> <span class="keyword1">rcosets</span><span class="hidden">â‡˜</span><sub><span class="free">G</span><span class="main">â¦‡</span>carrier <span class="main">:=</span> <span class="skolem">A</span><span class="main">â¦ˆ</span></sub><span class="hidden">â‡™</span> <span class="free">H</span>"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> FactGroup_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
            <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">x'</span></span> <span class="keyword2"><span class="keyword">where</span></span> x'<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">x'</span> <span class="main">âˆˆ</span> <span class="skolem">A</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="free">H</span> <span class="main">#&gt;</span><span class="skolem">x</span> <span class="main">=</span> <span class="free">H</span> <span class="main">#&gt;</span><span class="hidden">â‡˜</span><sub><span class="free">G</span><span class="main">â¦‡</span>carrier <span class="main">:=</span> <span class="skolem">A</span><span class="main">â¦ˆ</span></sub><span class="hidden">â‡™</span> <span class="skolem">x'</span>"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> RCOSETS_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
            <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="free">H</span> <span class="main">#&gt;</span> <span class="skolem">x</span> <span class="main">=</span> <span class="free">H</span> <span class="main">#&gt;</span> <span class="skolem">x'</span>"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> r_coset_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
            <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">âˆˆ</span> <span class="free">H</span> <span class="main">#&gt;</span> <span class="skolem">x'</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> is_subgroup rcos_self x<span class="main">)</span>
            <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">âˆˆ</span> <span class="skolem">A</span> <span class="main">#&gt;</span> <span class="skolem">x'</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> HA <span class="keyword1"><span class="command">unfolding</span></span> r_coset_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
            <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">âˆˆ</span> <span class="skolem">A</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> x'<span class="main">(</span>1<span class="main">)</span> <span class="keyword1"><span class="command">unfolding</span></span> r_coset_def <span class="keyword1"><span class="command">using</span></span> subgroup.m_closed A<span class="main">(</span>1<span class="main">)</span> normal_imp_subgroup <span class="keyword1"><span class="command">by</span></span> <span class="operator">force</span>
          <span class="keyword1"><span class="command">qed</span></span>
        <span class="keyword1"><span class="command">qed</span></span>
        <span class="keyword1"><span class="command">with</span></span> A<span class="main">(</span>3<span class="main">)</span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
      <span class="keyword1"><span class="command">qed</span></span>
    <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">qed</span></span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword2"><span class="keyword">end</span></span>
</pre>
</div><div id="CompositionSeries">
<div class="head">
<h1>Theory CompositionSeries</h1>
</div>
<pre class="source"><span class="comment1">(*  Title:      Composition Series
    Author:     Jakob von Raumer, Karlsruhe Institute of Technology
    Maintainer: Jakob von Raumer &lt;jakob.raumer@student.kit.edu&gt;
*)</span>

<span class="keyword1"><span class="command">theory</span></span> CompositionSeries
<span class="keyword2"><span class="keyword">imports</span></span>
  <a href="SimpleGroups.html">SimpleGroups</a>
  <a href="MaximalNormalSubgroups.html">MaximalNormalSubgroups</a>
<span class="keyword2"><span class="keyword">begin</span></span>

<span class="keyword1"><span class="command">section</span></span> <span class="quoted"><span class="plain_text">â€¹Normal series and Composition seriesâ€º</span></span>

<span class="keyword1"><span class="command">subsection</span></span> <span class="quoted"><span class="plain_text">â€¹Preliminariesâ€º</span></span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">â€¹A subgroup which is unique in cardinality is normal:â€º</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> group<span class="main">)</span> unique_sizes_subgrp_normal<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> fin<span class="main">:</span><span class="quoted"><span class="quoted">"finite <span class="main">(</span>carrier <span class="free">G</span><span class="main">)</span>"</span></span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="main">âˆƒ!</span><span class="bound">Q</span><span class="main">.</span> <span class="bound">Q</span> <span class="main">âˆˆ</span> subgroups_of_size <span class="free">q</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="keyword1">THE</span> <span class="bound">Q</span><span class="main">.</span> <span class="bound">Q</span> <span class="main">âˆˆ</span> subgroups_of_size <span class="free">q</span><span class="main">)</span> <span class="main">âŠ²</span> <span class="free">G</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">from</span></span> assms <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">Q</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">Q</span> <span class="main">âˆˆ</span> subgroups_of_size <span class="free">q</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword3"><span class="command">define</span></span> <span class="skolem"><span class="skolem">Q</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">Q</span> <span class="main">=</span> <span class="main">(</span><span class="keyword1">THE</span> <span class="bound">Q</span><span class="main">.</span> <span class="bound">Q</span> <span class="main">âˆˆ</span> subgroups_of_size <span class="free">q</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">with</span></span> assms <span class="keyword1"><span class="command">have</span></span> Qsize<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">Q</span> <span class="main">âˆˆ</span> subgroups_of_size <span class="free">q</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> theI <span class="keyword1"><span class="command">by</span></span> <span class="operator">metis</span>
  <span class="keyword1"><span class="command">hence</span></span> QG<span class="main">:</span><span class="quoted"><span class="quoted">"subgroup <span class="skolem">Q</span> <span class="free">G</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> cardQ<span class="main">:</span><span class="quoted"><span class="quoted">"card <span class="skolem">Q</span> <span class="main">=</span> <span class="free">q</span>"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> subgroups_of_size_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">from</span></span> QG <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">Q</span> <span class="main">âŠ²</span> <span class="free">G</span>"</span></span> <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="main">(</span><span class="operator">rule</span> normalI<span class="main">)</span>
  <span class="keyword1"><span class="command">proof</span></span>
    <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">g</span>
    <span class="keyword3"><span class="command">assume</span></span> g<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">g</span> <span class="main">âˆˆ</span> carrier <span class="free">G</span>"</span></span>
    <span class="keyword1"><span class="command">hence</span></span> invg<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="keyword1">inv</span> <span class="skolem">g</span> <span class="main">âˆˆ</span> carrier <span class="free">G</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> inv_closed<span class="main">)</span>
    <span class="keyword1"><span class="command">with</span></span> fin Qsize <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"conjugation_action <span class="free">q</span> <span class="main">(</span><span class="keyword1">inv</span> <span class="skolem">g</span><span class="main">)</span> <span class="skolem">Q</span> <span class="main">âˆˆ</span> subgroups_of_size <span class="free">q</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> conjugation_is_size_invariant<span class="main">)</span>
    <span class="keyword1"><span class="command">with</span></span> g Qsize <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="keyword1">inv</span> <span class="skolem">g</span><span class="main">)</span> <span class="main">&lt;#</span> <span class="main">(</span><span class="skolem">Q</span> <span class="main">#&gt;</span> <span class="keyword1">inv</span> <span class="main">(</span><span class="keyword1">inv</span> <span class="skolem">g</span><span class="main">)</span><span class="main">)</span> <span class="main">âˆˆ</span> subgroups_of_size <span class="free">q</span>"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> conjugation_action_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">with</span></span> invg g <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">inv</span> <span class="skolem">g</span> <span class="main">&lt;#</span> <span class="main">(</span><span class="skolem">Q</span> <span class="main">#&gt;</span> <span class="skolem">g</span><span class="main">)</span> <span class="main">=</span> <span class="skolem">Q</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> Qsize assms<span class="main"><span class="main">(</span></span>2<span class="main"><span class="main">)</span></span> inv_inv<span class="main">)</span>
    <span class="keyword1"><span class="command">with</span></span> QG QG g <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">Q</span> <span class="main">#&gt;</span> <span class="skolem">g</span> <span class="main">=</span> <span class="skolem">g</span> <span class="main">&lt;#</span> <span class="skolem">Q</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> conj_wo_inv<span class="main">)</span>
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">with</span></span> Q_def <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">â€¹A group whose order is the product of two distinct
primes $p$ and $q$ where $p &lt; q$ has a unique subgroup of size $q$:â€º</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> group<span class="main">)</span> pq_order_unique_subgrp<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> finite<span class="main">:</span><span class="quoted"><span class="quoted">"finite <span class="main">(</span>carrier <span class="free">G</span><span class="main">)</span>"</span></span>
  <span class="keyword2"><span class="keyword">assumes</span></span> orderG<span class="main">:</span><span class="quoted"><span class="quoted">"order <span class="free">G</span> <span class="main">=</span> <span class="free">q</span> <span class="main">*</span> <span class="free">p</span>"</span></span>
  <span class="keyword2"><span class="keyword">assumes</span></span> primep<span class="main">:</span><span class="quoted"><span class="quoted">"prime <span class="free">p</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> primeq<span class="main">:</span><span class="quoted"><span class="quoted">"prime <span class="free">q</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> pq<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="free">p</span> <span class="main">&lt;</span> <span class="free">q</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">âˆƒ!</span><span class="bound">Q</span><span class="main">.</span> <span class="bound">Q</span> <span class="main">âˆˆ</span> <span class="main">(</span>subgroups_of_size <span class="free">q</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">from</span></span> primep primeq pq <span class="keyword1"><span class="command">have</span></span> nqdvdp<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="main">Â¬</span> <span class="main">(</span><span class="free">q</span> <span class="keyword1">dvd</span> <span class="free">p</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> less_not_refl3 prime_nat_iff<span class="main">)</span>
  <span class="keyword3"><span class="command">define</span></span> <span class="skolem"><span class="skolem">calM</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">calM</span> <span class="main">=</span> <span class="main">{</span><span class="bound">s</span><span class="main">.</span> <span class="bound">s</span> <span class="main">âŠ†</span> carrier <span class="free">G</span> <span class="main">âˆ§</span> card <span class="bound">s</span> <span class="main">=</span> <span class="free">q</span> <span class="main">^</span> <span class="main">1</span><span class="main">}</span>"</span></span>
  <span class="keyword3"><span class="command">define</span></span> <span class="skolem"><span class="skolem">RelM</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">RelM</span> <span class="main">=</span> <span class="main">{</span><span class="main">(</span><span class="bound">N1</span><span class="main">,</span> <span class="bound">N2</span><span class="main">)</span><span class="main">.</span> <span class="bound">N1</span> <span class="main">âˆˆ</span> <span class="skolem">calM</span> <span class="main">âˆ§</span> <span class="bound">N2</span> <span class="main">âˆˆ</span> <span class="skolem">calM</span> <span class="main">âˆ§</span> <span class="main">(</span><span class="main">âˆƒ</span><span class="bound">g</span><span class="main">âˆˆ</span>carrier <span class="free">G</span><span class="main">.</span> <span class="bound">N1</span> <span class="main">=</span> <span class="bound">N2</span> <span class="main">#&gt;</span> <span class="bound">g</span><span class="main">)</span><span class="main">}</span>"</span></span>
  <span class="keyword1"><span class="command">interpret</span></span> syl<span class="main">:</span> snd_sylow <span class="quoted"><span class="free">G</span></span> <span class="quoted"><span class="free">q</span></span> <span class="quoted"><span class="main">1</span></span> <span class="quoted"><span class="free">p</span></span> <span class="quoted"><span class="skolem">calM</span></span> <span class="quoted"><span class="skolem">RelM</span></span>
    <span class="keyword1"><span class="command">unfolding</span></span> snd_sylow_def sylow_def snd_sylow_axioms_def sylow_axioms_def
    <span class="keyword1"><span class="command">using</span></span> is_group primeq orderG finite nqdvdp calM_def RelM_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">Q</span></span> <span class="keyword2"><span class="keyword">where</span></span> Q<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">Q</span> <span class="main">âˆˆ</span> subgroups_of_size <span class="free">q</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> <span class="main"><span class="main">(</span></span>lifting<span class="main"><span class="main">,</span></span> mono_tags<span class="main"><span class="main">)</span></span> mem_Collect_eq power_one_right subgroups_of_size_def syl.sylow_thm<span class="main">)</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> 
  <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">rule</span> ex1I<span class="main">)</span>
     <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">P</span>
     <span class="keyword3"><span class="command">assume</span></span> P<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">P</span> <span class="main">âˆˆ</span> subgroups_of_size <span class="free">q</span>"</span></span>
     <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"card <span class="main">(</span>subgroups_of_size <span class="free">q</span><span class="main">)</span> <span class="keyword1">mod</span> <span class="free">q</span> <span class="main">=</span> <span class="main">1</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> power_one_right syl.p_sylow_mod_p<span class="main">)</span>     
     <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"card <span class="main">(</span>subgroups_of_size <span class="free">q</span><span class="main">)</span> <span class="keyword1">dvd</span> <span class="free">p</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> power_one_right syl.num_sylow_dvd_remainder<span class="main">)</span>
     <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"card <span class="main">(</span>subgroups_of_size <span class="free">q</span><span class="main">)</span> <span class="main">=</span> <span class="free">p</span> <span class="main">âˆ¨</span> card <span class="main">(</span>subgroups_of_size <span class="free">q</span><span class="main">)</span> <span class="main">=</span> <span class="main">1</span>"</span></span>
       <span class="keyword1"><span class="command">using</span></span> primep <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> prime_nat_iff<span class="main">)</span>
     <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"card <span class="main">(</span>subgroups_of_size <span class="free">q</span><span class="main">)</span> <span class="main">=</span> <span class="main">1</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> pq
       <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
     <span class="keyword1"><span class="command">with</span></span> Q P <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">P</span> <span class="main">=</span> <span class="skolem">Q</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span>card_Suc_eq<span class="main">)</span>
  <span class="keyword1"><span class="command">qed</span></span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">â€¹... And this unique subgroup is normal.â€º</span></span>

<span class="keyword1"><span class="command">corollary</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> group<span class="main">)</span> pq_order_subgrp_normal<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> finite<span class="main">:</span><span class="quoted"><span class="quoted">"finite <span class="main">(</span>carrier <span class="free">G</span><span class="main">)</span>"</span></span>
  <span class="keyword2"><span class="keyword">assumes</span></span> orderG<span class="main">:</span><span class="quoted"><span class="quoted">"order <span class="free">G</span> <span class="main">=</span> <span class="free">q</span> <span class="main">*</span> <span class="free">p</span>"</span></span>
  <span class="keyword2"><span class="keyword">assumes</span></span> primep<span class="main">:</span><span class="quoted"><span class="quoted">"prime <span class="free">p</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> primeq<span class="main">:</span><span class="quoted"><span class="quoted">"prime <span class="free">q</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> pq<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="free">p</span> <span class="main">&lt;</span> <span class="free">q</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="keyword1">THE</span> <span class="bound">Q</span><span class="main">.</span> <span class="bound">Q</span> <span class="main">âˆˆ</span> subgroups_of_size <span class="free">q</span><span class="main">)</span> <span class="main">âŠ²</span> <span class="free">G</span>"</span></span>
<span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> pq_order_unique_subgrp unique_sizes_subgrp_normal<span class="main">)</span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">â€¹The trivial subgroup is normal in every group.â€º</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> group<span class="main">)</span> trivial_subgroup_is_normal<span class="main">:</span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">{</span><span class="main">ğŸ­</span><span class="main">}</span> <span class="main">âŠ²</span> <span class="free">G</span>"</span></span>
<span class="keyword1"><span class="command">unfolding</span></span> normal_def normal_axioms_def r_coset_def l_coset_def <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">intro</span><span class="main"><span class="main">:</span></span> normalI subgroupI <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> is_group<span class="main">)</span>

<span class="keyword1"><span class="command">subsection</span></span> <span class="quoted"><span class="plain_text">â€¹Normal Seriesâ€º</span></span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">â€¹We define a normal series as a locale which fixes one group
<span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">term</span></span> <span class="quoted"><span class="free"><span class="quoted"><span class="free">G</span></span></span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span> and a list <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">term</span></span> <span class="quoted"><span class="free"><span class="quoted"><span class="free">ğ”Š</span></span></span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span> of subsets of <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">term</span></span> <span class="quoted"><span class="free"><span class="quoted"><span class="free">G</span></span></span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span>'s carrier. This list
must begin with the trivial subgroup, end with the carrier of the group itself
and each of the list items must be a normal subgroup of its successor.â€º</span></span>

<span class="keyword1"><span class="command">locale</span></span> normal_series <span class="main">=</span> group <span class="main">+</span>
  <span class="keyword2"><span class="keyword">fixes</span></span> <span class="free">ğ”Š</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> notempty<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="free">ğ”Š</span> <span class="main">â‰ </span> <span class="main">[]</span>"</span></span>
  <span class="keyword2"><span class="keyword">assumes</span></span> hd<span class="main">:</span><span class="quoted"><span class="quoted">"hd <span class="free">ğ”Š</span> <span class="main">=</span> <span class="main">{</span><span class="main">ğŸ­</span><span class="main">}</span>"</span></span>
  <span class="keyword2"><span class="keyword">assumes</span></span> last<span class="main">:</span><span class="quoted"><span class="quoted">"last <span class="free">ğ”Š</span> <span class="main">=</span> carrier <span class="free">G</span>"</span></span>
  <span class="keyword2"><span class="keyword">assumes</span></span> normal<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="main">â‹€</span><span class="bound">i</span><span class="main">.</span> <span class="bound">i</span> <span class="main">+</span> <span class="main">1</span> <span class="main">&lt;</span> length <span class="free">ğ”Š</span> <span class="main">âŸ¹</span> <span class="main">(</span><span class="free">ğ”Š</span> <span class="main">!</span> <span class="bound">i</span><span class="main">)</span> <span class="main">âŠ²</span> <span class="free">G</span><span class="main">â¦‡</span>carrier <span class="main">:=</span> <span class="free">ğ”Š</span> <span class="main">!</span> <span class="main">(</span><span class="bound">i</span> <span class="main">+</span> <span class="main">1</span><span class="main">)</span><span class="main">â¦ˆ</span>"</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> normal_series<span class="main">)</span> is_normal_series<span class="main">:</span> <span class="quoted"><span class="quoted">"normal_series <span class="free">G</span> <span class="free">ğ”Š</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> normal_series_axioms<span class="main">)</span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">â€¹For every group there is a "trivial" normal series consisting
only of the group itself and its trivial subgroup.â€º</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> group<span class="main">)</span> trivial_normal_series<span class="main">:</span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"normal_series <span class="free">G</span> <span class="main">[</span><span class="main">{</span><span class="main">ğŸ­</span><span class="main">}</span><span class="main">,</span> carrier <span class="free">G</span><span class="main">]</span>"</span></span>
<span class="keyword1"><span class="command">unfolding</span></span> normal_series_def normal_series_axioms_def
<span class="keyword1"><span class="command">using</span></span> is_group trivial_subgroup_is_normal <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">â€¹We can also show that the normal series presented above is the only such with
a length of two:â€º</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> normal_series<span class="main">)</span> length_two_unique<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"length <span class="free">ğ”Š</span> <span class="main">=</span> <span class="numeral">2</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">ğ”Š</span> <span class="main">=</span> <span class="main">[</span><span class="main">{</span><span class="main">ğŸ­</span><span class="main">}</span><span class="main">,</span> carrier <span class="free">G</span><span class="main">]</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span><span class="main">(</span><span class="operator">rule</span> nth_equalityI<span class="main">)</span>
  <span class="keyword1"><span class="command">from</span></span> assms <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"length <span class="free">ğ”Š</span> <span class="main">=</span> length <span class="main">[</span><span class="main">{</span><span class="main">ğŸ­</span><span class="main">}</span><span class="main">,</span> carrier <span class="free">G</span><span class="main">]</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">next</span></span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="free">ğ”Š</span> <span class="main">!</span> <span class="skolem">i</span> <span class="main">=</span> <span class="main">[</span><span class="main">{</span><span class="main">ğŸ­</span><span class="main">}</span><span class="main">,</span> carrier <span class="free">G</span><span class="main">]</span> <span class="main">!</span> <span class="skolem">i</span>"</span></span> <span class="keyword2"><span class="keyword">if</span></span> i<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">i</span> <span class="main">&lt;</span> length <span class="free">ğ”Š</span>"</span></span> <span class="keyword2"><span class="keyword">for</span></span> <span class="skolem">i</span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">i</span> <span class="main">=</span> <span class="main">0</span> <span class="main">âˆ¨</span> <span class="skolem">i</span> <span class="main">=</span> <span class="main">1</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> that assms <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"<span class="free">ğ”Š</span> <span class="main">!</span> <span class="skolem">i</span> <span class="main">=</span> <span class="main">[</span><span class="main">{</span><span class="main">ğŸ­</span><span class="main">}</span><span class="main">,</span> carrier <span class="free">G</span><span class="main">]</span> <span class="main">!</span> <span class="skolem">i</span>"</span></span>
    <span class="keyword1"><span class="command">proof</span></span><span class="main">(</span><span class="operator">rule</span> disjE<span class="main">)</span>
      <span class="keyword3"><span class="command">assume</span></span> i<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">i</span> <span class="main">=</span> <span class="main">0</span>"</span></span>
      <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="free">ğ”Š</span> <span class="main">!</span> <span class="skolem">i</span> <span class="main">=</span> hd <span class="free">ğ”Š</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> hd_conv_nth notempty<span class="main">)</span>
      <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"<span class="free">ğ”Š</span> <span class="main">!</span> <span class="skolem">i</span> <span class="main">=</span> <span class="main">[</span><span class="main">{</span><span class="main">ğŸ­</span><span class="main">}</span><span class="main">,</span> carrier <span class="free">G</span><span class="main">]</span> <span class="main">!</span> <span class="skolem">i</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> hd i <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">next</span></span>
      <span class="keyword3"><span class="command">assume</span></span> i<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">i</span> <span class="main">=</span> <span class="main">1</span>"</span></span>
      <span class="keyword1"><span class="command">with</span></span> assms <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">ğ”Š</span> <span class="main">!</span> <span class="skolem">i</span> <span class="main">=</span> last <span class="free">ğ”Š</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> diff_add_inverse last_conv_nth nat_1_add_1 notempty<span class="main">)</span>
      <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"<span class="free">ğ”Š</span> <span class="main">!</span> <span class="skolem">i</span> <span class="main">=</span> <span class="main">[</span><span class="main">{</span><span class="main">ğŸ­</span><span class="main">}</span><span class="main">,</span> carrier <span class="free">G</span><span class="main">]</span> <span class="main">!</span> <span class="skolem">i</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> last i <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">qed</span></span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">â€¹We can construct new normal series by expanding existing ones: If we
append the carrier of a group <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">term</span></span> <span class="quoted"><span class="free"><span class="quoted"><span class="free">G</span></span></span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span> to a normal series for a normal subgroup
<span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">term</span></span> <span class="quoted"><span class="quoted">"<span class="free"><span class="free">H</span></span> <span class="main"><span class="main">âŠ²</span></span> <span class="free"><span class="free">G</span></span>"</span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span> we receive a normal series for <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">term</span></span> <span class="quoted"><span class="free"><span class="quoted"><span class="free">G</span></span></span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span>.â€º</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> group<span class="main">)</span> normal_series_extend<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> normal<span class="main">:</span><span class="quoted"><span class="quoted">"normal_series <span class="main">(</span><span class="free">G</span><span class="main">â¦‡</span>carrier <span class="main">:=</span> <span class="free">H</span><span class="main">â¦ˆ</span><span class="main">)</span> <span class="free">â„Œ</span>"</span></span>
  <span class="keyword2"><span class="keyword">assumes</span></span> HG<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="free">H</span> <span class="main">âŠ²</span> <span class="free">G</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"normal_series <span class="free">G</span> <span class="main">(</span><span class="free">â„Œ</span> <span class="main">@</span> <span class="main">[</span>carrier <span class="free">G</span><span class="main">]</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">from</span></span> normal <span class="keyword1"><span class="command">interpret</span></span> normalH<span class="main">:</span> normal_series <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">G</span><span class="main">â¦‡</span>carrier <span class="main">:=</span> <span class="free">H</span><span class="main">â¦ˆ</span><span class="main">)</span>"</span></span> <span class="quoted"><span class="free">â„Œ</span></span><span class="keyword1"><span class="command">.</span></span>
  <span class="keyword1"><span class="command">from</span></span> normalH.hd <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"hd <span class="free">â„Œ</span> <span class="main">=</span> <span class="main">{</span><span class="main">ğŸ­</span><span class="main">}</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">with</span></span> normalH.notempty <span class="keyword1"><span class="command">have</span></span> hdTriv<span class="main">:</span><span class="quoted"><span class="quoted">"hd <span class="main">(</span><span class="free">â„Œ</span> <span class="main">@</span> <span class="main">[</span>carrier <span class="free">G</span><span class="main">]</span><span class="main">)</span> <span class="main">=</span> <span class="main">{</span><span class="main">ğŸ­</span><span class="main">}</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> hd_append2<span class="main">)</span>
  <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">unfolding</span></span> normal_series_def normal_series_axioms_def <span class="keyword1"><span class="command">using</span></span> is_group
  <span class="keyword1"><span class="command">proof</span></span> <span class="operator">auto</span>
    <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">x</span>
    <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">âˆˆ</span> hd <span class="main">(</span><span class="free">â„Œ</span> <span class="main">@</span> <span class="main">[</span>carrier <span class="free">G</span><span class="main">]</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">with</span></span> hdTriv <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">=</span> <span class="main">ğŸ­</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">next</span></span>
    <span class="keyword1"><span class="command">from</span></span> hdTriv <span class="keyword3"><span class="command">show</span></span>  <span class="quoted"><span class="quoted">"<span class="main">ğŸ­</span> <span class="main">âˆˆ</span> hd <span class="main">(</span><span class="free">â„Œ</span> <span class="main">@</span> <span class="main">[</span>carrier <span class="free">G</span><span class="main">]</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">next</span></span>
    <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">i</span>
    <span class="keyword3"><span class="command">assume</span></span> i<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">i</span> <span class="main">&lt;</span> length <span class="free">â„Œ</span>"</span></span>
    <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">â„Œ</span> <span class="main">@</span> <span class="main">[</span>carrier <span class="free">G</span><span class="main">]</span><span class="main">)</span> <span class="main">!</span> <span class="skolem">i</span> <span class="main">âŠ²</span> <span class="free">G</span><span class="main">â¦‡</span>carrier <span class="main">:=</span> <span class="main">(</span><span class="free">â„Œ</span> <span class="main">@</span> <span class="main">[</span>carrier <span class="free">G</span><span class="main">]</span><span class="main">)</span> <span class="main">!</span> Suc <span class="skolem">i</span><span class="main">â¦ˆ</span>"</span></span>
    <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">cases</span> <span class="quoted"><span class="quoted">"<span class="skolem">i</span> <span class="main">+</span> <span class="main">1</span> <span class="main">&lt;</span> length <span class="free">â„Œ</span>"</span></span><span class="main">)</span>
      <span class="keyword3"><span class="command">case</span></span> True
      <span class="keyword1"><span class="command">with</span></span> normalH.normal <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">â„Œ</span> <span class="main">!</span> <span class="skolem">i</span> <span class="main">âŠ²</span> <span class="free">G</span><span class="main">â¦‡</span>carrier <span class="main">:=</span> <span class="free">â„Œ</span> <span class="main">!</span> <span class="main">(</span><span class="skolem">i</span> <span class="main">+</span> <span class="main">1</span><span class="main">)</span><span class="main">â¦ˆ</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">with</span></span> i <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">â„Œ</span> <span class="main">@</span> <span class="main">[</span>carrier <span class="free">G</span><span class="main">]</span><span class="main">)</span> <span class="main">!</span> <span class="skolem">i</span> <span class="main">âŠ²</span> <span class="free">G</span><span class="main">â¦‡</span>carrier <span class="main">:=</span> <span class="free">â„Œ</span> <span class="main">!</span> <span class="main">(</span><span class="skolem">i</span> <span class="main">+</span> <span class="main">1</span><span class="main">)</span><span class="main">â¦ˆ</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> nth_append <span class="keyword1"><span class="command">by</span></span> <span class="operator">metis</span>
      <span class="keyword1"><span class="command">with</span></span> True <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">â„Œ</span> <span class="main">@</span> <span class="main">[</span>carrier <span class="free">G</span><span class="main">]</span><span class="main">)</span> <span class="main">!</span> <span class="skolem">i</span> <span class="main">âŠ²</span> <span class="free">G</span><span class="main">â¦‡</span>carrier <span class="main">:=</span> <span class="main">(</span><span class="free">â„Œ</span> <span class="main">@</span> <span class="main">[</span>carrier <span class="free">G</span><span class="main">]</span><span class="main">)</span> <span class="main">!</span> <span class="main">(</span>Suc <span class="skolem">i</span><span class="main">)</span><span class="main">â¦ˆ</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> nth_append Suc_eq_plus1 <span class="keyword1"><span class="command">by</span></span> <span class="operator">metis</span>
    <span class="keyword1"><span class="command">next</span></span>
      <span class="keyword3"><span class="command">case</span></span> False
      <span class="keyword1"><span class="command">with</span></span> i <span class="keyword1"><span class="command">have</span></span> i2<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">i</span> <span class="main">+</span> <span class="main">1</span> <span class="main">=</span> length <span class="free">â„Œ</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
      <span class="keyword1"><span class="command">from</span></span> i <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">â„Œ</span> <span class="main">@</span> <span class="main">[</span>carrier <span class="free">G</span><span class="main">]</span><span class="main">)</span> <span class="main">!</span> <span class="skolem">i</span> <span class="main">=</span> <span class="free">â„Œ</span> <span class="main">!</span> <span class="skolem">i</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> nth_append<span class="main">)</span>
      <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">from</span></span> i2 normalH.notempty <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> last <span class="free">â„Œ</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> add_diff_cancel_right' last_conv_nth<span class="main">)</span>
      <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">from</span></span> normalH.last <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> <span class="free">H</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
      <span class="keyword1"><span class="command">finally</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">â„Œ</span> <span class="main">@</span> <span class="main">[</span>carrier <span class="free">G</span><span class="main">]</span><span class="main">)</span> <span class="main">!</span> <span class="skolem">i</span> <span class="main">=</span> <span class="free">H</span>"</span></span><span class="keyword1"><span class="command">.</span></span>
      <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> i2 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">â„Œ</span> <span class="main">@</span> <span class="main">[</span>carrier <span class="free">G</span><span class="main">]</span><span class="main">)</span> <span class="main">!</span> <span class="main">(</span><span class="skolem">i</span> <span class="main">+</span> <span class="main">1</span><span class="main">)</span> <span class="main">=</span> carrier <span class="free">G</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> nth_append_length<span class="main">)</span>
      <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> HG <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">qed</span></span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">â€¹All entries of a normal series for $G$ are subgroups of $G$.â€º</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> normal_series<span class="main">)</span> normal_series_subgroups<span class="main">:</span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">i</span> <span class="main">&lt;</span> length <span class="free">ğ”Š</span> <span class="main">âŸ¹</span> subgroup <span class="main">(</span><span class="free">ğ”Š</span> <span class="main">!</span> <span class="free">i</span><span class="main">)</span> <span class="free">G</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">i</span> <span class="main">+</span> <span class="main">1</span> <span class="main">&lt;</span> length <span class="free">ğ”Š</span> <span class="main">âŸ¹</span> subgroup <span class="main">(</span><span class="free">ğ”Š</span> <span class="main">!</span> <span class="free">i</span><span class="main">)</span> <span class="free">G</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">induction</span> <span class="quoted"><span class="quoted">"length <span class="free">ğ”Š</span> <span class="main">-</span> <span class="main">(</span><span class="free">i</span> <span class="main">+</span> <span class="numeral">2</span><span class="main">)</span>"</span></span> <span class="quasi_keyword">arbitrary</span><span class="main"><span class="main">:</span></span> <span class="quoted"><span class="free">i</span></span><span class="main">)</span>
    <span class="keyword3"><span class="command">case</span></span> 0
    <span class="keyword1"><span class="command">hence</span></span> i<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">i</span> <span class="main">+</span> <span class="numeral">2</span> <span class="main">=</span> length <span class="free">ğ”Š</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">hence</span></span> ii<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">i</span> <span class="main">+</span> <span class="main">1</span> <span class="main">=</span> length <span class="free">ğ”Š</span> <span class="main">-</span> <span class="main">1</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">force</span>
    <span class="keyword1"><span class="command">from</span></span> i normal <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">ğ”Š</span> <span class="main">!</span> <span class="skolem">i</span> <span class="main">âŠ²</span> <span class="free">G</span><span class="main">â¦‡</span>carrier <span class="main">:=</span> <span class="free">ğ”Š</span> <span class="main">!</span> <span class="main">(</span><span class="skolem">i</span> <span class="main">+</span> <span class="main">1</span><span class="main">)</span><span class="main">â¦ˆ</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">with</span></span> ii last notempty <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"subgroup <span class="main">(</span><span class="free">ğ”Š</span> <span class="main">!</span> <span class="skolem">i</span><span class="main">)</span> <span class="free">G</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> last_conv_nth normal_imp_subgroup <span class="keyword1"><span class="command">by</span></span> <span class="operator">fastforce</span>
  <span class="keyword1"><span class="command">next</span></span>
    <span class="keyword3"><span class="command">case</span></span> <span class="main">(</span>Suc <span class="skolem">k</span><span class="main">)</span>
    <span class="keyword1"><span class="command">from</span></span> Suc<span class="main">(</span>3<span class="main">)</span>  normal <span class="keyword1"><span class="command">have</span></span> i<span class="main">:</span><span class="quoted"><span class="quoted">"subgroup <span class="main">(</span><span class="free">ğ”Š</span> <span class="main">!</span> <span class="skolem">i</span><span class="main">)</span> <span class="main">(</span><span class="free">G</span><span class="main">â¦‡</span>carrier <span class="main">:=</span> <span class="free">ğ”Š</span> <span class="main">!</span> <span class="main">(</span><span class="skolem">i</span> <span class="main">+</span> <span class="main">1</span><span class="main">)</span><span class="main">â¦ˆ</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> normal_imp_subgroup <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">from</span></span> Suc<span class="main">(</span>2<span class="main">)</span> <span class="keyword1"><span class="command">have</span></span> k<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">k</span> <span class="main">=</span> length <span class="free">ğ”Š</span> <span class="main">-</span> <span class="main">(</span><span class="main">(</span><span class="skolem">i</span> <span class="main">+</span> <span class="main">1</span><span class="main">)</span> <span class="main">+</span> <span class="numeral">2</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">arith</span>
    <span class="keyword1"><span class="command">with</span></span> Suc <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"subgroup <span class="main">(</span><span class="free">ğ”Š</span> <span class="main">!</span> <span class="main">(</span><span class="skolem">i</span> <span class="main">+</span> <span class="main">1</span><span class="main">)</span><span class="main">)</span> <span class="free">G</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">with</span></span> i <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"subgroup <span class="main">(</span><span class="free">ğ”Š</span> <span class="main">!</span> <span class="skolem">i</span><span class="main">)</span> <span class="free">G</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> is_group subgroup.subgroup_of_subgroup<span class="main">)</span>
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">i</span> <span class="main">+</span> <span class="main">1</span> <span class="main">=</span> length <span class="free">ğ”Š</span> <span class="main">âŸ¹</span> subgroup <span class="main">(</span><span class="free">ğ”Š</span> <span class="main">!</span> <span class="free">i</span><span class="main">)</span> <span class="free">G</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> last notempty last_conv_nth <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> add_diff_cancel_right' subgroup_self<span class="main">)</span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="free">i</span> <span class="main">&lt;</span> length <span class="free">ğ”Š</span> <span class="main">âŸ¹</span> subgroup <span class="main">(</span><span class="free">ğ”Š</span> <span class="main">!</span> <span class="free">i</span><span class="main">)</span> <span class="free">G</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">force</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">â€¹The second to last entry of a normal series is a normal subgroup of G.â€º</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> normal_series<span class="main">)</span> normal_series_snd_to_last<span class="main">:</span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">ğ”Š</span> <span class="main">!</span> <span class="main">(</span>length <span class="free">ğ”Š</span> <span class="main">-</span> <span class="numeral">2</span><span class="main">)</span> <span class="main">âŠ²</span> <span class="free">G</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">cases</span> <span class="quoted"><span class="quoted">"<span class="numeral">2</span> <span class="main">â‰¤</span> length <span class="free">ğ”Š</span>"</span></span><span class="main">)</span>
  <span class="keyword3"><span class="command">case</span></span> False
  <span class="keyword1"><span class="command">with</span></span> notempty <span class="keyword1"><span class="command">have</span></span> length<span class="main">:</span><span class="quoted"><span class="quoted">"length <span class="free">ğ”Š</span> <span class="main">=</span> <span class="main">1</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> Suc_eq_plus1 leI length_0_conv less_2_cases plus_nat.add_0<span class="main">)</span>
  <span class="keyword1"><span class="command">with</span></span> hd <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">ğ”Š</span> <span class="main">!</span> <span class="main">(</span>length <span class="free">ğ”Š</span> <span class="main">-</span> <span class="numeral">2</span><span class="main">)</span> <span class="main">=</span> <span class="main">{</span><span class="main">ğŸ­</span><span class="main">}</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> hd_conv_nth notempty <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">with</span></span> length <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> trivial_subgroup_is_normal<span class="main">)</span>
<span class="keyword1"><span class="command">next</span></span>
  <span class="keyword3"><span class="command">case</span></span> True
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span>length <span class="free">ğ”Š</span> <span class="main">-</span> <span class="numeral">2</span><span class="main">)</span> <span class="main">+</span> <span class="main">1</span> <span class="main">&lt;</span> length <span class="free">ğ”Š</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">arith</span>
  <span class="keyword1"><span class="command">with</span></span> normal last <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">ğ”Š</span> <span class="main">!</span> <span class="main">(</span>length <span class="free">ğ”Š</span> <span class="main">-</span> <span class="numeral">2</span><span class="main">)</span> <span class="main">âŠ²</span> <span class="free">G</span><span class="main">â¦‡</span>carrier <span class="main">:=</span> <span class="free">ğ”Š</span> <span class="main">!</span> <span class="main">(</span><span class="main">(</span>length <span class="free">ğ”Š</span> <span class="main">-</span> <span class="numeral">2</span><span class="main">)</span> <span class="main">+</span> <span class="main">1</span><span class="main">)</span><span class="main">â¦ˆ</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">1</span> <span class="main">+</span> <span class="main">(</span><span class="main">1</span> <span class="main">+</span> <span class="main">(</span>length <span class="free">ğ”Š</span> <span class="main">-</span> <span class="main">(</span><span class="main">1</span> <span class="main">+</span> <span class="main">1</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> length <span class="free">ğ”Š</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> True le_add_diff_inverse <span class="keyword1"><span class="command">by</span></span> <span class="operator">presburger</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">ğ”Š</span> <span class="main">!</span> <span class="main">(</span>length <span class="free">ğ”Š</span> <span class="main">-</span> <span class="numeral">2</span><span class="main">)</span> <span class="main">âŠ²</span> <span class="free">G</span><span class="main">â¦‡</span>carrier <span class="main">:=</span>  <span class="free">ğ”Š</span> <span class="main">!</span> <span class="main">(</span>length <span class="free">ğ”Š</span> <span class="main">-</span> <span class="main">1</span><span class="main">)</span><span class="main">â¦ˆ</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> <span class="quoted"><span class="quoted">â€¹<span class="free">ğ”Š</span> <span class="main">!</span> <span class="main">(</span>length <span class="free">ğ”Š</span> <span class="main">-</span> <span class="numeral">2</span><span class="main">)</span> <span class="main">âŠ²</span> <span class="free">G</span> <span class="main">â¦‡</span>carrier <span class="main">:=</span> <span class="free">ğ”Š</span> <span class="main">!</span> <span class="main">(</span>length <span class="free">ğ”Š</span> <span class="main">-</span> <span class="numeral">2</span> <span class="main">+</span> <span class="main">1</span><span class="main">)</span><span class="main">â¦ˆ</span>â€º</span></span> add.commute add_diff_cancel_left' one_add_one<span class="main">)</span>
  <span class="keyword1"><span class="command">with</span></span> notempty last <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> last_conv_nth <span class="keyword1"><span class="command">by</span></span> <span class="operator">force</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">â€¹Just like the expansion of normal series, every prefix of a normal series is again a normal series.â€º</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> normal_series<span class="main">)</span> normal_series_prefix_closed<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">i</span> <span class="main">â‰¤</span> length <span class="free">ğ”Š</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">0</span> <span class="main">&lt;</span> <span class="free">i</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"normal_series <span class="main">(</span><span class="free">G</span><span class="main">â¦‡</span>carrier <span class="main">:=</span> <span class="free">ğ”Š</span> <span class="main">!</span> <span class="main">(</span><span class="free">i</span> <span class="main">-</span> <span class="main">1</span><span class="main">)</span><span class="main">â¦ˆ</span><span class="main">)</span> <span class="main">(</span>take <span class="free">i</span> <span class="free">ğ”Š</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">unfolding</span></span> normal_series_def normal_series_axioms_def
<span class="keyword1"><span class="command">using</span></span> assms
<span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> hd <span class="quasi_keyword">del</span><span class="main"><span class="main">:</span></span>equalityI<span class="main">)</span>
  <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> is_group normal_series_subgroups subgroup.subgroup_is_group<span class="main">)</span>
 <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> last_conv_nth min.absorb2 notempty<span class="main">)</span>
<span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>1<span class="main">)</span> normal <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">done</span></span></span></span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">â€¹If a group's order is the product of two distinct primes <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">term</span></span> <span class="quoted"><span class="free"><span class="quoted"><span class="free">p</span></span></span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span> and <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">term</span></span> <span class="quoted"><span class="free"><span class="quoted"><span class="free">q</span></span></span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span>, where
<span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">term</span></span> <span class="quoted"><span class="quoted">"<span class="free"><span class="free">p</span></span> <span class="main"><span class="main">&lt;</span></span> <span class="free"><span class="free">q</span></span>"</span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span>, we can construct a normal series using the only subgroup of size  <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">term</span></span> <span class="quoted"><span class="free"><span class="quoted"><span class="free">q</span></span></span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span>.â€º</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> group<span class="main">)</span> pq_order_normal_series<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> finite<span class="main">:</span><span class="quoted"><span class="quoted">"finite <span class="main">(</span>carrier <span class="free">G</span><span class="main">)</span>"</span></span>
  <span class="keyword2"><span class="keyword">assumes</span></span> orderG<span class="main">:</span><span class="quoted"><span class="quoted">"order <span class="free">G</span> <span class="main">=</span> <span class="free">q</span> <span class="main">*</span> <span class="free">p</span>"</span></span>
  <span class="keyword2"><span class="keyword">assumes</span></span> primep<span class="main">:</span><span class="quoted"><span class="quoted">"prime <span class="free">p</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> primeq<span class="main">:</span><span class="quoted"><span class="quoted">"prime <span class="free">q</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> pq<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="free">p</span> <span class="main">&lt;</span> <span class="free">q</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"normal_series <span class="free">G</span> <span class="main">[</span><span class="main">{</span><span class="main">ğŸ­</span><span class="main">}</span><span class="main">,</span> <span class="main">(</span><span class="keyword1">THE</span> <span class="bound">H</span><span class="main">.</span> <span class="bound">H</span> <span class="main">âˆˆ</span> subgroups_of_size <span class="free">q</span><span class="main">)</span><span class="main">,</span> carrier <span class="free">G</span><span class="main">]</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword3"><span class="command">define</span></span> <span class="skolem"><span class="skolem">H</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">H</span> <span class="main">=</span> <span class="main">(</span><span class="keyword1">THE</span> <span class="bound">H</span><span class="main">.</span> <span class="bound">H</span> <span class="main">âˆˆ</span> subgroups_of_size <span class="free">q</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">with</span></span> assms <span class="keyword1"><span class="command">have</span></span> HG<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">H</span> <span class="main">âŠ²</span> <span class="free">G</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> pq_order_subgrp_normal<span class="main">)</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">interpret</span></span> groupH<span class="main">:</span> group <span class="quoted"><span class="quoted">"<span class="free">G</span><span class="main">â¦‡</span>carrier <span class="main">:=</span> <span class="skolem">H</span><span class="main">â¦ˆ</span>"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> normal_def <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> subgroup_imp_group<span class="main">)</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"normal_series <span class="main">(</span><span class="free">G</span><span class="main">â¦‡</span>carrier <span class="main">:=</span> <span class="skolem">H</span><span class="main">â¦ˆ</span><span class="main">)</span> <span class="main">[</span><span class="main">{</span><span class="main">ğŸ­</span><span class="main">}</span><span class="main">,</span> <span class="skolem">H</span><span class="main">]</span>"</span></span>  <span class="keyword1"><span class="command">using</span></span> groupH.trivial_normal_series <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">with</span></span> HG <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">unfolding</span></span> H_def <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> append_Cons append_Nil normal_series_extend<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">â€¹The following defines the list of all quotient groups of the normal series:â€º</span></span>

<span class="keyword1"><span class="command">definition</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> normal_series<span class="main">)</span> <span class="entity">quotients</span>
  <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="free">quotients</span> <span class="main">=</span> map <span class="main">(</span><span class="main">Î»</span><span class="bound">i</span><span class="main">.</span> <span class="free">G</span><span class="main">â¦‡</span>carrier <span class="main">:=</span> <span class="free">ğ”Š</span> <span class="main">!</span> <span class="main">(</span><span class="bound">i</span> <span class="main">+</span> <span class="main">1</span><span class="main">)</span><span class="main">â¦ˆ</span> <span class="keyword1">Mod</span> <span class="free">ğ”Š</span> <span class="main">!</span> <span class="bound">i</span><span class="main">)</span> <span class="main">[</span><span class="main">0</span><span class="main">..&lt;</span><span class="main">(</span><span class="main">(</span>length <span class="free">ğ”Š</span><span class="main">)</span> <span class="main">-</span> <span class="main">1</span><span class="main">)</span><span class="main">]</span>"</span></span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">â€¹The list of quotient groups has one less entry than the series itself:â€º</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> normal_series<span class="main">)</span> quotients_length<span class="main">:</span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"length quotients <span class="main">+</span> <span class="main">1</span> <span class="main">=</span> length <span class="free">ğ”Š</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"length quotients <span class="main">+</span> <span class="main">1</span> <span class="main">=</span> length <span class="main">[</span><span class="main">0</span><span class="main">..&lt;</span><span class="main">(</span><span class="main">(</span>length <span class="free">ğ”Š</span><span class="main">)</span> <span class="main">-</span> <span class="main">1</span><span class="main">)</span><span class="main">]</span> <span class="main">+</span> <span class="main">1</span>"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> quotients_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> <span class="main">(</span>length <span class="free">ğ”Š</span> <span class="main">-</span> <span class="main">1</span><span class="main">)</span> <span class="main">+</span> <span class="main">1</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> diff_zero length_upt<span class="main">)</span>
  <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command"><span class="improper">with</span></span></span> notempty <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> length <span class="free">ğ”Š</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> <span class="dynamic"><span class="dynamic">ac_simps</span></span><span class="main">)</span>
  <span class="keyword1"><span class="command">finally</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">.</span></span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> normal_series<span class="main">)</span> last_quotient<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"length <span class="free">ğ”Š</span> <span class="main">&gt;</span> <span class="main">1</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"last quotients <span class="main">=</span> <span class="free">G</span> <span class="keyword1">Mod</span> <span class="free">ğ”Š</span> <span class="main">!</span> <span class="main">(</span>length <span class="free">ğ”Š</span> <span class="main">-</span> <span class="main">1</span> <span class="main">-</span> <span class="main">1</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">from</span></span> assms <span class="keyword1"><span class="command">have</span></span> lsimp<span class="main">:</span><span class="quoted"><span class="quoted">"length <span class="free">ğ”Š</span> <span class="main">-</span> <span class="main">1</span> <span class="main">-</span> <span class="main">1</span> <span class="main">+</span> <span class="main">1</span> <span class="main">=</span> length <span class="free">ğ”Š</span> <span class="main">-</span> <span class="main">1</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">from</span></span> assms <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"quotients <span class="main">â‰ </span> <span class="main">[]</span>"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> quotients_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"last quotients <span class="main">=</span> quotients <span class="main">!</span> <span class="main">(</span>length quotients <span class="main">-</span> <span class="main">1</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> last_conv_nth<span class="main">)</span>
  <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">â€¦</span> <span class="main">=</span> quotients <span class="main">!</span> <span class="main">(</span>length <span class="free">ğ”Š</span> <span class="main">-</span> <span class="main">1</span> <span class="main">-</span> <span class="main">1</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> add_diff_cancel_left' quotients_length add.commute<span class="main">)</span>
  <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">â€¦</span> <span class="main">=</span> <span class="free">G</span><span class="main">â¦‡</span>carrier <span class="main">:=</span> <span class="free">ğ”Š</span> <span class="main">!</span> <span class="main">(</span><span class="main">(</span>length <span class="free">ğ”Š</span> <span class="main">-</span> <span class="main">1</span> <span class="main">-</span> <span class="main">1</span><span class="main">)</span> <span class="main">+</span> <span class="main">1</span><span class="main">)</span><span class="main">â¦ˆ</span> <span class="keyword1">Mod</span> <span class="free">ğ”Š</span> <span class="main">!</span> <span class="main">(</span>length <span class="free">ğ”Š</span> <span class="main">-</span> <span class="main">1</span> <span class="main">-</span> <span class="main">1</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">unfolding</span></span> quotients_def <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">â€¦</span> <span class="main">=</span> <span class="free">G</span><span class="main">â¦‡</span>carrier <span class="main">:=</span> <span class="free">ğ”Š</span> <span class="main">!</span> <span class="main">(</span>length <span class="free">ğ”Š</span> <span class="main">-</span> <span class="main">1</span><span class="main">)</span><span class="main">â¦ˆ</span> <span class="keyword1">Mod</span> <span class="free">ğ”Š</span> <span class="main">!</span> <span class="main">(</span>length <span class="free">ğ”Š</span> <span class="main">-</span> <span class="main">1</span> <span class="main">-</span> <span class="main">1</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> lsimp <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">â€¦</span> <span class="main">=</span> <span class="free">G</span> <span class="keyword1">Mod</span> <span class="free">ğ”Š</span> <span class="main">!</span> <span class="main">(</span>length <span class="free">ğ”Š</span> <span class="main">-</span> <span class="main">1</span> <span class="main">-</span> <span class="main">1</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> last last_conv_nth notempty <span class="keyword1"><span class="command">by</span></span> <span class="operator">force</span>
  <span class="keyword1"><span class="command">finally</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">.</span></span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">â€¹The next lemma transports the constituting properties of a normal series
along an isomorphism of groups.â€º</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> normal_series<span class="main">)</span> normal_series_iso<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> H<span class="main">:</span><span class="quoted"><span class="quoted">"group <span class="free">H</span>"</span></span>
  <span class="keyword2"><span class="keyword">assumes</span></span> iso<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="free">Î¨</span> <span class="main">âˆˆ</span> iso <span class="free">G</span> <span class="free">H</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"normal_series <span class="free">H</span> <span class="main">(</span>map <span class="main">(</span>image <span class="free">Î¨</span><span class="main">)</span> <span class="free">ğ”Š</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> normal_series_def normal_series_axioms_def<span class="main">)</span>
<span class="keyword1"><span class="command">using</span></span> H notempty <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">rule</span> conjI<span class="main">)</span>
  <span class="keyword1"><span class="command">from</span></span> H is_group iso <span class="keyword1"><span class="command">have</span></span> group_hom<span class="main">:</span><span class="quoted"><span class="quoted">"group_hom <span class="free">G</span> <span class="free">H</span> <span class="free">Î¨</span>"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> group_hom_def group_hom_axioms_def iso_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"hd <span class="main">(</span>map <span class="main">(</span>image <span class="free">Î¨</span><span class="main">)</span> <span class="free">ğ”Š</span><span class="main">)</span> <span class="main">=</span> <span class="free">Î¨</span> <span class="main">`</span> <span class="main">{</span><span class="main">ğŸ­</span><span class="main">}</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> hd_map hd notempty<span class="main">)</span>
  <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">â€¦</span> <span class="main">=</span> <span class="main">{</span><span class="free">Î¨</span> <span class="main">ğŸ­</span><span class="main">}</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> image_empty image_insert<span class="main">)</span>
  <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">â€¦</span> <span class="main">=</span> <span class="main">{</span><span class="main">ğŸ­</span><span class="hidden">â‡˜</span><sub><span class="free">H</span></sub><span class="hidden">â‡™</span><span class="main">}</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> group_hom group_hom.hom_one <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">finally</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"hd <span class="main">(</span>map <span class="main">(</span><span class="main">(`)</span> <span class="free">Î¨</span><span class="main">)</span> <span class="free">ğ”Š</span><span class="main">)</span> <span class="main">=</span> <span class="main">{</span><span class="main">ğŸ­</span><span class="hidden">â‡˜</span><sub><span class="free">H</span></sub><span class="hidden">â‡™</span><span class="main">}</span>"</span></span><span class="keyword1"><span class="command">.</span></span>
<span class="keyword1"><span class="command">next</span></span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"last <span class="main">(</span>map <span class="main">(</span><span class="main">(`)</span> <span class="free">Î¨</span><span class="main">)</span> <span class="free">ğ”Š</span><span class="main">)</span> <span class="main">=</span> carrier <span class="free">H</span> <span class="main">âˆ§</span> <span class="main">(</span><span class="main">âˆ€</span><span class="bound">i</span><span class="main">.</span> Suc <span class="bound">i</span> <span class="main">&lt;</span> length <span class="free">ğ”Š</span> <span class="main">âŸ¶</span> <span class="free">Î¨</span> <span class="main">`</span> <span class="free">ğ”Š</span> <span class="main">!</span> <span class="bound">i</span> <span class="main">âŠ²</span> <span class="free">H</span><span class="main">â¦‡</span>carrier <span class="main">:=</span> <span class="free">Î¨</span> <span class="main">`</span> <span class="free">ğ”Š</span> <span class="main">!</span> Suc <span class="bound">i</span><span class="main">â¦ˆ</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">del</span><span class="main"><span class="main">:</span></span> equalityI<span class="main">)</span>
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"last <span class="main">(</span>map <span class="main">(</span><span class="main">(`)</span> <span class="free">Î¨</span><span class="main">)</span> <span class="free">ğ”Š</span><span class="main">)</span> <span class="main">=</span> <span class="free">Î¨</span> <span class="main">`</span> <span class="main">(</span>carrier <span class="free">G</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> last last_map notempty <span class="keyword1"><span class="command">by</span></span> <span class="operator">metis</span>
    <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">â€¦</span> <span class="main">=</span> carrier <span class="free">H</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> iso <span class="keyword1"><span class="command">unfolding</span></span> iso_def bij_betw_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">finally</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"last <span class="main">(</span>map <span class="main">(</span><span class="main">(`)</span> <span class="free">Î¨</span><span class="main">)</span> <span class="free">ğ”Š</span><span class="main">)</span> <span class="main">=</span> carrier <span class="free">H</span>"</span></span><span class="keyword1"><span class="command">.</span></span>
  <span class="keyword1"><span class="command">next</span></span>
    <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">i</span>
    <span class="keyword3"><span class="command">assume</span></span> i<span class="main">:</span><span class="quoted"><span class="quoted">"Suc <span class="skolem">i</span> <span class="main">&lt;</span> length <span class="free">ğ”Š</span>"</span></span>
    <span class="keyword1"><span class="command">hence</span></span> norm<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="free">ğ”Š</span> <span class="main">!</span> <span class="skolem">i</span> <span class="main">âŠ²</span> <span class="free">G</span><span class="main">â¦‡</span>carrier <span class="main">:=</span> <span class="free">ğ”Š</span> <span class="main">!</span> Suc <span class="skolem">i</span><span class="main">â¦ˆ</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> normal <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"restrict <span class="free">Î¨</span> <span class="main">(</span><span class="free">ğ”Š</span> <span class="main">!</span> Suc <span class="skolem">i</span><span class="main">)</span> <span class="main">âˆˆ</span> iso <span class="main">(</span><span class="free">G</span><span class="main">â¦‡</span>carrier <span class="main">:=</span> <span class="free">ğ”Š</span> <span class="main">!</span> Suc <span class="skolem">i</span><span class="main">â¦ˆ</span><span class="main">)</span> <span class="main">(</span><span class="free">H</span><span class="main">â¦‡</span>carrier <span class="main">:=</span> <span class="free">Î¨</span> <span class="main">`</span> <span class="free">ğ”Š</span> <span class="main">!</span> Suc <span class="skolem">i</span><span class="main">â¦ˆ</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> H i is_group iso iso_restrict normal_series_subgroups<span class="main">)</span>
    <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"group <span class="main">(</span><span class="free">G</span><span class="main">â¦‡</span>carrier <span class="main">:=</span> <span class="free">ğ”Š</span> <span class="main">!</span> Suc <span class="skolem">i</span><span class="main">â¦ˆ</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> i normal_series_subgroups subgroup_imp_group<span class="main">)</span>
    <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command"><span class="improper">hence</span></span></span> <span class="quoted"><span class="quoted">"subgroup <span class="main">(</span><span class="free">ğ”Š</span> <span class="main">!</span> Suc <span class="skolem">i</span><span class="main">)</span> <span class="free">G</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> i normal_series_subgroups<span class="main">)</span>
    <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"subgroup <span class="main">(</span><span class="free">Î¨</span> <span class="main">`</span> <span class="free">ğ”Š</span> <span class="main">!</span> Suc <span class="skolem">i</span><span class="main">)</span> <span class="free">H</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> H is_group iso iso_subgroup<span class="main">)</span>
    <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"group <span class="main">(</span><span class="free">H</span><span class="main">â¦‡</span>carrier <span class="main">:=</span> <span class="free">Î¨</span> <span class="main">`</span> <span class="free">ğ”Š</span> <span class="main">!</span> Suc <span class="skolem">i</span><span class="main">â¦ˆ</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> H subgroup.subgroup_is_group<span class="main">)</span>
    <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"restrict <span class="free">Î¨</span> <span class="main">(</span><span class="free">ğ”Š</span> <span class="main">!</span> Suc <span class="skolem">i</span><span class="main">)</span> <span class="main">`</span> <span class="free">ğ”Š</span> <span class="main">!</span> <span class="skolem">i</span> <span class="main">âŠ²</span> <span class="free">H</span><span class="main">â¦‡</span>carrier <span class="main">:=</span> <span class="free">Î¨</span> <span class="main">`</span> <span class="free">ğ”Š</span> <span class="main">!</span> Suc <span class="skolem">i</span><span class="main">â¦ˆ</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> is_group H iso_normal_subgroup <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">cong</span> <span class="quasi_keyword">del</span><span class="main"><span class="main">:</span></span> image_cong_simp<span class="main">)</span>
    <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> norm <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">ğ”Š</span> <span class="main">!</span> <span class="skolem">i</span> <span class="main">âŠ†</span> <span class="free">ğ”Š</span> <span class="main">!</span> Suc <span class="skolem">i</span>"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> normal_def subgroup_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="main">{</span><span class="bound">y</span><span class="main">.</span> <span class="main">âˆƒ</span><span class="bound">x</span><span class="main">âˆˆ</span><span class="free">ğ”Š</span> <span class="main">!</span> <span class="skolem">i</span><span class="main">.</span> <span class="bound">y</span> <span class="main">=</span> <span class="main">(</span><span class="keyword1">if</span> <span class="bound">x</span> <span class="main">âˆˆ</span> <span class="free">ğ”Š</span> <span class="main">!</span> Suc <span class="skolem">i</span> <span class="keyword1">then</span> <span class="free">Î¨</span> <span class="bound">x</span> <span class="keyword1">else</span> undefined<span class="main">)</span><span class="main">}</span> <span class="main">=</span> <span class="main">{</span><span class="bound">y</span><span class="main">.</span> <span class="main">âˆƒ</span><span class="bound">x</span><span class="main">âˆˆ</span><span class="free">ğ”Š</span> <span class="main">!</span> <span class="skolem">i</span><span class="main">.</span> <span class="bound">y</span> <span class="main">=</span> <span class="free">Î¨</span> <span class="bound">x</span><span class="main">}</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="free">Î¨</span> <span class="main">`</span> <span class="free">ğ”Š</span> <span class="main">!</span> <span class="skolem">i</span> <span class="main">âŠ²</span> <span class="free">H</span><span class="main">â¦‡</span>carrier <span class="main">:=</span> <span class="free">Î¨</span> <span class="main">`</span> <span class="free">ğ”Š</span> <span class="main">!</span> Suc <span class="skolem">i</span><span class="main">â¦ˆ</span>"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> restrict_def image_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">qed</span></span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">subsection</span></span> <span class="quoted"><span class="plain_text">â€¹Composition Seriesâ€º</span></span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">â€¹A composition series is a normal series where all consecutive factor groups are simple:â€º</span></span>

<span class="keyword1"><span class="command">locale</span></span> composition_series <span class="main">=</span> normal_series <span class="main">+</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> simplefact<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="main">â‹€</span><span class="bound">i</span><span class="main">.</span> <span class="bound">i</span> <span class="main">+</span> <span class="main">1</span> <span class="main">&lt;</span>  length <span class="free">ğ”Š</span> <span class="main">âŸ¹</span> simple_group <span class="main">(</span><span class="free">G</span><span class="main">â¦‡</span>carrier <span class="main">:=</span> <span class="free">ğ”Š</span> <span class="main">!</span> <span class="main">(</span><span class="bound">i</span> <span class="main">+</span> <span class="main">1</span><span class="main">)</span><span class="main">â¦ˆ</span> <span class="keyword1">Mod</span> <span class="free">ğ”Š</span> <span class="main">!</span> <span class="bound">i</span><span class="main">)</span>"</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> composition_series<span class="main">)</span> is_composition_series<span class="main">:</span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"composition_series <span class="free">G</span> <span class="free">ğ”Š</span>"</span></span>
<span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> composition_series_axioms<span class="main">)</span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">â€¹A composition series for a group $G$ has length one if and only if $G$ is the trivial group.â€º</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> composition_series<span class="main">)</span> composition_series_length_one<span class="main">:</span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span>length <span class="free">ğ”Š</span> <span class="main">=</span> <span class="main">1</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="free">ğ”Š</span> <span class="main">=</span> <span class="main">[</span><span class="main">{</span><span class="main">ğŸ­</span><span class="main">}</span><span class="main">]</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span>
  <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"length <span class="free">ğ”Š</span> <span class="main">=</span> <span class="main">1</span>"</span></span>
  <span class="keyword1"><span class="command">with</span></span> hd <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"length <span class="free">ğ”Š</span> <span class="main">=</span> length <span class="main">[</span><span class="main">{</span><span class="main">ğŸ­</span><span class="main">}</span><span class="main">]</span> <span class="main">âˆ§</span> <span class="main">(</span><span class="main">âˆ€</span><span class="bound"><span class="bound">i</span></span> <span class="main">&lt;</span> length <span class="free">ğ”Š</span><span class="main">.</span> <span class="free">ğ”Š</span> <span class="main">!</span> <span class="bound">i</span> <span class="main">=</span> <span class="main">[</span><span class="main">{</span><span class="main">ğŸ­</span><span class="main">}</span><span class="main">]</span> <span class="main">!</span> <span class="bound">i</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> hd_conv_nth notempty <span class="keyword1"><span class="command">by</span></span> <span class="operator">force</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"<span class="free">ğ”Š</span> <span class="main">=</span> <span class="main">[</span><span class="main">{</span><span class="main">ğŸ­</span><span class="main">}</span><span class="main">]</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> list_eq_iff_nth_eq <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
<span class="keyword1"><span class="command">next</span></span>
  <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="free">ğ”Š</span> <span class="main">=</span> <span class="main">[</span><span class="main">{</span><span class="main">ğŸ­</span><span class="main">}</span><span class="main">]</span>"</span></span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"length <span class="free">ğ”Š</span> <span class="main">=</span> <span class="main">1</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> composition_series<span class="main">)</span> composition_series_triv_group<span class="main">:</span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span>carrier <span class="free">G</span> <span class="main">=</span> <span class="main">{</span><span class="main">ğŸ­</span><span class="main">}</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="free">ğ”Š</span> <span class="main">=</span> <span class="main">[</span><span class="main">{</span><span class="main">ğŸ­</span><span class="main">}</span><span class="main">]</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span>
  <span class="keyword3"><span class="command">assume</span></span> G<span class="main">:</span><span class="quoted"><span class="quoted">"carrier <span class="free">G</span> <span class="main">=</span> <span class="main">{</span><span class="main">ğŸ­</span><span class="main">}</span>"</span></span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"length <span class="free">ğ”Š</span> <span class="main">=</span> <span class="main">1</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">rule</span> ccontr<span class="main">)</span>
    <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"length <span class="free">ğ”Š</span> <span class="main">â‰ </span> <span class="main">1</span>"</span></span>
    <span class="keyword1"><span class="command">with</span></span> notempty <span class="keyword1"><span class="command">have</span></span> length<span class="main">:</span><span class="quoted"><span class="quoted">"length <span class="free">ğ”Š</span> <span class="main">â‰¥</span> <span class="numeral">2</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> Suc_eq_plus1 length_0_conv less_2_cases not_less plus_nat.add_0<span class="main">)</span>
    <span class="keyword1"><span class="command">with</span></span> simplefact hd hd_conv_nth notempty <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"simple_group <span class="main">(</span><span class="free">G</span><span class="main">â¦‡</span>carrier <span class="main">:=</span> <span class="free">ğ”Š</span> <span class="main">!</span> <span class="main">1</span><span class="main">â¦ˆ</span> <span class="keyword1">Mod</span> <span class="main">{</span><span class="main">ğŸ­</span><span class="main">}</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">force</span>
    <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> SG<span class="main">:</span><span class="quoted"><span class="quoted">"subgroup <span class="main">(</span><span class="free">ğ”Š</span> <span class="main">!</span> <span class="main">1</span><span class="main">)</span> <span class="free">G</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> length normal_series_subgroups <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"group <span class="main">(</span><span class="free">G</span><span class="main">â¦‡</span>carrier <span class="main">:=</span> <span class="free">ğ”Š</span> <span class="main">!</span> <span class="main">1</span><span class="main">â¦ˆ</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> subgroup_imp_group<span class="main">)</span>
    <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span>  <span class="quoted"><span class="quoted">"simple_group <span class="main">(</span><span class="free">G</span><span class="main">â¦‡</span>carrier <span class="main">:=</span> <span class="free">ğ”Š</span> <span class="main">!</span> <span class="main">1</span><span class="main">â¦ˆ</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> group.trivial_factor_iso simple_group.iso_simple <span class="keyword1"><span class="command">by</span></span> <span class="operator">fastforce</span>
    <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> SG G <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"carrier <span class="main">(</span><span class="free">G</span><span class="main">â¦‡</span>carrier <span class="main">:=</span> <span class="free">ğ”Š</span> <span class="main">!</span> <span class="main">1</span><span class="main">â¦ˆ</span><span class="main">)</span> <span class="main">=</span> <span class="main">{</span><span class="main">ğŸ­</span><span class="main">}</span>"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> subgroup_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted">False</span> <span class="keyword1"><span class="command">using</span></span> simple_group.simple_not_triv <span class="keyword1"><span class="command">by</span></span> <span class="operator">force</span>
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"<span class="free">ğ”Š</span> <span class="main">=</span> <span class="main">[</span><span class="main">{</span><span class="main">ğŸ­</span><span class="main">}</span><span class="main">]</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> composition_series_length_one<span class="main">)</span>
<span class="keyword1"><span class="command">next</span></span>
  <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="free">ğ”Š</span> <span class="main">=</span> <span class="main">[</span><span class="main">{</span><span class="main">ğŸ­</span><span class="main">}</span><span class="main">]</span>"</span></span>
  <span class="keyword1"><span class="command">with</span></span> last <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"carrier <span class="free">G</span> <span class="main">=</span> <span class="main">{</span><span class="main">ğŸ­</span><span class="main">}</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">â€¹The inner elements of a composition series may not consist of the trivial subgroup or the
group itself.â€º</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> composition_series<span class="main">)</span> inner_elements_not_triv<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">i</span> <span class="main">+</span> <span class="main">1</span> <span class="main">&lt;</span> length <span class="free">ğ”Š</span>"</span></span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">i</span> <span class="main">&gt;</span> <span class="main">0</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">ğ”Š</span> <span class="main">!</span> <span class="free">i</span> <span class="main">â‰ </span> <span class="main">{</span><span class="main">ğŸ­</span><span class="main">}</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span>
  <span class="keyword1"><span class="command">from</span></span> assms <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">i</span> <span class="main">-</span> <span class="main">1</span><span class="main">)</span> <span class="main">+</span> <span class="main">1</span> <span class="main">&lt;</span> length <span class="free">ğ”Š</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">hence</span></span> simple<span class="main">:</span><span class="quoted"><span class="quoted">"simple_group <span class="main">(</span><span class="free">G</span><span class="main">â¦‡</span>carrier <span class="main">:=</span> <span class="free">ğ”Š</span> <span class="main">!</span> <span class="main">(</span><span class="main">(</span><span class="free">i</span> <span class="main">-</span> <span class="main">1</span><span class="main">)</span> <span class="main">+</span> <span class="main">1</span><span class="main">)</span><span class="main">â¦ˆ</span> <span class="keyword1">Mod</span> <span class="free">ğ”Š</span> <span class="main">!</span> <span class="main">(</span><span class="free">i</span> <span class="main">-</span> <span class="main">1</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> simplefact <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword3"><span class="command">assume</span></span> i<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="free">ğ”Š</span> <span class="main">!</span> <span class="free">i</span> <span class="main">=</span> <span class="main">{</span><span class="main">ğŸ­</span><span class="main">}</span>"</span></span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> assms <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">i</span> <span class="main">-</span> <span class="main">1</span><span class="main">)</span> <span class="main">+</span> <span class="main">1</span> <span class="main">=</span> <span class="free">i</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">G</span><span class="main">â¦‡</span>carrier <span class="main">:=</span> <span class="free">ğ”Š</span> <span class="main">!</span> <span class="main">(</span><span class="main">(</span><span class="free">i</span> <span class="main">-</span> <span class="main">1</span><span class="main">)</span> <span class="main">+</span> <span class="main">1</span><span class="main">)</span><span class="main">â¦ˆ</span> <span class="keyword1">Mod</span> <span class="free">ğ”Š</span> <span class="main">!</span> <span class="main">(</span><span class="free">i</span> <span class="main">-</span> <span class="main">1</span><span class="main">)</span> <span class="main">=</span> <span class="free">G</span><span class="main">â¦‡</span>carrier <span class="main">:=</span> <span class="main">{</span><span class="main">ğŸ­</span><span class="main">}</span><span class="main">â¦ˆ</span> <span class="keyword1">Mod</span> <span class="free">ğ”Š</span> <span class="main">!</span> <span class="main">(</span><span class="free">i</span> <span class="main">-</span> <span class="main">1</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> i <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"order <span class="main">(</span><span class="free">G</span><span class="main">â¦‡</span>carrier <span class="main">:=</span> <span class="free">ğ”Š</span> <span class="main">!</span> <span class="main">(</span><span class="main">(</span><span class="free">i</span> <span class="main">-</span> <span class="main">1</span><span class="main">)</span> <span class="main">+</span> <span class="main">1</span><span class="main">)</span><span class="main">â¦ˆ</span> <span class="keyword1">Mod</span> <span class="free">ğ”Š</span> <span class="main">!</span> <span class="main">(</span><span class="free">i</span> <span class="main">-</span> <span class="main">1</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> <span class="main">1</span>"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> FactGroup_def order_def RCOSETS_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">force</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"False"</span></span> <span class="keyword1"><span class="command">using</span></span> i simple <span class="keyword1"><span class="command">unfolding</span></span> simple_group_def simple_group_axioms_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">â€¹A composition series of a simple group always is its trivial one.â€º</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> composition_series<span class="main">)</span> composition_series_simple_group<span class="main">:</span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span>simple_group <span class="free">G</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="free">ğ”Š</span> <span class="main">=</span> <span class="main">[</span><span class="main">{</span><span class="main">ğŸ­</span><span class="main">}</span><span class="main">,</span> carrier <span class="free">G</span><span class="main">]</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span>
  <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="free">ğ”Š</span> <span class="main">=</span> <span class="main">[</span><span class="main">{</span><span class="main">ğŸ­</span><span class="main">}</span><span class="main">,</span> carrier <span class="free">G</span><span class="main">]</span>"</span></span>
  <span class="keyword1"><span class="command">with</span></span> simplefact <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"simple_group <span class="main">(</span><span class="free">G</span> <span class="keyword1">Mod</span> <span class="main">{</span><span class="main">ğŸ­</span><span class="main">}</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"the_elem <span class="main">âˆˆ</span> iso <span class="main">(</span><span class="free">G</span> <span class="keyword1">Mod</span> <span class="main">{</span><span class="main">ğŸ­</span><span class="main">}</span><span class="main">)</span> <span class="free">G</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> trivial_factor_iso<span class="main">)</span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"simple_group <span class="free">G</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> is_group simple_group.iso_simple<span class="main">)</span>
<span class="keyword1"><span class="command">next</span></span>
  <span class="keyword3"><span class="command">assume</span></span> simple<span class="main">:</span><span class="quoted"><span class="quoted">"simple_group <span class="free">G</span>"</span></span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"length <span class="free">ğ”Š</span> <span class="main">&gt;</span> <span class="main">1</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">rule</span> ccontr<span class="main">)</span>
    <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">Â¬</span> <span class="main">1</span> <span class="main">&lt;</span> length <span class="free">ğ”Š</span>"</span></span>
    <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"length <span class="free">ğ”Š</span> <span class="main">=</span> <span class="main">1</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> Suc_leI antisym notempty<span class="main">)</span>
    <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"carrier <span class="free">G</span> <span class="main">=</span> <span class="main">{</span><span class="main">ğŸ­</span><span class="main">}</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> hd last <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> composition_series_length_one composition_series_triv_group<span class="main">)</span>
    <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"order <span class="free">G</span> <span class="main">=</span> <span class="main">1</span>"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> order_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">with</span></span> simple <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"False"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> simple_group_def simple_group_axioms_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"length <span class="free">ğ”Š</span> <span class="main">â‰¤</span> <span class="numeral">2</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">rule</span> ccontr<span class="main">)</span>
    <span class="keyword3"><span class="command">define</span></span> <span class="skolem"><span class="skolem">k</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">k</span> <span class="main">=</span> length <span class="free">ğ”Š</span> <span class="main">-</span> <span class="numeral">2</span>"</span></span>
    <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">Â¬</span> <span class="main">(</span>length <span class="free">ğ”Š</span> <span class="main">â‰¤</span> <span class="numeral">2</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">hence</span></span> gt2<span class="main">:</span><span class="quoted"><span class="quoted">"length <span class="free">ğ”Š</span> <span class="main">&gt;</span> <span class="numeral">2</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">hence</span></span> ksmall<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">k</span> <span class="main">+</span> <span class="main">1</span> <span class="main">&lt;</span> length <span class="free">ğ”Š</span>"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> k_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">from</span></span> gt2 <span class="keyword1"><span class="command">have</span></span> carrier<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="free">ğ”Š</span> <span class="main">!</span> <span class="main">(</span><span class="skolem">k</span> <span class="main">+</span> <span class="main">1</span><span class="main">)</span> <span class="main">=</span> carrier <span class="free">G</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> notempty last last_conv_nth k_def
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> Nat.add_diff_assoc Nat.diff_cancel <span class="quoted"><span class="quoted">â€¹<span class="main">Â¬</span> length <span class="free">ğ”Š</span> <span class="main">â‰¤</span> <span class="numeral">2</span>â€º</span></span> add.commute nat_le_linear one_add_one<span class="main">)</span>
    <span class="keyword1"><span class="command">from</span></span> normal ksmall <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">ğ”Š</span> <span class="main">!</span> <span class="skolem">k</span> <span class="main">âŠ²</span> <span class="free">G</span><span class="main">â¦‡</span> carrier <span class="main">:=</span> <span class="free">ğ”Š</span> <span class="main">!</span> <span class="main">(</span><span class="skolem">k</span> <span class="main">+</span> <span class="main">1</span><span class="main">)</span><span class="main">â¦ˆ</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">from</span></span> simplefact ksmall <span class="keyword1"><span class="command">have</span></span> simplek<span class="main">:</span><span class="quoted"><span class="quoted">"simple_group <span class="main">(</span><span class="free">G</span><span class="main">â¦‡</span>carrier <span class="main">:=</span> <span class="free">ğ”Š</span> <span class="main">!</span> <span class="main">(</span><span class="skolem">k</span> <span class="main">+</span> <span class="main">1</span><span class="main">)</span><span class="main">â¦ˆ</span> <span class="keyword1">Mod</span> <span class="free">ğ”Š</span> <span class="main">!</span> <span class="skolem">k</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">from</span></span> simplefact ksmall <span class="keyword1"><span class="command">have</span></span> simplek'<span class="main">:</span><span class="quoted"><span class="quoted">"simple_group <span class="main">(</span><span class="free">G</span><span class="main">â¦‡</span>carrier <span class="main">:=</span> <span class="free">ğ”Š</span> <span class="main">!</span> <span class="main">(</span><span class="main">(</span><span class="skolem">k</span> <span class="main">-</span> <span class="main">1</span><span class="main">)</span> <span class="main">+</span> <span class="main">1</span><span class="main">)</span><span class="main">â¦ˆ</span> <span class="keyword1">Mod</span> <span class="free">ğ”Š</span> <span class="main">!</span> <span class="main">(</span><span class="skolem">k</span> <span class="main">-</span> <span class="main">1</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">ğ”Š</span> <span class="main">!</span> <span class="skolem">k</span> <span class="main">âŠ²</span> <span class="free">G</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> carrier k_def gt2 normal ksmall <span class="keyword1"><span class="command">by</span></span> <span class="operator">force</span>
    <span class="keyword1"><span class="command">with</span></span> simple <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">ğ”Š</span> <span class="main">!</span> <span class="skolem">k</span><span class="main">)</span> <span class="main">=</span> carrier <span class="free">G</span> <span class="main">âˆ¨</span> <span class="main">(</span><span class="free">ğ”Š</span> <span class="main">!</span> <span class="skolem">k</span><span class="main">)</span> <span class="main">=</span> <span class="main">{</span><span class="main">ğŸ­</span><span class="main">}</span>"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> simple_group_def simple_group_axioms_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"False"</span></span>
    <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">rule</span> disjE<span class="main">)</span>
      <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="free">ğ”Š</span> <span class="main">!</span> <span class="skolem">k</span> <span class="main">=</span> carrier <span class="free">G</span>"</span></span>
      <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="free">G</span><span class="main">â¦‡</span>carrier <span class="main">:=</span> <span class="free">ğ”Š</span> <span class="main">!</span> <span class="main">(</span><span class="skolem">k</span> <span class="main">+</span> <span class="main">1</span><span class="main">)</span><span class="main">â¦ˆ</span> <span class="keyword1">Mod</span> <span class="free">ğ”Š</span> <span class="main">!</span> <span class="skolem">k</span> <span class="main">=</span> <span class="free">G</span> <span class="keyword1">Mod</span> <span class="main">(</span>carrier <span class="free">G</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> carrier <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">with</span></span> simplek self_factor_not_simple <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"False"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">next</span></span>
      <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="free">ğ”Š</span> <span class="main">!</span> <span class="skolem">k</span> <span class="main">=</span> <span class="main">{</span><span class="main">ğŸ­</span><span class="main">}</span>"</span></span>
      <span class="keyword1"><span class="command">with</span></span> ksmall k_def gt2 <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"False"</span></span> <span class="keyword1"><span class="command">using</span></span> inner_elements_not_triv <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"length <span class="free">ğ”Š</span> <span class="main">=</span> <span class="numeral">2</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"<span class="free">ğ”Š</span> <span class="main">=</span> <span class="main">[</span><span class="main">{</span><span class="main">ğŸ­</span><span class="main">}</span><span class="main">,</span> carrier <span class="free">G</span><span class="main">]</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> length_two_unique<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">â€¹Two consecutive elements in a composition series are distinct.â€º</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> composition_series<span class="main">)</span> entries_distinct<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> finite<span class="main">:</span><span class="quoted"><span class="quoted">"finite <span class="main">(</span>carrier <span class="free">G</span><span class="main">)</span>"</span></span>
  <span class="keyword2"><span class="keyword">assumes</span></span> i<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="free">i</span> <span class="main">+</span> <span class="main">1</span> <span class="main">&lt;</span> length <span class="free">ğ”Š</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">ğ”Š</span> <span class="main">!</span> <span class="free">i</span> <span class="main">â‰ </span> <span class="free">ğ”Š</span> <span class="main">!</span> <span class="main">(</span><span class="free">i</span> <span class="main">+</span> <span class="main">1</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span>
  <span class="keyword1"><span class="command">from</span></span> finite <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"finite  <span class="main">(</span><span class="free">ğ”Š</span> <span class="main">!</span> <span class="main">(</span><span class="free">i</span> <span class="main">+</span> <span class="main">1</span><span class="main">)</span><span class="main">)</span>"</span></span> 
    <span class="keyword1"><span class="command">using</span></span> i normal_series_subgroups subgroup.subset rev_finite_subset <span class="keyword1"><span class="command">by</span></span> <span class="operator">metis</span>
  <span class="keyword1"><span class="command">hence</span></span> fin<span class="main">:</span><span class="quoted"><span class="quoted">"finite <span class="main">(</span>carrier <span class="main">(</span><span class="free">G</span><span class="main">â¦‡</span>carrier <span class="main">:=</span> <span class="free">ğ”Š</span> <span class="main">!</span> <span class="main">(</span><span class="free">i</span> <span class="main">+</span> <span class="main">1</span><span class="main">)</span><span class="main">â¦ˆ</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">from</span></span> i <span class="keyword1"><span class="command">have</span></span> norm<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="free">ğ”Š</span> <span class="main">!</span> <span class="free">i</span> <span class="main">âŠ²</span> <span class="main">(</span><span class="free">G</span><span class="main">â¦‡</span>carrier <span class="main">:=</span> <span class="free">ğ”Š</span> <span class="main">!</span> <span class="main">(</span><span class="free">i</span> <span class="main">+</span> <span class="main">1</span><span class="main">)</span><span class="main">â¦ˆ</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> normal<span class="main">)</span>
  <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="free">ğ”Š</span> <span class="main">!</span> <span class="free">i</span> <span class="main">=</span> <span class="free">ğ”Š</span> <span class="main">!</span> <span class="main">(</span><span class="free">i</span> <span class="main">+</span> <span class="main">1</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="free">ğ”Š</span> <span class="main">!</span> <span class="free">i</span> <span class="main">=</span> carrier <span class="main">(</span><span class="free">G</span><span class="main">â¦‡</span>carrier <span class="main">:=</span> <span class="free">ğ”Š</span> <span class="main">!</span> <span class="main">(</span><span class="free">i</span> <span class="main">+</span> <span class="main">1</span><span class="main">)</span><span class="main">â¦ˆ</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"carrier <span class="main">(</span><span class="main">(</span><span class="free">G</span><span class="main">â¦‡</span>carrier <span class="main">:=</span> <span class="main">(</span><span class="free">ğ”Š</span> <span class="main">!</span> <span class="main">(</span><span class="free">i</span> <span class="main">+</span> <span class="main">1</span><span class="main">)</span><span class="main">)</span><span class="main">â¦ˆ</span><span class="main">)</span> <span class="keyword1">Mod</span> <span class="main">(</span><span class="free">ğ”Š</span> <span class="main">!</span> <span class="free">i</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> <span class="main">{</span><span class="main">ğŸ­</span><span class="hidden">â‡˜</span><sub><span class="main">(</span><span class="free">G</span><span class="main">â¦‡</span>carrier <span class="main">:=</span> <span class="free">ğ”Š</span> <span class="main">!</span> <span class="main">(</span><span class="free">i</span> <span class="main">+</span> <span class="main">1</span><span class="main">)</span><span class="main">â¦ˆ</span><span class="main">)</span> <span class="keyword1">Mod</span> <span class="free">ğ”Š</span> <span class="main">!</span> <span class="free">i</span></sub><span class="hidden">â‡™</span><span class="main">}</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> norm fin normal.fact_group_trivial_iff <span class="keyword1"><span class="command">by</span></span> <span class="operator">metis</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="main">Â¬</span> simple_group <span class="main">(</span><span class="main">(</span><span class="free">G</span><span class="main">â¦‡</span>carrier <span class="main">:=</span> <span class="main">(</span><span class="free">ğ”Š</span> <span class="main">!</span> <span class="main">(</span><span class="free">i</span> <span class="main">+</span> <span class="main">1</span><span class="main">)</span><span class="main">)</span><span class="main">â¦ˆ</span><span class="main">)</span> <span class="keyword1">Mod</span> <span class="main">(</span><span class="free">ğ”Š</span> <span class="main">!</span> <span class="free">i</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> simple_group.simple_not_triv<span class="main">)</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="quoted">False</span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> i simplefact<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">â€¹The normal series for groups of order <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">term</span></span> <span class="quoted"><span class="quoted">"<span class="free"><span class="free">p</span></span> <span class="main"><span class="main">*</span></span> <span class="free"><span class="free">q</span></span>"</span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span> is even a composition series:â€º</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> group<span class="main">)</span> pq_order_composition_series<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> finite<span class="main">:</span><span class="quoted"><span class="quoted">"finite <span class="main">(</span>carrier <span class="free">G</span><span class="main">)</span>"</span></span>
  <span class="keyword2"><span class="keyword">assumes</span></span> orderG<span class="main">:</span><span class="quoted"><span class="quoted">"order <span class="free">G</span> <span class="main">=</span> <span class="free">q</span> <span class="main">*</span> <span class="free">p</span>"</span></span>
  <span class="keyword2"><span class="keyword">assumes</span></span> primep<span class="main">:</span><span class="quoted"><span class="quoted">"prime <span class="free">p</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> primeq<span class="main">:</span><span class="quoted"><span class="quoted">"prime <span class="free">q</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> pq<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="free">p</span> <span class="main">&lt;</span> <span class="free">q</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"composition_series <span class="free">G</span> <span class="main">[</span><span class="main">{</span><span class="main">ğŸ­</span><span class="main">}</span><span class="main">,</span> <span class="main">(</span><span class="keyword1">THE</span> <span class="bound">H</span><span class="main">.</span> <span class="bound">H</span> <span class="main">âˆˆ</span> subgroups_of_size <span class="free">q</span><span class="main">)</span><span class="main">,</span> carrier <span class="free">G</span><span class="main">]</span>"</span></span>
<span class="keyword1"><span class="command">unfolding</span></span> composition_series_def composition_series_axioms_def
<span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="main">(</span><span class="operator">auto</span><span class="main">)</span>
<span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="main">(</span><span class="operator">rule</span> pq_order_normal_series<span class="main">)</span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword3"><span class="command">define</span></span> <span class="skolem"><span class="skolem">H</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">H</span> <span class="main">=</span> <span class="main">(</span><span class="keyword1">THE</span> <span class="bound">H</span><span class="main">.</span> <span class="bound">H</span> <span class="main">âˆˆ</span> subgroups_of_size <span class="free">q</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">from</span></span> assms <span class="keyword1"><span class="command">have</span></span> exi<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="main">âˆƒ!</span><span class="bound">Q</span><span class="main">.</span> <span class="bound">Q</span> <span class="main">âˆˆ</span> <span class="main">(</span>subgroups_of_size <span class="free">q</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> pq_order_unique_subgrp<span class="main">)</span>
  <span class="keyword1"><span class="command">hence</span></span> Hsize<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">H</span> <span class="main">âˆˆ</span> subgroups_of_size <span class="free">q</span>"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> H_def <span class="keyword1"><span class="command">using</span></span> theI' <span class="keyword1"><span class="command">by</span></span> <span class="operator">metis</span>
  <span class="keyword1"><span class="command">hence</span></span> HsubG<span class="main">:</span><span class="quoted"><span class="quoted">"subgroup <span class="skolem">H</span> <span class="free">G</span>"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> subgroups_of_size_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">interpret</span></span> Hgroup<span class="main">:</span> group <span class="quoted"><span class="quoted">"<span class="free">G</span><span class="main">â¦‡</span>carrier <span class="main">:=</span> <span class="skolem">H</span><span class="main">â¦ˆ</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> subgroup_imp_group<span class="main">)</span>
  <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">i</span>
  <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">i</span> <span class="main">&lt;</span> Suc <span class="main">(</span>Suc <span class="main">0</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">i</span> <span class="main">=</span> <span class="main">0</span> <span class="main">âˆ¨</span> <span class="skolem">i</span> <span class="main">=</span> <span class="main">1</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"simple_group <span class="main">(</span><span class="free">G</span><span class="main">â¦‡</span>carrier <span class="main">:=</span> <span class="main">[</span><span class="skolem">H</span><span class="main">,</span> carrier <span class="free">G</span><span class="main">]</span> <span class="main">!</span> <span class="skolem">i</span><span class="main">â¦ˆ</span> <span class="keyword1">Mod</span> <span class="main">[</span><span class="main">{</span><span class="main">ğŸ­</span><span class="main">}</span><span class="main">,</span> <span class="skolem">H</span><span class="main">,</span> carrier <span class="free">G</span><span class="main">]</span> <span class="main">!</span> <span class="skolem">i</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span>
    <span class="keyword3"><span class="command">assume</span></span> i<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">i</span> <span class="main">=</span> <span class="main">0</span>"</span></span>
    <span class="keyword1"><span class="command">from</span></span> Hsize <span class="keyword1"><span class="command">have</span></span> orderH<span class="main">:</span><span class="quoted"><span class="quoted">"order <span class="main">(</span><span class="free">G</span><span class="main">â¦‡</span>carrier <span class="main">:=</span> <span class="skolem">H</span><span class="main">â¦ˆ</span><span class="main">)</span> <span class="main">=</span> <span class="free">q</span>"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> subgroups_of_size_def order_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"order <span class="main">(</span><span class="free">G</span><span class="main">â¦‡</span>carrier <span class="main">:=</span> <span class="skolem">H</span><span class="main">â¦ˆ</span> <span class="keyword1">Mod</span> <span class="main">{</span><span class="main">ğŸ­</span><span class="main">}</span><span class="main">)</span> <span class="main">=</span> <span class="free">q</span>"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> FactGroup_def <span class="keyword1"><span class="command">using</span></span> card_rcosets_triv order_def
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> Hgroup.card_rcosets_triv HsubG finite monoid.cases_scheme monoid.select_convs<span class="main"><span class="main">(</span></span>2<span class="main"><span class="main">)</span></span> partial_object.select_convs<span class="main"><span class="main">(</span></span>1<span class="main"><span class="main">)</span></span> partial_object.update_convs<span class="main"><span class="main">(</span></span>1<span class="main"><span class="main">)</span></span> subgroup_finite<span class="main">)</span>
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"normal <span class="main">{</span><span class="main">ğŸ­</span><span class="main">}</span> <span class="main">(</span><span class="free">G</span><span class="main">â¦‡</span>carrier <span class="main">:=</span> <span class="skolem">H</span><span class="main">â¦ˆ</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> Hgroup.is_group Hgroup.normal_inv_iff HsubG group.trivial_subgroup_is_normal is_group singleton_iff subgroup.one_closed subgroup.subgroup_of_subgroup<span class="main">)</span>
    <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"group <span class="main">(</span><span class="free">G</span><span class="main">â¦‡</span>carrier <span class="main">:=</span> <span class="skolem">H</span><span class="main">â¦ˆ</span> <span class="keyword1">Mod</span> <span class="main">{</span><span class="main">ğŸ­</span><span class="main">}</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> normal.factorgroup_is_group<span class="main">)</span>
    <span class="keyword1"><span class="command">with</span></span> orderH primeq <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"simple_group <span class="main">(</span><span class="free">G</span><span class="main">â¦‡</span>carrier <span class="main">:=</span> <span class="skolem">H</span><span class="main">â¦ˆ</span> <span class="keyword1">Mod</span> <span class="main">{</span><span class="main">ğŸ­</span><span class="main">}</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> <span class="quoted"><span class="quoted">â€¹order <span class="main">(</span><span class="free">G</span><span class="main">â¦‡</span>carrier <span class="main">:=</span> <span class="skolem">H</span><span class="main">â¦ˆ</span> <span class="keyword1">Mod</span> <span class="main">{</span><span class="main">ğŸ­</span><span class="main">}</span><span class="main">)</span> <span class="main">=</span> <span class="free">q</span>â€º</span></span> group.prime_order_simple<span class="main">)</span>
    <span class="keyword1"><span class="command">with</span></span> i <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">next</span></span>
    <span class="keyword3"><span class="command">assume</span></span> i<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">i</span> <span class="main">=</span> <span class="main">1</span>"</span></span>
    <span class="keyword1"><span class="command">from</span></span> assms exi <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">H</span> <span class="main">âŠ²</span> <span class="free">G</span>"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> H_def <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> pq_order_subgrp_normal<span class="main">)</span>
    <span class="keyword1"><span class="command">hence</span></span> groupGH<span class="main">:</span><span class="quoted"><span class="quoted">"group <span class="main">(</span><span class="free">G</span> <span class="keyword1">Mod</span> <span class="skolem">H</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> normal.factorgroup_is_group<span class="main">)</span>
    <span class="keyword1"><span class="command">from</span></span> primeq <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">q</span> <span class="main">â‰ </span> <span class="main">0</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> not_prime_0<span class="main">)</span>
    <span class="keyword1"><span class="command">from</span></span> HsubG finite orderG <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"card <span class="main">(</span><span class="keyword1">rcosets</span> <span class="skolem">H</span><span class="main">)</span> <span class="main">*</span> card <span class="skolem">H</span> <span class="main">=</span> <span class="free">q</span> <span class="main">*</span> <span class="free">p</span>"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> subgroups_of_size_def <span class="keyword1"><span class="command">using</span></span> lagrange <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">with</span></span> Hsize <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"card <span class="main">(</span><span class="keyword1">rcosets</span> <span class="skolem">H</span><span class="main">)</span> <span class="main">*</span> <span class="free">q</span> <span class="main">=</span> <span class="free">q</span> <span class="main">*</span> <span class="free">p</span>"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> subgroups_of_size_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">with</span></span> <span class="quoted"><span class="quoted">â€¹<span class="free">q</span> <span class="main">â‰ </span> <span class="main">0</span>â€º</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"card <span class="main">(</span><span class="keyword1">rcosets</span> <span class="skolem">H</span><span class="main">)</span> <span class="main">=</span> <span class="free">p</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"order <span class="main">(</span><span class="free">G</span> <span class="keyword1">Mod</span> <span class="skolem">H</span><span class="main">)</span> <span class="main">=</span> <span class="free">p</span>"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> order_def FactGroup_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">with</span></span> groupGH primep <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"simple_group <span class="main">(</span><span class="free">G</span> <span class="keyword1">Mod</span> <span class="skolem">H</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> group.prime_order_simple<span class="main">)</span>
    <span class="keyword1"><span class="command">with</span></span> i <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">qed</span></span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">â€¹Prefixes of composition series are also composition series.â€º</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> composition_series<span class="main">)</span> composition_series_prefix_closed<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">i</span> <span class="main">â‰¤</span> length <span class="free">ğ”Š</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">0</span> <span class="main">&lt;</span> <span class="free">i</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"composition_series <span class="main">(</span><span class="free">G</span><span class="main">â¦‡</span>carrier <span class="main">:=</span> <span class="free">ğ”Š</span> <span class="main">!</span> <span class="main">(</span><span class="free">i</span> <span class="main">-</span> <span class="main">1</span><span class="main">)</span><span class="main">â¦ˆ</span><span class="main">)</span> <span class="main">(</span>take <span class="free">i</span> <span class="free">ğ”Š</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">unfolding</span></span> composition_series_def composition_series_axioms_def
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">from</span></span> assms <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"normal_series <span class="main">(</span><span class="free">G</span><span class="main">â¦‡</span>carrier <span class="main">:=</span> <span class="free">ğ”Š</span> <span class="main">!</span> <span class="main">(</span><span class="free">i</span> <span class="main">-</span> Suc <span class="main">0</span><span class="main">)</span><span class="main">â¦ˆ</span><span class="main">)</span> <span class="main">(</span>take <span class="free">i</span> <span class="free">ğ”Š</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> One_nat_def normal_series_prefix_closed<span class="main">)</span>
<span class="keyword1"><span class="command">next</span></span>
  <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">j</span>
  <span class="keyword3"><span class="command">assume</span></span> j<span class="main">:</span><span class="quoted"><span class="quoted">"Suc <span class="skolem">j</span> <span class="main">&lt;</span> length <span class="free">ğ”Š</span>"</span></span> <span class="quoted"><span class="quoted">"Suc <span class="skolem">j</span> <span class="main">&lt;</span> <span class="free">i</span>"</span></span>
  <span class="keyword1"><span class="command">with</span></span> simplefact <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"simple_group <span class="main">(</span><span class="free">G</span><span class="main">â¦‡</span>carrier <span class="main">:=</span> <span class="free">ğ”Š</span> <span class="main">!</span> Suc <span class="skolem">j</span><span class="main">â¦ˆ</span> <span class="keyword1">Mod</span> <span class="free">ğ”Š</span> <span class="main">!</span> <span class="skolem">j</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> Suc_eq_plus1<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">â€¹The second element in a composition series is simple group.â€º</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> composition_series<span class="main">)</span> composition_series_snd_simple<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="numeral">2</span> <span class="main">â‰¤</span> length <span class="free">ğ”Š</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"simple_group <span class="main">(</span><span class="free">G</span><span class="main">â¦‡</span>carrier <span class="main">:=</span> <span class="free">ğ”Š</span> <span class="main">!</span> <span class="main">1</span><span class="main">â¦ˆ</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">from</span></span> assms <span class="keyword1"><span class="command">interpret</span></span> compTake<span class="main">:</span> composition_series <span class="quoted"><span class="quoted">"<span class="free">G</span><span class="main">â¦‡</span>carrier <span class="main">:=</span> <span class="free">ğ”Š</span> <span class="main">!</span> <span class="main">1</span><span class="main">â¦ˆ</span>"</span></span> <span class="quoted"><span class="quoted">"take <span class="numeral">2</span> <span class="free">ğ”Š</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> add_diff_cancel_right' composition_series_prefix_closed one_add_one zero_less_numeral<span class="main">)</span>
  <span class="keyword1"><span class="command">from</span></span> assms <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"length <span class="main">(</span>take <span class="numeral">2</span> <span class="free">ğ”Š</span><span class="main">)</span> <span class="main">=</span> <span class="numeral">2</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> add_diff_cancel_right' append_take_drop_id diff_diff_cancel length_append length_drop<span class="main">)</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span>take <span class="numeral">2</span> <span class="free">ğ”Š</span><span class="main">)</span> <span class="main">=</span> <span class="main">[</span><span class="main">{</span><span class="main">ğŸ­</span><span class="hidden">â‡˜</span><sub><span class="main">(</span><span class="free">G</span><span class="main">â¦‡</span>carrier <span class="main">:=</span> <span class="free">ğ”Š</span> <span class="main">!</span> <span class="main">1</span><span class="main">â¦ˆ</span><span class="main">)</span></sub><span class="hidden">â‡™</span><span class="main">}</span><span class="main">,</span> carrier <span class="main">(</span><span class="free">G</span><span class="main">â¦‡</span>carrier <span class="main">:=</span> <span class="free">ğ”Š</span> <span class="main">!</span> <span class="main">1</span><span class="main">â¦ˆ</span><span class="main">)</span><span class="main">]</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> compTake.length_two_unique<span class="main">)</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> compTake.composition_series_simple_group<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">â€¹As a stronger way to state the previous lemma: An entry of a composition series is 
  simple if and only if it is the second one.â€º</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> composition_series<span class="main">)</span> composition_snd_simple_iff<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">i</span> <span class="main">&lt;</span> length <span class="free">ğ”Š</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span>simple_group <span class="main">(</span><span class="free">G</span><span class="main">â¦‡</span>carrier <span class="main">:=</span>  <span class="free">ğ”Š</span> <span class="main">!</span> <span class="free">i</span><span class="main">â¦ˆ</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="free">i</span> <span class="main">=</span> <span class="main">1</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span>
  <span class="keyword3"><span class="command">assume</span></span> simpi<span class="main">:</span><span class="quoted"><span class="quoted">"simple_group <span class="main">(</span><span class="free">G</span><span class="main">â¦‡</span>carrier <span class="main">:=</span> <span class="free">ğ”Š</span> <span class="main">!</span> <span class="free">i</span><span class="main">â¦ˆ</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="free">ğ”Š</span> <span class="main">!</span> <span class="free">i</span> <span class="main">â‰ </span> <span class="main">{</span><span class="main">ğŸ­</span><span class="main">}</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> simple_group.simple_not_triv <span class="keyword1"><span class="command">by</span></span> <span class="operator">force</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="free">i</span> <span class="main">â‰ </span> <span class="main">0</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> hd hd_conv_nth notempty <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">interpret</span></span> compTake<span class="main">:</span> composition_series <span class="quoted"><span class="quoted">"<span class="free">G</span><span class="main">â¦‡</span>carrier <span class="main">:=</span> <span class="free">ğ”Š</span> <span class="main">!</span> <span class="free">i</span><span class="main">â¦ˆ</span>"</span></span> <span class="quoted"><span class="quoted">"take <span class="main">(</span>Suc <span class="free">i</span><span class="main">)</span> <span class="free">ğ”Š</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> assms composition_series_prefix_closed <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> diff_Suc_1 less_eq_Suc_le zero_less_Suc<span class="main">)</span>
  <span class="keyword1"><span class="command">from</span></span> simpi <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span>take <span class="main">(</span>Suc <span class="free">i</span><span class="main">)</span> <span class="free">ğ”Š</span><span class="main">)</span> <span class="main">=</span> <span class="main">[</span><span class="main">{</span><span class="main">ğŸ­</span><span class="hidden">â‡˜</span><sub><span class="free">G</span><span class="main">â¦‡</span>carrier <span class="main">:=</span> <span class="free">ğ”Š</span> <span class="main">!</span> <span class="free">i</span><span class="main">â¦ˆ</span></sub><span class="hidden">â‡™</span><span class="main">}</span><span class="main">,</span> carrier <span class="main">(</span><span class="free">G</span><span class="main">â¦‡</span>carrier <span class="main">:=</span> <span class="free">ğ”Š</span> <span class="main">!</span> <span class="free">i</span><span class="main">â¦ˆ</span><span class="main">)</span><span class="main">]</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> compTake.composition_series_simple_group<span class="main">)</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"length <span class="main">(</span>take <span class="main">(</span>Suc <span class="free">i</span><span class="main">)</span> <span class="free">ğ”Š</span><span class="main">)</span> <span class="main">=</span> <span class="numeral">2</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"min <span class="main">(</span>length <span class="free">ğ”Š</span><span class="main">)</span> <span class="main">(</span>Suc <span class="free">i</span><span class="main">)</span> <span class="main">=</span> <span class="numeral">2</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> length_take<span class="main">)</span>
  <span class="keyword1"><span class="command">with</span></span> assms <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"Suc <span class="free">i</span> <span class="main">=</span> <span class="numeral">2</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">force</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"<span class="free">i</span> <span class="main">=</span> <span class="main">1</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">next</span></span>
  <span class="keyword3"><span class="command">assume</span></span> i<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="free">i</span> <span class="main">=</span> <span class="main">1</span>"</span></span>
  <span class="keyword1"><span class="command">with</span></span> assms <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="numeral">2</span> <span class="main">â‰¤</span> length <span class="free">ğ”Š</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">with</span></span> i <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"simple_group <span class="main">(</span><span class="free">G</span><span class="main">â¦‡</span>carrier <span class="main">:=</span> <span class="free">ğ”Š</span> <span class="main">!</span> <span class="free">i</span><span class="main">â¦ˆ</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> composition_series_snd_simple<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">â€¹The second to last entry of a normal series is not only a normal subgroup but
  actually even a \emph{maximal} normal subgroup.â€º</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> composition_series<span class="main">)</span> snd_to_last_max_normal<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> finite<span class="main">:</span><span class="quoted"><span class="quoted">"finite <span class="main">(</span>carrier <span class="free">G</span><span class="main">)</span>"</span></span>
  <span class="keyword2"><span class="keyword">assumes</span></span> length<span class="main">:</span><span class="quoted"><span class="quoted">"length <span class="free">ğ”Š</span> <span class="main">&gt;</span> <span class="main">1</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"max_normal_subgroup <span class="main">(</span><span class="free">ğ”Š</span> <span class="main">!</span> <span class="main">(</span>length <span class="free">ğ”Š</span> <span class="main">-</span> <span class="numeral">2</span><span class="main">)</span><span class="main">)</span> <span class="free">G</span>"</span></span>
<span class="keyword1"><span class="command">unfolding</span></span> max_normal_subgroup_def max_normal_subgroup_axioms_def
<span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">del</span><span class="main"><span class="main">:</span></span> equalityI<span class="main">)</span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="free">ğ”Š</span> <span class="main">!</span> <span class="main">(</span>length <span class="free">ğ”Š</span> <span class="main">-</span> <span class="numeral">2</span><span class="main">)</span> <span class="main">âŠ²</span> <span class="free">G</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> normal_series_snd_to_last<span class="main">)</span>
<span class="keyword1"><span class="command">next</span></span> 
  <span class="keyword3"><span class="command">define</span></span> <span class="skolem"><span class="skolem">G'</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">G'</span> <span class="main">=</span> <span class="free">ğ”Š</span> <span class="main">!</span> <span class="main">(</span>length <span class="free">ğ”Š</span> <span class="main">-</span> <span class="numeral">2</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">from</span></span> length <span class="keyword1"><span class="command">have</span></span> length21<span class="main">:</span><span class="quoted"><span class="quoted">"length <span class="free">ğ”Š</span> <span class="main">-</span> <span class="numeral">2</span> <span class="main">+</span> <span class="main">1</span> <span class="main">=</span> length <span class="free">ğ”Š</span> <span class="main">-</span> <span class="main">1</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">arith</span>
  <span class="keyword1"><span class="command">from</span></span> length <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"length <span class="free">ğ”Š</span> <span class="main">-</span> <span class="numeral">2</span> <span class="main">+</span> <span class="main">1</span> <span class="main">&lt;</span> length <span class="free">ğ”Š</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">arith</span>
  <span class="keyword1"><span class="command">with</span></span> simplefact <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"simple_group <span class="main">(</span><span class="free">G</span><span class="main">â¦‡</span>carrier <span class="main">:=</span> <span class="free">ğ”Š</span> <span class="main">!</span> <span class="main">(</span><span class="main">(</span>length <span class="free">ğ”Š</span> <span class="main">-</span> <span class="numeral">2</span><span class="main">)</span> <span class="main">+</span> <span class="main">1</span><span class="main">)</span><span class="main">â¦ˆ</span> <span class="keyword1">Mod</span> <span class="skolem">G'</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> G'_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">with</span></span> length21 <span class="keyword1"><span class="command">have</span></span> simple_last<span class="main">:</span><span class="quoted"><span class="quoted">"simple_group <span class="main">(</span><span class="free">G</span> <span class="keyword1">Mod</span> <span class="skolem">G'</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> last notempty last_conv_nth <span class="keyword1"><span class="command">by</span></span> <span class="operator">fastforce</span>
  <span class="keyword1"><span class="command">{</span></span>
    <span class="keyword3"><span class="command">assume</span></span> snd_to_last_eq<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">G'</span> <span class="main">=</span> carrier <span class="free">G</span>"</span></span>
    <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"carrier <span class="main">(</span><span class="free">G</span> <span class="keyword1">Mod</span> <span class="skolem">G'</span><span class="main">)</span> <span class="main">=</span> <span class="main">{</span><span class="main">ğŸ­</span><span class="hidden">â‡˜</span><sub><span class="free">G</span> <span class="keyword1">Mod</span> <span class="skolem">G'</span></sub><span class="hidden">â‡™</span><span class="main">}</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> normal_series_snd_to_last finite normal.fact_group_trivial_iff <span class="keyword1"><span class="command">unfolding</span></span> G'_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">metis</span>
    <span class="keyword1"><span class="command">with</span></span> snd_to_last_eq <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">Â¬</span> simple_group <span class="main">(</span><span class="free">G</span> <span class="keyword1">Mod</span> <span class="skolem">G'</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> self_factor_not_simple<span class="main">)</span>
    <span class="keyword1"><span class="command">with</span></span> simple_last <span class="keyword3"><span class="command">show</span></span> <span class="quoted">False</span> <span class="keyword1"><span class="command">unfolding</span></span> G'_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">}</span></span>
  <span class="keyword1"><span class="command">{</span></span>
    <span class="keyword1"><span class="command">have</span></span> G'G<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">G'</span> <span class="main">âŠ²</span> <span class="free">G</span>"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> G'_def <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> normal_series_snd_to_last<span class="main">)</span>
    <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">J</span>
    <span class="keyword3"><span class="command">assume</span></span> J<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">J</span> <span class="main">âŠ²</span> <span class="free">G</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">J</span> <span class="main">â‰ </span> <span class="skolem">G'</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">J</span> <span class="main">â‰ </span> carrier <span class="free">G</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">G'</span> <span class="main">âŠ†</span> <span class="skolem">J</span>"</span></span>
    <span class="keyword1"><span class="command">hence</span></span> JG'GG'<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="keyword1">rcosets</span><span class="hidden">â‡˜</span><sub><span class="main">(</span><span class="free">G</span><span class="main">â¦‡</span>carrier <span class="main">:=</span> <span class="skolem">J</span><span class="main">â¦ˆ</span><span class="main">)</span></sub><span class="hidden">â‡™</span> <span class="skolem">G'</span> <span class="main">âŠ²</span> <span class="free">G</span> <span class="keyword1">Mod</span> <span class="skolem">G'</span>"</span></span>  <span class="keyword1"><span class="command">using</span></span> normality_factorization normal_series_snd_to_last <span class="keyword1"><span class="command">unfolding</span></span> G'_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">from</span></span> G'G J<span class="main">(</span>1<span class="main">,</span>4<span class="main">)</span> <span class="keyword1"><span class="command">have</span></span> G'J<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">G'</span> <span class="main">âŠ²</span> <span class="main">(</span><span class="free">G</span><span class="main">â¦‡</span>carrier <span class="main">:=</span> <span class="skolem">J</span><span class="main">â¦ˆ</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> normal_imp_subgroup normal_restrict_supergroup<span class="main">)</span>
    <span class="keyword1"><span class="command">from</span></span> finite J<span class="main">(</span>1<span class="main">)</span> <span class="keyword1"><span class="command">have</span></span> finJ<span class="main">:</span><span class="quoted"><span class="quoted">"finite <span class="skolem">J</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> normal_imp_subgroup subgroup_finite<span class="main">)</span>
    <span class="keyword1"><span class="command">from</span></span> JG'GG' simple_last <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">rcosets</span><span class="hidden">â‡˜</span><sub><span class="free">G</span><span class="main">â¦‡</span>carrier <span class="main">:=</span> <span class="skolem">J</span><span class="main">â¦ˆ</span></sub><span class="hidden">â‡™</span> <span class="skolem">G'</span> <span class="main">=</span> <span class="main">{</span><span class="main">ğŸ­</span><span class="hidden">â‡˜</span><sub><span class="free">G</span> <span class="keyword1">Mod</span> <span class="skolem">G'</span></sub><span class="hidden">â‡™</span><span class="main">}</span> <span class="main">âˆ¨</span> <span class="keyword1">rcosets</span><span class="hidden">â‡˜</span><sub><span class="free">G</span><span class="main">â¦‡</span>carrier <span class="main">:=</span> <span class="skolem">J</span><span class="main">â¦ˆ</span></sub><span class="hidden">â‡™</span> <span class="skolem">G'</span> <span class="main">=</span> carrier <span class="main">(</span><span class="free">G</span> <span class="keyword1">Mod</span> <span class="skolem">G'</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">unfolding</span></span> simple_group_def simple_group_axioms_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword3"><span class="command">thus</span></span> <span class="quoted">False</span> 
    <span class="keyword1"><span class="command">proof</span></span>
      <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">rcosets</span><span class="hidden">â‡˜</span><sub><span class="free">G</span><span class="main">â¦‡</span>carrier <span class="main">:=</span> <span class="skolem">J</span><span class="main">â¦ˆ</span></sub><span class="hidden">â‡™</span> <span class="skolem">G'</span> <span class="main">=</span> <span class="main">{</span><span class="main">ğŸ­</span><span class="hidden">â‡˜</span><sub><span class="free">G</span> <span class="keyword1">Mod</span> <span class="skolem">G'</span></sub><span class="hidden">â‡™</span><span class="main">}</span>"</span></span>
      <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">rcosets</span><span class="hidden">â‡˜</span><sub><span class="free">G</span><span class="main">â¦‡</span>carrier <span class="main">:=</span> <span class="skolem">J</span><span class="main">â¦ˆ</span></sub><span class="hidden">â‡™</span> <span class="skolem">G'</span> <span class="main">=</span> <span class="main">{</span><span class="main">ğŸ­</span><span class="hidden">â‡˜</span><sub><span class="main">(</span><span class="free">G</span><span class="main">â¦‡</span>carrier <span class="main">:=</span> <span class="skolem">J</span><span class="main">â¦ˆ</span><span class="main">)</span> <span class="keyword1">Mod</span> <span class="skolem">G'</span></sub><span class="hidden">â‡™</span><span class="main">}</span>"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> FactGroup_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
      <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">G'</span> <span class="main">=</span> <span class="skolem">J</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> G'J finJ normal.fact_group_trivial_iff <span class="keyword1"><span class="command">unfolding</span></span> FactGroup_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">fastforce</span>
      <span class="keyword1"><span class="command">with</span></span> J<span class="main">(</span>2<span class="main">)</span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted">False</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">next</span></span>
      <span class="keyword3"><span class="command">assume</span></span> facts_eq<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="keyword1">rcosets</span><span class="hidden">â‡˜</span><sub><span class="free">G</span><span class="main">â¦‡</span>carrier <span class="main">:=</span> <span class="skolem">J</span><span class="main">â¦ˆ</span></sub><span class="hidden">â‡™</span> <span class="skolem">G'</span> <span class="main">=</span> carrier <span class="main">(</span><span class="free">G</span> <span class="keyword1">Mod</span> <span class="skolem">G'</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">J</span> <span class="main">=</span> carrier <span class="free">G</span>"</span></span>
      <span class="keyword1"><span class="command">proof</span></span>
        <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">J</span> <span class="main">âŠ†</span> carrier <span class="free">G</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> J<span class="main">(</span>1<span class="main">)</span> normal_imp_subgroup subgroup.subset <span class="keyword1"><span class="command">by</span></span> <span class="operator">force</span>
      <span class="keyword1"><span class="command">next</span></span>
        <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"carrier <span class="free">G</span> <span class="main">âŠ†</span> <span class="skolem">J</span>"</span></span>
        <span class="keyword1"><span class="command">proof</span></span>
          <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">x</span>
          <span class="keyword3"><span class="command">assume</span></span> x<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">âˆˆ</span> carrier <span class="free">G</span>"</span></span>
          <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">G'</span> <span class="main">#&gt;</span> <span class="skolem">x</span> <span class="main">âˆˆ</span> carrier <span class="main">(</span><span class="free">G</span> <span class="keyword1">Mod</span> <span class="skolem">G'</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> FactGroup_def RCOSETS_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
          <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">G'</span> <span class="main">#&gt;</span> <span class="skolem">x</span> <span class="main">âˆˆ</span> <span class="keyword1">rcosets</span><span class="hidden">â‡˜</span><sub><span class="free">G</span><span class="main">â¦‡</span>carrier <span class="main">:=</span> <span class="skolem">J</span><span class="main">â¦ˆ</span></sub><span class="hidden">â‡™</span> <span class="skolem">G'</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> facts_eq <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
          <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">j</span></span> <span class="keyword2"><span class="keyword">where</span></span> j<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">j</span> <span class="main">âˆˆ</span> <span class="skolem">J</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">G'</span> <span class="main">#&gt;</span> <span class="skolem">x</span> <span class="main">=</span> <span class="skolem">G'</span> <span class="main">#&gt;</span> <span class="skolem">j</span>"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> RCOSETS_def r_coset_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">force</span>
          <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">âˆˆ</span> <span class="skolem">G'</span> <span class="main">#&gt;</span> <span class="skolem">j</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> G'G normal_imp_subgroup x repr_independenceD <span class="keyword1"><span class="command">by</span></span> <span class="operator">fastforce</span>
          <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">g'</span></span> <span class="keyword2"><span class="keyword">where</span></span> g'<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">g'</span> <span class="main">âˆˆ</span> <span class="skolem">G'</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">=</span> <span class="skolem">g'</span> <span class="main">âŠ—</span> <span class="skolem">j</span>"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> r_coset_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
          <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">g'</span> <span class="main">âˆˆ</span> <span class="skolem">J</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> G'J normal_imp_subgroup subgroup.subset <span class="keyword1"><span class="command">by</span></span> <span class="operator">force</span>
          <span class="keyword1"><span class="command">with</span></span> g'<span class="main">(</span>2<span class="main">)</span> j<span class="main">(</span>1<span class="main">)</span> <span class="keyword3"><span class="command">show</span></span>  <span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">âˆˆ</span> <span class="skolem">J</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> J<span class="main">(</span>1<span class="main">)</span> normal_imp_subgroup subgroup.m_closed <span class="keyword1"><span class="command">by</span></span> <span class="operator">fastforce</span>
        <span class="keyword1"><span class="command">qed</span></span>
      <span class="keyword1"><span class="command">qed</span></span>
      <span class="keyword1"><span class="command">with</span></span> J<span class="main">(</span>3<span class="main">)</span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted">False</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">}</span></span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">â€¹For the next lemma we need a few facts about removing adjacent duplicates.â€º</span></span>

<span class="keyword1" id="CompositionSeries-remdups_adj_obtain_adjacency"><span class="command">lemma</span></span> remdups_adj_obtain_adjacency<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">i</span> <span class="main">+</span> <span class="main">1</span> <span class="main">&lt;</span> length <span class="main">(</span>remdups_adj <span class="free">xs</span><span class="main">)</span>"</span></span> <span class="quoted"><span class="quoted">"length <span class="free">xs</span> <span class="main">&gt;</span> <span class="main">0</span>"</span></span>
  <span class="keyword2"><span class="keyword">obtains</span></span> <span class="free">j</span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="free">j</span> <span class="main">+</span> <span class="main">1</span> <span class="main">&lt;</span> length <span class="free">xs</span>"</span></span>
    <span class="quoted"><span class="quoted">"<span class="main">(</span>remdups_adj <span class="free">xs</span><span class="main">)</span> <span class="main">!</span> <span class="free">i</span> <span class="main">=</span> <span class="free">xs</span> <span class="main">!</span> <span class="free">j</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span>remdups_adj <span class="free">xs</span><span class="main">)</span> <span class="main">!</span> <span class="main">(</span><span class="free">i</span> <span class="main">+</span> <span class="main">1</span><span class="main">)</span> <span class="main">=</span> <span class="free">xs</span> <span class="main">!</span> <span class="main">(</span><span class="free">j</span> <span class="main">+</span> <span class="main">1</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">induction</span> <span class="quoted"><span class="free">xs</span></span> <span class="quasi_keyword">arbitrary</span><span class="main"><span class="main">:</span></span> <span class="quoted"><span class="free">i</span></span> <span class="quoted"><span class="free">thesis</span></span><span class="main">)</span>
  <span class="keyword3"><span class="command">case</span></span> Nil
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted">False</span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> length_greater_0_conv<span class="main">)</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="skolem">thesis</span></span><span class="keyword1"><span class="command">..</span></span>
<span class="keyword1"><span class="command">next</span></span>
  <span class="keyword3"><span class="command">case</span></span> <span class="main">(</span>Cons <span class="skolem">x</span> <span class="skolem">xs</span><span class="main">)</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">xs</span> <span class="main">â‰ </span> <span class="main">[]</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">y</span></span> <span class="skolem"><span class="skolem">xs'</span></span> <span class="keyword2"><span class="keyword">where</span></span> xs<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">xs</span> <span class="main">=</span> <span class="skolem">y</span> <span class="main">#</span> <span class="skolem">xs'</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">cases</span> <span class="quoted"><span class="skolem">xs</span></span><span class="main">)</span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">â€¹<span class="skolem">xs</span> <span class="main">â‰ </span> <span class="main">[]</span>â€º</span></span> <span class="keyword1"><span class="command">have</span></span> lenxs<span class="main">:</span><span class="quoted"><span class="quoted">"length <span class="skolem">xs</span> <span class="main">&gt;</span> <span class="main">0</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">from</span></span> xs <span class="keyword1"><span class="command">have</span></span> rem<span class="main">:</span><span class="quoted"><span class="quoted">"remdups_adj <span class="main">(</span><span class="skolem">x</span> <span class="main">#</span> <span class="skolem">xs</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="keyword1">if</span> <span class="skolem">x</span> <span class="main">=</span> <span class="skolem">y</span> <span class="keyword1">then</span> remdups_adj <span class="main">(</span><span class="skolem">y</span> <span class="main">#</span> <span class="skolem">xs'</span><span class="main">)</span> <span class="keyword1">else</span> <span class="skolem">x</span> <span class="main">#</span> remdups_adj <span class="main">(</span><span class="skolem">y</span> <span class="main">#</span> <span class="skolem">xs'</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> remdups_adj.simps<span class="main">(</span>3<span class="main">)</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="skolem">thesis</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">cases</span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">=</span> <span class="skolem">y</span>"</span></span><span class="main">)</span>
    <span class="keyword3"><span class="command">case</span></span> True
    <span class="keyword1"><span class="command">with</span></span> rem xs <span class="keyword1"><span class="command">have</span></span> rem2<span class="main">:</span><span class="quoted"><span class="quoted">"remdups_adj <span class="main">(</span><span class="skolem">x</span> <span class="main">#</span> <span class="skolem">xs</span><span class="main">)</span> <span class="main">=</span> remdups_adj <span class="skolem">xs</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">with</span></span> Cons<span class="main">(</span>3<span class="main">)</span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">i</span> <span class="main">+</span> <span class="main">1</span> <span class="main">&lt;</span> length <span class="main">(</span>remdups_adj <span class="skolem">xs</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">with</span></span> Cons.IH lenxs <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">k</span></span> <span class="keyword2"><span class="keyword">where</span></span> j<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">k</span> <span class="main">+</span> <span class="main">1</span> <span class="main">&lt;</span> length <span class="skolem">xs</span>"</span></span> <span class="quoted"><span class="quoted">"remdups_adj <span class="skolem">xs</span> <span class="main">!</span> <span class="skolem">i</span> <span class="main">=</span> <span class="skolem">xs</span> <span class="main">!</span> <span class="skolem">k</span>"</span></span>
        <span class="quoted"><span class="quoted">"remdups_adj <span class="skolem">xs</span> <span class="main">!</span> <span class="main">(</span><span class="skolem">i</span> <span class="main">+</span> <span class="main">1</span><span class="main">)</span> <span class="main">=</span> <span class="skolem">xs</span> <span class="main">!</span> <span class="main">(</span><span class="skolem">k</span> <span class="main">+</span> <span class="main">1</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="skolem">thesis</span></span> <span class="keyword1"><span class="command">using</span></span> Cons<span class="main">(</span>2<span class="main">)</span> rem2 <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">next</span></span>
    <span class="keyword3"><span class="command">case</span></span> False
    <span class="keyword1"><span class="command">with</span></span> rem xs <span class="keyword1"><span class="command">have</span></span> rem2<span class="main">:</span><span class="quoted"><span class="quoted">"remdups_adj <span class="main">(</span><span class="skolem">x</span> <span class="main">#</span> <span class="skolem">xs</span><span class="main">)</span> <span class="main">=</span> <span class="skolem">x</span> <span class="main">#</span> remdups_adj <span class="skolem">xs</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="skolem">thesis</span></span>
    <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">cases</span> <span class="quoted"><span class="skolem">i</span></span><span class="main">)</span>
      <span class="keyword3"><span class="command">case</span></span> 0
      <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">0</span> <span class="main">+</span> <span class="main">1</span> <span class="main">&lt;</span> length <span class="main">(</span><span class="skolem">x</span> <span class="main">#</span> <span class="skolem">xs</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> lenxs <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"remdups_adj <span class="main">(</span><span class="skolem">x</span> <span class="main">#</span> <span class="skolem">xs</span><span class="main">)</span> <span class="main">!</span> <span class="skolem">i</span> <span class="main">=</span> <span class="main">(</span><span class="skolem">x</span> <span class="main">#</span> <span class="skolem">xs</span><span class="main">)</span> <span class="main">!</span> <span class="main">0</span>"</span></span>
      <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
        <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"remdups_adj <span class="main">(</span><span class="skolem">x</span> <span class="main">#</span> <span class="skolem">xs</span><span class="main">)</span> <span class="main">!</span> <span class="skolem">i</span> <span class="main">=</span> <span class="main">(</span><span class="skolem">x</span> <span class="main">#</span> remdups_adj <span class="main">(</span><span class="skolem">y</span> <span class="main">#</span> <span class="skolem">xs'</span><span class="main">)</span><span class="main">)</span> <span class="main">!</span> <span class="main">0</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> xs rem2 0 <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
        <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">â€¦</span> <span class="main">=</span> <span class="skolem">x</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
        <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">â€¦</span> <span class="main">=</span> <span class="main">(</span><span class="skolem">x</span> <span class="main">#</span> <span class="skolem">xs</span><span class="main">)</span> <span class="main">!</span> <span class="main">0</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
        <span class="keyword1"><span class="command">finally</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span><span class="keyword1"><span class="command">.</span></span>
      <span class="keyword1"><span class="command">qed</span></span>
      <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"remdups_adj <span class="main">(</span><span class="skolem">x</span> <span class="main">#</span> <span class="skolem">xs</span><span class="main">)</span> <span class="main">!</span> <span class="main">(</span><span class="skolem">i</span> <span class="main">+</span> <span class="main">1</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="skolem">x</span> <span class="main">#</span> <span class="skolem">xs</span><span class="main">)</span> <span class="main">!</span> <span class="main">(</span><span class="main">0</span> <span class="main">+</span> <span class="main">1</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
        <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"remdups_adj <span class="main">(</span><span class="skolem">x</span> <span class="main">#</span> <span class="skolem">xs</span><span class="main">)</span> <span class="main">!</span> <span class="main">(</span><span class="skolem">i</span> <span class="main">+</span> <span class="main">1</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="skolem">x</span> <span class="main">#</span> remdups_adj <span class="main">(</span><span class="skolem">y</span> <span class="main">#</span> <span class="skolem">xs'</span><span class="main">)</span><span class="main">)</span> <span class="main">!</span> <span class="main">1</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> xs rem2 0 <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
        <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">â€¦</span> <span class="main">=</span> remdups_adj <span class="main">(</span><span class="skolem">y</span> <span class="main">#</span> <span class="skolem">xs'</span><span class="main">)</span> <span class="main">!</span> <span class="main">0</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
        <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">â€¦</span> <span class="main">=</span> <span class="main">(</span><span class="skolem">y</span> <span class="main">#</span> <span class="main">(</span>remdups <span class="main">(</span><span class="skolem">y</span> <span class="main">#</span> <span class="skolem">xs'</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">!</span> <span class="main">0</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> nth_Cons' remdups_adj_Cons_alt<span class="main">)</span>
        <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">â€¦</span> <span class="main">=</span> <span class="skolem">y</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
        <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">â€¦</span> <span class="main">=</span> <span class="main">(</span><span class="skolem">x</span> <span class="main">#</span> <span class="skolem">xs</span><span class="main">)</span> <span class="main">!</span> <span class="main">(</span><span class="main">0</span> <span class="main">+</span> <span class="main">1</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> xs <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
        <span class="keyword1"><span class="command">finally</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span><span class="keyword1"><span class="command">.</span></span>
      <span class="keyword1"><span class="command">qed</span></span>
      <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="skolem">thesis</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> Cons.prems<span class="main"><span class="main">(</span></span>1<span class="main"><span class="main">)</span></span><span class="main">)</span>
    <span class="keyword1"><span class="command">next</span></span>
      <span class="keyword3"><span class="command">case</span></span> <span class="main">(</span>Suc <span class="skolem">k</span><span class="main">)</span>
      <span class="keyword1"><span class="command">with</span></span> Cons<span class="main">(</span>3<span class="main">)</span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">k</span> <span class="main">+</span> <span class="main">1</span> <span class="main">&lt;</span> length <span class="main">(</span>remdups_adj <span class="main">(</span><span class="skolem">x</span> <span class="main">#</span> <span class="skolem">xs</span><span class="main">)</span><span class="main">)</span> <span class="main">-</span> <span class="main">1</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">â€¦</span> <span class="main">â‰¤</span> length <span class="main">(</span>remdups_adj <span class="skolem">xs</span><span class="main">)</span> <span class="main">+</span> <span class="main">1</span> <span class="main">-</span> <span class="main">1</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> One_nat_def le_refl list.size<span class="main"><span class="main">(</span></span>4<span class="main"><span class="main">)</span></span> rem2<span class="main">)</span>
      <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">â€¦</span> <span class="main">=</span> length <span class="main">(</span>remdups_adj <span class="skolem">xs</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
      <span class="keyword1"><span class="command">finally</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">k</span> <span class="main">+</span> <span class="main">1</span> <span class="main">&lt;</span> length <span class="main">(</span>remdups_adj <span class="skolem">xs</span><span class="main">)</span>"</span></span><span class="keyword1"><span class="command">.</span></span>
      <span class="keyword1"><span class="command">with</span></span> Cons.IH lenxs <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">j</span></span> <span class="keyword2"><span class="keyword">where</span></span> j<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">j</span> <span class="main">+</span> <span class="main">1</span> <span class="main">&lt;</span> length <span class="skolem">xs</span>"</span></span> <span class="quoted"><span class="quoted">"remdups_adj <span class="skolem">xs</span> <span class="main">!</span> <span class="skolem">k</span> <span class="main">=</span> <span class="skolem">xs</span> <span class="main">!</span> <span class="skolem">j</span>"</span></span>
        <span class="quoted"><span class="quoted">"remdups_adj <span class="skolem">xs</span> <span class="main">!</span> <span class="main">(</span><span class="skolem">k</span> <span class="main">+</span> <span class="main">1</span><span class="main">)</span> <span class="main">=</span> <span class="skolem">xs</span> <span class="main">!</span> <span class="main">(</span><span class="skolem">j</span> <span class="main">+</span> <span class="main">1</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">from</span></span> j<span class="main">(</span>1<span class="main">)</span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"Suc <span class="skolem">j</span> <span class="main">+</span> <span class="main">1</span> <span class="main">&lt;</span> length <span class="main">(</span><span class="skolem">x</span> <span class="main">#</span> <span class="skolem">xs</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
      <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"remdups_adj <span class="main">(</span><span class="skolem">x</span> <span class="main">#</span> <span class="skolem">xs</span><span class="main">)</span> <span class="main">!</span> <span class="skolem">i</span> <span class="main">=</span> <span class="main">(</span><span class="skolem">x</span> <span class="main">#</span> <span class="skolem">xs</span><span class="main">)</span> <span class="main">!</span> <span class="main">(</span>Suc <span class="skolem">j</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
        <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"remdups_adj <span class="main">(</span><span class="skolem">x</span> <span class="main">#</span> <span class="skolem">xs</span><span class="main">)</span> <span class="main">!</span> <span class="skolem">i</span> <span class="main">=</span> <span class="main">(</span><span class="skolem">x</span> <span class="main">#</span> remdups_adj <span class="skolem">xs</span><span class="main">)</span> <span class="main">!</span> <span class="skolem">i</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> rem2 <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
        <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">â€¦</span> <span class="main">=</span> <span class="main">(</span>remdups_adj <span class="skolem">xs</span><span class="main">)</span> <span class="main">!</span> <span class="skolem">k</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> Suc <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
        <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">â€¦</span> <span class="main">=</span> <span class="skolem">xs</span> <span class="main">!</span> <span class="skolem">j</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> j<span class="main">(</span>2<span class="main">)</span> <span class="keyword1"><span class="command">.</span></span>
        <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">â€¦</span> <span class="main">=</span> <span class="main">(</span><span class="skolem">x</span> <span class="main">#</span> <span class="skolem">xs</span><span class="main">)</span> <span class="main">!</span> <span class="main">(</span>Suc <span class="skolem">j</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
        <span class="keyword1"><span class="command">finally</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">.</span></span>
      <span class="keyword1"><span class="command">qed</span></span>
      <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"remdups_adj <span class="main">(</span><span class="skolem">x</span> <span class="main">#</span> <span class="skolem">xs</span><span class="main">)</span> <span class="main">!</span> <span class="main">(</span><span class="skolem">i</span> <span class="main">+</span> <span class="main">1</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="skolem">x</span> <span class="main">#</span> <span class="skolem">xs</span><span class="main">)</span> <span class="main">!</span> <span class="main">(</span>Suc <span class="skolem">j</span> <span class="main">+</span> <span class="main">1</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
        <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"remdups_adj <span class="main">(</span><span class="skolem">x</span> <span class="main">#</span> <span class="skolem">xs</span><span class="main">)</span> <span class="main">!</span> <span class="main">(</span><span class="skolem">i</span> <span class="main">+</span> <span class="main">1</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="skolem">x</span> <span class="main">#</span> remdups_adj <span class="skolem">xs</span><span class="main">)</span> <span class="main">!</span> <span class="main">(</span><span class="skolem">i</span> <span class="main">+</span> <span class="main">1</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> rem2 <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
        <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">â€¦</span> <span class="main">=</span> <span class="main">(</span>remdups_adj <span class="skolem">xs</span><span class="main">)</span> <span class="main">!</span> <span class="main">(</span><span class="skolem">k</span> <span class="main">+</span> <span class="main">1</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> Suc <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
        <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">â€¦</span> <span class="main">=</span> <span class="skolem">xs</span> <span class="main">!</span> <span class="main">(</span><span class="skolem">j</span> <span class="main">+</span> <span class="main">1</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> j<span class="main">(</span>3<span class="main">)</span><span class="keyword1"><span class="command">.</span></span>
        <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">â€¦</span> <span class="main">=</span> <span class="main">(</span><span class="skolem">x</span> <span class="main">#</span> <span class="skolem">xs</span><span class="main">)</span> <span class="main">!</span> <span class="main">(</span>Suc <span class="skolem">j</span> <span class="main">+</span> <span class="main">1</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
        <span class="keyword1"><span class="command">finally</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span><span class="keyword1"><span class="command">.</span></span>
      <span class="keyword1"><span class="command">qed</span></span>
      <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="skolem">thesis</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> Cons.prems<span class="main"><span class="main">(</span></span>1<span class="main"><span class="main">)</span></span><span class="main">)</span>
    <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">qed</span></span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="CompositionSeries-hd_remdups_adj"><span class="command">lemma</span></span> hd_remdups_adj<span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"hd <span class="main">(</span>remdups_adj <span class="free">xs</span><span class="main">)</span> <span class="main">=</span> hd <span class="free">xs</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">induction</span> <span class="quoted"><span class="free">xs</span></span> <span class="quasi_keyword">rule</span><span class="main"><span class="main">:</span></span> remdups_adj.induct<span class="main">)</span> <span class="operator">simp_all</span>

<span class="keyword1" id="CompositionSeries-remdups_adj_adjacent"><span class="command">lemma</span></span> remdups_adj_adjacent<span class="main">:</span>
  <span class="quoted"><span class="quoted">"Suc <span class="free">i</span> <span class="main">&lt;</span> length <span class="main">(</span>remdups_adj <span class="free">xs</span><span class="main">)</span> <span class="main">âŸ¹</span> remdups_adj <span class="free">xs</span> <span class="main">!</span> <span class="free">i</span> <span class="main">â‰ </span> remdups_adj <span class="free">xs</span> <span class="main">!</span> Suc <span class="free">i</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">induction</span> <span class="quoted"><span class="free">xs</span></span> <span class="quasi_keyword">arbitrary</span><span class="main"><span class="main">:</span></span> <span class="quoted"><span class="free">i</span></span> <span class="quasi_keyword">rule</span><span class="main"><span class="main">:</span></span> remdups_adj.induct<span class="main">)</span>
  <span class="keyword3"><span class="command">case</span></span> <span class="main">(</span>3 <span class="skolem">x</span> <span class="skolem">y</span> <span class="skolem">xs</span> <span class="skolem">i</span><span class="main">)</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?case</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">cases</span> <span class="quoted"><span class="skolem">i</span></span><span class="main"><span class="keyword3">,</span></span> <span class="operator">cases</span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">=</span> <span class="skolem">y</span>"</span></span><span class="main">)</span> <span class="main">(</span><span class="operator">simp</span><span class="main"><span class="keyword3">,</span></span> <span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> hd_conv_nth<span class="main"><span class="main">[</span></span><span class="operator">symmetric</span><span class="main"><span class="main">]</span></span><span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span> <span class="operator">simp_all</span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">â€¹Intersecting each entry of a composition series with a normal subgroup of $G$ and removing
  all adjacent duplicates yields another composition series.â€º</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> composition_series<span class="main">)</span> intersect_normal<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> finite<span class="main">:</span><span class="quoted"><span class="quoted">"finite <span class="main">(</span>carrier <span class="free">G</span><span class="main">)</span>"</span></span>
  <span class="keyword2"><span class="keyword">assumes</span></span> KG<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="free">K</span> <span class="main">âŠ²</span> <span class="free">G</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"composition_series <span class="main">(</span><span class="free">G</span><span class="main">â¦‡</span>carrier <span class="main">:=</span> <span class="free">K</span><span class="main">â¦ˆ</span><span class="main">)</span> <span class="main">(</span>remdups_adj <span class="main">(</span>map <span class="main">(</span><span class="main">Î»</span><span class="bound">H</span><span class="main">.</span> <span class="free">K</span> <span class="main">âˆ©</span> <span class="bound">H</span><span class="main">)</span> <span class="free">ğ”Š</span><span class="main">)</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">unfolding</span></span> composition_series_def composition_series_axioms_def normal_series_def normal_series_axioms_def
<span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">only</span><span class="main"><span class="main">:</span></span> conjI <span class="quasi_keyword">del</span><span class="main"><span class="main">:</span></span> equalityI<span class="main">)</span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"group <span class="main">(</span><span class="free">G</span><span class="main">â¦‡</span>carrier <span class="main">:=</span> <span class="free">K</span><span class="main">â¦ˆ</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> KG normal_imp_subgroup subgroup_imp_group <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">next</span></span>
  <span class="comment1">â€• â€¹Show, that removing adjacent duplicates doesn't result in an empty list.â€º</span>
  <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"remdups_adj <span class="main">(</span>map <span class="main">(</span><span class="main">(âˆ©)</span> <span class="free">K</span><span class="main">)</span> <span class="free">ğ”Š</span><span class="main">)</span> <span class="main">=</span> <span class="main">[]</span>"</span></span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"map <span class="main">(</span><span class="main">(âˆ©)</span> <span class="free">K</span><span class="main">)</span> <span class="free">ğ”Š</span> <span class="main">=</span> <span class="main">[]</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> remdups_adj_Nil_iff<span class="main">)</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="free">ğ”Š</span> <span class="main">=</span> <span class="main">[]</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> Nil_is_map_conv<span class="main">)</span>
  <span class="keyword1"><span class="command">with</span></span> notempty <span class="keyword3"><span class="command">show</span></span> <span class="quoted">False</span><span class="keyword1"><span class="command">..</span></span>
<span class="keyword1"><span class="command">next</span></span>
  <span class="comment1">â€• â€¹Show, that the head of the reduced list is still the trivial groupâ€º</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">ğ”Š</span> <span class="main">=</span> <span class="main">{</span><span class="main">ğŸ­</span><span class="main">}</span> <span class="main">#</span> tl <span class="free">ğ”Š</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> notempty hd <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> list.sel<span class="main"><span class="main">(</span></span>1<span class="main"><span class="main">,</span></span>3<span class="main"><span class="main">)</span></span> neq_Nil_conv<span class="main">)</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"map <span class="main">(</span><span class="main">(âˆ©)</span> <span class="free">K</span><span class="main">)</span> <span class="free">ğ”Š</span> <span class="main">=</span> map <span class="main">(</span><span class="main">(âˆ©)</span> <span class="free">K</span><span class="main">)</span> <span class="main">(</span><span class="main">{</span><span class="main">ğŸ­</span><span class="main">}</span> <span class="main">#</span> tl <span class="free">ğ”Š</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"remdups_adj <span class="main">(</span>map <span class="main">(</span><span class="main">(âˆ©)</span> <span class="free">K</span><span class="main">)</span> <span class="free">ğ”Š</span><span class="main">)</span> <span class="main">=</span> remdups_adj <span class="main">(</span><span class="main">(</span><span class="free">K</span> <span class="main">âˆ©</span> <span class="main">{</span><span class="main">ğŸ­</span><span class="main">}</span><span class="main">)</span> <span class="main">#</span> <span class="main">(</span>map <span class="main">(</span><span class="main">(âˆ©)</span> <span class="free">K</span><span class="main">)</span> <span class="main">(</span>tl <span class="free">ğ”Š</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">â€¦</span> <span class="main">=</span> <span class="main">(</span><span class="free">K</span> <span class="main">âˆ©</span> <span class="main">{</span><span class="main">ğŸ­</span><span class="main">}</span><span class="main">)</span> <span class="main">#</span> tl <span class="main">(</span>remdups_adj <span class="main">(</span><span class="main">(</span><span class="free">K</span> <span class="main">âˆ©</span> <span class="main">{</span><span class="main">ğŸ­</span><span class="main">}</span><span class="main">)</span> <span class="main">#</span> <span class="main">(</span>map <span class="main">(</span><span class="main">(âˆ©)</span> <span class="free">K</span><span class="main">)</span> <span class="main">(</span>tl <span class="free">ğ”Š</span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">finally</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"hd <span class="main">(</span>remdups_adj <span class="main">(</span>map <span class="main">(</span><span class="main">(âˆ©)</span> <span class="free">K</span><span class="main">)</span> <span class="free">ğ”Š</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> <span class="free">K</span> <span class="main">âˆ©</span> <span class="main">{</span><span class="main">ğŸ­</span><span class="main">}</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> list.sel<span class="main">(</span>1<span class="main">)</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">metis</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"hd <span class="main">(</span>remdups_adj <span class="main">(</span>map <span class="main">(</span><span class="main">(âˆ©)</span> <span class="free">K</span><span class="main">)</span> <span class="free">ğ”Š</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> <span class="main">{</span><span class="main">ğŸ­</span><span class="hidden">â‡˜</span><sub><span class="free">G</span><span class="main">â¦‡</span>carrier <span class="main">:=</span> <span class="free">K</span><span class="main">â¦ˆ</span></sub><span class="hidden">â‡™</span><span class="main">}</span>"</span></span> 
    <span class="keyword1"><span class="command">using</span></span> KG normal_imp_subgroup subgroup.one_closed <span class="keyword1"><span class="command">by</span></span> <span class="operator">force</span>
<span class="keyword1"><span class="command">next</span></span>
  <span class="comment1">â€• â€¹Show that the last entry is really <span class="antiquoted"><span class="antiquote">@{</span><span class="operator">text</span> <span class="raw_text">"K âˆ© G"</span><span class="antiquote">}</span></span>. Since we don't have a lemma ready to talk about the
    last entry of a reduced list, we reverse the list twice.â€º</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"rev <span class="free">ğ”Š</span> <span class="main">=</span> <span class="main">(</span>carrier <span class="free">G</span><span class="main">)</span> <span class="main">#</span> tl <span class="main">(</span>rev <span class="free">ğ”Š</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> list.sel<span class="main"><span class="main">(</span></span>1<span class="main"><span class="main">,</span></span>3<span class="main"><span class="main">)</span></span> last last_rev neq_Nil_conv notempty rev_is_Nil_conv rev_rev_ident<span class="main">)</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"rev <span class="main">(</span>map <span class="main">(</span><span class="main">(âˆ©)</span> <span class="free">K</span><span class="main">)</span> <span class="free">ğ”Š</span><span class="main">)</span> <span class="main">=</span> map <span class="main">(</span><span class="main">(âˆ©)</span> <span class="free">K</span><span class="main">)</span> <span class="main">(</span><span class="main">(</span>carrier <span class="free">G</span><span class="main">)</span> <span class="main">#</span> tl <span class="main">(</span>rev <span class="free">ğ”Š</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> rev_map<span class="main">)</span>
  <span class="keyword1"><span class="command">hence</span></span> rev<span class="main">:</span><span class="quoted"><span class="quoted">"rev <span class="main">(</span>map <span class="main">(</span><span class="main">(âˆ©)</span> <span class="free">K</span><span class="main">)</span> <span class="free">ğ”Š</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="free">K</span> <span class="main">âˆ©</span> <span class="main">(</span>carrier <span class="free">G</span><span class="main">)</span><span class="main">)</span> <span class="main">#</span> <span class="main">(</span>map <span class="main">(</span><span class="main">(âˆ©)</span> <span class="free">K</span><span class="main">)</span> <span class="main">(</span>tl <span class="main">(</span>rev <span class="free">ğ”Š</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"last <span class="main">(</span>remdups_adj <span class="main">(</span>map <span class="main">(</span><span class="main">(âˆ©)</span> <span class="free">K</span><span class="main">)</span> <span class="free">ğ”Š</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> hd <span class="main">(</span>rev <span class="main">(</span>remdups_adj <span class="main">(</span>map <span class="main">(</span><span class="main">(âˆ©)</span> <span class="free">K</span><span class="main">)</span> <span class="free">ğ”Š</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> hd_rev map_is_Nil_conv notempty remdups_adj_Nil_iff<span class="main">)</span>
  <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">â€¦</span> <span class="main">=</span> hd <span class="main">(</span>remdups_adj <span class="main">(</span>rev <span class="main">(</span>map <span class="main">(</span><span class="main">(âˆ©)</span> <span class="free">K</span><span class="main">)</span> <span class="free">ğ”Š</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> remdups_adj_rev<span class="main">)</span>
  <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">â€¦</span> <span class="main">=</span> hd <span class="main">(</span>remdups_adj <span class="main">(</span><span class="main">(</span><span class="free">K</span> <span class="main">âˆ©</span> <span class="main">(</span>carrier <span class="free">G</span><span class="main">)</span><span class="main">)</span> <span class="main">#</span> <span class="main">(</span>map <span class="main">(</span><span class="main">(âˆ©)</span> <span class="free">K</span><span class="main">)</span> <span class="main">(</span>tl <span class="main">(</span>rev <span class="free">ğ”Š</span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> rev<span class="main">)</span>
  <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">â€¦</span> <span class="main">=</span> hd <span class="main">(</span><span class="main">(</span><span class="free">K</span> <span class="main">âˆ©</span> <span class="main">(</span>carrier <span class="free">G</span><span class="main">)</span><span class="main">)</span> <span class="main">#</span> <span class="main">(</span>remdups_adj <span class="main">(</span><span class="main">(</span><span class="free">K</span> <span class="main">âˆ©</span> <span class="main">(</span>carrier <span class="free">G</span><span class="main">)</span><span class="main">)</span> <span class="main">#</span> <span class="main">(</span>map <span class="main">(</span><span class="main">(âˆ©)</span> <span class="free">K</span><span class="main">)</span> <span class="main">(</span>tl <span class="main">(</span>rev <span class="free">ğ”Š</span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> list.sel<span class="main"><span class="main">(</span></span>1<span class="main"><span class="main">)</span></span> remdups_adj_Cons_alt<span class="main">)</span>
  <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">â€¦</span> <span class="main">=</span> <span class="free">K</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> KG normal_imp_subgroup subgroup.subset <span class="keyword1"><span class="command">by</span></span> <span class="operator">force</span>
  <span class="keyword1"><span class="command">finally</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"last <span class="main">(</span>remdups_adj <span class="main">(</span>map <span class="main">(</span><span class="main">(âˆ©)</span> <span class="free">K</span><span class="main">)</span> <span class="free">ğ”Š</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> carrier <span class="main">(</span><span class="free">G</span><span class="main">â¦‡</span>carrier <span class="main">:=</span> <span class="free">K</span><span class="main">â¦ˆ</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">next</span></span>
  <span class="comment1">â€• â€¹The induction step, using the second isomorphism theorem for groups.â€º</span>
  <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">j</span>
  <span class="keyword3"><span class="command">assume</span></span> j<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">j</span> <span class="main">+</span> <span class="main">1</span> <span class="main">&lt;</span> length <span class="main">(</span>remdups_adj <span class="main">(</span>map <span class="main">(</span><span class="main">(âˆ©)</span> <span class="free">K</span><span class="main">)</span> <span class="free">ğ”Š</span><span class="main">)</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">have</span></span> KGnotempty<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="main">(</span>map <span class="main">(</span><span class="main">(âˆ©)</span> <span class="free">K</span><span class="main">)</span> <span class="free">ğ”Š</span><span class="main">)</span> <span class="main">â‰ </span> <span class="main">[]</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> notempty <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> Nil_is_map_conv<span class="main">)</span>
  <span class="keyword1"><span class="command">with</span></span> j <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">i</span></span> <span class="keyword2"><span class="keyword">where</span></span> i<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">i</span> <span class="main">+</span> <span class="main">1</span> <span class="main">&lt;</span> length <span class="main">(</span>map <span class="main">(</span><span class="main">(âˆ©)</span> <span class="free">K</span><span class="main">)</span> <span class="free">ğ”Š</span><span class="main">)</span>"</span></span>
    <span class="quoted"><span class="quoted">"<span class="main">(</span>remdups_adj <span class="main">(</span>map <span class="main">(</span><span class="main">(âˆ©)</span> <span class="free">K</span><span class="main">)</span> <span class="free">ğ”Š</span><span class="main">)</span><span class="main">)</span> <span class="main">!</span> <span class="skolem">j</span> <span class="main">=</span> <span class="main">(</span>map <span class="main">(</span><span class="main">(âˆ©)</span> <span class="free">K</span><span class="main">)</span> <span class="free">ğ”Š</span><span class="main">)</span> <span class="main">!</span> <span class="skolem">i</span>"</span></span>
    <span class="quoted"><span class="quoted">"<span class="main">(</span>remdups_adj <span class="main">(</span>map <span class="main">(</span><span class="main">(âˆ©)</span> <span class="free">K</span><span class="main">)</span> <span class="free">ğ”Š</span><span class="main">)</span><span class="main">)</span> <span class="main">!</span> <span class="main">(</span><span class="skolem">j</span> <span class="main">+</span> <span class="main">1</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span>map <span class="main">(</span><span class="main">(âˆ©)</span> <span class="free">K</span><span class="main">)</span> <span class="free">ğ”Š</span><span class="main">)</span> <span class="main">!</span> <span class="main">(</span><span class="skolem">i</span> <span class="main">+</span> <span class="main">1</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> remdups_adj_obtain_adjacency <span class="keyword1"><span class="command">by</span></span> <span class="operator">force</span>
  <span class="keyword1"><span class="command">from</span></span> i<span class="main">(</span>1<span class="main">)</span> <span class="keyword1"><span class="command">have</span></span> i'<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">i</span> <span class="main">+</span> <span class="main">1</span> <span class="main">&lt;</span> length <span class="free">ğ”Š</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> length_map<span class="main">)</span>
  <span class="keyword1"><span class="command">hence</span></span> GiSi<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="free">ğ”Š</span> <span class="main">!</span> <span class="skolem">i</span> <span class="main">âŠ²</span> <span class="free">G</span><span class="main">â¦‡</span>carrier <span class="main">:=</span> <span class="free">ğ”Š</span> <span class="main">!</span> <span class="main">(</span><span class="skolem">i</span> <span class="main">+</span> <span class="main">1</span><span class="main">)</span><span class="main">â¦ˆ</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> normal<span class="main">)</span>
  <span class="keyword1"><span class="command">hence</span></span> GiSi'<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="free">ğ”Š</span> <span class="main">!</span> <span class="skolem">i</span> <span class="main">âŠ†</span> <span class="free">ğ”Š</span> <span class="main">!</span> <span class="main">(</span><span class="skolem">i</span> <span class="main">+</span> <span class="main">1</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> normal_imp_subgroup subgroup.subset <span class="keyword1"><span class="command">by</span></span> <span class="operator">force</span>
  <span class="keyword1"><span class="command">from</span></span> i' <span class="keyword1"><span class="command">have</span></span> finGSi<span class="main">:</span><span class="quoted"><span class="quoted">"finite <span class="main">(</span><span class="free">ğ”Š</span> <span class="main">!</span> <span class="main">(</span><span class="skolem">i</span> <span class="main">+</span> <span class="main">1</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span>  normal_series_subgroups finite <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> subgroup_finite<span class="main">)</span>
  <span class="keyword1"><span class="command">from</span></span> GiSi KG i' normal_series_subgroups <span class="keyword1"><span class="command">have</span></span> GSiKnormGSi<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="free">ğ”Š</span> <span class="main">!</span> <span class="main">(</span><span class="skolem">i</span> <span class="main">+</span> <span class="main">1</span><span class="main">)</span> <span class="main">âˆ©</span> <span class="free">K</span> <span class="main">âŠ²</span> <span class="free">G</span><span class="main">â¦‡</span>carrier <span class="main">:=</span> <span class="free">ğ”Š</span> <span class="main">!</span> <span class="main">(</span><span class="skolem">i</span> <span class="main">+</span> <span class="main">1</span><span class="main">)</span><span class="main">â¦ˆ</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> second_isomorphism_grp.normal_subgrp_intersection_normal
    <span class="keyword1"><span class="command">unfolding</span></span> second_isomorphism_grp_def second_isomorphism_grp_axioms_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">with</span></span> GiSi <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">ğ”Š</span> <span class="main">!</span> <span class="skolem">i</span> <span class="main">âˆ©</span> <span class="main">(</span><span class="free">ğ”Š</span> <span class="main">!</span> <span class="main">(</span><span class="skolem">i</span> <span class="main">+</span> <span class="main">1</span><span class="main">)</span> <span class="main">âˆ©</span> <span class="free">K</span><span class="main">)</span> <span class="main">âŠ²</span> <span class="free">G</span><span class="main">â¦‡</span>carrier <span class="main">:=</span> <span class="free">ğ”Š</span> <span class="main">!</span> <span class="main">(</span><span class="skolem">i</span> <span class="main">+</span> <span class="main">1</span><span class="main">)</span><span class="main">â¦ˆ</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> group.normal_subgroup_intersect group.subgroup_imp_group i' is_group is_normal_series normal_series.normal_series_subgroups<span class="main">)</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="free">K</span> <span class="main">âˆ©</span> <span class="main">(</span><span class="free">ğ”Š</span> <span class="main">!</span> <span class="skolem">i</span> <span class="main">âˆ©</span> <span class="free">ğ”Š</span> <span class="main">!</span> <span class="main">(</span><span class="skolem">i</span> <span class="main">+</span> <span class="main">1</span><span class="main">)</span><span class="main">)</span> <span class="main">âŠ²</span> <span class="free">G</span><span class="main">â¦‡</span>carrier <span class="main">:=</span> <span class="free">ğ”Š</span> <span class="main">!</span> <span class="main">(</span><span class="skolem">i</span> <span class="main">+</span> <span class="main">1</span><span class="main">)</span><span class="main">â¦ˆ</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> inf_commute inf_left_commute<span class="main">)</span>
  <span class="keyword1"><span class="command">hence</span></span> KGinormGSi<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="free">K</span> <span class="main">âˆ©</span> <span class="free">ğ”Š</span> <span class="main">!</span> <span class="skolem">i</span> <span class="main">âŠ²</span> <span class="free">G</span><span class="main">â¦‡</span>carrier <span class="main">:=</span> <span class="free">ğ”Š</span> <span class="main">!</span> <span class="main">(</span><span class="skolem">i</span> <span class="main">+</span> <span class="main">1</span><span class="main">)</span><span class="main">â¦ˆ</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> GiSi' <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> le_iff_inf<span class="main">)</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">K</span> <span class="main">âˆ©</span> <span class="free">ğ”Š</span> <span class="main">!</span> <span class="skolem">i</span> <span class="main">âŠ†</span> <span class="free">K</span> <span class="main">âˆ©</span> <span class="free">ğ”Š</span> <span class="main">!</span> <span class="main">(</span><span class="skolem">i</span> <span class="main">+</span> <span class="main">1</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> GiSi' <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> groupGSi<span class="main">:</span><span class="quoted"><span class="quoted">"group <span class="main">(</span><span class="free">G</span><span class="main">â¦‡</span>carrier <span class="main">:=</span> <span class="free">ğ”Š</span> <span class="main">!</span> <span class="main">(</span><span class="skolem">i</span> <span class="main">+</span> <span class="main">1</span><span class="main">)</span><span class="main">â¦ˆ</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> i normal_series_subgroups subgroup_imp_group <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> subKGSiGSi<span class="main">:</span><span class="quoted"><span class="quoted">"subgroup <span class="main">(</span><span class="free">K</span> <span class="main">âˆ©</span> <span class="free">ğ”Š</span> <span class="main">!</span> <span class="main">(</span><span class="skolem">i</span> <span class="main">+</span> <span class="main">1</span><span class="main">)</span><span class="main">)</span> <span class="main">(</span><span class="free">G</span><span class="main">â¦‡</span>carrier <span class="main">:=</span> <span class="free">ğ”Š</span> <span class="main">!</span> <span class="main">(</span><span class="skolem">i</span> <span class="main">+</span> <span class="main">1</span><span class="main">)</span><span class="main">â¦ˆ</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> GSiKnormGSi inf_sup_aci<span class="main"><span class="main">(</span></span>1<span class="main"><span class="main">)</span></span> normal_imp_subgroup<span class="main">)</span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> fstgoal<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="free">K</span> <span class="main">âˆ©</span> <span class="free">ğ”Š</span> <span class="main">!</span> <span class="skolem">i</span> <span class="main">âŠ²</span> <span class="free">G</span><span class="main">â¦‡</span>carrier <span class="main">:=</span> <span class="free">ğ”Š</span> <span class="main">!</span> <span class="main">(</span><span class="skolem">i</span> <span class="main">+</span> <span class="main">1</span><span class="main">)</span><span class="main">,</span> carrier <span class="main">:=</span> <span class="free">K</span> <span class="main">âˆ©</span> <span class="free">ğ”Š</span> <span class="main">!</span> <span class="main">(</span><span class="skolem">i</span> <span class="main">+</span> <span class="main">1</span><span class="main">)</span><span class="main">â¦ˆ</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> group.normal_restrict_supergroup <span class="keyword1"><span class="command">by</span></span> <span class="operator">force</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"remdups_adj <span class="main">(</span>map <span class="main">(</span><span class="main">(âˆ©)</span> <span class="free">K</span><span class="main">)</span> <span class="free">ğ”Š</span><span class="main">)</span> <span class="main">!</span> <span class="skolem">j</span> <span class="main">âŠ²</span> <span class="free">G</span><span class="main">â¦‡</span>carrier <span class="main">:=</span> <span class="free">K</span><span class="main">,</span> carrier <span class="main">:=</span> remdups_adj <span class="main">(</span>map <span class="main">(</span><span class="main">(âˆ©)</span> <span class="free">K</span><span class="main">)</span> <span class="free">ğ”Š</span><span class="main">)</span> <span class="main">!</span> <span class="main">(</span><span class="skolem">j</span> <span class="main">+</span> <span class="main">1</span><span class="main">)</span><span class="main">â¦ˆ</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> i <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">from</span></span> simplefact <span class="keyword1"><span class="command">have</span></span> Gisimple<span class="main">:</span><span class="quoted"><span class="quoted">"simple_group <span class="main">(</span><span class="free">G</span><span class="main">â¦‡</span>carrier <span class="main">:=</span> <span class="free">ğ”Š</span> <span class="main">!</span> <span class="main">(</span><span class="skolem">i</span> <span class="main">+</span> <span class="main">1</span><span class="main">)</span><span class="main">â¦ˆ</span> <span class="keyword1">Mod</span> <span class="free">ğ”Š</span> <span class="main">!</span> <span class="skolem">i</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> i' <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">hence</span></span> Gimax<span class="main">:</span><span class="quoted"><span class="quoted">"max_normal_subgroup <span class="main">(</span><span class="free">ğ”Š</span> <span class="main">!</span> <span class="skolem">i</span><span class="main">)</span> <span class="main">(</span><span class="free">G</span><span class="main">â¦‡</span>carrier <span class="main">:=</span> <span class="free">ğ”Š</span> <span class="main">!</span> <span class="main">(</span><span class="skolem">i</span> <span class="main">+</span> <span class="main">1</span><span class="main">)</span><span class="main">â¦ˆ</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> normal.max_normal_simple_quotient GiSi finGSi <span class="keyword1"><span class="command">by</span></span> <span class="operator">force</span>
  <span class="keyword1"><span class="command">from</span></span> GSiKnormGSi GiSi <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">ğ”Š</span> <span class="main">!</span> <span class="skolem">i</span> <span class="main">&lt;#&gt;</span><span class="hidden">â‡˜</span><sub><span class="free">G</span><span class="main">â¦‡</span>carrier <span class="main">:=</span> <span class="free">ğ”Š</span> <span class="main">!</span> <span class="main">(</span><span class="skolem">i</span> <span class="main">+</span> <span class="main">1</span><span class="main">)</span><span class="main">â¦ˆ</span></sub><span class="hidden">â‡™</span> <span class="free">ğ”Š</span> <span class="main">!</span> <span class="main">(</span><span class="skolem">i</span> <span class="main">+</span> <span class="main">1</span><span class="main">)</span> <span class="main">âˆ©</span> <span class="free">K</span> <span class="main">âŠ²</span> <span class="main">(</span><span class="free">G</span><span class="main">â¦‡</span>carrier <span class="main">:=</span> <span class="free">ğ”Š</span> <span class="main">!</span> <span class="main">(</span><span class="skolem">i</span> <span class="main">+</span> <span class="main">1</span><span class="main">)</span><span class="main">â¦ˆ</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> groupGSi group.normal_subgroup_set_mult_closed set_mult_consistent <span class="keyword1"><span class="command">by</span></span> <span class="operator">fastforce</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="free">ğ”Š</span> <span class="main">!</span> <span class="skolem">i</span> <span class="main">&lt;#&gt;</span> <span class="free">ğ”Š</span> <span class="main">!</span> <span class="main">(</span><span class="skolem">i</span> <span class="main">+</span> <span class="main">1</span><span class="main">)</span> <span class="main">âˆ©</span> <span class="free">K</span> <span class="main">âŠ²</span> <span class="free">G</span><span class="main">â¦‡</span>carrier <span class="main">:=</span> <span class="free">ğ”Š</span> <span class="main">!</span> <span class="main">(</span><span class="skolem">i</span> <span class="main">+</span> <span class="main">1</span><span class="main">)</span><span class="main">â¦ˆ</span>"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> set_mult_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="free">ğ”Š</span> <span class="main">!</span> <span class="skolem">i</span> <span class="main">&lt;#&gt;</span> <span class="free">K</span> <span class="main">âˆ©</span> <span class="free">ğ”Š</span> <span class="main">!</span> <span class="main">(</span><span class="skolem">i</span> <span class="main">+</span> <span class="main">1</span><span class="main">)</span> <span class="main">âŠ²</span> <span class="free">G</span><span class="main">â¦‡</span>carrier <span class="main">:=</span> <span class="free">ğ”Š</span> <span class="main">!</span> <span class="main">(</span><span class="skolem">i</span> <span class="main">+</span> <span class="main">1</span><span class="main">)</span><span class="main">â¦ˆ</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> inf_commute <span class="keyword1"><span class="command">by</span></span> <span class="operator">metis</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">ğ”Š</span> <span class="main">!</span> <span class="skolem">i</span> <span class="main">âŠ†</span> <span class="free">ğ”Š</span> <span class="main">!</span> <span class="skolem">i</span> <span class="main">&lt;#&gt;</span><span class="hidden">â‡˜</span><sub><span class="free">G</span><span class="main">â¦‡</span>carrier <span class="main">:=</span> <span class="free">ğ”Š</span> <span class="main">!</span> <span class="main">(</span><span class="skolem">i</span> <span class="main">+</span> <span class="main">1</span><span class="main">)</span><span class="main">â¦ˆ</span></sub><span class="hidden">â‡™</span> <span class="free">K</span> <span class="main">âˆ©</span> <span class="free">ğ”Š</span> <span class="main">!</span> <span class="main">(</span><span class="skolem">i</span> <span class="main">+</span> <span class="main">1</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> second_isomorphism_grp.H_contained_in_set_mult
    <span class="keyword1"><span class="command">unfolding</span></span> second_isomorphism_grp_def second_isomorphism_grp_axioms_def
    <span class="keyword1"><span class="command">using</span></span> subKGSiGSi GiSi normal_imp_subgroup <span class="keyword1"><span class="command">by</span></span> <span class="operator">fastforce</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="free">ğ”Š</span> <span class="main">!</span> <span class="skolem">i</span> <span class="main">âŠ†</span> <span class="free">ğ”Š</span> <span class="main">!</span> <span class="skolem">i</span> <span class="main">&lt;#&gt;</span> <span class="free">K</span> <span class="main">âˆ©</span> <span class="free">ğ”Š</span> <span class="main">!</span> <span class="main">(</span><span class="skolem">i</span> <span class="main">+</span> <span class="main">1</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> set_mult_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> KGdisj<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="free">ğ”Š</span> <span class="main">!</span> <span class="skolem">i</span> <span class="main">&lt;#&gt;</span> <span class="free">K</span> <span class="main">âˆ©</span> <span class="free">ğ”Š</span> <span class="main">!</span> <span class="main">(</span><span class="skolem">i</span> <span class="main">+</span> <span class="main">1</span><span class="main">)</span> <span class="main">=</span> <span class="free">ğ”Š</span> <span class="main">!</span> <span class="skolem">i</span> <span class="main">âˆ¨</span> <span class="free">ğ”Š</span> <span class="main">!</span> <span class="skolem">i</span> <span class="main">&lt;#&gt;</span> <span class="free">K</span> <span class="main">âˆ©</span> <span class="free">ğ”Š</span> <span class="main">!</span> <span class="main">(</span><span class="skolem">i</span> <span class="main">+</span> <span class="main">1</span><span class="main">)</span> <span class="main">=</span> <span class="free">ğ”Š</span> <span class="main">!</span> <span class="main">(</span><span class="skolem">i</span> <span class="main">+</span> <span class="main">1</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> Gimax <span class="keyword1"><span class="command">unfolding</span></span> max_normal_subgroup_def max_normal_subgroup_axioms_def
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">Ï†</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">Ï†</span> <span class="main">âˆˆ</span> iso  <span class="main">(</span><span class="free">G</span><span class="main">â¦‡</span>carrier <span class="main">:=</span> <span class="free">K</span> <span class="main">âˆ©</span> <span class="free">ğ”Š</span> <span class="main">!</span> <span class="main">(</span><span class="skolem">i</span> <span class="main">+</span> <span class="main">1</span><span class="main">)</span><span class="main">â¦ˆ</span> <span class="keyword1">Mod</span> <span class="main">(</span><span class="free">ğ”Š</span> <span class="main">!</span> <span class="skolem">i</span> <span class="main">âˆ©</span> <span class="main">(</span><span class="free">K</span> <span class="main">âˆ©</span> <span class="free">ğ”Š</span> <span class="main">!</span> <span class="main">(</span><span class="skolem">i</span> <span class="main">+</span> <span class="main">1</span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>
             <span class="main">(</span><span class="free">G</span><span class="main">â¦‡</span>carrier <span class="main">:=</span> <span class="free">ğ”Š</span> <span class="main">!</span> <span class="skolem">i</span> <span class="main">&lt;#&gt;</span><span class="hidden">â‡˜</span><sub><span class="free">G</span><span class="main">â¦‡</span>carrier <span class="main">:=</span> <span class="free">ğ”Š</span> <span class="main">!</span> <span class="main">(</span><span class="skolem">i</span> <span class="main">+</span> <span class="main">1</span><span class="main">)</span><span class="main">â¦ˆ</span></sub><span class="hidden">â‡™</span> <span class="free">K</span> <span class="main">âˆ©</span> <span class="free">ğ”Š</span> <span class="main">!</span> <span class="main">(</span><span class="skolem">i</span> <span class="main">+</span> <span class="main">1</span><span class="main">)</span><span class="main">â¦ˆ</span> <span class="keyword1">Mod</span> <span class="free">ğ”Š</span> <span class="main">!</span> <span class="skolem">i</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> second_isomorphism_grp.normal_intersection_quotient_isom
    <span class="keyword1"><span class="command">unfolding</span></span> second_isomorphism_grp_def second_isomorphism_grp_axioms_def
    <span class="keyword1"><span class="command">using</span></span> GiSi subKGSiGSi normal_imp_subgroup  <span class="keyword1"><span class="command">by</span></span> <span class="operator">fastforce</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">Ï†</span> <span class="main">âˆˆ</span> iso  <span class="main">(</span><span class="free">G</span><span class="main">â¦‡</span>carrier <span class="main">:=</span> <span class="free">K</span> <span class="main">âˆ©</span> <span class="free">ğ”Š</span> <span class="main">!</span> <span class="main">(</span><span class="skolem">i</span> <span class="main">+</span> <span class="main">1</span><span class="main">)</span><span class="main">â¦ˆ</span> <span class="keyword1">Mod</span> <span class="main">(</span><span class="free">K</span> <span class="main">âˆ©</span> <span class="free">ğ”Š</span> <span class="main">!</span> <span class="main">(</span><span class="skolem">i</span> <span class="main">+</span> <span class="main">1</span><span class="main">)</span> <span class="main">âˆ©</span> <span class="free">ğ”Š</span> <span class="main">!</span> <span class="skolem">i</span><span class="main">)</span><span class="main">)</span>
                  <span class="main">(</span><span class="free">G</span><span class="main">â¦‡</span>carrier <span class="main">:=</span> <span class="free">ğ”Š</span> <span class="main">!</span> <span class="skolem">i</span> <span class="main">&lt;#&gt;</span><span class="hidden">â‡˜</span><sub><span class="free">G</span><span class="main">â¦‡</span>carrier <span class="main">:=</span> <span class="free">ğ”Š</span> <span class="main">!</span> <span class="main">(</span><span class="skolem">i</span> <span class="main">+</span> <span class="main">1</span><span class="main">)</span><span class="main">â¦ˆ</span></sub><span class="hidden">â‡™</span> <span class="free">K</span> <span class="main">âˆ©</span> <span class="free">ğ”Š</span> <span class="main">!</span> <span class="main">(</span><span class="skolem">i</span> <span class="main">+</span> <span class="main">1</span><span class="main">)</span><span class="main">â¦ˆ</span> <span class="keyword1">Mod</span> <span class="free">ğ”Š</span> <span class="main">!</span> <span class="skolem">i</span><span class="main">)</span>"</span></span> 
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> inf_commute<span class="main">)</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">Ï†</span> <span class="main">âˆˆ</span> iso <span class="main">(</span><span class="free">G</span><span class="main">â¦‡</span>carrier <span class="main">:=</span> <span class="free">K</span> <span class="main">âˆ©</span> <span class="free">ğ”Š</span> <span class="main">!</span> <span class="main">(</span><span class="skolem">i</span> <span class="main">+</span> <span class="main">1</span><span class="main">)</span><span class="main">â¦ˆ</span> <span class="keyword1">Mod</span> <span class="main">(</span><span class="free">K</span> <span class="main">âˆ©</span> <span class="main">(</span><span class="free">ğ”Š</span> <span class="main">!</span> <span class="main">(</span><span class="skolem">i</span> <span class="main">+</span> <span class="main">1</span><span class="main">)</span> <span class="main">âˆ©</span> <span class="free">ğ”Š</span> <span class="main">!</span> <span class="skolem">i</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>
                 <span class="main">(</span><span class="free">G</span><span class="main">â¦‡</span>carrier <span class="main">:=</span> <span class="free">ğ”Š</span> <span class="main">!</span> <span class="skolem">i</span> <span class="main">&lt;#&gt;</span><span class="hidden">â‡˜</span><sub><span class="free">G</span><span class="main">â¦‡</span>carrier <span class="main">:=</span> <span class="free">ğ”Š</span> <span class="main">!</span> <span class="main">(</span><span class="skolem">i</span> <span class="main">+</span> <span class="main">1</span><span class="main">)</span><span class="main">â¦ˆ</span></sub><span class="hidden">â‡™</span> <span class="free">K</span> <span class="main">âˆ©</span> <span class="free">ğ”Š</span> <span class="main">!</span> <span class="main">(</span><span class="skolem">i</span> <span class="main">+</span> <span class="main">1</span><span class="main">)</span><span class="main">â¦ˆ</span> <span class="keyword1">Mod</span> <span class="free">ğ”Š</span> <span class="main">!</span> <span class="skolem">i</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> Int_assoc<span class="main">)</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">Ï†</span> <span class="main">âˆˆ</span> iso <span class="main">(</span><span class="free">G</span><span class="main">â¦‡</span>carrier <span class="main">:=</span> <span class="free">K</span> <span class="main">âˆ©</span> <span class="free">ğ”Š</span> <span class="main">!</span> <span class="main">(</span><span class="skolem">i</span> <span class="main">+</span> <span class="main">1</span><span class="main">)</span><span class="main">â¦ˆ</span> <span class="keyword1">Mod</span> <span class="main">(</span><span class="free">K</span> <span class="main">âˆ©</span> <span class="free">ğ”Š</span> <span class="main">!</span> <span class="skolem">i</span><span class="main">)</span><span class="main">)</span>
                 <span class="main">(</span><span class="free">G</span><span class="main">â¦‡</span>carrier <span class="main">:=</span> <span class="free">ğ”Š</span> <span class="main">!</span> <span class="skolem">i</span> <span class="main">&lt;#&gt;</span><span class="hidden">â‡˜</span><sub><span class="free">G</span><span class="main">â¦‡</span>carrier <span class="main">:=</span> <span class="free">ğ”Š</span> <span class="main">!</span> <span class="main">(</span><span class="skolem">i</span> <span class="main">+</span> <span class="main">1</span><span class="main">)</span><span class="main">â¦ˆ</span></sub><span class="hidden">â‡™</span> <span class="free">K</span> <span class="main">âˆ©</span> <span class="free">ğ”Š</span> <span class="main">!</span> <span class="main">(</span><span class="skolem">i</span> <span class="main">+</span> <span class="main">1</span><span class="main">)</span><span class="main">â¦ˆ</span> <span class="keyword1">Mod</span> <span class="free">ğ”Š</span> <span class="main">!</span> <span class="skolem">i</span><span class="main">)</span>"</span></span> 
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> GiSi' Int_absorb2 Int_commute<span class="main">)</span>
  <span class="keyword1"><span class="command">hence</span></span> Ï†<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">Ï†</span> <span class="main">âˆˆ</span> iso <span class="main">(</span><span class="free">G</span><span class="main">â¦‡</span>carrier <span class="main">:=</span> <span class="free">K</span> <span class="main">âˆ©</span> <span class="free">ğ”Š</span> <span class="main">!</span> <span class="main">(</span><span class="skolem">i</span> <span class="main">+</span> <span class="main">1</span><span class="main">)</span><span class="main">â¦ˆ</span> <span class="keyword1">Mod</span> <span class="main">(</span><span class="free">K</span> <span class="main">âˆ©</span> <span class="free">ğ”Š</span> <span class="main">!</span> <span class="skolem">i</span><span class="main">)</span><span class="main">)</span>
                   <span class="main">(</span><span class="free">G</span><span class="main">â¦‡</span>carrier <span class="main">:=</span> <span class="free">ğ”Š</span> <span class="main">!</span> <span class="skolem">i</span> <span class="main">&lt;#&gt;</span> <span class="free">K</span> <span class="main">âˆ©</span> <span class="free">ğ”Š</span> <span class="main">!</span> <span class="main">(</span><span class="skolem">i</span> <span class="main">+</span> <span class="main">1</span><span class="main">)</span><span class="main">â¦ˆ</span> <span class="keyword1">Mod</span> <span class="free">ğ”Š</span> <span class="main">!</span> <span class="skolem">i</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">unfolding</span></span> set_mult_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">from</span></span> fstgoal <span class="keyword1"><span class="command">have</span></span> KGsiKGigroup<span class="main">:</span><span class="quoted"><span class="quoted">"group <span class="main">(</span><span class="free">G</span><span class="main">â¦‡</span>carrier <span class="main">:=</span> <span class="free">K</span> <span class="main">âˆ©</span> <span class="free">ğ”Š</span> <span class="main">!</span> <span class="main">(</span><span class="skolem">i</span> <span class="main">+</span> <span class="main">1</span><span class="main">)</span><span class="main">â¦ˆ</span> <span class="keyword1">Mod</span> <span class="main">(</span><span class="free">K</span> <span class="main">âˆ©</span> <span class="free">ğ”Š</span> <span class="main">!</span> <span class="skolem">i</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> normal.factorgroup_is_group <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">from</span></span> KGdisj <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"simple_group <span class="main">(</span><span class="free">G</span><span class="main">â¦‡</span>carrier <span class="main">:=</span> <span class="free">K</span><span class="main">,</span> carrier <span class="main">:=</span> remdups_adj <span class="main">(</span>map <span class="main">(</span><span class="main">(âˆ©)</span> <span class="free">K</span><span class="main">)</span> <span class="free">ğ”Š</span><span class="main">)</span> <span class="main">!</span> <span class="main">(</span><span class="skolem">j</span> <span class="main">+</span> <span class="main">1</span><span class="main">)</span><span class="main">â¦ˆ</span> <span class="keyword1">Mod</span> remdups_adj <span class="main">(</span>map <span class="main">(</span><span class="main">(âˆ©)</span> <span class="free">K</span><span class="main">)</span> <span class="free">ğ”Š</span><span class="main">)</span> <span class="main">!</span> <span class="skolem">j</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">have</span></span> groupGi<span class="main">:</span><span class="quoted"><span class="quoted">"group <span class="main">(</span><span class="free">G</span><span class="main">â¦‡</span>carrier <span class="main">:=</span> <span class="free">ğ”Š</span> <span class="main">!</span> <span class="skolem">i</span><span class="main">â¦ˆ</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> i' normal_series_subgroups subgroup_imp_group <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="free">ğ”Š</span> <span class="main">!</span> <span class="skolem">i</span> <span class="main">&lt;#&gt;</span> <span class="free">K</span> <span class="main">âˆ©</span> <span class="free">ğ”Š</span> <span class="main">!</span> Suc <span class="skolem">i</span> <span class="main">=</span> <span class="free">ğ”Š</span> <span class="main">!</span> <span class="skolem">i</span>"</span></span>
    <span class="keyword1"><span class="command">with</span></span> Ï† <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">Ï†</span> <span class="main">âˆˆ</span> iso <span class="main">(</span><span class="free">G</span><span class="main">â¦‡</span>carrier <span class="main">:=</span> <span class="free">K</span> <span class="main">âˆ©</span> <span class="free">ğ”Š</span> <span class="main">!</span> <span class="main">(</span><span class="skolem">i</span> <span class="main">+</span> <span class="main">1</span><span class="main">)</span><span class="main">â¦ˆ</span> <span class="keyword1">Mod</span> <span class="main">(</span><span class="free">K</span> <span class="main">âˆ©</span> <span class="free">ğ”Š</span> <span class="main">!</span> <span class="skolem">i</span><span class="main">)</span><span class="main">)</span> <span class="main">(</span><span class="free">G</span><span class="main">â¦‡</span>carrier <span class="main">:=</span> <span class="free">ğ”Š</span> <span class="main">!</span> <span class="skolem">i</span><span class="main">â¦ˆ</span> <span class="keyword1">Mod</span> <span class="free">ğ”Š</span> <span class="main">!</span> <span class="skolem">i</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">Ïˆ</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">Ïˆ</span> <span class="main">âˆˆ</span> iso <span class="main">(</span><span class="free">G</span><span class="main">â¦‡</span>carrier <span class="main">:=</span> <span class="free">ğ”Š</span> <span class="main">!</span> <span class="skolem">i</span><span class="main">â¦ˆ</span> <span class="keyword1">Mod</span> <span class="main">(</span>carrier <span class="main">(</span><span class="free">G</span><span class="main">â¦‡</span>carrier <span class="main">:=</span> <span class="free">ğ”Š</span> <span class="main">!</span> <span class="skolem">i</span><span class="main">â¦ˆ</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">(</span><span class="free">G</span><span class="main">â¦‡</span>carrier <span class="main">:=</span> <span class="main">{</span><span class="main">ğŸ­</span><span class="hidden">â‡˜</span><sub><span class="free">G</span><span class="main">â¦‡</span>carrier <span class="main">:=</span> <span class="free">ğ”Š</span> <span class="main">!</span> <span class="skolem">i</span><span class="main">â¦ˆ</span></sub><span class="hidden">â‡™</span><span class="main">}</span><span class="main">â¦ˆ</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> group.self_factor_iso groupGi <span class="keyword1"><span class="command">by</span></span> <span class="operator">force</span>
    <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">Ï€</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">Ï€</span> <span class="main">âˆˆ</span> iso <span class="main">(</span><span class="free">G</span><span class="main">â¦‡</span>carrier <span class="main">:=</span> <span class="free">K</span> <span class="main">âˆ©</span> <span class="free">ğ”Š</span> <span class="main">!</span> <span class="main">(</span><span class="skolem">i</span> <span class="main">+</span> <span class="main">1</span><span class="main">)</span><span class="main">â¦ˆ</span> <span class="keyword1">Mod</span> <span class="main">(</span><span class="free">K</span> <span class="main">âˆ©</span> <span class="free">ğ”Š</span> <span class="main">!</span> <span class="skolem">i</span><span class="main">)</span><span class="main">)</span> <span class="main">(</span><span class="free">G</span><span class="main">â¦‡</span>carrier <span class="main">:=</span> <span class="main">{</span><span class="main">ğŸ­</span><span class="main">}</span><span class="main">â¦ˆ</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> iso_set_trans <span class="keyword1"><span class="command">by</span></span> <span class="operator">fastforce</span>
    <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"order <span class="main">(</span><span class="free">G</span><span class="main">â¦‡</span>carrier <span class="main">:=</span> <span class="free">K</span> <span class="main">âˆ©</span> <span class="free">ğ”Š</span> <span class="main">!</span> <span class="main">(</span><span class="skolem">i</span> <span class="main">+</span> <span class="main">1</span><span class="main">)</span><span class="main">â¦ˆ</span> <span class="keyword1">Mod</span> <span class="main">(</span><span class="free">K</span> <span class="main">âˆ©</span> <span class="free">ğ”Š</span> <span class="main">!</span> <span class="skolem">i</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> order <span class="main">(</span><span class="free">G</span><span class="main">â¦‡</span>carrier <span class="main">:=</span> <span class="main">{</span><span class="main">ğŸ­</span><span class="main">}</span><span class="main">â¦ˆ</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> iso_order_closed<span class="main">)</span>
    <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"order <span class="main">(</span><span class="free">G</span><span class="main">â¦‡</span>carrier <span class="main">:=</span> <span class="free">K</span> <span class="main">âˆ©</span> <span class="free">ğ”Š</span> <span class="main">!</span> <span class="main">(</span><span class="skolem">i</span> <span class="main">+</span> <span class="main">1</span><span class="main">)</span><span class="main">â¦ˆ</span> <span class="keyword1">Mod</span> <span class="main">(</span><span class="free">K</span> <span class="main">âˆ©</span> <span class="free">ğ”Š</span> <span class="main">!</span> <span class="skolem">i</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> <span class="main">1</span>"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> order_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"carrier <span class="main">(</span><span class="free">G</span><span class="main">â¦‡</span>carrier <span class="main">:=</span> <span class="free">K</span> <span class="main">âˆ©</span> <span class="free">ğ”Š</span> <span class="main">!</span> <span class="main">(</span><span class="skolem">i</span> <span class="main">+</span> <span class="main">1</span><span class="main">)</span><span class="main">â¦ˆ</span> <span class="keyword1">Mod</span> <span class="main">(</span><span class="free">K</span> <span class="main">âˆ©</span> <span class="free">ğ”Š</span> <span class="main">!</span> <span class="skolem">i</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> <span class="main">{</span><span class="main">ğŸ­</span><span class="hidden">â‡˜</span><sub><span class="free">G</span><span class="main">â¦‡</span>carrier <span class="main">:=</span> <span class="free">K</span> <span class="main">âˆ©</span> <span class="free">ğ”Š</span> <span class="main">!</span> <span class="main">(</span><span class="skolem">i</span> <span class="main">+</span> <span class="main">1</span><span class="main">)</span><span class="main">â¦ˆ</span> <span class="keyword1">Mod</span> <span class="main">(</span><span class="free">K</span> <span class="main">âˆ©</span> <span class="free">ğ”Š</span> <span class="main">!</span> <span class="skolem">i</span><span class="main">)</span></sub><span class="hidden">â‡™</span><span class="main">}</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> group.order_one_triv_iff KGsiKGigroup <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
    <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> fstgoal <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">K</span> <span class="main">âˆ©</span> <span class="free">ğ”Š</span> <span class="main">!</span> <span class="skolem">i</span> <span class="main">âŠ²</span> <span class="free">G</span><span class="main">â¦‡</span>carrier <span class="main">:=</span> <span class="free">K</span> <span class="main">âˆ©</span> <span class="free">ğ”Š</span> <span class="main">!</span> <span class="main">(</span><span class="skolem">i</span> <span class="main">+</span> <span class="main">1</span><span class="main">)</span><span class="main">â¦ˆ</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> finGSi <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"finite <span class="main">(</span>carrier <span class="main">(</span><span class="free">G</span><span class="main">â¦‡</span>carrier <span class="main">:=</span> <span class="free">K</span> <span class="main">âˆ©</span> <span class="free">ğ”Š</span> <span class="main">!</span> <span class="main">(</span><span class="skolem">i</span> <span class="main">+</span> <span class="main">1</span><span class="main">)</span><span class="main">â¦ˆ</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">K</span> <span class="main">âˆ©</span> <span class="free">ğ”Š</span> <span class="main">!</span> <span class="skolem">i</span> <span class="main">=</span> carrier <span class="main">(</span><span class="free">G</span><span class="main">â¦‡</span>carrier <span class="main">:=</span> <span class="free">K</span> <span class="main">âˆ©</span> <span class="free">ğ”Š</span> <span class="main">!</span> <span class="main">(</span><span class="skolem">i</span> <span class="main">+</span> <span class="main">1</span><span class="main">)</span><span class="main">â¦ˆ</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> normal.fact_group_trivial_iff<span class="main">)</span>
    <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span>remdups_adj <span class="main">(</span>map <span class="main">(</span><span class="main">(âˆ©)</span> <span class="free">K</span><span class="main">)</span> <span class="free">ğ”Š</span><span class="main">)</span><span class="main">)</span> <span class="main">!</span> <span class="skolem">j</span> <span class="main">=</span> <span class="main">(</span>remdups_adj <span class="main">(</span>map <span class="main">(</span><span class="main">(âˆ©)</span> <span class="free">K</span><span class="main">)</span> <span class="free">ğ”Š</span><span class="main">)</span><span class="main">)</span> <span class="main">!</span> <span class="main">(</span><span class="skolem">j</span> <span class="main">+</span> <span class="main">1</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> i <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">with</span></span> j <span class="keyword1"><span class="command">have</span></span> <span class="quoted">False</span> <span class="keyword1"><span class="command">using</span></span> remdups_adj_adjacent KGnotempty Suc_eq_plus1 <span class="keyword1"><span class="command">by</span></span> <span class="operator">metis</span>
    <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"simple_group <span class="main">(</span><span class="free">G</span><span class="main">â¦‡</span>carrier <span class="main">:=</span> remdups_adj <span class="main">(</span>map <span class="main">(</span><span class="main">(âˆ©)</span> <span class="free">K</span><span class="main">)</span> <span class="free">ğ”Š</span><span class="main">)</span> <span class="main">!</span> Suc <span class="skolem">j</span><span class="main">â¦ˆ</span> <span class="keyword1">Mod</span> remdups_adj <span class="main">(</span>map <span class="main">(</span><span class="main">(âˆ©)</span> <span class="free">K</span><span class="main">)</span> <span class="free">ğ”Š</span><span class="main">)</span> <span class="main">!</span> <span class="skolem">j</span><span class="main">)</span>"</span></span><span class="keyword1"><span class="command">..</span></span>
  <span class="keyword1"><span class="command">next</span></span>
    <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="free">ğ”Š</span> <span class="main">!</span> <span class="skolem">i</span> <span class="main">&lt;#&gt;</span> <span class="free">K</span> <span class="main">âˆ©</span> <span class="free">ğ”Š</span> <span class="main">!</span> Suc <span class="skolem">i</span> <span class="main">=</span> <span class="free">ğ”Š</span> <span class="main">!</span> Suc <span class="skolem">i</span>"</span></span>
    <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command"><span class="improper">with</span></span></span> Ï† <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">Ï†</span> <span class="main">âˆˆ</span> iso <span class="main">(</span><span class="free">G</span><span class="main">â¦‡</span>carrier <span class="main">:=</span> <span class="free">K</span> <span class="main">âˆ©</span> <span class="free">ğ”Š</span> <span class="main">!</span> <span class="main">(</span><span class="skolem">i</span> <span class="main">+</span> <span class="main">1</span><span class="main">)</span><span class="main">â¦ˆ</span> <span class="keyword1">Mod</span> <span class="main">(</span><span class="free">K</span> <span class="main">âˆ©</span> <span class="free">ğ”Š</span> <span class="main">!</span> <span class="skolem">i</span><span class="main">)</span><span class="main">)</span> <span class="main">(</span><span class="free">G</span><span class="main">â¦‡</span>carrier <span class="main">:=</span> <span class="free">ğ”Š</span> <span class="main">!</span> <span class="main">(</span><span class="skolem">i</span> <span class="main">+</span> <span class="main">1</span><span class="main">)</span><span class="main">â¦ˆ</span> <span class="keyword1">Mod</span> <span class="free">ğ”Š</span> <span class="main">!</span> <span class="skolem">i</span><span class="main">)</span>"</span></span><span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">Ï†'</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">Ï†'</span> <span class="main">âˆˆ</span> iso <span class="main">(</span><span class="free">G</span><span class="main">â¦‡</span>carrier <span class="main">:=</span> <span class="free">ğ”Š</span> <span class="main">!</span> <span class="main">(</span><span class="skolem">i</span> <span class="main">+</span> <span class="main">1</span><span class="main">)</span><span class="main">â¦ˆ</span> <span class="keyword1">Mod</span> <span class="free">ğ”Š</span> <span class="main">!</span> <span class="skolem">i</span><span class="main">)</span> <span class="main">(</span><span class="free">G</span><span class="main">â¦‡</span>carrier <span class="main">:=</span> <span class="free">K</span> <span class="main">âˆ©</span> <span class="free">ğ”Š</span> <span class="main">!</span> <span class="main">(</span><span class="skolem">i</span> <span class="main">+</span> <span class="main">1</span><span class="main">)</span><span class="main">â¦ˆ</span> <span class="keyword1">Mod</span> <span class="main">(</span><span class="free">K</span> <span class="main">âˆ©</span> <span class="free">ğ”Š</span> <span class="main">!</span> <span class="skolem">i</span><span class="main">)</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> KGsiKGigroup group.iso_set_sym <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">with</span></span> Gisimple KGsiKGigroup <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"simple_group <span class="main">(</span><span class="free">G</span><span class="main">â¦‡</span>carrier <span class="main">:=</span> <span class="free">K</span> <span class="main">âˆ©</span> <span class="free">ğ”Š</span> <span class="main">!</span> <span class="main">(</span><span class="skolem">i</span> <span class="main">+</span> <span class="main">1</span><span class="main">)</span><span class="main">â¦ˆ</span> <span class="keyword1">Mod</span> <span class="main">(</span><span class="free">K</span> <span class="main">âˆ©</span> <span class="free">ğ”Š</span> <span class="main">!</span> <span class="skolem">i</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> simple_group.iso_simple<span class="main">)</span>
    <span class="keyword1"><span class="command">with</span></span> i <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"simple_group <span class="main">(</span><span class="free">G</span><span class="main">â¦‡</span>carrier <span class="main">:=</span> remdups_adj <span class="main">(</span>map <span class="main">(</span><span class="main">(âˆ©)</span> <span class="free">K</span><span class="main">)</span> <span class="free">ğ”Š</span><span class="main">)</span> <span class="main">!</span> Suc <span class="skolem">j</span><span class="main">â¦ˆ</span> <span class="keyword1">Mod</span> remdups_adj <span class="main">(</span>map <span class="main">(</span><span class="main">(âˆ©)</span> <span class="free">K</span><span class="main">)</span> <span class="free">ğ”Š</span><span class="main">)</span> <span class="main">!</span> <span class="skolem">j</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">qed</span></span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> group<span class="main">)</span> composition_series_extend<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"composition_series <span class="main">(</span><span class="free">G</span><span class="main">â¦‡</span>carrier <span class="main">:=</span> <span class="free">H</span><span class="main">â¦ˆ</span><span class="main">)</span> <span class="free">â„Œ</span>"</span></span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"simple_group <span class="main">(</span><span class="free">G</span> <span class="keyword1">Mod</span> <span class="free">H</span><span class="main">)</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="free">H</span> <span class="main">âŠ²</span> <span class="free">G</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"composition_series <span class="free">G</span> <span class="main">(</span><span class="free">â„Œ</span> <span class="main">@</span> <span class="main">[</span>carrier <span class="free">G</span><span class="main">]</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">unfolding</span></span> composition_series_def composition_series_axioms_def
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">from</span></span> assms<span class="main">(</span>1<span class="main">)</span> <span class="keyword1"><span class="command">interpret</span></span> compâ„Œ<span class="main">:</span> composition_series <span class="quoted"><span class="quoted">"<span class="free">G</span><span class="main">â¦‡</span>carrier <span class="main">:=</span> <span class="free">H</span><span class="main">â¦ˆ</span>"</span></span> <span class="quoted"><span class="free">â„Œ</span></span> <span class="keyword1"><span class="command">.</span></span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"normal_series <span class="free">G</span> <span class="main">(</span><span class="free">â„Œ</span> <span class="main">@</span> <span class="main">[</span>carrier <span class="free">G</span><span class="main">]</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span>  assms<span class="main">(</span>3<span class="main">)</span> compâ„Œ.is_normal_series <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> normal_series_extend<span class="main">)</span>
  <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">i</span>
  <span class="keyword3"><span class="command">assume</span></span> i<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">i</span> <span class="main">&lt;</span> length <span class="free">â„Œ</span>"</span></span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"simple_group <span class="main">(</span><span class="free">G</span><span class="main">â¦‡</span>carrier <span class="main">:=</span> <span class="main">(</span><span class="free">â„Œ</span> <span class="main">@</span> <span class="main">[</span>carrier <span class="free">G</span><span class="main">]</span><span class="main">)</span> <span class="main">!</span> Suc <span class="skolem">i</span><span class="main">â¦ˆ</span> <span class="keyword1">Mod</span> <span class="main">(</span><span class="free">â„Œ</span> <span class="main">@</span> <span class="main">[</span>carrier <span class="free">G</span><span class="main">]</span><span class="main">)</span> <span class="main">!</span> <span class="skolem">i</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">cases</span> <span class="quoted"><span class="quoted">"<span class="skolem">i</span> <span class="main">=</span> length <span class="free">â„Œ</span> <span class="main">-</span> <span class="main">1</span>"</span></span><span class="main">)</span>
    <span class="keyword3"><span class="command">case</span></span> True
    <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">â„Œ</span> <span class="main">@</span> <span class="main">[</span>carrier <span class="free">G</span><span class="main">]</span><span class="main">)</span> <span class="main">!</span> Suc <span class="skolem">i</span> <span class="main">=</span> carrier <span class="free">G</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> i diff_Suc_1 lessE nth_append_length<span class="main">)</span>
    <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">â„Œ</span> <span class="main">@</span> <span class="main">[</span>carrier <span class="free">G</span><span class="main">]</span><span class="main">)</span> <span class="main">!</span> <span class="skolem">i</span> <span class="main">=</span> <span class="free">â„Œ</span> <span class="main">!</span> <span class="skolem">i</span>"</span></span><span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> butlast_snoc i nth_butlast<span class="main">)</span>
    <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">â„Œ</span> <span class="main">@</span> <span class="main">[</span>carrier <span class="free">G</span><span class="main">]</span><span class="main">)</span> <span class="main">!</span> <span class="skolem">i</span> <span class="main">=</span> <span class="free">H</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> True last_conv_nth compâ„Œ.notempty compâ„Œ.last <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>2<span class="main">)</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">next</span></span>
    <span class="keyword3"><span class="command">case</span></span> False
    <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"Suc <span class="skolem">i</span> <span class="main">&lt;</span> length <span class="free">â„Œ</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> i <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">â„Œ</span> <span class="main">@</span> <span class="main">[</span>carrier <span class="free">G</span><span class="main">]</span><span class="main">)</span> <span class="main">!</span> Suc <span class="skolem">i</span> <span class="main">=</span> <span class="free">â„Œ</span> <span class="main">!</span> Suc <span class="skolem">i</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> nth_append <span class="keyword1"><span class="command">by</span></span> <span class="operator">metis</span>
    <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> i <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">â„Œ</span> <span class="main">@</span> <span class="main">[</span>carrier <span class="free">G</span><span class="main">]</span><span class="main">)</span> <span class="main">!</span> <span class="skolem">i</span> <span class="main">=</span> <span class="free">â„Œ</span> <span class="main">!</span> <span class="skolem">i</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> nth_append <span class="keyword1"><span class="command">by</span></span> <span class="operator">metis</span>
    <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">â€¹Suc <span class="skolem">i</span> <span class="main">&lt;</span> length <span class="free">â„Œ</span>â€º</span></span> compâ„Œ.simplefact <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">qed</span></span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> composition_series<span class="main">)</span> entries_mono<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">i</span> <span class="main">â‰¤</span> <span class="free">j</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="free">j</span> <span class="main">&lt;</span> length <span class="free">ğ”Š</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">ğ”Š</span> <span class="main">!</span> <span class="free">i</span> <span class="main">âŠ†</span> <span class="free">ğ”Š</span> <span class="main">!</span> <span class="free">j</span>"</span></span>
<span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">induction</span> <span class="quoted"><span class="quoted">"<span class="free">j</span> <span class="main">-</span> <span class="free">i</span>"</span></span> <span class="quasi_keyword">arbitrary</span><span class="main"><span class="main">:</span></span> <span class="quoted"><span class="free">i</span></span> <span class="quoted"><span class="free">j</span></span><span class="main">)</span>
  <span class="keyword3"><span class="command">case</span></span> 0
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">i</span> <span class="main">=</span> <span class="skolem">j</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"<span class="free">ğ”Š</span> <span class="main">!</span> <span class="skolem">i</span> <span class="main">âŠ†</span> <span class="free">ğ”Š</span> <span class="main">!</span> <span class="skolem">j</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">next</span></span>
  <span class="keyword3"><span class="command">case</span></span> <span class="main">(</span>Suc <span class="skolem">k</span> <span class="skolem">i</span> <span class="skolem">j</span><span class="main">)</span>
  <span class="keyword1"><span class="command">hence</span></span> i'<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">i</span> <span class="main">+</span> <span class="main">(</span>Suc <span class="skolem">k</span><span class="main">)</span> <span class="main">=</span> <span class="skolem">j</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">i</span> <span class="main">+</span> <span class="main">1</span> <span class="main">&lt;</span> length <span class="free">ğ”Š</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">hence</span></span> ij<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">i</span> <span class="main">+</span> <span class="main">1</span> <span class="main">â‰¤</span> <span class="skolem">j</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">ğ”Š</span> <span class="main">!</span> <span class="skolem">i</span> <span class="main">âŠ†</span> <span class="free">ğ”Š</span> <span class="main">!</span> <span class="main">(</span><span class="skolem">i</span> <span class="main">+</span> <span class="main">1</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> i' normal normal_imp_subgroup subgroup.subset <span class="keyword1"><span class="command">by</span></span> <span class="operator">force</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">j</span> <span class="main">-</span> <span class="main">(</span><span class="skolem">i</span> <span class="main">+</span> <span class="main">1</span><span class="main">)</span> <span class="main">=</span> <span class="skolem">k</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">j</span> <span class="main">&lt;</span> length <span class="free">ğ”Š</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> Suc assms <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="free">ğ”Š</span> <span class="main">!</span> <span class="main">(</span><span class="skolem">i</span> <span class="main">+</span> <span class="main">1</span><span class="main">)</span> <span class="main">âŠ†</span> <span class="free">ğ”Š</span> <span class="main">!</span> <span class="skolem">j</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> Suc<span class="main">(</span>1<span class="main">)</span> ij <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="free">ğ”Š</span> <span class="main">!</span> <span class="skolem">i</span> <span class="main">âŠ†</span> <span class="free">ğ”Š</span> <span class="main">!</span> <span class="skolem">j</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword2"><span class="keyword">end</span></span>
</pre>
</div><div id="GroupIsoClasses">
<div class="head">
<h1>Theory GroupIsoClasses</h1>
</div>
<pre class="source"><span class="comment1">(*  Title:      Isomorphism Classes of Groups
    Author:     Jakob von Raumer, Karlsruhe Institute of Technology
    Maintainer: Jakob von Raumer &lt;jakob.raumer@student.kit.edu&gt;
*)</span>

<span class="keyword1"><span class="command">theory</span></span> GroupIsoClasses
<span class="keyword2"><span class="keyword">imports</span></span>
  <span class="quoted">"<a href="../../HOL/HOL-Algebra/Coset.html">HOL-Algebra.Coset</a>"</span>
<span class="keyword2"><span class="keyword">begin</span></span>

<span class="keyword1"><span class="command">section</span></span> <span class="quoted"><span class="plain_text">â€¹Isomorphism Classes of Groupsâ€º</span></span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">â€¹We construct a quotient type for isomorphism classes of groups.â€º</span></span>

<span class="keyword1"><span class="command">typedef</span></span> <span class="tfree">'a</span> group <span class="main">=</span> <span class="quoted"><span class="quoted">"<span class="main">{</span><span class="bound">G</span> <span class="main">::</span> <span class="tfree">'a</span> monoid<span class="main">.</span> group <span class="bound">G</span><span class="main">}</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">â‹€</span><span class="bound">a</span><span class="main">.</span> <span class="main">â¦‡</span>carrier <span class="main">=</span> <span class="main">{</span><span class="bound">a</span><span class="main">}</span><span class="main">,</span> mult <span class="main">=</span> <span class="main">(</span><span class="main">Î»</span><span class="bound">x</span> <span class="bound">y</span><span class="main">.</span> <span class="bound">x</span><span class="main">)</span><span class="main">,</span> one <span class="main">=</span> <span class="bound">a</span><span class="main">â¦ˆ</span> <span class="main">âˆˆ</span> <span class="main">{</span><span class="bound">G</span><span class="main">.</span> group <span class="bound">G</span><span class="main">}</span>"</span></span>
  <span class="keyword1"><span class="command">unfolding</span></span> group_def group_axioms_def monoid_def Units_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">definition</span></span> <span class="entity">group_iso_rel</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'a</span> group <span class="main">â‡’</span> <span class="tfree">'a</span> group <span class="main">â‡’</span> bool"</span></span>
  <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="free">group_iso_rel</span> <span class="free"><span class="bound"><span class="entity">G</span></span></span> <span class="free"><span class="bound"><span class="entity">H</span></span></span> <span class="main">=</span> <span class="main">(</span><span class="main">âˆƒ</span><span class="bound">Ï†</span><span class="main">.</span> <span class="bound">Ï†</span> <span class="main">âˆˆ</span> iso <span class="main">(</span>Rep_group <span class="free"><span class="bound"><span class="entity">G</span></span></span><span class="main">)</span> <span class="main">(</span>Rep_group <span class="free"><span class="bound"><span class="entity">H</span></span></span><span class="main">)</span><span class="main">)</span>"</span></span>

<span class="keyword1"><span class="command">quotient_type</span></span> <span class="tfree">'a</span> group_iso_class <span class="main">=</span> <span class="quoted"><span class="quoted">"<span class="tfree">'a</span> group"</span></span> <span class="main">/</span> <span class="quoted">group_iso_rel</span>
  <span class="keyword2"><span class="keyword">morphisms</span></span> Rep_group_iso Abs_group_iso
<span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">rule</span> equivpI<span class="main">)</span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"reflp group_iso_rel"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">rule</span> reflpI<span class="main">)</span>
    <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">G</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'b</span> group"</span></span>
    <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"group_iso_rel <span class="skolem">G</span> <span class="skolem">G</span>"</span></span>
      <span class="keyword1"><span class="command">unfolding</span></span> group_iso_rel_def <span class="keyword1"><span class="command">using</span></span> iso_set_refl <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">qed</span></span>
<span class="keyword1"><span class="command">next</span></span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"symp group_iso_rel"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">rule</span> sympI<span class="main">)</span>
    <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">G</span> <span class="skolem">H</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'b</span> group"</span></span>
    <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"group_iso_rel <span class="skolem">G</span> <span class="skolem">H</span>"</span></span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">Ï†</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">Ï†</span> <span class="main">âˆˆ</span> iso <span class="main">(</span>Rep_group <span class="skolem">G</span><span class="main">)</span> <span class="main">(</span>Rep_group <span class="skolem">H</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> group_iso_rel_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">Ï†'</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">Ï†'</span> <span class="main">âˆˆ</span> iso <span class="main">(</span>Rep_group <span class="skolem">H</span><span class="main">)</span> <span class="main">(</span>Rep_group <span class="skolem">G</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> group.iso_sym Rep_group
      <span class="keyword1"><span class="command">using</span></span> group.iso_set_sym <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
    <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"group_iso_rel <span class="skolem">H</span> <span class="skolem">G</span>"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> group_iso_rel_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">qed</span></span>
<span class="keyword1"><span class="command">next</span></span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"transp group_iso_rel"</span></span> 
  <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">rule</span> transpI<span class="main">)</span>
    <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">G</span> <span class="skolem">H</span> <span class="skolem">I</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'b</span> group"</span></span>
    <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"group_iso_rel <span class="skolem">G</span> <span class="skolem">H</span>"</span></span> <span class="quoted"><span class="quoted">"group_iso_rel <span class="skolem">H</span> <span class="skolem">I</span>"</span></span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">Ï†</span></span> <span class="skolem"><span class="skolem">Ïˆ</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">Ï†</span> <span class="main">âˆˆ</span> iso <span class="main">(</span>Rep_group <span class="skolem">G</span><span class="main">)</span> <span class="main">(</span>Rep_group <span class="skolem">H</span><span class="main">)</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">Ïˆ</span> <span class="main">âˆˆ</span> iso <span class="main">(</span>Rep_group <span class="skolem">H</span><span class="main">)</span> <span class="main">(</span>Rep_group <span class="skolem">I</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">unfolding</span></span> group_iso_rel_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">Ï€</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">Ï€</span> <span class="main">âˆˆ</span> iso <span class="main">(</span>Rep_group <span class="skolem">G</span><span class="main">)</span> <span class="main">(</span>Rep_group <span class="skolem">I</span><span class="main">)</span>"</span></span> 
      <span class="keyword1"><span class="command">using</span></span> iso_set_trans <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
    <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"group_iso_rel <span class="skolem">G</span> <span class="skolem">I</span>"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> group_iso_rel_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">qed</span></span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">â€¹This assigns to a given group the group isomorphism classâ€º</span></span>

<span class="keyword1"><span class="command">definition</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> group<span class="main">)</span> <span class="entity">iso_class</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'a</span> group_iso_class"</span></span>
  <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="free">iso_class</span> <span class="main">=</span> Abs_group_iso <span class="main">(</span>Abs_group <span class="main">(</span>monoid.truncate <span class="free">G</span><span class="main">)</span><span class="main">)</span>"</span></span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">â€¹Two isomorphic groups do indeed have the same isomorphism class:â€º</span></span>

<span class="keyword1" id="GroupIsoClasses-iso_classes_iff"><span class="command">lemma</span></span> iso_classes_iff<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"group <span class="free">G</span>"</span></span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"group <span class="free">H</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">âˆƒ</span><span class="bound">Ï†</span><span class="main">.</span> <span class="bound">Ï†</span> <span class="main">âˆˆ</span> iso <span class="free">G</span> <span class="free">H</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span>group.iso_class <span class="free">G</span> <span class="main">=</span> group.iso_class <span class="free">H</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">from</span></span> assms<span class="main">(</span>1<span class="main">,</span>2<span class="main">)</span> <span class="keyword1"><span class="command">have</span></span> groups<span class="main">:</span><span class="quoted"><span class="quoted">"group <span class="main">(</span>monoid.truncate <span class="free">G</span><span class="main">)</span>"</span></span> <span class="quoted"><span class="quoted">"group <span class="main">(</span>monoid.truncate <span class="free">H</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">unfolding</span></span> monoid.truncate_def group_def group_axioms_def Units_def monoid_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">âˆƒ</span><span class="bound">Ï†</span><span class="main">.</span> <span class="bound">Ï†</span> <span class="main">âˆˆ</span> iso <span class="free">G</span> <span class="free">H</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="main">âˆƒ</span><span class="bound">Ï†</span><span class="main">.</span> <span class="bound">Ï†</span> <span class="main">âˆˆ</span> iso <span class="main">(</span>monoid.truncate <span class="free">G</span><span class="main">)</span> <span class="main">(</span>monoid.truncate <span class="free">H</span><span class="main">)</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">unfolding</span></span> iso_def hom_def monoid.truncate_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">â€¦</span> <span class="main">=</span> group_iso_rel <span class="main">(</span>Abs_group <span class="main">(</span>monoid.truncate <span class="free">G</span><span class="main">)</span><span class="main">)</span> <span class="main">(</span>Abs_group <span class="main">(</span>monoid.truncate <span class="free">H</span><span class="main">)</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">unfolding</span></span> group_iso_rel_def <span class="keyword1"><span class="command">using</span></span> groups group.Abs_group_inverse <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> mem_Collect_eq<span class="main">)</span>
  <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">â€¦</span> <span class="main">=</span> <span class="main">(</span>group.iso_class <span class="free">G</span> <span class="main">=</span> group.iso_class <span class="free">H</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> group.iso_class_def assms group_iso_class.abs_eq_iff <span class="keyword1"><span class="command">by</span></span> <span class="operator">metis</span>
  <span class="keyword1"><span class="command">finally</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span><span class="keyword1"><span class="command">.</span></span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword2"><span class="keyword">end</span></span>
</pre>
</div><div id="JordanHolder">
<div class="head">
<h1>Theory JordanHolder</h1>
</div>
<pre class="source"><span class="comment1">(*  Title:      The Jordan-HÃ¶lder Theorem
    Author:     Jakob von Raumer, Karlsruhe Institute of Technology
    Maintainer: Jakob von Raumer &lt;jakob.raumer@student.kit.edu&gt;
*)</span>

<span class="keyword1"><span class="command">theory</span></span> JordanHolder
<span class="keyword2"><span class="keyword">imports</span></span>
  <a href="CompositionSeries.html">CompositionSeries</a>
  <a href="MaximalNormalSubgroups.html">MaximalNormalSubgroups</a>
  <span class="quoted">"<a href="../../HOL/HOL-Library/Multiset.html">HOL-Library.Multiset</a>"</span>
  <a href="GroupIsoClasses.html">GroupIsoClasses</a>
<span class="keyword2"><span class="keyword">begin</span></span>

<span class="keyword1"><span class="command">section</span></span> <span class="quoted"><span class="plain_text">â€¹The Jordan-H\"older Theoremâ€º</span></span>

<span class="keyword1"><span class="command">locale</span></span> jordan_hoelder <span class="main">=</span> group
  <span class="main">+</span> compâ„Œ<span class="main">?</span><span class="main">:</span> composition_series <span class="quoted"><span class="free">G</span></span> <span class="quoted"><span class="free">â„Œ</span></span>
  <span class="main">+</span> compğ”Š<span class="main">?</span><span class="main">:</span> composition_series <span class="quoted"><span class="free">G</span></span> <span class="quoted"><span class="free">ğ”Š</span></span> <span class="keyword2"><span class="keyword">for</span></span> <span class="free">â„Œ</span> <span class="keyword2"><span class="keyword">and</span></span> <span class="free">ğ”Š</span>
  <span class="main">+</span> <span class="keyword2"><span class="keyword">assumes</span></span> finite<span class="main">:</span><span class="quoted"><span class="quoted">"finite <span class="main">(</span>carrier <span class="free">G</span><span class="main">)</span>"</span></span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">â€¹Before we finally start the actual proof of the theorem, one last lemma: Cancelling
  the last entry of a normal series results in a normal series with quotients being all but the last
  of the original ones.â€º</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> normal_series<span class="main">)</span> quotients_butlast<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"length <span class="free">ğ”Š</span> <span class="main">&gt;</span> <span class="main">1</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"butlast quotients <span class="main">=</span> normal_series.quotients <span class="main">(</span><span class="free">G</span><span class="main">â¦‡</span>carrier <span class="main">:=</span> <span class="free">ğ”Š</span> <span class="main">!</span> <span class="main">(</span>length <span class="free">ğ”Š</span> <span class="main">-</span> <span class="main">1</span> <span class="main">-</span> <span class="main">1</span><span class="main">)</span><span class="main">â¦ˆ</span><span class="main">)</span> <span class="main">(</span>take <span class="main">(</span>length <span class="free">ğ”Š</span> <span class="main">-</span> <span class="main">1</span><span class="main">)</span> <span class="free">ğ”Š</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">rule</span> nth_equalityI <span class="main">)</span>
  <span class="keyword3"><span class="command">define</span></span> <span class="skolem"><span class="skolem">n</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">n</span> <span class="main">=</span> length <span class="free">ğ”Š</span> <span class="main">-</span> <span class="main">1</span>"</span></span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">n</span> <span class="main">=</span> length <span class="main">(</span>take <span class="skolem">n</span> <span class="free">ğ”Š</span><span class="main">)</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">n</span> <span class="main">&gt;</span> <span class="main">0</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">n</span> <span class="main">&lt;</span> length <span class="free">ğ”Š</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms notempty <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">interpret</span></span> normalğ”Šbutlast<span class="main">:</span> normal_series <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">G</span><span class="main">â¦‡</span>carrier <span class="main">:=</span> <span class="free">ğ”Š</span> <span class="main">!</span> <span class="main">(</span><span class="skolem">n</span> <span class="main">-</span> <span class="main">1</span><span class="main">)</span><span class="main">â¦ˆ</span><span class="main">)</span>"</span></span> <span class="quoted"><span class="quoted">"take <span class="skolem">n</span> <span class="free">ğ”Š</span>"</span></span> 
    <span class="keyword1"><span class="command">using</span></span> normal_series_prefix_closed <span class="quoted"><span class="quoted">â€¹<span class="skolem">n</span> <span class="main">&gt;</span> <span class="main">0</span>â€º</span></span> <span class="quoted"><span class="quoted">â€¹<span class="skolem">n</span> <span class="main">&lt;</span> length <span class="free">ğ”Š</span>â€º</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"length <span class="main">(</span>butlast quotients<span class="main">)</span> <span class="main">=</span> length quotients <span class="main">-</span> <span class="main">1</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> length_butlast<span class="main">)</span>
  <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">â€¦</span> <span class="main">=</span> length <span class="free">ğ”Š</span> <span class="main">-</span> <span class="main">1</span> <span class="main">-</span> <span class="main">1</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> add_diff_cancel_right' quotients_length<span class="main">)</span>
  <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">â€¦</span> <span class="main">=</span> length <span class="main">(</span>take <span class="skolem">n</span> <span class="free">ğ”Š</span><span class="main">)</span> <span class="main">-</span> <span class="main">1</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> <span class="quoted"><span class="quoted">â€¹<span class="skolem">n</span> <span class="main">=</span> length <span class="main">(</span>take <span class="skolem">n</span> <span class="free">ğ”Š</span><span class="main">)</span>â€º</span></span> n_def<span class="main">)</span>
  <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">â€¦</span> <span class="main">=</span> length normalğ”Šbutlast.quotients"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> normalğ”Šbutlast.quotients_length diff_add_inverse2<span class="main">)</span>
  <span class="keyword1"><span class="command">finally</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"length <span class="main">(</span>butlast quotients<span class="main">)</span> <span class="main">=</span> length normalğ”Šbutlast.quotients"</span></span> <span class="keyword1"><span class="command">.</span></span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">âˆ€</span><span class="bound"><span class="bound">i</span></span><span class="main">&lt;</span>length <span class="main">(</span>butlast quotients<span class="main">)</span><span class="main">.</span> butlast quotients <span class="main">!</span> <span class="bound">i</span> <span class="main">=</span> normalğ”Šbutlast.quotients <span class="main">!</span> <span class="bound">i</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="operator">auto</span>
    <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">i</span>
    <span class="keyword3"><span class="command">assume</span></span> i<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">i</span> <span class="main">&lt;</span> length quotients <span class="main">-</span> Suc <span class="main">0</span>"</span></span>
    <span class="keyword1"><span class="command">hence</span></span> i'<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">i</span> <span class="main">&lt;</span> length <span class="free">ğ”Š</span> <span class="main">-</span> <span class="main">1</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">i</span> <span class="main">&lt;</span> <span class="skolem">n</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">i</span> <span class="main">+</span> <span class="main">1</span> <span class="main">&lt;</span> <span class="skolem">n</span>"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> n_def <span class="keyword1"><span class="command">using</span></span> quotients_length <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">from</span></span> i <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"butlast quotients <span class="main">!</span> <span class="skolem">i</span> <span class="main">=</span> quotients <span class="main">!</span> <span class="skolem">i</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> One_nat_def length_butlast nth_butlast<span class="main">)</span>
    <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">â€¦</span> <span class="main">=</span> <span class="free">G</span><span class="main">â¦‡</span>carrier <span class="main">:=</span> <span class="free">ğ”Š</span> <span class="main">!</span> <span class="main">(</span><span class="skolem">i</span> <span class="main">+</span> <span class="main">1</span><span class="main">)</span><span class="main">â¦ˆ</span> <span class="keyword1">Mod</span> <span class="free">ğ”Š</span> <span class="main">!</span> <span class="skolem">i</span>"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> quotients_def <span class="keyword1"><span class="command">using</span></span> i'<span class="main">(</span>1<span class="main">)</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">â€¦</span> <span class="main">=</span> <span class="free">G</span><span class="main">â¦‡</span>carrier <span class="main">:=</span> <span class="main">(</span>take <span class="skolem">n</span> <span class="free">ğ”Š</span><span class="main">)</span> <span class="main">!</span> <span class="main">(</span><span class="skolem">i</span> <span class="main">+</span> <span class="main">1</span><span class="main">)</span><span class="main">â¦ˆ</span> <span class="keyword1">Mod</span> <span class="main">(</span>take <span class="skolem">n</span> <span class="free">ğ”Š</span><span class="main">)</span> <span class="main">!</span> <span class="skolem">i</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> i'<span class="main">(</span>2<span class="main">,</span>3<span class="main">)</span> nth_take <span class="keyword1"><span class="command">by</span></span> <span class="operator">metis</span>
    <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">â€¦</span> <span class="main">=</span> normalğ”Šbutlast.quotients <span class="main">!</span> <span class="skolem">i</span>"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> normalğ”Šbutlast.quotients_def <span class="keyword1"><span class="command">using</span></span> i' <span class="keyword1"><span class="command">by</span></span> <span class="operator">fastforce</span>
    <span class="keyword1"><span class="command">finally</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"butlast <span class="main">(</span>normal_series.quotients <span class="free">G</span> <span class="free">ğ”Š</span><span class="main">)</span> <span class="main">!</span> <span class="skolem">i</span> <span class="main">=</span> normal_series.quotients <span class="main">(</span><span class="free">G</span><span class="main">â¦‡</span>carrier <span class="main">:=</span> <span class="free">ğ”Š</span> <span class="main">!</span> <span class="main">(</span><span class="skolem">n</span> <span class="main">-</span> Suc <span class="main">0</span><span class="main">)</span><span class="main">â¦ˆ</span><span class="main">)</span> <span class="main">(</span>take <span class="skolem">n</span> <span class="free">ğ”Š</span><span class="main">)</span> <span class="main">!</span> <span class="skolem">i</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"<span class="main">â‹€</span><span class="bound">i</span><span class="main">.</span> <span class="bound">i</span> <span class="main">&lt;</span> length <span class="main">(</span>butlast quotients<span class="main">)</span> 
            <span class="main">âŸ¹</span> butlast quotients <span class="main">!</span> <span class="bound">i</span>
              <span class="main">=</span> normal_series.quotients <span class="main">(</span><span class="free">G</span><span class="main">â¦‡</span>carrier <span class="main">:=</span> <span class="free">ğ”Š</span> <span class="main">!</span> <span class="main">(</span>length <span class="free">ğ”Š</span> <span class="main">-</span> <span class="main">1</span> <span class="main">-</span> <span class="main">1</span><span class="main">)</span><span class="main">â¦ˆ</span><span class="main">)</span>  <span class="main">(</span>take <span class="main">(</span>length <span class="free">ğ”Š</span> <span class="main">-</span> <span class="main">1</span><span class="main">)</span> <span class="free">ğ”Š</span><span class="main">)</span> <span class="main">!</span> <span class="bound">i</span>"</span></span>
    <span class="keyword1"><span class="command">unfolding</span></span> n_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">â€¹The main part of the Jordan HÃ¶lder theorem is its statement about the uniqueness of 
  a composition series. Here, uniqueness up to reordering and isomorphism is modelled by stating
  that the multisets of isomorphism classes of all quotients are equal.â€º</span></span>

<span class="keyword1"><span class="command">theorem</span></span> jordan_hoelder_multisets<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"group <span class="free">G</span>"</span></span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"finite <span class="main">(</span>carrier <span class="free">G</span><span class="main">)</span>"</span></span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"composition_series <span class="free">G</span> <span class="free">ğ”Š</span>"</span></span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"composition_series <span class="free">G</span> <span class="free">â„Œ</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"mset <span class="main">(</span>map group.iso_class <span class="main">(</span>normal_series.quotients <span class="free">G</span> <span class="free">ğ”Š</span><span class="main">)</span><span class="main">)</span>
    <span class="main">=</span> mset <span class="main">(</span>map group.iso_class <span class="main">(</span>normal_series.quotients <span class="free">G</span> <span class="free">â„Œ</span><span class="main">)</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">using</span></span> assms
<span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">induction</span> <span class="quoted"><span class="quoted">"length <span class="free">ğ”Š</span>"</span></span> <span class="quasi_keyword">arbitrary</span><span class="main"><span class="main">:</span></span> <span class="quoted"><span class="free">ğ”Š</span></span> <span class="quoted"><span class="free">â„Œ</span></span> <span class="quoted"><span class="free">G</span></span> <span class="quasi_keyword">rule</span><span class="main"><span class="main">:</span></span> full_nat_induct<span class="main">)</span>
  <span class="keyword3"><span class="command">case</span></span> <span class="main">(</span>1 <span class="skolem">ğ”Š</span> <span class="skolem">â„Œ</span> <span class="skolem">G</span><span class="main">)</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">interpret</span></span> compğ”Š<span class="main">:</span> composition_series <span class="quoted"><span class="skolem">G</span></span> <span class="quoted"><span class="skolem">ğ”Š</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">from</span></span> 1 <span class="keyword1"><span class="command">interpret</span></span> compâ„Œ<span class="main">:</span> composition_series <span class="quoted"><span class="skolem">G</span></span> <span class="quoted"><span class="skolem">â„Œ</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">from</span></span> 1 <span class="keyword1"><span class="command">interpret</span></span> grpG<span class="main">:</span> group <span class="quoted"><span class="skolem">G</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?case</span></span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">cases</span> <span class="quoted"><span class="quoted">"length <span class="skolem">ğ”Š</span> <span class="main">â‰¤</span> <span class="numeral">2</span>"</span></span><span class="main">)</span>
  <span class="keyword1"><span class="command">next</span></span>
    <span class="keyword3"><span class="command">case</span></span> True
    <span class="keyword1"><span class="command">hence</span></span>  <span class="quoted"><span class="quoted">"length <span class="skolem">ğ”Š</span> <span class="main">=</span> <span class="main">0</span> <span class="main">âˆ¨</span> length <span class="skolem">ğ”Š</span> <span class="main">=</span> <span class="main">1</span> <span class="main">âˆ¨</span> length <span class="skolem">ğ”Š</span> <span class="main">=</span> <span class="numeral">2</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">arith</span>
    <span class="keyword1"><span class="command">with</span></span> compğ”Š.notempty <span class="keyword1"><span class="command">have</span></span>  <span class="quoted"><span class="quoted">"length <span class="skolem">ğ”Š</span> <span class="main">=</span> <span class="main">1</span> <span class="main">âˆ¨</span> length <span class="skolem">ğ”Š</span> <span class="main">=</span> <span class="numeral">2</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
    <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">del</span><span class="main"><span class="main">:</span></span> mset_map<span class="main">)</span>
      <span class="comment1">â€• â€¹First trivial case: <span class="antiquoted"><span class="antiquote">@{</span><span class="operator">text</span> <span class="raw_text">ğ”Š</span><span class="antiquote">}</span></span> is the trivial group.â€º</span>
      <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"length <span class="skolem">ğ”Š</span> <span class="main">=</span> Suc <span class="main">0</span>"</span></span>
      <span class="keyword1"><span class="command">hence</span></span> length<span class="main">:</span><span class="quoted"><span class="quoted">"length <span class="skolem">ğ”Š</span> <span class="main">=</span> <span class="main">1</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
      <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"length <span class="main">[]</span> <span class="main">+</span> <span class="main">1</span> <span class="main">=</span> length <span class="skolem">ğ”Š</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> length <span class="keyword1"><span class="command">have</span></span> charğ”Š<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">ğ”Š</span> <span class="main">=</span> <span class="main">[</span><span class="main">{</span><span class="main">ğŸ­</span><span class="hidden">â‡˜</span><sub><span class="skolem">G</span></sub><span class="hidden">â‡™</span><span class="main">}</span><span class="main">]</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> compğ”Š.composition_series_length_one<span class="main">)</span>
      <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"carrier <span class="skolem">G</span> <span class="main">=</span> <span class="main">{</span><span class="main">ğŸ­</span><span class="hidden">â‡˜</span><sub><span class="skolem">G</span></sub><span class="hidden">â‡™</span><span class="main">}</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> compğ”Š.composition_series_triv_group<span class="main">)</span>
      <span class="keyword1"><span class="command">with</span></span> length charğ”Š <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">ğ”Š</span> <span class="main">=</span> <span class="skolem">â„Œ</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> compâ„Œ.composition_series_triv_group <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
      <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">next</span></span>
      <span class="comment1">â€• â€¹Second trivial case: <span class="antiquoted"><span class="antiquote">@{</span><span class="operator">text</span> <span class="raw_text">ğ”Š</span><span class="antiquote">}</span></span> is simple.â€º</span>
      <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"length <span class="skolem">ğ”Š</span> <span class="main">=</span> <span class="numeral">2</span>"</span></span>
      <span class="keyword1"><span class="command">hence</span></span> ğ”Šchar<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">ğ”Š</span> <span class="main">=</span> <span class="main">[</span><span class="main">{</span><span class="main">ğŸ­</span><span class="hidden">â‡˜</span><sub><span class="skolem">G</span></sub><span class="hidden">â‡™</span><span class="main">}</span><span class="main">,</span> carrier <span class="skolem">G</span><span class="main">]</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> compğ”Š.length_two_unique<span class="main">)</span>
      <span class="keyword1"><span class="command">hence</span></span> simple<span class="main">:</span><span class="quoted"><span class="quoted">"simple_group <span class="skolem">G</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> compğ”Š.composition_series_simple_group<span class="main">)</span>
      <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">â„Œ</span> <span class="main">=</span> <span class="main">[</span><span class="main">{</span><span class="main">ğŸ­</span><span class="hidden">â‡˜</span><sub><span class="skolem">G</span></sub><span class="hidden">â‡™</span><span class="main">}</span><span class="main">,</span> carrier <span class="skolem">G</span><span class="main">]</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> compâ„Œ.composition_series_simple_group <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">with</span></span> ğ”Šchar <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">ğ”Š</span> <span class="main">=</span> <span class="skolem">â„Œ</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
      <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">next</span></span>
    <span class="keyword3"><span class="command">case</span></span> False
    <span class="comment1">â€• â€¹Non-trivial case: <span class="antiquoted"><span class="antiquote">@{</span><span class="operator">text</span> <span class="raw_text">ğ”Š</span><span class="antiquote">}</span></span> has length at least 3.â€º</span>
    <span class="keyword1"><span class="command">hence</span></span> length<span class="main">:</span><span class="quoted"><span class="quoted">"length <span class="skolem">ğ”Š</span> <span class="main">â‰¥</span> <span class="numeral">3</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="comment1">â€• â€¹First we show that <span class="antiquoted"><span class="antiquote">@{</span><span class="operator">text</span> <span class="raw_text">â„Œ</span><span class="antiquote">}</span></span> must have a length of at least 3.â€º</span>
    <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="main">Â¬</span> simple_group <span class="skolem">G</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> compğ”Š.composition_series_simple_group <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">â„Œ</span> <span class="main">â‰ </span> <span class="main">[</span><span class="main">{</span><span class="main">ğŸ­</span><span class="hidden">â‡˜</span><sub><span class="skolem">G</span></sub><span class="hidden">â‡™</span><span class="main">}</span><span class="main">,</span> carrier <span class="skolem">G</span><span class="main">]</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> compâ„Œ.composition_series_simple_group <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"length <span class="skolem">â„Œ</span> <span class="main">â‰ </span> <span class="numeral">2</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> compâ„Œ.length_two_unique <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> length <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"carrier <span class="skolem">G</span> <span class="main">â‰ </span> <span class="main">{</span><span class="main">ğŸ­</span><span class="hidden">â‡˜</span><sub><span class="skolem">G</span></sub><span class="hidden">â‡™</span><span class="main">}</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> compğ”Š.composition_series_length_one compğ”Š.composition_series_triv_group <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"length <span class="skolem">â„Œ</span> <span class="main">â‰ </span> <span class="main">1</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> compâ„Œ.composition_series_length_one compâ„Œ.composition_series_triv_group <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> compâ„Œ.notempty <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"length <span class="skolem">â„Œ</span> <span class="main">â‰ </span> <span class="main">0</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> lengthâ„Œbig<span class="main">:</span><span class="quoted"><span class="quoted">"length <span class="skolem">â„Œ</span> <span class="main">â‰¥</span> <span class="numeral">3</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> compâ„Œ.notempty <span class="keyword1"><span class="command">by</span></span> <span class="operator">arith</span>
    <span class="keyword3"><span class="command">define</span></span> <span class="skolem"><span class="skolem">m</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">m</span> <span class="main">=</span> length <span class="skolem">â„Œ</span> <span class="main">-</span> <span class="main">1</span>"</span></span>
    <span class="keyword3"><span class="command">define</span></span> <span class="skolem"><span class="skolem">n</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">n</span> <span class="main">=</span> length <span class="skolem">ğ”Š</span> <span class="main">-</span> <span class="main">1</span>"</span></span>
    <span class="keyword1"><span class="command">from</span></span> lengthâ„Œbig <span class="keyword1"><span class="command">have</span></span> m'<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">m</span> <span class="main">&gt;</span> <span class="main">0</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">m</span> <span class="main">&lt;</span> length <span class="skolem">â„Œ</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">m</span> <span class="main">-</span> <span class="main">1</span><span class="main">)</span> <span class="main">+</span> <span class="main">1</span> <span class="main">&lt;</span> length <span class="skolem">â„Œ</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">m</span> <span class="main">-</span> <span class="main">1</span> <span class="main">=</span> length <span class="skolem">â„Œ</span> <span class="main">-</span> <span class="numeral">2</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">m</span> <span class="main">-</span> <span class="main">1</span> <span class="main">+</span> <span class="main">1</span> <span class="main">=</span> length <span class="skolem">â„Œ</span> <span class="main">-</span> <span class="main">1</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">m</span> <span class="main">-</span> <span class="main">1</span> <span class="main">&lt;</span> length <span class="skolem">â„Œ</span>"</span></span>
      <span class="keyword1"><span class="command">unfolding</span></span> m_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">from</span></span> length <span class="keyword1"><span class="command">have</span></span> n'<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">n</span> <span class="main">&gt;</span> <span class="main">0</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">n</span> <span class="main">&lt;</span> length <span class="skolem">ğ”Š</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">n</span> <span class="main">-</span> <span class="main">1</span><span class="main">)</span> <span class="main">+</span> <span class="main">1</span> <span class="main">&lt;</span> length <span class="skolem">ğ”Š</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">n</span> <span class="main">-</span> <span class="main">1</span> <span class="main">&lt;</span> length <span class="skolem">ğ”Š</span>"</span></span> <span class="quoted"><span class="quoted">"Suc <span class="skolem">n</span> <span class="main">â‰¤</span> length <span class="skolem">ğ”Š</span>"</span></span>
     <span class="quoted"><span class="quoted">"<span class="skolem">n</span> <span class="main">-</span> <span class="main">1</span> <span class="main">=</span> length <span class="skolem">ğ”Š</span> <span class="main">-</span> <span class="numeral">2</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">n</span> <span class="main">-</span> <span class="main">1</span> <span class="main">+</span> <span class="main">1</span> <span class="main">=</span> length <span class="skolem">ğ”Š</span> <span class="main">-</span> <span class="main">1</span>"</span></span>  <span class="keyword1"><span class="command">unfolding</span></span> n_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword3"><span class="command">define</span></span> <span class="skolem"><span class="skolem">ğ”ŠPn</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">ğ”ŠPn</span> <span class="main">=</span> <span class="skolem">G</span><span class="main">â¦‡</span>carrier <span class="main">:=</span> <span class="skolem">ğ”Š</span> <span class="main">!</span> <span class="main">(</span><span class="skolem">n</span> <span class="main">-</span> <span class="main">1</span><span class="main">)</span><span class="main">â¦ˆ</span>"</span></span>
    <span class="keyword3"><span class="command">define</span></span> <span class="skolem"><span class="skolem">â„ŒPm</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">â„ŒPm</span> <span class="main">=</span> <span class="skolem">G</span><span class="main">â¦‡</span>carrier <span class="main">:=</span> <span class="skolem">â„Œ</span> <span class="main">!</span> <span class="main">(</span><span class="skolem">m</span> <span class="main">-</span> <span class="main">1</span><span class="main">)</span><span class="main">â¦ˆ</span>"</span></span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">interpret</span></span> grpğ”ŠPn<span class="main">:</span> group <span class="quoted"><span class="skolem">ğ”ŠPn</span></span> <span class="keyword1"><span class="command">unfolding</span></span> ğ”ŠPn_def <span class="keyword1"><span class="command">using</span></span> n' <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> compğ”Š.normal_series_subgroups compğ”Š.subgroup_imp_group<span class="main">)</span>
    <span class="keyword1"><span class="command">interpret</span></span> grpâ„ŒPm<span class="main">:</span> group <span class="quoted"><span class="skolem">â„ŒPm</span></span> <span class="keyword1"><span class="command">unfolding</span></span> â„ŒPm_def <span class="keyword1"><span class="command">using</span></span> m' compâ„Œ.normal_series_subgroups 1<span class="main">(</span>2<span class="main">)</span> group.subgroup_imp_group <span class="keyword1"><span class="command">by</span></span> <span class="operator">force</span>
    <span class="keyword1"><span class="command">have</span></span> finGbl<span class="main">:</span><span class="quoted"><span class="quoted">"finite <span class="main">(</span>carrier <span class="skolem">ğ”ŠPn</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">â€¹<span class="skolem">n</span> <span class="main">-</span> <span class="main">1</span> <span class="main">&lt;</span> length <span class="skolem">ğ”Š</span>â€º</span></span> 1<span class="main">(</span>3<span class="main">)</span> <span class="keyword1"><span class="command">unfolding</span></span> ğ”ŠPn_def <span class="keyword1"><span class="command">using</span></span> compğ”Š.normal_series_subgroups compğ”Š.subgroup_finite <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">have</span></span> finHbl<span class="main">:</span><span class="quoted"><span class="quoted">"finite <span class="main">(</span>carrier <span class="skolem">â„ŒPm</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">â€¹<span class="skolem">m</span> <span class="main">-</span> <span class="main">1</span> <span class="main">&lt;</span> length <span class="skolem">â„Œ</span>â€º</span></span> 1<span class="main">(</span>3<span class="main">)</span> <span class="keyword1"><span class="command">unfolding</span></span> â„ŒPm_def <span class="keyword1"><span class="command">using</span></span> compâ„Œ.normal_series_subgroups compğ”Š.subgroup_finite <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">have</span></span> quotsğ”Šnotempty<span class="main">:</span><span class="quoted"><span class="quoted">"compğ”Š.quotients <span class="main">â‰ </span> <span class="main">[]</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> compğ”Š.quotients_length length <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">have</span></span> quotsâ„Œnotempty<span class="main">:</span><span class="quoted"><span class="quoted">"compâ„Œ.quotients <span class="main">â‰ </span> <span class="main">[]</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> compâ„Œ.quotients_length lengthâ„Œbig <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    
    <span class="comment1">â€• â€¹Instantiate truncated composition series since they are used for both casesâ€º</span>
    <span class="keyword1"><span class="command">interpret</span></span> â„Œbutlast<span class="main">:</span> composition_series <span class="quoted"><span class="skolem">â„ŒPm</span></span> <span class="quoted"><span class="quoted">"take <span class="skolem">m</span> <span class="skolem">â„Œ</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> compâ„Œ.composition_series_prefix_closed m'<span class="main">(</span>1<span class="main">,</span>2<span class="main">)</span> â„ŒPm_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">interpret</span></span> ğ”Šbutlast<span class="main">:</span> composition_series <span class="quoted"><span class="skolem">ğ”ŠPn</span></span> <span class="quoted"><span class="quoted">"take <span class="skolem">n</span> <span class="skolem">ğ”Š</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> compğ”Š.composition_series_prefix_closed n'<span class="main">(</span>1<span class="main">,</span>2<span class="main">)</span> ğ”ŠPn_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">have</span></span> ltaken<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">n</span> <span class="main">=</span> length <span class="main">(</span>take <span class="skolem">n</span> <span class="skolem">ğ”Š</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> length_take n'<span class="main">(</span>2<span class="main">)</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">have</span></span> ltakem<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">m</span> <span class="main">=</span> length <span class="main">(</span>take <span class="skolem">m</span> <span class="skolem">â„Œ</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> length_take m'<span class="main">(</span>2<span class="main">)</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
    <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">cases</span> <span class="quoted"><span class="quoted">"<span class="skolem">â„Œ</span> <span class="main">!</span> <span class="main">(</span><span class="skolem">m</span> <span class="main">-</span> <span class="main">1</span><span class="main">)</span>  <span class="main">=</span> <span class="skolem">ğ”Š</span> <span class="main">!</span> <span class="main">(</span><span class="skolem">n</span> <span class="main">-</span> <span class="main">1</span><span class="main">)</span>"</span></span><span class="main">)</span>
      <span class="comment1">â€• â€¹If <span class="antiquoted"><span class="antiquote">@{</span><span class="operator">term</span> <span class="quoted">"<span class="skolem">â„Œ</span> <span class="main">!</span> <span class="main">(</span><span class="free">l</span> <span class="main">-</span> <span class="main">1</span><span class="main">)</span> <span class="main">=</span> <span class="skolem">ğ”Š</span> <span class="main">!</span> <span class="main">1</span>"</span><span class="antiquote">}</span></span>, everything is simple...â€º</span>
      <span class="keyword3"><span class="command">case</span></span> True
      <span class="comment1">â€• â€¹The last quotients of <span class="antiquoted"><span class="antiquote">@{</span><span class="operator">term</span> <span class="quoted"><span class="skolem">ğ”Š</span></span><span class="antiquote">}</span></span> and <span class="antiquoted"><span class="antiquote">@{</span><span class="operator">term</span> <span class="quoted"><span class="skolem">â„Œ</span></span><span class="antiquote">}</span></span> are equal.â€º</span>
      <span class="keyword1"><span class="command">have</span></span> lasteq<span class="main">:</span><span class="quoted"><span class="quoted">"last compğ”Š.quotients <span class="main">=</span> last compâ„Œ.quotients"</span></span>
      <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
        <span class="keyword1"><span class="command">from</span></span> length <span class="keyword1"><span class="command">have</span></span> lg<span class="main">:</span><span class="quoted"><span class="quoted">"length <span class="skolem">ğ”Š</span> <span class="main">-</span> <span class="main">1</span> <span class="main">-</span> <span class="main">1</span> <span class="main">+</span> <span class="main">1</span> <span class="main">=</span> length <span class="skolem">ğ”Š</span> <span class="main">-</span> <span class="main">1</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> Suc_diff_1 Suc_eq_plus1 n'<span class="main"><span class="main">(</span></span>1<span class="main"><span class="main">)</span></span> n_def<span class="main">)</span>
        <span class="keyword1"><span class="command">from</span></span> lengthâ„Œbig <span class="keyword1"><span class="command">have</span></span> lh<span class="main">:</span><span class="quoted"><span class="quoted">"length <span class="skolem">â„Œ</span> <span class="main">-</span> <span class="main">1</span> <span class="main">-</span> <span class="main">1</span> <span class="main">+</span> <span class="main">1</span> <span class="main">=</span> length <span class="skolem">â„Œ</span> <span class="main">-</span> <span class="main">1</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> Suc_diff_1 Suc_eq_plus1 <span class="quoted"><span class="quoted">â€¹<span class="main">0</span> <span class="main">&lt;</span> <span class="skolem">m</span>â€º</span></span> m_def<span class="main">)</span>
        <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"last compğ”Š.quotients <span class="main">=</span>  <span class="skolem">G</span> <span class="keyword1">Mod</span> <span class="skolem">ğ”Š</span> <span class="main">!</span> <span class="main">(</span><span class="skolem">n</span> <span class="main">-</span> <span class="main">1</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> length compğ”Š.last_quotient <span class="keyword1"><span class="command">unfolding</span></span> n_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">â€¦</span> <span class="main">=</span> <span class="skolem">G</span> <span class="keyword1">Mod</span> <span class="skolem">â„Œ</span> <span class="main">!</span> <span class="main">(</span><span class="skolem">m</span> <span class="main">-</span> <span class="main">1</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> True <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
        <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">â€¦</span> <span class="main">=</span> last compâ„Œ.quotients"</span></span> <span class="keyword1"><span class="command">using</span></span> lengthâ„Œbig compâ„Œ.last_quotient <span class="keyword1"><span class="command">unfolding</span></span> m_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword1"><span class="command">finally</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">.</span></span>
      <span class="keyword1"><span class="command">qed</span></span>
      <span class="keyword1"><span class="command">from</span></span> ltaken <span class="keyword1"><span class="command">have</span></span> ind<span class="main">:</span><span class="quoted"><span class="quoted">"mset <span class="main">(</span>map group.iso_class ğ”Šbutlast.quotients<span class="main">)</span> <span class="main">=</span> mset <span class="main">(</span>map group.iso_class â„Œbutlast.quotients<span class="main">)</span>"</span></span>
        <span class="keyword1"><span class="command">using</span></span> 1<span class="main">(</span>1<span class="main">)</span> True n'<span class="main">(</span>5<span class="main">)</span> grpğ”ŠPn.is_group finGbl ğ”Šbutlast.is_composition_series â„Œbutlast.is_composition_series <span class="keyword1"><span class="command">unfolding</span></span> ğ”ŠPn_def â„ŒPm_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">metis</span>
      <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"mset <span class="main">(</span>map group.iso_class compğ”Š.quotients<span class="main">)</span>
                    <span class="main">=</span> mset <span class="main">(</span>map group.iso_class <span class="main">(</span>butlast compğ”Š.quotients <span class="main">@</span> <span class="main">[</span>last compğ”Š.quotients<span class="main">]</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> quotsğ”Šnotempty<span class="main">)</span>
      <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">â€¦</span> <span class="main">=</span> mset <span class="main">(</span>map group.iso_class <span class="main">(</span>ğ”Šbutlast.quotients <span class="main">@</span> <span class="main">[</span>last <span class="main">(</span>compğ”Š.quotients<span class="main">)</span><span class="main">]</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> compğ”Š.quotients_butlast length <span class="keyword1"><span class="command">unfolding</span></span> n_def ğ”ŠPn_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">â€¦</span> <span class="main">=</span> mset <span class="main">(</span><span class="main">(</span>map group.iso_class ğ”Šbutlast.quotients<span class="main">)</span> <span class="main">@</span> <span class="main">[</span>group.iso_class <span class="main">(</span>last <span class="main">(</span>compğ”Š.quotients<span class="main">)</span><span class="main">)</span><span class="main">]</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">â€¦</span> <span class="main">=</span> mset <span class="main">(</span>map group.iso_class ğ”Šbutlast.quotients<span class="main">)</span> <span class="main">+</span> <span class="main">{#</span> group.iso_class <span class="main">(</span>last <span class="main">(</span>compğ”Š.quotients<span class="main">)</span><span class="main">)</span> <span class="main">#}</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">â€¦</span> <span class="main">=</span> mset <span class="main">(</span>map group.iso_class â„Œbutlast.quotients<span class="main">)</span> <span class="main">+</span> <span class="main">{#</span> group.iso_class <span class="main">(</span>last <span class="main">(</span>compğ”Š.quotients<span class="main">)</span><span class="main">)</span> <span class="main">#}</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> ind <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
      <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">â€¦</span> <span class="main">=</span> mset <span class="main">(</span>map group.iso_class â„Œbutlast.quotients<span class="main">)</span> <span class="main">+</span> <span class="main">{#</span> group.iso_class <span class="main">(</span>last <span class="main">(</span>compâ„Œ.quotients<span class="main">)</span><span class="main">)</span> <span class="main">#}</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> lasteq <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
      <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">â€¦</span> <span class="main">=</span> mset <span class="main">(</span><span class="main">(</span>map group.iso_class â„Œbutlast.quotients<span class="main">)</span> <span class="main">@</span> <span class="main">[</span>group.iso_class <span class="main">(</span>last <span class="main">(</span>compâ„Œ.quotients<span class="main">)</span><span class="main">)</span><span class="main">]</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">â€¦</span> <span class="main">=</span> mset <span class="main">(</span>map group.iso_class <span class="main">(</span>â„Œbutlast.quotients <span class="main">@</span> <span class="main">[</span>last <span class="main">(</span>compâ„Œ.quotients<span class="main">)</span><span class="main">]</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">â€¦</span> <span class="main">=</span> mset <span class="main">(</span>map group.iso_class <span class="main">(</span>butlast compâ„Œ.quotients <span class="main">@</span> <span class="main">[</span>last compâ„Œ.quotients<span class="main">]</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> lengthâ„Œbig compâ„Œ.quotients_butlast <span class="keyword1"><span class="command">unfolding</span></span> m_def â„ŒPm_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">â€¦</span> <span class="main">=</span> mset <span class="main">(</span>map group.iso_class compâ„Œ.quotients<span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> append_butlast_last_id quotsâ„Œnotempty <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
      <span class="keyword1"><span class="command">finally</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">.</span></span>
    <span class="keyword1"><span class="command">next</span></span>
      <span class="keyword3"><span class="command">case</span></span> False 
      <span class="keyword3"><span class="command">define</span></span> <span class="skolem"><span class="skolem">â„ŒPmIntğ”ŠPn</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">â„ŒPmIntğ”ŠPn</span> <span class="main">=</span> <span class="skolem">G</span><span class="main">â¦‡</span>carrier <span class="main">:=</span> <span class="skolem">â„Œ</span> <span class="main">!</span> <span class="main">(</span><span class="skolem">m</span> <span class="main">-</span> <span class="main">1</span><span class="main">)</span> <span class="main">âˆ©</span> <span class="skolem">ğ”Š</span> <span class="main">!</span> <span class="main">(</span><span class="skolem">n</span> <span class="main">-</span> <span class="main">1</span><span class="main">)</span><span class="main">â¦ˆ</span>"</span></span>
      <span class="keyword1"><span class="command">interpret</span></span> ğ”ŠPnmax<span class="main">:</span> max_normal_subgroup <span class="quoted"><span class="quoted">"<span class="skolem">ğ”Š</span> <span class="main">!</span> <span class="main">(</span><span class="skolem">n</span> <span class="main">-</span> <span class="main">1</span><span class="main">)</span>"</span></span> <span class="quoted"><span class="skolem">G</span></span> <span class="keyword1"><span class="command">unfolding</span></span> n_def
        <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> add_lessD1 diff_diff_add n'<span class="main"><span class="main">(</span></span>3<span class="main"><span class="main">)</span></span> add.commute one_add_one 1<span class="main"><span class="main">(</span></span>3<span class="main"><span class="main">)</span></span> compğ”Š.snd_to_last_max_normal<span class="main">)</span>
      <span class="keyword1"><span class="command">interpret</span></span> â„ŒPmmax<span class="main">:</span> max_normal_subgroup <span class="quoted"><span class="quoted">"<span class="skolem">â„Œ</span> <span class="main">!</span> <span class="main">(</span><span class="skolem">m</span> <span class="main">-</span> <span class="main">1</span><span class="main">)</span>"</span></span> <span class="quoted"><span class="skolem">G</span></span> <span class="keyword1"><span class="command">unfolding</span></span> m_def
        <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> add_lessD1 diff_diff_add m'<span class="main"><span class="main">(</span></span>3<span class="main"><span class="main">)</span></span> add.commute one_add_one 1<span class="main"><span class="main">(</span></span>3<span class="main"><span class="main">)</span></span> compâ„Œ.snd_to_last_max_normal<span class="main">)</span>
      <span class="keyword1"><span class="command">have</span></span> â„ŒPmnormG<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">â„Œ</span> <span class="main">!</span> <span class="main">(</span><span class="skolem">m</span> <span class="main">-</span> <span class="main">1</span><span class="main">)</span> <span class="main">âŠ²</span> <span class="skolem">G</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> compâ„Œ.normal_series_snd_to_last m'<span class="main">(</span>4<span class="main">)</span> <span class="keyword1"><span class="command">unfolding</span></span> m_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">have</span></span> ğ”ŠPnnormG<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">ğ”Š</span> <span class="main">!</span> <span class="main">(</span><span class="skolem">n</span> <span class="main">-</span> <span class="main">1</span><span class="main">)</span> <span class="main">âŠ²</span> <span class="skolem">G</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> compğ”Š.normal_series_snd_to_last n'<span class="main">(</span>6<span class="main">)</span> <span class="keyword1"><span class="command">unfolding</span></span> n_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">have</span></span> â„ŒPmintğ”ŠPnnormG<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">â„Œ</span> <span class="main">!</span> <span class="main">(</span><span class="skolem">m</span> <span class="main">-</span> <span class="main">1</span><span class="main">)</span> <span class="main">âˆ©</span> <span class="skolem">ğ”Š</span> <span class="main">!</span> <span class="main">(</span><span class="skolem">n</span> <span class="main">-</span> <span class="main">1</span><span class="main">)</span> <span class="main">âŠ²</span> <span class="skolem">G</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> â„ŒPmnormG ğ”ŠPnnormG <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> compğ”Š.normal_subgroup_intersect<span class="main">)</span>
      <span class="keyword1"><span class="command">have</span></span> Intnormğ”ŠPn<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">â„Œ</span> <span class="main">!</span> <span class="main">(</span><span class="skolem">m</span> <span class="main">-</span> <span class="main">1</span><span class="main">)</span> <span class="main">âˆ©</span> <span class="skolem">ğ”Š</span> <span class="main">!</span> <span class="main">(</span><span class="skolem">n</span> <span class="main">-</span> <span class="main">1</span><span class="main">)</span> <span class="main">âŠ²</span> <span class="skolem">ğ”ŠPn</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> ğ”ŠPnnormG â„ŒPmnormG Int_lower2 <span class="keyword1"><span class="command">unfolding</span></span> ğ”ŠPn_def
        <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> compğ”Š.normal_restrict_supergroup compğ”Š.normal_series_subgroups compğ”Š.normal_subgroup_intersect n'<span class="main"><span class="main">(</span></span>4<span class="main"><span class="main">)</span></span><span class="main">)</span>
      <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">interpret</span></span> grpğ”ŠPnModâ„ŒPmintğ”ŠPn<span class="main">:</span> group <span class="quoted"><span class="quoted">"<span class="skolem">ğ”ŠPn</span> <span class="keyword1">Mod</span> <span class="skolem">â„Œ</span> <span class="main">!</span> <span class="main">(</span><span class="skolem">m</span> <span class="main">-</span> <span class="main">1</span><span class="main">)</span> <span class="main">âˆ©</span> <span class="skolem">ğ”Š</span> <span class="main">!</span> <span class="main">(</span><span class="skolem">n</span> <span class="main">-</span> <span class="main">1</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> normal.factorgroup_is_group<span class="main">)</span>
      <span class="keyword1"><span class="command">have</span></span> Intnormâ„ŒPm<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">â„Œ</span> <span class="main">!</span> <span class="main">(</span><span class="skolem">m</span> <span class="main">-</span> <span class="main">1</span><span class="main">)</span> <span class="main">âˆ©</span> <span class="skolem">ğ”Š</span> <span class="main">!</span> <span class="main">(</span><span class="skolem">n</span> <span class="main">-</span> <span class="main">1</span><span class="main">)</span> <span class="main">âŠ²</span> <span class="skolem">â„ŒPm</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> â„ŒPmnormG ğ”ŠPnnormG Int_lower2 Int_commute <span class="keyword1"><span class="command">unfolding</span></span> â„ŒPm_def
        <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> compğ”Š.normal_restrict_supergroup compğ”Š.normal_subgroup_intersect compâ„Œ.normal_series_subgroups m'<span class="main"><span class="main">(</span></span>6<span class="main"><span class="main">)</span></span><span class="main">)</span>
      <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">interpret</span></span> grpâ„ŒPmModâ„ŒPmintğ”ŠPn<span class="main">:</span> group <span class="quoted"><span class="quoted">"<span class="skolem">â„ŒPm</span> <span class="keyword1">Mod</span> <span class="skolem">â„Œ</span> <span class="main">!</span> <span class="main">(</span><span class="skolem">m</span> <span class="main">-</span> <span class="main">1</span><span class="main">)</span> <span class="main">âˆ©</span> <span class="skolem">ğ”Š</span> <span class="main">!</span> <span class="main">(</span><span class="skolem">n</span> <span class="main">-</span> <span class="main">1</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> normal.factorgroup_is_group<span class="main">)</span>

      <span class="comment1">â€• â€¹Show that the second to last entries are not contained in each other.â€º</span>
      <span class="keyword1"><span class="command">have</span></span> notâ„ŒPmSubğ”ŠPn<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="main">Â¬</span> <span class="main">(</span><span class="skolem">â„Œ</span> <span class="main">!</span> <span class="main">(</span><span class="skolem">m</span> <span class="main">-</span> <span class="main">1</span><span class="main">)</span> <span class="main">âŠ†</span> <span class="skolem">ğ”Š</span> <span class="main">!</span> <span class="main">(</span><span class="skolem">n</span> <span class="main">-</span> <span class="main">1</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> â„ŒPmmax.max_normal ğ”ŠPnnormG False<span class="main">[</span><span class="operator">symmetric</span><span class="main">]</span> ğ”ŠPnmax.proper <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
      <span class="keyword1"><span class="command">have</span></span> notğ”ŠPnSubâ„ŒPm<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="main">Â¬</span> <span class="main">(</span><span class="skolem">ğ”Š</span> <span class="main">!</span> <span class="main">(</span><span class="skolem">n</span> <span class="main">-</span> <span class="main">1</span><span class="main">)</span> <span class="main">âŠ†</span> <span class="skolem">â„Œ</span> <span class="main">!</span> <span class="main">(</span><span class="skolem">m</span> <span class="main">-</span> <span class="main">1</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> ğ”ŠPnmax.max_normal â„ŒPmnormG False â„ŒPmmax.proper <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
      
      <span class="comment1">â€• â€¹Show that <span class="antiquoted"><span class="antiquote">@{</span><span class="operator">term</span> <span class="quoted">"<span class="skolem">G</span> <span class="keyword1">Mod</span> <span class="main">(</span><span class="skolem">â„Œ</span> <span class="main">!</span> <span class="main">(</span><span class="skolem">m</span> <span class="main">-</span> <span class="main">1</span><span class="main">)</span> <span class="main">âˆ©</span> <span class="skolem">ğ”Š</span> <span class="main">!</span> <span class="main">(</span><span class="skolem">n</span> <span class="main">-</span> <span class="main">1</span><span class="main">)</span><span class="main">)</span>"</span><span class="antiquote">}</span></span> is a simple group.â€º</span>
      <span class="keyword1"><span class="command">have</span></span> â„ŒPmSubSetmult<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">â„Œ</span> <span class="main">!</span> <span class="main">(</span><span class="skolem">m</span> <span class="main">-</span> <span class="main">1</span><span class="main">)</span> <span class="main">âŠ†</span> <span class="skolem">â„Œ</span> <span class="main">!</span> <span class="main">(</span><span class="skolem">m</span> <span class="main">-</span> <span class="main">1</span><span class="main">)</span> <span class="main">&lt;#&gt;</span><span class="hidden">â‡˜</span><sub><span class="skolem">G</span></sub><span class="hidden">â‡™</span> <span class="skolem">ğ”Š</span> <span class="main">!</span> <span class="main">(</span><span class="skolem">n</span> <span class="main">-</span> <span class="main">1</span><span class="main">)</span>"</span></span>
        <span class="keyword1"><span class="command">using</span></span> second_isomorphism_grp.H_contained_in_set_mult ğ”ŠPnmax.is_normal â„ŒPmnormG normal_imp_subgroup
        <span class="keyword1"><span class="command">unfolding</span></span> second_isomorphism_grp_def second_isomorphism_grp_axioms_def max_normal_subgroup_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">metis</span>
      <span class="keyword1"><span class="command">have</span></span> ğ”ŠPnSubSetmult<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">ğ”Š</span> <span class="main">!</span> <span class="main">(</span><span class="skolem">n</span> <span class="main">-</span> <span class="main">1</span><span class="main">)</span> <span class="main">âŠ†</span> <span class="skolem">â„Œ</span> <span class="main">!</span> <span class="main">(</span><span class="skolem">m</span> <span class="main">-</span> <span class="main">1</span><span class="main">)</span> <span class="main">&lt;#&gt;</span><span class="hidden">â‡˜</span><sub><span class="skolem">G</span></sub><span class="hidden">â‡™</span> <span class="skolem">ğ”Š</span> <span class="main">!</span> <span class="main">(</span><span class="skolem">n</span> <span class="main">-</span> <span class="main">1</span><span class="main">)</span>"</span></span>
        <span class="keyword1"><span class="command">using</span></span> second_isomorphism_grp.S_contained_in_set_mult ğ”ŠPnmax.is_normal â„ŒPmnormG normal_imp_subgroup
        <span class="keyword1"><span class="command">unfolding</span></span> second_isomorphism_grp_def second_isomorphism_grp_axioms_def max_normal_subgroup_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">metis</span>
      <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">ğ”Š</span> <span class="main">!</span> <span class="main">(</span><span class="skolem">n</span> <span class="main">-</span> <span class="main">1</span><span class="main">)</span> <span class="main">â‰ </span> <span class="main">(</span><span class="skolem">â„Œ</span> <span class="main">!</span> <span class="main">(</span><span class="skolem">m</span> <span class="main">-</span> <span class="main">1</span><span class="main">)</span><span class="main">)</span> <span class="main">&lt;#&gt;</span><span class="hidden">â‡˜</span><sub><span class="skolem">G</span></sub><span class="hidden">â‡™</span> <span class="main">(</span><span class="skolem">ğ”Š</span> <span class="main">!</span> <span class="main">(</span><span class="skolem">n</span> <span class="main">-</span> <span class="main">1</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> â„ŒPmSubSetmult notâ„ŒPmSubğ”ŠPn <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">hence</span></span> set_multG<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">â„Œ</span> <span class="main">!</span> <span class="main">(</span><span class="skolem">m</span> <span class="main">-</span> <span class="main">1</span><span class="main">)</span><span class="main">)</span> <span class="main">&lt;#&gt;</span><span class="hidden">â‡˜</span><sub><span class="skolem">G</span></sub><span class="hidden">â‡™</span> <span class="main">(</span><span class="skolem">ğ”Š</span> <span class="main">!</span> <span class="main">(</span><span class="skolem">n</span> <span class="main">-</span> <span class="main">1</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> carrier <span class="skolem">G</span>"</span></span>
        <span class="keyword1"><span class="command">using</span></span> ğ”ŠPnmax.max_normal ğ”ŠPnmax.is_normal â„ŒPmnormG compğ”Š.normal_subgroup_set_mult_closed ğ”ŠPnSubSetmult <span class="keyword1"><span class="command">by</span></span> <span class="operator">metis</span>
      <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">Ï†</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">Ï†</span> <span class="main">âˆˆ</span> iso <span class="main">(</span><span class="skolem">ğ”ŠPn</span> <span class="keyword1">Mod</span> <span class="main">(</span><span class="skolem">â„Œ</span> <span class="main">!</span> <span class="main">(</span><span class="skolem">m</span> <span class="main">-</span> <span class="main">1</span><span class="main">)</span> <span class="main">âˆ©</span> <span class="skolem">ğ”Š</span> <span class="main">!</span> <span class="main">(</span><span class="skolem">n</span> <span class="main">-</span> <span class="main">1</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">(</span><span class="skolem">G</span><span class="main">â¦‡</span>carrier <span class="main">:=</span> carrier <span class="skolem">G</span><span class="main">â¦ˆ</span> <span class="keyword1">Mod</span> <span class="skolem">â„Œ</span> <span class="main">!</span> <span class="main">(</span><span class="skolem">m</span> <span class="main">-</span> <span class="main">1</span><span class="main">)</span><span class="main">)</span>"</span></span>
        <span class="keyword1"><span class="command">using</span></span> second_isomorphism_grp.normal_intersection_quotient_isom â„ŒPmnormG ğ”ŠPnmax.is_normal normal_imp_subgroup
        <span class="keyword1"><span class="command">unfolding</span></span> second_isomorphism_grp_def second_isomorphism_grp_axioms_def max_normal_subgroup_def ğ”ŠPn_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">metis</span>
      <span class="keyword1"><span class="command">hence</span></span> Ï†<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">Ï†</span> <span class="main">âˆˆ</span> iso <span class="main">(</span><span class="skolem">ğ”ŠPn</span> <span class="keyword1">Mod</span> <span class="main">(</span><span class="skolem">â„Œ</span> <span class="main">!</span> <span class="main">(</span><span class="skolem">m</span> <span class="main">-</span> <span class="main">1</span><span class="main">)</span> <span class="main">âˆ©</span> <span class="skolem">ğ”Š</span> <span class="main">!</span> <span class="main">(</span><span class="skolem">n</span> <span class="main">-</span> <span class="main">1</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">(</span><span class="skolem">G</span> <span class="keyword1">Mod</span> <span class="skolem">â„Œ</span> <span class="main">!</span> <span class="main">(</span><span class="skolem">m</span> <span class="main">-</span> <span class="main">1</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">Ï†2</span></span> <span class="keyword2"><span class="keyword">where</span></span> Ï†2<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">Ï†2</span> <span class="main">âˆˆ</span> iso <span class="main">(</span><span class="skolem">G</span> <span class="keyword1">Mod</span> <span class="skolem">â„Œ</span> <span class="main">!</span> <span class="main">(</span><span class="skolem">m</span> <span class="main">-</span> <span class="main">1</span><span class="main">)</span><span class="main">)</span> <span class="main">(</span><span class="skolem">ğ”ŠPn</span> <span class="keyword1">Mod</span> <span class="main">(</span><span class="skolem">â„Œ</span> <span class="main">!</span> <span class="main">(</span><span class="skolem">m</span> <span class="main">-</span> <span class="main">1</span><span class="main">)</span> <span class="main">âˆ©</span> <span class="skolem">ğ”Š</span> <span class="main">!</span> <span class="main">(</span><span class="skolem">n</span> <span class="main">-</span> <span class="main">1</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span>
        <span class="keyword1"><span class="command">using</span></span> group.iso_set_sym grpğ”ŠPnModâ„ŒPmintğ”ŠPn.is_group <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"simple_group <span class="main">(</span><span class="skolem">G</span><span class="main">â¦‡</span>carrier <span class="main">:=</span> <span class="skolem">â„Œ</span> <span class="main">!</span> <span class="main">(</span><span class="skolem">m</span> <span class="main">-</span> <span class="main">1</span> <span class="main">+</span> <span class="main">1</span><span class="main">)</span><span class="main">â¦ˆ</span> <span class="keyword1">Mod</span> <span class="skolem">â„Œ</span> <span class="main">!</span> <span class="main">(</span><span class="skolem">m</span> <span class="main">-</span> <span class="main">1</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> compâ„Œ.simplefact m'<span class="main">(</span>3<span class="main">)</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
      <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"simple_group <span class="main">(</span><span class="skolem">G</span> <span class="keyword1">Mod</span> <span class="skolem">â„Œ</span> <span class="main">!</span> <span class="main">(</span><span class="skolem">m</span> <span class="main">-</span> <span class="main">1</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> compâ„Œ.last last_conv_nth compâ„Œ.notempty m'<span class="main">(</span>5<span class="main">)</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">fastforce</span>
      <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> simpleğ”ŠPnModInt<span class="main">:</span><span class="quoted"><span class="quoted">"simple_group <span class="main">(</span><span class="skolem">ğ”ŠPn</span> <span class="keyword1">Mod</span> <span class="main">(</span><span class="skolem">â„Œ</span> <span class="main">!</span> <span class="main">(</span><span class="skolem">m</span> <span class="main">-</span> <span class="main">1</span><span class="main">)</span> <span class="main">âˆ©</span> <span class="skolem">ğ”Š</span> <span class="main">!</span> <span class="main">(</span><span class="skolem">n</span> <span class="main">-</span> <span class="main">1</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span>
        <span class="keyword1"><span class="command">using</span></span> simple_group.iso_simple grpğ”ŠPnModâ„ŒPmintğ”ŠPn.is_group <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">interpret</span></span> grpGModâ„ŒPm<span class="main">:</span> group <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">G</span> <span class="keyword1">Mod</span> <span class="skolem">â„Œ</span> <span class="main">!</span> <span class="main">(</span><span class="skolem">m</span> <span class="main">-</span> <span class="main">1</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> â„ŒPmnormG normal.factorgroup_is_group<span class="main">)</span>

      <span class="comment1">â€• â€¹Show analogues of the previous statements for <span class="antiquoted"><span class="antiquote">@{</span><span class="operator">term</span> <span class="quoted">"<span class="skolem">â„Œ</span> <span class="main">!</span> <span class="main">(</span><span class="skolem">m</span> <span class="main">-</span> <span class="main">1</span><span class="main">)</span>"</span><span class="antiquote">}</span></span> instead of <span class="antiquoted"><span class="antiquote">@{</span><span class="operator">term</span> <span class="quoted">"<span class="skolem">ğ”Š</span> <span class="main">!</span> <span class="main">(</span><span class="skolem">n</span> <span class="main">-</span> <span class="main">1</span><span class="main">)</span>"</span><span class="antiquote">}</span></span>.â€º</span>
      <span class="keyword1"><span class="command">have</span></span> â„ŒPmSubSetmult'<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">â„Œ</span> <span class="main">!</span> <span class="main">(</span><span class="skolem">m</span> <span class="main">-</span> <span class="main">1</span><span class="main">)</span> <span class="main">âŠ†</span> <span class="skolem">ğ”Š</span> <span class="main">!</span> <span class="main">(</span><span class="skolem">n</span> <span class="main">-</span> <span class="main">1</span><span class="main">)</span> <span class="main">&lt;#&gt;</span><span class="hidden">â‡˜</span><sub><span class="skolem">G</span></sub><span class="hidden">â‡™</span> <span class="skolem">â„Œ</span> <span class="main">!</span> <span class="main">(</span><span class="skolem">m</span> <span class="main">-</span> <span class="main">1</span><span class="main">)</span>"</span></span>
        <span class="keyword1"><span class="command">using</span></span> second_isomorphism_grp.S_contained_in_set_mult ğ”ŠPnmax.is_normal â„ŒPmnormG normal_imp_subgroup
        <span class="keyword1"><span class="command">unfolding</span></span> second_isomorphism_grp_def second_isomorphism_grp_axioms_def max_normal_subgroup_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">metis</span>
      <span class="keyword1"><span class="command">have</span></span> ğ”ŠPnSubSetmult'<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">ğ”Š</span> <span class="main">!</span> <span class="main">(</span><span class="skolem">n</span> <span class="main">-</span> <span class="main">1</span><span class="main">)</span> <span class="main">âŠ†</span> <span class="skolem">ğ”Š</span> <span class="main">!</span> <span class="main">(</span><span class="skolem">n</span> <span class="main">-</span> <span class="main">1</span><span class="main">)</span> <span class="main">&lt;#&gt;</span><span class="hidden">â‡˜</span><sub><span class="skolem">G</span></sub><span class="hidden">â‡™</span> <span class="skolem">â„Œ</span> <span class="main">!</span> <span class="main">(</span><span class="skolem">m</span> <span class="main">-</span> <span class="main">1</span><span class="main">)</span>"</span></span>
        <span class="keyword1"><span class="command">using</span></span> second_isomorphism_grp.H_contained_in_set_mult ğ”ŠPnmax.is_normal â„ŒPmnormG normal_imp_subgroup
        <span class="keyword1"><span class="command">unfolding</span></span> second_isomorphism_grp_def second_isomorphism_grp_axioms_def max_normal_subgroup_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">metis</span>
      <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">â„Œ</span> <span class="main">!</span> <span class="main">(</span><span class="skolem">m</span> <span class="main">-</span> <span class="main">1</span><span class="main">)</span> <span class="main">â‰ </span> <span class="main">(</span><span class="skolem">ğ”Š</span> <span class="main">!</span> <span class="main">(</span><span class="skolem">n</span> <span class="main">-</span> <span class="main">1</span><span class="main">)</span><span class="main">)</span> <span class="main">&lt;#&gt;</span><span class="hidden">â‡˜</span><sub><span class="skolem">G</span></sub><span class="hidden">â‡™</span> <span class="main">(</span><span class="skolem">â„Œ</span> <span class="main">!</span> <span class="main">(</span><span class="skolem">m</span> <span class="main">-</span> <span class="main">1</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> ğ”ŠPnSubSetmult' notğ”ŠPnSubâ„ŒPm <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">hence</span></span> set_multG<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">ğ”Š</span> <span class="main">!</span> <span class="main">(</span><span class="skolem">n</span> <span class="main">-</span> <span class="main">1</span><span class="main">)</span><span class="main">)</span> <span class="main">&lt;#&gt;</span><span class="hidden">â‡˜</span><sub><span class="skolem">G</span></sub><span class="hidden">â‡™</span> <span class="main">(</span><span class="skolem">â„Œ</span> <span class="main">!</span> <span class="main">(</span><span class="skolem">m</span> <span class="main">-</span> <span class="main">1</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> carrier <span class="skolem">G</span>"</span></span>
        <span class="keyword1"><span class="command">using</span></span> â„ŒPmmax.max_normal â„ŒPmmax.is_normal ğ”ŠPnnormG compğ”Š.normal_subgroup_set_mult_closed â„ŒPmSubSetmult' <span class="keyword1"><span class="command">by</span></span> <span class="operator">metis</span>
      <span class="keyword1"><span class="command">from</span></span> set_multG <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">Ïˆ</span></span> <span class="keyword2"><span class="keyword">where</span></span> 
            <span class="quoted"><span class="quoted">"<span class="skolem">Ïˆ</span> <span class="main">âˆˆ</span> iso <span class="main">(</span><span class="skolem">â„ŒPm</span> <span class="keyword1">Mod</span> <span class="main">(</span><span class="skolem">ğ”Š</span> <span class="main">!</span> <span class="main">(</span><span class="skolem">n</span> <span class="main">-</span> <span class="main">1</span><span class="main">)</span> <span class="main">âˆ©</span> <span class="skolem">â„Œ</span> <span class="main">!</span> <span class="main">(</span><span class="skolem">m</span> <span class="main">-</span> <span class="main">1</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">(</span><span class="skolem">G</span><span class="main">â¦‡</span>carrier <span class="main">:=</span> carrier <span class="skolem">G</span><span class="main">â¦ˆ</span> <span class="keyword1">Mod</span> <span class="skolem">ğ”Š</span> <span class="main">!</span> <span class="main">(</span><span class="skolem">n</span> <span class="main">-</span> <span class="main">1</span><span class="main">)</span><span class="main">)</span>"</span></span>
        <span class="keyword1"><span class="command">using</span></span> second_isomorphism_grp.normal_intersection_quotient_isom ğ”ŠPnnormG â„ŒPmmax.is_normal normal_imp_subgroup
        <span class="keyword1"><span class="command">unfolding</span></span> second_isomorphism_grp_def second_isomorphism_grp_axioms_def max_normal_subgroup_def â„ŒPm_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">metis</span>
      <span class="keyword1"><span class="command">hence</span></span> Ïˆ<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">Ïˆ</span> <span class="main">âˆˆ</span> iso <span class="main">(</span><span class="skolem">â„ŒPm</span> <span class="keyword1">Mod</span> <span class="main">(</span><span class="skolem">â„Œ</span> <span class="main">!</span> <span class="main">(</span><span class="skolem">m</span> <span class="main">-</span> <span class="main">1</span><span class="main">)</span> <span class="main">âˆ©</span> <span class="main">(</span><span class="skolem">ğ”Š</span> <span class="main">!</span> <span class="main">(</span><span class="skolem">n</span> <span class="main">-</span> <span class="main">1</span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">(</span><span class="skolem">G</span><span class="main">â¦‡</span>carrier <span class="main">:=</span> carrier <span class="skolem">G</span><span class="main">â¦ˆ</span> <span class="keyword1">Mod</span> <span class="skolem">ğ”Š</span> <span class="main">!</span> <span class="main">(</span><span class="skolem">n</span> <span class="main">-</span> <span class="main">1</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> Int_commute <span class="keyword1"><span class="command">by</span></span> <span class="operator">metis</span>
      <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">Ïˆ2</span></span> <span class="keyword2"><span class="keyword">where</span></span>
             Ïˆ2<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">Ïˆ2</span> <span class="main">âˆˆ</span> iso <span class="main">(</span><span class="skolem">G</span> <span class="keyword1">Mod</span> <span class="skolem">ğ”Š</span> <span class="main">!</span> <span class="main">(</span><span class="skolem">n</span> <span class="main">-</span> <span class="main">1</span><span class="main">)</span><span class="main">)</span> <span class="main">(</span><span class="skolem">â„ŒPm</span> <span class="keyword1">Mod</span> <span class="main">(</span><span class="skolem">â„Œ</span> <span class="main">!</span> <span class="main">(</span><span class="skolem">m</span> <span class="main">-</span> <span class="main">1</span><span class="main">)</span> <span class="main">âˆ©</span> <span class="skolem">ğ”Š</span> <span class="main">!</span> <span class="main">(</span><span class="skolem">n</span> <span class="main">-</span> <span class="main">1</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span>
        <span class="keyword1"><span class="command">using</span></span> group.iso_set_sym grpâ„ŒPmModâ„ŒPmintğ”ŠPn.is_group <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"simple_group <span class="main">(</span><span class="skolem">G</span><span class="main">â¦‡</span>carrier <span class="main">:=</span> <span class="skolem">ğ”Š</span> <span class="main">!</span> <span class="main">(</span><span class="skolem">n</span> <span class="main">-</span> <span class="main">1</span> <span class="main">+</span> <span class="main">1</span><span class="main">)</span><span class="main">â¦ˆ</span> <span class="keyword1">Mod</span> <span class="skolem">ğ”Š</span> <span class="main">!</span> <span class="main">(</span><span class="skolem">n</span> <span class="main">-</span> <span class="main">1</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> compğ”Š.simplefact n'<span class="main">(</span>3<span class="main">)</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
      <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"simple_group <span class="main">(</span><span class="skolem">G</span> <span class="keyword1">Mod</span> <span class="skolem">ğ”Š</span> <span class="main">!</span> <span class="main">(</span><span class="skolem">n</span> <span class="main">-</span> <span class="main">1</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> compğ”Š.last last_conv_nth compğ”Š.notempty n'<span class="main">(</span>7<span class="main">)</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">fastforce</span>
      <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> simpleâ„ŒPmModInt<span class="main">:</span><span class="quoted"><span class="quoted">"simple_group <span class="main">(</span><span class="skolem">â„ŒPm</span> <span class="keyword1">Mod</span> <span class="main">(</span><span class="skolem">â„Œ</span> <span class="main">!</span> <span class="main">(</span><span class="skolem">m</span> <span class="main">-</span> <span class="main">1</span><span class="main">)</span> <span class="main">âˆ©</span> <span class="skolem">ğ”Š</span> <span class="main">!</span> <span class="main">(</span><span class="skolem">n</span> <span class="main">-</span> <span class="main">1</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span> 
        <span class="keyword1"><span class="command">using</span></span> simple_group.iso_simple grpâ„ŒPmModâ„ŒPmintğ”ŠPn.is_group <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">interpret</span></span> grpGModğ”ŠPn<span class="main">:</span> group <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">G</span> <span class="keyword1">Mod</span> <span class="skolem">ğ”Š</span> <span class="main">!</span> <span class="main">(</span><span class="skolem">n</span> <span class="main">-</span> <span class="main">1</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> ğ”ŠPnnormG normal.factorgroup_is_group<span class="main">)</span>
      
      <span class="comment1">â€• â€¹Instantiate several composition series used to build up the equality of quotient multisets.â€º</span>
      <span class="keyword3"><span class="command">define</span></span> <span class="skolem"><span class="skolem">ğ”</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">ğ”</span> <span class="main">=</span> remdups_adj <span class="main">(</span>map <span class="main">(</span><span class="main">(âˆ©)</span> <span class="main">(</span><span class="skolem">â„Œ</span> <span class="main">!</span> <span class="main">(</span><span class="skolem">m</span> <span class="main">-</span> <span class="main">1</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="skolem">ğ”Š</span><span class="main">)</span>"</span></span>
      <span class="keyword3"><span class="command">define</span></span> <span class="skolem"><span class="skolem">ğ”</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">ğ”</span> <span class="main">=</span> remdups_adj <span class="main">(</span>map <span class="main">(</span><span class="main">(âˆ©)</span> <span class="main">(</span><span class="skolem">ğ”Š</span> <span class="main">!</span> <span class="main">(</span><span class="skolem">n</span> <span class="main">-</span> <span class="main">1</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="skolem">â„Œ</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">interpret</span></span> ğ”<span class="main">:</span> composition_series <span class="quoted"><span class="skolem">â„ŒPm</span></span> <span class="quoted"><span class="skolem">ğ”</span></span> <span class="keyword1"><span class="command">using</span></span> compğ”Š.intersect_normal 1<span class="main">(</span>3<span class="main">)</span> â„ŒPmnormG <span class="keyword1"><span class="command">unfolding</span></span> ğ”_def â„ŒPm_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">interpret</span></span> ğ”<span class="main">:</span> composition_series <span class="quoted"><span class="skolem">ğ”ŠPn</span></span> <span class="quoted"><span class="skolem">ğ”</span></span> <span class="keyword1"><span class="command">using</span></span> compâ„Œ.intersect_normal 1<span class="main">(</span>3<span class="main">)</span> ğ”ŠPnnormG <span class="keyword1"><span class="command">unfolding</span></span> ğ”_def ğ”ŠPn_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>


      <span class="comment1">â€• â€¹Apply the induction hypothesis on <span class="antiquoted"><span class="antiquote">@{</span><span class="operator">text</span> <span class="raw_text">ğ”Šbutlast</span><span class="antiquote">}</span></span> and <span class="antiquoted"><span class="antiquote">@{</span><span class="operator">text</span> <span class="raw_text">ğ”</span><span class="antiquote">}</span></span>â€º</span>
      <span class="keyword1"><span class="command">from</span></span> n'<span class="main">(</span>2<span class="main">)</span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"Suc <span class="main">(</span>length <span class="main">(</span>take <span class="skolem">n</span> <span class="skolem">ğ”Š</span><span class="main">)</span><span class="main">)</span> <span class="main">â‰¤</span> length <span class="skolem">ğ”Š</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">hence</span></span> multisetsğ”Šbutlastğ”<span class="main">:</span><span class="quoted"><span class="quoted">"mset <span class="main">(</span>map group.iso_class ğ”Šbutlast.quotients<span class="main">)</span> <span class="main">=</span> mset <span class="main">(</span>map group.iso_class ğ”.quotients<span class="main">)</span>"</span></span>
        <span class="keyword1"><span class="command">using</span></span>  <span class="quoted">"1.hyps"</span> grpğ”ŠPn.is_group finGbl ğ”Šbutlast.is_composition_series ğ”.is_composition_series <span class="keyword1"><span class="command">by</span></span> <span class="operator">metis</span>
      <span class="keyword1"><span class="command">hence</span></span> lengthğ”<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">n</span> <span class="main">=</span> length <span class="skolem">ğ”</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> ğ”Šbutlast.quotients_length ğ”.quotients_length length_map size_mset ltaken <span class="keyword1"><span class="command">by</span></span> <span class="operator">metis</span>
      <span class="keyword1"><span class="command">hence</span></span> lengthğ”'<span class="main">:</span><span class="quoted"><span class="quoted">"length <span class="skolem">ğ”</span> <span class="main">&gt;</span> <span class="main">1</span>"</span></span> <span class="quoted"><span class="quoted">"length <span class="skolem">ğ”</span> <span class="main">-</span> <span class="main">1</span> <span class="main">&gt;</span> <span class="main">0</span>"</span></span> <span class="quoted"><span class="quoted">"length <span class="skolem">ğ”</span> <span class="main">-</span> <span class="main">1</span> <span class="main">â‰¤</span> length <span class="skolem">ğ”</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> n'<span class="main">(</span>6<span class="main">)</span> length <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">have</span></span> Inteqğ”sndlast<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">â„Œ</span> <span class="main">!</span> <span class="main">(</span><span class="skolem">m</span> <span class="main">-</span> <span class="main">1</span><span class="main">)</span> <span class="main">âˆ©</span> <span class="skolem">ğ”Š</span> <span class="main">!</span> <span class="main">(</span><span class="skolem">n</span> <span class="main">-</span> <span class="main">1</span><span class="main">)</span> <span class="main">=</span> <span class="skolem">ğ”</span> <span class="main">!</span> <span class="main">(</span>length <span class="skolem">ğ”</span> <span class="main">-</span> <span class="main">1</span> <span class="main">-</span> <span class="main">1</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
        <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"length <span class="skolem">ğ”</span> <span class="main">-</span> <span class="main">1</span> <span class="main">-</span> <span class="main">1</span> <span class="main">+</span> <span class="main">1</span> <span class="main">&lt;</span> length <span class="skolem">ğ”</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> lengthğ”' <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> KGnotempty<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="main">(</span>map <span class="main">(</span><span class="main">(âˆ©)</span> <span class="main">(</span><span class="skolem">ğ”Š</span> <span class="main">!</span> <span class="main">(</span><span class="skolem">n</span> <span class="main">-</span> <span class="main">1</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="skolem">â„Œ</span><span class="main">)</span> <span class="main">â‰ </span> <span class="main">[]</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> compâ„Œ.notempty <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> Nil_is_map_conv<span class="main">)</span>
        <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">i</span></span> <span class="keyword2"><span class="keyword">where</span></span> i<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">i</span> <span class="main">+</span> <span class="main">1</span> <span class="main">&lt;</span> length <span class="main">(</span>map <span class="main">(</span><span class="main">(âˆ©)</span> <span class="main">(</span><span class="skolem">ğ”Š</span> <span class="main">!</span> <span class="main">(</span><span class="skolem">n</span> <span class="main">-</span> <span class="main">1</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="skolem">â„Œ</span><span class="main">)</span>"</span></span>
          <span class="quoted"><span class="quoted">"<span class="skolem">ğ”</span> <span class="main">!</span> <span class="main">(</span>length <span class="skolem">ğ”</span> <span class="main">-</span> <span class="main">1</span> <span class="main">-</span> <span class="main">1</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span>map <span class="main">(</span><span class="main">(âˆ©)</span> <span class="main">(</span><span class="skolem">ğ”Š</span> <span class="main">!</span> <span class="main">(</span><span class="skolem">n</span> <span class="main">-</span> <span class="main">1</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="skolem">â„Œ</span><span class="main">)</span> <span class="main">!</span> <span class="skolem">i</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">ğ”</span> <span class="main">!</span> <span class="main">(</span>length <span class="skolem">ğ”</span> <span class="main">-</span> <span class="main">1</span> <span class="main">-</span> <span class="main">1</span> <span class="main">+</span> <span class="main">1</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span>map <span class="main">(</span><span class="main">(âˆ©)</span> <span class="main">(</span><span class="skolem">ğ”Š</span> <span class="main">!</span> <span class="main">(</span><span class="skolem">n</span> <span class="main">-</span> <span class="main">1</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="skolem">â„Œ</span><span class="main">)</span> <span class="main">!</span> <span class="main">(</span><span class="skolem">i</span> <span class="main">+</span> <span class="main">1</span><span class="main">)</span>"</span></span>
          <span class="keyword1"><span class="command">using</span></span> remdups_adj_obtain_adjacency <span class="keyword1"><span class="command">unfolding</span></span> ğ”_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">force</span>
        <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">ğ”</span> <span class="main">!</span> <span class="main">(</span>length <span class="skolem">ğ”</span> <span class="main">-</span> <span class="main">1</span> <span class="main">-</span> <span class="main">1</span><span class="main">)</span> <span class="main">=</span> <span class="skolem">â„Œ</span> <span class="main">!</span> <span class="skolem">i</span> <span class="main">âˆ©</span> <span class="skolem">ğ”Š</span> <span class="main">!</span> <span class="main">(</span><span class="skolem">n</span> <span class="main">-</span> <span class="main">1</span><span class="main">)</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">ğ”</span> <span class="main">!</span> <span class="main">(</span>length <span class="skolem">ğ”</span> <span class="main">-</span> <span class="main">1</span> <span class="main">-</span> <span class="main">1</span> <span class="main">+</span> <span class="main">1</span><span class="main">)</span> <span class="main">=</span> <span class="skolem">â„Œ</span> <span class="main">!</span> <span class="main">(</span><span class="skolem">i</span> <span class="main">+</span> <span class="main">1</span><span class="main">)</span> <span class="main">âˆ©</span> <span class="skolem">ğ”Š</span> <span class="main">!</span> <span class="main">(</span><span class="skolem">n</span> <span class="main">-</span> <span class="main">1</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">ğ”</span> <span class="main">!</span> <span class="main">(</span>length <span class="skolem">ğ”</span> <span class="main">-</span> <span class="main">1</span><span class="main">)</span> <span class="main">=</span> <span class="skolem">â„Œ</span> <span class="main">!</span> <span class="main">(</span><span class="skolem">i</span> <span class="main">+</span> <span class="main">1</span><span class="main">)</span> <span class="main">âˆ©</span> <span class="skolem">ğ”Š</span> <span class="main">!</span> <span class="main">(</span><span class="skolem">n</span> <span class="main">-</span> <span class="main">1</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> lengthğ”'<span class="main">(</span>2<span class="main">)</span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> Suc_diff_1 Suc_eq_plus1<span class="main">)</span>
        <span class="keyword1"><span class="command">hence</span></span> ğ”ŠPnsubâ„ŒPm<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">ğ”Š</span> <span class="main">!</span> <span class="main">(</span><span class="skolem">n</span> <span class="main">-</span> <span class="main">1</span><span class="main">)</span> <span class="main">âŠ†</span> <span class="skolem">â„Œ</span> <span class="main">!</span> <span class="main">(</span><span class="skolem">i</span> <span class="main">+</span> <span class="main">1</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> ğ”.last ğ”.notempty last_conv_nth <span class="keyword1"><span class="command">unfolding</span></span> ğ”ŠPn_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword1"><span class="command">from</span></span> i<span class="main">(</span>1<span class="main">)</span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">i</span> <span class="main">+</span> <span class="main">1</span> <span class="main">&lt;</span> <span class="skolem">m</span> <span class="main">+</span> <span class="main">1</span>"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> m_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">Â¬</span> <span class="main">(</span><span class="skolem">i</span> <span class="main">+</span> <span class="main">1</span> <span class="main">â‰¤</span> <span class="skolem">m</span> <span class="main">-</span> <span class="main">1</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> compâ„Œ.entries_mono m'<span class="main">(</span>6<span class="main">)</span> notğ”ŠPnSubâ„ŒPm ğ”ŠPnsubâ„ŒPm <span class="keyword1"><span class="command">by</span></span> <span class="operator">fastforce</span>
        <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">m</span> <span class="main">-</span> <span class="main">1</span> <span class="main">=</span> <span class="skolem">i</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword1"><span class="command">with</span></span> i <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">qed</span></span>
      <span class="keyword1"><span class="command">hence</span></span> ğ”sndlast<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">â„ŒPmIntğ”ŠPn</span> <span class="main">=</span> <span class="main">(</span><span class="skolem">ğ”ŠPn</span><span class="main">â¦‡</span>carrier <span class="main">:=</span> <span class="skolem">ğ”</span> <span class="main">!</span> <span class="main">(</span>length <span class="skolem">ğ”</span> <span class="main">-</span> <span class="main">1</span> <span class="main">-</span> <span class="main">1</span><span class="main">)</span><span class="main">â¦ˆ</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> â„ŒPmIntğ”ŠPn_def ğ”ŠPn_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">interpret</span></span> ğ”butlast<span class="main">:</span> composition_series <span class="quoted"><span class="skolem">â„ŒPmIntğ”ŠPn</span></span> <span class="quoted"><span class="quoted">"take <span class="main">(</span>length <span class="skolem">ğ”</span> <span class="main">-</span> <span class="main">1</span><span class="main">)</span> <span class="skolem">ğ”</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> lengthğ”' ğ”.composition_series_prefix_closed <span class="keyword1"><span class="command">by</span></span> <span class="operator">metis</span>
      <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">â€¹length <span class="skolem">ğ”</span> <span class="main">&gt;</span> <span class="main">1</span>â€º</span></span> <span class="keyword1"><span class="command">have</span></span> quotsğ”notemtpy<span class="main">:</span><span class="quoted"><span class="quoted">"ğ”.quotients <span class="main">â‰ </span> <span class="main">[]</span>"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> ğ”.quotients_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

      <span class="comment1">â€• â€¹Apply the induction hypothesis on <span class="antiquoted"><span class="antiquote">@{</span><span class="operator">text</span> <span class="raw_text">ğ”butlast</span><span class="antiquote">}</span></span> and <span class="antiquoted"><span class="antiquote">@{</span><span class="operator">text</span> <span class="raw_text">ğ”butlast</span><span class="antiquote">}</span></span>â€º</span>
      <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"length <span class="skolem">ğ”</span> <span class="main">&gt;</span> <span class="main">1</span>"</span></span>
      <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">rule</span> ccontr<span class="main">)</span>
        <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">Â¬</span> length <span class="skolem">ğ”</span> <span class="main">&gt;</span> <span class="main">1</span>"</span></span>
        <span class="keyword1"><span class="command">with</span></span> ğ”.notempty <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"length <span class="skolem">ğ”</span> <span class="main">=</span> <span class="main">1</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> One_nat_def Suc_lessI length_greater_0_conv<span class="main">)</span>
        <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"carrier <span class="skolem">â„ŒPm</span> <span class="main">=</span> <span class="main">{</span><span class="main">ğŸ­</span><span class="hidden">â‡˜</span><sub><span class="skolem">â„ŒPm</span></sub><span class="hidden">â‡™</span><span class="main">}</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> ğ”.composition_series_length_one ğ”.composition_series_triv_group <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"carrier <span class="skolem">â„ŒPm</span> <span class="main">=</span> <span class="main">{</span><span class="main">ğŸ­</span><span class="hidden">â‡˜</span><sub><span class="skolem">G</span></sub><span class="hidden">â‡™</span><span class="main">}</span>"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> â„ŒPm_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"carrier <span class="skolem">â„ŒPm</span> <span class="main">âŠ†</span> <span class="skolem">ğ”Š</span> <span class="main">!</span> <span class="main">(</span><span class="skolem">n</span> <span class="main">-</span> <span class="main">1</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> ğ”ŠPnmax.is_subgroup subgroup.one_closed <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword1"><span class="command">with</span></span> notâ„ŒPmSubğ”ŠPn <span class="keyword3"><span class="command">show</span></span> <span class="quoted">False</span> <span class="keyword1"><span class="command">unfolding</span></span> â„ŒPm_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">qed</span></span>
      <span class="keyword1"><span class="command">hence</span></span> lengthğ”'<span class="main">:</span><span class="quoted"><span class="quoted">"length <span class="skolem">ğ”</span> <span class="main">-</span> <span class="main">1</span> <span class="main">&gt;</span> <span class="main">0</span>"</span></span> <span class="quoted"><span class="quoted">"length <span class="skolem">ğ”</span> <span class="main">-</span> <span class="main">1</span> <span class="main">â‰¤</span> length <span class="skolem">ğ”</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span> 
      <span class="keyword1"><span class="command">have</span></span> Inteqğ”sndlast<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">â„Œ</span> <span class="main">!</span> <span class="main">(</span><span class="skolem">m</span> <span class="main">-</span> <span class="main">1</span><span class="main">)</span> <span class="main">âˆ©</span> <span class="skolem">ğ”Š</span> <span class="main">!</span> <span class="main">(</span><span class="skolem">n</span> <span class="main">-</span> <span class="main">1</span><span class="main">)</span> <span class="main">=</span> <span class="skolem">ğ”</span> <span class="main">!</span> <span class="main">(</span>length <span class="skolem">ğ”</span> <span class="main">-</span> <span class="main">1</span> <span class="main">-</span> <span class="main">1</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
        <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"length <span class="skolem">ğ”</span> <span class="main">-</span> <span class="main">1</span> <span class="main">-</span> <span class="main">1</span> <span class="main">+</span> <span class="main">1</span> <span class="main">&lt;</span> length <span class="skolem">ğ”</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> lengthğ”' <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> KGnotempty<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="main">(</span>map <span class="main">(</span><span class="main">(âˆ©)</span> <span class="main">(</span><span class="skolem">â„Œ</span> <span class="main">!</span> <span class="main">(</span><span class="skolem">m</span> <span class="main">-</span> <span class="main">1</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="skolem">ğ”Š</span><span class="main">)</span> <span class="main">â‰ </span> <span class="main">[]</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> compğ”Š.notempty <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> Nil_is_map_conv<span class="main">)</span>
        <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">i</span></span> <span class="keyword2"><span class="keyword">where</span></span> i<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">i</span> <span class="main">+</span> <span class="main">1</span> <span class="main">&lt;</span> length <span class="main">(</span>map <span class="main">(</span><span class="main">(âˆ©)</span> <span class="main">(</span><span class="skolem">â„Œ</span> <span class="main">!</span> <span class="main">(</span><span class="skolem">m</span> <span class="main">-</span> <span class="main">1</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="skolem">ğ”Š</span><span class="main">)</span>"</span></span>
          <span class="quoted"><span class="quoted">"<span class="skolem">ğ”</span> <span class="main">!</span> <span class="main">(</span>length <span class="skolem">ğ”</span> <span class="main">-</span> <span class="main">1</span> <span class="main">-</span> <span class="main">1</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span>map <span class="main">(</span><span class="main">(âˆ©)</span> <span class="main">(</span><span class="skolem">â„Œ</span> <span class="main">!</span> <span class="main">(</span><span class="skolem">m</span> <span class="main">-</span> <span class="main">1</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="skolem">ğ”Š</span><span class="main">)</span> <span class="main">!</span> <span class="skolem">i</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">ğ”</span> <span class="main">!</span> <span class="main">(</span>length <span class="skolem">ğ”</span> <span class="main">-</span> <span class="main">1</span> <span class="main">-</span> <span class="main">1</span> <span class="main">+</span> <span class="main">1</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span>map <span class="main">(</span><span class="main">(âˆ©)</span> <span class="main">(</span><span class="skolem">â„Œ</span> <span class="main">!</span> <span class="main">(</span><span class="skolem">m</span> <span class="main">-</span> <span class="main">1</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="skolem">ğ”Š</span><span class="main">)</span> <span class="main">!</span> <span class="main">(</span><span class="skolem">i</span> <span class="main">+</span> <span class="main">1</span><span class="main">)</span>"</span></span>
          <span class="keyword1"><span class="command">using</span></span> remdups_adj_obtain_adjacency <span class="keyword1"><span class="command">unfolding</span></span> ğ”_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">force</span>
        <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">ğ”</span> <span class="main">!</span> <span class="main">(</span>length <span class="skolem">ğ”</span> <span class="main">-</span> <span class="main">1</span> <span class="main">-</span> <span class="main">1</span><span class="main">)</span> <span class="main">=</span> <span class="skolem">ğ”Š</span> <span class="main">!</span> <span class="skolem">i</span> <span class="main">âˆ©</span> <span class="skolem">â„Œ</span> <span class="main">!</span> <span class="main">(</span><span class="skolem">m</span> <span class="main">-</span> <span class="main">1</span><span class="main">)</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">ğ”</span> <span class="main">!</span> <span class="main">(</span>length <span class="skolem">ğ”</span> <span class="main">-</span> <span class="main">1</span> <span class="main">-</span> <span class="main">1</span> <span class="main">+</span> <span class="main">1</span><span class="main">)</span> <span class="main">=</span> <span class="skolem">ğ”Š</span> <span class="main">!</span> <span class="main">(</span><span class="skolem">i</span> <span class="main">+</span> <span class="main">1</span><span class="main">)</span> <span class="main">âˆ©</span> <span class="skolem">â„Œ</span> <span class="main">!</span> <span class="main">(</span><span class="skolem">m</span> <span class="main">-</span> <span class="main">1</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">ğ”</span> <span class="main">!</span> <span class="main">(</span>length <span class="skolem">ğ”</span> <span class="main">-</span> <span class="main">1</span><span class="main">)</span> <span class="main">=</span> <span class="skolem">ğ”Š</span> <span class="main">!</span> <span class="main">(</span><span class="skolem">i</span> <span class="main">+</span> <span class="main">1</span><span class="main">)</span> <span class="main">âˆ©</span> <span class="skolem">â„Œ</span> <span class="main">!</span> <span class="main">(</span><span class="skolem">m</span> <span class="main">-</span> <span class="main">1</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> lengthğ”'<span class="main">(</span>1<span class="main">)</span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> Suc_diff_1 Suc_eq_plus1<span class="main">)</span>
        <span class="keyword1"><span class="command">hence</span></span> â„ŒPmsubğ”ŠPn<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">â„Œ</span> <span class="main">!</span> <span class="main">(</span><span class="skolem">m</span> <span class="main">-</span> <span class="main">1</span><span class="main">)</span> <span class="main">âŠ†</span> <span class="skolem">ğ”Š</span> <span class="main">!</span> <span class="main">(</span><span class="skolem">i</span> <span class="main">+</span> <span class="main">1</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> ğ”.last ğ”.notempty last_conv_nth <span class="keyword1"><span class="command">unfolding</span></span> â„ŒPm_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword1"><span class="command">from</span></span> i<span class="main">(</span>1<span class="main">)</span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">i</span> <span class="main">+</span> <span class="main">1</span> <span class="main">&lt;</span> <span class="skolem">n</span> <span class="main">+</span> <span class="main">1</span>"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> n_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">Â¬</span> <span class="main">(</span><span class="skolem">i</span> <span class="main">+</span> <span class="main">1</span> <span class="main">â‰¤</span> <span class="skolem">n</span> <span class="main">-</span> <span class="main">1</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> compğ”Š.entries_mono n'<span class="main">(</span>2<span class="main">)</span> notâ„ŒPmSubğ”ŠPn â„ŒPmsubğ”ŠPn <span class="keyword1"><span class="command">by</span></span> <span class="operator">fastforce</span>
        <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">n</span> <span class="main">-</span> <span class="main">1</span> <span class="main">=</span> <span class="skolem">i</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword1"><span class="command">with</span></span> i <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">qed</span></span>
      <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"composition_series <span class="main">(</span><span class="skolem">G</span><span class="main">â¦‡</span>carrier <span class="main">:=</span> <span class="skolem">ğ”</span> <span class="main">!</span> <span class="main">(</span>length <span class="skolem">ğ”</span> <span class="main">-</span> <span class="main">1</span> <span class="main">-</span> <span class="main">1</span><span class="main">)</span><span class="main">â¦ˆ</span><span class="main">)</span> <span class="main">(</span>take <span class="main">(</span>length <span class="skolem">ğ”</span> <span class="main">-</span> <span class="main">1</span><span class="main">)</span> <span class="skolem">ğ”</span><span class="main">)</span>"</span></span>
        <span class="keyword1"><span class="command">using</span></span> lengthğ”' ğ”.composition_series_prefix_closed <span class="keyword1"><span class="command">unfolding</span></span> â„ŒPmIntğ”ŠPn_def â„ŒPm_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">fastforce</span>
      <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">interpret</span></span> ğ”butlast<span class="main">:</span> composition_series <span class="quoted"><span class="skolem">â„ŒPmIntğ”ŠPn</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span>take <span class="main">(</span>length <span class="skolem">ğ”</span> <span class="main">-</span> <span class="main">1</span><span class="main">)</span> <span class="skolem">ğ”</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> Inteqğ”sndlast <span class="keyword1"><span class="command">unfolding</span></span> â„ŒPmIntğ”ŠPn_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">from</span></span> finGbl <span class="keyword1"><span class="command">have</span></span> finInt<span class="main">:</span><span class="quoted"><span class="quoted">"finite <span class="main">(</span>carrier <span class="skolem">â„ŒPmIntğ”ŠPn</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> â„ŒPmIntğ”ŠPn_def ğ”ŠPn_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
      <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"Suc <span class="main">(</span>length <span class="main">(</span>take <span class="main">(</span>length <span class="skolem">ğ”</span> <span class="main">-</span> <span class="main">1</span><span class="main">)</span> <span class="skolem">ğ”</span><span class="main">)</span><span class="main">)</span> <span class="main">â‰¤</span> length <span class="skolem">ğ”Š</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> lengthğ” <span class="keyword1"><span class="command">unfolding</span></span> n_def <span class="keyword1"><span class="command">using</span></span> n'<span class="main">(</span>2<span class="main">)</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> multisetsğ”ğ”butlast<span class="main">:</span><span class="quoted"><span class="quoted">"mset <span class="main">(</span>map group.iso_class ğ”butlast.quotients<span class="main">)</span> <span class="main">=</span> mset <span class="main">(</span>map group.iso_class ğ”butlast.quotients<span class="main">)</span>"</span></span>
         <span class="keyword1"><span class="command">using</span></span> <span class="quoted">"1.hyps"</span> ğ”butlast.is_group ğ”butlast.is_composition_series ğ”butlast.is_composition_series <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"length <span class="main">(</span>take <span class="main">(</span>length <span class="skolem">ğ”</span> <span class="main">-</span> <span class="main">1</span><span class="main">)</span> <span class="skolem">ğ”</span><span class="main">)</span> <span class="main">=</span> length <span class="main">(</span>take <span class="main">(</span>length <span class="skolem">ğ”</span> <span class="main">-</span> <span class="main">1</span><span class="main">)</span> <span class="skolem">ğ”</span><span class="main">)</span>"</span></span>
        <span class="keyword1"><span class="command">using</span></span> ğ”butlast.quotients_length ğ”butlast.quotients_length length_map size_mset <span class="keyword1"><span class="command">by</span></span> <span class="operator">metis</span>
      <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"length <span class="main">(</span>take <span class="main">(</span>length <span class="skolem">ğ”</span> <span class="main">-</span> <span class="main">1</span><span class="main">)</span> <span class="skolem">ğ”</span><span class="main">)</span> <span class="main">=</span> <span class="skolem">n</span> <span class="main">-</span> <span class="main">1</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> lengthğ” n'<span class="main">(</span>1<span class="main">)</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">hence</span></span> lengthğ”<span class="main">:</span><span class="quoted"><span class="quoted">"length <span class="skolem">ğ”</span> <span class="main">=</span> <span class="skolem">n</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> Suc_diff_1 ğ”.notempty butlast_conv_take length_butlast length_greater_0_conv n'<span class="main"><span class="main">(</span></span>1<span class="main"><span class="main">)</span></span><span class="main">)</span>
      
      <span class="comment1">â€• â€¹Apply the induction hypothesis on <span class="antiquoted"><span class="antiquote">@{</span><span class="operator">text</span> <span class="raw_text">ğ”</span><span class="antiquote">}</span></span> and <span class="antiquoted"><span class="antiquote">@{</span><span class="operator">text</span> <span class="raw_text">â„Œbutlast</span><span class="antiquote">}</span></span>â€º</span>
      <span class="keyword1"><span class="command">from</span></span> Inteqğ”sndlast <span class="keyword1"><span class="command">have</span></span> ğ”sndlast<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">â„ŒPmIntğ”ŠPn</span> <span class="main">=</span> <span class="main">(</span><span class="skolem">â„ŒPm</span><span class="main">â¦‡</span>carrier <span class="main">:=</span> <span class="skolem">ğ”</span> <span class="main">!</span> <span class="main">(</span>length <span class="skolem">ğ”</span> <span class="main">-</span> <span class="main">1</span> <span class="main">-</span> <span class="main">1</span><span class="main">)</span><span class="main">â¦ˆ</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> â„ŒPmIntğ”ŠPn_def â„ŒPm_def ğ”_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">from</span></span> lengthğ” <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"Suc <span class="main">(</span>length <span class="skolem">ğ”</span><span class="main">)</span> <span class="main">â‰¤</span> length <span class="skolem">ğ”Š</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> n'<span class="main">(</span>2<span class="main">)</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">hence</span></span> multisetsâ„Œbutlastğ”<span class="main">:</span><span class="quoted"><span class="quoted">"mset <span class="main">(</span>map group.iso_class â„Œbutlast.quotients<span class="main">)</span> <span class="main">=</span> mset <span class="main">(</span>map group.iso_class ğ”.quotients<span class="main">)</span>"</span></span>
        <span class="keyword1"><span class="command">using</span></span>  <span class="quoted">"1.hyps"</span> grpâ„ŒPm.is_group finHbl â„Œbutlast.is_composition_series ğ”.is_composition_series <span class="keyword1"><span class="command">by</span></span> <span class="operator">metis</span>
      <span class="keyword1"><span class="command">hence</span></span> lengthğ”<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">m</span> <span class="main">=</span> length <span class="skolem">ğ”</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> â„Œbutlast.quotients_length ğ”.quotients_length length_map size_mset ltakem <span class="keyword1"><span class="command">by</span></span> <span class="operator">metis</span>
      <span class="keyword1"><span class="command">hence</span></span>  <span class="quoted"><span class="quoted">"length <span class="skolem">ğ”</span> <span class="main">&gt;</span> <span class="main">1</span>"</span></span> <span class="quoted"><span class="quoted">"length <span class="skolem">ğ”</span> <span class="main">-</span> <span class="main">1</span> <span class="main">&gt;</span> <span class="main">0</span>"</span></span> <span class="quoted"><span class="quoted">"length <span class="skolem">ğ”</span> <span class="main">-</span> <span class="main">1</span> <span class="main">â‰¤</span> length <span class="skolem">ğ”</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> m'<span class="main">(</span>4<span class="main">)</span> lengthâ„Œbig <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">hence</span></span> quotsğ”notemtpy<span class="main">:</span><span class="quoted"><span class="quoted">"ğ”.quotients <span class="main">â‰ </span> <span class="main">[]</span>"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> ğ”.quotients_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      
      <span class="keyword1"><span class="command">interpret</span></span> ğ”butlastaddğ”ŠPn<span class="main">:</span> composition_series <span class="quoted"><span class="skolem">ğ”ŠPn</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span>take <span class="main">(</span>length <span class="skolem">ğ”</span> <span class="main">-</span> <span class="main">1</span><span class="main">)</span> <span class="skolem">ğ”</span><span class="main">)</span> <span class="main">@</span> <span class="main">[</span><span class="skolem">ğ”Š</span> <span class="main">!</span> <span class="main">(</span><span class="skolem">n</span> <span class="main">-</span> <span class="main">1</span><span class="main">)</span><span class="main">]</span>"</span></span>
        <span class="keyword1"><span class="command">using</span></span> grpğ”ŠPn.composition_series_extend ğ”butlast.is_composition_series simpleğ”ŠPnModInt Intnormğ”ŠPn
        <span class="keyword1"><span class="command">unfolding</span></span> ğ”ŠPn_def â„ŒPmIntğ”ŠPn_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">interpret</span></span> ğ”butlastaddâ„ŒPm<span class="main">:</span> composition_series <span class="quoted"><span class="skolem">â„ŒPm</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span>take <span class="main">(</span>length <span class="skolem">ğ”</span> <span class="main">-</span> <span class="main">1</span><span class="main">)</span> <span class="skolem">ğ”</span><span class="main">)</span> <span class="main">@</span> <span class="main">[</span><span class="skolem">â„Œ</span> <span class="main">!</span> <span class="main">(</span><span class="skolem">m</span> <span class="main">-</span> <span class="main">1</span><span class="main">)</span><span class="main">]</span>"</span></span>
        <span class="keyword1"><span class="command">using</span></span> grpâ„ŒPm.composition_series_extend ğ”butlast.is_composition_series simpleâ„ŒPmModInt Intnormâ„ŒPm
        <span class="keyword1"><span class="command">unfolding</span></span> â„ŒPm_def â„ŒPmIntğ”ŠPn_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      
      <span class="comment1">â€• â€¹Prove equality of those composition series.â€º</span>
      <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"mset <span class="main">(</span>map group.iso_class compğ”Š.quotients<span class="main">)</span>
                    <span class="main">=</span> mset <span class="main">(</span>map group.iso_class <span class="main">(</span><span class="main">(</span>butlast compğ”Š.quotients<span class="main">)</span> <span class="main">@</span> <span class="main">[</span>last compğ”Š.quotients<span class="main">]</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> quotsğ”Šnotempty <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
      <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">â€¦</span> <span class="main">=</span> mset <span class="main">(</span>map group.iso_class <span class="main">(</span>ğ”Šbutlast.quotients <span class="main">@</span> <span class="main">[</span><span class="skolem">G</span> <span class="keyword1">Mod</span> <span class="skolem">ğ”Š</span> <span class="main">!</span> <span class="main">(</span><span class="skolem">n</span> <span class="main">-</span> <span class="main">1</span><span class="main">)</span><span class="main">]</span><span class="main">)</span><span class="main">)</span>"</span></span>
        <span class="keyword1"><span class="command">using</span></span> compğ”Š.quotients_butlast compğ”Š.last_quotient length <span class="keyword1"><span class="command">unfolding</span></span> n_def ğ”ŠPn_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">â€¦</span> <span class="main">=</span> mset <span class="main">(</span>map group.iso_class <span class="main">(</span><span class="main">(</span>butlast ğ”.quotients<span class="main">)</span> <span class="main">@</span> <span class="main">[</span>last ğ”.quotients<span class="main">]</span><span class="main">)</span><span class="main">)</span> <span class="main">+</span> <span class="main">{#</span> group.iso_class <span class="main">(</span><span class="skolem">G</span> <span class="keyword1">Mod</span> <span class="skolem">ğ”Š</span> <span class="main">!</span> <span class="main">(</span><span class="skolem">n</span> <span class="main">-</span> <span class="main">1</span><span class="main">)</span><span class="main">)</span> <span class="main">#}</span>"</span></span>
        <span class="keyword1"><span class="command">using</span></span> multisetsğ”Šbutlastğ” quotsğ”notemtpy <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
      <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">â€¦</span> <span class="main">=</span> mset <span class="main">(</span>map group.iso_class <span class="main">(</span>ğ”butlast.quotients <span class="main">@</span> <span class="main">[</span><span class="skolem">ğ”ŠPn</span> <span class="keyword1">Mod</span> <span class="skolem">â„Œ</span> <span class="main">!</span> <span class="main">(</span><span class="skolem">m</span> <span class="main">-</span> <span class="main">1</span><span class="main">)</span> <span class="main">âˆ©</span> <span class="skolem">ğ”Š</span> <span class="main">!</span> <span class="main">(</span><span class="skolem">n</span> <span class="main">-</span> <span class="main">1</span><span class="main">)</span><span class="main">]</span><span class="main">)</span><span class="main">)</span> <span class="main">+</span> <span class="main">{#</span> group.iso_class <span class="main">(</span><span class="skolem">G</span> <span class="keyword1">Mod</span> <span class="skolem">ğ”Š</span> <span class="main">!</span> <span class="main">(</span><span class="skolem">n</span> <span class="main">-</span> <span class="main">1</span><span class="main">)</span><span class="main">)</span> <span class="main">#}</span>"</span></span>
        <span class="keyword1"><span class="command">using</span></span> ğ”.quotients_butlast ğ”.last_quotient <span class="quoted"><span class="quoted">â€¹length <span class="skolem">ğ”</span> <span class="main">&gt;</span> <span class="main">1</span>â€º</span></span> ğ”sndlast Inteqğ”sndlast <span class="keyword1"><span class="command">unfolding</span></span> n_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">â€¦</span> <span class="main">=</span> mset <span class="main">(</span>map group.iso_class ğ”butlast.quotients<span class="main">)</span> <span class="main">+</span> <span class="main">{#</span> group.iso_class <span class="main">(</span><span class="skolem">ğ”ŠPn</span> <span class="keyword1">Mod</span> <span class="skolem">â„Œ</span> <span class="main">!</span> <span class="main">(</span><span class="skolem">m</span> <span class="main">-</span> <span class="main">1</span><span class="main">)</span> <span class="main">âˆ©</span> <span class="skolem">ğ”Š</span> <span class="main">!</span> <span class="main">(</span><span class="skolem">n</span> <span class="main">-</span> <span class="main">1</span><span class="main">)</span><span class="main">)</span> <span class="main">#}</span> <span class="main">+</span> <span class="main">{#</span> group.iso_class <span class="main">(</span><span class="skolem">G</span> <span class="keyword1">Mod</span> <span class="skolem">ğ”Š</span> <span class="main">!</span> <span class="main">(</span><span class="skolem">n</span> <span class="main">-</span> <span class="main">1</span><span class="main">)</span><span class="main">)</span> <span class="main">#}</span>"</span></span>
        <span class="keyword1"><span class="command">using</span></span> multisetsğ”ğ”butlast <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
      <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">â€¦</span> <span class="main">=</span> mset <span class="main">(</span>map group.iso_class ğ”butlast.quotients<span class="main">)</span> <span class="main">+</span> <span class="main">{#</span> group.iso_class <span class="main">(</span><span class="skolem">G</span> <span class="keyword1">Mod</span> <span class="skolem">â„Œ</span> <span class="main">!</span> <span class="main">(</span><span class="skolem">m</span> <span class="main">-</span> <span class="main">1</span><span class="main">)</span><span class="main">)</span> <span class="main">#}</span> <span class="main">+</span> <span class="main">{#</span> group.iso_class <span class="main">(</span><span class="skolem">â„ŒPm</span> <span class="keyword1">Mod</span> <span class="skolem">â„Œ</span> <span class="main">!</span> <span class="main">(</span><span class="skolem">m</span> <span class="main">-</span> <span class="main">1</span><span class="main">)</span> <span class="main">âˆ©</span> <span class="skolem">ğ”Š</span> <span class="main">!</span> <span class="main">(</span><span class="skolem">n</span> <span class="main">-</span> <span class="main">1</span><span class="main">)</span><span class="main">)</span> <span class="main">#}</span>"</span></span>
        <span class="keyword1"><span class="command">using</span></span> Ï† Ïˆ2 iso_classes_iff grpğ”ŠPnModâ„ŒPmintğ”ŠPn.is_group grpGModâ„ŒPm.is_group grpGModğ”ŠPn.is_group grpâ„ŒPmModâ„ŒPmintğ”ŠPn.is_group
        <span class="keyword1"><span class="command">by</span></span> <span class="operator">metis</span>
      <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">â€¦</span> <span class="main">=</span> mset <span class="main">(</span>map group.iso_class ğ”butlast.quotients<span class="main">)</span> <span class="main">+</span> <span class="main">{#</span> group.iso_class <span class="main">(</span><span class="skolem">â„ŒPm</span> <span class="keyword1">Mod</span> <span class="skolem">â„Œ</span> <span class="main">!</span> <span class="main">(</span><span class="skolem">m</span> <span class="main">-</span> <span class="main">1</span><span class="main">)</span> <span class="main">âˆ©</span> <span class="skolem">ğ”Š</span> <span class="main">!</span> <span class="main">(</span><span class="skolem">n</span> <span class="main">-</span> <span class="main">1</span><span class="main">)</span><span class="main">)</span> <span class="main">#}</span> <span class="main">+</span> <span class="main">{#</span> group.iso_class <span class="main">(</span><span class="skolem">G</span> <span class="keyword1">Mod</span> <span class="skolem">â„Œ</span> <span class="main">!</span> <span class="main">(</span><span class="skolem">m</span> <span class="main">-</span> <span class="main">1</span><span class="main">)</span><span class="main">)</span> <span class="main">#}</span>"</span></span>
        <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
      <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">â€¦</span> <span class="main">=</span> mset <span class="main">(</span>map group.iso_class <span class="main">(</span><span class="main">(</span>butlast ğ”.quotients<span class="main">)</span> <span class="main">@</span> <span class="main">[</span>last ğ”.quotients<span class="main">]</span><span class="main">)</span><span class="main">)</span> <span class="main">+</span> <span class="main">{#</span> group.iso_class <span class="main">(</span><span class="skolem">G</span> <span class="keyword1">Mod</span> <span class="skolem">â„Œ</span> <span class="main">!</span> <span class="main">(</span><span class="skolem">m</span> <span class="main">-</span> <span class="main">1</span><span class="main">)</span><span class="main">)</span> <span class="main">#}</span>"</span></span>
        <span class="keyword1"><span class="command">using</span></span> ğ”.quotients_butlast ğ”.last_quotient <span class="quoted"><span class="quoted">â€¹length <span class="skolem">ğ”</span> <span class="main">&gt;</span> <span class="main">1</span>â€º</span></span> ğ”sndlast Inteqğ”sndlast <span class="keyword1"><span class="command">unfolding</span></span> m_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">â€¦</span> <span class="main">=</span> mset <span class="main">(</span>map group.iso_class â„Œbutlast.quotients<span class="main">)</span> <span class="main">+</span> <span class="main">{#</span> group.iso_class <span class="main">(</span><span class="skolem">G</span> <span class="keyword1">Mod</span> <span class="skolem">â„Œ</span> <span class="main">!</span> <span class="main">(</span><span class="skolem">m</span> <span class="main">-</span> <span class="main">1</span><span class="main">)</span><span class="main">)</span> <span class="main">#}</span>"</span></span>
        <span class="keyword1"><span class="command">using</span></span> multisetsâ„Œbutlastğ” quotsğ”notemtpy <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
      <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">â€¦</span> <span class="main">=</span> mset <span class="main">(</span>map group.iso_class <span class="main">(</span><span class="main">(</span>butlast compâ„Œ.quotients<span class="main">)</span> <span class="main">@</span> <span class="main">[</span>last compâ„Œ.quotients<span class="main">]</span><span class="main">)</span><span class="main">)</span>"</span></span>
        <span class="keyword1"><span class="command">using</span></span> compâ„Œ.quotients_butlast compâ„Œ.last_quotient lengthâ„Œbig <span class="keyword1"><span class="command">unfolding</span></span> m_def â„ŒPm_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">â€¦</span> <span class="main">=</span> mset <span class="main">(</span>map group.iso_class compâ„Œ.quotients<span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> quotsâ„Œnotempty <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
      <span class="keyword1"><span class="command">finally</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">.</span></span>
    <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">qed</span></span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">â€¹As a corollary, we see that the composition series of a fixed group all have the same length.â€º</span></span>

<span class="keyword1"><span class="command">corollary</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> jordan_hoelder<span class="main">)</span> jordan_hoelder_size<span class="main">:</span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"length <span class="free">ğ”Š</span> <span class="main">=</span> length <span class="free">â„Œ</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"length <span class="free">ğ”Š</span> <span class="main">=</span> length compğ”Š.quotients <span class="main">+</span> <span class="main">1</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> compğ”Š.quotients_length<span class="main">)</span>
  <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">â€¦</span> <span class="main">=</span> length <span class="main">(</span>map group.iso_class compğ”Š.quotients<span class="main">)</span> <span class="main">+</span> <span class="main">1</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> length_map<span class="main">)</span>
  <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">â€¦</span> <span class="main">=</span> size <span class="main">(</span>mset <span class="main">(</span>map group.iso_class compğ”Š.quotients<span class="main">)</span><span class="main">)</span> <span class="main">+</span> <span class="main">1</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> size_mset<span class="main">)</span>
  <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">â€¦</span> <span class="main">=</span> size <span class="main">(</span>mset <span class="main">(</span>map group.iso_class compâ„Œ.quotients<span class="main">)</span><span class="main">)</span> <span class="main">+</span> <span class="main">1</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> jordan_hoelder_multisets is_group finite is_composition_series compâ„Œ.is_composition_series <span class="keyword1"><span class="command">by</span></span> <span class="operator">metis</span>
  <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">â€¦</span> <span class="main">=</span> length <span class="main">(</span>map group.iso_class compâ„Œ.quotients<span class="main">)</span> <span class="main">+</span> <span class="main">1</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> size_mset<span class="main">)</span>
  <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">â€¦</span> <span class="main">=</span> length compâ„Œ.quotients <span class="main">+</span> <span class="main">1</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> length_map<span class="main">)</span>
  <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">â€¦</span> <span class="main">=</span> length <span class="free">â„Œ</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> compâ„Œ.quotients_length<span class="main">)</span>
  <span class="keyword1"><span class="command">finally</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span><span class="keyword1"><span class="command">.</span></span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword2"><span class="keyword">end</span></span>
</pre>
</div>
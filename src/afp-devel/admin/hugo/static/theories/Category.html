<div id="Cat">
<div class="head">
<h1>Theory Cat</h1>
</div>
<pre class="source"><span class="comment1">(*  Title:       Category theory using Isar and Locales
    Author:      Greg O'Keefe, June, July, August 2003
    License: LGPL
*)</span>

<span class="keyword1"><span class="command">section</span></span> <span class="quoted"><span class="plain_text">‹Categories›</span></span>

<span class="keyword1"><span class="command">theory</span></span> Cat
<span class="keyword2"><span class="keyword">imports</span></span> <span class="quoted">"<a href="../../HOL/HOL-Library/FuncSet.html">HOL-Library.FuncSet</a>"</span>
<span class="keyword2"><span class="keyword">begin</span></span>

<span class="keyword1"><span class="command">subsection</span></span> <span class="quoted"><span class="plain_text">‹Definitions›</span></span>

<span class="keyword1"><span class="command">record</span></span> <span class="main">(</span><span class="tfree">'o</span><span class="main">,</span> <span class="tfree">'a</span><span class="main">)</span> category <span class="main">=</span>
  ob <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'o</span> set"</span></span> <span class="main">(</span><span class="quoted">"<span class="keyword1">Ob</span>ı"</span>  70<span class="main">)</span>
  ar <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'a</span> set"</span></span> <span class="main">(</span><span class="quoted">"<span class="keyword1">Ar</span>ı"</span>  70<span class="main">)</span>
  dom <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'a</span> <span class="main">⇒</span> <span class="tfree">'o</span>"</span></span> <span class="main">(</span><span class="quoted">"<span class="keyword1">Dom</span>ı _"</span> <span class="main">[</span>81<span class="main">]</span> 70<span class="main">)</span>
  cod <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'a</span> <span class="main">⇒</span> <span class="tfree">'o</span>"</span></span> <span class="main">(</span><span class="quoted">"<span class="keyword1">Cod</span>ı _"</span> <span class="main">[</span>81<span class="main">]</span> 70<span class="main">)</span>
  id <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'o</span> <span class="main">⇒</span> <span class="tfree">'a</span>"</span></span> <span class="main">(</span><span class="quoted">"<span class="keyword1">Id</span>ı _"</span> <span class="main">[</span>81<span class="main">]</span> 80<span class="main">)</span>
  comp <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'a</span> <span class="main">⇒</span> <span class="tfree">'a</span> <span class="main">⇒</span> <span class="tfree">'a</span>"</span></span>  <span class="main">(</span><span class="keyword2"><span class="keyword">infixl</span></span> <span class="quoted">"<span class="keyword1">∙</span>ı"</span> 60<span class="main">)</span>

<span class="keyword1"><span class="command">definition</span></span>
  <span class="entity">hom</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="main">[</span><span class="main">(</span><span class="tfree">'o</span><span class="main">,</span><span class="tfree">'a</span><span class="main">,</span><span class="tfree">'m</span><span class="main">)</span> category_scheme<span class="main">,</span> <span class="tfree">'o</span><span class="main">,</span> <span class="tfree">'o</span><span class="main">]</span> <span class="main">⇒</span> <span class="tfree">'a</span> set"</span></span>
    <span class="main">(</span><span class="quoted">"<span class="keyword1">Hom</span>ı _ _"</span> <span class="main">[</span>81<span class="main">,</span>81<span class="main">]</span> 80<span class="main">)</span> <span class="keyword2"><span class="keyword">where</span></span>
  <span class="quoted"><span class="quoted">"<span class="free">hom</span> <span class="free"><span class="bound"><span class="entity">CC</span></span></span> <span class="free"><span class="bound"><span class="entity">A</span></span></span> <span class="free"><span class="bound"><span class="entity">B</span></span></span> <span class="main">=</span> <span class="main">{</span> <span class="bound">f</span><span class="main">.</span> <span class="bound">f</span><span class="main">∈</span>ar <span class="free"><span class="bound"><span class="entity">CC</span></span></span> <span class="main">&amp;</span> dom <span class="free"><span class="bound"><span class="entity">CC</span></span></span> <span class="bound">f</span> <span class="main">=</span> <span class="free"><span class="bound"><span class="entity">A</span></span></span> <span class="main">&amp;</span> cod <span class="free"><span class="bound"><span class="entity">CC</span></span></span> <span class="bound">f</span> <span class="main">=</span> <span class="free"><span class="bound"><span class="entity">B</span></span></span> <span class="main">}</span>"</span></span>

<span class="keyword1"><span class="command">locale</span></span> category <span class="main">=</span>
  <span class="keyword2"><span class="keyword">fixes</span></span> <span class="free">CC</span> <span class="main">(</span><span class="keyword2"><span class="keyword">structure</span></span><span class="main">)</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> dom_object <span class="main">[</span><span class="operator">intro</span><span class="main">]</span><span class="main">:</span>
  <span class="quoted"><span class="quoted">"<span class="free">f</span> <span class="main">∈</span> <span class="keyword1">Ar</span> <span class="main">⟹</span> <span class="keyword1">Dom</span> <span class="free">f</span> <span class="main">∈</span> <span class="keyword1">Ob</span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> cod_object <span class="main">[</span><span class="operator">intro</span><span class="main">]</span><span class="main">:</span>
  <span class="quoted"><span class="quoted">"<span class="free">f</span> <span class="main">∈</span> <span class="keyword1">Ar</span> <span class="main">⟹</span> <span class="keyword1">Cod</span> <span class="free">f</span> <span class="main">∈</span> <span class="keyword1">Ob</span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> id_left <span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span>
  <span class="quoted"><span class="quoted">"<span class="free">f</span> <span class="main">∈</span> <span class="keyword1">Ar</span> <span class="main">⟹</span> <span class="keyword1">Id</span> <span class="main">(</span><span class="keyword1">Cod</span> <span class="free">f</span><span class="main">)</span> <span class="main">∙</span> <span class="free">f</span> <span class="main">=</span> <span class="free">f</span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> id_right <span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span>
  <span class="quoted"><span class="quoted">"<span class="free">f</span> <span class="main">∈</span> <span class="keyword1">Ar</span> <span class="main">⟹</span> <span class="free">f</span> <span class="main">∙</span> <span class="keyword1">Id</span> <span class="main">(</span><span class="keyword1">Dom</span> <span class="free">f</span><span class="main">)</span> <span class="main">=</span> <span class="free">f</span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> id_hom <span class="main">[</span><span class="operator">intro</span><span class="main">]</span><span class="main">:</span>
  <span class="quoted"><span class="quoted">"<span class="free">A</span> <span class="main">∈</span> <span class="keyword1">Ob</span> <span class="main">⟹</span> <span class="keyword1">Id</span> <span class="free">A</span> <span class="main">∈</span> <span class="keyword1">Hom</span> <span class="free">A</span> <span class="free">A</span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> comp_types <span class="main">[</span><span class="operator">intro</span><span class="main">]</span><span class="main">:</span>
  <span class="quoted"><span class="quoted">"<span class="main">⋀</span><span class="bound">A</span> <span class="bound">B</span> <span class="bound">C</span><span class="main">.</span> <span class="main">(</span>comp <span class="free">CC</span><span class="main">)</span> <span class="main">:</span> <span class="main">(</span><span class="keyword1">Hom</span> <span class="bound">B</span> <span class="bound">C</span><span class="main">)</span> <span class="main">→</span> <span class="main">(</span><span class="keyword1">Hom</span> <span class="bound">A</span> <span class="bound">B</span><span class="main">)</span> <span class="main">→</span> <span class="main">(</span><span class="keyword1">Hom</span> <span class="bound">A</span> <span class="bound">C</span><span class="main">)</span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> comp_associative <span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span>
  <span class="quoted"><span class="quoted">"<span class="free">f</span> <span class="main">∈</span> <span class="keyword1">Ar</span> <span class="main">⟹</span> <span class="free">g</span> <span class="main">∈</span> <span class="keyword1">Ar</span> <span class="main">⟹</span> <span class="free">h</span> <span class="main">∈</span> <span class="keyword1">Ar</span>
  <span class="main">⟹</span> <span class="keyword1">Cod</span> <span class="free">h</span> <span class="main">=</span> <span class="keyword1">Dom</span> <span class="free">g</span> <span class="main">⟹</span> <span class="keyword1">Cod</span> <span class="free">g</span> <span class="main">=</span> <span class="keyword1">Dom</span> <span class="free">f</span>
  <span class="main">⟹</span> <span class="free">f</span> <span class="main">∙</span> <span class="main">(</span><span class="free">g</span> <span class="main">∙</span> <span class="free">h</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="free">f</span> <span class="main">∙</span> <span class="free">g</span><span class="main">)</span> <span class="main">∙</span> <span class="free">h</span>"</span></span>


<span class="keyword1"><span class="command">subsection</span></span> <span class="quoted"><span class="plain_text">‹Lemmas›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> category<span class="main">)</span> homI<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">f</span> <span class="main">∈</span> <span class="keyword1">Ar</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">Dom</span> <span class="free">f</span> <span class="main">=</span> <span class="free">A</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">Cod</span> <span class="free">f</span> <span class="main">=</span> <span class="free">B</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">f</span> <span class="main">∈</span> <span class="keyword1">Hom</span> <span class="free">A</span> <span class="free">B</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> hom_def<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> category<span class="main">)</span> homE<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">A</span> <span class="main">∈</span> <span class="keyword1">Ob</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">B</span> <span class="main">∈</span> <span class="keyword1">Ob</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">f</span> <span class="main">∈</span> <span class="keyword1">Hom</span> <span class="free">A</span> <span class="free">B</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">Dom</span> <span class="free">f</span> <span class="main">=</span> <span class="free">A</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">Cod</span> <span class="free">f</span> <span class="main">=</span> <span class="free">B</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">Dom</span> <span class="free">f</span> <span class="main">=</span> <span class="free">A</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> hom_def<span class="main">)</span> 
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">Cod</span> <span class="free">f</span> <span class="main">=</span> <span class="free">B</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> hom_def<span class="main">)</span> 
<span class="keyword1"><span class="command">qed</span></span>
   
<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> category<span class="main">)</span> id_arrow <span class="main">[</span><span class="operator">intro</span><span class="main">]</span><span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">A</span> <span class="main">∈</span> <span class="keyword1">Ob</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">Id</span> <span class="free">A</span> <span class="main">∈</span> <span class="keyword1">Ar</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
  <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="free">A</span> <span class="main">∈</span> <span class="keyword1">Ob</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">Id</span> <span class="free">A</span> <span class="main">∈</span> <span class="keyword1">Hom</span> <span class="free">A</span> <span class="free">A</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> id_hom<span class="main">)</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">Id</span> <span class="free">A</span> <span class="main">∈</span> <span class="keyword1">Ar</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> hom_def<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> category<span class="main">)</span> id_dom_cod<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">A</span> <span class="main">∈</span> <span class="keyword1">Ob</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">Dom</span> <span class="main">(</span><span class="keyword1">Id</span> <span class="free">A</span><span class="main">)</span> <span class="main">=</span> <span class="free">A</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">Cod</span> <span class="main">(</span><span class="keyword1">Id</span> <span class="free">A</span><span class="main">)</span> <span class="main">=</span> <span class="free">A</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
  <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="free">A</span> <span class="main">∈</span> <span class="keyword1">Ob</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> 1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="keyword1">Id</span> <span class="free">A</span> <span class="main">∈</span> <span class="keyword1">Hom</span> <span class="free">A</span> <span class="free">A</span>"</span></span> <span class="keyword1"><span class="command">..</span></span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">Dom</span> <span class="main">(</span><span class="keyword1">Id</span> <span class="free">A</span><span class="main">)</span> <span class="main">=</span> <span class="free">A</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">Cod</span> <span class="main">(</span><span class="keyword1">Id</span> <span class="free">A</span><span class="main">)</span> <span class="main">=</span> <span class="free">A</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp_all</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> hom_def<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>


<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> category<span class="main">)</span> compI <span class="main">[</span><span class="operator">intro</span><span class="main">]</span><span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> f<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">f</span> <span class="main">∈</span> <span class="keyword1">Ar</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> g<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">g</span> <span class="main">∈</span> <span class="keyword1">Ar</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">Cod</span> <span class="free">f</span> <span class="main">=</span> <span class="keyword1">Dom</span> <span class="free">g</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">g</span> <span class="main">∙</span> <span class="free">f</span> <span class="main">∈</span> <span class="keyword1">Ar</span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">Dom</span> <span class="main">(</span><span class="free">g</span> <span class="main">∙</span> <span class="free">f</span><span class="main">)</span> <span class="main">=</span> <span class="keyword1">Dom</span> <span class="free">f</span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">Cod</span> <span class="main">(</span><span class="free">g</span> <span class="main">∙</span> <span class="free">f</span><span class="main">)</span> <span class="main">=</span> <span class="keyword1">Cod</span> <span class="free">g</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">f</span> <span class="main">∈</span> <span class="keyword1">Hom</span> <span class="main">(</span><span class="keyword1">Dom</span> <span class="free">f</span><span class="main">)</span> <span class="main">(</span><span class="keyword1">Cod</span> <span class="free">f</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> f <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> hom_def<span class="main">)</span>
  <span class="keyword1"><span class="command">with</span></span> <span class="quoted"><span class="quoted">‹<span class="keyword1">Cod</span> <span class="free">f</span> <span class="main">=</span> <span class="keyword1">Dom</span> <span class="free">g</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> f_homset<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">f</span> <span class="main">∈</span> <span class="keyword1">Hom</span> <span class="main">(</span><span class="keyword1">Dom</span> <span class="free">f</span><span class="main">)</span> <span class="main">(</span><span class="keyword1">Dom</span> <span class="free">g</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">have</span></span> g_homset<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">g</span> <span class="main">∈</span> <span class="keyword1">Hom</span> <span class="main">(</span><span class="keyword1">Dom</span> <span class="free">g</span><span class="main">)</span> <span class="main">(</span><span class="keyword1">Cod</span> <span class="free">g</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> g <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> hom_def<span class="main">)</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(∙</span><span class="main">)</span> <span class="main">:</span> <span class="keyword1">Hom</span> <span class="main">(</span><span class="keyword1">Dom</span> <span class="free">g</span><span class="main">)</span> <span class="main">(</span><span class="keyword1">Cod</span> <span class="free">g</span><span class="main">)</span> <span class="main">→</span> <span class="keyword1">Hom</span> <span class="main">(</span><span class="keyword1">Dom</span> <span class="free">f</span><span class="main">)</span> <span class="main">(</span><span class="keyword1">Dom</span> <span class="free">g</span><span class="main">)</span> <span class="main">→</span> <span class="keyword1">Hom</span> <span class="main">(</span><span class="keyword1">Dom</span> <span class="free">f</span><span class="main">)</span> <span class="main">(</span><span class="keyword1">Cod</span> <span class="free">g</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">..</span></span>
  <span class="keyword1"><span class="command">from</span></span> this <span class="keyword2"><span class="keyword">and</span></span> g_homset 
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(∙</span><span class="main">)</span> <span class="free">g</span> <span class="main">∈</span> <span class="keyword1">Hom</span> <span class="main">(</span><span class="keyword1">Dom</span> <span class="free">f</span><span class="main">)</span> <span class="main">(</span><span class="keyword1">Dom</span> <span class="free">g</span><span class="main">)</span> <span class="main">→</span> <span class="keyword1">Hom</span> <span class="main">(</span><span class="keyword1">Dom</span> <span class="free">f</span><span class="main">)</span> <span class="main">(</span><span class="keyword1">Cod</span> <span class="free">g</span><span class="main">)</span>"</span></span> 
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> funcset_mem<span class="main">)</span>
  <span class="keyword1"><span class="command">from</span></span> this <span class="keyword2"><span class="keyword">and</span></span> f_homset 
  <span class="keyword1"><span class="command">have</span></span> gf_homset<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">g</span> <span class="main">∙</span> <span class="free">f</span> <span class="main">∈</span> <span class="keyword1">Hom</span> <span class="main">(</span><span class="keyword1">Dom</span> <span class="free">f</span><span class="main">)</span> <span class="main">(</span><span class="keyword1">Cod</span> <span class="free">g</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> funcset_mem<span class="main">)</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"<span class="free">g</span> <span class="main">∙</span> <span class="free">f</span> <span class="main">∈</span> <span class="keyword1">Ar</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> hom_def<span class="main">)</span> 
  <span class="keyword1"><span class="command">from</span></span> gf_homset <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">Dom</span> <span class="main">(</span><span class="free">g</span> <span class="main">∙</span> <span class="free">f</span><span class="main">)</span> <span class="main">=</span> <span class="keyword1">Dom</span> <span class="free">f</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">Cod</span> <span class="main">(</span><span class="free">g</span> <span class="main">∙</span> <span class="free">f</span><span class="main">)</span> <span class="main">=</span> <span class="keyword1">Cod</span> <span class="free">g</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp_all</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> hom_def<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword2"><span class="keyword">end</span></span>
</pre>
</div><div id="SetCat">
<div class="head">
<h1>Theory SetCat</h1>
</div>
<pre class="source"><span class="comment1">(*  Title:       Category theory using Isar and Locales
    Author:      Greg O'Keefe, June, July, August 2003
    License: LGPL
*)</span>

<span class="keyword1"><span class="command">section</span></span> <span class="quoted"><span class="plain_text">‹{{\sf Set}} is a Category›</span></span>

<span class="keyword1"><span class="command">theory</span></span> SetCat
<span class="keyword2"><span class="keyword">imports</span></span> <a href="Cat.html">Cat</a>
<span class="keyword2"><span class="keyword">begin</span></span>

<span class="keyword1"><span class="command">subsection</span></span><span class="quoted"><span class="plain_text">‹Definitions›</span></span>

<span class="keyword1"><span class="command">record</span></span> <span class="tfree">'c</span> set_arrow <span class="main">=</span>
  set_dom <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'c</span> set"</span></span>
  set_func <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'c</span> <span class="main">⇒</span> <span class="tfree">'c</span>"</span></span>
  set_cod <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'c</span> set"</span></span>

<span class="keyword1"><span class="command">definition</span></span>
  <span class="entity">set_arrow</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="main">[</span><span class="tfree">'c</span> set<span class="main">,</span> <span class="tfree">'c</span> set_arrow<span class="main">]</span> <span class="main">⇒</span> bool"</span></span> <span class="keyword2"><span class="keyword">where</span></span>
  <span class="quoted"><span class="quoted">"<span class="free">set_arrow</span> <span class="free"><span class="bound"><span class="entity">U</span></span></span> <span class="free"><span class="bound"><span class="entity">f</span></span></span> <span class="main">⟷</span> set_dom <span class="free"><span class="bound"><span class="entity">f</span></span></span> <span class="main">⊆</span> <span class="free"><span class="bound"><span class="entity">U</span></span></span> <span class="main">&amp;</span> set_cod <span class="free"><span class="bound"><span class="entity">f</span></span></span> <span class="main">⊆</span> <span class="free"><span class="bound"><span class="entity">U</span></span></span>
    <span class="main">&amp;</span> <span class="main">(</span>set_func <span class="free"><span class="bound"><span class="entity">f</span></span></span><span class="main">)</span><span class="main">:</span> <span class="main">(</span>set_dom <span class="free"><span class="bound"><span class="entity">f</span></span></span><span class="main">)</span> <span class="main">→</span> <span class="main">(</span>set_cod <span class="free"><span class="bound"><span class="entity">f</span></span></span><span class="main">)</span> 
    <span class="main">&amp;</span> set_func <span class="free"><span class="bound"><span class="entity">f</span></span></span> <span class="main">∈</span> extensional <span class="main">(</span>set_dom <span class="free"><span class="bound"><span class="entity">f</span></span></span><span class="main">)</span>"</span></span>

<span class="keyword1"><span class="command">definition</span></span>
  <span class="entity">set_id</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="main">[</span><span class="tfree">'c</span> set<span class="main">,</span> <span class="tfree">'c</span> set<span class="main">]</span> <span class="main">⇒</span> <span class="tfree">'c</span> set_arrow"</span></span> <span class="keyword2"><span class="keyword">where</span></span>
  <span class="quoted"><span class="quoted">"<span class="free">set_id</span> <span class="free"><span class="bound"><span class="entity">U</span></span></span> <span class="main">=</span> <span class="main">(</span><span class="main">λ</span><span class="bound">s</span><span class="main">∈</span>Pow <span class="free"><span class="bound"><span class="entity">U</span></span></span><span class="main">.</span> <span class="main">⦇</span>set_dom<span class="main">=</span><span class="bound">s</span><span class="main">,</span> set_func<span class="main">=</span><span class="main">λ</span><span class="bound">x</span><span class="main">∈</span><span class="bound">s</span><span class="main">.</span> <span class="bound">x</span><span class="main">,</span> set_cod<span class="main">=</span><span class="bound">s</span><span class="main">⦈</span><span class="main">)</span>"</span></span>

<span class="keyword1"><span class="command">definition</span></span>
  <span class="entity">set_comp</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="main">[</span><span class="tfree">'c</span> set_arrow<span class="main">,</span> <span class="tfree">'c</span> set_arrow<span class="main">]</span> <span class="main">⇒</span> <span class="tfree">'c</span> set_arrow"</span></span>  <span class="main">(</span><span class="keyword2"><span class="keyword">infix</span></span> <span class="quoted">"<span class="keyword1">⊙</span>"</span> 70<span class="main">)</span> <span class="keyword2"><span class="keyword">where</span></span>
  <span class="quoted"><span class="quoted">"<span class="free">set_comp</span> <span class="free"><span class="bound"><span class="entity">g</span></span></span> <span class="free"><span class="bound"><span class="entity">f</span></span></span> <span class="main">=</span>
  <span class="main">⦇</span>
    set_dom <span class="main">=</span> set_dom <span class="free"><span class="bound"><span class="entity">f</span></span></span><span class="main">,</span> 
    set_func <span class="main">=</span> compose <span class="main">(</span>set_dom <span class="free"><span class="bound"><span class="entity">f</span></span></span><span class="main">)</span> <span class="main">(</span>set_func <span class="free"><span class="bound"><span class="entity">g</span></span></span><span class="main">)</span> <span class="main">(</span>set_func <span class="free"><span class="bound"><span class="entity">f</span></span></span><span class="main">)</span><span class="main">,</span> 
    set_cod <span class="main">=</span> set_cod <span class="free"><span class="bound"><span class="entity">g</span></span></span>
  <span class="main">⦈</span>"</span></span>

<span class="keyword1"><span class="command">definition</span></span>
  <span class="entity">set_cat</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'c</span> set <span class="main">⇒</span> <span class="main">(</span><span class="tfree">'c</span> set<span class="main">,</span> <span class="tfree">'c</span> set_arrow<span class="main">)</span> category"</span></span> <span class="keyword2"><span class="keyword">where</span></span>
  <span class="quoted"><span class="quoted">"<span class="free">set_cat</span> <span class="free"><span class="bound"><span class="entity">U</span></span></span> <span class="main">=</span>
  <span class="main">⦇</span> 
    ob <span class="main">=</span> Pow <span class="free"><span class="bound"><span class="entity">U</span></span></span><span class="main">,</span>
    ar <span class="main">=</span> <span class="main">{</span><span class="bound">f</span><span class="main">.</span> set_arrow <span class="free"><span class="bound"><span class="entity">U</span></span></span> <span class="bound">f</span><span class="main">}</span><span class="main">,</span>
    dom <span class="main">=</span> set_dom<span class="main">,</span>
    cod <span class="main">=</span> set_cod<span class="main">,</span>
    id <span class="main">=</span> set_id <span class="free"><span class="bound"><span class="entity">U</span></span></span><span class="main">,</span> 
    comp <span class="main">=</span> set_comp
  <span class="main">⦈</span>"</span></span>


<span class="keyword1"><span class="command">subsection</span></span> <span class="quoted"><span class="plain_text">‹Simple Rules and Lemmas›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> set_objectI <span class="main">[</span><span class="operator">intro</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">A</span> <span class="main">⊆</span> <span class="free">U</span> <span class="main">⟹</span> <span class="free">A</span> <span class="main">∈</span> ob <span class="main">(</span>set_cat <span class="free">U</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> set_cat_def<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> set_objectE <span class="main">[</span><span class="operator">intro</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">A</span> <span class="main">∈</span> ob <span class="main">(</span>set_cat <span class="free">U</span><span class="main">)</span> <span class="main">⟹</span> <span class="free">A</span> <span class="main">⊆</span> <span class="free">U</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> set_cat_def<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> set_homI <span class="main">[</span><span class="operator">intro</span><span class="main">]</span><span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">A</span> <span class="main">⊆</span> <span class="free">U</span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">B</span> <span class="main">⊆</span> <span class="free">U</span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">f</span> <span class="main">:</span> <span class="free">A</span><span class="main">→</span><span class="free">B</span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">f</span> <span class="main">∈</span> extensional <span class="free">A</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">⦇</span>set_dom<span class="main">=</span><span class="free">A</span><span class="main">,</span> set_func<span class="main">=</span><span class="free">f</span><span class="main">,</span> set_cod<span class="main">=</span><span class="free">B</span><span class="main">⦈</span> <span class="main">∈</span> hom <span class="main">(</span>set_cat <span class="free">U</span><span class="main">)</span> <span class="free">A</span> <span class="free">B</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> set_cat_def hom_def set_arrow_def<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> set_dom <span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"dom <span class="main">(</span>set_cat <span class="free">U</span><span class="main">)</span> <span class="free">f</span> <span class="main">=</span> set_dom <span class="free">f</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> set_cat_def<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> set_cod <span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"cod <span class="main">(</span>set_cat <span class="free">U</span><span class="main">)</span> <span class="free">f</span> <span class="main">=</span> set_cod <span class="free">f</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> set_cat_def<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> set_id <span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"id <span class="main">(</span>set_cat <span class="free">U</span><span class="main">)</span> <span class="free">A</span> <span class="main">=</span> set_id <span class="free">U</span> <span class="free">A</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> set_cat_def<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> set_comp <span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"comp <span class="main">(</span>set_cat <span class="free">U</span><span class="main">)</span> <span class="free">g</span> <span class="free">f</span> <span class="main">=</span> <span class="free">g</span> <span class="main">⊙</span> <span class="free">f</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> set_cat_def<span class="main">)</span>
  

<span class="keyword1"><span class="command">lemma</span></span> set_dom_cod_object_subset <span class="main">[</span><span class="operator">intro</span><span class="main">]</span><span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> f<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">f</span> <span class="main">∈</span> ar <span class="main">(</span>set_cat <span class="free">U</span><span class="main">)</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"dom <span class="main">(</span>set_cat <span class="free">U</span><span class="main">)</span> <span class="free">f</span> <span class="main">∈</span> ob <span class="main">(</span>set_cat <span class="free">U</span><span class="main">)</span>"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"cod <span class="main">(</span>set_cat <span class="free">U</span><span class="main">)</span> <span class="free">f</span> <span class="main">∈</span> ob <span class="main">(</span>set_cat <span class="free">U</span><span class="main">)</span>"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"set_cod <span class="free">f</span> <span class="main">⊆</span> <span class="free">U</span>"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"set_dom <span class="free">f</span> <span class="main">⊆</span> <span class="free">U</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
  <span class="keyword1"><span class="command">note</span></span> <span class="main">[</span><span class="operator">simp</span><span class="main">]</span> <span class="main">=</span> set_cat_def set_arrow_def
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"dom <span class="main">(</span>set_cat <span class="free">U</span><span class="main">)</span> <span class="free">f</span> <span class="main">=</span> set_dom <span class="free">f</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> f <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">also</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">…</span> <span class="main">⊆</span> <span class="free">U</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> f <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">finally</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"dom <span class="main">(</span>set_cat <span class="free">U</span><span class="main">)</span> <span class="free">f</span> <span class="main">∈</span> ob <span class="main">(</span>set_cat <span class="free">U</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">..</span></span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"cod <span class="main">(</span>set_cat <span class="free">U</span><span class="main">)</span> <span class="free">f</span> <span class="main">=</span> set_cod <span class="free">f</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> f <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">also</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">…</span> <span class="main">⊆</span> <span class="free">U</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> f <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">finally</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"cod <span class="main">(</span>set_cat <span class="free">U</span><span class="main">)</span> <span class="free">f</span> <span class="main">∈</span> ob <span class="main">(</span>set_cat <span class="free">U</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">..</span></span>
<span class="keyword1"><span class="command">qed</span></span>


<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹In this context, <span class="antiquoted"><span class="raw_text"><span class="antiquoted"><span class="raw_text"><span class="operator"><span class="operator">‹</span></span>f ∈ hom A B›</span></span></span></span> is quite a strong claim.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> set_homE <span class="main">[</span><span class="operator">intro</span><span class="main">]</span><span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> f<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">f</span> <span class="main">∈</span> hom <span class="main">(</span>set_cat <span class="free">U</span><span class="main">)</span> <span class="free">A</span> <span class="free">B</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">A</span> <span class="main">⊆</span> <span class="free">U</span>"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">B</span> <span class="main">⊆</span> <span class="free">U</span>"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"set_dom <span class="free">f</span> <span class="main">=</span> <span class="free">A</span>"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"set_func <span class="free">f</span> <span class="main">:</span> <span class="free">A</span> <span class="main">→</span> <span class="free">B</span>"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"set_cod <span class="free">f</span> <span class="main">=</span> <span class="free">B</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> 1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">f</span> <span class="main">∈</span> ar <span class="main">(</span>set_cat <span class="free">U</span><span class="main">)</span>"</span></span> 
    <span class="keyword1"><span class="command">using</span></span> f <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> hom_def set_cat_def<span class="main">)</span>
  <span class="keyword3"><span class="command">show</span></span> 2<span class="main">:</span> <span class="quoted"><span class="quoted">"set_dom <span class="free">f</span> <span class="main">=</span> <span class="free">A</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> f <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> set_cat_def hom_def set_arrow_def<span class="main">)</span>
  <span class="keyword1"><span class="command">from</span></span> 1 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"set_dom <span class="free">f</span> <span class="main">⊆</span> <span class="free">U</span>"</span></span> <span class="keyword1"><span class="command">..</span></span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"<span class="free">A</span> <span class="main">⊆</span> <span class="free">U</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> 2<span class="main">)</span>
  <span class="keyword3"><span class="command">show</span></span> 3<span class="main">:</span> <span class="quoted"><span class="quoted">"set_cod <span class="free">f</span> <span class="main">=</span> <span class="free">B</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> f <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> set_cat_def hom_def set_arrow_def<span class="main">)</span>
  <span class="keyword1"><span class="command">from</span></span> 1 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"set_cod <span class="free">f</span> <span class="main">⊆</span> <span class="free">U</span>"</span></span> <span class="keyword1"><span class="command">..</span></span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"<span class="free">B</span> <span class="main">⊆</span> <span class="free">U</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> 3<span class="main">)</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"set_func <span class="free">f</span> <span class="main">∈</span> <span class="main">(</span>set_dom <span class="free">f</span><span class="main">)</span> <span class="main">→</span> <span class="main">(</span>set_cod <span class="free">f</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> f <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> set_cat_def hom_def set_arrow_def<span class="main">)</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"set_func <span class="free">f</span> <span class="main">∈</span> <span class="free">A</span> <span class="main">→</span> <span class="free">B</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> 2 3<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>


<span class="keyword1"><span class="command">subsection</span></span> <span class="quoted"><span class="plain_text">‹Set is a Category›</span></span>
<span class="keyword1"><span class="command">lemma</span></span> set_id_left<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> f<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">f</span> <span class="main">∈</span> ar <span class="main">(</span>set_cat <span class="free">U</span><span class="main">)</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"set_id <span class="free">U</span> <span class="main">(</span>set_cod <span class="free">f</span><span class="main">)</span> <span class="main">⊙</span> <span class="free">f</span> <span class="main">=</span> <span class="free">f</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
  <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="free">f</span> <span class="main">∈</span> ar <span class="main">(</span>set_cat <span class="free">U</span><span class="main">)</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"set_cod <span class="free">f</span> <span class="main">⊆</span> <span class="free">U</span>"</span></span> <span class="keyword1"><span class="command">..</span></span>
  <span class="keyword1"><span class="command">hence</span></span> 1<span class="main">:</span> <span class="quoted"><span class="quoted">"set_id <span class="free">U</span> <span class="main">(</span>set_cod <span class="free">f</span><span class="main">)</span> <span class="main">⊙</span> <span class="free">f</span> <span class="main">=</span> 
    <span class="main">⦇</span>
    set_dom<span class="main">=</span>set_dom <span class="free">f</span><span class="main">,</span> 
    set_func<span class="main">=</span>compose <span class="main">(</span>set_dom <span class="free">f</span><span class="main">)</span> <span class="main">(</span><span class="main">λ</span><span class="bound">x</span><span class="main">∈</span>set_cod <span class="free">f</span><span class="main">.</span> <span class="bound">x</span><span class="main">)</span> <span class="main">(</span>set_func <span class="free">f</span><span class="main">)</span><span class="main">,</span>
    set_cod<span class="main">=</span>set_cod <span class="free">f</span>
    <span class="main">⦈</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> f <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> set_comp_def set_id_def<span class="main">)</span>
  <span class="keyword1"><span class="command">have</span></span> 2<span class="main">:</span> <span class="quoted"><span class="quoted">"compose <span class="main">(</span>set_dom <span class="free">f</span><span class="main">)</span>  <span class="main">(</span><span class="main">λ</span><span class="bound">x</span><span class="main">∈</span>set_cod <span class="free">f</span><span class="main">.</span> <span class="bound">x</span><span class="main">)</span> <span class="main">(</span>set_func <span class="free">f</span><span class="main">)</span> <span class="main">=</span> set_func <span class="free">f</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">rule</span> extensionalityI<span class="main">)</span>
    <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"compose <span class="main">(</span>set_dom <span class="free">f</span><span class="main">)</span> <span class="main">(</span><span class="main">λ</span><span class="bound">x</span><span class="main">∈</span>set_cod <span class="free">f</span><span class="main">.</span> <span class="bound">x</span><span class="main">)</span> <span class="main">(</span>set_func <span class="free">f</span><span class="main">)</span> <span class="main">∈</span> extensional <span class="main">(</span>set_dom <span class="free">f</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> compose_extensional<span class="main">)</span>
    <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"set_func <span class="free">f</span> <span class="main">∈</span> extensional <span class="main">(</span>set_dom <span class="free">f</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> f <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> set_cat_def set_arrow_def<span class="main">)</span>
    <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">x</span>
    <span class="keyword3"><span class="command">assume</span></span> x_in_dom<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">∈</span> set_dom <span class="free">f</span>"</span></span>
    <span class="keyword1"><span class="command">have</span></span> f_into_cod<span class="main">:</span> <span class="quoted"><span class="quoted">"set_func <span class="free">f</span> <span class="main">:</span> <span class="main">(</span>set_dom <span class="free">f</span><span class="main">)</span> <span class="main">→</span> <span class="main">(</span>set_cod <span class="free">f</span><span class="main">)</span>"</span></span> 
      <span class="keyword1"><span class="command">using</span></span> f <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> set_cat_def set_arrow_def<span class="main">)</span>
    <span class="keyword1"><span class="command">from</span></span> f_into_cod <span class="keyword2"><span class="keyword">and</span></span> x_in_dom
    <span class="keyword1"><span class="command">have</span></span> f_x_in_cod<span class="main">:</span> <span class="quoted"><span class="quoted">"set_func <span class="free">f</span> <span class="skolem">x</span> <span class="main">∈</span> set_cod <span class="free">f</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> funcset_mem<span class="main">)</span>
    <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"compose <span class="main">(</span>set_dom <span class="free">f</span><span class="main">)</span> <span class="main">(</span><span class="main">λ</span><span class="bound">x</span><span class="main">∈</span>set_cod <span class="free">f</span><span class="main">.</span> <span class="bound">x</span><span class="main">)</span> <span class="main">(</span>set_func <span class="free">f</span><span class="main">)</span> <span class="skolem">x</span> <span class="main">=</span> set_func <span class="free">f</span> <span class="skolem">x</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> x_in_dom f_x_in_cod compose_def<span class="main">)</span>
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">from</span></span> 1 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"set_id <span class="free">U</span> <span class="main">(</span>set_cod <span class="free">f</span><span class="main">)</span> <span class="main">⊙</span> <span class="free">f</span> <span class="main">=</span> 
    <span class="main">⦇</span>
    set_dom<span class="main">=</span>set_dom <span class="free">f</span><span class="main">,</span> 
    set_func<span class="main">=</span>set_func <span class="free">f</span><span class="main">,</span>
    set_cod<span class="main">=</span>set_cod <span class="free">f</span>
    <span class="main">⦈</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">only</span><span class="main"><span class="main">:</span></span> 2<span class="main">)</span>
  <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">…</span> <span class="main">=</span> <span class="free">f</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">finally</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">.</span></span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">lemma</span></span> set_id_right<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> f<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">f</span> <span class="main">∈</span> ar <span class="main">(</span>set_cat <span class="free">U</span><span class="main">)</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">f</span> <span class="main">⊙</span> <span class="main">(</span>set_id <span class="free">U</span> <span class="main">(</span>set_dom <span class="free">f</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> <span class="free">f</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
  <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="free">f</span> <span class="main">∈</span> ar <span class="main">(</span>set_cat <span class="free">U</span><span class="main">)</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"set_dom <span class="free">f</span> <span class="main">⊆</span> <span class="free">U</span>"</span></span> <span class="keyword1"><span class="command">..</span></span>
  <span class="keyword1"><span class="command">hence</span></span> 1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">f</span> <span class="main">⊙</span> <span class="main">(</span>set_id <span class="free">U</span> <span class="main">(</span>set_dom <span class="free">f</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> 
    <span class="main">⦇</span>
    set_dom<span class="main">=</span>set_dom <span class="free">f</span><span class="main">,</span> 
    set_func<span class="main">=</span>compose <span class="main">(</span>set_dom <span class="free">f</span><span class="main">)</span> <span class="main">(</span>set_func <span class="free">f</span><span class="main">)</span> <span class="main">(</span><span class="main">λ</span><span class="bound">x</span><span class="main">∈</span>set_dom <span class="free">f</span><span class="main">.</span> <span class="bound">x</span><span class="main">)</span><span class="main">,</span>
    set_cod<span class="main">=</span>set_cod <span class="free">f</span>
    <span class="main">⦈</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> f <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> set_comp_def set_id_def<span class="main">)</span>
  <span class="keyword1"><span class="command">have</span></span> 2<span class="main">:</span> <span class="quoted"><span class="quoted">"compose <span class="main">(</span>set_dom <span class="free">f</span><span class="main">)</span> <span class="main">(</span>set_func <span class="free">f</span><span class="main">)</span> <span class="main">(</span><span class="main">λ</span><span class="bound">x</span><span class="main">∈</span>set_dom <span class="free">f</span><span class="main">.</span> <span class="bound">x</span><span class="main">)</span> <span class="main">=</span> set_func <span class="free">f</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">rule</span> extensionalityI<span class="main">)</span>
    <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"compose <span class="main">(</span>set_dom <span class="free">f</span><span class="main">)</span> <span class="main">(</span>set_func <span class="free">f</span><span class="main">)</span> <span class="main">(</span><span class="main">λ</span><span class="bound">x</span><span class="main">∈</span>set_dom <span class="free">f</span><span class="main">.</span> <span class="bound">x</span><span class="main">)</span> <span class="main">∈</span> extensional <span class="main">(</span>set_dom <span class="free">f</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> compose_extensional<span class="main">)</span>
    <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"set_func <span class="free">f</span> <span class="main">∈</span> extensional <span class="main">(</span>set_dom <span class="free">f</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> f <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> set_cat_def set_arrow_def<span class="main">)</span>
    <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">x</span>
    <span class="keyword3"><span class="command">assume</span></span> x_in_dom<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">∈</span> set_dom <span class="free">f</span>"</span></span>
    <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"compose <span class="main">(</span>set_dom <span class="free">f</span><span class="main">)</span> <span class="main">(</span>set_func <span class="free">f</span><span class="main">)</span> <span class="main">(</span><span class="main">λ</span><span class="bound">x</span><span class="main">∈</span>set_dom <span class="free">f</span><span class="main">.</span> <span class="bound">x</span><span class="main">)</span> <span class="skolem">x</span> <span class="main">=</span> set_func <span class="free">f</span> <span class="skolem">x</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> compose_def<span class="main">)</span>
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">from</span></span> 1 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">f</span> <span class="main">⊙</span> <span class="main">(</span>set_id <span class="free">U</span> <span class="main">(</span>set_dom <span class="free">f</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> 
    <span class="main">⦇</span>
    set_dom<span class="main">=</span>set_dom <span class="free">f</span><span class="main">,</span> 
    set_func<span class="main">=</span>set_func <span class="free">f</span><span class="main">,</span>
    set_cod<span class="main">=</span>set_cod <span class="free">f</span>
    <span class="main">⦈</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">only</span><span class="main"><span class="main">:</span></span> 2<span class="main">)</span>
  <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">…</span> <span class="main">=</span> <span class="free">f</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">finally</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">.</span></span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">lemma</span></span> set_id_hom<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">A</span> <span class="main">∈</span> ob <span class="main">(</span>set_cat <span class="free">U</span><span class="main">)</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"id <span class="main">(</span>set_cat <span class="free">U</span><span class="main">)</span> <span class="free">A</span> <span class="main">∈</span> hom <span class="main">(</span>set_cat <span class="free">U</span><span class="main">)</span> <span class="free">A</span> <span class="free">A</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
  <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="free">A</span> <span class="main">∈</span> ob <span class="main">(</span>set_cat <span class="free">U</span><span class="main">)</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> 1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">A</span> <span class="main">⊆</span> <span class="free">U</span>"</span></span> <span class="keyword1"><span class="command">..</span></span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"id <span class="main">(</span>set_cat <span class="free">U</span><span class="main">)</span> <span class="free">A</span> <span class="main">=</span> <span class="main">⦇</span>set_dom<span class="main">=</span><span class="free">A</span><span class="main">,</span> set_func<span class="main">=</span><span class="main">λ</span><span class="bound">x</span><span class="main">∈</span><span class="free">A</span><span class="main">.</span> <span class="bound">x</span><span class="main">,</span> set_cod<span class="main">=</span><span class="free">A</span><span class="main">⦈</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> set_cat_def set_id_def<span class="main">)</span>
  <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">…</span> <span class="main">∈</span> hom <span class="main">(</span>set_cat <span class="free">U</span><span class="main">)</span> <span class="free">A</span> <span class="free">A</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">rule</span> set_homI<span class="main">)</span>
    <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">λ</span><span class="bound">x</span><span class="main">∈</span><span class="free">A</span><span class="main">.</span> <span class="bound">x</span><span class="main">)</span> <span class="main">∈</span> <span class="free">A</span> <span class="main">→</span> <span class="free">A</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> funcsetI<span class="main"><span class="keyword3">,</span></span> <span class="operator">auto</span><span class="main">)</span>
    <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">λ</span><span class="bound">x</span><span class="main">∈</span><span class="free">A</span><span class="main">.</span> <span class="bound">x</span><span class="main">)</span> <span class="main">∈</span> extensional <span class="free">A</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> restrict_extensional<span class="main">)</span>
  <span class="keyword1"><span class="command">qed</span></span> <span class="main">(</span><span class="operator">rule</span> 1<span class="main"><span class="keyword3">,</span></span> <span class="operator">rule</span> 1<span class="main">)</span>
  <span class="keyword1"><span class="command">finally</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">.</span></span>
<span class="keyword1"><span class="command">qed</span></span>


<span class="keyword1"><span class="command">lemma</span></span> set_comp_types<span class="main">:</span>
<span class="quoted"><span class="quoted">"comp <span class="main">(</span>set_cat <span class="free">U</span><span class="main">)</span> <span class="main">∈</span> hom <span class="main">(</span>set_cat <span class="free">U</span><span class="main">)</span> <span class="free">B</span> <span class="free">C</span> <span class="main">→</span> hom <span class="main">(</span>set_cat <span class="free">U</span><span class="main">)</span> <span class="free">A</span> <span class="free">B</span> <span class="main">→</span> hom <span class="main">(</span>set_cat <span class="free">U</span><span class="main">)</span> <span class="free">A</span> <span class="free">C</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">rule</span> funcsetI<span class="main">)</span>
  <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">g</span>
  <span class="keyword3"><span class="command">assume</span></span> g_BC<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">g</span> <span class="main">∈</span> hom <span class="main">(</span>set_cat <span class="free">U</span><span class="main">)</span> <span class="free">B</span> <span class="free">C</span>"</span></span>
  <span class="keyword1"><span class="command">hence</span></span> comp_cod<span class="main">:</span> <span class="quoted"><span class="quoted">"set_cod <span class="skolem">g</span> <span class="main">=</span> <span class="free">C</span>"</span></span> <span class="keyword1"><span class="command">..</span></span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"comp <span class="main">(</span>set_cat <span class="free">U</span><span class="main">)</span> <span class="skolem">g</span> <span class="main">∈</span> hom <span class="main">(</span>set_cat <span class="free">U</span><span class="main">)</span> <span class="free">A</span> <span class="free">B</span> <span class="main">→</span> hom <span class="main">(</span>set_cat <span class="free">U</span><span class="main">)</span> <span class="free">A</span> <span class="free">C</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">rule</span> funcsetI<span class="main">)</span>
    <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">f</span>
    <span class="keyword3"><span class="command">assume</span></span> f_AB<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">f</span> <span class="main">∈</span> hom <span class="main">(</span>set_cat <span class="free">U</span><span class="main">)</span> <span class="free">A</span> <span class="free">B</span>"</span></span>
    <span class="keyword1"><span class="command">hence</span></span> comp_dom<span class="main">:</span> <span class="quoted"><span class="quoted">"set_dom <span class="skolem">f</span> <span class="main">=</span> <span class="free">A</span>"</span></span> <span class="keyword1"><span class="command">..</span></span>
    <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"comp <span class="main">(</span>set_cat <span class="free">U</span><span class="main">)</span> <span class="skolem">g</span> <span class="skolem">f</span> <span class="main">∈</span> hom <span class="main">(</span>set_cat <span class="free">U</span><span class="main">)</span> <span class="free">A</span> <span class="free">C</span>"</span></span>
    <span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
      <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"comp <span class="main">(</span>set_cat <span class="free">U</span><span class="main">)</span> <span class="skolem">g</span> <span class="skolem">f</span> <span class="main">=</span> 
        <span class="main">⦇</span>
        set_dom <span class="main">=</span> <span class="free">A</span><span class="main">,</span> 
        set_func <span class="main">=</span> compose <span class="main">(</span>set_dom <span class="skolem">f</span><span class="main">)</span> <span class="main">(</span>set_func <span class="skolem">g</span><span class="main">)</span> <span class="main">(</span>set_func <span class="skolem">f</span><span class="main">)</span><span class="main">,</span>
        set_cod <span class="main">=</span> <span class="free">C</span>
        <span class="main">⦈</span>"</span></span>
        <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> set_cat_def set_comp_def comp_cod comp_dom<span class="main">)</span>
      <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">…</span> <span class="main">∈</span> hom <span class="main">(</span>set_cat <span class="free">U</span><span class="main">)</span> <span class="free">A</span> <span class="free">C</span>"</span></span>
      <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">rule</span> set_homI<span class="main">)</span>
        <span class="keyword1"><span class="command">from</span></span> f_AB <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="free">A</span> <span class="main">⊆</span> <span class="free">U</span>"</span></span> <span class="keyword1"><span class="command">..</span></span>
        <span class="keyword1"><span class="command">from</span></span> g_BC <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="free">C</span> <span class="main">⊆</span> <span class="free">U</span>"</span></span> <span class="keyword1"><span class="command">..</span></span>
        <span class="keyword1"><span class="command">from</span></span> f_AB <span class="keyword1"><span class="command">have</span></span> fs_f<span class="main">:</span> <span class="quoted"><span class="quoted">"set_func <span class="skolem">f</span><span class="main">:</span> <span class="free">A</span> <span class="main">→</span> <span class="free">B</span>"</span></span> <span class="keyword1"><span class="command">..</span></span>
        <span class="keyword1"><span class="command">from</span></span> g_BC <span class="keyword1"><span class="command">have</span></span> fs_g<span class="main">:</span> <span class="quoted"><span class="quoted">"set_func <span class="skolem">g</span><span class="main">:</span> <span class="free">B</span> <span class="main">→</span> <span class="free">C</span>"</span></span> <span class="keyword1"><span class="command">..</span></span>
        <span class="keyword1"><span class="command">from</span></span> fs_g <span class="keyword2"><span class="keyword">and</span></span> fs_f
        <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">" compose <span class="main">(</span>set_dom <span class="skolem">f</span><span class="main">)</span> <span class="main">(</span>set_func <span class="skolem">g</span><span class="main">)</span> <span class="main">(</span>set_func <span class="skolem">f</span><span class="main">)</span> <span class="main">:</span> <span class="free">A</span> <span class="main">→</span> <span class="free">C</span>"</span></span>
          <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">only</span><span class="main"><span class="main">:</span></span> comp_dom<span class="main">)</span> <span class="main">(</span><span class="operator">rule</span> funcset_compose<span class="main">)</span>
        <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"compose <span class="main">(</span>set_dom <span class="skolem">f</span><span class="main">)</span> <span class="main">(</span>set_func <span class="skolem">g</span><span class="main">)</span> <span class="main">(</span>set_func <span class="skolem">f</span><span class="main">)</span> <span class="main">∈</span> extensional <span class="free">A</span>"</span></span>
          <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">only</span><span class="main"><span class="main">:</span></span> comp_dom<span class="main">)</span> <span class="main">(</span><span class="operator">rule</span> compose_extensional<span class="main">)</span>
      <span class="keyword1"><span class="command">qed</span></span>
      <span class="keyword1"><span class="command">finally</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">.</span></span>
    <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">qed</span></span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹We reason explicitly about the function component of the
composite arrow, leaving the rest to the simplifier.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> set_comp_associative<span class="main">:</span>
  <span class="keyword2"><span class="keyword">fixes</span></span> <span class="free">f</span> <span class="keyword2"><span class="keyword">and</span></span> <span class="free">g</span> <span class="keyword2"><span class="keyword">and</span></span> <span class="free">h</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> f<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">f</span> <span class="main">∈</span> ar <span class="main">(</span>set_cat <span class="free">U</span><span class="main">)</span>"</span></span> 
    <span class="keyword2"><span class="keyword">and</span></span> g<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">g</span> <span class="main">∈</span> ar <span class="main">(</span>set_cat <span class="free">U</span><span class="main">)</span>"</span></span> 
    <span class="keyword2"><span class="keyword">and</span></span> h<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">h</span> <span class="main">∈</span> ar <span class="main">(</span>set_cat <span class="free">U</span><span class="main">)</span>"</span></span> 
    <span class="keyword2"><span class="keyword">and</span></span> hg<span class="main">:</span> <span class="quoted"><span class="quoted">"cod <span class="main">(</span>set_cat <span class="free">U</span><span class="main">)</span> <span class="free">h</span> <span class="main">=</span> dom <span class="main">(</span>set_cat <span class="free">U</span><span class="main">)</span> <span class="free">g</span>"</span></span> 
    <span class="keyword2"><span class="keyword">and</span></span> gf<span class="main">:</span> <span class="quoted"><span class="quoted">"cod <span class="main">(</span>set_cat <span class="free">U</span><span class="main">)</span> <span class="free">g</span> <span class="main">=</span> dom <span class="main">(</span>set_cat <span class="free">U</span><span class="main">)</span> <span class="free">f</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"comp <span class="main">(</span>set_cat <span class="free">U</span><span class="main">)</span> <span class="free">f</span> <span class="main">(</span>comp <span class="main">(</span>set_cat <span class="free">U</span><span class="main">)</span> <span class="free">g</span> <span class="free">h</span><span class="main">)</span> <span class="main">=</span>
  comp <span class="main">(</span>set_cat <span class="free">U</span><span class="main">)</span> <span class="main">(</span>comp <span class="main">(</span>set_cat <span class="free">U</span><span class="main">)</span> <span class="free">f</span> <span class="free">g</span><span class="main">)</span> <span class="free">h</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> set_cat_def set_comp_def<span class="main">)</span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"compose <span class="main">(</span>set_dom <span class="free">h</span><span class="main">)</span> <span class="main">(</span>set_func <span class="free">f</span><span class="main">)</span> <span class="main">(</span>compose <span class="main">(</span>set_dom <span class="free">h</span><span class="main">)</span> <span class="main">(</span>set_func <span class="free">g</span><span class="main">)</span> <span class="main">(</span>set_func <span class="free">h</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span>
    compose <span class="main">(</span>set_dom <span class="free">h</span><span class="main">)</span> <span class="main">(</span>compose <span class="main">(</span>set_dom <span class="free">g</span><span class="main">)</span> <span class="main">(</span>set_func <span class="free">f</span><span class="main">)</span> <span class="main">(</span>set_func <span class="free">g</span><span class="main">)</span><span class="main">)</span> <span class="main">(</span>set_func <span class="free">h</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">rule</span> compose_assoc<span class="main">)</span>
    <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"set_func <span class="free">h</span> <span class="main">∈</span> set_dom <span class="free">h</span> <span class="main">→</span> set_dom <span class="free">g</span>"</span></span> 
      <span class="keyword1"><span class="command">using</span></span> h hg <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> set_cat_def set_arrow_def<span class="main">)</span>
  <span class="keyword1"><span class="command">qed</span></span>
<span class="keyword1"><span class="command">qed</span></span>


<span class="keyword1"><span class="command">theorem</span></span> set_cat_cat<span class="main">:</span>  <span class="quoted"><span class="quoted">"category <span class="main">(</span>set_cat <span class="free">U</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">rule</span> category.intro<span class="main">)</span>
  <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">f</span>
  <span class="keyword3"><span class="command">assume</span></span> f<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">f</span> <span class="main">∈</span> ar <span class="main">(</span>set_cat <span class="free">U</span><span class="main">)</span>"</span></span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"dom <span class="main">(</span>set_cat <span class="free">U</span><span class="main">)</span> <span class="skolem">f</span> <span class="main">∈</span> ob <span class="main">(</span>set_cat <span class="free">U</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> f <span class="keyword1"><span class="command">..</span></span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"cod <span class="main">(</span>set_cat <span class="free">U</span><span class="main">)</span> <span class="skolem">f</span> <span class="main">∈</span> ob <span class="main">(</span>set_cat <span class="free">U</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> f <span class="keyword1"><span class="command">..</span></span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"comp <span class="main">(</span>set_cat <span class="free">U</span><span class="main">)</span> <span class="main">(</span>id <span class="main">(</span>set_cat <span class="free">U</span><span class="main">)</span> <span class="main">(</span>cod <span class="main">(</span>set_cat <span class="free">U</span><span class="main">)</span> <span class="skolem">f</span><span class="main">)</span><span class="main">)</span> <span class="skolem">f</span> <span class="main">=</span> <span class="skolem">f</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> f <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> set_id_left<span class="main">)</span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"comp <span class="main">(</span>set_cat <span class="free">U</span><span class="main">)</span> <span class="skolem">f</span> <span class="main">(</span>id <span class="main">(</span>set_cat <span class="free">U</span><span class="main">)</span> <span class="main">(</span>dom <span class="main">(</span>set_cat <span class="free">U</span><span class="main">)</span> <span class="skolem">f</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> <span class="skolem">f</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> f <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> set_id_right<span class="main">)</span>
<span class="keyword1"><span class="command">next</span></span>
  <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">A</span>
  <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">A</span> <span class="main">∈</span> ob <span class="main">(</span>set_cat <span class="free">U</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"id <span class="main">(</span>set_cat <span class="free">U</span><span class="main">)</span> <span class="skolem">A</span> <span class="main">∈</span> hom <span class="main">(</span>set_cat <span class="free">U</span><span class="main">)</span> <span class="skolem">A</span> <span class="skolem">A</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> set_id_hom<span class="main">)</span>
<span class="keyword1"><span class="command">next</span></span>
  <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">A</span> <span class="keyword2"><span class="keyword">and</span></span> <span class="skolem">B</span> <span class="keyword2"><span class="keyword">and</span></span> <span class="skolem">C</span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"comp <span class="main">(</span>set_cat <span class="free">U</span><span class="main">)</span> <span class="main">∈</span> hom <span class="main">(</span>set_cat <span class="free">U</span><span class="main">)</span> <span class="skolem">B</span> <span class="skolem">C</span> <span class="main">→</span> hom <span class="main">(</span>set_cat <span class="free">U</span><span class="main">)</span> <span class="skolem">A</span> <span class="skolem">B</span> <span class="main">→</span> hom <span class="main">(</span>set_cat <span class="free">U</span><span class="main">)</span> <span class="skolem">A</span> <span class="skolem">C</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> set_comp_types<span class="main">)</span>
<span class="keyword1"><span class="command">next</span></span>
  <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">f</span> <span class="keyword2"><span class="keyword">and</span></span> <span class="skolem">g</span> <span class="keyword2"><span class="keyword">and</span></span> <span class="skolem">h</span>
  <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">f</span> <span class="main">∈</span> ar <span class="main">(</span>set_cat <span class="free">U</span><span class="main">)</span>"</span></span> 
    <span class="keyword2"><span class="keyword">and</span></span>  <span class="quoted"><span class="quoted">"<span class="skolem">g</span> <span class="main">∈</span> ar <span class="main">(</span>set_cat <span class="free">U</span><span class="main">)</span>"</span></span> 
    <span class="keyword2"><span class="keyword">and</span></span>  <span class="quoted"><span class="quoted">"<span class="skolem">h</span> <span class="main">∈</span> ar <span class="main">(</span>set_cat <span class="free">U</span><span class="main">)</span>"</span></span> 
    <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"cod <span class="main">(</span>set_cat <span class="free">U</span><span class="main">)</span> <span class="skolem">h</span> <span class="main">=</span> dom <span class="main">(</span>set_cat <span class="free">U</span><span class="main">)</span> <span class="skolem">g</span>"</span></span> 
    <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"cod <span class="main">(</span>set_cat <span class="free">U</span><span class="main">)</span> <span class="skolem">g</span> <span class="main">=</span> dom <span class="main">(</span>set_cat <span class="free">U</span><span class="main">)</span> <span class="skolem">f</span>"</span></span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"comp <span class="main">(</span>set_cat <span class="free">U</span><span class="main">)</span> <span class="skolem">f</span> <span class="main">(</span>comp <span class="main">(</span>set_cat <span class="free">U</span><span class="main">)</span> <span class="skolem">g</span> <span class="skolem">h</span><span class="main">)</span> <span class="main">=</span>
    comp <span class="main">(</span>set_cat <span class="free">U</span><span class="main">)</span> <span class="main">(</span>comp <span class="main">(</span>set_cat <span class="free">U</span><span class="main">)</span> <span class="skolem">f</span> <span class="skolem">g</span><span class="main">)</span> <span class="skolem">h</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> set_comp_associative<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword2"><span class="keyword">end</span></span>
</pre>
</div><div id="Functors">
<div class="head">
<h1>Theory Functors</h1>
</div>
<pre class="source"><span class="comment1">(*  Title:       Category theory using Isar and Locales
    Author:      Greg O'Keefe, June, July, August 2003
    License: LGPL

Functors: Define functors and prove a trivial example.
*)</span>

<span class="keyword1"><span class="command">section</span></span> <span class="quoted"><span class="plain_text">‹Functors›</span></span>

<span class="keyword1"><span class="command">theory</span></span> Functors
<span class="keyword2"><span class="keyword">imports</span></span> <a href="Cat.html">Cat</a>
<span class="keyword2"><span class="keyword">begin</span></span>

<span class="keyword1"><span class="command">subsection</span></span> <span class="quoted"><span class="plain_text">‹Definitions›</span></span>

<span class="keyword1"><span class="command">record</span></span> <span class="main">(</span><span class="tfree">'o1</span><span class="main">,</span><span class="tfree">'a1</span><span class="main">,</span><span class="tfree">'o2</span><span class="main">,</span><span class="tfree">'a2</span><span class="main">)</span> <span class="quoted">"functor"</span> <span class="main">=</span>
  om <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'o1</span> <span class="main">⇒</span> <span class="tfree">'o2</span>"</span></span>
  am <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'a1</span> <span class="main">⇒</span> <span class="tfree">'a2</span>"</span></span>

<span class="keyword1"><span class="command">abbreviation</span></span>
  <span class="entity">om_syn</span>  <span class="main">(</span><span class="quoted">"_ <span class="keyword1"><span class="hidden">⇘</span><sub>𝗈</sub><span class="hidden">⇙</span></span>"</span> <span class="main">[</span>81<span class="main">]</span><span class="main">)</span> <span class="keyword2"><span class="keyword">where</span></span>
  <span class="quoted"><span class="quoted">"<span class="free"><span class="bound"><span class="entity">F</span></span></span><span class="keyword1"><span class="free"><span class="hidden">⇘</span><sub>𝗈</sub><span class="hidden">⇙</span></span></span> <span class="main">≡</span> om <span class="free"><span class="bound"><span class="entity">F</span></span></span>"</span></span>

<span class="keyword1"><span class="command">abbreviation</span></span>
  <span class="entity">am_syn</span>  <span class="main">(</span><span class="quoted">"_ <span class="keyword1"><span class="hidden">⇘</span><sub>𝖺</sub><span class="hidden">⇙</span></span>"</span> <span class="main">[</span>81<span class="main">]</span><span class="main">)</span> <span class="keyword2"><span class="keyword">where</span></span>
  <span class="quoted"><span class="quoted">"<span class="free"><span class="bound"><span class="entity">F</span></span></span><span class="keyword1"><span class="free"><span class="hidden">⇘</span><sub>𝖺</sub><span class="hidden">⇙</span></span></span> <span class="main">≡</span> am <span class="free"><span class="bound"><span class="entity">F</span></span></span>"</span></span>

<span class="keyword1"><span class="command">locale</span></span> two_cats <span class="main">=</span> AA<span class="main">?</span><span class="main">:</span> category <span class="quoted"><span class="free">AA</span></span> <span class="main">+</span> BB<span class="main">?</span><span class="main">:</span> category <span class="quoted"><span class="free">BB</span></span>
    <span class="keyword2"><span class="keyword">for</span></span> <span class="free">AA</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="tfree">'o1</span><span class="main">,</span><span class="tfree">'a1</span><span class="main">,</span><span class="tfree">'m1</span><span class="main">)</span>category_scheme"</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">structure</span></span><span class="main">)</span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="free">BB</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="tfree">'o2</span><span class="main">,</span><span class="tfree">'a2</span><span class="main">,</span><span class="tfree">'m2</span><span class="main">)</span>category_scheme"</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">structure</span></span><span class="main">)</span> <span class="main">+</span> 
  <span class="keyword2"><span class="keyword">fixes</span></span> <span class="free">preserves_dom</span>  <span class="main">::</span>  <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="tfree">'o1</span><span class="main">,</span><span class="tfree">'a1</span><span class="main">,</span><span class="tfree">'o2</span><span class="main">,</span><span class="tfree">'a2</span><span class="main">)</span>functor <span class="main">⇒</span> bool"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="free">preserves_cod</span>  <span class="main">::</span>  <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="tfree">'o1</span><span class="main">,</span><span class="tfree">'a1</span><span class="main">,</span><span class="tfree">'o2</span><span class="main">,</span><span class="tfree">'a2</span><span class="main">)</span>functor <span class="main">⇒</span> bool"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="free">preserves_id</span>  <span class="main">::</span>  <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="tfree">'o1</span><span class="main">,</span><span class="tfree">'a1</span><span class="main">,</span><span class="tfree">'o2</span><span class="main">,</span><span class="tfree">'a2</span><span class="main">)</span>functor <span class="main">⇒</span> bool"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="free">preserves_comp</span>  <span class="main">::</span>  <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="tfree">'o1</span><span class="main">,</span><span class="tfree">'a1</span><span class="main">,</span><span class="tfree">'o2</span><span class="main">,</span><span class="tfree">'a2</span><span class="main">)</span>functor <span class="main">⇒</span> bool"</span></span>
  <span class="keyword2"><span class="keyword">defines</span></span> <span class="quoted"><span class="quoted">"<span class="free">preserves_dom</span> <span class="free">G</span> <span class="main">≡</span> <span class="main">∀</span><span class="bound">f</span><span class="main">∈</span><span class="keyword1">Ar</span><span class="main"><span class="hidden">⇘</span><sub></sub></span><span class="free">AA</span><span class="main"><span class="hidden">⇙</span></span><span class="main">.</span> <span class="free">G</span><span class="keyword1"><span class="hidden">⇘</span><sub>𝗈</sub><span class="hidden">⇙</span></span> <span class="main">(</span><span class="keyword1">Dom</span><span class="main"><span class="hidden">⇘</span><sub></sub></span><span class="free">AA</span><span class="main"><span class="hidden">⇙</span></span> <span class="bound">f</span><span class="main">)</span> <span class="main">=</span> <span class="keyword1">Dom</span><span class="main"><span class="hidden">⇘</span><sub></sub></span><span class="free">BB</span><span class="main"><span class="hidden">⇙</span></span> <span class="main">(</span><span class="free">G</span><span class="keyword1"><span class="hidden">⇘</span><sub>𝖺</sub><span class="hidden">⇙</span></span> <span class="bound">f</span><span class="main">)</span>"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">preserves_cod</span> <span class="free">G</span> <span class="main">≡</span> <span class="main">∀</span><span class="bound">f</span><span class="main">∈</span><span class="keyword1">Ar</span><span class="main"><span class="hidden">⇘</span><sub></sub></span><span class="free">AA</span><span class="main"><span class="hidden">⇙</span></span><span class="main">.</span> <span class="free">G</span><span class="keyword1"><span class="hidden">⇘</span><sub>𝗈</sub><span class="hidden">⇙</span></span> <span class="main">(</span><span class="keyword1">Cod</span><span class="main"><span class="hidden">⇘</span><sub></sub></span><span class="free">AA</span><span class="main"><span class="hidden">⇙</span></span> <span class="bound">f</span><span class="main">)</span> <span class="main">=</span> <span class="keyword1">Cod</span><span class="main"><span class="hidden">⇘</span><sub></sub></span><span class="free">BB</span><span class="main"><span class="hidden">⇙</span></span> <span class="main">(</span><span class="free">G</span><span class="keyword1"><span class="hidden">⇘</span><sub>𝖺</sub><span class="hidden">⇙</span></span> <span class="bound">f</span><span class="main">)</span>"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">preserves_id</span> <span class="free">G</span> <span class="main">≡</span> <span class="main">∀</span><span class="bound">A</span><span class="main">∈</span><span class="keyword1">Ob</span><span class="main"><span class="hidden">⇘</span><sub></sub></span><span class="free">AA</span><span class="main"><span class="hidden">⇙</span></span><span class="main">.</span> <span class="free">G</span><span class="keyword1"><span class="hidden">⇘</span><sub>𝖺</sub><span class="hidden">⇙</span></span> <span class="main">(</span><span class="keyword1">Id</span><span class="main"><span class="hidden">⇘</span><sub></sub></span><span class="free">AA</span><span class="main"><span class="hidden">⇙</span></span> <span class="bound">A</span><span class="main">)</span> <span class="main">=</span> <span class="keyword1">Id</span><span class="main"><span class="hidden">⇘</span><sub></sub></span><span class="free">BB</span><span class="main"><span class="hidden">⇙</span></span> <span class="main">(</span><span class="free">G</span><span class="keyword1"><span class="hidden">⇘</span><sub>𝗈</sub><span class="hidden">⇙</span></span> <span class="bound">A</span><span class="main">)</span>"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">preserves_comp</span> <span class="free">G</span> <span class="main">≡</span>
      <span class="main">∀</span><span class="bound">f</span><span class="main">∈</span><span class="keyword1">Ar</span><span class="main"><span class="hidden">⇘</span><sub></sub></span><span class="free">AA</span><span class="main"><span class="hidden">⇙</span></span><span class="main">.</span> <span class="main">∀</span><span class="bound">g</span><span class="main">∈</span><span class="keyword1">Ar</span><span class="main"><span class="hidden">⇘</span><sub></sub></span><span class="free">AA</span><span class="main"><span class="hidden">⇙</span></span><span class="main">.</span> <span class="keyword1">Cod</span><span class="main"><span class="hidden">⇘</span><sub></sub></span><span class="free">AA</span><span class="main"><span class="hidden">⇙</span></span> <span class="bound">f</span> <span class="main">=</span> <span class="keyword1">Dom</span><span class="main"><span class="hidden">⇘</span><sub></sub></span><span class="free">AA</span><span class="main"><span class="hidden">⇙</span></span> <span class="bound">g</span> <span class="main">⟶</span> <span class="free">G</span><span class="keyword1"><span class="hidden">⇘</span><sub>𝖺</sub><span class="hidden">⇙</span></span> <span class="main">(</span><span class="bound">g</span> <span class="main">∙</span><span class="main"><span class="hidden">⇘</span><sub></sub></span><span class="free">AA</span><span class="main"><span class="hidden">⇙</span></span> <span class="bound">f</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="free">G</span><span class="keyword1"><span class="hidden">⇘</span><sub>𝖺</sub><span class="hidden">⇙</span></span> <span class="bound">g</span><span class="main">)</span> <span class="main">∙</span><span class="main"><span class="hidden">⇘</span><sub></sub></span><span class="free">BB</span><span class="main"><span class="hidden">⇙</span></span> <span class="main">(</span><span class="free">G</span><span class="keyword1"><span class="hidden">⇘</span><sub>𝖺</sub><span class="hidden">⇙</span></span> <span class="bound">f</span><span class="main">)</span>"</span></span>

<span class="keyword1"><span class="command">locale</span></span> <span class="quoted">"functor"</span> <span class="main">=</span> two_cats <span class="main">+</span>
  <span class="keyword2"><span class="keyword">fixes</span></span> <span class="free">F</span> <span class="main">(</span><span class="keyword2"><span class="keyword">structure</span></span><span class="main">)</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> F_preserves_arrows<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">F</span><span class="keyword1"><span class="hidden">⇘</span><sub>𝖺</sub><span class="hidden">⇙</span></span> <span class="main">:</span> <span class="keyword1">Ar</span><span class="main"><span class="hidden">⇘</span><sub></sub></span><span class="free">AA</span><span class="main"><span class="hidden">⇙</span></span> <span class="main">→</span> <span class="keyword1">Ar</span><span class="main"><span class="hidden">⇘</span><sub></sub></span><span class="free">BB</span><span class="main"><span class="hidden">⇙</span></span>"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> F_preserves_objects<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">F</span><span class="keyword1"><span class="hidden">⇘</span><sub>𝗈</sub><span class="hidden">⇙</span></span> <span class="main">:</span> <span class="keyword1">Ob</span><span class="main"><span class="hidden">⇘</span><sub></sub></span><span class="free">AA</span><span class="main"><span class="hidden">⇙</span></span> <span class="main">→</span> <span class="keyword1">Ob</span><span class="main"><span class="hidden">⇘</span><sub></sub></span><span class="free">BB</span><span class="main"><span class="hidden">⇙</span></span>"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> F_preserves_dom<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">preserves_dom</span> <span class="free">F</span>"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> F_preserves_cod<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">preserves_cod</span> <span class="free">F</span>"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> F_preserves_id<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">preserves_id</span> <span class="free">F</span>"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> F_preserves_comp<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">preserves_comp</span> <span class="free">F</span>"</span></span>
<span class="keyword2"><span class="keyword">begin</span></span>

<span class="keyword1"><span class="command">lemmas</span></span> F_axioms <span class="main">=</span> F_preserves_arrows F_preserves_objects F_preserves_dom 
  F_preserves_cod F_preserves_id F_preserves_comp

<span class="keyword1"><span class="command">lemmas</span></span> func_pred_defs <span class="main">=</span> preserves_dom_def preserves_cod_def preserves_id_def preserves_comp_def

<span class="keyword2"><span class="keyword">end</span></span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹This gives us nicer notation for asserting that things are functors.›</span></span>

<span class="keyword1"><span class="command">abbreviation</span></span>
  <span class="entity">Functor</span>  <span class="main">(</span><span class="quoted">"<span class="keyword1">Functor</span> _ <span class="keyword1">:</span> _ <span class="keyword1">⟶</span> _"</span> <span class="main">[</span>81<span class="main">]</span><span class="main">)</span> <span class="keyword2"><span class="keyword">where</span></span>
  <span class="quoted"><span class="quoted">"<span class="keyword1"><span class="free">Functor</span></span> <span class="free"><span class="bound"><span class="entity">F</span></span></span> <span class="main"><span class="free">:</span></span> <span class="free"><span class="bound"><span class="entity">AA</span></span></span> <span class="main"><span class="free">⟶</span></span> <span class="free"><span class="bound"><span class="entity">BB</span></span></span> <span class="main">≡</span> functor <span class="free"><span class="bound"><span class="entity">AA</span></span></span> <span class="free"><span class="bound"><span class="entity">BB</span></span></span> <span class="free"><span class="bound"><span class="entity">F</span></span></span>"</span></span>


<span class="keyword1"><span class="command">subsection</span></span> <span class="quoted"><span class="plain_text">‹Simple Lemmas›</span></span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹For example:›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> <span class="quoted">"functor"</span><span class="main">)</span> <span class="quoted"><span class="quoted">"<span class="keyword1">Functor</span> <span class="free">F</span> <span class="main">:</span> <span class="free">AA</span> <span class="main">⟶</span> <span class="free">BB</span>"</span></span> <span class="keyword1"><span class="command">..</span></span>


<span class="keyword1"><span class="command">lemma</span></span> functors_preserve_arrows <span class="main">[</span><span class="operator">intro</span><span class="main">]</span><span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">Functor</span> <span class="free">F</span> <span class="main">:</span> <span class="free">AA</span> <span class="main">⟶</span> <span class="free">BB</span>"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">f</span> <span class="main">∈</span> ar <span class="free">AA</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">F</span><span class="keyword1"><span class="hidden">⇘</span><sub>𝖺</sub><span class="hidden">⇙</span></span> <span class="free">f</span> <span class="main">∈</span> ar <span class="free">BB</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
  <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="keyword1">Functor</span> <span class="free">F</span> <span class="main">:</span> <span class="free">AA</span> <span class="main">⟶</span> <span class="free">BB</span>›</span></span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">F</span><span class="keyword1"><span class="hidden">⇘</span><sub>𝖺</sub><span class="hidden">⇙</span></span> <span class="main">:</span> ar <span class="free">AA</span> <span class="main">→</span> ar <span class="free">BB</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> functor_def functor_axioms_def<span class="main">)</span>
  <span class="keyword1"><span class="command">from</span></span> this <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹<span class="free">f</span> <span class="main">∈</span> ar <span class="free">AA</span>›</span></span>
  <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> funcset_mem<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>


<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> <span class="quoted">"functor"</span><span class="main">)</span> functors_preserve_homsets<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> 1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">A</span> <span class="main">∈</span> <span class="keyword1">Ob</span><span class="main"><span class="hidden">⇘</span><sub></sub></span><span class="free">AA</span><span class="main"><span class="hidden">⇙</span></span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> 2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">B</span> <span class="main">∈</span> <span class="keyword1">Ob</span><span class="main"><span class="hidden">⇘</span><sub></sub></span><span class="free">AA</span><span class="main"><span class="hidden">⇙</span></span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> 3<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">f</span> <span class="main">∈</span> <span class="keyword1">Hom</span><span class="main"><span class="hidden">⇘</span><sub></sub></span><span class="free">AA</span><span class="main"><span class="hidden">⇙</span></span> <span class="free">A</span> <span class="free">B</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">F</span><span class="keyword1"><span class="hidden">⇘</span><sub>𝖺</sub><span class="hidden">⇙</span></span> <span class="free">f</span> <span class="main">∈</span> <span class="keyword1">Hom</span><span class="main"><span class="hidden">⇘</span><sub></sub></span><span class="free">BB</span><span class="main"><span class="hidden">⇙</span></span> <span class="main">(</span><span class="free">F</span><span class="keyword1"><span class="hidden">⇘</span><sub>𝗈</sub><span class="hidden">⇙</span></span> <span class="free">A</span><span class="main">)</span> <span class="main">(</span><span class="free">F</span><span class="keyword1"><span class="hidden">⇘</span><sub>𝗈</sub><span class="hidden">⇙</span></span> <span class="free">B</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
  <span class="keyword1"><span class="command">from</span></span> 3 
  <span class="keyword1"><span class="command">have</span></span> 4<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">f</span> <span class="main">∈</span> <span class="keyword1">Ar</span>"</span></span> 
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> hom_def<span class="main">)</span>
  <span class="keyword1"><span class="command">with</span></span> F_preserves_arrows 
  <span class="keyword1"><span class="command">have</span></span> 5<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">F</span><span class="keyword1"><span class="hidden">⇘</span><sub>𝖺</sub><span class="hidden">⇙</span></span> <span class="free">f</span> <span class="main">∈</span> <span class="keyword1">Ar</span><span class="main"><span class="hidden">⇘</span><sub></sub></span><span class="free">BB</span><span class="main"><span class="hidden">⇙</span></span>"</span></span> 
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> funcset_mem<span class="main">)</span>
  <span class="keyword1"><span class="command">from</span></span> 4 <span class="keyword2"><span class="keyword">and</span></span> F_preserves_dom 
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">Dom</span><span class="main"><span class="hidden">⇘</span><sub></sub></span><span class="free">BB</span><span class="main"><span class="hidden">⇙</span></span> <span class="main">(</span><span class="free">F</span><span class="keyword1"><span class="hidden">⇘</span><sub>𝖺</sub><span class="hidden">⇙</span></span> <span class="free">f</span><span class="main">)</span> <span class="main">=</span> <span class="free">F</span><span class="keyword1"><span class="hidden">⇘</span><sub>𝗈</sub><span class="hidden">⇙</span></span> <span class="main">(</span><span class="keyword1">Dom</span><span class="main"><span class="hidden">⇘</span><sub></sub></span><span class="free">AA</span><span class="main"><span class="hidden">⇙</span></span> <span class="free">f</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> preserves_dom_def<span class="main">)</span>
  <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">from</span></span> 3 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">…</span> <span class="main">=</span> <span class="free">F</span><span class="keyword1"><span class="hidden">⇘</span><sub>𝗈</sub><span class="hidden">⇙</span></span> <span class="free">A</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> hom_def<span class="main">)</span>
  <span class="keyword1"><span class="command">finally</span></span> <span class="keyword1"><span class="command">have</span></span> 6<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="keyword1">Dom</span><span class="main"><span class="hidden">⇘</span><sub></sub></span><span class="free">BB</span><span class="main"><span class="hidden">⇙</span></span> <span class="main">(</span><span class="free">F</span><span class="keyword1"><span class="hidden">⇘</span><sub>𝖺</sub><span class="hidden">⇙</span></span> <span class="free">f</span><span class="main">)</span> <span class="main">=</span> <span class="free">F</span><span class="keyword1"><span class="hidden">⇘</span><sub>𝗈</sub><span class="hidden">⇙</span></span> <span class="free">A</span>"</span></span> <span class="keyword1"><span class="command">.</span></span>
  <span class="keyword1"><span class="command">from</span></span> 4 <span class="keyword2"><span class="keyword">and</span></span> F_preserves_cod 
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">Cod</span><span class="main"><span class="hidden">⇘</span><sub></sub></span><span class="free">BB</span><span class="main"><span class="hidden">⇙</span></span> <span class="main">(</span><span class="free">F</span><span class="keyword1"><span class="hidden">⇘</span><sub>𝖺</sub><span class="hidden">⇙</span></span> <span class="free">f</span><span class="main">)</span> <span class="main">=</span> <span class="free">F</span><span class="keyword1"><span class="hidden">⇘</span><sub>𝗈</sub><span class="hidden">⇙</span></span> <span class="main">(</span><span class="keyword1">Cod</span><span class="main"><span class="hidden">⇘</span><sub></sub></span><span class="free">AA</span><span class="main"><span class="hidden">⇙</span></span> <span class="free">f</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> preserves_cod_def<span class="main">)</span>
  <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">from</span></span> 3 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">…</span> <span class="main">=</span> <span class="free">F</span><span class="keyword1"><span class="hidden">⇘</span><sub>𝗈</sub><span class="hidden">⇙</span></span> <span class="free">B</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> hom_def<span class="main">)</span>
  <span class="keyword1"><span class="command">finally</span></span> <span class="keyword1"><span class="command">have</span></span> 7<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="keyword1">Cod</span><span class="main"><span class="hidden">⇘</span><sub></sub></span><span class="free">BB</span><span class="main"><span class="hidden">⇙</span></span> <span class="main">(</span><span class="free">F</span><span class="keyword1"><span class="hidden">⇘</span><sub>𝖺</sub><span class="hidden">⇙</span></span> <span class="free">f</span><span class="main">)</span> <span class="main">=</span> <span class="free">F</span><span class="keyword1"><span class="hidden">⇘</span><sub>𝗈</sub><span class="hidden">⇙</span></span> <span class="free">B</span>"</span></span> <span class="keyword1"><span class="command">.</span></span>
  <span class="keyword1"><span class="command">from</span></span> 5 <span class="keyword2"><span class="keyword">and</span></span> 6 <span class="keyword2"><span class="keyword">and</span></span> 7
  <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> hom_def<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>
    

<span class="keyword1"><span class="command">lemma</span></span> functors_preserve_objects <span class="main">[</span><span class="operator">intro</span><span class="main">]</span><span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">Functor</span> <span class="free">F</span> <span class="main">:</span> <span class="free">AA</span> <span class="main">⟶</span> <span class="free">BB</span>"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">A</span> <span class="main">∈</span> ob <span class="free">AA</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">F</span><span class="keyword1"><span class="hidden">⇘</span><sub>𝗈</sub><span class="hidden">⇙</span></span> <span class="free">A</span> <span class="main">∈</span> ob <span class="free">BB</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
  <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="keyword1">Functor</span> <span class="free">F</span> <span class="main">:</span> <span class="free">AA</span> <span class="main">⟶</span> <span class="free">BB</span>›</span></span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">F</span><span class="keyword1"><span class="hidden">⇘</span><sub>𝗈</sub><span class="hidden">⇙</span></span> <span class="main">:</span> ob <span class="free">AA</span> <span class="main">→</span> ob <span class="free">BB</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> functor_def functor_axioms_def<span class="main">)</span>
  <span class="keyword1"><span class="command">from</span></span> this <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹<span class="free">A</span> <span class="main">∈</span> ob <span class="free">AA</span>›</span></span>
  <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> funcset_mem<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>


<span class="keyword1"><span class="command">subsection</span></span> <span class="quoted"><span class="plain_text">‹Identity Functor›</span></span>

<span class="keyword1"><span class="command">definition</span></span>
  <span class="entity">id_func</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="tfree">'o</span><span class="main">,</span><span class="tfree">'a</span><span class="main">,</span><span class="tfree">'m</span><span class="main">)</span> category_scheme <span class="main">⇒</span> <span class="main">(</span><span class="tfree">'o</span><span class="main">,</span><span class="tfree">'a</span><span class="main">,</span><span class="tfree">'o</span><span class="main">,</span><span class="tfree">'a</span><span class="main">)</span> functor"</span></span> <span class="keyword2"><span class="keyword">where</span></span>
  <span class="quoted"><span class="quoted">"<span class="free">id_func</span> <span class="free"><span class="bound"><span class="entity">CC</span></span></span> <span class="main">=</span> <span class="main">⦇</span>om<span class="main">=</span><span class="main">(</span><span class="main">λ</span><span class="bound">A</span><span class="main">∈</span>ob <span class="free"><span class="bound"><span class="entity">CC</span></span></span><span class="main">.</span> <span class="bound">A</span><span class="main">)</span><span class="main">,</span> am<span class="main">=</span><span class="main">(</span><span class="main">λ</span><span class="bound">f</span><span class="main">∈</span>ar <span class="free"><span class="bound"><span class="entity">CC</span></span></span><span class="main">.</span> <span class="bound">f</span><span class="main">)</span><span class="main">⦈</span>"</span></span>

<span class="keyword1"><span class="command">locale</span></span> one_cat <span class="main">=</span> two_cats <span class="main">+</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> endo<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">BB</span> <span class="main">=</span> <span class="free">AA</span>"</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> one_cat<span class="main">)</span> id_func_preserves_arrows<span class="main">:</span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span>id_func <span class="free">AA</span><span class="main">)</span><span class="keyword1"><span class="hidden">⇘</span><sub>𝖺</sub><span class="hidden">⇙</span></span> <span class="main">:</span> <span class="keyword1">Ar</span> <span class="main">→</span> <span class="keyword1">Ar</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">unfold</span> id_func_def<span class="main"><span class="keyword3">,</span></span> <span class="operator">rule</span> funcsetI<span class="main"><span class="keyword3">,</span></span> <span class="operator">simp</span><span class="main">)</span>


<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> one_cat<span class="main">)</span> id_func_preserves_objects<span class="main">:</span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span>id_func <span class="free">AA</span><span class="main">)</span><span class="keyword1"><span class="hidden">⇘</span><sub>𝗈</sub><span class="hidden">⇙</span></span> <span class="main">:</span> <span class="keyword1">Ob</span> <span class="main">→</span> <span class="keyword1">Ob</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">unfold</span> id_func_def<span class="main"><span class="keyword3">,</span></span> <span class="operator">rule</span> funcsetI<span class="main"><span class="keyword3">,</span></span> <span class="operator">simp</span><span class="main">)</span>


<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> one_cat<span class="main">)</span> id_func_preserves_dom<span class="main">:</span>
  <span class="keyword2"><span class="keyword">shows</span></span>  <span class="quoted"><span class="quoted">"<span class="free">preserves_dom</span> <span class="main">(</span>id_func <span class="free">AA</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">unfolding</span></span> preserves_dom_def endo
<span class="keyword1"><span class="command">proof</span></span>
  <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">f</span>
  <span class="keyword3"><span class="command">assume</span></span> f<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">f</span> <span class="main">∈</span> <span class="keyword1">Ar</span>"</span></span>
  <span class="keyword1"><span class="command">hence</span></span> lhs<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span>id_func <span class="free">AA</span><span class="main">)</span><span class="keyword1"><span class="hidden">⇘</span><sub>𝗈</sub><span class="hidden">⇙</span></span> <span class="main">(</span><span class="keyword1">Dom</span> <span class="skolem">f</span><span class="main">)</span> <span class="main">=</span> <span class="keyword1">Dom</span> <span class="skolem">f</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> id_func_def<span class="main">)</span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span>id_func <span class="free">AA</span><span class="main">)</span><span class="keyword1"><span class="hidden">⇘</span><sub>𝖺</sub><span class="hidden">⇙</span></span> <span class="skolem">f</span> <span class="main">=</span> <span class="skolem">f</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> f <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> id_func_def<span class="main">)</span>
  <span class="keyword1"><span class="command">hence</span></span> rhs<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="keyword1">Dom</span> <span class="main">(</span>id_func <span class="free">AA</span><span class="main">)</span><span class="keyword1"><span class="hidden">⇘</span><sub>𝖺</sub><span class="hidden">⇙</span></span> <span class="skolem">f</span> <span class="main">=</span> <span class="keyword1">Dom</span> <span class="skolem">f</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">from</span></span> lhs <span class="keyword2"><span class="keyword">and</span></span> rhs <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span>id_func <span class="free">AA</span><span class="main">)</span><span class="keyword1"><span class="hidden">⇘</span><sub>𝗈</sub><span class="hidden">⇙</span></span> <span class="main">(</span><span class="keyword1">Dom</span> <span class="skolem">f</span><span class="main">)</span> <span class="main">=</span> <span class="keyword1">Dom</span> <span class="main">(</span>id_func <span class="free">AA</span><span class="main">)</span><span class="keyword1"><span class="hidden">⇘</span><sub>𝖺</sub><span class="hidden">⇙</span></span> <span class="skolem">f</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> one_cat<span class="main">)</span> id_func_preserves_cod<span class="main">:</span>
  <span class="quoted"><span class="quoted">"<span class="free">preserves_cod</span> <span class="main">(</span>id_func <span class="free">AA</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">unfold</span> preserves_cod_def<span class="main"><span class="keyword3">,</span></span> <span class="operator">simp</span> <span class="quasi_keyword">only</span><span class="main"><span class="main">:</span></span> endo<span class="main">)</span>
<span class="keyword1"><span class="command">proof</span></span>
  <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">f</span>
  <span class="keyword3"><span class="command">assume</span></span> f<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">f</span> <span class="main">∈</span> <span class="keyword1">Ar</span>"</span></span>
  <span class="keyword1"><span class="command">hence</span></span> lhs<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span>id_func <span class="free">AA</span><span class="main">)</span><span class="keyword1"><span class="hidden">⇘</span><sub>𝗈</sub><span class="hidden">⇙</span></span> <span class="main">(</span><span class="keyword1">Cod</span> <span class="skolem">f</span><span class="main">)</span> <span class="main">=</span> <span class="keyword1">Cod</span> <span class="skolem">f</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> id_func_def<span class="main">)</span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span>id_func <span class="free">AA</span><span class="main">)</span><span class="keyword1"><span class="hidden">⇘</span><sub>𝖺</sub><span class="hidden">⇙</span></span> <span class="skolem">f</span> <span class="main">=</span> <span class="skolem">f</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> f <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> id_func_def<span class="main">)</span>
  <span class="keyword1"><span class="command">hence</span></span> rhs<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="keyword1">Cod</span> <span class="main">(</span>id_func <span class="free">AA</span><span class="main">)</span><span class="keyword1"><span class="hidden">⇘</span><sub>𝖺</sub><span class="hidden">⇙</span></span> <span class="skolem">f</span> <span class="main">=</span> <span class="keyword1">Cod</span> <span class="skolem">f</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">from</span></span> lhs <span class="keyword2"><span class="keyword">and</span></span> rhs <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span>id_func <span class="free">AA</span><span class="main">)</span><span class="keyword1"><span class="hidden">⇘</span><sub>𝗈</sub><span class="hidden">⇙</span></span> <span class="main">(</span><span class="keyword1">Cod</span> <span class="skolem">f</span><span class="main">)</span> <span class="main">=</span> <span class="keyword1">Cod</span> <span class="main">(</span>id_func <span class="free">AA</span><span class="main">)</span><span class="keyword1"><span class="hidden">⇘</span><sub>𝖺</sub><span class="hidden">⇙</span></span> <span class="skolem">f</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>


<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> one_cat<span class="main">)</span> id_func_preserves_id<span class="main">:</span>
  <span class="quoted"><span class="quoted">"<span class="free">preserves_id</span> <span class="main">(</span>id_func <span class="free">AA</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">unfolding</span></span> preserves_id_def endo
<span class="keyword1"><span class="command">proof</span></span>
  <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">A</span>
  <span class="keyword3"><span class="command">assume</span></span> A<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">A</span> <span class="main">∈</span> <span class="keyword1">Ob</span>"</span></span>
  <span class="keyword1"><span class="command">hence</span></span> lhs<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span>id_func <span class="free">AA</span><span class="main">)</span><span class="keyword1"><span class="hidden">⇘</span><sub>𝖺</sub><span class="hidden">⇙</span></span> <span class="main">(</span><span class="keyword1">Id</span> <span class="skolem">A</span><span class="main">)</span> <span class="main">=</span> <span class="keyword1">Id</span> <span class="skolem">A</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> id_func_def<span class="main">)</span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span>id_func <span class="free">AA</span><span class="main">)</span><span class="keyword1"><span class="hidden">⇘</span><sub>𝗈</sub><span class="hidden">⇙</span></span> <span class="skolem">A</span> <span class="main">=</span> <span class="skolem">A</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> A <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> id_func_def<span class="main">)</span>
  <span class="keyword1"><span class="command">hence</span></span> rhs<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="keyword1">Id</span> <span class="main">(</span><span class="main">(</span>id_func <span class="free">AA</span><span class="main">)</span><span class="keyword1"><span class="hidden">⇘</span><sub>𝗈</sub><span class="hidden">⇙</span></span> <span class="skolem">A</span><span class="main">)</span> <span class="main">=</span> <span class="keyword1">Id</span> <span class="skolem">A</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">from</span></span> lhs <span class="keyword2"><span class="keyword">and</span></span> rhs <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span>id_func <span class="free">AA</span><span class="main">)</span><span class="keyword1"><span class="hidden">⇘</span><sub>𝖺</sub><span class="hidden">⇙</span></span> <span class="main">(</span><span class="keyword1">Id</span> <span class="skolem">A</span><span class="main">)</span> <span class="main">=</span> <span class="keyword1">Id</span> <span class="main">(</span><span class="main">(</span>id_func <span class="free">AA</span><span class="main">)</span><span class="keyword1"><span class="hidden">⇘</span><sub>𝗈</sub><span class="hidden">⇙</span></span> <span class="skolem">A</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>


<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> one_cat<span class="main">)</span> id_func_preserves_comp<span class="main">:</span>
  <span class="quoted"><span class="quoted">"<span class="free">preserves_comp</span> <span class="main">(</span>id_func <span class="free">AA</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">unfolding</span></span> preserves_comp_def endo
<span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">intro</span> ballI impI<span class="main">)</span>
  <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">f</span> <span class="keyword2"><span class="keyword">and</span></span> <span class="skolem">g</span>
  <span class="keyword3"><span class="command">assume</span></span> f<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">f</span> <span class="main">∈</span> <span class="keyword1">Ar</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> g<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">g</span> <span class="main">∈</span> <span class="keyword1">Ar</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">Cod</span> <span class="skolem">f</span> <span class="main">=</span> <span class="keyword1">Dom</span> <span class="skolem">g</span>"</span></span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">g</span> <span class="main">∙</span> <span class="skolem">f</span> <span class="main">∈</span> <span class="keyword1">Ar</span>"</span></span> <span class="keyword1"><span class="command">..</span></span>
  <span class="keyword1"><span class="command">hence</span></span> lhs<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span>id_func <span class="free">AA</span><span class="main">)</span><span class="keyword1"><span class="hidden">⇘</span><sub>𝖺</sub><span class="hidden">⇙</span></span> <span class="main">(</span><span class="skolem">g</span> <span class="main">∙</span> <span class="skolem">f</span><span class="main">)</span> <span class="main">=</span> <span class="skolem">g</span> <span class="main">∙</span> <span class="skolem">f</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> id_func_def<span class="main">)</span>
  <span class="keyword1"><span class="command">have</span></span> id_f<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span>id_func <span class="free">AA</span><span class="main">)</span><span class="keyword1"><span class="hidden">⇘</span><sub>𝖺</sub><span class="hidden">⇙</span></span> <span class="skolem">f</span> <span class="main">=</span> <span class="skolem">f</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> f <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> id_func_def<span class="main">)</span>
  <span class="keyword1"><span class="command">have</span></span> id_g<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span>id_func <span class="free">AA</span><span class="main">)</span><span class="keyword1"><span class="hidden">⇘</span><sub>𝖺</sub><span class="hidden">⇙</span></span> <span class="skolem">g</span> <span class="main">=</span> <span class="skolem">g</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> g <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> id_func_def<span class="main">)</span>
  <span class="keyword1"><span class="command">hence</span></span> rhs<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span>id_func <span class="free">AA</span><span class="main">)</span><span class="keyword1"><span class="hidden">⇘</span><sub>𝖺</sub><span class="hidden">⇙</span></span> <span class="skolem">g</span> <span class="main">∙</span> <span class="main">(</span>id_func <span class="free">AA</span><span class="main">)</span><span class="keyword1"><span class="hidden">⇘</span><sub>𝖺</sub><span class="hidden">⇙</span></span> <span class="skolem">f</span> <span class="main">=</span> <span class="skolem">g</span> <span class="main">∙</span> <span class="skolem">f</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> id_f id_g<span class="main">)</span>
  <span class="keyword1"><span class="command">from</span></span> lhs <span class="keyword2"><span class="keyword">and</span></span> rhs 
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span>id_func <span class="free">AA</span><span class="main">)</span><span class="keyword1"><span class="hidden">⇘</span><sub>𝖺</sub><span class="hidden">⇙</span></span> <span class="main">(</span><span class="skolem">g</span> <span class="main">∙</span> <span class="skolem">f</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span>id_func <span class="free">AA</span><span class="main">)</span><span class="keyword1"><span class="hidden">⇘</span><sub>𝖺</sub><span class="hidden">⇙</span></span> <span class="skolem">g</span> <span class="main">∙</span> <span class="main">(</span>id_func <span class="free">AA</span><span class="main">)</span><span class="keyword1"><span class="hidden">⇘</span><sub>𝖺</sub><span class="hidden">⇙</span></span> <span class="skolem">f</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">theorem</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> one_cat<span class="main">)</span> id_func_functor<span class="main">:</span>
  <span class="quoted"><span class="quoted">"<span class="keyword1">Functor</span> <span class="main">(</span>id_func <span class="free">AA</span><span class="main">)</span> <span class="main">:</span> <span class="free">AA</span> <span class="main">⟶</span> <span class="free">AA</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
  <span class="keyword1"><span class="command">from</span></span> id_func_preserves_arrows
    <span class="keyword2"><span class="keyword">and</span></span> id_func_preserves_objects
    <span class="keyword2"><span class="keyword">and</span></span> id_func_preserves_dom
    <span class="keyword2"><span class="keyword">and</span></span> id_func_preserves_cod
    <span class="keyword2"><span class="keyword">and</span></span> id_func_preserves_id
    <span class="keyword2"><span class="keyword">and</span></span> id_func_preserves_comp
  <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">unfold_locales</span> <span class="main">(</span><span class="operator">simp_all</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> endo preserves_dom_def
      preserves_cod_def preserves_id_def preserves_comp_def<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword2"><span class="keyword">end</span></span>
</pre>
</div><div id="HomFunctors">
<div class="head">
<h1>Theory HomFunctors</h1>
</div>
<pre class="source"><span class="comment1">(*  Title:       Category theory using Isar and Locales
    Author:      Greg O'Keefe, June, July, August 2003
    License: LGPL

Define homfunctors, prove that they are functors.
*)</span>

<span class="keyword1"><span class="command">section</span></span> <span class="plain_text">HomFunctors</span>

<span class="keyword1"><span class="command">theory</span></span> HomFunctors
<span class="keyword2"><span class="keyword">imports</span></span> <a href="SetCat.html">SetCat</a> <a href="Functors.html">Functors</a>
<span class="keyword2"><span class="keyword">begin</span></span>

<span class="keyword1"><span class="command">locale</span></span> into_set <span class="main">=</span> two_cats <span class="quoted"><span class="free">AA</span></span> <span class="quoted"><span class="free">BB</span></span>
    <span class="keyword2"><span class="keyword">for</span></span> <span class="free">AA</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="tfree">'o</span><span class="main">,</span><span class="tfree">'a</span><span class="main">,</span><span class="tfree">'m</span><span class="main">)</span>category_scheme"</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">structure</span></span><span class="main">)</span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="free">BB</span> <span class="main">(</span><span class="keyword2"><span class="keyword">structure</span></span><span class="main">)</span> <span class="main">+</span>
  <span class="keyword2"><span class="keyword">fixes</span></span> <span class="free">U</span> <span class="keyword2"><span class="keyword">and</span></span> <span class="free">Set</span> 
  <span class="keyword2"><span class="keyword">defines</span></span> <span class="quoted"><span class="quoted">"<span class="free">U</span> <span class="main">≡</span> <span class="main">(</span>UNIV<span class="main">::</span><span class="tfree">'a</span> set<span class="main">)</span>"</span></span>
  <span class="keyword2"><span class="keyword">defines</span></span> <span class="quoted"><span class="quoted">"<span class="free">Set</span> <span class="main">≡</span> set_cat <span class="free">U</span>"</span></span>
  <span class="keyword2"><span class="keyword">assumes</span></span> BB_Set<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">BB</span> <span class="main">=</span> <span class="free">Set</span>"</span></span>
  <span class="keyword2"><span class="keyword">fixes</span></span> <span class="free">homf</span> <span class="main">(</span><span class="quoted">"<span class="keyword1">Hom'(</span>_<span class="keyword1">,'_')</span>"</span><span class="main">)</span>
  <span class="keyword2"><span class="keyword">defines</span></span> <span class="quoted"><span class="quoted">"<span class="free">homf</span> <span class="free">A</span> <span class="main">≡</span> <span class="main">⦇</span>
  om <span class="main">=</span> <span class="main">(</span><span class="main">λ</span><span class="bound">B</span><span class="main">∈</span><span class="keyword1">Ob</span><span class="main">.</span> <span class="keyword1">Hom</span> <span class="free">A</span> <span class="bound">B</span><span class="main">)</span><span class="main">,</span>
  am <span class="main">=</span> <span class="main">(</span><span class="main">λ</span><span class="bound">f</span><span class="main">∈</span><span class="keyword1">Ar</span><span class="main">.</span> <span class="main">⦇</span>set_dom<span class="main">=</span><span class="keyword1">Hom</span> <span class="free">A</span> <span class="main">(</span><span class="keyword1">Dom</span> <span class="bound">f</span><span class="main">)</span><span class="main">,</span>set_func<span class="main">=</span><span class="main">(</span><span class="main">λ</span><span class="bound">g</span><span class="main">∈</span><span class="keyword1">Hom</span> <span class="free">A</span> <span class="main">(</span><span class="keyword1">Dom</span> <span class="bound">f</span><span class="main">)</span><span class="main">.</span> <span class="bound">f</span> <span class="main">∙</span> <span class="bound">g</span><span class="main">)</span><span class="main">,</span>set_cod<span class="main">=</span><span class="keyword1">Hom</span> <span class="free">A</span> <span class="main">(</span><span class="keyword1">Cod</span> <span class="bound">f</span><span class="main">)</span><span class="main">⦈</span><span class="main">)</span>
  <span class="main">⦈</span>"</span></span>


<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> into_set<span class="main">)</span> homf_preserves_arrows<span class="main">:</span>
 <span class="quoted"><span class="quoted">"<span class="keyword1"><span class="free">Hom(</span></span><span class="free">A</span><span class="main"><span class="free">,_)</span></span><span class="keyword1"><span class="hidden">⇘</span><sub>𝖺</sub><span class="hidden">⇙</span></span> <span class="main">:</span> <span class="keyword1">Ar</span> <span class="main">→</span> ar <span class="free">Set</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">rule</span> funcsetI<span class="main">)</span>
  <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">f</span>
  <span class="keyword3"><span class="command">assume</span></span> f<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">f</span> <span class="main">∈</span> <span class="keyword1">Ar</span>"</span></span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1"><span class="free">Hom(</span></span><span class="free">A</span><span class="main"><span class="free">,_)</span></span><span class="keyword1"><span class="hidden">⇘</span><sub>𝖺</sub><span class="hidden">⇙</span></span> <span class="skolem">f</span> <span class="main">∈</span> ar <span class="free">Set</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> homf_def Set_def set_cat_def set_arrow_def U_def<span class="main">)</span>
    <span class="keyword1"><span class="command">have</span></span> 1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(∙</span><span class="main">)</span> <span class="main">:</span> <span class="keyword1">Hom</span> <span class="main">(</span><span class="keyword1">Dom</span> <span class="skolem">f</span><span class="main">)</span> <span class="main">(</span><span class="keyword1">Cod</span> <span class="skolem">f</span><span class="main">)</span> <span class="main">→</span> <span class="keyword1">Hom</span> <span class="free">A</span> <span class="main">(</span><span class="keyword1">Dom</span> <span class="skolem">f</span><span class="main">)</span> <span class="main">→</span> <span class="keyword1">Hom</span> <span class="free">A</span> <span class="main">(</span><span class="keyword1">Cod</span> <span class="skolem">f</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">..</span></span>
    <span class="keyword1"><span class="command">have</span></span> 2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">f</span> <span class="main">∈</span> <span class="keyword1">Hom</span> <span class="main">(</span><span class="keyword1">Dom</span> <span class="skolem">f</span><span class="main">)</span> <span class="main">(</span><span class="keyword1">Cod</span> <span class="skolem">f</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> f <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> hom_def<span class="main">)</span>
    <span class="keyword1"><span class="command">from</span></span> 1 <span class="keyword2"><span class="keyword">and</span></span> 2 <span class="keyword1"><span class="command">have</span></span> 3<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(∙</span><span class="main">)</span> <span class="skolem">f</span> <span class="main">:</span> <span class="keyword1">Hom</span> <span class="free">A</span> <span class="main">(</span><span class="keyword1">Dom</span> <span class="skolem">f</span><span class="main">)</span> <span class="main">→</span> <span class="keyword1">Hom</span> <span class="free">A</span> <span class="main">(</span><span class="keyword1">Cod</span> <span class="skolem">f</span><span class="main">)</span>"</span></span> 
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> funcset_mem<span class="main">)</span>
    <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">λ</span><span class="bound">g</span><span class="main">∈</span><span class="keyword1">Hom</span> <span class="free">A</span> <span class="main">(</span><span class="keyword1">Dom</span> <span class="skolem">f</span><span class="main">)</span><span class="main">.</span> <span class="skolem">f</span> <span class="main">∙</span> <span class="bound">g</span><span class="main">)</span> <span class="main">:</span> <span class="keyword1">Hom</span> <span class="free">A</span> <span class="main">(</span><span class="keyword1">Dom</span> <span class="skolem">f</span><span class="main">)</span> <span class="main">→</span> <span class="keyword1">Hom</span> <span class="free">A</span> <span class="main">(</span><span class="keyword1">Cod</span> <span class="skolem">f</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">rule</span> funcsetI<span class="main">)</span>
      <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">g'</span>
      <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">g'</span> <span class="main">∈</span> <span class="keyword1">Hom</span> <span class="free">A</span> <span class="main">(</span><span class="keyword1">Dom</span> <span class="skolem">f</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">from</span></span> 3 <span class="keyword2"><span class="keyword">and</span></span> this <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">λ</span><span class="bound">g</span><span class="main">∈</span><span class="keyword1">Hom</span> <span class="free">A</span> <span class="main">(</span><span class="keyword1">Dom</span> <span class="skolem">f</span><span class="main">)</span><span class="main">.</span> <span class="skolem">f</span> <span class="main">∙</span> <span class="bound">g</span><span class="main">)</span> <span class="skolem">g'</span> <span class="main">∈</span> <span class="keyword1">Hom</span> <span class="free">A</span> <span class="main">(</span><span class="keyword1">Cod</span> <span class="skolem">f</span><span class="main">)</span>"</span></span>
        <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span> <span class="main">(</span><span class="operator">rule</span> funcset_mem<span class="main">)</span>
    <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">qed</span></span>
<span class="keyword1"><span class="command">qed</span></span>


<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> into_set<span class="main">)</span> homf_preserves_objects<span class="main">:</span>
 <span class="quoted"><span class="quoted">"<span class="keyword1"><span class="free">Hom(</span></span><span class="free">A</span><span class="main"><span class="free">,_)</span></span><span class="keyword1"><span class="hidden">⇘</span><sub>𝗈</sub><span class="hidden">⇙</span></span> <span class="main">:</span> <span class="keyword1">Ob</span> <span class="main">→</span> ob <span class="free">Set</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">rule</span> funcsetI<span class="main">)</span>
  <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">B</span>
  <span class="keyword3"><span class="command">assume</span></span> B<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">B</span> <span class="main">∈</span> <span class="keyword1">Ob</span>"</span></span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1"><span class="free">Hom(</span></span><span class="free">A</span><span class="main"><span class="free">,_)</span></span><span class="keyword1"><span class="hidden">⇘</span><sub>𝗈</sub><span class="hidden">⇙</span></span> <span class="skolem">B</span> <span class="main">=</span> <span class="keyword1">Hom</span> <span class="free">A</span> <span class="skolem">B</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> B <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> homf_def<span class="main">)</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">…</span> <span class="main">∈</span> ob <span class="free">Set</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> U_def Set_def set_cat_def<span class="main">)</span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1"><span class="free">Hom(</span></span><span class="free">A</span><span class="main"><span class="free">,_)</span></span><span class="keyword1"><span class="hidden">⇘</span><sub>𝗈</sub><span class="hidden">⇙</span></span> <span class="skolem">B</span> <span class="main">∈</span> ob <span class="free">Set</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>


<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> into_set<span class="main">)</span> homf_preserves_dom<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> f<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">f</span> <span class="main">∈</span> <span class="keyword1">Ar</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1"><span class="free">Hom(</span></span><span class="free">A</span><span class="main"><span class="free">,_)</span></span><span class="keyword1"><span class="hidden">⇘</span><sub>𝗈</sub><span class="hidden">⇙</span></span> <span class="main">(</span><span class="keyword1">Dom</span> <span class="free">f</span><span class="main">)</span> <span class="main">=</span> dom <span class="free">Set</span> <span class="main">(</span><span class="keyword1"><span class="free">Hom(</span></span><span class="free">A</span><span class="main"><span class="free">,_)</span></span><span class="keyword1"><span class="hidden">⇘</span><sub>𝖺</sub><span class="hidden">⇙</span></span> <span class="free">f</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">Dom</span> <span class="free">f</span> <span class="main">∈</span> <span class="keyword1">Ob</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> f <span class="keyword1"><span class="command">..</span></span>
  <span class="keyword1"><span class="command">hence</span></span> 1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="keyword1"><span class="free">Hom(</span></span><span class="free">A</span><span class="main"><span class="free">,_)</span></span><span class="keyword1"><span class="hidden">⇘</span><sub>𝗈</sub><span class="hidden">⇙</span></span> <span class="main">(</span><span class="keyword1">Dom</span> <span class="free">f</span><span class="main">)</span> <span class="main">=</span> <span class="keyword1">Hom</span> <span class="free">A</span> <span class="main">(</span><span class="keyword1">Dom</span> <span class="free">f</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> f <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> homf_def<span class="main">)</span>
  <span class="keyword1"><span class="command">have</span></span> 2<span class="main">:</span> <span class="quoted"><span class="quoted">"dom <span class="free">Set</span> <span class="main">(</span><span class="keyword1"><span class="free">Hom(</span></span><span class="free">A</span><span class="main"><span class="free">,_)</span></span><span class="keyword1"><span class="hidden">⇘</span><sub>𝖺</sub><span class="hidden">⇙</span></span> <span class="free">f</span><span class="main">)</span> <span class="main">=</span> <span class="keyword1">Hom</span> <span class="free">A</span> <span class="main">(</span><span class="keyword1">Dom</span> <span class="free">f</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> f <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> Set_def homf_def<span class="main">)</span>
  <span class="keyword1"><span class="command">from</span></span> 1 <span class="keyword2"><span class="keyword">and</span></span> 2 <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> into_set<span class="main">)</span> homf_preserves_cod<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> f<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">f</span> <span class="main">∈</span> <span class="keyword1">Ar</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1"><span class="free">Hom(</span></span><span class="free">A</span><span class="main"><span class="free">,_)</span></span><span class="keyword1"><span class="hidden">⇘</span><sub>𝗈</sub><span class="hidden">⇙</span></span> <span class="main">(</span><span class="keyword1">Cod</span> <span class="free">f</span><span class="main">)</span> <span class="main">=</span> cod <span class="free">Set</span> <span class="main">(</span><span class="keyword1"><span class="free">Hom(</span></span><span class="free">A</span><span class="main"><span class="free">,_)</span></span><span class="keyword1"><span class="hidden">⇘</span><sub>𝖺</sub><span class="hidden">⇙</span></span> <span class="free">f</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">Cod</span> <span class="free">f</span> <span class="main">∈</span> <span class="keyword1">Ob</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> f <span class="keyword1"><span class="command">..</span></span>
  <span class="keyword1"><span class="command">hence</span></span> 1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="keyword1"><span class="free">Hom(</span></span><span class="free">A</span><span class="main"><span class="free">,_)</span></span><span class="keyword1"><span class="hidden">⇘</span><sub>𝗈</sub><span class="hidden">⇙</span></span> <span class="main">(</span><span class="keyword1">Cod</span> <span class="free">f</span><span class="main">)</span> <span class="main">=</span> <span class="keyword1">Hom</span> <span class="free">A</span> <span class="main">(</span><span class="keyword1">Cod</span> <span class="free">f</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> f <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> homf_def<span class="main">)</span>
  <span class="keyword1"><span class="command">have</span></span> 2<span class="main">:</span> <span class="quoted"><span class="quoted">"cod <span class="free">Set</span> <span class="main">(</span><span class="keyword1"><span class="free">Hom(</span></span><span class="free">A</span><span class="main"><span class="free">,_)</span></span><span class="keyword1"><span class="hidden">⇘</span><sub>𝖺</sub><span class="hidden">⇙</span></span> <span class="free">f</span><span class="main">)</span> <span class="main">=</span> <span class="keyword1">Hom</span> <span class="free">A</span> <span class="main">(</span><span class="keyword1">Cod</span> <span class="free">f</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> f <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> Set_def homf_def<span class="main">)</span>
  <span class="keyword1"><span class="command">from</span></span> 1 <span class="keyword2"><span class="keyword">and</span></span> 2 <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>


<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> into_set<span class="main">)</span> homf_preserves_id<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> B<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">B</span> <span class="main">∈</span> <span class="keyword1">Ob</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1"><span class="free">Hom(</span></span><span class="free">A</span><span class="main"><span class="free">,_)</span></span><span class="keyword1"><span class="hidden">⇘</span><sub>𝖺</sub><span class="hidden">⇙</span></span> <span class="main">(</span><span class="keyword1">Id</span> <span class="free">B</span><span class="main">)</span> <span class="main">=</span> id <span class="free">Set</span> <span class="main">(</span><span class="keyword1"><span class="free">Hom(</span></span><span class="free">A</span><span class="main"><span class="free">,_)</span></span><span class="keyword1"><span class="hidden">⇘</span><sub>𝗈</sub><span class="hidden">⇙</span></span> <span class="free">B</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> 1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="keyword1">Id</span> <span class="free">B</span> <span class="main">∈</span> <span class="keyword1">Ar</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> B <span class="keyword1"><span class="command">..</span></span>
  <span class="keyword1"><span class="command">have</span></span> 2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="keyword1">Dom</span> <span class="main">(</span><span class="keyword1">Id</span> <span class="free">B</span><span class="main">)</span> <span class="main">=</span> <span class="free">B</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> B <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> AA.id_dom_cod<span class="main">)</span>
  <span class="keyword1"><span class="command">have</span></span> 3<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="keyword1">Cod</span> <span class="main">(</span><span class="keyword1">Id</span> <span class="free">B</span><span class="main">)</span> <span class="main">=</span> <span class="free">B</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> B <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> AA.id_dom_cod<span class="main">)</span>
  <span class="keyword1"><span class="command">have</span></span> 4<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">λ</span><span class="bound">g</span><span class="main">∈</span><span class="keyword1">Hom</span> <span class="free">A</span> <span class="free">B</span><span class="main">.</span> <span class="main">(</span><span class="keyword1">Id</span> <span class="free">B</span><span class="main">)</span> <span class="main">∙</span> <span class="bound">g</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="main">λ</span><span class="bound">g</span><span class="main">∈</span><span class="keyword1">Hom</span> <span class="free">A</span> <span class="free">B</span><span class="main">.</span> <span class="bound">g</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> ext<span class="main">)</span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> hom_def<span class="main">)</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1"><span class="free">Hom(</span></span><span class="free">A</span><span class="main"><span class="free">,_)</span></span><span class="keyword1"><span class="hidden">⇘</span><sub>𝖺</sub><span class="hidden">⇙</span></span> <span class="main">(</span><span class="keyword1">Id</span> <span class="free">B</span><span class="main">)</span> <span class="main">=</span> <span class="main">⦇</span>
    set_dom<span class="main">=</span><span class="keyword1">Hom</span> <span class="free">A</span> <span class="free">B</span><span class="main">,</span> 
    set_func<span class="main">=</span><span class="main">(</span><span class="main">λ</span><span class="bound">g</span><span class="main">∈</span><span class="keyword1">Hom</span> <span class="free">A</span> <span class="free">B</span><span class="main">.</span> <span class="bound">g</span><span class="main">)</span><span class="main">,</span>
    set_cod<span class="main">=</span><span class="keyword1">Hom</span> <span class="free">A</span> <span class="free">B</span><span class="main">⦈</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> homf_def 1 2 3 4<span class="main">)</span>
  <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">…</span><span class="main">=</span> id <span class="free">Set</span> <span class="main">(</span><span class="keyword1"><span class="free">Hom(</span></span><span class="free">A</span><span class="main"><span class="free">,_)</span></span><span class="keyword1"><span class="hidden">⇘</span><sub>𝗈</sub><span class="hidden">⇙</span></span> <span class="free">B</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> B <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> Set_def U_def set_cat_def set_id_def homf_def<span class="main">)</span>
  <span class="keyword1"><span class="command">finally</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">.</span></span>
<span class="keyword1"><span class="command">qed</span></span>
  

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> into_set<span class="main">)</span> homf_preserves_comp<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> f<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">f</span> <span class="main">∈</span> <span class="keyword1">Ar</span>"</span></span> 
    <span class="keyword2"><span class="keyword">and</span></span> g<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">g</span> <span class="main">∈</span> <span class="keyword1">Ar</span>"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> fg<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="keyword1">Cod</span> <span class="free">f</span> <span class="main">=</span> <span class="keyword1">Dom</span> <span class="free">g</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1"><span class="free">Hom(</span></span><span class="free">A</span><span class="main"><span class="free">,_)</span></span><span class="keyword1"><span class="hidden">⇘</span><sub>𝖺</sub><span class="hidden">⇙</span></span> <span class="main">(</span><span class="free">g</span> <span class="main">∙</span> <span class="free">f</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="keyword1"><span class="free">Hom(</span></span><span class="free">A</span><span class="main"><span class="free">,_)</span></span><span class="keyword1"><span class="hidden">⇘</span><sub>𝖺</sub><span class="hidden">⇙</span></span> <span class="free">g</span><span class="main">)</span> <span class="main">⊙</span> <span class="main">(</span><span class="keyword1"><span class="free">Hom(</span></span><span class="free">A</span><span class="main"><span class="free">,_)</span></span><span class="keyword1"><span class="hidden">⇘</span><sub>𝖺</sub><span class="hidden">⇙</span></span> <span class="free">f</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> 1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">g</span> <span class="main">∙</span> <span class="free">f</span> <span class="main">∈</span> <span class="keyword1">Ar</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">..</span></span>
  <span class="keyword1"><span class="command">have</span></span> 2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="keyword1">Dom</span> <span class="main">(</span><span class="free">g</span> <span class="main">∙</span> <span class="free">f</span><span class="main">)</span> <span class="main">=</span> <span class="keyword1">Dom</span> <span class="free">f</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> f g fg <span class="keyword1"><span class="command">..</span></span>
  <span class="keyword1"><span class="command">have</span></span> 3<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="keyword1">Cod</span> <span class="main">(</span><span class="free">g</span> <span class="main">∙</span> <span class="free">f</span><span class="main">)</span> <span class="main">=</span> <span class="keyword1">Cod</span> <span class="free">g</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> f g fg <span class="keyword1"><span class="command">..</span></span>
  <span class="keyword1"><span class="command">have</span></span> lhs<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="keyword1"><span class="free">Hom(</span></span><span class="free">A</span><span class="main"><span class="free">,_)</span></span><span class="keyword1"><span class="hidden">⇘</span><sub>𝖺</sub><span class="hidden">⇙</span></span> <span class="main">(</span><span class="free">g</span> <span class="main">∙</span> <span class="free">f</span><span class="main">)</span> <span class="main">=</span> <span class="main">⦇</span>
    set_dom<span class="main">=</span><span class="keyword1">Hom</span> <span class="free">A</span> <span class="main">(</span><span class="keyword1">Dom</span> <span class="free">f</span><span class="main">)</span><span class="main">,</span> 
    set_func<span class="main">=</span><span class="main">(</span><span class="main">λ</span><span class="bound">h</span><span class="main">∈</span><span class="keyword1">Hom</span> <span class="free">A</span> <span class="main">(</span><span class="keyword1">Dom</span> <span class="free">f</span><span class="main">)</span><span class="main">.</span> <span class="main">(</span><span class="free">g</span> <span class="main">∙</span> <span class="free">f</span><span class="main">)</span> <span class="main">∙</span> <span class="bound">h</span><span class="main">)</span><span class="main">,</span>
    set_cod<span class="main">=</span><span class="keyword1">Hom</span> <span class="free">A</span> <span class="main">(</span><span class="keyword1">Cod</span> <span class="free">g</span><span class="main">)</span><span class="main">⦈</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> homf_def 1 2 3<span class="main">)</span>
  <span class="keyword1"><span class="command">have</span></span> 4<span class="main">:</span> <span class="quoted"><span class="quoted">"set_dom <span class="main">(</span><span class="main">(</span><span class="keyword1"><span class="free">Hom(</span></span><span class="free">A</span><span class="main"><span class="free">,_)</span></span><span class="keyword1"><span class="hidden">⇘</span><sub>𝖺</sub><span class="hidden">⇙</span></span> <span class="free">g</span><span class="main">)</span> <span class="main">⊙</span> <span class="main">(</span><span class="keyword1"><span class="free">Hom(</span></span><span class="free">A</span><span class="main"><span class="free">,_)</span></span><span class="keyword1"><span class="hidden">⇘</span><sub>𝖺</sub><span class="hidden">⇙</span></span> <span class="free">f</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> <span class="keyword1">Hom</span> <span class="free">A</span> <span class="main">(</span><span class="keyword1">Dom</span> <span class="free">f</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> f <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> set_comp_def homf_def<span class="main">)</span>
  <span class="keyword1"><span class="command">have</span></span> 5<span class="main">:</span> <span class="quoted"><span class="quoted">"set_cod <span class="main">(</span><span class="main">(</span><span class="keyword1"><span class="free">Hom(</span></span><span class="free">A</span><span class="main"><span class="free">,_)</span></span><span class="keyword1"><span class="hidden">⇘</span><sub>𝖺</sub><span class="hidden">⇙</span></span> <span class="free">g</span><span class="main">)</span> <span class="main">⊙</span> <span class="main">(</span><span class="keyword1"><span class="free">Hom(</span></span><span class="free">A</span><span class="main"><span class="free">,_)</span></span><span class="keyword1"><span class="hidden">⇘</span><sub>𝖺</sub><span class="hidden">⇙</span></span> <span class="free">f</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> <span class="keyword1">Hom</span> <span class="free">A</span> <span class="main">(</span><span class="keyword1">Cod</span> <span class="free">g</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> g <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> set_comp_def homf_def<span class="main">)</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"set_func <span class="main">(</span><span class="main">(</span><span class="keyword1"><span class="free">Hom(</span></span><span class="free">A</span><span class="main"><span class="free">,_)</span></span><span class="keyword1"><span class="hidden">⇘</span><sub>𝖺</sub><span class="hidden">⇙</span></span> <span class="free">g</span><span class="main">)</span> <span class="main">⊙</span> <span class="main">(</span><span class="keyword1"><span class="free">Hom(</span></span><span class="free">A</span><span class="main"><span class="free">,_)</span></span><span class="keyword1"><span class="hidden">⇘</span><sub>𝖺</sub><span class="hidden">⇙</span></span> <span class="free">f</span><span class="main">)</span><span class="main">)</span>
      <span class="main">=</span> compose <span class="main">(</span><span class="keyword1">Hom</span> <span class="free">A</span> <span class="main">(</span><span class="keyword1">Dom</span> <span class="free">f</span><span class="main">)</span><span class="main">)</span> <span class="main">(</span><span class="main">λ</span><span class="bound">y</span><span class="main">∈</span><span class="keyword1">Hom</span> <span class="free">A</span> <span class="main">(</span><span class="keyword1">Dom</span> <span class="free">g</span><span class="main">)</span><span class="main">.</span> <span class="free">g</span> <span class="main">∙</span> <span class="bound">y</span><span class="main">)</span> <span class="main">(</span><span class="main">λ</span><span class="bound">x</span><span class="main">∈</span><span class="keyword1">Hom</span> <span class="free">A</span> <span class="main">(</span><span class="keyword1">Dom</span> <span class="free">f</span><span class="main">)</span><span class="main">.</span> <span class="free">f</span> <span class="main">∙</span> <span class="bound">x</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> f g <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> set_comp_def homf_def<span class="main">)</span>
  <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">…</span> <span class="main">=</span> <span class="main">(</span><span class="main">λ</span><span class="bound">h</span><span class="main">∈</span><span class="keyword1">Hom</span> <span class="free">A</span> <span class="main">(</span><span class="keyword1">Dom</span> <span class="free">f</span><span class="main">)</span><span class="main">.</span> <span class="main">(</span><span class="free">g</span> <span class="main">∙</span> <span class="free">f</span><span class="main">)</span> <span class="main">∙</span> <span class="bound">h</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span>
      <span class="operator">rule</span> extensionalityI<span class="main"><span class="keyword3">,</span></span> 
      <span class="operator">rule</span> compose_extensional<span class="main"><span class="keyword3">,</span></span>
      <span class="operator">rule</span> restrict_extensional<span class="main"><span class="keyword3">,</span></span>
      <span class="operator">simp</span><span class="main">)</span>
    <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">h</span>
    <span class="keyword3"><span class="command">assume</span></span> 10<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">h</span> <span class="main">∈</span> <span class="keyword1">Hom</span> <span class="free">A</span> <span class="main">(</span><span class="keyword1">Dom</span> <span class="free">f</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">hence</span></span> 11<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">f</span> <span class="main">∙</span> <span class="skolem">h</span> <span class="main">∈</span> <span class="keyword1">Hom</span> <span class="free">A</span> <span class="main">(</span><span class="keyword1">Dom</span> <span class="free">g</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
      <span class="keyword1"><span class="command">from</span></span> 10 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">h</span> <span class="main">∈</span> <span class="keyword1">Ar</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> hom_def<span class="main">)</span>
      <span class="keyword1"><span class="command">have</span></span> 100<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(∙</span><span class="main">)</span> <span class="main">:</span> <span class="keyword1">Hom</span> <span class="main">(</span><span class="keyword1">Dom</span> <span class="free">f</span><span class="main">)</span> <span class="main">(</span><span class="keyword1">Dom</span> <span class="free">g</span><span class="main">)</span> <span class="main">→</span> <span class="keyword1">Hom</span> <span class="free">A</span> <span class="main">(</span><span class="keyword1">Dom</span> <span class="free">f</span><span class="main">)</span> <span class="main">→</span> <span class="keyword1">Hom</span> <span class="free">A</span> <span class="main">(</span><span class="keyword1">Dom</span> <span class="free">g</span><span class="main">)</span>"</span></span>
        <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> AA.comp_types<span class="main">)</span>
      <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">f</span> <span class="main">∈</span> <span class="keyword1">Hom</span> <span class="main">(</span><span class="keyword1">Dom</span> <span class="free">f</span><span class="main">)</span> <span class="main">(</span><span class="keyword1">Cod</span> <span class="free">f</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> f <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> hom_def<span class="main">)</span>
      <span class="keyword1"><span class="command">hence</span></span> 101<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">f</span> <span class="main">∈</span> <span class="keyword1">Hom</span> <span class="main">(</span><span class="keyword1">Dom</span> <span class="free">f</span><span class="main">)</span> <span class="main">(</span><span class="keyword1">Dom</span> <span class="free">g</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> fg <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
      <span class="keyword1"><span class="command">from</span></span> 100 <span class="keyword2"><span class="keyword">and</span></span> 101
      <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(∙</span><span class="main">)</span> <span class="free">f</span> <span class="main">:</span> <span class="keyword1">Hom</span> <span class="free">A</span> <span class="main">(</span><span class="keyword1">Dom</span> <span class="free">f</span><span class="main">)</span> <span class="main">→</span> <span class="keyword1">Hom</span> <span class="free">A</span> <span class="main">(</span><span class="keyword1">Dom</span> <span class="free">g</span><span class="main">)</span>"</span></span>
        <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> funcset_mem<span class="main">)</span>
      <span class="keyword1"><span class="command">from</span></span> this <span class="keyword2"><span class="keyword">and</span></span> 10 
      <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="free">f</span> <span class="main">∙</span> <span class="skolem">h</span> <span class="main">∈</span> <span class="keyword1">Hom</span> <span class="free">A</span> <span class="main">(</span><span class="keyword1">Dom</span> <span class="free">g</span><span class="main">)</span>"</span></span>
        <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> funcset_mem<span class="main">)</span>
    <span class="keyword1"><span class="command">qed</span></span>
    <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">Cod</span> <span class="main">(</span><span class="free">f</span> <span class="main">∙</span> <span class="skolem">h</span><span class="main">)</span> <span class="main">=</span> <span class="keyword1">Dom</span> <span class="free">g</span>"</span></span> 
      <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">Dom</span> <span class="main">(</span><span class="free">f</span> <span class="main">∙</span> <span class="skolem">h</span><span class="main">)</span> <span class="main">=</span> <span class="free">A</span>"</span></span>
      <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">f</span> <span class="main">∙</span> <span class="skolem">h</span> <span class="main">∈</span> <span class="keyword1">Ar</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp_all</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> hom_def<span class="main">)</span>
    <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"compose <span class="main">(</span><span class="keyword1">Hom</span> <span class="free">A</span> <span class="main">(</span><span class="keyword1">Dom</span> <span class="free">f</span><span class="main">)</span><span class="main">)</span> <span class="main">(</span><span class="main">λ</span><span class="bound">y</span><span class="main">∈</span><span class="keyword1">Hom</span> <span class="free">A</span> <span class="main">(</span><span class="keyword1">Dom</span> <span class="free">g</span><span class="main">)</span><span class="main">.</span> <span class="free">g</span> <span class="main">∙</span> <span class="bound">y</span><span class="main">)</span> <span class="main">(</span><span class="main">λ</span><span class="bound">x</span><span class="main">∈</span><span class="keyword1">Hom</span> <span class="free">A</span> <span class="main">(</span><span class="keyword1">Dom</span> <span class="free">f</span><span class="main">)</span><span class="main">.</span> <span class="free">f</span> <span class="main">∙</span> <span class="bound">x</span><span class="main">)</span> <span class="skolem">h</span> <span class="main">=</span>
        <span class="main">(</span><span class="free">g</span> <span class="main">∙</span> <span class="free">f</span><span class="main">)</span> <span class="main">∙</span> <span class="skolem">h</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> f g fg 10 <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> compose_def 10 11 hom_def<span class="main">)</span>
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">finally</span></span> <span class="keyword1"><span class="command">have</span></span> 6<span class="main">:</span> <span class="quoted"><span class="quoted">"set_func <span class="main">(</span><span class="main">(</span><span class="keyword1"><span class="free">Hom(</span></span><span class="free">A</span><span class="main"><span class="free">,_)</span></span><span class="keyword1"><span class="hidden">⇘</span><sub>𝖺</sub><span class="hidden">⇙</span></span> <span class="free">g</span><span class="main">)</span> <span class="main">⊙</span> <span class="main">(</span><span class="keyword1"><span class="free">Hom(</span></span><span class="free">A</span><span class="main"><span class="free">,_)</span></span><span class="keyword1"><span class="hidden">⇘</span><sub>𝖺</sub><span class="hidden">⇙</span></span> <span class="free">f</span><span class="main">)</span><span class="main">)</span>
    <span class="main">=</span> <span class="main">(</span><span class="main">λ</span><span class="bound">h</span><span class="main">∈</span><span class="keyword1">Hom</span> <span class="free">A</span> <span class="main">(</span><span class="keyword1">Dom</span> <span class="free">f</span><span class="main">)</span><span class="main">.</span> <span class="main">(</span><span class="free">g</span> <span class="main">∙</span> <span class="free">f</span><span class="main">)</span> <span class="main">∙</span> <span class="bound">h</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">.</span></span>
  <span class="keyword1"><span class="command">from</span></span> 4 <span class="keyword2"><span class="keyword">and</span></span> 5 <span class="keyword2"><span class="keyword">and</span></span> 6
  <span class="keyword1"><span class="command">have</span></span> rhs<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="keyword1"><span class="free">Hom(</span></span><span class="free">A</span><span class="main"><span class="free">,_)</span></span><span class="keyword1"><span class="hidden">⇘</span><sub>𝖺</sub><span class="hidden">⇙</span></span> <span class="free">g</span><span class="main">)</span> <span class="main">⊙</span> <span class="main">(</span><span class="keyword1"><span class="free">Hom(</span></span><span class="free">A</span><span class="main"><span class="free">,_)</span></span><span class="keyword1"><span class="hidden">⇘</span><sub>𝖺</sub><span class="hidden">⇙</span></span> <span class="free">f</span><span class="main">)</span> <span class="main">=</span> <span class="main">⦇</span>
    set_dom<span class="main">=</span><span class="keyword1">Hom</span> <span class="free">A</span> <span class="main">(</span><span class="keyword1">Dom</span> <span class="free">f</span><span class="main">)</span><span class="main">,</span> 
    set_func<span class="main">=</span><span class="main">(</span><span class="main">λ</span><span class="bound">h</span><span class="main">∈</span><span class="keyword1">Hom</span> <span class="free">A</span> <span class="main">(</span><span class="keyword1">Dom</span> <span class="free">f</span><span class="main">)</span><span class="main">.</span> <span class="main">(</span><span class="free">g</span> <span class="main">∙</span> <span class="free">f</span><span class="main">)</span> <span class="main">∙</span> <span class="bound">h</span><span class="main">)</span><span class="main">,</span>
    set_cod<span class="main">=</span><span class="keyword1">Hom</span> <span class="free">A</span> <span class="main">(</span><span class="keyword1">Cod</span> <span class="free">g</span><span class="main">)</span><span class="main">⦈</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> lhs rhs<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>


<span class="keyword1"><span class="command">theorem</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> into_set<span class="main">)</span> homf_into_set<span class="main">:</span>
  <span class="quoted"><span class="quoted">"<span class="keyword1">Functor</span> <span class="keyword1"><span class="free">Hom(</span></span><span class="free">A</span><span class="main"><span class="free">,_)</span></span> <span class="main">:</span> <span class="free">AA</span> <span class="main">⟶</span> <span class="free">Set</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">intro</span> functor.intro functor_axioms.intro<span class="main">)</span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1"><span class="free">Hom(</span></span><span class="free">A</span><span class="main"><span class="free">,_)</span></span><span class="keyword1"><span class="hidden">⇘</span><sub>𝖺</sub><span class="hidden">⇙</span></span> <span class="main">:</span> <span class="keyword1">Ar</span> <span class="main">→</span> ar <span class="free">Set</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> homf_preserves_arrows<span class="main">)</span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1"><span class="free">Hom(</span></span><span class="free">A</span><span class="main"><span class="free">,_)</span></span><span class="keyword1"><span class="hidden">⇘</span><sub>𝗈</sub><span class="hidden">⇙</span></span> <span class="main">:</span> <span class="keyword1">Ob</span> <span class="main">→</span> ob <span class="free">Set</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> homf_preserves_objects<span class="main">)</span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">f</span><span class="main">∈</span><span class="keyword1">Ar</span><span class="main">.</span> <span class="keyword1"><span class="free">Hom(</span></span><span class="free">A</span><span class="main"><span class="free">,_)</span></span><span class="keyword1"><span class="hidden">⇘</span><sub>𝗈</sub><span class="hidden">⇙</span></span> <span class="main">(</span><span class="keyword1">Dom</span> <span class="bound">f</span><span class="main">)</span> <span class="main">=</span> dom <span class="free">Set</span> <span class="main">(</span><span class="keyword1"><span class="free">Hom(</span></span><span class="free">A</span><span class="main"><span class="free">,_)</span></span><span class="keyword1"><span class="hidden">⇘</span><sub>𝖺</sub><span class="hidden">⇙</span></span> <span class="bound">f</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">intro</span> ballI<span class="main">)</span> <span class="main">(</span><span class="operator">rule</span> homf_preserves_dom<span class="main">)</span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">f</span><span class="main">∈</span><span class="keyword1">Ar</span><span class="main">.</span> <span class="keyword1"><span class="free">Hom(</span></span><span class="free">A</span><span class="main"><span class="free">,_)</span></span><span class="keyword1"><span class="hidden">⇘</span><sub>𝗈</sub><span class="hidden">⇙</span></span> <span class="main">(</span><span class="keyword1">Cod</span> <span class="bound">f</span><span class="main">)</span> <span class="main">=</span> cod <span class="free">Set</span> <span class="main">(</span><span class="keyword1"><span class="free">Hom(</span></span><span class="free">A</span><span class="main"><span class="free">,_)</span></span><span class="keyword1"><span class="hidden">⇘</span><sub>𝖺</sub><span class="hidden">⇙</span></span> <span class="bound">f</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">intro</span> ballI<span class="main">)</span> <span class="main">(</span><span class="operator">rule</span> homf_preserves_cod<span class="main">)</span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">B</span><span class="main">∈</span><span class="keyword1">Ob</span><span class="main">.</span> <span class="keyword1"><span class="free">Hom(</span></span><span class="free">A</span><span class="main"><span class="free">,_)</span></span><span class="keyword1"><span class="hidden">⇘</span><sub>𝖺</sub><span class="hidden">⇙</span></span> <span class="main">(</span><span class="keyword1">Id</span> <span class="bound">B</span><span class="main">)</span> <span class="main">=</span> id <span class="free">Set</span> <span class="main">(</span><span class="keyword1"><span class="free">Hom(</span></span><span class="free">A</span><span class="main"><span class="free">,_)</span></span><span class="keyword1"><span class="hidden">⇘</span><sub>𝗈</sub><span class="hidden">⇙</span></span> <span class="bound">B</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">intro</span> ballI<span class="main">)</span> <span class="main">(</span><span class="operator">rule</span> homf_preserves_id<span class="main">)</span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">f</span><span class="main">∈</span><span class="keyword1">Ar</span><span class="main">.</span> <span class="main">∀</span><span class="bound">g</span><span class="main">∈</span><span class="keyword1">Ar</span><span class="main">.</span> 
    <span class="keyword1">Cod</span> <span class="bound">f</span> <span class="main">=</span> <span class="keyword1">Dom</span> <span class="bound">g</span> <span class="main">⟶</span>
    <span class="keyword1"><span class="free">Hom(</span></span><span class="free">A</span><span class="main"><span class="free">,_)</span></span><span class="keyword1"><span class="hidden">⇘</span><sub>𝖺</sub><span class="hidden">⇙</span></span> <span class="main">(</span><span class="bound">g</span> <span class="main">∙</span> <span class="bound">f</span><span class="main">)</span> <span class="main">=</span> comp <span class="free">Set</span> <span class="main">(</span><span class="keyword1"><span class="free">Hom(</span></span><span class="free">A</span><span class="main"><span class="free">,_)</span></span><span class="keyword1"><span class="hidden">⇘</span><sub>𝖺</sub><span class="hidden">⇙</span></span> <span class="bound">g</span><span class="main">)</span> <span class="main">(</span><span class="keyword1"><span class="free">Hom(</span></span><span class="free">A</span><span class="main"><span class="free">,_)</span></span><span class="keyword1"><span class="hidden">⇘</span><sub>𝖺</sub><span class="hidden">⇙</span></span> <span class="bound">f</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">intro</span> ballI impI<span class="main"><span class="keyword3">,</span></span> <span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> Set_def set_cat_def<span class="main">)</span> <span class="main">(</span><span class="operator">rule</span> homf_preserves_comp<span class="main">)</span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"two_cats <span class="free">AA</span> <span class="free">Set</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="operator">intro_locales</span>
    <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"category <span class="free">Set</span>"</span></span> 
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">unfold</span> Set_def<span class="main"><span class="keyword3">,</span></span> <span class="operator">rule</span> set_cat_cat<span class="main">)</span>
  <span class="keyword1"><span class="command">qed</span></span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword2"><span class="keyword">end</span></span>
</pre>
</div><div id="NatTrans">
<div class="head">
<h1>Theory NatTrans</h1>
</div>
<pre class="source"><span class="comment1">(*  Title:       Category theory using Isar and Locales
    Author:      Greg O'Keefe, June, July, August 2003
    License: LGPL

Define natural transformation, prove that the identity arrow function is one.
*)</span>

<span class="keyword1"><span class="command">section</span></span> <span class="quoted"><span class="plain_text">‹Natural Transformations›</span></span>

<span class="keyword1"><span class="command">theory</span></span> NatTrans
<span class="keyword2"><span class="keyword">imports</span></span> <a href="Functors.html">Functors</a>
<span class="keyword2"><span class="keyword">begin</span></span>

<span class="comment1">(* guess the third axiom is implied by the fifth *)</span>
<span class="keyword1"><span class="command">locale</span></span> natural_transformation <span class="main">=</span> two_cats <span class="main">+</span>
  <span class="keyword2"><span class="keyword">fixes</span></span> <span class="free">F</span> <span class="keyword2"><span class="keyword">and</span></span> <span class="free">G</span> <span class="keyword2"><span class="keyword">and</span></span> <span class="free">u</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">Functor</span> <span class="free">F</span> <span class="main">:</span> <span class="free">AA</span> <span class="main">⟶</span> <span class="free">BB</span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">Functor</span> <span class="free">G</span> <span class="main">:</span> <span class="free">AA</span> <span class="main">⟶</span> <span class="free">BB</span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">u</span> <span class="main">:</span> ob <span class="free">AA</span> <span class="main">→</span> ar <span class="free">BB</span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">u</span> <span class="main">∈</span> extensional <span class="main">(</span>ob <span class="free">AA</span><span class="main">)</span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">A</span><span class="main">∈</span><span class="keyword1">Ob</span><span class="main">.</span> <span class="free">u</span> <span class="bound">A</span> <span class="main">∈</span> <span class="keyword1">Hom</span><span class="main"><span class="hidden">⇘</span><sub></sub></span><span class="free">BB</span><span class="main"><span class="hidden">⇙</span></span> <span class="main">(</span><span class="free">F</span><span class="keyword1"><span class="hidden">⇘</span><sub>𝗈</sub><span class="hidden">⇙</span></span> <span class="bound">A</span><span class="main">)</span> <span class="main">(</span><span class="free">G</span><span class="keyword1"><span class="hidden">⇘</span><sub>𝗈</sub><span class="hidden">⇙</span></span> <span class="bound">A</span><span class="main">)</span>"</span></span> 
  <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">A</span><span class="main">∈</span><span class="keyword1">Ob</span><span class="main">.</span> <span class="main">∀</span><span class="bound">B</span><span class="main">∈</span><span class="keyword1">Ob</span><span class="main">.</span> <span class="main">∀</span><span class="bound">f</span><span class="main">∈</span><span class="keyword1">Hom</span> <span class="bound">A</span> <span class="bound">B</span><span class="main">.</span> <span class="main">(</span><span class="free">G</span><span class="keyword1"><span class="hidden">⇘</span><sub>𝖺</sub><span class="hidden">⇙</span></span> <span class="bound">f</span><span class="main">)</span> <span class="main">∙</span><span class="main"><span class="hidden">⇘</span><sub></sub></span><span class="free">BB</span><span class="main"><span class="hidden">⇙</span></span> <span class="main">(</span><span class="free">u</span> <span class="bound">A</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="free">u</span> <span class="bound">B</span><span class="main">)</span> <span class="main">∙</span><span class="main"><span class="hidden">⇘</span><sub></sub></span><span class="free">BB</span><span class="main"><span class="hidden">⇙</span></span> <span class="main">(</span><span class="free">F</span><span class="keyword1"><span class="hidden">⇘</span><sub>𝖺</sub><span class="hidden">⇙</span></span> <span class="bound">f</span><span class="main">)</span>"</span></span>

<span class="keyword1"><span class="command">abbreviation</span></span>
  <span class="entity">nt_syn</span>  <span class="main">(</span><span class="quoted">"_ <span class="keyword1">:</span> _ <span class="keyword1">⇒</span> _ <span class="keyword1">in</span> <span class="keyword1">Func</span> <span class="keyword1">'(</span>_ <span class="keyword1">,</span> _ <span class="keyword1">')</span>"</span> <span class="main">[</span>81<span class="main">]</span><span class="main">)</span> <span class="keyword2"><span class="keyword">where</span></span>
  <span class="quoted"><span class="quoted">"<span class="free"><span class="bound"><span class="entity">u</span></span></span> <span class="main"><span class="free">:</span></span> <span class="free"><span class="bound"><span class="entity">F</span></span></span> <span class="main"><span class="free">⇒</span></span> <span class="free"><span class="bound"><span class="entity">G</span></span></span> <span class="keyword1"><span class="free">in</span></span> <span class="keyword1"><span class="free">Func</span></span><span class="main"><span class="free">(</span></span><span class="free"><span class="bound"><span class="entity">AA</span></span></span><span class="main"><span class="free">,</span></span> <span class="free"><span class="bound"><span class="entity">BB</span></span></span><span class="main"><span class="free">)</span></span> <span class="main">≡</span> natural_transformation <span class="free"><span class="bound"><span class="entity">AA</span></span></span> <span class="free"><span class="bound"><span class="entity">BB</span></span></span> <span class="free"><span class="bound"><span class="entity">F</span></span></span> <span class="free"><span class="bound"><span class="entity">G</span></span></span> <span class="free"><span class="bound"><span class="entity">u</span></span></span>"</span></span>

<span class="comment1">(* is this doing what I think its doing? *)</span>
<span class="keyword1"><span class="command">locale</span></span> endoNT <span class="main">=</span> natural_transformation <span class="main">+</span> one_cat

<span class="keyword1"><span class="command">theorem</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> endoNT<span class="main">)</span> id_restrict_natural<span class="main">:</span>
  <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">λ</span><span class="bound">A</span><span class="main">∈</span><span class="keyword1">Ob</span><span class="main">.</span> <span class="keyword1">Id</span> <span class="bound">A</span><span class="main">)</span> <span class="main">:</span> <span class="main">(</span>id_func <span class="free">AA</span><span class="main">)</span> <span class="main">⇒</span> <span class="main">(</span>id_func <span class="free">AA</span><span class="main">)</span> <span class="keyword1">in</span> <span class="keyword1">Func</span><span class="main">(</span><span class="free">AA</span><span class="main">,</span><span class="free">AA</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">intro</span> natural_transformation.intro natural_transformation_axioms.intro 
    two_cats.intro ballI<span class="main">)</span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">λ</span><span class="bound">A</span><span class="main">∈</span><span class="keyword1">Ob</span><span class="main">.</span> <span class="keyword1">Id</span> <span class="bound">A</span><span class="main">)</span> <span class="main">:</span> <span class="keyword1">Ob</span> <span class="main">→</span> <span class="keyword1">Ar</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> funcsetI<span class="main">)</span> <span class="operator">auto</span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">λ</span><span class="bound">A</span><span class="main">∈</span><span class="keyword1">Ob</span><span class="main">.</span> <span class="keyword1">Id</span> <span class="bound">A</span><span class="main">)</span> <span class="main">∈</span> extensional <span class="main">(</span><span class="keyword1">Ob</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> restrict_extensional<span class="main">)</span>
  <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">A</span> 
  <span class="keyword3"><span class="command">assume</span></span> A<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">A</span> <span class="main">∈</span> <span class="keyword1">Ob</span>"</span></span> 
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">Id</span> <span class="skolem">A</span> <span class="main">∈</span> <span class="keyword1">Hom</span> <span class="skolem">A</span> <span class="skolem">A</span>"</span></span> <span class="keyword1"><span class="command">..</span></span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">λ</span><span class="bound">X</span><span class="main">∈</span><span class="keyword1">Ob</span><span class="main">.</span> <span class="keyword1">Id</span> <span class="bound">X</span><span class="main">)</span> <span class="skolem">A</span> <span class="main">∈</span> <span class="keyword1">Hom</span> <span class="main">(</span><span class="main">(</span>id_func <span class="free">AA</span><span class="main">)</span><span class="keyword1"><span class="hidden">⇘</span><sub>𝗈</sub><span class="hidden">⇙</span></span> <span class="skolem">A</span><span class="main">)</span>  <span class="main">(</span><span class="main">(</span>id_func <span class="free">AA</span><span class="main">)</span><span class="keyword1"><span class="hidden">⇘</span><sub>𝗈</sub><span class="hidden">⇙</span></span> <span class="skolem">A</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> A <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> id_func_def<span class="main">)</span> 
  <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">B</span> <span class="keyword2"><span class="keyword">and</span></span> <span class="skolem">f</span>
  <span class="keyword3"><span class="command">assume</span></span> B<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">B</span> <span class="main">∈</span> <span class="keyword1">Ob</span>"</span></span> 
    <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">f</span> <span class="main">∈</span> <span class="keyword1">Hom</span> <span class="skolem">A</span> <span class="skolem">B</span>"</span></span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">f</span> <span class="main">∈</span> <span class="keyword1">Ar</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">A</span> <span class="main">=</span> <span class="keyword1">Dom</span> <span class="skolem">f</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">B</span> <span class="main">=</span> <span class="keyword1">Cod</span> <span class="skolem">f</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">Dom</span> <span class="skolem">f</span> <span class="main">∈</span> <span class="keyword1">Ob</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">Cod</span> <span class="skolem">f</span> <span class="main">∈</span> <span class="keyword1">Ob</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> A <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp_all</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> hom_def<span class="main">)</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span>id_func <span class="free">AA</span><span class="main">)</span><span class="keyword1"><span class="hidden">⇘</span><sub>𝖺</sub><span class="hidden">⇙</span></span> <span class="skolem">f</span> <span class="main">∙</span> <span class="main">(</span><span class="main">λ</span><span class="bound">A</span><span class="main">∈</span><span class="keyword1">Ob</span><span class="main">.</span> <span class="keyword1">Id</span> <span class="bound">A</span><span class="main">)</span> <span class="skolem">A</span>
      <span class="main">=</span> <span class="main">(</span><span class="main">λ</span><span class="bound">A</span><span class="main">∈</span><span class="keyword1">Ob</span><span class="main">.</span> <span class="keyword1">Id</span> <span class="bound">A</span><span class="main">)</span> <span class="skolem">B</span> <span class="main">∙</span> <span class="main">(</span>id_func <span class="free">AA</span><span class="main">)</span><span class="keyword1"><span class="hidden">⇘</span><sub>𝖺</sub><span class="hidden">⇙</span></span> <span class="skolem">f</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span>  id_func_def<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">intro</span><span class="main"><span class="main">:</span></span> id_func_functor<span class="main"><span class="keyword3">,</span></span> <span class="operator">unfold_locales</span><span class="main"><span class="keyword3">,</span></span> <span class="operator">unfold_locales</span><span class="main">)</span>

<span class="keyword2"><span class="keyword">end</span></span>
</pre>
</div><div id="Yoneda">
<div class="head">
<h1>Theory Yoneda</h1>
</div>
<pre class="source"><span class="comment1">(*  Title:       Category theory using Isar and Locales
    Author:      Greg O'Keefe, June, July, August 2003
    License: LGPL
*)</span>

<span class="keyword1"><span class="command">section</span></span> <span class="quoted"><span class="plain_text">‹Yonedas Lemma›</span></span>

<span class="keyword1"><span class="command">theory</span></span> Yoneda
<span class="keyword2"><span class="keyword">imports</span></span> <a href="HomFunctors.html">HomFunctors</a> <a href="NatTrans.html">NatTrans</a>
<span class="keyword2"><span class="keyword">begin</span></span>

<span class="keyword1"><span class="command">subsection</span></span> <span class="quoted"><span class="plain_text">‹The Sandwich Natural Transformation›</span></span>

<span class="keyword1"><span class="command">locale</span></span> Yoneda <span class="main">=</span> <span class="quoted">"functor"</span> <span class="main">+</span> into_set <span class="main">+</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">TERM</span> <span class="main">(</span><span class="free">AA</span> <span class="main">::</span> <span class="main">(</span><span class="tfree">'o</span><span class="main">,</span><span class="tfree">'a</span><span class="main">,</span><span class="tfree">'m</span><span class="main">)</span>category_scheme<span class="main">)</span>"</span></span>
  <span class="keyword2"><span class="keyword">fixes</span></span> <span class="free">sandwich</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="main">[</span><span class="tfree">'o</span><span class="main">,</span><span class="tfree">'a</span><span class="main">,</span><span class="tfree">'o</span><span class="main">]</span> <span class="main">⇒</span> <span class="tfree">'a</span> set_arrow"</span></span>  <span class="main">(</span><span class="quoted">"<span class="keyword1">σ'(</span>_<span class="keyword1">,</span>_<span class="keyword1">')</span>"</span><span class="main">)</span>
  <span class="keyword2"><span class="keyword">defines</span></span> <span class="quoted"><span class="quoted">"<span class="free">sandwich</span> <span class="free">A</span> <span class="free">a</span> <span class="main">≡</span> <span class="main">(</span><span class="main">λ</span><span class="bound">B</span><span class="main">∈</span><span class="keyword1">Ob</span><span class="main">.</span> <span class="main">⦇</span>
  set_dom<span class="main">=</span><span class="keyword1">Hom</span> <span class="free">A</span> <span class="bound">B</span><span class="main">,</span>
  set_func<span class="main">=</span><span class="main">(</span><span class="main">λ</span><span class="bound">f</span><span class="main">∈</span><span class="keyword1">Hom</span> <span class="free">A</span> <span class="bound">B</span><span class="main">.</span> set_func <span class="main">(</span><span class="free">F</span><span class="keyword1"><span class="hidden">⇘</span><sub>𝖺</sub><span class="hidden">⇙</span></span> <span class="bound">f</span><span class="main">)</span> <span class="free">a</span><span class="main">)</span><span class="main">,</span>
  set_cod<span class="main">=</span><span class="free">F</span><span class="keyword1"><span class="hidden">⇘</span><sub>𝗈</sub><span class="hidden">⇙</span></span> <span class="bound">B</span>
  <span class="main">⦈</span><span class="main">)</span>"</span></span>
  <span class="keyword2"><span class="keyword">fixes</span></span> <span class="free">unsandwich</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="main">[</span><span class="tfree">'o</span><span class="main">,</span><span class="tfree">'o</span> <span class="main">⇒</span> <span class="tfree">'a</span> set_arrow<span class="main">]</span> <span class="main">⇒</span> <span class="tfree">'a</span>"</span></span> <span class="main">(</span><span class="quoted">"<span class="keyword1">σ<span class="hidden">⇧</span><sup>←</sup>'(</span>_<span class="keyword1">,</span>_<span class="keyword1">')</span>"</span><span class="main">)</span>
  <span class="keyword2"><span class="keyword">defines</span></span> <span class="quoted"><span class="quoted">"<span class="free">unsandwich</span> <span class="free">A</span> <span class="free">u</span> <span class="main">≡</span> set_func <span class="main">(</span><span class="free">u</span> <span class="free">A</span><span class="main">)</span> <span class="main">(</span><span class="keyword1">Id</span> <span class="free">A</span><span class="main">)</span>"</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> Yoneda<span class="main">)</span> F_into_set<span class="main">:</span> 
  <span class="quoted"><span class="quoted">"<span class="keyword1">Functor</span> <span class="free">F</span> <span class="main">:</span> <span class="free">AA</span> <span class="main">⟶</span> <span class="free">Set</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
  <span class="keyword1"><span class="command">from</span></span> F_axioms <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">Functor</span> <span class="free">F</span> <span class="main">:</span> <span class="free">AA</span> <span class="main">⟶</span> <span class="free">BB</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">intro_locales</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">only</span><span class="main"><span class="main">:</span></span> BB_Set<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>


<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> Yoneda<span class="main">)</span> F_comp_func<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> 1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">A</span> <span class="main">∈</span> <span class="keyword1">Ob</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> 2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">B</span> <span class="main">∈</span> <span class="keyword1">Ob</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> 3<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">C</span> <span class="main">∈</span> <span class="keyword1">Ob</span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> 4<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">g</span> <span class="main">∈</span> <span class="keyword1">Hom</span> <span class="free">A</span> <span class="free">B</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> 5<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">f</span> <span class="main">∈</span> <span class="keyword1">Hom</span> <span class="free">B</span> <span class="free">C</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"set_func <span class="main">(</span><span class="free">F</span><span class="keyword1"><span class="hidden">⇘</span><sub>𝖺</sub><span class="hidden">⇙</span></span> <span class="main">(</span><span class="free">f</span> <span class="main">∙</span> <span class="free">g</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> compose <span class="main">(</span><span class="free">F</span><span class="keyword1"><span class="hidden">⇘</span><sub>𝗈</sub><span class="hidden">⇙</span></span> <span class="free">A</span><span class="main">)</span> <span class="main">(</span>set_func <span class="main">(</span><span class="free">F</span><span class="keyword1"><span class="hidden">⇘</span><sub>𝖺</sub><span class="hidden">⇙</span></span> <span class="free">f</span><span class="main">)</span><span class="main">)</span> <span class="main">(</span>set_func <span class="main">(</span><span class="free">F</span><span class="keyword1"><span class="hidden">⇘</span><sub>𝖺</sub><span class="hidden">⇙</span></span> <span class="free">g</span><span class="main">)</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
  <span class="keyword1"><span class="command">from</span></span> 4 <span class="keyword2"><span class="keyword">and</span></span> 5 
  <span class="keyword1"><span class="command">have</span></span> 7<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="keyword1">Cod</span> <span class="free">g</span> <span class="main">=</span> <span class="keyword1">Dom</span> <span class="free">f</span>"</span></span> 
    <span class="keyword2"><span class="keyword">and</span></span> 8<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">g</span> <span class="main">∈</span> <span class="keyword1">Ar</span>"</span></span> 
    <span class="keyword2"><span class="keyword">and</span></span> 9<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">f</span> <span class="main">∈</span> <span class="keyword1">Ar</span>"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> 10<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="keyword1">Dom</span> <span class="free">g</span> <span class="main">=</span> <span class="free">A</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp_all</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> hom_def<span class="main">)</span>
  <span class="keyword1"><span class="command">from</span></span> F_preserves_dom <span class="keyword2"><span class="keyword">and</span></span> 8 <span class="keyword2"><span class="keyword">and</span></span> 10
  <span class="keyword1"><span class="command">have</span></span> 11<span class="main">:</span> <span class="quoted"><span class="quoted">"set_dom <span class="main">(</span><span class="free">F</span><span class="keyword1"><span class="hidden">⇘</span><sub>𝖺</sub><span class="hidden">⇙</span></span> <span class="free">g</span><span class="main">)</span> <span class="main">=</span> <span class="free">F</span><span class="keyword1"><span class="hidden">⇘</span><sub>𝗈</sub><span class="hidden">⇙</span></span> <span class="free">A</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> preserves_dom_def BB_Set Set_def<span class="main">)</span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">from</span></span> F_preserves_comp <span class="keyword2"><span class="keyword">and</span></span> 7 <span class="keyword2"><span class="keyword">and</span></span> 8 <span class="keyword2"><span class="keyword">and</span></span> 9
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">F</span><span class="keyword1"><span class="hidden">⇘</span><sub>𝖺</sub><span class="hidden">⇙</span></span> <span class="main">(</span><span class="free">f</span> <span class="main">∙</span> <span class="free">g</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="free">F</span><span class="keyword1"><span class="hidden">⇘</span><sub>𝖺</sub><span class="hidden">⇙</span></span> <span class="free">f</span><span class="main">)</span> <span class="main">∙</span><span class="main"><span class="hidden">⇘</span><sub></sub></span><span class="free">BB</span><span class="main"><span class="hidden">⇙</span></span> <span class="main">(</span><span class="free">F</span><span class="keyword1"><span class="hidden">⇘</span><sub>𝖺</sub><span class="hidden">⇙</span></span> <span class="free">g</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> preserves_comp_def<span class="main">)</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"set_func <span class="main">(</span><span class="free">F</span><span class="keyword1"><span class="hidden">⇘</span><sub>𝖺</sub><span class="hidden">⇙</span></span> <span class="main">(</span><span class="free">f</span> <span class="main">∙</span> <span class="free">g</span><span class="main">)</span><span class="main">)</span>  <span class="main">=</span> set_func <span class="main">(</span><span class="main">(</span><span class="free">F</span><span class="keyword1"><span class="hidden">⇘</span><sub>𝖺</sub><span class="hidden">⇙</span></span> <span class="free">f</span><span class="main">)</span> <span class="main">⊙</span> <span class="main">(</span><span class="free">F</span><span class="keyword1"><span class="hidden">⇘</span><sub>𝖺</sub><span class="hidden">⇙</span></span> <span class="free">g</span><span class="main">)</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> BB_Set Set_def<span class="main">)</span>
  <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">…</span> <span class="main">=</span> compose <span class="main">(</span><span class="free">F</span><span class="keyword1"><span class="hidden">⇘</span><sub>𝗈</sub><span class="hidden">⇙</span></span> <span class="free">A</span><span class="main">)</span> <span class="main">(</span>set_func <span class="main">(</span><span class="free">F</span><span class="keyword1"><span class="hidden">⇘</span><sub>𝖺</sub><span class="hidden">⇙</span></span> <span class="free">f</span><span class="main">)</span><span class="main">)</span> <span class="main">(</span>set_func <span class="main">(</span><span class="free">F</span><span class="keyword1"><span class="hidden">⇘</span><sub>𝖺</sub><span class="hidden">⇙</span></span> <span class="free">g</span><span class="main">)</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> set_comp_def 11<span class="main">)</span>
  <span class="keyword1"><span class="command">finally</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">.</span></span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> Yoneda<span class="main">)</span> sandwich_funcset<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> A<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">A</span> <span class="main">∈</span> <span class="keyword1">Ob</span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span> <span class="main">∈</span> <span class="free">F</span><span class="keyword1"><span class="hidden">⇘</span><sub>𝗈</sub><span class="hidden">⇙</span></span> <span class="free">A</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span>  <span class="quoted"><span class="quoted">"<span class="keyword1"><span class="free">σ(</span></span><span class="free">A</span><span class="main"><span class="free">,</span></span><span class="free">a</span><span class="main"><span class="free">)</span></span> <span class="main">:</span> <span class="keyword1">Ob</span> <span class="main">→</span> ar <span class="free">Set</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">rule</span> funcsetI<span class="main">)</span>
  <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">B</span>
  <span class="keyword3"><span class="command">assume</span></span> B<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">B</span> <span class="main">∈</span> <span class="keyword1">Ob</span>"</span></span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1"><span class="free">σ(</span></span><span class="free">A</span><span class="main"><span class="free">,</span></span><span class="free">a</span><span class="main"><span class="free">)</span></span> <span class="skolem">B</span> <span class="main">∈</span> ar <span class="free">Set</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> Set_def sandwich_def set_cat_def<span class="main">)</span>
    <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"set_arrow <span class="free">U</span> <span class="main">⦇</span>
      set_dom <span class="main">=</span> <span class="keyword1">Hom</span> <span class="free">A</span> <span class="skolem">B</span><span class="main">,</span> 
      set_func <span class="main">=</span> <span class="main">λ</span><span class="bound">f</span><span class="main">∈</span><span class="keyword1">Hom</span> <span class="free">A</span> <span class="skolem">B</span><span class="main">.</span> set_func <span class="main">(</span><span class="free">F</span><span class="keyword1"><span class="hidden">⇘</span><sub>𝖺</sub><span class="hidden">⇙</span></span> <span class="bound">f</span><span class="main">)</span> <span class="free">a</span><span class="main">,</span> 
      set_cod <span class="main">=</span> <span class="free">F</span><span class="keyword1"><span class="hidden">⇘</span><sub>𝗈</sub><span class="hidden">⇙</span></span> <span class="skolem">B</span><span class="main">⦈</span>"</span></span>
    <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> set_arrow_def<span class="main"><span class="keyword3">,</span></span> <span class="operator">intro</span> conjI<span class="main">)</span>
      <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">Hom</span> <span class="free">A</span> <span class="skolem">B</span> <span class="main">⊆</span> <span class="free">U</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">F</span><span class="keyword1"><span class="hidden">⇘</span><sub>𝗈</sub><span class="hidden">⇙</span></span> <span class="skolem">B</span> <span class="main">⊆</span> <span class="free">U</span>"</span></span>
        <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp_all</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> U_def<span class="main">)</span>
      <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">λ</span><span class="bound">f</span><span class="main">∈</span><span class="keyword1">Hom</span> <span class="free">A</span> <span class="skolem">B</span><span class="main">.</span> set_func <span class="main">(</span><span class="free">F</span><span class="keyword1"><span class="hidden">⇘</span><sub>𝖺</sub><span class="hidden">⇙</span></span> <span class="bound">f</span><span class="main">)</span> <span class="free">a</span><span class="main">)</span> <span class="main">∈</span> <span class="keyword1">Hom</span> <span class="free">A</span> <span class="skolem">B</span> <span class="main">→</span> <span class="free">F</span><span class="keyword1"><span class="hidden">⇘</span><sub>𝗈</sub><span class="hidden">⇙</span></span> <span class="skolem">B</span>"</span></span>
      <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">rule</span> funcsetI<span class="main"><span class="keyword3">,</span></span> <span class="operator">simp</span><span class="main">)</span>
        <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">f</span>
        <span class="keyword3"><span class="command">assume</span></span> f<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">f</span> <span class="main">∈</span> <span class="keyword1">Hom</span> <span class="free">A</span> <span class="skolem">B</span>"</span></span>
        <span class="keyword1"><span class="command">with</span></span> A B <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">F</span><span class="keyword1"><span class="hidden">⇘</span><sub>𝖺</sub><span class="hidden">⇙</span></span> <span class="skolem">f</span> <span class="main">∈</span> <span class="keyword1">Hom</span><span class="main"><span class="hidden">⇘</span><sub></sub></span><span class="free">BB</span><span class="main"><span class="hidden">⇙</span></span> <span class="main">(</span><span class="free">F</span><span class="keyword1"><span class="hidden">⇘</span><sub>𝗈</sub><span class="hidden">⇙</span></span> <span class="free">A</span><span class="main">)</span> <span class="main">(</span><span class="free">F</span><span class="keyword1"><span class="hidden">⇘</span><sub>𝗈</sub><span class="hidden">⇙</span></span> <span class="skolem">B</span><span class="main">)</span>"</span></span>
          <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> functors_preserve_homsets<span class="main">)</span>
        <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="free">F</span><span class="keyword1"><span class="hidden">⇘</span><sub>𝖺</sub><span class="hidden">⇙</span></span> <span class="skolem">f</span> <span class="main">∈</span> ar <span class="free">Set</span>"</span></span> 
          <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"set_dom <span class="main">(</span><span class="free">F</span><span class="keyword1"><span class="hidden">⇘</span><sub>𝖺</sub><span class="hidden">⇙</span></span> <span class="skolem">f</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="free">F</span><span class="keyword1"><span class="hidden">⇘</span><sub>𝗈</sub><span class="hidden">⇙</span></span> <span class="free">A</span><span class="main">)</span>"</span></span>
          <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"set_cod <span class="main">(</span><span class="free">F</span><span class="keyword1"><span class="hidden">⇘</span><sub>𝖺</sub><span class="hidden">⇙</span></span> <span class="skolem">f</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="free">F</span><span class="keyword1"><span class="hidden">⇘</span><sub>𝗈</sub><span class="hidden">⇙</span></span> <span class="skolem">B</span><span class="main">)</span>"</span></span>
          <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp_all</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> hom_def BB_Set Set_def<span class="main">)</span>
        <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"set_func <span class="main">(</span><span class="free">F</span><span class="keyword1"><span class="hidden">⇘</span><sub>𝖺</sub><span class="hidden">⇙</span></span> <span class="skolem">f</span><span class="main">)</span> <span class="main">:</span> <span class="main">(</span><span class="free">F</span><span class="keyword1"><span class="hidden">⇘</span><sub>𝗈</sub><span class="hidden">⇙</span></span> <span class="free">A</span><span class="main">)</span> <span class="main">→</span> <span class="main">(</span><span class="free">F</span><span class="keyword1"><span class="hidden">⇘</span><sub>𝗈</sub><span class="hidden">⇙</span></span> <span class="skolem">B</span><span class="main">)</span>"</span></span>
          <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> Set_def set_cat_def set_arrow_def<span class="main">)</span>
        <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"set_func <span class="main">(</span><span class="free">F</span><span class="keyword1"><span class="hidden">⇘</span><sub>𝖺</sub><span class="hidden">⇙</span></span> <span class="skolem">f</span><span class="main">)</span> <span class="free">a</span> <span class="main">∈</span> <span class="free">F</span><span class="keyword1"><span class="hidden">⇘</span><sub>𝗈</sub><span class="hidden">⇙</span></span> <span class="skolem">B</span>"</span></span>
          <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="free">a</span> <span class="main">∈</span> <span class="free">F</span><span class="keyword1"><span class="hidden">⇘</span><sub>𝗈</sub><span class="hidden">⇙</span></span> <span class="free">A</span>›</span></span>
          <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> funcset_mem<span class="main">)</span>
      <span class="keyword1"><span class="command">qed</span></span>
    <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">qed</span></span>
<span class="keyword1"><span class="command">qed</span></span>


<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> Yoneda<span class="main">)</span> sandwich_type<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> A<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">A</span> <span class="main">∈</span> <span class="keyword1">Ob</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> B<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">B</span> <span class="main">∈</span> <span class="keyword1">Ob</span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span> <span class="main">∈</span> <span class="free">F</span><span class="keyword1"><span class="hidden">⇘</span><sub>𝗈</sub><span class="hidden">⇙</span></span> <span class="free">A</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1"><span class="free">σ(</span></span><span class="free">A</span><span class="main"><span class="free">,</span></span><span class="free">a</span><span class="main"><span class="free">)</span></span> <span class="free">B</span> <span class="main">∈</span> hom <span class="free">Set</span> <span class="main">(</span><span class="keyword1">Hom</span> <span class="free">A</span> <span class="free">B</span><span class="main">)</span> <span class="main">(</span><span class="free">F</span><span class="keyword1"><span class="hidden">⇘</span><sub>𝗈</sub><span class="hidden">⇙</span></span> <span class="free">B</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1"><span class="free">σ(</span></span><span class="free">A</span><span class="main"><span class="free">,</span></span><span class="free">a</span><span class="main"><span class="free">)</span></span> <span class="main">∈</span> <span class="keyword1">Ob</span> <span class="main">→</span> <span class="keyword1">Ar</span><span class="main"><span class="hidden">⇘</span><sub></sub></span><span class="free">Set</span><span class="main"><span class="hidden">⇙</span></span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> A <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹<span class="free">a</span> <span class="main">∈</span> <span class="free">F</span><span class="keyword1"><span class="hidden">⇘</span><sub>𝗈</sub><span class="hidden">⇙</span></span> <span class="free">A</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> sandwich_funcset<span class="main">)</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1"><span class="free">σ(</span></span><span class="free">A</span><span class="main"><span class="free">,</span></span><span class="free">a</span><span class="main"><span class="free">)</span></span> <span class="free">B</span> <span class="main">∈</span> ar <span class="free">Set</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> B <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> funcset_mem<span class="main">)</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
    <span class="keyword1"><span class="command">using</span></span> B <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> sandwich_def hom_def Set_def<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>


<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> Yoneda<span class="main">)</span> sandwich_commutes<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> AOb<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">A</span> <span class="main">∈</span> <span class="keyword1">Ob</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> BOb<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">B</span> <span class="main">∈</span> <span class="keyword1">Ob</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> COb<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">C</span> <span class="main">∈</span> <span class="keyword1">Ob</span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> aFa<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">a</span> <span class="main">∈</span> <span class="free">F</span><span class="keyword1"><span class="hidden">⇘</span><sub>𝗈</sub><span class="hidden">⇙</span></span> <span class="free">A</span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> fBC<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">f</span> <span class="main">∈</span> <span class="keyword1">Hom</span> <span class="free">B</span> <span class="free">C</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">F</span><span class="keyword1"><span class="hidden">⇘</span><sub>𝖺</sub><span class="hidden">⇙</span></span> <span class="free">f</span><span class="main">)</span> <span class="main">⊙</span> <span class="main">(</span><span class="keyword1"><span class="free">σ(</span></span><span class="free">A</span><span class="main"><span class="free">,</span></span><span class="free">a</span><span class="main"><span class="free">)</span></span> <span class="free">B</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="keyword1"><span class="free">σ(</span></span><span class="free">A</span><span class="main"><span class="free">,</span></span><span class="free">a</span><span class="main"><span class="free">)</span></span> <span class="free">C</span><span class="main">)</span> <span class="main">⊙</span> <span class="main">(</span><span class="keyword1"><span class="free">Hom(</span></span><span class="free">A</span><span class="main"><span class="free">,_)</span></span><span class="keyword1"><span class="hidden">⇘</span><sub>𝖺</sub><span class="hidden">⇙</span></span> <span class="free">f</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
  <span class="keyword1"><span class="command">from</span></span> fBC <span class="keyword1"><span class="command">have</span></span> 1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">f</span> <span class="main">∈</span> <span class="keyword1">Ar</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> 2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="keyword1">Dom</span> <span class="free">f</span> <span class="main">=</span> <span class="free">B</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> 3<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="keyword1">Cod</span> <span class="free">f</span> <span class="main">=</span> <span class="free">C</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp_all</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> hom_def<span class="main">)</span>
  <span class="keyword1"><span class="command">from</span></span> BOb <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"set_dom <span class="main">(</span><span class="main">(</span><span class="free">F</span><span class="keyword1"><span class="hidden">⇘</span><sub>𝖺</sub><span class="hidden">⇙</span></span> <span class="free">f</span><span class="main">)</span> <span class="main">⊙</span> <span class="main">(</span><span class="keyword1"><span class="free">σ(</span></span><span class="free">A</span><span class="main"><span class="free">,</span></span><span class="free">a</span><span class="main"><span class="free">)</span></span> <span class="free">B</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> <span class="keyword1">Hom</span> <span class="free">A</span> <span class="free">B</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> set_comp_def sandwich_def<span class="main">)</span>
  <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">…</span> <span class="main">=</span> set_dom <span class="main">(</span><span class="main">(</span><span class="keyword1"><span class="free">σ(</span></span><span class="free">A</span><span class="main"><span class="free">,</span></span><span class="free">a</span><span class="main"><span class="free">)</span></span> <span class="free">C</span><span class="main">)</span> <span class="main">⊙</span> <span class="main">(</span><span class="keyword1"><span class="free">Hom(</span></span><span class="free">A</span><span class="main"><span class="free">,_)</span></span><span class="keyword1"><span class="hidden">⇘</span><sub>𝖺</sub><span class="hidden">⇙</span></span> <span class="free">f</span><span class="main">)</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> set_comp_def homf_def 1 2<span class="main">)</span>
  <span class="keyword1"><span class="command">finally</span></span> <span class="keyword1"><span class="command">have</span></span> set_dom_eq<span class="main">:</span> 
    <span class="quoted"><span class="quoted">"set_dom <span class="main">(</span><span class="main">(</span><span class="free">F</span><span class="keyword1"><span class="hidden">⇘</span><sub>𝖺</sub><span class="hidden">⇙</span></span> <span class="free">f</span><span class="main">)</span> <span class="main">⊙</span> <span class="main">(</span><span class="keyword1"><span class="free">σ(</span></span><span class="free">A</span><span class="main"><span class="free">,</span></span><span class="free">a</span><span class="main"><span class="free">)</span></span> <span class="free">B</span><span class="main">)</span><span class="main">)</span> 
    <span class="main">=</span> set_dom <span class="main">(</span><span class="main">(</span><span class="keyword1"><span class="free">σ(</span></span><span class="free">A</span><span class="main"><span class="free">,</span></span><span class="free">a</span><span class="main"><span class="free">)</span></span> <span class="free">C</span><span class="main">)</span> <span class="main">⊙</span> <span class="main">(</span><span class="keyword1"><span class="free">Hom(</span></span><span class="free">A</span><span class="main"><span class="free">,_)</span></span><span class="keyword1"><span class="hidden">⇘</span><sub>𝖺</sub><span class="hidden">⇙</span></span> <span class="free">f</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">.</span></span>
  <span class="keyword1"><span class="command">from</span></span> BOb COb fBC <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">F</span><span class="keyword1"><span class="hidden">⇘</span><sub>𝖺</sub><span class="hidden">⇙</span></span> <span class="free">f</span><span class="main">)</span> <span class="main">∈</span> <span class="keyword1">Hom</span><span class="main"><span class="hidden">⇘</span><sub></sub></span><span class="free">BB</span><span class="main"><span class="hidden">⇙</span></span> <span class="main">(</span><span class="free">F</span><span class="keyword1"><span class="hidden">⇘</span><sub>𝗈</sub><span class="hidden">⇙</span></span> <span class="free">B</span><span class="main">)</span> <span class="main">(</span><span class="free">F</span><span class="keyword1"><span class="hidden">⇘</span><sub>𝗈</sub><span class="hidden">⇙</span></span> <span class="free">C</span><span class="main">)</span>"</span></span> 
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> functors_preserve_homsets<span class="main">)</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"set_cod <span class="main">(</span><span class="main">(</span><span class="free">F</span><span class="keyword1"><span class="hidden">⇘</span><sub>𝖺</sub><span class="hidden">⇙</span></span> <span class="free">f</span><span class="main">)</span> <span class="main">⊙</span> <span class="main">(</span><span class="keyword1"><span class="free">σ(</span></span><span class="free">A</span><span class="main"><span class="free">,</span></span><span class="free">a</span><span class="main"><span class="free">)</span></span> <span class="free">B</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> <span class="free">F</span><span class="keyword1"><span class="hidden">⇘</span><sub>𝗈</sub><span class="hidden">⇙</span></span> <span class="free">C</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> set_comp_def BB_Set Set_def set_cat_def hom_def<span class="main">)</span>
  <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">from</span></span> COb
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">…</span> <span class="main">=</span> set_cod <span class="main">(</span><span class="main">(</span><span class="keyword1"><span class="free">σ(</span></span><span class="free">A</span><span class="main"><span class="free">,</span></span><span class="free">a</span><span class="main"><span class="free">)</span></span> <span class="free">C</span><span class="main">)</span> <span class="main">⊙</span> <span class="main">(</span><span class="keyword1"><span class="free">Hom(</span></span><span class="free">A</span><span class="main"><span class="free">,_)</span></span><span class="keyword1"><span class="hidden">⇘</span><sub>𝖺</sub><span class="hidden">⇙</span></span> <span class="free">f</span><span class="main">)</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> set_comp_def sandwich_def<span class="main">)</span>
  <span class="keyword1"><span class="command">finally</span></span> <span class="keyword1"><span class="command">have</span></span> set_cod_eq<span class="main">:</span>
    <span class="quoted"><span class="quoted">"set_cod <span class="main">(</span><span class="main">(</span><span class="free">F</span><span class="keyword1"><span class="hidden">⇘</span><sub>𝖺</sub><span class="hidden">⇙</span></span> <span class="free">f</span><span class="main">)</span> <span class="main">⊙</span> <span class="main">(</span><span class="keyword1"><span class="free">σ(</span></span><span class="free">A</span><span class="main"><span class="free">,</span></span><span class="free">a</span><span class="main"><span class="free">)</span></span> <span class="free">B</span><span class="main">)</span><span class="main">)</span> 
    <span class="main">=</span> set_cod <span class="main">(</span><span class="main">(</span><span class="keyword1"><span class="free">σ(</span></span><span class="free">A</span><span class="main"><span class="free">,</span></span><span class="free">a</span><span class="main"><span class="free">)</span></span> <span class="free">C</span><span class="main">)</span> <span class="main">⊙</span> <span class="main">(</span><span class="keyword1"><span class="free">Hom(</span></span><span class="free">A</span><span class="main"><span class="free">,_)</span></span><span class="keyword1"><span class="hidden">⇘</span><sub>𝖺</sub><span class="hidden">⇙</span></span> <span class="free">f</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">.</span></span>
  <span class="keyword1"><span class="command">from</span></span> AOb <span class="keyword2"><span class="keyword">and</span></span> BOb <span class="keyword2"><span class="keyword">and</span></span> COb <span class="keyword2"><span class="keyword">and</span></span> fBC <span class="keyword2"><span class="keyword">and</span></span> aFa
  <span class="keyword1"><span class="command">have</span></span> set_func_lhs<span class="main">:</span> 
    <span class="quoted"><span class="quoted">"set_func <span class="main">(</span><span class="main">(</span><span class="free">F</span><span class="keyword1"><span class="hidden">⇘</span><sub>𝖺</sub><span class="hidden">⇙</span></span> <span class="free">f</span><span class="main">)</span> <span class="main">⊙</span> <span class="main">(</span><span class="keyword1"><span class="free">σ(</span></span><span class="free">A</span><span class="main"><span class="free">,</span></span><span class="free">a</span><span class="main"><span class="free">)</span></span> <span class="free">B</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> 
    <span class="main">(</span><span class="main">λ</span><span class="bound">g</span><span class="main">∈</span><span class="keyword1">Hom</span> <span class="free">A</span> <span class="free">B</span><span class="main">.</span> set_func <span class="main">(</span><span class="free">F</span><span class="keyword1"><span class="hidden">⇘</span><sub>𝖺</sub><span class="hidden">⇙</span></span> <span class="main">(</span><span class="free">f</span> <span class="main">∙</span> <span class="bound">g</span><span class="main">)</span><span class="main">)</span> <span class="free">a</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span>  set_comp_def sandwich_def compose_def<span class="main">)</span>
    <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">rule</span> extensionalityI<span class="main"><span class="keyword3">,</span></span> <span class="operator">rule</span> restrict_extensional<span class="main"><span class="keyword3">,</span></span> <span class="operator">rule</span> restrict_extensional<span class="main">)</span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> F_comp_func compose_def<span class="main">)</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(∙</span><span class="main">)</span> <span class="main">:</span> <span class="keyword1">Hom</span> <span class="free">B</span> <span class="free">C</span> <span class="main">→</span> <span class="keyword1">Hom</span> <span class="free">A</span> <span class="free">B</span> <span class="main">→</span> <span class="keyword1">Hom</span> <span class="free">A</span> <span class="free">C</span>"</span></span> <span class="keyword1"><span class="command">..</span></span>  
  <span class="keyword1"><span class="command">from</span></span> this <span class="keyword2"><span class="keyword">and</span></span> fBC 
  <span class="keyword1"><span class="command">have</span></span> opfType<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(∙</span><span class="main">)</span> <span class="free">f</span> <span class="main">:</span> <span class="keyword1">Hom</span> <span class="free">A</span> <span class="free">B</span> <span class="main">→</span> <span class="keyword1">Hom</span> <span class="free">A</span> <span class="free">C</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> funcset_mem<span class="main">)</span>
  <span class="keyword1"><span class="command">from</span></span> 1 <span class="keyword2"><span class="keyword">and</span></span> 2
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"set_func <span class="main">(</span><span class="main">(</span><span class="keyword1"><span class="free">σ(</span></span><span class="free">A</span><span class="main"><span class="free">,</span></span><span class="free">a</span><span class="main"><span class="free">)</span></span> <span class="free">C</span><span class="main">)</span> <span class="main">⊙</span> <span class="main">(</span><span class="keyword1"><span class="free">Hom(</span></span><span class="free">A</span><span class="main"><span class="free">,_)</span></span><span class="keyword1"><span class="hidden">⇘</span><sub>𝖺</sub><span class="hidden">⇙</span></span> <span class="free">f</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span>
    <span class="main">(</span><span class="main">λ</span><span class="bound">g</span><span class="main">∈</span><span class="keyword1">Hom</span> <span class="free">A</span> <span class="free">B</span><span class="main">.</span> set_func <span class="main">(</span><span class="keyword1"><span class="free">σ(</span></span><span class="free">A</span><span class="main"><span class="free">,</span></span><span class="free">a</span><span class="main"><span class="free">)</span></span> <span class="free">C</span><span class="main">)</span> <span class="main">(</span><span class="free">f</span> <span class="main">∙</span> <span class="bound">g</span><span class="main">)</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> set_comp_def homf_def<span class="main">)</span>
    <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> compose_def<span class="main">)</span>
    <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">rule</span> extensionalityI<span class="main"><span class="keyword3">,</span></span> <span class="operator">rule</span> restrict_extensional<span class="main"><span class="keyword3">,</span></span> <span class="operator">rule</span> restrict_extensional<span class="main">)</span>
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">from</span></span> COb <span class="keyword2"><span class="keyword">and</span></span> opfType 
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">" <span class="main">…</span> <span class="main">=</span> <span class="main">(</span><span class="main">λ</span><span class="bound">g</span><span class="main">∈</span><span class="keyword1">Hom</span> <span class="free">A</span> <span class="free">B</span><span class="main">.</span> set_func <span class="main">(</span><span class="free">F</span><span class="keyword1"><span class="hidden">⇘</span><sub>𝖺</sub><span class="hidden">⇙</span></span> <span class="main">(</span><span class="free">f</span> <span class="main">∙</span> <span class="bound">g</span><span class="main">)</span><span class="main">)</span> <span class="free">a</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> sandwich_def<span class="main">)</span>
    <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">rule</span> extensionalityI<span class="main"><span class="keyword3">,</span></span> <span class="operator">rule</span> restrict_extensional<span class="main"><span class="keyword3">,</span></span> <span class="operator">rule</span> restrict_extensional<span class="main">)</span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span>Pi_def<span class="main">)</span>
  <span class="keyword1"><span class="command">finally</span></span> <span class="keyword1"><span class="command">have</span></span> set_func_rhs<span class="main">:</span>
    <span class="quoted"><span class="quoted">"set_func <span class="main">(</span><span class="main">(</span><span class="keyword1"><span class="free">σ(</span></span><span class="free">A</span><span class="main"><span class="free">,</span></span><span class="free">a</span><span class="main"><span class="free">)</span></span> <span class="free">C</span><span class="main">)</span> <span class="main">⊙</span> <span class="main">(</span><span class="keyword1"><span class="free">Hom(</span></span><span class="free">A</span><span class="main"><span class="free">,_)</span></span><span class="keyword1"><span class="hidden">⇘</span><sub>𝖺</sub><span class="hidden">⇙</span></span> <span class="free">f</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span>
    <span class="main">(</span><span class="main">λ</span><span class="bound">g</span><span class="main">∈</span><span class="keyword1">Hom</span> <span class="free">A</span> <span class="free">B</span><span class="main">.</span> set_func <span class="main">(</span><span class="free">F</span><span class="keyword1"><span class="hidden">⇘</span><sub>𝖺</sub><span class="hidden">⇙</span></span> <span class="main">(</span><span class="free">f</span> <span class="main">∙</span> <span class="bound">g</span><span class="main">)</span><span class="main">)</span> <span class="free">a</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">.</span></span>
  <span class="keyword1"><span class="command">from</span></span> set_func_lhs <span class="keyword2"><span class="keyword">and</span></span> set_func_rhs <span class="keyword1"><span class="command">have</span></span>
    <span class="quoted"><span class="quoted">"set_func <span class="main">(</span><span class="main">(</span><span class="free">F</span><span class="keyword1"><span class="hidden">⇘</span><sub>𝖺</sub><span class="hidden">⇙</span></span> <span class="free">f</span><span class="main">)</span> <span class="main">⊙</span> <span class="main">(</span><span class="keyword1"><span class="free">σ(</span></span><span class="free">A</span><span class="main"><span class="free">,</span></span><span class="free">a</span><span class="main"><span class="free">)</span></span> <span class="free">B</span><span class="main">)</span><span class="main">)</span>
    <span class="main">=</span> set_func <span class="main">(</span><span class="main">(</span><span class="keyword1"><span class="free">σ(</span></span><span class="free">A</span><span class="main"><span class="free">,</span></span><span class="free">a</span><span class="main"><span class="free">)</span></span> <span class="free">C</span><span class="main">)</span> <span class="main">⊙</span> <span class="main">(</span><span class="keyword1"><span class="free">Hom(</span></span><span class="free">A</span><span class="main"><span class="free">,_)</span></span><span class="keyword1"><span class="hidden">⇘</span><sub>𝖺</sub><span class="hidden">⇙</span></span> <span class="free">f</span><span class="main">)</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">with</span></span> set_dom_eq <span class="keyword2"><span class="keyword">and</span></span> set_cod_eq <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>


<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> Yoneda<span class="main">)</span> sandwich_natural<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">A</span> <span class="main">∈</span> <span class="keyword1">Ob</span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span> <span class="main">∈</span> <span class="free">F</span><span class="keyword1"><span class="hidden">⇘</span><sub>𝗈</sub><span class="hidden">⇙</span></span> <span class="free">A</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1"><span class="free">σ(</span></span><span class="free">A</span><span class="main"><span class="free">,</span></span><span class="free">a</span><span class="main"><span class="free">)</span></span> <span class="main">:</span> <span class="keyword1"><span class="free">Hom(</span></span><span class="free">A</span><span class="main"><span class="free">,_)</span></span> <span class="main">⇒</span> <span class="free">F</span> <span class="keyword1">in</span> <span class="keyword1">Func</span><span class="main">(</span><span class="free">AA</span><span class="main">,</span><span class="free">Set</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">intro</span> natural_transformation.intro natural_transformation_axioms.intro two_cats.intro<span class="main">)</span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"category <span class="free">AA</span>"</span></span> <span class="keyword1"><span class="command">..</span></span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"category <span class="free">Set</span>"</span></span> 
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">only</span><span class="main"><span class="main">:</span></span> Set_def<span class="main">)</span><span class="main">(</span><span class="operator">rule</span> set_cat_cat<span class="main">)</span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">Functor</span> <span class="keyword1"><span class="free">Hom(</span></span><span class="free">A</span><span class="main"><span class="free">,_)</span></span> <span class="main">:</span> <span class="free">AA</span> <span class="main">⟶</span> <span class="free">Set</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> homf_into_set<span class="main">)</span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">Functor</span> <span class="free">F</span> <span class="main">:</span> <span class="free">AA</span> <span class="main">⟶</span> <span class="free">Set</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> F_into_set<span class="main">)</span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">B</span><span class="main">∈</span><span class="keyword1">Ob</span><span class="main">.</span> <span class="keyword1"><span class="free">σ(</span></span><span class="free">A</span><span class="main"><span class="free">,</span></span><span class="free">a</span><span class="main"><span class="free">)</span></span> <span class="bound">B</span> <span class="main">∈</span> hom <span class="free">Set</span> <span class="main">(</span><span class="keyword1"><span class="free">Hom(</span></span><span class="free">A</span><span class="main"><span class="free">,_)</span></span><span class="keyword1"><span class="hidden">⇘</span><sub>𝗈</sub><span class="hidden">⇙</span></span> <span class="bound">B</span><span class="main">)</span> <span class="main">(</span><span class="free">F</span><span class="keyword1"><span class="hidden">⇘</span><sub>𝗈</sub><span class="hidden">⇙</span></span> <span class="bound">B</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> homf_def <span class="quasi_keyword">intro</span><span class="main"><span class="main">:</span></span> sandwich_type<span class="main">)</span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1"><span class="free">σ(</span></span><span class="free">A</span><span class="main"><span class="free">,</span></span><span class="free">a</span><span class="main"><span class="free">)</span></span> <span class="main">:</span> <span class="keyword1">Ob</span> <span class="main">→</span> ar <span class="free">Set</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> sandwich_funcset<span class="main">)</span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1"><span class="free">σ(</span></span><span class="free">A</span><span class="main"><span class="free">,</span></span><span class="free">a</span><span class="main"><span class="free">)</span></span> <span class="main">∈</span> extensional <span class="main">(</span><span class="keyword1">Ob</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">unfolding</span></span> sandwich_def <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> restrict_extensional<span class="main">)</span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">B</span><span class="main">∈</span><span class="keyword1">Ob</span><span class="main">.</span> <span class="main">∀</span><span class="bound">C</span><span class="main">∈</span><span class="keyword1">Ob</span><span class="main">.</span> <span class="main">∀</span><span class="bound">f</span><span class="main">∈</span><span class="keyword1">Hom</span> <span class="bound">B</span> <span class="bound">C</span><span class="main">.</span>
    comp <span class="free">Set</span> <span class="main">(</span><span class="free">F</span> <span class="keyword1"><span class="hidden">⇘</span><sub>𝖺</sub><span class="hidden">⇙</span></span> <span class="bound">f</span><span class="main">)</span> <span class="main">(</span><span class="keyword1"><span class="free">σ(</span></span><span class="free">A</span><span class="main"><span class="free">,</span></span><span class="free">a</span><span class="main"><span class="free">)</span></span> <span class="bound">B</span><span class="main">)</span> <span class="main">=</span> comp <span class="free">Set</span> <span class="main">(</span><span class="keyword1"><span class="free">σ(</span></span><span class="free">A</span><span class="main"><span class="free">,</span></span><span class="free">a</span><span class="main"><span class="free">)</span></span> <span class="bound">C</span><span class="main">)</span> <span class="main">(</span><span class="keyword1"><span class="free">Hom(</span></span><span class="free">A</span><span class="main"><span class="free">,_)</span></span><span class="keyword1"><span class="hidden">⇘</span><sub>𝖺</sub><span class="hidden">⇙</span></span> <span class="bound">f</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> Set_def <span class="quasi_keyword">intro</span><span class="main"><span class="main">:</span></span> sandwich_commutes<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>


<span class="keyword1"><span class="command">subsection</span></span> <span class="quoted"><span class="plain_text">‹Sandwich Components are Bijective›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> Yoneda<span class="main">)</span> unsandwich_left_inverse<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> 1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">A</span> <span class="main">∈</span> <span class="keyword1">Ob</span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> 2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">a</span> <span class="main">∈</span> <span class="free">F</span><span class="keyword1"><span class="hidden">⇘</span><sub>𝗈</sub><span class="hidden">⇙</span></span> <span class="free">A</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1"><span class="free">σ<span class="hidden">⇧</span><sup>←</sup>(</span></span><span class="free">A</span><span class="main"><span class="free">,</span></span><span class="keyword1"><span class="free">σ(</span></span><span class="free">A</span><span class="main"><span class="free">,</span></span><span class="free">a</span><span class="main"><span class="free">)</span></span><span class="main"><span class="free">)</span></span> <span class="main">=</span> <span class="free">a</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
  <span class="keyword1"><span class="command">from</span></span> 1 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">Id</span> <span class="free">A</span> <span class="main">∈</span> <span class="keyword1">Hom</span> <span class="free">A</span> <span class="free">A</span>"</span></span> <span class="keyword1"><span class="command">..</span></span>
  <span class="keyword1"><span class="command">with</span></span> 1 
  <span class="keyword1"><span class="command">have</span></span> 3<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="keyword1"><span class="free">σ<span class="hidden">⇧</span><sup>←</sup>(</span></span><span class="free">A</span><span class="main"><span class="free">,</span></span><span class="keyword1"><span class="free">σ(</span></span><span class="free">A</span><span class="main"><span class="free">,</span></span><span class="free">a</span><span class="main"><span class="free">)</span></span><span class="main"><span class="free">)</span></span> <span class="main">=</span> set_func <span class="main">(</span><span class="free">F</span><span class="keyword1"><span class="hidden">⇘</span><sub>𝖺</sub><span class="hidden">⇙</span></span> <span class="main">(</span><span class="keyword1">Id</span> <span class="free">A</span><span class="main">)</span><span class="main">)</span> <span class="free">a</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> sandwich_def homf_def unsandwich_def<span class="main">)</span>
  <span class="keyword1"><span class="command">from</span></span> F_preserves_id <span class="keyword2"><span class="keyword">and</span></span> 1
  <span class="keyword1"><span class="command">have</span></span> 4<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">F</span><span class="keyword1"><span class="hidden">⇘</span><sub>𝖺</sub><span class="hidden">⇙</span></span> <span class="main">(</span><span class="keyword1">Id</span> <span class="free">A</span><span class="main">)</span> <span class="main">=</span> id <span class="free">Set</span> <span class="main">(</span><span class="free">F</span><span class="keyword1"><span class="hidden">⇘</span><sub>𝗈</sub><span class="hidden">⇙</span></span> <span class="free">A</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> preserves_id_def BB_Set<span class="main">)</span>
  <span class="keyword1"><span class="command">from</span></span> F_preserves_objects <span class="keyword2"><span class="keyword">and</span></span> 1 
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">F</span><span class="keyword1"><span class="hidden">⇘</span><sub>𝗈</sub><span class="hidden">⇙</span></span> <span class="free">A</span> <span class="main">∈</span> <span class="keyword1">Ob</span><span class="main"><span class="hidden">⇘</span><sub></sub></span><span class="free">BB</span><span class="main"><span class="hidden">⇙</span></span>"</span></span> 
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> funcset_mem<span class="main">)</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="free">F</span><span class="keyword1"><span class="hidden">⇘</span><sub>𝗈</sub><span class="hidden">⇙</span></span> <span class="free">A</span> <span class="main">⊆</span> <span class="free">U</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> BB_Set Set_def set_cat_def<span class="main">)</span>
  <span class="keyword1"><span class="command">with</span></span> 2
  <span class="keyword1"><span class="command">have</span></span> 5<span class="main">:</span> <span class="quoted"><span class="quoted">"set_func <span class="main">(</span>id <span class="free">Set</span> <span class="main">(</span><span class="free">F</span><span class="keyword1"><span class="hidden">⇘</span><sub>𝗈</sub><span class="hidden">⇙</span></span> <span class="free">A</span><span class="main">)</span><span class="main">)</span> <span class="free">a</span> <span class="main">=</span> <span class="free">a</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> Set_def  set_id_def<span class="main">)</span>
  <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> 3 4 5<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>


<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> Yoneda<span class="main">)</span> unsandwich_right_inverse<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> 1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">A</span> <span class="main">∈</span> <span class="keyword1">Ob</span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> 2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">u</span> <span class="main">:</span> <span class="keyword1"><span class="free">Hom(</span></span><span class="free">A</span><span class="main"><span class="free">,_)</span></span> <span class="main">⇒</span> <span class="free">F</span> <span class="keyword1">in</span> <span class="keyword1">Func</span><span class="main">(</span><span class="free">AA</span><span class="main">,</span><span class="free">Set</span><span class="main">)</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1"><span class="free">σ(</span></span><span class="free">A</span><span class="main"><span class="free">,</span></span><span class="keyword1"><span class="free">σ<span class="hidden">⇧</span><sup>←</sup>(</span></span><span class="free">A</span><span class="main"><span class="free">,</span></span><span class="free">u</span><span class="main"><span class="free">)</span></span><span class="main"><span class="free">)</span></span> <span class="main">=</span> <span class="free">u</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">rule</span> extensionalityI<span class="main">)</span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1"><span class="free">σ(</span></span><span class="free">A</span><span class="main"><span class="free">,</span></span><span class="keyword1"><span class="free">σ<span class="hidden">⇧</span><sup>←</sup>(</span></span><span class="free">A</span><span class="main"><span class="free">,</span></span><span class="free">u</span><span class="main"><span class="free">)</span></span><span class="main"><span class="free">)</span></span> <span class="main">∈</span> extensional <span class="main">(</span><span class="keyword1">Ob</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">unfold</span> sandwich_def<span class="main"><span class="keyword3">,</span></span> <span class="operator">rule</span> restrict_extensional<span class="main">)</span>
  <span class="keyword1"><span class="command">from</span></span> 2 <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="free">u</span> <span class="main">∈</span>  extensional <span class="main">(</span><span class="keyword1">Ob</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> natural_transformation_def natural_transformation_axioms_def<span class="main">)</span>
  <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">B</span>
  <span class="keyword3"><span class="command">assume</span></span> 3<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">B</span> <span class="main">∈</span> <span class="keyword1">Ob</span>"</span></span>
  <span class="keyword1"><span class="command">with</span></span> 1
  <span class="keyword1"><span class="command">have</span></span> one<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="keyword1"><span class="free">σ(</span></span><span class="free">A</span><span class="main"><span class="free">,</span></span><span class="keyword1"><span class="free">σ<span class="hidden">⇧</span><sup>←</sup>(</span></span><span class="free">A</span><span class="main"><span class="free">,</span></span><span class="free">u</span><span class="main"><span class="free">)</span></span><span class="main"><span class="free">)</span></span> <span class="skolem">B</span> <span class="main">=</span> <span class="main">⦇</span>
    set_dom <span class="main">=</span> <span class="keyword1">Hom</span> <span class="free">A</span> <span class="skolem">B</span><span class="main">,</span>
    set_func <span class="main">=</span> <span class="main">(</span><span class="main">λ</span><span class="bound">f</span><span class="main">∈</span><span class="keyword1">Hom</span> <span class="free">A</span> <span class="skolem">B</span><span class="main">.</span> <span class="main">(</span>set_func <span class="main">(</span><span class="free">F</span><span class="keyword1"><span class="hidden">⇘</span><sub>𝖺</sub><span class="hidden">⇙</span></span> <span class="bound">f</span><span class="main">)</span><span class="main">)</span> <span class="main">(</span>set_func <span class="main">(</span><span class="free">u</span> <span class="free">A</span><span class="main">)</span> <span class="main">(</span><span class="keyword1">Id</span> <span class="free">A</span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">,</span>
    set_cod <span class="main">=</span> <span class="free">F</span><span class="keyword1"><span class="hidden">⇘</span><sub>𝗈</sub><span class="hidden">⇙</span></span> <span class="skolem">B</span> <span class="main">⦈</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> sandwich_def unsandwich_def<span class="main">)</span>
  <span class="keyword1"><span class="command">from</span></span> 1 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1"><span class="free">Hom(</span></span><span class="free">A</span><span class="main"><span class="free">,_)</span></span><span class="keyword1"><span class="hidden">⇘</span><sub>𝗈</sub><span class="hidden">⇙</span></span> <span class="free">A</span> <span class="main">=</span> <span class="keyword1">Hom</span> <span class="free">A</span> <span class="free">A</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> homf_def<span class="main">)</span>
  <span class="keyword1"><span class="command">with</span></span> 1 <span class="keyword2"><span class="keyword">and</span></span> 2 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">u</span> <span class="free">A</span><span class="main">)</span> <span class="main">∈</span> hom <span class="free">Set</span> <span class="main">(</span><span class="keyword1">Hom</span> <span class="free">A</span> <span class="free">A</span><span class="main">)</span> <span class="main">(</span><span class="free">F</span><span class="keyword1"><span class="hidden">⇘</span><sub>𝗈</sub><span class="hidden">⇙</span></span> <span class="free">A</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> natural_transformation_def natural_transformation_axioms_def<span class="main"><span class="keyword3">,</span></span>
      <span class="operator">auto</span><span class="main">)</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"set_dom <span class="main">(</span><span class="free">u</span> <span class="free">A</span><span class="main">)</span> <span class="main">=</span> <span class="keyword1">Hom</span> <span class="free">A</span> <span class="free">A</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> hom_def Set_def<span class="main">)</span>
  <span class="keyword1"><span class="command">with</span></span> 1 <span class="keyword1"><span class="command">have</span></span> applicable<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="keyword1">Id</span> <span class="free">A</span> <span class="main">∈</span> set_dom <span class="main">(</span><span class="free">u</span> <span class="free">A</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span><span class="main">)</span><span class="main">(</span><span class="operator">rule</span><span class="main">)</span>
  <span class="keyword1"><span class="command">have</span></span> two<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">λ</span><span class="bound">f</span><span class="main">∈</span><span class="keyword1">Hom</span> <span class="free">A</span> <span class="skolem">B</span><span class="main">.</span> <span class="main">(</span>set_func <span class="main">(</span><span class="free">F</span><span class="keyword1"><span class="hidden">⇘</span><sub>𝖺</sub><span class="hidden">⇙</span></span> <span class="bound">f</span><span class="main">)</span><span class="main">)</span> <span class="main">(</span>set_func <span class="main">(</span><span class="free">u</span> <span class="free">A</span><span class="main">)</span> <span class="main">(</span><span class="keyword1">Id</span> <span class="free">A</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> 
    <span class="main">=</span> <span class="main">(</span><span class="main">λ</span><span class="bound">f</span><span class="main">∈</span><span class="keyword1">Hom</span> <span class="free">A</span> <span class="skolem">B</span><span class="main">.</span> <span class="main">(</span>set_func <span class="main">(</span><span class="main">(</span><span class="free">F</span><span class="keyword1"><span class="hidden">⇘</span><sub>𝖺</sub><span class="hidden">⇙</span></span> <span class="bound">f</span><span class="main">)</span> <span class="main">⊙</span> <span class="main">(</span><span class="free">u</span> <span class="free">A</span><span class="main">)</span><span class="main">)</span> <span class="main">(</span><span class="keyword1">Id</span> <span class="free">A</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span> 
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> extensionalityI<span class="main"><span class="keyword3">,</span></span>
      <span class="operator">rule</span> restrict_extensional<span class="main"><span class="keyword3">,</span></span> <span class="operator">rule</span> restrict_extensional<span class="main"><span class="keyword3">,</span></span>
      <span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> set_comp_def compose_def applicable<span class="main">)</span>
  <span class="keyword1"><span class="command">from</span></span> 2
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">∀</span><span class="bound">X</span><span class="main">∈</span><span class="keyword1">Ob</span><span class="main">.</span> <span class="main">∀</span><span class="bound">Y</span><span class="main">∈</span><span class="keyword1">Ob</span><span class="main">.</span> <span class="main">∀</span><span class="bound">f</span><span class="main">∈</span><span class="keyword1">Hom</span> <span class="bound">X</span> <span class="bound">Y</span><span class="main">.</span> <span class="main">(</span><span class="free">F</span><span class="keyword1"><span class="hidden">⇘</span><sub>𝖺</sub><span class="hidden">⇙</span></span> <span class="bound">f</span><span class="main">)</span> <span class="main">∙</span><span class="main"><span class="hidden">⇘</span><sub></sub></span><span class="free">BB</span><span class="main"><span class="hidden">⇙</span></span> <span class="main">(</span><span class="free">u</span> <span class="bound">X</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="free">u</span> <span class="bound">Y</span><span class="main">)</span> <span class="main">∙</span><span class="main"><span class="hidden">⇘</span><sub></sub></span><span class="free">BB</span><span class="main"><span class="hidden">⇙</span></span> <span class="main">(</span><span class="keyword1"><span class="free">Hom(</span></span><span class="free">A</span><span class="main"><span class="free">,_)</span></span><span class="keyword1"><span class="hidden">⇘</span><sub>𝖺</sub><span class="hidden">⇙</span></span> <span class="bound">f</span><span class="main">)</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> natural_transformation_def natural_transformation_axioms_def BB_Set<span class="main">)</span>
  <span class="keyword1"><span class="command">with</span></span> 1 <span class="keyword2"><span class="keyword">and</span></span> 3 
  <span class="keyword1"><span class="command">have</span></span> three<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">λ</span><span class="bound">f</span><span class="main">∈</span><span class="keyword1">Hom</span> <span class="free">A</span> <span class="skolem">B</span><span class="main">.</span> <span class="main">(</span>set_func <span class="main">(</span><span class="main">(</span><span class="free">F</span><span class="keyword1"><span class="hidden">⇘</span><sub>𝖺</sub><span class="hidden">⇙</span></span> <span class="bound">f</span><span class="main">)</span> <span class="main">⊙</span> <span class="main">(</span><span class="free">u</span> <span class="free">A</span><span class="main">)</span><span class="main">)</span> <span class="main">(</span><span class="keyword1">Id</span> <span class="free">A</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> 
    <span class="main">=</span> <span class="main">(</span><span class="main">λ</span><span class="bound">f</span><span class="main">∈</span><span class="keyword1">Hom</span> <span class="free">A</span> <span class="skolem">B</span><span class="main">.</span> <span class="main">(</span>set_func <span class="main">(</span><span class="main">(</span><span class="free">u</span> <span class="skolem">B</span><span class="main">)</span> <span class="main">⊙</span> <span class="main">(</span><span class="keyword1"><span class="free">Hom(</span></span><span class="free">A</span><span class="main"><span class="free">,_)</span></span><span class="main">)</span><span class="keyword1"><span class="hidden">⇘</span><sub>𝖺</sub><span class="hidden">⇙</span></span> <span class="bound">f</span><span class="main">)</span><span class="main">)</span> <span class="main">(</span><span class="keyword1">Id</span> <span class="free">A</span><span class="main">)</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> BB_Set Set_def<span class="main">)</span>
    <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">rule</span> extensionalityI<span class="main">)</span>
    <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">rule</span> restrict_extensional<span class="main"><span class="keyword3">,</span></span> <span class="operator">rule</span> restrict_extensional<span class="main">)</span>
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">f</span> <span class="main">∈</span> <span class="keyword1">Hom</span> <span class="free">A</span> <span class="skolem">B</span><span class="main">.</span> set_dom <span class="main">(</span><span class="keyword1"><span class="free">Hom(</span></span><span class="free">A</span><span class="main"><span class="free">,_)</span></span><span class="keyword1"><span class="hidden">⇘</span><sub>𝖺</sub><span class="hidden">⇙</span></span> <span class="bound">f</span><span class="main">)</span> <span class="main">=</span> <span class="keyword1">Hom</span> <span class="free">A</span> <span class="free">A</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">intro</span> ballI<span class="main"><span class="keyword3">,</span></span> <span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> homf_def hom_def<span class="main">)</span>
  <span class="keyword1"><span class="command">have</span></span> roolz<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">⋀</span><span class="bound">f</span><span class="main">.</span> <span class="bound">f</span> <span class="main">∈</span> <span class="keyword1">Hom</span> <span class="free">A</span> <span class="skolem">B</span> <span class="main">⟹</span> set_dom <span class="main">(</span><span class="keyword1"><span class="free">Hom(</span></span><span class="free">A</span><span class="main"><span class="free">,_)</span></span><span class="keyword1"><span class="hidden">⇘</span><sub>𝖺</sub><span class="hidden">⇙</span></span> <span class="bound">f</span><span class="main">)</span> <span class="main">=</span> <span class="keyword1">Hom</span> <span class="free">A</span> <span class="free">A</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> homf_def hom_def<span class="main">)</span>
  <span class="keyword1"><span class="command">from</span></span> 1 <span class="keyword1"><span class="command">have</span></span> rooly<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="keyword1">Id</span> <span class="free">A</span> <span class="main">∈</span> <span class="keyword1">Hom</span> <span class="free">A</span> <span class="free">A</span>"</span></span> <span class="keyword1"><span class="command">..</span></span>
  <span class="keyword1"><span class="command">have</span></span> roolx<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">⋀</span><span class="bound">f</span><span class="main">.</span> <span class="bound">f</span> <span class="main">∈</span> <span class="keyword1">Hom</span> <span class="free">A</span> <span class="skolem">B</span> <span class="main">⟹</span> <span class="bound">f</span> <span class="main">∈</span> <span class="keyword1">Ar</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> hom_def<span class="main">)</span>
  <span class="keyword1"><span class="command">have</span></span> roolw<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">⋀</span><span class="bound">f</span><span class="main">.</span> <span class="bound">f</span> <span class="main">∈</span> <span class="keyword1">Hom</span> <span class="free">A</span> <span class="skolem">B</span> <span class="main">⟹</span> <span class="keyword1">Id</span> <span class="free">A</span> <span class="main">∈</span> <span class="keyword1">Hom</span> <span class="free">A</span> <span class="main">(</span><span class="keyword1">Dom</span> <span class="bound">f</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
    <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">f</span>
    <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">f</span> <span class="main">∈</span> <span class="keyword1">Hom</span> <span class="free">A</span> <span class="skolem">B</span>"</span></span>
    <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">Dom</span> <span class="skolem">f</span> <span class="main">=</span> <span class="free">A</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> hom_def<span class="main">)</span>
    <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">Id</span> <span class="free">A</span> <span class="main">∈</span> <span class="keyword1">Hom</span> <span class="free">A</span> <span class="main">(</span><span class="keyword1">Dom</span> <span class="skolem">f</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> rooly<span class="main">)</span>
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">have</span></span> annoying<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">⋀</span><span class="bound">f</span><span class="main">.</span> <span class="bound">f</span> <span class="main">∈</span> <span class="keyword1">Hom</span> <span class="free">A</span> <span class="skolem">B</span> <span class="main">⟹</span> <span class="keyword1">Id</span> <span class="free">A</span> <span class="main">=</span> <span class="keyword1">Id</span> <span class="main">(</span><span class="keyword1">Dom</span> <span class="bound">f</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> hom_def<span class="main">)</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">λ</span><span class="bound">f</span><span class="main">∈</span><span class="keyword1">Hom</span> <span class="free">A</span> <span class="skolem">B</span><span class="main">.</span> <span class="main">(</span>set_func <span class="main">(</span><span class="main">(</span><span class="free">u</span> <span class="skolem">B</span><span class="main">)</span> <span class="main">⊙</span> <span class="main">(</span><span class="keyword1"><span class="free">Hom(</span></span><span class="free">A</span><span class="main"><span class="free">,_)</span></span><span class="main">)</span><span class="keyword1"><span class="hidden">⇘</span><sub>𝖺</sub><span class="hidden">⇙</span></span> <span class="bound">f</span><span class="main">)</span><span class="main">)</span> <span class="main">(</span><span class="keyword1">Id</span> <span class="free">A</span><span class="main">)</span><span class="main">)</span>
    <span class="main">=</span> <span class="main">(</span><span class="main">λ</span><span class="bound">f</span><span class="main">∈</span><span class="keyword1">Hom</span> <span class="free">A</span> <span class="skolem">B</span><span class="main">.</span> <span class="main">(</span>compose <span class="main">(</span><span class="keyword1">Hom</span> <span class="free">A</span> <span class="free">A</span><span class="main">)</span> <span class="main">(</span>set_func <span class="main">(</span><span class="free">u</span> <span class="skolem">B</span><span class="main">)</span><span class="main">)</span> <span class="main">(</span>set_func <span class="main">(</span><span class="keyword1"><span class="free">Hom(</span></span><span class="free">A</span><span class="main"><span class="free">,_)</span></span><span class="keyword1"><span class="hidden">⇘</span><sub>𝖺</sub><span class="hidden">⇙</span></span> <span class="bound">f</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">(</span><span class="keyword1">Id</span> <span class="free">A</span><span class="main">)</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">rule</span> extensionalityI<span class="main">)</span>
    <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">rule</span> restrict_extensional<span class="main"><span class="keyword3">,</span></span> <span class="operator">rule</span> restrict_extensional<span class="main">)</span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> compose_def set_comp_def roolz rooly<span class="main">)</span>
  <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">…</span> <span class="main">=</span> <span class="main">(</span><span class="main">λ</span><span class="bound">f</span><span class="main">∈</span><span class="keyword1">Hom</span> <span class="free">A</span> <span class="skolem">B</span><span class="main">.</span> <span class="main">(</span>set_func <span class="main">(</span><span class="free">u</span> <span class="skolem">B</span><span class="main">)</span> <span class="bound">f</span><span class="main">)</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">rule</span> extensionalityI<span class="main">)</span>
    <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">rule</span> restrict_extensional<span class="main"><span class="keyword3">,</span></span> <span class="operator">rule</span> restrict_extensional<span class="main">)</span>
    <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> compose_def homf_def rooly roolx roolw<span class="main">)</span>
    <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">only</span><span class="main"><span class="main">:</span></span> annoying<span class="main">)</span>
    <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> roolx id_right<span class="main">)</span>
    <span class="keyword1"><span class="command"><span class="improper"><span class="command">done</span></span></span></span>
  <span class="keyword1"><span class="command">finally</span></span> <span class="keyword1"><span class="command">have</span></span> four<span class="main">:</span> 
    <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">λ</span><span class="bound">f</span><span class="main">∈</span><span class="keyword1">Hom</span> <span class="free">A</span> <span class="skolem">B</span><span class="main">.</span> <span class="main">(</span>set_func <span class="main">(</span><span class="main">(</span><span class="free">u</span> <span class="skolem">B</span><span class="main">)</span> <span class="main">⊙</span> <span class="main">(</span><span class="keyword1"><span class="free">Hom(</span></span><span class="free">A</span><span class="main"><span class="free">,_)</span></span><span class="main">)</span><span class="keyword1"><span class="hidden">⇘</span><sub>𝖺</sub><span class="hidden">⇙</span></span> <span class="bound">f</span><span class="main">)</span><span class="main">)</span> <span class="main">(</span><span class="keyword1">Id</span> <span class="free">A</span><span class="main">)</span><span class="main">)</span>
    <span class="main">=</span> <span class="main">(</span><span class="main">λ</span><span class="bound">f</span><span class="main">∈</span><span class="keyword1">Hom</span> <span class="free">A</span> <span class="skolem">B</span><span class="main">.</span> <span class="main">(</span>set_func <span class="main">(</span><span class="free">u</span> <span class="skolem">B</span><span class="main">)</span> <span class="bound">f</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">.</span></span>
  <span class="keyword1"><span class="command">from</span></span> 2 <span class="keyword2"><span class="keyword">and</span></span>  3 
  <span class="keyword1"><span class="command">have</span></span> uBhom<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">u</span> <span class="skolem">B</span> <span class="main">∈</span> hom <span class="free">Set</span> <span class="main">(</span><span class="keyword1"><span class="free">Hom(</span></span><span class="free">A</span><span class="main"><span class="free">,_)</span></span><span class="keyword1"><span class="hidden">⇘</span><sub>𝗈</sub><span class="hidden">⇙</span></span> <span class="skolem">B</span><span class="main">)</span> <span class="main">(</span><span class="free">F</span><span class="keyword1"><span class="hidden">⇘</span><sub>𝗈</sub><span class="hidden">⇙</span></span> <span class="skolem">B</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> natural_transformation_def natural_transformation_axioms_def<span class="main">)</span>
  <span class="keyword1"><span class="command">with</span></span> 3 
  <span class="keyword1"><span class="command">have</span></span> five<span class="main">:</span> <span class="quoted"><span class="quoted">"set_dom <span class="main">(</span><span class="free">u</span> <span class="skolem">B</span><span class="main">)</span> <span class="main">=</span> <span class="keyword1">Hom</span> <span class="free">A</span> <span class="skolem">B</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> hom_def homf_def Set_def set_cat_def<span class="main">)</span>
  <span class="keyword1"><span class="command">from</span></span> uBhom
  <span class="keyword1"><span class="command">have</span></span> six<span class="main">:</span> <span class="quoted"><span class="quoted">"set_cod <span class="main">(</span><span class="free">u</span> <span class="skolem">B</span><span class="main">)</span> <span class="main">=</span> <span class="free">F</span><span class="keyword1"><span class="hidden">⇘</span><sub>𝗈</sub><span class="hidden">⇙</span></span> <span class="skolem">B</span>"</span></span> 
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> hom_def homf_def Set_def set_cat_def<span class="main">)</span>
  <span class="keyword1"><span class="command">have</span></span> seven<span class="main">:</span> <span class="quoted"><span class="quoted">"restrict <span class="main">(</span>set_func <span class="main">(</span><span class="free">u</span> <span class="skolem">B</span><span class="main">)</span><span class="main">)</span> <span class="main">(</span><span class="keyword1">Hom</span> <span class="free">A</span> <span class="skolem">B</span><span class="main">)</span> <span class="main">=</span> set_func <span class="main">(</span><span class="free">u</span> <span class="skolem">B</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">rule</span> extensionalityI<span class="main">)</span>
    <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">rule</span> restrict_extensional<span class="main">)</span>
  <span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
    <span class="keyword1"><span class="command">from</span></span> uBhom <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">u</span> <span class="skolem">B</span> <span class="main">∈</span> ar <span class="free">Set</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> hom_def<span class="main">)</span>
    <span class="keyword1"><span class="command">hence</span></span> almost<span class="main">:</span> <span class="quoted"><span class="quoted">"set_func <span class="main">(</span><span class="free">u</span> <span class="skolem">B</span><span class="main">)</span> <span class="main">∈</span> extensional <span class="main">(</span>set_dom <span class="main">(</span><span class="free">u</span> <span class="skolem">B</span><span class="main">)</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> Set_def set_cat_def set_arrow_def<span class="main">)</span>
    <span class="keyword1"><span class="command">from</span></span> almost <span class="keyword2"><span class="keyword">and</span></span> five
    <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"set_func <span class="main">(</span><span class="free">u</span> <span class="skolem">B</span><span class="main">)</span> <span class="main">∈</span> extensional <span class="main">(</span><span class="keyword1">Hom</span> <span class="free">A</span> <span class="skolem">B</span><span class="main">)</span>"</span></span> 
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">f</span>
    <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">f</span> <span class="main">∈</span> <span class="keyword1">Hom</span> <span class="free">A</span> <span class="skolem">B</span>"</span></span>
    <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"restrict <span class="main">(</span>set_func <span class="main">(</span><span class="free">u</span> <span class="skolem">B</span><span class="main">)</span><span class="main">)</span> <span class="main">(</span><span class="keyword1">Hom</span> <span class="free">A</span> <span class="skolem">B</span><span class="main">)</span> <span class="skolem">f</span> <span class="main">=</span> set_func <span class="main">(</span><span class="free">u</span> <span class="skolem">B</span><span class="main">)</span> <span class="skolem">f</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">from</span></span> one <span class="keyword2"><span class="keyword">and</span></span> two <span class="keyword2"><span class="keyword">and</span></span> three <span class="keyword2"><span class="keyword">and</span></span> four <span class="keyword2"><span class="keyword">and</span></span> five <span class="keyword2"><span class="keyword">and</span></span> six <span class="keyword2"><span class="keyword">and</span></span> seven
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1"><span class="free">σ(</span></span><span class="free">A</span><span class="main"><span class="free">,</span></span><span class="keyword1"><span class="free">σ<span class="hidden">⇧</span><sup>←</sup>(</span></span><span class="free">A</span><span class="main"><span class="free">,</span></span><span class="free">u</span><span class="main"><span class="free">)</span></span><span class="main"><span class="free">)</span></span> <span class="skolem">B</span> <span class="main">=</span> <span class="free">u</span> <span class="skolem">B</span>"</span></span> 
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>


<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹In order to state the lemma, we must rectify a curious
omission from the Isabelle/HOL library. They define the idea of
injectivity on a given set, but surjectivity is only defined relative
to the entire universe of the target type.›</span></span>

<span class="keyword1"><span class="command">definition</span></span>
  <span class="entity">surj_on</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="main">[</span><span class="tfree">'a</span> <span class="main">⇒</span> <span class="tfree">'b</span><span class="main">,</span> <span class="tfree">'a</span> set<span class="main">,</span> <span class="tfree">'b</span> set<span class="main">]</span> <span class="main">⇒</span> bool"</span></span> <span class="keyword2"><span class="keyword">where</span></span>
  <span class="quoted"><span class="quoted">"<span class="free">surj_on</span> <span class="free"><span class="bound"><span class="entity">f</span></span></span> <span class="free"><span class="bound"><span class="entity">A</span></span></span> <span class="free"><span class="bound"><span class="entity">B</span></span></span> <span class="main">⟷</span> <span class="main">(</span><span class="main">∀</span><span class="bound">y</span><span class="main">∈</span><span class="free"><span class="bound"><span class="entity">B</span></span></span><span class="main">.</span> <span class="main">∃</span><span class="bound">x</span><span class="main">∈</span><span class="free"><span class="bound"><span class="entity">A</span></span></span><span class="main">.</span> <span class="free"><span class="bound"><span class="entity">f</span></span></span><span class="main">(</span><span class="bound">x</span><span class="main">)</span><span class="main">=</span><span class="bound">y</span><span class="main">)</span>"</span></span>

<span class="keyword1"><span class="command">definition</span></span>
  <span class="entity">bij_on</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="main">[</span><span class="tfree">'a</span> <span class="main">⇒</span> <span class="tfree">'b</span><span class="main">,</span> <span class="tfree">'a</span> set<span class="main">,</span> <span class="tfree">'b</span> set<span class="main">]</span> <span class="main">⇒</span> bool"</span></span> <span class="keyword2"><span class="keyword">where</span></span>
  <span class="quoted"><span class="quoted">"<span class="free">bij_on</span> <span class="free"><span class="bound"><span class="entity">f</span></span></span> <span class="free"><span class="bound"><span class="entity">A</span></span></span> <span class="free"><span class="bound"><span class="entity">B</span></span></span> <span class="main">⟷</span> inj_on <span class="free"><span class="bound"><span class="entity">f</span></span></span> <span class="free"><span class="bound"><span class="entity">A</span></span></span> <span class="main">&amp;</span> surj_on <span class="free"><span class="bound"><span class="entity">f</span></span></span> <span class="free"><span class="bound"><span class="entity">A</span></span></span> <span class="free"><span class="bound"><span class="entity">B</span></span></span>"</span></span>

<span class="keyword1"><span class="command">definition</span></span>
  <span class="entity">equinumerous</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="main">[</span><span class="tfree">'a</span> set<span class="main">,</span> <span class="tfree">'b</span> set<span class="main">]</span> <span class="main">⇒</span> bool"</span></span>  <span class="main">(</span><span class="keyword2"><span class="keyword">infix</span></span> <span class="quoted">"<span class="keyword1">≅</span>"</span> 40<span class="main">)</span> <span class="keyword2"><span class="keyword">where</span></span>
  <span class="quoted"><span class="quoted">"<span class="free">equinumerous</span> <span class="free"><span class="bound"><span class="entity">A</span></span></span> <span class="free"><span class="bound"><span class="entity">B</span></span></span> <span class="main">⟷</span> <span class="main">(</span><span class="main">∃</span><span class="bound">f</span><span class="main">.</span> bij_betw <span class="bound">f</span> <span class="free"><span class="bound"><span class="entity">A</span></span></span> <span class="free"><span class="bound"><span class="entity">B</span></span></span><span class="main">)</span>"</span></span>

<span class="keyword1"><span class="command">lemma</span></span> bij_betw_eq<span class="main">:</span>
  <span class="quoted"><span class="quoted">"bij_betw <span class="free">f</span> <span class="free">A</span> <span class="free">B</span> <span class="main">⟷</span>
    inj_on <span class="free">f</span> <span class="free">A</span> <span class="main">∧</span> <span class="main">(</span><span class="main">∀</span><span class="bound">y</span><span class="main">∈</span><span class="free">B</span><span class="main">.</span> <span class="main">∃</span><span class="bound">x</span><span class="main">∈</span><span class="free">A</span><span class="main">.</span> <span class="free">f</span><span class="main">(</span><span class="bound">x</span><span class="main">)</span><span class="main">=</span><span class="bound">y</span><span class="main">)</span> <span class="main">∧</span> <span class="main">(</span><span class="main">∀</span><span class="bound">x</span><span class="main">∈</span><span class="free">A</span><span class="main">.</span> <span class="free">f</span> <span class="bound">x</span> <span class="main">∈</span> <span class="free">B</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">unfolding</span></span> bij_betw_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">theorem</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> Yoneda<span class="main">)</span> Yoneda<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> 1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">A</span> <span class="main">∈</span> <span class="keyword1">Ob</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">F</span><span class="keyword1"><span class="hidden">⇘</span><sub>𝗈</sub><span class="hidden">⇙</span></span> <span class="free">A</span> <span class="main">≅</span> <span class="main">{</span><span class="bound">u</span><span class="main">.</span> <span class="bound">u</span> <span class="main">:</span> <span class="keyword1"><span class="free">Hom(</span></span><span class="free">A</span><span class="main"><span class="free">,_)</span></span> <span class="main">⇒</span> <span class="free">F</span> <span class="keyword1">in</span> <span class="keyword1">Func</span><span class="main">(</span><span class="free">AA</span><span class="main">,</span><span class="free">Set</span><span class="main">)</span><span class="main">}</span>"</span></span>
<span class="keyword1"><span class="command">unfolding</span></span> equinumerous_def bij_betw_eq inj_on_def
<span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">intro</span> exI conjI bexI ballI impI<span class="main">)</span>
  <span class="comment1">― ‹Sandwich is injective›</span>
  <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">x</span> <span class="keyword2"><span class="keyword">and</span></span> <span class="skolem">y</span>
  <span class="keyword3"><span class="command">assume</span></span> 2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">∈</span> <span class="free">F</span><span class="keyword1"><span class="hidden">⇘</span><sub>𝗈</sub><span class="hidden">⇙</span></span> <span class="free">A</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> 3<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">y</span> <span class="main">∈</span> <span class="free">F</span><span class="keyword1"><span class="hidden">⇘</span><sub>𝗈</sub><span class="hidden">⇙</span></span> <span class="free">A</span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> 4<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="keyword1"><span class="free">σ(</span></span><span class="free">A</span><span class="main"><span class="free">,</span></span><span class="skolem">x</span><span class="main"><span class="free">)</span></span> <span class="main">=</span> <span class="keyword1"><span class="free">σ(</span></span><span class="free">A</span><span class="main"><span class="free">,</span></span><span class="skolem">y</span><span class="main"><span class="free">)</span></span>"</span></span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1"><span class="free">σ<span class="hidden">⇧</span><sup>←</sup>(</span></span><span class="free">A</span><span class="main"><span class="free">,</span></span><span class="keyword1"><span class="free">σ(</span></span><span class="free">A</span><span class="main"><span class="free">,</span></span><span class="skolem">x</span><span class="main"><span class="free">)</span></span><span class="main"><span class="free">)</span></span> <span class="main">=</span> <span class="keyword1"><span class="free">σ<span class="hidden">⇧</span><sup>←</sup>(</span></span><span class="free">A</span><span class="main"><span class="free">,</span></span><span class="keyword1"><span class="free">σ(</span></span><span class="free">A</span><span class="main"><span class="free">,</span></span><span class="skolem">y</span><span class="main"><span class="free">)</span></span><span class="main"><span class="free">)</span></span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">with</span></span> unsandwich_left_inverse
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">=</span> <span class="skolem">y</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> 1 2 3<span class="main">)</span>
<span class="keyword1"><span class="command">next</span></span>
  <span class="comment1">― ‹Sandwich covers F A›</span>
  <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">u</span>
  <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">u</span> <span class="main">∈</span> <span class="main">{</span><span class="bound">y</span><span class="main">.</span> <span class="bound">y</span> <span class="main">:</span> <span class="keyword1"><span class="free">Hom(</span></span><span class="free">A</span><span class="main"><span class="free">,_)</span></span> <span class="main">⇒</span> <span class="free">F</span> <span class="keyword1">in</span> <span class="keyword1">Func</span> <span class="main">(</span><span class="free">AA</span><span class="main">,</span><span class="free">Set</span><span class="main">)</span><span class="main">}</span>"</span></span>
  <span class="keyword1"><span class="command">hence</span></span> 2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">u</span> <span class="main">:</span> <span class="keyword1"><span class="free">Hom(</span></span><span class="free">A</span><span class="main"><span class="free">,_)</span></span> <span class="main">⇒</span> <span class="free">F</span> <span class="keyword1">in</span> <span class="keyword1">Func</span> <span class="main">(</span><span class="free">AA</span><span class="main">,</span><span class="free">Set</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">with</span></span> 1 <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1"><span class="free">σ(</span></span><span class="free">A</span><span class="main"><span class="free">,</span></span><span class="keyword1"><span class="free">σ<span class="hidden">⇧</span><sup>←</sup>(</span></span><span class="free">A</span><span class="main"><span class="free">,</span></span><span class="skolem">u</span><span class="main"><span class="free">)</span></span><span class="main"><span class="free">)</span></span> <span class="main">=</span> <span class="skolem">u</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> unsandwich_right_inverse<span class="main">)</span>
  <span class="comment1">― ‹Sandwich is into F A›</span> <span class="comment1">(* there is really similar reasoning elsewhere*)</span>
  <span class="keyword1"><span class="command">from</span></span> 1 <span class="keyword2"><span class="keyword">and</span></span> 2 
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">u</span> <span class="free">A</span> <span class="main">∈</span> hom <span class="free">Set</span> <span class="main">(</span><span class="keyword1">Hom</span> <span class="free">A</span> <span class="free">A</span><span class="main">)</span> <span class="main">(</span><span class="free">F</span><span class="keyword1"><span class="hidden">⇘</span><sub>𝗈</sub><span class="hidden">⇙</span></span> <span class="free">A</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> natural_transformation_def natural_transformation_axioms_def homf_def<span class="main">)</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">u</span> <span class="free">A</span> <span class="main">∈</span> ar <span class="free">Set</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"dom <span class="free">Set</span> <span class="main">(</span><span class="skolem">u</span> <span class="free">A</span><span class="main">)</span> <span class="main">=</span> <span class="keyword1">Hom</span> <span class="free">A</span> <span class="free">A</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"cod <span class="free">Set</span> <span class="main">(</span><span class="skolem">u</span> <span class="free">A</span><span class="main">)</span> <span class="main">=</span> <span class="free">F</span><span class="keyword1"><span class="hidden">⇘</span><sub>𝗈</sub><span class="hidden">⇙</span></span> <span class="free">A</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp_all</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> hom_def<span class="main">)</span>
  <span class="keyword1"><span class="command">hence</span></span> uAfuncset<span class="main">:</span> <span class="quoted"><span class="quoted">"set_func <span class="main">(</span><span class="skolem">u</span> <span class="free">A</span><span class="main">)</span> <span class="main">:</span> <span class="main">(</span><span class="keyword1">Hom</span> <span class="free">A</span> <span class="free">A</span><span class="main">)</span> <span class="main">→</span> <span class="main">(</span><span class="free">F</span><span class="keyword1"><span class="hidden">⇘</span><sub>𝗈</sub><span class="hidden">⇙</span></span> <span class="free">A</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> Set_def set_cat_def set_arrow_def<span class="main">)</span>
  <span class="keyword1"><span class="command">from</span></span> 1 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">Id</span> <span class="free">A</span> <span class="main">∈</span> <span class="keyword1">Hom</span> <span class="free">A</span> <span class="free">A</span>"</span></span> <span class="keyword1"><span class="command">..</span></span>
  <span class="keyword1"><span class="command">with</span></span> uAfuncset 
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1"><span class="free">σ<span class="hidden">⇧</span><sup>←</sup>(</span></span><span class="free">A</span><span class="main"><span class="free">,</span></span><span class="skolem">u</span><span class="main"><span class="free">)</span></span> <span class="main">∈</span> <span class="free">F</span><span class="keyword1"><span class="hidden">⇘</span><sub>𝗈</sub><span class="hidden">⇙</span></span> <span class="free">A</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> unsandwich_def<span class="main"><span class="keyword3">,</span></span> <span class="operator">rule</span> funcset_mem<span class="main">)</span>
<span class="keyword1"><span class="command">next</span></span>
  <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">x</span>
  <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">∈</span> <span class="free">F</span><span class="keyword1"><span class="hidden">⇘</span><sub>𝗈</sub><span class="hidden">⇙</span></span> <span class="free">A</span>"</span></span>
  <span class="keyword1"><span class="command">with</span></span> 1 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1"><span class="free">σ(</span></span><span class="free">A</span><span class="main"><span class="free">,</span></span><span class="skolem">x</span><span class="main"><span class="free">)</span></span> <span class="main">:</span> <span class="keyword1"><span class="free">Hom(</span></span><span class="free">A</span><span class="main"><span class="free">,_)</span></span> <span class="main">⇒</span> <span class="free">F</span> <span class="keyword1">in</span> <span class="keyword1">Func</span> <span class="main">(</span><span class="free">AA</span><span class="main">,</span><span class="free">Set</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> sandwich_natural<span class="main">)</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1"><span class="free">σ(</span></span><span class="free">A</span><span class="main"><span class="free">,</span></span><span class="skolem">x</span><span class="main"><span class="free">)</span></span> <span class="main">∈</span> <span class="main">{</span><span class="bound">y</span><span class="main">.</span> <span class="bound">y</span> <span class="main">:</span> <span class="keyword1"><span class="free">Hom(</span></span><span class="free">A</span><span class="main"><span class="free">,_)</span></span> <span class="main">⇒</span> <span class="free">F</span> <span class="keyword1">in</span> <span class="keyword1">Func</span> <span class="main">(</span><span class="free">AA</span><span class="main">,</span><span class="free">Set</span><span class="main">)</span><span class="main">}</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword2"><span class="keyword">end</span></span>
</pre>
</div>
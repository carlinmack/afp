<div id="Banach_Steinhaus_Missing">
<div class="head">
<h1>Theory Banach_Steinhaus_Missing</h1>
</div>
<pre class="source"><span class="comment1">(*
  File:   Banach_Steinhaus_Missing.thy
  Author: Dominique Unruh, University of Tartu
  Author: Jose Manuel Rodriguez Caballero, University of Tartu
*)</span>
<span class="keyword1"><span class="command">section</span></span> <span class="quoted"><span class="plain_text">‹Missing results for the proof of Banach-Steinhaus theorem›</span></span>

<span class="keyword1"><span class="command">theory</span></span> Banach_Steinhaus_Missing
  <span class="keyword2"><span class="keyword">imports</span></span>
    <span class="quoted">"<a href="../../HOL/HOL-Analysis/Infinite_Set_Sum.html">HOL-Analysis.Infinite_Set_Sum</a>"</span>

<span class="keyword2"><span class="keyword">begin</span></span>
<span class="keyword1"><span class="command">subsection</span></span> <span class="quoted"><span class="plain_text">‹Results missing for the proof of Banach-Steinhaus theorem›</span></span>
<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹
  The results proved here are preliminaries for the proof of Banach-Steinhaus theorem using Sokal's 
  approach, but they do not explicitly appear in Sokal's paper ~\cite{sokal2011reall}.
›</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹Notation for the norm›</span></span>
<span class="keyword1"><span class="command">bundle</span></span> notation_norm <span class="keyword2"><span class="keyword">begin</span></span>
<span class="keyword1"><span class="command">notation</span></span> norm <span class="main">(</span><span class="quoted">"<span class="keyword1">∥</span>_<span class="keyword1">∥</span>"</span><span class="main">)</span>
<span class="keyword2"><span class="keyword">end</span></span>

<span class="keyword1"><span class="command">bundle</span></span> no_notation_norm <span class="keyword2"><span class="keyword">begin</span></span>
<span class="keyword1"><span class="command">no_notation</span></span> norm <span class="main">(</span><span class="quoted">"<span class="keyword1">∥</span>_<span class="keyword1">∥</span>"</span><span class="main">)</span>
<span class="keyword2"><span class="keyword">end</span></span>

<span class="keyword1"><span class="command">unbundle</span></span> notation_norm

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹Notation for apply bilinear function›</span></span>
<span class="keyword1"><span class="command">bundle</span></span> notation_blinfun_apply <span class="keyword2"><span class="keyword">begin</span></span>
<span class="keyword1"><span class="command">notation</span></span> blinfun_apply <span class="main">(</span><span class="keyword2"><span class="keyword">infixr</span></span> <span class="quoted">"<span class="keyword1">*<span class="hidden">⇩</span><sub>v</sub></span>"</span> 70<span class="main">)</span>
<span class="keyword2"><span class="keyword">end</span></span>

<span class="keyword1"><span class="command">bundle</span></span> no_notation_blinfun_apply <span class="keyword2"><span class="keyword">begin</span></span>
<span class="keyword1"><span class="command">no_notation</span></span> blinfun_apply <span class="main">(</span><span class="keyword2"><span class="keyword">infixr</span></span> <span class="quoted">"<span class="keyword1">*<span class="hidden">⇩</span><sub>v</sub></span>"</span> 70<span class="main">)</span>
<span class="keyword2"><span class="keyword">end</span></span>

<span class="keyword1"><span class="command">unbundle</span></span> notation_blinfun_apply

<span class="keyword1"><span class="command">lemma</span></span> bdd_above_plus<span class="main">:</span>
  <span class="keyword2"><span class="keyword">fixes</span></span> <span class="free">f</span><span class="main">::</span><span class="quoted"><span class="quoted">‹<span class="tfree">'a</span> <span class="main">⇒</span> real›</span></span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">‹bdd_above <span class="main">(</span><span class="free">f</span> <span class="main">`</span> <span class="free">S</span><span class="main">)</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹bdd_above <span class="main">(</span><span class="free">g</span> <span class="main">`</span> <span class="free">S</span><span class="main">)</span>›</span></span> 
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">‹bdd_above <span class="main">(</span><span class="main">(</span><span class="main">λ</span> <span class="bound">x</span><span class="main">.</span> <span class="free">f</span> <span class="bound">x</span> <span class="main">+</span> <span class="free">g</span> <span class="bound">x</span><span class="main">)</span> <span class="main">`</span> <span class="free">S</span><span class="main">)</span>›</span></span>
  <span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹
  Explanation: If the images of two real-valued functions <span class="antiquoted"><span class="antiquoted"><span class="operator"><span class="operator"><span class="hidden">\&lt;^</span><span class="control">term</span><span class="hidden">&gt;</span></span></span><span class="quoted"><span class="quoted">‹<span class="free"><span class="free">f</span></span>›</span></span></span></span>,<span class="antiquoted"><span class="antiquoted"><span class="operator"><span class="operator"><span class="hidden">\&lt;^</span><span class="control">term</span><span class="hidden">&gt;</span></span></span><span class="quoted"><span class="quoted">‹<span class="free"><span class="free">g</span></span>›</span></span></span></span> are bounded above on a 
  set <span class="antiquoted"><span class="antiquoted"><span class="operator"><span class="operator"><span class="hidden">\&lt;^</span><span class="control">term</span><span class="hidden">&gt;</span></span></span><span class="quoted"><span class="quoted">‹<span class="free"><span class="free">S</span></span>›</span></span></span></span>, then the image of their sum is bounded on <span class="antiquoted"><span class="antiquoted"><span class="operator"><span class="operator"><span class="hidden">\&lt;^</span><span class="control">term</span><span class="hidden">&gt;</span></span></span><span class="quoted"><span class="quoted">‹<span class="free"><span class="free">S</span></span>›</span></span></span></span>.
›</span></span>
<span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
  <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">M</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">‹<span class="main">⋀</span> <span class="bound">x</span><span class="main">.</span> <span class="bound">x</span><span class="main">∈</span><span class="free">S</span> <span class="main">⟹</span> <span class="free">f</span> <span class="bound">x</span> <span class="main">≤</span> <span class="skolem">M</span>›</span></span>
    <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹bdd_above <span class="main">(</span><span class="free">f</span> <span class="main">`</span> <span class="free">S</span><span class="main">)</span>›</span></span> <span class="keyword1"><span class="command">unfolding</span></span> bdd_above_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">N</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">‹<span class="main">⋀</span> <span class="bound">x</span><span class="main">.</span> <span class="bound">x</span><span class="main">∈</span><span class="free">S</span> <span class="main">⟹</span> <span class="free">g</span> <span class="bound">x</span> <span class="main">≤</span> <span class="skolem">N</span>›</span></span>
    <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹bdd_above <span class="main">(</span><span class="free">g</span> <span class="main">`</span> <span class="free">S</span><span class="main">)</span>›</span></span> <span class="keyword1"><span class="command">unfolding</span></span> bdd_above_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹<span class="main">⋀</span> <span class="bound">x</span><span class="main">.</span> <span class="bound">x</span><span class="main">∈</span><span class="free">S</span> <span class="main">⟹</span> <span class="free">f</span> <span class="bound">x</span> <span class="main">+</span> <span class="free">g</span> <span class="bound">x</span> <span class="main">≤</span> <span class="skolem">M</span> <span class="main">+</span> <span class="skolem">N</span>›</span></span>
    <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="main">⋀</span><span class="bound">x</span><span class="main">.</span> <span class="bound">x</span> <span class="main">∈</span> <span class="free">S</span> <span class="main">⟹</span> <span class="free">f</span> <span class="bound">x</span> <span class="main">≤</span> <span class="skolem">M</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="main">⋀</span><span class="bound">x</span><span class="main">.</span> <span class="bound">x</span> <span class="main">∈</span> <span class="free">S</span> <span class="main">⟹</span> <span class="free">g</span> <span class="bound">x</span> <span class="main">≤</span> <span class="skolem">N</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">fastforce</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">unfolding</span></span> bdd_above_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹The maximum of two functions›</span></span>
<span class="keyword1"><span class="command">definition</span></span> <span class="entity">pointwise_max</span><span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="tfree">'a</span> <span class="main">⇒</span> <span class="tfree">'b</span><span class="main">::</span>ord<span class="main">)</span> <span class="main">⇒</span> <span class="main">(</span><span class="tfree">'a</span> <span class="main">⇒</span> <span class="tfree">'b</span><span class="main">)</span> <span class="main">⇒</span> <span class="main">(</span><span class="tfree">'a</span> <span class="main">⇒</span> <span class="tfree">'b</span><span class="main">)</span>"</span></span> <span class="keyword2"><span class="keyword">where</span></span>
  <span class="quoted"><span class="quoted">‹<span class="free">pointwise_max</span> <span class="free"><span class="bound"><span class="entity">f</span></span></span> <span class="free"><span class="bound"><span class="entity">g</span></span></span> <span class="main">=</span> <span class="main">(</span><span class="main">λ</span><span class="bound">x</span><span class="main">.</span> max <span class="main">(</span><span class="free"><span class="bound"><span class="entity">f</span></span></span> <span class="bound">x</span><span class="main">)</span> <span class="main">(</span><span class="free"><span class="bound"><span class="entity">g</span></span></span> <span class="bound">x</span><span class="main">)</span><span class="main">)</span>›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> max_Sup_absorb_left<span class="main">:</span>
  <span class="keyword2"><span class="keyword">fixes</span></span> <span class="free">f</span> <span class="free">g</span><span class="main">::</span><span class="quoted"><span class="quoted">‹<span class="tfree">'a</span> <span class="main">⇒</span> real›</span></span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">‹<span class="free">X</span> <span class="main">≠</span> <span class="main">{}</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹bdd_above <span class="main">(</span><span class="free">f</span> <span class="main">`</span> <span class="free">X</span><span class="main">)</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹bdd_above <span class="main">(</span><span class="free">g</span> <span class="main">`</span> <span class="free">X</span><span class="main">)</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹Sup <span class="main">(</span><span class="free">f</span> <span class="main">`</span> <span class="free">X</span><span class="main">)</span> <span class="main">≥</span> Sup <span class="main">(</span><span class="free">g</span> <span class="main">`</span> <span class="free">X</span><span class="main">)</span>›</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">‹Sup <span class="main">(</span><span class="main">(</span>pointwise_max <span class="free">f</span> <span class="free">g</span><span class="main">)</span> <span class="main">`</span> <span class="free">X</span><span class="main">)</span> <span class="main">=</span> Sup <span class="main">(</span><span class="free">f</span> <span class="main">`</span> <span class="free">X</span><span class="main">)</span>›</span></span>

  <span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹Explanation: For real-valued functions <span class="antiquoted"><span class="antiquoted"><span class="operator"><span class="operator"><span class="hidden">\&lt;^</span><span class="control">term</span><span class="hidden">&gt;</span></span></span><span class="quoted"><span class="quoted">‹<span class="free"><span class="free">f</span></span>›</span></span></span></span> and <span class="antiquoted"><span class="antiquoted"><span class="operator"><span class="operator"><span class="hidden">\&lt;^</span><span class="control">term</span><span class="hidden">&gt;</span></span></span><span class="quoted"><span class="quoted">‹<span class="free"><span class="free">g</span></span>›</span></span></span></span>, if the supremum of <span class="antiquoted"><span class="antiquoted"><span class="operator"><span class="operator"><span class="hidden">\&lt;^</span><span class="control">term</span><span class="hidden">&gt;</span></span></span><span class="quoted"><span class="quoted">‹<span class="free"><span class="free">f</span></span>›</span></span></span></span> is 
    greater-equal the supremum of <span class="antiquoted"><span class="antiquoted"><span class="operator"><span class="operator"><span class="hidden">\&lt;^</span><span class="control">term</span><span class="hidden">&gt;</span></span></span><span class="quoted"><span class="quoted">‹<span class="free"><span class="free">g</span></span>›</span></span></span></span>, then the supremum of <span class="antiquoted"><span class="antiquoted"><span class="operator"><span class="operator"><span class="hidden">\&lt;^</span><span class="control">term</span><span class="hidden">&gt;</span></span></span><span class="quoted"><span class="quoted">‹max <span class="free"><span class="free">f</span></span> <span class="free"><span class="free">g</span></span>›</span></span></span></span> equals the supremum of
    <span class="antiquoted"><span class="antiquoted"><span class="operator"><span class="operator"><span class="hidden">\&lt;^</span><span class="control">term</span><span class="hidden">&gt;</span></span></span><span class="quoted"><span class="quoted">‹<span class="free"><span class="free">f</span></span>›</span></span></span></span>. (Under some technical conditions.)›</span></span>

<span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> y_Sup<span class="main">:</span> <span class="quoted"><span class="quoted">‹<span class="skolem">y</span> <span class="main">∈</span> <span class="main">(</span><span class="main">(</span><span class="main">λ</span> <span class="bound">x</span><span class="main">.</span> max <span class="main">(</span><span class="free">f</span> <span class="bound">x</span><span class="main">)</span> <span class="main">(</span><span class="free">g</span> <span class="bound">x</span><span class="main">)</span><span class="main">)</span> <span class="main">`</span> <span class="free">X</span><span class="main">)</span> <span class="main">⟹</span> <span class="skolem">y</span> <span class="main">≤</span> Sup <span class="main">(</span><span class="free">f</span> <span class="main">`</span> <span class="free">X</span><span class="main">)</span>›</span></span> <span class="keyword2"><span class="keyword">for</span></span> <span class="skolem">y</span>
  <span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
    <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">y</span> <span class="main">∈</span> <span class="main">(</span><span class="main">(</span><span class="main">λ</span> <span class="bound">x</span><span class="main">.</span> max <span class="main">(</span><span class="free">f</span> <span class="bound">x</span><span class="main">)</span> <span class="main">(</span><span class="free">g</span> <span class="bound">x</span><span class="main">)</span><span class="main">)</span> <span class="main">`</span> <span class="free">X</span><span class="main">)</span>›</span></span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">x</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">y</span> <span class="main">=</span> max <span class="main">(</span><span class="free">f</span> <span class="skolem">x</span><span class="main">)</span> <span class="main">(</span><span class="free">g</span> <span class="skolem">x</span><span class="main">)</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">x</span> <span class="main">∈</span> <span class="free">X</span>›</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹<span class="free">f</span> <span class="skolem">x</span> <span class="main">≤</span> Sup <span class="main">(</span><span class="free">f</span> <span class="main">`</span> <span class="free">X</span><span class="main">)</span>›</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span>  <span class="quoted"><span class="quoted">‹<span class="skolem">x</span> <span class="main">∈</span> <span class="free">X</span>›</span></span> <span class="quoted"><span class="quoted">‹bdd_above <span class="main">(</span><span class="free">f</span> <span class="main">`</span> <span class="free">X</span><span class="main">)</span>›</span></span> cSUP_upper<span class="main">)</span> 
    <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span>  <span class="quoted"><span class="quoted">‹<span class="free">g</span> <span class="skolem">x</span> <span class="main">≤</span> Sup <span class="main">(</span><span class="free">g</span> <span class="main">`</span> <span class="free">X</span><span class="main">)</span>›</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span>  <span class="quoted"><span class="quoted">‹<span class="skolem">x</span> <span class="main">∈</span> <span class="free">X</span>›</span></span> <span class="quoted"><span class="quoted">‹bdd_above <span class="main">(</span><span class="free">g</span> <span class="main">`</span> <span class="free">X</span><span class="main">)</span>›</span></span> cSUP_upper<span class="main">)</span> 
    <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹max <span class="main">(</span><span class="free">f</span> <span class="skolem">x</span><span class="main">)</span> <span class="main">(</span><span class="free">g</span> <span class="skolem">x</span><span class="main">)</span> <span class="main">≤</span> Sup <span class="main">(</span><span class="free">f</span> <span class="main">`</span> <span class="free">X</span><span class="main">)</span>›</span></span>
      <span class="keyword1"><span class="command">using</span></span>  <span class="quoted"><span class="quoted">‹Sup <span class="main">(</span><span class="free">f</span> <span class="main">`</span> <span class="free">X</span><span class="main">)</span> <span class="main">≥</span> Sup <span class="main">(</span><span class="free">g</span> <span class="main">`</span> <span class="free">X</span><span class="main">)</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">y</span> <span class="main">=</span> max <span class="main">(</span><span class="free">f</span> <span class="skolem">x</span><span class="main">)</span> <span class="main">(</span><span class="free">g</span> <span class="skolem">x</span><span class="main">)</span>›</span></span><span class="main">)</span> 
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">have</span></span> y_f_X<span class="main">:</span> <span class="quoted"><span class="quoted">‹<span class="skolem">y</span> <span class="main">∈</span> <span class="free">f</span> <span class="main">`</span> <span class="free">X</span> <span class="main">⟹</span> <span class="skolem">y</span> <span class="main">≤</span> Sup <span class="main">(</span><span class="main">(</span><span class="main">λ</span> <span class="bound">x</span><span class="main">.</span> max <span class="main">(</span><span class="free">f</span> <span class="bound">x</span><span class="main">)</span> <span class="main">(</span><span class="free">g</span> <span class="bound">x</span><span class="main">)</span><span class="main">)</span> <span class="main">`</span> <span class="free">X</span><span class="main">)</span>›</span></span> <span class="keyword2"><span class="keyword">for</span></span> <span class="skolem">y</span>
  <span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
    <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">y</span> <span class="main">∈</span> <span class="free">f</span> <span class="main">`</span> <span class="free">X</span>›</span></span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">x</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">x</span> <span class="main">∈</span> <span class="free">X</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">y</span> <span class="main">=</span> <span class="free">f</span> <span class="skolem">x</span>›</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
    <span class="keyword1"><span class="command">have</span></span>  <span class="quoted"><span class="quoted">‹bdd_above <span class="main">(</span><span class="main">(</span><span class="main">λ</span> <span class="bound">ξ</span><span class="main">.</span> max <span class="main">(</span><span class="free">f</span> <span class="bound">ξ</span><span class="main">)</span> <span class="main">(</span><span class="free">g</span> <span class="bound">ξ</span><span class="main">)</span><span class="main">)</span> <span class="main">`</span> <span class="free">X</span><span class="main">)</span>›</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> <span class="main"><span class="main">(</span></span>no_types<span class="main"><span class="main">)</span></span> <span class="quoted"><span class="quoted">‹bdd_above <span class="main">(</span><span class="free">f</span> <span class="main">`</span> <span class="free">X</span><span class="main">)</span>›</span></span> <span class="quoted"><span class="quoted">‹bdd_above <span class="main">(</span><span class="free">g</span> <span class="main">`</span> <span class="free">X</span><span class="main">)</span>›</span></span> bdd_above_image_sup sup_max<span class="main">)</span>
    <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">e</span> <span class="main">&gt;</span> <span class="main">0</span> <span class="main">⟹</span> <span class="main">∃</span> <span class="bound">k</span> <span class="main">∈</span> <span class="main">(</span><span class="main">λ</span> <span class="bound">ξ</span><span class="main">.</span> max <span class="main">(</span><span class="free">f</span> <span class="bound">ξ</span><span class="main">)</span> <span class="main">(</span><span class="free">g</span> <span class="bound">ξ</span><span class="main">)</span><span class="main">)</span> <span class="main">`</span> <span class="free">X</span><span class="main">.</span> <span class="skolem">y</span> <span class="main">≤</span> <span class="bound">k</span> <span class="main">+</span> <span class="skolem">e</span>›</span></span>
      <span class="keyword2"><span class="keyword">for</span></span> <span class="skolem">e</span><span class="main">::</span><span class="quoted">real</span>
      <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹Sup <span class="main">(</span><span class="free">f</span> <span class="main">`</span> <span class="free">X</span><span class="main">)</span> <span class="main">≥</span> Sup <span class="main">(</span><span class="free">g</span> <span class="main">`</span> <span class="free">X</span><span class="main">)</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">smt</span> <span class="quoted"><span class="quoted">‹<span class="skolem">x</span> <span class="main">∈</span> <span class="free">X</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">y</span> <span class="main">=</span> <span class="free">f</span> <span class="skolem">x</span>›</span></span> image_eqI<span class="main">)</span>        
    <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
      <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">x</span> <span class="main">∈</span> <span class="free">X</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">y</span> <span class="main">=</span> <span class="free">f</span> <span class="skolem">x</span>›</span></span> cSUP_upper <span class="keyword1"><span class="command">by</span></span> <span class="operator">fastforce</span>
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹Sup <span class="main">(</span><span class="main">(</span><span class="main">λ</span> <span class="bound">x</span><span class="main">.</span> max <span class="main">(</span><span class="free">f</span> <span class="bound">x</span><span class="main">)</span> <span class="main">(</span><span class="free">g</span> <span class="bound">x</span><span class="main">)</span><span class="main">)</span> <span class="main">`</span> <span class="free">X</span><span class="main">)</span> <span class="main">≤</span> Sup <span class="main">(</span><span class="free">f</span> <span class="main">`</span> <span class="free">X</span><span class="main">)</span>›</span></span>
    <span class="keyword1"><span class="command">using</span></span> y_Sup <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> <span class="quoted"><span class="quoted">‹<span class="free">X</span> <span class="main">≠</span> <span class="main">{}</span>›</span></span> cSup_least<span class="main">)</span> 
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹Sup <span class="main">(</span><span class="main">(</span><span class="main">λ</span> <span class="bound">x</span><span class="main">.</span> max <span class="main">(</span><span class="free">f</span> <span class="bound">x</span><span class="main">)</span> <span class="main">(</span><span class="free">g</span> <span class="bound">x</span><span class="main">)</span><span class="main">)</span> <span class="main">`</span> <span class="free">X</span><span class="main">)</span> <span class="main">≥</span> Sup <span class="main">(</span><span class="free">f</span> <span class="main">`</span> <span class="free">X</span><span class="main">)</span>›</span></span>
    <span class="keyword1"><span class="command">using</span></span> y_f_X <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> <span class="main"><span class="main">(</span></span>mono_tags<span class="main"><span class="main">)</span></span> cSup_least calculation empty_is_image<span class="main">)</span>  
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">unfolding</span></span> pointwise_max_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">lemma</span></span> max_Sup_absorb_right<span class="main">:</span>
  <span class="keyword2"><span class="keyword">fixes</span></span> <span class="free">f</span> <span class="free">g</span><span class="main">::</span><span class="quoted"><span class="quoted">‹<span class="tfree">'a</span> <span class="main">⇒</span> real›</span></span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">‹<span class="free">X</span> <span class="main">≠</span> <span class="main">{}</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹bdd_above <span class="main">(</span><span class="free">f</span> <span class="main">`</span> <span class="free">X</span><span class="main">)</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹bdd_above <span class="main">(</span><span class="free">g</span> <span class="main">`</span> <span class="free">X</span><span class="main">)</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹Sup <span class="main">(</span><span class="free">f</span> <span class="main">`</span> <span class="free">X</span><span class="main">)</span> <span class="main">≤</span> Sup <span class="main">(</span><span class="free">g</span> <span class="main">`</span> <span class="free">X</span><span class="main">)</span>›</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">‹Sup <span class="main">(</span><span class="main">(</span>pointwise_max <span class="free">f</span> <span class="free">g</span><span class="main">)</span> <span class="main">`</span> <span class="free">X</span><span class="main">)</span> <span class="main">=</span> Sup <span class="main">(</span><span class="free">g</span> <span class="main">`</span> <span class="free">X</span><span class="main">)</span>›</span></span>
  <span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹
  Explanation: For real-valued functions <span class="antiquoted"><span class="antiquoted"><span class="operator"><span class="operator"><span class="hidden">\&lt;^</span><span class="control">term</span><span class="hidden">&gt;</span></span></span><span class="quoted"><span class="quoted">‹<span class="free"><span class="free">f</span></span>›</span></span></span></span> and <span class="antiquoted"><span class="antiquoted"><span class="operator"><span class="operator"><span class="hidden">\&lt;^</span><span class="control">term</span><span class="hidden">&gt;</span></span></span><span class="quoted"><span class="quoted">‹<span class="free"><span class="free">g</span></span>›</span></span></span></span> and a nonempty set <span class="antiquoted"><span class="antiquoted"><span class="operator"><span class="operator"><span class="hidden">\&lt;^</span><span class="control">term</span><span class="hidden">&gt;</span></span></span><span class="quoted"><span class="quoted">‹<span class="free"><span class="free">X</span></span>›</span></span></span></span>, such that 
  the <span class="antiquoted"><span class="antiquoted"><span class="operator"><span class="operator"><span class="hidden">\&lt;^</span><span class="control">term</span><span class="hidden">&gt;</span></span></span><span class="quoted"><span class="quoted">‹<span class="free"><span class="free">f</span></span>›</span></span></span></span> and <span class="antiquoted"><span class="antiquoted"><span class="operator"><span class="operator"><span class="hidden">\&lt;^</span><span class="control">term</span><span class="hidden">&gt;</span></span></span><span class="quoted"><span class="quoted">‹<span class="free"><span class="free">g</span></span>›</span></span></span></span> are bounded above on <span class="antiquoted"><span class="antiquoted"><span class="operator"><span class="operator"><span class="hidden">\&lt;^</span><span class="control">term</span><span class="hidden">&gt;</span></span></span><span class="quoted"><span class="quoted">‹<span class="free"><span class="free">X</span></span>›</span></span></span></span>, if the supremum of <span class="antiquoted"><span class="antiquoted"><span class="operator"><span class="operator"><span class="hidden">\&lt;^</span><span class="control">term</span><span class="hidden">&gt;</span></span></span><span class="quoted"><span class="quoted">‹<span class="free"><span class="free">f</span></span>›</span></span></span></span> on <span class="antiquoted"><span class="antiquoted"><span class="operator"><span class="operator"><span class="hidden">\&lt;^</span><span class="control">term</span><span class="hidden">&gt;</span></span></span><span class="quoted"><span class="quoted">‹<span class="free"><span class="free">X</span></span>›</span></span></span></span> is 
  lower-equal the supremum of <span class="antiquoted"><span class="antiquoted"><span class="operator"><span class="operator"><span class="hidden">\&lt;^</span><span class="control">term</span><span class="hidden">&gt;</span></span></span><span class="quoted"><span class="quoted">‹<span class="free"><span class="free">g</span></span>›</span></span></span></span> on <span class="antiquoted"><span class="antiquoted"><span class="operator"><span class="operator"><span class="hidden">\&lt;^</span><span class="control">term</span><span class="hidden">&gt;</span></span></span><span class="quoted"><span class="quoted">‹<span class="free"><span class="free">X</span></span>›</span></span></span></span>, then the supremum of <span class="antiquoted"><span class="antiquoted"><span class="operator"><span class="operator"><span class="hidden">\&lt;^</span><span class="control">term</span><span class="hidden">&gt;</span></span></span><span class="quoted"><span class="quoted">‹pointwise_max <span class="free"><span class="free">f</span></span> <span class="free"><span class="free">g</span></span>›</span></span></span></span> on <span class="antiquoted"><span class="antiquoted"><span class="operator"><span class="operator"><span class="hidden">\&lt;^</span><span class="control">term</span><span class="hidden">&gt;</span></span></span><span class="quoted"><span class="quoted">‹<span class="free"><span class="free">X</span></span>›</span></span></span></span>
  equals the supremum of <span class="antiquoted"><span class="antiquoted"><span class="operator"><span class="operator"><span class="hidden">\&lt;^</span><span class="control">term</span><span class="hidden">&gt;</span></span></span><span class="quoted"><span class="quoted">‹<span class="free"><span class="free">g</span></span>›</span></span></span></span>. This is the right analog of <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">text</span></span> <span class="raw_text"><span class="raw_text">max_Sup_absorb_left</span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span>.
›</span></span>
<span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹Sup <span class="main">(</span><span class="main">(</span>pointwise_max <span class="free">g</span> <span class="free">f</span><span class="main">)</span> <span class="main">`</span> <span class="free">X</span><span class="main">)</span> <span class="main">=</span> Sup <span class="main">(</span><span class="free">g</span> <span class="main">`</span> <span class="free">X</span><span class="main">)</span>›</span></span>
    <span class="keyword1"><span class="command">using</span></span>  assms <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> max_Sup_absorb_left<span class="main">)</span>     
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹pointwise_max <span class="free">g</span> <span class="free">f</span> <span class="main">=</span> pointwise_max <span class="free">f</span> <span class="free">g</span>›</span></span>
    <span class="keyword1"><span class="command">unfolding</span></span> pointwise_max_def  <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">lemma</span></span> max_Sup<span class="main">:</span>
  <span class="keyword2"><span class="keyword">fixes</span></span> <span class="free">f</span> <span class="free">g</span><span class="main">::</span><span class="quoted"><span class="quoted">‹<span class="tfree">'a</span> <span class="main">⇒</span> real›</span></span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">‹<span class="free">X</span> <span class="main">≠</span> <span class="main">{}</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹bdd_above <span class="main">(</span><span class="free">f</span> <span class="main">`</span> <span class="free">X</span><span class="main">)</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹bdd_above <span class="main">(</span><span class="free">g</span> <span class="main">`</span> <span class="free">X</span><span class="main">)</span>›</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">‹Sup <span class="main">(</span><span class="main">(</span>pointwise_max <span class="free">f</span> <span class="free">g</span><span class="main">)</span> <span class="main">`</span> <span class="free">X</span><span class="main">)</span> <span class="main">=</span> max <span class="main">(</span>Sup <span class="main">(</span><span class="free">f</span> <span class="main">`</span> <span class="free">X</span><span class="main">)</span><span class="main">)</span> <span class="main">(</span>Sup <span class="main">(</span><span class="free">g</span> <span class="main">`</span> <span class="free">X</span><span class="main">)</span><span class="main">)</span>›</span></span>
  <span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹
  Explanation: Let <span class="antiquoted"><span class="antiquoted"><span class="operator"><span class="operator"><span class="hidden">\&lt;^</span><span class="control">term</span><span class="hidden">&gt;</span></span></span><span class="quoted"><span class="quoted">‹<span class="free"><span class="free">X</span></span>›</span></span></span></span> be a nonempty set. Two supremum over <span class="antiquoted"><span class="antiquoted"><span class="operator"><span class="operator"><span class="hidden">\&lt;^</span><span class="control">term</span><span class="hidden">&gt;</span></span></span><span class="quoted"><span class="quoted">‹<span class="free"><span class="free">X</span></span>›</span></span></span></span> of the maximum of two 
  real-value functions is equal to the maximum of their suprema over <span class="antiquoted"><span class="antiquoted"><span class="operator"><span class="operator"><span class="hidden">\&lt;^</span><span class="control">term</span><span class="hidden">&gt;</span></span></span><span class="quoted"><span class="quoted">‹<span class="free"><span class="free">X</span></span>›</span></span></span></span>, provided that the
  functions are bounded above on <span class="antiquoted"><span class="antiquoted"><span class="operator"><span class="operator"><span class="hidden">\&lt;^</span><span class="control">term</span><span class="hidden">&gt;</span></span></span><span class="quoted"><span class="quoted">‹<span class="free"><span class="free">X</span></span>›</span></span></span></span>.
›</span></span>
<span class="keyword1"><span class="command">proof</span></span><span class="main">(</span><span class="operator">cases</span> <span class="quoted"><span class="quoted">‹Sup <span class="main">(</span><span class="free">f</span> <span class="main">`</span> <span class="free">X</span><span class="main">)</span> <span class="main">≥</span> Sup <span class="main">(</span><span class="free">g</span> <span class="main">`</span> <span class="free">X</span><span class="main">)</span>›</span></span><span class="main">)</span>
  <span class="keyword3"><span class="command">case</span></span> True <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> assms<span class="main"><span class="main">(</span></span>1<span class="main"><span class="main">)</span></span> assms<span class="main"><span class="main">(</span></span>2<span class="main"><span class="main">)</span></span> assms<span class="main"><span class="main">(</span></span>3<span class="main"><span class="main">)</span></span> max_Sup_absorb_left<span class="main">)</span>
<span class="keyword1"><span class="command">next</span></span>
  <span class="keyword3"><span class="command">case</span></span> False 
  <span class="keyword1"><span class="command">have</span></span> f1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> <span class="main">0</span> <span class="main">≤</span> Sup <span class="main">(</span><span class="free">f</span> <span class="main">`</span> <span class="free">X</span><span class="main">)</span> <span class="main">+</span> <span class="main">-</span> <span class="main">1</span> <span class="main">*</span> Sup <span class="main">(</span><span class="free">g</span> <span class="main">`</span> <span class="free">X</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> False <span class="keyword1"><span class="command">by</span></span> <span class="operator">linarith</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"Sup <span class="main">(</span>Banach_Steinhaus_Missing.pointwise_max <span class="free">f</span> <span class="free">g</span> <span class="main">`</span> <span class="free">X</span><span class="main">)</span> <span class="main">=</span> Sup <span class="main">(</span><span class="free">g</span> <span class="main">`</span> <span class="free">X</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> assms<span class="main"><span class="main">(</span></span>1<span class="main"><span class="main">)</span></span> assms<span class="main"><span class="main">(</span></span>2<span class="main"><span class="main">)</span></span> assms<span class="main"><span class="main">(</span></span>3<span class="main"><span class="main">)</span></span> max_Sup_absorb_right<span class="main">)</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
    <span class="keyword1"><span class="command">using</span></span> f1 <span class="keyword1"><span class="command">by</span></span> <span class="operator">linarith</span>
<span class="keyword1"><span class="command">qed</span></span>


<span class="keyword1"><span class="command">lemma</span></span> identity_telescopic<span class="main">:</span>
  <span class="keyword2"><span class="keyword">fixes</span></span> <span class="free">x</span> <span class="main">::</span> <span class="quoted"><span class="quoted">‹<span class="main">_</span> <span class="main">⇒</span> <span class="tfree">'a</span><span class="main">::</span>real_normed_vector›</span></span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">‹<span class="free">x</span> <span class="main">⇢</span> <span class="free">l</span>›</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">‹<span class="main">(</span><span class="main">λ</span> <span class="bound">N</span><span class="main">.</span> sum <span class="main">(</span><span class="main">λ</span> <span class="bound">k</span><span class="main">.</span> <span class="free">x</span> <span class="main">(</span>Suc <span class="bound">k</span><span class="main">)</span> <span class="main">-</span> <span class="free">x</span> <span class="bound">k</span><span class="main">)</span> <span class="main">{</span><span class="free">n</span><span class="main">..</span><span class="bound">N</span><span class="main">}</span><span class="main">)</span> <span class="main">⇢</span> <span class="free">l</span> <span class="main">-</span> <span class="free">x</span> <span class="free">n</span>›</span></span>
  <span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹
  Expression of a limit as a telescopic series.
  Explanation: If <span class="antiquoted"><span class="antiquoted"><span class="operator"><span class="operator"><span class="hidden">\&lt;^</span><span class="control">term</span><span class="hidden">&gt;</span></span></span><span class="quoted"><span class="quoted">‹<span class="free"><span class="free">x</span></span>›</span></span></span></span> converges to <span class="antiquoted"><span class="antiquoted"><span class="operator"><span class="operator"><span class="hidden">\&lt;^</span><span class="control">term</span><span class="hidden">&gt;</span></span></span><span class="quoted"><span class="quoted">‹<span class="free"><span class="free">l</span></span>›</span></span></span></span> then the sum <span class="antiquoted"><span class="antiquoted"><span class="operator"><span class="operator"><span class="hidden">\&lt;^</span><span class="control">term</span><span class="hidden">&gt;</span></span></span><span class="quoted"><span class="quoted">‹sum <span class="main"><span class="main">(</span></span><span class="main"><span class="main">λ</span></span> <span class="bound"><span class="bound">k</span></span><span class="main"><span class="main">.</span></span> <span class="free"><span class="free">x</span></span> <span class="main"><span class="main">(</span></span>Suc <span class="bound"><span class="bound">k</span></span><span class="main"><span class="main">)</span></span> <span class="main"><span class="main">-</span></span> <span class="free"><span class="free">x</span></span> <span class="bound"><span class="bound">k</span></span><span class="main"><span class="main">)</span></span> <span class="main"><span class="main">{</span></span><span class="free"><span class="free">n</span></span><span class="main"><span class="main">..</span></span><span class="free"><span class="free">N</span></span><span class="main"><span class="main">}</span></span>›</span></span></span></span>
  converges to <span class="antiquoted"><span class="antiquoted"><span class="operator"><span class="operator"><span class="hidden">\&lt;^</span><span class="control">term</span><span class="hidden">&gt;</span></span></span><span class="quoted"><span class="quoted">‹<span class="free"><span class="free">l</span></span> <span class="main"><span class="main">-</span></span> <span class="free"><span class="free">x</span></span> <span class="free"><span class="free">n</span></span>›</span></span></span></span> as <span class="antiquoted"><span class="antiquoted"><span class="operator"><span class="operator"><span class="hidden">\&lt;^</span><span class="control">term</span><span class="hidden">&gt;</span></span></span><span class="quoted"><span class="quoted">‹<span class="free"><span class="free">N</span></span>›</span></span></span></span> goes to infinity.
›</span></span>
<span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹<span class="main">(</span><span class="main">λ</span> <span class="bound">p</span><span class="main">.</span> <span class="free">x</span> <span class="main">(</span><span class="bound">p</span> <span class="main">+</span> Suc <span class="free">n</span><span class="main">)</span><span class="main">)</span> <span class="main">⇢</span> <span class="free">l</span>›</span></span>
    <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="free">x</span> <span class="main">⇢</span> <span class="free">l</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> LIMSEQ_ignore_initial_segment<span class="main">)</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">‹<span class="main">(</span><span class="main">λ</span> <span class="bound">p</span><span class="main">.</span> <span class="free">x</span> <span class="main">(</span>Suc <span class="free">n</span> <span class="main">+</span> <span class="bound">p</span><span class="main">)</span><span class="main">)</span> <span class="main">⇢</span> <span class="free">l</span>›</span></span>   
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> add.commute<span class="main">)</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">‹<span class="main">(</span><span class="main">λ</span> <span class="bound">p</span><span class="main">.</span> <span class="free">x</span> <span class="main">(</span>Suc <span class="main">(</span><span class="free">n</span> <span class="main">+</span> <span class="bound">p</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">⇢</span> <span class="free">l</span>›</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span> 
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">‹<span class="main">(</span><span class="main">λ</span> <span class="bound">t</span><span class="main">.</span> <span class="main">(</span><span class="main">-</span> <span class="main">(</span><span class="free">x</span> <span class="free">n</span><span class="main">)</span><span class="main">)</span> <span class="main">+</span> <span class="main">(</span><span class="main">λ</span> <span class="bound">p</span><span class="main">.</span>  <span class="free">x</span> <span class="main">(</span>Suc <span class="main">(</span><span class="free">n</span> <span class="main">+</span> <span class="bound">p</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="bound">t</span> <span class="main">)</span> <span class="main">⇢</span> <span class="main">(</span><span class="main">-</span> <span class="main">(</span><span class="free">x</span> <span class="free">n</span><span class="main">)</span><span class="main">)</span>  <span class="main">+</span> <span class="free">l</span>›</span></span>
    <span class="keyword1"><span class="command">using</span></span> tendsto_add_const_iff <span class="keyword1"><span class="command">by</span></span> <span class="operator">metis</span> 
  <span class="keyword1"><span class="command">hence</span></span> f1<span class="main">:</span> <span class="quoted"><span class="quoted">‹<span class="main">(</span><span class="main">λ</span> <span class="bound">p</span><span class="main">.</span> <span class="free">x</span> <span class="main">(</span>Suc <span class="main">(</span><span class="free">n</span> <span class="main">+</span> <span class="bound">p</span><span class="main">)</span><span class="main">)</span> <span class="main">-</span> <span class="free">x</span> <span class="free">n</span><span class="main">)</span><span class="main">⇢</span> <span class="free">l</span> <span class="main">-</span> <span class="free">x</span> <span class="free">n</span>›</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹sum <span class="main">(</span><span class="main">λ</span> <span class="bound">k</span><span class="main">.</span> <span class="free">x</span> <span class="main">(</span>Suc <span class="bound">k</span><span class="main">)</span> <span class="main">-</span> <span class="free">x</span> <span class="bound">k</span><span class="main">)</span> <span class="main">{</span><span class="free">n</span><span class="main">..</span><span class="free">n</span><span class="main">+</span><span class="skolem">p</span><span class="main">}</span> <span class="main">=</span> <span class="free">x</span> <span class="main">(</span>Suc <span class="main">(</span><span class="free">n</span><span class="main">+</span><span class="skolem">p</span><span class="main">)</span><span class="main">)</span> <span class="main">-</span> <span class="free">x</span> <span class="free">n</span>›</span></span> <span class="keyword2"><span class="keyword">for</span></span> <span class="skolem">p</span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> sum_Suc_diff<span class="main">)</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹<span class="main">(</span><span class="main">λ</span> <span class="bound">N</span><span class="main">.</span> sum <span class="main">(</span><span class="main">λ</span> <span class="bound">k</span><span class="main">.</span> <span class="free">x</span> <span class="main">(</span>Suc <span class="bound">k</span><span class="main">)</span> <span class="main">-</span> <span class="free">x</span> <span class="bound">k</span><span class="main">)</span> <span class="main">{</span><span class="free">n</span><span class="main">..</span><span class="bound">N</span><span class="main">}</span><span class="main">)</span> <span class="main">(</span><span class="free">n</span> <span class="main">+</span> <span class="skolem">t</span><span class="main">)</span> 
               <span class="main">=</span> <span class="main">(</span><span class="main">λ</span> <span class="bound">p</span><span class="main">.</span> sum <span class="main">(</span><span class="main">λ</span> <span class="bound">k</span><span class="main">.</span> <span class="free">x</span> <span class="main">(</span>Suc <span class="bound">k</span><span class="main">)</span> <span class="main">-</span> <span class="free">x</span> <span class="bound">k</span><span class="main">)</span> <span class="main">{</span><span class="free">n</span><span class="main">..</span><span class="free">n</span><span class="main">+</span><span class="bound">p</span><span class="main">}</span><span class="main">)</span> <span class="skolem">t</span>›</span></span> <span class="keyword2"><span class="keyword">for</span></span> <span class="skolem">t</span>
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span>  <span class="quoted"><span class="quoted">‹<span class="main">(</span><span class="main">λ</span> <span class="bound">p</span><span class="main">.</span> <span class="main">(</span><span class="main">λ</span> <span class="bound">N</span><span class="main">.</span> sum <span class="main">(</span><span class="main">λ</span> <span class="bound">k</span><span class="main">.</span> <span class="free">x</span> <span class="main">(</span>Suc <span class="bound">k</span><span class="main">)</span> <span class="main">-</span> <span class="free">x</span> <span class="bound">k</span><span class="main">)</span> <span class="main">{</span><span class="free">n</span><span class="main">..</span><span class="bound">N</span><span class="main">}</span><span class="main">)</span> <span class="main">(</span><span class="free">n</span> <span class="main">+</span> <span class="bound">p</span><span class="main">)</span><span class="main">)</span> <span class="main">⇢</span> <span class="free">l</span> <span class="main">-</span> <span class="free">x</span> <span class="free">n</span>›</span></span>
    <span class="keyword1"><span class="command">using</span></span> f1 <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">‹<span class="main">(</span><span class="main">λ</span> <span class="bound">p</span><span class="main">.</span> <span class="main">(</span><span class="main">λ</span> <span class="bound">N</span><span class="main">.</span> sum <span class="main">(</span><span class="main">λ</span> <span class="bound">k</span><span class="main">.</span> <span class="free">x</span> <span class="main">(</span>Suc <span class="bound">k</span><span class="main">)</span> <span class="main">-</span> <span class="free">x</span> <span class="bound">k</span><span class="main">)</span> <span class="main">{</span><span class="free">n</span><span class="main">..</span><span class="bound">N</span><span class="main">}</span><span class="main">)</span> <span class="main">(</span><span class="bound">p</span> <span class="main">+</span> <span class="free">n</span><span class="main">)</span><span class="main">)</span> <span class="main">⇢</span> <span class="free">l</span> <span class="main">-</span> <span class="free">x</span> <span class="free">n</span>›</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> add.commute<span class="main">)</span>
  <span class="keyword1"><span class="command">hence</span></span>  <span class="quoted"><span class="quoted">‹<span class="main">(</span><span class="main">λ</span> <span class="bound">p</span><span class="main">.</span> <span class="main">(</span><span class="main">λ</span> <span class="bound">N</span><span class="main">.</span> sum <span class="main">(</span><span class="main">λ</span> <span class="bound">k</span><span class="main">.</span> <span class="free">x</span> <span class="main">(</span>Suc <span class="bound">k</span><span class="main">)</span> <span class="main">-</span> <span class="free">x</span> <span class="bound">k</span><span class="main">)</span> <span class="main">{</span><span class="free">n</span><span class="main">..</span><span class="bound">N</span><span class="main">}</span><span class="main">)</span> <span class="bound">p</span><span class="main">)</span> <span class="main">⇢</span> <span class="free">l</span> <span class="main">-</span> <span class="free">x</span> <span class="free">n</span>›</span></span>
    <span class="keyword1"><span class="command">using</span></span> Topological_Spaces.LIMSEQ_offset<span class="main">[</span><span class="keyword2"><span class="keyword"><span class="operator">where</span></span></span> f <span class="main"><span class="main">=</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">λ</span> <span class="bound">N</span><span class="main">.</span> sum <span class="main">(</span><span class="main">λ</span> <span class="bound">k</span><span class="main">.</span> <span class="free">x</span> <span class="main">(</span>Suc <span class="bound">k</span><span class="main">)</span> <span class="main">-</span> <span class="free">x</span> <span class="bound">k</span><span class="main">)</span> <span class="main">{</span><span class="free">n</span><span class="main">..</span><span class="bound">N</span><span class="main">}</span><span class="main">)</span>"</span></span> 
        <span class="keyword2"><span class="keyword"><span class="quasi_keyword">and</span></span></span> a <span class="main"><span class="main">=</span></span> <span class="quoted"><span class="quoted">"<span class="free">l</span> <span class="main">-</span> <span class="free">x</span> <span class="free">n</span>"</span></span> <span class="keyword2"><span class="keyword"><span class="quasi_keyword">and</span></span></span> k <span class="main"><span class="main">=</span></span> <span class="quoted"><span class="free">n</span></span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">hence</span></span>  <span class="quoted"><span class="quoted">‹<span class="main">(</span><span class="main">λ</span> <span class="bound">M</span><span class="main">.</span> <span class="main">(</span><span class="main">λ</span> <span class="bound">N</span><span class="main">.</span> sum <span class="main">(</span><span class="main">λ</span> <span class="bound">k</span><span class="main">.</span> <span class="free">x</span> <span class="main">(</span>Suc <span class="bound">k</span><span class="main">)</span> <span class="main">-</span> <span class="free">x</span> <span class="bound">k</span><span class="main">)</span> <span class="main">{</span><span class="free">n</span><span class="main">..</span><span class="bound">N</span><span class="main">}</span><span class="main">)</span> <span class="bound">M</span><span class="main">)</span> <span class="main">⇢</span> <span class="free">l</span> <span class="main">-</span> <span class="free">x</span> <span class="free">n</span>›</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">lemma</span></span> bound_Cauchy_to_lim<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">‹<span class="free">y</span> <span class="main">⇢</span> <span class="free">x</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹<span class="main">⋀</span><span class="bound">n</span><span class="main">.</span> <span class="main">∥</span><span class="free">y</span> <span class="main">(</span>Suc <span class="bound">n</span><span class="main">)</span> <span class="main">-</span> <span class="free">y</span> <span class="bound">n</span><span class="main">∥</span> <span class="main">≤</span> <span class="free">c</span><span class="main">^</span><span class="bound">n</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹<span class="free">y</span> <span class="main">0</span> <span class="main">=</span> <span class="main">0</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹<span class="free">c</span> <span class="main">&lt;</span> <span class="main">1</span>›</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">‹<span class="main">∥</span><span class="free">x</span> <span class="main">-</span> <span class="free">y</span> <span class="main">(</span>Suc <span class="free">n</span><span class="main">)</span><span class="main">∥</span> <span class="main">≤</span> <span class="main">(</span><span class="free">c</span> <span class="main">/</span> <span class="main">(</span><span class="main">1</span> <span class="main">-</span> <span class="free">c</span><span class="main">)</span><span class="main">)</span> <span class="main">*</span> <span class="free">c</span> <span class="main">^</span> <span class="free">n</span>›</span></span>
  <span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹
  Inequality about a sequence of approximations assuming that the sequence of differences is bounded
  by a geometric progression.
  Explanation: Let <span class="antiquoted"><span class="antiquoted"><span class="operator"><span class="operator"><span class="hidden">\&lt;^</span><span class="control">term</span><span class="hidden">&gt;</span></span></span><span class="quoted"><span class="quoted">‹<span class="free"><span class="free">y</span></span>›</span></span></span></span> be a sequence converging to <span class="antiquoted"><span class="antiquoted"><span class="operator"><span class="operator"><span class="hidden">\&lt;^</span><span class="control">term</span><span class="hidden">&gt;</span></span></span><span class="quoted"><span class="quoted">‹<span class="free"><span class="free">x</span></span>›</span></span></span></span>.
  If <span class="antiquoted"><span class="antiquoted"><span class="operator"><span class="operator"><span class="hidden">\&lt;^</span><span class="control">term</span><span class="hidden">&gt;</span></span></span><span class="quoted"><span class="quoted">‹<span class="free"><span class="free">y</span></span>›</span></span></span></span> satisfies the inequality <span class="antiquoted"><span class="raw_text"><span class="antiquoted"><span class="raw_text"><span class="operator"><span class="operator">‹</span></span>∥y (Suc n) - y n∥ ≤ c ^ n›</span></span></span></span> for some <span class="antiquoted"><span class="antiquoted"><span class="operator"><span class="operator"><span class="hidden">\&lt;^</span><span class="control">term</span><span class="hidden">&gt;</span></span></span><span class="quoted"><span class="quoted">‹<span class="free"><span class="free">c</span></span> <span class="main"><span class="main">&lt;</span></span> <span class="main"><span class="main">1</span></span>›</span></span></span></span> and 
  assuming <span class="antiquoted"><span class="antiquoted"><span class="operator"><span class="operator"><span class="hidden">\&lt;^</span><span class="control">term</span><span class="hidden">&gt;</span></span></span><span class="quoted"><span class="quoted">‹<span class="free"><span class="free">y</span></span> <span class="main"><span class="main">0</span></span> <span class="main"><span class="main">=</span></span> <span class="main"><span class="main">0</span></span>›</span></span></span></span> then the inequality <span class="antiquoted"><span class="raw_text"><span class="antiquoted"><span class="raw_text"><span class="operator"><span class="operator">‹</span></span>∥x - y (Suc n)∥ ≤ (c / (1 - c)) * c ^ n›</span></span></span></span> holds.
›</span></span>
<span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹<span class="free">c</span> <span class="main">≥</span> <span class="main">0</span>›</span></span>
    <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="main">⋀</span> <span class="bound">n</span><span class="main">.</span> <span class="main">∥</span><span class="free">y</span> <span class="main">(</span>Suc <span class="bound">n</span><span class="main">)</span> <span class="main">-</span> <span class="free">y</span> <span class="bound">n</span><span class="main">∥</span> <span class="main">≤</span> <span class="free">c</span><span class="main">^</span><span class="bound">n</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">smt</span> norm_imp_pos_and_ge power_Suc0_right<span class="main">)</span>
  <span class="keyword1"><span class="command">have</span></span> norm_1<span class="main">:</span> <span class="quoted"><span class="quoted">‹norm <span class="main">(</span><span class="main">∑</span><span class="bound">k</span> <span class="main">=</span> Suc <span class="free">n</span><span class="main">..</span><span class="skolem">N</span><span class="main">.</span> <span class="free">y</span> <span class="main">(</span>Suc <span class="bound">k</span><span class="main">)</span> <span class="main">-</span> <span class="free">y</span> <span class="bound">k</span><span class="main">)</span> <span class="main">≤</span> <span class="main">(</span><span class="free">c</span> <span class="main">^</span> Suc <span class="free">n</span><span class="main">)</span><span class="main">/</span><span class="main">(</span><span class="main">1</span> <span class="main">-</span> <span class="free">c</span><span class="main">)</span>›</span></span> <span class="keyword2"><span class="keyword">for</span></span> <span class="skolem">N</span>
  <span class="keyword1"><span class="command">proof</span></span><span class="main">(</span><span class="operator">cases</span> <span class="quoted"><span class="quoted">‹<span class="skolem">N</span> <span class="main">&lt;</span> Suc <span class="free">n</span>›</span></span><span class="main">)</span>
    <span class="keyword3"><span class="command">case</span></span> True
    <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">‹<span class="main">∥</span>sum <span class="main">(</span><span class="main">λ</span><span class="bound">k</span><span class="main">.</span> <span class="free">y</span> <span class="main">(</span>Suc <span class="bound">k</span><span class="main">)</span> <span class="main">-</span> <span class="free">y</span> <span class="bound">k</span><span class="main">)</span> <span class="main">{</span>Suc <span class="free">n</span> <span class="main">..</span> <span class="skolem">N</span><span class="main">}</span><span class="main">∥</span> <span class="main">=</span> <span class="main">0</span>›</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>  <span class="keyword1"><span class="command">using</span></span>  <span class="quoted"><span class="quoted">‹<span class="free">c</span> <span class="main">≥</span> <span class="main">0</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="free">c</span> <span class="main">&lt;</span> <span class="main">1</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>       
  <span class="keyword1"><span class="command">next</span></span>
    <span class="keyword3"><span class="command">case</span></span> False
    <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">N</span> <span class="main">≥</span> Suc <span class="free">n</span>›</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹<span class="free">c</span><span class="main">^</span><span class="main">(</span>Suc <span class="skolem">N</span><span class="main">)</span> <span class="main">≥</span> <span class="main">0</span>›</span></span>
      <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="free">c</span> <span class="main">≥</span> <span class="main">0</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹<span class="main">1</span> <span class="main">-</span> <span class="free">c</span> <span class="main">&gt;</span> <span class="main">0</span>›</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> <span class="quoted"><span class="quoted">‹<span class="free">c</span> <span class="main">&lt;</span> <span class="main">1</span>›</span></span><span class="main">)</span>
    <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">‹<span class="main">(</span><span class="main">1</span> <span class="main">-</span> <span class="free">c</span><span class="main">)</span><span class="main">/</span><span class="main">(</span><span class="main">1</span> <span class="main">-</span> <span class="free">c</span><span class="main">)</span> <span class="main">=</span> <span class="main">1</span>›</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹<span class="main">∥</span>sum <span class="main">(</span><span class="main">λ</span><span class="bound">k</span><span class="main">.</span> <span class="free">y</span> <span class="main">(</span>Suc <span class="bound">k</span><span class="main">)</span> <span class="main">-</span> <span class="free">y</span> <span class="bound">k</span><span class="main">)</span> <span class="main">{</span>Suc <span class="free">n</span> <span class="main">..</span> <span class="skolem">N</span><span class="main">}</span><span class="main">∥</span> <span class="main">≤</span> <span class="main">(</span>sum <span class="main">(</span><span class="main">λ</span><span class="bound">k</span><span class="main">.</span> <span class="main">∥</span><span class="free">y</span> <span class="main">(</span>Suc <span class="bound">k</span><span class="main">)</span> <span class="main">-</span> <span class="free">y</span> <span class="bound">k</span><span class="main">∥</span><span class="main">)</span> <span class="main">{</span>Suc <span class="free">n</span> <span class="main">..</span> <span class="skolem">N</span><span class="main">}</span><span class="main">)</span>›</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> sum_norm_le<span class="main">)</span>
    <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">‹<span class="main">∥</span>sum <span class="main">(</span><span class="main">λ</span><span class="bound">k</span><span class="main">.</span> <span class="free">y</span> <span class="main">(</span>Suc <span class="bound">k</span><span class="main">)</span> <span class="main">-</span> <span class="free">y</span> <span class="bound">k</span><span class="main">)</span> <span class="main">{</span>Suc <span class="free">n</span> <span class="main">..</span> <span class="skolem">N</span><span class="main">}</span><span class="main">∥</span> <span class="main">≤</span> <span class="main">(</span>sum <span class="main">(</span>power <span class="free">c</span><span class="main">)</span> <span class="main">{</span>Suc <span class="free">n</span> <span class="main">..</span> <span class="skolem">N</span><span class="main">}</span><span class="main">)</span>›</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> assms<span class="main"><span class="main">(</span></span>2<span class="main"><span class="main">)</span></span> sum_norm_le<span class="main">)</span>
    <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">‹<span class="main">(</span><span class="main">1</span> <span class="main">-</span> <span class="free">c</span><span class="main">)</span> <span class="main">*</span> <span class="main">∥</span>sum <span class="main">(</span><span class="main">λ</span><span class="bound">k</span><span class="main">.</span> <span class="free">y</span> <span class="main">(</span>Suc <span class="bound">k</span><span class="main">)</span> <span class="main">-</span> <span class="free">y</span> <span class="bound">k</span><span class="main">)</span> <span class="main">{</span>Suc <span class="free">n</span> <span class="main">..</span> <span class="skolem">N</span><span class="main">}</span><span class="main">∥</span>
                   <span class="main">≤</span> <span class="main">(</span><span class="main">1</span> <span class="main">-</span> <span class="free">c</span><span class="main">)</span> <span class="main">*</span> <span class="main">(</span>sum <span class="main">(</span>power <span class="free">c</span><span class="main">)</span> <span class="main">{</span>Suc <span class="free">n</span> <span class="main">..</span> <span class="skolem">N</span><span class="main">}</span><span class="main">)</span>›</span></span>
      <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="main">0</span> <span class="main">&lt;</span> <span class="main">1</span> <span class="main">-</span> <span class="free">c</span>›</span></span> mult_le_cancel_iff2 <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>      
    <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹<span class="main">…</span> <span class="main">=</span> <span class="free">c</span><span class="main">^</span><span class="main">(</span>Suc <span class="free">n</span><span class="main">)</span> <span class="main">-</span> <span class="free">c</span><span class="main">^</span><span class="main">(</span>Suc <span class="skolem">N</span><span class="main">)</span>›</span></span>
      <span class="keyword1"><span class="command">using</span></span> Set_Interval.sum_gp_multiplied <span class="quoted"><span class="quoted">‹Suc <span class="free">n</span> <span class="main">≤</span> <span class="skolem">N</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
    <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹<span class="main">…</span> <span class="main">≤</span> <span class="free">c</span><span class="main">^</span><span class="main">(</span>Suc <span class="free">n</span><span class="main">)</span>›</span></span>
      <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="free">c</span><span class="main">^</span><span class="main">(</span>Suc <span class="skolem">N</span><span class="main">)</span> <span class="main">≥</span> <span class="main">0</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">finally</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹<span class="main">(</span><span class="main">1</span> <span class="main">-</span> <span class="free">c</span><span class="main">)</span> <span class="main">*</span> <span class="main">∥</span><span class="main">∑</span><span class="bound">k</span> <span class="main">=</span> Suc <span class="free">n</span><span class="main">..</span><span class="skolem">N</span><span class="main">.</span> <span class="free">y</span> <span class="main">(</span>Suc <span class="bound">k</span><span class="main">)</span> <span class="main">-</span> <span class="free">y</span> <span class="bound">k</span><span class="main">∥</span> <span class="main">≤</span> <span class="free">c</span> <span class="main">^</span> Suc <span class="free">n</span>›</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
    <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">‹<span class="main">(</span><span class="main">(</span><span class="main">1</span> <span class="main">-</span> <span class="free">c</span><span class="main">)</span> <span class="main">*</span> <span class="main">∥</span><span class="main">∑</span><span class="bound">k</span> <span class="main">=</span> Suc <span class="free">n</span><span class="main">..</span><span class="skolem">N</span><span class="main">.</span> <span class="free">y</span> <span class="main">(</span>Suc <span class="bound">k</span><span class="main">)</span> <span class="main">-</span> <span class="free">y</span> <span class="bound">k</span><span class="main">∥</span><span class="main">)</span><span class="main">/</span><span class="main">(</span><span class="main">1</span> <span class="main">-</span> <span class="free">c</span><span class="main">)</span>
                   <span class="main">≤</span> <span class="main">(</span><span class="free">c</span> <span class="main">^</span> Suc <span class="free">n</span><span class="main">)</span><span class="main">/</span><span class="main">(</span><span class="main">1</span> <span class="main">-</span> <span class="free">c</span><span class="main">)</span>›</span></span>
      <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="main">0</span> <span class="main">&lt;</span> <span class="main">1</span> <span class="main">-</span> <span class="free">c</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">smt</span> divide_right_mono<span class="main">)</span>      
    <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">‹<span class="main">∥</span><span class="main">∑</span><span class="bound">k</span> <span class="main">=</span> Suc <span class="free">n</span><span class="main">..</span><span class="skolem">N</span><span class="main">.</span> <span class="free">y</span> <span class="main">(</span>Suc <span class="bound">k</span><span class="main">)</span> <span class="main">-</span> <span class="free">y</span> <span class="bound">k</span><span class="main">∥</span> <span class="main">≤</span> <span class="main">(</span><span class="free">c</span> <span class="main">^</span> Suc <span class="free">n</span><span class="main">)</span><span class="main">/</span><span class="main">(</span><span class="main">1</span> <span class="main">-</span> <span class="free">c</span><span class="main">)</span>›</span></span>
      <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="main">0</span> <span class="main">&lt;</span> <span class="main">1</span> <span class="main">-</span> <span class="free">c</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span> 
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹<span class="main">(</span><span class="main">λ</span> <span class="bound">N</span><span class="main">.</span> <span class="main">(</span>sum <span class="main">(</span><span class="main">λ</span><span class="bound">k</span><span class="main">.</span> <span class="free">y</span> <span class="main">(</span>Suc <span class="bound">k</span><span class="main">)</span> <span class="main">-</span> <span class="free">y</span> <span class="bound">k</span><span class="main">)</span> <span class="main">{</span>Suc <span class="free">n</span> <span class="main">..</span> <span class="bound">N</span><span class="main">}</span><span class="main">)</span><span class="main">)</span> <span class="main">⇢</span> <span class="free">x</span> <span class="main">-</span> <span class="free">y</span> <span class="main">(</span>Suc <span class="free">n</span><span class="main">)</span>›</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> <span class="main"><span class="main">(</span></span>no_types<span class="main"><span class="main">)</span></span> <span class="quoted"><span class="quoted">‹<span class="free">y</span> <span class="main">⇢</span> <span class="free">x</span>›</span></span> identity_telescopic<span class="main">)</span>     
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">‹<span class="main">(</span><span class="main">λ</span> <span class="bound">N</span><span class="main">.</span> <span class="main">∥</span>sum <span class="main">(</span><span class="main">λ</span><span class="bound">k</span><span class="main">.</span> <span class="free">y</span> <span class="main">(</span>Suc <span class="bound">k</span><span class="main">)</span> <span class="main">-</span> <span class="free">y</span> <span class="bound">k</span><span class="main">)</span> <span class="main">{</span>Suc <span class="free">n</span> <span class="main">..</span> <span class="bound">N</span><span class="main">}</span><span class="main">∥</span><span class="main">)</span> <span class="main">⇢</span> <span class="main">∥</span><span class="free">x</span> <span class="main">-</span> <span class="free">y</span> <span class="main">(</span>Suc <span class="free">n</span><span class="main">)</span><span class="main">∥</span>›</span></span>
    <span class="keyword1"><span class="command">using</span></span> tendsto_norm <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">‹<span class="main">∥</span><span class="free">x</span> <span class="main">-</span> <span class="free">y</span> <span class="main">(</span>Suc <span class="free">n</span><span class="main">)</span><span class="main">∥</span> <span class="main">≤</span> <span class="main">(</span><span class="free">c</span> <span class="main">^</span> Suc <span class="free">n</span><span class="main">)</span><span class="main">/</span><span class="main">(</span><span class="main">1</span> <span class="main">-</span> <span class="free">c</span><span class="main">)</span>›</span></span>
    <span class="keyword1"><span class="command">using</span></span> norm_1 Lim_bounded <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">hence</span></span>  <span class="quoted"><span class="quoted">‹<span class="main">∥</span><span class="free">x</span> <span class="main">-</span> <span class="free">y</span> <span class="main">(</span>Suc <span class="free">n</span><span class="main">)</span><span class="main">∥</span> <span class="main">≤</span> <span class="main">(</span><span class="free">c</span> <span class="main">^</span> Suc <span class="free">n</span><span class="main">)</span><span class="main">/</span><span class="main">(</span><span class="main">1</span> <span class="main">-</span> <span class="free">c</span><span class="main">)</span>›</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹<span class="main">(</span><span class="free">c</span> <span class="main">^</span> Suc <span class="free">n</span><span class="main">)</span><span class="main">/</span><span class="main">(</span><span class="main">1</span> <span class="main">-</span> <span class="free">c</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="free">c</span> <span class="main">/</span> <span class="main">(</span><span class="main">1</span> <span class="main">-</span> <span class="free">c</span><span class="main">)</span><span class="main">)</span> <span class="main">*</span> <span class="main">(</span><span class="free">c</span> <span class="main">^</span> <span class="free">n</span><span class="main">)</span>›</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> divide_inverse_commute<span class="main">)</span>    
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">‹<span class="main">∥</span><span class="free">x</span> <span class="main">-</span> <span class="free">y</span> <span class="main">(</span>Suc <span class="free">n</span><span class="main">)</span><span class="main">∥</span> <span class="main">≤</span> <span class="main">(</span><span class="free">c</span> <span class="main">/</span> <span class="main">(</span><span class="main">1</span> <span class="main">-</span> <span class="free">c</span><span class="main">)</span><span class="main">)</span> <span class="main">*</span> <span class="main">(</span><span class="free">c</span> <span class="main">^</span> <span class="free">n</span><span class="main">)</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">linarith</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">lemma</span></span> onorm_open_ball<span class="main">:</span>
  <span class="keyword2"><span class="keyword">includes</span></span> notation_norm
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">‹<span class="main">∥</span><span class="free">f</span><span class="main">∥</span> <span class="main">=</span> Sup <span class="main">{</span> <span class="main">∥</span><span class="free">f</span> <span class="keyword1">*<span class="hidden">⇩</span><sub>v</sub></span> <span class="bound">x</span><span class="main">∥</span> <span class="main">|</span> <span class="bound">x</span><span class="main">.</span> <span class="main">∥</span><span class="bound">x</span><span class="main">∥</span> <span class="main">&lt;</span> <span class="main">1</span> <span class="main">}</span>›</span></span>
  <span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹
  Explanation: Let <span class="antiquoted"><span class="antiquoted"><span class="operator"><span class="operator"><span class="hidden">\&lt;^</span><span class="control">term</span><span class="hidden">&gt;</span></span></span><span class="quoted"><span class="quoted">‹<span class="free"><span class="free">f</span></span>›</span></span></span></span> be a bounded linear operator. The operator norm of <span class="antiquoted"><span class="antiquoted"><span class="operator"><span class="operator"><span class="hidden">\&lt;^</span><span class="control">term</span><span class="hidden">&gt;</span></span></span><span class="quoted"><span class="quoted">‹<span class="free"><span class="free">f</span></span>›</span></span></span></span> is the
  supremum of <span class="antiquoted"><span class="antiquoted"><span class="operator"><span class="operator"><span class="hidden">\&lt;^</span><span class="control">term</span><span class="hidden">&gt;</span></span></span><span class="quoted"><span class="quoted">‹norm <span class="main"><span class="main">(</span></span><span class="free"><span class="free">f</span></span> <span class="free"><span class="free">x</span></span><span class="main"><span class="main">)</span></span>›</span></span></span></span> for <span class="antiquoted"><span class="antiquoted"><span class="operator"><span class="operator"><span class="hidden">\&lt;^</span><span class="control">term</span><span class="hidden">&gt;</span></span></span><span class="quoted"><span class="quoted">‹<span class="free"><span class="free">x</span></span>›</span></span></span></span> such that <span class="antiquoted"><span class="antiquoted"><span class="operator"><span class="operator"><span class="hidden">\&lt;^</span><span class="control">term</span><span class="hidden">&gt;</span></span></span><span class="quoted"><span class="quoted">‹norm <span class="free"><span class="free">x</span></span> <span class="main"><span class="main">&lt;</span></span> <span class="main"><span class="main">1</span></span>›</span></span></span></span>.
›</span></span>
<span class="keyword1"><span class="command">proof</span></span><span class="main">(</span><span class="operator">cases</span> <span class="quoted"><span class="quoted">‹<span class="main">(</span>UNIV<span class="main">::</span><span class="tfree">'a</span> set<span class="main">)</span> <span class="main">=</span> <span class="main">0</span>›</span></span><span class="main">)</span>
  <span class="keyword3"><span class="command">case</span></span> True
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">x</span> <span class="main">=</span> <span class="main">0</span>›</span></span> <span class="keyword2"><span class="keyword">for</span></span> <span class="skolem">x</span><span class="main">::</span><span class="tfree"><span class="quoted"><span class="tfree">'a</span></span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">‹<span class="free">f</span> <span class="keyword1">*<span class="hidden">⇩</span><sub>v</sub></span> <span class="skolem">x</span> <span class="main">=</span> <span class="main">0</span>›</span></span> <span class="keyword2"><span class="keyword">for</span></span> <span class="skolem">x</span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> <span class="main"><span class="main">(</span></span>full_types<span class="main"><span class="main">)</span></span> blinfun.zero_right<span class="main">)</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">‹<span class="main">∥</span><span class="free">f</span><span class="main">∥</span> <span class="main">=</span> <span class="main">0</span>›</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> blinfun_eqI zero_blinfun.rep_eq<span class="main">)</span>      
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹<span class="main">{</span> <span class="main">∥</span><span class="free">f</span> <span class="keyword1">*<span class="hidden">⇩</span><sub>v</sub></span> <span class="bound">x</span><span class="main">∥</span> <span class="main">|</span> <span class="bound">x</span><span class="main">.</span> <span class="main">∥</span><span class="bound">x</span><span class="main">∥</span> <span class="main">&lt;</span> <span class="main">1</span><span class="main">}</span> <span class="main">=</span> <span class="main">{</span><span class="main">0</span><span class="main">}</span>›</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">smt</span> Collect_cong <span class="quoted"><span class="quoted">‹<span class="main">⋀</span><span class="bound">x</span><span class="main">.</span> <span class="free">f</span> <span class="keyword1">*<span class="hidden">⇩</span><sub>v</sub></span> <span class="bound">x</span> <span class="main">=</span> <span class="main">0</span>›</span></span> norm_zero singleton_conv<span class="main">)</span>      
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">‹Sup <span class="main">{</span> <span class="main">∥</span><span class="free">f</span> <span class="keyword1">*<span class="hidden">⇩</span><sub>v</sub></span> <span class="bound">x</span><span class="main">∥</span> <span class="main">|</span> <span class="bound">x</span><span class="main">.</span> <span class="main">∥</span><span class="bound">x</span><span class="main">∥</span> <span class="main">&lt;</span> <span class="main">1</span><span class="main">}</span> <span class="main">=</span> <span class="main">0</span>›</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>    
  <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="main">∥</span><span class="free">f</span><span class="main">∥</span> <span class="main">=</span> <span class="main">0</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>      
<span class="keyword1"><span class="command">next</span></span>
  <span class="keyword3"><span class="command">case</span></span> False
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">‹<span class="main">(</span>UNIV<span class="main">::</span><span class="tfree">'a</span> set<span class="main">)</span> <span class="main">≠</span> <span class="main">0</span>›</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">have</span></span> nonnegative<span class="main">:</span> <span class="quoted"><span class="quoted">‹<span class="main">∥</span><span class="free">f</span> <span class="keyword1">*<span class="hidden">⇩</span><sub>v</sub></span> <span class="skolem">x</span><span class="main">∥</span> <span class="main">≥</span> <span class="main">0</span>›</span></span> <span class="keyword2"><span class="keyword">for</span></span> <span class="skolem">x</span>
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹<span class="main">∃</span> <span class="bound">x</span><span class="main">::</span><span class="tfree">'a</span><span class="main">.</span> <span class="bound">x</span> <span class="main">≠</span> <span class="main">0</span>›</span></span>
    <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹UNIV <span class="main">≠</span> <span class="main">0</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">x</span></span><span class="main">::</span><span class="tfree"><span class="quoted"><span class="tfree">'a</span></span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">x</span> <span class="main">≠</span> <span class="main">0</span>›</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">‹<span class="main">∥</span><span class="skolem">x</span><span class="main">∥</span> <span class="main">≠</span> <span class="main">0</span>›</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword3"><span class="command">define</span></span> <span class="skolem"><span class="skolem">y</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">y</span> <span class="main">=</span> <span class="skolem">x</span> <span class="keyword1">/<span class="hidden">⇩</span><sub>R</sub></span> <span class="main">∥</span><span class="skolem">x</span><span class="main">∥</span>›</span></span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹norm <span class="skolem">y</span> <span class="main">=</span> <span class="main">∥</span> <span class="skolem">x</span> <span class="keyword1">/<span class="hidden">⇩</span><sub>R</sub></span> <span class="main">∥</span><span class="skolem">x</span><span class="main">∥</span> <span class="main">∥</span>›</span></span>
    <span class="keyword1"><span class="command">unfolding</span></span> y_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹<span class="main">…</span> <span class="main">=</span> <span class="main">∥</span><span class="skolem">x</span><span class="main">∥</span> <span class="keyword1">/<span class="hidden">⇩</span><sub>R</sub></span> <span class="main">∥</span><span class="skolem">x</span><span class="main">∥</span>›</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹<span class="main">…</span> <span class="main">=</span> <span class="main">1</span>›</span></span>
    <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="main">∥</span><span class="skolem">x</span><span class="main">∥</span> <span class="main">≠</span> <span class="main">0</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">finally</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹<span class="main">∥</span><span class="skolem">y</span><span class="main">∥</span> <span class="main">=</span> <span class="main">1</span>›</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">hence</span></span> norm_1_non_empty<span class="main">:</span> <span class="quoted"><span class="quoted">‹<span class="main">{</span> <span class="main">∥</span><span class="free">f</span> <span class="keyword1">*<span class="hidden">⇩</span><sub>v</sub></span> <span class="bound">x</span><span class="main">∥</span> <span class="main">|</span> <span class="bound">x</span><span class="main">.</span> <span class="main">∥</span><span class="bound">x</span><span class="main">∥</span> <span class="main">=</span> <span class="main">1</span><span class="main">}</span> <span class="main">≠</span> <span class="main">{}</span>›</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">have</span></span> norm_1_bounded<span class="main">:</span> <span class="quoted"><span class="quoted">‹bdd_above <span class="main">{</span> <span class="main">∥</span><span class="free">f</span> <span class="keyword1">*<span class="hidden">⇩</span><sub>v</sub></span> <span class="bound">x</span><span class="main">∥</span> <span class="main">|</span> <span class="bound">x</span><span class="main">.</span> <span class="main">∥</span><span class="bound">x</span><span class="main">∥</span> <span class="main">=</span> <span class="main">1</span><span class="main">}</span>›</span></span>
    <span class="keyword1"><span class="command">unfolding</span></span> bdd_above_def <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> norm_blinfun<span class="main">)</span>
  <span class="keyword1"><span class="command">have</span></span> norm_less_1_non_empty<span class="main">:</span> <span class="quoted"><span class="quoted">‹<span class="main">{</span><span class="main">∥</span><span class="free">f</span> <span class="keyword1">*<span class="hidden">⇩</span><sub>v</sub></span> <span class="bound">x</span><span class="main">∥</span> <span class="main">|</span> <span class="bound">x</span><span class="main">.</span> <span class="main">∥</span><span class="bound">x</span><span class="main">∥</span> <span class="main">&lt;</span> <span class="main">1</span><span class="main">}</span> <span class="main">≠</span> <span class="main">{}</span>›</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> <span class="main"><span class="main">(</span></span>mono_tags<span class="main"><span class="main">,</span></span> lifting<span class="main"><span class="main">)</span></span> Collect_empty_eq_bot bot_empty_eq empty_iff norm_zero 
        zero_less_one<span class="main">)</span>   
  <span class="keyword1"><span class="command">have</span></span> norm_less_1_bounded<span class="main">:</span> <span class="quoted"><span class="quoted">‹bdd_above <span class="main">{</span><span class="main">∥</span><span class="free">f</span> <span class="keyword1">*<span class="hidden">⇩</span><sub>v</sub></span> <span class="bound">x</span><span class="main">∥</span> <span class="main">|</span> <span class="bound">x</span><span class="main">.</span> <span class="main">∥</span><span class="bound">x</span><span class="main">∥</span> <span class="main">&lt;</span> <span class="main">1</span><span class="main">}</span>›</span></span>
  <span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹<span class="main">∃</span><span class="bound">r</span><span class="main">.</span> <span class="main">∥</span><span class="skolem">a</span> <span class="bound">r</span><span class="main">∥</span> <span class="main">&lt;</span> <span class="main">1</span> <span class="main">⟶</span> <span class="main">∥</span><span class="free">f</span> <span class="keyword1">*<span class="hidden">⇩</span><sub>v</sub></span> <span class="main">(</span><span class="skolem">a</span> <span class="bound">r</span><span class="main">)</span><span class="main">∥</span> <span class="main">≤</span> <span class="bound">r</span>›</span></span> <span class="keyword2"><span class="keyword">for</span></span> <span class="skolem">a</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"real <span class="main">⇒</span> <span class="tfree">'a</span>"</span></span>
    <span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
      <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">r</span></span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="tfree">'a</span> <span class="keyword1">⇒<span class="hidden">⇩</span><sub>L</sub></span> <span class="tfree">'b</span><span class="main">)</span> <span class="main">⇒</span> real"</span></span> <span class="keyword2"><span class="keyword">where</span></span>
        <span class="quoted"><span class="quoted">"<span class="main">⋀</span><span class="bound">f</span> <span class="bound">x</span><span class="main">.</span> <span class="main">0</span> <span class="main">≤</span> <span class="skolem">r</span> <span class="bound">f</span> <span class="main">∧</span> <span class="main">(</span>bounded_linear <span class="bound">f</span> <span class="main">⟶</span> <span class="main">∥</span><span class="bound">f</span> <span class="keyword1">*<span class="hidden">⇩</span><sub>v</sub></span> <span class="bound">x</span><span class="main">∥</span> <span class="main">≤</span> <span class="main">∥</span><span class="bound">x</span><span class="main">∥</span> <span class="main">*</span> <span class="skolem">r</span> <span class="bound">f</span><span class="main">)</span>"</span></span>
        <span class="keyword1"><span class="command">using</span></span> bounded_linear.nonneg_bounded <span class="keyword1"><span class="command">by</span></span> <span class="operator">moura</span>
      <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹<span class="main">¬</span> <span class="main">∥</span><span class="free">f</span><span class="main">∥</span> <span class="main">&lt;</span> <span class="main">0</span>›</span></span>
        <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>          
      <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">∃</span><span class="bound">r</span><span class="main">.</span> <span class="main">∥</span><span class="free">f</span><span class="main">∥</span> <span class="main">*</span> <span class="main">∥</span><span class="skolem">a</span> <span class="bound">r</span><span class="main">∥</span> <span class="main">≤</span> <span class="bound">r</span><span class="main">)</span> <span class="main">∨</span> <span class="main">(</span><span class="main">∃</span><span class="bound">r</span><span class="main">.</span> <span class="main">∥</span><span class="skolem">a</span> <span class="bound">r</span><span class="main">∥</span> <span class="main">&lt;</span> <span class="main">1</span> <span class="main">⟶</span> <span class="main">∥</span><span class="free">f</span> <span class="keyword1">*<span class="hidden">⇩</span><sub>v</sub></span> <span class="skolem">a</span> <span class="bound">r</span><span class="main">∥</span> <span class="main">≤</span> <span class="bound">r</span><span class="main">)</span>"</span></span>
        <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">meson</span> less_eq_real_def mult_le_cancel_left2<span class="main">)</span> 
      <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> dual_order.trans norm_blinfun <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
    <span class="keyword1"><span class="command">qed</span></span>
    <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">‹<span class="main">∃</span> <span class="bound">M</span><span class="main">.</span> <span class="main">∀</span> <span class="bound">x</span><span class="main">.</span> <span class="main">∥</span><span class="bound">x</span><span class="main">∥</span> <span class="main">&lt;</span> <span class="main">1</span> <span class="main">⟶</span> <span class="main">∥</span><span class="free">f</span> <span class="keyword1">*<span class="hidden">⇩</span><sub>v</sub></span> <span class="bound">x</span><span class="main">∥</span> <span class="main">≤</span> <span class="bound">M</span>›</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">metis</span>
    <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span> 
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">have</span></span> Sup_non_neg<span class="main">:</span> <span class="quoted"><span class="quoted">‹Sup <span class="main">{</span><span class="main">∥</span><span class="free">f</span> <span class="keyword1">*<span class="hidden">⇩</span><sub>v</sub></span> <span class="bound">x</span><span class="main">∥</span> <span class="main">|</span><span class="bound">x</span><span class="main">.</span> <span class="main">∥</span><span class="bound">x</span><span class="main">∥</span> <span class="main">=</span> <span class="main">1</span><span class="main">}</span> <span class="main">≥</span> <span class="main">0</span>›</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">smt</span> Collect_empty_eq cSup_upper mem_Collect_eq nonnegative norm_1_bounded norm_1_non_empty<span class="main">)</span>      
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹<span class="main">{</span><span class="main">0</span><span class="main">::</span>real<span class="main">}</span> <span class="main">≠</span> <span class="main">{}</span>›</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹bdd_above <span class="main">{</span><span class="main">0</span><span class="main">::</span>real<span class="main">}</span>›</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">‹<span class="main">∥</span><span class="free">f</span><span class="main">∥</span> <span class="main">=</span> Sup <span class="main">{</span><span class="main">∥</span><span class="free">f</span> <span class="keyword1">*<span class="hidden">⇩</span><sub>v</sub></span> <span class="bound">x</span><span class="main">∥</span> <span class="main">|</span> <span class="bound">x</span><span class="main">.</span> <span class="main">∥</span><span class="bound">x</span><span class="main">∥</span> <span class="main">&lt;</span> <span class="main">1</span><span class="main">}</span>›</span></span>
  <span class="keyword1"><span class="command">proof</span></span><span class="main">(</span><span class="operator">cases</span> <span class="quoted"><span class="quoted">‹<span class="main">∀</span><span class="bound">x</span><span class="main">.</span> <span class="free">f</span> <span class="keyword1">*<span class="hidden">⇩</span><sub>v</sub></span> <span class="bound">x</span> <span class="main">=</span> <span class="main">0</span>›</span></span><span class="main">)</span>
    <span class="keyword3"><span class="command">case</span></span> True
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹<span class="main">∥</span><span class="free">f</span> <span class="keyword1">*<span class="hidden">⇩</span><sub>v</sub></span> <span class="skolem">x</span><span class="main">∥</span> <span class="main">=</span> <span class="main">0</span>›</span></span> <span class="keyword2"><span class="keyword">for</span></span> <span class="skolem">x</span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> True<span class="main">)</span>
    <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">‹<span class="main">{</span><span class="main">∥</span><span class="free">f</span> <span class="keyword1">*<span class="hidden">⇩</span><sub>v</sub></span> <span class="bound">x</span><span class="main">∥</span> <span class="main">|</span> <span class="bound">x</span><span class="main">.</span> <span class="main">∥</span><span class="bound">x</span><span class="main">∥</span> <span class="main">&lt;</span> <span class="main">1</span> <span class="main">}</span> <span class="main">⊆</span> <span class="main">{</span><span class="main">0</span><span class="main">}</span>›</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>        
    <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹<span class="main">{</span><span class="main">∥</span><span class="free">f</span> <span class="keyword1">*<span class="hidden">⇩</span><sub>v</sub></span> <span class="bound">x</span><span class="main">∥</span> <span class="main">|</span> <span class="bound">x</span><span class="main">.</span> <span class="main">∥</span><span class="bound">x</span><span class="main">∥</span> <span class="main">&lt;</span> <span class="main">1</span> <span class="main">}</span> <span class="main">⊇</span> <span class="main">{</span><span class="main">0</span><span class="main">}</span>›</span></span>
      <span class="keyword1"><span class="command">using</span></span> calculation norm_less_1_non_empty <span class="keyword1"><span class="command">by</span></span> <span class="operator">fastforce</span>                        
    <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹<span class="main">{</span><span class="main">∥</span><span class="free">f</span> <span class="keyword1">*<span class="hidden">⇩</span><sub>v</sub></span> <span class="bound">x</span><span class="main">∥</span> <span class="main">|</span> <span class="bound">x</span><span class="main">.</span> <span class="main">∥</span><span class="bound">x</span><span class="main">∥</span> <span class="main">&lt;</span> <span class="main">1</span> <span class="main">}</span> <span class="main">=</span> <span class="main">{</span><span class="main">0</span><span class="main">}</span>›</span></span>  
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
    <span class="keyword1"><span class="command">hence</span></span> Sup1<span class="main">:</span> <span class="quoted"><span class="quoted">‹Sup <span class="main">{</span><span class="main">∥</span><span class="free">f</span> <span class="keyword1">*<span class="hidden">⇩</span><sub>v</sub></span> <span class="bound">x</span><span class="main">∥</span> <span class="main">|</span> <span class="bound">x</span><span class="main">.</span> <span class="main">∥</span><span class="bound">x</span><span class="main">∥</span> <span class="main">&lt;</span> <span class="main">1</span> <span class="main">}</span> <span class="main">=</span> <span class="main">0</span>›</span></span> 
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹<span class="main">∥</span><span class="free">f</span><span class="main">∥</span> <span class="main">=</span> <span class="main">0</span>›</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> True blinfun_eqI<span class="main">)</span>        
    <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹Sup <span class="main">{</span><span class="main">∥</span><span class="free">f</span> <span class="keyword1">*<span class="hidden">⇩</span><sub>v</sub></span> <span class="bound">x</span><span class="main">∥</span> <span class="main">|</span> <span class="bound">x</span><span class="main">.</span> <span class="main">∥</span><span class="bound">x</span><span class="main">∥</span> <span class="main">&lt;</span> <span class="main">1</span><span class="main">}</span> <span class="main">=</span> <span class="main">0</span>›</span></span>
      <span class="keyword1"><span class="command">using</span></span> Sup1 <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
    <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">next</span></span>
    <span class="keyword3"><span class="command">case</span></span> False
    <span class="keyword1"><span class="command">have</span></span> norm_f_eq_leq<span class="main">:</span> <span class="quoted"><span class="quoted">‹<span class="skolem">y</span> <span class="main">∈</span> <span class="main">{</span><span class="main">∥</span><span class="free">f</span> <span class="keyword1">*<span class="hidden">⇩</span><sub>v</sub></span> <span class="bound">x</span><span class="main">∥</span> <span class="main">|</span> <span class="bound">x</span><span class="main">.</span> <span class="main">∥</span><span class="bound">x</span><span class="main">∥</span> <span class="main">=</span> <span class="main">1</span><span class="main">}</span> <span class="main">⟹</span> 
                         <span class="skolem">y</span> <span class="main">≤</span> Sup <span class="main">{</span><span class="main">∥</span><span class="free">f</span> <span class="keyword1">*<span class="hidden">⇩</span><sub>v</sub></span> <span class="bound">x</span><span class="main">∥</span> <span class="main">|</span> <span class="bound">x</span><span class="main">.</span> <span class="main">∥</span><span class="bound">x</span><span class="main">∥</span> <span class="main">&lt;</span> <span class="main">1</span><span class="main">}</span>›</span></span> <span class="keyword2"><span class="keyword">for</span></span> <span class="skolem">y</span>
    <span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
      <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">y</span> <span class="main">∈</span> <span class="main">{</span><span class="main">∥</span><span class="free">f</span> <span class="keyword1">*<span class="hidden">⇩</span><sub>v</sub></span> <span class="bound">x</span><span class="main">∥</span> <span class="main">|</span> <span class="bound">x</span><span class="main">.</span> <span class="main">∥</span><span class="bound">x</span><span class="main">∥</span> <span class="main">=</span> <span class="main">1</span><span class="main">}</span>›</span></span>
      <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">‹<span class="main">∃</span> <span class="bound">x</span><span class="main">.</span> <span class="skolem">y</span> <span class="main">=</span> <span class="main">∥</span><span class="free">f</span> <span class="keyword1">*<span class="hidden">⇩</span><sub>v</sub></span> <span class="bound">x</span><span class="main">∥</span> <span class="main">∧</span> <span class="main">∥</span><span class="bound">x</span><span class="main">∥</span> <span class="main">=</span> <span class="main">1</span>›</span></span>
        <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
      <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">x</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">y</span> <span class="main">=</span> <span class="main">∥</span><span class="free">f</span> <span class="keyword1">*<span class="hidden">⇩</span><sub>v</sub></span> <span class="skolem">x</span><span class="main">∥</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹<span class="main">∥</span><span class="skolem">x</span><span class="main">∥</span> <span class="main">=</span> <span class="main">1</span>›</span></span>
        <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword3"><span class="command">define</span></span> <span class="skolem"><span class="skolem">y'</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">y'</span> <span class="skolem">n</span> <span class="main">=</span> <span class="main">(</span><span class="main">1</span> <span class="main">-</span> <span class="main">(</span>inverse <span class="main">(</span>real <span class="main">(</span>Suc <span class="skolem">n</span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="keyword1">*<span class="hidden">⇩</span><sub>R</sub></span> <span class="skolem">y</span>›</span></span> <span class="keyword2"><span class="keyword">for</span></span> <span class="skolem">n</span>
      <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">y'</span> <span class="skolem">n</span> <span class="main">∈</span> <span class="main">{</span><span class="main">∥</span><span class="free">f</span> <span class="keyword1">*<span class="hidden">⇩</span><sub>v</sub></span> <span class="bound">x</span><span class="main">∥</span> <span class="main">|</span> <span class="bound">x</span><span class="main">.</span> <span class="main">∥</span><span class="bound">x</span><span class="main">∥</span> <span class="main">&lt;</span> <span class="main">1</span><span class="main">}</span>›</span></span> <span class="keyword2"><span class="keyword">for</span></span> <span class="skolem">n</span>
      <span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
        <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">y'</span> <span class="skolem">n</span> <span class="main">=</span> <span class="main">(</span><span class="main">1</span> <span class="main">-</span> <span class="main">(</span>inverse <span class="main">(</span>real <span class="main">(</span>Suc <span class="skolem">n</span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="keyword1">*<span class="hidden">⇩</span><sub>R</sub></span> <span class="main">∥</span><span class="free">f</span> <span class="keyword1">*<span class="hidden">⇩</span><sub>v</sub></span> <span class="skolem">x</span><span class="main">∥</span>›</span></span>
          <span class="keyword1"><span class="command">using</span></span> y'_def <span class="quoted"><span class="quoted">‹<span class="skolem">y</span> <span class="main">=</span> <span class="main">∥</span><span class="free">f</span> <span class="keyword1">*<span class="hidden">⇩</span><sub>v</sub></span> <span class="skolem">x</span><span class="main">∥</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
        <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹<span class="main">...</span> <span class="main">=</span> <span class="main">¦</span><span class="main">(</span><span class="main">1</span> <span class="main">-</span> <span class="main">(</span>inverse <span class="main">(</span>real <span class="main">(</span>Suc <span class="skolem">n</span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">¦</span> <span class="keyword1">*<span class="hidden">⇩</span><sub>R</sub></span> <span class="main">∥</span><span class="free">f</span> <span class="keyword1">*<span class="hidden">⇩</span><sub>v</sub></span> <span class="skolem">x</span><span class="main">∥</span>›</span></span>
          <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> <span class="main"><span class="main">(</span></span>mono_tags<span class="main"><span class="main">,</span></span> hide_lams<span class="main"><span class="main">)</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">y</span> <span class="main">=</span> <span class="main">∥</span><span class="free">f</span> <span class="keyword1">*<span class="hidden">⇩</span><sub>v</sub></span> <span class="skolem">x</span><span class="main">∥</span>›</span></span> abs_1 abs_le_self_iff abs_of_nat 
              abs_of_nonneg add_diff_cancel_left' add_eq_if cancel_comm_monoid_add_class.diff_cancel
              diff_ge_0_iff_ge eq_iff_diff_eq_0 inverse_1 inverse_le_iff_le nat.distinct<span class="main"><span class="main">(</span></span>1<span class="main"><span class="main">)</span></span> of_nat_0
              of_nat_Suc of_nat_le_0_iff zero_less_abs_iff zero_neq_one<span class="main">)</span>
        <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹<span class="main">...</span> <span class="main">=</span> <span class="main">∥</span><span class="free">f</span> <span class="keyword1">*<span class="hidden">⇩</span><sub>v</sub></span> <span class="main">(</span><span class="main">(</span><span class="main">1</span> <span class="main">-</span> <span class="main">(</span>inverse <span class="main">(</span>real <span class="main">(</span>Suc <span class="skolem">n</span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="keyword1">*<span class="hidden">⇩</span><sub>R</sub></span>  <span class="skolem">x</span><span class="main">)</span><span class="main">∥</span>›</span></span>
          <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> blinfun.scaleR_right<span class="main">)</span>            
        <span class="keyword1"><span class="command">finally</span></span> <span class="keyword1"><span class="command">have</span></span> y'_1<span class="main">:</span> <span class="quoted"><span class="quoted">‹<span class="skolem">y'</span> <span class="skolem">n</span> <span class="main">=</span> <span class="main">∥</span><span class="free">f</span> <span class="keyword1">*<span class="hidden">⇩</span><sub>v</sub></span> <span class="main">(</span> <span class="main">(</span><span class="main">1</span> <span class="main">-</span> <span class="main">(</span>inverse <span class="main">(</span>real <span class="main">(</span>Suc <span class="skolem">n</span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="keyword1">*<span class="hidden">⇩</span><sub>R</sub></span> <span class="skolem">x</span><span class="main">)</span><span class="main">∥</span>›</span></span> 
          <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
        <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹<span class="main">∥</span><span class="main">(</span><span class="main">1</span> <span class="main">-</span> <span class="main">(</span>inverse <span class="main">(</span>Suc <span class="skolem">n</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="keyword1">*<span class="hidden">⇩</span><sub>R</sub></span> <span class="skolem">x</span><span class="main">∥</span> <span class="main">=</span> <span class="main">(</span><span class="main">1</span> <span class="main">-</span> <span class="main">(</span>inverse <span class="main">(</span>real <span class="main">(</span>Suc <span class="skolem">n</span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">*</span> <span class="main">∥</span><span class="skolem">x</span><span class="main">∥</span>›</span></span>
          <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> linordered_field_class.inverse_le_1_iff<span class="main">)</span>                
        <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">‹<span class="main">∥</span><span class="main">(</span><span class="main">1</span> <span class="main">-</span> <span class="main">(</span>inverse <span class="main">(</span>Suc <span class="skolem">n</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="keyword1">*<span class="hidden">⇩</span><sub>R</sub></span> <span class="skolem">x</span><span class="main">∥</span> <span class="main">&lt;</span> <span class="main">1</span>›</span></span>
          <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> <span class="quoted"><span class="quoted">‹<span class="main">∥</span><span class="skolem">x</span><span class="main">∥</span> <span class="main">=</span> <span class="main">1</span>›</span></span><span class="main">)</span> 
        <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> y'_1 <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span> 
      <span class="keyword1"><span class="command">qed</span></span>
      <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹<span class="main">(</span><span class="main">λ</span><span class="bound">n</span><span class="main">.</span> <span class="main">(</span><span class="main">1</span> <span class="main">-</span> <span class="main">(</span>inverse <span class="main">(</span>real <span class="main">(</span>Suc <span class="bound">n</span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">)</span> <span class="main">⇢</span> <span class="main">1</span>›</span></span>
        <span class="keyword1"><span class="command">using</span></span> Limits.LIMSEQ_inverse_real_of_nat_add_minus <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
      <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">‹<span class="main">(</span><span class="main">λ</span><span class="bound">n</span><span class="main">.</span> <span class="main">(</span><span class="main">1</span> <span class="main">-</span> <span class="main">(</span>inverse <span class="main">(</span>real <span class="main">(</span>Suc <span class="bound">n</span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="keyword1">*<span class="hidden">⇩</span><sub>R</sub></span> <span class="skolem">y</span><span class="main">)</span> <span class="main">⇢</span> <span class="main">1</span> <span class="keyword1">*<span class="hidden">⇩</span><sub>R</sub></span> <span class="skolem">y</span>›</span></span>
        <span class="keyword1"><span class="command">using</span></span> Limits.tendsto_scaleR <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
      <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">‹<span class="main">(</span><span class="main">λ</span><span class="bound">n</span><span class="main">.</span> <span class="main">(</span><span class="main">1</span> <span class="main">-</span> <span class="main">(</span>inverse <span class="main">(</span>real <span class="main">(</span>Suc <span class="bound">n</span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="keyword1">*<span class="hidden">⇩</span><sub>R</sub></span> <span class="skolem">y</span><span class="main">)</span> <span class="main">⇢</span> <span class="skolem">y</span>›</span></span>
        <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
      <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">‹<span class="main">(</span><span class="main">λ</span><span class="bound">n</span><span class="main">.</span> <span class="skolem">y'</span> <span class="bound">n</span><span class="main">)</span> <span class="main">⇢</span> <span class="skolem">y</span>›</span></span>
        <span class="keyword1"><span class="command">using</span></span> y'_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
      <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">y'</span> <span class="main">⇢</span> <span class="skolem">y</span>›</span></span> 
        <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
      <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">y'</span> <span class="skolem">n</span> <span class="main">≤</span> Sup <span class="main">{</span><span class="main">∥</span><span class="free">f</span> <span class="keyword1">*<span class="hidden">⇩</span><sub>v</sub></span> <span class="bound">x</span><span class="main">∥</span> <span class="main">|</span> <span class="bound">x</span><span class="main">.</span> <span class="main">∥</span><span class="bound">x</span><span class="main">∥</span> <span class="main">&lt;</span> <span class="main">1</span><span class="main">}</span>›</span></span> <span class="keyword2"><span class="keyword">for</span></span> <span class="skolem">n</span>
        <span class="keyword1"><span class="command">using</span></span> cSup_upper <span class="quoted"><span class="quoted">‹<span class="main">⋀</span><span class="bound">n</span><span class="main">.</span> <span class="skolem">y'</span> <span class="bound">n</span> <span class="main">∈</span> <span class="main">{</span><span class="main">∥</span><span class="free">f</span> <span class="keyword1">*<span class="hidden">⇩</span><sub>v</sub></span> <span class="bound">x</span><span class="main">∥</span> <span class="main">|</span><span class="bound">x</span><span class="main">.</span> <span class="main">∥</span><span class="bound">x</span><span class="main">∥</span> <span class="main">&lt;</span> <span class="main">1</span><span class="main">}</span>›</span></span> norm_less_1_bounded <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
      <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">y</span> <span class="main">≤</span> Sup <span class="main">{</span><span class="main">∥</span><span class="free">f</span> <span class="keyword1">*<span class="hidden">⇩</span><sub>v</sub></span> <span class="bound">x</span><span class="main">∥</span> <span class="main">|</span> <span class="bound">x</span><span class="main">.</span> <span class="main">∥</span><span class="bound">x</span><span class="main">∥</span> <span class="main">&lt;</span> <span class="main">1</span><span class="main">}</span>›</span></span>
        <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">y'</span> <span class="main">⇢</span> <span class="skolem">y</span>›</span></span> Topological_Spaces.Sup_lim <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">meson</span> LIMSEQ_le_const2<span class="main">)</span>
      <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
    <span class="keyword1"><span class="command">qed</span></span>
    <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">‹Sup <span class="main">{</span><span class="main">∥</span><span class="free">f</span> <span class="keyword1">*<span class="hidden">⇩</span><sub>v</sub></span> <span class="bound">x</span><span class="main">∥</span> <span class="main">|</span> <span class="bound">x</span><span class="main">.</span> <span class="main">∥</span><span class="bound">x</span><span class="main">∥</span> <span class="main">=</span> <span class="main">1</span><span class="main">}</span> <span class="main">≤</span> Sup <span class="main">{</span><span class="main">∥</span><span class="free">f</span> <span class="keyword1">*<span class="hidden">⇩</span><sub>v</sub></span> <span class="bound">x</span><span class="main">∥</span> <span class="main">|</span> <span class="bound">x</span><span class="main">.</span> <span class="main">∥</span><span class="bound">x</span><span class="main">∥</span> <span class="main">&lt;</span> <span class="main">1</span><span class="main">}</span>›</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> <span class="main"><span class="main">(</span></span>lifting<span class="main"><span class="main">)</span></span> cSup_least norm_1_non_empty<span class="main">)</span>
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">y</span> <span class="main">∈</span> <span class="main">{</span><span class="main">∥</span><span class="free">f</span> <span class="keyword1">*<span class="hidden">⇩</span><sub>v</sub></span> <span class="bound">x</span><span class="main">∥</span> <span class="main">|</span> <span class="bound">x</span><span class="main">.</span> <span class="main">∥</span><span class="bound">x</span><span class="main">∥</span> <span class="main">&lt;</span> <span class="main">1</span><span class="main">}</span> <span class="main">⟹</span> <span class="skolem">y</span> <span class="main">≤</span> Sup <span class="main">{</span><span class="main">∥</span><span class="free">f</span> <span class="keyword1">*<span class="hidden">⇩</span><sub>v</sub></span> <span class="bound">x</span><span class="main">∥</span> <span class="main">|</span> <span class="bound">x</span><span class="main">.</span> <span class="main">∥</span><span class="bound">x</span><span class="main">∥</span> <span class="main">=</span> <span class="main">1</span><span class="main">}</span>›</span></span> <span class="keyword2"><span class="keyword">for</span></span> <span class="skolem">y</span>
    <span class="keyword1"><span class="command">proof</span></span><span class="main">(</span><span class="operator">cases</span> <span class="quoted"><span class="quoted">‹<span class="skolem">y</span> <span class="main">=</span> <span class="main">0</span>›</span></span><span class="main">)</span>
      <span class="keyword3"><span class="command">case</span></span> True <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> Sup_non_neg<span class="main">)</span> 
    <span class="keyword1"><span class="command">next</span></span>
      <span class="keyword3"><span class="command">case</span></span> False
      <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">y</span> <span class="main">≠</span> <span class="main">0</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
      <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">y</span> <span class="main">∈</span> <span class="main">{</span><span class="main">∥</span><span class="free">f</span> <span class="keyword1">*<span class="hidden">⇩</span><sub>v</sub></span> <span class="bound">x</span><span class="main">∥</span> <span class="main">|</span> <span class="bound">x</span><span class="main">.</span> <span class="main">∥</span><span class="bound">x</span><span class="main">∥</span> <span class="main">&lt;</span> <span class="main">1</span><span class="main">}</span>›</span></span>
      <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">‹<span class="main">∃</span> <span class="bound">x</span><span class="main">.</span> <span class="skolem">y</span> <span class="main">=</span> <span class="main">∥</span><span class="free">f</span> <span class="keyword1">*<span class="hidden">⇩</span><sub>v</sub></span> <span class="bound">x</span><span class="main">∥</span> <span class="main">∧</span> <span class="main">∥</span><span class="bound">x</span><span class="main">∥</span> <span class="main">&lt;</span> <span class="main">1</span>›</span></span>
        <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
      <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">x</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">y</span> <span class="main">=</span> <span class="main">∥</span><span class="free">f</span> <span class="keyword1">*<span class="hidden">⇩</span><sub>v</sub></span> <span class="skolem">x</span><span class="main">∥</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹<span class="main">∥</span><span class="skolem">x</span><span class="main">∥</span> <span class="main">&lt;</span> <span class="main">1</span>›</span></span>
        <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
      <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹<span class="main">(</span><span class="main">1</span><span class="main">/</span><span class="main">∥</span><span class="skolem">x</span><span class="main">∥</span><span class="main">)</span> <span class="main">*</span> <span class="skolem">y</span> <span class="main">=</span> <span class="main">(</span><span class="main">1</span><span class="main">/</span><span class="main">∥</span><span class="skolem">x</span><span class="main">∥</span><span class="main">)</span> <span class="main">*</span> <span class="main">∥</span><span class="free">f</span> <span class="skolem">x</span><span class="main">∥</span>›</span></span>
        <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">y</span> <span class="main">=</span> <span class="main">∥</span><span class="free">f</span> <span class="keyword1">*<span class="hidden">⇩</span><sub>v</sub></span> <span class="skolem">x</span><span class="main">∥</span>›</span></span><span class="main">)</span>
      <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹<span class="main">...</span> <span class="main">=</span> <span class="main">¦</span><span class="main">1</span><span class="main">/</span><span class="main">∥</span><span class="skolem">x</span><span class="main">∥</span><span class="main">¦</span> <span class="main">*</span> <span class="main">∥</span><span class="free">f</span> <span class="keyword1">*<span class="hidden">⇩</span><sub>v</sub></span> <span class="skolem">x</span><span class="main">∥</span>›</span></span>
        <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
      <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹<span class="main">...</span> <span class="main">=</span> <span class="main">∥</span><span class="main">(</span><span class="main">1</span><span class="main">/</span><span class="main">∥</span><span class="skolem">x</span><span class="main">∥</span><span class="main">)</span> <span class="keyword1">*<span class="hidden">⇩</span><sub>R</sub></span> <span class="main">(</span><span class="free">f</span> <span class="keyword1">*<span class="hidden">⇩</span><sub>v</sub></span> <span class="skolem">x</span><span class="main">)</span><span class="main">∥</span>›</span></span>
        <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
      <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹<span class="main">...</span> <span class="main">=</span> <span class="main">∥</span><span class="free">f</span> <span class="keyword1">*<span class="hidden">⇩</span><sub>v</sub></span> <span class="main">(</span><span class="main">(</span><span class="main">1</span><span class="main">/</span><span class="main">∥</span><span class="skolem">x</span><span class="main">∥</span><span class="main">)</span> <span class="keyword1">*<span class="hidden">⇩</span><sub>R</sub></span> <span class="skolem">x</span><span class="main">)</span><span class="main">∥</span>›</span></span>
        <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> blinfun.scaleR_right<span class="main">)</span>          
      <span class="keyword1"><span class="command">finally</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹<span class="main">(</span><span class="main">1</span><span class="main">/</span><span class="main">∥</span><span class="skolem">x</span><span class="main">∥</span><span class="main">)</span> <span class="main">*</span> <span class="skolem">y</span>  <span class="main">=</span> <span class="main">∥</span><span class="free">f</span> <span class="keyword1">*<span class="hidden">⇩</span><sub>v</sub></span> <span class="main">(</span><span class="main">(</span><span class="main">1</span><span class="main">/</span><span class="main">∥</span><span class="skolem">x</span><span class="main">∥</span><span class="main">)</span> <span class="keyword1">*<span class="hidden">⇩</span><sub>R</sub></span> <span class="skolem">x</span><span class="main">)</span><span class="main">∥</span>›</span></span>
        <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
      <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">x</span> <span class="main">≠</span> <span class="main">0</span>›</span></span>
        <span class="keyword1"><span class="command">using</span></span>  <span class="quoted"><span class="quoted">‹<span class="skolem">y</span> <span class="main">≠</span> <span class="main">0</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">y</span> <span class="main">=</span> <span class="main">∥</span><span class="free">f</span> <span class="keyword1">*<span class="hidden">⇩</span><sub>v</sub></span> <span class="skolem">x</span><span class="main">∥</span>›</span></span> blinfun.zero_right <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span> 
      <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹<span class="main">∥</span> <span class="main">(</span><span class="main">1</span><span class="main">/</span><span class="main">∥</span><span class="skolem">x</span><span class="main">∥</span><span class="main">)</span> <span class="keyword1">*<span class="hidden">⇩</span><sub>R</sub></span> <span class="skolem">x</span> <span class="main">∥</span> <span class="main">=</span> <span class="main">¦</span> <span class="main">(</span><span class="main">1</span><span class="main">/</span><span class="main">∥</span><span class="skolem">x</span><span class="main">∥</span><span class="main">)</span> <span class="main">¦</span> <span class="main">*</span> <span class="main">∥</span><span class="skolem">x</span><span class="main">∥</span>›</span></span>
        <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
      <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹<span class="main">...</span> <span class="main">=</span> <span class="main">(</span><span class="main">1</span><span class="main">/</span><span class="main">∥</span><span class="skolem">x</span><span class="main">∥</span><span class="main">)</span> <span class="main">*</span> <span class="main">∥</span><span class="skolem">x</span><span class="main">∥</span>›</span></span>
        <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
      <span class="keyword1"><span class="command">finally</span></span> <span class="keyword1"><span class="command">have</span></span>  <span class="quoted"><span class="quoted">‹<span class="main">∥</span><span class="main">(</span><span class="main">1</span><span class="main">/</span><span class="main">∥</span><span class="skolem">x</span><span class="main">∥</span><span class="main">)</span> <span class="keyword1">*<span class="hidden">⇩</span><sub>R</sub></span> <span class="skolem">x</span><span class="main">∥</span> <span class="main">=</span> <span class="main">1</span>›</span></span>
        <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">x</span> <span class="main">≠</span> <span class="main">0</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
      <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">‹<span class="main">(</span><span class="main">1</span><span class="main">/</span><span class="main">∥</span><span class="skolem">x</span><span class="main">∥</span><span class="main">)</span> <span class="main">*</span> <span class="skolem">y</span> <span class="main">∈</span> <span class="main">{</span> <span class="main">∥</span><span class="free">f</span> <span class="keyword1">*<span class="hidden">⇩</span><sub>v</sub></span> <span class="bound">x</span><span class="main">∥</span> <span class="main">|</span> <span class="bound">x</span><span class="main">.</span> <span class="main">∥</span><span class="bound">x</span><span class="main">∥</span> <span class="main">=</span> <span class="main">1</span><span class="main">}</span>›</span></span>
        <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="main">1</span> <span class="main">/</span> <span class="main">∥</span><span class="skolem">x</span><span class="main">∥</span> <span class="main">*</span> <span class="skolem">y</span> <span class="main">=</span> <span class="main">∥</span><span class="free">f</span> <span class="keyword1">*<span class="hidden">⇩</span><sub>v</sub></span> <span class="main">(</span><span class="main">1</span> <span class="main">/</span> <span class="main">∥</span><span class="skolem">x</span><span class="main">∥</span><span class="main">)</span> <span class="keyword1">*<span class="hidden">⇩</span><sub>R</sub></span> <span class="skolem">x</span><span class="main">∥</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
      <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">‹<span class="main">(</span><span class="main">1</span><span class="main">/</span><span class="main">∥</span><span class="skolem">x</span><span class="main">∥</span><span class="main">)</span> <span class="main">*</span> <span class="skolem">y</span> <span class="main">≤</span> Sup <span class="main">{</span> <span class="main">∥</span><span class="free">f</span> <span class="keyword1">*<span class="hidden">⇩</span><sub>v</sub></span> <span class="bound">x</span><span class="main">∥</span> <span class="main">|</span> <span class="bound">x</span><span class="main">.</span> <span class="main">∥</span><span class="bound">x</span><span class="main">∥</span> <span class="main">=</span> <span class="main">1</span><span class="main">}</span>›</span></span>
        <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> cSup_upper norm_1_bounded<span class="main">)</span>
      <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">y</span> <span class="main">≤</span> <span class="main">(</span><span class="main">1</span><span class="main">/</span><span class="main">∥</span><span class="skolem">x</span><span class="main">∥</span><span class="main">)</span> <span class="main">*</span> <span class="skolem">y</span>›</span></span>
        <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> <span class="quoted"><span class="quoted">‹<span class="main">∥</span><span class="skolem">x</span><span class="main">∥</span> <span class="main">&lt;</span> <span class="main">1</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">y</span> <span class="main">=</span> <span class="main">∥</span><span class="free">f</span> <span class="keyword1">*<span class="hidden">⇩</span><sub>v</sub></span> <span class="skolem">x</span><span class="main">∥</span>›</span></span> mult_le_cancel_right1 norm_not_less_zero 
            order.strict_implies_order <span class="quoted"><span class="quoted">‹<span class="skolem">x</span> <span class="main">≠</span> <span class="main">0</span>›</span></span> less_divide_eq_1_pos zero_less_norm_iff<span class="main">)</span>
      <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">linarith</span> 
    <span class="keyword1"><span class="command">qed</span></span>
    <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">‹Sup <span class="main">{</span> <span class="main">∥</span><span class="free">f</span> <span class="keyword1">*<span class="hidden">⇩</span><sub>v</sub></span> <span class="bound">x</span><span class="main">∥</span> <span class="main">|</span> <span class="bound">x</span><span class="main">.</span> <span class="main">∥</span><span class="bound">x</span><span class="main">∥</span> <span class="main">&lt;</span> <span class="main">1</span><span class="main">}</span> <span class="main">≤</span> Sup <span class="main">{</span> <span class="main">∥</span><span class="free">f</span> <span class="keyword1">*<span class="hidden">⇩</span><sub>v</sub></span> <span class="bound">x</span><span class="main">∥</span> <span class="main">|</span> <span class="bound">x</span><span class="main">.</span> <span class="main">∥</span><span class="bound">x</span><span class="main">∥</span> <span class="main">=</span> <span class="main">1</span><span class="main">}</span>›</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">smt</span> cSup_least norm_less_1_non_empty<span class="main">)</span> 
    <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">‹Sup <span class="main">{</span> <span class="main">∥</span><span class="free">f</span> <span class="keyword1">*<span class="hidden">⇩</span><sub>v</sub></span> <span class="bound">x</span><span class="main">∥</span> <span class="main">|</span> <span class="bound">x</span><span class="main">.</span> <span class="main">∥</span><span class="bound">x</span><span class="main">∥</span> <span class="main">=</span> <span class="main">1</span><span class="main">}</span> <span class="main">=</span> Sup <span class="main">{</span> <span class="main">∥</span><span class="free">f</span> <span class="keyword1">*<span class="hidden">⇩</span><sub>v</sub></span> <span class="bound">x</span><span class="main">∥</span> <span class="main">|</span> <span class="bound">x</span><span class="main">.</span> <span class="main">∥</span><span class="bound">x</span><span class="main">∥</span> <span class="main">&lt;</span> <span class="main">1</span><span class="main">}</span>›</span></span>
      <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹Sup <span class="main">{</span><span class="main">∥</span><span class="free">f</span> <span class="keyword1">*<span class="hidden">⇩</span><sub>v</sub></span> <span class="bound">x</span><span class="main">∥</span> <span class="main">|</span><span class="bound">x</span><span class="main">.</span> norm <span class="bound">x</span> <span class="main">=</span> <span class="main">1</span><span class="main">}</span> <span class="main">≤</span> Sup <span class="main">{</span> <span class="main">∥</span><span class="free">f</span> <span class="keyword1">*<span class="hidden">⇩</span><sub>v</sub></span> <span class="bound">x</span><span class="main">∥</span> <span class="main">|</span><span class="bound">x</span><span class="main">.</span> <span class="main">∥</span><span class="bound">x</span><span class="main">∥</span> <span class="main">&lt;</span> <span class="main">1</span><span class="main">}</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">linarith</span>
    <span class="keyword1"><span class="command">have</span></span> f1<span class="main">:</span> <span class="quoted"><span class="quoted">‹<span class="main">(</span><span class="keyword1">SUP</span> <span class="bound">x</span><span class="main">.</span> <span class="main">∥</span><span class="free">f</span> <span class="keyword1">*<span class="hidden">⇩</span><sub>v</sub></span> <span class="bound">x</span><span class="main">∥</span> <span class="main">/</span> <span class="main">∥</span><span class="bound">x</span><span class="main">∥</span><span class="main">)</span> <span class="main">=</span> Sup <span class="main">{</span> <span class="main">∥</span><span class="free">f</span> <span class="keyword1">*<span class="hidden">⇩</span><sub>v</sub></span> <span class="bound">x</span><span class="main">∥</span> <span class="main">/</span> <span class="main">∥</span><span class="bound">x</span><span class="main">∥</span> <span class="main">|</span> <span class="bound">x</span><span class="main">.</span> True<span class="main">}</span>›</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> full_SetCompr_eq<span class="main">)</span>
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">y</span> <span class="main">∈</span> <span class="main">{</span> <span class="main">∥</span><span class="free">f</span> <span class="keyword1">*<span class="hidden">⇩</span><sub>v</sub></span> <span class="bound">x</span><span class="main">∥</span> <span class="main">/</span> <span class="main">∥</span><span class="bound">x</span><span class="main">∥</span> <span class="main">|</span><span class="bound">x</span><span class="main">.</span> True<span class="main">}</span> <span class="main">⟹</span> <span class="skolem">y</span> <span class="main">∈</span> <span class="main">{</span> <span class="main">∥</span><span class="free">f</span> <span class="keyword1">*<span class="hidden">⇩</span><sub>v</sub></span> <span class="bound">x</span><span class="main">∥</span> <span class="main">|</span><span class="bound">x</span><span class="main">.</span> <span class="main">∥</span><span class="bound">x</span><span class="main">∥</span> <span class="main">=</span> <span class="main">1</span><span class="main">}</span> <span class="main">∪</span> <span class="main">{</span><span class="main">0</span><span class="main">}</span>›</span></span>
      <span class="keyword2"><span class="keyword">for</span></span> <span class="skolem">y</span>
    <span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
      <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">y</span> <span class="main">∈</span> <span class="main">{</span> <span class="main">∥</span><span class="free">f</span> <span class="keyword1">*<span class="hidden">⇩</span><sub>v</sub></span> <span class="bound">x</span><span class="main">∥</span> <span class="main">/</span> <span class="main">∥</span><span class="bound">x</span><span class="main">∥</span> <span class="main">|</span><span class="bound">x</span><span class="main">.</span> True<span class="main">}</span>›</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
      <span class="keyword1"><span class="command">proof</span></span><span class="main">(</span><span class="operator">cases</span> <span class="quoted"><span class="quoted">‹<span class="skolem">y</span> <span class="main">=</span> <span class="main">0</span>›</span></span><span class="main">)</span>
        <span class="keyword3"><span class="command">case</span></span> True  <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span> 
      <span class="keyword1"><span class="command">next</span></span>
        <span class="keyword3"><span class="command">case</span></span> False
        <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹<span class="main">∃</span> <span class="bound">x</span><span class="main">.</span> <span class="skolem">y</span> <span class="main">=</span> <span class="main">∥</span><span class="free">f</span> <span class="keyword1">*<span class="hidden">⇩</span><sub>v</sub></span> <span class="bound">x</span><span class="main">∥</span> <span class="main">/</span> <span class="main">∥</span><span class="bound">x</span><span class="main">∥</span>›</span></span>
          <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">y</span> <span class="main">∈</span> <span class="main">{</span> <span class="main">∥</span><span class="free">f</span> <span class="keyword1">*<span class="hidden">⇩</span><sub>v</sub></span> <span class="bound">x</span><span class="main">∥</span> <span class="main">/</span> <span class="main">∥</span><span class="bound">x</span><span class="main">∥</span> <span class="main">|</span><span class="bound">x</span><span class="main">.</span> True<span class="main">}</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">x</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">y</span> <span class="main">=</span> <span class="main">∥</span><span class="free">f</span> <span class="keyword1">*<span class="hidden">⇩</span><sub>v</sub></span> <span class="skolem">x</span><span class="main">∥</span> <span class="main">/</span> <span class="main">∥</span><span class="skolem">x</span><span class="main">∥</span>›</span></span>
          <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
        <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">y</span> <span class="main">=</span> <span class="main">¦</span><span class="main">(</span><span class="main">1</span><span class="main">/</span><span class="main">∥</span><span class="skolem">x</span><span class="main">∥</span><span class="main">)</span><span class="main">¦</span> <span class="main">*</span> <span class="main">∥</span> <span class="free">f</span> <span class="keyword1">*<span class="hidden">⇩</span><sub>v</sub></span> <span class="skolem">x</span> <span class="main">∥</span>›</span></span>
          <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
        <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">y</span> <span class="main">=</span> <span class="main">∥</span><span class="main">(</span><span class="main">1</span><span class="main">/</span><span class="main">∥</span><span class="skolem">x</span><span class="main">∥</span><span class="main">)</span> <span class="keyword1">*<span class="hidden">⇩</span><sub>R</sub></span> <span class="main">(</span><span class="free">f</span> <span class="keyword1">*<span class="hidden">⇩</span><sub>v</sub></span> <span class="skolem">x</span><span class="main">)</span><span class="main">∥</span>›</span></span>
          <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
        <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">y</span> <span class="main">=</span> <span class="main">∥</span><span class="free">f</span> <span class="main">(</span><span class="main">(</span><span class="main">1</span><span class="main">/</span><span class="main">∥</span><span class="skolem">x</span><span class="main">∥</span><span class="main">)</span> <span class="keyword1">*<span class="hidden">⇩</span><sub>R</sub></span> <span class="skolem">x</span><span class="main">)</span><span class="main">∥</span>›</span></span>
          <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> blinfun.scaleR_right<span class="main">)</span>            
        <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹<span class="main">∥</span> <span class="main">(</span><span class="main">1</span><span class="main">/</span><span class="main">∥</span><span class="skolem">x</span><span class="main">∥</span><span class="main">)</span> <span class="keyword1">*<span class="hidden">⇩</span><sub>R</sub></span> <span class="skolem">x</span> <span class="main">∥</span> <span class="main">=</span> <span class="main">1</span>›</span></span>
          <span class="keyword1"><span class="command">using</span></span> False <span class="quoted"><span class="quoted">‹<span class="skolem">y</span> <span class="main">=</span> <span class="main">∥</span><span class="free">f</span> <span class="keyword1">*<span class="hidden">⇩</span><sub>v</sub></span> <span class="skolem">x</span><span class="main">∥</span> <span class="main">/</span> <span class="main">∥</span><span class="skolem">x</span><span class="main">∥</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">y</span> <span class="main">∈</span> <span class="main">{</span><span class="main">∥</span><span class="free">f</span> <span class="keyword1">*<span class="hidden">⇩</span><sub>v</sub></span> <span class="bound">x</span><span class="main">∥</span> <span class="main">|</span><span class="bound">x</span><span class="main">.</span> <span class="main">∥</span><span class="bound">x</span><span class="main">∥</span> <span class="main">=</span> <span class="main">1</span><span class="main">}</span>›</span></span>
          <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
        <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
      <span class="keyword1"><span class="command">qed</span></span>
    <span class="keyword1"><span class="command">qed</span></span>
    <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">y</span> <span class="main">∈</span> <span class="main">{</span><span class="main">∥</span><span class="free">f</span> <span class="bound">x</span><span class="main">∥</span> <span class="main">|</span><span class="bound">x</span><span class="main">.</span> <span class="main">∥</span><span class="bound">x</span><span class="main">∥</span> <span class="main">=</span> <span class="main">1</span><span class="main">}</span> <span class="main">∪</span> <span class="main">{</span><span class="main">0</span><span class="main">}</span> <span class="main">⟹</span> <span class="skolem">y</span> <span class="main">∈</span> <span class="main">{</span><span class="main">∥</span><span class="free">f</span> <span class="keyword1">*<span class="hidden">⇩</span><sub>v</sub></span> <span class="bound">x</span><span class="main">∥</span> <span class="main">/</span> <span class="main">∥</span><span class="bound">x</span><span class="main">∥</span> <span class="main">|</span><span class="bound">x</span><span class="main">.</span> True<span class="main">}</span>›</span></span>
      <span class="keyword2"><span class="keyword">for</span></span> <span class="skolem">y</span>
    <span class="keyword1"><span class="command">proof</span></span><span class="main">(</span><span class="operator">cases</span> <span class="quoted"><span class="quoted">‹<span class="skolem">y</span> <span class="main">=</span> <span class="main">0</span>›</span></span><span class="main">)</span>
      <span class="keyword3"><span class="command">case</span></span> True <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span> 
    <span class="keyword1"><span class="command">next</span></span>
      <span class="keyword3"><span class="command">case</span></span> False
      <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">y</span> <span class="main">∉</span> <span class="main">{</span><span class="main">0</span><span class="main">}</span>›</span></span>
        <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
      <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">y</span> <span class="main">∈</span> <span class="main">{</span><span class="main">∥</span><span class="free">f</span> <span class="keyword1">*<span class="hidden">⇩</span><sub>v</sub></span> <span class="bound">x</span><span class="main">∥</span> <span class="main">|</span><span class="bound">x</span><span class="main">.</span> <span class="main">∥</span><span class="bound">x</span><span class="main">∥</span> <span class="main">=</span> <span class="main">1</span><span class="main">}</span> <span class="main">∪</span> <span class="main">{</span><span class="main">0</span><span class="main">}</span>›</span></span>
      <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">y</span> <span class="main">∈</span> <span class="main">{</span><span class="main">∥</span><span class="free">f</span> <span class="keyword1">*<span class="hidden">⇩</span><sub>v</sub></span> <span class="bound">x</span><span class="main">∥</span> <span class="main">|</span><span class="bound">x</span><span class="main">.</span> <span class="main">∥</span><span class="bound">x</span><span class="main">∥</span> <span class="main">=</span> <span class="main">1</span><span class="main">}</span>›</span></span>
        <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
      <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">x</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">‹<span class="main">∥</span><span class="skolem">x</span><span class="main">∥</span> <span class="main">=</span> <span class="main">1</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">y</span> <span class="main">=</span> <span class="main">∥</span><span class="free">f</span> <span class="keyword1">*<span class="hidden">⇩</span><sub>v</sub></span> <span class="skolem">x</span><span class="main">∥</span>›</span></span>
        <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">y</span> <span class="main">=</span> <span class="main">∥</span><span class="free">f</span> <span class="keyword1">*<span class="hidden">⇩</span><sub>v</sub></span> <span class="skolem">x</span><span class="main">∥</span> <span class="main">/</span> <span class="main">∥</span><span class="skolem">x</span><span class="main">∥</span>›</span></span> <span class="keyword1"><span class="command">using</span></span>  <span class="quoted"><span class="quoted">‹<span class="main">∥</span><span class="skolem">x</span><span class="main">∥</span> <span class="main">=</span> <span class="main">1</span>›</span></span>  <span class="quoted"><span class="quoted">‹<span class="skolem">y</span> <span class="main">=</span> <span class="main">∥</span><span class="free">f</span> <span class="keyword1">*<span class="hidden">⇩</span><sub>v</sub></span> <span class="skolem">x</span><span class="main">∥</span>›</span></span>
        <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span> 
      <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span> 
    <span class="keyword1"><span class="command">qed</span></span>
    <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹<span class="main">{</span><span class="main">∥</span><span class="free">f</span> <span class="keyword1">*<span class="hidden">⇩</span><sub>v</sub></span> <span class="bound">x</span><span class="main">∥</span> <span class="main">/</span> <span class="main">∥</span><span class="bound">x</span><span class="main">∥</span> <span class="main">|</span><span class="bound">x</span><span class="main">.</span> True<span class="main">}</span> <span class="main">=</span> <span class="main">{</span><span class="main">∥</span><span class="free">f</span> <span class="keyword1">*<span class="hidden">⇩</span><sub>v</sub></span> <span class="bound">x</span><span class="main">∥</span> <span class="main">|</span><span class="bound">x</span><span class="main">.</span> <span class="main">∥</span><span class="bound">x</span><span class="main">∥</span> <span class="main">=</span> <span class="main">1</span><span class="main">}</span> <span class="main">∪</span> <span class="main">{</span><span class="main">0</span><span class="main">}</span>›</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
    <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">‹Sup <span class="main">{</span><span class="main">∥</span><span class="free">f</span> <span class="keyword1">*<span class="hidden">⇩</span><sub>v</sub></span> <span class="bound">x</span><span class="main">∥</span> <span class="main">/</span> <span class="main">∥</span><span class="bound">x</span><span class="main">∥</span> <span class="main">|</span><span class="bound">x</span><span class="main">.</span> True<span class="main">}</span> <span class="main">=</span> Sup <span class="main">(</span><span class="main">{</span><span class="main">∥</span><span class="free">f</span> <span class="keyword1">*<span class="hidden">⇩</span><sub>v</sub></span> <span class="bound">x</span><span class="main">∥</span> <span class="main">|</span><span class="bound">x</span><span class="main">.</span> <span class="main">∥</span><span class="bound">x</span><span class="main">∥</span> <span class="main">=</span> <span class="main">1</span><span class="main">}</span> <span class="main">∪</span> <span class="main">{</span><span class="main">0</span><span class="main">}</span><span class="main">)</span>›</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">⋀</span><span class="bound">r</span> <span class="bound">s</span><span class="main">.</span> <span class="main">¬</span> <span class="main">(</span><span class="bound">r</span><span class="main">::</span>real<span class="main">)</span> <span class="main">≤</span> <span class="bound">s</span> <span class="main">∨</span> sup <span class="bound">r</span> <span class="bound">s</span> <span class="main">=</span> <span class="bound">s</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> <span class="main"><span class="main">(</span></span>lifting<span class="main"><span class="main">)</span></span> sup.absorb_iff1 sup_commute<span class="main">)</span>
    <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">‹Sup <span class="main">(</span><span class="main">{</span><span class="main">∥</span><span class="free">f</span> <span class="keyword1">*<span class="hidden">⇩</span><sub>v</sub></span> <span class="bound">x</span><span class="main">∥</span> <span class="main">|</span><span class="bound">x</span><span class="main">.</span> <span class="main">∥</span><span class="bound">x</span><span class="main">∥</span> <span class="main">=</span> <span class="main">1</span><span class="main">}</span> <span class="main">∪</span> <span class="main">{</span><span class="main">(</span><span class="main">0</span><span class="main">::</span>real<span class="main">)</span><span class="main">}</span><span class="main">)</span>
             <span class="main">=</span> max <span class="main">(</span>Sup <span class="main">{</span><span class="main">∥</span><span class="free">f</span> <span class="keyword1">*<span class="hidden">⇩</span><sub>v</sub></span> <span class="bound">x</span><span class="main">∥</span> <span class="main">|</span><span class="bound">x</span><span class="main">.</span> <span class="main">∥</span><span class="bound">x</span><span class="main">∥</span> <span class="main">=</span> <span class="main">1</span><span class="main">}</span><span class="main">)</span> <span class="main">(</span>Sup <span class="main">{</span><span class="main">0</span><span class="main">::</span>real<span class="main">}</span><span class="main">)</span>›</span></span>
      <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="main">0</span> <span class="main">≤</span> Sup <span class="main">{</span><span class="main">∥</span><span class="free">f</span> <span class="keyword1">*<span class="hidden">⇩</span><sub>v</sub></span> <span class="bound">x</span><span class="main">∥</span> <span class="main">|</span><span class="bound">x</span><span class="main">.</span> <span class="main">∥</span><span class="bound">x</span><span class="main">∥</span> <span class="main">=</span> <span class="main">1</span><span class="main">}</span>›</span></span> <span class="quoted"><span class="quoted">‹bdd_above <span class="main">{</span><span class="main">0</span><span class="main">}</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="main">{</span><span class="main">0</span><span class="main">}</span> <span class="main">≠</span> <span class="main">{}</span>›</span></span> cSup_singleton 
        cSup_union_distrib max.absorb_iff1 sup_commute norm_1_bounded norm_1_non_empty
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> <span class="main"><span class="main">(</span></span>no_types<span class="main"><span class="main">,</span></span> lifting<span class="main"><span class="main">)</span></span> <span class="main">)</span>
    <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹Sup <span class="main">{</span><span class="main">(</span><span class="main">0</span><span class="main">::</span>real<span class="main">)</span><span class="main">}</span> <span class="main">=</span> <span class="main">(</span><span class="main">0</span><span class="main">::</span>real<span class="main">)</span>›</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>          
    <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹Sup <span class="main">(</span><span class="main">{</span><span class="main">∥</span><span class="free">f</span> <span class="keyword1">*<span class="hidden">⇩</span><sub>v</sub></span> <span class="bound">x</span><span class="main">∥</span> <span class="main">|</span><span class="bound">x</span><span class="main">.</span> <span class="main">∥</span><span class="bound">x</span><span class="main">∥</span> <span class="main">=</span> <span class="main">1</span><span class="main">}</span> <span class="main">∪</span> <span class="main">{</span><span class="main">0</span><span class="main">}</span><span class="main">)</span> <span class="main">=</span> Sup <span class="main">{</span><span class="main">∥</span><span class="free">f</span> <span class="keyword1">*<span class="hidden">⇩</span><sub>v</sub></span> <span class="bound">x</span><span class="main">∥</span> <span class="main">|</span><span class="bound">x</span><span class="main">.</span> <span class="main">∥</span><span class="bound">x</span><span class="main">∥</span> <span class="main">=</span> <span class="main">1</span><span class="main">}</span>›</span></span>
      <span class="keyword1"><span class="command">using</span></span> Sup_non_neg <span class="keyword1"><span class="command">by</span></span> <span class="operator">linarith</span>
    <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹Sup <span class="main">(</span> <span class="main">{</span><span class="main">∥</span><span class="free">f</span> <span class="keyword1">*<span class="hidden">⇩</span><sub>v</sub></span> <span class="bound">x</span><span class="main">∥</span> <span class="main">|</span><span class="bound">x</span><span class="main">.</span> <span class="main">∥</span><span class="bound">x</span><span class="main">∥</span> <span class="main">=</span> <span class="main">1</span><span class="main">}</span> <span class="main">∪</span> <span class="main">{</span><span class="main">0</span><span class="main">}</span><span class="main">)</span> 
                    <span class="main">=</span> max <span class="main">(</span>Sup <span class="main">{</span><span class="main">∥</span><span class="free">f</span> <span class="keyword1">*<span class="hidden">⇩</span><sub>v</sub></span> <span class="bound">x</span><span class="main">∥</span> <span class="main">|</span><span class="bound">x</span><span class="main">.</span> <span class="main">∥</span><span class="bound">x</span><span class="main">∥</span> <span class="main">=</span> <span class="main">1</span><span class="main">}</span><span class="main">)</span> <span class="main">(</span>Sup <span class="main">{</span><span class="main">0</span><span class="main">}</span><span class="main">)</span> ›</span></span>
      <span class="keyword1"><span class="command">using</span></span> Sup_non_neg  <span class="quoted"><span class="quoted">‹Sup <span class="main">(</span><span class="main">{</span><span class="main">∥</span><span class="free">f</span> <span class="keyword1">*<span class="hidden">⇩</span><sub>v</sub></span> <span class="bound">x</span><span class="main">∥</span> <span class="main">|</span><span class="bound">x</span><span class="main">.</span> <span class="main">∥</span><span class="bound">x</span><span class="main">∥</span> <span class="main">=</span> <span class="main">1</span><span class="main">}</span> <span class="main">∪</span> <span class="main">{</span><span class="main">0</span><span class="main">}</span><span class="main">)</span> 
        <span class="main">=</span> max <span class="main">(</span>Sup <span class="main">{</span><span class="main">∥</span><span class="free">f</span> <span class="keyword1">*<span class="hidden">⇩</span><sub>v</sub></span> <span class="bound">x</span><span class="main">∥</span> <span class="main">|</span><span class="bound">x</span><span class="main">.</span> <span class="main">∥</span><span class="bound">x</span><span class="main">∥</span> <span class="main">=</span> <span class="main">1</span><span class="main">}</span><span class="main">)</span> <span class="main">(</span>Sup <span class="main">{</span><span class="main">0</span><span class="main">}</span><span class="main">)</span>›</span></span> 
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>           
    <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> f2<span class="main">:</span> <span class="quoted"><span class="quoted">‹Sup <span class="main">{</span><span class="main">∥</span><span class="free">f</span> <span class="keyword1">*<span class="hidden">⇩</span><sub>v</sub></span> <span class="bound">x</span><span class="main">∥</span> <span class="main">/</span> <span class="main">∥</span><span class="bound">x</span><span class="main">∥</span> <span class="main">|</span> <span class="bound">x</span><span class="main">.</span> True<span class="main">}</span> <span class="main">=</span> Sup <span class="main">{</span><span class="main">∥</span><span class="free">f</span> <span class="keyword1">*<span class="hidden">⇩</span><sub>v</sub></span> <span class="bound">x</span><span class="main">∥</span> <span class="main">|</span> <span class="bound">x</span><span class="main">.</span> <span class="main">∥</span><span class="bound">x</span><span class="main">∥</span> <span class="main">=</span> <span class="main">1</span><span class="main">}</span>›</span></span>
      <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹Sup <span class="main">{</span><span class="main">∥</span><span class="free">f</span> <span class="keyword1">*<span class="hidden">⇩</span><sub>v</sub></span> <span class="bound">x</span><span class="main">∥</span> <span class="main">/</span> <span class="main">∥</span><span class="bound">x</span><span class="main">∥</span> <span class="main">|</span><span class="bound">x</span><span class="main">.</span> True<span class="main">}</span> <span class="main">=</span> Sup <span class="main">(</span><span class="main">{</span><span class="main">∥</span><span class="free">f</span> <span class="keyword1">*<span class="hidden">⇩</span><sub>v</sub></span> <span class="bound">x</span><span class="main">∥</span> <span class="main">|</span><span class="bound">x</span><span class="main">.</span> <span class="main">∥</span><span class="bound">x</span><span class="main">∥</span> <span class="main">=</span> <span class="main">1</span><span class="main">}</span> <span class="main">∪</span> <span class="main">{</span><span class="main">0</span><span class="main">}</span><span class="main">)</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">linarith</span>
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹<span class="main">(</span><span class="keyword1">SUP</span> <span class="bound">x</span><span class="main">.</span> <span class="main">∥</span><span class="free">f</span> <span class="keyword1">*<span class="hidden">⇩</span><sub>v</sub></span> <span class="bound">x</span><span class="main">∥</span> <span class="main">/</span> <span class="main">∥</span><span class="bound">x</span><span class="main">∥</span><span class="main">)</span> <span class="main">=</span> Sup <span class="main">{</span><span class="main">∥</span><span class="free">f</span> <span class="keyword1">*<span class="hidden">⇩</span><sub>v</sub></span> <span class="bound">x</span><span class="main">∥</span> <span class="main">|</span> <span class="bound">x</span><span class="main">.</span> <span class="main">∥</span><span class="bound">x</span><span class="main">∥</span> <span class="main">=</span> <span class="main">1</span><span class="main">}</span>›</span></span>
      <span class="keyword1"><span class="command">using</span></span> f1 f2 <span class="keyword1"><span class="command">by</span></span> <span class="operator">linarith</span>
    <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">‹<span class="main">(</span><span class="keyword1">SUP</span> <span class="bound">x</span><span class="main">.</span> <span class="main">∥</span><span class="free">f</span> <span class="keyword1">*<span class="hidden">⇩</span><sub>v</sub></span> <span class="bound">x</span><span class="main">∥</span> <span class="main">/</span> <span class="main">∥</span><span class="bound">x</span><span class="main">∥</span><span class="main">)</span> <span class="main">=</span> Sup <span class="main">{</span><span class="main">∥</span><span class="free">f</span> <span class="keyword1">*<span class="hidden">⇩</span><sub>v</sub></span> <span class="bound">x</span><span class="main">∥</span> <span class="main">|</span> <span class="bound">x</span><span class="main">.</span> <span class="main">∥</span><span class="bound">x</span><span class="main">∥</span> <span class="main">&lt;</span> <span class="main">1</span> <span class="main">}</span>›</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> <span class="quoted"><span class="quoted">‹Sup <span class="main">{</span><span class="main">∥</span><span class="free">f</span> <span class="keyword1">*<span class="hidden">⇩</span><sub>v</sub></span> <span class="bound">x</span><span class="main">∥</span> <span class="main">|</span><span class="bound">x</span><span class="main">.</span> <span class="main">∥</span><span class="bound">x</span><span class="main">∥</span> <span class="main">=</span> <span class="main">1</span><span class="main">}</span> <span class="main">=</span> Sup <span class="main">{</span><span class="main">∥</span><span class="free">f</span> <span class="keyword1">*<span class="hidden">⇩</span><sub>v</sub></span> <span class="bound">x</span><span class="main">∥</span> <span class="main">|</span><span class="bound">x</span><span class="main">.</span> <span class="main">∥</span><span class="bound">x</span><span class="main">∥</span> <span class="main">&lt;</span> <span class="main">1</span><span class="main">}</span>›</span></span><span class="main">)</span>        
    <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="operator">transfer</span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> onorm_def<span class="main">)</span> 
  <span class="keyword1"><span class="command">qed</span></span>      
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">lemma</span></span> onorm_r<span class="main">:</span>
  <span class="keyword2"><span class="keyword">includes</span></span> notation_norm
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">‹<span class="free">r</span> <span class="main">&gt;</span> <span class="main">0</span>›</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">‹<span class="main">∥</span><span class="free">f</span><span class="main">∥</span> <span class="main">=</span> Sup <span class="main">(</span><span class="main">(</span><span class="main">λ</span><span class="bound">x</span><span class="main">.</span> <span class="main">∥</span><span class="free">f</span> <span class="keyword1">*<span class="hidden">⇩</span><sub>v</sub></span> <span class="bound">x</span><span class="main">∥</span><span class="main">)</span> <span class="main">`</span> <span class="main">(</span>ball <span class="main">0</span> <span class="free">r</span><span class="main">)</span><span class="main">)</span> <span class="main">/</span> <span class="free">r</span>›</span></span>
  <span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹
  Explanation: The norm of <span class="antiquoted"><span class="antiquoted"><span class="operator"><span class="operator"><span class="hidden">\&lt;^</span><span class="control">term</span><span class="hidden">&gt;</span></span></span><span class="quoted"><span class="quoted">‹<span class="free"><span class="free">f</span></span>›</span></span></span></span> is <span class="antiquoted"><span class="antiquoted"><span class="operator"><span class="operator"><span class="hidden">\&lt;^</span><span class="control">term</span><span class="hidden">&gt;</span></span></span><span class="quoted"><span class="quoted">‹<span class="main"><span class="main">1</span></span><span class="main"><span class="main">/</span></span><span class="free"><span class="free">r</span></span>›</span></span></span></span> of the supremum of the norm of <span class="antiquoted"><span class="antiquoted"><span class="operator"><span class="operator"><span class="hidden">\&lt;^</span><span class="control">term</span><span class="hidden">&gt;</span></span></span><span class="quoted"><span class="quoted">‹<span class="free"><span class="free">f</span></span> <span class="keyword1"><span class="keyword1">*<span class="hidden">⇩</span><sub>v</sub></span></span> <span class="free"><span class="free">x</span></span>›</span></span></span></span> for
  <span class="antiquoted"><span class="antiquoted"><span class="operator"><span class="operator"><span class="hidden">\&lt;^</span><span class="control">term</span><span class="hidden">&gt;</span></span></span><span class="quoted"><span class="quoted">‹<span class="free"><span class="free">x</span></span>›</span></span></span></span> in the ball of radius <span class="antiquoted"><span class="antiquoted"><span class="operator"><span class="operator"><span class="hidden">\&lt;^</span><span class="control">term</span><span class="hidden">&gt;</span></span></span><span class="quoted"><span class="quoted">‹<span class="free"><span class="free">r</span></span>›</span></span></span></span> centered at the origin.
›</span></span>
<span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹<span class="main">∥</span><span class="free">f</span><span class="main">∥</span> <span class="main">=</span> Sup <span class="main">{</span><span class="main">∥</span><span class="free">f</span> <span class="keyword1">*<span class="hidden">⇩</span><sub>v</sub></span> <span class="bound">x</span><span class="main">∥</span> <span class="main">|</span><span class="bound">x</span><span class="main">.</span> <span class="main">∥</span><span class="bound">x</span><span class="main">∥</span> <span class="main">&lt;</span> <span class="main">1</span><span class="main">}</span>›</span></span>
    <span class="keyword1"><span class="command">using</span></span> onorm_open_ball <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹<span class="main">{</span><span class="main">∥</span><span class="free">f</span> <span class="keyword1">*<span class="hidden">⇩</span><sub>v</sub></span> <span class="bound">x</span><span class="main">∥</span> <span class="main">|</span><span class="bound">x</span><span class="main">.</span> <span class="main">∥</span><span class="bound">x</span><span class="main">∥</span> <span class="main">&lt;</span> <span class="main">1</span><span class="main">}</span> <span class="main">=</span> <span class="main">(</span><span class="main">λ</span><span class="bound">x</span><span class="main">.</span> <span class="main">∥</span><span class="free">f</span> <span class="keyword1">*<span class="hidden">⇩</span><sub>v</sub></span> <span class="bound">x</span><span class="main">∥</span><span class="main">)</span> <span class="main">`</span> <span class="main">(</span>ball <span class="main">0</span> <span class="main">1</span><span class="main">)</span>›</span></span>
    <span class="keyword1"><span class="command">unfolding</span></span> ball_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> onorm_f<span class="main">:</span> <span class="quoted"><span class="quoted">‹<span class="main">∥</span><span class="free">f</span><span class="main">∥</span> <span class="main">=</span> Sup <span class="main">(</span><span class="main">(</span><span class="main">λ</span><span class="bound">x</span><span class="main">.</span> <span class="main">∥</span><span class="free">f</span> <span class="keyword1">*<span class="hidden">⇩</span><sub>v</sub></span> <span class="bound">x</span><span class="main">∥</span><span class="main">)</span> <span class="main">`</span> <span class="main">(</span>ball <span class="main">0</span> <span class="main">1</span><span class="main">)</span><span class="main">)</span>›</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">have</span></span> s2<span class="main">:</span> <span class="quoted"><span class="quoted">‹<span class="skolem">x</span> <span class="main">∈</span> <span class="main">(</span><span class="main">λ</span><span class="bound">t</span><span class="main">.</span> <span class="free">r</span> <span class="keyword1">*<span class="hidden">⇩</span><sub>R</sub></span> <span class="main">∥</span><span class="free">f</span> <span class="keyword1">*<span class="hidden">⇩</span><sub>v</sub></span> <span class="bound">t</span><span class="main">∥</span><span class="main">)</span> <span class="main">`</span> ball <span class="main">0</span> <span class="main">1</span> <span class="main">⟹</span> <span class="skolem">x</span> <span class="main">≤</span> <span class="free">r</span> <span class="main">*</span> Sup <span class="main">(</span><span class="main">(</span><span class="main">λ</span><span class="bound">t</span><span class="main">.</span> <span class="main">∥</span><span class="free">f</span> <span class="keyword1">*<span class="hidden">⇩</span><sub>v</sub></span> <span class="bound">t</span><span class="main">∥</span><span class="main">)</span> <span class="main">`</span> ball <span class="main">0</span> <span class="main">1</span><span class="main">)</span>›</span></span> <span class="keyword2"><span class="keyword">for</span></span> <span class="skolem">x</span>
  <span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
    <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">x</span> <span class="main">∈</span> <span class="main">(</span><span class="main">λ</span><span class="bound">t</span><span class="main">.</span> <span class="free">r</span> <span class="keyword1">*<span class="hidden">⇩</span><sub>R</sub></span> <span class="main">∥</span><span class="free">f</span> <span class="keyword1">*<span class="hidden">⇩</span><sub>v</sub></span> <span class="bound">t</span><span class="main">∥</span><span class="main">)</span> <span class="main">`</span> ball <span class="main">0</span> <span class="main">1</span>›</span></span>
    <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">‹<span class="main">∃</span> <span class="bound">t</span><span class="main">.</span> <span class="skolem">x</span> <span class="main">=</span> <span class="free">r</span> <span class="keyword1">*<span class="hidden">⇩</span><sub>R</sub></span> <span class="main">∥</span><span class="free">f</span> <span class="keyword1">*<span class="hidden">⇩</span><sub>v</sub></span> <span class="bound">t</span><span class="main">∥</span> <span class="main">∧</span> <span class="main">∥</span><span class="bound">t</span><span class="main">∥</span> <span class="main">&lt;</span> <span class="main">1</span>›</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">t</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">x</span> <span class="main">=</span> <span class="free">r</span> <span class="keyword1">*<span class="hidden">⇩</span><sub>R</sub></span> <span class="main">∥</span><span class="free">f</span> <span class="keyword1">*<span class="hidden">⇩</span><sub>v</sub></span> <span class="skolem">t</span><span class="main">∥</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹<span class="main">∥</span><span class="skolem">t</span><span class="main">∥</span> <span class="main">&lt;</span> <span class="main">1</span>›</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
    <span class="keyword3"><span class="command">define</span></span> <span class="skolem"><span class="skolem">y</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">y</span> <span class="main">=</span> <span class="skolem">x</span> <span class="keyword1">/<span class="hidden">⇩</span><sub>R</sub></span> <span class="free">r</span>›</span></span>
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">x</span> <span class="main">=</span> <span class="free">r</span> <span class="main">*</span> <span class="main">(</span>inverse <span class="free">r</span> <span class="main">*</span> <span class="skolem">x</span><span class="main">)</span>›</span></span>
      <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">x</span> <span class="main">=</span> <span class="free">r</span> <span class="keyword1">*<span class="hidden">⇩</span><sub>R</sub></span> norm <span class="main">(</span><span class="free">f</span> <span class="skolem">t</span><span class="main">)</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">x</span> <span class="main">-</span> <span class="main">(</span><span class="free">r</span> <span class="main">*</span> <span class="main">(</span>inverse <span class="free">r</span> <span class="main">*</span> <span class="skolem">x</span><span class="main">)</span><span class="main">)</span> <span class="main">≤</span> <span class="main">0</span>›</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">linarith</span>
    <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">x</span> <span class="main">≤</span> <span class="free">r</span> <span class="main">*</span> <span class="main">(</span><span class="skolem">x</span> <span class="keyword1">/<span class="hidden">⇩</span><sub>R</sub></span> <span class="free">r</span><span class="main">)</span>›</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">y</span> <span class="main">∈</span> <span class="main">(</span><span class="main">λ</span><span class="bound">k</span><span class="main">.</span> <span class="main">∥</span><span class="free">f</span> <span class="keyword1">*<span class="hidden">⇩</span><sub>v</sub></span> <span class="bound">k</span><span class="main">∥</span><span class="main">)</span> <span class="main">`</span> ball <span class="main">0</span> <span class="main">1</span>›</span></span>
      <span class="keyword1"><span class="command">unfolding</span></span> y_def <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">smt</span> <span class="quoted"><span class="quoted">‹<span class="skolem">x</span> <span class="main">∈</span> <span class="main">(</span><span class="main">λ</span><span class="bound">t</span><span class="main">.</span> <span class="free">r</span> <span class="keyword1">*<span class="hidden">⇩</span><sub>R</sub></span> <span class="main">∥</span><span class="free">f</span> <span class="keyword1">*<span class="hidden">⇩</span><sub>v</sub></span> <span class="bound">t</span><span class="main">∥</span><span class="main">)</span> <span class="main">`</span> ball <span class="main">0</span> <span class="main">1</span>›</span></span> assms image_iff 
          inverse_inverse_eq pos_le_divideR_eq positive_imp_inverse_positive<span class="main">)</span> 
    <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">x</span> <span class="main">≤</span> <span class="free">r</span> <span class="main">*</span> <span class="skolem">y</span>›</span></span>          
      <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">x</span> <span class="main">≤</span> <span class="free">r</span> <span class="main">*</span> <span class="main">(</span><span class="skolem">x</span> <span class="keyword1">/<span class="hidden">⇩</span><sub>R</sub></span> <span class="free">r</span><span class="main">)</span>›</span></span> y_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
    <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> y_norm_f<span class="main">:</span> <span class="quoted"><span class="quoted">‹<span class="skolem">y</span> <span class="main">∈</span> <span class="main">(</span><span class="main">λ</span><span class="bound">t</span><span class="main">.</span> <span class="main">∥</span><span class="free">f</span> <span class="keyword1">*<span class="hidden">⇩</span><sub>v</sub></span> <span class="bound">t</span><span class="main">∥</span><span class="main">)</span> <span class="main">`</span> ball <span class="main">0</span> <span class="main">1</span> <span class="main">∧</span> <span class="skolem">x</span> <span class="main">≤</span> <span class="free">r</span> <span class="main">*</span> <span class="skolem">y</span>›</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹<span class="main">(</span><span class="main">λ</span><span class="bound">t</span><span class="main">.</span> <span class="main">∥</span><span class="free">f</span> <span class="keyword1">*<span class="hidden">⇩</span><sub>v</sub></span> <span class="bound">t</span><span class="main">∥</span><span class="main">)</span> <span class="main">`</span> ball <span class="main">0</span> <span class="main">1</span> <span class="main">≠</span> <span class="main">{}</span>›</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>        
    <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹bdd_above <span class="main">(</span><span class="main">(</span><span class="main">λ</span><span class="bound">t</span><span class="main">.</span> <span class="main">∥</span><span class="free">f</span> <span class="keyword1">*<span class="hidden">⇩</span><sub>v</sub></span> <span class="bound">t</span><span class="main">∥</span><span class="main">)</span> <span class="main">`</span> ball <span class="main">0</span> <span class="main">1</span><span class="main">)</span>›</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> bounded_linear_image blinfun.bounded_linear_right bounded_imp_bdd_above 
          bounded_norm_comp<span class="main">)</span> 
    <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹<span class="main">∃</span> <span class="bound">y</span><span class="main">.</span> <span class="bound">y</span> <span class="main">∈</span> <span class="main">(</span><span class="main">λ</span><span class="bound">t</span><span class="main">.</span> <span class="main">∥</span><span class="free">f</span> <span class="keyword1">*<span class="hidden">⇩</span><sub>v</sub></span> <span class="bound">t</span><span class="main">∥</span><span class="main">)</span> <span class="main">`</span> ball <span class="main">0</span> <span class="main">1</span> <span class="main">∧</span> <span class="skolem">x</span> <span class="main">≤</span> <span class="free">r</span> <span class="main">*</span> <span class="bound">y</span>›</span></span>
      <span class="keyword1"><span class="command">using</span></span> y_norm_f <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
    <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">smt</span> <span class="quoted"><span class="quoted">‹<span class="main">0</span> <span class="main">&lt;</span> <span class="free">r</span>›</span></span> cSup_upper ordered_comm_semiring_class.comm_mult_left_mono<span class="main">)</span> 
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">have</span></span> s3<span class="main">:</span> <span class="quoted"><span class="quoted">‹<span class="main">(</span><span class="main">⋀</span><span class="bound">x</span><span class="main">.</span> <span class="bound">x</span> <span class="main">∈</span> <span class="main">(</span><span class="main">λ</span><span class="bound">t</span><span class="main">.</span> <span class="free">r</span> <span class="main">*</span> <span class="main">∥</span><span class="free">f</span> <span class="keyword1">*<span class="hidden">⇩</span><sub>v</sub></span> <span class="bound">t</span><span class="main">∥</span><span class="main">)</span> <span class="main">`</span> ball <span class="main">0</span> <span class="main">1</span> <span class="main">⟹</span> <span class="bound">x</span> <span class="main">≤</span> <span class="skolem">y</span><span class="main">)</span> <span class="main">⟹</span>
         <span class="free">r</span> <span class="main">*</span> Sup <span class="main">(</span><span class="main">(</span><span class="main">λ</span><span class="bound">t</span><span class="main">.</span> <span class="main">∥</span><span class="free">f</span> <span class="keyword1">*<span class="hidden">⇩</span><sub>v</sub></span> <span class="bound">t</span><span class="main">∥</span><span class="main">)</span> <span class="main">`</span> ball <span class="main">0</span> <span class="main">1</span><span class="main">)</span> <span class="main">≤</span> <span class="skolem">y</span>›</span></span> <span class="keyword2"><span class="keyword">for</span></span> <span class="skolem">y</span>
  <span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
    <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">‹<span class="main">⋀</span><span class="bound">x</span><span class="main">.</span> <span class="bound">x</span> <span class="main">∈</span> <span class="main">(</span><span class="main">λ</span><span class="bound">t</span><span class="main">.</span> <span class="free">r</span> <span class="main">*</span> <span class="main">∥</span><span class="free">f</span> <span class="keyword1">*<span class="hidden">⇩</span><sub>v</sub></span> <span class="bound">t</span><span class="main">∥</span><span class="main">)</span> <span class="main">`</span> ball <span class="main">0</span> <span class="main">1</span> <span class="main">⟹</span> <span class="bound">x</span> <span class="main">≤</span> <span class="skolem">y</span>›</span></span> 
    <span class="keyword1"><span class="command">have</span></span> x_leq<span class="main">:</span> <span class="quoted"><span class="quoted">‹<span class="skolem">x</span> <span class="main">∈</span> <span class="main">(</span><span class="main">λ</span><span class="bound">t</span><span class="main">.</span> <span class="main">∥</span><span class="free">f</span> <span class="keyword1">*<span class="hidden">⇩</span><sub>v</sub></span> <span class="bound">t</span><span class="main">∥</span><span class="main">)</span> <span class="main">`</span> ball <span class="main">0</span> <span class="main">1</span> <span class="main">⟹</span> <span class="skolem">x</span> <span class="main">≤</span> <span class="skolem">y</span> <span class="main">/</span> <span class="free">r</span>›</span></span> <span class="keyword2"><span class="keyword">for</span></span> <span class="skolem">x</span>
    <span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
      <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">x</span> <span class="main">∈</span> <span class="main">(</span><span class="main">λ</span><span class="bound">t</span><span class="main">.</span> <span class="main">∥</span><span class="free">f</span> <span class="keyword1">*<span class="hidden">⇩</span><sub>v</sub></span> <span class="bound">t</span><span class="main">∥</span><span class="main">)</span> <span class="main">`</span> ball <span class="main">0</span> <span class="main">1</span>›</span></span>
      <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">t</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">t</span> <span class="main">∈</span> ball <span class="main">(</span><span class="main">0</span><span class="main">::</span><span class="tfree">'a</span><span class="main">)</span> <span class="main">1</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">x</span> <span class="main">=</span> <span class="main">∥</span><span class="free">f</span> <span class="keyword1">*<span class="hidden">⇩</span><sub>v</sub></span> <span class="skolem">t</span><span class="main">∥</span>›</span></span>
        <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword3"><span class="command">define</span></span> <span class="skolem"><span class="skolem">x'</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">x'</span> <span class="main">=</span> <span class="free">r</span> <span class="keyword1">*<span class="hidden">⇩</span><sub>R</sub></span> <span class="skolem">x</span>›</span></span>
      <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">x'</span> <span class="main">=</span> <span class="free">r</span> <span class="main">*</span> <span class="main">∥</span><span class="free">f</span> <span class="keyword1">*<span class="hidden">⇩</span><sub>v</sub></span> <span class="skolem">t</span><span class="main">∥</span>›</span></span>
        <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">x</span> <span class="main">=</span> <span class="main">∥</span><span class="free">f</span> <span class="keyword1">*<span class="hidden">⇩</span><sub>v</sub></span> <span class="skolem">t</span><span class="main">∥</span>›</span></span> x'_def<span class="main">)</span>
      <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">x'</span> <span class="main">∈</span> <span class="main">(</span><span class="main">λ</span><span class="bound">t</span><span class="main">.</span> <span class="free">r</span> <span class="main">*</span> <span class="main">∥</span><span class="free">f</span> <span class="keyword1">*<span class="hidden">⇩</span><sub>v</sub></span> <span class="bound">t</span><span class="main">∥</span><span class="main">)</span> <span class="main">`</span> ball <span class="main">0</span> <span class="main">1</span>›</span></span>
        <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">t</span> <span class="main">∈</span> ball <span class="main">(</span><span class="main">0</span><span class="main">::</span><span class="tfree">'a</span><span class="main">)</span> <span class="main">1</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">x'</span> <span class="main">≤</span> <span class="skolem">y</span>›</span></span>
        <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="main">⋀</span><span class="bound">x</span><span class="main">.</span> <span class="bound">x</span> <span class="main">∈</span> <span class="main">(</span><span class="main">λ</span><span class="bound">t</span><span class="main">.</span> <span class="free">r</span> <span class="main">*</span> <span class="main">∥</span><span class="free">f</span> <span class="keyword1">*<span class="hidden">⇩</span><sub>v</sub></span> <span class="bound">t</span><span class="main">∥</span><span class="main">)</span> <span class="main">`</span> ball <span class="main">0</span> <span class="main">1</span> <span class="main">⟹</span> <span class="bound">x</span> <span class="main">≤</span> <span class="skolem">y</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>        
      <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">x</span> <span class="main">≤</span> <span class="skolem">y</span> <span class="main">/</span> <span class="free">r</span>›</span></span>
        <span class="keyword1"><span class="command">unfolding</span></span> x'_def <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="free">r</span> <span class="main">&gt;</span> <span class="main">0</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> mult.commute pos_le_divide_eq<span class="main">)</span> 
    <span class="keyword1"><span class="command">qed</span></span>
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹<span class="main">(</span><span class="main">λ</span><span class="bound">t</span><span class="main">.</span> <span class="main">∥</span><span class="free">f</span> <span class="keyword1">*<span class="hidden">⇩</span><sub>v</sub></span> <span class="bound">t</span><span class="main">∥</span><span class="main">)</span> <span class="main">`</span> ball <span class="main">0</span> <span class="main">1</span> <span class="main">≠</span> <span class="main">{}</span>›</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>        
    <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹bdd_above <span class="main">(</span><span class="main">(</span><span class="main">λ</span><span class="bound">t</span><span class="main">.</span> <span class="main">∥</span><span class="free">f</span> <span class="keyword1">*<span class="hidden">⇩</span><sub>v</sub></span> <span class="bound">t</span><span class="main">∥</span><span class="main">)</span> <span class="main">`</span> ball <span class="main">0</span> <span class="main">1</span><span class="main">)</span>›</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> bounded_linear_image blinfun.bounded_linear_right bounded_imp_bdd_above 
          bounded_norm_comp<span class="main">)</span> 
    <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹Sup <span class="main">(</span><span class="main">(</span><span class="main">λ</span><span class="bound">t</span><span class="main">.</span> <span class="main">∥</span><span class="free">f</span> <span class="keyword1">*<span class="hidden">⇩</span><sub>v</sub></span> <span class="bound">t</span><span class="main">∥</span><span class="main">)</span> <span class="main">`</span> ball <span class="main">0</span> <span class="main">1</span><span class="main">)</span> <span class="main">≤</span> <span class="skolem">y</span><span class="main">/</span><span class="free">r</span>›</span></span>
      <span class="keyword1"><span class="command">using</span></span> x_leq <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> <span class="quoted"><span class="quoted">‹bdd_above <span class="main">(</span><span class="main">(</span><span class="main">λ</span><span class="bound">t</span><span class="main">.</span> <span class="main">∥</span><span class="free">f</span> <span class="keyword1">*<span class="hidden">⇩</span><sub>v</sub></span> <span class="bound">t</span><span class="main">∥</span><span class="main">)</span> <span class="main">`</span> ball <span class="main">0</span> <span class="main">1</span><span class="main">)</span>›</span></span> cSup_least<span class="main">)</span> 
    <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="free">r</span> <span class="main">&gt;</span> <span class="main">0</span>›</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">smt</span> divide_strict_right_mono nonzero_mult_div_cancel_left<span class="main">)</span>  
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">have</span></span> norm_scaleR<span class="main">:</span> <span class="quoted"><span class="quoted">‹norm <span class="main">∘</span> <span class="main">(</span><span class="keyword1">(*<span class="hidden">⇩</span><sub>R</sub>)</span> <span class="free">r</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="keyword1">(*<span class="hidden">⇩</span><sub>R</sub>)</span> <span class="main">¦</span><span class="free">r</span><span class="main">¦</span><span class="main">)</span> <span class="main">∘</span> <span class="main">(</span>norm<span class="main">::</span><span class="tfree">'a</span> <span class="main">⇒</span> real<span class="main">)</span>›</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">have</span></span> f_x1<span class="main">:</span> <span class="quoted"><span class="quoted">‹<span class="free">f</span> <span class="main">(</span><span class="free">r</span> <span class="keyword1">*<span class="hidden">⇩</span><sub>R</sub></span> <span class="skolem">x</span><span class="main">)</span> <span class="main">=</span> <span class="free">r</span> <span class="keyword1">*<span class="hidden">⇩</span><sub>R</sub></span> <span class="free">f</span> <span class="skolem">x</span>›</span></span> <span class="keyword2"><span class="keyword">for</span></span> <span class="skolem">x</span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> blinfun.scaleR_right<span class="main">)</span>    
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹ball <span class="main">(</span><span class="main">0</span><span class="main">::</span><span class="tfree">'a</span><span class="main">)</span> <span class="free">r</span> <span class="main">=</span> <span class="main">(</span><span class="keyword1">(*<span class="hidden">⇩</span><sub>R</sub>)</span> <span class="free">r</span><span class="main">)</span> <span class="main">`</span> <span class="main">(</span>ball <span class="main">0</span> <span class="main">1</span><span class="main">)</span>›</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">smt</span> assms ball_scale nonzero_mult_div_cancel_left right_inverse_eq scale_zero_right<span class="main">)</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">‹Sup <span class="main">(</span><span class="main">(</span><span class="main">λ</span><span class="bound">t</span><span class="main">.</span> <span class="main">∥</span><span class="free">f</span> <span class="keyword1">*<span class="hidden">⇩</span><sub>v</sub></span> <span class="bound">t</span><span class="main">∥</span><span class="main">)</span> <span class="main">`</span> <span class="main">(</span>ball <span class="main">0</span> <span class="free">r</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> Sup <span class="main">(</span><span class="main">(</span><span class="main">λ</span><span class="bound">t</span><span class="main">.</span> <span class="main">∥</span><span class="free">f</span> <span class="keyword1">*<span class="hidden">⇩</span><sub>v</sub></span> <span class="bound">t</span><span class="main">∥</span><span class="main">)</span> <span class="main">`</span> <span class="main">(</span><span class="main">(</span><span class="keyword1">(*<span class="hidden">⇩</span><sub>R</sub>)</span> <span class="free">r</span><span class="main">)</span> <span class="main">`</span> <span class="main">(</span>ball <span class="main">0</span> <span class="main">1</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>›</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹<span class="main">…</span> <span class="main">=</span> Sup <span class="main">(</span><span class="main">(</span><span class="main">(</span><span class="main">λ</span><span class="bound">t</span><span class="main">.</span> <span class="main">∥</span><span class="free">f</span> <span class="keyword1">*<span class="hidden">⇩</span><sub>v</sub></span> <span class="bound">t</span><span class="main">∥</span><span class="main">)</span> <span class="main">∘</span> <span class="main">(</span><span class="keyword1">(*<span class="hidden">⇩</span><sub>R</sub>)</span> <span class="free">r</span><span class="main">)</span><span class="main">)</span> <span class="main">`</span> <span class="main">(</span>ball <span class="main">0</span> <span class="main">1</span><span class="main">)</span><span class="main">)</span>›</span></span>
    <span class="keyword1"><span class="command">using</span></span> Sup.SUP_image <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹<span class="main">…</span> <span class="main">=</span> Sup <span class="main">(</span><span class="main">(</span><span class="main">λ</span><span class="bound">t</span><span class="main">.</span> <span class="main">∥</span><span class="free">f</span> <span class="keyword1">*<span class="hidden">⇩</span><sub>v</sub></span> <span class="main">(</span><span class="free">r</span> <span class="keyword1">*<span class="hidden">⇩</span><sub>R</sub></span> <span class="bound">t</span><span class="main">)</span><span class="main">∥</span><span class="main">)</span> <span class="main">`</span> <span class="main">(</span>ball <span class="main">0</span> <span class="main">1</span><span class="main">)</span><span class="main">)</span>›</span></span>
    <span class="keyword1"><span class="command">using</span></span> f_x1 <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> comp_assoc<span class="main">)</span> 
  <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹<span class="main">…</span> <span class="main">=</span> Sup <span class="main">(</span><span class="main">(</span><span class="main">λ</span><span class="bound">t</span><span class="main">.</span> <span class="main">¦</span><span class="free">r</span><span class="main">¦</span> <span class="keyword1">*<span class="hidden">⇩</span><sub>R</sub></span> <span class="main">∥</span><span class="free">f</span> <span class="keyword1">*<span class="hidden">⇩</span><sub>v</sub></span> <span class="bound">t</span><span class="main">∥</span><span class="main">)</span> <span class="main">`</span> <span class="main">(</span>ball <span class="main">0</span> <span class="main">1</span><span class="main">)</span><span class="main">)</span>›</span></span>
    <span class="keyword1"><span class="command">using</span></span> norm_scaleR f_x1 <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span> 
  <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹<span class="main">…</span> <span class="main">=</span> Sup <span class="main">(</span><span class="main">(</span><span class="main">λ</span><span class="bound">t</span><span class="main">.</span> <span class="free">r</span> <span class="keyword1">*<span class="hidden">⇩</span><sub>R</sub></span> <span class="main">∥</span><span class="free">f</span> <span class="keyword1">*<span class="hidden">⇩</span><sub>v</sub></span> <span class="bound">t</span><span class="main">∥</span><span class="main">)</span> <span class="main">`</span> <span class="main">(</span>ball <span class="main">0</span> <span class="main">1</span><span class="main">)</span><span class="main">)</span>›</span></span>
    <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="free">r</span> <span class="main">&gt;</span> <span class="main">0</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹<span class="main">…</span> <span class="main">=</span> <span class="free">r</span> <span class="main">*</span> Sup <span class="main">(</span><span class="main">(</span><span class="main">λ</span><span class="bound">t</span><span class="main">.</span> <span class="main">∥</span><span class="free">f</span> <span class="keyword1">*<span class="hidden">⇩</span><sub>v</sub></span> <span class="bound">t</span><span class="main">∥</span><span class="main">)</span> <span class="main">`</span> <span class="main">(</span>ball <span class="main">0</span> <span class="main">1</span><span class="main">)</span><span class="main">)</span>›</span></span>
    <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">rule</span> cSup_eq_non_empty<span class="main">)</span> <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="operator">simp</span> <span class="keyword1"><span class="command">using</span></span> s2 <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="operator">auto</span> <span class="keyword1"><span class="command">using</span></span> s3 <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹<span class="main">…</span> <span class="main">=</span> <span class="free">r</span> <span class="main">*</span> <span class="main">∥</span><span class="free">f</span><span class="main">∥</span>›</span></span>
    <span class="keyword1"><span class="command">using</span></span> onorm_f <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">finally</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹Sup <span class="main">(</span><span class="main">(</span><span class="main">λ</span><span class="bound">t</span><span class="main">.</span> <span class="main">∥</span><span class="free">f</span> <span class="keyword1">*<span class="hidden">⇩</span><sub>v</sub></span> <span class="bound">t</span><span class="main">∥</span><span class="main">)</span> <span class="main">`</span> ball <span class="main">0</span> <span class="free">r</span><span class="main">)</span> <span class="main">=</span> <span class="free">r</span> <span class="main">*</span> <span class="main">∥</span><span class="free">f</span><span class="main">∥</span>›</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>    
  <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">‹<span class="main">∥</span><span class="free">f</span><span class="main">∥</span> <span class="main">=</span> Sup <span class="main">(</span><span class="main">(</span><span class="main">λ</span><span class="bound">x</span><span class="main">.</span> <span class="main">∥</span><span class="free">f</span> <span class="keyword1">*<span class="hidden">⇩</span><sub>v</sub></span> <span class="bound">x</span><span class="main">∥</span><span class="main">)</span> <span class="main">`</span> <span class="main">(</span>ball <span class="main">0</span> <span class="free">r</span><span class="main">)</span><span class="main">)</span> <span class="main">/</span> <span class="free">r</span>›</span></span> <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="free">r</span> <span class="main">&gt;</span> <span class="main">0</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹Pointwise convergence›</span></span>
<span class="keyword1"><span class="command">definition</span></span> <span class="entity">pointwise_convergent_to</span> <span class="main">::</span> 
  <span class="quoted"><span class="quoted">‹<span class="main">(</span> nat <span class="main">⇒</span> <span class="main">(</span><span class="tfree">'a</span> <span class="main">⇒</span> <span class="tfree">'b</span><span class="main">::</span>topological_space<span class="main">)</span> <span class="main">)</span> <span class="main">⇒</span> <span class="main">(</span><span class="tfree">'a</span> <span class="main">⇒</span> <span class="tfree">'b</span><span class="main">)</span> <span class="main">⇒</span> bool›</span></span> 
  <span class="main">(</span><span class="quoted">‹<span class="keyword3">(</span><span class="keyword3">(</span>_<span class="keyword3">)</span><span class="keyword3">/ </span><span class="keyword1">─pointwise→</span> <span class="keyword3">(</span>_<span class="keyword3">)</span><span class="keyword3">)</span>›</span> <span class="main">[</span>60<span class="main">,</span> 60<span class="main">]</span> 60<span class="main">)</span> <span class="keyword2"><span class="keyword">where</span></span>
  <span class="quoted"><span class="quoted">‹<span class="free">pointwise_convergent_to</span> <span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="free"><span class="bound"><span class="entity">l</span></span></span> <span class="main">=</span> <span class="main">(</span><span class="main">∀</span> <span class="bound">t</span><span class="main">::</span><span class="tfree">'a</span><span class="main">.</span> <span class="main">(</span><span class="main">λ</span> <span class="bound">n</span><span class="main">.</span> <span class="main">(</span><span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="bound">n</span><span class="main">)</span> <span class="bound">t</span><span class="main">)</span> <span class="main">⇢</span> <span class="free"><span class="bound"><span class="entity">l</span></span></span> <span class="bound">t</span><span class="main">)</span>›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> linear_limit_linear<span class="main">:</span>
  <span class="keyword2"><span class="keyword">fixes</span></span> <span class="free">f</span> <span class="main">::</span> <span class="quoted"><span class="quoted">‹<span class="main">_</span> <span class="main">⇒</span> <span class="main">(</span><span class="tfree">'a</span><span class="main">::</span>real_vector <span class="main">⇒</span> <span class="tfree">'b</span><span class="main">::</span>real_normed_vector<span class="main">)</span>›</span></span>
  <span class="keyword2"><span class="keyword">assumes</span></span>  <span class="quoted"><span class="quoted">‹<span class="main">⋀</span><span class="bound">n</span><span class="main">.</span> linear <span class="main">(</span><span class="free">f</span> <span class="bound">n</span><span class="main">)</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹<span class="free">f</span> <span class="keyword1">─pointwise→</span> <span class="free">F</span>›</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">‹linear <span class="free">F</span>›</span></span>
  <span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹
  Explanation: If a family of linear operators converges pointwise, then the limit is also a linear
  operator.
›</span></span>
<span class="keyword1"><span class="command">proof</span></span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="free">F</span> <span class="main">(</span><span class="skolem">x</span> <span class="main">+</span> <span class="skolem">y</span><span class="main">)</span> <span class="main">=</span> <span class="free">F</span> <span class="skolem">x</span> <span class="main">+</span> <span class="free">F</span> <span class="skolem">y</span>"</span></span> <span class="keyword2"><span class="keyword">for</span></span> <span class="skolem">x</span> <span class="skolem">y</span>
  <span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">a</span><span class="main">.</span> <span class="free">F</span> <span class="bound">a</span> <span class="main">=</span> lim <span class="main">(</span><span class="main">λ</span><span class="bound">n</span><span class="main">.</span> <span class="free">f</span> <span class="bound">n</span> <span class="bound">a</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="free">f</span> <span class="keyword1">─pointwise→</span> <span class="free">F</span>›</span></span> <span class="keyword1"><span class="command">unfolding</span></span> pointwise_convergent_to_def <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> <span class="main"><span class="main">(</span></span>full_types<span class="main"><span class="main">)</span></span> limI<span class="main">)</span>
    <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">f</span> <span class="bound">b</span> <span class="bound">c</span> <span class="bound">g</span><span class="main">.</span> <span class="main">(</span>lim <span class="main">(</span><span class="main">λ</span><span class="bound">n</span><span class="main">.</span> <span class="bound">g</span> <span class="bound">n</span> <span class="main">+</span> <span class="bound">f</span> <span class="bound">n</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="bound">b</span><span class="main">::</span><span class="tfree">'b</span><span class="main">)</span> <span class="main">+</span> <span class="bound">c</span> <span class="main">∨</span> <span class="main">¬</span> <span class="bound">f</span> <span class="main">⇢</span> <span class="bound">c</span><span class="main">)</span> <span class="main">∨</span> <span class="main">¬</span> <span class="bound">g</span> <span class="main">⇢</span> <span class="bound">b</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> <span class="main"><span class="main">(</span></span>no_types<span class="main"><span class="main">)</span></span> limI tendsto_add<span class="main">)</span>
    <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">⋀</span><span class="bound">a</span><span class="main">.</span> <span class="main">(</span><span class="main">λ</span><span class="bound">n</span><span class="main">.</span> <span class="free">f</span> <span class="bound">n</span> <span class="bound">a</span><span class="main">)</span> <span class="main">⇢</span> <span class="free">F</span> <span class="bound">a</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>2<span class="main">)</span> pointwise_convergent_to_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">force</span>
    <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> 
      lim_sum<span class="main">:</span> <span class="quoted"><span class="quoted">‹lim <span class="main">(</span><span class="main">λ</span> <span class="bound">n</span><span class="main">.</span> <span class="main">(</span><span class="free">f</span> <span class="bound">n</span><span class="main">)</span> <span class="skolem">x</span> <span class="main">+</span> <span class="main">(</span><span class="free">f</span> <span class="bound">n</span><span class="main">)</span> <span class="skolem">y</span><span class="main">)</span> <span class="main">=</span> lim <span class="main">(</span><span class="main">λ</span> <span class="bound">n</span><span class="main">.</span> <span class="main">(</span><span class="free">f</span> <span class="bound">n</span><span class="main">)</span> <span class="skolem">x</span><span class="main">)</span> <span class="main">+</span> lim <span class="main">(</span><span class="main">λ</span> <span class="bound">n</span><span class="main">.</span> <span class="main">(</span><span class="free">f</span> <span class="bound">n</span><span class="main">)</span> <span class="skolem">y</span><span class="main">)</span>›</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">metis</span>
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹<span class="main">(</span><span class="free">f</span> <span class="skolem">n</span><span class="main">)</span> <span class="main">(</span><span class="skolem">x</span> <span class="main">+</span> <span class="skolem">y</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="free">f</span> <span class="skolem">n</span><span class="main">)</span> <span class="skolem">x</span> <span class="main">+</span> <span class="main">(</span><span class="free">f</span> <span class="skolem">n</span><span class="main">)</span> <span class="skolem">y</span>›</span></span> <span class="keyword2"><span class="keyword">for</span></span> <span class="skolem">n</span>
      <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="main">⋀</span> <span class="bound">n</span><span class="main">.</span>  linear <span class="main">(</span><span class="free">f</span> <span class="bound">n</span><span class="main">)</span>›</span></span> <span class="keyword1"><span class="command">unfolding</span></span> linear_def <span class="keyword1"><span class="command">using</span></span> Real_Vector_Spaces.linear_iff assms<span class="main">(</span>1<span class="main">)</span> 
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">‹lim <span class="main">(</span><span class="main">λ</span> <span class="bound">n</span><span class="main">.</span> <span class="main">(</span><span class="free">f</span> <span class="bound">n</span><span class="main">)</span> <span class="main">(</span><span class="skolem">x</span> <span class="main">+</span> <span class="skolem">y</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> lim <span class="main">(</span><span class="main">λ</span> <span class="bound">n</span><span class="main">.</span> <span class="main">(</span><span class="free">f</span> <span class="bound">n</span><span class="main">)</span> <span class="skolem">x</span> <span class="main">+</span> <span class="main">(</span><span class="free">f</span> <span class="bound">n</span><span class="main">)</span> <span class="skolem">y</span><span class="main">)</span>›</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">‹lim <span class="main">(</span><span class="main">λ</span> <span class="bound">n</span><span class="main">.</span> <span class="main">(</span><span class="free">f</span> <span class="bound">n</span><span class="main">)</span> <span class="main">(</span><span class="skolem">x</span> <span class="main">+</span> <span class="skolem">y</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> lim <span class="main">(</span><span class="main">λ</span> <span class="bound">n</span><span class="main">.</span> <span class="main">(</span><span class="free">f</span> <span class="bound">n</span><span class="main">)</span> <span class="skolem">x</span><span class="main">)</span> <span class="main">+</span> lim <span class="main">(</span><span class="main">λ</span> <span class="bound">n</span><span class="main">.</span> <span class="main">(</span><span class="free">f</span> <span class="bound">n</span><span class="main">)</span> <span class="skolem">y</span><span class="main">)</span>›</span></span>
      <span class="keyword1"><span class="command">using</span></span> lim_sum <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹<span class="main">(</span><span class="main">λ</span> <span class="bound">n</span><span class="main">.</span> <span class="main">(</span><span class="free">f</span> <span class="bound">n</span><span class="main">)</span> <span class="main">(</span><span class="skolem">x</span> <span class="main">+</span> <span class="skolem">y</span><span class="main">)</span><span class="main">)</span> <span class="main">⇢</span> <span class="free">F</span> <span class="main">(</span><span class="skolem">x</span> <span class="main">+</span> <span class="skolem">y</span><span class="main">)</span>›</span></span>
      <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="free">f</span> <span class="keyword1">─pointwise→</span> <span class="free">F</span>›</span></span> <span class="keyword1"><span class="command">unfolding</span></span> pointwise_convergent_to_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
    <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹<span class="main">(</span><span class="main">λ</span> <span class="bound">n</span><span class="main">.</span> <span class="main">(</span><span class="free">f</span> <span class="bound">n</span><span class="main">)</span> <span class="skolem">x</span><span class="main">)</span> <span class="main">⇢</span> <span class="free">F</span> <span class="skolem">x</span>›</span></span>
      <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="free">f</span> <span class="keyword1">─pointwise→</span> <span class="free">F</span>›</span></span> <span class="keyword1"><span class="command">unfolding</span></span> pointwise_convergent_to_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
    <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹<span class="main">(</span><span class="main">λ</span> <span class="bound">n</span><span class="main">.</span> <span class="main">(</span><span class="free">f</span> <span class="bound">n</span><span class="main">)</span> <span class="skolem">y</span><span class="main">)</span> <span class="main">⇢</span> <span class="free">F</span> <span class="skolem">y</span>›</span></span>
      <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="free">f</span> <span class="keyword1">─pointwise→</span> <span class="free">F</span>›</span></span> <span class="keyword1"><span class="command">unfolding</span></span> pointwise_convergent_to_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
    <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> limI<span class="main">)</span> 
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="free">F</span> <span class="main">(</span><span class="skolem">r</span> <span class="keyword1">*<span class="hidden">⇩</span><sub>R</sub></span> <span class="skolem">x</span><span class="main">)</span> <span class="main">=</span> <span class="skolem">r</span> <span class="keyword1">*<span class="hidden">⇩</span><sub>R</sub></span> <span class="free">F</span> <span class="skolem">x</span>"</span></span> <span class="keyword2"><span class="keyword">for</span></span> <span class="skolem">r</span> <span class="keyword2"><span class="keyword">and</span></span> <span class="skolem">x</span>
  <span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹<span class="main">(</span><span class="free">f</span> <span class="skolem">n</span><span class="main">)</span> <span class="main">(</span><span class="skolem">r</span> <span class="keyword1">*<span class="hidden">⇩</span><sub>R</sub></span> <span class="skolem">x</span><span class="main">)</span> <span class="main">=</span> <span class="skolem">r</span> <span class="keyword1">*<span class="hidden">⇩</span><sub>R</sub></span> <span class="main">(</span><span class="free">f</span> <span class="skolem">n</span><span class="main">)</span> <span class="skolem">x</span>›</span></span> <span class="keyword2"><span class="keyword">for</span></span> <span class="skolem">n</span>
      <span class="keyword1"><span class="command">using</span></span>  <span class="quoted"><span class="quoted">‹<span class="main">⋀</span> <span class="bound">n</span><span class="main">.</span>  linear <span class="main">(</span><span class="free">f</span> <span class="bound">n</span><span class="main">)</span>›</span></span> 
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> Real_Vector_Spaces.linear_def real_vector.linear_scale<span class="main">)</span>
    <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">‹lim <span class="main">(</span><span class="main">λ</span> <span class="bound">n</span><span class="main">.</span> <span class="main">(</span><span class="free">f</span> <span class="bound">n</span><span class="main">)</span> <span class="main">(</span><span class="skolem">r</span> <span class="keyword1">*<span class="hidden">⇩</span><sub>R</sub></span> <span class="skolem">x</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> lim <span class="main">(</span><span class="main">λ</span> <span class="bound">n</span><span class="main">.</span> <span class="skolem">r</span> <span class="keyword1">*<span class="hidden">⇩</span><sub>R</sub></span> <span class="main">(</span><span class="free">f</span> <span class="bound">n</span><span class="main">)</span> <span class="skolem">x</span><span class="main">)</span>›</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹convergent <span class="main">(</span><span class="main">λ</span> <span class="bound">n</span><span class="main">.</span> <span class="main">(</span><span class="free">f</span> <span class="bound">n</span><span class="main">)</span> <span class="skolem">x</span><span class="main">)</span>›</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> assms<span class="main"><span class="main">(</span></span>2<span class="main"><span class="main">)</span></span> convergentI pointwise_convergent_to_def<span class="main">)</span>
    <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹isCont <span class="main">(</span><span class="main">λ</span> <span class="bound">t</span><span class="main">::</span><span class="tfree">'b</span><span class="main">.</span> <span class="skolem">r</span> <span class="keyword1">*<span class="hidden">⇩</span><sub>R</sub></span> <span class="bound">t</span><span class="main">)</span> <span class="skolem">tt</span>›</span></span> <span class="keyword2"><span class="keyword">for</span></span> <span class="skolem">tt</span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> bounded_linear_scaleR_right<span class="main">)</span>
    <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹lim <span class="main">(</span><span class="main">λ</span> <span class="bound">n</span><span class="main">.</span> <span class="skolem">r</span> <span class="keyword1">*<span class="hidden">⇩</span><sub>R</sub></span> <span class="main">(</span><span class="main">(</span><span class="free">f</span> <span class="bound">n</span><span class="main">)</span> <span class="skolem">x</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span>  <span class="skolem">r</span> <span class="keyword1">*<span class="hidden">⇩</span><sub>R</sub></span> lim <span class="main">(</span><span class="main">λ</span> <span class="bound">n</span><span class="main">.</span> <span class="main">(</span><span class="free">f</span> <span class="bound">n</span><span class="main">)</span> <span class="skolem">x</span><span class="main">)</span>›</span></span>
      <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="free">f</span> <span class="keyword1">─pointwise→</span> <span class="free">F</span>›</span></span> <span class="keyword1"><span class="command">unfolding</span></span> pointwise_convergent_to_def 
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> <span class="main"><span class="main">(</span></span>mono_tags<span class="main"><span class="main">)</span></span> isCont_tendsto_compose limI<span class="main">)</span>
    <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">‹lim <span class="main">(</span><span class="main">λ</span> <span class="bound">n</span><span class="main">.</span>  <span class="main">(</span><span class="free">f</span> <span class="bound">n</span><span class="main">)</span> <span class="main">(</span><span class="skolem">r</span> <span class="keyword1">*<span class="hidden">⇩</span><sub>R</sub></span> <span class="skolem">x</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> <span class="skolem">r</span> <span class="keyword1">*<span class="hidden">⇩</span><sub>R</sub></span> lim <span class="main">(</span><span class="main">λ</span> <span class="bound">n</span><span class="main">.</span> <span class="main">(</span><span class="free">f</span> <span class="bound">n</span><span class="main">)</span> <span class="skolem">x</span><span class="main">)</span>›</span></span> 
      <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹lim <span class="main">(</span><span class="main">λ</span> <span class="bound">n</span><span class="main">.</span> <span class="main">(</span><span class="free">f</span> <span class="bound">n</span><span class="main">)</span> <span class="main">(</span><span class="skolem">r</span> <span class="keyword1">*<span class="hidden">⇩</span><sub>R</sub></span> <span class="skolem">x</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> lim <span class="main">(</span><span class="main">λ</span> <span class="bound">n</span><span class="main">.</span> <span class="skolem">r</span> <span class="keyword1">*<span class="hidden">⇩</span><sub>R</sub></span> <span class="main">(</span><span class="free">f</span> <span class="bound">n</span><span class="main">)</span> <span class="skolem">x</span><span class="main">)</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹<span class="main">(</span><span class="main">λ</span> <span class="bound">n</span><span class="main">.</span> <span class="main">(</span><span class="free">f</span> <span class="bound">n</span><span class="main">)</span> <span class="skolem">x</span><span class="main">)</span> <span class="main">⇢</span> <span class="free">F</span> <span class="skolem">x</span>›</span></span>
      <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="free">f</span> <span class="keyword1">─pointwise→</span> <span class="free">F</span>›</span></span> <span class="keyword1"><span class="command">unfolding</span></span> pointwise_convergent_to_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
    <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹<span class="main">(</span><span class="main">λ</span> <span class="bound">n</span><span class="main">.</span>  <span class="main">(</span><span class="free">f</span> <span class="bound">n</span><span class="main">)</span> <span class="main">(</span><span class="skolem">r</span> <span class="keyword1">*<span class="hidden">⇩</span><sub>R</sub></span> <span class="skolem">x</span><span class="main">)</span><span class="main">)</span> <span class="main">⇢</span> <span class="free">F</span> <span class="main">(</span><span class="skolem">r</span> <span class="keyword1">*<span class="hidden">⇩</span><sub>R</sub></span> <span class="skolem">x</span><span class="main">)</span>›</span></span>
      <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="free">f</span> <span class="keyword1">─pointwise→</span> <span class="free">F</span>›</span></span> <span class="keyword1"><span class="command">unfolding</span></span> pointwise_convergent_to_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
    <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> limI<span class="main">)</span> 
  <span class="keyword1"><span class="command">qed</span></span>
<span class="keyword1"><span class="command">qed</span></span>


<span class="keyword1"><span class="command">lemma</span></span> non_Cauchy_unbounded<span class="main">:</span>
  <span class="keyword2"><span class="keyword">fixes</span></span> <span class="free">a</span> <span class="main">::</span><span class="quoted"><span class="quoted">‹<span class="main">_</span> <span class="main">⇒</span> real›</span></span> 
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">‹<span class="main">⋀</span><span class="bound">n</span><span class="main">.</span> <span class="free">a</span> <span class="bound">n</span> <span class="main">≥</span> <span class="main">0</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹<span class="free">e</span> <span class="main">&gt;</span> <span class="main">0</span>›</span></span> 
    <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹<span class="main">∀</span><span class="bound">M</span><span class="main">.</span> <span class="main">∃</span><span class="bound">m</span><span class="main">.</span> <span class="main">∃</span><span class="bound">n</span><span class="main">.</span> <span class="bound">m</span> <span class="main">≥</span> <span class="bound">M</span> <span class="main">∧</span> <span class="bound">n</span> <span class="main">≥</span> <span class="bound">M</span> <span class="main">∧</span> <span class="bound">m</span> <span class="main">&gt;</span> <span class="bound">n</span> <span class="main">∧</span> sum <span class="free">a</span> <span class="main">{</span>Suc <span class="bound">n</span><span class="main">..</span><span class="bound">m</span><span class="main">}</span> <span class="main">≥</span> <span class="free">e</span>›</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">‹<span class="main">(</span><span class="main">λ</span><span class="bound">n</span><span class="main">.</span> <span class="main">(</span>sum <span class="free">a</span>  <span class="main">{</span><span class="main">0</span><span class="main">..</span><span class="bound">n</span><span class="main">}</span><span class="main">)</span><span class="main">)</span> <span class="main">⇢</span> <span class="main">∞</span>›</span></span>
  <span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹
  Explanation: If the sequence of partial sums of nonnegative terms is not Cauchy, then it converges
  to infinite.
›</span></span>
<span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
  <span class="keyword3"><span class="command">define</span></span> <span class="skolem"><span class="skolem">S</span></span><span class="main">::</span><span class="quoted"><span class="quoted">"ereal set"</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">S</span> <span class="main">=</span> range <span class="main">(</span><span class="main">λ</span><span class="bound">n</span><span class="main">.</span> sum <span class="free">a</span>  <span class="main">{</span><span class="main">0</span><span class="main">..</span><span class="bound">n</span><span class="main">}</span><span class="main">)</span>›</span></span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹<span class="main">∃</span><span class="bound">s</span><span class="main">∈</span><span class="skolem">S</span><span class="main">.</span>  <span class="skolem">k</span><span class="main">*</span><span class="free">e</span> <span class="main">≤</span> <span class="bound">s</span>›</span></span> <span class="keyword2"><span class="keyword">for</span></span> <span class="skolem">k</span><span class="main">::</span><span class="quoted">nat</span>
  <span class="keyword1"><span class="command">proof</span></span><span class="main">(</span><span class="operator">induction</span> <span class="quoted"><span class="skolem">k</span></span><span class="main">)</span>
    <span class="keyword3"><span class="command">case</span></span> 0
    <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="main">∀</span><span class="bound">M</span><span class="main">.</span> <span class="main">∃</span><span class="bound">m</span><span class="main">.</span> <span class="main">∃</span><span class="bound">n</span><span class="main">.</span> <span class="bound">m</span> <span class="main">≥</span> <span class="bound">M</span> <span class="main">∧</span> <span class="bound">n</span> <span class="main">≥</span> <span class="bound">M</span> <span class="main">∧</span> <span class="bound">m</span> <span class="main">&gt;</span> <span class="bound">n</span> <span class="main">∧</span> sum <span class="free">a</span> <span class="main">{</span>Suc <span class="bound">n</span><span class="main">..</span><span class="bound">m</span><span class="main">}</span> <span class="main">≥</span> <span class="free">e</span>›</span></span>
    <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">m</span></span> <span class="skolem"><span class="skolem">n</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">m</span> <span class="main">≥</span> <span class="main">0</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">n</span> <span class="main">≥</span> <span class="main">0</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">m</span> <span class="main">&gt;</span> <span class="skolem">n</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹sum <span class="free">a</span> <span class="main">{</span>Suc <span class="skolem">n</span><span class="main">..</span><span class="skolem">m</span><span class="main">}</span> <span class="main">≥</span> <span class="free">e</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">n</span> <span class="main">&lt;</span> Suc <span class="skolem">n</span>›</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">‹<span class="main">{</span><span class="main">0</span><span class="main">..</span><span class="skolem">n</span><span class="main">}</span> <span class="main">∪</span> <span class="main">{</span>Suc <span class="skolem">n</span><span class="main">..</span><span class="skolem">m</span><span class="main">}</span> <span class="main">=</span> <span class="main">{</span><span class="main">0</span><span class="main">..</span><span class="skolem">m</span><span class="main">}</span>›</span></span>
      <span class="keyword1"><span class="command">using</span></span> Set_Interval.ivl_disj_un<span class="main">(</span>7<span class="main">)</span> <span class="quoted"><span class="quoted">‹<span class="skolem">n</span> <span class="main">&lt;</span> <span class="skolem">m</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹finite <span class="main">{</span><span class="main">0</span><span class="main">..</span><span class="skolem">n</span><span class="main">}</span>›</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹finite <span class="main">{</span>Suc <span class="skolem">n</span><span class="main">..</span><span class="skolem">m</span><span class="main">}</span>›</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹<span class="main">{</span><span class="main">0</span><span class="main">..</span><span class="skolem">n</span><span class="main">}</span> <span class="main">∩</span> <span class="main">{</span>Suc <span class="skolem">n</span><span class="main">..</span><span class="skolem">m</span><span class="main">}</span> <span class="main">=</span> <span class="main">{}</span>›</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹sum <span class="free">a</span> <span class="main">{</span><span class="main">0</span><span class="main">..</span><span class="skolem">n</span><span class="main">}</span> <span class="main">+</span> sum <span class="free">a</span> <span class="main">{</span>Suc <span class="skolem">n</span><span class="main">..</span><span class="skolem">m</span><span class="main">}</span> <span class="main">=</span> sum <span class="free">a</span> <span class="main">{</span><span class="main">0</span><span class="main">..</span><span class="skolem">m</span><span class="main">}</span>›</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> sum.union_disjoint<span class="main">)</span> 
    <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹sum <span class="free">a</span> <span class="main">{</span>Suc <span class="skolem">n</span><span class="main">..</span><span class="skolem">m</span><span class="main">}</span> <span class="main">&gt;</span> <span class="main">0</span>›</span></span>
      <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="free">e</span> <span class="main">&gt;</span> <span class="main">0</span>›</span></span> <span class="quoted"><span class="quoted">‹sum <span class="free">a</span> <span class="main">{</span>Suc <span class="skolem">n</span><span class="main">..</span><span class="skolem">m</span><span class="main">}</span> <span class="main">≥</span> <span class="free">e</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">linarith</span>
    <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹sum <span class="free">a</span> <span class="main">{</span><span class="main">0</span><span class="main">..</span><span class="skolem">n</span><span class="main">}</span> <span class="main">≥</span> <span class="main">0</span>›</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> assms<span class="main"><span class="main">(</span></span>1<span class="main"><span class="main">)</span></span> sum_nonneg<span class="main">)</span>
    <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹sum <span class="free">a</span> <span class="main">{</span><span class="main">0</span><span class="main">..</span><span class="skolem">m</span><span class="main">}</span> <span class="main">&gt;</span> <span class="main">0</span>›</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">linarith</span>      
    <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹sum <span class="free">a</span> <span class="main">{</span><span class="main">0</span><span class="main">..</span><span class="skolem">m</span><span class="main">}</span> <span class="main">∈</span> <span class="skolem">S</span>›</span></span>
      <span class="keyword1"><span class="command">unfolding</span></span> S_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
    <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹<span class="main">∃</span><span class="bound">s</span><span class="main">∈</span><span class="skolem">S</span><span class="main">.</span> <span class="main">0</span> <span class="main">≤</span> <span class="bound">s</span>›</span></span>
      <span class="keyword1"><span class="command">using</span></span> ereal_less_eq<span class="main">(</span>5<span class="main">)</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">fastforce</span>    
    <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?case</span></span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> zero_ereal_def<span class="main">)</span>  
  <span class="keyword1"><span class="command">next</span></span>
    <span class="keyword3"><span class="command">case</span></span> <span class="main">(</span>Suc <span class="skolem">k</span><span class="main">)</span>
    <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">‹<span class="main">∃</span><span class="bound">s</span><span class="main">∈</span><span class="skolem">S</span><span class="main">.</span> <span class="skolem">k</span><span class="main">*</span><span class="free">e</span> <span class="main">≤</span> <span class="bound">s</span>›</span></span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">s</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">s</span><span class="main">∈</span><span class="skolem">S</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹ereal <span class="main">(</span><span class="skolem">k</span> <span class="main">*</span> <span class="free">e</span><span class="main">)</span> <span class="main">≤</span> <span class="skolem">s</span>›</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹<span class="main">∃</span><span class="bound">N</span><span class="main">.</span> <span class="skolem">s</span> <span class="main">=</span> sum <span class="free">a</span> <span class="main">{</span><span class="main">0</span><span class="main">..</span><span class="bound">N</span><span class="main">}</span>›</span></span>
      <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">s</span><span class="main">∈</span><span class="skolem">S</span>›</span></span> <span class="keyword1"><span class="command">unfolding</span></span> S_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">N</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">s</span> <span class="main">=</span> sum <span class="free">a</span> <span class="main">{</span><span class="main">0</span><span class="main">..</span><span class="skolem">N</span><span class="main">}</span>›</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
    <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="main">∀</span><span class="bound">M</span><span class="main">.</span> <span class="main">∃</span><span class="bound">m</span><span class="main">.</span> <span class="main">∃</span><span class="bound">n</span><span class="main">.</span> <span class="bound">m</span> <span class="main">≥</span> <span class="bound">M</span> <span class="main">∧</span> <span class="bound">n</span> <span class="main">≥</span> <span class="bound">M</span> <span class="main">∧</span> <span class="bound">m</span> <span class="main">&gt;</span> <span class="bound">n</span> <span class="main">∧</span> sum <span class="free">a</span> <span class="main">{</span>Suc <span class="bound">n</span><span class="main">..</span><span class="bound">m</span><span class="main">}</span> <span class="main">≥</span> <span class="free">e</span>›</span></span>
    <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">m</span></span> <span class="skolem"><span class="skolem">n</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">m</span> <span class="main">≥</span> Suc <span class="skolem">N</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">n</span> <span class="main">≥</span> Suc <span class="skolem">N</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">m</span> <span class="main">&gt;</span> <span class="skolem">n</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹sum <span class="free">a</span> <span class="main">{</span>Suc <span class="skolem">n</span><span class="main">..</span><span class="skolem">m</span><span class="main">}</span> <span class="main">≥</span> <span class="free">e</span>›</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹finite <span class="main">{</span>Suc <span class="skolem">N</span><span class="main">..</span><span class="skolem">n</span><span class="main">}</span>›</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹finite <span class="main">{</span>Suc <span class="skolem">n</span><span class="main">..</span><span class="skolem">m</span><span class="main">}</span>›</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹<span class="main">{</span>Suc <span class="skolem">N</span><span class="main">..</span><span class="skolem">n</span><span class="main">}</span> <span class="main">∪</span> <span class="main">{</span>Suc <span class="skolem">n</span><span class="main">..</span><span class="skolem">m</span><span class="main">}</span> <span class="main">=</span> <span class="main">{</span>Suc <span class="skolem">N</span><span class="main">..</span><span class="skolem">m</span><span class="main">}</span>›</span></span>
      <span class="keyword1"><span class="command">using</span></span> Set_Interval.ivl_disj_un
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">smt</span> <span class="quoted"><span class="quoted">‹Suc <span class="skolem">N</span> <span class="main">≤</span> <span class="skolem">n</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">n</span> <span class="main">&lt;</span> <span class="skolem">m</span>›</span></span> atLeastSucAtMost_greaterThanAtMost less_imp_le_nat<span class="main">)</span>
    <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹<span class="main">{}</span> <span class="main">=</span> <span class="main">{</span>Suc <span class="skolem">N</span><span class="main">..</span><span class="skolem">n</span><span class="main">}</span> <span class="main">∩</span> <span class="main">{</span>Suc <span class="skolem">n</span><span class="main">..</span><span class="skolem">m</span><span class="main">}</span>›</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹sum <span class="free">a</span> <span class="main">{</span>Suc <span class="skolem">N</span><span class="main">..</span><span class="skolem">m</span><span class="main">}</span> <span class="main">=</span> sum <span class="free">a</span> <span class="main">{</span>Suc <span class="skolem">N</span><span class="main">..</span><span class="skolem">n</span><span class="main">}</span> <span class="main">+</span> sum <span class="free">a</span> <span class="main">{</span>Suc <span class="skolem">n</span><span class="main">..</span><span class="skolem">m</span><span class="main">}</span>›</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> sum.union_disjoint<span class="main">)</span>
    <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹sum <span class="free">a</span> <span class="main">{</span>Suc <span class="skolem">N</span><span class="main">..</span><span class="skolem">n</span><span class="main">}</span> <span class="main">≥</span> <span class="main">0</span>›</span></span>
      <span class="keyword1"><span class="command">using</span></span>  <span class="quoted"><span class="quoted">‹<span class="main">⋀</span><span class="bound">n</span><span class="main">.</span> <span class="free">a</span> <span class="bound">n</span> <span class="main">≥</span> <span class="main">0</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> sum_nonneg<span class="main">)</span> 
    <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹sum <span class="free">a</span> <span class="main">{</span>Suc <span class="skolem">N</span><span class="main">..</span><span class="skolem">m</span><span class="main">}</span> <span class="main">≥</span> <span class="free">e</span>›</span></span>
      <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="free">e</span> <span class="main">≤</span> sum <span class="free">a</span> <span class="main">{</span>Suc <span class="skolem">n</span><span class="main">..</span><span class="skolem">m</span><span class="main">}</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">linarith</span>
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹finite <span class="main">{</span><span class="main">0</span><span class="main">..</span><span class="skolem">N</span><span class="main">}</span>›</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹finite <span class="main">{</span>Suc <span class="skolem">N</span><span class="main">..</span><span class="skolem">m</span><span class="main">}</span>›</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹<span class="main">{</span><span class="main">0</span><span class="main">..</span><span class="skolem">N</span><span class="main">}</span> <span class="main">∪</span> <span class="main">{</span>Suc <span class="skolem">N</span><span class="main">..</span><span class="skolem">m</span><span class="main">}</span> <span class="main">=</span> <span class="main">{</span><span class="main">0</span><span class="main">..</span><span class="skolem">m</span><span class="main">}</span>›</span></span>
      <span class="keyword1"><span class="command">using</span></span> Set_Interval.ivl_disj_un<span class="main">(</span>7<span class="main">)</span> <span class="quoted"><span class="quoted">‹Suc <span class="skolem">N</span> <span class="main">≤</span> <span class="skolem">m</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>          
    <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹<span class="main">{</span><span class="main">0</span><span class="main">..</span><span class="skolem">N</span><span class="main">}</span> <span class="main">∩</span> <span class="main">{</span>Suc <span class="skolem">N</span><span class="main">..</span><span class="skolem">m</span><span class="main">}</span> <span class="main">=</span> <span class="main">{}</span>›</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹sum <span class="free">a</span> <span class="main">{</span><span class="main">0</span><span class="main">..</span><span class="skolem">N</span><span class="main">}</span> <span class="main">+</span> sum <span class="free">a</span> <span class="main">{</span>Suc <span class="skolem">N</span><span class="main">..</span><span class="skolem">m</span><span class="main">}</span> <span class="main">=</span>  sum <span class="free">a</span> <span class="main">{</span><span class="main">0</span><span class="main">..</span><span class="skolem">m</span><span class="main">}</span>›</span></span> 
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> <span class="quoted"><span class="quoted">‹finite <span class="main">{</span><span class="main">0</span><span class="main">..</span><span class="skolem">N</span><span class="main">}</span>›</span></span> sum.union_disjoint<span class="main">)</span>    
    <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">‹<span class="free">e</span> <span class="main">+</span> <span class="skolem">k</span> <span class="main">*</span> <span class="free">e</span> <span class="main">≤</span> sum <span class="free">a</span> <span class="main">{</span><span class="main">0</span><span class="main">..</span><span class="skolem">m</span><span class="main">}</span>›</span></span>
      <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹ereal <span class="main">(</span>real <span class="skolem">k</span> <span class="main">*</span> <span class="free">e</span><span class="main">)</span> <span class="main">≤</span> <span class="skolem">s</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">s</span> <span class="main">=</span> ereal <span class="main">(</span>sum <span class="free">a</span> <span class="main">{</span><span class="main">0</span><span class="main">..</span><span class="skolem">N</span><span class="main">}</span><span class="main">)</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="free">e</span> <span class="main">≤</span> sum <span class="free">a</span> <span class="main">{</span>Suc <span class="skolem">N</span><span class="main">..</span><span class="skolem">m</span><span class="main">}</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span> 
    <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹<span class="free">e</span> <span class="main">+</span> <span class="skolem">k</span> <span class="main">*</span> <span class="free">e</span> <span class="main">=</span> <span class="main">(</span>Suc <span class="skolem">k</span><span class="main">)</span> <span class="main">*</span> <span class="free">e</span>›</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> semiring_normalization_rules<span class="main"><span class="main">(</span></span>3<span class="main"><span class="main">)</span></span><span class="main">)</span>
    <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹<span class="main">(</span>Suc <span class="skolem">k</span><span class="main">)</span> <span class="main">*</span> <span class="free">e</span> <span class="main">≤</span> sum <span class="free">a</span> <span class="main">{</span><span class="main">0</span><span class="main">..</span><span class="skolem">m</span><span class="main">}</span>›</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">linarith</span>
    <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">‹ereal <span class="main">(</span><span class="main">(</span>Suc <span class="skolem">k</span><span class="main">)</span> <span class="main">*</span> <span class="free">e</span><span class="main">)</span> <span class="main">≤</span> sum <span class="free">a</span> <span class="main">{</span><span class="main">0</span><span class="main">..</span><span class="skolem">m</span><span class="main">}</span>›</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹sum <span class="free">a</span> <span class="main">{</span><span class="main">0</span><span class="main">..</span><span class="skolem">m</span><span class="main">}</span><span class="main">∈</span><span class="skolem">S</span>›</span></span>
      <span class="keyword1"><span class="command">unfolding</span></span> S_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
    <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?case</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">‹<span class="main">∃</span><span class="bound">s</span><span class="main">∈</span><span class="skolem">S</span><span class="main">.</span> <span class="main">(</span>real <span class="skolem">n</span><span class="main">)</span> <span class="main">≤</span> <span class="bound">s</span>›</span></span> <span class="keyword2"><span class="keyword">for</span></span> <span class="skolem">n</span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">meson</span> assms<span class="main"><span class="main">(</span></span>2<span class="main"><span class="main">)</span></span> ereal_le_le ex_less_of_nat_mult less_le_not_le<span class="main">)</span>
  <span class="keyword1"><span class="command">hence</span></span>  <span class="quoted"><span class="quoted">‹Sup <span class="skolem">S</span> <span class="main">=</span> <span class="main">∞</span>›</span></span>
    <span class="keyword1"><span class="command">using</span></span> Sup_le_iff Sup_subset_mono dual_order.strict_trans1 leD less_PInf_Ex_of_nat subsetI 
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">metis</span>
  <span class="keyword1"><span class="command">hence</span></span> Sup<span class="main">:</span> <span class="quoted"><span class="quoted">‹Sup <span class="main">(</span><span class="main">(</span>range <span class="main">(</span><span class="main">λ</span> <span class="bound">n</span><span class="main">.</span> <span class="main">(</span>sum <span class="free">a</span>  <span class="main">{</span><span class="main">0</span><span class="main">..</span><span class="bound">n</span><span class="main">}</span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">::</span>ereal set<span class="main">)</span> <span class="main">=</span> <span class="main">∞</span>›</span></span> <span class="keyword1"><span class="command">using</span></span> S_def 
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹incseq <span class="main">(</span><span class="main">λ</span><span class="bound">n</span><span class="main">.</span> <span class="main">(</span>sum <span class="free">a</span>  <span class="main">{..&lt;</span><span class="bound">n</span><span class="main">}</span><span class="main">)</span><span class="main">)</span>›</span></span>
    <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="main">⋀</span><span class="bound">n</span><span class="main">.</span> <span class="free">a</span> <span class="bound">n</span> <span class="main">≥</span> <span class="main">0</span>›</span></span> <span class="keyword1"><span class="command">using</span></span> Extended_Real.incseq_sumI <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">‹incseq <span class="main">(</span><span class="main">λ</span><span class="bound">n</span><span class="main">.</span> <span class="main">(</span>sum <span class="free">a</span>  <span class="main">{..&lt;</span> Suc <span class="bound">n</span><span class="main">}</span><span class="main">)</span><span class="main">)</span>›</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">meson</span> incseq_Suc_iff<span class="main">)</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">‹incseq <span class="main">(</span><span class="main">λ</span><span class="bound">n</span><span class="main">.</span> <span class="main">(</span>sum <span class="free">a</span>  <span class="main">{</span><span class="main">0</span><span class="main">..</span><span class="bound">n</span><span class="main">}</span><span class="main">)</span><span class="main">::</span>ereal<span class="main">)</span>›</span></span>
    <span class="keyword1"><span class="command">using</span></span> incseq_ereal <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> atLeast0AtMost lessThan_Suc_atMost<span class="main">)</span> 
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">‹<span class="main">(</span><span class="main">λ</span><span class="bound">n</span><span class="main">.</span> sum <span class="free">a</span>  <span class="main">{</span><span class="main">0</span><span class="main">..</span><span class="bound">n</span><span class="main">}</span><span class="main">)</span> <span class="main">⇢</span> Sup <span class="main">(</span>range <span class="main">(</span><span class="main">λ</span><span class="bound">n</span><span class="main">.</span> <span class="main">(</span>sum <span class="free">a</span>  <span class="main">{</span><span class="main">0</span><span class="main">..</span><span class="bound">n</span><span class="main">}</span><span class="main">)</span><span class="main">::</span>ereal<span class="main">)</span><span class="main">)</span>›</span></span>
    <span class="keyword1"><span class="command">using</span></span> LIMSEQ_SUP <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> Sup PInfty_neq_ereal <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span> 
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">lemma</span></span> sum_Cauchy_positive<span class="main">:</span>
  <span class="keyword2"><span class="keyword">fixes</span></span> <span class="free">a</span> <span class="main">::</span><span class="quoted"><span class="quoted">‹<span class="main">_</span> <span class="main">⇒</span> real›</span></span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">‹<span class="main">⋀</span><span class="bound">n</span><span class="main">.</span> <span class="free">a</span> <span class="bound">n</span> <span class="main">≥</span> <span class="main">0</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹<span class="main">∃</span><span class="bound">K</span><span class="main">.</span> <span class="main">∀</span><span class="bound">n</span><span class="main">.</span> <span class="main">(</span>sum <span class="free">a</span>  <span class="main">{</span><span class="main">0</span><span class="main">..</span><span class="bound">n</span><span class="main">}</span><span class="main">)</span> <span class="main">≤</span> <span class="bound">K</span>›</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">‹Cauchy <span class="main">(</span><span class="main">λ</span><span class="bound">n</span><span class="main">.</span> sum <span class="free">a</span> <span class="main">{</span><span class="main">0</span><span class="main">..</span><span class="bound">n</span><span class="main">}</span><span class="main">)</span>›</span></span>
  <span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹
  Explanation: If a series of nonnegative reals is bounded, then the series is 
  Cauchy.
›</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">unfold</span> Cauchy_altdef2<span class="main"><span class="keyword3">,</span></span> <span class="operator">rule</span><span class="main"><span class="keyword3">,</span></span> <span class="operator">rule</span><span class="main">)</span>
  <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">e</span><span class="main">::</span><span class="quoted">real</span>
  <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">e</span><span class="main">&gt;</span><span class="main">0</span>›</span></span>       
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹<span class="main">∃</span><span class="bound">M</span><span class="main">.</span> <span class="main">∀</span><span class="bound"><span class="bound">m</span></span><span class="main">≥</span><span class="bound">M</span><span class="main">.</span> <span class="main">∀</span><span class="bound"><span class="bound">n</span></span><span class="main">≥</span><span class="bound">M</span><span class="main">.</span> <span class="bound">m</span> <span class="main">&gt;</span> <span class="bound">n</span> <span class="main">⟶</span> sum <span class="free">a</span> <span class="main">{</span>Suc <span class="bound">n</span><span class="main">..</span><span class="bound">m</span><span class="main">}</span> <span class="main">&lt;</span> <span class="skolem">e</span>›</span></span>
  <span class="keyword1"><span class="command">proof</span></span><span class="main">(</span><span class="operator">rule</span> classical<span class="main">)</span>
    <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">‹<span class="main">¬</span><span class="main">(</span><span class="main">∃</span><span class="bound">M</span><span class="main">.</span> <span class="main">∀</span><span class="bound"><span class="bound">m</span></span><span class="main">≥</span><span class="bound">M</span><span class="main">.</span> <span class="main">∀</span><span class="bound"><span class="bound">n</span></span><span class="main">≥</span><span class="bound">M</span><span class="main">.</span> <span class="bound">m</span> <span class="main">&gt;</span> <span class="bound">n</span> <span class="main">⟶</span> sum <span class="free">a</span> <span class="main">{</span>Suc <span class="bound">n</span><span class="main">..</span><span class="bound">m</span><span class="main">}</span> <span class="main">&lt;</span> <span class="skolem">e</span><span class="main">)</span>›</span></span>
    <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">‹<span class="main">∀</span><span class="bound">M</span><span class="main">.</span> <span class="main">∃</span><span class="bound">m</span><span class="main">.</span> <span class="main">∃</span><span class="bound">n</span><span class="main">.</span> <span class="bound">m</span> <span class="main">≥</span> <span class="bound">M</span> <span class="main">∧</span> <span class="bound">n</span> <span class="main">≥</span> <span class="bound">M</span> <span class="main">∧</span> <span class="bound">m</span> <span class="main">&gt;</span> <span class="bound">n</span> <span class="main">∧</span> <span class="main">¬</span><span class="main">(</span>sum <span class="free">a</span> <span class="main">{</span>Suc <span class="bound">n</span><span class="main">..</span><span class="bound">m</span><span class="main">}</span> <span class="main">&lt;</span> <span class="skolem">e</span><span class="main">)</span>›</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
    <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">‹<span class="main">∀</span><span class="bound">M</span><span class="main">.</span> <span class="main">∃</span><span class="bound">m</span><span class="main">.</span> <span class="main">∃</span><span class="bound">n</span><span class="main">.</span> <span class="bound">m</span> <span class="main">≥</span> <span class="bound">M</span> <span class="main">∧</span> <span class="bound">n</span> <span class="main">≥</span> <span class="bound">M</span> <span class="main">∧</span> <span class="bound">m</span> <span class="main">&gt;</span> <span class="bound">n</span> <span class="main">∧</span> sum <span class="free">a</span> <span class="main">{</span>Suc <span class="bound">n</span><span class="main">..</span><span class="bound">m</span><span class="main">}</span> <span class="main">≥</span> <span class="skolem">e</span>›</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">fastforce</span>
    <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">‹<span class="main">(</span><span class="main">λ</span><span class="bound">n</span><span class="main">.</span> <span class="main">(</span>sum <span class="free">a</span>  <span class="main">{</span><span class="main">0</span><span class="main">..</span><span class="bound">n</span><span class="main">}</span><span class="main">)</span> <span class="main">)</span> <span class="main">⇢</span> <span class="main">∞</span>›</span></span>
      <span class="keyword1"><span class="command">using</span></span> non_Cauchy_unbounded <span class="quoted"><span class="quoted">‹<span class="main">0</span> <span class="main">&lt;</span> <span class="skolem">e</span>›</span></span> assms<span class="main">(</span>1<span class="main">)</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
    <span class="keyword1"><span class="command">from</span></span>  <span class="quoted"><span class="quoted">‹<span class="main">∃</span><span class="bound">K</span><span class="main">.</span> <span class="main">∀</span><span class="bound">n</span><span class="main">.</span> sum <span class="free">a</span>  <span class="main">{</span><span class="main">0</span><span class="main">..</span><span class="bound">n</span><span class="main">}</span> <span class="main">≤</span> <span class="bound">K</span>›</span></span>
    <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">K</span></span> <span class="keyword2"><span class="keyword">where</span></span>  <span class="quoted"><span class="quoted">‹<span class="main">∀</span><span class="bound">n</span><span class="main">.</span> sum <span class="free">a</span> <span class="main">{</span><span class="main">0</span><span class="main">..</span><span class="bound">n</span><span class="main">}</span> <span class="main">≤</span> <span class="skolem">K</span>›</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
    <span class="keyword1"><span class="command">from</span></span>  <span class="quoted"><span class="quoted">‹<span class="main">(</span><span class="main">λ</span><span class="bound">n</span><span class="main">.</span> sum <span class="free">a</span> <span class="main">{</span><span class="main">0</span><span class="main">..</span><span class="bound">n</span><span class="main">}</span><span class="main">)</span>  <span class="main">⇢</span> <span class="main">∞</span>›</span></span>
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹<span class="main">∀</span><span class="bound">B</span><span class="main">.</span> <span class="main">∃</span><span class="bound">N</span><span class="main">.</span> <span class="main">∀</span><span class="bound"><span class="bound">n</span></span><span class="main">≥</span><span class="bound">N</span><span class="main">.</span> <span class="main">(</span><span class="main">λ</span> <span class="bound">n</span><span class="main">.</span> <span class="main">(</span>sum <span class="free">a</span>  <span class="main">{</span><span class="main">0</span><span class="main">..</span><span class="bound">n</span><span class="main">}</span><span class="main">)</span> <span class="main">)</span> <span class="bound">n</span> <span class="main">≥</span> <span class="bound">B</span>›</span></span>
      <span class="keyword1"><span class="command">using</span></span> Lim_PInfty <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">hence</span></span>  <span class="quoted"><span class="quoted">‹<span class="main">∃</span><span class="bound">n</span><span class="main">.</span> <span class="main">(</span>sum <span class="free">a</span> <span class="main">{</span><span class="main">0</span><span class="main">..</span><span class="bound">n</span><span class="main">}</span><span class="main">)</span> <span class="main">≥</span> <span class="skolem">K</span><span class="main">+</span><span class="main">1</span>›</span></span>
      <span class="keyword1"><span class="command">using</span></span> ereal_less_eq<span class="main">(</span>3<span class="main">)</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>        
    <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span>  <span class="quoted"><span class="quoted">‹<span class="main">∀</span><span class="bound">n</span><span class="main">.</span> <span class="main">(</span>sum <span class="free">a</span>  <span class="main">{</span><span class="main">0</span><span class="main">..</span><span class="bound">n</span><span class="main">}</span><span class="main">)</span> <span class="main">≤</span> <span class="skolem">K</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">smt</span>       
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹sum <span class="free">a</span> <span class="main">{</span>Suc <span class="skolem">n</span><span class="main">..</span><span class="skolem">m</span><span class="main">}</span> <span class="main">=</span> sum <span class="free">a</span> <span class="main">{</span><span class="main">0</span><span class="main">..</span><span class="skolem">m</span><span class="main">}</span> <span class="main">-</span> sum <span class="free">a</span> <span class="main">{</span><span class="main">0</span><span class="main">..</span><span class="skolem">n</span><span class="main">}</span>›</span></span>
    <span class="keyword2"><span class="keyword">if</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">m</span> <span class="main">&gt;</span> <span class="skolem">n</span>"</span></span> <span class="keyword2"><span class="keyword">for</span></span> <span class="skolem">m</span> <span class="skolem">n</span>
    <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> that atLeast0AtMost<span class="main">)</span> <span class="keyword1"><span class="command">using</span></span> sum_up_index_split 
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">smt</span> less_imp_add_positive that<span class="main">)</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">‹<span class="main">∃</span><span class="bound">M</span><span class="main">.</span> <span class="main">∀</span><span class="bound"><span class="bound">m</span></span><span class="main">≥</span><span class="bound">M</span><span class="main">.</span> <span class="main">∀</span><span class="bound"><span class="bound">n</span></span><span class="main">≥</span><span class="bound">M</span><span class="main">.</span> <span class="bound">m</span> <span class="main">&gt;</span> <span class="bound">n</span> <span class="main">⟶</span> sum <span class="free">a</span> <span class="main">{</span><span class="main">0</span><span class="main">..</span><span class="bound">m</span><span class="main">}</span> <span class="main">-</span> sum <span class="free">a</span> <span class="main">{</span><span class="main">0</span><span class="main">..</span><span class="bound">n</span><span class="main">}</span> <span class="main">&lt;</span> <span class="skolem">e</span>›</span></span>
    <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="main">∃</span><span class="bound">M</span><span class="main">.</span> <span class="main">∀</span><span class="bound"><span class="bound">m</span></span><span class="main">≥</span><span class="bound">M</span><span class="main">.</span> <span class="main">∀</span><span class="bound"><span class="bound">n</span></span><span class="main">≥</span><span class="bound">M</span><span class="main">.</span> <span class="bound">m</span> <span class="main">&gt;</span> <span class="bound">n</span> <span class="main">⟶</span> sum <span class="free">a</span> <span class="main">{</span>Suc <span class="bound">n</span><span class="main">..</span><span class="bound">m</span><span class="main">}</span> <span class="main">&lt;</span> <span class="skolem">e</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">smt</span>     
  <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="main">∃</span><span class="bound">M</span><span class="main">.</span> <span class="main">∀</span><span class="bound"><span class="bound">m</span></span><span class="main">≥</span><span class="bound">M</span><span class="main">.</span> <span class="main">∀</span><span class="bound"><span class="bound">n</span></span><span class="main">≥</span><span class="bound">M</span><span class="main">.</span> <span class="bound">m</span> <span class="main">&gt;</span> <span class="bound">n</span> <span class="main">⟶</span> sum <span class="free">a</span> <span class="main">{</span><span class="main">0</span><span class="main">..</span><span class="bound">m</span><span class="main">}</span> <span class="main">-</span> sum <span class="free">a</span> <span class="main">{</span><span class="main">0</span><span class="main">..</span><span class="bound">n</span><span class="main">}</span> <span class="main">&lt;</span> <span class="skolem">e</span>›</span></span>
  <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">M</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">‹<span class="main">∀</span><span class="bound"><span class="bound">m</span></span><span class="main">≥</span><span class="skolem">M</span><span class="main">.</span> <span class="main">∀</span><span class="bound"><span class="bound">n</span></span><span class="main">≥</span><span class="skolem">M</span><span class="main">.</span> <span class="bound">m</span> <span class="main">&gt;</span> <span class="bound">n</span> <span class="main">⟶</span> sum <span class="free">a</span> <span class="main">{</span><span class="main">0</span><span class="main">..</span><span class="bound">m</span><span class="main">}</span> <span class="main">-</span> sum <span class="free">a</span> <span class="main">{</span><span class="main">0</span><span class="main">..</span><span class="bound">n</span><span class="main">}</span> <span class="main">&lt;</span> <span class="skolem">e</span>›</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">m</span> <span class="main">&gt;</span> <span class="skolem">n</span> <span class="main">⟹</span> sum <span class="free">a</span> <span class="main">{</span><span class="main">0</span><span class="main">..</span><span class="skolem">m</span><span class="main">}</span> <span class="main">≥</span> sum <span class="free">a</span> <span class="main">{</span><span class="main">0</span><span class="main">..</span><span class="skolem">n</span><span class="main">}</span>›</span></span> <span class="keyword2"><span class="keyword">for</span></span> <span class="skolem">m</span> <span class="skolem">n</span>
    <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="main">⋀</span> <span class="bound">n</span><span class="main">.</span> <span class="free">a</span> <span class="bound">n</span> <span class="main">≥</span> <span class="main">0</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> sum_mono2<span class="main">)</span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹<span class="main">∃</span><span class="bound">M</span><span class="main">.</span> <span class="main">∀</span><span class="bound"><span class="bound">m</span></span><span class="main">≥</span><span class="bound">M</span><span class="main">.</span> <span class="main">∀</span><span class="bound"><span class="bound">n</span></span><span class="main">≥</span><span class="bound">M</span><span class="main">.</span> <span class="bound">m</span> <span class="main">&gt;</span> <span class="bound">n</span> <span class="main">⟶</span> <span class="main">¦</span>sum <span class="free">a</span> <span class="main">{</span><span class="main">0</span><span class="main">..</span><span class="bound">m</span><span class="main">}</span> <span class="main">-</span> sum <span class="free">a</span> <span class="main">{</span><span class="main">0</span><span class="main">..</span><span class="bound">n</span><span class="main">}</span><span class="main">¦</span> <span class="main">&lt;</span> <span class="skolem">e</span>›</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">‹<span class="main">∃</span><span class="bound">M</span><span class="main">.</span> <span class="main">∀</span><span class="bound"><span class="bound">m</span></span><span class="main">≥</span><span class="bound">M</span><span class="main">.</span> <span class="main">∀</span><span class="bound"><span class="bound">n</span></span><span class="main">≥</span><span class="bound">M</span><span class="main">.</span> <span class="bound">m</span> <span class="main">≥</span> <span class="bound">n</span> <span class="main">⟶</span> <span class="main">¦</span>sum <span class="free">a</span> <span class="main">{</span><span class="main">0</span><span class="main">..</span><span class="bound">m</span><span class="main">}</span> <span class="main">-</span> sum <span class="free">a</span> <span class="main">{</span><span class="main">0</span><span class="main">..</span><span class="bound">n</span><span class="main">}</span><span class="main">¦</span> <span class="main">&lt;</span> <span class="skolem">e</span>›</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> <span class="quoted"><span class="quoted">‹<span class="main">0</span> <span class="main">&lt;</span> <span class="skolem">e</span>›</span></span> abs_zero cancel_comm_monoid_add_class.diff_cancel diff_is_0_eq' 
        less_irrefl_nat linorder_neqE_nat zero_less_diff<span class="main">)</span>      
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">‹<span class="main">∃</span><span class="bound">M</span><span class="main">.</span> <span class="main">∀</span><span class="bound"><span class="bound">m</span></span><span class="main">≥</span><span class="bound">M</span><span class="main">.</span> <span class="main">∀</span><span class="bound"><span class="bound">n</span></span><span class="main">≥</span><span class="bound">M</span><span class="main">.</span> <span class="main">¦</span>sum <span class="free">a</span> <span class="main">{</span><span class="main">0</span><span class="main">..</span><span class="bound">m</span><span class="main">}</span> <span class="main">-</span> sum <span class="free">a</span> <span class="main">{</span><span class="main">0</span><span class="main">..</span><span class="bound">n</span><span class="main">}</span><span class="main">¦</span> <span class="main">&lt;</span> <span class="skolem">e</span>›</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> abs_minus_commute nat_le_linear<span class="main">)</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">‹<span class="main">∃</span><span class="bound">M</span><span class="main">.</span> <span class="main">∀</span><span class="bound"><span class="bound">m</span></span><span class="main">≥</span><span class="bound">M</span><span class="main">.</span> <span class="main">∀</span><span class="bound"><span class="bound">n</span></span><span class="main">≥</span><span class="bound">M</span><span class="main">.</span> dist <span class="main">(</span>sum <span class="free">a</span> <span class="main">{</span><span class="main">0</span><span class="main">..</span><span class="bound">m</span><span class="main">}</span><span class="main">)</span> <span class="main">(</span>sum <span class="free">a</span> <span class="main">{</span><span class="main">0</span><span class="main">..</span><span class="bound">n</span><span class="main">}</span><span class="main">)</span> <span class="main">&lt;</span> <span class="skolem">e</span>›</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> dist_real_def<span class="main">)</span>      
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">‹<span class="main">∃</span><span class="bound">M</span><span class="main">.</span> <span class="main">∀</span><span class="bound"><span class="bound">m</span></span><span class="main">≥</span><span class="bound">M</span><span class="main">.</span> <span class="main">∀</span><span class="bound"><span class="bound">n</span></span><span class="main">≥</span><span class="bound">M</span><span class="main">.</span> dist <span class="main">(</span>sum <span class="free">a</span> <span class="main">{</span><span class="main">0</span><span class="main">..</span><span class="bound">m</span><span class="main">}</span><span class="main">)</span> <span class="main">(</span>sum <span class="free">a</span> <span class="main">{</span><span class="main">0</span><span class="main">..</span><span class="bound">n</span><span class="main">}</span><span class="main">)</span> <span class="main">&lt;</span> <span class="skolem">e</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">‹<span class="main">∃</span><span class="bound">N</span><span class="main">.</span> <span class="main">∀</span><span class="bound"><span class="bound">n</span></span><span class="main">≥</span><span class="bound">N</span><span class="main">.</span> dist <span class="main">(</span>sum <span class="free">a</span> <span class="main">{</span><span class="main">0</span><span class="main">..</span><span class="bound">n</span><span class="main">}</span><span class="main">)</span> <span class="main">(</span>sum <span class="free">a</span> <span class="main">{</span><span class="main">0</span><span class="main">..</span><span class="bound">N</span><span class="main">}</span><span class="main">)</span> <span class="main">&lt;</span> <span class="skolem">e</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">lemma</span></span> convergent_series_Cauchy<span class="main">:</span>
  <span class="keyword2"><span class="keyword">fixes</span></span> <span class="free">a</span><span class="main">::</span><span class="quoted"><span class="quoted">‹nat <span class="main">⇒</span> real›</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="free">φ</span><span class="main">::</span><span class="quoted"><span class="quoted">‹nat <span class="main">⇒</span> <span class="tfree">'a</span><span class="main">::</span>metric_space›</span></span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">‹<span class="main">∃</span><span class="bound">M</span><span class="main">.</span> <span class="main">∀</span><span class="bound">n</span><span class="main">.</span> sum <span class="free">a</span> <span class="main">{</span><span class="main">0</span><span class="main">..</span><span class="bound">n</span><span class="main">}</span> <span class="main">≤</span> <span class="bound">M</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹<span class="main">⋀</span><span class="bound">n</span><span class="main">.</span> dist <span class="main">(</span><span class="free">φ</span> <span class="main">(</span>Suc <span class="bound">n</span><span class="main">)</span><span class="main">)</span> <span class="main">(</span><span class="free">φ</span> <span class="bound">n</span><span class="main">)</span> <span class="main">≤</span> <span class="free">a</span> <span class="bound">n</span>›</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">‹Cauchy <span class="free">φ</span>›</span></span>
  <span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹
  Explanation: Let <span class="antiquoted"><span class="antiquoted"><span class="operator"><span class="operator"><span class="hidden">\&lt;^</span><span class="control">term</span><span class="hidden">&gt;</span></span></span><span class="quoted"><span class="quoted">‹<span class="free"><span class="free">a</span></span>›</span></span></span></span> be a real-valued sequence and let <span class="antiquoted"><span class="antiquoted"><span class="operator"><span class="operator"><span class="hidden">\&lt;^</span><span class="control">term</span><span class="hidden">&gt;</span></span></span><span class="quoted"><span class="quoted">‹<span class="free"><span class="free">φ</span></span>›</span></span></span></span> be sequence in a metric space.
  If the partial sums of <span class="antiquoted"><span class="antiquoted"><span class="operator"><span class="operator"><span class="hidden">\&lt;^</span><span class="control">term</span><span class="hidden">&gt;</span></span></span><span class="quoted"><span class="quoted">‹<span class="free"><span class="free">a</span></span>›</span></span></span></span> are uniformly bounded and the distance between consecutive terms of <span class="antiquoted"><span class="antiquoted"><span class="operator"><span class="operator"><span class="hidden">\&lt;^</span><span class="control">term</span><span class="hidden">&gt;</span></span></span><span class="quoted"><span class="quoted">‹<span class="free"><span class="free">φ</span></span>›</span></span></span></span>
  are bounded by the sequence <span class="antiquoted"><span class="antiquoted"><span class="operator"><span class="operator"><span class="hidden">\&lt;^</span><span class="control">term</span><span class="hidden">&gt;</span></span></span><span class="quoted"><span class="quoted">‹<span class="free"><span class="free">a</span></span>›</span></span></span></span>, then <span class="antiquoted"><span class="antiquoted"><span class="operator"><span class="operator"><span class="hidden">\&lt;^</span><span class="control">term</span><span class="hidden">&gt;</span></span></span><span class="quoted"><span class="quoted">‹<span class="free"><span class="free">φ</span></span>›</span></span></span></span> is Cauchy.›</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">unfold</span> Cauchy_altdef2<span class="main"><span class="keyword3">,</span></span> <span class="operator">rule</span><span class="main"><span class="keyword3">,</span></span> <span class="operator">rule</span><span class="main">)</span>
  <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">e</span><span class="main">::</span><span class="quoted">real</span>
  <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">e</span> <span class="main">&gt;</span> <span class="main">0</span>›</span></span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹<span class="main">⋀</span><span class="bound">k</span><span class="main">.</span> <span class="free">a</span> <span class="bound">k</span> <span class="main">≥</span> <span class="main">0</span>›</span></span>
    <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="main">⋀</span><span class="bound">n</span><span class="main">.</span> dist <span class="main">(</span><span class="free">φ</span> <span class="main">(</span>Suc <span class="bound">n</span><span class="main">)</span><span class="main">)</span> <span class="main">(</span><span class="free">φ</span> <span class="bound">n</span><span class="main">)</span> <span class="main">≤</span> <span class="free">a</span> <span class="bound">n</span>›</span></span> dual_order.trans zero_le_dist <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">‹Cauchy <span class="main">(</span><span class="main">λ</span><span class="bound">k</span><span class="main">.</span> sum <span class="free">a</span> <span class="main">{</span><span class="main">0</span><span class="main">..</span><span class="bound">k</span><span class="main">}</span><span class="main">)</span>›</span></span>
    <span class="keyword1"><span class="command">using</span></span>  <span class="quoted"><span class="quoted">‹<span class="main">∃</span><span class="bound">M</span><span class="main">.</span> <span class="main">∀</span><span class="bound">n</span><span class="main">.</span> sum <span class="free">a</span> <span class="main">{</span><span class="main">0</span><span class="main">..</span><span class="bound">n</span><span class="main">}</span> <span class="main">≤</span> <span class="bound">M</span>›</span></span> sum_Cauchy_positive <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">‹<span class="main">∃</span><span class="bound">M</span><span class="main">.</span> <span class="main">∀</span><span class="bound"><span class="bound">m</span></span><span class="main">≥</span><span class="bound">M</span><span class="main">.</span> <span class="main">∀</span><span class="bound"><span class="bound">n</span></span><span class="main">≥</span><span class="bound">M</span><span class="main">.</span> dist <span class="main">(</span>sum <span class="free">a</span> <span class="main">{</span><span class="main">0</span><span class="main">..</span><span class="bound">m</span><span class="main">}</span><span class="main">)</span> <span class="main">(</span>sum <span class="free">a</span> <span class="main">{</span><span class="main">0</span><span class="main">..</span><span class="bound">n</span><span class="main">}</span><span class="main">)</span> <span class="main">&lt;</span> <span class="skolem">e</span>›</span></span>
    <span class="keyword1"><span class="command">unfolding</span></span> Cauchy_def <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">e</span> <span class="main">&gt;</span> <span class="main">0</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">‹<span class="main">∃</span><span class="bound">M</span><span class="main">.</span> <span class="main">∀</span><span class="bound"><span class="bound">m</span></span><span class="main">≥</span><span class="bound">M</span><span class="main">.</span> <span class="main">∀</span><span class="bound"><span class="bound">n</span></span><span class="main">≥</span><span class="bound">M</span><span class="main">.</span> <span class="bound">m</span> <span class="main">&gt;</span> <span class="bound">n</span> <span class="main">⟶</span> dist <span class="main">(</span>sum <span class="free">a</span> <span class="main">{</span><span class="main">0</span><span class="main">..</span><span class="bound">m</span><span class="main">}</span><span class="main">)</span> <span class="main">(</span>sum <span class="free">a</span> <span class="main">{</span><span class="main">0</span><span class="main">..</span><span class="bound">n</span><span class="main">}</span><span class="main">)</span> <span class="main">&lt;</span> <span class="skolem">e</span>›</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹dist <span class="main">(</span>sum <span class="free">a</span> <span class="main">{</span><span class="main">0</span><span class="main">..</span><span class="skolem">m</span><span class="main">}</span><span class="main">)</span> <span class="main">(</span>sum <span class="free">a</span> <span class="main">{</span><span class="main">0</span><span class="main">..</span><span class="skolem">n</span><span class="main">}</span><span class="main">)</span> <span class="main">=</span> sum <span class="free">a</span> <span class="main">{</span>Suc <span class="skolem">n</span><span class="main">..</span><span class="skolem">m</span><span class="main">}</span>›</span></span> <span class="keyword2"><span class="keyword">if</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">n</span><span class="main">&lt;</span><span class="skolem">m</span>›</span></span> <span class="keyword2"><span class="keyword">for</span></span> <span class="skolem">m</span> <span class="skolem">n</span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">n</span> <span class="main">&lt;</span> Suc <span class="skolem">n</span>›</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹finite <span class="main">{</span><span class="main">0</span><span class="main">..</span><span class="skolem">n</span><span class="main">}</span>›</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹finite <span class="main">{</span>Suc <span class="skolem">n</span><span class="main">..</span><span class="skolem">m</span><span class="main">}</span>›</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹<span class="main">{</span><span class="main">0</span><span class="main">..</span><span class="skolem">n</span><span class="main">}</span> <span class="main">∪</span> <span class="main">{</span>Suc <span class="skolem">n</span><span class="main">..</span><span class="skolem">m</span><span class="main">}</span> <span class="main">=</span> <span class="main">{</span><span class="main">0</span><span class="main">..</span><span class="skolem">m</span><span class="main">}</span>›</span></span>
      <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">n</span> <span class="main">&lt;</span> Suc <span class="skolem">n</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">n</span> <span class="main">&lt;</span> <span class="skolem">m</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span>  <span class="quoted"><span class="quoted">‹<span class="main">{</span><span class="main">0</span><span class="main">..</span><span class="skolem">n</span><span class="main">}</span> <span class="main">∩</span> <span class="main">{</span>Suc <span class="skolem">n</span><span class="main">..</span><span class="skolem">m</span><span class="main">}</span> <span class="main">=</span> <span class="main">{}</span>›</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> sum_plus<span class="main">:</span> <span class="quoted"><span class="quoted">‹<span class="main">(</span>sum <span class="free">a</span> <span class="main">{</span><span class="main">0</span><span class="main">..</span><span class="skolem">n</span><span class="main">}</span><span class="main">)</span> <span class="main">+</span> sum <span class="free">a</span> <span class="main">{</span>Suc <span class="skolem">n</span><span class="main">..</span><span class="skolem">m</span><span class="main">}</span> <span class="main">=</span> <span class="main">(</span>sum <span class="free">a</span> <span class="main">{</span><span class="main">0</span><span class="main">..</span><span class="skolem">m</span><span class="main">}</span><span class="main">)</span>›</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> sum.union_disjoint<span class="main">)</span>
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹dist <span class="main">(</span>sum <span class="free">a</span> <span class="main">{</span><span class="main">0</span><span class="main">..</span><span class="skolem">m</span><span class="main">}</span><span class="main">)</span> <span class="main">(</span>sum <span class="free">a</span> <span class="main">{</span><span class="main">0</span><span class="main">..</span><span class="skolem">n</span><span class="main">}</span><span class="main">)</span> <span class="main">=</span> <span class="main">¦</span><span class="main">(</span>sum <span class="free">a</span> <span class="main">{</span><span class="main">0</span><span class="main">..</span><span class="skolem">m</span><span class="main">}</span><span class="main">)</span> <span class="main">-</span> <span class="main">(</span>sum <span class="free">a</span> <span class="main">{</span><span class="main">0</span><span class="main">..</span><span class="skolem">n</span><span class="main">}</span><span class="main">)</span><span class="main">¦</span>›</span></span>
      <span class="keyword1"><span class="command">using</span></span> dist_real_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
    <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹<span class="main">(</span>sum <span class="free">a</span> <span class="main">{</span><span class="main">0</span><span class="main">..</span><span class="skolem">m</span><span class="main">}</span><span class="main">)</span> <span class="main">-</span> <span class="main">(</span>sum <span class="free">a</span> <span class="main">{</span><span class="main">0</span><span class="main">..</span><span class="skolem">n</span><span class="main">}</span><span class="main">)</span> <span class="main">=</span> sum <span class="free">a</span> <span class="main">{</span>Suc <span class="skolem">n</span><span class="main">..</span><span class="skolem">m</span><span class="main">}</span>›</span></span>
      <span class="keyword1"><span class="command">using</span></span> sum_plus <span class="keyword1"><span class="command">by</span></span> <span class="operator">linarith</span> 
    <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> <span class="quoted"><span class="quoted">‹<span class="main">⋀</span><span class="bound">k</span><span class="main">.</span> <span class="main">0</span> <span class="main">≤</span> <span class="free">a</span> <span class="bound">k</span>›</span></span> sum_nonneg<span class="main">)</span>
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">hence</span></span> sum_a<span class="main">:</span> <span class="quoted"><span class="quoted">‹<span class="main">∃</span><span class="bound">M</span><span class="main">.</span> <span class="main">∀</span><span class="bound"><span class="bound">m</span></span><span class="main">≥</span><span class="bound">M</span><span class="main">.</span> <span class="main">∀</span><span class="bound"><span class="bound">n</span></span><span class="main">≥</span><span class="bound">M</span><span class="main">.</span> <span class="bound">m</span> <span class="main">&gt;</span> <span class="bound">n</span> <span class="main">⟶</span> sum <span class="free">a</span> <span class="main">{</span>Suc <span class="bound">n</span><span class="main">..</span><span class="bound">m</span><span class="main">}</span> <span class="main">&lt;</span> <span class="skolem">e</span>›</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> <span class="quoted"><span class="quoted">‹<span class="main">∃</span><span class="bound">M</span><span class="main">.</span> <span class="main">∀</span><span class="bound"><span class="bound">m</span></span><span class="main">≥</span><span class="bound">M</span><span class="main">.</span> <span class="main">∀</span><span class="bound"><span class="bound">n</span></span><span class="main">≥</span><span class="bound">M</span><span class="main">.</span> dist <span class="main">(</span>sum <span class="free">a</span> <span class="main">{</span><span class="main">0</span><span class="main">..</span><span class="bound">m</span><span class="main">}</span><span class="main">)</span> <span class="main">(</span>sum <span class="free">a</span> <span class="main">{</span><span class="main">0</span><span class="main">..</span><span class="bound">n</span><span class="main">}</span><span class="main">)</span> <span class="main">&lt;</span> <span class="skolem">e</span>›</span></span><span class="main">)</span> 
  <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">M</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">‹<span class="main">∀</span><span class="bound"><span class="bound">m</span></span><span class="main">≥</span><span class="skolem">M</span><span class="main">.</span> <span class="main">∀</span><span class="bound"><span class="bound">n</span></span><span class="main">≥</span><span class="skolem">M</span><span class="main">.</span> <span class="bound">m</span> <span class="main">&gt;</span> <span class="bound">n</span> <span class="main">⟶</span> sum <span class="free">a</span> <span class="main">{</span>Suc <span class="bound">n</span><span class="main">..</span><span class="bound">m</span><span class="main">}</span> <span class="main">&lt;</span> <span class="skolem">e</span>›</span></span>
    <span class="keyword1"><span class="command">using</span></span> sum_a <span class="quoted"><span class="quoted">‹<span class="skolem">e</span> <span class="main">&gt;</span> <span class="main">0</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">hence</span></span>  <span class="quoted"><span class="quoted">‹<span class="main">∀</span><span class="bound">m</span><span class="main">.</span> <span class="main">∀</span><span class="bound">n</span><span class="main">.</span> Suc <span class="bound">m</span> <span class="main">≥</span> Suc <span class="skolem">M</span> <span class="main">∧</span> Suc <span class="bound">n</span> <span class="main">≥</span> Suc <span class="skolem">M</span> <span class="main">∧</span> Suc <span class="bound">m</span> <span class="main">&gt;</span> Suc <span class="bound">n</span> <span class="main">⟶</span> sum <span class="free">a</span> <span class="main">{</span>Suc <span class="bound">n</span><span class="main">..</span>Suc <span class="bound">m</span> <span class="main">-</span> <span class="main">1</span><span class="main">}</span> <span class="main">&lt;</span> <span class="skolem">e</span>›</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">hence</span></span>  <span class="quoted"><span class="quoted">‹<span class="main">∀</span><span class="bound"><span class="bound">m</span></span><span class="main">≥</span><span class="main">1</span><span class="main">.</span> <span class="main">∀</span><span class="bound"><span class="bound">n</span></span><span class="main">≥</span><span class="main">1</span><span class="main">.</span> <span class="bound">m</span> <span class="main">≥</span> Suc <span class="skolem">M</span> <span class="main">∧</span> <span class="bound">n</span> <span class="main">≥</span> Suc <span class="skolem">M</span> <span class="main">∧</span> <span class="bound">m</span> <span class="main">&gt;</span> <span class="bound">n</span> <span class="main">⟶</span> sum <span class="free">a</span> <span class="main">{</span><span class="bound">n</span><span class="main">..</span><span class="bound">m</span> <span class="main">-</span> <span class="main">1</span><span class="main">}</span> <span class="main">&lt;</span> <span class="skolem">e</span>›</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> Suc_le_D<span class="main">)</span>
  <span class="keyword1"><span class="command">hence</span></span> sum_a2<span class="main">:</span> <span class="quoted"><span class="quoted">‹<span class="main">∃</span><span class="bound">M</span><span class="main">.</span> <span class="main">∀</span><span class="bound"><span class="bound">m</span></span><span class="main">≥</span><span class="bound">M</span><span class="main">.</span> <span class="main">∀</span><span class="bound"><span class="bound">n</span></span><span class="main">≥</span><span class="bound">M</span><span class="main">.</span> <span class="bound">m</span> <span class="main">&gt;</span> <span class="bound">n</span> <span class="main">⟶</span> sum <span class="free">a</span> <span class="main">{</span><span class="bound">n</span><span class="main">..</span><span class="bound">m</span><span class="main">-</span><span class="main">1</span><span class="main">}</span> <span class="main">&lt;</span> <span class="skolem">e</span>›</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">meson</span> add_leE<span class="main">)</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹dist <span class="main">(</span><span class="free">φ</span> <span class="main">(</span><span class="skolem">n</span><span class="main">+</span><span class="skolem">p</span><span class="main">+</span><span class="main">1</span><span class="main">)</span><span class="main">)</span> <span class="main">(</span><span class="free">φ</span> <span class="skolem">n</span><span class="main">)</span> <span class="main">≤</span> sum <span class="free">a</span> <span class="main">{</span><span class="skolem">n</span><span class="main">..</span><span class="skolem">n</span><span class="main">+</span><span class="skolem">p</span><span class="main">}</span>›</span></span> <span class="keyword2"><span class="keyword">for</span></span> <span class="skolem">p</span> <span class="skolem">n</span> <span class="main">::</span> <span class="quoted">nat</span>
  <span class="keyword1"><span class="command">proof</span></span><span class="main">(</span><span class="operator">induction</span> <span class="quoted"><span class="skolem">p</span></span><span class="main">)</span>
    <span class="keyword3"><span class="command">case</span></span> 0 <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?case</span></span></span>  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> assms<span class="main"><span class="main">(</span></span>2<span class="main"><span class="main">)</span></span><span class="main">)</span>
  <span class="keyword1"><span class="command">next</span></span>
    <span class="keyword3"><span class="command">case</span></span> <span class="main">(</span>Suc <span class="skolem">p</span><span class="main">)</span> <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?case</span></span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">smt</span> Suc_eq_plus1 add_Suc_right add_less_same_cancel1 assms<span class="main"><span class="main">(</span></span>2<span class="main"><span class="main">)</span></span> dist_self dist_triangle2 
          gr_implies_not0 sum.cl_ivl_Suc<span class="main">)</span>  
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">m</span> <span class="main">&gt;</span> <span class="skolem">n</span> <span class="main">⟹</span> dist <span class="main">(</span><span class="free">φ</span> <span class="skolem">m</span><span class="main">)</span> <span class="main">(</span><span class="free">φ</span> <span class="skolem">n</span><span class="main">)</span> <span class="main">≤</span> sum <span class="free">a</span> <span class="main">{</span><span class="skolem">n</span><span class="main">..</span><span class="skolem">m</span><span class="main">-</span><span class="main">1</span><span class="main">}</span>›</span></span> <span class="keyword2"><span class="keyword">for</span></span> <span class="skolem">m</span> <span class="skolem">n</span> <span class="main">::</span> <span class="quoted">nat</span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> Suc_eq_plus1 Suc_le_D diff_Suc_1  gr0_implies_Suc less_eq_Suc_le less_imp_Suc_add 
        zero_less_Suc<span class="main">)</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">‹<span class="main">∃</span><span class="bound">M</span><span class="main">.</span> <span class="main">∀</span><span class="bound"><span class="bound">m</span></span><span class="main">≥</span><span class="bound">M</span><span class="main">.</span> <span class="main">∀</span><span class="bound"><span class="bound">n</span></span><span class="main">≥</span><span class="bound">M</span><span class="main">.</span> <span class="bound">m</span> <span class="main">&gt;</span> <span class="bound">n</span> <span class="main">⟶</span> dist <span class="main">(</span><span class="free">φ</span> <span class="bound">m</span><span class="main">)</span> <span class="main">(</span><span class="free">φ</span> <span class="bound">n</span><span class="main">)</span> <span class="main">&lt;</span> <span class="skolem">e</span>›</span></span> 
    <span class="keyword1"><span class="command">using</span></span> sum_a2 <span class="quoted"><span class="quoted">‹<span class="skolem">e</span> <span class="main">&gt;</span> <span class="main">0</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">smt</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound">N</span><span class="main">.</span> <span class="main">∀</span><span class="bound"><span class="bound">n</span></span><span class="main">≥</span><span class="bound">N</span><span class="main">.</span> dist <span class="main">(</span><span class="free">φ</span> <span class="bound">n</span><span class="main">)</span> <span class="main">(</span><span class="free">φ</span> <span class="bound">N</span><span class="main">)</span> <span class="main">&lt;</span> <span class="skolem">e</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="main">0</span> <span class="main">&lt;</span> <span class="skolem">e</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">fastforce</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">unbundle</span></span> notation_blinfun_apply

<span class="keyword1"><span class="command">unbundle</span></span> no_notation_norm

<span class="keyword2"><span class="keyword">end</span></span>
</pre>
</div><div id="Banach_Steinhaus">
<div class="head">
<h1>Theory Banach_Steinhaus</h1>
</div>
<pre class="source"><span class="comment1">(*
  File:   Banach_Steinhaus.thy
  Author: Dominique Unruh, University of Tartu
  Author: Jose Manuel Rodriguez Caballero, University of Tartu
*)</span>
<span class="keyword1"><span class="command">section</span></span> <span class="quoted"><span class="plain_text">‹Banach-Steinhaus theorem›</span></span>

<span class="keyword1"><span class="command">theory</span></span> Banach_Steinhaus
  <span class="keyword2"><span class="keyword">imports</span></span> <a href="Banach_Steinhaus_Missing.html">Banach_Steinhaus_Missing</a>
<span class="keyword2"><span class="keyword">begin</span></span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹
  We formalize Banach-Steinhaus theorem as theorem <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">text</span></span> <span class="raw_text"><span class="raw_text">banach_steinhaus</span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span>. This theorem was 
  originally proved in Banach-Steinhaus's paper~\cite{banach1927principe}. For the proof, we follow
  Sokal's approach~\cite{sokal2011really}. Furthermore, we prove as a corollary a result about
  pointwise convergent sequences of bounded operators whose domain is a Banach space.
›</span></span>

<span class="keyword1"><span class="command">subsection</span></span> <span class="quoted"><span class="plain_text">‹Preliminaries for Sokal's proof of Banach-Steinhaus theorem›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> linear_plus_norm<span class="main">:</span>
  <span class="keyword2"><span class="keyword">includes</span></span> notation_norm
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">‹linear <span class="free">f</span>›</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">‹<span class="main">∥</span><span class="free">f</span> <span class="free">ξ</span><span class="main">∥</span> <span class="main">≤</span> max <span class="main">∥</span><span class="free">f</span> <span class="main">(</span><span class="free">x</span> <span class="main">+</span> <span class="free">ξ</span><span class="main">)</span><span class="main">∥</span> <span class="main">∥</span><span class="free">f</span> <span class="main">(</span><span class="free">x</span> <span class="main">-</span> <span class="free">ξ</span><span class="main">)</span><span class="main">∥</span>›</span></span>
  <span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹
  Explanation: For arbitrary <span class="antiquoted"><span class="antiquoted"><span class="operator"><span class="operator"><span class="hidden">\&lt;^</span><span class="control">term</span><span class="hidden">&gt;</span></span></span><span class="quoted"><span class="quoted">‹<span class="free"><span class="free">x</span></span>›</span></span></span></span> and a linear operator <span class="antiquoted"><span class="antiquoted"><span class="operator"><span class="operator"><span class="hidden">\&lt;^</span><span class="control">term</span><span class="hidden">&gt;</span></span></span><span class="quoted"><span class="quoted">‹<span class="free"><span class="free">f</span></span>›</span></span></span></span>,
  <span class="antiquoted"><span class="antiquoted"><span class="operator"><span class="operator"><span class="hidden">\&lt;^</span><span class="control">term</span><span class="hidden">&gt;</span></span></span><span class="quoted"><span class="quoted">‹norm <span class="main"><span class="main">(</span></span><span class="free"><span class="free">f</span></span> <span class="free"><span class="free">ξ</span></span><span class="main"><span class="main">)</span></span>›</span></span></span></span> is upper bounded by the maximum of the norms
  of the shifts of <span class="antiquoted"><span class="antiquoted"><span class="operator"><span class="operator"><span class="hidden">\&lt;^</span><span class="control">term</span><span class="hidden">&gt;</span></span></span><span class="quoted"><span class="quoted">‹<span class="free"><span class="free">f</span></span>›</span></span></span></span> (i.e., <span class="antiquoted"><span class="antiquoted"><span class="operator"><span class="operator"><span class="hidden">\&lt;^</span><span class="control">term</span><span class="hidden">&gt;</span></span></span><span class="quoted"><span class="quoted">‹<span class="free"><span class="free">f</span></span> <span class="main"><span class="main">(</span></span><span class="free"><span class="free">x</span></span> <span class="main"><span class="main">+</span></span> <span class="free"><span class="free">ξ</span></span><span class="main"><span class="main">)</span></span>›</span></span></span></span> and <span class="antiquoted"><span class="antiquoted"><span class="operator"><span class="operator"><span class="hidden">\&lt;^</span><span class="control">term</span><span class="hidden">&gt;</span></span></span><span class="quoted"><span class="quoted">‹<span class="free"><span class="free">f</span></span> <span class="main"><span class="main">(</span></span><span class="free"><span class="free">x</span></span> <span class="main"><span class="main">-</span></span> <span class="free"><span class="free">ξ</span></span><span class="main"><span class="main">)</span></span>›</span></span></span></span>).
›</span></span>
<span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹norm <span class="main">(</span><span class="free">f</span> <span class="free">ξ</span><span class="main">)</span> <span class="main">=</span> norm <span class="main">(</span> <span class="main">(</span>inverse <span class="main">(</span>of_nat <span class="numeral">2</span><span class="main">)</span><span class="main">)</span> <span class="keyword1">*<span class="hidden">⇩</span><sub>R</sub></span> <span class="main">(</span><span class="free">f</span> <span class="main">(</span><span class="free">x</span> <span class="main">+</span> <span class="free">ξ</span><span class="main">)</span> <span class="main">-</span> <span class="free">f</span> <span class="main">(</span><span class="free">x</span> <span class="main">-</span> <span class="free">ξ</span><span class="main">)</span><span class="main">)</span> <span class="main">)</span>›</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">smt</span> add_diff_cancel_left' assms diff_add_cancel diff_diff_add linear_diff midpoint_def 
        midpoint_plus_self of_nat_1 of_nat_add one_add_one scaleR_half_double<span class="main">)</span>
  <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹<span class="main">…</span> <span class="main">=</span> inverse <span class="main">(</span>of_nat <span class="numeral">2</span><span class="main">)</span> <span class="main">*</span> norm <span class="main">(</span><span class="free">f</span> <span class="main">(</span><span class="free">x</span> <span class="main">+</span> <span class="free">ξ</span><span class="main">)</span> <span class="main">-</span> <span class="free">f</span> <span class="main">(</span><span class="free">x</span> <span class="main">-</span> <span class="free">ξ</span><span class="main">)</span><span class="main">)</span>›</span></span>
    <span class="keyword1"><span class="command">using</span></span> Real_Vector_Spaces.real_normed_vector_class.norm_scaleR <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹<span class="main">…</span> <span class="main">≤</span> inverse <span class="main">(</span>of_nat <span class="numeral">2</span><span class="main">)</span> <span class="main">*</span> <span class="main">(</span>norm <span class="main">(</span><span class="free">f</span> <span class="main">(</span><span class="free">x</span> <span class="main">+</span> <span class="free">ξ</span><span class="main">)</span><span class="main">)</span> <span class="main">+</span> norm <span class="main">(</span><span class="free">f</span> <span class="main">(</span><span class="free">x</span> <span class="main">-</span> <span class="free">ξ</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>›</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> norm_triangle_ineq4<span class="main">)</span>
  <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹<span class="main">…</span> <span class="main">≤</span>  max <span class="main">(</span>norm <span class="main">(</span><span class="free">f</span> <span class="main">(</span><span class="free">x</span> <span class="main">+</span> <span class="free">ξ</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">(</span>norm <span class="main">(</span><span class="free">f</span> <span class="main">(</span><span class="free">x</span> <span class="main">-</span> <span class="free">ξ</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>›</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">finally</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">lemma</span></span> onorm_Sup_on_ball<span class="main">:</span>
  <span class="keyword2"><span class="keyword">includes</span></span> notation_norm
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">‹<span class="free">r</span> <span class="main">&gt;</span> <span class="main">0</span>›</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">∥</span><span class="free">f</span><span class="main">∥</span> <span class="main">≤</span> Sup <span class="main">(</span> <span class="main">(</span><span class="main">λ</span><span class="bound">x</span><span class="main">.</span> <span class="main">∥</span><span class="free">f</span> <span class="keyword1">*<span class="hidden">⇩</span><sub>v</sub></span> <span class="bound">x</span><span class="main">∥</span><span class="main">)</span> <span class="main">`</span> <span class="main">(</span>ball <span class="free">x</span> <span class="free">r</span><span class="main">)</span> <span class="main">)</span> <span class="main">/</span> <span class="free">r</span>"</span></span>
  <span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹
  Explanation: Let <span class="antiquoted"><span class="antiquoted"><span class="operator"><span class="operator"><span class="hidden">\&lt;^</span><span class="control">term</span><span class="hidden">&gt;</span></span></span><span class="quoted"><span class="quoted">‹<span class="free"><span class="free">f</span></span>›</span></span></span></span> be a bounded operator and let <span class="antiquoted"><span class="antiquoted"><span class="operator"><span class="operator"><span class="hidden">\&lt;^</span><span class="control">term</span><span class="hidden">&gt;</span></span></span><span class="quoted"><span class="quoted">‹<span class="free"><span class="free">x</span></span>›</span></span></span></span> be a point. For any <span class="antiquoted"><span class="antiquoted"><span class="operator"><span class="operator"><span class="hidden">\&lt;^</span><span class="control">term</span><span class="hidden">&gt;</span></span></span><span class="quoted"><span class="quoted">‹<span class="free"><span class="free">r</span></span> <span class="main"><span class="main">&gt;</span></span> <span class="main"><span class="main">0</span></span>›</span></span></span></span>, 
  the operator norm of <span class="antiquoted"><span class="antiquoted"><span class="operator"><span class="operator"><span class="hidden">\&lt;^</span><span class="control">term</span><span class="hidden">&gt;</span></span></span><span class="quoted"><span class="quoted">‹<span class="free"><span class="free">f</span></span>›</span></span></span></span> is bounded above by the supremum of $f$ applied to the open ball of 
  radius <span class="antiquoted"><span class="antiquoted"><span class="operator"><span class="operator"><span class="hidden">\&lt;^</span><span class="control">term</span><span class="hidden">&gt;</span></span></span><span class="quoted"><span class="quoted">‹<span class="free"><span class="free">r</span></span>›</span></span></span></span> around <span class="antiquoted"><span class="antiquoted"><span class="operator"><span class="operator"><span class="hidden">\&lt;^</span><span class="control">term</span><span class="hidden">&gt;</span></span></span><span class="quoted"><span class="quoted">‹<span class="free"><span class="free">x</span></span>›</span></span></span></span>, divided by <span class="antiquoted"><span class="antiquoted"><span class="operator"><span class="operator"><span class="hidden">\&lt;^</span><span class="control">term</span><span class="hidden">&gt;</span></span></span><span class="quoted"><span class="quoted">‹<span class="free"><span class="free">r</span></span>›</span></span></span></span>.
›</span></span>
<span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> bdd_above_3<span class="main">:</span> <span class="quoted"><span class="quoted">‹bdd_above <span class="main">(</span><span class="main">(</span><span class="main">λ</span><span class="bound">x</span><span class="main">.</span> <span class="main">∥</span><span class="free">f</span> <span class="keyword1">*<span class="hidden">⇩</span><sub>v</sub></span> <span class="bound">x</span><span class="main">∥</span><span class="main">)</span> <span class="main">`</span> <span class="main">(</span>ball <span class="main">0</span> <span class="free">r</span><span class="main">)</span><span class="main">)</span>›</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
    <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">M</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">‹<span class="main">⋀</span> <span class="bound">ξ</span><span class="main">.</span>  <span class="main">∥</span><span class="free">f</span> <span class="keyword1">*<span class="hidden">⇩</span><sub>v</sub></span> <span class="bound">ξ</span><span class="main">∥</span> <span class="main">≤</span> <span class="skolem">M</span> <span class="main">*</span> norm <span class="bound">ξ</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">M</span> <span class="main">≥</span> <span class="main">0</span>›</span></span>
      <span class="keyword1"><span class="command">using</span></span> norm_blinfun norm_ge_zero <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>      
    <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">‹<span class="main">⋀</span> <span class="bound">ξ</span><span class="main">.</span> <span class="bound">ξ</span> <span class="main">∈</span> ball <span class="main">0</span> <span class="free">r</span> <span class="main">⟹</span> <span class="main">∥</span><span class="free">f</span> <span class="keyword1">*<span class="hidden">⇩</span><sub>v</sub></span> <span class="bound">ξ</span><span class="main">∥</span> <span class="main">≤</span> <span class="skolem">M</span> <span class="main">*</span> <span class="free">r</span>›</span></span>
      <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="free">r</span> <span class="main">&gt;</span> <span class="main">0</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">smt</span> mem_ball_0 mult_left_mono<span class="main">)</span> 
    <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">meson</span> bdd_aboveI2<span class="main">)</span>     
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">have</span></span> bdd_above_2<span class="main">:</span> <span class="quoted"><span class="quoted">‹bdd_above <span class="main">(</span><span class="main">(</span><span class="main">λ</span> <span class="bound">ξ</span><span class="main">.</span> <span class="main">∥</span><span class="free">f</span> <span class="keyword1">*<span class="hidden">⇩</span><sub>v</sub></span> <span class="main">(</span><span class="free">x</span> <span class="main">+</span> <span class="bound">ξ</span><span class="main">)</span><span class="main">∥</span><span class="main">)</span> <span class="main">`</span> <span class="main">(</span>ball <span class="main">0</span> <span class="free">r</span><span class="main">)</span><span class="main">)</span>›</span></span>
  <span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹bdd_above <span class="main">(</span><span class="main">(</span><span class="main">λ</span> <span class="bound">ξ</span><span class="main">.</span> <span class="main">∥</span><span class="free">f</span> <span class="keyword1">*<span class="hidden">⇩</span><sub>v</sub></span> <span class="free">x</span><span class="main">∥</span><span class="main">)</span> <span class="main">`</span> <span class="main">(</span>ball <span class="main">0</span> <span class="free">r</span><span class="main">)</span><span class="main">)</span>›</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>          
    <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹bdd_above <span class="main">(</span><span class="main">(</span><span class="main">λ</span> <span class="bound">ξ</span><span class="main">.</span> <span class="main">∥</span><span class="free">f</span> <span class="keyword1">*<span class="hidden">⇩</span><sub>v</sub></span> <span class="bound">ξ</span><span class="main">∥</span><span class="main">)</span> <span class="main">`</span> <span class="main">(</span>ball <span class="main">0</span> <span class="free">r</span><span class="main">)</span><span class="main">)</span>›</span></span>
      <span class="keyword1"><span class="command">using</span></span> bdd_above_3 <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
    <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹bdd_above <span class="main">(</span><span class="main">(</span><span class="main">λ</span> <span class="bound">ξ</span><span class="main">.</span> <span class="main">∥</span><span class="free">f</span> <span class="keyword1">*<span class="hidden">⇩</span><sub>v</sub></span> <span class="free">x</span><span class="main">∥</span> <span class="main">+</span> <span class="main">∥</span><span class="free">f</span> <span class="keyword1">*<span class="hidden">⇩</span><sub>v</sub></span> <span class="bound">ξ</span><span class="main">∥</span><span class="main">)</span> <span class="main">`</span> <span class="main">(</span>ball <span class="main">0</span> <span class="free">r</span><span class="main">)</span><span class="main">)</span>›</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> bdd_above_plus<span class="main">)</span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">M</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">‹<span class="main">⋀</span> <span class="bound">ξ</span><span class="main">.</span> <span class="bound">ξ</span> <span class="main">∈</span> ball <span class="main">0</span> <span class="free">r</span> <span class="main">⟹</span> <span class="main">∥</span><span class="free">f</span> <span class="keyword1">*<span class="hidden">⇩</span><sub>v</sub></span> <span class="free">x</span><span class="main">∥</span> <span class="main">+</span> <span class="main">∥</span><span class="free">f</span> <span class="keyword1">*<span class="hidden">⇩</span><sub>v</sub></span> <span class="bound">ξ</span><span class="main">∥</span> <span class="main">≤</span> <span class="skolem">M</span>›</span></span>
      <span class="keyword1"><span class="command">unfolding</span></span> bdd_above_def <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">meson</span> image_eqI<span class="main">)</span>
    <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹<span class="main">∥</span><span class="free">f</span> <span class="keyword1">*<span class="hidden">⇩</span><sub>v</sub></span> <span class="main">(</span><span class="free">x</span> <span class="main">+</span> <span class="skolem">ξ</span><span class="main">)</span><span class="main">∥</span> <span class="main">≤</span> <span class="main">∥</span><span class="free">f</span> <span class="keyword1">*<span class="hidden">⇩</span><sub>v</sub></span> <span class="free">x</span><span class="main">∥</span> <span class="main">+</span> <span class="main">∥</span><span class="free">f</span> <span class="keyword1">*<span class="hidden">⇩</span><sub>v</sub></span> <span class="skolem">ξ</span><span class="main">∥</span>›</span></span> <span class="keyword2"><span class="keyword">for</span></span> <span class="skolem">ξ</span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> blinfun.add_right norm_triangle_ineq<span class="main">)</span>                
    <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹<span class="main">⋀</span> <span class="bound">ξ</span><span class="main">.</span> <span class="bound">ξ</span> <span class="main">∈</span> ball <span class="main">0</span> <span class="free">r</span> <span class="main">⟹</span> <span class="main">∥</span><span class="free">f</span> <span class="keyword1">*<span class="hidden">⇩</span><sub>v</sub></span> <span class="main">(</span><span class="free">x</span> <span class="main">+</span> <span class="bound">ξ</span><span class="main">)</span><span class="main">∥</span> <span class="main">≤</span> <span class="skolem">M</span>›</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> blinfun.add_right norm_triangle_le<span class="main">)</span>
    <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">meson</span> bdd_aboveI2<span class="main">)</span>                          
  <span class="keyword1"><span class="command">qed</span></span> 
  <span class="keyword1"><span class="command">have</span></span> bdd_above_4<span class="main">:</span> <span class="quoted"><span class="quoted">‹bdd_above <span class="main">(</span><span class="main">(</span><span class="main">λ</span> <span class="bound">ξ</span><span class="main">.</span> <span class="main">∥</span><span class="free">f</span> <span class="keyword1">*<span class="hidden">⇩</span><sub>v</sub></span> <span class="main">(</span><span class="free">x</span> <span class="main">-</span> <span class="bound">ξ</span><span class="main">)</span><span class="main">∥</span><span class="main">)</span> <span class="main">`</span> <span class="main">(</span>ball <span class="main">0</span> <span class="free">r</span><span class="main">)</span><span class="main">)</span>›</span></span>
  <span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
    <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">K</span></span> <span class="keyword2"><span class="keyword">where</span></span> K_def<span class="main">:</span> <span class="quoted"><span class="quoted">‹<span class="main">⋀</span> <span class="bound">ξ</span><span class="main">.</span> <span class="bound">ξ</span> <span class="main">∈</span> ball <span class="main">0</span> <span class="free">r</span> <span class="main">⟹</span> <span class="main">∥</span><span class="free">f</span> <span class="keyword1">*<span class="hidden">⇩</span><sub>v</sub></span> <span class="main">(</span><span class="free">x</span> <span class="main">+</span> <span class="bound">ξ</span><span class="main">)</span><span class="main">∥</span> <span class="main">≤</span> <span class="skolem">K</span>›</span></span>
      <span class="keyword1"><span class="command">using</span></span>  <span class="quoted"><span class="quoted">‹bdd_above <span class="main">(</span><span class="main">(</span><span class="main">λ</span> <span class="bound">ξ</span><span class="main">.</span> norm <span class="main">(</span><span class="free">f</span> <span class="main">(</span><span class="free">x</span> <span class="main">+</span> <span class="bound">ξ</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">`</span> <span class="main">(</span>ball <span class="main">0</span> <span class="free">r</span><span class="main">)</span><span class="main">)</span>›</span></span> <span class="keyword1"><span class="command">unfolding</span></span> bdd_above_def 
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">meson</span> image_eqI<span class="main">)</span>
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">ξ</span> <span class="main">∈</span> ball <span class="main">(</span><span class="main">0</span><span class="main">::</span><span class="tfree">'a</span><span class="main">)</span> <span class="free">r</span> <span class="main">⟹</span> <span class="main">-</span><span class="skolem">ξ</span> <span class="main">∈</span> ball <span class="main">0</span> <span class="free">r</span>›</span></span> <span class="keyword2"><span class="keyword">for</span></span> <span class="skolem">ξ</span>
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> K_def ab_group_add_class.ab_diff_conv_add_uminus bdd_aboveI2<span class="main">)</span>
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">have</span></span> bdd_above_1<span class="main">:</span> <span class="quoted"><span class="quoted">‹bdd_above <span class="main">(</span><span class="main">(</span><span class="main">λ</span> <span class="bound">ξ</span><span class="main">.</span> max <span class="main">∥</span><span class="free">f</span> <span class="keyword1">*<span class="hidden">⇩</span><sub>v</sub></span> <span class="main">(</span><span class="free">x</span> <span class="main">+</span> <span class="bound">ξ</span><span class="main">)</span><span class="main">∥</span>  <span class="main">∥</span><span class="free">f</span> <span class="keyword1">*<span class="hidden">⇩</span><sub>v</sub></span> <span class="main">(</span><span class="free">x</span> <span class="main">-</span> <span class="bound">ξ</span><span class="main">)</span><span class="main">∥</span><span class="main">)</span> <span class="main">`</span> <span class="main">(</span>ball <span class="main">0</span> <span class="free">r</span><span class="main">)</span><span class="main">)</span>›</span></span>
  <span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹bdd_above <span class="main">(</span><span class="main">(</span><span class="main">λ</span> <span class="bound">ξ</span><span class="main">.</span> <span class="main">∥</span><span class="free">f</span> <span class="keyword1">*<span class="hidden">⇩</span><sub>v</sub></span> <span class="main">(</span><span class="free">x</span> <span class="main">+</span> <span class="bound">ξ</span><span class="main">)</span><span class="main">∥</span><span class="main">)</span> <span class="main">`</span> <span class="main">(</span>ball <span class="main">0</span> <span class="free">r</span><span class="main">)</span><span class="main">)</span>›</span></span>
      <span class="keyword1"><span class="command">using</span></span> bdd_above_2 <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
    <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹bdd_above <span class="main">(</span><span class="main">(</span><span class="main">λ</span> <span class="bound">ξ</span><span class="main">.</span>  <span class="main">∥</span><span class="free">f</span> <span class="keyword1">*<span class="hidden">⇩</span><sub>v</sub></span> <span class="main">(</span><span class="free">x</span> <span class="main">-</span> <span class="bound">ξ</span><span class="main">)</span><span class="main">∥</span><span class="main">)</span> <span class="main">`</span> <span class="main">(</span>ball <span class="main">0</span> <span class="free">r</span><span class="main">)</span><span class="main">)</span>›</span></span>
      <span class="keyword1"><span class="command">using</span></span> bdd_above_4 <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
    <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
      <span class="keyword1"><span class="command">unfolding</span></span> max_def <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="operator">auto</span> <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">meson</span> bdd_above_Int1 bdd_above_mono image_Int_subset<span class="main">)</span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">meson</span> bdd_above_Int1 bdd_above_mono image_Int_subset<span class="main">)</span>   
  <span class="keyword1"><span class="command">qed</span></span> 
  <span class="keyword1"><span class="command">have</span></span> bdd_above_6<span class="main">:</span> <span class="quoted"><span class="quoted">‹bdd_above <span class="main">(</span><span class="main">(</span><span class="main">λ</span><span class="bound">t</span><span class="main">.</span> <span class="main">∥</span><span class="free">f</span> <span class="keyword1">*<span class="hidden">⇩</span><sub>v</sub></span> <span class="bound">t</span><span class="main">∥</span><span class="main">)</span> <span class="main">`</span> ball <span class="free">x</span> <span class="free">r</span><span class="main">)</span>›</span></span>
  <span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹bounded <span class="main">(</span>ball <span class="free">x</span> <span class="free">r</span><span class="main">)</span>›</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>            
    <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">‹bounded <span class="main">(</span><span class="main">(</span><span class="main">λ</span><span class="bound">t</span><span class="main">.</span> <span class="main">∥</span><span class="free">f</span> <span class="keyword1">*<span class="hidden">⇩</span><sub>v</sub></span> <span class="bound">t</span><span class="main">∥</span><span class="main">)</span> <span class="main">`</span> ball <span class="free">x</span> <span class="free">r</span><span class="main">)</span>›</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> <span class="main"><span class="main">(</span></span>no_types<span class="main"><span class="main">)</span></span> add.left_neutral bdd_above_2 bdd_above_norm bounded_norm_comp 
          image_add_ball image_image<span class="main">)</span>
    <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> bounded_imp_bdd_above<span class="main">)</span>
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">have</span></span> norm_1<span class="main">:</span> <span class="quoted"><span class="quoted">‹<span class="main">(</span><span class="main">λ</span><span class="bound">ξ</span><span class="main">.</span> <span class="main">∥</span><span class="free">f</span> <span class="keyword1">*<span class="hidden">⇩</span><sub>v</sub></span> <span class="main">(</span><span class="free">x</span> <span class="main">+</span> <span class="bound">ξ</span><span class="main">)</span><span class="main">∥</span><span class="main">)</span> <span class="main">`</span> ball <span class="main">0</span> <span class="free">r</span> <span class="main">=</span> <span class="main">(</span><span class="main">λ</span><span class="bound">t</span><span class="main">.</span> <span class="main">∥</span><span class="free">f</span> <span class="keyword1">*<span class="hidden">⇩</span><sub>v</sub></span> <span class="bound">t</span><span class="main">∥</span><span class="main">)</span> <span class="main">`</span> ball <span class="free">x</span> <span class="free">r</span>›</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> add.right_neutral ball_translation image_image<span class="main">)</span>   
  <span class="keyword1"><span class="command">have</span></span> bdd_above_5<span class="main">:</span> <span class="quoted"><span class="quoted">‹bdd_above <span class="main">(</span><span class="main">(</span><span class="main">λ</span><span class="bound">ξ</span><span class="main">.</span> norm <span class="main">(</span><span class="free">f</span> <span class="main">(</span><span class="free">x</span> <span class="main">+</span> <span class="bound">ξ</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">`</span> ball <span class="main">0</span> <span class="free">r</span><span class="main">)</span>›</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> bdd_above_2<span class="main">)</span>   
  <span class="keyword1"><span class="command">have</span></span> norm_2<span class="main">:</span> <span class="quoted"><span class="quoted">‹<span class="main">∥</span><span class="skolem">ξ</span><span class="main">∥</span> <span class="main">&lt;</span> <span class="free">r</span> <span class="main">⟹</span> <span class="main">∥</span><span class="free">f</span> <span class="keyword1">*<span class="hidden">⇩</span><sub>v</sub></span> <span class="main">(</span><span class="free">x</span> <span class="main">-</span> <span class="skolem">ξ</span><span class="main">)</span><span class="main">∥</span> <span class="main">∈</span> <span class="main">(</span><span class="main">λ</span><span class="bound">ξ</span><span class="main">.</span> <span class="main">∥</span><span class="free">f</span> <span class="keyword1">*<span class="hidden">⇩</span><sub>v</sub></span> <span class="main">(</span><span class="free">x</span> <span class="main">+</span> <span class="bound">ξ</span><span class="main">)</span><span class="main">∥</span><span class="main">)</span> <span class="main">`</span> ball <span class="main">0</span> <span class="free">r</span>›</span></span> <span class="keyword2"><span class="keyword">for</span></span> <span class="skolem">ξ</span>
  <span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
    <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">‹<span class="main">∥</span><span class="skolem">ξ</span><span class="main">∥</span> <span class="main">&lt;</span> <span class="free">r</span>›</span></span>
    <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">ξ</span> <span class="main">∈</span> ball <span class="main">(</span><span class="main">0</span><span class="main">::</span><span class="tfree">'a</span><span class="main">)</span> <span class="free">r</span>›</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">‹<span class="main">-</span><span class="skolem">ξ</span> <span class="main">∈</span> ball <span class="main">(</span><span class="main">0</span><span class="main">::</span><span class="tfree">'a</span><span class="main">)</span> <span class="free">r</span>›</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> 
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> <span class="main"><span class="main">(</span></span>no_types<span class="main"><span class="main">,</span></span> lifting<span class="main"><span class="main">)</span></span> ab_group_add_class.ab_diff_conv_add_uminus image_iff<span class="main">)</span> 
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">have</span></span> norm_2'<span class="main">:</span> <span class="quoted"><span class="quoted">‹<span class="main">∥</span><span class="skolem">ξ</span><span class="main">∥</span> <span class="main">&lt;</span> <span class="free">r</span> <span class="main">⟹</span> <span class="main">∥</span><span class="free">f</span> <span class="keyword1">*<span class="hidden">⇩</span><sub>v</sub></span> <span class="main">(</span><span class="free">x</span> <span class="main">+</span> <span class="skolem">ξ</span><span class="main">)</span><span class="main">∥</span> <span class="main">∈</span> <span class="main">(</span><span class="main">λ</span><span class="bound">ξ</span><span class="main">.</span> <span class="main">∥</span><span class="free">f</span> <span class="keyword1">*<span class="hidden">⇩</span><sub>v</sub></span> <span class="main">(</span><span class="free">x</span> <span class="main">-</span> <span class="bound">ξ</span><span class="main">)</span><span class="main">∥</span><span class="main">)</span> <span class="main">`</span> ball <span class="main">0</span> <span class="free">r</span>›</span></span> <span class="keyword2"><span class="keyword">for</span></span> <span class="skolem">ξ</span>
  <span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
    <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">‹norm <span class="skolem">ξ</span> <span class="main">&lt;</span> <span class="free">r</span>›</span></span>
    <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">ξ</span> <span class="main">∈</span> ball <span class="main">(</span><span class="main">0</span><span class="main">::</span><span class="tfree">'a</span><span class="main">)</span> <span class="free">r</span>›</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">‹<span class="main">-</span><span class="skolem">ξ</span> <span class="main">∈</span> ball <span class="main">(</span><span class="main">0</span><span class="main">::</span><span class="tfree">'a</span><span class="main">)</span> <span class="free">r</span>›</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> 
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> <span class="main"><span class="main">(</span></span>no_types<span class="main"><span class="main">,</span></span> lifting<span class="main"><span class="main">)</span></span> diff_minus_eq_add image_iff<span class="main">)</span>          
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">have</span></span> bdd_above_6<span class="main">:</span> <span class="quoted"><span class="quoted">‹bdd_above <span class="main">(</span><span class="main">(</span><span class="main">λ</span><span class="bound">ξ</span><span class="main">.</span> <span class="main">∥</span><span class="free">f</span> <span class="keyword1">*<span class="hidden">⇩</span><sub>v</sub></span> <span class="main">(</span><span class="free">x</span> <span class="main">-</span> <span class="bound">ξ</span><span class="main">)</span><span class="main">∥</span><span class="main">)</span> <span class="main">`</span> ball <span class="main">0</span> <span class="free">r</span><span class="main">)</span>›</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> bdd_above_4<span class="main">)</span>   
  <span class="keyword1"><span class="command">have</span></span> Sup_2<span class="main">:</span> <span class="quoted"><span class="quoted">‹<span class="main">(</span><span class="keyword1">SUP</span> <span class="bound">ξ</span><span class="main">∈</span>ball <span class="main">0</span> <span class="free">r</span><span class="main">.</span> max <span class="main">∥</span><span class="free">f</span> <span class="keyword1">*<span class="hidden">⇩</span><sub>v</sub></span> <span class="main">(</span><span class="free">x</span> <span class="main">+</span> <span class="bound">ξ</span><span class="main">)</span><span class="main">∥</span> <span class="main">∥</span><span class="free">f</span> <span class="keyword1">*<span class="hidden">⇩</span><sub>v</sub></span> <span class="main">(</span><span class="free">x</span> <span class="main">-</span> <span class="bound">ξ</span><span class="main">)</span><span class="main">∥</span><span class="main">)</span> <span class="main">=</span>
                 max <span class="main">(</span><span class="keyword1">SUP</span> <span class="bound">ξ</span><span class="main">∈</span>ball <span class="main">0</span> <span class="free">r</span><span class="main">.</span> <span class="main">∥</span><span class="free">f</span> <span class="keyword1">*<span class="hidden">⇩</span><sub>v</sub></span> <span class="main">(</span><span class="free">x</span> <span class="main">+</span> <span class="bound">ξ</span><span class="main">)</span><span class="main">∥</span><span class="main">)</span> <span class="main">(</span><span class="keyword1">SUP</span> <span class="bound">ξ</span><span class="main">∈</span>ball <span class="main">0</span> <span class="free">r</span><span class="main">.</span> <span class="main">∥</span><span class="free">f</span> <span class="keyword1">*<span class="hidden">⇩</span><sub>v</sub></span> <span class="main">(</span><span class="free">x</span> <span class="main">-</span> <span class="bound">ξ</span><span class="main">)</span><span class="main">∥</span><span class="main">)</span>›</span></span>
  <span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹ball <span class="main">(</span><span class="main">0</span><span class="main">::</span><span class="tfree">'a</span><span class="main">)</span> <span class="free">r</span> <span class="main">≠</span> <span class="main">{}</span>›</span></span>
      <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="free">r</span> <span class="main">&gt;</span> <span class="main">0</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹bdd_above <span class="main">(</span><span class="main">(</span><span class="main">λ</span><span class="bound">ξ</span><span class="main">.</span> <span class="main">∥</span><span class="free">f</span> <span class="keyword1">*<span class="hidden">⇩</span><sub>v</sub></span> <span class="main">(</span><span class="free">x</span> <span class="main">+</span> <span class="bound">ξ</span><span class="main">)</span><span class="main">∥</span><span class="main">)</span> <span class="main">`</span> ball <span class="main">0</span> <span class="free">r</span><span class="main">)</span>›</span></span>
      <span class="keyword1"><span class="command">using</span></span> bdd_above_5 <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
    <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹bdd_above <span class="main">(</span><span class="main">(</span><span class="main">λ</span><span class="bound">ξ</span><span class="main">.</span> <span class="main">∥</span><span class="free">f</span> <span class="keyword1">*<span class="hidden">⇩</span><sub>v</sub></span> <span class="main">(</span><span class="free">x</span> <span class="main">-</span> <span class="bound">ξ</span><span class="main">)</span><span class="main">∥</span><span class="main">)</span> <span class="main">`</span> ball <span class="main">0</span> <span class="free">r</span><span class="main">)</span>›</span></span>
      <span class="keyword1"><span class="command">using</span></span> bdd_above_6 <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
    <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
      <span class="keyword1"><span class="command">using</span></span> max_Sup
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> <span class="main"><span class="main">(</span></span>mono_tags<span class="main"><span class="main">,</span></span> lifting<span class="main"><span class="main">)</span></span> Banach_Steinhaus_Missing.pointwise_max_def image_cong<span class="main">)</span> 
  <span class="keyword1"><span class="command">qed</span></span> 
  <span class="keyword1"><span class="command">have</span></span> Sup_3'<span class="main">:</span> <span class="quoted"><span class="quoted">‹<span class="main">∥</span><span class="skolem">ξ</span><span class="main">∥</span> <span class="main">&lt;</span> <span class="free">r</span> <span class="main">⟹</span> <span class="main">∥</span><span class="free">f</span> <span class="keyword1">*<span class="hidden">⇩</span><sub>v</sub></span> <span class="main">(</span><span class="free">x</span> <span class="main">+</span> <span class="skolem">ξ</span><span class="main">)</span><span class="main">∥</span> <span class="main">∈</span> <span class="main">(</span><span class="main">λ</span><span class="bound">ξ</span><span class="main">.</span> <span class="main">∥</span><span class="free">f</span> <span class="keyword1">*<span class="hidden">⇩</span><sub>v</sub></span> <span class="main">(</span><span class="free">x</span> <span class="main">-</span> <span class="bound">ξ</span><span class="main">)</span><span class="main">∥</span><span class="main">)</span> <span class="main">`</span> ball <span class="main">0</span> <span class="free">r</span>›</span></span> <span class="keyword2"><span class="keyword">for</span></span> <span class="skolem">ξ</span><span class="main">::</span><span class="tfree"><span class="quoted"><span class="tfree">'a</span></span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> norm_2'<span class="main">)</span>
  <span class="keyword1"><span class="command">have</span></span> Sup_3''<span class="main">:</span> <span class="quoted"><span class="quoted">‹<span class="main">∥</span><span class="skolem">ξ</span><span class="main">∥</span> <span class="main">&lt;</span> <span class="free">r</span> <span class="main">⟹</span> <span class="main">∥</span><span class="free">f</span> <span class="keyword1">*<span class="hidden">⇩</span><sub>v</sub></span> <span class="main">(</span><span class="free">x</span> <span class="main">-</span> <span class="skolem">ξ</span><span class="main">)</span><span class="main">∥</span> <span class="main">∈</span> <span class="main">(</span><span class="main">λ</span><span class="bound">ξ</span><span class="main">.</span> <span class="main">∥</span><span class="free">f</span> <span class="keyword1">*<span class="hidden">⇩</span><sub>v</sub></span> <span class="main">(</span><span class="free">x</span> <span class="main">+</span> <span class="bound">ξ</span><span class="main">)</span><span class="main">∥</span><span class="main">)</span> <span class="main">`</span> ball <span class="main">0</span> <span class="free">r</span>›</span></span> <span class="keyword2"><span class="keyword">for</span></span> <span class="skolem">ξ</span><span class="main">::</span><span class="tfree"><span class="quoted"><span class="tfree">'a</span></span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> norm_2<span class="main">)</span>  
  <span class="keyword1"><span class="command">have</span></span> Sup_3<span class="main">:</span> <span class="quoted"><span class="quoted">‹max <span class="main">(</span><span class="keyword1">SUP</span> <span class="bound">ξ</span><span class="main">∈</span>ball <span class="main">0</span> <span class="free">r</span><span class="main">.</span> <span class="main">∥</span><span class="free">f</span> <span class="keyword1">*<span class="hidden">⇩</span><sub>v</sub></span> <span class="main">(</span><span class="free">x</span> <span class="main">+</span> <span class="bound">ξ</span><span class="main">)</span><span class="main">∥</span><span class="main">)</span> <span class="main">(</span><span class="keyword1">SUP</span> <span class="bound">ξ</span><span class="main">∈</span>ball <span class="main">0</span> <span class="free">r</span><span class="main">.</span>  <span class="main">∥</span><span class="free">f</span> <span class="keyword1">*<span class="hidden">⇩</span><sub>v</sub></span> <span class="main">(</span><span class="free">x</span> <span class="main">-</span> <span class="bound">ξ</span><span class="main">)</span><span class="main">∥</span><span class="main">)</span> <span class="main">=</span>
        <span class="main">(</span><span class="keyword1">SUP</span> <span class="bound">ξ</span><span class="main">∈</span>ball <span class="main">0</span> <span class="free">r</span><span class="main">.</span> <span class="main">∥</span><span class="free">f</span> <span class="keyword1">*<span class="hidden">⇩</span><sub>v</sub></span> <span class="main">(</span><span class="free">x</span> <span class="main">+</span> <span class="bound">ξ</span><span class="main">)</span><span class="main">∥</span><span class="main">)</span>›</span></span>
  <span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹<span class="main">(</span><span class="main">λ</span><span class="bound">ξ</span><span class="main">.</span> <span class="main">∥</span><span class="free">f</span> <span class="keyword1">*<span class="hidden">⇩</span><sub>v</sub></span> <span class="main">(</span><span class="free">x</span> <span class="main">+</span> <span class="bound">ξ</span><span class="main">)</span><span class="main">∥</span><span class="main">)</span> <span class="main">`</span> <span class="main">(</span>ball <span class="main">0</span> <span class="free">r</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="main">λ</span><span class="bound">ξ</span><span class="main">.</span> <span class="main">∥</span><span class="free">f</span> <span class="keyword1">*<span class="hidden">⇩</span><sub>v</sub></span> <span class="main">(</span><span class="free">x</span> <span class="main">-</span> <span class="bound">ξ</span><span class="main">)</span><span class="main">∥</span><span class="main">)</span> <span class="main">`</span> <span class="main">(</span>ball <span class="main">0</span> <span class="free">r</span><span class="main">)</span>›</span></span>
      <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="operator">auto</span> <span class="keyword1"><span class="command">using</span></span> Sup_3' <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="operator">auto</span> <span class="keyword1"><span class="command">using</span></span> Sup_3'' <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
    <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">‹Sup <span class="main">(</span><span class="main">(</span><span class="main">λ</span><span class="bound">ξ</span><span class="main">.</span> <span class="main">∥</span><span class="free">f</span> <span class="keyword1">*<span class="hidden">⇩</span><sub>v</sub></span> <span class="main">(</span><span class="free">x</span> <span class="main">+</span> <span class="bound">ξ</span><span class="main">)</span><span class="main">∥</span><span class="main">)</span> <span class="main">`</span> <span class="main">(</span>ball <span class="main">0</span> <span class="free">r</span><span class="main">)</span><span class="main">)</span><span class="main">=</span>Sup <span class="main">(</span><span class="main">(</span><span class="main">λ</span><span class="bound">ξ</span><span class="main">.</span> <span class="main">∥</span><span class="free">f</span> <span class="keyword1">*<span class="hidden">⇩</span><sub>v</sub></span> <span class="main">(</span><span class="free">x</span> <span class="main">-</span> <span class="bound">ξ</span><span class="main">)</span><span class="main">∥</span><span class="main">)</span> <span class="main">`</span> <span class="main">(</span>ball <span class="main">0</span> <span class="free">r</span><span class="main">)</span><span class="main">)</span>›</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">have</span></span> Sup_1<span class="main">:</span> <span class="quoted"><span class="quoted">‹Sup <span class="main">(</span><span class="main">(</span><span class="main">λ</span><span class="bound">t</span><span class="main">.</span> <span class="main">∥</span><span class="free">f</span> <span class="keyword1">*<span class="hidden">⇩</span><sub>v</sub></span> <span class="bound">t</span><span class="main">∥</span><span class="main">)</span> <span class="main">`</span> <span class="main">(</span>ball <span class="main">0</span> <span class="free">r</span><span class="main">)</span><span class="main">)</span> <span class="main">≤</span> Sup <span class="main">(</span> <span class="main">(</span><span class="main">λ</span><span class="bound">ξ</span><span class="main">.</span> <span class="main">∥</span><span class="free">f</span> <span class="keyword1">*<span class="hidden">⇩</span><sub>v</sub></span> <span class="bound">ξ</span><span class="main">∥</span><span class="main">)</span> <span class="main">`</span> <span class="main">(</span>ball <span class="free">x</span> <span class="free">r</span><span class="main">)</span> <span class="main">)</span>›</span></span> 
  <span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹<span class="main">(</span><span class="main">λ</span><span class="bound">t</span><span class="main">.</span> <span class="main">∥</span><span class="free">f</span> <span class="keyword1">*<span class="hidden">⇩</span><sub>v</sub></span> <span class="bound">t</span><span class="main">∥</span><span class="main">)</span> <span class="skolem">ξ</span> <span class="main">≤</span> max <span class="main">∥</span><span class="free">f</span> <span class="keyword1">*<span class="hidden">⇩</span><sub>v</sub></span> <span class="main">(</span><span class="free">x</span> <span class="main">+</span> <span class="skolem">ξ</span><span class="main">)</span><span class="main">∥</span> <span class="main">∥</span><span class="free">f</span> <span class="keyword1">*<span class="hidden">⇩</span><sub>v</sub></span> <span class="main">(</span><span class="free">x</span> <span class="main">-</span> <span class="skolem">ξ</span><span class="main">)</span><span class="main">∥</span>›</span></span> <span class="keyword2"><span class="keyword">for</span></span> <span class="skolem">ξ</span>
      <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="main">(</span><span class="operator">rule</span> linear_plus_norm<span class="main">)</span> <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">rule</span> bounded_linear.linear<span class="main">)</span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> blinfun.bounded_linear_right<span class="main">)</span>
    <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹bdd_above <span class="main">(</span><span class="main">(</span><span class="main">λ</span> <span class="bound">ξ</span><span class="main">.</span> max <span class="main">∥</span><span class="free">f</span> <span class="keyword1">*<span class="hidden">⇩</span><sub>v</sub></span> <span class="main">(</span><span class="free">x</span> <span class="main">+</span> <span class="bound">ξ</span><span class="main">)</span><span class="main">∥</span>  <span class="main">∥</span><span class="free">f</span> <span class="keyword1">*<span class="hidden">⇩</span><sub>v</sub></span> <span class="main">(</span><span class="free">x</span> <span class="main">-</span> <span class="bound">ξ</span><span class="main">)</span><span class="main">∥</span><span class="main">)</span> <span class="main">`</span> <span class="main">(</span>ball <span class="main">0</span> <span class="free">r</span><span class="main">)</span><span class="main">)</span>›</span></span> 
      <span class="keyword1"><span class="command">using</span></span> bdd_above_1 <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
    <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹ball <span class="main">(</span><span class="main">0</span><span class="main">::</span><span class="tfree">'a</span><span class="main">)</span> <span class="free">r</span> <span class="main">≠</span> <span class="main">{}</span>›</span></span>
      <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="free">r</span> <span class="main">&gt;</span> <span class="main">0</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>      
    <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹Sup <span class="main">(</span><span class="main">(</span><span class="main">λ</span><span class="bound">t</span><span class="main">.</span> <span class="main">∥</span><span class="free">f</span> <span class="keyword1">*<span class="hidden">⇩</span><sub>v</sub></span> <span class="bound">t</span><span class="main">∥</span><span class="main">)</span> <span class="main">`</span> <span class="main">(</span>ball <span class="main">0</span> <span class="free">r</span><span class="main">)</span><span class="main">)</span> <span class="main">≤</span>
                     Sup <span class="main">(</span><span class="main">(</span><span class="main">λ</span><span class="bound">ξ</span><span class="main">.</span> max <span class="main">∥</span><span class="free">f</span> <span class="keyword1">*<span class="hidden">⇩</span><sub>v</sub></span> <span class="main">(</span><span class="free">x</span> <span class="main">+</span> <span class="bound">ξ</span><span class="main">)</span><span class="main">∥</span> <span class="main">∥</span><span class="free">f</span> <span class="keyword1">*<span class="hidden">⇩</span><sub>v</sub></span> <span class="main">(</span><span class="free">x</span> <span class="main">-</span> <span class="bound">ξ</span><span class="main">)</span><span class="main">∥</span><span class="main">)</span> <span class="main">`</span> <span class="main">(</span>ball <span class="main">0</span> <span class="free">r</span><span class="main">)</span><span class="main">)</span>›</span></span>
      <span class="keyword1"><span class="command">using</span></span> cSUP_mono <span class="keyword1"><span class="command">by</span></span> <span class="operator">smt</span> 
    <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹<span class="main">…</span> <span class="main">=</span> max <span class="main">(</span>Sup <span class="main">(</span><span class="main">(</span><span class="main">λ</span><span class="bound">ξ</span><span class="main">.</span>  <span class="main">∥</span><span class="free">f</span> <span class="keyword1">*<span class="hidden">⇩</span><sub>v</sub></span> <span class="main">(</span><span class="free">x</span> <span class="main">+</span> <span class="bound">ξ</span><span class="main">)</span><span class="main">∥</span><span class="main">)</span> <span class="main">`</span> <span class="main">(</span>ball <span class="main">0</span> <span class="free">r</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>
                        <span class="main">(</span>Sup <span class="main">(</span><span class="main">(</span><span class="main">λ</span><span class="bound">ξ</span><span class="main">.</span> <span class="main">∥</span><span class="free">f</span> <span class="keyword1">*<span class="hidden">⇩</span><sub>v</sub></span> <span class="main">(</span><span class="free">x</span> <span class="main">-</span> <span class="bound">ξ</span><span class="main">)</span><span class="main">∥</span><span class="main">)</span> <span class="main">`</span> <span class="main">(</span>ball <span class="main">0</span> <span class="free">r</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>›</span></span> 
      <span class="keyword1"><span class="command">using</span></span> Sup_2 <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
    <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹<span class="main">…</span> <span class="main">=</span> Sup <span class="main">(</span><span class="main">(</span><span class="main">λ</span><span class="bound">ξ</span><span class="main">.</span> <span class="main">∥</span><span class="free">f</span> <span class="keyword1">*<span class="hidden">⇩</span><sub>v</sub></span> <span class="main">(</span><span class="free">x</span> <span class="main">+</span> <span class="bound">ξ</span><span class="main">)</span><span class="main">∥</span><span class="main">)</span> <span class="main">`</span> <span class="main">(</span>ball <span class="main">0</span> <span class="free">r</span><span class="main">)</span><span class="main">)</span>›</span></span>
      <span class="keyword1"><span class="command">using</span></span> Sup_3 <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
    <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹<span class="main">…</span> <span class="main">=</span> Sup <span class="main">(</span><span class="main">(</span><span class="main">λ</span><span class="bound">ξ</span><span class="main">.</span> <span class="main">∥</span><span class="free">f</span> <span class="keyword1">*<span class="hidden">⇩</span><sub>v</sub></span> <span class="bound">ξ</span><span class="main">∥</span><span class="main">)</span> <span class="main">`</span> <span class="main">(</span>ball <span class="free">x</span> <span class="free">r</span><span class="main">)</span><span class="main">)</span>›</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span>  add.right_neutral ball_translation image_image<span class="main">)</span>      
    <span class="keyword1"><span class="command">finally</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹<span class="main">∥</span><span class="free">f</span><span class="main">∥</span> <span class="main">=</span> <span class="main">(</span><span class="keyword1">SUP</span> <span class="bound">x</span><span class="main">∈</span>ball <span class="main">0</span> <span class="free">r</span><span class="main">.</span> <span class="main">∥</span><span class="free">f</span> <span class="keyword1">*<span class="hidden">⇩</span><sub>v</sub></span> <span class="bound">x</span><span class="main">∥</span><span class="main">)</span> <span class="main">/</span> <span class="free">r</span>›</span></span>
    <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="main">0</span> <span class="main">&lt;</span> <span class="free">r</span>›</span></span> onorm_r <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹Sup <span class="main">(</span><span class="main">(</span><span class="main">λ</span><span class="bound">t</span><span class="main">.</span> <span class="main">∥</span><span class="free">f</span> <span class="keyword1">*<span class="hidden">⇩</span><sub>v</sub></span> <span class="bound">t</span><span class="main">∥</span><span class="main">)</span> <span class="main">`</span> <span class="main">(</span>ball <span class="main">0</span> <span class="free">r</span><span class="main">)</span><span class="main">)</span> <span class="main">/</span> <span class="free">r</span> <span class="main">≤</span> Sup <span class="main">(</span><span class="main">(</span><span class="main">λ</span><span class="bound">ξ</span><span class="main">.</span> <span class="main">∥</span><span class="free">f</span> <span class="keyword1">*<span class="hidden">⇩</span><sub>v</sub></span> <span class="bound">ξ</span><span class="main">∥</span><span class="main">)</span> <span class="main">`</span> <span class="main">(</span>ball <span class="free">x</span> <span class="free">r</span><span class="main">)</span><span class="main">)</span> <span class="main">/</span> <span class="free">r</span>›</span></span>
    <span class="keyword1"><span class="command">using</span></span> Sup_1 <span class="quoted"><span class="quoted">‹<span class="main">0</span> <span class="main">&lt;</span> <span class="free">r</span>›</span></span> divide_right_mono <span class="keyword1"><span class="command">by</span></span> <span class="operator">fastforce</span> 
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹<span class="main">∥</span><span class="free">f</span><span class="main">∥</span> <span class="main">≤</span> Sup <span class="main">(</span><span class="main">(</span><span class="main">λ</span><span class="bound">t</span><span class="main">.</span> <span class="main">∥</span><span class="free">f</span> <span class="keyword1">*<span class="hidden">⇩</span><sub>v</sub></span> <span class="bound">t</span><span class="main">∥</span><span class="main">)</span> <span class="main">`</span> ball <span class="free">x</span> <span class="free">r</span><span class="main">)</span> <span class="main">/</span> <span class="free">r</span>›</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>    
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">lemma</span></span> onorm_Sup_on_ball'<span class="main">:</span>
  <span class="keyword2"><span class="keyword">includes</span></span> notation_norm
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">‹<span class="free">r</span> <span class="main">&gt;</span> <span class="main">0</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹<span class="free">τ</span> <span class="main">&lt;</span> <span class="main">1</span>›</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">‹<span class="main">∃</span><span class="bound">ξ</span><span class="main">∈</span>ball <span class="free">x</span> <span class="free">r</span><span class="main">.</span>  <span class="free">τ</span> <span class="main">*</span> <span class="free">r</span> <span class="main">*</span> <span class="main">∥</span><span class="free">f</span><span class="main">∥</span> <span class="main">≤</span> <span class="main">∥</span><span class="free">f</span> <span class="keyword1">*<span class="hidden">⇩</span><sub>v</sub></span> <span class="bound">ξ</span><span class="main">∥</span>›</span></span>
  <span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹                 
  In the proof of Banach-Steinhaus theorem, we will use this variation of the 
  lemma <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">text</span></span> <span class="raw_text"><span class="raw_text">onorm_Sup_on_ball</span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span>.

  Explanation: Let <span class="antiquoted"><span class="antiquoted"><span class="operator"><span class="operator"><span class="hidden">\&lt;^</span><span class="control">term</span><span class="hidden">&gt;</span></span></span><span class="quoted"><span class="quoted">‹<span class="free"><span class="free">f</span></span>›</span></span></span></span> be a bounded operator, let <span class="antiquoted"><span class="antiquoted"><span class="operator"><span class="operator"><span class="hidden">\&lt;^</span><span class="control">term</span><span class="hidden">&gt;</span></span></span><span class="quoted"><span class="quoted">‹<span class="free"><span class="free">x</span></span>›</span></span></span></span> be a point and let <span class="antiquoted"><span class="antiquoted"><span class="operator"><span class="operator"><span class="hidden">\&lt;^</span><span class="control">term</span><span class="hidden">&gt;</span></span></span><span class="quoted"><span class="quoted">‹<span class="free"><span class="free">r</span></span>›</span></span></span></span> be a 
  positive real number. For any real number <span class="antiquoted"><span class="antiquoted"><span class="operator"><span class="operator"><span class="hidden">\&lt;^</span><span class="control">term</span><span class="hidden">&gt;</span></span></span><span class="quoted"><span class="quoted">‹<span class="free"><span class="free">τ</span></span> <span class="main"><span class="main">&lt;</span></span> <span class="main"><span class="main">1</span></span>›</span></span></span></span>, there is a point <span class="antiquoted"><span class="antiquoted"><span class="operator"><span class="operator"><span class="hidden">\&lt;^</span><span class="control">term</span><span class="hidden">&gt;</span></span></span><span class="quoted"><span class="quoted">‹<span class="free"><span class="free">ξ</span></span>›</span></span></span></span> in the open ball 
  of radius <span class="antiquoted"><span class="antiquoted"><span class="operator"><span class="operator"><span class="hidden">\&lt;^</span><span class="control">term</span><span class="hidden">&gt;</span></span></span><span class="quoted"><span class="quoted">‹<span class="free"><span class="free">r</span></span>›</span></span></span></span> around <span class="antiquoted"><span class="antiquoted"><span class="operator"><span class="operator"><span class="hidden">\&lt;^</span><span class="control">term</span><span class="hidden">&gt;</span></span></span><span class="quoted"><span class="quoted">‹<span class="free"><span class="free">x</span></span>›</span></span></span></span> such that <span class="antiquoted"><span class="antiquoted"><span class="operator"><span class="operator"><span class="hidden">\&lt;^</span><span class="control">term</span><span class="hidden">&gt;</span></span></span><span class="quoted"><span class="quoted">‹<span class="free"><span class="free">τ</span></span> <span class="main"><span class="main">*</span></span> <span class="free"><span class="free">r</span></span> <span class="main"><span class="main">*</span></span> <span class="main"><span class="main">∥</span></span><span class="free"><span class="free">f</span></span><span class="main"><span class="main">∥</span></span> <span class="main"><span class="main">≤</span></span> <span class="main"><span class="main">∥</span></span><span class="free"><span class="free">f</span></span> <span class="keyword1"><span class="keyword1">*<span class="hidden">⇩</span><sub>v</sub></span></span> <span class="free"><span class="free">ξ</span></span><span class="main"><span class="main">∥</span></span>›</span></span></span></span>.
›</span></span>
<span class="keyword1"><span class="command">proof</span></span><span class="main">(</span><span class="operator">cases</span>  <span class="quoted"><span class="quoted">‹<span class="free">f</span> <span class="main">=</span> <span class="main">0</span>›</span></span><span class="main">)</span>
  <span class="keyword3"><span class="command">case</span></span> True
  <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> assms<span class="main"><span class="main">(</span></span>1<span class="main"><span class="main">)</span></span> centre_in_ball mult_zero_right norm_zero order_refl 
        zero_blinfun.rep_eq<span class="main">)</span> 
<span class="keyword1"><span class="command">next</span></span>
  <span class="keyword3"><span class="command">case</span></span> False
  <span class="keyword1"><span class="command">have</span></span> bdd_above_1<span class="main">:</span> <span class="quoted"><span class="quoted">‹bdd_above <span class="main">(</span><span class="main">(</span><span class="main">λ</span><span class="bound">t</span><span class="main">.</span> <span class="main">∥</span><span class="keyword1">(*<span class="hidden">⇩</span><sub>v</sub>)</span> <span class="skolem">f</span> <span class="bound">t</span><span class="main">∥</span><span class="main">)</span> <span class="main">`</span> ball <span class="free">x</span> <span class="free">r</span><span class="main">)</span>›</span></span> <span class="keyword2"><span class="keyword">for</span></span> <span class="skolem">f</span><span class="main">::</span><span class="quoted"><span class="quoted">‹<span class="tfree">'a</span> <span class="keyword1">⇒<span class="hidden">⇩</span><sub>L</sub></span> <span class="tfree">'b</span>›</span></span>
    <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>1<span class="main">)</span> bounded_linear_image <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> bounded_linear_image 
        blinfun.bounded_linear_right bounded_imp_bdd_above bounded_norm_comp<span class="main">)</span> 
  <span class="keyword1"><span class="command">have</span></span>  <span class="quoted"><span class="quoted">‹norm <span class="free">f</span> <span class="main">&gt;</span> <span class="main">0</span>›</span></span>
    <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="free">f</span> <span class="main">≠</span> <span class="main">0</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹norm <span class="free">f</span> <span class="main">≤</span>  Sup <span class="main">(</span> <span class="main">(</span><span class="main">λ</span><span class="bound">ξ</span><span class="main">.</span>  <span class="main">∥</span><span class="keyword1">(*<span class="hidden">⇩</span><sub>v</sub>)</span> <span class="free">f</span> <span class="bound">ξ</span><span class="main">∥</span><span class="main">)</span> <span class="main">`</span> <span class="main">(</span>ball <span class="free">x</span> <span class="free">r</span><span class="main">)</span> <span class="main">)</span> <span class="main">/</span> <span class="free">r</span>›</span></span>
    <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="free">r</span> <span class="main">&gt;</span> <span class="main">0</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> onorm_Sup_on_ball<span class="main">)</span>  
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">‹<span class="free">r</span> <span class="main">*</span> norm <span class="free">f</span> <span class="main">≤</span>  Sup <span class="main">(</span> <span class="main">(</span><span class="main">λ</span><span class="bound">ξ</span><span class="main">.</span>  <span class="main">∥</span><span class="keyword1">(*<span class="hidden">⇩</span><sub>v</sub>)</span> <span class="free">f</span> <span class="bound">ξ</span><span class="main">∥</span><span class="main">)</span> <span class="main">`</span> <span class="main">(</span>ball <span class="free">x</span> <span class="free">r</span><span class="main">)</span> <span class="main">)</span>›</span></span>
    <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="main">0</span> <span class="main">&lt;</span> <span class="free">r</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">smt</span> divide_strict_right_mono nonzero_mult_div_cancel_left<span class="main">)</span> 
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹<span class="free">τ</span> <span class="main">*</span> <span class="free">r</span> <span class="main">*</span> norm <span class="free">f</span> <span class="main">&lt;</span> <span class="free">r</span> <span class="main">*</span> norm <span class="free">f</span>›</span></span>
    <span class="keyword1"><span class="command">using</span></span>  <span class="quoted"><span class="quoted">‹<span class="free">τ</span> <span class="main">&lt;</span> <span class="main">1</span>›</span></span> <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="main">0</span> <span class="main">&lt;</span> norm <span class="free">f</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="main">0</span> <span class="main">&lt;</span> <span class="free">r</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹<span class="free">τ</span> <span class="main">*</span> <span class="free">r</span> <span class="main">*</span> norm <span class="free">f</span> <span class="main">&lt;</span> Sup <span class="main">(</span> <span class="main">(</span>norm <span class="main">∘</span> <span class="main">(</span><span class="keyword1">(*<span class="hidden">⇩</span><sub>v</sub>)</span> <span class="free">f</span><span class="main">)</span><span class="main">)</span> <span class="main">`</span> <span class="main">(</span>ball <span class="free">x</span> <span class="free">r</span><span class="main">)</span> <span class="main">)</span>›</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹<span class="main">(</span>norm <span class="main">∘</span> <span class="main">(</span> <span class="keyword1">(*<span class="hidden">⇩</span><sub>v</sub>)</span> <span class="free">f</span><span class="main">)</span><span class="main">)</span> <span class="main">`</span> <span class="main">(</span>ball <span class="free">x</span> <span class="free">r</span><span class="main">)</span> <span class="main">≠</span> <span class="main">{}</span>›</span></span>
    <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="main">0</span> <span class="main">&lt;</span> <span class="free">r</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>    
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹bdd_above <span class="main">(</span><span class="main">(</span>norm <span class="main">∘</span> <span class="main">(</span> <span class="keyword1">(*<span class="hidden">⇩</span><sub>v</sub>)</span> <span class="free">f</span><span class="main">)</span><span class="main">)</span> <span class="main">`</span> <span class="main">(</span>ball <span class="free">x</span> <span class="free">r</span><span class="main">)</span><span class="main">)</span>›</span></span>
    <span class="keyword1"><span class="command">using</span></span> bdd_above_1 <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="operator">transfer</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹<span class="main">∃</span><span class="bound">t</span> <span class="main">∈</span> <span class="main">(</span>norm <span class="main">∘</span> <span class="main">(</span> <span class="keyword1">(*<span class="hidden">⇩</span><sub>v</sub>)</span> <span class="free">f</span><span class="main">)</span><span class="main">)</span> <span class="main">`</span> <span class="main">(</span>ball <span class="free">x</span> <span class="free">r</span><span class="main">)</span><span class="main">.</span> <span class="free">τ</span> <span class="main">*</span> <span class="free">r</span> <span class="main">*</span> norm <span class="free">f</span> <span class="main">&lt;</span> <span class="bound">t</span>›</span></span> 
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> less_cSup_iff<span class="main">)</span>    
  <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">smt</span> comp_def image_iff<span class="main">)</span> 
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">subsection</span></span> <span class="quoted"><span class="plain_text">‹Banach-Steinhaus theorem›</span></span>

<span class="keyword1"><span class="command">theorem</span></span> banach_steinhaus<span class="main">:</span>
  <span class="keyword2"><span class="keyword">fixes</span></span> <span class="free">f</span><span class="main">::</span><span class="quoted"><span class="quoted">‹<span class="tfree">'c</span> <span class="main">⇒</span> <span class="main">(</span><span class="tfree">'a</span><span class="main">::</span>banach <span class="keyword1">⇒<span class="hidden">⇩</span><sub>L</sub></span> <span class="tfree">'b</span><span class="main">::</span>real_normed_vector<span class="main">)</span>›</span></span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">‹<span class="main">⋀</span><span class="bound">x</span><span class="main">.</span> bounded <span class="main">(</span>range <span class="main">(</span><span class="main">λ</span><span class="bound">n</span><span class="main">.</span> <span class="main">(</span><span class="free">f</span> <span class="bound">n</span><span class="main">)</span> <span class="keyword1">*<span class="hidden">⇩</span><sub>v</sub></span> <span class="bound">x</span><span class="main">)</span><span class="main">)</span>›</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span>  <span class="quoted"><span class="quoted">‹bounded <span class="main">(</span>range <span class="free">f</span><span class="main">)</span>›</span></span>
  <span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹
  This is Banach-Steinhaus Theorem.

  Explanation: If a family of bounded operators on a Banach space
  is pointwise bounded, then it is uniformly bounded.
›</span></span>
<span class="keyword1"><span class="command">proof</span></span><span class="main">(</span><span class="operator">rule</span> classical<span class="main">)</span>
  <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">‹<span class="main">¬</span><span class="main">(</span>bounded <span class="main">(</span>range <span class="free">f</span><span class="main">)</span><span class="main">)</span>›</span></span>
  <span class="keyword1"><span class="command">have</span></span> sum_1<span class="main">:</span> <span class="quoted"><span class="quoted">‹<span class="main">∃</span><span class="bound">K</span><span class="main">.</span> <span class="main">∀</span><span class="bound">n</span><span class="main">.</span> sum <span class="main">(</span><span class="main">λ</span><span class="bound">k</span><span class="main">.</span> inverse <span class="main">(</span>real_of_nat <span class="numeral">3</span><span class="main">^</span><span class="bound">k</span><span class="main">)</span><span class="main">)</span> <span class="main">{</span><span class="main">0</span><span class="main">..</span><span class="bound">n</span><span class="main">}</span> <span class="main">≤</span> <span class="bound">K</span>›</span></span>
  <span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹summable <span class="main">(</span><span class="main">λ</span><span class="bound">n</span><span class="main">.</span> inverse <span class="main">(</span><span class="main">(</span><span class="numeral">3</span><span class="main">::</span>real<span class="main">)</span> <span class="main">^</span> <span class="bound">n</span><span class="main">)</span><span class="main">)</span>›</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">flip</span><span class="main"><span class="main">:</span></span> power_inverse<span class="main">)</span>
    <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">‹bounded <span class="main">(</span>range <span class="main">(</span><span class="main">λ</span><span class="bound">n</span><span class="main">.</span> sum <span class="main">(</span><span class="main">λ</span> <span class="bound">k</span><span class="main">.</span> inverse <span class="main">(</span>real <span class="numeral">3</span> <span class="main">^</span> <span class="bound">k</span><span class="main">)</span><span class="main">)</span> <span class="main">{</span><span class="main">0</span><span class="main">..&lt;</span><span class="bound">n</span><span class="main">}</span><span class="main">)</span><span class="main">)</span>›</span></span>
      <span class="keyword1"><span class="command">using</span></span> summable_imp_sums_bounded<span class="main">[</span><span class="keyword2"><span class="keyword"><span class="operator">where</span></span></span> f <span class="main"><span class="main">=</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">λ</span><span class="bound">n</span><span class="main">.</span> inverse <span class="main">(</span>real_of_nat <span class="numeral">3</span><span class="main">^</span><span class="bound">n</span><span class="main">)</span><span class="main">)</span>"</span></span><span class="main">]</span>
        lessThan_atLeast0 <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">‹<span class="main">∃</span><span class="bound">M</span><span class="main">.</span> <span class="main">∀</span><span class="bound">h</span><span class="main">∈</span><span class="main">(</span>range <span class="main">(</span><span class="main">λ</span><span class="bound">n</span><span class="main">.</span> sum <span class="main">(</span><span class="main">λ</span> <span class="bound">k</span><span class="main">.</span> inverse <span class="main">(</span>real <span class="numeral">3</span> <span class="main">^</span> <span class="bound">k</span><span class="main">)</span><span class="main">)</span> <span class="main">{</span><span class="main">0</span><span class="main">..&lt;</span><span class="bound">n</span><span class="main">}</span><span class="main">)</span><span class="main">)</span><span class="main">.</span> norm <span class="bound">h</span> <span class="main">≤</span> <span class="bound">M</span>›</span></span>
      <span class="keyword1"><span class="command">using</span></span> bounded_iff <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">M</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">h</span><span class="main">∈</span>range <span class="main">(</span><span class="main">λ</span><span class="bound">n</span><span class="main">.</span> sum <span class="main">(</span><span class="main">λ</span> <span class="bound">k</span><span class="main">.</span> inverse <span class="main">(</span>real <span class="numeral">3</span> <span class="main">^</span> <span class="bound">k</span><span class="main">)</span><span class="main">)</span> <span class="main">{</span><span class="main">0</span><span class="main">..&lt;</span><span class="bound">n</span><span class="main">}</span><span class="main">)</span> <span class="main">⟹</span> norm <span class="skolem">h</span> <span class="main">≤</span> <span class="skolem">M</span>›</span></span> 
      <span class="keyword2"><span class="keyword">for</span></span> <span class="skolem">h</span>
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>      
    <span class="keyword1"><span class="command">have</span></span> sum_2<span class="main">:</span> <span class="quoted"><span class="quoted">‹sum <span class="main">(</span><span class="main">λ</span><span class="bound">k</span><span class="main">.</span> inverse <span class="main">(</span>real_of_nat <span class="numeral">3</span><span class="main">^</span><span class="bound">k</span><span class="main">)</span><span class="main">)</span> <span class="main">{</span><span class="main">0</span><span class="main">..</span><span class="skolem">n</span><span class="main">}</span> <span class="main">≤</span> <span class="skolem">M</span>›</span></span> <span class="keyword2"><span class="keyword">for</span></span> <span class="skolem">n</span>
    <span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
      <span class="keyword1"><span class="command">have</span></span>  <span class="quoted"><span class="quoted">‹norm <span class="main">(</span>sum <span class="main">(</span><span class="main">λ</span> <span class="bound">k</span><span class="main">.</span> inverse <span class="main">(</span>real <span class="numeral">3</span> <span class="main">^</span> <span class="bound">k</span><span class="main">)</span><span class="main">)</span> <span class="main">{</span><span class="main">0</span><span class="main">..&lt;</span> Suc <span class="skolem">n</span><span class="main">}</span><span class="main">)</span> <span class="main">≤</span> <span class="skolem">M</span>›</span></span>
        <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="main">⋀</span><span class="bound">h</span><span class="main">.</span> <span class="bound">h</span><span class="main">∈</span><span class="main">(</span>range <span class="main">(</span><span class="main">λ</span><span class="bound">n</span><span class="main">.</span> sum <span class="main">(</span><span class="main">λ</span> <span class="bound">k</span><span class="main">.</span> inverse <span class="main">(</span>real <span class="numeral">3</span> <span class="main">^</span> <span class="bound">k</span><span class="main">)</span><span class="main">)</span> <span class="main">{</span><span class="main">0</span><span class="main">..&lt;</span><span class="bound">n</span><span class="main">}</span><span class="main">)</span><span class="main">)</span> <span class="main">⟹</span> norm <span class="bound">h</span> <span class="main">≤</span> <span class="skolem">M</span>›</span></span> 
        <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
      <span class="keyword1"><span class="command">hence</span></span>  <span class="quoted"><span class="quoted">‹norm <span class="main">(</span>sum <span class="main">(</span><span class="main">λ</span> <span class="bound">k</span><span class="main">.</span> inverse <span class="main">(</span>real <span class="numeral">3</span> <span class="main">^</span> <span class="bound">k</span><span class="main">)</span><span class="main">)</span> <span class="main">{</span><span class="main">0</span><span class="main">..</span><span class="skolem">n</span><span class="main">}</span><span class="main">)</span> <span class="main">≤</span> <span class="skolem">M</span>›</span></span>
        <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> atLeastLessThanSuc_atLeastAtMost<span class="main">)</span>        
      <span class="keyword1"><span class="command">hence</span></span>  <span class="quoted"><span class="quoted">‹<span class="main">(</span>sum <span class="main">(</span><span class="main">λ</span> <span class="bound">k</span><span class="main">.</span> inverse <span class="main">(</span>real <span class="numeral">3</span> <span class="main">^</span> <span class="bound">k</span><span class="main">)</span><span class="main">)</span> <span class="main">{</span><span class="main">0</span><span class="main">..</span><span class="skolem">n</span><span class="main">}</span><span class="main">)</span> <span class="main">≤</span> <span class="skolem">M</span>›</span></span>
        <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>  <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
    <span class="keyword1"><span class="command">qed</span></span>
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹sum <span class="main">(</span><span class="main">λ</span><span class="bound">k</span><span class="main">.</span> inverse <span class="main">(</span>real_of_nat <span class="numeral">3</span><span class="main">^</span><span class="bound">k</span><span class="main">)</span><span class="main">)</span> <span class="main">{</span><span class="main">0</span><span class="main">..</span><span class="skolem">n</span><span class="main">}</span> <span class="main">≤</span> <span class="skolem">M</span>›</span></span> <span class="keyword2"><span class="keyword">for</span></span> <span class="skolem">n</span> 
      <span class="keyword1"><span class="command">using</span></span> sum_2 <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
    <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>  <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹of_rat <span class="numeral">2</span><span class="main">/</span><span class="numeral">3</span> <span class="main">&lt;</span> <span class="main">(</span><span class="main">1</span><span class="main">::</span>real<span class="main">)</span>›</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">‹<span class="main">∀</span><span class="bound">g</span><span class="main">::</span><span class="tfree">'a</span> <span class="keyword1">⇒<span class="hidden">⇩</span><sub>L</sub></span> <span class="tfree">'b</span><span class="main">.</span> <span class="main">∀</span><span class="bound">x</span><span class="main">.</span> <span class="main">∀</span><span class="bound">r</span><span class="main">.</span> <span class="main">∃</span><span class="bound">ξ</span><span class="main">.</span> <span class="bound">g</span> <span class="main">≠</span> <span class="main">0</span> <span class="main">∧</span> <span class="bound">r</span> <span class="main">&gt;</span> <span class="main">0</span>
               <span class="main">⟶</span> <span class="main">(</span><span class="bound">ξ</span><span class="main">∈</span>ball <span class="bound">x</span> <span class="bound">r</span> <span class="main">∧</span> <span class="main">(</span>of_rat <span class="numeral">2</span><span class="main">/</span><span class="numeral">3</span><span class="main">)</span> <span class="main">*</span> <span class="bound">r</span> <span class="main">*</span> norm <span class="bound">g</span> <span class="main">≤</span> norm <span class="main">(</span><span class="keyword1">(*<span class="hidden">⇩</span><sub>v</sub>)</span> <span class="bound">g</span> <span class="bound">ξ</span><span class="main">)</span><span class="main">)</span>›</span></span> 
    <span class="keyword1"><span class="command">using</span></span> onorm_Sup_on_ball' <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">‹<span class="main">∃</span><span class="bound">ξ</span><span class="main">.</span> <span class="main">∀</span><span class="bound">g</span><span class="main">::</span><span class="tfree">'a</span> <span class="keyword1">⇒<span class="hidden">⇩</span><sub>L</sub></span> <span class="tfree">'b</span><span class="main">.</span> <span class="main">∀</span><span class="bound">x</span><span class="main">.</span> <span class="main">∀</span><span class="bound">r</span><span class="main">.</span> <span class="bound">g</span> <span class="main">≠</span> <span class="main">0</span> <span class="main">∧</span> <span class="bound">r</span> <span class="main">&gt;</span> <span class="main">0</span>
           <span class="main">⟶</span> <span class="main">(</span><span class="main">(</span><span class="bound">ξ</span> <span class="bound">g</span> <span class="bound">x</span> <span class="bound">r</span><span class="main">)</span><span class="main">∈</span>ball <span class="bound">x</span> <span class="bound">r</span> <span class="main">∧</span> <span class="main">(</span>of_rat <span class="numeral">2</span><span class="main">/</span><span class="numeral">3</span><span class="main">)</span> <span class="main">*</span> <span class="bound">r</span> <span class="main">*</span> norm <span class="bound">g</span> <span class="main">≤</span> norm <span class="main">(</span><span class="keyword1">(*<span class="hidden">⇩</span><sub>v</sub>)</span> <span class="bound">g</span> <span class="main">(</span><span class="bound">ξ</span> <span class="bound">g</span> <span class="bound">x</span> <span class="bound">r</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>›</span></span> 
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">metis</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">ξ</span></span> <span class="keyword2"><span class="keyword">where</span></span> f1<span class="main">:</span> <span class="quoted"><span class="quoted">‹<span class="main">⟦</span><span class="skolem">g</span> <span class="main">≠</span> <span class="main">0</span><span class="main">;</span> <span class="skolem">r</span> <span class="main">&gt;</span> <span class="main">0</span><span class="main">⟧</span> <span class="main">⟹</span> 
        <span class="skolem">ξ</span> <span class="skolem">g</span> <span class="skolem">x</span> <span class="skolem">r</span> <span class="main">∈</span> ball <span class="skolem">x</span> <span class="skolem">r</span> <span class="main">∧</span>  <span class="main">(</span>of_rat <span class="numeral">2</span><span class="main">/</span><span class="numeral">3</span><span class="main">)</span> <span class="main">*</span> <span class="skolem">r</span> <span class="main">*</span> norm <span class="skolem">g</span> <span class="main">≤</span> norm <span class="main">(</span><span class="keyword1">(*<span class="hidden">⇩</span><sub>v</sub>)</span> <span class="skolem">g</span> <span class="main">(</span><span class="skolem">ξ</span> <span class="skolem">g</span> <span class="skolem">x</span> <span class="skolem">r</span><span class="main">)</span><span class="main">)</span>›</span></span>
    <span class="keyword2"><span class="keyword">for</span></span> <span class="skolem">g</span><span class="main">::</span><span class="quoted"><span class="quoted">‹<span class="tfree">'a</span> <span class="keyword1">⇒<span class="hidden">⇩</span><sub>L</sub></span> <span class="tfree">'b</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="skolem">x</span> <span class="keyword2"><span class="keyword">and</span></span> <span class="skolem">r</span>
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹<span class="main">∀</span><span class="bound">n</span><span class="main">.</span> <span class="main">∃</span><span class="bound">k</span><span class="main">.</span> norm <span class="main">(</span><span class="free">f</span> <span class="bound">k</span><span class="main">)</span> <span class="main">≥</span> <span class="numeral">4</span><span class="main">^</span><span class="bound">n</span>›</span></span>
    <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="main">¬</span><span class="main">(</span>bounded <span class="main">(</span>range <span class="free">f</span><span class="main">)</span><span class="main">)</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> <span class="main"><span class="main">(</span></span>mono_tags<span class="main"><span class="main">,</span></span> hide_lams<span class="main"><span class="main">)</span></span> boundedI image_iff linear<span class="main">)</span>
  <span class="keyword1"><span class="command">hence</span></span>  <span class="quoted"><span class="quoted">‹<span class="main">∃</span><span class="bound">k</span><span class="main">.</span> <span class="main">∀</span><span class="bound">n</span><span class="main">.</span> norm <span class="main">(</span><span class="free">f</span> <span class="main">(</span><span class="bound">k</span> <span class="bound">n</span><span class="main">)</span><span class="main">)</span> <span class="main">≥</span> <span class="numeral">4</span><span class="main">^</span><span class="bound">n</span>›</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">metis</span>
  <span class="keyword1"><span class="command">hence</span></span>  <span class="quoted"><span class="quoted">‹<span class="main">∃</span><span class="bound">k</span><span class="main">.</span> <span class="main">∀</span><span class="bound">n</span><span class="main">.</span> norm <span class="main">(</span><span class="main">(</span><span class="free">f</span> <span class="main">∘</span> <span class="bound">k</span><span class="main">)</span> <span class="bound">n</span><span class="main">)</span> <span class="main">≥</span> <span class="numeral">4</span><span class="main">^</span><span class="bound">n</span>›</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">k</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">‹norm <span class="main">(</span><span class="main">(</span><span class="free">f</span> <span class="main">∘</span> <span class="skolem">k</span><span class="main">)</span> <span class="skolem">n</span><span class="main">)</span> <span class="main">≥</span> <span class="numeral">4</span><span class="main">^</span><span class="skolem">n</span>›</span></span> <span class="keyword2"><span class="keyword">for</span></span> <span class="skolem">n</span>
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword3"><span class="command">define</span></span> <span class="skolem"><span class="skolem">T</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">T</span> <span class="main">=</span> <span class="free">f</span> <span class="main">∘</span> <span class="skolem">k</span>›</span></span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">T</span> <span class="skolem">n</span> <span class="main">∈</span> range <span class="free">f</span>›</span></span> <span class="keyword2"><span class="keyword">for</span></span> <span class="skolem">n</span>
    <span class="keyword1"><span class="command">unfolding</span></span> T_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>        
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹norm <span class="main">(</span><span class="skolem">T</span> <span class="skolem">n</span><span class="main">)</span> <span class="main">≥</span> of_nat <span class="main">(</span><span class="numeral">4</span><span class="main">^</span><span class="skolem">n</span><span class="main">)</span>›</span></span> <span class="keyword2"><span class="keyword">for</span></span> <span class="skolem">n</span>
    <span class="keyword1"><span class="command">unfolding</span></span> T_def <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="main">⋀</span> <span class="bound">n</span><span class="main">.</span> norm <span class="main">(</span><span class="main">(</span><span class="free">f</span> <span class="main">∘</span> <span class="skolem">k</span><span class="main">)</span> <span class="bound">n</span><span class="main">)</span> <span class="main">≥</span> <span class="numeral">4</span><span class="main">^</span><span class="bound">n</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">T</span> <span class="skolem">n</span> <span class="main">≠</span> <span class="main">0</span>›</span></span> <span class="keyword2"><span class="keyword">for</span></span> <span class="skolem">n</span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">smt</span> T_def <span class="quoted"><span class="quoted">‹<span class="main">⋀</span><span class="bound">n</span><span class="main">.</span> <span class="numeral">4</span> <span class="main">^</span> <span class="bound">n</span> <span class="main">≤</span> norm <span class="main">(</span><span class="main">(</span><span class="free">f</span> <span class="main">∘</span> <span class="skolem">k</span><span class="main">)</span> <span class="bound">n</span><span class="main">)</span>›</span></span> norm_zero power_not_zero zero_le_power<span class="main">)</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹inverse <span class="main">(</span>of_nat <span class="numeral">3</span><span class="main">^</span><span class="skolem">n</span><span class="main">)</span> <span class="main">&gt;</span> <span class="main">(</span><span class="main">0</span><span class="main">::</span>real<span class="main">)</span>›</span></span> <span class="keyword2"><span class="keyword">for</span></span> <span class="skolem">n</span>
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword3"><span class="command">define</span></span> <span class="skolem"><span class="skolem">y</span></span><span class="main">::</span><span class="quoted"><span class="quoted">‹nat <span class="main">⇒</span> <span class="tfree">'a</span>›</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">y</span> <span class="main">=</span> rec_nat <span class="main">0</span> <span class="main">(</span><span class="main">λ</span><span class="bound">n</span> <span class="bound">x</span><span class="main">.</span> <span class="skolem">ξ</span> <span class="main">(</span><span class="skolem">T</span> <span class="bound">n</span><span class="main">)</span> <span class="bound">x</span> <span class="main">(</span>inverse <span class="main">(</span>of_nat <span class="numeral">3</span><span class="main">^</span><span class="bound">n</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>›</span></span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">y</span> <span class="main">(</span>Suc <span class="skolem">n</span><span class="main">)</span> <span class="main">∈</span> ball <span class="main">(</span><span class="skolem">y</span> <span class="skolem">n</span><span class="main">)</span> <span class="main">(</span>inverse <span class="main">(</span>of_nat <span class="numeral">3</span><span class="main">^</span><span class="skolem">n</span><span class="main">)</span><span class="main">)</span>›</span></span> <span class="keyword2"><span class="keyword">for</span></span> <span class="skolem">n</span>
    <span class="keyword1"><span class="command">using</span></span> f1 <span class="quoted"><span class="quoted">‹<span class="main">⋀</span> <span class="bound">n</span><span class="main">.</span> <span class="skolem">T</span> <span class="bound">n</span> <span class="main">≠</span> <span class="main">0</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="main">⋀</span> <span class="bound">n</span><span class="main">.</span> inverse <span class="main">(</span>of_nat <span class="numeral">3</span><span class="main">^</span><span class="bound">n</span><span class="main">)</span> <span class="main">&gt;</span> <span class="main">0</span>›</span></span> <span class="keyword1"><span class="command">unfolding</span></span> y_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">‹norm <span class="main">(</span><span class="skolem">y</span> <span class="main">(</span>Suc <span class="skolem">n</span><span class="main">)</span> <span class="main">-</span> <span class="skolem">y</span> <span class="skolem">n</span><span class="main">)</span> <span class="main">≤</span> inverse <span class="main">(</span>of_nat <span class="numeral">3</span><span class="main">^</span><span class="skolem">n</span><span class="main">)</span>›</span></span> <span class="keyword2"><span class="keyword">for</span></span> <span class="skolem">n</span>
    <span class="keyword1"><span class="command">unfolding</span></span> ball_def <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="operator">auto</span> <span class="keyword1"><span class="command">using</span></span> dist_norm <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">smt</span> norm_minus_commute<span class="main">)</span> 
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹<span class="main">∃</span><span class="bound">K</span><span class="main">.</span> <span class="main">∀</span><span class="bound">n</span><span class="main">.</span> sum <span class="main">(</span><span class="main">λ</span><span class="bound">k</span><span class="main">.</span> inverse <span class="main">(</span>real_of_nat <span class="numeral">3</span><span class="main">^</span><span class="bound">k</span><span class="main">)</span><span class="main">)</span> <span class="main">{</span><span class="main">0</span><span class="main">..</span><span class="bound">n</span><span class="main">}</span> <span class="main">≤</span> <span class="bound">K</span>›</span></span>
    <span class="keyword1"><span class="command">using</span></span> sum_1 <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹Cauchy <span class="skolem">y</span>›</span></span>
    <span class="keyword1"><span class="command">using</span></span> convergent_series_Cauchy<span class="main">[</span><span class="keyword2"><span class="keyword"><span class="operator">where</span></span></span> a <span class="main"><span class="main">=</span></span> <span class="quoted"><span class="quoted">"<span class="main">λ</span><span class="bound">n</span><span class="main">.</span> inverse <span class="main">(</span>of_nat <span class="numeral">3</span><span class="main">^</span><span class="bound">n</span><span class="main">)</span>"</span></span> <span class="keyword2"><span class="keyword"><span class="quasi_keyword">and</span></span></span> φ <span class="main"><span class="main">=</span></span> <span class="quoted"><span class="skolem">y</span></span><span class="main">]</span> dist_norm
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> calculation<span class="main"><span class="main">(</span></span>1<span class="main"><span class="main">)</span></span> calculation<span class="main"><span class="main">(</span></span>2<span class="main"><span class="main">)</span></span><span class="main">)</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">‹<span class="main">∃</span> <span class="bound">x</span><span class="main">.</span> <span class="skolem">y</span> <span class="main">⇢</span> <span class="bound">x</span>›</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> convergent_eq_Cauchy<span class="main">)</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">x</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">y</span> <span class="main">⇢</span> <span class="skolem">x</span>›</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">have</span></span> norm_2<span class="main">:</span> <span class="quoted"><span class="quoted">‹norm <span class="main">(</span><span class="skolem">x</span> <span class="main">-</span> <span class="skolem">y</span> <span class="main">(</span>Suc <span class="skolem">n</span><span class="main">)</span><span class="main">)</span> <span class="main">≤</span> <span class="main">(</span>inverse <span class="main">(</span>of_nat <span class="numeral">2</span><span class="main">)</span><span class="main">)</span><span class="main">*</span><span class="main">(</span>inverse <span class="main">(</span>of_nat <span class="numeral">3</span><span class="main">^</span><span class="skolem">n</span><span class="main">)</span><span class="main">)</span>›</span></span> <span class="keyword2"><span class="keyword">for</span></span> <span class="skolem">n</span>
  <span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹inverse <span class="main">(</span>real_of_nat <span class="numeral">3</span><span class="main">)</span> <span class="main">&lt;</span> <span class="main">1</span>›</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>        
    <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">y</span> <span class="main">0</span> <span class="main">=</span> <span class="main">0</span>›</span></span>
      <span class="keyword1"><span class="command">using</span></span> y_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹norm <span class="main">(</span><span class="skolem">x</span> <span class="main">-</span> <span class="skolem">y</span> <span class="main">(</span>Suc <span class="skolem">n</span><span class="main">)</span><span class="main">)</span> 
    <span class="main">≤</span> <span class="main">(</span>inverse <span class="main">(</span>of_nat <span class="numeral">3</span><span class="main">)</span><span class="main">)</span> <span class="main">*</span> inverse <span class="main">(</span><span class="main">1</span> <span class="main">-</span> <span class="main">(</span>inverse <span class="main">(</span>of_nat <span class="numeral">3</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">*</span> <span class="main">(</span><span class="main">(</span>inverse <span class="main">(</span>of_nat <span class="numeral">3</span><span class="main">)</span><span class="main">)</span> <span class="main">^</span> <span class="skolem">n</span><span class="main">)</span>›</span></span>
      <span class="keyword1"><span class="command">using</span></span> bound_Cauchy_to_lim<span class="main">[</span><span class="keyword2"><span class="keyword"><span class="operator">where</span></span></span> c <span class="main"><span class="main">=</span></span> <span class="quoted"><span class="quoted">"inverse <span class="main">(</span>of_nat <span class="numeral">3</span><span class="main">)</span>"</span></span> <span class="keyword2"><span class="keyword"><span class="quasi_keyword">and</span></span></span> y <span class="main"><span class="main">=</span></span> <span class="quoted"><span class="skolem">y</span></span> <span class="keyword2"><span class="keyword"><span class="quasi_keyword">and</span></span></span> x <span class="main"><span class="main">=</span></span> <span class="quoted"><span class="skolem">x</span></span><span class="main">]</span>
        power_inverse semiring_norm<span class="main">(</span>77<span class="main">)</span>  <span class="quoted"><span class="quoted">‹<span class="skolem">y</span> <span class="main">⇢</span> <span class="skolem">x</span>›</span></span>
        <span class="quoted"><span class="quoted">‹<span class="main">⋀</span> <span class="bound">n</span><span class="main">.</span> norm <span class="main">(</span><span class="skolem">y</span> <span class="main">(</span>Suc <span class="bound">n</span><span class="main">)</span> <span class="main">-</span> <span class="skolem">y</span> <span class="bound">n</span><span class="main">)</span> <span class="main">≤</span> inverse <span class="main">(</span>of_nat <span class="numeral">3</span><span class="main">^</span><span class="bound">n</span><span class="main">)</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> divide_inverse<span class="main">)</span>
    <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹inverse <span class="main">(</span>real_of_nat <span class="numeral">3</span><span class="main">)</span> <span class="main">*</span> inverse <span class="main">(</span><span class="main">1</span> <span class="main">-</span> <span class="main">(</span>inverse <span class="main">(</span>of_nat <span class="numeral">3</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>
                   <span class="main">=</span> inverse <span class="main">(</span>of_nat <span class="numeral">2</span><span class="main">)</span>›</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> 
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> power_inverse<span class="main">)</span> 
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹norm <span class="main">(</span><span class="skolem">x</span> <span class="main">-</span> <span class="skolem">y</span> <span class="main">(</span>Suc <span class="skolem">n</span><span class="main">)</span><span class="main">)</span> <span class="main">≤</span> <span class="main">(</span>inverse <span class="main">(</span>of_nat <span class="numeral">2</span><span class="main">)</span><span class="main">)</span><span class="main">*</span><span class="main">(</span>inverse <span class="main">(</span>of_nat <span class="numeral">3</span><span class="main">^</span><span class="skolem">n</span><span class="main">)</span><span class="main">)</span>›</span></span> <span class="keyword2"><span class="keyword">for</span></span> <span class="skolem">n</span>
    <span class="keyword1"><span class="command">using</span></span> norm_2 <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹<span class="main">∃</span> <span class="bound">M</span><span class="main">.</span> <span class="main">∀</span> <span class="bound">n</span><span class="main">.</span> norm <span class="main">(</span><span class="keyword1">(*<span class="hidden">⇩</span><sub>v</sub>)</span> <span class="main">(</span><span class="skolem">T</span> <span class="bound">n</span><span class="main">)</span> <span class="skolem">x</span><span class="main">)</span> <span class="main">≤</span> <span class="bound">M</span>›</span></span>
    <span class="keyword1"><span class="command">unfolding</span></span> T_def <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> <span class="quoted"><span class="quoted">‹<span class="main">⋀</span><span class="bound">x</span><span class="main">.</span> bounded <span class="main">(</span>range <span class="main">(</span><span class="main">λ</span><span class="bound">n</span><span class="main">.</span> <span class="keyword1">(*<span class="hidden">⇩</span><sub>v</sub>)</span> <span class="main">(</span><span class="free">f</span> <span class="bound">n</span><span class="main">)</span> <span class="bound">x</span><span class="main">)</span><span class="main">)</span>›</span></span> bounded_iff rangeI<span class="main">)</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">M</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">‹norm <span class="main">(</span><span class="keyword1">(*<span class="hidden">⇩</span><sub>v</sub>)</span> <span class="main">(</span><span class="skolem">T</span> <span class="skolem">n</span><span class="main">)</span> <span class="skolem">x</span><span class="main">)</span> <span class="main">≤</span> <span class="skolem">M</span>›</span></span> <span class="keyword2"><span class="keyword">for</span></span> <span class="skolem">n</span>
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">have</span></span> norm_1<span class="main">:</span> <span class="quoted"><span class="quoted">‹norm <span class="main">(</span><span class="skolem">T</span> <span class="skolem">n</span><span class="main">)</span> <span class="main">*</span> norm <span class="main">(</span><span class="skolem">y</span> <span class="main">(</span>Suc <span class="skolem">n</span><span class="main">)</span> <span class="main">-</span> <span class="skolem">x</span><span class="main">)</span> <span class="main">+</span> norm <span class="main">(</span><span class="keyword1">(*<span class="hidden">⇩</span><sub>v</sub>)</span> <span class="main">(</span><span class="skolem">T</span> <span class="skolem">n</span><span class="main">)</span> <span class="skolem">x</span><span class="main">)</span>
       <span class="main">≤</span> inverse <span class="main">(</span>real <span class="numeral">2</span><span class="main">)</span> <span class="main">*</span> inverse <span class="main">(</span>real <span class="numeral">3</span> <span class="main">^</span> <span class="skolem">n</span><span class="main">)</span> <span class="main">*</span> norm <span class="main">(</span><span class="skolem">T</span> <span class="skolem">n</span><span class="main">)</span> <span class="main">+</span> norm <span class="main">(</span><span class="keyword1">(*<span class="hidden">⇩</span><sub>v</sub>)</span> <span class="main">(</span><span class="skolem">T</span> <span class="skolem">n</span><span class="main">)</span> <span class="skolem">x</span><span class="main">)</span>›</span></span> <span class="keyword2"><span class="keyword">for</span></span> <span class="skolem">n</span>
  <span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>   
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹norm <span class="main">(</span><span class="skolem">y</span> <span class="main">(</span>Suc <span class="skolem">n</span><span class="main">)</span> <span class="main">-</span> <span class="skolem">x</span><span class="main">)</span> <span class="main">≤</span> <span class="main">(</span>inverse <span class="main">(</span>of_nat <span class="numeral">2</span><span class="main">)</span><span class="main">)</span><span class="main">*</span><span class="main">(</span>inverse <span class="main">(</span>of_nat <span class="numeral">3</span><span class="main">^</span><span class="skolem">n</span><span class="main">)</span><span class="main">)</span>›</span></span>
      <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹norm <span class="main">(</span><span class="skolem">x</span> <span class="main">-</span> <span class="skolem">y</span> <span class="main">(</span>Suc <span class="skolem">n</span><span class="main">)</span><span class="main">)</span> <span class="main">≤</span> <span class="main">(</span>inverse <span class="main">(</span>of_nat <span class="numeral">2</span><span class="main">)</span><span class="main">)</span><span class="main">*</span><span class="main">(</span>inverse <span class="main">(</span>of_nat <span class="numeral">3</span><span class="main">^</span><span class="skolem">n</span><span class="main">)</span><span class="main">)</span>›</span></span> 
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> norm_minus_commute<span class="main">)</span>
    <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹norm <span class="main">(</span><span class="skolem">T</span> <span class="skolem">n</span><span class="main">)</span> <span class="main">≥</span> <span class="main">0</span>›</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹norm <span class="main">(</span><span class="skolem">T</span> <span class="skolem">n</span><span class="main">)</span> <span class="main">*</span> norm <span class="main">(</span><span class="skolem">y</span> <span class="main">(</span>Suc <span class="skolem">n</span><span class="main">)</span> <span class="main">-</span> <span class="skolem">x</span><span class="main">)</span> 
                     <span class="main">≤</span> <span class="main">(</span>inverse <span class="main">(</span>of_nat <span class="numeral">2</span><span class="main">)</span><span class="main">)</span><span class="main">*</span><span class="main">(</span>inverse <span class="main">(</span>of_nat <span class="numeral">3</span><span class="main">^</span><span class="skolem">n</span><span class="main">)</span><span class="main">)</span><span class="main">*</span>norm <span class="main">(</span><span class="skolem">T</span> <span class="skolem">n</span><span class="main">)</span>›</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> <span class="quoted"><span class="quoted">‹<span class="main">⋀</span><span class="bound">n</span><span class="main">.</span> <span class="skolem">T</span> <span class="bound">n</span> <span class="main">≠</span> <span class="main">0</span>›</span></span><span class="main">)</span>
    <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>      
  <span class="keyword1"><span class="command">qed</span></span> 
  <span class="keyword1"><span class="command">have</span></span> inverse_2<span class="main">:</span> <span class="quoted"><span class="quoted">‹<span class="main">(</span>inverse <span class="main">(</span>of_nat <span class="numeral">6</span><span class="main">)</span><span class="main">)</span> <span class="main">*</span> inverse <span class="main">(</span>real <span class="numeral">3</span> <span class="main">^</span> <span class="skolem">n</span><span class="main">)</span> <span class="main">*</span> norm <span class="main">(</span><span class="skolem">T</span> <span class="skolem">n</span><span class="main">)</span> 
                  <span class="main">≤</span> norm <span class="main">(</span><span class="keyword1">(*<span class="hidden">⇩</span><sub>v</sub>)</span> <span class="main">(</span><span class="skolem">T</span> <span class="skolem">n</span><span class="main">)</span> <span class="skolem">x</span><span class="main">)</span>›</span></span> <span class="keyword2"><span class="keyword">for</span></span> <span class="skolem">n</span>
  <span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹<span class="main">(</span>of_rat <span class="numeral">2</span><span class="main">/</span><span class="numeral">3</span><span class="main">)</span><span class="main">*</span><span class="main">(</span>inverse <span class="main">(</span>of_nat <span class="numeral">3</span><span class="main">^</span><span class="skolem">n</span><span class="main">)</span><span class="main">)</span><span class="main">*</span>norm <span class="main">(</span><span class="skolem">T</span> <span class="skolem">n</span><span class="main">)</span> <span class="main">≤</span> norm <span class="main">(</span><span class="keyword1">(*<span class="hidden">⇩</span><sub>v</sub>)</span> <span class="main">(</span><span class="skolem">T</span> <span class="skolem">n</span><span class="main">)</span> <span class="main">(</span><span class="skolem">y</span> <span class="main">(</span>Suc <span class="skolem">n</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>›</span></span> 
      <span class="keyword1"><span class="command">using</span></span> f1 <span class="quoted"><span class="quoted">‹<span class="main">⋀</span> <span class="bound">n</span><span class="main">.</span> <span class="skolem">T</span> <span class="bound">n</span> <span class="main">≠</span> <span class="main">0</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="main">⋀</span> <span class="bound">n</span><span class="main">.</span> inverse <span class="main">(</span>of_nat <span class="numeral">3</span><span class="main">^</span><span class="bound">n</span><span class="main">)</span> <span class="main">&gt;</span> <span class="main">0</span>›</span></span> <span class="keyword1"><span class="command">unfolding</span></span> y_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹<span class="main">…</span> <span class="main">=</span> norm <span class="main">(</span><span class="keyword1">(*<span class="hidden">⇩</span><sub>v</sub>)</span> <span class="main">(</span><span class="skolem">T</span> <span class="skolem">n</span><span class="main">)</span> <span class="main">(</span><span class="main">(</span><span class="skolem">y</span> <span class="main">(</span>Suc <span class="skolem">n</span><span class="main">)</span> <span class="main">-</span> <span class="skolem">x</span><span class="main">)</span> <span class="main">+</span> <span class="skolem">x</span><span class="main">)</span><span class="main">)</span>›</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹<span class="main">…</span> <span class="main">=</span> norm <span class="main">(</span><span class="keyword1">(*<span class="hidden">⇩</span><sub>v</sub>)</span> <span class="main">(</span><span class="skolem">T</span> <span class="skolem">n</span><span class="main">)</span> <span class="main">(</span><span class="skolem">y</span> <span class="main">(</span>Suc <span class="skolem">n</span><span class="main">)</span> <span class="main">-</span> <span class="skolem">x</span><span class="main">)</span> <span class="main">+</span> <span class="keyword1">(*<span class="hidden">⇩</span><sub>v</sub>)</span> <span class="main">(</span><span class="skolem">T</span> <span class="skolem">n</span><span class="main">)</span> <span class="skolem">x</span><span class="main">)</span>›</span></span>
      <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="operator">transfer</span> <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="operator">auto</span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> diff_add_cancel linear_simps<span class="main"><span class="main">(</span></span>1<span class="main"><span class="main">)</span></span><span class="main">)</span>
    <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹<span class="main">…</span> <span class="main">≤</span> norm <span class="main">(</span><span class="keyword1">(*<span class="hidden">⇩</span><sub>v</sub>)</span> <span class="main">(</span><span class="skolem">T</span> <span class="skolem">n</span><span class="main">)</span> <span class="main">(</span><span class="skolem">y</span> <span class="main">(</span>Suc <span class="skolem">n</span><span class="main">)</span> <span class="main">-</span> <span class="skolem">x</span><span class="main">)</span><span class="main">)</span> <span class="main">+</span> norm <span class="main">(</span><span class="keyword1">(*<span class="hidden">⇩</span><sub>v</sub>)</span> <span class="main">(</span><span class="skolem">T</span> <span class="skolem">n</span><span class="main">)</span> <span class="skolem">x</span><span class="main">)</span>›</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> norm_triangle_ineq<span class="main">)</span>
    <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹<span class="main">…</span> <span class="main">≤</span> norm <span class="main">(</span><span class="skolem">T</span> <span class="skolem">n</span><span class="main">)</span> <span class="main">*</span> norm <span class="main">(</span><span class="skolem">y</span> <span class="main">(</span>Suc <span class="skolem">n</span><span class="main">)</span> <span class="main">-</span> <span class="skolem">x</span><span class="main">)</span> <span class="main">+</span> norm <span class="main">(</span><span class="keyword1">(*<span class="hidden">⇩</span><sub>v</sub>)</span> <span class="main">(</span><span class="skolem">T</span> <span class="skolem">n</span><span class="main">)</span> <span class="skolem">x</span><span class="main">)</span>›</span></span>
      <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="operator">transfer</span> <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="operator">auto</span> <span class="keyword1"><span class="command">using</span></span> onorm <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span> 
    <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹<span class="main">…</span> <span class="main">≤</span> <span class="main">(</span>inverse <span class="main">(</span>of_nat <span class="numeral">2</span><span class="main">)</span><span class="main">)</span><span class="main">*</span><span class="main">(</span>inverse <span class="main">(</span>of_nat <span class="numeral">3</span><span class="main">^</span><span class="skolem">n</span><span class="main">)</span><span class="main">)</span><span class="main">*</span>norm <span class="main">(</span><span class="skolem">T</span> <span class="skolem">n</span><span class="main">)</span> 
                <span class="main">+</span> norm <span class="main">(</span><span class="keyword1">(*<span class="hidden">⇩</span><sub>v</sub>)</span> <span class="main">(</span><span class="skolem">T</span> <span class="skolem">n</span><span class="main">)</span> <span class="skolem">x</span><span class="main">)</span>›</span></span>
      <span class="keyword1"><span class="command">using</span></span> norm_1 <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
    <span class="keyword1"><span class="command">finally</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹<span class="main">(</span>of_rat <span class="numeral">2</span><span class="main">/</span><span class="numeral">3</span><span class="main">)</span> <span class="main">*</span> inverse <span class="main">(</span>real <span class="numeral">3</span> <span class="main">^</span> <span class="skolem">n</span><span class="main">)</span> <span class="main">*</span> norm <span class="main">(</span><span class="skolem">T</span> <span class="skolem">n</span><span class="main">)</span>
                <span class="main">≤</span> inverse <span class="main">(</span>real <span class="numeral">2</span><span class="main">)</span> <span class="main">*</span> inverse <span class="main">(</span>real <span class="numeral">3</span> <span class="main">^</span> <span class="skolem">n</span><span class="main">)</span> <span class="main">*</span> norm <span class="main">(</span><span class="skolem">T</span> <span class="skolem">n</span><span class="main">)</span> 
                <span class="main">+</span> norm <span class="main">(</span><span class="keyword1">(*<span class="hidden">⇩</span><sub>v</sub>)</span> <span class="main">(</span><span class="skolem">T</span> <span class="skolem">n</span><span class="main">)</span> <span class="skolem">x</span><span class="main">)</span>›</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
    <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">‹<span class="main">(</span>of_rat <span class="numeral">2</span><span class="main">/</span><span class="numeral">3</span><span class="main">)</span> <span class="main">*</span> inverse <span class="main">(</span>real <span class="numeral">3</span> <span class="main">^</span> <span class="skolem">n</span><span class="main">)</span> <span class="main">*</span> norm <span class="main">(</span><span class="skolem">T</span> <span class="skolem">n</span><span class="main">)</span> 
             <span class="main">-</span> inverse <span class="main">(</span>real <span class="numeral">2</span><span class="main">)</span> <span class="main">*</span> inverse <span class="main">(</span>real <span class="numeral">3</span> <span class="main">^</span> <span class="skolem">n</span><span class="main">)</span> <span class="main">*</span> norm <span class="main">(</span><span class="skolem">T</span> <span class="skolem">n</span><span class="main">)</span> <span class="main">≤</span> norm <span class="main">(</span><span class="keyword1">(*<span class="hidden">⇩</span><sub>v</sub>)</span> <span class="main">(</span><span class="skolem">T</span> <span class="skolem">n</span><span class="main">)</span> <span class="skolem">x</span><span class="main">)</span>›</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">linarith</span>
    <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹<span class="main">(</span>of_rat <span class="numeral">2</span><span class="main">/</span><span class="numeral">3</span><span class="main">)</span> <span class="main">*</span> inverse <span class="main">(</span>real <span class="numeral">3</span> <span class="main">^</span> <span class="skolem">n</span><span class="main">)</span> <span class="main">*</span> norm <span class="main">(</span><span class="skolem">T</span> <span class="skolem">n</span><span class="main">)</span> 
             <span class="main">-</span> inverse <span class="main">(</span>real <span class="numeral">2</span><span class="main">)</span> <span class="main">*</span> inverse <span class="main">(</span>real <span class="numeral">3</span> <span class="main">^</span> <span class="skolem">n</span><span class="main">)</span> <span class="main">*</span> norm <span class="main">(</span><span class="skolem">T</span> <span class="skolem">n</span><span class="main">)</span>
             <span class="main">=</span> <span class="main">(</span>inverse <span class="main">(</span>of_nat <span class="numeral">6</span><span class="main">)</span><span class="main">)</span> <span class="main">*</span> inverse <span class="main">(</span>real <span class="numeral">3</span> <span class="main">^</span> <span class="skolem">n</span><span class="main">)</span> <span class="main">*</span> norm <span class="main">(</span><span class="skolem">T</span> <span class="skolem">n</span><span class="main">)</span>›</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">fastforce</span>
    <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">‹<span class="main">(</span>inverse <span class="main">(</span>of_nat <span class="numeral">6</span><span class="main">)</span><span class="main">)</span> <span class="main">*</span> inverse <span class="main">(</span>real <span class="numeral">3</span> <span class="main">^</span> <span class="skolem">n</span><span class="main">)</span> <span class="main">*</span> norm <span class="main">(</span><span class="skolem">T</span> <span class="skolem">n</span><span class="main">)</span> <span class="main">≤</span> norm <span class="main">(</span><span class="keyword1">(*<span class="hidden">⇩</span><sub>v</sub>)</span> <span class="main">(</span><span class="skolem">T</span> <span class="skolem">n</span><span class="main">)</span> <span class="skolem">x</span><span class="main">)</span>›</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">linarith</span>      
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">have</span></span> inverse_3<span class="main">:</span> <span class="quoted"><span class="quoted">‹<span class="main">(</span>inverse <span class="main">(</span>of_nat <span class="numeral">6</span><span class="main">)</span><span class="main">)</span> <span class="main">*</span> <span class="main">(</span>of_rat <span class="main">(</span><span class="numeral">4</span><span class="main">/</span><span class="numeral">3</span><span class="main">)</span><span class="main">^</span><span class="skolem">n</span><span class="main">)</span> 
                    <span class="main">≤</span> <span class="main">(</span>inverse <span class="main">(</span>of_nat <span class="numeral">6</span><span class="main">)</span><span class="main">)</span> <span class="main">*</span> inverse <span class="main">(</span>real <span class="numeral">3</span> <span class="main">^</span> <span class="skolem">n</span><span class="main">)</span> <span class="main">*</span> norm <span class="main">(</span><span class="skolem">T</span> <span class="skolem">n</span><span class="main">)</span>›</span></span> <span class="keyword2"><span class="keyword">for</span></span> <span class="skolem">n</span>
  <span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹of_rat <span class="main">(</span><span class="numeral">4</span><span class="main">/</span><span class="numeral">3</span><span class="main">)</span><span class="main">^</span><span class="skolem">n</span> <span class="main">=</span> inverse <span class="main">(</span>real <span class="numeral">3</span> <span class="main">^</span> <span class="skolem">n</span><span class="main">)</span> <span class="main">*</span> <span class="main">(</span>of_nat <span class="numeral">4</span><span class="main">^</span><span class="skolem">n</span><span class="main">)</span>›</span></span>
      <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="operator">auto</span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> divide_inverse_commute of_rat_divide power_divide of_rat_numeral_eq<span class="main">)</span> 
    <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹<span class="main">…</span> <span class="main">≤</span>  inverse <span class="main">(</span>real <span class="numeral">3</span> <span class="main">^</span> <span class="skolem">n</span><span class="main">)</span> <span class="main">*</span> norm <span class="main">(</span><span class="skolem">T</span> <span class="skolem">n</span><span class="main">)</span>›</span></span>
      <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="main">⋀</span><span class="bound">n</span><span class="main">.</span> norm <span class="main">(</span><span class="skolem">T</span> <span class="bound">n</span><span class="main">)</span> <span class="main">≥</span> of_nat <span class="main">(</span><span class="numeral">4</span><span class="main">^</span><span class="bound">n</span><span class="main">)</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">finally</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹of_rat <span class="main">(</span><span class="numeral">4</span><span class="main">/</span><span class="numeral">3</span><span class="main">)</span><span class="main">^</span><span class="skolem">n</span> <span class="main">≤</span> inverse <span class="main">(</span>real <span class="numeral">3</span> <span class="main">^</span> <span class="skolem">n</span><span class="main">)</span> <span class="main">*</span> norm <span class="main">(</span><span class="skolem">T</span> <span class="skolem">n</span><span class="main">)</span>›</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
    <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹inverse <span class="main">(</span>of_nat <span class="numeral">6</span><span class="main">)</span> <span class="main">&gt;</span> <span class="main">(</span><span class="main">0</span><span class="main">::</span>real<span class="main">)</span>›</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">have</span></span> inverse_1<span class="main">:</span> <span class="quoted"><span class="quoted">‹<span class="main">(</span>inverse <span class="main">(</span>of_nat <span class="numeral">6</span><span class="main">)</span><span class="main">)</span> <span class="main">*</span> <span class="main">(</span>of_rat <span class="main">(</span><span class="numeral">4</span><span class="main">/</span><span class="numeral">3</span><span class="main">)</span><span class="main">^</span><span class="skolem">n</span><span class="main">)</span> <span class="main">≤</span> <span class="skolem">M</span>›</span></span> <span class="keyword2"><span class="keyword">for</span></span> <span class="skolem">n</span>
  <span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹<span class="main">(</span>inverse <span class="main">(</span>of_nat <span class="numeral">6</span><span class="main">)</span><span class="main">)</span> <span class="main">*</span> <span class="main">(</span>of_rat <span class="main">(</span><span class="numeral">4</span><span class="main">/</span><span class="numeral">3</span><span class="main">)</span><span class="main">^</span><span class="skolem">n</span><span class="main">)</span> 
          <span class="main">≤</span> <span class="main">(</span>inverse <span class="main">(</span>of_nat <span class="numeral">6</span><span class="main">)</span><span class="main">)</span> <span class="main">*</span> inverse <span class="main">(</span>real <span class="numeral">3</span> <span class="main">^</span> <span class="skolem">n</span><span class="main">)</span> <span class="main">*</span> norm <span class="main">(</span><span class="skolem">T</span> <span class="skolem">n</span><span class="main">)</span>›</span></span> 
      <span class="keyword1"><span class="command">using</span></span> inverse_3 <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
    <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹<span class="main">…</span> <span class="main">≤</span> norm <span class="main">(</span><span class="keyword1">(*<span class="hidden">⇩</span><sub>v</sub>)</span> <span class="main">(</span><span class="skolem">T</span> <span class="skolem">n</span><span class="main">)</span> <span class="skolem">x</span><span class="main">)</span>›</span></span> 
      <span class="keyword1"><span class="command">using</span></span> inverse_2 <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
    <span class="keyword1"><span class="command">finally</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹<span class="main">(</span>inverse <span class="main">(</span>of_nat <span class="numeral">6</span><span class="main">)</span><span class="main">)</span> <span class="main">*</span> <span class="main">(</span>of_rat <span class="main">(</span><span class="numeral">4</span><span class="main">/</span><span class="numeral">3</span><span class="main">)</span><span class="main">^</span><span class="skolem">n</span><span class="main">)</span> <span class="main">≤</span> norm <span class="main">(</span><span class="keyword1">(*<span class="hidden">⇩</span><sub>v</sub>)</span> <span class="main">(</span><span class="skolem">T</span> <span class="skolem">n</span><span class="main">)</span> <span class="skolem">x</span><span class="main">)</span>›</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="main">⋀</span> <span class="bound">n</span><span class="main">.</span> norm <span class="main">(</span><span class="keyword1">(*<span class="hidden">⇩</span><sub>v</sub>)</span> <span class="main">(</span><span class="skolem">T</span> <span class="bound">n</span><span class="main">)</span> <span class="skolem">x</span><span class="main">)</span> <span class="main">≤</span> <span class="skolem">M</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">smt</span>
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹<span class="main">∃</span><span class="bound">n</span><span class="main">.</span> <span class="skolem">M</span> <span class="main">&lt;</span> <span class="main">(</span>inverse <span class="main">(</span>of_nat <span class="numeral">6</span><span class="main">)</span><span class="main">)</span> <span class="main">*</span> <span class="main">(</span>of_rat <span class="main">(</span><span class="numeral">4</span><span class="main">/</span><span class="numeral">3</span><span class="main">)</span><span class="main">^</span><span class="bound">n</span><span class="main">)</span>›</span></span>
    <span class="keyword1"><span class="command">using</span></span> Real.real_arch_pow <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹<span class="main">(</span>inverse <span class="main">(</span>of_nat <span class="numeral">6</span><span class="main">)</span><span class="main">)</span> <span class="main">*</span> <span class="main">(</span>of_rat <span class="main">(</span><span class="numeral">4</span><span class="main">/</span><span class="numeral">3</span><span class="main">)</span><span class="main">^</span><span class="skolem">n</span><span class="main">)</span> <span class="main">≤</span> <span class="skolem">M</span>›</span></span> <span class="keyword2"><span class="keyword">for</span></span> <span class="skolem">n</span>
    <span class="keyword1"><span class="command">using</span></span> inverse_1 <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>                      
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">smt</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">subsection</span></span> <span class="quoted"><span class="plain_text">‹A consequence of Banach-Steinhaus theorem›</span></span>

<span class="keyword1"><span class="command">corollary</span></span> bounded_linear_limit_bounded_linear<span class="main">:</span>
  <span class="keyword2"><span class="keyword">fixes</span></span> <span class="free">f</span><span class="main">::</span><span class="quoted"><span class="quoted">‹nat <span class="main">⇒</span> <span class="main">(</span><span class="tfree">'a</span><span class="main">::</span>banach <span class="keyword1">⇒<span class="hidden">⇩</span><sub>L</sub></span> <span class="tfree">'b</span><span class="main">::</span>real_normed_vector<span class="main">)</span>›</span></span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">‹<span class="main">⋀</span><span class="bound">x</span><span class="main">.</span> convergent <span class="main">(</span><span class="main">λ</span><span class="bound">n</span><span class="main">.</span> <span class="main">(</span><span class="free">f</span> <span class="bound">n</span><span class="main">)</span> <span class="keyword1">*<span class="hidden">⇩</span><sub>v</sub></span> <span class="bound">x</span><span class="main">)</span>›</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span>  <span class="quoted"><span class="quoted">‹<span class="main">∃</span><span class="bound">g</span><span class="main">.</span> <span class="main">(</span><span class="main">λ</span><span class="bound">n</span><span class="main">.</span> <span class="keyword1">(*<span class="hidden">⇩</span><sub>v</sub>)</span> <span class="main">(</span><span class="free">f</span> <span class="bound">n</span><span class="main">)</span><span class="main">)</span> <span class="keyword1">─pointwise→</span> <span class="keyword1">(*<span class="hidden">⇩</span><sub>v</sub>)</span> <span class="bound">g</span>›</span></span>
  <span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹
  Explanation: If a sequence of bounded operators on a Banach space converges
  pointwise, then the limit is also a bounded operator.
›</span></span>
<span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹<span class="main">∃</span><span class="bound">l</span><span class="main">.</span> <span class="main">(</span><span class="main">λ</span><span class="bound">n</span><span class="main">.</span> <span class="keyword1">(*<span class="hidden">⇩</span><sub>v</sub>)</span> <span class="main">(</span><span class="free">f</span> <span class="bound">n</span><span class="main">)</span> <span class="skolem">x</span><span class="main">)</span> <span class="main">⇢</span> <span class="bound">l</span>›</span></span> <span class="keyword2"><span class="keyword">for</span></span> <span class="skolem">x</span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span>  <span class="quoted"><span class="quoted">‹<span class="main">⋀</span><span class="bound">x</span><span class="main">.</span> convergent <span class="main">(</span><span class="main">λ</span><span class="bound">n</span><span class="main">.</span> <span class="keyword1">(*<span class="hidden">⇩</span><sub>v</sub>)</span> <span class="main">(</span><span class="free">f</span> <span class="bound">n</span><span class="main">)</span> <span class="bound">x</span><span class="main">)</span>›</span></span> convergentD<span class="main">)</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">‹<span class="main">∃</span><span class="bound">F</span><span class="main">.</span> <span class="main">(</span><span class="main">λ</span><span class="bound">n</span><span class="main">.</span> <span class="keyword1">(*<span class="hidden">⇩</span><sub>v</sub>)</span> <span class="main">(</span><span class="free">f</span> <span class="bound">n</span><span class="main">)</span><span class="main">)</span> <span class="keyword1">─pointwise→</span> <span class="bound">F</span>›</span></span>
    <span class="keyword1"><span class="command">unfolding</span></span> pointwise_convergent_to_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">metis</span>
  <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">F</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">‹<span class="main">(</span><span class="main">λ</span><span class="bound">n</span><span class="main">.</span> <span class="keyword1">(*<span class="hidden">⇩</span><sub>v</sub>)</span> <span class="main">(</span><span class="free">f</span> <span class="bound">n</span><span class="main">)</span><span class="main">)</span> <span class="keyword1">─pointwise→</span> <span class="skolem">F</span>›</span></span>
    <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="main">∃</span><span class="bound">F</span><span class="main">.</span> <span class="main">(</span><span class="main">λ</span><span class="bound">n</span><span class="main">.</span> <span class="keyword1">(*<span class="hidden">⇩</span><sub>v</sub>)</span> <span class="main">(</span><span class="free">f</span> <span class="bound">n</span><span class="main">)</span><span class="main">)</span> <span class="keyword1">─pointwise→</span> <span class="bound">F</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹<span class="main">⋀</span><span class="bound">x</span><span class="main">.</span> <span class="main">(</span><span class="main">λ</span> <span class="bound">n</span><span class="main">.</span> <span class="keyword1">(*<span class="hidden">⇩</span><sub>v</sub>)</span> <span class="main">(</span><span class="free">f</span> <span class="bound">n</span><span class="main">)</span> <span class="bound">x</span><span class="main">)</span> <span class="main">⇢</span> <span class="skolem">F</span> <span class="bound">x</span>›</span></span>
    <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="main">(</span><span class="main">λ</span><span class="bound">n</span><span class="main">.</span> <span class="keyword1">(*<span class="hidden">⇩</span><sub>v</sub>)</span> <span class="main">(</span><span class="free">f</span> <span class="bound">n</span><span class="main">)</span><span class="main">)</span> <span class="keyword1">─pointwise→</span> <span class="skolem">F</span>›</span></span> <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="operator">transfer</span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> pointwise_convergent_to_def<span class="main">)</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹bounded <span class="main">(</span>range <span class="free">f</span><span class="main">)</span>›</span></span>
    <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="main">⋀</span><span class="bound">x</span><span class="main">.</span> convergent <span class="main">(</span><span class="main">λ</span><span class="bound">n</span><span class="main">.</span> <span class="keyword1">(*<span class="hidden">⇩</span><sub>v</sub>)</span> <span class="main">(</span><span class="free">f</span> <span class="bound">n</span><span class="main">)</span> <span class="bound">x</span><span class="main">)</span>›</span></span> banach_steinhaus
      <span class="quoted"><span class="quoted">‹<span class="main">⋀</span><span class="bound">x</span><span class="main">.</span> <span class="main">∃</span><span class="bound">l</span><span class="main">.</span> <span class="main">(</span><span class="main">λ</span><span class="bound">n</span><span class="main">.</span> <span class="keyword1">(*<span class="hidden">⇩</span><sub>v</sub>)</span> <span class="main">(</span><span class="free">f</span> <span class="bound">n</span><span class="main">)</span> <span class="bound">x</span><span class="main">)</span> <span class="main">⇢</span> <span class="bound">l</span>›</span></span> convergent_imp_bounded <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">have</span></span> norm_f_n<span class="main">:</span> <span class="quoted"><span class="quoted">‹<span class="main">∃</span> <span class="bound">M</span><span class="main">.</span> <span class="main">∀</span> <span class="bound">n</span><span class="main">.</span> norm <span class="main">(</span><span class="free">f</span> <span class="bound">n</span><span class="main">)</span> <span class="main">≤</span> <span class="bound">M</span>›</span></span>
    <span class="keyword1"><span class="command">unfolding</span></span> bounded_def
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">meson</span> UNIV_I <span class="quoted"><span class="quoted">‹bounded <span class="main">(</span>range <span class="free">f</span><span class="main">)</span>›</span></span> bounded_iff image_eqI<span class="main">)</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹isCont <span class="main">(</span><span class="main">λ</span> <span class="bound">t</span><span class="main">::</span><span class="tfree">'b</span><span class="main">.</span> norm <span class="bound">t</span><span class="main">)</span> <span class="skolem">y</span>›</span></span> <span class="keyword2"><span class="keyword">for</span></span> <span class="skolem">y</span><span class="main">::</span><span class="tfree"><span class="quoted"><span class="tfree">'b</span></span></span>
    <span class="keyword1"><span class="command">using</span></span> Limits.isCont_norm <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">‹<span class="main">(</span><span class="main">λ</span> <span class="bound">n</span><span class="main">.</span> norm <span class="main">(</span><span class="keyword1">(*<span class="hidden">⇩</span><sub>v</sub>)</span> <span class="main">(</span><span class="free">f</span> <span class="bound">n</span><span class="main">)</span> <span class="skolem">x</span><span class="main">)</span><span class="main">)</span> <span class="main">⇢</span> <span class="main">(</span>norm <span class="main">(</span><span class="skolem">F</span> <span class="skolem">x</span><span class="main">)</span><span class="main">)</span>›</span></span> <span class="keyword2"><span class="keyword">for</span></span> <span class="skolem">x</span>
    <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="main">⋀</span> <span class="bound">x</span><span class="main">::</span><span class="tfree">'a</span><span class="main">.</span> <span class="main">(</span><span class="main">λ</span> <span class="bound">n</span><span class="main">.</span> <span class="keyword1">(*<span class="hidden">⇩</span><sub>v</sub>)</span> <span class="main">(</span><span class="free">f</span> <span class="bound">n</span><span class="main">)</span> <span class="bound">x</span><span class="main">)</span> <span class="main">⇢</span> <span class="skolem">F</span> <span class="bound">x</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> tendsto_norm<span class="main">)</span>
  <span class="keyword1"><span class="command">hence</span></span> norm_f_n_x<span class="main">:</span> <span class="quoted"><span class="quoted">‹<span class="main">∃</span> <span class="bound">M</span><span class="main">.</span> <span class="main">∀</span> <span class="bound">n</span><span class="main">.</span> norm <span class="main">(</span><span class="keyword1">(*<span class="hidden">⇩</span><sub>v</sub>)</span> <span class="main">(</span><span class="free">f</span> <span class="bound">n</span><span class="main">)</span> <span class="skolem">x</span><span class="main">)</span> <span class="main">≤</span> <span class="bound">M</span>›</span></span> <span class="keyword2"><span class="keyword">for</span></span> <span class="skolem">x</span>
    <span class="keyword1"><span class="command">using</span></span> Elementary_Metric_Spaces.convergent_imp_bounded
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> UNIV_I <span class="quoted"><span class="quoted">‹<span class="main">⋀</span> <span class="bound">x</span><span class="main">::</span><span class="tfree">'a</span><span class="main">.</span> <span class="main">(</span><span class="main">λ</span> <span class="bound">n</span><span class="main">.</span> <span class="keyword1">(*<span class="hidden">⇩</span><sub>v</sub>)</span> <span class="main">(</span><span class="free">f</span> <span class="bound">n</span><span class="main">)</span> <span class="bound">x</span><span class="main">)</span> <span class="main">⇢</span> <span class="skolem">F</span> <span class="bound">x</span>›</span></span> bounded_iff image_eqI<span class="main">)</span>
  <span class="keyword1"><span class="command">have</span></span> norm_f<span class="main">:</span> <span class="quoted"><span class="quoted">‹<span class="main">∃</span><span class="bound">K</span><span class="main">.</span> <span class="main">∀</span><span class="bound">n</span><span class="main">.</span> <span class="main">∀</span><span class="bound">x</span><span class="main">.</span> norm <span class="main">(</span><span class="keyword1">(*<span class="hidden">⇩</span><sub>v</sub>)</span> <span class="main">(</span><span class="free">f</span> <span class="bound">n</span><span class="main">)</span> <span class="bound">x</span><span class="main">)</span> <span class="main">≤</span> norm <span class="bound">x</span> <span class="main">*</span> <span class="bound">K</span>›</span></span>
  <span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹<span class="main">∃</span> <span class="bound">M</span><span class="main">.</span> <span class="main">∀</span> <span class="bound">n</span><span class="main">.</span> norm <span class="main">(</span><span class="keyword1">(*<span class="hidden">⇩</span><sub>v</sub>)</span> <span class="main">(</span><span class="free">f</span> <span class="bound">n</span><span class="main">)</span> <span class="skolem">x</span><span class="main">)</span> <span class="main">≤</span> <span class="bound">M</span>›</span></span> <span class="keyword2"><span class="keyword">for</span></span> <span class="skolem">x</span>
      <span class="keyword1"><span class="command">using</span></span> norm_f_n_x  <span class="quoted"><span class="quoted">‹<span class="main">⋀</span><span class="bound">x</span><span class="main">.</span> <span class="main">(</span><span class="main">λ</span><span class="bound">n</span><span class="main">.</span> <span class="keyword1">(*<span class="hidden">⇩</span><sub>v</sub>)</span> <span class="main">(</span><span class="free">f</span> <span class="bound">n</span><span class="main">)</span> <span class="bound">x</span><span class="main">)</span> <span class="main">⇢</span> <span class="skolem">F</span> <span class="bound">x</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
    <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">‹<span class="main">∃</span> <span class="bound">M</span><span class="main">.</span> <span class="main">∀</span> <span class="bound">n</span><span class="main">.</span> norm <span class="main">(</span><span class="free">f</span> <span class="bound">n</span><span class="main">)</span> <span class="main">≤</span> <span class="bound">M</span>›</span></span>
      <span class="keyword1"><span class="command">using</span></span> norm_f_n <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span> 
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">M</span></span><span class="main">::</span><span class="quoted">real</span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">‹<span class="main">∃</span> <span class="bound">M</span><span class="main">.</span> <span class="main">∀</span> <span class="bound">n</span><span class="main">.</span> norm <span class="main">(</span><span class="free">f</span> <span class="bound">n</span><span class="main">)</span> <span class="main">≤</span> <span class="bound">M</span>›</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹<span class="main">∀</span> <span class="bound">n</span><span class="main">.</span> <span class="main">∀</span><span class="bound">x</span><span class="main">.</span> norm <span class="main">(</span><span class="keyword1">(*<span class="hidden">⇩</span><sub>v</sub>)</span> <span class="main">(</span><span class="free">f</span> <span class="bound">n</span><span class="main">)</span> <span class="bound">x</span><span class="main">)</span> <span class="main">≤</span> norm <span class="bound">x</span> <span class="main">*</span> norm <span class="main">(</span><span class="free">f</span> <span class="bound">n</span><span class="main">)</span>›</span></span>
      <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="operator">transfer</span> <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="operator">auto</span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> mult.commute onorm<span class="main">)</span> 
    <span class="keyword3"><span class="command">thus</span></span>  <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="main">∃</span> <span class="bound">M</span><span class="main">.</span> <span class="main">∀</span> <span class="bound">n</span><span class="main">.</span> norm <span class="main">(</span><span class="free">f</span> <span class="bound">n</span><span class="main">)</span> <span class="main">≤</span> <span class="bound">M</span>›</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> <span class="main"><span class="main">(</span></span>no_types<span class="main"><span class="main">,</span></span> hide_lams<span class="main"><span class="main">)</span></span> dual_order.trans norm_eq_zero order_refl 
          mult_le_cancel_iff2 vector_space_over_itself.scale_zero_left zero_less_norm_iff<span class="main">)</span>
  <span class="keyword1"><span class="command">qed</span></span> 
  <span class="keyword1"><span class="command">have</span></span> norm_F_x<span class="main">:</span> <span class="quoted"><span class="quoted">‹<span class="main">∃</span><span class="bound">K</span><span class="main">.</span> <span class="main">∀</span><span class="bound">x</span><span class="main">.</span> norm <span class="main">(</span><span class="skolem">F</span> <span class="bound">x</span><span class="main">)</span> <span class="main">≤</span> norm <span class="bound">x</span> <span class="main">*</span> <span class="bound">K</span>›</span></span>
  <span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound">K</span><span class="main">.</span> <span class="main">∀</span><span class="bound">n</span><span class="main">.</span> <span class="main">∀</span><span class="bound">x</span><span class="main">.</span> norm <span class="main">(</span><span class="keyword1">(*<span class="hidden">⇩</span><sub>v</sub>)</span> <span class="main">(</span><span class="free">f</span> <span class="bound">n</span><span class="main">)</span> <span class="bound">x</span><span class="main">)</span> <span class="main">≤</span> norm <span class="bound">x</span> <span class="main">*</span> <span class="bound">K</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> norm_f <span class="quoted"><span class="quoted">‹<span class="main">⋀</span><span class="bound">x</span><span class="main">.</span> <span class="main">(</span><span class="main">λ</span><span class="bound">n</span><span class="main">.</span> <span class="keyword1">(*<span class="hidden">⇩</span><sub>v</sub>)</span> <span class="main">(</span><span class="free">f</span> <span class="bound">n</span><span class="main">)</span> <span class="bound">x</span><span class="main">)</span> <span class="main">⇢</span> <span class="skolem">F</span> <span class="bound">x</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
      <span class="keyword1"><span class="command">using</span></span>  <span class="quoted"><span class="quoted">‹<span class="main">⋀</span> <span class="bound">x</span><span class="main">::</span><span class="tfree">'a</span><span class="main">.</span> <span class="main">(</span><span class="main">λ</span> <span class="bound">n</span><span class="main">.</span> <span class="keyword1">(*<span class="hidden">⇩</span><sub>v</sub>)</span> <span class="main">(</span><span class="free">f</span> <span class="bound">n</span><span class="main">)</span>  <span class="bound">x</span><span class="main">)</span> <span class="main">⇢</span> <span class="skolem">F</span> <span class="bound">x</span>›</span></span> <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="operator">transfer</span> 
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> Lim_bounded tendsto_norm<span class="main">)</span>   
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹linear <span class="skolem">F</span>›</span></span>
  <span class="keyword1"><span class="command">proof</span></span><span class="main">(</span><span class="operator">rule</span> linear_limit_linear<span class="main">)</span>
    <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">‹linear <span class="main">(</span><span class="keyword1">(*<span class="hidden">⇩</span><sub>v</sub>)</span> <span class="main">(</span><span class="free">f</span> <span class="skolem">n</span><span class="main">)</span><span class="main">)</span>›</span></span> <span class="keyword2"><span class="keyword">for</span></span> <span class="skolem">n</span>
      <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="operator">transfer</span> <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="operator">auto</span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> bounded_linear.linear<span class="main">)</span> 
    <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">‹<span class="free">f</span> <span class="keyword1">─pointwise→</span> <span class="skolem">F</span>›</span></span>
      <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="main">(</span><span class="main">λ</span><span class="bound">n</span><span class="main">.</span> <span class="keyword1">(*<span class="hidden">⇩</span><sub>v</sub>)</span> <span class="main">(</span><span class="free">f</span> <span class="bound">n</span><span class="main">)</span><span class="main">)</span> <span class="keyword1">─pointwise→</span> <span class="skolem">F</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹bounded_linear_axioms <span class="skolem">F</span>›</span></span>
    <span class="keyword1"><span class="command">using</span></span> norm_F_x <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> <span class="quoted"><span class="quoted">‹<span class="main">⋀</span><span class="bound">x</span><span class="main">.</span> <span class="main">(</span><span class="main">λ</span><span class="bound">n</span><span class="main">.</span> <span class="keyword1">(*<span class="hidden">⇩</span><sub>v</sub>)</span> <span class="main">(</span><span class="free">f</span> <span class="bound">n</span><span class="main">)</span> <span class="bound">x</span><span class="main">)</span> <span class="main">⇢</span> <span class="skolem">F</span> <span class="bound">x</span>›</span></span> bounded_linear_axioms_def<span class="main">)</span> 
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹bounded_linear <span class="skolem">F</span>›</span></span> 
    <span class="keyword1"><span class="command">unfolding</span></span> bounded_linear_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">‹<span class="main">∃</span><span class="bound">g</span><span class="main">.</span> <span class="keyword1">(*<span class="hidden">⇩</span><sub>v</sub>)</span> <span class="bound">g</span> <span class="main">=</span> <span class="skolem">F</span>›</span></span>
    <span class="keyword1"><span class="command">using</span></span> bounded_linear_Blinfun_apply <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="main">(</span><span class="main">λ</span><span class="bound">n</span><span class="main">.</span> <span class="keyword1">(*<span class="hidden">⇩</span><sub>v</sub>)</span> <span class="main">(</span><span class="free">f</span> <span class="bound">n</span><span class="main">)</span><span class="main">)</span> <span class="keyword1">─pointwise→</span> <span class="skolem">F</span>›</span></span> <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="operator">transfer</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword2"><span class="keyword">end</span></span>
</pre>
</div>
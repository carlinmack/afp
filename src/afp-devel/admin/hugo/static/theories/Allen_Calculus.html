<div id="xor_cal">
<div class="head">
<h1>Theory xor_cal</h1>
</div>
<pre class="source"><span class="comment1">(*
Title:  Allen's qualitative temporal calculus
Author:  Fadoua Ghourabi (fadouaghourabi@gmail.com)
Affiliation: Ochanomizu University, Japan
*)</span>

<span class="keyword1"><span class="command">theory</span></span> xor_cal

<span class="keyword2"><span class="keyword">imports</span></span>

  <a href="../../HOL/HOL/Main.html">Main</a>

<span class="keyword2"><span class="keyword">begin</span></span>
<span class="keyword1"><span class="command">definition</span></span> <span class="entity">xor</span><span class="main">::</span><span class="quoted"><span class="quoted">"bool <span class="main">⇒</span> bool <span class="main">⇒</span> bool"</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">infixl</span></span> <span class="quoted">"<span class="keyword1">⊕</span>"</span> 60<span class="main">)</span>
<span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="free">xor</span> <span class="free"><span class="bound"><span class="entity">A</span></span></span> <span class="free"><span class="bound"><span class="entity">B</span></span></span> <span class="main">≡</span> <span class="main">(</span><span class="free"><span class="bound"><span class="entity">A</span></span></span> <span class="main">∧</span> <span class="main">¬</span><span class="free"><span class="bound"><span class="entity">B</span></span></span><span class="main">)</span> <span class="main">∨</span> <span class="main">(</span><span class="main">¬</span><span class="free"><span class="bound"><span class="entity">A</span></span></span> <span class="main">∧</span> <span class="free"><span class="bound"><span class="entity">B</span></span></span><span class="main">)</span>"</span></span>

<span class="keyword1"><span class="command">declare</span></span> xor_def <span class="main">[</span><span class="operator">simp</span><span class="main">]</span>

<span class="keyword1"><span class="command">interpretation</span></span> bool<span class="main">:</span>semigroup <span class="quoted"><span class="quoted">"<span class="main">(⊕)</span> "</span></span>
<span class="keyword1"><span class="command">proof</span></span>
<span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">a</span> <span class="skolem">b</span> <span class="skolem">c</span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">a</span> <span class="main">⊕</span> <span class="skolem">b</span> <span class="main">⊕</span> <span class="skolem">c</span> <span class="main">=</span> <span class="skolem">a</span> <span class="main">⊕</span> <span class="main">(</span><span class="skolem">b</span> <span class="main">⊕</span> <span class="skolem">c</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span><span class="keyword1"><span class="command">}</span></span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">lemma</span></span> xor_distr_L <span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span><span class="quoted"><span class="quoted">"<span class="free">A</span> <span class="main">⊕</span> <span class="main">(</span><span class="free">B</span> <span class="main">⊕</span> <span class="free">C</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="free">A</span><span class="main">∧</span><span class="main">¬</span><span class="free">B</span><span class="main">∧</span><span class="main">¬</span><span class="free">C</span><span class="main">)</span><span class="main">∨</span><span class="main">(</span><span class="free">A</span><span class="main">∧</span><span class="free">B</span><span class="main">∧</span><span class="free">C</span><span class="main">)</span><span class="main">∨</span><span class="main">(</span><span class="main">¬</span><span class="free">A</span><span class="main">∧</span><span class="free">B</span><span class="main">∧</span><span class="main">¬</span><span class="free">C</span><span class="main">)</span><span class="main">∨</span><span class="main">(</span><span class="main">¬</span><span class="free">A</span><span class="main">∧</span><span class="main">¬</span><span class="free">B</span><span class="main">∧</span><span class="free">C</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">lemma</span></span> xor_distr_R <span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span><span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">A</span> <span class="main">⊕</span> <span class="free">B</span><span class="main">)</span> <span class="main">⊕</span> <span class="free">C</span> <span class="main">=</span> <span class="free">A</span> <span class="main">⊕</span> <span class="main">(</span><span class="free">B</span> <span class="main">⊕</span> <span class="free">C</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword2"><span class="keyword">end</span></span>
</pre>
</div><div id="axioms">
<div class="head">
<h1>Theory axioms</h1>
</div>
<pre class="source"><span class="comment1">(*
Title:  Allen's qualitative temporal calculus
Author:  Fadoua Ghourabi (fadouaghourabi@gmail.com)
Affiliation: Ochanomizu University, Japan
*)</span>



<span class="keyword1"><span class="command">theory</span></span> axioms

<span class="keyword2"><span class="keyword">imports</span></span>
    <a href="../../HOL/HOL/Main.html">Main</a>  <a href="xor_cal.html">xor_cal</a>

<span class="keyword2"><span class="keyword">begin</span></span>


<span class="keyword1"><span class="command">section</span></span> <span class="quoted"><span class="plain_text">‹Axioms›</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹We formalize Allen's definition of theory of time in term of intervals (Allen, 1983). 
Two relations, namely meets and equality, are defined between intervals. Two interval meets if they  are adjacent 
A set of 5 axioms ((M1) $\sim$ (M5)) are then defined based on relation meets.›</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹We define a class interval whose assumptions are (i) properties of relations meets  and, (ii) axioms (M1) $\sim$ (M5).›</span></span>

<span class="keyword1"><span class="command">class</span></span> interval <span class="main">=</span>
 <span class="keyword2"><span class="keyword">fixes</span></span>
  <span class="free"><span class="free"><span class="free">meets</span></span></span><span class="main">::</span><span class="quoted"><span class="quoted">"<span class="tfree">'a</span> <span class="main">⇒</span> <span class="tfree">'a</span> <span class="main">⇒</span> bool"</span></span>  <span class="main">(</span><span class="keyword2"><span class="keyword">infixl</span></span> <span class="quoted">"<span class="keyword1"><span class="keyword1"><span class="keyword1">∥</span></span></span>"</span> 60<span class="main">)</span> <span class="keyword2"><span class="keyword">and</span></span>
  <span class="free"><span class="free"><span class="free">ℐ</span></span></span><span class="main">::</span><span class="quoted"><span class="quoted">"<span class="tfree">'a</span> <span class="main">⇒</span> bool"</span></span>
 <span class="keyword2"><span class="keyword">assumes</span></span>
  meets_atrans<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="main">⟦</span><span class="main">(</span><span class="free">p</span><span class="main"><span class="free">∥</span></span><span class="free">q</span><span class="main">)</span><span class="main">;</span><span class="main">(</span><span class="free">q</span><span class="main"><span class="free">∥</span></span><span class="free">r</span><span class="main">)</span><span class="main">⟧</span> <span class="main">⟹</span> <span class="main">¬</span><span class="main">(</span><span class="free">p</span><span class="main"><span class="free">∥</span></span><span class="free">r</span><span class="main">)</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span>
  meets_irrefl<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="free">ℐ</span> <span class="free">p</span> <span class="main">⟹</span> <span class="main">¬</span><span class="main">(</span><span class="free">p</span><span class="main"><span class="free">∥</span></span><span class="free">p</span><span class="main">)</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span>
  meets_asym<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">p</span><span class="main"><span class="free">∥</span></span><span class="free">q</span><span class="main">)</span> <span class="main">⟹</span> <span class="main">¬</span><span class="main">(</span><span class="free">q</span><span class="main"><span class="free">∥</span></span><span class="free">p</span><span class="main">)</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span>
  meets_wd<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="free">p</span><span class="main"><span class="free">∥</span></span><span class="free">q</span> <span class="main">⟹</span> <span class="free">ℐ</span> <span class="free">p</span> <span class="main">∧</span> <span class="free">ℐ</span> <span class="free">q</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span>
<span class="comment1">(**** Time axioms ******)</span>
  M1<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="main">⟦</span><span class="main">(</span><span class="free">p</span><span class="main"><span class="free">∥</span></span><span class="free">q</span><span class="main">)</span><span class="main">;</span> <span class="main">(</span><span class="free">p</span><span class="main"><span class="free">∥</span></span><span class="free">s</span><span class="main">)</span><span class="main">;</span> <span class="main">(</span><span class="free">r</span><span class="main"><span class="free">∥</span></span><span class="free">q</span><span class="main">)</span><span class="main">⟧</span> <span class="main">⟹</span> <span class="main">(</span><span class="free">r</span><span class="main"><span class="free">∥</span></span><span class="free">s</span><span class="main">)</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span>
  M2<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="main">⟦</span><span class="main">(</span><span class="free">p</span><span class="main"><span class="free">∥</span></span><span class="free">q</span><span class="main">)</span> <span class="main">;</span> <span class="main">(</span><span class="free">r</span><span class="main"><span class="free">∥</span></span><span class="free">s</span><span class="main">)</span><span class="main">⟧</span> <span class="main">⟹</span> <span class="free">p</span><span class="main"><span class="free">∥</span></span><span class="free">s</span> <span class="main">⊕</span> <span class="main">(</span><span class="main">(</span><span class="main">∃</span><span class="bound">t</span><span class="main">.</span> <span class="main">(</span><span class="free">p</span><span class="main"><span class="free">∥</span></span><span class="bound">t</span><span class="main">)</span><span class="main">∧</span><span class="main">(</span><span class="bound">t</span><span class="main"><span class="free">∥</span></span><span class="free">s</span><span class="main">)</span><span class="main">)</span> <span class="main">⊕</span> <span class="main">(</span><span class="main">∃</span><span class="bound">t</span><span class="main">.</span> <span class="main">(</span><span class="free">r</span><span class="main"><span class="free">∥</span></span><span class="bound">t</span><span class="main">)</span><span class="main">∧</span><span class="main">(</span><span class="bound">t</span><span class="main"><span class="free">∥</span></span><span class="free">q</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span>
  M3<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="free">ℐ</span> <span class="free">p</span> <span class="main">⟹</span> <span class="main">(</span><span class="main">∃</span><span class="bound">q</span> <span class="bound">r</span><span class="main">.</span> <span class="bound">q</span><span class="main"><span class="free">∥</span></span><span class="free">p</span> <span class="main">∧</span> <span class="free">p</span><span class="main"><span class="free">∥</span></span><span class="bound">r</span><span class="main">)</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span>
  M4<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="main">⟦</span><span class="free">p</span><span class="main"><span class="free">∥</span></span><span class="free">q</span> <span class="main">;</span> <span class="free">q</span><span class="main"><span class="free">∥</span></span><span class="free">s</span> <span class="main">;</span> <span class="free">p</span><span class="main"><span class="free">∥</span></span><span class="free">r</span> <span class="main">;</span> <span class="free">r</span><span class="main"><span class="free">∥</span></span><span class="free">s</span><span class="main">⟧</span> <span class="main">⟹</span> <span class="free">q</span> <span class="main">=</span> <span class="free">r</span>"</span></span>  <span class="keyword2"><span class="keyword">and</span></span>
  M5exist<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="free">p</span><span class="main"><span class="free">∥</span></span><span class="free">q</span> <span class="main">⟹</span> <span class="main">(</span><span class="main">∃</span><span class="bound">r</span> <span class="bound">s</span> <span class="bound">t</span><span class="main">.</span> <span class="bound">r</span><span class="main"><span class="free">∥</span></span><span class="free">p</span> <span class="main">∧</span> <span class="free">p</span><span class="main"><span class="free">∥</span></span><span class="free">q</span> <span class="main">∧</span> <span class="free">q</span><span class="main"><span class="free">∥</span></span><span class="bound">s</span> <span class="main">∧</span> <span class="bound">r</span><span class="main"><span class="free">∥</span></span><span class="bound">t</span> <span class="main">∧</span> <span class="bound">t</span><span class="main"><span class="free">∥</span></span><span class="bound">s</span><span class="main">)</span>"</span></span> 
<span class="comment1">(**********)</span>

<span class="keyword1"><span class="command">lemma</span></span>  <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> interval<span class="main">)</span> trans2<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="main">⟦</span><span class="free">p</span><span class="main">∥</span><span class="free">t</span><span class="main">;</span> <span class="free">t</span><span class="main">∥</span><span class="free">r</span><span class="main">;</span> <span class="free">r</span><span class="main">∥</span><span class="free">q</span><span class="main">⟧</span> <span class="main">⟹</span> <span class="main">¬</span><span class="free">p</span><span class="main">∥</span><span class="free">q</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> M1 meets_asym <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> interval<span class="main">)</span> nontrans1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">u</span><span class="main">∥</span><span class="free">r</span> <span class="main">⟹</span> <span class="main">¬</span> <span class="main">(</span><span class="main">∃</span><span class="bound">t</span><span class="main">.</span> <span class="free">u</span><span class="main">∥</span><span class="bound">t</span> <span class="main">∧</span> <span class="bound">t</span><span class="main">∥</span><span class="free">r</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> meets_atrans <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
 
<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> interval<span class="main">)</span> nontrans2<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="free">u</span><span class="main">∥</span><span class="free">r</span> <span class="main">⟹</span> <span class="main">¬</span> <span class="main">(</span><span class="main">∃</span><span class="bound">t</span><span class="main">.</span> <span class="free">r</span><span class="main">∥</span><span class="bound">t</span> <span class="main">∧</span> <span class="bound">t</span><span class="main">∥</span><span class="free">u</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> M1 M5exist trans2 <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> interval<span class="main">)</span> nonmeets1<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="main">¬</span> <span class="main">(</span><span class="free">u</span><span class="main">∥</span><span class="free">r</span> <span class="main">∧</span> <span class="free">r</span><span class="main">∥</span><span class="free">u</span><span class="main">)</span>"</span></span> 
  <span class="keyword1"><span class="command">using</span></span> meets_asym <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> interval<span class="main">)</span>  nonmeets2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">⟦</span>ℐ <span class="free">u</span> <span class="main">;</span> ℐ <span class="free">r</span> <span class="main">⟧</span> <span class="main">⟹</span> <span class="main">¬</span> <span class="main">(</span><span class="free">u</span><span class="main">∥</span><span class="free">r</span> <span class="main">∧</span> <span class="free">u</span> <span class="main">=</span> <span class="free">r</span><span class="main">)</span>"</span></span> 
  <span class="keyword1"><span class="command">using</span></span> meets_irrefl <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> interval<span class="main">)</span> nonmeets3<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> <span class="main">(</span><span class="free">u</span><span class="main">∥</span><span class="free">r</span> <span class="main">∧</span> <span class="main">(</span><span class="main">∃</span><span class="bound">p</span><span class="main">.</span> <span class="free">u</span><span class="main">∥</span><span class="bound">p</span> <span class="main">∧</span> <span class="bound">p</span><span class="main">∥</span><span class="free">r</span><span class="main">)</span><span class="main">)</span>"</span></span> 
  <span class="keyword1"><span class="command">using</span></span> nontrans1 <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> interval<span class="main">)</span> nonmeets4<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">¬</span><span class="main">(</span><span class="free">u</span><span class="main">∥</span><span class="free">r</span> <span class="main">∧</span> <span class="main">(</span><span class="main">∃</span><span class="bound">p</span><span class="main">.</span> <span class="free">r</span><span class="main">∥</span><span class="bound">p</span> <span class="main">∧</span> <span class="bound">p</span><span class="main">∥</span><span class="free">u</span><span class="main">)</span><span class="main">)</span>"</span></span> 
  <span class="keyword1"><span class="command">using</span></span> nontrans2 <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> interval<span class="main">)</span> elimmeets<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">p</span> <span class="main">∥</span> <span class="free">s</span> <span class="main">∧</span> <span class="main">(</span><span class="main">∃</span><span class="bound">t</span><span class="main">.</span> <span class="free">p</span> <span class="main">∥</span> <span class="bound">t</span> <span class="main">∧</span> <span class="bound">t</span> <span class="main">∥</span> <span class="free">s</span><span class="main">)</span> <span class="main">∧</span> <span class="main">(</span><span class="main">∃</span><span class="bound">t</span><span class="main">.</span> <span class="free">r</span> <span class="main">∥</span> <span class="bound">t</span> <span class="main">∧</span> <span class="bound">t</span> <span class="main">∥</span> <span class="free">q</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> False"</span></span>
  <span class="keyword1"><span class="command">using</span></span> meets_atrans <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span> 

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> interval<span class="main">)</span> M5exist_var<span class="main">:</span>
<span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">x</span><span class="main">∥</span><span class="free">y</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="free">y</span><span class="main">∥</span><span class="free">z</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="free">z</span><span class="main">∥</span><span class="free">w</span>"</span></span>
<span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound">t</span><span class="main">.</span> <span class="free">x</span><span class="main">∥</span><span class="bound">t</span> <span class="main">∧</span> <span class="bound">t</span><span class="main">∥</span><span class="free">w</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">from</span></span> assms<span class="main">(</span>1<span class="main">,</span>3<span class="main">)</span> <span class="keyword1"><span class="command">have</span></span> a<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="free">x</span><span class="main">∥</span><span class="free">w</span> <span class="main">⊕</span> <span class="main">(</span><span class="main">∃</span><span class="bound">t</span><span class="main">.</span> <span class="free">x</span><span class="main">∥</span><span class="bound">t</span> <span class="main">∧</span> <span class="bound">t</span><span class="main">∥</span><span class="free">w</span><span class="main">)</span> <span class="main">⊕</span> <span class="main">(</span><span class="main">∃</span><span class="bound">t</span><span class="main">.</span> <span class="free">z</span><span class="main">∥</span><span class="bound">t</span> <span class="main">∧</span> <span class="bound">t</span><span class="main">∥</span><span class="free">y</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> M2<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="free">x</span></span> <span class="quoted"><span class="free">y</span></span> <span class="quoted"><span class="free">z</span></span> <span class="quoted"><span class="free">w</span></span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">from</span></span> assms <span class="keyword1"><span class="command">have</span></span> b1<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="main">¬</span><span class="free">x</span><span class="main">∥</span><span class="free">w</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> trans2 <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">from</span></span> assms<span class="main">(</span>2<span class="main">)</span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> <span class="main">(</span><span class="main">∃</span><span class="bound">t</span><span class="main">.</span> <span class="free">z</span><span class="main">∥</span><span class="bound">t</span> <span class="main">∧</span> <span class="bound">t</span><span class="main">∥</span><span class="free">y</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> nontrans2<span class="main">)</span>
  <span class="keyword1"><span class="command">with</span></span> b1 a <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">" <span class="main">(</span><span class="main">∃</span><span class="bound">t</span><span class="main">.</span> <span class="free">x</span><span class="main">∥</span><span class="bound">t</span> <span class="main">∧</span> <span class="bound">t</span><span class="main">∥</span><span class="free">w</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> interval<span class="main">)</span> M5exist_var2<span class="main">:</span>
<span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">p</span><span class="main">∥</span><span class="free">q</span>"</span></span>
<span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound">r1</span> <span class="bound">r2</span> <span class="bound">r3</span> <span class="bound">s</span> <span class="bound">t</span><span class="main">.</span> <span class="bound">r1</span><span class="main">∥</span><span class="bound">r2</span> <span class="main">∧</span> <span class="bound">r2</span><span class="main">∥</span><span class="bound">r3</span> <span class="main">∧</span> <span class="bound">r3</span><span class="main">∥</span><span class="free">p</span> <span class="main">∧</span> <span class="free">p</span><span class="main">∥</span><span class="free">q</span> <span class="main">∧</span> <span class="free">q</span><span class="main">∥</span><span class="bound">s</span> <span class="main">∧</span> <span class="bound">r1</span><span class="main">∥</span><span class="bound">t</span> <span class="main">∧</span> <span class="bound">t</span><span class="main">∥</span><span class="bound">s</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">from</span></span> assms <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">r3</span></span> <span class="skolem"><span class="skolem">k1</span></span> <span class="skolem"><span class="skolem">s</span></span>  <span class="keyword2"><span class="keyword">where</span></span> r3p<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">r3</span><span class="main">∥</span><span class="free">p</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span>  qs<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="free">q</span><span class="main">∥</span><span class="skolem">s</span>"</span></span>  <span class="keyword2"><span class="keyword">and</span></span>  r3k1<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">r3</span> <span class="main">∥</span><span class="skolem">k1</span>"</span></span>  <span class="keyword2"><span class="keyword">and</span></span>  k1s<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">k1</span><span class="main">∥</span><span class="skolem">s</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> M5exist <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span> 
  <span class="keyword1"><span class="command">from</span></span> r3p <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">r2</span></span> <span class="keyword2"><span class="keyword">where</span></span> r2r3<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">r2</span><span class="main">∥</span><span class="skolem">r3</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> M3<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="skolem">r3</span></span><span class="main">]</span> meets_wd <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">from</span></span> r2r3 <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">r1</span></span> <span class="keyword2"><span class="keyword">where</span></span> r1r2<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">r1</span><span class="main">∥</span><span class="skolem">r2</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> M3<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="skolem">r2</span></span><span class="main">]</span> meets_wd <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">with</span></span>  assms  r2r3 r3p qs <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">t</span></span> <span class="keyword2"><span class="keyword">where</span></span> r1t1<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">r1</span><span class="main">∥</span><span class="skolem">t</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> t1q<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">t</span><span class="main">∥</span><span class="skolem">s</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> M5exist_var <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">with</span></span> assms r1r2 r2r3 r3p qs <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
<span class="keyword1"><span class="command">qed</span></span>
  
<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> interval<span class="main">)</span> M5exist_var3<span class="main">:</span>
<span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">k</span><span class="main">∥</span><span class="free">l</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">l</span><span class="main">∥</span><span class="free">q</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">q</span><span class="main">∥</span><span class="free">t</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">t</span><span class="main">∥</span><span class="free">r</span>"</span></span> 
<span class="keyword2"><span class="keyword">shows</span></span>  <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound">lqt</span><span class="main">.</span> <span class="free">k</span><span class="main">∥</span><span class="bound">lqt</span> <span class="main">∧</span> <span class="bound">lqt</span><span class="main">∥</span><span class="free">r</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">from</span></span> assms<span class="main">(</span>1-3<span class="main">)</span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">lq</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="free">k</span><span class="main">∥</span><span class="skolem">lq</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">lq</span><span class="main">∥</span><span class="free">t</span>"</span></span> 
  <span class="keyword1"><span class="command">using</span></span> M5exist_var <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span> 
  <span class="keyword1"><span class="command">with</span></span> assms<span class="main">(</span>4<span class="main">)</span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">lqt</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="free">k</span><span class="main">∥</span><span class="skolem">lqt</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">lqt</span><span class="main">∥</span><span class="free">r</span>"</span></span> 
  <span class="keyword1"><span class="command">using</span></span> M5exist_var <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>


<span class="keyword2"><span class="keyword">end</span></span>
</pre>
</div><div id="allen">
<div class="head">
<h1>Theory allen</h1>
</div>
<pre class="source"><span class="comment1">(*
Title:  Allen's qualitative temporal calculus
Author:  Fadoua Ghourabi (fadouaghourabi@gmail.com)
Affiliation: Ochanomizu University, Japan
*)</span>

<span class="keyword1"><span class="command">section</span></span> <span class="quoted"><span class="plain_text">‹Time interval relations›</span></span>


<span class="keyword1"><span class="command">theory</span></span> allen

<span class="keyword2"><span class="keyword">imports</span></span>

  <a href="../../HOL/HOL/Main.html">Main</a> <a href="axioms.html">axioms</a> 
  <span class="quoted">"<a href="../../HOL/HOL-Eisbach/Eisbach_Tools.html">HOL-Eisbach.Eisbach_Tools</a>"</span>


<span class="keyword2"><span class="keyword">begin</span></span>

<span class="keyword1"><span class="command">section</span></span> <span class="quoted"><span class="plain_text">‹Basic relations›</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹We  define 7 binary relations  between time intervals. 
Relations e, m, b, ov, d, s and f stand for equal, meets, before, overlaps, during, starts and finishes, respectively.›</span></span>

<span class="keyword1"><span class="command">class</span></span> arelations <span class="main">=</span> interval <span class="main">+</span> 
 <span class="keyword2"><span class="keyword">fixes</span></span> 
  <span class="free"><span class="free"><span class="free">e</span></span></span><span class="main">::</span><span class="quoted"><span class="quoted">"<span class="main">(</span><span class="tfree">'a</span><span class="main">×</span><span class="tfree">'a</span><span class="main">)</span> set"</span></span> <span class="keyword2"><span class="keyword">and</span></span>
  <span class="free"><span class="free"><span class="free">m</span></span></span><span class="main">::</span><span class="quoted"><span class="quoted">"<span class="main">(</span><span class="tfree">'a</span><span class="main">×</span><span class="tfree">'a</span><span class="main">)</span> set"</span></span> <span class="keyword2"><span class="keyword">and</span></span> 
  <span class="free"><span class="free"><span class="free">b</span></span></span><span class="main">::</span><span class="quoted"><span class="quoted">"<span class="main">(</span><span class="tfree">'a</span><span class="main">×</span><span class="tfree">'a</span><span class="main">)</span> set"</span></span> <span class="keyword2"><span class="keyword">and</span></span>
  <span class="free"><span class="free"><span class="free">ov</span></span></span><span class="main">::</span><span class="quoted"><span class="quoted">"<span class="main">(</span><span class="tfree">'a</span><span class="main">×</span><span class="tfree">'a</span><span class="main">)</span> set"</span></span> <span class="keyword2"><span class="keyword">and</span></span>
  <span class="free"><span class="free"><span class="free">d</span></span></span><span class="main">::</span><span class="quoted"><span class="quoted">"<span class="main">(</span><span class="tfree">'a</span><span class="main">×</span><span class="tfree">'a</span><span class="main">)</span> set"</span></span> <span class="keyword2"><span class="keyword">and</span></span>
  <span class="free"><span class="free"><span class="free">s</span></span></span><span class="main">::</span><span class="quoted"><span class="quoted">"<span class="main">(</span><span class="tfree">'a</span><span class="main">×</span><span class="tfree">'a</span><span class="main">)</span> set"</span></span> <span class="keyword2"><span class="keyword">and</span></span>
  <span class="free"><span class="free"><span class="free">f</span></span></span><span class="main">::</span><span class="quoted"><span class="quoted">"<span class="main">(</span><span class="tfree">'a</span><span class="main">×</span><span class="tfree">'a</span><span class="main">)</span> set"</span></span>  
<span class="keyword2"><span class="keyword">assumes</span></span>
  e<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">p</span><span class="main">,</span><span class="free">q</span><span class="main">)</span> <span class="main">∈</span> <span class="free">e</span> <span class="main">=</span> <span class="main">(</span><span class="free">p</span> <span class="main">=</span> <span class="free">q</span><span class="main">)</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span>
  m<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">p</span><span class="main">,</span><span class="free">q</span><span class="main">)</span> <span class="main">∈</span> <span class="free">m</span> <span class="main">=</span> <span class="free">p</span><span class="main">∥</span><span class="free">q</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span>
  b<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">p</span><span class="main">,</span><span class="free">q</span><span class="main">)</span> <span class="main">∈</span> <span class="free">b</span> <span class="main">=</span> <span class="main">(</span><span class="main">∃</span><span class="bound">t</span><span class="main">::</span><span class="tfree">'a</span><span class="main">.</span> <span class="free">p</span><span class="main">∥</span><span class="bound">t</span> <span class="main">∧</span> <span class="bound">t</span><span class="main">∥</span><span class="free">q</span><span class="main">)</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span>
  ov<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">p</span><span class="main">,</span><span class="free">q</span><span class="main">)</span> <span class="main">∈</span> <span class="free">ov</span> <span class="main">=</span> <span class="main">(</span><span class="main">∃</span><span class="bound">k</span> <span class="bound">l</span> <span class="bound">u</span> <span class="bound">v</span> <span class="bound">t</span><span class="main">::</span><span class="tfree">'a</span><span class="main">.</span> 
                   <span class="main">(</span><span class="bound">k</span><span class="main">∥</span><span class="free">p</span> <span class="main">∧</span> <span class="free">p</span><span class="main">∥</span><span class="bound">u</span> <span class="main">∧</span> <span class="bound">u</span><span class="main">∥</span><span class="bound">v</span><span class="main">)</span> <span class="main">∧</span> <span class="main">(</span><span class="bound">k</span><span class="main">∥</span><span class="bound">l</span> <span class="main">∧</span> <span class="bound">l</span><span class="main">∥</span><span class="free">q</span> <span class="main">∧</span> <span class="free">q</span><span class="main">∥</span><span class="bound">v</span><span class="main">)</span> <span class="main">∧</span> <span class="main">(</span><span class="bound">l</span><span class="main">∥</span><span class="bound">t</span> <span class="main">∧</span> <span class="bound">t</span><span class="main">∥</span><span class="bound">u</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span>
  s<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">p</span><span class="main">,</span><span class="free">q</span><span class="main">)</span> <span class="main">∈</span> <span class="free">s</span> <span class="main">=</span>  <span class="main">(</span><span class="main">∃</span><span class="bound">k</span> <span class="bound">u</span> <span class="bound">v</span><span class="main">::</span><span class="tfree">'a</span><span class="main">.</span> <span class="bound">k</span><span class="main">∥</span><span class="free">p</span> <span class="main">∧</span> <span class="free">p</span><span class="main">∥</span><span class="bound">u</span> <span class="main">∧</span> <span class="bound">u</span><span class="main">∥</span><span class="bound">v</span> <span class="main">∧</span> <span class="bound">k</span><span class="main">∥</span><span class="free">q</span> <span class="main">∧</span> <span class="free">q</span><span class="main">∥</span><span class="bound">v</span><span class="main">)</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span>
  f<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">p</span><span class="main">,</span><span class="free">q</span><span class="main">)</span> <span class="main">∈</span> <span class="free">f</span> <span class="main">=</span> <span class="main">(</span><span class="main">∃</span><span class="bound">k</span> <span class="bound">l</span>  <span class="bound">u</span> <span class="main">::</span><span class="tfree">'a</span><span class="main">.</span> <span class="bound">k</span><span class="main">∥</span><span class="bound">l</span> <span class="main">∧</span> <span class="bound">l</span><span class="main">∥</span><span class="free">p</span> <span class="main">∧</span> <span class="free">p</span><span class="main">∥</span><span class="bound">u</span> <span class="main">∧</span> <span class="bound">k</span><span class="main">∥</span><span class="free">q</span> <span class="main">∧</span> <span class="free">q</span><span class="main">∥</span><span class="bound">u</span><span class="main">)</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span>
  d<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">p</span><span class="main">,</span><span class="free">q</span><span class="main">)</span> <span class="main">∈</span> <span class="free">d</span> <span class="main">=</span> <span class="main">(</span><span class="main">∃</span><span class="bound">k</span> <span class="bound">l</span> <span class="bound">u</span> <span class="bound">v</span><span class="main">::</span><span class="tfree">'a</span><span class="main">.</span> <span class="bound">k</span><span class="main">∥</span><span class="bound">l</span> <span class="main">∧</span> <span class="bound">l</span><span class="main">∥</span><span class="free">p</span> <span class="main">∧</span> <span class="free">p</span><span class="main">∥</span><span class="bound">u</span> <span class="main">∧</span><span class="bound">u</span><span class="main">∥</span><span class="bound">v</span> <span class="main">∧</span> <span class="bound">k</span><span class="main">∥</span><span class="free">q</span> <span class="main">∧</span> <span class="free">q</span><span class="main">∥</span><span class="bound">v</span><span class="main">)</span>"</span></span> 
 

<span class="comment1">(** e compositions **)</span>
<span class="keyword1"><span class="command">subsection</span></span> <span class="quoted"><span class="plain_text">‹e-composition›</span></span>
<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹Relation e is the identity relation for composition.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> cer<span class="main">:</span>
<span class="keyword2"><span class="keyword">assumes</span></span>  <span class="quoted"><span class="quoted">"<span class="free">r</span> <span class="main">∈</span> <span class="main">{</span>e<span class="main">,</span>m<span class="main">,</span>b<span class="main">,</span>ov<span class="main">,</span>s<span class="main">,</span>f<span class="main">,</span>d<span class="main">,</span>m<span class="main">^-1</span><span class="main">,</span>b<span class="main">^-1</span><span class="main">,</span>ov<span class="main">^-1</span><span class="main">,</span>s<span class="main">^-1</span><span class="main">,</span>f<span class="main">^-1</span><span class="main">,</span>d<span class="main">^-1</span><span class="main">}</span>"</span></span> 
<span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"e <span class="keyword1">O</span> <span class="free">r</span> <span class="main">=</span> <span class="free">r</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">x</span> <span class="skolem">y</span> <span class="keyword3"><span class="command">assume</span></span> a<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">x</span><span class="main">,</span><span class="skolem">y</span><span class="main">)</span> <span class="main">∈</span> e <span class="keyword1">O</span> <span class="free">r</span>"</span></span> 
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">z</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">x</span><span class="main">,</span><span class="skolem">z</span><span class="main">)</span> <span class="main">∈</span> e"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">z</span><span class="main">,</span><span class="skolem">y</span><span class="main">)</span> <span class="main">∈</span> <span class="free">r</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="main">(</span><span class="skolem">x</span><span class="main">,</span><span class="skolem">z</span><span class="main">)</span> <span class="main">∈</span> e›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">=</span> <span class="skolem">z</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> e <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">with</span></span> <span class="quoted"><span class="quoted">‹<span class="main">(</span><span class="skolem">z</span><span class="main">,</span><span class="skolem">y</span><span class="main">)</span><span class="main">∈</span> <span class="free">r</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">x</span><span class="main">,</span><span class="skolem">y</span><span class="main">)</span> <span class="main">∈</span> <span class="free">r</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span><span class="keyword1"><span class="command">}</span></span> <span class="keyword1"><span class="command">note</span></span> c1 <span class="main">=</span> this
  
 <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">x</span> <span class="skolem">y</span> <span class="keyword3"><span class="command">assume</span></span> a<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">x</span><span class="main">,</span><span class="skolem">y</span><span class="main">)</span> <span class="main">∈</span>  <span class="free">r</span>"</span></span>
   <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">x</span><span class="main">,</span><span class="skolem">x</span><span class="main">)</span> <span class="main">∈</span> e"</span></span> <span class="keyword1"><span class="command">using</span></span> e <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
   <span class="keyword1"><span class="command">with</span></span> a <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">x</span><span class="main">,</span><span class="skolem">y</span><span class="main">)</span> <span class="main">∈</span> e <span class="keyword1">O</span> <span class="free">r</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span><span class="keyword1"><span class="command">}</span></span> <span class="keyword1"><span class="command">note</span></span> c2 <span class="main">=</span> this
 
 <span class="keyword1"><span class="command">from</span></span> c1 c2 <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">lemma</span></span> cre<span class="main">:</span>
<span class="keyword2"><span class="keyword">assumes</span></span>  <span class="quoted"><span class="quoted">"<span class="free">r</span> <span class="main">∈</span> <span class="main">{</span>e<span class="main">,</span>m<span class="main">,</span>b<span class="main">,</span>ov<span class="main">,</span>s<span class="main">,</span>f<span class="main">,</span>d<span class="main">,</span>m<span class="main">^-1</span><span class="main">,</span>b<span class="main">^-1</span><span class="main">,</span>ov<span class="main">^-1</span><span class="main">,</span>s<span class="main">^-1</span><span class="main">,</span>f<span class="main">^-1</span><span class="main">,</span>d<span class="main">^-1</span><span class="main">}</span>"</span></span>
<span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">" <span class="free">r</span> <span class="keyword1">O</span> e <span class="main">=</span> <span class="free">r</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">x</span> <span class="skolem">y</span> <span class="keyword3"><span class="command">assume</span></span> a<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">x</span><span class="main">,</span><span class="skolem">y</span><span class="main">)</span> <span class="main">∈</span> <span class="free">r</span> <span class="keyword1">O</span> e"</span></span> 
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">z</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">x</span><span class="main">,</span><span class="skolem">z</span><span class="main">)</span> <span class="main">∈</span> <span class="free">r</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">z</span><span class="main">,</span><span class="skolem">y</span><span class="main">)</span> <span class="main">∈</span> e"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="main">(</span><span class="skolem">z</span><span class="main">,</span><span class="skolem">y</span><span class="main">)</span> <span class="main">∈</span> e›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">z</span> <span class="main">=</span> <span class="skolem">y</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> e <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">with</span></span> <span class="quoted"><span class="quoted">‹<span class="main">(</span><span class="skolem">x</span><span class="main">,</span><span class="skolem">z</span><span class="main">)</span><span class="main">∈</span> <span class="free">r</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">x</span><span class="main">,</span><span class="skolem">y</span><span class="main">)</span> <span class="main">∈</span> <span class="free">r</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span><span class="keyword1"><span class="command">}</span></span> <span class="keyword1"><span class="command">note</span></span> c1 <span class="main">=</span> this
  
 <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">x</span> <span class="skolem">y</span> <span class="keyword3"><span class="command">assume</span></span> a<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">x</span><span class="main">,</span><span class="skolem">y</span><span class="main">)</span> <span class="main">∈</span>  <span class="free">r</span>"</span></span>
   <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">y</span><span class="main">,</span><span class="skolem">y</span><span class="main">)</span> <span class="main">∈</span> e"</span></span> <span class="keyword1"><span class="command">using</span></span> e <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
   <span class="keyword1"><span class="command">with</span></span> a <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">x</span><span class="main">,</span><span class="skolem">y</span><span class="main">)</span> <span class="main">∈</span> <span class="free">r</span> <span class="keyword1">O</span> e"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span><span class="keyword1"><span class="command">}</span></span> <span class="keyword1"><span class="command">note</span></span> c2 <span class="main">=</span> this
 
 <span class="keyword1"><span class="command">from</span></span> c1 c2 <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">lemmas</span></span> ceb <span class="main">=</span> cer<span class="main">[</span><span class="operator">of</span> <span class="quoted">b</span><span class="main">]</span>
<span class="keyword1"><span class="command">lemmas</span></span> cebi <span class="main">=</span> cer<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="quoted">"b<span class="main">^-1</span>"</span></span><span class="main">]</span>
<span class="keyword1"><span class="command">lemmas</span></span> cem <span class="main">=</span> cer<span class="main">[</span><span class="operator">of</span> <span class="quoted">m</span><span class="main">]</span>
<span class="keyword1"><span class="command">lemmas</span></span> cemi <span class="main">=</span> cer<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="quoted">"m<span class="main">^-1</span>"</span></span><span class="main">]</span>
<span class="keyword1"><span class="command">lemmas</span></span> cee <span class="main">=</span> cer<span class="main">[</span><span class="operator">of</span> <span class="quoted">e</span><span class="main">]</span>
<span class="keyword1"><span class="command">lemmas</span></span> ces <span class="main">=</span> cer<span class="main">[</span><span class="operator">of</span> <span class="quoted">s</span><span class="main">]</span>
<span class="keyword1"><span class="command">lemmas</span></span> cesi <span class="main">=</span> cer<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="quoted">"s<span class="main">^-1</span>"</span></span><span class="main">]</span>
<span class="keyword1"><span class="command">lemmas</span></span> cef <span class="main">=</span> cer<span class="main">[</span><span class="operator">of</span> <span class="quoted">f</span><span class="main">]</span>
<span class="keyword1"><span class="command">lemmas</span></span> cefi <span class="main">=</span> cer<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="quoted">"f<span class="main">^-1</span>"</span></span><span class="main">]</span>
<span class="keyword1"><span class="command">lemmas</span></span> ceov <span class="main">=</span> cer<span class="main">[</span><span class="operator">of</span> <span class="quoted">ov</span><span class="main">]</span>
<span class="keyword1"><span class="command">lemmas</span></span> ceovi <span class="main">=</span> cer<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="quoted">"ov<span class="main">^-1</span>"</span></span><span class="main">]</span>
<span class="keyword1"><span class="command">lemmas</span></span> ced <span class="main">=</span> cer<span class="main">[</span><span class="operator">of</span> <span class="quoted">d</span><span class="main">]</span>
<span class="keyword1"><span class="command">lemmas</span></span> cedi <span class="main">=</span> cer<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="quoted">"d<span class="main">^-1</span>"</span></span><span class="main">]</span>
<span class="keyword1"><span class="command">lemmas</span></span> cbe <span class="main">=</span> cre<span class="main">[</span><span class="operator">of</span> <span class="quoted">b</span><span class="main">]</span>
<span class="keyword1"><span class="command">lemmas</span></span> cbie <span class="main">=</span> cre<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="quoted">"b<span class="main">^-1</span>"</span></span><span class="main">]</span>
<span class="keyword1"><span class="command">lemmas</span></span> cme <span class="main">=</span> cre<span class="main">[</span><span class="operator">of</span> <span class="quoted">m</span><span class="main">]</span>
<span class="keyword1"><span class="command">lemmas</span></span> cmie <span class="main">=</span> cre<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="quoted">"m<span class="main">^-1</span>"</span></span><span class="main">]</span>
<span class="keyword1"><span class="command">lemmas</span></span> cse <span class="main">=</span> cre<span class="main">[</span><span class="operator">of</span> <span class="quoted">s</span><span class="main">]</span>
<span class="keyword1"><span class="command">lemmas</span></span> csie <span class="main">=</span> cre<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="quoted">"s<span class="main">^-1</span>"</span></span><span class="main">]</span>
<span class="keyword1"><span class="command">lemmas</span></span> cfe <span class="main">=</span> cre<span class="main">[</span><span class="operator">of</span> <span class="quoted">f</span><span class="main">]</span>
<span class="keyword1"><span class="command">lemmas</span></span> cfie <span class="main">=</span> cre<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="quoted">"f<span class="main">^-1</span>"</span></span><span class="main">]</span>
<span class="keyword1"><span class="command">lemmas</span></span> cove <span class="main">=</span> cre<span class="main">[</span><span class="operator">of</span> <span class="quoted">ov</span><span class="main">]</span>
<span class="keyword1"><span class="command">lemmas</span></span> covie <span class="main">=</span> cre<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="quoted">"ov<span class="main">^-1</span>"</span></span><span class="main">]</span>
<span class="keyword1"><span class="command">lemmas</span></span> cde <span class="main">=</span> cre<span class="main">[</span><span class="operator">of</span> <span class="quoted">d</span><span class="main">]</span>
<span class="keyword1"><span class="command">lemmas</span></span> cdie <span class="main">=</span> cre<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="quoted">"d<span class="main">^-1</span>"</span></span><span class="main">]</span>

<span class="comment1">(*******)</span>

<span class="comment1">(* composition with single relation *)</span>
<span class="keyword1"><span class="command">subsection</span></span> <span class="quoted"><span class="plain_text">‹r-composition›</span></span>
<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹We prove compositions of the form $r_1 \circ r_2 \subseteq r$, where $r$ is a basic relation.›</span></span>

<span class="keyword1"><span class="command">method</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> arelations<span class="main">)</span> r_compose <span class="keyword2"><span class="keyword">uses</span></span> r1 r2 r3 <span class="main">=</span> <span class="main">(</span><span class="main">(</span><span class="operator">auto</span><span class="main"><span class="keyword3">,</span></span> <span class="main">(</span><span class="operator">subst</span> <span class="main"><span class="main">(</span></span><span class="quasi_keyword">asm</span><span class="main"><span class="main">)</span></span> <span class="dynamic"><span class="dynamic">r1</span></span> <span class="main">)</span><span class="main"><span class="keyword3">,</span></span> <span class="main">(</span><span class="operator">subst</span> <span class="main"><span class="main">(</span></span><span class="quasi_keyword">asm</span><span class="main"><span class="main">)</span></span> <span class="dynamic"><span class="dynamic">r2</span></span><span class="main">)</span><span class="main"><span class="keyword3">,</span></span> <span class="main">(</span><span class="operator">subst</span> <span class="dynamic"><span class="dynamic">r3</span></span><span class="main">)</span><span class="main">)</span> <span class="main"><span class="keyword3">,</span></span>  <span class="main">(</span><span class="operator">meson</span> M5exist_var<span class="main">)</span><span class="main">)</span>


<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> arelations<span class="main">)</span> cbb<span class="main">:</span><span class="quoted"><span class="quoted">"b <span class="keyword1">O</span> b <span class="main">⊆</span> b"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">r_compose</span> <span class="quasi_keyword">r1</span><span class="main"><span class="main">:</span></span>b <span class="quasi_keyword">r2</span><span class="main"><span class="main">:</span></span>b <span class="quasi_keyword">r3</span><span class="main"><span class="main">:</span></span>b<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span>  <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> arelations<span class="main">)</span>  cbm<span class="main">:</span><span class="quoted"><span class="quoted">"b <span class="keyword1">O</span> m <span class="main">⊆</span> b"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">r_compose</span> <span class="quasi_keyword">r1</span><span class="main"><span class="main">:</span></span>b <span class="quasi_keyword">r2</span><span class="main"><span class="main">:</span></span>m <span class="quasi_keyword">r3</span><span class="main"><span class="main">:</span></span>b<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> cbov<span class="main">:</span><span class="quoted"><span class="quoted">"b <span class="keyword1">O</span> ov <span class="main">⊆</span> b"</span></span>
  <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span>b ov<span class="main">)</span>
  <span class="keyword1"><span class="command">using</span></span> M1 M5exist_var <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>

<span class="keyword1"><span class="command">lemma</span></span> cbfi<span class="main">:</span><span class="quoted"><span class="quoted">"b <span class="keyword1">O</span> f<span class="main">^-1</span> <span class="main">⊆</span> b"</span></span>
  <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span>b f<span class="main">)</span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">meson</span> M1 M5exist_var<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> cbdi<span class="main">:</span><span class="quoted"><span class="quoted">"b <span class="keyword1">O</span> d<span class="main">^-1</span> <span class="main">⊆</span> b"</span></span>
  <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> b d<span class="main">)</span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">meson</span> M1 M5exist_var<span class="main">)</span>
 
<span class="keyword1"><span class="command">lemma</span></span> cbs<span class="main">:</span><span class="quoted"><span class="quoted">"b <span class="keyword1">O</span> s <span class="main">⊆</span> b"</span></span>
  <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> b s<span class="main">)</span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">meson</span> M1 M5exist_var<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> cbsi<span class="main">:</span><span class="quoted"><span class="quoted">"b <span class="keyword1">O</span> s<span class="main">^-1</span> <span class="main">⊆</span> b"</span></span>
  <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> b s<span class="main">)</span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">meson</span> M1 M5exist_var<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> arelations<span class="main">)</span> cmb<span class="main">:</span><span class="quoted"><span class="quoted">"m <span class="keyword1">O</span> b <span class="main">⊆</span> b"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">r_compose</span> <span class="quasi_keyword">r1</span><span class="main"><span class="main">:</span></span>m <span class="quasi_keyword">r2</span><span class="main"><span class="main">:</span></span>b <span class="quasi_keyword">r3</span><span class="main"><span class="main">:</span></span>b<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> cmm<span class="main">:</span><span class="quoted"><span class="quoted">"m <span class="keyword1">O</span> m <span class="main">⊆</span> b"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> b m<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> cmov<span class="main">:</span><span class="quoted"><span class="quoted">"m <span class="keyword1">O</span> ov <span class="main">⊆</span> b"</span></span>
  <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span>b m ov<span class="main">)</span>
  <span class="keyword1"><span class="command">using</span></span> M1 M5exist_var <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>

<span class="keyword1"><span class="command">lemma</span></span> cmfi<span class="main">:</span><span class="quoted"><span class="quoted">"m <span class="keyword1">O</span> f<span class="main">^-1</span> <span class="main">⊆</span> b"</span></span>
  <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">r_compose</span> <span class="quasi_keyword">r1</span><span class="main"><span class="main">:</span></span>m <span class="quasi_keyword">r2</span><span class="main"><span class="main">:</span></span>f <span class="quasi_keyword">r3</span><span class="main"><span class="main">:</span></span>b<span class="main">)</span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">meson</span> M1<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> cmdi<span class="main">:</span><span class="quoted"><span class="quoted">"m <span class="keyword1">O</span> d<span class="main">^-1</span> <span class="main">⊆</span> b"</span></span>
  <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span>m d b<span class="main">)</span>
  <span class="keyword1"><span class="command">using</span></span> M1 <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>

<span class="keyword1"><span class="command">lemma</span></span> cms<span class="main">:</span><span class="quoted"><span class="quoted">"m <span class="keyword1">O</span> s <span class="main">⊆</span> m"</span></span>
  <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span>m s<span class="main">)</span>
  <span class="keyword1"><span class="command">using</span></span> M1 <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">lemma</span></span> cmsi<span class="main">:</span><span class="quoted"><span class="quoted">"m <span class="keyword1">O</span> s<span class="main">^-1</span> <span class="main">⊆</span> m"</span></span>
  <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span>m s<span class="main">)</span>
  <span class="keyword1"><span class="command">using</span></span> M1 <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>

<span class="keyword1"><span class="command">lemma</span></span> covb<span class="main">:</span><span class="quoted"><span class="quoted">"ov <span class="keyword1">O</span> b <span class="main">⊆</span> b"</span></span>
  <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span>ov b<span class="main">)</span>
  <span class="keyword1"><span class="command">using</span></span> M1 M5exist_var <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>

<span class="keyword1"><span class="command">lemma</span></span> covm<span class="main">:</span><span class="quoted"><span class="quoted">"ov <span class="keyword1">O</span> m <span class="main">⊆</span> b"</span></span>
  <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span>ov m b<span class="main">)</span>
  <span class="keyword1"><span class="command">using</span></span> M1 <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>

<span class="keyword1"><span class="command">lemma</span></span> covs<span class="main">:</span><span class="quoted"><span class="quoted">"ov <span class="keyword1">O</span> s <span class="main">⊆</span> ov"</span></span> 
<span class="keyword1"><span class="command">proof</span></span>
  <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">p</span><span class="main">::</span><span class="quoted"><span class="quoted">"<span class="tfree">'a</span><span class="main">×</span><span class="tfree">'a</span>"</span></span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">p</span> <span class="main">∈</span> ov <span class="keyword1">O</span> s"</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">x</span></span> <span class="skolem"><span class="skolem">y</span></span> <span class="skolem"><span class="skolem">z</span></span> <span class="keyword2"><span class="keyword">where</span></span> p<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">p</span> <span class="main">=</span> <span class="main">(</span><span class="skolem">x</span><span class="main">,</span><span class="skolem">z</span><span class="main">)</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> xyov<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">x</span><span class="main">,</span><span class="skolem">y</span><span class="main">)</span><span class="main">∈</span> ov"</span></span> <span class="keyword2"><span class="keyword">and</span></span> yzs<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">y</span><span class="main">,</span><span class="skolem">z</span><span class="main">)</span> <span class="main">∈</span> s"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">from</span></span> xyov <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">r</span></span> <span class="skolem"><span class="skolem">u</span></span> <span class="skolem"><span class="skolem">v</span></span> <span class="skolem"><span class="skolem">t</span></span> <span class="skolem"><span class="skolem">k</span></span> <span class="keyword2"><span class="keyword">where</span></span> rx<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">r</span><span class="main">∥</span><span class="skolem">x</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> xu<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">x</span><span class="main">∥</span><span class="skolem">u</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> uv<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">u</span><span class="main">∥</span><span class="skolem">v</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> rt<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">r</span><span class="main">∥</span><span class="skolem">t</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> tk<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">t</span><span class="main">∥</span><span class="skolem">k</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> ty<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">t</span><span class="main">∥</span><span class="skolem">y</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> yv<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">y</span><span class="main">∥</span><span class="skolem">v</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> ku<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">k</span><span class="main">∥</span><span class="skolem">u</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> ov <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">from</span></span> yzs <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">l1</span></span> <span class="skolem"><span class="skolem">l2</span></span> <span class="keyword2"><span class="keyword">where</span></span> yl1<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">y</span><span class="main">∥</span><span class="skolem">l1</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> l1l2<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">l1</span><span class="main">∥</span><span class="skolem">l2</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> zl2<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">z</span><span class="main">∥</span><span class="skolem">l2</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> s <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">from</span></span> uv yl1 yv <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">u</span><span class="main">∥</span><span class="skolem">l1</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> M1 <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">with</span></span> xu l1l2 <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">ul1</span></span> <span class="keyword2"><span class="keyword">where</span></span> xul1<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">x</span><span class="main">∥</span><span class="skolem">ul1</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> ul1l2<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">ul1</span><span class="main">∥</span><span class="skolem">l2</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> M5exist_var <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">from</span></span> ku xu xul1 l1l2 <span class="keyword1"><span class="command">have</span></span> kul1<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">k</span><span class="main">∥</span><span class="skolem">ul1</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> M1 <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">from</span></span> ty yzs <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">t</span><span class="main">∥</span><span class="skolem">z</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> s M1 <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">with</span></span> rx rt xul1 ul1l2 zl2 tk kul1 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">x</span><span class="main">,</span><span class="skolem">z</span><span class="main">)</span> <span class="main">∈</span> ov"</span></span> <span class="keyword1"><span class="command">using</span></span> ov <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">with</span></span> p <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">p</span> <span class="main">∈</span> ov"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">lemma</span></span> cfib<span class="main">:</span><span class="quoted"><span class="quoted">"f<span class="main">^-1</span> <span class="keyword1">O</span> b <span class="main">⊆</span> b"</span></span> 
  <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span>f b<span class="main">)</span>
  <span class="keyword1"><span class="command">using</span></span> M1 <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>

<span class="keyword1"><span class="command">lemma</span></span> cfim<span class="main">:</span><span class="quoted"><span class="quoted">"f<span class="main">^-1</span> <span class="keyword1">O</span> m <span class="main">⊆</span> m"</span></span>
  <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span>f m<span class="main">)</span>
  <span class="keyword1"><span class="command">using</span></span> M1 <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">lemma</span></span> cfiov<span class="main">:</span><span class="quoted"><span class="quoted">"f<span class="main">^-1</span> <span class="keyword1">O</span> ov <span class="main">⊆</span> ov"</span></span> 
<span class="keyword1"><span class="command">proof</span></span> 
    <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">p</span><span class="main">::</span><span class="quoted"><span class="quoted">"<span class="tfree">'a</span><span class="main">×</span><span class="tfree">'a</span>"</span></span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">p</span> <span class="main">∈</span> f<span class="main">^-1</span> <span class="keyword1">O</span> ov"</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">x</span></span> <span class="skolem"><span class="skolem">y</span></span> <span class="skolem"><span class="skolem">z</span></span> <span class="keyword2"><span class="keyword">where</span></span> p<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">p</span> <span class="main">=</span> <span class="main">(</span><span class="skolem">x</span><span class="main">,</span><span class="skolem">z</span><span class="main">)</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> xyfi<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">x</span><span class="main">,</span><span class="skolem">y</span><span class="main">)</span><span class="main">∈</span> f<span class="main">^-1</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> yzov<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">y</span><span class="main">,</span><span class="skolem">z</span><span class="main">)</span> <span class="main">∈</span> ov"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">from</span></span> xyfi yzov <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">t'</span></span> <span class="skolem"><span class="skolem">r</span></span> <span class="skolem"><span class="skolem">u</span></span>   <span class="keyword2"><span class="keyword">where</span></span> tpr<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">t'</span><span class="main">∥</span><span class="skolem">r</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> ry<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">r</span><span class="main">∥</span><span class="skolem">y</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> yu<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">y</span><span class="main">∥</span><span class="skolem">u</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> tpx<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">t'</span><span class="main">∥</span><span class="skolem">x</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> xu<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">x</span><span class="main">∥</span><span class="skolem">u</span>"</span></span>  <span class="keyword1"><span class="command">using</span></span> f  <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
    <span class="keyword1"><span class="command">from</span></span> yzov  ry  <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">v</span></span> <span class="skolem"><span class="skolem">k</span></span> <span class="skolem"><span class="skolem">t</span></span> <span class="skolem"><span class="skolem">u'</span></span> <span class="keyword2"><span class="keyword">where</span></span> yup<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">y</span><span class="main">∥</span><span class="skolem">u'</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> upv<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">u'</span><span class="main">∥</span><span class="skolem">v</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> rk<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">r</span><span class="main">∥</span><span class="skolem">k</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> kz<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">k</span><span class="main">∥</span><span class="skolem">z</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> zv<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">z</span><span class="main">∥</span><span class="skolem">v</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> kt<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">k</span><span class="main">∥</span><span class="skolem">t</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> tup<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">t</span><span class="main">∥</span><span class="skolem">u'</span>"</span></span> 
    <span class="keyword1"><span class="command">using</span></span> ov <span class="keyword1"><span class="command">using</span></span> M1 <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
    <span class="keyword1"><span class="command">from</span></span> yu xu yup <span class="keyword1"><span class="command">have</span></span> xup<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">x</span><span class="main">∥</span><span class="skolem">u'</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> M1 <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
    <span class="keyword1"><span class="command">from</span></span> tpr rk kt <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">r'</span></span> <span class="keyword2"><span class="keyword">where</span></span> tprp<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">t'</span><span class="main">∥</span><span class="skolem">r'</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> rpt<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">r'</span><span class="main">∥</span><span class="skolem">t</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> M5exist_var <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
    <span class="keyword1"><span class="command">from</span></span> kt rpt kz <span class="keyword1"><span class="command">have</span></span> rpz<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">r'</span><span class="main">∥</span><span class="skolem">z</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> M1 <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
    <span class="keyword1"><span class="command">from</span></span> tprp rpz rpt tpx xup zv upv tup <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">x</span><span class="main">,</span><span class="skolem">z</span><span class="main">)</span> <span class="main">∈</span> ov"</span></span> <span class="keyword1"><span class="command">using</span></span> ov <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
    <span class="keyword1"><span class="command">with</span></span> p <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">p</span> <span class="main">∈</span> ov"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">lemma</span></span> cfifi<span class="main">:</span><span class="quoted"><span class="quoted">"f<span class="main">^-1</span> <span class="keyword1">O</span> f<span class="main">^-1</span> <span class="main">⊆</span> f<span class="main">^-1</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span>
  <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">x</span><span class="main">::</span><span class="quoted"><span class="quoted">"<span class="tfree">'a</span><span class="main">×</span><span class="tfree">'a</span>"</span></span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">∈</span> f<span class="main">^-1</span> <span class="keyword1">O</span> f<span class="main">^-1</span>"</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">p</span></span> <span class="skolem"><span class="skolem">q</span></span> <span class="skolem"><span class="skolem">z</span></span> <span class="keyword2"><span class="keyword">where</span></span> x<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">=</span> <span class="main">(</span><span class="skolem">p</span><span class="main">,</span> <span class="skolem">q</span><span class="main">)</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">p</span><span class="main">,</span><span class="skolem">z</span><span class="main">)</span> <span class="main">∈</span> f<span class="main">^-1</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">z</span><span class="main">,</span><span class="skolem">q</span><span class="main">)</span> <span class="main">∈</span> f<span class="main">^-1</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="main">(</span><span class="skolem">p</span><span class="main">,</span><span class="skolem">z</span><span class="main">)</span> <span class="main">∈</span> f<span class="main">^-1</span>›</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">k</span></span> <span class="skolem"><span class="skolem">l</span></span> <span class="skolem"><span class="skolem">u</span></span>  <span class="keyword2"><span class="keyword">where</span></span> kp<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">k</span><span class="main">∥</span><span class="skolem">p</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> kl<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">k</span><span class="main">∥</span><span class="skolem">l</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> lz<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">l</span><span class="main">∥</span><span class="skolem">z</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> pu<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">p</span><span class="main">∥</span><span class="skolem">u</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> zu<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">z</span><span class="main">∥</span><span class="skolem">u</span>"</span></span>  <span class="keyword1"><span class="command">using</span></span> f  <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="main">(</span><span class="skolem">z</span><span class="main">,</span><span class="skolem">q</span><span class="main">)</span> <span class="main">∈</span> f<span class="main">^-1</span>›</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">k'</span></span> <span class="skolem"><span class="skolem">u'</span></span> <span class="skolem"><span class="skolem">l'</span></span> <span class="keyword2"><span class="keyword">where</span></span> kpz<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">k'</span><span class="main">∥</span><span class="skolem">z</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> kplp<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">k'</span><span class="main">∥</span><span class="skolem">l'</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> lpq<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">l'</span><span class="main">∥</span><span class="skolem">q</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> qup<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">q</span><span class="main">∥</span><span class="skolem">u'</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> zup<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">z</span><span class="main">∥</span><span class="skolem">u'</span>"</span></span>  <span class="keyword1"><span class="command">using</span></span> f  <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">from</span></span> zu zup pu <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">p</span><span class="main">∥</span><span class="skolem">u'</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> M1 <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">from</span></span> lz kpz kplp <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">l</span><span class="main">∥</span><span class="skolem">l'</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> M1 <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">with</span></span> kl lpq <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">ll</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">k</span><span class="main">∥</span><span class="skolem">ll</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">ll</span><span class="main">∥</span><span class="skolem">q</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> M5exist_var <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">with</span></span> kp <span class="quoted"><span class="quoted">‹<span class="skolem">p</span><span class="main">∥</span><span class="skolem">u'</span>›</span></span> qup <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">∈</span> f<span class="main">^-1</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> x f <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">lemma</span></span> cfidi<span class="main">:</span><span class="quoted"><span class="quoted">"f<span class="main">^-1</span> <span class="keyword1">O</span> d<span class="main">^-1</span> <span class="main">⊆</span> d<span class="main">^-1</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span>
  <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">x</span><span class="main">::</span><span class="quoted"><span class="quoted">"<span class="tfree">'a</span><span class="main">×</span><span class="tfree">'a</span>"</span></span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">:</span> f<span class="main">^-1</span> <span class="keyword1">O</span> d<span class="main">^-1</span>"</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">p</span></span> <span class="skolem"><span class="skolem">q</span></span> <span class="skolem"><span class="skolem">z</span></span> <span class="keyword2"><span class="keyword">where</span></span> x<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">=</span> <span class="main">(</span><span class="skolem">p</span><span class="main">,</span><span class="skolem">q</span><span class="main">)</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">p</span><span class="main">,</span><span class="skolem">z</span><span class="main">)</span> <span class="main">∈</span> f<span class="main">^-1</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">z</span><span class="main">,</span><span class="skolem">q</span><span class="main">)</span> <span class="main">∈</span> d<span class="main">^-1</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">k</span></span> <span class="skolem"><span class="skolem">l</span></span> <span class="skolem"><span class="skolem">u</span></span> <span class="keyword2"><span class="keyword">where</span></span> kp<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">k</span> <span class="main">∥</span> <span class="skolem">p</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> kl<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">k</span><span class="main">∥</span><span class="skolem">l</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> lz<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">l</span><span class="main">∥</span><span class="skolem">z</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> pu<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">p</span> <span class="main">∥</span><span class="skolem">u</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span>  zu<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">z</span><span class="main">∥</span><span class="skolem">u</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> f  <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">k'</span></span> <span class="skolem"><span class="skolem">l'</span></span> <span class="skolem"><span class="skolem">u'</span></span> <span class="skolem"><span class="skolem">v'</span></span> <span class="keyword2"><span class="keyword">where</span></span> kpz<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">k'</span> <span class="main">∥</span><span class="skolem">z</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> kplp<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">k'</span> <span class="main">∥</span><span class="skolem">l'</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> lpq<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">l'</span> <span class="main">∥</span><span class="skolem">q</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span>  qup<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">q</span> <span class="main">∥</span><span class="skolem">u'</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span>  upvp<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">u'</span><span class="main">∥</span><span class="skolem">v'</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> zvp<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">z</span><span class="main">∥</span><span class="skolem">v'</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> d <span class="quoted"><span class="quoted">‹<span class="main">(</span><span class="skolem">z</span><span class="main">,</span><span class="skolem">q</span><span class="main">)</span><span class="main">∈</span>d<span class="main">^-1</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">from</span></span> lz kpz kplp <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">l</span><span class="main">∥</span><span class="skolem">l'</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> M1 <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">with</span></span> kl lpq <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">ll</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">k</span><span class="main">∥</span><span class="skolem">ll</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">ll</span><span class="main">∥</span><span class="skolem">q</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> M5exist_var <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> zu zvp upvp <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">u'</span> <span class="main">∥</span> <span class="skolem">u</span> "</span></span> <span class="keyword1"><span class="command">using</span></span> M1 <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">∈</span> d<span class="main">^-1</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> x kp pu qup d  <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">lemma</span></span> cfis<span class="main">:</span><span class="quoted"><span class="quoted">"f<span class="main">^-1</span> <span class="keyword1">O</span> s <span class="main">⊆</span> ov"</span></span>
<span class="keyword1"><span class="command">proof</span></span>
   <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">x</span><span class="main">::</span><span class="quoted"><span class="quoted">"<span class="tfree">'a</span><span class="main">×</span><span class="tfree">'a</span>"</span></span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">∈</span> f<span class="main">^-1</span> <span class="keyword1">O</span> s"</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">p</span></span> <span class="skolem"><span class="skolem">q</span></span> <span class="skolem"><span class="skolem">z</span></span> <span class="keyword2"><span class="keyword">where</span></span> x<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">=</span> <span class="main">(</span><span class="skolem">p</span><span class="main">,</span><span class="skolem">q</span><span class="main">)</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">p</span><span class="main">,</span><span class="skolem">z</span><span class="main">)</span><span class="main">∈</span> f<span class="main">^-1</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">z</span><span class="main">,</span><span class="skolem">q</span><span class="main">)</span> <span class="main">∈</span> s"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
   <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="main">(</span><span class="skolem">p</span><span class="main">,</span><span class="skolem">z</span><span class="main">)</span><span class="main">∈</span> f<span class="main">^-1</span>›</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">k</span></span> <span class="skolem"><span class="skolem">l</span></span> <span class="skolem"><span class="skolem">u</span></span> <span class="keyword2"><span class="keyword">where</span></span> kp<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">k</span><span class="main">∥</span><span class="skolem">p</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> kl<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">k</span><span class="main">∥</span><span class="skolem">l</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> lz<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">l</span><span class="main">∥</span><span class="skolem">z</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> pu<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">p</span><span class="main">∥</span><span class="skolem">u</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> zu<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">z</span><span class="main">∥</span><span class="skolem">u</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> f <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
   <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="main">(</span><span class="skolem">z</span><span class="main">,</span><span class="skolem">q</span><span class="main">)</span><span class="main">∈</span> s›</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">k'</span></span> <span class="skolem"><span class="skolem">u'</span></span> <span class="skolem"><span class="skolem">v'</span></span> <span class="keyword2"><span class="keyword">where</span></span> kpz<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">k'</span><span class="main">∥</span><span class="skolem">z</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> kpq<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">k'</span><span class="main">∥</span><span class="skolem">q</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> zup<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">z</span><span class="main">∥</span><span class="skolem">u'</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> upvp<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">u'</span><span class="main">∥</span><span class="skolem">v'</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> qvp<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">q</span><span class="main">∥</span><span class="skolem">v'</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> s M1 <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
   <span class="keyword1"><span class="command">from</span></span> pu zu zup <span class="keyword1"><span class="command">have</span></span> pup<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">p</span><span class="main">∥</span><span class="skolem">u'</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> M1 <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
   <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> lz kpz kpq <span class="keyword1"><span class="command">have</span></span> lq<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">l</span><span class="main">∥</span><span class="skolem">q</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> M1 <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
   <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">∈</span> ov"</span></span> <span class="keyword1"><span class="command">using</span></span> x lz zup kp kl upvp upvp ov qvp <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">lemma</span></span> cfisi<span class="main">:</span><span class="quoted"><span class="quoted">"f<span class="main">^-1</span> <span class="keyword1">O</span> s<span class="main">^-1</span> <span class="main">⊆</span> d<span class="main">^-1</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span>
  <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">x</span><span class="main">::</span><span class="quoted"><span class="quoted">"<span class="tfree">'a</span><span class="main">×</span><span class="tfree">'a</span>"</span></span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">∈</span> f<span class="main">^-1</span> <span class="keyword1">O</span> s<span class="main">^-1</span>"</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">p</span></span> <span class="skolem"><span class="skolem">q</span></span> <span class="skolem"><span class="skolem">z</span></span> <span class="keyword2"><span class="keyword">where</span></span> x<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">=</span> <span class="main">(</span><span class="skolem">p</span><span class="main">,</span><span class="skolem">q</span><span class="main">)</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">p</span><span class="main">,</span><span class="skolem">z</span><span class="main">)</span> <span class="main">∈</span> f<span class="main">^-1</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">z</span><span class="main">,</span><span class="skolem">q</span><span class="main">)</span> <span class="main">∈</span> s<span class="main">^-1</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">k</span></span> <span class="skolem"><span class="skolem">l</span></span> <span class="skolem"><span class="skolem">u</span></span> <span class="keyword2"><span class="keyword">where</span></span> kp<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">k</span> <span class="main">∥</span> <span class="skolem">p</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> kl<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">k</span><span class="main">∥</span><span class="skolem">l</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> lz<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">l</span><span class="main">∥</span><span class="skolem">z</span>"</span></span>  <span class="keyword2"><span class="keyword">and</span></span> pu<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">p</span> <span class="main">∥</span><span class="skolem">u</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span>  zu<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">z</span><span class="main">∥</span><span class="skolem">u</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> f  <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">k'</span></span> <span class="skolem"><span class="skolem">u'</span></span> <span class="skolem"><span class="skolem">v'</span></span> <span class="keyword2"><span class="keyword">where</span></span> kpz<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">k'</span> <span class="main">∥</span><span class="skolem">z</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> kpq<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">k'</span> <span class="main">∥</span><span class="skolem">q</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> qup<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">q</span> <span class="main">∥</span><span class="skolem">u'</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span>  upvp<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">u'</span><span class="main">∥</span><span class="skolem">v'</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span>  zvp<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">z</span><span class="main">∥</span><span class="skolem">v'</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> s <span class="quoted"><span class="quoted">‹<span class="main">(</span><span class="skolem">z</span><span class="main">,</span><span class="skolem">q</span><span class="main">)</span><span class="main">:</span> s<span class="main">^-1</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">from</span></span> zu zvp upvp <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">u'</span><span class="main">∥</span><span class="skolem">u</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> M1 <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> lz kpz kpq <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">l</span> <span class="main">∥</span><span class="skolem">q</span> "</span></span> <span class="keyword1"><span class="command">using</span></span> M1 <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">∈</span> d<span class="main">^-1</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> x d kl kp qup  pu  <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">lemma</span></span> cdifi<span class="main">:</span><span class="quoted"><span class="quoted">"d<span class="main">^-1</span> <span class="keyword1">O</span> f<span class="main">^-1</span> <span class="main">⊆</span> d<span class="main">^-1</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span>
  <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">x</span><span class="main">::</span><span class="quoted"><span class="quoted">"<span class="tfree">'a</span><span class="main">×</span><span class="tfree">'a</span>"</span></span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">:</span> d<span class="main">^-1</span> <span class="keyword1">O</span> f<span class="main">^-1</span>"</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">p</span></span> <span class="skolem"><span class="skolem">q</span></span> <span class="skolem"><span class="skolem">z</span></span> <span class="keyword2"><span class="keyword">where</span></span> x<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">=</span> <span class="main">(</span><span class="skolem">p</span><span class="main">,</span><span class="skolem">q</span><span class="main">)</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">p</span><span class="main">,</span><span class="skolem">z</span><span class="main">)</span> <span class="main">∈</span> d<span class="main">^-1</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">z</span><span class="main">,</span><span class="skolem">q</span><span class="main">)</span> <span class="main">∈</span> f<span class="main">^-1</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">k</span></span> <span class="skolem"><span class="skolem">l</span></span> <span class="skolem"><span class="skolem">u</span></span> <span class="skolem"><span class="skolem">v</span></span>  <span class="keyword2"><span class="keyword">where</span></span> kp<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">k</span> <span class="main">∥</span> <span class="skolem">p</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> kl<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">k</span><span class="main">∥</span><span class="skolem">l</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> lz<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">l</span><span class="main">∥</span><span class="skolem">z</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> zu<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">z</span> <span class="main">∥</span><span class="skolem">u</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> uv<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">u</span><span class="main">∥</span><span class="skolem">v</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> pv<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">p</span><span class="main">∥</span><span class="skolem">v</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> d  <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">k'</span></span> <span class="skolem"><span class="skolem">l'</span></span> <span class="skolem"><span class="skolem">u'</span></span> <span class="keyword2"><span class="keyword">where</span></span> kpz<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">k'</span> <span class="main">∥</span><span class="skolem">z</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> kplp<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">k'</span> <span class="main">∥</span><span class="skolem">l'</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> lpq<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">l'</span> <span class="main">∥</span><span class="skolem">q</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span>  qup<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">q</span> <span class="main">∥</span><span class="skolem">u'</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> zup<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">z</span><span class="main">∥</span><span class="skolem">u'</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> f <span class="quoted"><span class="quoted">‹<span class="main">(</span><span class="skolem">z</span><span class="main">,</span><span class="skolem">q</span><span class="main">)</span><span class="main">:</span> f<span class="main">^-1</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">from</span></span> lz kpz kplp  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">l</span><span class="main">∥</span><span class="skolem">l'</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> M1 <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">with</span></span> kl lpq <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">ll</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">k</span><span class="main">∥</span><span class="skolem">ll</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">ll</span><span class="main">∥</span><span class="skolem">q</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> M5exist_var <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> zu qup zup <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">q</span> <span class="main">∥</span> <span class="skolem">u</span> "</span></span> <span class="keyword1"><span class="command">using</span></span> M1 <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">∈</span> d<span class="main">^-1</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> x d kp uv pv  <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">lemma</span></span> cdidi<span class="main">:</span><span class="quoted"><span class="quoted">"d<span class="main">^-1</span> <span class="keyword1">O</span> d<span class="main">^-1</span> <span class="main">⊆</span> d<span class="main">^-1</span>"</span></span> 
<span class="keyword1"><span class="command">proof</span></span>
  <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">x</span><span class="main">::</span><span class="quoted"><span class="quoted">"<span class="tfree">'a</span><span class="main">×</span><span class="tfree">'a</span>"</span></span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">:</span> d<span class="main">^-1</span> <span class="keyword1">O</span> d<span class="main">^-1</span>"</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">p</span></span> <span class="skolem"><span class="skolem">q</span></span> <span class="skolem"><span class="skolem">z</span></span> <span class="keyword2"><span class="keyword">where</span></span> x<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">=</span> <span class="main">(</span><span class="skolem">p</span><span class="main">,</span><span class="skolem">q</span><span class="main">)</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">p</span><span class="main">,</span><span class="skolem">z</span><span class="main">)</span> <span class="main">∈</span> d<span class="main">^-1</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">z</span><span class="main">,</span><span class="skolem">q</span><span class="main">)</span> <span class="main">∈</span> d<span class="main">^-1</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">k</span></span> <span class="skolem"><span class="skolem">l</span></span> <span class="skolem"><span class="skolem">u</span></span> <span class="skolem"><span class="skolem">v</span></span> <span class="keyword2"><span class="keyword">where</span></span> kp<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">k</span> <span class="main">∥</span> <span class="skolem">p</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> kl<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">k</span><span class="main">∥</span><span class="skolem">l</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> lz<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">l</span><span class="main">∥</span><span class="skolem">z</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> zu<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">z</span> <span class="main">∥</span><span class="skolem">u</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> uv<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">u</span><span class="main">∥</span><span class="skolem">v</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> pv<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">p</span><span class="main">∥</span><span class="skolem">v</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> d  <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">k'</span></span> <span class="skolem"><span class="skolem">l'</span></span> <span class="skolem"><span class="skolem">u'</span></span> <span class="skolem"><span class="skolem">v'</span></span> <span class="keyword2"><span class="keyword">where</span></span> kpz<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">k'</span> <span class="main">∥</span><span class="skolem">z</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> kplp<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">k'</span> <span class="main">∥</span><span class="skolem">l'</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> lpq<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">l'</span> <span class="main">∥</span><span class="skolem">q</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span>  qup<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">q</span> <span class="main">∥</span><span class="skolem">u'</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> upvp<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">u'</span> <span class="main">∥</span><span class="skolem">v'</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> zvp<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">z</span> <span class="main">∥</span><span class="skolem">v'</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> d <span class="quoted"><span class="quoted">‹<span class="main">(</span><span class="skolem">z</span><span class="main">,</span><span class="skolem">q</span><span class="main">)</span><span class="main">:</span> d<span class="main">^-1</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">from</span></span> lz kpz kplp  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">l</span><span class="main">∥</span><span class="skolem">l'</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> M1 <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">with</span></span> kl lpq <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">ll</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">k</span><span class="main">∥</span><span class="skolem">ll</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">ll</span><span class="main">∥</span><span class="skolem">q</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> M5exist_var <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> zvp zu upvp <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">u'</span> <span class="main">∥</span> <span class="skolem">u</span> "</span></span> <span class="keyword1"><span class="command">using</span></span> M1 <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command"><span class="improper">with</span></span></span> qup uv <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">uu</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">q</span><span class="main">∥</span><span class="skolem">uu</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">uu</span><span class="main">∥</span><span class="skolem">v</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> M5exist_var  <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">∈</span> d<span class="main">^-1</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> x d kp pv   <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">lemma</span></span> cdisi<span class="main">:</span><span class="quoted"><span class="quoted">"d<span class="main">^-1</span> <span class="keyword1">O</span> s<span class="main">^-1</span> <span class="main">⊆</span> d<span class="main">^-1</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span>
  <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">x</span><span class="main">::</span><span class="quoted"><span class="quoted">"<span class="tfree">'a</span><span class="main">×</span><span class="tfree">'a</span>"</span></span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">:</span> d<span class="main">^-1</span> <span class="keyword1">O</span> s<span class="main">^-1</span>"</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">p</span></span> <span class="skolem"><span class="skolem">q</span></span> <span class="skolem"><span class="skolem">z</span></span> <span class="keyword2"><span class="keyword">where</span></span> x<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">=</span> <span class="main">(</span><span class="skolem">p</span><span class="main">,</span><span class="skolem">q</span><span class="main">)</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">p</span><span class="main">,</span><span class="skolem">z</span><span class="main">)</span> <span class="main">∈</span> d<span class="main">^-1</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">z</span><span class="main">,</span><span class="skolem">q</span><span class="main">)</span> <span class="main">∈</span> s<span class="main">^-1</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">k</span></span> <span class="skolem"><span class="skolem">l</span></span>  <span class="skolem"><span class="skolem">u</span></span> <span class="skolem"><span class="skolem">v</span></span> <span class="keyword2"><span class="keyword">where</span></span> kp<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">k</span> <span class="main">∥</span><span class="skolem">p</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> kl<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">k</span><span class="main">∥</span><span class="skolem">l</span>"</span></span>  <span class="keyword2"><span class="keyword">and</span></span> lz<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">l</span><span class="main">∥</span><span class="skolem">z</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> zu<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">z</span><span class="main">∥</span><span class="skolem">u</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> uv<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">u</span><span class="main">∥</span><span class="skolem">v</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> pv<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">p</span><span class="main">∥</span><span class="skolem">v</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> d <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">k'</span></span> <span class="skolem"><span class="skolem">u'</span></span> <span class="skolem"><span class="skolem">v'</span></span> <span class="keyword2"><span class="keyword">where</span></span> kpz<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">k'</span> <span class="main">∥</span><span class="skolem">z</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> kpq<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">k'</span> <span class="main">∥</span><span class="skolem">q</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span>  qup<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">q</span> <span class="main">∥</span><span class="skolem">u'</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> upvp<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">u'</span> <span class="main">∥</span><span class="skolem">v'</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> zvp<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">z</span> <span class="main">∥</span><span class="skolem">v'</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> s <span class="quoted"><span class="quoted">‹<span class="main">(</span><span class="skolem">z</span><span class="main">,</span><span class="skolem">q</span><span class="main">)</span><span class="main">:</span> s<span class="main">^-1</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">from</span></span> upvp zvp zu <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">u'</span><span class="main">∥</span><span class="skolem">u</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> M1 <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">with</span></span> qup uv <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">uu</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">q</span><span class="main">∥</span><span class="skolem">uu</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">uu</span><span class="main">∥</span><span class="skolem">v</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> M5exist_var <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> kpz lz kpq <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">l</span> <span class="main">∥</span><span class="skolem">q</span> "</span></span> <span class="keyword1"><span class="command">using</span></span> M1 <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">∈</span> d<span class="main">^-1</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> x d kp kl pv  <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">lemma</span></span> csb<span class="main">:</span><span class="quoted"><span class="quoted">"s <span class="keyword1">O</span> b <span class="main">⊆</span> b"</span></span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span>s b<span class="main">)</span>
<span class="keyword1"><span class="command">using</span></span> M1 M5exist_var <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>

<span class="keyword1"><span class="command">lemma</span></span> csm<span class="main">:</span><span class="quoted"><span class="quoted">"s <span class="keyword1">O</span> m <span class="main">⊆</span> b"</span></span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span>s m b<span class="main">)</span>
<span class="keyword1"><span class="command">using</span></span> M1 <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>

<span class="keyword1"><span class="command">lemma</span></span> css<span class="main">:</span><span class="quoted"><span class="quoted">"s <span class="keyword1">O</span> s <span class="main">⊆</span> s"</span></span>
<span class="keyword1"><span class="command">proof</span></span>
  <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">x</span><span class="main">::</span><span class="quoted"><span class="quoted">"<span class="tfree">'a</span><span class="main">×</span><span class="tfree">'a</span>"</span></span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">∈</span> s <span class="keyword1">O</span> s"</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">p</span></span> <span class="skolem"><span class="skolem">q</span></span> <span class="skolem"><span class="skolem">z</span></span> <span class="keyword2"><span class="keyword">where</span></span> x<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">=</span> <span class="main">(</span><span class="skolem">p</span><span class="main">,</span><span class="skolem">q</span><span class="main">)</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">p</span><span class="main">,</span><span class="skolem">z</span><span class="main">)</span> <span class="main">∈</span> s"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">z</span><span class="main">,</span><span class="skolem">q</span><span class="main">)</span> <span class="main">∈</span> s"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="main">(</span><span class="skolem">p</span><span class="main">,</span><span class="skolem">z</span><span class="main">)</span> <span class="main">∈</span> s›</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">k</span></span> <span class="skolem"><span class="skolem">u</span></span> <span class="skolem"><span class="skolem">v</span></span> <span class="keyword2"><span class="keyword">where</span></span> kp<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">k</span><span class="main">∥</span><span class="skolem">p</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> kz<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">k</span><span class="main">∥</span><span class="skolem">z</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> pu<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">p</span><span class="main">∥</span><span class="skolem">u</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> uv<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">u</span><span class="main">∥</span><span class="skolem">v</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> zv<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">z</span><span class="main">∥</span><span class="skolem">v</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> s <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="main">(</span><span class="skolem">z</span><span class="main">,</span><span class="skolem">q</span><span class="main">)</span> <span class="main">∈</span> s›</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">k'</span></span> <span class="skolem"><span class="skolem">u'</span></span> <span class="skolem"><span class="skolem">v'</span></span> <span class="keyword2"><span class="keyword">where</span></span> kpq<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">k'</span><span class="main">∥</span><span class="skolem">q</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> kpz<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">k'</span><span class="main">∥</span><span class="skolem">z</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> zup<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">z</span><span class="main">∥</span><span class="skolem">u'</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> upvp<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">u'</span><span class="main">∥</span><span class="skolem">v'</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> qvp<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">q</span><span class="main">∥</span><span class="skolem">v'</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> s <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">from</span></span> kp kpz kz <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">k'</span><span class="main">∥</span><span class="skolem">p</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> M1 <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> uv zup zv <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">u</span><span class="main">∥</span><span class="skolem">u'</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> M1 <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command"><span class="improper">with</span></span></span> pu upvp <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">uu</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">p</span><span class="main">∥</span><span class="skolem">uu</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">uu</span><span class="main">∥</span><span class="skolem">v'</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> M5exist_var <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">∈</span> s"</span></span> <span class="keyword1"><span class="command">using</span></span> x s kpq qvp  <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">lemma</span></span> csifi<span class="main">:</span><span class="quoted"><span class="quoted">"s<span class="main">^-1</span> <span class="keyword1">O</span> f<span class="main">^-1</span> <span class="main">⊆</span> d<span class="main">^-1</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span>
  <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">x</span><span class="main">::</span><span class="quoted"><span class="quoted">"<span class="tfree">'a</span><span class="main">×</span><span class="tfree">'a</span>"</span></span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">:</span> s<span class="main">^-1</span> <span class="keyword1">O</span> f<span class="main">^-1</span>"</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">p</span></span> <span class="skolem"><span class="skolem">q</span></span> <span class="skolem"><span class="skolem">z</span></span> <span class="keyword2"><span class="keyword">where</span></span> x<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">=</span> <span class="main">(</span><span class="skolem">p</span><span class="main">,</span><span class="skolem">q</span><span class="main">)</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">p</span><span class="main">,</span><span class="skolem">z</span><span class="main">)</span> <span class="main">∈</span> s<span class="main">^-1</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">z</span><span class="main">,</span><span class="skolem">q</span><span class="main">)</span> <span class="main">∈</span> f<span class="main">^-1</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">k</span></span> <span class="skolem"><span class="skolem">u</span></span> <span class="skolem"><span class="skolem">v</span></span> <span class="keyword2"><span class="keyword">where</span></span> kp<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">k</span> <span class="main">∥</span> <span class="skolem">p</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> kz<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">k</span><span class="main">∥</span><span class="skolem">z</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> zu<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">z</span> <span class="main">∥</span><span class="skolem">u</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> uv<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">u</span><span class="main">∥</span><span class="skolem">v</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> pv<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">p</span><span class="main">∥</span><span class="skolem">v</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> s  <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">k'</span></span> <span class="skolem"><span class="skolem">l'</span></span> <span class="skolem"><span class="skolem">u'</span></span> <span class="keyword2"><span class="keyword">where</span></span> kpz<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">k'</span> <span class="main">∥</span><span class="skolem">z</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> kplp<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">k'</span> <span class="main">∥</span><span class="skolem">l'</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> lpq<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">l'</span> <span class="main">∥</span><span class="skolem">q</span>"</span></span>  <span class="keyword2"><span class="keyword">and</span></span> zup<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">z</span><span class="main">∥</span><span class="skolem">u'</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> qup<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">q</span><span class="main">∥</span><span class="skolem">u'</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> f <span class="quoted"><span class="quoted">‹<span class="main">(</span><span class="skolem">z</span><span class="main">,</span><span class="skolem">q</span><span class="main">)</span><span class="main">:</span> f<span class="main">^-1</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">from</span></span> kz kpz kplp <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">k</span><span class="main">∥</span><span class="skolem">l'</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> M1 <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> qup zup zu <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">q</span> <span class="main">∥</span> <span class="skolem">u</span> "</span></span> <span class="keyword1"><span class="command">using</span></span> M1 <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">∈</span> d<span class="main">^-1</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> x d kp lpq pv uv <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">lemma</span></span> csidi<span class="main">:</span><span class="quoted"><span class="quoted">"s<span class="main">^-1</span> <span class="keyword1">O</span> d<span class="main">^-1</span> <span class="main">⊆</span> d<span class="main">^-1</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span>
  <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">x</span><span class="main">::</span><span class="quoted"><span class="quoted">"<span class="tfree">'a</span><span class="main">×</span><span class="tfree">'a</span>"</span></span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">:</span> s<span class="main">^-1</span> <span class="keyword1">O</span> d<span class="main">^-1</span>"</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">p</span></span> <span class="skolem"><span class="skolem">q</span></span> <span class="skolem"><span class="skolem">z</span></span> <span class="keyword2"><span class="keyword">where</span></span> x<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">=</span> <span class="main">(</span><span class="skolem">p</span><span class="main">,</span><span class="skolem">q</span><span class="main">)</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">p</span><span class="main">,</span><span class="skolem">z</span><span class="main">)</span> <span class="main">∈</span> s<span class="main">^-1</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">z</span><span class="main">,</span><span class="skolem">q</span><span class="main">)</span> <span class="main">∈</span> d<span class="main">^-1</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">k</span></span> <span class="skolem"><span class="skolem">u</span></span> <span class="skolem"><span class="skolem">v</span></span> <span class="keyword2"><span class="keyword">where</span></span> kp<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">k</span> <span class="main">∥</span> <span class="skolem">p</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> kz<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">k</span><span class="main">∥</span><span class="skolem">z</span>"</span></span>  <span class="keyword2"><span class="keyword">and</span></span> zu<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">z</span> <span class="main">∥</span><span class="skolem">u</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> uv<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">u</span><span class="main">∥</span><span class="skolem">v</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> pv<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">p</span><span class="main">∥</span><span class="skolem">v</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> s  <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">k'</span></span> <span class="skolem"><span class="skolem">l'</span></span> <span class="skolem"><span class="skolem">u'</span></span> <span class="skolem"><span class="skolem">v'</span></span> <span class="keyword2"><span class="keyword">where</span></span> kpz<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">k'</span> <span class="main">∥</span><span class="skolem">z</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> kplp<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">k'</span> <span class="main">∥</span><span class="skolem">l'</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> lpq<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">l'</span><span class="main">∥</span><span class="skolem">q</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> qup<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">q</span> <span class="main">∥</span><span class="skolem">u'</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> upvp<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">u'</span> <span class="main">∥</span><span class="skolem">v'</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> zvp<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">z</span><span class="main">∥</span><span class="skolem">v'</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> d <span class="quoted"><span class="quoted">‹<span class="main">(</span><span class="skolem">z</span><span class="main">,</span><span class="skolem">q</span><span class="main">)</span><span class="main">:</span> d<span class="main">^-1</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">from</span></span> zvp upvp zu <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">u'</span><span class="main">∥</span><span class="skolem">u</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> M1 <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">with</span></span> qup uv <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">uu</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">q</span><span class="main">∥</span><span class="skolem">uu</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">uu</span><span class="main">∥</span><span class="skolem">v</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> M5exist_var <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> kz kpz kplp <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">k</span> <span class="main">∥</span><span class="skolem">l'</span> "</span></span> <span class="keyword1"><span class="command">using</span></span> M1 <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">∈</span> d<span class="main">^-1</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> x d kp lpq pv  <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">lemma</span></span> cdb<span class="main">:</span><span class="quoted"><span class="quoted">"d <span class="keyword1">O</span> b <span class="main">⊆</span> b"</span></span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span>d b<span class="main">)</span>
<span class="keyword1"><span class="command">using</span></span> M1 M5exist_var <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>

<span class="keyword1"><span class="command">lemma</span></span> cdm<span class="main">:</span><span class="quoted"><span class="quoted">"d <span class="keyword1">O</span> m <span class="main">⊆</span> b"</span></span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span>d m b<span class="main">)</span>
<span class="keyword1"><span class="command">using</span></span> M1 <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>

<span class="keyword1"><span class="command">lemma</span></span> cfb<span class="main">:</span><span class="quoted"><span class="quoted">"f <span class="keyword1">O</span> b <span class="main">⊆</span> b"</span></span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span>f b<span class="main">)</span>
<span class="keyword1"><span class="command">using</span></span> M1 <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>

<span class="keyword1"><span class="command">lemma</span></span> cfm<span class="main">:</span><span class="quoted"><span class="quoted">"f <span class="keyword1">O</span> m <span class="main">⊆</span> m"</span></span>
<span class="keyword1"><span class="command">proof</span></span> 
  <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">x</span><span class="main">::</span><span class="quoted"><span class="quoted">"<span class="tfree">'a</span><span class="main">×</span><span class="tfree">'a</span>"</span></span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">∈</span> f <span class="keyword1">O</span> m"</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">p</span></span> <span class="skolem"><span class="skolem">q</span></span> <span class="skolem"><span class="skolem">z</span></span> <span class="keyword2"><span class="keyword">where</span></span> x<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">=</span> <span class="main">(</span><span class="skolem">p</span><span class="main">,</span><span class="skolem">q</span><span class="main">)</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> 1<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">p</span><span class="main">,</span><span class="skolem">z</span><span class="main">)</span> <span class="main">∈</span> f"</span></span> <span class="keyword2"><span class="keyword">and</span></span> 2<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">z</span><span class="main">,</span><span class="skolem">q</span><span class="main">)</span> <span class="main">∈</span> m"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">from</span></span> 1 <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">u</span></span> <span class="keyword2"><span class="keyword">where</span></span> pu<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">p</span><span class="main">∥</span><span class="skolem">u</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> zu<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">z</span><span class="main">∥</span><span class="skolem">u</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> f <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">with</span></span> 2   <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">p</span><span class="main">,</span><span class="skolem">q</span><span class="main">)</span> <span class="main">∈</span> m"</span></span> <span class="keyword1"><span class="command">using</span></span> M1 m <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span><span class="main">∈</span> m"</span></span> <span class="keyword1"><span class="command">using</span></span> x <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>


<span class="comment1">(* ========= $\alpah_1$ compositions ============ *)</span>
<span class="keyword1"><span class="command">subsection</span></span> <span class="quoted"><span class="plain_text">‹$\alpha$-composition›</span></span>
<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹We prove compositions of the form $r_1 \circ r_2 \subseteq s \cup ov \cup d$.›</span></span>


<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> arelations<span class="main">)</span> cmd<span class="main">:</span><span class="quoted"><span class="quoted">"m <span class="keyword1">O</span> d <span class="main">⊆</span> s <span class="main">∪</span> ov <span class="main">∪</span> d"</span></span>
<span class="keyword1"><span class="command">proof</span></span> 
  <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">x</span><span class="main">::</span><span class="quoted"><span class="quoted">"<span class="tfree">'a</span><span class="main">×</span><span class="tfree">'a</span>"</span></span> <span class="keyword3"><span class="command">assume</span></span> a<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">∈</span> m <span class="keyword1">O</span> d"</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">p</span></span> <span class="skolem"><span class="skolem">q</span></span> <span class="skolem"><span class="skolem">z</span></span> <span class="keyword2"><span class="keyword">where</span></span> x<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">=</span><span class="main">(</span><span class="skolem">p</span><span class="main">,</span><span class="skolem">q</span><span class="main">)</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> 1<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">p</span><span class="main">,</span><span class="skolem">z</span><span class="main">)</span> <span class="main">∈</span> m"</span></span> <span class="keyword2"><span class="keyword">and</span></span> 2<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">z</span><span class="main">,</span><span class="skolem">q</span><span class="main">)</span> <span class="main">∈</span> d"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">k</span></span> <span class="skolem"><span class="skolem">l</span></span> <span class="skolem"><span class="skolem">u</span></span> <span class="skolem"><span class="skolem">v</span></span>  <span class="keyword2"><span class="keyword">where</span></span> pz<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">p</span><span class="main">∥</span><span class="skolem">z</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> kq<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">k</span><span class="main">∥</span><span class="skolem">q</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> kl<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">k</span><span class="main">∥</span><span class="skolem">l</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> lz<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">l</span><span class="main">∥</span><span class="skolem">z</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> zu<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">z</span><span class="main">∥</span><span class="skolem">u</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> uv<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">u</span><span class="main">∥</span><span class="skolem">v</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> qv<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">q</span><span class="main">∥</span><span class="skolem">v</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> m d <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">k'</span></span> <span class="keyword2"><span class="keyword">where</span></span> kpp<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">k'</span><span class="main">∥</span><span class="skolem">p</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> M3 meets_wd pz <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">from</span></span> pz zu uv <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">zu</span></span> <span class="keyword2"><span class="keyword">where</span></span> pzu<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">p</span><span class="main">∥</span><span class="skolem">zu</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> zuv<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">zu</span><span class="main">∥</span><span class="skolem">v</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> M5exist_var  <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">from</span></span> kpp kq <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">k'</span><span class="main">∥</span><span class="skolem">q</span> <span class="main">⊕</span> <span class="main">(</span><span class="main">(</span><span class="main">∃</span><span class="bound">t</span><span class="main">.</span> <span class="skolem">k'</span><span class="main">∥</span><span class="bound">t</span> <span class="main">∧</span> <span class="bound">t</span><span class="main">∥</span><span class="skolem">q</span><span class="main">)</span> <span class="main">⊕</span> <span class="main">(</span><span class="main">∃</span><span class="bound">t</span><span class="main">.</span> <span class="skolem">k</span><span class="main">∥</span><span class="bound">t</span> <span class="main">∧</span> <span class="bound">t</span><span class="main">∥</span><span class="skolem">p</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">is</span></span> <span class="quoted"><span class="quoted">"<span class="var">?A</span> <span class="main">⊕</span> <span class="main">(</span><span class="var">?B</span> <span class="main">⊕</span> <span class="var">?C</span><span class="main">)</span>"</span></span><span class="main">)</span> <span class="keyword1"><span class="command">using</span></span> M2 <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span> 
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="var">?A</span><span class="main">∧</span><span class="main">¬</span><span class="var">?B</span><span class="main">∧</span><span class="main">¬</span><span class="var">?C</span><span class="main">)</span><span class="main">∨</span><span class="main">(</span><span class="main">¬</span><span class="var">?A</span><span class="main">∧</span><span class="var">?B</span><span class="main">∧</span><span class="main">¬</span><span class="var">?C</span><span class="main">)</span><span class="main">∨</span><span class="main">(</span><span class="main">¬</span><span class="var">?A</span><span class="main">∧</span><span class="main">¬</span><span class="var">?B</span><span class="main">∧</span><span class="var">?C</span><span class="main">)</span>"</span></span>  <span class="keyword1"><span class="command">using</span></span> local.meets_atrans xor_distr_L<span class="main">[</span><span class="operator">of</span> <span class="var"><span class="quoted"><span class="var">?A</span></span></span> <span class="var"><span class="quoted"><span class="var">?B</span></span></span> <span class="var"><span class="quoted"><span class="var">?C</span></span></span><span class="main">]</span>  <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">∈</span> s <span class="main">∪</span> ov <span class="main">∪</span> d"</span></span>    
  <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">elim</span> disjE<span class="main">)</span>
    <span class="keyword1"><span class="command">{</span></span><span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="var">?A</span><span class="main">∧</span><span class="main">¬</span><span class="var">?B</span><span class="main">∧</span><span class="main">¬</span><span class="var">?C</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="var">?A</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span> 
     <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">p</span><span class="main">,</span><span class="skolem">q</span><span class="main">)</span> <span class="main">∈</span> s"</span></span> <span class="keyword1"><span class="command">using</span></span>  s qv kpp pzu zuv <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
     <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> x <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span> <span class="keyword1"><span class="command">}</span></span>
    <span class="keyword1"><span class="command">next</span></span>
    <span class="keyword1"><span class="command">{</span></span><span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">¬</span><span class="var">?A</span><span class="main">∧</span><span class="var">?B</span><span class="main">∧</span><span class="main">¬</span><span class="var">?C</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="var">?B</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
     <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">t</span></span> <span class="keyword2"><span class="keyword">where</span></span> kpt<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">k'</span><span class="main">∥</span><span class="skolem">t</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> tq<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">t</span><span class="main">∥</span><span class="skolem">q</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
     <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> kq kl tq <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">t</span><span class="main">∥</span><span class="skolem">l</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> M1 <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
     <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> lz pz pzu <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">l</span><span class="main">∥</span><span class="skolem">zu</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> M1 <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
     <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">p</span><span class="main">,</span><span class="skolem">q</span><span class="main">)</span> <span class="main">∈</span> ov"</span></span> <span class="keyword1"><span class="command">using</span></span> ov kpp qv pzu zuv <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
     <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> x <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span><span class="keyword1"><span class="command">}</span></span>
    <span class="keyword1"><span class="command">next</span></span>
    <span class="keyword1"><span class="command">{</span></span><span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">¬</span><span class="var">?A</span><span class="main">∧</span><span class="main">¬</span><span class="var">?B</span><span class="main">∧</span><span class="var">?C</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="var">?C</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
     <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">t</span></span> <span class="keyword2"><span class="keyword">where</span></span> kt<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">k</span><span class="main">∥</span><span class="skolem">t</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> tp<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">t</span><span class="main">∥</span><span class="skolem">p</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
     <span class="keyword1"><span class="command">with</span></span> kq pzu zuv qv  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">p</span><span class="main">,</span><span class="skolem">q</span><span class="main">)</span><span class="main">∈</span>d"</span></span> <span class="keyword1"><span class="command">using</span></span> d <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
     <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> x <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span><span class="keyword1"><span class="command">}</span></span>
  <span class="keyword1"><span class="command">qed</span></span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> arelations<span class="main">)</span> cmf<span class="main">:</span><span class="quoted"><span class="quoted">"m <span class="keyword1">O</span> f <span class="main">⊆</span> s <span class="main">∪</span> ov <span class="main">∪</span> d"</span></span>
<span class="keyword1"><span class="command">proof</span></span>
  <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">x</span><span class="main">::</span><span class="quoted"><span class="quoted">"<span class="tfree">'a</span><span class="main">×</span><span class="tfree">'a</span>"</span></span> <span class="keyword3"><span class="command">assume</span></span> a<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">∈</span> m <span class="keyword1">O</span> f"</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">p</span></span> <span class="skolem"><span class="skolem">q</span></span> <span class="skolem"><span class="skolem">z</span></span> <span class="keyword2"><span class="keyword">where</span></span> x<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">=</span><span class="main">(</span><span class="skolem">p</span><span class="main">,</span><span class="skolem">q</span><span class="main">)</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> 1<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">p</span><span class="main">,</span><span class="skolem">z</span><span class="main">)</span> <span class="main">∈</span> m"</span></span> <span class="keyword2"><span class="keyword">and</span></span> 2<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">z</span><span class="main">,</span><span class="skolem">q</span><span class="main">)</span> <span class="main">∈</span> f"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">k</span></span> <span class="skolem"><span class="skolem">l</span></span> <span class="skolem"><span class="skolem">u</span></span>   <span class="keyword2"><span class="keyword">where</span></span> pz<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">p</span><span class="main">∥</span><span class="skolem">z</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> kq<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">k</span><span class="main">∥</span><span class="skolem">q</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> kl<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">k</span><span class="main">∥</span><span class="skolem">l</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> lz<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">l</span><span class="main">∥</span><span class="skolem">z</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> zu<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">z</span><span class="main">∥</span><span class="skolem">u</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> qu<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">q</span><span class="main">∥</span><span class="skolem">u</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> m f <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">k'</span></span> <span class="keyword2"><span class="keyword">where</span></span> kpp<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">k'</span><span class="main">∥</span><span class="skolem">p</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> M3 meets_wd pz <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">from</span></span> kpp kq <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">k'</span><span class="main">∥</span><span class="skolem">q</span> <span class="main">⊕</span> <span class="main">(</span><span class="main">(</span><span class="main">∃</span><span class="bound">t</span><span class="main">.</span> <span class="skolem">k'</span><span class="main">∥</span><span class="bound">t</span> <span class="main">∧</span> <span class="bound">t</span><span class="main">∥</span><span class="skolem">q</span><span class="main">)</span> <span class="main">⊕</span> <span class="main">(</span><span class="main">∃</span><span class="bound">t</span><span class="main">.</span> <span class="skolem">k</span><span class="main">∥</span><span class="bound">t</span> <span class="main">∧</span> <span class="bound">t</span><span class="main">∥</span><span class="skolem">p</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">is</span></span> <span class="quoted"><span class="quoted">"<span class="var">?A</span> <span class="main">⊕</span> <span class="main">(</span><span class="var">?B</span> <span class="main">⊕</span> <span class="var">?C</span><span class="main">)</span>"</span></span><span class="main">)</span> <span class="keyword1"><span class="command">using</span></span> M2 <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span> 
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="var">?A</span><span class="main">∧</span><span class="main">¬</span><span class="var">?B</span><span class="main">∧</span><span class="main">¬</span><span class="var">?C</span><span class="main">)</span><span class="main">∨</span><span class="main">(</span><span class="main">¬</span><span class="var">?A</span><span class="main">∧</span><span class="var">?B</span><span class="main">∧</span><span class="main">¬</span><span class="var">?C</span><span class="main">)</span><span class="main">∨</span><span class="main">(</span><span class="main">¬</span><span class="var">?A</span><span class="main">∧</span><span class="main">¬</span><span class="var">?B</span><span class="main">∧</span><span class="var">?C</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> local.meets_atrans xor_distr_L<span class="main">[</span><span class="operator">of</span> <span class="var"><span class="quoted"><span class="var">?A</span></span></span> <span class="var"><span class="quoted"><span class="var">?B</span></span></span> <span class="var"><span class="quoted"><span class="var">?C</span></span></span><span class="main">]</span>  <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">∈</span> s <span class="main">∪</span> ov <span class="main">∪</span> d"</span></span>    
  <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">elim</span> disjE<span class="main">)</span>
    <span class="keyword1"><span class="command">{</span></span><span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="var">?A</span><span class="main">∧</span><span class="main">¬</span><span class="var">?B</span><span class="main">∧</span><span class="main">¬</span><span class="var">?C</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="var">?A</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span> 
     <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">p</span><span class="main">,</span><span class="skolem">q</span><span class="main">)</span> <span class="main">∈</span> s"</span></span> <span class="keyword1"><span class="command">using</span></span>  s qu kpp pz zu <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
     <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> x <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span> <span class="keyword1"><span class="command">}</span></span>
    <span class="keyword1"><span class="command">next</span></span>
    <span class="keyword1"><span class="command">{</span></span><span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">¬</span><span class="var">?A</span><span class="main">∧</span><span class="var">?B</span><span class="main">∧</span><span class="main">¬</span><span class="var">?C</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="var">?B</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
     <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">t</span></span> <span class="keyword2"><span class="keyword">where</span></span> kpt<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">k'</span><span class="main">∥</span><span class="skolem">t</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> tq<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">t</span><span class="main">∥</span><span class="skolem">q</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
     <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> kq kl tq <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">t</span><span class="main">∥</span><span class="skolem">l</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> M1 <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span> 
     <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> lz pz pz <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">l</span><span class="main">∥</span><span class="skolem">z</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> M1 <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
     <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">p</span><span class="main">,</span><span class="skolem">q</span><span class="main">)</span> <span class="main">∈</span> ov"</span></span> <span class="keyword1"><span class="command">using</span></span> ov kpp qu pz zu <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
     <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> x <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span><span class="keyword1"><span class="command">}</span></span>
    <span class="keyword1"><span class="command">next</span></span>
    <span class="keyword1"><span class="command">{</span></span><span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">¬</span><span class="var">?A</span><span class="main">∧</span><span class="main">¬</span><span class="var">?B</span><span class="main">∧</span><span class="var">?C</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="var">?C</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
     <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">t</span></span> <span class="keyword2"><span class="keyword">where</span></span> kt<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">k</span><span class="main">∥</span><span class="skolem">t</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> tp<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">t</span><span class="main">∥</span><span class="skolem">p</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
     <span class="keyword1"><span class="command">with</span></span> kq pz zu qu  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">p</span><span class="main">,</span><span class="skolem">q</span><span class="main">)</span><span class="main">∈</span>d"</span></span> <span class="keyword1"><span class="command">using</span></span> d <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
     <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> x <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span><span class="keyword1"><span class="command">}</span></span>
  <span class="keyword1"><span class="command">qed</span></span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">lemma</span></span> cmovi<span class="main">:</span><span class="quoted"><span class="quoted">"m <span class="keyword1">O</span> ov<span class="main">^-1</span>  <span class="main">⊆</span> s <span class="main">∪</span> ov <span class="main">∪</span> d"</span></span>
<span class="keyword1"><span class="command">proof</span></span> 
  <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">x</span><span class="main">::</span><span class="quoted"><span class="quoted">"<span class="tfree">'a</span><span class="main">×</span><span class="tfree">'a</span>"</span></span> <span class="keyword3"><span class="command">assume</span></span> a<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">∈</span> m <span class="keyword1">O</span> ov<span class="main">^-1</span>"</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">p</span></span> <span class="skolem"><span class="skolem">q</span></span> <span class="skolem"><span class="skolem">z</span></span> <span class="keyword2"><span class="keyword">where</span></span> x<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">=</span><span class="main">(</span><span class="skolem">p</span><span class="main">,</span><span class="skolem">q</span><span class="main">)</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> 1<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">p</span><span class="main">,</span><span class="skolem">z</span><span class="main">)</span> <span class="main">∈</span> m"</span></span> <span class="keyword2"><span class="keyword">and</span></span> 2<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">z</span><span class="main">,</span><span class="skolem">q</span><span class="main">)</span> <span class="main">∈</span> ov<span class="main">^-1</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">k</span></span> <span class="skolem"><span class="skolem">l</span></span> <span class="skolem"><span class="skolem">c</span></span> <span class="skolem"><span class="skolem">u</span></span> <span class="skolem"><span class="skolem">v</span></span>  <span class="keyword2"><span class="keyword">where</span></span> pz<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">p</span><span class="main">∥</span><span class="skolem">z</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> kq<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">k</span><span class="main">∥</span><span class="skolem">q</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> kl<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">k</span><span class="main">∥</span><span class="skolem">l</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> lz<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">l</span><span class="main">∥</span><span class="skolem">z</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> qu<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">q</span><span class="main">∥</span><span class="skolem">u</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> uv<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">u</span><span class="main">∥</span><span class="skolem">v</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> zv<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">z</span><span class="main">∥</span><span class="skolem">v</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> lc<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">l</span><span class="main">∥</span><span class="skolem">c</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> cu<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">c</span><span class="main">∥</span><span class="skolem">u</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> m ov <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">k'</span></span> <span class="keyword2"><span class="keyword">where</span></span> kpp<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">k'</span><span class="main">∥</span><span class="skolem">p</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> M3 meets_wd pz <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">from</span></span> lz lc pz <span class="keyword1"><span class="command">have</span></span> pc<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">p</span><span class="main">∥</span><span class="skolem">c</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> M1 <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">from</span></span> kpp kq <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">k'</span><span class="main">∥</span><span class="skolem">q</span> <span class="main">⊕</span> <span class="main">(</span><span class="main">(</span><span class="main">∃</span><span class="bound">t</span><span class="main">.</span> <span class="skolem">k'</span><span class="main">∥</span><span class="bound">t</span> <span class="main">∧</span> <span class="bound">t</span><span class="main">∥</span><span class="skolem">q</span><span class="main">)</span> <span class="main">⊕</span> <span class="main">(</span><span class="main">∃</span><span class="bound">t</span><span class="main">.</span> <span class="skolem">k</span><span class="main">∥</span><span class="bound">t</span> <span class="main">∧</span> <span class="bound">t</span><span class="main">∥</span><span class="skolem">p</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">is</span></span> <span class="quoted"><span class="quoted">"<span class="var">?A</span> <span class="main">⊕</span> <span class="main">(</span><span class="var">?B</span> <span class="main">⊕</span> <span class="var">?C</span><span class="main">)</span>"</span></span><span class="main">)</span> <span class="keyword1"><span class="command">using</span></span> M2 <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span> 
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="var">?A</span><span class="main">∧</span><span class="main">¬</span><span class="var">?B</span><span class="main">∧</span><span class="main">¬</span><span class="var">?C</span><span class="main">)</span><span class="main">∨</span><span class="main">(</span><span class="main">¬</span><span class="var">?A</span><span class="main">∧</span><span class="var">?B</span><span class="main">∧</span><span class="main">¬</span><span class="var">?C</span><span class="main">)</span><span class="main">∨</span><span class="main">(</span><span class="main">¬</span><span class="var">?A</span><span class="main">∧</span><span class="main">¬</span><span class="var">?B</span><span class="main">∧</span><span class="var">?C</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">insert</span> xor_distr_L<span class="main"><span class="main">[</span></span><span class="operator">of</span> <span class="var"><span class="quoted"><span class="var">?A</span></span></span> <span class="var"><span class="quoted"><span class="var">?B</span></span></span> <span class="var"><span class="quoted"><span class="var">?C</span></span></span><span class="main"><span class="main">]</span></span><span class="main"><span class="keyword3">,</span></span> <span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span>elimmeets<span class="main">)</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">∈</span> s <span class="main">∪</span> ov <span class="main">∪</span> d"</span></span>    
  <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">elim</span> disjE<span class="main">)</span>
    <span class="keyword1"><span class="command">{</span></span><span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="var">?A</span><span class="main">∧</span><span class="main">¬</span><span class="var">?B</span><span class="main">∧</span><span class="main">¬</span><span class="var">?C</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="var">?A</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span> 
     <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">p</span><span class="main">,</span><span class="skolem">q</span><span class="main">)</span> <span class="main">∈</span> s"</span></span> <span class="keyword1"><span class="command">using</span></span> s kpp qu cu pc <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
     <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> x <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span> <span class="keyword1"><span class="command">}</span></span>
    <span class="keyword1"><span class="command">next</span></span>
    <span class="keyword1"><span class="command">{</span></span><span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">¬</span><span class="var">?A</span><span class="main">∧</span><span class="var">?B</span><span class="main">∧</span><span class="main">¬</span><span class="var">?C</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="var">?B</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
     <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">t</span></span> <span class="keyword2"><span class="keyword">where</span></span> kpt<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">k'</span><span class="main">∥</span><span class="skolem">t</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> tq<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">t</span><span class="main">∥</span><span class="skolem">q</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
     <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> kq kl tq <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">t</span><span class="main">∥</span><span class="skolem">l</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> M1 <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
     <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">p</span><span class="main">,</span><span class="skolem">q</span><span class="main">)</span> <span class="main">∈</span> ov"</span></span> <span class="keyword1"><span class="command">using</span></span> ov kpp qu cu lc pc <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
     <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> x <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span><span class="keyword1"><span class="command">}</span></span>
    <span class="keyword1"><span class="command">next</span></span>
    <span class="keyword1"><span class="command">{</span></span><span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">¬</span><span class="var">?A</span><span class="main">∧</span><span class="main">¬</span><span class="var">?B</span><span class="main">∧</span><span class="var">?C</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="var">?C</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
     <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">t</span></span> <span class="keyword2"><span class="keyword">where</span></span> kt<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">k</span><span class="main">∥</span><span class="skolem">t</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> tp<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">t</span><span class="main">∥</span><span class="skolem">p</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
     <span class="keyword1"><span class="command">then</span></span>  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">p</span><span class="main">,</span><span class="skolem">q</span><span class="main">)</span><span class="main">∈</span>d"</span></span> <span class="keyword1"><span class="command">using</span></span> d kq cu qu pc <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
     <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> x <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span><span class="keyword1"><span class="command">}</span></span>
  <span class="keyword1"><span class="command">qed</span></span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">lemma</span></span> covd<span class="main">:</span><span class="quoted"><span class="quoted">"ov <span class="keyword1">O</span> d <span class="main">⊆</span> s <span class="main">∪</span> ov <span class="main">∪</span> d"</span></span>
<span class="keyword1"><span class="command">proof</span></span>
  <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">x</span><span class="main">::</span><span class="quoted"><span class="quoted">"<span class="tfree">'a</span><span class="main">×</span><span class="tfree">'a</span>"</span></span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">∈</span> ov <span class="keyword1">O</span> d"</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">p</span></span> <span class="skolem"><span class="skolem">q</span></span> <span class="skolem"><span class="skolem">z</span></span> <span class="keyword2"><span class="keyword">where</span></span> x<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">x</span><span class="main">=</span><span class="main">(</span><span class="skolem">p</span><span class="main">,</span><span class="skolem">q</span><span class="main">)</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">p</span><span class="main">,</span><span class="skolem">z</span><span class="main">)</span> <span class="main">∈</span> ov"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">z</span><span class="main">,</span><span class="skolem">q</span><span class="main">)</span> <span class="main">∈</span> d"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="main">(</span><span class="skolem">p</span><span class="main">,</span><span class="skolem">z</span><span class="main">)</span> <span class="main">∈</span> ov›</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">k</span></span> <span class="skolem"><span class="skolem">u</span></span> <span class="skolem"><span class="skolem">v</span></span> <span class="skolem"><span class="skolem">l</span></span> <span class="skolem"><span class="skolem">c</span></span> <span class="keyword2"><span class="keyword">where</span></span> kp<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">k</span><span class="main">∥</span><span class="skolem">p</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> pu<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">p</span><span class="main">∥</span><span class="skolem">u</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> uv<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">u</span><span class="main">∥</span><span class="skolem">v</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> zv<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">z</span><span class="main">∥</span><span class="skolem">v</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> lc<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">l</span><span class="main">∥</span><span class="skolem">c</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> cu<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">c</span><span class="main">∥</span><span class="skolem">u</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> kl<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">k</span><span class="main">∥</span><span class="skolem">l</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> lz<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">l</span><span class="main">∥</span><span class="skolem">z</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> cu<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">c</span><span class="main">∥</span><span class="skolem">u</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> ov <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="main">(</span><span class="skolem">z</span><span class="main">,</span><span class="skolem">q</span><span class="main">)</span> <span class="main">∈</span> d›</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">k'</span></span> <span class="skolem"><span class="skolem">l'</span></span> <span class="skolem"><span class="skolem">u'</span></span> <span class="skolem"><span class="skolem">v'</span></span> <span class="keyword2"><span class="keyword">where</span></span> kpq<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">k'</span><span class="main">∥</span><span class="skolem">q</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> kplp<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">k'</span><span class="main">∥</span><span class="skolem">l'</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> lpz<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">l'</span><span class="main">∥</span><span class="skolem">z</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> qvp<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">q</span><span class="main">∥</span><span class="skolem">v'</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> zup<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">z</span><span class="main">∥</span><span class="skolem">u'</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> upvp<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">u'</span><span class="main">∥</span><span class="skolem">v'</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> d <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">from</span></span> uv zv zup <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">u</span><span class="main">∥</span><span class="skolem">u'</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> M1 <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">from</span></span> pu upvp <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">uu</span></span> <span class="keyword2"><span class="keyword">where</span></span> puu<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">p</span><span class="main">∥</span><span class="skolem">uu</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> uuvp<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">uu</span><span class="main">∥</span><span class="skolem">v'</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">u</span><span class="main">∥</span><span class="skolem">u'</span>›</span></span> <span class="keyword1"><span class="command">using</span></span> M5exist_var <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">from</span></span> kp kpq <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">k</span><span class="main">∥</span><span class="skolem">q</span> <span class="main">⊕</span> <span class="main">(</span><span class="main">(</span><span class="main">∃</span><span class="bound">t</span><span class="main">.</span> <span class="skolem">k</span><span class="main">∥</span><span class="bound">t</span> <span class="main">∧</span> <span class="bound">t</span><span class="main">∥</span><span class="skolem">q</span><span class="main">)</span> <span class="main">⊕</span> <span class="main">(</span><span class="main">∃</span><span class="bound">t</span><span class="main">.</span> <span class="skolem">k'</span><span class="main">∥</span><span class="bound">t</span> <span class="main">∧</span> <span class="bound">t</span><span class="main">∥</span><span class="skolem">p</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">is</span></span> <span class="quoted"><span class="quoted">"<span class="var">?A</span> <span class="main">⊕</span> <span class="main">(</span><span class="var">?B</span> <span class="main">⊕</span> <span class="var">?C</span><span class="main">)</span>"</span></span><span class="main">)</span> <span class="keyword1"><span class="command">using</span></span> M2 <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="var">?A</span><span class="main">∧</span><span class="main">¬</span><span class="var">?B</span><span class="main">∧</span><span class="main">¬</span><span class="var">?C</span><span class="main">)</span> <span class="main">∨</span> <span class="main">(</span><span class="main">(</span><span class="main">¬</span><span class="var">?A</span><span class="main">∧</span><span class="var">?B</span><span class="main">∧</span><span class="main">¬</span><span class="var">?C</span><span class="main">)</span> <span class="main">∨</span> <span class="main">(</span><span class="main">¬</span><span class="var">?A</span><span class="main">∧</span><span class="main">¬</span><span class="var">?B</span><span class="main">∧</span><span class="var">?C</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">insert</span> xor_distr_L<span class="main"><span class="main">[</span></span><span class="operator">of</span> <span class="var"><span class="quoted"><span class="var">?A</span></span></span> <span class="var"><span class="quoted"><span class="var">?B</span></span></span> <span class="var"><span class="quoted"><span class="var">?C</span></span></span><span class="main"><span class="main">]</span></span><span class="main"><span class="keyword3">,</span></span> <span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span>elimmeets<span class="main">)</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">∈</span>  s <span class="main">∪</span> ov <span class="main">∪</span> d"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">elim</span> disjE<span class="main">)</span>
    <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="var">?A</span><span class="main">∧</span><span class="main">¬</span><span class="var">?B</span><span class="main">∧</span><span class="main">¬</span><span class="var">?C</span>"</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="var"><span class="quoted"><span class="var">?A</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
      <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">p</span><span class="main">,</span><span class="skolem">q</span><span class="main">)</span> <span class="main">∈</span> s"</span></span> <span class="keyword1"><span class="command">using</span></span> s kp qvp puu uuvp <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
      <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> x <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span><span class="keyword1"><span class="command">}</span></span>
    <span class="keyword1"><span class="command">next</span></span>
    <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span><span class="var">?A</span><span class="main">∧</span><span class="var">?B</span><span class="main">∧</span><span class="main">¬</span><span class="var">?C</span>"</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="var"><span class="quoted"><span class="var">?B</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
      <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">t</span></span> <span class="keyword2"><span class="keyword">where</span></span> kt<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">k</span><span class="main">∥</span><span class="skolem">t</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> tq<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">t</span><span class="main">∥</span><span class="skolem">q</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">from</span></span> cu pu puu <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">c</span><span class="main">∥</span><span class="skolem">uu</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> M1 <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> kpq tq kplp <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">t</span><span class="main">∥</span><span class="skolem">l'</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> M1 <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> lpz lz lc <span class="keyword1"><span class="command">have</span></span> lpc<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">l'</span><span class="main">∥</span><span class="skolem">c</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> M1 <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">lc</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">t</span><span class="main">∥</span><span class="skolem">lc</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">lc</span><span class="main">∥</span><span class="skolem">uu</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> M5exist_var <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
      <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">p</span><span class="main">,</span><span class="skolem">q</span><span class="main">)</span> <span class="main">∈</span> ov"</span></span> <span class="keyword1"><span class="command">using</span></span> ov kp kt tq puu uuvp qvp  <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
      <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> x <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span><span class="keyword1"><span class="command">}</span></span>
    <span class="keyword1"><span class="command">next</span></span>
    <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span><span class="var">?A</span> <span class="main">∧</span> <span class="main">¬</span><span class="var">?B</span> <span class="main">∧</span> <span class="var">?C</span>"</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="var"><span class="quoted"><span class="var">?C</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
      <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">t</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">k'</span><span class="main">∥</span><span class="skolem">t</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">t</span><span class="main">∥</span><span class="skolem">p</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">with</span></span> puu uuvp qvp kpq <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">p</span><span class="main">,</span><span class="skolem">q</span><span class="main">)</span> <span class="main">∈</span> d"</span></span> <span class="keyword1"><span class="command">using</span></span> d <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
      <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> x <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span><span class="keyword1"><span class="command">}</span></span>
  <span class="keyword1"><span class="command">qed</span></span>
<span class="keyword1"><span class="command">qed</span></span>


<span class="keyword1"><span class="command">lemma</span></span> covf<span class="main">:</span><span class="quoted"><span class="quoted">"ov <span class="keyword1">O</span> f <span class="main">⊆</span> s <span class="main">∪</span> ov <span class="main">∪</span> d"</span></span>
<span class="keyword1"><span class="command">proof</span></span>
  <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">x</span><span class="main">::</span><span class="quoted"><span class="quoted">"<span class="tfree">'a</span><span class="main">×</span><span class="tfree">'a</span>"</span></span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">∈</span> ov <span class="keyword1">O</span> f"</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">p</span></span> <span class="skolem"><span class="skolem">q</span></span> <span class="skolem"><span class="skolem">z</span></span> <span class="keyword2"><span class="keyword">where</span></span> x<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">x</span><span class="main">=</span><span class="main">(</span><span class="skolem">p</span><span class="main">,</span><span class="skolem">q</span><span class="main">)</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">p</span><span class="main">,</span><span class="skolem">z</span><span class="main">)</span> <span class="main">∈</span> ov"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">z</span><span class="main">,</span><span class="skolem">q</span><span class="main">)</span> <span class="main">∈</span> f"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="main">(</span><span class="skolem">p</span><span class="main">,</span><span class="skolem">z</span><span class="main">)</span> <span class="main">∈</span> ov›</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">k</span></span> <span class="skolem"><span class="skolem">u</span></span> <span class="skolem"><span class="skolem">v</span></span> <span class="skolem"><span class="skolem">l</span></span> <span class="skolem"><span class="skolem">c</span></span> <span class="keyword2"><span class="keyword">where</span></span> kp<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">k</span><span class="main">∥</span><span class="skolem">p</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> pu<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">p</span><span class="main">∥</span><span class="skolem">u</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> uv<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">u</span><span class="main">∥</span><span class="skolem">v</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> zv<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">z</span><span class="main">∥</span><span class="skolem">v</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> lc<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">l</span><span class="main">∥</span><span class="skolem">c</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> cu<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">c</span><span class="main">∥</span><span class="skolem">u</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> kl<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">k</span><span class="main">∥</span><span class="skolem">l</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> lz<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">l</span><span class="main">∥</span><span class="skolem">z</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> cu<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">c</span><span class="main">∥</span><span class="skolem">u</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> ov <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="main">(</span><span class="skolem">z</span><span class="main">,</span><span class="skolem">q</span><span class="main">)</span> <span class="main">∈</span> f›</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">k'</span></span> <span class="skolem"><span class="skolem">l'</span></span> <span class="skolem"><span class="skolem">u'</span></span>  <span class="keyword2"><span class="keyword">where</span></span> kpq<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">k'</span><span class="main">∥</span><span class="skolem">q</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> kplp<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">k'</span><span class="main">∥</span><span class="skolem">l'</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> lpz<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">l'</span><span class="main">∥</span><span class="skolem">z</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> qup<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">q</span><span class="main">∥</span><span class="skolem">u'</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> zup<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">z</span><span class="main">∥</span><span class="skolem">u'</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> f <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">from</span></span> uv zv zup <span class="keyword1"><span class="command">have</span></span> uu<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">u</span><span class="main">∥</span><span class="skolem">u'</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> M1 <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">from</span></span> kp kpq <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">k</span><span class="main">∥</span><span class="skolem">q</span> <span class="main">⊕</span> <span class="main">(</span><span class="main">(</span><span class="main">∃</span><span class="bound">t</span><span class="main">.</span> <span class="skolem">k</span><span class="main">∥</span><span class="bound">t</span> <span class="main">∧</span> <span class="bound">t</span><span class="main">∥</span><span class="skolem">q</span><span class="main">)</span> <span class="main">⊕</span> <span class="main">(</span><span class="main">∃</span><span class="bound">t</span><span class="main">.</span> <span class="skolem">k'</span><span class="main">∥</span><span class="bound">t</span> <span class="main">∧</span> <span class="bound">t</span><span class="main">∥</span><span class="skolem">p</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">is</span></span> <span class="quoted"><span class="quoted">"<span class="var">?A</span> <span class="main">⊕</span> <span class="main">(</span><span class="var">?B</span> <span class="main">⊕</span> <span class="var">?C</span><span class="main">)</span>"</span></span><span class="main">)</span> <span class="keyword1"><span class="command">using</span></span> M2 <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="var">?A</span><span class="main">∧</span><span class="main">¬</span><span class="var">?B</span><span class="main">∧</span><span class="main">¬</span><span class="var">?C</span><span class="main">)</span> <span class="main">∨</span> <span class="main">(</span><span class="main">(</span><span class="main">¬</span><span class="var">?A</span><span class="main">∧</span><span class="var">?B</span><span class="main">∧</span><span class="main">¬</span><span class="var">?C</span><span class="main">)</span> <span class="main">∨</span> <span class="main">(</span><span class="main">¬</span><span class="var">?A</span><span class="main">∧</span><span class="main">¬</span><span class="var">?B</span><span class="main">∧</span><span class="var">?C</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">insert</span> xor_distr_L<span class="main"><span class="main">[</span></span><span class="operator">of</span> <span class="var"><span class="quoted"><span class="var">?A</span></span></span> <span class="var"><span class="quoted"><span class="var">?B</span></span></span> <span class="var"><span class="quoted"><span class="var">?C</span></span></span><span class="main"><span class="main">]</span></span><span class="main"><span class="keyword3">,</span></span> <span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span>elimmeets<span class="main">)</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">∈</span>  s <span class="main">∪</span> ov <span class="main">∪</span> d"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">elim</span> disjE<span class="main">)</span>
    <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="var">?A</span><span class="main">∧</span><span class="main">¬</span><span class="var">?B</span><span class="main">∧</span><span class="main">¬</span><span class="var">?C</span>"</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="var"><span class="quoted"><span class="var">?A</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
      <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">p</span><span class="main">,</span><span class="skolem">q</span><span class="main">)</span> <span class="main">∈</span> s"</span></span> <span class="keyword1"><span class="command">using</span></span> s kp qup uu pu <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
      <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> x <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span><span class="keyword1"><span class="command">}</span></span>
    <span class="keyword1"><span class="command">next</span></span>
    <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span><span class="var">?A</span><span class="main">∧</span><span class="var">?B</span><span class="main">∧</span><span class="main">¬</span><span class="var">?C</span>"</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="var"><span class="quoted"><span class="var">?B</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
      <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">t</span></span> <span class="keyword2"><span class="keyword">where</span></span> kt<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">k</span><span class="main">∥</span><span class="skolem">t</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> tq<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">t</span><span class="main">∥</span><span class="skolem">q</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> kpq tq kplp <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">t</span><span class="main">∥</span><span class="skolem">l'</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> M1 <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> lpz lz lc <span class="keyword1"><span class="command">have</span></span> lpc<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">l'</span><span class="main">∥</span><span class="skolem">c</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> M1 <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">lc</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">t</span><span class="main">∥</span><span class="skolem">lc</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">lc</span><span class="main">∥</span><span class="skolem">u</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> cu M5exist_var <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
      <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">p</span><span class="main">,</span><span class="skolem">q</span><span class="main">)</span> <span class="main">∈</span> ov"</span></span> <span class="keyword1"><span class="command">using</span></span> ov kp kt tq pu uu qup  <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
      <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> x <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span><span class="keyword1"><span class="command">}</span></span>
    <span class="keyword1"><span class="command">next</span></span>
    <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span><span class="var">?A</span> <span class="main">∧</span> <span class="main">¬</span><span class="var">?B</span> <span class="main">∧</span> <span class="var">?C</span>"</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="var"><span class="quoted"><span class="var">?C</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
      <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">t</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">k'</span><span class="main">∥</span><span class="skolem">t</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">t</span><span class="main">∥</span><span class="skolem">p</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">with</span></span> pu uu qup kpq <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">p</span><span class="main">,</span><span class="skolem">q</span><span class="main">)</span> <span class="main">∈</span> d"</span></span> <span class="keyword1"><span class="command">using</span></span> d <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
      <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> x <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span><span class="keyword1"><span class="command">}</span></span>
  <span class="keyword1"><span class="command">qed</span></span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">lemma</span></span> cfid<span class="main">:</span><span class="quoted"><span class="quoted">"f<span class="main">^-1</span> <span class="keyword1">O</span> d <span class="main">⊆</span> s <span class="main">∪</span> ov <span class="main">∪</span> d"</span></span>
<span class="keyword1"><span class="command">proof</span></span>
  <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">x</span><span class="main">::</span><span class="quoted"><span class="quoted">"<span class="tfree">'a</span><span class="main">×</span><span class="tfree">'a</span>"</span></span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">∈</span> f<span class="main">^-1</span> <span class="keyword1">O</span> d"</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">p</span></span> <span class="skolem"><span class="skolem">q</span></span> <span class="skolem"><span class="skolem">z</span></span> <span class="keyword2"><span class="keyword">where</span></span> x<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">=</span> <span class="main">(</span><span class="skolem">p</span><span class="main">,</span><span class="skolem">q</span><span class="main">)</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">p</span><span class="main">,</span><span class="skolem">z</span><span class="main">)</span> <span class="main">∈</span> f<span class="main">^-1</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">z</span><span class="main">,</span><span class="skolem">q</span><span class="main">)</span><span class="main">∈</span> d"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="main">(</span><span class="skolem">p</span><span class="main">,</span><span class="skolem">z</span><span class="main">)</span> <span class="main">∈</span> f<span class="main">^-1</span>›</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">k</span></span> <span class="skolem"><span class="skolem">l</span></span> <span class="skolem"><span class="skolem">u</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">k</span><span class="main">∥</span><span class="skolem">l</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">l</span><span class="main">∥</span><span class="skolem">z</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> kp<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">k</span><span class="main">∥</span><span class="skolem">p</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> pu<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">p</span><span class="main">∥</span><span class="skolem">u</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> zu<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">z</span><span class="main">∥</span><span class="skolem">u</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> f <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="main">(</span><span class="skolem">z</span><span class="main">,</span><span class="skolem">q</span><span class="main">)</span> <span class="main">∈</span> d›</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">k'</span></span> <span class="skolem"><span class="skolem">l'</span></span> <span class="skolem"><span class="skolem">u'</span></span> <span class="skolem"><span class="skolem">v</span></span> <span class="keyword2"><span class="keyword">where</span></span> kplp<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">k'</span><span class="main">∥</span><span class="skolem">l'</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> kpq<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">k'</span><span class="main">∥</span><span class="skolem">q</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> lpz<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">l'</span><span class="main">∥</span><span class="skolem">z</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> zup<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">z</span><span class="main">∥</span><span class="skolem">u'</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> upv<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">u'</span><span class="main">∥</span><span class="skolem">v</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> qv<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">q</span><span class="main">∥</span><span class="skolem">v</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> d <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">from</span></span> pu zu zup <span class="keyword1"><span class="command">have</span></span> pup<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">p</span><span class="main">∥</span><span class="skolem">u'</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> M1 <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">from</span></span> kp kpq <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">k</span><span class="main">∥</span><span class="skolem">q</span> <span class="main">⊕</span> <span class="main">(</span><span class="main">(</span><span class="main">∃</span><span class="bound">t</span><span class="main">.</span> <span class="skolem">k</span><span class="main">∥</span><span class="bound">t</span> <span class="main">∧</span> <span class="bound">t</span><span class="main">∥</span><span class="skolem">q</span><span class="main">)</span> <span class="main">⊕</span> <span class="main">(</span><span class="main">∃</span><span class="bound">t</span><span class="main">.</span> <span class="skolem">k'</span><span class="main">∥</span><span class="bound">t</span> <span class="main">∧</span> <span class="bound">t</span><span class="main">∥</span><span class="skolem">p</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">is</span></span> <span class="quoted"><span class="quoted">"<span class="var">?A</span> <span class="main">⊕</span> <span class="main">(</span><span class="var">?B</span> <span class="main">⊕</span> <span class="var">?C</span><span class="main">)</span>"</span></span><span class="main">)</span> <span class="keyword1"><span class="command">using</span></span> M2 <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="var">?A</span><span class="main">∧</span><span class="main">¬</span><span class="var">?B</span><span class="main">∧</span><span class="main">¬</span><span class="var">?C</span><span class="main">)</span> <span class="main">∨</span> <span class="main">(</span><span class="main">(</span><span class="main">¬</span><span class="var">?A</span><span class="main">∧</span><span class="var">?B</span><span class="main">∧</span><span class="main">¬</span><span class="var">?C</span><span class="main">)</span> <span class="main">∨</span> <span class="main">(</span><span class="main">¬</span><span class="var">?A</span><span class="main">∧</span><span class="main">¬</span><span class="var">?B</span><span class="main">∧</span><span class="var">?C</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">insert</span> xor_distr_L<span class="main"><span class="main">[</span></span><span class="operator">of</span> <span class="var"><span class="quoted"><span class="var">?A</span></span></span> <span class="var"><span class="quoted"><span class="var">?B</span></span></span> <span class="var"><span class="quoted"><span class="var">?C</span></span></span><span class="main"><span class="main">]</span></span><span class="main"><span class="keyword3">,</span></span> <span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span>elimmeets<span class="main">)</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">∈</span> s <span class="main">∪</span> ov <span class="main">∪</span> d"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">elim</span> disjE<span class="main">)</span>
    <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="var">?A</span><span class="main">∧</span><span class="main">¬</span><span class="var">?B</span><span class="main">∧</span><span class="main">¬</span><span class="var">?C</span>"</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="var"><span class="quoted"><span class="var">?A</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
      <span class="keyword1"><span class="command">with</span></span> pup upv kp qv <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">p</span><span class="main">,</span><span class="skolem">q</span><span class="main">)</span> <span class="main">∈</span> s"</span></span> <span class="keyword1"><span class="command">using</span></span> s <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
      <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> x <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span><span class="keyword1"><span class="command">}</span></span>
    <span class="keyword1"><span class="command">next</span></span>
    <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span><span class="var">?A</span><span class="main">∧</span><span class="var">?B</span><span class="main">∧</span><span class="main">¬</span><span class="var">?C</span>"</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="var"><span class="quoted"><span class="var">?B</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
      <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">t</span></span> <span class="keyword2"><span class="keyword">where</span></span> kt<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">k</span><span class="main">∥</span><span class="skolem">t</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> tq<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">t</span><span class="main">∥</span><span class="skolem">q</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">from</span></span> tq kpq kplp <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">t</span><span class="main">∥</span><span class="skolem">l'</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> M1 <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
      <span class="keyword1"><span class="command">with</span></span> lpz zup <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">lpz</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">t</span><span class="main">∥</span><span class="skolem">lpz</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">lpz</span><span class="main">∥</span><span class="skolem">u'</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> M5exist_var <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
      <span class="keyword1"><span class="command">with</span></span> kp pup upv kt tq qv <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">p</span><span class="main">,</span><span class="skolem">q</span><span class="main">)</span><span class="main">∈</span>ov"</span></span> <span class="keyword1"><span class="command">using</span></span> ov <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
      <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> x <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span><span class="keyword1"><span class="command">}</span></span>
       <span class="keyword1"><span class="command">next</span></span>
    <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span><span class="var">?A</span> <span class="main">∧</span> <span class="main">¬</span><span class="var">?B</span> <span class="main">∧</span> <span class="var">?C</span>"</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="var"><span class="quoted"><span class="var">?C</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
      <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">t</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">k'</span><span class="main">∥</span><span class="skolem">t</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">t</span><span class="main">∥</span><span class="skolem">p</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">with</span></span> pup upv kpq qv <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">p</span><span class="main">,</span><span class="skolem">q</span><span class="main">)</span> <span class="main">∈</span> d"</span></span> <span class="keyword1"><span class="command">using</span></span> d <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
      <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> x <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span><span class="keyword1"><span class="command">}</span></span>
    <span class="keyword1"><span class="command">qed</span></span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">lemma</span></span> cfov<span class="main">:</span><span class="quoted"><span class="quoted">"f <span class="keyword1">O</span> ov <span class="main">⊆</span> ov <span class="main">∪</span> s <span class="main">∪</span> d"</span></span>
<span class="keyword1"><span class="command">proof</span></span>
    <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">x</span><span class="main">::</span><span class="quoted"><span class="quoted">"<span class="tfree">'a</span><span class="main">×</span><span class="tfree">'a</span>"</span></span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">∈</span> f <span class="keyword1">O</span> ov"</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">p</span></span> <span class="skolem"><span class="skolem">q</span></span> <span class="skolem"><span class="skolem">z</span></span> <span class="keyword2"><span class="keyword">where</span></span> x<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">=</span> <span class="main">(</span><span class="skolem">p</span><span class="main">,</span><span class="skolem">q</span><span class="main">)</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">p</span><span class="main">,</span><span class="skolem">z</span><span class="main">)</span> <span class="main">∈</span> f"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">z</span><span class="main">,</span><span class="skolem">q</span><span class="main">)</span><span class="main">∈</span> ov"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="main">(</span><span class="skolem">p</span><span class="main">,</span><span class="skolem">z</span><span class="main">)</span> <span class="main">∈</span> f›</span></span> <span class="keyword3"><span class="command">obtain</span></span>  <span class="skolem"><span class="skolem">k</span></span> <span class="skolem"><span class="skolem">l</span></span> <span class="skolem"><span class="skolem">u</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">k</span><span class="main">∥</span><span class="skolem">l</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> kz<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">k</span><span class="main">∥</span><span class="skolem">z</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> lp<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">l</span><span class="main">∥</span><span class="skolem">p</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> pu<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">p</span><span class="main">∥</span><span class="skolem">u</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> zu<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">z</span><span class="main">∥</span><span class="skolem">u</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> f <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
    <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="main">(</span><span class="skolem">z</span><span class="main">,</span><span class="skolem">q</span><span class="main">)</span> <span class="main">∈</span> ov›</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">k'</span></span> <span class="skolem"><span class="skolem">l'</span></span> <span class="skolem"><span class="skolem">c</span></span>  <span class="skolem"><span class="skolem">u'</span></span> <span class="skolem"><span class="skolem">v</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">k'</span><span class="main">∥</span><span class="skolem">l'</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> kpz<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">k'</span><span class="main">∥</span><span class="skolem">z</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> lpq<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">l'</span><span class="main">∥</span> <span class="skolem">q</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span>  zup<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">z</span><span class="main">∥</span><span class="skolem">u'</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> upv<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">u'</span><span class="main">∥</span><span class="skolem">v</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> qv<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">q</span><span class="main">∥</span><span class="skolem">v</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> lpc<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">l'</span><span class="main">∥</span><span class="skolem">c</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> cup<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">c</span><span class="main">∥</span><span class="skolem">u'</span>"</span></span>  <span class="keyword1"><span class="command">using</span></span>  ov <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
    <span class="keyword1"><span class="command">from</span></span> pu zu zup <span class="keyword1"><span class="command">have</span></span> pup<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">p</span><span class="main">∥</span><span class="skolem">u'</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> M1 <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
    <span class="keyword1"><span class="command">from</span></span> lp lpq <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">l</span><span class="main">∥</span><span class="skolem">q</span> <span class="main">⊕</span> <span class="main">(</span><span class="main">(</span><span class="main">∃</span><span class="bound">t</span><span class="main">.</span> <span class="skolem">l</span><span class="main">∥</span><span class="bound">t</span> <span class="main">∧</span> <span class="bound">t</span><span class="main">∥</span><span class="skolem">q</span><span class="main">)</span> <span class="main">⊕</span> <span class="main">(</span><span class="main">∃</span><span class="bound">t</span><span class="main">.</span> <span class="skolem">l'</span><span class="main">∥</span><span class="bound">t</span> <span class="main">∧</span> <span class="bound">t</span><span class="main">∥</span><span class="skolem">p</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">is</span></span> <span class="quoted"><span class="quoted">"<span class="var">?A</span> <span class="main">⊕</span> <span class="main">(</span><span class="var">?B</span> <span class="main">⊕</span> <span class="var">?C</span><span class="main">)</span>"</span></span><span class="main">)</span> <span class="keyword1"><span class="command">using</span></span> M2 <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="var">?A</span><span class="main">∧</span><span class="main">¬</span><span class="var">?B</span><span class="main">∧</span><span class="main">¬</span><span class="var">?C</span><span class="main">)</span> <span class="main">∨</span> <span class="main">(</span><span class="main">(</span><span class="main">¬</span><span class="var">?A</span><span class="main">∧</span><span class="var">?B</span><span class="main">∧</span><span class="main">¬</span><span class="var">?C</span><span class="main">)</span> <span class="main">∨</span> <span class="main">(</span><span class="main">¬</span><span class="var">?A</span><span class="main">∧</span><span class="main">¬</span><span class="var">?B</span><span class="main">∧</span><span class="var">?C</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">insert</span> xor_distr_L<span class="main"><span class="main">[</span></span><span class="operator">of</span> <span class="var"><span class="quoted"><span class="var">?A</span></span></span> <span class="var"><span class="quoted"><span class="var">?B</span></span></span> <span class="var"><span class="quoted"><span class="var">?C</span></span></span><span class="main"><span class="main">]</span></span><span class="main"><span class="keyword3">,</span></span> <span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span>elimmeets<span class="main">)</span>
    <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">∈</span> ov <span class="main">∪</span> s <span class="main">∪</span> d"</span></span>
    <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">elim</span> disjE<span class="main">)</span>
      <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="var">?A</span><span class="main">∧</span><span class="main">¬</span><span class="var">?B</span><span class="main">∧</span><span class="main">¬</span><span class="var">?C</span>"</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="var"><span class="quoted"><span class="var">?A</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
        <span class="keyword1"><span class="command">with</span></span>  lp pup upv qv <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">p</span><span class="main">,</span><span class="skolem">q</span><span class="main">)</span> <span class="main">∈</span> s"</span></span> <span class="keyword1"><span class="command">using</span></span> s <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
        <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> x <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span><span class="keyword1"><span class="command">}</span></span>
      <span class="keyword1"><span class="command">next</span></span>
      <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span><span class="var">?A</span><span class="main">∧</span><span class="var">?B</span><span class="main">∧</span><span class="main">¬</span><span class="var">?C</span>"</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="var"><span class="quoted"><span class="var">?B</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
      <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">t</span></span> <span class="keyword2"><span class="keyword">where</span></span> lt<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">l</span><span class="main">∥</span><span class="skolem">t</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> tq<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">t</span><span class="main">∥</span><span class="skolem">q</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">from</span></span> tq lpq lpc <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">t</span><span class="main">∥</span><span class="skolem">c</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> M1 <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
      <span class="keyword1"><span class="command">with</span></span> lp lt tq pup upv qv cup <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">p</span><span class="main">,</span><span class="skolem">q</span><span class="main">)</span><span class="main">∈</span>ov"</span></span> <span class="keyword1"><span class="command">using</span></span> ov <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
      <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> x <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span><span class="keyword1"><span class="command">}</span></span>
      <span class="keyword1"><span class="command">next</span></span>
      <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span><span class="var">?A</span> <span class="main">∧</span> <span class="main">¬</span><span class="var">?B</span> <span class="main">∧</span> <span class="var">?C</span>"</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="var"><span class="quoted"><span class="var">?C</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
      <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">t</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">l'</span><span class="main">∥</span><span class="skolem">t</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">t</span><span class="main">∥</span><span class="skolem">p</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">with</span></span> lpq pup upv qv <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">p</span><span class="main">,</span><span class="skolem">q</span><span class="main">)</span> <span class="main">∈</span> d"</span></span> <span class="keyword1"><span class="command">using</span></span> d <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
      <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> x <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span><span class="keyword1"><span class="command">}</span></span>
    <span class="keyword1"><span class="command">qed</span></span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="comment1">(* ========= $\alpha_2$ composition ========== *)</span>
<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹We prove compositions of the form $r_1 \circ r_2 \subseteq ov \cup f^{-1} \cup d^{-1}$.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> covsi<span class="main">:</span><span class="quoted"><span class="quoted">"ov <span class="keyword1">O</span> s<span class="main">^-1</span> <span class="main">⊆</span> ov <span class="main">∪</span> f<span class="main">^-1</span> <span class="main">∪</span> d<span class="main">^-1</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span>
    <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">x</span><span class="main">::</span><span class="quoted"><span class="quoted">"<span class="tfree">'a</span><span class="main">×</span><span class="tfree">'a</span>"</span></span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">∈</span> ov <span class="keyword1">O</span> s<span class="main">^-1</span>"</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">p</span></span> <span class="skolem"><span class="skolem">q</span></span> <span class="skolem"><span class="skolem">z</span></span> <span class="keyword2"><span class="keyword">where</span></span> x<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">=</span> <span class="main">(</span><span class="skolem">p</span><span class="main">,</span><span class="skolem">q</span><span class="main">)</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">p</span><span class="main">,</span><span class="skolem">z</span><span class="main">)</span> <span class="main">∈</span> ov"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">z</span><span class="main">,</span><span class="skolem">q</span><span class="main">)</span> <span class="main">∈</span> s<span class="main">^-1</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="main">(</span><span class="skolem">p</span><span class="main">,</span><span class="skolem">z</span><span class="main">)</span> <span class="main">∈</span> ov›</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">k</span></span> <span class="skolem"><span class="skolem">l</span></span> <span class="skolem"><span class="skolem">c</span></span> <span class="skolem"><span class="skolem">u</span></span>  <span class="keyword2"><span class="keyword">where</span></span> kp<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">k</span><span class="main">∥</span><span class="skolem">p</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> pu<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">p</span><span class="main">∥</span><span class="skolem">u</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> kl<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">k</span><span class="main">∥</span><span class="skolem">l</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> lz<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">l</span><span class="main">∥</span><span class="skolem">z</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> lc<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">l</span><span class="main">∥</span><span class="skolem">c</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> cu<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">c</span><span class="main">∥</span><span class="skolem">u</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> ov <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
    <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="main">(</span><span class="skolem">z</span><span class="main">,</span><span class="skolem">q</span><span class="main">)</span> <span class="main">∈</span> s<span class="main">^-1</span>›</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">k'</span></span> <span class="skolem"><span class="skolem">u'</span></span> <span class="skolem"><span class="skolem">v'</span></span> <span class="keyword2"><span class="keyword">where</span></span> kpz<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">k'</span><span class="main">∥</span><span class="skolem">z</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> kpq<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">k'</span><span class="main">∥</span><span class="skolem">q</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> kpz<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">k'</span><span class="main">∥</span><span class="skolem">z</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span>  zup<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">z</span><span class="main">∥</span><span class="skolem">u'</span>"</span></span>  <span class="keyword2"><span class="keyword">and</span></span> qvp<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">q</span><span class="main">∥</span><span class="skolem">v'</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> s <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
    <span class="keyword1"><span class="command">from</span></span> lz kpz kpq <span class="keyword1"><span class="command">have</span></span> lq<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">l</span><span class="main">∥</span><span class="skolem">q</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> M1 <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
    <span class="keyword1"><span class="command">from</span></span> pu qvp <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">p</span><span class="main">∥</span><span class="skolem">v'</span> <span class="main">⊕</span> <span class="main">(</span><span class="main">(</span><span class="main">∃</span><span class="bound">t</span><span class="main">.</span> <span class="skolem">p</span><span class="main">∥</span><span class="bound">t</span> <span class="main">∧</span> <span class="bound">t</span><span class="main">∥</span><span class="skolem">v'</span><span class="main">)</span> <span class="main">⊕</span> <span class="main">(</span><span class="main">∃</span><span class="bound">t</span><span class="main">.</span> <span class="skolem">q</span><span class="main">∥</span><span class="bound">t</span> <span class="main">∧</span> <span class="bound">t</span><span class="main">∥</span><span class="skolem">u</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">is</span></span> <span class="quoted"><span class="quoted">"<span class="var">?A</span> <span class="main">⊕</span> <span class="main">(</span><span class="var">?B</span> <span class="main">⊕</span> <span class="var">?C</span><span class="main">)</span>"</span></span><span class="main">)</span> <span class="keyword1"><span class="command">using</span></span> M2 <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="var">?A</span><span class="main">∧</span><span class="main">¬</span><span class="var">?B</span><span class="main">∧</span><span class="main">¬</span><span class="var">?C</span><span class="main">)</span> <span class="main">∨</span> <span class="main">(</span><span class="main">(</span><span class="main">¬</span><span class="var">?A</span><span class="main">∧</span><span class="var">?B</span><span class="main">∧</span><span class="main">¬</span><span class="var">?C</span><span class="main">)</span> <span class="main">∨</span> <span class="main">(</span><span class="main">¬</span><span class="var">?A</span><span class="main">∧</span><span class="main">¬</span><span class="var">?B</span><span class="main">∧</span><span class="var">?C</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">insert</span> xor_distr_L<span class="main"><span class="main">[</span></span><span class="operator">of</span> <span class="var"><span class="quoted"><span class="var">?A</span></span></span> <span class="var"><span class="quoted"><span class="var">?B</span></span></span> <span class="var"><span class="quoted"><span class="var">?C</span></span></span><span class="main"><span class="main">]</span></span><span class="main"><span class="keyword3">,</span></span> <span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span>elimmeets<span class="main">)</span>
    <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">∈</span> ov <span class="main">∪</span> f<span class="main">^-1</span> <span class="main">∪</span> d<span class="main">^-1</span>"</span></span>
    <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">elim</span> disjE<span class="main">)</span>
      <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="var">?A</span><span class="main">∧</span><span class="main">¬</span><span class="var">?B</span><span class="main">∧</span><span class="main">¬</span><span class="var">?C</span>"</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="var"><span class="quoted"><span class="var">?A</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
        <span class="keyword1"><span class="command">with</span></span> qvp kp kl lq <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">p</span><span class="main">,</span><span class="skolem">q</span><span class="main">)</span> <span class="main">∈</span> f<span class="main">^-1</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> f <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
        <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> x <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span><span class="keyword1"><span class="command">}</span></span>
      <span class="keyword1"><span class="command">next</span></span>
      <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span><span class="var">?A</span><span class="main">∧</span><span class="var">?B</span><span class="main">∧</span><span class="main">¬</span><span class="var">?C</span>"</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="var"><span class="quoted"><span class="var">?B</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span> 
        <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">t</span></span> <span class="keyword2"><span class="keyword">where</span></span> ptp<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">p</span><span class="main">∥</span><span class="skolem">t</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">t</span><span class="main">∥</span><span class="skolem">v'</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command"><span class="improper">with</span></span></span> pu cu <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">c</span><span class="main">∥</span><span class="skolem">t</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> M1 <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
        <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">p</span><span class="main">,</span><span class="skolem">q</span><span class="main">)</span><span class="main">∈</span> ov"</span></span> <span class="keyword1"><span class="command">using</span></span> kp kl lc cu lq qvp  ov <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
        <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> x <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span><span class="keyword1"><span class="command">}</span></span>        
     <span class="keyword1"><span class="command">next</span></span>
      <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span><span class="var">?A</span> <span class="main">∧</span> <span class="main">¬</span><span class="var">?B</span> <span class="main">∧</span> <span class="var">?C</span>"</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="var"><span class="quoted"><span class="var">?C</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
        <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">t</span></span> <span class="keyword2"><span class="keyword">where</span></span> qt<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">q</span><span class="main">∥</span><span class="skolem">t</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">t</span><span class="main">∥</span><span class="skolem">u</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword1"><span class="command">with</span></span> kp kl lq pu  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">p</span><span class="main">,</span><span class="skolem">q</span><span class="main">)</span> <span class="main">∈</span> d<span class="main">^-1</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> d <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span> 
        <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> x <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span><span class="keyword1"><span class="command">}</span></span>
      <span class="keyword1"><span class="command">qed</span></span>
<span class="keyword1"><span class="command">qed</span></span>


<span class="keyword1"><span class="command">lemma</span></span> cdim<span class="main">:</span><span class="quoted"><span class="quoted">"d<span class="main">^-1</span> <span class="keyword1">O</span> m <span class="main">⊆</span>  ov <span class="main">∪</span> d<span class="main">^-1</span> <span class="main">∪</span> f<span class="main">^-1</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> 
    <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">x</span><span class="main">::</span><span class="quoted"><span class="quoted">"<span class="tfree">'a</span><span class="main">×</span><span class="tfree">'a</span>"</span></span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">∈</span> d<span class="main">^-1</span> <span class="keyword1">O</span> m"</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">p</span></span> <span class="skolem"><span class="skolem">q</span></span> <span class="skolem"><span class="skolem">z</span></span> <span class="keyword2"><span class="keyword">where</span></span> x<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">=</span> <span class="main">(</span><span class="skolem">p</span><span class="main">,</span><span class="skolem">q</span><span class="main">)</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">p</span><span class="main">,</span><span class="skolem">z</span><span class="main">)</span> <span class="main">∈</span> d<span class="main">^-1</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">z</span><span class="main">,</span><span class="skolem">q</span><span class="main">)</span> <span class="main">∈</span> m"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="main">(</span><span class="skolem">p</span><span class="main">,</span><span class="skolem">z</span><span class="main">)</span> <span class="main">∈</span> d<span class="main">^-1</span>›</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">k</span></span> <span class="skolem"><span class="skolem">l</span></span> <span class="skolem"><span class="skolem">u</span></span> <span class="skolem"><span class="skolem">v</span></span> <span class="keyword2"><span class="keyword">where</span></span> kp<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">k</span><span class="main">∥</span><span class="skolem">p</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> pv<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">p</span><span class="main">∥</span><span class="skolem">v</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> kl<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">k</span><span class="main">∥</span><span class="skolem">l</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> lz<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">l</span><span class="main">∥</span><span class="skolem">z</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> zu<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">z</span><span class="main">∥</span><span class="skolem">u</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> uv<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">u</span><span class="main">∥</span><span class="skolem">v</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> d <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
    <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="main">(</span><span class="skolem">z</span><span class="main">,</span><span class="skolem">q</span><span class="main">)</span> <span class="main">∈</span> m›</span></span>  <span class="keyword1"><span class="command">have</span></span> zq<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">z</span><span class="main">∥</span><span class="skolem">q</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> m <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
    <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">v'</span></span> <span class="keyword2"><span class="keyword">where</span></span> qvp<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">q</span><span class="main">∥</span><span class="skolem">v'</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> M3 meets_wd zq <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
    <span class="keyword1"><span class="command">from</span></span> kl lz zq <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">lz</span></span> <span class="keyword2"><span class="keyword">where</span></span> klz<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">k</span><span class="main">∥</span><span class="skolem">lz</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> lzq<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">lz</span><span class="main">∥</span><span class="skolem">q</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> M5exist_var  <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
    <span class="keyword1"><span class="command">from</span></span> pv qvp <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">p</span><span class="main">∥</span><span class="skolem">v'</span> <span class="main">⊕</span> <span class="main">(</span><span class="main">(</span><span class="main">∃</span><span class="bound">t</span><span class="main">.</span> <span class="skolem">p</span><span class="main">∥</span><span class="bound">t</span> <span class="main">∧</span> <span class="bound">t</span><span class="main">∥</span><span class="skolem">v'</span><span class="main">)</span> <span class="main">⊕</span> <span class="main">(</span><span class="main">∃</span><span class="bound">t</span><span class="main">.</span> <span class="skolem">q</span><span class="main">∥</span><span class="bound">t</span> <span class="main">∧</span> <span class="bound">t</span><span class="main">∥</span><span class="skolem">v</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">is</span></span> <span class="quoted"><span class="quoted">"<span class="var">?A</span> <span class="main">⊕</span> <span class="main">(</span><span class="var">?B</span> <span class="main">⊕</span> <span class="var">?C</span><span class="main">)</span>"</span></span><span class="main">)</span> <span class="keyword1"><span class="command">using</span></span> M2 <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="var">?A</span><span class="main">∧</span><span class="main">¬</span><span class="var">?B</span><span class="main">∧</span><span class="main">¬</span><span class="var">?C</span><span class="main">)</span> <span class="main">∨</span> <span class="main">(</span><span class="main">(</span><span class="main">¬</span><span class="var">?A</span><span class="main">∧</span><span class="var">?B</span><span class="main">∧</span><span class="main">¬</span><span class="var">?C</span><span class="main">)</span> <span class="main">∨</span> <span class="main">(</span><span class="main">¬</span><span class="var">?A</span><span class="main">∧</span><span class="main">¬</span><span class="var">?B</span><span class="main">∧</span><span class="var">?C</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">insert</span> xor_distr_L<span class="main"><span class="main">[</span></span><span class="operator">of</span> <span class="var"><span class="quoted"><span class="var">?A</span></span></span> <span class="var"><span class="quoted"><span class="var">?B</span></span></span> <span class="var"><span class="quoted"><span class="var">?C</span></span></span><span class="main"><span class="main">]</span></span><span class="main"><span class="keyword3">,</span></span> <span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span>elimmeets<span class="main">)</span>
    <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">∈</span>  ov <span class="main">∪</span> d<span class="main">^-1</span> <span class="main">∪</span> f<span class="main">^-1</span>"</span></span>
    <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">elim</span> disjE<span class="main">)</span>
      <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="var">?A</span><span class="main">∧</span><span class="main">¬</span><span class="var">?B</span><span class="main">∧</span><span class="main">¬</span><span class="var">?C</span>"</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="var"><span class="quoted"><span class="var">?A</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
        <span class="keyword1"><span class="command">with</span></span> qvp kp klz lzq<span class="quoted"><span class="quoted">‹<span class="var">?A</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">p</span><span class="main">,</span><span class="skolem">q</span><span class="main">)</span> <span class="main">∈</span> f<span class="main">^-1</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> f <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
        <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> x <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span><span class="keyword1"><span class="command">}</span></span>
      <span class="keyword1"><span class="command">next</span></span>
      <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span><span class="var">?A</span><span class="main">∧</span><span class="var">?B</span><span class="main">∧</span><span class="main">¬</span><span class="var">?C</span>"</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="var"><span class="quoted"><span class="var">?B</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span> 
        <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">t</span></span> <span class="keyword2"><span class="keyword">where</span></span> pt<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">p</span><span class="main">∥</span><span class="skolem">t</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> tvp<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">t</span><span class="main">∥</span><span class="skolem">v'</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword1"><span class="command">from</span></span> zq lzq zu <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">lz</span><span class="main">∥</span><span class="skolem">u</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> M1 <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> pt pv uv <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">u</span><span class="main">∥</span><span class="skolem">t</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> M1 <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">p</span><span class="main">,</span><span class="skolem">q</span><span class="main">)</span><span class="main">∈</span> ov"</span></span> <span class="keyword1"><span class="command">using</span></span> kp klz lzq pt tvp qvp ov <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
        <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> x <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span><span class="keyword1"><span class="command">}</span></span>        
     <span class="keyword1"><span class="command">next</span></span>
      <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span><span class="var">?A</span> <span class="main">∧</span> <span class="main">¬</span><span class="var">?B</span> <span class="main">∧</span> <span class="var">?C</span>"</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="var"><span class="quoted"><span class="var">?C</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
        <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">t</span></span> <span class="keyword2"><span class="keyword">where</span></span> qt<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">q</span><span class="main">∥</span><span class="skolem">t</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">t</span><span class="main">∥</span><span class="skolem">v</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword1"><span class="command">with</span></span> kp klz lzq pv <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">p</span><span class="main">,</span><span class="skolem">q</span><span class="main">)</span> <span class="main">∈</span> d<span class="main">^-1</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> d <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span> 
        <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> x <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span><span class="keyword1"><span class="command">}</span></span>
      <span class="keyword1"><span class="command">qed</span></span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">lemma</span></span> cdiov<span class="main">:</span><span class="quoted"><span class="quoted">"d<span class="main">^-1</span> <span class="keyword1">O</span> ov <span class="main">⊆</span> ov <span class="main">∪</span> f<span class="main">^-1</span> <span class="main">∪</span> d<span class="main">^-1</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span>
    <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">x</span><span class="main">::</span><span class="quoted"><span class="quoted">"<span class="tfree">'a</span><span class="main">×</span><span class="tfree">'a</span>"</span></span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">∈</span> d<span class="main">^-1</span> <span class="keyword1">O</span> ov"</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">p</span></span> <span class="skolem"><span class="skolem">q</span></span> <span class="skolem"><span class="skolem">r</span></span> <span class="keyword2"><span class="keyword">where</span></span> x<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">=</span> <span class="main">(</span><span class="skolem">p</span><span class="main">,</span><span class="skolem">r</span><span class="main">)</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">p</span><span class="main">,</span><span class="skolem">q</span><span class="main">)</span> <span class="main">∈</span> d<span class="main">^-1</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">q</span><span class="main">,</span><span class="skolem">r</span><span class="main">)</span> <span class="main">∈</span> ov"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="main">(</span><span class="skolem">p</span><span class="main">,</span><span class="skolem">q</span><span class="main">)</span> <span class="main">∈</span> d<span class="main">^-1</span>›</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">u</span></span> <span class="skolem"><span class="skolem">v</span></span> <span class="skolem"><span class="skolem">k</span></span> <span class="skolem"><span class="skolem">l</span></span>  <span class="keyword2"><span class="keyword">where</span></span> kp<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">k</span><span class="main">∥</span><span class="skolem">p</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> pv<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">p</span><span class="main">∥</span><span class="skolem">v</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> kl<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">k</span><span class="main">∥</span><span class="skolem">l</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> lq<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">l</span><span class="main">∥</span><span class="skolem">q</span>"</span></span>  <span class="keyword2"><span class="keyword">and</span></span> qu<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">q</span><span class="main">∥</span><span class="skolem">u</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> uv<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">u</span><span class="main">∥</span><span class="skolem">v</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> d <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
    <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="main">(</span><span class="skolem">q</span><span class="main">,</span><span class="skolem">r</span><span class="main">)</span> <span class="main">∈</span> ov›</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">k'</span></span> <span class="skolem"><span class="skolem">l'</span></span> <span class="skolem"><span class="skolem">t</span></span> <span class="skolem"><span class="skolem">u'</span></span> <span class="skolem"><span class="skolem">v'</span></span> <span class="keyword2"><span class="keyword">where</span></span> lpr<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">l'</span><span class="main">∥</span><span class="skolem">r</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> kpq<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">k'</span><span class="main">∥</span><span class="skolem">q</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> kplp<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">k'</span><span class="main">∥</span><span class="skolem">l'</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> qup<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">q</span><span class="main">∥</span><span class="skolem">u'</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">u'</span><span class="main">∥</span><span class="skolem">v'</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> rvp<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">r</span><span class="main">∥</span><span class="skolem">v'</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> lpt<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">l'</span><span class="main">∥</span><span class="skolem">t</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> tup<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">t</span><span class="main">∥</span><span class="skolem">u'</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> ov <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
    <span class="keyword1"><span class="command">from</span></span> lq kplp kpq <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">l</span><span class="main">∥</span><span class="skolem">l'</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> M1 <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
    <span class="keyword1"><span class="command">with</span></span> kl lpr  <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">ll</span></span> <span class="keyword2"><span class="keyword">where</span></span>  kll<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">k</span><span class="main">∥</span><span class="skolem">ll</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> llr<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">ll</span><span class="main">∥</span><span class="skolem">r</span>"</span></span>  <span class="keyword1"><span class="command">using</span></span> M5exist_var <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
    <span class="keyword1"><span class="command">from</span></span> pv rvp <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">p</span><span class="main">∥</span><span class="skolem">v'</span> <span class="main">⊕</span> <span class="main">(</span><span class="main">(</span><span class="main">∃</span><span class="bound">t'</span><span class="main">.</span> <span class="skolem">p</span><span class="main">∥</span><span class="bound">t'</span> <span class="main">∧</span> <span class="bound">t'</span><span class="main">∥</span><span class="skolem">v'</span><span class="main">)</span> <span class="main">⊕</span> <span class="main">(</span><span class="main">∃</span><span class="bound">t'</span><span class="main">.</span> <span class="skolem">r</span><span class="main">∥</span><span class="bound">t'</span> <span class="main">∧</span> <span class="bound">t'</span><span class="main">∥</span><span class="skolem">v</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">is</span></span> <span class="quoted"><span class="quoted">"<span class="var">?A</span> <span class="main">⊕</span> <span class="main">(</span><span class="var">?B</span> <span class="main">⊕</span> <span class="var">?C</span><span class="main">)</span>"</span></span><span class="main">)</span> <span class="keyword1"><span class="command">using</span></span> M2 <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="var">?A</span><span class="main">∧</span><span class="main">¬</span><span class="var">?B</span><span class="main">∧</span><span class="main">¬</span><span class="var">?C</span><span class="main">)</span> <span class="main">∨</span> <span class="main">(</span><span class="main">(</span><span class="main">¬</span><span class="var">?A</span><span class="main">∧</span><span class="var">?B</span><span class="main">∧</span><span class="main">¬</span><span class="var">?C</span><span class="main">)</span> <span class="main">∨</span> <span class="main">(</span><span class="main">¬</span><span class="var">?A</span><span class="main">∧</span><span class="main">¬</span><span class="var">?B</span><span class="main">∧</span><span class="var">?C</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">insert</span> xor_distr_L<span class="main"><span class="main">[</span></span><span class="operator">of</span> <span class="var"><span class="quoted"><span class="var">?A</span></span></span> <span class="var"><span class="quoted"><span class="var">?B</span></span></span> <span class="var"><span class="quoted"><span class="var">?C</span></span></span><span class="main"><span class="main">]</span></span><span class="main"><span class="keyword3">,</span></span> <span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span>elimmeets<span class="main">)</span>
    <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">∈</span> ov <span class="main">∪</span> f<span class="main">^-1</span> <span class="main">∪</span> d<span class="main">^-1</span>"</span></span>
    <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">elim</span> disjE<span class="main">)</span>
      <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="var">?A</span><span class="main">∧</span><span class="main">¬</span><span class="var">?B</span><span class="main">∧</span><span class="main">¬</span><span class="var">?C</span>"</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="var"><span class="quoted"><span class="var">?A</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
        <span class="keyword1"><span class="command">with</span></span> rvp llr kp kll <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">p</span><span class="main">,</span><span class="skolem">r</span><span class="main">)</span> <span class="main">∈</span> f<span class="main">^-1</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> f <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
        <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> x <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span><span class="keyword1"><span class="command">}</span></span>
      <span class="keyword1"><span class="command">next</span></span>
      <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span><span class="var">?A</span><span class="main">∧</span><span class="var">?B</span><span class="main">∧</span><span class="main">¬</span><span class="var">?C</span>"</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="var"><span class="quoted"><span class="var">?B</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span> 
        <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">t'</span></span> <span class="keyword2"><span class="keyword">where</span></span> ptp<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">p</span><span class="main">∥</span><span class="skolem">t'</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> tpvp<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">t'</span><span class="main">∥</span><span class="skolem">v'</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> lpt lpr llr <span class="keyword1"><span class="command">have</span></span> llt<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">ll</span><span class="main">∥</span><span class="skolem">t</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> M1 <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
        <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> ptp uv pv <span class="keyword1"><span class="command">have</span></span> utp<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">u</span><span class="main">∥</span><span class="skolem">t'</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> M1 <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
        <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> qu tup qup <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">t</span><span class="main">∥</span><span class="skolem">u</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> M1 <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
        <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command"><span class="improper">with</span></span></span> utp llt <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">tu</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">ll</span><span class="main">∥</span><span class="skolem">tu</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">tu</span><span class="main">∥</span><span class="skolem">t'</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> M5exist_var <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
        <span class="keyword1"><span class="command">with</span></span> kp ptp tpvp kll llr rvp  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">p</span><span class="main">,</span><span class="skolem">r</span><span class="main">)</span><span class="main">∈</span> ov"</span></span> <span class="keyword1"><span class="command">using</span></span>  ov <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
        <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> x <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span><span class="keyword1"><span class="command">}</span></span>        
     <span class="keyword1"><span class="command">next</span></span>
      <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span><span class="var">?A</span> <span class="main">∧</span> <span class="main">¬</span><span class="var">?B</span> <span class="main">∧</span> <span class="var">?C</span>"</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="var"><span class="quoted"><span class="var">?C</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
        <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">t'</span></span> <span class="keyword2"><span class="keyword">where</span></span> rtp<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">r</span><span class="main">∥</span><span class="skolem">t'</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">t'</span><span class="main">∥</span><span class="skolem">v</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword1"><span class="command">with</span></span> kll llr kp pv <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">p</span><span class="main">,</span><span class="skolem">r</span><span class="main">)</span> <span class="main">∈</span> d<span class="main">^-1</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> d <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span> 
        <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> x <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span><span class="keyword1"><span class="command">}</span></span>
      <span class="keyword1"><span class="command">qed</span></span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">lemma</span></span> cdis<span class="main">:</span><span class="quoted"><span class="quoted">"d<span class="main">^-1</span> <span class="keyword1">O</span> s <span class="main">⊆</span> ov <span class="main">∪</span> f<span class="main">^-1</span> <span class="main">∪</span> d<span class="main">^-1</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span>
  <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">x</span><span class="main">::</span><span class="quoted"><span class="quoted">"<span class="tfree">'a</span><span class="main">×</span><span class="tfree">'a</span>"</span></span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">∈</span> d<span class="main">^-1</span> <span class="keyword1">O</span> s"</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">p</span></span> <span class="skolem"><span class="skolem">q</span></span> <span class="skolem"><span class="skolem">z</span></span> <span class="keyword2"><span class="keyword">where</span></span> x<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">=</span> <span class="main">(</span><span class="skolem">p</span><span class="main">,</span><span class="skolem">q</span><span class="main">)</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">p</span><span class="main">,</span><span class="skolem">z</span><span class="main">)</span> <span class="main">∈</span> d<span class="main">^-1</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">z</span><span class="main">,</span><span class="skolem">q</span><span class="main">)</span> <span class="main">∈</span> s"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="main">(</span><span class="skolem">p</span><span class="main">,</span><span class="skolem">z</span><span class="main">)</span><span class="main">∈</span>d<span class="main">^-1</span>›</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">k</span></span> <span class="skolem"><span class="skolem">l</span></span> <span class="skolem"><span class="skolem">u</span></span> <span class="skolem"><span class="skolem">v</span></span> <span class="keyword2"><span class="keyword">where</span></span> kl<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">k</span><span class="main">∥</span><span class="skolem">l</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> lz<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">l</span><span class="main">∥</span><span class="skolem">z</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> kp<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">k</span><span class="main">∥</span><span class="skolem">p</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> zu<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">z</span><span class="main">∥</span><span class="skolem">u</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> uv<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">u</span><span class="main">∥</span><span class="skolem">v</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> pv<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">p</span><span class="main">∥</span><span class="skolem">v</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> d <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="main">(</span><span class="skolem">z</span><span class="main">,</span><span class="skolem">q</span><span class="main">)</span> <span class="main">∈</span> s›</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">l'</span></span>  <span class="skolem"><span class="skolem">v'</span></span> <span class="keyword2"><span class="keyword">where</span></span> lpz<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">l'</span><span class="main">∥</span><span class="skolem">z</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> lpq<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">l'</span><span class="main">∥</span><span class="skolem">q</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> qvp<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">q</span><span class="main">∥</span><span class="skolem">v'</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> s <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">from</span></span> lz lpz lpq <span class="keyword1"><span class="command">have</span></span> lq<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">l</span><span class="main">∥</span><span class="skolem">q</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> M1 <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">from</span></span> pv qvp <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">p</span><span class="main">∥</span><span class="skolem">v'</span> <span class="main">⊕</span> <span class="main">(</span><span class="main">(</span><span class="main">∃</span><span class="bound">t</span><span class="main">.</span> <span class="skolem">p</span><span class="main">∥</span><span class="bound">t</span> <span class="main">∧</span> <span class="bound">t</span><span class="main">∥</span><span class="skolem">v'</span><span class="main">)</span> <span class="main">⊕</span> <span class="main">(</span><span class="main">∃</span><span class="bound">t</span><span class="main">.</span> <span class="skolem">q</span><span class="main">∥</span><span class="bound">t</span> <span class="main">∧</span> <span class="bound">t</span><span class="main">∥</span><span class="skolem">v</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">is</span></span> <span class="quoted"><span class="quoted">"<span class="var">?A</span> <span class="main">⊕</span> <span class="main">(</span><span class="var">?B</span> <span class="main">⊕</span> <span class="var">?C</span><span class="main">)</span>"</span></span><span class="main">)</span> <span class="keyword1"><span class="command">using</span></span> M2 <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="var">?A</span><span class="main">∧</span><span class="main">¬</span><span class="var">?B</span><span class="main">∧</span><span class="main">¬</span><span class="var">?C</span><span class="main">)</span> <span class="main">∨</span> <span class="main">(</span><span class="main">(</span><span class="main">¬</span><span class="var">?A</span><span class="main">∧</span><span class="var">?B</span><span class="main">∧</span><span class="main">¬</span><span class="var">?C</span><span class="main">)</span> <span class="main">∨</span> <span class="main">(</span><span class="main">¬</span><span class="var">?A</span><span class="main">∧</span><span class="main">¬</span><span class="var">?B</span><span class="main">∧</span><span class="var">?C</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">insert</span> xor_distr_L<span class="main"><span class="main">[</span></span><span class="operator">of</span> <span class="var"><span class="quoted"><span class="var">?A</span></span></span> <span class="var"><span class="quoted"><span class="var">?B</span></span></span> <span class="var"><span class="quoted"><span class="var">?C</span></span></span><span class="main"><span class="main">]</span></span><span class="main"><span class="keyword3">,</span></span> <span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span>elimmeets<span class="main">)</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">∈</span> ov <span class="main">∪</span> f<span class="main">^-1</span> <span class="main">∪</span> d<span class="main">^-1</span>"</span></span>
    <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">elim</span> disjE<span class="main">)</span>
      <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="var">?A</span><span class="main">∧</span><span class="main">¬</span><span class="var">?B</span><span class="main">∧</span><span class="main">¬</span><span class="var">?C</span>"</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="var"><span class="quoted"><span class="var">?A</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
        <span class="keyword1"><span class="command">with</span></span> kl lq qvp kp <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">p</span><span class="main">,</span><span class="skolem">q</span><span class="main">)</span> <span class="main">∈</span> f<span class="main">^-1</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> f <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
        <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> x <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span><span class="keyword1"><span class="command">}</span></span>
      <span class="keyword1"><span class="command">next</span></span>
      <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span><span class="var">?A</span><span class="main">∧</span><span class="var">?B</span><span class="main">∧</span><span class="main">¬</span><span class="var">?C</span>"</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="var"><span class="quoted"><span class="var">?B</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span> 
        <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">t</span></span> <span class="keyword2"><span class="keyword">where</span></span> pt<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">p</span><span class="main">∥</span><span class="skolem">t</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> tvp<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">t</span><span class="main">∥</span><span class="skolem">v'</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword1"><span class="command">from</span></span> pt pv uv <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">u</span><span class="main">∥</span><span class="skolem">t</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> M1 <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
        <span class="keyword1"><span class="command">with</span></span> lz zu <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">zu</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">l</span><span class="main">∥</span><span class="skolem">zu</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">zu</span><span class="main">∥</span><span class="skolem">t</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> M5exist_var <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
        <span class="keyword1"><span class="command">with</span></span> kp pt tvp kl lq qvp <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">p</span><span class="main">,</span><span class="skolem">q</span><span class="main">)</span> <span class="main">∈</span> ov"</span></span> <span class="keyword1"><span class="command">using</span></span> ov <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
        <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> x <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span><span class="keyword1"><span class="command">}</span></span>
      <span class="keyword1"><span class="command">next</span></span>
      <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span><span class="var">?A</span> <span class="main">∧</span> <span class="main">¬</span><span class="var">?B</span> <span class="main">∧</span> <span class="var">?C</span>"</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="var"><span class="quoted"><span class="var">?C</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
        <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">t</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">q</span><span class="main">∥</span><span class="skolem">t</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">t</span><span class="main">∥</span><span class="skolem">v</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword1"><span class="command">with</span></span> kl lq kp pv <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">p</span><span class="main">,</span><span class="skolem">q</span><span class="main">)</span><span class="main">∈</span>d<span class="main">^-1</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> d <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
        <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> x <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span><span class="keyword1"><span class="command">}</span></span>
      <span class="keyword1"><span class="command">qed</span></span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">lemma</span></span> csim<span class="main">:</span><span class="quoted"><span class="quoted">"s<span class="main">^-1</span> <span class="keyword1">O</span> m <span class="main">⊆</span> ov <span class="main">∪</span> f<span class="main">^-1</span> <span class="main">∪</span> d<span class="main">^-1</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> 
  <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">x</span><span class="main">::</span><span class="quoted"><span class="quoted">"<span class="tfree">'a</span><span class="main">×</span><span class="tfree">'a</span>"</span></span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">∈</span> s<span class="main">^-1</span> <span class="keyword1">O</span> m"</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">p</span></span> <span class="skolem"><span class="skolem">q</span></span> <span class="skolem"><span class="skolem">z</span></span> <span class="keyword2"><span class="keyword">where</span></span> x<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">=</span> <span class="main">(</span><span class="skolem">p</span><span class="main">,</span><span class="skolem">q</span><span class="main">)</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">p</span><span class="main">,</span><span class="skolem">z</span><span class="main">)</span> <span class="main">∈</span> s<span class="main">^-1</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">z</span><span class="main">,</span><span class="skolem">q</span><span class="main">)</span> <span class="main">∈</span> m"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="main">(</span><span class="skolem">p</span><span class="main">,</span><span class="skolem">z</span><span class="main">)</span><span class="main">∈</span>s<span class="main">^-1</span>›</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">k</span></span> <span class="skolem"><span class="skolem">u</span></span> <span class="skolem"><span class="skolem">v</span></span> <span class="keyword2"><span class="keyword">where</span></span> kp<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">k</span><span class="main">∥</span><span class="skolem">p</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> kz<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">k</span><span class="main">∥</span><span class="skolem">z</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> zu<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">z</span><span class="main">∥</span><span class="skolem">u</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> uv<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">u</span><span class="main">∥</span><span class="skolem">v</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> pv<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">p</span><span class="main">∥</span><span class="skolem">v</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> s <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="main">(</span><span class="skolem">z</span><span class="main">,</span><span class="skolem">q</span><span class="main">)</span> <span class="main">∈</span> m›</span></span> <span class="keyword1"><span class="command">have</span></span> zq<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">z</span><span class="main">∥</span><span class="skolem">q</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> m <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">v'</span></span> <span class="keyword2"><span class="keyword">where</span></span> qvp<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">q</span><span class="main">∥</span><span class="skolem">v'</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> M3 meets_wd zq <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">from</span></span> pv qvp <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">p</span><span class="main">∥</span><span class="skolem">v'</span> <span class="main">⊕</span> <span class="main">(</span><span class="main">(</span><span class="main">∃</span><span class="bound">t</span><span class="main">.</span> <span class="skolem">p</span><span class="main">∥</span><span class="bound">t</span> <span class="main">∧</span> <span class="bound">t</span><span class="main">∥</span><span class="skolem">v'</span><span class="main">)</span> <span class="main">⊕</span> <span class="main">(</span><span class="main">∃</span><span class="bound">t</span><span class="main">.</span> <span class="skolem">q</span><span class="main">∥</span><span class="bound">t</span> <span class="main">∧</span> <span class="bound">t</span><span class="main">∥</span><span class="skolem">v</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">is</span></span> <span class="quoted"><span class="quoted">"<span class="var">?A</span> <span class="main">⊕</span> <span class="main">(</span><span class="var">?B</span> <span class="main">⊕</span> <span class="var">?C</span><span class="main">)</span>"</span></span><span class="main">)</span> <span class="keyword1"><span class="command">using</span></span> M2 <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="var">?A</span><span class="main">∧</span><span class="main">¬</span><span class="var">?B</span><span class="main">∧</span><span class="main">¬</span><span class="var">?C</span><span class="main">)</span> <span class="main">∨</span> <span class="main">(</span><span class="main">(</span><span class="main">¬</span><span class="var">?A</span><span class="main">∧</span><span class="var">?B</span><span class="main">∧</span><span class="main">¬</span><span class="var">?C</span><span class="main">)</span> <span class="main">∨</span> <span class="main">(</span><span class="main">¬</span><span class="var">?A</span><span class="main">∧</span><span class="main">¬</span><span class="var">?B</span><span class="main">∧</span><span class="var">?C</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">insert</span> xor_distr_L<span class="main"><span class="main">[</span></span><span class="operator">of</span> <span class="var"><span class="quoted"><span class="var">?A</span></span></span> <span class="var"><span class="quoted"><span class="var">?B</span></span></span> <span class="var"><span class="quoted"><span class="var">?C</span></span></span><span class="main"><span class="main">]</span></span><span class="main"><span class="keyword3">,</span></span> <span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span>elimmeets<span class="main">)</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">∈</span> ov <span class="main">∪</span> f<span class="main">^-1</span> <span class="main">∪</span> d<span class="main">^-1</span>"</span></span>
    <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">elim</span> disjE<span class="main">)</span>
      <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="var">?A</span><span class="main">∧</span><span class="main">¬</span><span class="var">?B</span><span class="main">∧</span><span class="main">¬</span><span class="var">?C</span>"</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="var"><span class="quoted"><span class="var">?A</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
        <span class="keyword1"><span class="command">with</span></span> kp kz zq qvp <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">p</span><span class="main">,</span><span class="skolem">q</span><span class="main">)</span> <span class="main">∈</span> f<span class="main">^-1</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> f <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
        <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> x <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span><span class="keyword1"><span class="command">}</span></span>
      <span class="keyword1"><span class="command">next</span></span>
      <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span><span class="var">?A</span><span class="main">∧</span><span class="var">?B</span><span class="main">∧</span><span class="main">¬</span><span class="var">?C</span>"</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="var"><span class="quoted"><span class="var">?B</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span> 
        <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">t</span></span> <span class="keyword2"><span class="keyword">where</span></span> pt<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">p</span><span class="main">∥</span><span class="skolem">t</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> tvp<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">t</span><span class="main">∥</span><span class="skolem">v'</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword1"><span class="command">from</span></span> pt pv uv <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">u</span><span class="main">∥</span><span class="skolem">t</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> M1 <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
        <span class="keyword1"><span class="command">with</span></span> kp pt tvp kz zq qvp zu  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">p</span><span class="main">,</span><span class="skolem">q</span><span class="main">)</span> <span class="main">∈</span> ov"</span></span> <span class="keyword1"><span class="command">using</span></span> ov <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
        <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> x <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span><span class="keyword1"><span class="command">}</span></span>
      <span class="keyword1"><span class="command">next</span></span>
      <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span><span class="var">?A</span> <span class="main">∧</span> <span class="main">¬</span><span class="var">?B</span> <span class="main">∧</span> <span class="var">?C</span>"</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="var"><span class="quoted"><span class="var">?C</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
        <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">t</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">q</span><span class="main">∥</span><span class="skolem">t</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">t</span><span class="main">∥</span><span class="skolem">v</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword1"><span class="command">with</span></span> kp kz zq pv <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">p</span><span class="main">,</span><span class="skolem">q</span><span class="main">)</span><span class="main">∈</span>d<span class="main">^-1</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> d <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
        <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> x <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span><span class="keyword1"><span class="command">}</span></span>
      <span class="keyword1"><span class="command">qed</span></span>
<span class="keyword1"><span class="command">qed</span></span>
 
<span class="keyword1"><span class="command">lemma</span></span> csiov<span class="main">:</span><span class="quoted"><span class="quoted">"s<span class="main">^-1</span> <span class="keyword1">O</span> ov <span class="main">⊆</span> ov <span class="main">∪</span> f<span class="main">^-1</span> <span class="main">∪</span> d<span class="main">^-1</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> 
  <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">x</span><span class="main">::</span><span class="quoted"><span class="quoted">"<span class="tfree">'a</span><span class="main">×</span><span class="tfree">'a</span>"</span></span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">∈</span> s<span class="main">^-1</span> <span class="keyword1">O</span> ov"</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">p</span></span> <span class="skolem"><span class="skolem">q</span></span> <span class="skolem"><span class="skolem">z</span></span> <span class="keyword2"><span class="keyword">where</span></span> x<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">=</span> <span class="main">(</span><span class="skolem">p</span><span class="main">,</span><span class="skolem">q</span><span class="main">)</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">p</span><span class="main">,</span><span class="skolem">z</span><span class="main">)</span> <span class="main">∈</span> s<span class="main">^-1</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">z</span><span class="main">,</span><span class="skolem">q</span><span class="main">)</span> <span class="main">∈</span> ov"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="main">(</span><span class="skolem">p</span><span class="main">,</span><span class="skolem">z</span><span class="main">)</span><span class="main">∈</span>s<span class="main">^-1</span>›</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">k</span></span> <span class="skolem"><span class="skolem">u</span></span> <span class="skolem"><span class="skolem">v</span></span> <span class="keyword2"><span class="keyword">where</span></span> kp<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">k</span><span class="main">∥</span><span class="skolem">p</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> kz<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">k</span><span class="main">∥</span><span class="skolem">z</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> zu<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">z</span><span class="main">∥</span><span class="skolem">u</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> uv<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">u</span><span class="main">∥</span><span class="skolem">v</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> pv<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">p</span><span class="main">∥</span><span class="skolem">v</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> s <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="main">(</span><span class="skolem">z</span><span class="main">,</span><span class="skolem">q</span><span class="main">)</span> <span class="main">∈</span> ov›</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">k'</span></span> <span class="skolem"><span class="skolem">l'</span></span> <span class="skolem"><span class="skolem">u'</span></span> <span class="skolem"><span class="skolem">v'</span></span> <span class="skolem"><span class="skolem">c</span></span> <span class="keyword2"><span class="keyword">where</span></span> kpz<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">k'</span><span class="main">∥</span><span class="skolem">z</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> zup<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">z</span><span class="main">∥</span><span class="skolem">u'</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> upvp<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">u'</span><span class="main">∥</span><span class="skolem">v'</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> kplp<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">k'</span><span class="main">∥</span><span class="skolem">l'</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> lpq<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">l'</span><span class="main">∥</span><span class="skolem">q</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> qvp<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">q</span><span class="main">∥</span><span class="skolem">v'</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> lpc<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">l'</span><span class="main">∥</span><span class="skolem">c</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> cup<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">c</span><span class="main">∥</span><span class="skolem">u'</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> ov <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">from</span></span> kz kpz kplp <span class="keyword1"><span class="command">have</span></span> klp<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">k</span><span class="main">∥</span><span class="skolem">l'</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> M1 <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">from</span></span> pv qvp <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">p</span><span class="main">∥</span><span class="skolem">v'</span> <span class="main">⊕</span> <span class="main">(</span><span class="main">(</span><span class="main">∃</span><span class="bound">t</span><span class="main">.</span> <span class="skolem">p</span><span class="main">∥</span><span class="bound">t</span> <span class="main">∧</span> <span class="bound">t</span><span class="main">∥</span><span class="skolem">v'</span><span class="main">)</span> <span class="main">⊕</span> <span class="main">(</span><span class="main">∃</span><span class="bound">t</span><span class="main">.</span> <span class="skolem">q</span><span class="main">∥</span><span class="bound">t</span> <span class="main">∧</span> <span class="bound">t</span><span class="main">∥</span><span class="skolem">v</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">is</span></span> <span class="quoted"><span class="quoted">"<span class="var">?A</span> <span class="main">⊕</span> <span class="main">(</span><span class="var">?B</span> <span class="main">⊕</span> <span class="var">?C</span><span class="main">)</span>"</span></span><span class="main">)</span> <span class="keyword1"><span class="command">using</span></span> M2 <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="var">?A</span><span class="main">∧</span><span class="main">¬</span><span class="var">?B</span><span class="main">∧</span><span class="main">¬</span><span class="var">?C</span><span class="main">)</span> <span class="main">∨</span> <span class="main">(</span><span class="main">(</span><span class="main">¬</span><span class="var">?A</span><span class="main">∧</span><span class="var">?B</span><span class="main">∧</span><span class="main">¬</span><span class="var">?C</span><span class="main">)</span> <span class="main">∨</span> <span class="main">(</span><span class="main">¬</span><span class="var">?A</span><span class="main">∧</span><span class="main">¬</span><span class="var">?B</span><span class="main">∧</span><span class="var">?C</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">insert</span> xor_distr_L<span class="main"><span class="main">[</span></span><span class="operator">of</span> <span class="var"><span class="quoted"><span class="var">?A</span></span></span> <span class="var"><span class="quoted"><span class="var">?B</span></span></span> <span class="var"><span class="quoted"><span class="var">?C</span></span></span><span class="main"><span class="main">]</span></span><span class="main"><span class="keyword3">,</span></span> <span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span>elimmeets<span class="main">)</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">∈</span> ov <span class="main">∪</span> f<span class="main">^-1</span> <span class="main">∪</span> d<span class="main">^-1</span>"</span></span>
    <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">elim</span> disjE<span class="main">)</span>
      <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="var">?A</span><span class="main">∧</span><span class="main">¬</span><span class="var">?B</span><span class="main">∧</span><span class="main">¬</span><span class="var">?C</span>"</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="var"><span class="quoted"><span class="var">?A</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
        <span class="keyword1"><span class="command">with</span></span> kp kplp lpq qvp klp <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">p</span><span class="main">,</span><span class="skolem">q</span><span class="main">)</span> <span class="main">∈</span> f<span class="main">^-1</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> f <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
        <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> x <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span><span class="keyword1"><span class="command">}</span></span>
      <span class="keyword1"><span class="command">next</span></span>
      <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span><span class="var">?A</span><span class="main">∧</span><span class="var">?B</span><span class="main">∧</span><span class="main">¬</span><span class="var">?C</span>"</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="var"><span class="quoted"><span class="var">?B</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span> 
        <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">t</span></span> <span class="keyword2"><span class="keyword">where</span></span> pt<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">p</span><span class="main">∥</span><span class="skolem">t</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> tvp<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">t</span><span class="main">∥</span><span class="skolem">v'</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword1"><span class="command">from</span></span> pt pv uv <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">u</span><span class="main">∥</span><span class="skolem">t</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> M1 <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
        <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> cup zup zu <span class="keyword1"><span class="command">have</span></span> cu<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">c</span><span class="main">∥</span><span class="skolem">u</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> M1 <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">cu</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">l'</span><span class="main">∥</span><span class="skolem">cu</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">cu</span><span class="main">∥</span><span class="skolem">t</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> lpc M5exist_var <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
        <span class="keyword1"><span class="command">with</span></span> kp pt tvp klp lpq qvp <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">p</span><span class="main">,</span><span class="skolem">q</span><span class="main">)</span> <span class="main">∈</span> ov"</span></span> <span class="keyword1"><span class="command">using</span></span> ov <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
        <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> x <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span><span class="keyword1"><span class="command">}</span></span>
      <span class="keyword1"><span class="command">next</span></span>
      <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span><span class="var">?A</span> <span class="main">∧</span> <span class="main">¬</span><span class="var">?B</span> <span class="main">∧</span> <span class="var">?C</span>"</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="var"><span class="quoted"><span class="var">?C</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
        <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">t</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">q</span><span class="main">∥</span><span class="skolem">t</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">t</span><span class="main">∥</span><span class="skolem">v</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword1"><span class="command">with</span></span> kp klp lpq pv <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">p</span><span class="main">,</span><span class="skolem">q</span><span class="main">)</span><span class="main">∈</span>d<span class="main">^-1</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> d <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
        <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> x <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span><span class="keyword1"><span class="command">}</span></span>
      <span class="keyword1"><span class="command">qed</span></span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">lemma</span></span> covim<span class="main">:</span><span class="quoted"><span class="quoted">"ov<span class="main">^-1</span> <span class="keyword1">O</span> m <span class="main">⊆</span> ov <span class="main">∪</span> f<span class="main">^-1</span> <span class="main">∪</span> d<span class="main">^-1</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span>
    <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">x</span><span class="main">::</span><span class="quoted"><span class="quoted">"<span class="tfree">'a</span><span class="main">×</span><span class="tfree">'a</span>"</span></span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">∈</span> ov<span class="main">^-1</span> <span class="keyword1">O</span> m"</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">p</span></span> <span class="skolem"><span class="skolem">q</span></span> <span class="skolem"><span class="skolem">z</span></span> <span class="keyword2"><span class="keyword">where</span></span> x<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">=</span> <span class="main">(</span><span class="skolem">p</span><span class="main">,</span><span class="skolem">q</span><span class="main">)</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">p</span><span class="main">,</span><span class="skolem">z</span><span class="main">)</span> <span class="main">∈</span> ov<span class="main">^-1</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">z</span><span class="main">,</span><span class="skolem">q</span><span class="main">)</span> <span class="main">∈</span> m"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="main">(</span><span class="skolem">p</span><span class="main">,</span><span class="skolem">z</span><span class="main">)</span> <span class="main">∈</span> ov<span class="main">^-1</span>›</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">k</span></span> <span class="skolem"><span class="skolem">l</span></span> <span class="skolem"><span class="skolem">c</span></span> <span class="skolem"><span class="skolem">u</span></span> <span class="skolem"><span class="skolem">v</span></span>  <span class="keyword2"><span class="keyword">where</span></span> kz<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">k</span><span class="main">∥</span><span class="skolem">z</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> zu<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">z</span><span class="main">∥</span><span class="skolem">u</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> kl<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">k</span><span class="main">∥</span><span class="skolem">l</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> lp<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">l</span><span class="main">∥</span><span class="skolem">p</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> lc<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">l</span><span class="main">∥</span><span class="skolem">c</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> cu<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">c</span><span class="main">∥</span><span class="skolem">u</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> pv<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">p</span><span class="main">∥</span><span class="skolem">v</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> uv<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">u</span><span class="main">∥</span><span class="skolem">v</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> ov <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
    <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="main">(</span><span class="skolem">z</span><span class="main">,</span><span class="skolem">q</span><span class="main">)</span> <span class="main">∈</span> m›</span></span>  <span class="keyword1"><span class="command">have</span></span> zq<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">z</span><span class="main">∥</span><span class="skolem">q</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> m <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">v'</span></span> <span class="keyword2"><span class="keyword">where</span></span> qvp<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">q</span><span class="main">∥</span><span class="skolem">v'</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> M3 meets_wd zq <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
    <span class="keyword1"><span class="command">from</span></span> zu zq cu <span class="keyword1"><span class="command">have</span></span> cq<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">c</span><span class="main">∥</span><span class="skolem">q</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> M1 <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
    <span class="keyword1"><span class="command">from</span></span> pv qvp <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">p</span><span class="main">∥</span><span class="skolem">v'</span> <span class="main">⊕</span> <span class="main">(</span><span class="main">(</span><span class="main">∃</span><span class="bound">t</span><span class="main">.</span> <span class="skolem">p</span><span class="main">∥</span><span class="bound">t</span> <span class="main">∧</span> <span class="bound">t</span><span class="main">∥</span><span class="skolem">v'</span><span class="main">)</span> <span class="main">⊕</span> <span class="main">(</span><span class="main">∃</span><span class="bound">t</span><span class="main">.</span> <span class="skolem">q</span><span class="main">∥</span><span class="bound">t</span> <span class="main">∧</span> <span class="bound">t</span><span class="main">∥</span><span class="skolem">v</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">is</span></span> <span class="quoted"><span class="quoted">"<span class="var">?A</span> <span class="main">⊕</span> <span class="main">(</span><span class="var">?B</span> <span class="main">⊕</span> <span class="var">?C</span><span class="main">)</span>"</span></span><span class="main">)</span> <span class="keyword1"><span class="command">using</span></span> M2 <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="var">?A</span><span class="main">∧</span><span class="main">¬</span><span class="var">?B</span><span class="main">∧</span><span class="main">¬</span><span class="var">?C</span><span class="main">)</span> <span class="main">∨</span> <span class="main">(</span><span class="main">(</span><span class="main">¬</span><span class="var">?A</span><span class="main">∧</span><span class="var">?B</span><span class="main">∧</span><span class="main">¬</span><span class="var">?C</span><span class="main">)</span> <span class="main">∨</span> <span class="main">(</span><span class="main">¬</span><span class="var">?A</span><span class="main">∧</span><span class="main">¬</span><span class="var">?B</span><span class="main">∧</span><span class="var">?C</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">insert</span> xor_distr_L<span class="main"><span class="main">[</span></span><span class="operator">of</span> <span class="var"><span class="quoted"><span class="var">?A</span></span></span> <span class="var"><span class="quoted"><span class="var">?B</span></span></span> <span class="var"><span class="quoted"><span class="var">?C</span></span></span><span class="main"><span class="main">]</span></span><span class="main"><span class="keyword3">,</span></span> <span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span>elimmeets<span class="main">)</span>
    <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">∈</span> ov <span class="main">∪</span> f<span class="main">^-1</span> <span class="main">∪</span> d<span class="main">^-1</span>"</span></span>
    <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">elim</span> disjE<span class="main">)</span>
      <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="var">?A</span><span class="main">∧</span><span class="main">¬</span><span class="var">?B</span><span class="main">∧</span><span class="main">¬</span><span class="var">?C</span>"</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="var"><span class="quoted"><span class="var">?A</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
        <span class="keyword1"><span class="command">with</span></span> lp lc cq qvp <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">p</span><span class="main">,</span><span class="skolem">q</span><span class="main">)</span> <span class="main">∈</span> f<span class="main">^-1</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> f <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
        <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> x <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span><span class="keyword1"><span class="command">}</span></span>
      <span class="keyword1"><span class="command">next</span></span>
      <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span><span class="var">?A</span><span class="main">∧</span><span class="var">?B</span><span class="main">∧</span><span class="main">¬</span><span class="var">?C</span>"</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="var"><span class="quoted"><span class="var">?B</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span> 
        <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">t</span></span> <span class="keyword2"><span class="keyword">where</span></span> ptp<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">p</span><span class="main">∥</span><span class="skolem">t</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">t</span><span class="main">∥</span><span class="skolem">v'</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command"><span class="improper">with</span></span></span> pv uv <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">u</span><span class="main">∥</span><span class="skolem">t</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> M1 <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
        <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">p</span><span class="main">,</span><span class="skolem">q</span><span class="main">)</span><span class="main">∈</span> ov"</span></span> <span class="keyword1"><span class="command">using</span></span> lp lc cq qvp cu ov <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
        <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> x <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span><span class="keyword1"><span class="command">}</span></span>        
     <span class="keyword1"><span class="command">next</span></span>
      <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span><span class="var">?A</span> <span class="main">∧</span> <span class="main">¬</span><span class="var">?B</span> <span class="main">∧</span> <span class="var">?C</span>"</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="var"><span class="quoted"><span class="var">?C</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
        <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">t</span></span> <span class="keyword2"><span class="keyword">where</span></span> qt<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">q</span><span class="main">∥</span><span class="skolem">t</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">t</span><span class="main">∥</span><span class="skolem">v</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword1"><span class="command">with</span></span> lp lc cq pv <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">p</span><span class="main">,</span><span class="skolem">q</span><span class="main">)</span> <span class="main">∈</span> d<span class="main">^-1</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> d <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span> 
        <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> x <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span><span class="keyword1"><span class="command">}</span></span>
      <span class="keyword1"><span class="command">qed</span></span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="comment1">(* =========$\alpha_3$ compositions========== *)</span>
<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹We prove compositions of the form $r_1 \circ r_2 \subseteq b \cup m \cup ov$.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> covov<span class="main">:</span><span class="quoted"><span class="quoted">"ov <span class="keyword1">O</span> ov <span class="main">⊆</span> b <span class="main">∪</span> m <span class="main">∪</span> ov"</span></span>
<span class="keyword1"><span class="command">proof</span></span>
   <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">x</span><span class="main">::</span><span class="quoted"><span class="quoted">"<span class="tfree">'a</span><span class="main">×</span><span class="tfree">'a</span>"</span></span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">∈</span> ov <span class="keyword1">O</span> ov"</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">p</span></span> <span class="skolem"><span class="skolem">q</span></span> <span class="skolem"><span class="skolem">z</span></span> <span class="keyword2"><span class="keyword">where</span></span> x<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">=</span> <span class="main">(</span><span class="skolem">p</span><span class="main">,</span><span class="skolem">q</span><span class="main">)</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">p</span><span class="main">,</span><span class="skolem">z</span><span class="main">)</span> <span class="main">∈</span> ov"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">z</span><span class="main">,</span><span class="skolem">q</span><span class="main">)</span><span class="main">∈</span> ov"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
   <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="main">(</span><span class="skolem">p</span><span class="main">,</span><span class="skolem">z</span><span class="main">)</span> <span class="main">∈</span> ov›</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">k</span></span> <span class="skolem"><span class="skolem">u</span></span> <span class="skolem"><span class="skolem">l</span></span> <span class="skolem"><span class="skolem">t</span></span> <span class="skolem"><span class="skolem">v</span></span> <span class="keyword2"><span class="keyword">where</span></span> kp<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">k</span><span class="main">∥</span><span class="skolem">p</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> pu<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">p</span><span class="main">∥</span><span class="skolem">u</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> kl<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">k</span><span class="main">∥</span><span class="skolem">l</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> lz<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">l</span><span class="main">∥</span><span class="skolem">z</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">l</span><span class="main">∥</span><span class="skolem">t</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">t</span><span class="main">∥</span><span class="skolem">u</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> uv<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">u</span><span class="main">∥</span><span class="skolem">v</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> zv<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">z</span><span class="main">∥</span><span class="skolem">v</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> ov <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
   <span class="keyword1"><span class="command">from</span></span>  <span class="quoted"><span class="quoted">‹<span class="main">(</span><span class="skolem">z</span><span class="main">,</span><span class="skolem">q</span><span class="main">)</span> <span class="main">∈</span> ov›</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">k'</span></span> <span class="skolem"><span class="skolem">l'</span></span> <span class="skolem"><span class="skolem">y</span></span> <span class="skolem"><span class="skolem">u'</span></span> <span class="skolem"><span class="skolem">v'</span></span> <span class="keyword2"><span class="keyword">where</span></span> kplp<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">k'</span><span class="main">∥</span><span class="skolem">l'</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> kpz<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">k'</span><span class="main">∥</span><span class="skolem">z</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> lpq<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">l'</span><span class="main">∥</span><span class="skolem">q</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> lpy<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">l'</span><span class="main">∥</span><span class="skolem">y</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">y</span><span class="main">∥</span><span class="skolem">u'</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> zup<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">z</span><span class="main">∥</span><span class="skolem">u'</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> upvp<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">u'</span><span class="main">∥</span><span class="skolem">v'</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> qvp<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">q</span><span class="main">∥</span><span class="skolem">v'</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> ov <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
   <span class="keyword1"><span class="command">from</span></span> lz kplp kpz <span class="keyword1"><span class="command">have</span></span> llp<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">l</span><span class="main">∥</span><span class="skolem">l'</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> M1 <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
   <span class="keyword1"><span class="command">from</span></span> uv zv zup <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">u</span><span class="main">∥</span><span class="skolem">u'</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> M1 <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
   <span class="keyword1"><span class="command">with</span></span> pu upvp <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">uu</span></span> <span class="keyword2"><span class="keyword">where</span></span> puu<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">p</span><span class="main">∥</span><span class="skolem">uu</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> uuv<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">uu</span><span class="main">∥</span><span class="skolem">v'</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> M5exist_var <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
   <span class="keyword1"><span class="command">from</span></span> puu lpq <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">p</span><span class="main">∥</span><span class="skolem">q</span> <span class="main">⊕</span> <span class="main">(</span><span class="main">(</span><span class="main">∃</span><span class="bound">t'</span><span class="main">.</span> <span class="skolem">p</span><span class="main">∥</span><span class="bound">t'</span> <span class="main">∧</span> <span class="bound">t'</span><span class="main">∥</span><span class="skolem">q</span><span class="main">)</span> <span class="main">⊕</span> <span class="main">(</span><span class="main">∃</span><span class="bound">t'</span><span class="main">.</span> <span class="skolem">l'</span><span class="main">∥</span><span class="bound">t'</span> <span class="main">∧</span> <span class="bound">t'</span><span class="main">∥</span><span class="skolem">uu</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">is</span></span> <span class="quoted"><span class="quoted">"<span class="var">?A</span> <span class="main">⊕</span> <span class="main">(</span><span class="var">?B</span> <span class="main">⊕</span> <span class="var">?C</span><span class="main">)</span>"</span></span><span class="main">)</span> <span class="keyword1"><span class="command">using</span></span> M2 <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="var">?A</span><span class="main">∧</span><span class="main">¬</span><span class="var">?B</span><span class="main">∧</span><span class="main">¬</span><span class="var">?C</span><span class="main">)</span> <span class="main">∨</span> <span class="main">(</span><span class="main">(</span><span class="main">¬</span><span class="var">?A</span><span class="main">∧</span><span class="var">?B</span><span class="main">∧</span><span class="main">¬</span><span class="var">?C</span><span class="main">)</span> <span class="main">∨</span> <span class="main">(</span><span class="main">¬</span><span class="var">?A</span><span class="main">∧</span><span class="main">¬</span><span class="var">?B</span><span class="main">∧</span><span class="var">?C</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">insert</span> xor_distr_L<span class="main"><span class="main">[</span></span><span class="operator">of</span> <span class="var"><span class="quoted"><span class="var">?A</span></span></span> <span class="var"><span class="quoted"><span class="var">?B</span></span></span> <span class="var"><span class="quoted"><span class="var">?C</span></span></span><span class="main"><span class="main">]</span></span><span class="main"><span class="keyword3">,</span></span> <span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span>elimmeets<span class="main">)</span>
    <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">∈</span> b <span class="main">∪</span> m <span class="main">∪</span> ov"</span></span>
    <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">elim</span> disjE<span class="main">)</span>
      <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="var">?A</span><span class="main">∧</span><span class="main">¬</span><span class="var">?B</span><span class="main">∧</span><span class="main">¬</span><span class="var">?C</span>"</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="var"><span class="quoted"><span class="var">?A</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
        <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">p</span><span class="main">,</span><span class="skolem">q</span><span class="main">)</span> <span class="main">∈</span> m"</span></span> <span class="keyword1"><span class="command">using</span></span> m <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> x <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span><span class="keyword1"><span class="command">}</span></span>
      <span class="keyword1"><span class="command">next</span></span>
      <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span><span class="var">?A</span><span class="main">∧</span><span class="var">?B</span><span class="main">∧</span><span class="main">¬</span><span class="var">?C</span>"</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="var"><span class="quoted"><span class="var">?B</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span> 
        <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">p</span><span class="main">,</span><span class="skolem">q</span><span class="main">)</span> <span class="main">∈</span> b"</span></span> <span class="keyword1"><span class="command">using</span></span> b <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> x <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span><span class="keyword1"><span class="command">}</span></span>
     <span class="keyword1"><span class="command">next</span></span>
      <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span><span class="var">?A</span> <span class="main">∧</span> <span class="main">¬</span><span class="var">?B</span> <span class="main">∧</span> <span class="var">?C</span>"</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="var"><span class="quoted"><span class="var">?C</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
        <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">t'</span></span> <span class="keyword2"><span class="keyword">where</span></span> lptp<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">l'</span><span class="main">∥</span><span class="skolem">t'</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">t'</span><span class="main">∥</span><span class="skolem">uu</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword1"><span class="command">from</span></span> kl llp lpq <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">ll</span></span> <span class="keyword2"><span class="keyword">where</span></span>  kll<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">k</span><span class="main">∥</span><span class="skolem">ll</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> llq<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">ll</span><span class="main">∥</span><span class="skolem">q</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> M5exist_var <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
        <span class="keyword1"><span class="command">with</span></span> lpq lptp  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">ll</span><span class="main">∥</span><span class="skolem">t'</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> M1 <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
        <span class="keyword1"><span class="command">with</span></span> kp puu uuv kll llq qvp <span class="quoted"><span class="quoted">‹<span class="skolem">t'</span><span class="main">∥</span><span class="skolem">uu</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">p</span><span class="main">,</span><span class="skolem">q</span><span class="main">)</span> <span class="main">∈</span> ov"</span></span> <span class="keyword1"><span class="command">using</span></span> ov <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
        <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> x <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span><span class="keyword1"><span class="command">}</span></span>
      <span class="keyword1"><span class="command">qed</span></span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">lemma</span></span> covfi<span class="main">:</span><span class="quoted"><span class="quoted">"ov <span class="keyword1">O</span> f<span class="main">^-1</span> <span class="main">⊆</span> b <span class="main">∪</span> m <span class="main">∪</span> ov"</span></span>
<span class="keyword1"><span class="command">proof</span></span>
   <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">x</span><span class="main">::</span><span class="quoted"><span class="quoted">"<span class="tfree">'a</span><span class="main">×</span><span class="tfree">'a</span>"</span></span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">∈</span> ov <span class="keyword1">O</span> f<span class="main">^-1</span>"</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">p</span></span> <span class="skolem"><span class="skolem">q</span></span> <span class="skolem"><span class="skolem">z</span></span> <span class="keyword2"><span class="keyword">where</span></span> x<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">=</span> <span class="main">(</span><span class="skolem">p</span><span class="main">,</span><span class="skolem">q</span><span class="main">)</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">p</span><span class="main">,</span><span class="skolem">z</span><span class="main">)</span> <span class="main">∈</span> ov"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">z</span><span class="main">,</span><span class="skolem">q</span><span class="main">)</span><span class="main">∈</span> f<span class="main">^-1</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
   <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="main">(</span><span class="skolem">p</span><span class="main">,</span><span class="skolem">z</span><span class="main">)</span> <span class="main">∈</span> ov›</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">k</span></span> <span class="skolem"><span class="skolem">u</span></span> <span class="skolem"><span class="skolem">l</span></span> <span class="skolem"><span class="skolem">c</span></span> <span class="skolem"><span class="skolem">v</span></span> <span class="keyword2"><span class="keyword">where</span></span> kp<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">k</span><span class="main">∥</span><span class="skolem">p</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> pu<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">p</span><span class="main">∥</span><span class="skolem">u</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> kl<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">k</span><span class="main">∥</span><span class="skolem">l</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> lz<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">l</span><span class="main">∥</span><span class="skolem">z</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">l</span><span class="main">∥</span><span class="skolem">c</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">c</span><span class="main">∥</span><span class="skolem">u</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> uv<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">u</span><span class="main">∥</span><span class="skolem">v</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> zv<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">z</span><span class="main">∥</span><span class="skolem">v</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> ov <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
   <span class="keyword1"><span class="command">from</span></span>  <span class="quoted"><span class="quoted">‹<span class="main">(</span><span class="skolem">z</span><span class="main">,</span><span class="skolem">q</span><span class="main">)</span> <span class="main">∈</span> f<span class="main">^-1</span>›</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">k'</span></span> <span class="skolem"><span class="skolem">l'</span></span> <span class="skolem"><span class="skolem">v'</span></span>  <span class="keyword2"><span class="keyword">where</span></span> kplp<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">k'</span><span class="main">∥</span><span class="skolem">l'</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> kpz<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">k'</span><span class="main">∥</span><span class="skolem">z</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> lpq<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">l'</span><span class="main">∥</span><span class="skolem">q</span>"</span></span>  <span class="keyword2"><span class="keyword">and</span></span> qvp<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">q</span><span class="main">∥</span><span class="skolem">v'</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> zvp<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">z</span><span class="main">∥</span><span class="skolem">v'</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> f <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
   <span class="keyword1"><span class="command">from</span></span> lz kplp kpz <span class="keyword1"><span class="command">have</span></span> llp<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">l</span><span class="main">∥</span><span class="skolem">l'</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> M1 <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
   <span class="keyword1"><span class="command">from</span></span>  zv qvp zvp <span class="keyword1"><span class="command">have</span></span> qv<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">q</span><span class="main">∥</span><span class="skolem">v</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> M1 <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
   <span class="keyword1"><span class="command">from</span></span> pu lpq <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">p</span><span class="main">∥</span><span class="skolem">q</span> <span class="main">⊕</span> <span class="main">(</span><span class="main">(</span><span class="main">∃</span><span class="bound">t</span><span class="main">.</span> <span class="skolem">p</span><span class="main">∥</span><span class="bound">t</span> <span class="main">∧</span> <span class="bound">t</span><span class="main">∥</span><span class="skolem">q</span><span class="main">)</span> <span class="main">⊕</span> <span class="main">(</span><span class="main">∃</span><span class="bound">t</span><span class="main">.</span> <span class="skolem">l'</span><span class="main">∥</span><span class="bound">t</span> <span class="main">∧</span> <span class="bound">t</span><span class="main">∥</span><span class="skolem">u</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">is</span></span> <span class="quoted"><span class="quoted">"<span class="var">?A</span> <span class="main">⊕</span> <span class="main">(</span><span class="var">?B</span> <span class="main">⊕</span> <span class="var">?C</span><span class="main">)</span>"</span></span><span class="main">)</span> <span class="keyword1"><span class="command">using</span></span> M2 <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="var">?A</span><span class="main">∧</span><span class="main">¬</span><span class="var">?B</span><span class="main">∧</span><span class="main">¬</span><span class="var">?C</span><span class="main">)</span> <span class="main">∨</span> <span class="main">(</span><span class="main">(</span><span class="main">¬</span><span class="var">?A</span><span class="main">∧</span><span class="var">?B</span><span class="main">∧</span><span class="main">¬</span><span class="var">?C</span><span class="main">)</span> <span class="main">∨</span> <span class="main">(</span><span class="main">¬</span><span class="var">?A</span><span class="main">∧</span><span class="main">¬</span><span class="var">?B</span><span class="main">∧</span><span class="var">?C</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">insert</span> xor_distr_L<span class="main"><span class="main">[</span></span><span class="operator">of</span> <span class="var"><span class="quoted"><span class="var">?A</span></span></span> <span class="var"><span class="quoted"><span class="var">?B</span></span></span> <span class="var"><span class="quoted"><span class="var">?C</span></span></span><span class="main"><span class="main">]</span></span><span class="main"><span class="keyword3">,</span></span> <span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span>elimmeets<span class="main">)</span>
    <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">∈</span> b <span class="main">∪</span> m <span class="main">∪</span> ov"</span></span>
    <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">elim</span> disjE<span class="main">)</span>
      <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="var">?A</span><span class="main">∧</span><span class="main">¬</span><span class="var">?B</span><span class="main">∧</span><span class="main">¬</span><span class="var">?C</span>"</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="var"><span class="quoted"><span class="var">?A</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
        <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">p</span><span class="main">,</span><span class="skolem">q</span><span class="main">)</span> <span class="main">∈</span> m"</span></span> <span class="keyword1"><span class="command">using</span></span> m <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> x <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span><span class="keyword1"><span class="command">}</span></span>
      <span class="keyword1"><span class="command">next</span></span>
      <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span><span class="var">?A</span><span class="main">∧</span><span class="var">?B</span><span class="main">∧</span><span class="main">¬</span><span class="var">?C</span>"</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="var"><span class="quoted"><span class="var">?B</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span> 
        <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">p</span><span class="main">,</span><span class="skolem">q</span><span class="main">)</span> <span class="main">∈</span> b"</span></span> <span class="keyword1"><span class="command">using</span></span> b <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> x <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span><span class="keyword1"><span class="command">}</span></span>
     <span class="keyword1"><span class="command">next</span></span>
      <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span><span class="var">?A</span> <span class="main">∧</span> <span class="main">¬</span><span class="var">?B</span> <span class="main">∧</span> <span class="var">?C</span>"</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="var"><span class="quoted"><span class="var">?C</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
        <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">t</span></span> <span class="keyword2"><span class="keyword">where</span></span> lptp<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">l'</span><span class="main">∥</span><span class="skolem">t</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">t</span><span class="main">∥</span><span class="skolem">u</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword1"><span class="command">from</span></span> kl llp lpq <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">ll</span></span> <span class="keyword2"><span class="keyword">where</span></span>  kll<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">k</span><span class="main">∥</span><span class="skolem">ll</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> llr<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">ll</span><span class="main">∥</span><span class="skolem">q</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> M5exist_var <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
        <span class="keyword1"><span class="command">with</span></span> lpq lptp  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">ll</span><span class="main">∥</span><span class="skolem">t</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> M1 <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
        <span class="keyword1"><span class="command">with</span></span> kp pu uv kll llr qv <span class="quoted"><span class="quoted">‹<span class="skolem">t</span><span class="main">∥</span><span class="skolem">u</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">p</span><span class="main">,</span><span class="skolem">q</span><span class="main">)</span> <span class="main">∈</span> ov"</span></span> <span class="keyword1"><span class="command">using</span></span> ov <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
        <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> x <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span><span class="keyword1"><span class="command">}</span></span>
      <span class="keyword1"><span class="command">qed</span></span>
<span class="keyword1"><span class="command">qed</span></span>


<span class="keyword1"><span class="command">lemma</span></span> csov<span class="main">:</span><span class="quoted"><span class="quoted">"s <span class="keyword1">O</span> ov <span class="main">⊆</span> b <span class="main">∪</span> m <span class="main">∪</span> ov"</span></span>
<span class="keyword1"><span class="command">proof</span></span>
   <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">x</span><span class="main">::</span><span class="quoted"><span class="quoted">"<span class="tfree">'a</span><span class="main">×</span><span class="tfree">'a</span>"</span></span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">∈</span> s <span class="keyword1">O</span> ov"</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">p</span></span> <span class="skolem"><span class="skolem">q</span></span> <span class="skolem"><span class="skolem">z</span></span> <span class="keyword2"><span class="keyword">where</span></span> x<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">=</span> <span class="main">(</span><span class="skolem">p</span><span class="main">,</span><span class="skolem">q</span><span class="main">)</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">p</span><span class="main">,</span><span class="skolem">z</span><span class="main">)</span> <span class="main">∈</span> s"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">z</span><span class="main">,</span><span class="skolem">q</span><span class="main">)</span><span class="main">∈</span> ov"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
   <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="main">(</span><span class="skolem">p</span><span class="main">,</span><span class="skolem">z</span><span class="main">)</span> <span class="main">∈</span> s›</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">k</span></span> <span class="skolem"><span class="skolem">u</span></span> <span class="skolem"><span class="skolem">v</span></span> <span class="keyword2"><span class="keyword">where</span></span> kp<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">k</span><span class="main">∥</span><span class="skolem">p</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> kz<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">k</span><span class="main">∥</span><span class="skolem">z</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span>  pu<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">p</span><span class="main">∥</span><span class="skolem">u</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> uv<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">u</span><span class="main">∥</span><span class="skolem">v</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> zv<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">z</span><span class="main">∥</span><span class="skolem">v</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> s <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
   <span class="keyword1"><span class="command">from</span></span>  <span class="quoted"><span class="quoted">‹<span class="main">(</span><span class="skolem">z</span><span class="main">,</span><span class="skolem">q</span><span class="main">)</span> <span class="main">∈</span> ov›</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">k'</span></span> <span class="skolem"><span class="skolem">l'</span></span>  <span class="skolem"><span class="skolem">u'</span></span> <span class="skolem"><span class="skolem">v'</span></span>   <span class="keyword2"><span class="keyword">where</span></span> kpz<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">k'</span><span class="main">∥</span><span class="skolem">z</span>"</span></span>  <span class="keyword2"><span class="keyword">and</span></span> kplp<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">k'</span><span class="main">∥</span><span class="skolem">l'</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> lpq<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">l'</span><span class="main">∥</span><span class="skolem">q</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> zup<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">z</span><span class="main">∥</span><span class="skolem">u'</span>"</span></span>  <span class="keyword2"><span class="keyword">and</span></span> qvp<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">q</span><span class="main">∥</span><span class="skolem">v'</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> upvp<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">u'</span><span class="main">∥</span><span class="skolem">v'</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> ov <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
   <span class="keyword1"><span class="command">from</span></span>  kz kpz kplp <span class="keyword1"><span class="command">have</span></span> klp<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">k</span><span class="main">∥</span><span class="skolem">l'</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> M1 <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
   <span class="keyword1"><span class="command">from</span></span>  uv zv zup  <span class="keyword1"><span class="command">have</span></span> uup<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">u</span><span class="main">∥</span><span class="skolem">u'</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> M1 <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
   <span class="keyword1"><span class="command">with</span></span> pu upvp <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">uu</span></span> <span class="keyword2"><span class="keyword">where</span></span> puu<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">p</span><span class="main">∥</span><span class="skolem">uu</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> uuvp<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">uu</span><span class="main">∥</span><span class="skolem">v'</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> M5exist_var <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
   <span class="keyword1"><span class="command">from</span></span> pu lpq <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">p</span><span class="main">∥</span><span class="skolem">q</span> <span class="main">⊕</span> <span class="main">(</span><span class="main">(</span><span class="main">∃</span><span class="bound">t</span><span class="main">.</span> <span class="skolem">p</span><span class="main">∥</span><span class="bound">t</span> <span class="main">∧</span> <span class="bound">t</span><span class="main">∥</span><span class="skolem">q</span><span class="main">)</span> <span class="main">⊕</span> <span class="main">(</span><span class="main">∃</span><span class="bound">t</span><span class="main">.</span> <span class="skolem">l'</span><span class="main">∥</span><span class="bound">t</span> <span class="main">∧</span> <span class="bound">t</span><span class="main">∥</span><span class="skolem">u</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">is</span></span> <span class="quoted"><span class="quoted">"<span class="var">?A</span> <span class="main">⊕</span> <span class="main">(</span><span class="var">?B</span> <span class="main">⊕</span> <span class="var">?C</span><span class="main">)</span>"</span></span><span class="main">)</span> <span class="keyword1"><span class="command">using</span></span> M2 <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
   <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="var">?A</span><span class="main">∧</span><span class="main">¬</span><span class="var">?B</span><span class="main">∧</span><span class="main">¬</span><span class="var">?C</span><span class="main">)</span> <span class="main">∨</span> <span class="main">(</span><span class="main">(</span><span class="main">¬</span><span class="var">?A</span><span class="main">∧</span><span class="var">?B</span><span class="main">∧</span><span class="main">¬</span><span class="var">?C</span><span class="main">)</span> <span class="main">∨</span> <span class="main">(</span><span class="main">¬</span><span class="var">?A</span><span class="main">∧</span><span class="main">¬</span><span class="var">?B</span><span class="main">∧</span><span class="var">?C</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">insert</span> xor_distr_L<span class="main"><span class="main">[</span></span><span class="operator">of</span> <span class="var"><span class="quoted"><span class="var">?A</span></span></span> <span class="var"><span class="quoted"><span class="var">?B</span></span></span> <span class="var"><span class="quoted"><span class="var">?C</span></span></span><span class="main"><span class="main">]</span></span><span class="main"><span class="keyword3">,</span></span> <span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span>elimmeets<span class="main">)</span>
   <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">∈</span> b <span class="main">∪</span> m <span class="main">∪</span> ov"</span></span>
   <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">elim</span> disjE<span class="main">)</span>
      <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="var">?A</span><span class="main">∧</span><span class="main">¬</span><span class="var">?B</span><span class="main">∧</span><span class="main">¬</span><span class="var">?C</span>"</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="var"><span class="quoted"><span class="var">?A</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
        <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">p</span><span class="main">,</span><span class="skolem">q</span><span class="main">)</span> <span class="main">∈</span> m"</span></span> <span class="keyword1"><span class="command">using</span></span> m <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> x <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span><span class="keyword1"><span class="command">}</span></span>
      <span class="keyword1"><span class="command">next</span></span>
      <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span><span class="var">?A</span><span class="main">∧</span><span class="var">?B</span><span class="main">∧</span><span class="main">¬</span><span class="var">?C</span>"</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="var"><span class="quoted"><span class="var">?B</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span> 
        <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">p</span><span class="main">,</span><span class="skolem">q</span><span class="main">)</span> <span class="main">∈</span> b"</span></span> <span class="keyword1"><span class="command">using</span></span> b <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> x <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span><span class="keyword1"><span class="command">}</span></span>
     <span class="keyword1"><span class="command">next</span></span>
      <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span><span class="var">?A</span> <span class="main">∧</span> <span class="main">¬</span><span class="var">?B</span> <span class="main">∧</span> <span class="var">?C</span>"</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="var"><span class="quoted"><span class="var">?C</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
        <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">t</span></span> <span class="keyword2"><span class="keyword">where</span></span> lpt<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">l'</span><span class="main">∥</span><span class="skolem">t</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">t</span><span class="main">∥</span><span class="skolem">u</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword1"><span class="command">with</span></span> pu puu <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">t</span><span class="main">∥</span><span class="skolem">uu</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> M1 <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
        <span class="keyword1"><span class="command">with</span></span> lpt kp puu uuvp klp lpq qvp  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">p</span><span class="main">,</span><span class="skolem">q</span><span class="main">)</span> <span class="main">∈</span> ov"</span></span> <span class="keyword1"><span class="command">using</span></span> ov <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
        <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> x <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span><span class="keyword1"><span class="command">}</span></span>
      <span class="keyword1"><span class="command">qed</span></span>
<span class="keyword1"><span class="command">qed</span></span>


<span class="keyword1"><span class="command">lemma</span></span> csfi<span class="main">:</span><span class="quoted"><span class="quoted">"s <span class="keyword1">O</span> f<span class="main">^-1</span> <span class="main">⊆</span> b <span class="main">∪</span> m <span class="main">∪</span> ov"</span></span>
<span class="keyword1"><span class="command">proof</span></span>
   <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">x</span><span class="main">::</span><span class="quoted"><span class="quoted">"<span class="tfree">'a</span><span class="main">×</span><span class="tfree">'a</span>"</span></span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">∈</span> s <span class="keyword1">O</span> f<span class="main">^-1</span>"</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">p</span></span> <span class="skolem"><span class="skolem">q</span></span> <span class="skolem"><span class="skolem">r</span></span> <span class="keyword2"><span class="keyword">where</span></span> x<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">=</span> <span class="main">(</span><span class="skolem">p</span><span class="main">,</span><span class="skolem">r</span><span class="main">)</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">p</span><span class="main">,</span><span class="skolem">q</span><span class="main">)</span> <span class="main">∈</span> s"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">q</span><span class="main">,</span><span class="skolem">r</span><span class="main">)</span><span class="main">∈</span> f<span class="main">^-1</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
   <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="main">(</span><span class="skolem">p</span><span class="main">,</span><span class="skolem">q</span><span class="main">)</span> <span class="main">∈</span> s›</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">k</span></span> <span class="skolem"><span class="skolem">u</span></span> <span class="skolem"><span class="skolem">v</span></span> <span class="keyword2"><span class="keyword">where</span></span> kp<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">k</span><span class="main">∥</span><span class="skolem">p</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> kq<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">k</span><span class="main">∥</span><span class="skolem">q</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span>  pu<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">p</span><span class="main">∥</span><span class="skolem">u</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> uv<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">u</span><span class="main">∥</span><span class="skolem">v</span>"</span></span>  <span class="keyword2"><span class="keyword">and</span></span> qv<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">q</span><span class="main">∥</span><span class="skolem">v</span>"</span></span>  <span class="keyword1"><span class="command">using</span></span> s <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
   <span class="keyword1"><span class="command">from</span></span>  <span class="quoted"><span class="quoted">‹<span class="main">(</span><span class="skolem">q</span><span class="main">,</span><span class="skolem">r</span><span class="main">)</span> <span class="main">∈</span> f<span class="main">^-1</span>›</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">k'</span></span> <span class="skolem"><span class="skolem">l</span></span>  <span class="skolem"><span class="skolem">v'</span></span>  <span class="keyword2"><span class="keyword">where</span></span> kpq<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">k'</span><span class="main">∥</span><span class="skolem">q</span>"</span></span>  <span class="keyword2"><span class="keyword">and</span></span> kpl<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">k'</span><span class="main">∥</span><span class="skolem">l</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> lr<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">l</span><span class="main">∥</span><span class="skolem">r</span>"</span></span>   <span class="keyword2"><span class="keyword">and</span></span> rvp<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">r</span><span class="main">∥</span><span class="skolem">v'</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> qvp<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">q</span><span class="main">∥</span><span class="skolem">v'</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> f <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
   <span class="keyword1"><span class="command">from</span></span> kpq kpl kq <span class="keyword1"><span class="command">have</span></span> kl<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">k</span><span class="main">∥</span><span class="skolem">l</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> M1 <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span> 
   <span class="keyword1"><span class="command">from</span></span> qvp qv uv <span class="keyword1"><span class="command">have</span></span> uvp<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">u</span><span class="main">∥</span><span class="skolem">v'</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> M1 <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
   <span class="keyword1"><span class="command">from</span></span> pu lr <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">p</span><span class="main">∥</span><span class="skolem">r</span> <span class="main">⊕</span> <span class="main">(</span><span class="main">(</span><span class="main">∃</span><span class="bound">t'</span><span class="main">.</span> <span class="skolem">p</span><span class="main">∥</span><span class="bound">t'</span> <span class="main">∧</span> <span class="bound">t'</span><span class="main">∥</span><span class="skolem">r</span><span class="main">)</span> <span class="main">⊕</span> <span class="main">(</span><span class="main">∃</span><span class="bound">t'</span><span class="main">.</span> <span class="skolem">l</span><span class="main">∥</span><span class="bound">t'</span> <span class="main">∧</span> <span class="bound">t'</span><span class="main">∥</span><span class="skolem">u</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">is</span></span> <span class="quoted"><span class="quoted">"<span class="var">?A</span> <span class="main">⊕</span> <span class="main">(</span><span class="var">?B</span> <span class="main">⊕</span> <span class="var">?C</span><span class="main">)</span>"</span></span><span class="main">)</span> <span class="keyword1"><span class="command">using</span></span> M2 <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
   <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="var">?A</span><span class="main">∧</span><span class="main">¬</span><span class="var">?B</span><span class="main">∧</span><span class="main">¬</span><span class="var">?C</span><span class="main">)</span> <span class="main">∨</span> <span class="main">(</span><span class="main">(</span><span class="main">¬</span><span class="var">?A</span><span class="main">∧</span><span class="var">?B</span><span class="main">∧</span><span class="main">¬</span><span class="var">?C</span><span class="main">)</span> <span class="main">∨</span> <span class="main">(</span><span class="main">¬</span><span class="var">?A</span><span class="main">∧</span><span class="main">¬</span><span class="var">?B</span><span class="main">∧</span><span class="var">?C</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">insert</span> xor_distr_L<span class="main"><span class="main">[</span></span><span class="operator">of</span> <span class="var"><span class="quoted"><span class="var">?A</span></span></span> <span class="var"><span class="quoted"><span class="var">?B</span></span></span> <span class="var"><span class="quoted"><span class="var">?C</span></span></span><span class="main"><span class="main">]</span></span><span class="main"><span class="keyword3">,</span></span> <span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span>elimmeets<span class="main">)</span>
   <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">∈</span> b <span class="main">∪</span> m <span class="main">∪</span> ov"</span></span>
   <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">elim</span> disjE<span class="main">)</span>
      <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="var">?A</span><span class="main">∧</span><span class="main">¬</span><span class="var">?B</span><span class="main">∧</span><span class="main">¬</span><span class="var">?C</span>"</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="var"><span class="quoted"><span class="var">?A</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
        <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">p</span><span class="main">,</span><span class="skolem">r</span><span class="main">)</span> <span class="main">∈</span> m"</span></span> <span class="keyword1"><span class="command">using</span></span> m <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> x <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span><span class="keyword1"><span class="command">}</span></span>
      <span class="keyword1"><span class="command">next</span></span>
      <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span><span class="var">?A</span><span class="main">∧</span><span class="var">?B</span><span class="main">∧</span><span class="main">¬</span><span class="var">?C</span>"</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="var"><span class="quoted"><span class="var">?B</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span> 
        <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">p</span><span class="main">,</span><span class="skolem">r</span><span class="main">)</span> <span class="main">∈</span> b"</span></span> <span class="keyword1"><span class="command">using</span></span> b <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> x <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span><span class="keyword1"><span class="command">}</span></span>
     <span class="keyword1"><span class="command">next</span></span>
      <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span><span class="var">?A</span> <span class="main">∧</span> <span class="main">¬</span><span class="var">?B</span> <span class="main">∧</span> <span class="var">?C</span>"</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="var"><span class="quoted"><span class="var">?C</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
        <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">t'</span></span> <span class="keyword2"><span class="keyword">where</span></span> ltp<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">l</span><span class="main">∥</span><span class="skolem">t'</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">t'</span><span class="main">∥</span><span class="skolem">u</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword1"><span class="command">with</span></span> kp pu uvp kl lr rvp <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">p</span><span class="main">,</span><span class="skolem">r</span><span class="main">)</span> <span class="main">∈</span> ov"</span></span> <span class="keyword1"><span class="command">using</span></span> ov <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
        <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> x <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span><span class="keyword1"><span class="command">}</span></span>
      <span class="keyword1"><span class="command">qed</span></span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="comment1">(* =========$\alpha_4$ compositions========== *)</span>
<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹We prove compositions of the form $r_1 \circ r_2 \subseteq f \cup f^{-1} \cup e$.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> cmmi<span class="main">:</span><span class="quoted"><span class="quoted">"m <span class="keyword1">O</span> m<span class="main">^-1</span> <span class="main">⊆</span> f <span class="main">∪</span> f<span class="main">^-1</span> <span class="main">∪</span> e"</span></span>
<span class="keyword1"><span class="command">proof</span></span> 
  <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">x</span><span class="main">::</span><span class="quoted"><span class="quoted">"<span class="tfree">'a</span><span class="main">×</span><span class="tfree">'a</span>"</span></span> <span class="keyword3"><span class="command">assume</span></span> a<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">∈</span> m <span class="keyword1">O</span> m<span class="main">^-1</span>"</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">p</span></span> <span class="skolem"><span class="skolem">q</span></span> <span class="skolem"><span class="skolem">z</span></span> <span class="keyword2"><span class="keyword">where</span></span> x<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">=</span><span class="main">(</span><span class="skolem">p</span><span class="main">,</span><span class="skolem">q</span><span class="main">)</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> 1<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">p</span><span class="main">,</span><span class="skolem">z</span><span class="main">)</span> <span class="main">∈</span> m"</span></span> <span class="keyword2"><span class="keyword">and</span></span> 2<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">z</span><span class="main">,</span><span class="skolem">q</span><span class="main">)</span> <span class="main">∈</span> m<span class="main">^-1</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> pz<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">p</span><span class="main">∥</span><span class="skolem">z</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> qz<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">q</span><span class="main">∥</span><span class="skolem">z</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> m <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">k</span></span> <span class="skolem"><span class="skolem">k'</span></span> <span class="keyword2"><span class="keyword">where</span></span> kp<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">k</span><span class="main">∥</span><span class="skolem">p</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> kpq<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">k'</span><span class="main">∥</span><span class="skolem">q</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> M3 meets_wd qz pz <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">from</span></span> kp kpq <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">k</span><span class="main">∥</span><span class="skolem">q</span> <span class="main">⊕</span> <span class="main">(</span><span class="main">(</span><span class="main">∃</span><span class="bound">t</span><span class="main">.</span> <span class="skolem">k</span><span class="main">∥</span><span class="bound">t</span> <span class="main">∧</span> <span class="bound">t</span><span class="main">∥</span><span class="skolem">q</span><span class="main">)</span> <span class="main">⊕</span> <span class="main">(</span><span class="main">∃</span><span class="bound">t</span><span class="main">.</span> <span class="skolem">k'</span><span class="main">∥</span><span class="bound">t</span> <span class="main">∧</span> <span class="bound">t</span><span class="main">∥</span><span class="skolem">p</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">is</span></span> <span class="quoted"><span class="quoted">"<span class="var">?A</span> <span class="main">⊕</span> <span class="main">(</span><span class="var">?B</span> <span class="main">⊕</span> <span class="var">?C</span><span class="main">)</span>"</span></span><span class="main">)</span> <span class="keyword1"><span class="command">using</span></span> M2 <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span> 
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="var">?A</span><span class="main">∧</span><span class="main">¬</span><span class="var">?B</span><span class="main">∧</span><span class="main">¬</span><span class="var">?C</span><span class="main">)</span><span class="main">∨</span><span class="main">(</span><span class="main">¬</span><span class="var">?A</span><span class="main">∧</span><span class="var">?B</span><span class="main">∧</span><span class="main">¬</span><span class="var">?C</span><span class="main">)</span><span class="main">∨</span><span class="main">(</span><span class="main">¬</span><span class="var">?A</span><span class="main">∧</span><span class="main">¬</span><span class="var">?B</span><span class="main">∧</span><span class="var">?C</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">insert</span> xor_distr_L<span class="main"><span class="main">[</span></span><span class="operator">of</span> <span class="var"><span class="quoted"><span class="var">?A</span></span></span> <span class="var"><span class="quoted"><span class="var">?B</span></span></span> <span class="var"><span class="quoted"><span class="var">?C</span></span></span><span class="main"><span class="main">]</span></span><span class="main"><span class="keyword3">,</span></span> <span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span>elimmeets<span class="main">)</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">∈</span>f <span class="main">∪</span> f<span class="main">^-1</span> <span class="main">∪</span> e"</span></span>    
  <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">elim</span> disjE<span class="main">)</span>
    <span class="keyword1"><span class="command">{</span></span><span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="var">?A</span><span class="main">∧</span><span class="main">¬</span><span class="var">?B</span><span class="main">∧</span><span class="main">¬</span><span class="var">?C</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="var">?A</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span> 
     <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">p</span> <span class="main">=</span> <span class="skolem">q</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> M4 kp pz qz <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span> 
     <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">p</span><span class="main">,</span><span class="skolem">q</span><span class="main">)</span> <span class="main">∈</span> e"</span></span> <span class="keyword1"><span class="command">using</span></span> e <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
     <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> x <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span> <span class="keyword1"><span class="command">}</span></span>
    <span class="keyword1"><span class="command">next</span></span>
    <span class="keyword1"><span class="command">{</span></span><span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">¬</span><span class="var">?A</span><span class="main">∧</span><span class="var">?B</span><span class="main">∧</span><span class="main">¬</span><span class="var">?C</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="var">?B</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
     <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">t</span></span> <span class="keyword2"><span class="keyword">where</span></span> kt<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">k</span><span class="main">∥</span><span class="skolem">t</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> tq<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">t</span><span class="main">∥</span><span class="skolem">q</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
     <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">p</span><span class="main">,</span><span class="skolem">q</span><span class="main">)</span> <span class="main">∈</span> f<span class="main">^-1</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> f qz pz kp <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
     <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> x <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span><span class="keyword1"><span class="command">}</span></span>
    <span class="keyword1"><span class="command">next</span></span>
    <span class="keyword1"><span class="command">{</span></span><span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">¬</span><span class="var">?A</span><span class="main">∧</span><span class="main">¬</span><span class="var">?B</span><span class="main">∧</span><span class="var">?C</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="var">?C</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
     <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">t</span></span> <span class="keyword2"><span class="keyword">where</span></span> kt<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">k'</span><span class="main">∥</span><span class="skolem">t</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> tp<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">t</span><span class="main">∥</span><span class="skolem">p</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
     <span class="keyword1"><span class="command">with</span></span> kpq pz qz <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">p</span><span class="main">,</span><span class="skolem">q</span><span class="main">)</span><span class="main">∈</span>f"</span></span> <span class="keyword1"><span class="command">using</span></span> f <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
     <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> x <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span><span class="keyword1"><span class="command">}</span></span>
  <span class="keyword1"><span class="command">qed</span></span>
<span class="keyword1"><span class="command">qed</span></span>
  

<span class="keyword1"><span class="command">lemma</span></span> cfif<span class="main">:</span><span class="quoted"><span class="quoted">"f<span class="main">^-1</span> <span class="keyword1">O</span> f <span class="main">⊆</span> e <span class="main">∪</span> f<span class="main">^-1</span> <span class="main">∪</span> f"</span></span>
<span class="keyword1"><span class="command">proof</span></span>
  <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">x</span><span class="main">::</span><span class="quoted"><span class="quoted">"<span class="tfree">'a</span><span class="main">×</span><span class="tfree">'a</span>"</span></span> <span class="keyword3"><span class="command">assume</span></span> a<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">∈</span> f<span class="main">^-1</span> <span class="keyword1">O</span> f"</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">p</span></span> <span class="skolem"><span class="skolem">q</span></span> <span class="skolem"><span class="skolem">z</span></span> <span class="keyword2"><span class="keyword">where</span></span> x<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">=</span><span class="main">(</span><span class="skolem">p</span><span class="main">,</span><span class="skolem">q</span><span class="main">)</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> 1<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">p</span><span class="main">,</span><span class="skolem">z</span><span class="main">)</span> <span class="main">∈</span> f<span class="main">^-1</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> 2<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">z</span><span class="main">,</span><span class="skolem">q</span><span class="main">)</span> <span class="main">∈</span> f"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">from</span></span> 1 <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">k</span></span> <span class="skolem"><span class="skolem">l</span></span> <span class="skolem"><span class="skolem">u</span></span> <span class="keyword2"><span class="keyword">where</span></span> kp<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">k</span><span class="main">∥</span><span class="skolem">p</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> kl<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">k</span><span class="main">∥</span><span class="skolem">l</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> lz<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">l</span><span class="main">∥</span><span class="skolem">z</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> zu<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">z</span><span class="main">∥</span><span class="skolem">u</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> pu<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">p</span><span class="main">∥</span><span class="skolem">u</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> f <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">from</span></span> 2 <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">k'</span></span> <span class="skolem"><span class="skolem">l'</span></span> <span class="skolem"><span class="skolem">u'</span></span> <span class="keyword2"><span class="keyword">where</span></span> kpq<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">k'</span><span class="main">∥</span><span class="skolem">q</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> kplp<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">k'</span><span class="main">∥</span><span class="skolem">l'</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> lpz<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">l'</span><span class="main">∥</span><span class="skolem">z</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> zup<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">z</span><span class="main">∥</span><span class="skolem">u'</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> qup<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">q</span><span class="main">∥</span><span class="skolem">u'</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> f <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">from</span></span> zu zup qup <span class="keyword1"><span class="command">have</span></span> qu<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">q</span><span class="main">∥</span><span class="skolem">u</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> M1 <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">from</span></span> kp kpq <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">k</span><span class="main">∥</span><span class="skolem">q</span> <span class="main">⊕</span> <span class="main">(</span><span class="main">(</span><span class="main">∃</span><span class="bound">t</span><span class="main">.</span> <span class="skolem">k</span><span class="main">∥</span><span class="bound">t</span> <span class="main">∧</span> <span class="bound">t</span><span class="main">∥</span><span class="skolem">q</span><span class="main">)</span> <span class="main">⊕</span> <span class="main">(</span><span class="main">∃</span><span class="bound">t</span><span class="main">.</span> <span class="skolem">k'</span><span class="main">∥</span><span class="bound">t</span> <span class="main">∧</span> <span class="bound">t</span><span class="main">∥</span><span class="skolem">p</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">is</span></span> <span class="quoted"><span class="quoted">"<span class="var">?A</span> <span class="main">⊕</span> <span class="main">(</span><span class="var">?B</span> <span class="main">⊕</span> <span class="var">?C</span><span class="main">)</span>"</span></span><span class="main">)</span> <span class="keyword1"><span class="command">using</span></span> M2 <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span> 
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="var">?A</span><span class="main">∧</span><span class="main">¬</span><span class="var">?B</span><span class="main">∧</span><span class="main">¬</span><span class="var">?C</span><span class="main">)</span><span class="main">∨</span><span class="main">(</span><span class="main">¬</span><span class="var">?A</span><span class="main">∧</span><span class="var">?B</span><span class="main">∧</span><span class="main">¬</span><span class="var">?C</span><span class="main">)</span><span class="main">∨</span><span class="main">(</span><span class="main">¬</span><span class="var">?A</span><span class="main">∧</span><span class="main">¬</span><span class="var">?B</span><span class="main">∧</span><span class="var">?C</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">insert</span> xor_distr_L<span class="main"><span class="main">[</span></span><span class="operator">of</span> <span class="var"><span class="quoted"><span class="var">?A</span></span></span> <span class="var"><span class="quoted"><span class="var">?B</span></span></span> <span class="var"><span class="quoted"><span class="var">?C</span></span></span><span class="main"><span class="main">]</span></span><span class="main"><span class="keyword3">,</span></span> <span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span>elimmeets<span class="main">)</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">∈</span> e <span class="main">∪</span> f<span class="main">^-1</span> <span class="main">∪</span> f"</span></span>    
  <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">elim</span> disjE<span class="main">)</span>
    <span class="keyword1"><span class="command">{</span></span><span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="var">?A</span><span class="main">∧</span><span class="main">¬</span><span class="var">?B</span><span class="main">∧</span><span class="main">¬</span><span class="var">?C</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="var">?A</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span> 
     <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">p</span> <span class="main">=</span> <span class="skolem">q</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> M4 kp pu qu <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span> 
     <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">p</span><span class="main">,</span><span class="skolem">q</span><span class="main">)</span> <span class="main">∈</span> e"</span></span> <span class="keyword1"><span class="command">using</span></span> e <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
     <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> x <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span> <span class="keyword1"><span class="command">}</span></span>
    <span class="keyword1"><span class="command">next</span></span>
    <span class="keyword1"><span class="command">{</span></span><span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">¬</span><span class="var">?A</span><span class="main">∧</span><span class="var">?B</span><span class="main">∧</span><span class="main">¬</span><span class="var">?C</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="var">?B</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
     <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">t</span></span> <span class="keyword2"><span class="keyword">where</span></span> kt<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">k</span><span class="main">∥</span><span class="skolem">t</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> tq<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">t</span><span class="main">∥</span><span class="skolem">q</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
     <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">p</span><span class="main">,</span><span class="skolem">q</span><span class="main">)</span> <span class="main">∈</span> f<span class="main">^-1</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> f qu pu kp <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
     <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> x <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span><span class="keyword1"><span class="command">}</span></span>
    <span class="keyword1"><span class="command">next</span></span>
    <span class="keyword1"><span class="command">{</span></span><span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">¬</span><span class="var">?A</span><span class="main">∧</span><span class="main">¬</span><span class="var">?B</span><span class="main">∧</span><span class="var">?C</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="var">?C</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
     <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">t</span></span> <span class="keyword2"><span class="keyword">where</span></span> kt<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">k'</span><span class="main">∥</span><span class="skolem">t</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> tp<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">t</span><span class="main">∥</span><span class="skolem">p</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
     <span class="keyword1"><span class="command">with</span></span> kpq pu qu <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">p</span><span class="main">,</span><span class="skolem">q</span><span class="main">)</span><span class="main">∈</span>f"</span></span> <span class="keyword1"><span class="command">using</span></span> f <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
     <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> x <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span><span class="keyword1"><span class="command">}</span></span>
  <span class="keyword1"><span class="command">qed</span></span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">lemma</span></span> cffi<span class="main">:</span><span class="quoted"><span class="quoted">"f <span class="keyword1">O</span> f<span class="main">^-1</span> <span class="main">⊆</span> e <span class="main">∪</span> f <span class="main">∪</span> f<span class="main">^-1</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span>
   <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">x</span><span class="main">::</span><span class="quoted"><span class="quoted">"<span class="tfree">'a</span><span class="main">×</span><span class="tfree">'a</span>"</span></span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">∈</span> f <span class="keyword1">O</span> f<span class="main">^-1</span>"</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">p</span></span> <span class="skolem"><span class="skolem">q</span></span> <span class="skolem"><span class="skolem">r</span></span> <span class="keyword2"><span class="keyword">where</span></span> x<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">=</span> <span class="main">(</span><span class="skolem">p</span><span class="main">,</span><span class="skolem">r</span><span class="main">)</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">p</span><span class="main">,</span><span class="skolem">q</span><span class="main">)</span><span class="main">∈</span>f"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">q</span><span class="main">,</span><span class="skolem">r</span><span class="main">)</span> <span class="main">∈</span>f<span class="main">^-1</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
   <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="main">(</span><span class="skolem">p</span><span class="main">,</span><span class="skolem">q</span><span class="main">)</span><span class="main">∈</span>f›</span></span> <span class="quoted"><span class="quoted">‹<span class="main">(</span><span class="skolem">q</span><span class="main">,</span><span class="skolem">r</span><span class="main">)</span> <span class="main">∈</span> f<span class="main">^-1</span>›</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">k</span></span> <span class="skolem"><span class="skolem">k'</span></span> <span class="keyword2"><span class="keyword">where</span></span> kp<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">k</span><span class="main">∥</span><span class="skolem">p</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> kpr<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">k'</span><span class="main">∥</span><span class="skolem">r</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> f <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
   <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="main">(</span><span class="skolem">p</span><span class="main">,</span><span class="skolem">q</span><span class="main">)</span><span class="main">∈</span>f›</span></span> <span class="quoted"><span class="quoted">‹<span class="main">(</span><span class="skolem">q</span><span class="main">,</span><span class="skolem">r</span><span class="main">)</span> <span class="main">∈</span> f<span class="main">^-1</span>›</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">u</span></span> <span class="keyword2"><span class="keyword">where</span></span> pu<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">p</span><span class="main">∥</span><span class="skolem">u</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">q</span><span class="main">∥</span><span class="skolem">u</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> ru<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">r</span><span class="main">∥</span><span class="skolem">u</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> f M1 <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
   <span class="keyword1"><span class="command">from</span></span> kp kpr <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">k</span><span class="main">∥</span><span class="skolem">r</span> <span class="main">⊕</span> <span class="main">(</span><span class="main">(</span><span class="main">∃</span><span class="bound">t</span><span class="main">.</span> <span class="skolem">k</span><span class="main">∥</span><span class="bound">t</span> <span class="main">∧</span> <span class="bound">t</span><span class="main">∥</span><span class="skolem">r</span><span class="main">)</span> <span class="main">⊕</span> <span class="main">(</span><span class="main">∃</span><span class="bound">t</span><span class="main">.</span> <span class="skolem">k'</span><span class="main">∥</span><span class="bound">t</span> <span class="main">∧</span> <span class="bound">t</span><span class="main">∥</span><span class="skolem">p</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">is</span></span> <span class="quoted"><span class="quoted">"<span class="var">?A</span> <span class="main">⊕</span> <span class="main">(</span><span class="var">?B</span> <span class="main">⊕</span> <span class="var">?C</span><span class="main">)</span>"</span></span><span class="main">)</span> <span class="keyword1"><span class="command">using</span></span> M2 <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
   <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="var">?A</span><span class="main">∧</span><span class="main">¬</span><span class="var">?B</span><span class="main">∧</span><span class="main">¬</span><span class="var">?C</span><span class="main">)</span> <span class="main">∨</span> <span class="main">(</span><span class="main">(</span><span class="main">¬</span><span class="var">?A</span><span class="main">∧</span><span class="var">?B</span><span class="main">∧</span><span class="main">¬</span><span class="var">?C</span><span class="main">)</span> <span class="main">∨</span> <span class="main">(</span><span class="main">¬</span><span class="var">?A</span><span class="main">∧</span><span class="main">¬</span><span class="var">?B</span><span class="main">∧</span><span class="var">?C</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">insert</span> xor_distr_L<span class="main"><span class="main">[</span></span><span class="operator">of</span> <span class="var"><span class="quoted"><span class="var">?A</span></span></span> <span class="var"><span class="quoted"><span class="var">?B</span></span></span> <span class="var"><span class="quoted"><span class="var">?C</span></span></span><span class="main"><span class="main">]</span></span><span class="main"><span class="keyword3">,</span></span> <span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span>elimmeets<span class="main">)</span>
   <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">∈</span> e <span class="main">∪</span> f <span class="main">∪</span> f<span class="main">^-1</span>"</span></span>
   <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">elim</span> disjE<span class="main">)</span>
      <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="var">?A</span><span class="main">∧</span><span class="main">¬</span><span class="var">?B</span><span class="main">∧</span><span class="main">¬</span><span class="var">?C</span>"</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="var"><span class="quoted"><span class="var">?A</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
        <span class="keyword1"><span class="command">with</span></span> pu ru kp <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">p</span> <span class="main">=</span> <span class="skolem">r</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> M4 <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> x e <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span><span class="keyword1"><span class="command">}</span></span>
      <span class="keyword1"><span class="command">next</span></span>
      <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span><span class="var">?A</span><span class="main">∧</span><span class="var">?B</span><span class="main">∧</span><span class="main">¬</span><span class="var">?C</span>"</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="var"><span class="quoted"><span class="var">?B</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span> 
        <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">t</span></span> <span class="keyword2"><span class="keyword">where</span></span> kt<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">k</span><span class="main">∥</span><span class="skolem">t</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> tr<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">t</span><span class="main">∥</span><span class="skolem">r</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword1"><span class="command">with</span></span> ru kp pu <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> x f <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span><span class="keyword1"><span class="command">}</span></span>
      <span class="keyword1"><span class="command">next</span></span>
      <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span><span class="var">?A</span> <span class="main">∧</span> <span class="main">¬</span><span class="var">?B</span> <span class="main">∧</span> <span class="var">?C</span>"</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="var"><span class="quoted"><span class="var">?C</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
        <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">t</span></span> <span class="keyword2"><span class="keyword">where</span></span> rtp<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">k'</span><span class="main">∥</span><span class="skolem">t</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">t</span><span class="main">∥</span><span class="skolem">p</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword1"><span class="command">with</span></span> kpr ru pu <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> x f <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span><span class="keyword1"><span class="command">}</span></span>
    <span class="keyword1"><span class="command">qed</span></span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="comment1">(* =========$\alpha_5$ composition========== *)</span>
<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹We prove compositions of the form $r_1 \circ r_2 \subseteq e \cup s \cup s^{-1}$.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> cssi<span class="main">:</span><span class="quoted"><span class="quoted">"s <span class="keyword1">O</span> s<span class="main">^-1</span> <span class="main">⊆</span> e <span class="main">∪</span> s <span class="main">∪</span> s<span class="main">^-1</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span>
   <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">x</span><span class="main">::</span><span class="quoted"><span class="quoted">"<span class="tfree">'a</span><span class="main">×</span><span class="tfree">'a</span>"</span></span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">∈</span> s <span class="keyword1">O</span> s<span class="main">^-1</span>"</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">p</span></span> <span class="skolem"><span class="skolem">q</span></span> <span class="skolem"><span class="skolem">r</span></span> <span class="keyword2"><span class="keyword">where</span></span> x<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">=</span> <span class="main">(</span><span class="skolem">p</span><span class="main">,</span><span class="skolem">r</span><span class="main">)</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">p</span><span class="main">,</span><span class="skolem">q</span><span class="main">)</span><span class="main">∈</span>s"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">q</span><span class="main">,</span><span class="skolem">r</span><span class="main">)</span> <span class="main">∈</span>s<span class="main">^-1</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
   <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="main">(</span><span class="skolem">p</span><span class="main">,</span><span class="skolem">q</span><span class="main">)</span><span class="main">∈</span>s›</span></span> <span class="quoted"><span class="quoted">‹<span class="main">(</span><span class="skolem">q</span><span class="main">,</span><span class="skolem">r</span><span class="main">)</span> <span class="main">∈</span> s<span class="main">^-1</span>›</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">k</span></span>  <span class="keyword2"><span class="keyword">where</span></span> kp<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">k</span><span class="main">∥</span><span class="skolem">p</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> kr<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">k</span><span class="main">∥</span><span class="skolem">r</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> kq<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">k</span><span class="main">∥</span><span class="skolem">q</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> s M1  <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
   <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="main">(</span><span class="skolem">p</span><span class="main">,</span><span class="skolem">q</span><span class="main">)</span><span class="main">∈</span>s›</span></span> <span class="quoted"><span class="quoted">‹<span class="main">(</span><span class="skolem">q</span><span class="main">,</span><span class="skolem">r</span><span class="main">)</span> <span class="main">∈</span> s<span class="main">^-1</span>›</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">u</span></span> <span class="skolem"><span class="skolem">u'</span></span> <span class="keyword2"><span class="keyword">where</span></span> pu<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">p</span><span class="main">∥</span><span class="skolem">u</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span>  rup<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">r</span><span class="main">∥</span><span class="skolem">u'</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> s <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
   <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">p</span><span class="main">∥</span><span class="skolem">u'</span> <span class="main">⊕</span> <span class="main">(</span><span class="main">(</span><span class="main">∃</span><span class="bound">t</span><span class="main">.</span> <span class="skolem">p</span><span class="main">∥</span><span class="bound">t</span> <span class="main">∧</span> <span class="bound">t</span><span class="main">∥</span><span class="skolem">u'</span><span class="main">)</span> <span class="main">⊕</span> <span class="main">(</span><span class="main">∃</span><span class="bound">t</span><span class="main">.</span> <span class="skolem">r</span><span class="main">∥</span><span class="bound">t</span> <span class="main">∧</span> <span class="bound">t</span><span class="main">∥</span><span class="skolem">u</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">is</span></span> <span class="quoted"><span class="quoted">"<span class="var">?A</span> <span class="main">⊕</span> <span class="main">(</span><span class="var">?B</span> <span class="main">⊕</span> <span class="var">?C</span><span class="main">)</span>"</span></span><span class="main">)</span> <span class="keyword1"><span class="command">using</span></span> M2 <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
   <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="var">?A</span><span class="main">∧</span><span class="main">¬</span><span class="var">?B</span><span class="main">∧</span><span class="main">¬</span><span class="var">?C</span><span class="main">)</span> <span class="main">∨</span> <span class="main">(</span><span class="main">(</span><span class="main">¬</span><span class="var">?A</span><span class="main">∧</span><span class="var">?B</span><span class="main">∧</span><span class="main">¬</span><span class="var">?C</span><span class="main">)</span> <span class="main">∨</span> <span class="main">(</span><span class="main">¬</span><span class="var">?A</span><span class="main">∧</span><span class="main">¬</span><span class="var">?B</span><span class="main">∧</span><span class="var">?C</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">insert</span> xor_distr_L<span class="main"><span class="main">[</span></span><span class="operator">of</span> <span class="var"><span class="quoted"><span class="var">?A</span></span></span> <span class="var"><span class="quoted"><span class="var">?B</span></span></span> <span class="var"><span class="quoted"><span class="var">?C</span></span></span><span class="main"><span class="main">]</span></span><span class="main"><span class="keyword3">,</span></span> <span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span>elimmeets<span class="main">)</span>
   <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">∈</span> e <span class="main">∪</span> s <span class="main">∪</span> s<span class="main">^-1</span>"</span></span>
   <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">elim</span> disjE<span class="main">)</span>
      <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="var">?A</span><span class="main">∧</span><span class="main">¬</span><span class="var">?B</span><span class="main">∧</span><span class="main">¬</span><span class="var">?C</span>"</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="var"><span class="quoted"><span class="var">?A</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
        <span class="keyword1"><span class="command">with</span></span> rup kp kr <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">p</span> <span class="main">=</span> <span class="skolem">r</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> M4 <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> x e <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span><span class="keyword1"><span class="command">}</span></span>
      <span class="keyword1"><span class="command">next</span></span>
      <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span><span class="var">?A</span><span class="main">∧</span><span class="var">?B</span><span class="main">∧</span><span class="main">¬</span><span class="var">?C</span>"</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="var"><span class="quoted"><span class="var">?B</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span> 
        <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">t</span></span> <span class="keyword2"><span class="keyword">where</span></span> kt<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">p</span><span class="main">∥</span><span class="skolem">t</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> tr<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">t</span><span class="main">∥</span><span class="skolem">u'</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword1"><span class="command">with</span></span> rup kp kr  <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> x s <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span><span class="keyword1"><span class="command">}</span></span>
      <span class="keyword1"><span class="command">next</span></span>
      <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span><span class="var">?A</span> <span class="main">∧</span> <span class="main">¬</span><span class="var">?B</span> <span class="main">∧</span> <span class="var">?C</span>"</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="var"><span class="quoted"><span class="var">?C</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
        <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">t</span></span> <span class="keyword2"><span class="keyword">where</span></span> rtp<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">r</span><span class="main">∥</span><span class="skolem">t</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">t</span><span class="main">∥</span><span class="skolem">u</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword1"><span class="command">with</span></span> pu kp kr <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> x s  <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span><span class="keyword1"><span class="command">}</span></span>
    <span class="keyword1"><span class="command">qed</span></span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">lemma</span></span> csis<span class="main">:</span><span class="quoted"><span class="quoted">"s<span class="main">^-1</span> <span class="keyword1">O</span> s <span class="main">⊆</span> e <span class="main">∪</span> s <span class="main">∪</span> s<span class="main">^-1</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span>
   <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">x</span><span class="main">::</span><span class="quoted"><span class="quoted">"<span class="tfree">'a</span><span class="main">×</span><span class="tfree">'a</span>"</span></span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">∈</span> s<span class="main">^-1</span> <span class="keyword1">O</span> s"</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">p</span></span> <span class="skolem"><span class="skolem">q</span></span> <span class="skolem"><span class="skolem">r</span></span> <span class="keyword2"><span class="keyword">where</span></span> x<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">=</span> <span class="main">(</span><span class="skolem">p</span><span class="main">,</span><span class="skolem">r</span><span class="main">)</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">p</span><span class="main">,</span><span class="skolem">q</span><span class="main">)</span><span class="main">∈</span>s<span class="main">^-1</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">q</span><span class="main">,</span><span class="skolem">r</span><span class="main">)</span> <span class="main">∈</span>s"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
   <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="main">(</span><span class="skolem">p</span><span class="main">,</span><span class="skolem">q</span><span class="main">)</span><span class="main">∈</span>s<span class="main">^-1</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="main">(</span><span class="skolem">q</span><span class="main">,</span><span class="skolem">r</span><span class="main">)</span> <span class="main">∈</span> s›</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">k</span></span>  <span class="keyword2"><span class="keyword">where</span></span> kp<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">k</span><span class="main">∥</span><span class="skolem">p</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> kr<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">k</span><span class="main">∥</span><span class="skolem">r</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> kq<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">k</span><span class="main">∥</span><span class="skolem">q</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> s M1  <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
   <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="main">(</span><span class="skolem">p</span><span class="main">,</span><span class="skolem">q</span><span class="main">)</span><span class="main">∈</span>s<span class="main">^-1</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="main">(</span><span class="skolem">q</span><span class="main">,</span><span class="skolem">r</span><span class="main">)</span> <span class="main">∈</span> s›</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">u</span></span> <span class="skolem"><span class="skolem">u'</span></span> <span class="keyword2"><span class="keyword">where</span></span> pu<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">p</span><span class="main">∥</span><span class="skolem">u</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span>  rup<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">r</span><span class="main">∥</span><span class="skolem">u'</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> s <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
   <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">p</span><span class="main">∥</span><span class="skolem">u'</span> <span class="main">⊕</span> <span class="main">(</span><span class="main">(</span><span class="main">∃</span><span class="bound">t</span><span class="main">.</span> <span class="skolem">p</span><span class="main">∥</span><span class="bound">t</span> <span class="main">∧</span> <span class="bound">t</span><span class="main">∥</span><span class="skolem">u'</span><span class="main">)</span> <span class="main">⊕</span> <span class="main">(</span><span class="main">∃</span><span class="bound">t</span><span class="main">.</span> <span class="skolem">r</span><span class="main">∥</span><span class="bound">t</span> <span class="main">∧</span> <span class="bound">t</span><span class="main">∥</span><span class="skolem">u</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">is</span></span> <span class="quoted"><span class="quoted">"<span class="var">?A</span> <span class="main">⊕</span> <span class="main">(</span><span class="var">?B</span> <span class="main">⊕</span> <span class="var">?C</span><span class="main">)</span>"</span></span><span class="main">)</span> <span class="keyword1"><span class="command">using</span></span> M2 <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
   <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="var">?A</span><span class="main">∧</span><span class="main">¬</span><span class="var">?B</span><span class="main">∧</span><span class="main">¬</span><span class="var">?C</span><span class="main">)</span> <span class="main">∨</span> <span class="main">(</span><span class="main">(</span><span class="main">¬</span><span class="var">?A</span><span class="main">∧</span><span class="var">?B</span><span class="main">∧</span><span class="main">¬</span><span class="var">?C</span><span class="main">)</span> <span class="main">∨</span> <span class="main">(</span><span class="main">¬</span><span class="var">?A</span><span class="main">∧</span><span class="main">¬</span><span class="var">?B</span><span class="main">∧</span><span class="var">?C</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">insert</span> xor_distr_L<span class="main"><span class="main">[</span></span><span class="operator">of</span> <span class="var"><span class="quoted"><span class="var">?A</span></span></span> <span class="var"><span class="quoted"><span class="var">?B</span></span></span> <span class="var"><span class="quoted"><span class="var">?C</span></span></span><span class="main"><span class="main">]</span></span><span class="main"><span class="keyword3">,</span></span> <span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span>elimmeets<span class="main">)</span>
   <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">∈</span> e <span class="main">∪</span> s <span class="main">∪</span> s<span class="main">^-1</span>"</span></span>
   <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">elim</span> disjE<span class="main">)</span>
      <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="var">?A</span><span class="main">∧</span><span class="main">¬</span><span class="var">?B</span><span class="main">∧</span><span class="main">¬</span><span class="var">?C</span>"</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="var"><span class="quoted"><span class="var">?A</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
        <span class="keyword1"><span class="command">with</span></span> rup kp kr <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">p</span> <span class="main">=</span> <span class="skolem">r</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> M4 <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> x e <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span><span class="keyword1"><span class="command">}</span></span>
      <span class="keyword1"><span class="command">next</span></span>
      <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span><span class="var">?A</span><span class="main">∧</span><span class="var">?B</span><span class="main">∧</span><span class="main">¬</span><span class="var">?C</span>"</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="var"><span class="quoted"><span class="var">?B</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span> 
        <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">t</span></span> <span class="keyword2"><span class="keyword">where</span></span> kt<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">p</span><span class="main">∥</span><span class="skolem">t</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> tr<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">t</span><span class="main">∥</span><span class="skolem">u'</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword1"><span class="command">with</span></span> rup kp kr  <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> x s <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span><span class="keyword1"><span class="command">}</span></span>
      <span class="keyword1"><span class="command">next</span></span>
      <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span><span class="var">?A</span> <span class="main">∧</span> <span class="main">¬</span><span class="var">?B</span> <span class="main">∧</span> <span class="var">?C</span>"</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="var"><span class="quoted"><span class="var">?C</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
        <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">t</span></span> <span class="keyword2"><span class="keyword">where</span></span> rtp<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">r</span><span class="main">∥</span><span class="skolem">t</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">t</span><span class="main">∥</span><span class="skolem">u</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword1"><span class="command">with</span></span> pu kp kr <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> x s  <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span><span class="keyword1"><span class="command">}</span></span>
    <span class="keyword1"><span class="command">qed</span></span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">lemma</span></span> cmim<span class="main">:</span><span class="quoted"><span class="quoted">"m<span class="main">^-1</span> <span class="keyword1">O</span> m <span class="main">⊆</span> s <span class="main">∪</span> s<span class="main">^-1</span> <span class="main">∪</span> e"</span></span>
<span class="keyword1"><span class="command">proof</span></span>
   <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">x</span><span class="main">::</span><span class="quoted"><span class="quoted">"<span class="tfree">'a</span><span class="main">×</span><span class="tfree">'a</span>"</span></span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">∈</span> m<span class="main">^-1</span> <span class="keyword1">O</span> m"</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">p</span></span> <span class="skolem"><span class="skolem">q</span></span> <span class="skolem"><span class="skolem">r</span></span> <span class="keyword2"><span class="keyword">where</span></span> x<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">=</span> <span class="main">(</span><span class="skolem">p</span><span class="main">,</span><span class="skolem">r</span><span class="main">)</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">p</span><span class="main">,</span><span class="skolem">q</span><span class="main">)</span><span class="main">∈</span>m<span class="main">^-1</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">q</span><span class="main">,</span><span class="skolem">r</span><span class="main">)</span> <span class="main">∈</span>m"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
   <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="main">(</span><span class="skolem">p</span><span class="main">,</span><span class="skolem">q</span><span class="main">)</span><span class="main">∈</span>m<span class="main">^-1</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="main">(</span><span class="skolem">q</span><span class="main">,</span><span class="skolem">r</span><span class="main">)</span> <span class="main">∈</span> m›</span></span>  <span class="keyword1"><span class="command">have</span></span> qp<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">q</span><span class="main">∥</span><span class="skolem">p</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> qr<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">q</span><span class="main">∥</span><span class="skolem">r</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> m  <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
   <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">u</span></span> <span class="skolem"><span class="skolem">u'</span></span>  <span class="keyword2"><span class="keyword">where</span></span> pu<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">p</span><span class="main">∥</span><span class="skolem">u</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span>  rup<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">r</span><span class="main">∥</span><span class="skolem">u'</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> M3 meets_wd qp qr <span class="keyword1"><span class="command">by</span></span> <span class="operator">fastforce</span>
   <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">p</span><span class="main">∥</span><span class="skolem">u'</span> <span class="main">⊕</span> <span class="main">(</span><span class="main">(</span><span class="main">∃</span><span class="bound">t</span><span class="main">.</span> <span class="skolem">p</span><span class="main">∥</span><span class="bound">t</span> <span class="main">∧</span> <span class="bound">t</span><span class="main">∥</span><span class="skolem">u'</span><span class="main">)</span> <span class="main">⊕</span> <span class="main">(</span><span class="main">∃</span><span class="bound">t</span><span class="main">.</span> <span class="skolem">r</span><span class="main">∥</span><span class="bound">t</span> <span class="main">∧</span> <span class="bound">t</span><span class="main">∥</span><span class="skolem">u</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">is</span></span> <span class="quoted"><span class="quoted">"<span class="var">?A</span> <span class="main">⊕</span> <span class="main">(</span><span class="var">?B</span> <span class="main">⊕</span> <span class="var">?C</span><span class="main">)</span>"</span></span><span class="main">)</span> <span class="keyword1"><span class="command">using</span></span> M2 <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
   <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="var">?A</span><span class="main">∧</span><span class="main">¬</span><span class="var">?B</span><span class="main">∧</span><span class="main">¬</span><span class="var">?C</span><span class="main">)</span> <span class="main">∨</span> <span class="main">(</span><span class="main">(</span><span class="main">¬</span><span class="var">?A</span><span class="main">∧</span><span class="var">?B</span><span class="main">∧</span><span class="main">¬</span><span class="var">?C</span><span class="main">)</span> <span class="main">∨</span> <span class="main">(</span><span class="main">¬</span><span class="var">?A</span><span class="main">∧</span><span class="main">¬</span><span class="var">?B</span><span class="main">∧</span><span class="var">?C</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">insert</span> xor_distr_L<span class="main"><span class="main">[</span></span><span class="operator">of</span> <span class="var"><span class="quoted"><span class="var">?A</span></span></span> <span class="var"><span class="quoted"><span class="var">?B</span></span></span> <span class="var"><span class="quoted"><span class="var">?C</span></span></span><span class="main"><span class="main">]</span></span><span class="main"><span class="keyword3">,</span></span> <span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span>elimmeets<span class="main">)</span>
   <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">∈</span>  s <span class="main">∪</span> s<span class="main">^-1</span> <span class="main">∪</span> e"</span></span>
   <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">elim</span> disjE<span class="main">)</span>
      <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="var">?A</span><span class="main">∧</span><span class="main">¬</span><span class="var">?B</span><span class="main">∧</span><span class="main">¬</span><span class="var">?C</span>"</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="var"><span class="quoted"><span class="var">?A</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
        <span class="keyword1"><span class="command">with</span></span> rup qp qr <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">p</span> <span class="main">=</span> <span class="skolem">r</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> M4 <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> x e <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span><span class="keyword1"><span class="command">}</span></span>
      <span class="keyword1"><span class="command">next</span></span>
      <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span><span class="var">?A</span><span class="main">∧</span><span class="var">?B</span><span class="main">∧</span><span class="main">¬</span><span class="var">?C</span>"</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="var"><span class="quoted"><span class="var">?B</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span> 
        <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">t</span></span> <span class="keyword2"><span class="keyword">where</span></span> kt<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">p</span><span class="main">∥</span><span class="skolem">t</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> tr<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">t</span><span class="main">∥</span><span class="skolem">u'</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword1"><span class="command">with</span></span> rup qp qr  <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> x s <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span><span class="keyword1"><span class="command">}</span></span>
      <span class="keyword1"><span class="command">next</span></span>
      <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span><span class="var">?A</span> <span class="main">∧</span> <span class="main">¬</span><span class="var">?B</span> <span class="main">∧</span> <span class="var">?C</span>"</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="var"><span class="quoted"><span class="var">?C</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
        <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">t</span></span> <span class="keyword2"><span class="keyword">where</span></span> rtp<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">r</span><span class="main">∥</span><span class="skolem">t</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">t</span><span class="main">∥</span><span class="skolem">u</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword1"><span class="command">with</span></span> pu qp qr <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> x s  <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span><span class="keyword1"><span class="command">}</span></span>
    <span class="keyword1"><span class="command">qed</span></span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="comment1">(* =========$\beta_1$ composition========== *)</span>
<span class="keyword1"><span class="command">subsection</span></span> <span class="quoted"><span class="plain_text">‹$\beta$-composition›</span></span>
<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹We prove compositions of the form $r_1 \circ r_2 \subseteq b \cup m \cup ov \cup s \cup d$.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> cbd<span class="main">:</span><span class="quoted"><span class="quoted">"b <span class="keyword1">O</span> d <span class="main">⊆</span> b <span class="main">∪</span> m <span class="main">∪</span> ov <span class="main">∪</span> s <span class="main">∪</span> d"</span></span>
<span class="keyword1"><span class="command">proof</span></span> 
  <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">x</span><span class="main">::</span><span class="quoted"><span class="quoted">"<span class="tfree">'a</span><span class="main">×</span><span class="tfree">'a</span>"</span></span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">∈</span> b <span class="keyword1">O</span> d"</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">p</span></span> <span class="skolem"><span class="skolem">q</span></span> <span class="skolem"><span class="skolem">z</span></span> <span class="keyword2"><span class="keyword">where</span></span> x<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">=</span> <span class="main">(</span><span class="skolem">p</span><span class="main">,</span><span class="skolem">q</span><span class="main">)</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">p</span><span class="main">,</span><span class="skolem">z</span><span class="main">)</span> <span class="main">∈</span> b"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">z</span><span class="main">,</span><span class="skolem">q</span><span class="main">)</span> <span class="main">∈</span> d"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="main">(</span><span class="skolem">p</span><span class="main">,</span><span class="skolem">z</span><span class="main">)</span> <span class="main">∈</span> b›</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">c</span></span> <span class="keyword2"><span class="keyword">where</span></span> pc<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">p</span><span class="main">∥</span><span class="skolem">c</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> cz<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">c</span><span class="main">∥</span><span class="skolem">z</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> b <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">a</span></span> <span class="keyword2"><span class="keyword">where</span></span> ap<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">a</span><span class="main">∥</span><span class="skolem">p</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> M3 meets_wd pc <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="main">(</span><span class="skolem">z</span><span class="main">,</span><span class="skolem">q</span><span class="main">)</span> <span class="main">∈</span> d›</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">k</span></span> <span class="skolem"><span class="skolem">l</span></span> <span class="skolem"><span class="skolem">u</span></span> <span class="skolem"><span class="skolem">v</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">k</span><span class="main">∥</span><span class="skolem">l</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">l</span><span class="main">∥</span><span class="skolem">z</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> kq<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">k</span><span class="main">∥</span><span class="skolem">q</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> zu<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">z</span><span class="main">∥</span><span class="skolem">u</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> uv<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">u</span><span class="main">∥</span><span class="skolem">v</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> qv<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">q</span><span class="main">∥</span><span class="skolem">v</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> d <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">from</span></span> pc cz zu <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">cz</span></span> <span class="keyword2"><span class="keyword">where</span></span> pcz<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">p</span><span class="main">∥</span><span class="skolem">cz</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> czu<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">cz</span><span class="main">∥</span><span class="skolem">u</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> M5exist_var <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">with</span></span> uv <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">czu</span></span> <span class="keyword2"><span class="keyword">where</span></span> pczu<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">p</span><span class="main">∥</span><span class="skolem">czu</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> czuv<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">czu</span><span class="main">∥</span><span class="skolem">v</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> M5exist_var <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">from</span></span> ap kq  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">a</span><span class="main">∥</span><span class="skolem">q</span> <span class="main">⊕</span> <span class="main">(</span><span class="main">(</span><span class="main">∃</span><span class="bound">t</span><span class="main">.</span> <span class="skolem">a</span><span class="main">∥</span><span class="bound">t</span> <span class="main">∧</span> <span class="bound">t</span><span class="main">∥</span><span class="skolem">q</span><span class="main">)</span> <span class="main">⊕</span> <span class="main">(</span><span class="main">∃</span><span class="bound">t</span><span class="main">.</span> <span class="skolem">k</span><span class="main">∥</span><span class="bound">t</span> <span class="main">∧</span> <span class="bound">t</span><span class="main">∥</span><span class="skolem">p</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">is</span></span> <span class="quoted"><span class="quoted">"<span class="var">?A</span> <span class="main">⊕</span> <span class="main">(</span><span class="var">?B</span> <span class="main">⊕</span> <span class="var">?C</span><span class="main">)</span>"</span></span><span class="main">)</span> <span class="keyword1"><span class="command">using</span></span> M2 <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="var">?A</span><span class="main">∧</span><span class="main">¬</span><span class="var">?B</span><span class="main">∧</span><span class="main">¬</span><span class="var">?C</span><span class="main">)</span> <span class="main">∨</span> <span class="main">(</span><span class="main">(</span><span class="main">¬</span><span class="var">?A</span><span class="main">∧</span><span class="var">?B</span><span class="main">∧</span><span class="main">¬</span><span class="var">?C</span><span class="main">)</span> <span class="main">∨</span> <span class="main">(</span><span class="main">¬</span><span class="var">?A</span><span class="main">∧</span><span class="main">¬</span><span class="var">?B</span><span class="main">∧</span><span class="var">?C</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">insert</span> xor_distr_L<span class="main"><span class="main">[</span></span><span class="operator">of</span> <span class="var"><span class="quoted"><span class="var">?A</span></span></span> <span class="var"><span class="quoted"><span class="var">?B</span></span></span> <span class="var"><span class="quoted"><span class="var">?C</span></span></span><span class="main"><span class="main">]</span></span><span class="main"><span class="keyword3">,</span></span> <span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span>elimmeets<span class="main">)</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">∈</span> b <span class="main">∪</span> m <span class="main">∪</span> ov <span class="main">∪</span> s <span class="main">∪</span> d"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">elim</span> disjE<span class="main">)</span>
      <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="var">?A</span><span class="main">∧</span><span class="main">¬</span><span class="var">?B</span><span class="main">∧</span><span class="main">¬</span><span class="var">?C</span>"</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="var"><span class="quoted"><span class="var">?A</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
        <span class="keyword1"><span class="command">with</span></span> ap pczu czuv uv qv <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">p</span><span class="main">,</span><span class="skolem">q</span><span class="main">)</span> <span class="main">∈</span> s"</span></span> <span class="keyword1"><span class="command">using</span></span> s <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
        <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> x  <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span><span class="keyword1"><span class="command">}</span></span> 
      <span class="keyword1"><span class="command">next</span></span>
      <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span><span class="var">?A</span><span class="main">∧</span><span class="var">?B</span><span class="main">∧</span><span class="main">¬</span><span class="var">?C</span>"</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="var"><span class="quoted"><span class="var">?B</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span> 
        <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">t</span></span> <span class="keyword2"><span class="keyword">where</span></span> at<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">a</span><span class="main">∥</span><span class="skolem">t</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> tq<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">t</span><span class="main">∥</span><span class="skolem">q</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword1"><span class="command">from</span></span> pc  tq <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">p</span><span class="main">∥</span><span class="skolem">q</span> <span class="main">⊕</span> <span class="main">(</span><span class="main">(</span><span class="main">∃</span><span class="bound">t'</span><span class="main">.</span> <span class="skolem">p</span><span class="main">∥</span><span class="bound">t'</span> <span class="main">∧</span> <span class="bound">t'</span><span class="main">∥</span><span class="skolem">q</span><span class="main">)</span> <span class="main">⊕</span> <span class="main">(</span><span class="main">∃</span><span class="bound">t'</span><span class="main">.</span> <span class="skolem">t</span><span class="main">∥</span><span class="bound">t'</span> <span class="main">∧</span> <span class="bound">t'</span><span class="main">∥</span><span class="skolem">c</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">is</span></span> <span class="quoted"><span class="quoted">"<span class="var">?A</span> <span class="main">⊕</span> <span class="main">(</span><span class="var">?B</span> <span class="main">⊕</span> <span class="var">?C</span><span class="main">)</span>"</span></span><span class="main">)</span> <span class="keyword1"><span class="command">using</span></span> M2 <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
        <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="var">?A</span><span class="main">∧</span><span class="main">¬</span><span class="var">?B</span><span class="main">∧</span><span class="main">¬</span><span class="var">?C</span><span class="main">)</span> <span class="main">∨</span> <span class="main">(</span><span class="main">(</span><span class="main">¬</span><span class="var">?A</span><span class="main">∧</span><span class="var">?B</span><span class="main">∧</span><span class="main">¬</span><span class="var">?C</span><span class="main">)</span> <span class="main">∨</span> <span class="main">(</span><span class="main">¬</span><span class="var">?A</span><span class="main">∧</span><span class="main">¬</span><span class="var">?B</span><span class="main">∧</span><span class="var">?C</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">insert</span> xor_distr_L<span class="main"><span class="main">[</span></span><span class="operator">of</span> <span class="var"><span class="quoted"><span class="var">?A</span></span></span> <span class="var"><span class="quoted"><span class="var">?B</span></span></span> <span class="var"><span class="quoted"><span class="var">?C</span></span></span><span class="main"><span class="main">]</span></span><span class="main"><span class="keyword3">,</span></span> <span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span>elimmeets<span class="main">)</span>
        <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">∈</span> b <span class="main">∪</span> m <span class="main">∪</span> ov <span class="main">∪</span> s <span class="main">∪</span> d"</span></span>
        <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">elim</span> disjE<span class="main">)</span>
           <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="var">?A</span><span class="main">∧</span><span class="main">¬</span><span class="var">?B</span><span class="main">∧</span><span class="main">¬</span><span class="var">?C</span>"</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="var"><span class="quoted"><span class="var">?A</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
             <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> x m <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span><span class="keyword1"><span class="command">}</span></span>
           <span class="keyword1"><span class="command">next</span></span>
           <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span><span class="var">?A</span><span class="main">∧</span><span class="var">?B</span><span class="main">∧</span><span class="main">¬</span><span class="var">?C</span>"</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="var"><span class="quoted"><span class="var">?B</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
             <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> x b <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span><span class="keyword1"><span class="command">}</span></span>
           <span class="keyword1"><span class="command">next</span></span>
           <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span><span class="var">?A</span> <span class="main">∧</span> <span class="main">¬</span><span class="var">?B</span> <span class="main">∧</span> <span class="var">?C</span>"</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="var"><span class="quoted"><span class="var">?C</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
             <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">t'</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">t</span><span class="main">∥</span><span class="skolem">t'</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">t'</span><span class="main">∥</span><span class="skolem">c</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
             <span class="keyword1"><span class="command">with</span></span> pc pczu <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">t'</span><span class="main">∥</span><span class="skolem">czu</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> M1 <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
             <span class="keyword1"><span class="command">with</span></span> at tq ap pczu czuv qv <span class="quoted"><span class="quoted">‹<span class="skolem">t</span><span class="main">∥</span><span class="skolem">t'</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">p</span><span class="main">,</span><span class="skolem">q</span><span class="main">)</span><span class="main">∈</span>ov"</span></span> <span class="keyword1"><span class="command">using</span></span> ov <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
             <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> x <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span><span class="keyword1"><span class="command">}</span></span>
        <span class="keyword1"><span class="command">qed</span></span>
        <span class="keyword1"><span class="command">}</span></span>  
      <span class="keyword1"><span class="command">next</span></span>
      <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span><span class="var">?A</span> <span class="main">∧</span> <span class="main">¬</span><span class="var">?B</span> <span class="main">∧</span> <span class="var">?C</span>"</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="var"><span class="quoted"><span class="var">?C</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
        <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">t</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">k</span><span class="main">∥</span><span class="skolem">t</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">t</span><span class="main">∥</span><span class="skolem">p</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword1"><span class="command">with</span></span> kq pczu czuv uv qv <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">p</span><span class="main">,</span><span class="skolem">q</span><span class="main">)</span> <span class="main">∈</span> d"</span></span> <span class="keyword1"><span class="command">using</span></span> d <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
        <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> x  <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span><span class="keyword1"><span class="command">}</span></span>
       <span class="keyword1"><span class="command">qed</span></span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">lemma</span></span> cbf<span class="main">:</span><span class="quoted"><span class="quoted">"b <span class="keyword1">O</span> f <span class="main">⊆</span> b <span class="main">∪</span> m <span class="main">∪</span> ov <span class="main">∪</span> s <span class="main">∪</span> d"</span></span>
<span class="keyword1"><span class="command">proof</span></span> 
  <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">x</span><span class="main">::</span><span class="quoted"><span class="quoted">"<span class="tfree">'a</span><span class="main">×</span><span class="tfree">'a</span>"</span></span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">∈</span> b <span class="keyword1">O</span> f"</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">p</span></span> <span class="skolem"><span class="skolem">q</span></span> <span class="skolem"><span class="skolem">z</span></span> <span class="keyword2"><span class="keyword">where</span></span> x<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">=</span> <span class="main">(</span><span class="skolem">p</span><span class="main">,</span><span class="skolem">q</span><span class="main">)</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">p</span><span class="main">,</span><span class="skolem">z</span><span class="main">)</span> <span class="main">∈</span> b"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">z</span><span class="main">,</span><span class="skolem">q</span><span class="main">)</span> <span class="main">∈</span> f"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="main">(</span><span class="skolem">p</span><span class="main">,</span><span class="skolem">z</span><span class="main">)</span> <span class="main">∈</span> b›</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">c</span></span> <span class="keyword2"><span class="keyword">where</span></span> pc<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">p</span><span class="main">∥</span><span class="skolem">c</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> cz<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">c</span><span class="main">∥</span><span class="skolem">z</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> b <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">a</span></span> <span class="keyword2"><span class="keyword">where</span></span> ap<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">a</span><span class="main">∥</span><span class="skolem">p</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> M3 meets_wd pc <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="main">(</span><span class="skolem">z</span><span class="main">,</span><span class="skolem">q</span><span class="main">)</span> <span class="main">∈</span> f›</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">k</span></span> <span class="skolem"><span class="skolem">l</span></span> <span class="skolem"><span class="skolem">u</span></span>  <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">k</span><span class="main">∥</span><span class="skolem">l</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">l</span><span class="main">∥</span><span class="skolem">z</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> kq<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">k</span><span class="main">∥</span><span class="skolem">q</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> zu<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">z</span><span class="main">∥</span><span class="skolem">u</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> qu<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">q</span><span class="main">∥</span><span class="skolem">u</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> f  <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">from</span></span> pc cz zu <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">cz</span></span> <span class="keyword2"><span class="keyword">where</span></span> pcz<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">p</span><span class="main">∥</span><span class="skolem">cz</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> czu<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">cz</span><span class="main">∥</span><span class="skolem">u</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> M5exist_var <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">from</span></span> ap kq  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">a</span><span class="main">∥</span><span class="skolem">q</span> <span class="main">⊕</span> <span class="main">(</span><span class="main">(</span><span class="main">∃</span><span class="bound">t</span><span class="main">.</span> <span class="skolem">a</span><span class="main">∥</span><span class="bound">t</span> <span class="main">∧</span> <span class="bound">t</span><span class="main">∥</span><span class="skolem">q</span><span class="main">)</span> <span class="main">⊕</span> <span class="main">(</span><span class="main">∃</span><span class="bound">t</span><span class="main">.</span> <span class="skolem">k</span><span class="main">∥</span><span class="bound">t</span> <span class="main">∧</span> <span class="bound">t</span><span class="main">∥</span><span class="skolem">p</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">is</span></span> <span class="quoted"><span class="quoted">"<span class="var">?A</span> <span class="main">⊕</span> <span class="main">(</span><span class="var">?B</span> <span class="main">⊕</span> <span class="var">?C</span><span class="main">)</span>"</span></span><span class="main">)</span> <span class="keyword1"><span class="command">using</span></span> M2 <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="var">?A</span><span class="main">∧</span><span class="main">¬</span><span class="var">?B</span><span class="main">∧</span><span class="main">¬</span><span class="var">?C</span><span class="main">)</span> <span class="main">∨</span> <span class="main">(</span><span class="main">(</span><span class="main">¬</span><span class="var">?A</span><span class="main">∧</span><span class="var">?B</span><span class="main">∧</span><span class="main">¬</span><span class="var">?C</span><span class="main">)</span> <span class="main">∨</span> <span class="main">(</span><span class="main">¬</span><span class="var">?A</span><span class="main">∧</span><span class="main">¬</span><span class="var">?B</span><span class="main">∧</span><span class="var">?C</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">insert</span> xor_distr_L<span class="main"><span class="main">[</span></span><span class="operator">of</span> <span class="var"><span class="quoted"><span class="var">?A</span></span></span> <span class="var"><span class="quoted"><span class="var">?B</span></span></span> <span class="var"><span class="quoted"><span class="var">?C</span></span></span><span class="main"><span class="main">]</span></span><span class="main"><span class="keyword3">,</span></span> <span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span>elimmeets<span class="main">)</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">∈</span> b <span class="main">∪</span> m <span class="main">∪</span> ov <span class="main">∪</span> s <span class="main">∪</span> d"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">elim</span> disjE<span class="main">)</span>
      <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="var">?A</span><span class="main">∧</span><span class="main">¬</span><span class="var">?B</span><span class="main">∧</span><span class="main">¬</span><span class="var">?C</span>"</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="var"><span class="quoted"><span class="var">?A</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
        <span class="keyword1"><span class="command">with</span></span> ap pcz czu  qu <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">p</span><span class="main">,</span><span class="skolem">q</span><span class="main">)</span> <span class="main">∈</span> s"</span></span> <span class="keyword1"><span class="command">using</span></span> s <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
        <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> x  <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span><span class="keyword1"><span class="command">}</span></span> 
      <span class="keyword1"><span class="command">next</span></span>
      <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span><span class="var">?A</span><span class="main">∧</span><span class="var">?B</span><span class="main">∧</span><span class="main">¬</span><span class="var">?C</span>"</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="var"><span class="quoted"><span class="var">?B</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span> 
        <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">t</span></span> <span class="keyword2"><span class="keyword">where</span></span> at<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">a</span><span class="main">∥</span><span class="skolem">t</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> tq<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">t</span><span class="main">∥</span><span class="skolem">q</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword1"><span class="command">from</span></span> pc  tq <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">p</span><span class="main">∥</span><span class="skolem">q</span> <span class="main">⊕</span> <span class="main">(</span><span class="main">(</span><span class="main">∃</span><span class="bound">t'</span><span class="main">.</span> <span class="skolem">p</span><span class="main">∥</span><span class="bound">t'</span> <span class="main">∧</span> <span class="bound">t'</span><span class="main">∥</span><span class="skolem">q</span><span class="main">)</span> <span class="main">⊕</span> <span class="main">(</span><span class="main">∃</span><span class="bound">t'</span><span class="main">.</span> <span class="skolem">t</span><span class="main">∥</span><span class="bound">t'</span> <span class="main">∧</span> <span class="bound">t'</span><span class="main">∥</span><span class="skolem">c</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">is</span></span> <span class="quoted"><span class="quoted">"<span class="var">?A</span> <span class="main">⊕</span> <span class="main">(</span><span class="var">?B</span> <span class="main">⊕</span> <span class="var">?C</span><span class="main">)</span>"</span></span><span class="main">)</span> <span class="keyword1"><span class="command">using</span></span> M2 <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
        <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="var">?A</span><span class="main">∧</span><span class="main">¬</span><span class="var">?B</span><span class="main">∧</span><span class="main">¬</span><span class="var">?C</span><span class="main">)</span> <span class="main">∨</span> <span class="main">(</span><span class="main">(</span><span class="main">¬</span><span class="var">?A</span><span class="main">∧</span><span class="var">?B</span><span class="main">∧</span><span class="main">¬</span><span class="var">?C</span><span class="main">)</span> <span class="main">∨</span> <span class="main">(</span><span class="main">¬</span><span class="var">?A</span><span class="main">∧</span><span class="main">¬</span><span class="var">?B</span><span class="main">∧</span><span class="var">?C</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">insert</span> xor_distr_L<span class="main"><span class="main">[</span></span><span class="operator">of</span> <span class="var"><span class="quoted"><span class="var">?A</span></span></span> <span class="var"><span class="quoted"><span class="var">?B</span></span></span> <span class="var"><span class="quoted"><span class="var">?C</span></span></span><span class="main"><span class="main">]</span></span><span class="main"><span class="keyword3">,</span></span> <span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span>elimmeets<span class="main">)</span>
        <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">∈</span> b <span class="main">∪</span> m <span class="main">∪</span> ov <span class="main">∪</span> s <span class="main">∪</span> d"</span></span>
        <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">elim</span> disjE<span class="main">)</span>
           <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="var">?A</span><span class="main">∧</span><span class="main">¬</span><span class="var">?B</span><span class="main">∧</span><span class="main">¬</span><span class="var">?C</span>"</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="var"><span class="quoted"><span class="var">?A</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
             <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> x m <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span><span class="keyword1"><span class="command">}</span></span>
           <span class="keyword1"><span class="command">next</span></span>
           <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span><span class="var">?A</span><span class="main">∧</span><span class="var">?B</span><span class="main">∧</span><span class="main">¬</span><span class="var">?C</span>"</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="var"><span class="quoted"><span class="var">?B</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
             <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> x b <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span><span class="keyword1"><span class="command">}</span></span>
           <span class="keyword1"><span class="command">next</span></span>
           <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span><span class="var">?A</span> <span class="main">∧</span> <span class="main">¬</span><span class="var">?B</span> <span class="main">∧</span> <span class="var">?C</span>"</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="var"><span class="quoted"><span class="var">?C</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
             <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">t'</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">t</span><span class="main">∥</span><span class="skolem">t'</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">t'</span><span class="main">∥</span><span class="skolem">c</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
             <span class="keyword1"><span class="command">with</span></span> pc pcz <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">t'</span><span class="main">∥</span><span class="skolem">cz</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> M1 <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
             <span class="keyword1"><span class="command">with</span></span> at tq ap pcz czu qu <span class="quoted"><span class="quoted">‹<span class="skolem">t</span><span class="main">∥</span><span class="skolem">t'</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">p</span><span class="main">,</span><span class="skolem">q</span><span class="main">)</span><span class="main">∈</span>ov"</span></span> <span class="keyword1"><span class="command">using</span></span> ov <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
             <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> x <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span><span class="keyword1"><span class="command">}</span></span>
        <span class="keyword1"><span class="command">qed</span></span>
        <span class="keyword1"><span class="command">}</span></span>  
      <span class="keyword1"><span class="command">next</span></span>
      <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span><span class="var">?A</span> <span class="main">∧</span> <span class="main">¬</span><span class="var">?B</span> <span class="main">∧</span> <span class="var">?C</span>"</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="var"><span class="quoted"><span class="var">?C</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
        <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">t</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">k</span><span class="main">∥</span><span class="skolem">t</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">t</span><span class="main">∥</span><span class="skolem">p</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword1"><span class="command">with</span></span> kq pcz czu  qu <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">p</span><span class="main">,</span><span class="skolem">q</span><span class="main">)</span> <span class="main">∈</span> d"</span></span> <span class="keyword1"><span class="command">using</span></span> d <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
        <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> x  <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span><span class="keyword1"><span class="command">}</span></span>
       <span class="keyword1"><span class="command">qed</span></span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">lemma</span></span> cbovi<span class="main">:</span><span class="quoted"><span class="quoted">"b <span class="keyword1">O</span> ov<span class="main">^-1</span> <span class="main">⊆</span> b <span class="main">∪</span> m <span class="main">∪</span> ov <span class="main">∪</span> s <span class="main">∪</span> d"</span></span>
<span class="keyword1"><span class="command">proof</span></span> 
  <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">x</span><span class="main">::</span><span class="quoted"><span class="quoted">"<span class="tfree">'a</span><span class="main">×</span><span class="tfree">'a</span>"</span></span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">∈</span> b <span class="keyword1">O</span> ov<span class="main">^-1</span>"</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">p</span></span> <span class="skolem"><span class="skolem">q</span></span> <span class="skolem"><span class="skolem">z</span></span> <span class="keyword2"><span class="keyword">where</span></span> x<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">=</span> <span class="main">(</span><span class="skolem">p</span><span class="main">,</span><span class="skolem">q</span><span class="main">)</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">p</span><span class="main">,</span><span class="skolem">z</span><span class="main">)</span> <span class="main">∈</span> b"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">z</span><span class="main">,</span><span class="skolem">q</span><span class="main">)</span> <span class="main">∈</span> ov<span class="main">^-1</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="main">(</span><span class="skolem">p</span><span class="main">,</span><span class="skolem">z</span><span class="main">)</span> <span class="main">∈</span> b›</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">c</span></span> <span class="keyword2"><span class="keyword">where</span></span> pc<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">p</span><span class="main">∥</span><span class="skolem">c</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> cz<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">c</span><span class="main">∥</span><span class="skolem">z</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> b <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">a</span></span> <span class="keyword2"><span class="keyword">where</span></span> ap<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">a</span><span class="main">∥</span><span class="skolem">p</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> M3 meets_wd pc <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="main">(</span><span class="skolem">z</span><span class="main">,</span><span class="skolem">q</span><span class="main">)</span> <span class="main">∈</span> ov<span class="main">^-1</span>›</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">k</span></span> <span class="skolem"><span class="skolem">l</span></span> <span class="skolem"><span class="skolem">u</span></span> <span class="skolem"><span class="skolem">v</span></span> <span class="skolem"><span class="skolem">w</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">k</span><span class="main">∥</span><span class="skolem">l</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> lz<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">l</span><span class="main">∥</span><span class="skolem">z</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> kq<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">k</span><span class="main">∥</span><span class="skolem">q</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> zv<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">z</span><span class="main">∥</span><span class="skolem">v</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> qu<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">q</span><span class="main">∥</span><span class="skolem">u</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> uv<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">u</span><span class="main">∥</span><span class="skolem">v</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> lw<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">l</span><span class="main">∥</span><span class="skolem">w</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> wu<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">w</span><span class="main">∥</span><span class="skolem">u</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> ov  <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">from</span></span> cz lz lw <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">c</span><span class="main">∥</span><span class="skolem">w</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> M1 <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">with</span></span> pc wu <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">cw</span></span> <span class="keyword2"><span class="keyword">where</span></span> pcw<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">p</span><span class="main">∥</span><span class="skolem">cw</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> cwu<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">cw</span><span class="main">∥</span><span class="skolem">u</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> M5exist_var <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">from</span></span> ap kq  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">a</span><span class="main">∥</span><span class="skolem">q</span> <span class="main">⊕</span> <span class="main">(</span><span class="main">(</span><span class="main">∃</span><span class="bound">t</span><span class="main">.</span> <span class="skolem">a</span><span class="main">∥</span><span class="bound">t</span> <span class="main">∧</span> <span class="bound">t</span><span class="main">∥</span><span class="skolem">q</span><span class="main">)</span> <span class="main">⊕</span> <span class="main">(</span><span class="main">∃</span><span class="bound">t</span><span class="main">.</span> <span class="skolem">k</span><span class="main">∥</span><span class="bound">t</span> <span class="main">∧</span> <span class="bound">t</span><span class="main">∥</span><span class="skolem">p</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">is</span></span> <span class="quoted"><span class="quoted">"<span class="var">?A</span> <span class="main">⊕</span> <span class="main">(</span><span class="var">?B</span> <span class="main">⊕</span> <span class="var">?C</span><span class="main">)</span>"</span></span><span class="main">)</span> <span class="keyword1"><span class="command">using</span></span> M2 <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="var">?A</span><span class="main">∧</span><span class="main">¬</span><span class="var">?B</span><span class="main">∧</span><span class="main">¬</span><span class="var">?C</span><span class="main">)</span> <span class="main">∨</span> <span class="main">(</span><span class="main">(</span><span class="main">¬</span><span class="var">?A</span><span class="main">∧</span><span class="var">?B</span><span class="main">∧</span><span class="main">¬</span><span class="var">?C</span><span class="main">)</span> <span class="main">∨</span> <span class="main">(</span><span class="main">¬</span><span class="var">?A</span><span class="main">∧</span><span class="main">¬</span><span class="var">?B</span><span class="main">∧</span><span class="var">?C</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">insert</span> xor_distr_L<span class="main"><span class="main">[</span></span><span class="operator">of</span> <span class="var"><span class="quoted"><span class="var">?A</span></span></span> <span class="var"><span class="quoted"><span class="var">?B</span></span></span> <span class="var"><span class="quoted"><span class="var">?C</span></span></span><span class="main"><span class="main">]</span></span><span class="main"><span class="keyword3">,</span></span> <span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span>elimmeets<span class="main">)</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">∈</span> b <span class="main">∪</span> m <span class="main">∪</span> ov <span class="main">∪</span> s <span class="main">∪</span> d"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">elim</span> disjE<span class="main">)</span>
      <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="var">?A</span><span class="main">∧</span><span class="main">¬</span><span class="var">?B</span><span class="main">∧</span><span class="main">¬</span><span class="var">?C</span>"</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="var"><span class="quoted"><span class="var">?A</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
        <span class="keyword1"><span class="command">with</span></span> ap qu pcw cwu  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">p</span><span class="main">,</span><span class="skolem">q</span><span class="main">)</span> <span class="main">∈</span> s"</span></span> <span class="keyword1"><span class="command">using</span></span> s <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
        <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> x  <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span><span class="keyword1"><span class="command">}</span></span> 
      <span class="keyword1"><span class="command">next</span></span>
      <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span><span class="var">?A</span><span class="main">∧</span><span class="var">?B</span><span class="main">∧</span><span class="main">¬</span><span class="var">?C</span>"</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="var"><span class="quoted"><span class="var">?B</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span> 
        <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">t</span></span> <span class="keyword2"><span class="keyword">where</span></span> at<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">a</span><span class="main">∥</span><span class="skolem">t</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> tq<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">t</span><span class="main">∥</span><span class="skolem">q</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword1"><span class="command">from</span></span> pc  tq <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">p</span><span class="main">∥</span><span class="skolem">q</span> <span class="main">⊕</span> <span class="main">(</span><span class="main">(</span><span class="main">∃</span><span class="bound">t'</span><span class="main">.</span> <span class="skolem">p</span><span class="main">∥</span><span class="bound">t'</span> <span class="main">∧</span> <span class="bound">t'</span><span class="main">∥</span><span class="skolem">q</span><span class="main">)</span> <span class="main">⊕</span> <span class="main">(</span><span class="main">∃</span><span class="bound">t'</span><span class="main">.</span> <span class="skolem">t</span><span class="main">∥</span><span class="bound">t'</span> <span class="main">∧</span> <span class="bound">t'</span><span class="main">∥</span><span class="skolem">c</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">is</span></span> <span class="quoted"><span class="quoted">"<span class="var">?A</span> <span class="main">⊕</span> <span class="main">(</span><span class="var">?B</span> <span class="main">⊕</span> <span class="var">?C</span><span class="main">)</span>"</span></span><span class="main">)</span> <span class="keyword1"><span class="command">using</span></span> M2 <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
        <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="var">?A</span><span class="main">∧</span><span class="main">¬</span><span class="var">?B</span><span class="main">∧</span><span class="main">¬</span><span class="var">?C</span><span class="main">)</span> <span class="main">∨</span> <span class="main">(</span><span class="main">(</span><span class="main">¬</span><span class="var">?A</span><span class="main">∧</span><span class="var">?B</span><span class="main">∧</span><span class="main">¬</span><span class="var">?C</span><span class="main">)</span> <span class="main">∨</span> <span class="main">(</span><span class="main">¬</span><span class="var">?A</span><span class="main">∧</span><span class="main">¬</span><span class="var">?B</span><span class="main">∧</span><span class="var">?C</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">insert</span> xor_distr_L<span class="main"><span class="main">[</span></span><span class="operator">of</span> <span class="var"><span class="quoted"><span class="var">?A</span></span></span> <span class="var"><span class="quoted"><span class="var">?B</span></span></span> <span class="var"><span class="quoted"><span class="var">?C</span></span></span><span class="main"><span class="main">]</span></span><span class="main"><span class="keyword3">,</span></span> <span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span>elimmeets<span class="main">)</span>
        <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">∈</span> b <span class="main">∪</span> m <span class="main">∪</span> ov <span class="main">∪</span> s <span class="main">∪</span> d"</span></span>
        <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">elim</span> disjE<span class="main">)</span>
           <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="var">?A</span><span class="main">∧</span><span class="main">¬</span><span class="var">?B</span><span class="main">∧</span><span class="main">¬</span><span class="var">?C</span>"</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="var"><span class="quoted"><span class="var">?A</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
             <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> x m <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span><span class="keyword1"><span class="command">}</span></span>
           <span class="keyword1"><span class="command">next</span></span>
           <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span><span class="var">?A</span><span class="main">∧</span><span class="var">?B</span><span class="main">∧</span><span class="main">¬</span><span class="var">?C</span>"</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="var"><span class="quoted"><span class="var">?B</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
             <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> x b <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span><span class="keyword1"><span class="command">}</span></span>
           <span class="keyword1"><span class="command">next</span></span>
           <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span><span class="var">?A</span> <span class="main">∧</span> <span class="main">¬</span><span class="var">?B</span> <span class="main">∧</span> <span class="var">?C</span>"</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="var"><span class="quoted"><span class="var">?C</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
             <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">t'</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">t</span><span class="main">∥</span><span class="skolem">t'</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">t'</span><span class="main">∥</span><span class="skolem">c</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
             <span class="keyword1"><span class="command">with</span></span> pc pcw <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">t'</span><span class="main">∥</span><span class="skolem">cw</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> M1 <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
             <span class="keyword1"><span class="command">with</span></span> at tq ap pcw cwu qu <span class="quoted"><span class="quoted">‹<span class="skolem">t</span><span class="main">∥</span><span class="skolem">t'</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">p</span><span class="main">,</span><span class="skolem">q</span><span class="main">)</span><span class="main">∈</span>ov"</span></span> <span class="keyword1"><span class="command">using</span></span> ov <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
             <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> x <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span><span class="keyword1"><span class="command">}</span></span>
        <span class="keyword1"><span class="command">qed</span></span>
        <span class="keyword1"><span class="command">}</span></span>  
      <span class="keyword1"><span class="command">next</span></span>
      <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span><span class="var">?A</span> <span class="main">∧</span> <span class="main">¬</span><span class="var">?B</span> <span class="main">∧</span> <span class="var">?C</span>"</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="var"><span class="quoted"><span class="var">?C</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
        <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">t</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">k</span><span class="main">∥</span><span class="skolem">t</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">t</span><span class="main">∥</span><span class="skolem">p</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword1"><span class="command">with</span></span> kq pcw cwu  qu <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">p</span><span class="main">,</span><span class="skolem">q</span><span class="main">)</span> <span class="main">∈</span> d"</span></span> <span class="keyword1"><span class="command">using</span></span> d <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
        <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> x  <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span><span class="keyword1"><span class="command">}</span></span>
       <span class="keyword1"><span class="command">qed</span></span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">lemma</span></span> cbmi<span class="main">:</span><span class="quoted"><span class="quoted">"b <span class="keyword1">O</span> m<span class="main">^-1</span> <span class="main">⊆</span> b <span class="main">∪</span> m <span class="main">∪</span> ov <span class="main">∪</span> s <span class="main">∪</span> d"</span></span>
<span class="keyword1"><span class="command">proof</span></span> 
   <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">x</span><span class="main">::</span><span class="quoted"><span class="quoted">"<span class="tfree">'a</span><span class="main">×</span><span class="tfree">'a</span>"</span></span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">∈</span> b <span class="keyword1">O</span> m<span class="main">^-1</span>"</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">p</span></span> <span class="skolem"><span class="skolem">q</span></span> <span class="skolem"><span class="skolem">z</span></span> <span class="keyword2"><span class="keyword">where</span></span> x<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">=</span> <span class="main">(</span><span class="skolem">p</span><span class="main">,</span><span class="skolem">q</span><span class="main">)</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">p</span><span class="main">,</span><span class="skolem">z</span><span class="main">)</span> <span class="main">∈</span> b"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">z</span><span class="main">,</span><span class="skolem">q</span><span class="main">)</span> <span class="main">∈</span> m<span class="main">^-1</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
   <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="main">(</span><span class="skolem">p</span><span class="main">,</span><span class="skolem">z</span><span class="main">)</span> <span class="main">∈</span> b›</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">c</span></span> <span class="keyword2"><span class="keyword">where</span></span> pc<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">p</span><span class="main">∥</span><span class="skolem">c</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> cz<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">c</span><span class="main">∥</span><span class="skolem">z</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> b <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
   <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">k</span></span> <span class="keyword2"><span class="keyword">where</span></span> kp<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">k</span><span class="main">∥</span><span class="skolem">p</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> M3 meets_wd pc <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
   <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="main">(</span><span class="skolem">z</span><span class="main">,</span><span class="skolem">q</span><span class="main">)</span> <span class="main">∈</span> m<span class="main">^-1</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> qz<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">q</span><span class="main">∥</span><span class="skolem">z</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> m <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
   <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">k'</span></span> <span class="keyword2"><span class="keyword">where</span></span> kpq<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">k'</span><span class="main">∥</span><span class="skolem">q</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> M3 meets_wd qz <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span> 
   <span class="keyword1"><span class="command">from</span></span> kp kpq  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">k</span><span class="main">∥</span><span class="skolem">q</span> <span class="main">⊕</span> <span class="main">(</span><span class="main">(</span><span class="main">∃</span><span class="bound">t</span><span class="main">.</span> <span class="skolem">k</span><span class="main">∥</span><span class="bound">t</span> <span class="main">∧</span> <span class="bound">t</span><span class="main">∥</span><span class="skolem">q</span><span class="main">)</span> <span class="main">⊕</span> <span class="main">(</span><span class="main">∃</span><span class="bound">t</span><span class="main">.</span> <span class="skolem">k'</span><span class="main">∥</span><span class="bound">t</span> <span class="main">∧</span> <span class="bound">t</span><span class="main">∥</span><span class="skolem">p</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">is</span></span> <span class="quoted"><span class="quoted">"<span class="var">?A</span> <span class="main">⊕</span> <span class="main">(</span><span class="var">?B</span> <span class="main">⊕</span> <span class="var">?C</span><span class="main">)</span>"</span></span><span class="main">)</span> <span class="keyword1"><span class="command">using</span></span> M2 <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
   <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="var">?A</span><span class="main">∧</span><span class="main">¬</span><span class="var">?B</span><span class="main">∧</span><span class="main">¬</span><span class="var">?C</span><span class="main">)</span> <span class="main">∨</span> <span class="main">(</span><span class="main">(</span><span class="main">¬</span><span class="var">?A</span><span class="main">∧</span><span class="var">?B</span><span class="main">∧</span><span class="main">¬</span><span class="var">?C</span><span class="main">)</span> <span class="main">∨</span> <span class="main">(</span><span class="main">¬</span><span class="var">?A</span><span class="main">∧</span><span class="main">¬</span><span class="var">?B</span><span class="main">∧</span><span class="var">?C</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">insert</span> xor_distr_L<span class="main"><span class="main">[</span></span><span class="operator">of</span> <span class="var"><span class="quoted"><span class="var">?A</span></span></span> <span class="var"><span class="quoted"><span class="var">?B</span></span></span> <span class="var"><span class="quoted"><span class="var">?C</span></span></span><span class="main"><span class="main">]</span></span><span class="main"><span class="keyword3">,</span></span> <span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span>elimmeets<span class="main">)</span>
   <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">∈</span> b <span class="main">∪</span> m <span class="main">∪</span> ov <span class="main">∪</span> s <span class="main">∪</span> d"</span></span>
   <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">elim</span> disjE<span class="main">)</span>
      <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="var">?A</span><span class="main">∧</span><span class="main">¬</span><span class="var">?B</span><span class="main">∧</span><span class="main">¬</span><span class="var">?C</span>"</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="var"><span class="quoted"><span class="var">?A</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
        <span class="keyword1"><span class="command">with</span></span> kp pc cz qz  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">p</span><span class="main">,</span><span class="skolem">q</span><span class="main">)</span> <span class="main">∈</span> s"</span></span> <span class="keyword1"><span class="command">using</span></span> s <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
        <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> x  <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span><span class="keyword1"><span class="command">}</span></span> 
      <span class="keyword1"><span class="command">next</span></span>
      <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span><span class="var">?A</span><span class="main">∧</span><span class="var">?B</span><span class="main">∧</span><span class="main">¬</span><span class="var">?C</span>"</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="var"><span class="quoted"><span class="var">?B</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span> 
        <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">t</span></span> <span class="keyword2"><span class="keyword">where</span></span> kt<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">k</span><span class="main">∥</span><span class="skolem">t</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> tq<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">t</span><span class="main">∥</span><span class="skolem">q</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword1"><span class="command">from</span></span> pc tq <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">p</span><span class="main">∥</span><span class="skolem">q</span> <span class="main">⊕</span> <span class="main">(</span><span class="main">(</span><span class="main">∃</span><span class="bound">t'</span><span class="main">.</span> <span class="skolem">p</span><span class="main">∥</span><span class="bound">t'</span> <span class="main">∧</span> <span class="bound">t'</span><span class="main">∥</span><span class="skolem">q</span><span class="main">)</span> <span class="main">⊕</span> <span class="main">(</span><span class="main">∃</span><span class="bound">t'</span><span class="main">.</span> <span class="skolem">t</span><span class="main">∥</span><span class="bound">t'</span> <span class="main">∧</span> <span class="bound">t'</span><span class="main">∥</span><span class="skolem">c</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">is</span></span> <span class="quoted"><span class="quoted">"<span class="var">?A</span> <span class="main">⊕</span> <span class="main">(</span><span class="var">?B</span> <span class="main">⊕</span> <span class="var">?C</span><span class="main">)</span>"</span></span><span class="main">)</span> <span class="keyword1"><span class="command">using</span></span> M2 <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
        <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="var">?A</span><span class="main">∧</span><span class="main">¬</span><span class="var">?B</span><span class="main">∧</span><span class="main">¬</span><span class="var">?C</span><span class="main">)</span> <span class="main">∨</span> <span class="main">(</span><span class="main">(</span><span class="main">¬</span><span class="var">?A</span><span class="main">∧</span><span class="var">?B</span><span class="main">∧</span><span class="main">¬</span><span class="var">?C</span><span class="main">)</span> <span class="main">∨</span> <span class="main">(</span><span class="main">¬</span><span class="var">?A</span><span class="main">∧</span><span class="main">¬</span><span class="var">?B</span><span class="main">∧</span><span class="var">?C</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">insert</span> xor_distr_L<span class="main"><span class="main">[</span></span><span class="operator">of</span> <span class="var"><span class="quoted"><span class="var">?A</span></span></span> <span class="var"><span class="quoted"><span class="var">?B</span></span></span> <span class="var"><span class="quoted"><span class="var">?C</span></span></span><span class="main"><span class="main">]</span></span><span class="main"><span class="keyword3">,</span></span> <span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span>elimmeets<span class="main">)</span>
        <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">∈</span> b <span class="main">∪</span> m <span class="main">∪</span> ov <span class="main">∪</span> s <span class="main">∪</span> d"</span></span>
        <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">elim</span> disjE<span class="main">)</span>
           <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="var">?A</span><span class="main">∧</span><span class="main">¬</span><span class="var">?B</span><span class="main">∧</span><span class="main">¬</span><span class="var">?C</span>"</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="var"><span class="quoted"><span class="var">?A</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
             <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> x m <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span><span class="keyword1"><span class="command">}</span></span>
           <span class="keyword1"><span class="command">next</span></span>
           <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span><span class="var">?A</span><span class="main">∧</span><span class="var">?B</span><span class="main">∧</span><span class="main">¬</span><span class="var">?C</span>"</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="var"><span class="quoted"><span class="var">?B</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
             <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> x b <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span><span class="keyword1"><span class="command">}</span></span>
           <span class="keyword1"><span class="command">next</span></span>
           <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span><span class="var">?A</span> <span class="main">∧</span> <span class="main">¬</span><span class="var">?B</span> <span class="main">∧</span> <span class="var">?C</span>"</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="var"><span class="quoted"><span class="var">?C</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
             <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">t'</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">t</span><span class="main">∥</span><span class="skolem">t'</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">t'</span><span class="main">∥</span><span class="skolem">c</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
             <span class="keyword1"><span class="command">with</span></span> pc cz qz kt tq kp <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">p</span><span class="main">,</span><span class="skolem">q</span><span class="main">)</span> <span class="main">∈</span> ov"</span></span> <span class="keyword1"><span class="command">using</span></span> ov <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
             <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> x <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span><span class="keyword1"><span class="command">}</span></span>
        <span class="keyword1"><span class="command">qed</span></span>
        <span class="keyword1"><span class="command">}</span></span>  
      <span class="keyword1"><span class="command">next</span></span>
      <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span><span class="var">?A</span> <span class="main">∧</span> <span class="main">¬</span><span class="var">?B</span> <span class="main">∧</span> <span class="var">?C</span>"</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="var"><span class="quoted"><span class="var">?C</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
        <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">t</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">k'</span><span class="main">∥</span><span class="skolem">t</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">t</span><span class="main">∥</span><span class="skolem">p</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword1"><span class="command">with</span></span> kpq pc cz qz <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">p</span><span class="main">,</span><span class="skolem">q</span><span class="main">)</span> <span class="main">∈</span> d"</span></span> <span class="keyword1"><span class="command">using</span></span> d <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
        <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> x  <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span><span class="keyword1"><span class="command">}</span></span>
       <span class="keyword1"><span class="command">qed</span></span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">lemma</span></span> cdov<span class="main">:</span><span class="quoted"><span class="quoted">"d <span class="keyword1">O</span> ov <span class="main">⊆</span>b <span class="main">∪</span> m <span class="main">∪</span> ov <span class="main">∪</span> s <span class="main">∪</span> d"</span></span>
<span class="keyword1"><span class="command">proof</span></span>
   <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">x</span><span class="main">::</span><span class="quoted"><span class="quoted">"<span class="tfree">'a</span><span class="main">×</span><span class="tfree">'a</span>"</span></span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">∈</span> d <span class="keyword1">O</span> ov"</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">p</span></span> <span class="skolem"><span class="skolem">q</span></span> <span class="skolem"><span class="skolem">z</span></span> <span class="keyword2"><span class="keyword">where</span></span> x<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">=</span> <span class="main">(</span><span class="skolem">p</span><span class="main">,</span><span class="skolem">q</span><span class="main">)</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">p</span><span class="main">,</span><span class="skolem">z</span><span class="main">)</span> <span class="main">∈</span> d"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">z</span><span class="main">,</span><span class="skolem">q</span><span class="main">)</span> <span class="main">∈</span> ov"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
   <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="main">(</span><span class="skolem">p</span><span class="main">,</span><span class="skolem">z</span><span class="main">)</span> <span class="main">∈</span> d›</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">k</span></span> <span class="skolem"><span class="skolem">l</span></span> <span class="skolem"><span class="skolem">u</span></span> <span class="skolem"><span class="skolem">v</span></span> <span class="keyword2"><span class="keyword">where</span></span> kl<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">k</span><span class="main">∥</span><span class="skolem">l</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> lp<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">l</span><span class="main">∥</span><span class="skolem">p</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> kz<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">k</span><span class="main">∥</span><span class="skolem">z</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> pu<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">p</span><span class="main">∥</span><span class="skolem">u</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> uv<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">u</span><span class="main">∥</span><span class="skolem">v</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> zv<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">z</span><span class="main">∥</span><span class="skolem">v</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> d <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
   <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="main">(</span><span class="skolem">z</span><span class="main">,</span><span class="skolem">q</span><span class="main">)</span> <span class="main">∈</span> ov›</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">k'</span></span> <span class="skolem"><span class="skolem">l'</span></span> <span class="skolem"><span class="skolem">u'</span></span> <span class="skolem"><span class="skolem">v'</span></span> <span class="skolem"><span class="skolem">c</span></span> <span class="keyword2"><span class="keyword">where</span></span> kplp<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">k'</span><span class="main">∥</span><span class="skolem">l'</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> kpz<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">k'</span><span class="main">∥</span><span class="skolem">z</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> lpq<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">l'</span><span class="main">∥</span><span class="skolem">q</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> zup<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">z</span><span class="main">∥</span><span class="skolem">u'</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> upvp<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">u'</span><span class="main">∥</span><span class="skolem">v'</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> qvp<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">q</span><span class="main">∥</span><span class="skolem">v'</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">l'</span><span class="main">∥</span><span class="skolem">c</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">c</span><span class="main">∥</span><span class="skolem">u'</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> ov <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
   <span class="keyword1"><span class="command">from</span></span> zup zv uv <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">u</span><span class="main">∥</span><span class="skolem">u'</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> M1 <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
   <span class="keyword1"><span class="command">with</span></span> pu upvp <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">uu</span></span> <span class="keyword2"><span class="keyword">where</span></span> puu<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">p</span><span class="main">∥</span><span class="skolem">uu</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> uuvp<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">uu</span><span class="main">∥</span><span class="skolem">v'</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> M5exist_var <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
   <span class="keyword1"><span class="command">from</span></span> lp lpq  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">l</span><span class="main">∥</span><span class="skolem">q</span> <span class="main">⊕</span> <span class="main">(</span><span class="main">(</span><span class="main">∃</span><span class="bound">t</span><span class="main">.</span> <span class="skolem">l</span><span class="main">∥</span><span class="bound">t</span> <span class="main">∧</span> <span class="bound">t</span><span class="main">∥</span><span class="skolem">q</span><span class="main">)</span> <span class="main">⊕</span> <span class="main">(</span><span class="main">∃</span><span class="bound">t</span><span class="main">.</span> <span class="skolem">l'</span><span class="main">∥</span><span class="bound">t</span> <span class="main">∧</span> <span class="bound">t</span><span class="main">∥</span><span class="skolem">p</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">is</span></span> <span class="quoted"><span class="quoted">"<span class="var">?A</span> <span class="main">⊕</span> <span class="main">(</span><span class="var">?B</span> <span class="main">⊕</span> <span class="var">?C</span><span class="main">)</span>"</span></span><span class="main">)</span> <span class="keyword1"><span class="command">using</span></span> M2 <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
   <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="var">?A</span><span class="main">∧</span><span class="main">¬</span><span class="var">?B</span><span class="main">∧</span><span class="main">¬</span><span class="var">?C</span><span class="main">)</span> <span class="main">∨</span> <span class="main">(</span><span class="main">(</span><span class="main">¬</span><span class="var">?A</span><span class="main">∧</span><span class="var">?B</span><span class="main">∧</span><span class="main">¬</span><span class="var">?C</span><span class="main">)</span> <span class="main">∨</span> <span class="main">(</span><span class="main">¬</span><span class="var">?A</span><span class="main">∧</span><span class="main">¬</span><span class="var">?B</span><span class="main">∧</span><span class="var">?C</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">insert</span> xor_distr_L<span class="main"><span class="main">[</span></span><span class="operator">of</span> <span class="var"><span class="quoted"><span class="var">?A</span></span></span> <span class="var"><span class="quoted"><span class="var">?B</span></span></span> <span class="var"><span class="quoted"><span class="var">?C</span></span></span><span class="main"><span class="main">]</span></span><span class="main"><span class="keyword3">,</span></span> <span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span>elimmeets<span class="main">)</span>
   <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">∈</span> b <span class="main">∪</span> m <span class="main">∪</span> ov <span class="main">∪</span> s <span class="main">∪</span> d"</span></span>
   <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">elim</span> disjE<span class="main">)</span>
      <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="var">?A</span><span class="main">∧</span><span class="main">¬</span><span class="var">?B</span><span class="main">∧</span><span class="main">¬</span><span class="var">?C</span>"</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="var"><span class="quoted"><span class="var">?A</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
        <span class="keyword1"><span class="command">with</span></span> lp puu uuvp qvp  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">p</span><span class="main">,</span><span class="skolem">q</span><span class="main">)</span> <span class="main">∈</span> s"</span></span> <span class="keyword1"><span class="command">using</span></span> s <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
        <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> x  <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span><span class="keyword1"><span class="command">}</span></span> 
      <span class="keyword1"><span class="command">next</span></span>
      <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span><span class="var">?A</span><span class="main">∧</span><span class="var">?B</span><span class="main">∧</span><span class="main">¬</span><span class="var">?C</span>"</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="var"><span class="quoted"><span class="var">?B</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span> 
        <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">t</span></span> <span class="keyword2"><span class="keyword">where</span></span> lt<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">l</span><span class="main">∥</span><span class="skolem">t</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> tq<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">t</span><span class="main">∥</span><span class="skolem">q</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword1"><span class="command">from</span></span> pu tq <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">p</span><span class="main">∥</span><span class="skolem">q</span> <span class="main">⊕</span> <span class="main">(</span><span class="main">(</span><span class="main">∃</span><span class="bound">t'</span><span class="main">.</span> <span class="skolem">p</span><span class="main">∥</span><span class="bound">t'</span> <span class="main">∧</span> <span class="bound">t'</span><span class="main">∥</span><span class="skolem">q</span><span class="main">)</span> <span class="main">⊕</span> <span class="main">(</span><span class="main">∃</span><span class="bound">t'</span><span class="main">.</span> <span class="skolem">t</span><span class="main">∥</span><span class="bound">t'</span> <span class="main">∧</span> <span class="bound">t'</span><span class="main">∥</span><span class="skolem">u</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">is</span></span> <span class="quoted"><span class="quoted">"<span class="var">?A</span> <span class="main">⊕</span> <span class="main">(</span><span class="var">?B</span> <span class="main">⊕</span> <span class="var">?C</span><span class="main">)</span>"</span></span><span class="main">)</span> <span class="keyword1"><span class="command">using</span></span> M2 <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
        <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="var">?A</span><span class="main">∧</span><span class="main">¬</span><span class="var">?B</span><span class="main">∧</span><span class="main">¬</span><span class="var">?C</span><span class="main">)</span> <span class="main">∨</span> <span class="main">(</span><span class="main">(</span><span class="main">¬</span><span class="var">?A</span><span class="main">∧</span><span class="var">?B</span><span class="main">∧</span><span class="main">¬</span><span class="var">?C</span><span class="main">)</span> <span class="main">∨</span> <span class="main">(</span><span class="main">¬</span><span class="var">?A</span><span class="main">∧</span><span class="main">¬</span><span class="var">?B</span><span class="main">∧</span><span class="var">?C</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">insert</span> xor_distr_L<span class="main"><span class="main">[</span></span><span class="operator">of</span> <span class="var"><span class="quoted"><span class="var">?A</span></span></span> <span class="var"><span class="quoted"><span class="var">?B</span></span></span> <span class="var"><span class="quoted"><span class="var">?C</span></span></span><span class="main"><span class="main">]</span></span><span class="main"><span class="keyword3">,</span></span> <span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span>elimmeets<span class="main">)</span>
        <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">∈</span> b <span class="main">∪</span> m <span class="main">∪</span> ov <span class="main">∪</span> s <span class="main">∪</span> d"</span></span>
        <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">elim</span> disjE<span class="main">)</span>
           <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="var">?A</span><span class="main">∧</span><span class="main">¬</span><span class="var">?B</span><span class="main">∧</span><span class="main">¬</span><span class="var">?C</span>"</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="var"><span class="quoted"><span class="var">?A</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
             <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> x m <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span><span class="keyword1"><span class="command">}</span></span>
           <span class="keyword1"><span class="command">next</span></span>
           <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span><span class="var">?A</span><span class="main">∧</span><span class="var">?B</span><span class="main">∧</span><span class="main">¬</span><span class="var">?C</span>"</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="var"><span class="quoted"><span class="var">?B</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
             <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> x b <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span><span class="keyword1"><span class="command">}</span></span>
           <span class="keyword1"><span class="command">next</span></span>
           <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span><span class="var">?A</span> <span class="main">∧</span> <span class="main">¬</span><span class="var">?B</span> <span class="main">∧</span> <span class="var">?C</span>"</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="var"><span class="quoted"><span class="var">?C</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
             <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">t'</span></span> <span class="keyword2"><span class="keyword">where</span></span> ttp<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">t</span><span class="main">∥</span><span class="skolem">t'</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">t'</span><span class="main">∥</span><span class="skolem">u</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
             <span class="keyword1"><span class="command">with</span></span> pu puu <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">t'</span><span class="main">∥</span><span class="skolem">uu</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> M1 <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
             <span class="keyword1"><span class="command">with</span></span> lp puu qvp uuvp lt tq  ttp <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">p</span><span class="main">,</span><span class="skolem">q</span><span class="main">)</span> <span class="main">∈</span> ov"</span></span> <span class="keyword1"><span class="command">using</span></span> ov <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
             <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> x <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span><span class="keyword1"><span class="command">}</span></span>
        <span class="keyword1"><span class="command">qed</span></span>
        <span class="keyword1"><span class="command">}</span></span>  
      <span class="keyword1"><span class="command">next</span></span>
      <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span><span class="var">?A</span> <span class="main">∧</span> <span class="main">¬</span><span class="var">?B</span> <span class="main">∧</span> <span class="var">?C</span>"</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="var"><span class="quoted"><span class="var">?C</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
        <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">t</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">l'</span><span class="main">∥</span><span class="skolem">t</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">t</span><span class="main">∥</span><span class="skolem">p</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
         <span class="keyword1"><span class="command">with</span></span> lpq puu uuvp qvp <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">p</span><span class="main">,</span><span class="skolem">q</span><span class="main">)</span> <span class="main">∈</span> d"</span></span> <span class="keyword1"><span class="command">using</span></span> d <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
        <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> x  <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span><span class="keyword1"><span class="command">}</span></span>
       <span class="keyword1"><span class="command">qed</span></span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">lemma</span></span> cdfi<span class="main">:</span><span class="quoted"><span class="quoted">"d <span class="keyword1">O</span> f<span class="main">^-1</span> <span class="main">⊆</span> b <span class="main">∪</span> m <span class="main">∪</span> ov <span class="main">∪</span> s <span class="main">∪</span> d"</span></span>
<span class="keyword1"><span class="command">proof</span></span>
   <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">x</span><span class="main">::</span><span class="quoted"><span class="quoted">"<span class="tfree">'a</span><span class="main">×</span><span class="tfree">'a</span>"</span></span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">∈</span> d <span class="keyword1">O</span> f<span class="main">^-1</span>"</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">p</span></span> <span class="skolem"><span class="skolem">q</span></span> <span class="skolem"><span class="skolem">z</span></span> <span class="keyword2"><span class="keyword">where</span></span> x<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">=</span> <span class="main">(</span><span class="skolem">p</span><span class="main">,</span><span class="skolem">q</span><span class="main">)</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">p</span><span class="main">,</span><span class="skolem">z</span><span class="main">)</span> <span class="main">∈</span> d"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">z</span><span class="main">,</span><span class="skolem">q</span><span class="main">)</span> <span class="main">∈</span> f<span class="main">^-1</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
   <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="main">(</span><span class="skolem">p</span><span class="main">,</span><span class="skolem">z</span><span class="main">)</span> <span class="main">∈</span> d›</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">k</span></span> <span class="skolem"><span class="skolem">l</span></span> <span class="skolem"><span class="skolem">u</span></span> <span class="skolem"><span class="skolem">v</span></span> <span class="keyword2"><span class="keyword">where</span></span> kl<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">k</span><span class="main">∥</span><span class="skolem">l</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> lp<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">l</span><span class="main">∥</span><span class="skolem">p</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> kz<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">k</span><span class="main">∥</span><span class="skolem">z</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> pu<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">p</span><span class="main">∥</span><span class="skolem">u</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> uv<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">u</span><span class="main">∥</span><span class="skolem">v</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> zv<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">z</span><span class="main">∥</span><span class="skolem">v</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> d <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
   <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="main">(</span><span class="skolem">z</span><span class="main">,</span><span class="skolem">q</span><span class="main">)</span> <span class="main">∈</span> f<span class="main">^-1</span>›</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">k'</span></span> <span class="skolem"><span class="skolem">l'</span></span> <span class="skolem"><span class="skolem">u'</span></span>  <span class="keyword2"><span class="keyword">where</span></span> kpz<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">k'</span><span class="main">∥</span><span class="skolem">z</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> kplp<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">k'</span><span class="main">∥</span><span class="skolem">l'</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> lpq<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">l'</span><span class="main">∥</span><span class="skolem">q</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> zup<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">z</span><span class="main">∥</span><span class="skolem">u'</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span>  qup<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">q</span><span class="main">∥</span><span class="skolem">u'</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> f <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
   <span class="keyword1"><span class="command">from</span></span> zup zv uv <span class="keyword1"><span class="command">have</span></span> uup<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">u</span><span class="main">∥</span><span class="skolem">u'</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> M1 <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
   <span class="keyword1"><span class="command">from</span></span> lp lpq  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">l</span><span class="main">∥</span><span class="skolem">q</span> <span class="main">⊕</span> <span class="main">(</span><span class="main">(</span><span class="main">∃</span><span class="bound">t</span><span class="main">.</span> <span class="skolem">l</span><span class="main">∥</span><span class="bound">t</span> <span class="main">∧</span> <span class="bound">t</span><span class="main">∥</span><span class="skolem">q</span><span class="main">)</span> <span class="main">⊕</span> <span class="main">(</span><span class="main">∃</span><span class="bound">t</span><span class="main">.</span> <span class="skolem">l'</span><span class="main">∥</span><span class="bound">t</span> <span class="main">∧</span> <span class="bound">t</span><span class="main">∥</span><span class="skolem">p</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">is</span></span> <span class="quoted"><span class="quoted">"<span class="var">?A</span> <span class="main">⊕</span> <span class="main">(</span><span class="var">?B</span> <span class="main">⊕</span> <span class="var">?C</span><span class="main">)</span>"</span></span><span class="main">)</span> <span class="keyword1"><span class="command">using</span></span> M2 <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
   <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="var">?A</span><span class="main">∧</span><span class="main">¬</span><span class="var">?B</span><span class="main">∧</span><span class="main">¬</span><span class="var">?C</span><span class="main">)</span> <span class="main">∨</span> <span class="main">(</span><span class="main">(</span><span class="main">¬</span><span class="var">?A</span><span class="main">∧</span><span class="var">?B</span><span class="main">∧</span><span class="main">¬</span><span class="var">?C</span><span class="main">)</span> <span class="main">∨</span> <span class="main">(</span><span class="main">¬</span><span class="var">?A</span><span class="main">∧</span><span class="main">¬</span><span class="var">?B</span><span class="main">∧</span><span class="var">?C</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">insert</span> xor_distr_L<span class="main"><span class="main">[</span></span><span class="operator">of</span> <span class="var"><span class="quoted"><span class="var">?A</span></span></span> <span class="var"><span class="quoted"><span class="var">?B</span></span></span> <span class="var"><span class="quoted"><span class="var">?C</span></span></span><span class="main"><span class="main">]</span></span><span class="main"><span class="keyword3">,</span></span> <span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span>elimmeets<span class="main">)</span>
   <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">∈</span> b <span class="main">∪</span> m <span class="main">∪</span> ov <span class="main">∪</span> s <span class="main">∪</span> d"</span></span>
   <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">elim</span> disjE<span class="main">)</span>
      <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="var">?A</span><span class="main">∧</span><span class="main">¬</span><span class="var">?B</span><span class="main">∧</span><span class="main">¬</span><span class="var">?C</span>"</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="var"><span class="quoted"><span class="var">?A</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
        <span class="keyword1"><span class="command">with</span></span> lp pu uup qup  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">p</span><span class="main">,</span><span class="skolem">q</span><span class="main">)</span> <span class="main">∈</span> s"</span></span> <span class="keyword1"><span class="command">using</span></span> s <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
        <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> x  <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span><span class="keyword1"><span class="command">}</span></span> 
      <span class="keyword1"><span class="command">next</span></span>
      <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span><span class="var">?A</span><span class="main">∧</span><span class="var">?B</span><span class="main">∧</span><span class="main">¬</span><span class="var">?C</span>"</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="var"><span class="quoted"><span class="var">?B</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span> 
        <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">t</span></span> <span class="keyword2"><span class="keyword">where</span></span> lt<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">l</span><span class="main">∥</span><span class="skolem">t</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> tq<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">t</span><span class="main">∥</span><span class="skolem">q</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword1"><span class="command">from</span></span> pu tq <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">p</span><span class="main">∥</span><span class="skolem">q</span> <span class="main">⊕</span> <span class="main">(</span><span class="main">(</span><span class="main">∃</span><span class="bound">t'</span><span class="main">.</span> <span class="skolem">p</span><span class="main">∥</span><span class="bound">t'</span> <span class="main">∧</span> <span class="bound">t'</span><span class="main">∥</span><span class="skolem">q</span><span class="main">)</span> <span class="main">⊕</span> <span class="main">(</span><span class="main">∃</span><span class="bound">t'</span><span class="main">.</span> <span class="skolem">t</span><span class="main">∥</span><span class="bound">t'</span> <span class="main">∧</span> <span class="bound">t'</span><span class="main">∥</span><span class="skolem">u</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">is</span></span> <span class="quoted"><span class="quoted">"<span class="var">?A</span> <span class="main">⊕</span> <span class="main">(</span><span class="var">?B</span> <span class="main">⊕</span> <span class="var">?C</span><span class="main">)</span>"</span></span><span class="main">)</span> <span class="keyword1"><span class="command">using</span></span> M2 <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
        <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="var">?A</span><span class="main">∧</span><span class="main">¬</span><span class="var">?B</span><span class="main">∧</span><span class="main">¬</span><span class="var">?C</span><span class="main">)</span> <span class="main">∨</span> <span class="main">(</span><span class="main">(</span><span class="main">¬</span><span class="var">?A</span><span class="main">∧</span><span class="var">?B</span><span class="main">∧</span><span class="main">¬</span><span class="var">?C</span><span class="main">)</span> <span class="main">∨</span> <span class="main">(</span><span class="main">¬</span><span class="var">?A</span><span class="main">∧</span><span class="main">¬</span><span class="var">?B</span><span class="main">∧</span><span class="var">?C</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">insert</span> xor_distr_L<span class="main"><span class="main">[</span></span><span class="operator">of</span> <span class="var"><span class="quoted"><span class="var">?A</span></span></span> <span class="var"><span class="quoted"><span class="var">?B</span></span></span> <span class="var"><span class="quoted"><span class="var">?C</span></span></span><span class="main"><span class="main">]</span></span><span class="main"><span class="keyword3">,</span></span> <span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span>elimmeets<span class="main">)</span>
        <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">∈</span> b <span class="main">∪</span> m <span class="main">∪</span> ov <span class="main">∪</span> s <span class="main">∪</span> d"</span></span>
        <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">elim</span> disjE<span class="main">)</span>
           <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="var">?A</span><span class="main">∧</span><span class="main">¬</span><span class="var">?B</span><span class="main">∧</span><span class="main">¬</span><span class="var">?C</span>"</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="var"><span class="quoted"><span class="var">?A</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
             <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> x m <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span><span class="keyword1"><span class="command">}</span></span>
           <span class="keyword1"><span class="command">next</span></span>
           <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span><span class="var">?A</span><span class="main">∧</span><span class="var">?B</span><span class="main">∧</span><span class="main">¬</span><span class="var">?C</span>"</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="var"><span class="quoted"><span class="var">?B</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
             <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> x b <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span><span class="keyword1"><span class="command">}</span></span>
           <span class="keyword1"><span class="command">next</span></span>
           <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span><span class="var">?A</span> <span class="main">∧</span> <span class="main">¬</span><span class="var">?B</span> <span class="main">∧</span> <span class="var">?C</span>"</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="var"><span class="quoted"><span class="var">?C</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
             <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">t'</span></span> <span class="keyword2"><span class="keyword">where</span></span> ttp<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">t</span><span class="main">∥</span><span class="skolem">t'</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> tpu<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">t'</span><span class="main">∥</span><span class="skolem">u</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
             <span class="keyword1"><span class="command">with</span></span> lt tq lp pu uup qup  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">p</span><span class="main">,</span><span class="skolem">q</span><span class="main">)</span> <span class="main">∈</span> ov"</span></span> <span class="keyword1"><span class="command">using</span></span> ov <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
             <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> x <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span><span class="keyword1"><span class="command">}</span></span>
        <span class="keyword1"><span class="command">qed</span></span>
        <span class="keyword1"><span class="command">}</span></span>  
      <span class="keyword1"><span class="command">next</span></span>
      <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span><span class="var">?A</span> <span class="main">∧</span> <span class="main">¬</span><span class="var">?B</span> <span class="main">∧</span> <span class="var">?C</span>"</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="var"><span class="quoted"><span class="var">?C</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
        <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">t</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">l'</span><span class="main">∥</span><span class="skolem">t</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">t</span><span class="main">∥</span><span class="skolem">p</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword1"><span class="command">with</span></span> lpq pu uup qup  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">p</span><span class="main">,</span><span class="skolem">q</span><span class="main">)</span> <span class="main">∈</span> d"</span></span> <span class="keyword1"><span class="command">using</span></span> d <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
        <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> x  <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span><span class="keyword1"><span class="command">}</span></span>
       <span class="keyword1"><span class="command">qed</span></span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="comment1">(* =========$\beta_2$ composition ==========*)</span>
<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹We prove compositions of the form $r_1 \circ r_2 \subseteq b \cup m \cup ov \cup f^{-1} \cup d^{-1}$.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> covdi<span class="main">:</span><span class="quoted"><span class="quoted">"ov <span class="keyword1">O</span> d<span class="main">^-1</span> <span class="main">⊆</span> b <span class="main">∪</span> m <span class="main">∪</span> ov <span class="main">∪</span> f<span class="main">^-1</span> <span class="main">∪</span> d<span class="main">^-1</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span>
  <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">x</span><span class="main">::</span><span class="quoted"><span class="quoted">"<span class="tfree">'a</span><span class="main">×</span><span class="tfree">'a</span>"</span></span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">∈</span> ov <span class="keyword1">O</span> d<span class="main">^-1</span>"</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">p</span></span> <span class="skolem"><span class="skolem">q</span></span> <span class="skolem"><span class="skolem">z</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">p</span><span class="main">,</span><span class="skolem">z</span><span class="main">)</span> <span class="main">:</span> ov"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">z</span><span class="main">,</span><span class="skolem">q</span><span class="main">)</span> <span class="main">:</span> d<span class="main">^-1</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> x<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">=</span> <span class="main">(</span><span class="skolem">p</span><span class="main">,</span><span class="skolem">q</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="main">(</span><span class="skolem">p</span><span class="main">,</span><span class="skolem">z</span><span class="main">)</span> <span class="main">:</span> ov›</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">k</span></span> <span class="skolem"><span class="skolem">l</span></span> <span class="skolem"><span class="skolem">u</span></span> <span class="skolem"><span class="skolem">v</span></span> <span class="skolem"><span class="skolem">c</span></span>  <span class="keyword2"><span class="keyword">where</span></span> kp<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">k</span><span class="main">∥</span><span class="skolem">p</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> kl<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">k</span><span class="main">∥</span><span class="skolem">l</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> lz<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">l</span><span class="main">∥</span><span class="skolem">z</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> pu<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">p</span><span class="main">∥</span><span class="skolem">u</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> uv<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">u</span><span class="main">∥</span><span class="skolem">v</span>"</span></span>  <span class="keyword2"><span class="keyword">and</span></span> zv<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">z</span><span class="main">∥</span><span class="skolem">v</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> lc<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">l</span><span class="main">∥</span><span class="skolem">c</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> cu<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">c</span><span class="main">∥</span><span class="skolem">u</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> ov <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="main">(</span><span class="skolem">z</span><span class="main">,</span><span class="skolem">q</span><span class="main">)</span> <span class="main">:</span> d<span class="main">^-1</span>›</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">l'</span></span> <span class="skolem"><span class="skolem">k'</span></span> <span class="skolem"><span class="skolem">u'</span></span> <span class="skolem"><span class="skolem">v'</span></span>  <span class="keyword2"><span class="keyword">where</span></span> lpq<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">l'</span><span class="main">∥</span><span class="skolem">q</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> kplp<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">k'</span><span class="main">∥</span><span class="skolem">l'</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> kpz<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">k'</span><span class="main">∥</span><span class="skolem">z</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> qup<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">q</span><span class="main">∥</span><span class="skolem">u'</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> upvp<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">u'</span><span class="main">∥</span><span class="skolem">v'</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> zvp<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">z</span><span class="main">∥</span><span class="skolem">v'</span>"</span></span>  <span class="keyword1"><span class="command">using</span></span> d  <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">from</span></span> lz kpz kplp <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">l</span><span class="main">∥</span><span class="skolem">l'</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> M1 <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">with</span></span> kl lpq <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">ll</span></span> <span class="keyword2"><span class="keyword">where</span></span> kll<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">k</span><span class="main">∥</span><span class="skolem">ll</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> llq<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">ll</span><span class="main">∥</span><span class="skolem">q</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> M5exist_var <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">from</span></span> pu qup  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">p</span><span class="main">∥</span><span class="skolem">u'</span> <span class="main">⊕</span> <span class="main">(</span><span class="main">(</span><span class="main">∃</span><span class="bound">t</span><span class="main">.</span> <span class="skolem">p</span><span class="main">∥</span><span class="bound">t</span> <span class="main">∧</span> <span class="bound">t</span><span class="main">∥</span><span class="skolem">u'</span><span class="main">)</span> <span class="main">⊕</span> <span class="main">(</span><span class="main">∃</span><span class="bound">t</span><span class="main">.</span> <span class="skolem">q</span><span class="main">∥</span><span class="bound">t</span> <span class="main">∧</span> <span class="bound">t</span><span class="main">∥</span><span class="skolem">u</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">is</span></span> <span class="quoted"><span class="quoted">"<span class="var">?A</span> <span class="main">⊕</span> <span class="main">(</span><span class="var">?B</span> <span class="main">⊕</span> <span class="var">?C</span><span class="main">)</span>"</span></span><span class="main">)</span> <span class="keyword1"><span class="command">using</span></span> M2 <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="var">?A</span><span class="main">∧</span><span class="main">¬</span><span class="var">?B</span><span class="main">∧</span><span class="main">¬</span><span class="var">?C</span><span class="main">)</span> <span class="main">∨</span> <span class="main">(</span><span class="main">(</span><span class="main">¬</span><span class="var">?A</span><span class="main">∧</span><span class="var">?B</span><span class="main">∧</span><span class="main">¬</span><span class="var">?C</span><span class="main">)</span> <span class="main">∨</span> <span class="main">(</span><span class="main">¬</span><span class="var">?A</span><span class="main">∧</span><span class="main">¬</span><span class="var">?B</span><span class="main">∧</span><span class="var">?C</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">insert</span> xor_distr_L<span class="main"><span class="main">[</span></span><span class="operator">of</span> <span class="var"><span class="quoted"><span class="var">?A</span></span></span> <span class="var"><span class="quoted"><span class="var">?B</span></span></span> <span class="var"><span class="quoted"><span class="var">?C</span></span></span><span class="main"><span class="main">]</span></span><span class="main"><span class="keyword3">,</span></span> <span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span>elimmeets<span class="main">)</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">∈</span> b <span class="main">∪</span> m <span class="main">∪</span> ov <span class="main">∪</span> f<span class="main">^-1</span> <span class="main">∪</span> d<span class="main">^-1</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">elim</span> disjE<span class="main">)</span>
      <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="var">?A</span><span class="main">∧</span><span class="main">¬</span><span class="var">?B</span><span class="main">∧</span><span class="main">¬</span><span class="var">?C</span>"</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="var"><span class="quoted"><span class="var">?A</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
        <span class="keyword1"><span class="command">with</span></span> qup kll llq kp  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">p</span><span class="main">,</span><span class="skolem">q</span><span class="main">)</span> <span class="main">∈</span> f<span class="main">^-1</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> f <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
        <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> x  <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span><span class="keyword1"><span class="command">}</span></span> 
      <span class="keyword1"><span class="command">next</span></span>
      <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span><span class="var">?A</span><span class="main">∧</span><span class="var">?B</span><span class="main">∧</span><span class="main">¬</span><span class="var">?C</span>"</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="var"><span class="quoted"><span class="var">?B</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span> 
        <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">t</span></span> <span class="keyword2"><span class="keyword">where</span></span> pt<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">p</span><span class="main">∥</span><span class="skolem">t</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> tup<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">t</span><span class="main">∥</span><span class="skolem">u'</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword1"><span class="command">from</span></span> pt lpq <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">p</span><span class="main">∥</span><span class="skolem">q</span> <span class="main">⊕</span> <span class="main">(</span><span class="main">(</span><span class="main">∃</span><span class="bound">t'</span><span class="main">.</span> <span class="skolem">p</span><span class="main">∥</span><span class="bound">t'</span> <span class="main">∧</span> <span class="bound">t'</span><span class="main">∥</span><span class="skolem">q</span><span class="main">)</span> <span class="main">⊕</span> <span class="main">(</span><span class="main">∃</span><span class="bound">t'</span><span class="main">.</span> <span class="skolem">l'</span><span class="main">∥</span><span class="bound">t'</span> <span class="main">∧</span> <span class="bound">t'</span><span class="main">∥</span><span class="skolem">t</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">is</span></span> <span class="quoted"><span class="quoted">"<span class="var">?A</span> <span class="main">⊕</span> <span class="main">(</span><span class="var">?B</span> <span class="main">⊕</span> <span class="var">?C</span><span class="main">)</span>"</span></span><span class="main">)</span> <span class="keyword1"><span class="command">using</span></span> M2 <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
        <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="var">?A</span><span class="main">∧</span><span class="main">¬</span><span class="var">?B</span><span class="main">∧</span><span class="main">¬</span><span class="var">?C</span><span class="main">)</span> <span class="main">∨</span> <span class="main">(</span><span class="main">(</span><span class="main">¬</span><span class="var">?A</span><span class="main">∧</span><span class="var">?B</span><span class="main">∧</span><span class="main">¬</span><span class="var">?C</span><span class="main">)</span> <span class="main">∨</span> <span class="main">(</span><span class="main">¬</span><span class="var">?A</span><span class="main">∧</span><span class="main">¬</span><span class="var">?B</span><span class="main">∧</span><span class="var">?C</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">insert</span> xor_distr_L<span class="main"><span class="main">[</span></span><span class="operator">of</span> <span class="var"><span class="quoted"><span class="var">?A</span></span></span> <span class="var"><span class="quoted"><span class="var">?B</span></span></span> <span class="var"><span class="quoted"><span class="var">?C</span></span></span><span class="main"><span class="main">]</span></span><span class="main"><span class="keyword3">,</span></span> <span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span>elimmeets<span class="main">)</span>
        <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">∈</span> b <span class="main">∪</span> m <span class="main">∪</span> ov <span class="main">∪</span> f<span class="main">^-1</span> <span class="main">∪</span> d<span class="main">^-1</span>"</span></span>
        <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">elim</span> disjE<span class="main">)</span>
           <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="var">?A</span><span class="main">∧</span><span class="main">¬</span><span class="var">?B</span><span class="main">∧</span><span class="main">¬</span><span class="var">?C</span>"</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="var"><span class="quoted"><span class="var">?A</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
             <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> x m <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span><span class="keyword1"><span class="command">}</span></span>
           <span class="keyword1"><span class="command">next</span></span>
           <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span><span class="var">?A</span><span class="main">∧</span><span class="var">?B</span><span class="main">∧</span><span class="main">¬</span><span class="var">?C</span>"</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="var"><span class="quoted"><span class="var">?B</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
             <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> x b <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span><span class="keyword1"><span class="command">}</span></span>
           <span class="keyword1"><span class="command">next</span></span>
           <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span><span class="var">?A</span> <span class="main">∧</span> <span class="main">¬</span><span class="var">?B</span> <span class="main">∧</span> <span class="var">?C</span>"</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="var"><span class="quoted"><span class="var">?C</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
             <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">t'</span></span> <span class="keyword2"><span class="keyword">where</span></span> lptp<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">l'</span><span class="main">∥</span><span class="skolem">t'</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> tpt<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">t'</span><span class="main">∥</span><span class="skolem">t</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
             <span class="keyword1"><span class="command">from</span></span> lpq lptp llq <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">ll</span><span class="main">∥</span><span class="skolem">t'</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> M1 <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
             <span class="keyword1"><span class="command">with</span></span> kp kll llq pt tup qup tpt  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">p</span><span class="main">,</span><span class="skolem">q</span><span class="main">)</span> <span class="main">∈</span> ov"</span></span> <span class="keyword1"><span class="command">using</span></span> ov <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
             <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> x <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span><span class="keyword1"><span class="command">}</span></span>
        <span class="keyword1"><span class="command">qed</span></span>
        <span class="keyword1"><span class="command">}</span></span>  
      <span class="keyword1"><span class="command">next</span></span>
      <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span><span class="var">?A</span> <span class="main">∧</span> <span class="main">¬</span><span class="var">?B</span> <span class="main">∧</span> <span class="var">?C</span>"</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="var"><span class="quoted"><span class="var">?C</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
        <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">t</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">q</span><span class="main">∥</span><span class="skolem">t</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">t</span><span class="main">∥</span><span class="skolem">u</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword1"><span class="command">with</span></span> pu kll llq kp   <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">p</span><span class="main">,</span><span class="skolem">q</span><span class="main">)</span> <span class="main">∈</span> d<span class="main">^-1</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> d <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
        <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> x  <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span><span class="keyword1"><span class="command">}</span></span>
       <span class="keyword1"><span class="command">qed</span></span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">lemma</span></span> cdib<span class="main">:</span><span class="quoted"><span class="quoted">"d<span class="main">^-1</span> <span class="keyword1">O</span> b <span class="main">⊆</span> b <span class="main">∪</span> m <span class="main">∪</span> ov <span class="main">∪</span> f<span class="main">^-1</span> <span class="main">∪</span> d<span class="main">^-1</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span>
  <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">x</span><span class="main">::</span><span class="quoted"><span class="quoted">"<span class="tfree">'a</span><span class="main">×</span><span class="tfree">'a</span>"</span></span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">∈</span> d<span class="main">^-1</span> <span class="keyword1">O</span> b"</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">p</span></span> <span class="skolem"><span class="skolem">q</span></span> <span class="skolem"><span class="skolem">z</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">p</span><span class="main">,</span><span class="skolem">z</span><span class="main">)</span> <span class="main">:</span> d<span class="main">^-1</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">z</span><span class="main">,</span><span class="skolem">q</span><span class="main">)</span> <span class="main">:</span> b"</span></span> <span class="keyword2"><span class="keyword">and</span></span> x<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">=</span> <span class="main">(</span><span class="skolem">p</span><span class="main">,</span><span class="skolem">q</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="main">(</span><span class="skolem">p</span><span class="main">,</span><span class="skolem">z</span><span class="main">)</span> <span class="main">:</span> d<span class="main">^-1</span>›</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">k</span></span> <span class="skolem"><span class="skolem">l</span></span> <span class="skolem"><span class="skolem">u</span></span> <span class="skolem"><span class="skolem">v</span></span>  <span class="keyword2"><span class="keyword">where</span></span> kp<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">k</span><span class="main">∥</span><span class="skolem">p</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> kl<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">k</span><span class="main">∥</span><span class="skolem">l</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> lz<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">l</span><span class="main">∥</span><span class="skolem">z</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> pv<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">p</span><span class="main">∥</span><span class="skolem">v</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> uv<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">u</span><span class="main">∥</span><span class="skolem">v</span>"</span></span>  <span class="keyword2"><span class="keyword">and</span></span> zu<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">z</span><span class="main">∥</span><span class="skolem">u</span>"</span></span>  <span class="keyword1"><span class="command">using</span></span> d <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="main">(</span><span class="skolem">z</span><span class="main">,</span><span class="skolem">q</span><span class="main">)</span> <span class="main">:</span> b›</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">c</span></span>  <span class="keyword2"><span class="keyword">where</span></span>  zc<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">z</span><span class="main">∥</span><span class="skolem">c</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> cq<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">c</span><span class="main">∥</span><span class="skolem">q</span>"</span></span>  <span class="keyword1"><span class="command">using</span></span> b <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">with</span></span> kl lz <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">lzc</span></span> <span class="keyword2"><span class="keyword">where</span></span> klzc<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">k</span><span class="main">∥</span><span class="skolem">lzc</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> lzcq<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">lzc</span><span class="main">∥</span><span class="skolem">q</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> M5exist_var <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">v'</span></span> <span class="keyword2"><span class="keyword">where</span></span> qvp<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">q</span><span class="main">∥</span><span class="skolem">v'</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> M3 meets_wd cq <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">from</span></span> pv qvp  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">p</span><span class="main">∥</span><span class="skolem">v'</span> <span class="main">⊕</span> <span class="main">(</span><span class="main">(</span><span class="main">∃</span><span class="bound">t</span><span class="main">.</span> <span class="skolem">p</span><span class="main">∥</span><span class="bound">t</span> <span class="main">∧</span> <span class="bound">t</span><span class="main">∥</span><span class="skolem">v'</span><span class="main">)</span> <span class="main">⊕</span> <span class="main">(</span><span class="main">∃</span><span class="bound">t</span><span class="main">.</span> <span class="skolem">q</span><span class="main">∥</span><span class="bound">t</span> <span class="main">∧</span> <span class="bound">t</span><span class="main">∥</span><span class="skolem">v</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">is</span></span> <span class="quoted"><span class="quoted">"<span class="var">?A</span> <span class="main">⊕</span> <span class="main">(</span><span class="var">?B</span> <span class="main">⊕</span> <span class="var">?C</span><span class="main">)</span>"</span></span><span class="main">)</span> <span class="keyword1"><span class="command">using</span></span> M2 <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="var">?A</span><span class="main">∧</span><span class="main">¬</span><span class="var">?B</span><span class="main">∧</span><span class="main">¬</span><span class="var">?C</span><span class="main">)</span> <span class="main">∨</span> <span class="main">(</span><span class="main">(</span><span class="main">¬</span><span class="var">?A</span><span class="main">∧</span><span class="var">?B</span><span class="main">∧</span><span class="main">¬</span><span class="var">?C</span><span class="main">)</span> <span class="main">∨</span> <span class="main">(</span><span class="main">¬</span><span class="var">?A</span><span class="main">∧</span><span class="main">¬</span><span class="var">?B</span><span class="main">∧</span><span class="var">?C</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">insert</span> xor_distr_L<span class="main"><span class="main">[</span></span><span class="operator">of</span> <span class="var"><span class="quoted"><span class="var">?A</span></span></span> <span class="var"><span class="quoted"><span class="var">?B</span></span></span> <span class="var"><span class="quoted"><span class="var">?C</span></span></span><span class="main"><span class="main">]</span></span><span class="main"><span class="keyword3">,</span></span> <span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span>elimmeets<span class="main">)</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">∈</span> b <span class="main">∪</span> m <span class="main">∪</span> ov <span class="main">∪</span> f<span class="main">^-1</span> <span class="main">∪</span> d<span class="main">^-1</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">elim</span> disjE<span class="main">)</span>
      <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="var">?A</span><span class="main">∧</span><span class="main">¬</span><span class="var">?B</span><span class="main">∧</span><span class="main">¬</span><span class="var">?C</span>"</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="var"><span class="quoted"><span class="var">?A</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
        <span class="keyword1"><span class="command">with</span></span> qvp kp klzc lzcq  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">p</span><span class="main">,</span><span class="skolem">q</span><span class="main">)</span> <span class="main">∈</span> f<span class="main">^-1</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> f <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
        <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> x  <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span><span class="keyword1"><span class="command">}</span></span> 
      <span class="keyword1"><span class="command">next</span></span>
      <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span><span class="var">?A</span><span class="main">∧</span><span class="var">?B</span><span class="main">∧</span><span class="main">¬</span><span class="var">?C</span>"</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="var"><span class="quoted"><span class="var">?B</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span> 
        <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">t</span></span> <span class="keyword2"><span class="keyword">where</span></span> pt<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">p</span><span class="main">∥</span><span class="skolem">t</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> tvp<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">t</span><span class="main">∥</span><span class="skolem">v'</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword1"><span class="command">from</span></span> pt cq <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">p</span><span class="main">∥</span><span class="skolem">q</span> <span class="main">⊕</span> <span class="main">(</span><span class="main">(</span><span class="main">∃</span><span class="bound">t'</span><span class="main">.</span> <span class="skolem">p</span><span class="main">∥</span><span class="bound">t'</span> <span class="main">∧</span> <span class="bound">t'</span><span class="main">∥</span><span class="skolem">q</span><span class="main">)</span> <span class="main">⊕</span> <span class="main">(</span><span class="main">∃</span><span class="bound">t'</span><span class="main">.</span> <span class="skolem">c</span><span class="main">∥</span><span class="bound">t'</span> <span class="main">∧</span> <span class="bound">t'</span><span class="main">∥</span><span class="skolem">t</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">is</span></span> <span class="quoted"><span class="quoted">"<span class="var">?A</span> <span class="main">⊕</span> <span class="main">(</span><span class="var">?B</span> <span class="main">⊕</span> <span class="var">?C</span><span class="main">)</span>"</span></span><span class="main">)</span> <span class="keyword1"><span class="command">using</span></span> M2 <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
        <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="var">?A</span><span class="main">∧</span><span class="main">¬</span><span class="var">?B</span><span class="main">∧</span><span class="main">¬</span><span class="var">?C</span><span class="main">)</span> <span class="main">∨</span> <span class="main">(</span><span class="main">(</span><span class="main">¬</span><span class="var">?A</span><span class="main">∧</span><span class="var">?B</span><span class="main">∧</span><span class="main">¬</span><span class="var">?C</span><span class="main">)</span> <span class="main">∨</span> <span class="main">(</span><span class="main">¬</span><span class="var">?A</span><span class="main">∧</span><span class="main">¬</span><span class="var">?B</span><span class="main">∧</span><span class="var">?C</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">insert</span> xor_distr_L<span class="main"><span class="main">[</span></span><span class="operator">of</span> <span class="var"><span class="quoted"><span class="var">?A</span></span></span> <span class="var"><span class="quoted"><span class="var">?B</span></span></span> <span class="var"><span class="quoted"><span class="var">?C</span></span></span><span class="main"><span class="main">]</span></span><span class="main"><span class="keyword3">,</span></span> <span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span>elimmeets<span class="main">)</span>
        <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">∈</span> b <span class="main">∪</span> m <span class="main">∪</span> ov <span class="main">∪</span> f<span class="main">^-1</span> <span class="main">∪</span> d<span class="main">^-1</span>"</span></span>
        <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">elim</span> disjE<span class="main">)</span>
           <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="var">?A</span><span class="main">∧</span><span class="main">¬</span><span class="var">?B</span><span class="main">∧</span><span class="main">¬</span><span class="var">?C</span>"</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="var"><span class="quoted"><span class="var">?A</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
             <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> x m <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span><span class="keyword1"><span class="command">}</span></span>
           <span class="keyword1"><span class="command">next</span></span>
           <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span><span class="var">?A</span><span class="main">∧</span><span class="var">?B</span><span class="main">∧</span><span class="main">¬</span><span class="var">?C</span>"</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="var"><span class="quoted"><span class="var">?B</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
             <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> x b <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span><span class="keyword1"><span class="command">}</span></span>
           <span class="keyword1"><span class="command">next</span></span>
           <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span><span class="var">?A</span> <span class="main">∧</span> <span class="main">¬</span><span class="var">?B</span> <span class="main">∧</span> <span class="var">?C</span>"</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="var"><span class="quoted"><span class="var">?C</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
             <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">t'</span></span> <span class="keyword2"><span class="keyword">where</span></span> ctp<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">c</span><span class="main">∥</span><span class="skolem">t'</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> tpt<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">t'</span><span class="main">∥</span><span class="skolem">t</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
             <span class="keyword1"><span class="command">from</span></span> lzcq cq ctp <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">lzc</span><span class="main">∥</span><span class="skolem">t'</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> M1 <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
             <span class="keyword1"><span class="command">with</span></span> pt tvp qvp kp klzc lzcq tpt <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">p</span><span class="main">,</span><span class="skolem">q</span><span class="main">)</span> <span class="main">∈</span> ov"</span></span> <span class="keyword1"><span class="command">using</span></span> ov <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
             <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> x <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span><span class="keyword1"><span class="command">}</span></span>
        <span class="keyword1"><span class="command">qed</span></span>
        <span class="keyword1"><span class="command">}</span></span>  
      <span class="keyword1"><span class="command">next</span></span>
      <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span><span class="var">?A</span> <span class="main">∧</span> <span class="main">¬</span><span class="var">?B</span> <span class="main">∧</span> <span class="var">?C</span>"</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="var"><span class="quoted"><span class="var">?C</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
        <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">t</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">q</span><span class="main">∥</span><span class="skolem">t</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">t</span><span class="main">∥</span><span class="skolem">v</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword1"><span class="command">with</span></span> pv kp klzc lzcq  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">p</span><span class="main">,</span><span class="skolem">q</span><span class="main">)</span> <span class="main">∈</span> d<span class="main">^-1</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> d <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
        <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> x  <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span><span class="keyword1"><span class="command">}</span></span>
       <span class="keyword1"><span class="command">qed</span></span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">lemma</span></span> csdi<span class="main">:</span><span class="quoted"><span class="quoted">"s <span class="keyword1">O</span> d<span class="main">^-1</span> <span class="main">⊆</span> b <span class="main">∪</span> m <span class="main">∪</span> ov <span class="main">∪</span> f<span class="main">^-1</span> <span class="main">∪</span> d<span class="main">^-1</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span>
  <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">x</span><span class="main">::</span><span class="quoted"><span class="quoted">"<span class="tfree">'a</span><span class="main">×</span><span class="tfree">'a</span>"</span></span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">∈</span> s <span class="keyword1">O</span> d<span class="main">^-1</span>"</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">p</span></span> <span class="skolem"><span class="skolem">q</span></span> <span class="skolem"><span class="skolem">z</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">p</span><span class="main">,</span><span class="skolem">z</span><span class="main">)</span> <span class="main">:</span> s"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">z</span><span class="main">,</span><span class="skolem">q</span><span class="main">)</span> <span class="main">:</span> d<span class="main">^-1</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> x<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">=</span> <span class="main">(</span><span class="skolem">p</span><span class="main">,</span><span class="skolem">q</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="main">(</span><span class="skolem">p</span><span class="main">,</span><span class="skolem">z</span><span class="main">)</span> <span class="main">:</span> s›</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">k</span></span>  <span class="skolem"><span class="skolem">u</span></span> <span class="skolem"><span class="skolem">v</span></span>  <span class="keyword2"><span class="keyword">where</span></span> kp<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">k</span><span class="main">∥</span><span class="skolem">p</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> kz<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">k</span><span class="main">∥</span><span class="skolem">z</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> pu<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">p</span><span class="main">∥</span><span class="skolem">u</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> uv<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">u</span><span class="main">∥</span><span class="skolem">v</span>"</span></span>  <span class="keyword2"><span class="keyword">and</span></span> zv<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">z</span><span class="main">∥</span><span class="skolem">v</span>"</span></span>  <span class="keyword1"><span class="command">using</span></span> s <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="main">(</span><span class="skolem">z</span><span class="main">,</span><span class="skolem">q</span><span class="main">)</span> <span class="main">:</span> d<span class="main">^-1</span>›</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">l'</span></span> <span class="skolem"><span class="skolem">k'</span></span> <span class="skolem"><span class="skolem">u'</span></span> <span class="skolem"><span class="skolem">v'</span></span>  <span class="keyword2"><span class="keyword">where</span></span> lpq<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">l'</span><span class="main">∥</span><span class="skolem">q</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> kplp<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">k'</span><span class="main">∥</span><span class="skolem">l'</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> kpz<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">k'</span><span class="main">∥</span><span class="skolem">z</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> qup<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">q</span><span class="main">∥</span><span class="skolem">u'</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> upvp<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">u'</span><span class="main">∥</span><span class="skolem">v'</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> zvp<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">z</span><span class="main">∥</span><span class="skolem">v'</span>"</span></span>  <span class="keyword1"><span class="command">using</span></span> d  <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">from</span></span> kp kz kpz <span class="keyword1"><span class="command">have</span></span> kpp<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">k'</span><span class="main">∥</span><span class="skolem">p</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> M1 <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">from</span></span> pu qup  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">p</span><span class="main">∥</span><span class="skolem">u'</span> <span class="main">⊕</span> <span class="main">(</span><span class="main">(</span><span class="main">∃</span><span class="bound">t</span><span class="main">.</span> <span class="skolem">p</span><span class="main">∥</span><span class="bound">t</span> <span class="main">∧</span> <span class="bound">t</span><span class="main">∥</span><span class="skolem">u'</span><span class="main">)</span> <span class="main">⊕</span> <span class="main">(</span><span class="main">∃</span><span class="bound">t</span><span class="main">.</span> <span class="skolem">q</span><span class="main">∥</span><span class="bound">t</span> <span class="main">∧</span> <span class="bound">t</span><span class="main">∥</span><span class="skolem">u</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">is</span></span> <span class="quoted"><span class="quoted">"<span class="var">?A</span> <span class="main">⊕</span> <span class="main">(</span><span class="var">?B</span> <span class="main">⊕</span> <span class="var">?C</span><span class="main">)</span>"</span></span><span class="main">)</span> <span class="keyword1"><span class="command">using</span></span> M2 <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="var">?A</span><span class="main">∧</span><span class="main">¬</span><span class="var">?B</span><span class="main">∧</span><span class="main">¬</span><span class="var">?C</span><span class="main">)</span> <span class="main">∨</span> <span class="main">(</span><span class="main">(</span><span class="main">¬</span><span class="var">?A</span><span class="main">∧</span><span class="var">?B</span><span class="main">∧</span><span class="main">¬</span><span class="var">?C</span><span class="main">)</span> <span class="main">∨</span> <span class="main">(</span><span class="main">¬</span><span class="var">?A</span><span class="main">∧</span><span class="main">¬</span><span class="var">?B</span><span class="main">∧</span><span class="var">?C</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">insert</span> xor_distr_L<span class="main"><span class="main">[</span></span><span class="operator">of</span> <span class="var"><span class="quoted"><span class="var">?A</span></span></span> <span class="var"><span class="quoted"><span class="var">?B</span></span></span> <span class="var"><span class="quoted"><span class="var">?C</span></span></span><span class="main"><span class="main">]</span></span><span class="main"><span class="keyword3">,</span></span> <span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span>elimmeets<span class="main">)</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">∈</span> b <span class="main">∪</span> m <span class="main">∪</span> ov <span class="main">∪</span> f<span class="main">^-1</span> <span class="main">∪</span> d<span class="main">^-1</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">elim</span> disjE<span class="main">)</span>
      <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="var">?A</span><span class="main">∧</span><span class="main">¬</span><span class="var">?B</span><span class="main">∧</span><span class="main">¬</span><span class="var">?C</span>"</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="var"><span class="quoted"><span class="var">?A</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
        <span class="keyword1"><span class="command">with</span></span> qup kpp kplp lpq  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">p</span><span class="main">,</span><span class="skolem">q</span><span class="main">)</span> <span class="main">∈</span> f<span class="main">^-1</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> f <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
        <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> x  <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span><span class="keyword1"><span class="command">}</span></span> 
      <span class="keyword1"><span class="command">next</span></span>
      <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span><span class="var">?A</span><span class="main">∧</span><span class="var">?B</span><span class="main">∧</span><span class="main">¬</span><span class="var">?C</span>"</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="var"><span class="quoted"><span class="var">?B</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span> 
        <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">t</span></span> <span class="keyword2"><span class="keyword">where</span></span> pt<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">p</span><span class="main">∥</span><span class="skolem">t</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> tup<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">t</span><span class="main">∥</span><span class="skolem">u'</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword1"><span class="command">from</span></span> pt lpq <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">p</span><span class="main">∥</span><span class="skolem">q</span> <span class="main">⊕</span> <span class="main">(</span><span class="main">(</span><span class="main">∃</span><span class="bound">t'</span><span class="main">.</span> <span class="skolem">p</span><span class="main">∥</span><span class="bound">t'</span> <span class="main">∧</span> <span class="bound">t'</span><span class="main">∥</span><span class="skolem">q</span><span class="main">)</span> <span class="main">⊕</span> <span class="main">(</span><span class="main">∃</span><span class="bound">t'</span><span class="main">.</span> <span class="skolem">l'</span><span class="main">∥</span><span class="bound">t'</span> <span class="main">∧</span> <span class="bound">t'</span><span class="main">∥</span><span class="skolem">t</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">is</span></span> <span class="quoted"><span class="quoted">"<span class="var">?A</span> <span class="main">⊕</span> <span class="main">(</span><span class="var">?B</span> <span class="main">⊕</span> <span class="var">?C</span><span class="main">)</span>"</span></span><span class="main">)</span> <span class="keyword1"><span class="command">using</span></span> M2 <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
        <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="var">?A</span><span class="main">∧</span><span class="main">¬</span><span class="var">?B</span><span class="main">∧</span><span class="main">¬</span><span class="var">?C</span><span class="main">)</span> <span class="main">∨</span> <span class="main">(</span><span class="main">(</span><span class="main">¬</span><span class="var">?A</span><span class="main">∧</span><span class="var">?B</span><span class="main">∧</span><span class="main">¬</span><span class="var">?C</span><span class="main">)</span> <span class="main">∨</span> <span class="main">(</span><span class="main">¬</span><span class="var">?A</span><span class="main">∧</span><span class="main">¬</span><span class="var">?B</span><span class="main">∧</span><span class="var">?C</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">insert</span> xor_distr_L<span class="main"><span class="main">[</span></span><span class="operator">of</span> <span class="var"><span class="quoted"><span class="var">?A</span></span></span> <span class="var"><span class="quoted"><span class="var">?B</span></span></span> <span class="var"><span class="quoted"><span class="var">?C</span></span></span><span class="main"><span class="main">]</span></span><span class="main"><span class="keyword3">,</span></span> <span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span>elimmeets<span class="main">)</span>
        <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">∈</span> b <span class="main">∪</span> m <span class="main">∪</span> ov <span class="main">∪</span> f<span class="main">^-1</span> <span class="main">∪</span> d<span class="main">^-1</span>"</span></span>
        <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">elim</span> disjE<span class="main">)</span>
           <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="var">?A</span><span class="main">∧</span><span class="main">¬</span><span class="var">?B</span><span class="main">∧</span><span class="main">¬</span><span class="var">?C</span>"</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="var"><span class="quoted"><span class="var">?A</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
             <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> x m <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span><span class="keyword1"><span class="command">}</span></span>
           <span class="keyword1"><span class="command">next</span></span>
           <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span><span class="var">?A</span><span class="main">∧</span><span class="var">?B</span><span class="main">∧</span><span class="main">¬</span><span class="var">?C</span>"</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="var"><span class="quoted"><span class="var">?B</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
             <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> x b <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span><span class="keyword1"><span class="command">}</span></span>
           <span class="keyword1"><span class="command">next</span></span>
           <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span><span class="var">?A</span> <span class="main">∧</span> <span class="main">¬</span><span class="var">?B</span> <span class="main">∧</span> <span class="var">?C</span>"</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="var"><span class="quoted"><span class="var">?C</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
             <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">t'</span></span> <span class="keyword2"><span class="keyword">where</span></span> lptp<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">l'</span><span class="main">∥</span><span class="skolem">t'</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> tpt<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">t'</span><span class="main">∥</span><span class="skolem">t</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
             <span class="keyword1"><span class="command">with</span></span> pt tup qup kpp kplp lpq  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">p</span><span class="main">,</span><span class="skolem">q</span><span class="main">)</span> <span class="main">∈</span> ov"</span></span> <span class="keyword1"><span class="command">using</span></span> ov <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
             <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> x <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span><span class="keyword1"><span class="command">}</span></span>
        <span class="keyword1"><span class="command">qed</span></span>
        <span class="keyword1"><span class="command">}</span></span>  
      <span class="keyword1"><span class="command">next</span></span>
      <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span><span class="var">?A</span> <span class="main">∧</span> <span class="main">¬</span><span class="var">?B</span> <span class="main">∧</span> <span class="var">?C</span>"</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="var"><span class="quoted"><span class="var">?C</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
        <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">t</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">q</span><span class="main">∥</span><span class="skolem">t</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">t</span><span class="main">∥</span><span class="skolem">u</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword1"><span class="command">with</span></span> pu kpp kplp lpq   <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">p</span><span class="main">,</span><span class="skolem">q</span><span class="main">)</span> <span class="main">∈</span> d<span class="main">^-1</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> d <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
        <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> x  <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span><span class="keyword1"><span class="command">}</span></span>
       <span class="keyword1"><span class="command">qed</span></span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">lemma</span></span> csib<span class="main">:</span><span class="quoted"><span class="quoted">"s<span class="main">^-1</span> <span class="keyword1">O</span> b <span class="main">⊆</span> b <span class="main">∪</span> m <span class="main">∪</span> ov <span class="main">∪</span> f<span class="main">^-1</span> <span class="main">∪</span> d<span class="main">^-1</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span>
  <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">x</span><span class="main">::</span><span class="quoted"><span class="quoted">"<span class="tfree">'a</span><span class="main">×</span><span class="tfree">'a</span>"</span></span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">∈</span> s<span class="main">^-1</span> <span class="keyword1">O</span> b"</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">p</span></span> <span class="skolem"><span class="skolem">q</span></span> <span class="skolem"><span class="skolem">z</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">p</span><span class="main">,</span><span class="skolem">z</span><span class="main">)</span> <span class="main">:</span> s<span class="main">^-1</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">z</span><span class="main">,</span><span class="skolem">q</span><span class="main">)</span> <span class="main">:</span> b"</span></span> <span class="keyword2"><span class="keyword">and</span></span> x<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">=</span> <span class="main">(</span><span class="skolem">p</span><span class="main">,</span><span class="skolem">q</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="main">(</span><span class="skolem">p</span><span class="main">,</span><span class="skolem">z</span><span class="main">)</span> <span class="main">:</span> s<span class="main">^-1</span>›</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">k</span></span>  <span class="skolem"><span class="skolem">u</span></span> <span class="skolem"><span class="skolem">v</span></span>  <span class="keyword2"><span class="keyword">where</span></span> kp<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">k</span><span class="main">∥</span><span class="skolem">p</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> kz<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">k</span><span class="main">∥</span><span class="skolem">z</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> zu<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">z</span><span class="main">∥</span><span class="skolem">u</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> uv<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">u</span><span class="main">∥</span><span class="skolem">v</span>"</span></span>  <span class="keyword2"><span class="keyword">and</span></span> pv<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">p</span><span class="main">∥</span><span class="skolem">v</span>"</span></span>  <span class="keyword1"><span class="command">using</span></span> s <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="main">(</span><span class="skolem">z</span><span class="main">,</span><span class="skolem">q</span><span class="main">)</span> <span class="main">:</span> b›</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">c</span></span>  <span class="keyword2"><span class="keyword">where</span></span>  zc<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">z</span><span class="main">∥</span><span class="skolem">c</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> cq<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">c</span><span class="main">∥</span><span class="skolem">q</span>"</span></span>  <span class="keyword1"><span class="command">using</span></span> b <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">from</span></span> kz zc cq <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">zc</span></span> <span class="keyword2"><span class="keyword">where</span></span> kzc<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">k</span><span class="main">∥</span><span class="skolem">zc</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> zcq<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">zc</span><span class="main">∥</span><span class="skolem">q</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> M5exist_var <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">v'</span></span> <span class="keyword2"><span class="keyword">where</span></span> qvp<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">q</span><span class="main">∥</span><span class="skolem">v'</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> M3 meets_wd cq <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">from</span></span> pv qvp  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">p</span><span class="main">∥</span><span class="skolem">v'</span> <span class="main">⊕</span> <span class="main">(</span><span class="main">(</span><span class="main">∃</span><span class="bound">t</span><span class="main">.</span> <span class="skolem">p</span><span class="main">∥</span><span class="bound">t</span> <span class="main">∧</span> <span class="bound">t</span><span class="main">∥</span><span class="skolem">v'</span><span class="main">)</span> <span class="main">⊕</span> <span class="main">(</span><span class="main">∃</span><span class="bound">t</span><span class="main">.</span> <span class="skolem">q</span><span class="main">∥</span><span class="bound">t</span> <span class="main">∧</span> <span class="bound">t</span><span class="main">∥</span><span class="skolem">v</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">is</span></span> <span class="quoted"><span class="quoted">"<span class="var">?A</span> <span class="main">⊕</span> <span class="main">(</span><span class="var">?B</span> <span class="main">⊕</span> <span class="var">?C</span><span class="main">)</span>"</span></span><span class="main">)</span> <span class="keyword1"><span class="command">using</span></span> M2 <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="var">?A</span><span class="main">∧</span><span class="main">¬</span><span class="var">?B</span><span class="main">∧</span><span class="main">¬</span><span class="var">?C</span><span class="main">)</span> <span class="main">∨</span> <span class="main">(</span><span class="main">(</span><span class="main">¬</span><span class="var">?A</span><span class="main">∧</span><span class="var">?B</span><span class="main">∧</span><span class="main">¬</span><span class="var">?C</span><span class="main">)</span> <span class="main">∨</span> <span class="main">(</span><span class="main">¬</span><span class="var">?A</span><span class="main">∧</span><span class="main">¬</span><span class="var">?B</span><span class="main">∧</span><span class="var">?C</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">insert</span> xor_distr_L<span class="main"><span class="main">[</span></span><span class="operator">of</span> <span class="var"><span class="quoted"><span class="var">?A</span></span></span> <span class="var"><span class="quoted"><span class="var">?B</span></span></span> <span class="var"><span class="quoted"><span class="var">?C</span></span></span><span class="main"><span class="main">]</span></span><span class="main"><span class="keyword3">,</span></span> <span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span>elimmeets<span class="main">)</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">∈</span> b <span class="main">∪</span> m <span class="main">∪</span> ov <span class="main">∪</span> f<span class="main">^-1</span> <span class="main">∪</span> d<span class="main">^-1</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">elim</span> disjE<span class="main">)</span>
      <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="var">?A</span><span class="main">∧</span><span class="main">¬</span><span class="var">?B</span><span class="main">∧</span><span class="main">¬</span><span class="var">?C</span>"</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="var"><span class="quoted"><span class="var">?A</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
        <span class="keyword1"><span class="command">with</span></span> qvp kp kzc zcq  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">p</span><span class="main">,</span><span class="skolem">q</span><span class="main">)</span> <span class="main">∈</span> f<span class="main">^-1</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> f <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
        <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> x  <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span><span class="keyword1"><span class="command">}</span></span> 
      <span class="keyword1"><span class="command">next</span></span>
      <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span><span class="var">?A</span><span class="main">∧</span><span class="var">?B</span><span class="main">∧</span><span class="main">¬</span><span class="var">?C</span>"</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="var"><span class="quoted"><span class="var">?B</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span> 
        <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">t</span></span> <span class="keyword2"><span class="keyword">where</span></span> pt<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">p</span><span class="main">∥</span><span class="skolem">t</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> tvp<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">t</span><span class="main">∥</span><span class="skolem">v'</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword1"><span class="command">from</span></span> pt cq <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">p</span><span class="main">∥</span><span class="skolem">q</span> <span class="main">⊕</span> <span class="main">(</span><span class="main">(</span><span class="main">∃</span><span class="bound">t'</span><span class="main">.</span> <span class="skolem">p</span><span class="main">∥</span><span class="bound">t'</span> <span class="main">∧</span> <span class="bound">t'</span><span class="main">∥</span><span class="skolem">q</span><span class="main">)</span> <span class="main">⊕</span> <span class="main">(</span><span class="main">∃</span><span class="bound">t'</span><span class="main">.</span> <span class="skolem">c</span><span class="main">∥</span><span class="bound">t'</span> <span class="main">∧</span> <span class="bound">t'</span><span class="main">∥</span><span class="skolem">t</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">is</span></span> <span class="quoted"><span class="quoted">"<span class="var">?A</span> <span class="main">⊕</span> <span class="main">(</span><span class="var">?B</span> <span class="main">⊕</span> <span class="var">?C</span><span class="main">)</span>"</span></span><span class="main">)</span> <span class="keyword1"><span class="command">using</span></span> M2 <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
        <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="var">?A</span><span class="main">∧</span><span class="main">¬</span><span class="var">?B</span><span class="main">∧</span><span class="main">¬</span><span class="var">?C</span><span class="main">)</span> <span class="main">∨</span> <span class="main">(</span><span class="main">(</span><span class="main">¬</span><span class="var">?A</span><span class="main">∧</span><span class="var">?B</span><span class="main">∧</span><span class="main">¬</span><span class="var">?C</span><span class="main">)</span> <span class="main">∨</span> <span class="main">(</span><span class="main">¬</span><span class="var">?A</span><span class="main">∧</span><span class="main">¬</span><span class="var">?B</span><span class="main">∧</span><span class="var">?C</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">insert</span> xor_distr_L<span class="main"><span class="main">[</span></span><span class="operator">of</span> <span class="var"><span class="quoted"><span class="var">?A</span></span></span> <span class="var"><span class="quoted"><span class="var">?B</span></span></span> <span class="var"><span class="quoted"><span class="var">?C</span></span></span><span class="main"><span class="main">]</span></span><span class="main"><span class="keyword3">,</span></span> <span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span>elimmeets<span class="main">)</span>
        <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">∈</span> b <span class="main">∪</span> m <span class="main">∪</span> ov <span class="main">∪</span> f<span class="main">^-1</span> <span class="main">∪</span> d<span class="main">^-1</span>"</span></span>
        <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">elim</span> disjE<span class="main">)</span>
           <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="var">?A</span><span class="main">∧</span><span class="main">¬</span><span class="var">?B</span><span class="main">∧</span><span class="main">¬</span><span class="var">?C</span>"</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="var"><span class="quoted"><span class="var">?A</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
             <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> x m <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span><span class="keyword1"><span class="command">}</span></span>
           <span class="keyword1"><span class="command">next</span></span>
           <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span><span class="var">?A</span><span class="main">∧</span><span class="var">?B</span><span class="main">∧</span><span class="main">¬</span><span class="var">?C</span>"</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="var"><span class="quoted"><span class="var">?B</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
             <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> x b <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span><span class="keyword1"><span class="command">}</span></span>
           <span class="keyword1"><span class="command">next</span></span>
           <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span><span class="var">?A</span> <span class="main">∧</span> <span class="main">¬</span><span class="var">?B</span> <span class="main">∧</span> <span class="var">?C</span>"</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="var"><span class="quoted"><span class="var">?C</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
             <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">t'</span></span> <span class="keyword2"><span class="keyword">where</span></span> ctp<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">c</span><span class="main">∥</span><span class="skolem">t'</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> tpt<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">t'</span><span class="main">∥</span><span class="skolem">t</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
             <span class="keyword1"><span class="command">from</span></span> zcq cq ctp <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">zc</span><span class="main">∥</span><span class="skolem">t'</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> M1 <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
             <span class="keyword1"><span class="command">with</span></span> zcq  pt tvp qvp kzc kp ctp tpt <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">p</span><span class="main">,</span><span class="skolem">q</span><span class="main">)</span> <span class="main">∈</span> ov"</span></span> <span class="keyword1"><span class="command">using</span></span> ov <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
             <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> x <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span><span class="keyword1"><span class="command">}</span></span>
        <span class="keyword1"><span class="command">qed</span></span>
        <span class="keyword1"><span class="command">}</span></span>  
      <span class="keyword1"><span class="command">next</span></span>
      <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span><span class="var">?A</span> <span class="main">∧</span> <span class="main">¬</span><span class="var">?B</span> <span class="main">∧</span> <span class="var">?C</span>"</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="var"><span class="quoted"><span class="var">?C</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
        <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">t</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">q</span><span class="main">∥</span><span class="skolem">t</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">t</span><span class="main">∥</span><span class="skolem">v</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword1"><span class="command">with</span></span> pv kp kzc zcq   <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">p</span><span class="main">,</span><span class="skolem">q</span><span class="main">)</span> <span class="main">∈</span> d<span class="main">^-1</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> d <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
        <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> x  <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span><span class="keyword1"><span class="command">}</span></span>
       <span class="keyword1"><span class="command">qed</span></span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">lemma</span></span> covib<span class="main">:</span><span class="quoted"><span class="quoted">"ov<span class="main">^-1</span> <span class="keyword1">O</span> b <span class="main">⊆</span> b <span class="main">∪</span> m <span class="main">∪</span> ov <span class="main">∪</span> f<span class="main">^-1</span> <span class="main">∪</span> d<span class="main">^-1</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span>
  <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">x</span><span class="main">::</span><span class="quoted"><span class="quoted">"<span class="tfree">'a</span><span class="main">×</span><span class="tfree">'a</span>"</span></span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">∈</span> ov<span class="main">^-1</span> <span class="keyword1">O</span> b"</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">p</span></span> <span class="skolem"><span class="skolem">q</span></span> <span class="skolem"><span class="skolem">z</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">p</span><span class="main">,</span><span class="skolem">z</span><span class="main">)</span> <span class="main">:</span> ov<span class="main">^-1</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">z</span><span class="main">,</span><span class="skolem">q</span><span class="main">)</span> <span class="main">:</span> b"</span></span> <span class="keyword2"><span class="keyword">and</span></span> x<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">=</span> <span class="main">(</span><span class="skolem">p</span><span class="main">,</span><span class="skolem">q</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="main">(</span><span class="skolem">p</span><span class="main">,</span><span class="skolem">z</span><span class="main">)</span> <span class="main">:</span> ov<span class="main">^-1</span>›</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">k</span></span> <span class="skolem"><span class="skolem">l</span></span> <span class="skolem"><span class="skolem">u</span></span> <span class="skolem"><span class="skolem">v</span></span> <span class="skolem"><span class="skolem">c</span></span>  <span class="keyword2"><span class="keyword">where</span></span> kz<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">k</span><span class="main">∥</span><span class="skolem">z</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> kl<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">k</span><span class="main">∥</span><span class="skolem">l</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> lp<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">l</span><span class="main">∥</span><span class="skolem">p</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> zu<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">z</span><span class="main">∥</span><span class="skolem">u</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> uv<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">u</span><span class="main">∥</span><span class="skolem">v</span>"</span></span>  <span class="keyword2"><span class="keyword">and</span></span> pv<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">p</span><span class="main">∥</span><span class="skolem">v</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> lc<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">l</span><span class="main">∥</span><span class="skolem">c</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> cu<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">c</span><span class="main">∥</span><span class="skolem">u</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> ov <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="main">(</span><span class="skolem">z</span><span class="main">,</span><span class="skolem">q</span><span class="main">)</span> <span class="main">:</span> b›</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">w</span></span>  <span class="keyword2"><span class="keyword">where</span></span>  zw<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">z</span><span class="main">∥</span><span class="skolem">w</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> wq<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">w</span><span class="main">∥</span><span class="skolem">q</span>"</span></span>  <span class="keyword1"><span class="command">using</span></span> b <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">from</span></span> cu zu zw <span class="keyword1"><span class="command">have</span></span> cw<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">c</span><span class="main">∥</span><span class="skolem">w</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> M1 <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">with</span></span> lc wq <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">cw</span></span> <span class="keyword2"><span class="keyword">where</span></span> lcw<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">l</span><span class="main">∥</span><span class="skolem">cw</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> cwq<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">cw</span><span class="main">∥</span><span class="skolem">q</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> M5exist_var <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">v'</span></span> <span class="keyword2"><span class="keyword">where</span></span> qvp<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">q</span><span class="main">∥</span><span class="skolem">v'</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> M3 meets_wd wq <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">from</span></span> pv qvp  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">p</span><span class="main">∥</span><span class="skolem">v'</span> <span class="main">⊕</span> <span class="main">(</span><span class="main">(</span><span class="main">∃</span><span class="bound">t</span><span class="main">.</span> <span class="skolem">p</span><span class="main">∥</span><span class="bound">t</span> <span class="main">∧</span> <span class="bound">t</span><span class="main">∥</span><span class="skolem">v'</span><span class="main">)</span> <span class="main">⊕</span> <span class="main">(</span><span class="main">∃</span><span class="bound">t</span><span class="main">.</span> <span class="skolem">q</span><span class="main">∥</span><span class="bound">t</span> <span class="main">∧</span> <span class="bound">t</span><span class="main">∥</span><span class="skolem">v</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">is</span></span> <span class="quoted"><span class="quoted">"<span class="var">?A</span> <span class="main">⊕</span> <span class="main">(</span><span class="var">?B</span> <span class="main">⊕</span> <span class="var">?C</span><span class="main">)</span>"</span></span><span class="main">)</span> <span class="keyword1"><span class="command">using</span></span> M2 <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="var">?A</span><span class="main">∧</span><span class="main">¬</span><span class="var">?B</span><span class="main">∧</span><span class="main">¬</span><span class="var">?C</span><span class="main">)</span> <span class="main">∨</span> <span class="main">(</span><span class="main">(</span><span class="main">¬</span><span class="var">?A</span><span class="main">∧</span><span class="var">?B</span><span class="main">∧</span><span class="main">¬</span><span class="var">?C</span><span class="main">)</span> <span class="main">∨</span> <span class="main">(</span><span class="main">¬</span><span class="var">?A</span><span class="main">∧</span><span class="main">¬</span><span class="var">?B</span><span class="main">∧</span><span class="var">?C</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">insert</span> xor_distr_L<span class="main"><span class="main">[</span></span><span class="operator">of</span> <span class="var"><span class="quoted"><span class="var">?A</span></span></span> <span class="var"><span class="quoted"><span class="var">?B</span></span></span> <span class="var"><span class="quoted"><span class="var">?C</span></span></span><span class="main"><span class="main">]</span></span><span class="main"><span class="keyword3">,</span></span> <span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span>elimmeets<span class="main">)</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">∈</span> b <span class="main">∪</span> m <span class="main">∪</span> ov <span class="main">∪</span> f<span class="main">^-1</span> <span class="main">∪</span> d<span class="main">^-1</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">elim</span> disjE<span class="main">)</span>
      <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="var">?A</span><span class="main">∧</span><span class="main">¬</span><span class="var">?B</span><span class="main">∧</span><span class="main">¬</span><span class="var">?C</span>"</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="var"><span class="quoted"><span class="var">?A</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
        <span class="keyword1"><span class="command">with</span></span> qvp lp lcw cwq  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">p</span><span class="main">,</span><span class="skolem">q</span><span class="main">)</span> <span class="main">∈</span> f<span class="main">^-1</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> f <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
        <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> x  <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span><span class="keyword1"><span class="command">}</span></span> 
      <span class="keyword1"><span class="command">next</span></span>
      <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span><span class="var">?A</span><span class="main">∧</span><span class="var">?B</span><span class="main">∧</span><span class="main">¬</span><span class="var">?C</span>"</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="var"><span class="quoted"><span class="var">?B</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span> 
        <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">t</span></span> <span class="keyword2"><span class="keyword">where</span></span> pt<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">p</span><span class="main">∥</span><span class="skolem">t</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> tvp<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">t</span><span class="main">∥</span><span class="skolem">v'</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword1"><span class="command">from</span></span> pt wq <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">p</span><span class="main">∥</span><span class="skolem">q</span> <span class="main">⊕</span> <span class="main">(</span><span class="main">(</span><span class="main">∃</span><span class="bound">t'</span><span class="main">.</span> <span class="skolem">p</span><span class="main">∥</span><span class="bound">t'</span> <span class="main">∧</span> <span class="bound">t'</span><span class="main">∥</span><span class="skolem">q</span><span class="main">)</span> <span class="main">⊕</span> <span class="main">(</span><span class="main">∃</span><span class="bound">t'</span><span class="main">.</span> <span class="skolem">w</span><span class="main">∥</span><span class="bound">t'</span> <span class="main">∧</span> <span class="bound">t'</span><span class="main">∥</span><span class="skolem">t</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">is</span></span> <span class="quoted"><span class="quoted">"<span class="var">?A</span> <span class="main">⊕</span> <span class="main">(</span><span class="var">?B</span> <span class="main">⊕</span> <span class="var">?C</span><span class="main">)</span>"</span></span><span class="main">)</span> <span class="keyword1"><span class="command">using</span></span> M2 <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
        <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="var">?A</span><span class="main">∧</span><span class="main">¬</span><span class="var">?B</span><span class="main">∧</span><span class="main">¬</span><span class="var">?C</span><span class="main">)</span> <span class="main">∨</span> <span class="main">(</span><span class="main">(</span><span class="main">¬</span><span class="var">?A</span><span class="main">∧</span><span class="var">?B</span><span class="main">∧</span><span class="main">¬</span><span class="var">?C</span><span class="main">)</span> <span class="main">∨</span> <span class="main">(</span><span class="main">¬</span><span class="var">?A</span><span class="main">∧</span><span class="main">¬</span><span class="var">?B</span><span class="main">∧</span><span class="var">?C</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">insert</span> xor_distr_L<span class="main"><span class="main">[</span></span><span class="operator">of</span> <span class="var"><span class="quoted"><span class="var">?A</span></span></span> <span class="var"><span class="quoted"><span class="var">?B</span></span></span> <span class="var"><span class="quoted"><span class="var">?C</span></span></span><span class="main"><span class="main">]</span></span><span class="main"><span class="keyword3">,</span></span> <span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span>elimmeets<span class="main">)</span>
        <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">∈</span> b <span class="main">∪</span> m <span class="main">∪</span> ov <span class="main">∪</span> f<span class="main">^-1</span> <span class="main">∪</span> d<span class="main">^-1</span>"</span></span>
        <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">elim</span> disjE<span class="main">)</span>
           <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="var">?A</span><span class="main">∧</span><span class="main">¬</span><span class="var">?B</span><span class="main">∧</span><span class="main">¬</span><span class="var">?C</span>"</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="var"><span class="quoted"><span class="var">?A</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
             <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> x m <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span><span class="keyword1"><span class="command">}</span></span>
           <span class="keyword1"><span class="command">next</span></span>
           <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span><span class="var">?A</span><span class="main">∧</span><span class="var">?B</span><span class="main">∧</span><span class="main">¬</span><span class="var">?C</span>"</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="var"><span class="quoted"><span class="var">?B</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
             <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> x b <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span><span class="keyword1"><span class="command">}</span></span>
           <span class="keyword1"><span class="command">next</span></span>
           <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span><span class="var">?A</span> <span class="main">∧</span> <span class="main">¬</span><span class="var">?B</span> <span class="main">∧</span> <span class="var">?C</span>"</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="var"><span class="quoted"><span class="var">?C</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
             <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">t'</span></span> <span class="keyword2"><span class="keyword">where</span></span> wtp<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">w</span><span class="main">∥</span><span class="skolem">t'</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> tpt<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">t'</span><span class="main">∥</span><span class="skolem">t</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
             <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command"><span class="improper">with</span></span></span> wq cwq <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">cw</span><span class="main">∥</span><span class="skolem">t'</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> M1 <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
             <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">p</span><span class="main">,</span><span class="skolem">q</span><span class="main">)</span> <span class="main">∈</span> ov"</span></span> <span class="keyword1"><span class="command">using</span></span> ov cwq lp lcw pt tvp qvp <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
             <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> x <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span><span class="keyword1"><span class="command">}</span></span>
        <span class="keyword1"><span class="command">qed</span></span>
        <span class="keyword1"><span class="command">}</span></span>  
      <span class="keyword1"><span class="command">next</span></span>
      <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span><span class="var">?A</span> <span class="main">∧</span> <span class="main">¬</span><span class="var">?B</span> <span class="main">∧</span> <span class="var">?C</span>"</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="var"><span class="quoted"><span class="var">?C</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
        <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">t</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">q</span><span class="main">∥</span><span class="skolem">t</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">t</span><span class="main">∥</span><span class="skolem">v</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword1"><span class="command">with</span></span> pv lp lcw cwq  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">p</span><span class="main">,</span><span class="skolem">q</span><span class="main">)</span> <span class="main">∈</span> d<span class="main">^-1</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> d <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
        <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> x  <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span><span class="keyword1"><span class="command">}</span></span>
       <span class="keyword1"><span class="command">qed</span></span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">lemma</span></span> cmib<span class="main">:</span><span class="quoted"><span class="quoted">"m<span class="main">^-1</span> <span class="keyword1">O</span> b <span class="main">⊆</span> b <span class="main">∪</span> m <span class="main">∪</span> ov <span class="main">∪</span> f<span class="main">^-1</span> <span class="main">∪</span> d<span class="main">^-1</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span>
  <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">x</span><span class="main">::</span><span class="quoted"><span class="quoted">"<span class="tfree">'a</span><span class="main">×</span><span class="tfree">'a</span>"</span></span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">∈</span> m<span class="main">^-1</span> <span class="keyword1">O</span> b"</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">p</span></span> <span class="skolem"><span class="skolem">q</span></span> <span class="skolem"><span class="skolem">z</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">p</span><span class="main">,</span><span class="skolem">z</span><span class="main">)</span> <span class="main">:</span> m<span class="main">^-1</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">z</span><span class="main">,</span><span class="skolem">q</span><span class="main">)</span> <span class="main">:</span> b"</span></span> <span class="keyword2"><span class="keyword">and</span></span> x<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">=</span> <span class="main">(</span><span class="skolem">p</span><span class="main">,</span><span class="skolem">q</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="main">(</span><span class="skolem">p</span><span class="main">,</span><span class="skolem">z</span><span class="main">)</span> <span class="main">:</span> m<span class="main">^-1</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> zp<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">z</span><span class="main">∥</span><span class="skolem">p</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> m <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="main">(</span><span class="skolem">z</span><span class="main">,</span><span class="skolem">q</span><span class="main">)</span> <span class="main">:</span> b›</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">w</span></span>  <span class="keyword2"><span class="keyword">where</span></span>  zw<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">z</span><span class="main">∥</span><span class="skolem">w</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> wq<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">w</span><span class="main">∥</span><span class="skolem">q</span>"</span></span>  <span class="keyword1"><span class="command">using</span></span> b <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">v</span></span> <span class="keyword2"><span class="keyword">where</span></span> pv<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">p</span><span class="main">∥</span><span class="skolem">v</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> M3 meets_wd zp  <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">v'</span></span> <span class="keyword2"><span class="keyword">where</span></span> qvp<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">q</span><span class="main">∥</span><span class="skolem">v'</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> M3 meets_wd wq <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>

  <span class="keyword1"><span class="command">from</span></span> pv qvp  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">p</span><span class="main">∥</span><span class="skolem">v'</span> <span class="main">⊕</span> <span class="main">(</span><span class="main">(</span><span class="main">∃</span><span class="bound">t</span><span class="main">.</span> <span class="skolem">p</span><span class="main">∥</span><span class="bound">t</span> <span class="main">∧</span> <span class="bound">t</span><span class="main">∥</span><span class="skolem">v'</span><span class="main">)</span> <span class="main">⊕</span> <span class="main">(</span><span class="main">∃</span><span class="bound">t</span><span class="main">.</span> <span class="skolem">q</span><span class="main">∥</span><span class="bound">t</span> <span class="main">∧</span> <span class="bound">t</span><span class="main">∥</span><span class="skolem">v</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">is</span></span> <span class="quoted"><span class="quoted">"<span class="var">?A</span> <span class="main">⊕</span> <span class="main">(</span><span class="var">?B</span> <span class="main">⊕</span> <span class="var">?C</span><span class="main">)</span>"</span></span><span class="main">)</span> <span class="keyword1"><span class="command">using</span></span> M2 <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="var">?A</span><span class="main">∧</span><span class="main">¬</span><span class="var">?B</span><span class="main">∧</span><span class="main">¬</span><span class="var">?C</span><span class="main">)</span> <span class="main">∨</span> <span class="main">(</span><span class="main">(</span><span class="main">¬</span><span class="var">?A</span><span class="main">∧</span><span class="var">?B</span><span class="main">∧</span><span class="main">¬</span><span class="var">?C</span><span class="main">)</span> <span class="main">∨</span> <span class="main">(</span><span class="main">¬</span><span class="var">?A</span><span class="main">∧</span><span class="main">¬</span><span class="var">?B</span><span class="main">∧</span><span class="var">?C</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">insert</span> xor_distr_L<span class="main"><span class="main">[</span></span><span class="operator">of</span> <span class="var"><span class="quoted"><span class="var">?A</span></span></span> <span class="var"><span class="quoted"><span class="var">?B</span></span></span> <span class="var"><span class="quoted"><span class="var">?C</span></span></span><span class="main"><span class="main">]</span></span><span class="main"><span class="keyword3">,</span></span> <span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span>elimmeets<span class="main">)</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">∈</span> b <span class="main">∪</span> m <span class="main">∪</span> ov <span class="main">∪</span> f<span class="main">^-1</span> <span class="main">∪</span> d<span class="main">^-1</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">elim</span> disjE<span class="main">)</span>
      <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="var">?A</span><span class="main">∧</span><span class="main">¬</span><span class="var">?B</span><span class="main">∧</span><span class="main">¬</span><span class="var">?C</span>"</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="var"><span class="quoted"><span class="var">?A</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
        <span class="keyword1"><span class="command">with</span></span> zp zw wq qvp  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">p</span><span class="main">,</span><span class="skolem">q</span><span class="main">)</span> <span class="main">∈</span> f<span class="main">^-1</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> f <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
        <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> x  <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span><span class="keyword1"><span class="command">}</span></span> 
      <span class="keyword1"><span class="command">next</span></span>
      <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span><span class="var">?A</span><span class="main">∧</span><span class="var">?B</span><span class="main">∧</span><span class="main">¬</span><span class="var">?C</span>"</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="var"><span class="quoted"><span class="var">?B</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span> 
        <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">t</span></span> <span class="keyword2"><span class="keyword">where</span></span> pt<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">p</span><span class="main">∥</span><span class="skolem">t</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> tvp<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">t</span><span class="main">∥</span><span class="skolem">v'</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword1"><span class="command">from</span></span> pt wq <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">p</span><span class="main">∥</span><span class="skolem">q</span> <span class="main">⊕</span> <span class="main">(</span><span class="main">(</span><span class="main">∃</span><span class="bound">t'</span><span class="main">.</span> <span class="skolem">p</span><span class="main">∥</span><span class="bound">t'</span> <span class="main">∧</span> <span class="bound">t'</span><span class="main">∥</span><span class="skolem">q</span><span class="main">)</span> <span class="main">⊕</span> <span class="main">(</span><span class="main">∃</span><span class="bound">t'</span><span class="main">.</span> <span class="skolem">w</span><span class="main">∥</span><span class="bound">t'</span> <span class="main">∧</span> <span class="bound">t'</span><span class="main">∥</span><span class="skolem">t</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">is</span></span> <span class="quoted"><span class="quoted">"<span class="var">?A</span> <span class="main">⊕</span> <span class="main">(</span><span class="var">?B</span> <span class="main">⊕</span> <span class="var">?C</span><span class="main">)</span>"</span></span><span class="main">)</span> <span class="keyword1"><span class="command">using</span></span> M2 <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
        <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="var">?A</span><span class="main">∧</span><span class="main">¬</span><span class="var">?B</span><span class="main">∧</span><span class="main">¬</span><span class="var">?C</span><span class="main">)</span> <span class="main">∨</span> <span class="main">(</span><span class="main">(</span><span class="main">¬</span><span class="var">?A</span><span class="main">∧</span><span class="var">?B</span><span class="main">∧</span><span class="main">¬</span><span class="var">?C</span><span class="main">)</span> <span class="main">∨</span> <span class="main">(</span><span class="main">¬</span><span class="var">?A</span><span class="main">∧</span><span class="main">¬</span><span class="var">?B</span><span class="main">∧</span><span class="var">?C</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">insert</span> xor_distr_L<span class="main"><span class="main">[</span></span><span class="operator">of</span> <span class="var"><span class="quoted"><span class="var">?A</span></span></span> <span class="var"><span class="quoted"><span class="var">?B</span></span></span> <span class="var"><span class="quoted"><span class="var">?C</span></span></span><span class="main"><span class="main">]</span></span><span class="main"><span class="keyword3">,</span></span> <span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span>elimmeets<span class="main">)</span>
        <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">∈</span> b <span class="main">∪</span> m <span class="main">∪</span> ov <span class="main">∪</span> f<span class="main">^-1</span> <span class="main">∪</span> d<span class="main">^-1</span>"</span></span>
        <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">elim</span> disjE<span class="main">)</span>
           <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="var">?A</span><span class="main">∧</span><span class="main">¬</span><span class="var">?B</span><span class="main">∧</span><span class="main">¬</span><span class="var">?C</span>"</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="var"><span class="quoted"><span class="var">?A</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
             <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> x m <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span><span class="keyword1"><span class="command">}</span></span>
           <span class="keyword1"><span class="command">next</span></span>
           <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span><span class="var">?A</span><span class="main">∧</span><span class="var">?B</span><span class="main">∧</span><span class="main">¬</span><span class="var">?C</span>"</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="var"><span class="quoted"><span class="var">?B</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
             <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> x b <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span><span class="keyword1"><span class="command">}</span></span>
           <span class="keyword1"><span class="command">next</span></span>
           <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span><span class="var">?A</span> <span class="main">∧</span> <span class="main">¬</span><span class="var">?B</span> <span class="main">∧</span> <span class="var">?C</span>"</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="var"><span class="quoted"><span class="var">?C</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
             <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">t'</span></span> <span class="keyword2"><span class="keyword">where</span></span> wtp<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">w</span><span class="main">∥</span><span class="skolem">t'</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> tpt<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">t'</span><span class="main">∥</span><span class="skolem">t</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
             <span class="keyword1"><span class="command">with</span></span> zp zw wq pt tvp qvp <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">p</span><span class="main">,</span><span class="skolem">q</span><span class="main">)</span> <span class="main">∈</span> ov"</span></span> <span class="keyword1"><span class="command">using</span></span> ov  <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
             <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> x <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span><span class="keyword1"><span class="command">}</span></span>
        <span class="keyword1"><span class="command">qed</span></span>
        <span class="keyword1"><span class="command">}</span></span>  
      <span class="keyword1"><span class="command">next</span></span>
      <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span><span class="var">?A</span> <span class="main">∧</span> <span class="main">¬</span><span class="var">?B</span> <span class="main">∧</span> <span class="var">?C</span>"</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="var"><span class="quoted"><span class="var">?C</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
        <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">t</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">q</span><span class="main">∥</span><span class="skolem">t</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">t</span><span class="main">∥</span><span class="skolem">v</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword1"><span class="command">with</span></span> zp zw wq pv   <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">p</span><span class="main">,</span><span class="skolem">q</span><span class="main">)</span> <span class="main">∈</span> d<span class="main">^-1</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> d <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
        <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> x  <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span><span class="keyword1"><span class="command">}</span></span>
       <span class="keyword1"><span class="command">qed</span></span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="comment1">(*==========$\gamma$ composition =======*)</span>
<span class="keyword1"><span class="command">subsection</span></span> <span class="quoted"><span class="plain_text">‹$\gamma$-composition›</span></span>
<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹We prove compositions of the form $r_1 \circ r_2 \subseteq ov \cup s \cup d \cup f \cup e \cup f^{-1} \cup d^{-1} \cup s^{-1} \cup ov^{-1}$.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> covovi<span class="main">:</span><span class="quoted"><span class="quoted">"ov <span class="keyword1">O</span> ov<span class="main">^-1</span> <span class="main">⊆</span> e <span class="main">∪</span> ov <span class="main">∪</span> ov<span class="main">^-1</span> <span class="main">∪</span> d <span class="main">∪</span> d<span class="main">^-1</span> <span class="main">∪</span> s <span class="main">∪</span> s<span class="main">^-1</span> <span class="main">∪</span> f <span class="main">∪</span> f<span class="main">^-1</span> "</span></span>
<span class="keyword1"><span class="command">proof</span></span>
  <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">x</span><span class="main">::</span><span class="quoted"><span class="quoted">"<span class="tfree">'a</span><span class="main">×</span><span class="tfree">'a</span>"</span></span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">∈</span> ov <span class="keyword1">O</span> ov<span class="main">^-1</span>"</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">p</span></span> <span class="skolem"><span class="skolem">q</span></span> <span class="skolem"><span class="skolem">z</span></span> <span class="keyword2"><span class="keyword">where</span></span> x<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">=</span> <span class="main">(</span><span class="skolem">p</span><span class="main">,</span><span class="skolem">q</span><span class="main">)</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">p</span><span class="main">,</span><span class="skolem">z</span><span class="main">)</span> <span class="main">∈</span> ov"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">z</span><span class="main">,</span> <span class="skolem">q</span><span class="main">)</span> <span class="main">∈</span> ov<span class="main">^-1</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="main">(</span><span class="skolem">p</span><span class="main">,</span><span class="skolem">z</span><span class="main">)</span> <span class="main">∈</span> ov›</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">k</span></span> <span class="skolem"><span class="skolem">l</span></span> <span class="skolem"><span class="skolem">c</span></span> <span class="skolem"><span class="skolem">u</span></span>  <span class="keyword2"><span class="keyword">where</span></span> kp<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">k</span><span class="main">∥</span><span class="skolem">p</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> kl<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">k</span><span class="main">∥</span><span class="skolem">l</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> lz<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">l</span><span class="main">∥</span><span class="skolem">z</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> lc<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">l</span><span class="main">∥</span><span class="skolem">c</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> pu<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">p</span><span class="main">∥</span><span class="skolem">u</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> cu<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">c</span><span class="main">∥</span><span class="skolem">u</span>"</span></span>  <span class="keyword1"><span class="command">using</span></span> ov <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="main">(</span><span class="skolem">z</span><span class="main">,</span><span class="skolem">q</span><span class="main">)</span> <span class="main">∈</span> ov<span class="main">^-1</span>›</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">k'</span></span> <span class="skolem"><span class="skolem">l'</span></span> <span class="skolem"><span class="skolem">c'</span></span> <span class="skolem"><span class="skolem">u'</span></span>  <span class="keyword2"><span class="keyword">where</span></span> kpq<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">k'</span><span class="main">∥</span><span class="skolem">q</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> kplp<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">k'</span><span class="main">∥</span><span class="skolem">l'</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> lpz<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">l'</span><span class="main">∥</span><span class="skolem">z</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> lpcp<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">l'</span><span class="main">∥</span><span class="skolem">c'</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> qup<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">q</span><span class="main">∥</span><span class="skolem">u'</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> cpup<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">c'</span><span class="main">∥</span><span class="skolem">u'</span>"</span></span>  <span class="keyword1"><span class="command">using</span></span> ov <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>

  <span class="keyword1"><span class="command">from</span></span> kp kpq  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">k</span><span class="main">∥</span><span class="skolem">q</span> <span class="main">⊕</span> <span class="main">(</span><span class="main">(</span><span class="main">∃</span><span class="bound">t</span><span class="main">.</span> <span class="skolem">k</span><span class="main">∥</span><span class="bound">t</span> <span class="main">∧</span> <span class="bound">t</span><span class="main">∥</span><span class="skolem">q</span><span class="main">)</span> <span class="main">⊕</span> <span class="main">(</span><span class="main">∃</span><span class="bound">t</span><span class="main">.</span> <span class="skolem">k'</span><span class="main">∥</span><span class="bound">t</span> <span class="main">∧</span> <span class="bound">t</span><span class="main">∥</span><span class="skolem">p</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">is</span></span> <span class="quoted"><span class="quoted">"<span class="var">?A</span> <span class="main">⊕</span> <span class="main">(</span><span class="var">?B</span> <span class="main">⊕</span> <span class="var">?C</span><span class="main">)</span>"</span></span><span class="main">)</span> <span class="keyword1"><span class="command">using</span></span> M2 <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="var">?A</span><span class="main">∧</span><span class="main">¬</span><span class="var">?B</span><span class="main">∧</span><span class="main">¬</span><span class="var">?C</span><span class="main">)</span> <span class="main">∨</span> <span class="main">(</span><span class="main">(</span><span class="main">¬</span><span class="var">?A</span><span class="main">∧</span><span class="var">?B</span><span class="main">∧</span><span class="main">¬</span><span class="var">?C</span><span class="main">)</span> <span class="main">∨</span> <span class="main">(</span><span class="main">¬</span><span class="var">?A</span><span class="main">∧</span><span class="main">¬</span><span class="var">?B</span><span class="main">∧</span><span class="var">?C</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">insert</span> xor_distr_L<span class="main"><span class="main">[</span></span><span class="operator">of</span> <span class="var"><span class="quoted"><span class="var">?A</span></span></span> <span class="var"><span class="quoted"><span class="var">?B</span></span></span> <span class="var"><span class="quoted"><span class="var">?C</span></span></span><span class="main"><span class="main">]</span></span><span class="main"><span class="keyword3">,</span></span> <span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span>elimmeets<span class="main">)</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">∈</span> e <span class="main">∪</span> ov <span class="main">∪</span> ov<span class="main">^-1</span> <span class="main">∪</span> d <span class="main">∪</span> d<span class="main">^-1</span> <span class="main">∪</span> s <span class="main">∪</span> s<span class="main">^-1</span> <span class="main">∪</span> f <span class="main">∪</span> f<span class="main">^-1</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">elim</span> disjE<span class="main">)</span>
      <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="var">?A</span><span class="main">∧</span><span class="main">¬</span><span class="var">?B</span><span class="main">∧</span><span class="main">¬</span><span class="var">?C</span>"</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> kq<span class="main">:</span><span class="var"><span class="quoted"><span class="var">?A</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
        <span class="keyword1"><span class="command">from</span></span> pu qup <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">p</span><span class="main">∥</span><span class="skolem">u'</span> <span class="main">⊕</span> <span class="main">(</span><span class="main">(</span><span class="main">∃</span><span class="bound">t'</span><span class="main">.</span> <span class="skolem">p</span><span class="main">∥</span><span class="bound">t'</span> <span class="main">∧</span> <span class="bound">t'</span><span class="main">∥</span><span class="skolem">u'</span><span class="main">)</span> <span class="main">⊕</span> <span class="main">(</span><span class="main">∃</span><span class="bound">t'</span><span class="main">.</span> <span class="skolem">q</span><span class="main">∥</span><span class="bound">t'</span> <span class="main">∧</span> <span class="bound">t'</span><span class="main">∥</span><span class="skolem">u</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">is</span></span> <span class="quoted"><span class="quoted">"<span class="var">?A</span> <span class="main">⊕</span> <span class="main">(</span><span class="var">?B</span> <span class="main">⊕</span> <span class="var">?C</span><span class="main">)</span>"</span></span><span class="main">)</span> <span class="keyword1"><span class="command">using</span></span> M2 <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
        <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="var">?A</span><span class="main">∧</span><span class="main">¬</span><span class="var">?B</span><span class="main">∧</span><span class="main">¬</span><span class="var">?C</span><span class="main">)</span> <span class="main">∨</span> <span class="main">(</span><span class="main">(</span><span class="main">¬</span><span class="var">?A</span><span class="main">∧</span><span class="var">?B</span><span class="main">∧</span><span class="main">¬</span><span class="var">?C</span><span class="main">)</span> <span class="main">∨</span> <span class="main">(</span><span class="main">¬</span><span class="var">?A</span><span class="main">∧</span><span class="main">¬</span><span class="var">?B</span><span class="main">∧</span><span class="var">?C</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">insert</span> xor_distr_L<span class="main"><span class="main">[</span></span><span class="operator">of</span> <span class="var"><span class="quoted"><span class="var">?A</span></span></span> <span class="var"><span class="quoted"><span class="var">?B</span></span></span> <span class="var"><span class="quoted"><span class="var">?C</span></span></span><span class="main"><span class="main">]</span></span><span class="main"><span class="keyword3">,</span></span> <span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span>elimmeets<span class="main">)</span>
        <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
        <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">elim</span> disjE<span class="main">)</span>
          <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="var">?A</span><span class="main">∧</span><span class="main">¬</span><span class="var">?B</span><span class="main">∧</span><span class="main">¬</span><span class="var">?C</span>"</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="var"><span class="quoted"><span class="var">?A</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
            <span class="keyword1"><span class="command">with</span></span> kq kp qup <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">p</span> <span class="main">=</span> <span class="skolem">q</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> M4 <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
            <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> x e <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span><span class="keyword1"><span class="command">}</span></span>
          <span class="keyword1"><span class="command">next</span></span>
          <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span><span class="var">?A</span><span class="main">∧</span><span class="var">?B</span><span class="main">∧</span><span class="main">¬</span><span class="var">?C</span>"</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="var"><span class="quoted"><span class="var">?B</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
            <span class="keyword1"><span class="command">with</span></span> kq kp qup <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> x s <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span><span class="keyword1"><span class="command">}</span></span>
          <span class="keyword1"><span class="command">next</span></span>
          <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span><span class="var">?A</span><span class="main">∧</span><span class="main">¬</span><span class="var">?B</span><span class="main">∧</span><span class="var">?C</span>"</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="var"><span class="quoted"><span class="var">?C</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
            <span class="keyword1"><span class="command">with</span></span> kq kp pu <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> x s <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span><span class="keyword1"><span class="command">}</span></span>
        <span class="keyword1"><span class="command">qed</span></span><span class="keyword1"><span class="command">}</span></span>
      <span class="keyword1"><span class="command">next</span></span>
      <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span><span class="var">?A</span><span class="main">∧</span><span class="var">?B</span><span class="main">∧</span><span class="main">¬</span><span class="var">?C</span>"</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="var"><span class="quoted"><span class="var">?B</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
        <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">t</span></span> <span class="keyword2"><span class="keyword">where</span></span> kt<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">k</span><span class="main">∥</span><span class="skolem">t</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> tq<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">t</span><span class="main">∥</span><span class="skolem">q</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword1"><span class="command">from</span></span> pu qup <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">p</span><span class="main">∥</span><span class="skolem">u'</span> <span class="main">⊕</span> <span class="main">(</span><span class="main">(</span><span class="main">∃</span><span class="bound">t'</span><span class="main">.</span> <span class="skolem">p</span><span class="main">∥</span><span class="bound">t'</span> <span class="main">∧</span> <span class="bound">t'</span><span class="main">∥</span><span class="skolem">u'</span><span class="main">)</span> <span class="main">⊕</span> <span class="main">(</span><span class="main">∃</span><span class="bound">t'</span><span class="main">.</span> <span class="skolem">q</span><span class="main">∥</span><span class="bound">t'</span> <span class="main">∧</span> <span class="bound">t'</span><span class="main">∥</span><span class="skolem">u</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">is</span></span> <span class="quoted"><span class="quoted">"<span class="var">?A</span> <span class="main">⊕</span> <span class="main">(</span><span class="var">?B</span> <span class="main">⊕</span> <span class="var">?C</span><span class="main">)</span>"</span></span><span class="main">)</span> <span class="keyword1"><span class="command">using</span></span> M2 <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
        <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="var">?A</span><span class="main">∧</span><span class="main">¬</span><span class="var">?B</span><span class="main">∧</span><span class="main">¬</span><span class="var">?C</span><span class="main">)</span> <span class="main">∨</span> <span class="main">(</span><span class="main">(</span><span class="main">¬</span><span class="var">?A</span><span class="main">∧</span><span class="var">?B</span><span class="main">∧</span><span class="main">¬</span><span class="var">?C</span><span class="main">)</span> <span class="main">∨</span> <span class="main">(</span><span class="main">¬</span><span class="var">?A</span><span class="main">∧</span><span class="main">¬</span><span class="var">?B</span><span class="main">∧</span><span class="var">?C</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">insert</span> xor_distr_L<span class="main"><span class="main">[</span></span><span class="operator">of</span> <span class="var"><span class="quoted"><span class="var">?A</span></span></span> <span class="var"><span class="quoted"><span class="var">?B</span></span></span> <span class="var"><span class="quoted"><span class="var">?C</span></span></span><span class="main"><span class="main">]</span></span><span class="main"><span class="keyword3">,</span></span> <span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span>elimmeets<span class="main">)</span>
        <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
        <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">elim</span> disjE<span class="main">)</span>
          <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="var">?A</span><span class="main">∧</span><span class="main">¬</span><span class="var">?B</span><span class="main">∧</span><span class="main">¬</span><span class="var">?C</span>"</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="var"><span class="quoted"><span class="var">?A</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
            <span class="keyword1"><span class="command">with</span></span> qup kp kt tq  <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> x f  <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span><span class="keyword1"><span class="command">}</span></span>
          <span class="keyword1"><span class="command">next</span></span>
          <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span><span class="var">?A</span><span class="main">∧</span><span class="var">?B</span><span class="main">∧</span><span class="main">¬</span><span class="var">?C</span>"</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="var"><span class="quoted"><span class="var">?B</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
            <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">t'</span></span> <span class="keyword2"><span class="keyword">where</span></span> ptp<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">p</span><span class="main">∥</span><span class="skolem">t'</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> tpup<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">t'</span><span class="main">∥</span><span class="skolem">u'</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
            <span class="keyword1"><span class="command">from</span></span> tq kpq kplp <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">t</span><span class="main">∥</span><span class="skolem">l'</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> M1 <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
            <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command"><span class="improper">with</span></span></span> lpz lz lc <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">l'</span><span class="main">∥</span><span class="skolem">c</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> M1 <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
            <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command"><span class="improper">with</span></span></span> cu pu ptp <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">c</span><span class="main">∥</span><span class="skolem">t'</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> M1 <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
            <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">lc</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">t</span><span class="main">∥</span><span class="skolem">lc</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">lc</span><span class="main">∥</span><span class="skolem">t'</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> M5exist_var <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
            <span class="keyword1"><span class="command">with</span></span> ptp tpup kp kt tq qup  <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> x ov <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span><span class="keyword1"><span class="command">}</span></span>
          <span class="keyword1"><span class="command">next</span></span>
          <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span><span class="var">?A</span><span class="main">∧</span><span class="main">¬</span><span class="var">?B</span><span class="main">∧</span><span class="var">?C</span>"</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="var"><span class="quoted"><span class="var">?C</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
            <span class="keyword1"><span class="command">with</span></span> pu kp kt tq  <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> x d  <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span><span class="keyword1"><span class="command">}</span></span>

        <span class="keyword1"><span class="command">qed</span></span><span class="keyword1"><span class="command">}</span></span>
      <span class="keyword1"><span class="command">next</span></span>
      <span class="keyword1"><span class="command">{</span></span><span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span><span class="var">?A</span><span class="main">∧</span><span class="main">¬</span><span class="var">?B</span><span class="main">∧</span><span class="var">?C</span>"</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="var"><span class="quoted"><span class="var">?C</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
       <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">t</span></span> <span class="keyword2"><span class="keyword">where</span></span> kpt<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">k'</span><span class="main">∥</span><span class="skolem">t</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> tp<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">t</span><span class="main">∥</span><span class="skolem">p</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword1"><span class="command">from</span></span> pu qup <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">p</span><span class="main">∥</span><span class="skolem">u'</span> <span class="main">⊕</span> <span class="main">(</span><span class="main">(</span><span class="main">∃</span><span class="bound">t'</span><span class="main">.</span> <span class="skolem">p</span><span class="main">∥</span><span class="bound">t'</span> <span class="main">∧</span> <span class="bound">t'</span><span class="main">∥</span><span class="skolem">u'</span><span class="main">)</span> <span class="main">⊕</span> <span class="main">(</span><span class="main">∃</span><span class="bound">t'</span><span class="main">.</span> <span class="skolem">q</span><span class="main">∥</span><span class="bound">t'</span> <span class="main">∧</span> <span class="bound">t'</span><span class="main">∥</span><span class="skolem">u</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">is</span></span> <span class="quoted"><span class="quoted">"<span class="var">?A</span> <span class="main">⊕</span> <span class="main">(</span><span class="var">?B</span> <span class="main">⊕</span> <span class="var">?C</span><span class="main">)</span>"</span></span><span class="main">)</span> <span class="keyword1"><span class="command">using</span></span> M2 <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
        <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="var">?A</span><span class="main">∧</span><span class="main">¬</span><span class="var">?B</span><span class="main">∧</span><span class="main">¬</span><span class="var">?C</span><span class="main">)</span> <span class="main">∨</span> <span class="main">(</span><span class="main">(</span><span class="main">¬</span><span class="var">?A</span><span class="main">∧</span><span class="var">?B</span><span class="main">∧</span><span class="main">¬</span><span class="var">?C</span><span class="main">)</span> <span class="main">∨</span> <span class="main">(</span><span class="main">¬</span><span class="var">?A</span><span class="main">∧</span><span class="main">¬</span><span class="var">?B</span><span class="main">∧</span><span class="var">?C</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">insert</span> xor_distr_L<span class="main"><span class="main">[</span></span><span class="operator">of</span> <span class="var"><span class="quoted"><span class="var">?A</span></span></span> <span class="var"><span class="quoted"><span class="var">?B</span></span></span> <span class="var"><span class="quoted"><span class="var">?C</span></span></span><span class="main"><span class="main">]</span></span><span class="main"><span class="keyword3">,</span></span> <span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span>elimmeets<span class="main">)</span>
        <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
        <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">elim</span> disjE<span class="main">)</span>
          <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="var">?A</span><span class="main">∧</span><span class="main">¬</span><span class="var">?B</span><span class="main">∧</span><span class="main">¬</span><span class="var">?C</span>"</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="var"><span class="quoted"><span class="var">?A</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
            <span class="keyword1"><span class="command">with</span></span> kpq kpt tp qup <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> x f  <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span><span class="keyword1"><span class="command">}</span></span>
          <span class="keyword1"><span class="command">next</span></span>
          <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span><span class="var">?A</span><span class="main">∧</span><span class="var">?B</span><span class="main">∧</span><span class="main">¬</span><span class="var">?C</span>"</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="var"><span class="quoted"><span class="var">?B</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
            <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">t'</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">p</span><span class="main">∥</span><span class="skolem">t'</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">t'</span><span class="main">∥</span><span class="skolem">u'</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
            <span class="keyword1"><span class="command">with</span></span>  kpq kpt tp qup <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> x d <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span><span class="keyword1"><span class="command">}</span></span>
          <span class="keyword1"><span class="command">next</span></span>
          <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span><span class="var">?A</span><span class="main">∧</span><span class="main">¬</span><span class="var">?B</span><span class="main">∧</span><span class="var">?C</span>"</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="var"><span class="quoted"><span class="var">?C</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
            <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">t'</span></span> <span class="keyword2"><span class="keyword">where</span></span> qtp<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">q</span><span class="main">∥</span><span class="skolem">t'</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> tpu<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">t'</span><span class="main">∥</span><span class="skolem">u</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
            <span class="keyword1"><span class="command">from</span></span> tp kp kl <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">t</span><span class="main">∥</span><span class="skolem">l</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> M1 <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
            <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command"><span class="improper">with</span></span></span> lpcp lpz lz <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">l</span><span class="main">∥</span><span class="skolem">c'</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> M1 <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
            <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command"><span class="improper">with</span></span></span> cpup qup qtp <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">c'</span><span class="main">∥</span><span class="skolem">t'</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> M1 <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
            <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">lc</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">t</span><span class="main">∥</span><span class="skolem">lc</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">lc</span><span class="main">∥</span><span class="skolem">t'</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> M5exist_var <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
            <span class="keyword1"><span class="command">with</span></span> kpt tp kpq qtp tpu pu <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> x ov <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span><span class="keyword1"><span class="command">}</span></span>
          <span class="keyword1"><span class="command">qed</span></span><span class="keyword1"><span class="command">}</span></span>
      <span class="keyword1"><span class="command">qed</span></span>
<span class="keyword1"><span class="command">qed</span></span>


<span class="keyword1"><span class="command">lemma</span></span> cdid<span class="main">:</span><span class="quoted"><span class="quoted">"d<span class="main">^-1</span> <span class="keyword1">O</span> d <span class="main">⊆</span> e <span class="main">∪</span> ov <span class="main">∪</span> ov<span class="main">^-1</span> <span class="main">∪</span> d <span class="main">∪</span> d<span class="main">^-1</span> <span class="main">∪</span> s <span class="main">∪</span> s<span class="main">^-1</span> <span class="main">∪</span> f <span class="main">∪</span> f<span class="main">^-1</span> "</span></span>
<span class="keyword1"><span class="command">proof</span></span>
  <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">x</span><span class="main">::</span><span class="quoted"><span class="quoted">"<span class="tfree">'a</span><span class="main">×</span><span class="tfree">'a</span>"</span></span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">∈</span> d<span class="main">^-1</span> <span class="keyword1">O</span> d"</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">p</span></span> <span class="skolem"><span class="skolem">q</span></span> <span class="skolem"><span class="skolem">z</span></span> <span class="keyword2"><span class="keyword">where</span></span> x<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">=</span> <span class="main">(</span><span class="skolem">p</span><span class="main">,</span><span class="skolem">q</span><span class="main">)</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">p</span><span class="main">,</span><span class="skolem">z</span><span class="main">)</span> <span class="main">∈</span> d<span class="main">^-1</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">z</span><span class="main">,</span> <span class="skolem">q</span><span class="main">)</span> <span class="main">∈</span> d"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="main">(</span><span class="skolem">p</span><span class="main">,</span><span class="skolem">z</span><span class="main">)</span> <span class="main">∈</span> d<span class="main">^-1</span>›</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">k</span></span> <span class="skolem"><span class="skolem">l</span></span> <span class="skolem"><span class="skolem">u</span></span> <span class="skolem"><span class="skolem">v</span></span> <span class="keyword2"><span class="keyword">where</span></span> kp<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">k</span><span class="main">∥</span><span class="skolem">p</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> kl<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">k</span><span class="main">∥</span><span class="skolem">l</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> lz<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">l</span><span class="main">∥</span><span class="skolem">z</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> pv<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">p</span><span class="main">∥</span><span class="skolem">v</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> zu<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">z</span><span class="main">∥</span><span class="skolem">u</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> uv<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">u</span><span class="main">∥</span><span class="skolem">v</span>"</span></span>  <span class="keyword1"><span class="command">using</span></span> d <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="main">(</span><span class="skolem">z</span><span class="main">,</span><span class="skolem">q</span><span class="main">)</span> <span class="main">∈</span> d›</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">k'</span></span> <span class="skolem"><span class="skolem">l'</span></span>  <span class="skolem"><span class="skolem">u'</span></span> <span class="skolem"><span class="skolem">v'</span></span>  <span class="keyword2"><span class="keyword">where</span></span> kpq<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">k'</span><span class="main">∥</span><span class="skolem">q</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> kplp<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">k'</span><span class="main">∥</span><span class="skolem">l'</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> lpz<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">l'</span><span class="main">∥</span><span class="skolem">z</span>"</span></span>  <span class="keyword2"><span class="keyword">and</span></span> qvp<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">q</span><span class="main">∥</span><span class="skolem">v'</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> zup<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">z</span><span class="main">∥</span><span class="skolem">u'</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> upvp<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">u'</span><span class="main">∥</span><span class="skolem">v'</span>"</span></span>  <span class="keyword1"><span class="command">using</span></span> d <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>

  <span class="keyword1"><span class="command">from</span></span> kp kpq  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">k</span><span class="main">∥</span><span class="skolem">q</span> <span class="main">⊕</span> <span class="main">(</span><span class="main">(</span><span class="main">∃</span><span class="bound">t</span><span class="main">.</span> <span class="skolem">k</span><span class="main">∥</span><span class="bound">t</span> <span class="main">∧</span> <span class="bound">t</span><span class="main">∥</span><span class="skolem">q</span><span class="main">)</span> <span class="main">⊕</span> <span class="main">(</span><span class="main">∃</span><span class="bound">t</span><span class="main">.</span> <span class="skolem">k'</span><span class="main">∥</span><span class="bound">t</span> <span class="main">∧</span> <span class="bound">t</span><span class="main">∥</span><span class="skolem">p</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">is</span></span> <span class="quoted"><span class="quoted">"<span class="var">?A</span> <span class="main">⊕</span> <span class="main">(</span><span class="var">?B</span> <span class="main">⊕</span> <span class="var">?C</span><span class="main">)</span>"</span></span><span class="main">)</span> <span class="keyword1"><span class="command">using</span></span> M2 <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="var">?A</span><span class="main">∧</span><span class="main">¬</span><span class="var">?B</span><span class="main">∧</span><span class="main">¬</span><span class="var">?C</span><span class="main">)</span> <span class="main">∨</span> <span class="main">(</span><span class="main">(</span><span class="main">¬</span><span class="var">?A</span><span class="main">∧</span><span class="var">?B</span><span class="main">∧</span><span class="main">¬</span><span class="var">?C</span><span class="main">)</span> <span class="main">∨</span> <span class="main">(</span><span class="main">¬</span><span class="var">?A</span><span class="main">∧</span><span class="main">¬</span><span class="var">?B</span><span class="main">∧</span><span class="var">?C</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">insert</span> xor_distr_L<span class="main"><span class="main">[</span></span><span class="operator">of</span> <span class="var"><span class="quoted"><span class="var">?A</span></span></span> <span class="var"><span class="quoted"><span class="var">?B</span></span></span> <span class="var"><span class="quoted"><span class="var">?C</span></span></span><span class="main"><span class="main">]</span></span><span class="main"><span class="keyword3">,</span></span> <span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span>elimmeets<span class="main">)</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">∈</span> e <span class="main">∪</span> ov <span class="main">∪</span> ov<span class="main">^-1</span> <span class="main">∪</span> d <span class="main">∪</span> d<span class="main">^-1</span> <span class="main">∪</span> s <span class="main">∪</span> s<span class="main">^-1</span> <span class="main">∪</span> f <span class="main">∪</span> f<span class="main">^-1</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">elim</span> disjE<span class="main">)</span>
      <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="var">?A</span><span class="main">∧</span><span class="main">¬</span><span class="var">?B</span><span class="main">∧</span><span class="main">¬</span><span class="var">?C</span>"</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> kq<span class="main">:</span><span class="var"><span class="quoted"><span class="var">?A</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
        <span class="keyword1"><span class="command">from</span></span> pv qvp <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">p</span><span class="main">∥</span><span class="skolem">v'</span> <span class="main">⊕</span> <span class="main">(</span><span class="main">(</span><span class="main">∃</span><span class="bound">t'</span><span class="main">.</span> <span class="skolem">p</span><span class="main">∥</span><span class="bound">t'</span> <span class="main">∧</span> <span class="bound">t'</span><span class="main">∥</span><span class="skolem">v'</span><span class="main">)</span> <span class="main">⊕</span> <span class="main">(</span><span class="main">∃</span><span class="bound">t'</span><span class="main">.</span> <span class="skolem">q</span><span class="main">∥</span><span class="bound">t'</span> <span class="main">∧</span> <span class="bound">t'</span><span class="main">∥</span><span class="skolem">v</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">is</span></span> <span class="quoted"><span class="quoted">"<span class="var">?A</span> <span class="main">⊕</span> <span class="main">(</span><span class="var">?B</span> <span class="main">⊕</span> <span class="var">?C</span><span class="main">)</span>"</span></span><span class="main">)</span> <span class="keyword1"><span class="command">using</span></span> M2 <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
        <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="var">?A</span><span class="main">∧</span><span class="main">¬</span><span class="var">?B</span><span class="main">∧</span><span class="main">¬</span><span class="var">?C</span><span class="main">)</span> <span class="main">∨</span> <span class="main">(</span><span class="main">(</span><span class="main">¬</span><span class="var">?A</span><span class="main">∧</span><span class="var">?B</span><span class="main">∧</span><span class="main">¬</span><span class="var">?C</span><span class="main">)</span> <span class="main">∨</span> <span class="main">(</span><span class="main">¬</span><span class="var">?A</span><span class="main">∧</span><span class="main">¬</span><span class="var">?B</span><span class="main">∧</span><span class="var">?C</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">insert</span> xor_distr_L<span class="main"><span class="main">[</span></span><span class="operator">of</span> <span class="var"><span class="quoted"><span class="var">?A</span></span></span> <span class="var"><span class="quoted"><span class="var">?B</span></span></span> <span class="var"><span class="quoted"><span class="var">?C</span></span></span><span class="main"><span class="main">]</span></span><span class="main"><span class="keyword3">,</span></span> <span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span>elimmeets<span class="main">)</span>
        <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
        <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">elim</span> disjE<span class="main">)</span>
          <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="var">?A</span><span class="main">∧</span><span class="main">¬</span><span class="var">?B</span><span class="main">∧</span><span class="main">¬</span><span class="var">?C</span>"</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="var"><span class="quoted"><span class="var">?A</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
            <span class="keyword1"><span class="command">with</span></span> kq kp qvp <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">p</span> <span class="main">=</span> <span class="skolem">q</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> M4 <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
            <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> x e <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span><span class="keyword1"><span class="command">}</span></span>
          <span class="keyword1"><span class="command">next</span></span>
          <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span><span class="var">?A</span><span class="main">∧</span><span class="var">?B</span><span class="main">∧</span><span class="main">¬</span><span class="var">?C</span>"</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="var"><span class="quoted"><span class="var">?B</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
            <span class="keyword1"><span class="command">with</span></span> kq kp qvp <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> x s <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span><span class="keyword1"><span class="command">}</span></span>
          <span class="keyword1"><span class="command">next</span></span>
          <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span><span class="var">?A</span><span class="main">∧</span><span class="main">¬</span><span class="var">?B</span><span class="main">∧</span><span class="var">?C</span>"</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="var"><span class="quoted"><span class="var">?C</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
            <span class="keyword1"><span class="command">with</span></span> kq kp pv <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> x s <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span><span class="keyword1"><span class="command">}</span></span>
        <span class="keyword1"><span class="command">qed</span></span><span class="keyword1"><span class="command">}</span></span>
      <span class="keyword1"><span class="command">next</span></span>
      <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span><span class="var">?A</span><span class="main">∧</span><span class="var">?B</span><span class="main">∧</span><span class="main">¬</span><span class="var">?C</span>"</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="var"><span class="quoted"><span class="var">?B</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
        <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">t</span></span> <span class="keyword2"><span class="keyword">where</span></span> kt<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">k</span><span class="main">∥</span><span class="skolem">t</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> tq<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">t</span><span class="main">∥</span><span class="skolem">q</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword1"><span class="command">from</span></span> pv qvp <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">p</span><span class="main">∥</span><span class="skolem">v'</span> <span class="main">⊕</span> <span class="main">(</span><span class="main">(</span><span class="main">∃</span><span class="bound">t'</span><span class="main">.</span> <span class="skolem">p</span><span class="main">∥</span><span class="bound">t'</span> <span class="main">∧</span> <span class="bound">t'</span><span class="main">∥</span><span class="skolem">v'</span><span class="main">)</span> <span class="main">⊕</span> <span class="main">(</span><span class="main">∃</span><span class="bound">t'</span><span class="main">.</span> <span class="skolem">q</span><span class="main">∥</span><span class="bound">t'</span> <span class="main">∧</span> <span class="bound">t'</span><span class="main">∥</span><span class="skolem">v</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">is</span></span> <span class="quoted"><span class="quoted">"<span class="var">?A</span> <span class="main">⊕</span> <span class="main">(</span><span class="var">?B</span> <span class="main">⊕</span> <span class="var">?C</span><span class="main">)</span>"</span></span><span class="main">)</span> <span class="keyword1"><span class="command">using</span></span> M2 <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
        <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="var">?A</span><span class="main">∧</span><span class="main">¬</span><span class="var">?B</span><span class="main">∧</span><span class="main">¬</span><span class="var">?C</span><span class="main">)</span> <span class="main">∨</span> <span class="main">(</span><span class="main">(</span><span class="main">¬</span><span class="var">?A</span><span class="main">∧</span><span class="var">?B</span><span class="main">∧</span><span class="main">¬</span><span class="var">?C</span><span class="main">)</span> <span class="main">∨</span> <span class="main">(</span><span class="main">¬</span><span class="var">?A</span><span class="main">∧</span><span class="main">¬</span><span class="var">?B</span><span class="main">∧</span><span class="var">?C</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">insert</span> xor_distr_L<span class="main"><span class="main">[</span></span><span class="operator">of</span> <span class="var"><span class="quoted"><span class="var">?A</span></span></span> <span class="var"><span class="quoted"><span class="var">?B</span></span></span> <span class="var"><span class="quoted"><span class="var">?C</span></span></span><span class="main"><span class="main">]</span></span><span class="main"><span class="keyword3">,</span></span> <span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span>elimmeets<span class="main">)</span>
        <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
        <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">elim</span> disjE<span class="main">)</span>
          <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="var">?A</span><span class="main">∧</span><span class="main">¬</span><span class="var">?B</span><span class="main">∧</span><span class="main">¬</span><span class="var">?C</span>"</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="var"><span class="quoted"><span class="var">?A</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
            <span class="keyword1"><span class="command">with</span></span> qvp kp kt tq  <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> x f  <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span><span class="keyword1"><span class="command">}</span></span>
          <span class="keyword1"><span class="command">next</span></span>
          <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span><span class="var">?A</span><span class="main">∧</span><span class="var">?B</span><span class="main">∧</span><span class="main">¬</span><span class="var">?C</span>"</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="var"><span class="quoted"><span class="var">?B</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
            <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">t'</span></span> <span class="keyword2"><span class="keyword">where</span></span> ptp<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">p</span><span class="main">∥</span><span class="skolem">t'</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> tpvp<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">t'</span><span class="main">∥</span><span class="skolem">v'</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
            <span class="keyword1"><span class="command">from</span></span> tq kpq kplp <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">t</span><span class="main">∥</span><span class="skolem">l'</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> M1 <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
            <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command"><span class="improper">with</span></span></span> ptp pv uv <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">u</span><span class="main">∥</span><span class="skolem">t'</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> M1 <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
            <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command"><span class="improper">with</span></span></span> lpz zu <span class="quoted"><span class="quoted">‹<span class="skolem">t</span><span class="main">∥</span><span class="skolem">l'</span>›</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">lzu</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">t</span><span class="main">∥</span><span class="skolem">lzu</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">lzu</span><span class="main">∥</span><span class="skolem">t'</span>"</span></span> <span class="keyword1"><span class="command">using</span></span>  M5exist_var   <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
            <span class="keyword1"><span class="command">ultimately</span></span>  <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> x ov kt tq kp ptp tpvp qvp <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span><span class="keyword1"><span class="command">}</span></span>
          <span class="keyword1"><span class="command">next</span></span>
          <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span><span class="var">?A</span><span class="main">∧</span><span class="main">¬</span><span class="var">?B</span><span class="main">∧</span><span class="var">?C</span>"</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="var"><span class="quoted"><span class="var">?C</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
            <span class="keyword1"><span class="command">with</span></span> pv kp kt tq  <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> x d  <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span><span class="keyword1"><span class="command">}</span></span>

        <span class="keyword1"><span class="command">qed</span></span><span class="keyword1"><span class="command">}</span></span>
      <span class="keyword1"><span class="command">next</span></span>
      <span class="keyword1"><span class="command">{</span></span><span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span><span class="var">?A</span><span class="main">∧</span><span class="main">¬</span><span class="var">?B</span><span class="main">∧</span><span class="var">?C</span>"</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="var"><span class="quoted"><span class="var">?C</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
       <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">t</span></span> <span class="keyword2"><span class="keyword">where</span></span> kpt<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">k'</span><span class="main">∥</span><span class="skolem">t</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> tp<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">t</span><span class="main">∥</span><span class="skolem">p</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword1"><span class="command">from</span></span> pv qvp <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">p</span><span class="main">∥</span><span class="skolem">v'</span> <span class="main">⊕</span> <span class="main">(</span><span class="main">(</span><span class="main">∃</span><span class="bound">t'</span><span class="main">.</span> <span class="skolem">p</span><span class="main">∥</span><span class="bound">t'</span> <span class="main">∧</span> <span class="bound">t'</span><span class="main">∥</span><span class="skolem">v'</span><span class="main">)</span> <span class="main">⊕</span> <span class="main">(</span><span class="main">∃</span><span class="bound">t'</span><span class="main">.</span> <span class="skolem">q</span><span class="main">∥</span><span class="bound">t'</span> <span class="main">∧</span> <span class="bound">t'</span><span class="main">∥</span><span class="skolem">v</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">is</span></span> <span class="quoted"><span class="quoted">"<span class="var">?A</span> <span class="main">⊕</span> <span class="main">(</span><span class="var">?B</span> <span class="main">⊕</span> <span class="var">?C</span><span class="main">)</span>"</span></span><span class="main">)</span> <span class="keyword1"><span class="command">using</span></span> M2 <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
        <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="var">?A</span><span class="main">∧</span><span class="main">¬</span><span class="var">?B</span><span class="main">∧</span><span class="main">¬</span><span class="var">?C</span><span class="main">)</span> <span class="main">∨</span> <span class="main">(</span><span class="main">(</span><span class="main">¬</span><span class="var">?A</span><span class="main">∧</span><span class="var">?B</span><span class="main">∧</span><span class="main">¬</span><span class="var">?C</span><span class="main">)</span> <span class="main">∨</span> <span class="main">(</span><span class="main">¬</span><span class="var">?A</span><span class="main">∧</span><span class="main">¬</span><span class="var">?B</span><span class="main">∧</span><span class="var">?C</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">insert</span> xor_distr_L<span class="main"><span class="main">[</span></span><span class="operator">of</span> <span class="var"><span class="quoted"><span class="var">?A</span></span></span> <span class="var"><span class="quoted"><span class="var">?B</span></span></span> <span class="var"><span class="quoted"><span class="var">?C</span></span></span><span class="main"><span class="main">]</span></span><span class="main"><span class="keyword3">,</span></span> <span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span>elimmeets<span class="main">)</span>
        <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
        <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">elim</span> disjE<span class="main">)</span>
          <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="var">?A</span><span class="main">∧</span><span class="main">¬</span><span class="var">?B</span><span class="main">∧</span><span class="main">¬</span><span class="var">?C</span>"</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="var"><span class="quoted"><span class="var">?A</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
            <span class="keyword1"><span class="command">with</span></span> kpq kpt tp qvp <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> x f  <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span><span class="keyword1"><span class="command">}</span></span>
          <span class="keyword1"><span class="command">next</span></span>
          <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span><span class="var">?A</span><span class="main">∧</span><span class="var">?B</span><span class="main">∧</span><span class="main">¬</span><span class="var">?C</span>"</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="var"><span class="quoted"><span class="var">?B</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
            <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">t'</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">p</span><span class="main">∥</span><span class="skolem">t'</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">t'</span><span class="main">∥</span><span class="skolem">v'</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
            <span class="keyword1"><span class="command">with</span></span>  kpq kpt tp qvp <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> x d <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span><span class="keyword1"><span class="command">}</span></span>
          <span class="keyword1"><span class="command">next</span></span>
          <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span><span class="var">?A</span><span class="main">∧</span><span class="main">¬</span><span class="var">?B</span><span class="main">∧</span><span class="var">?C</span>"</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="var"><span class="quoted"><span class="var">?C</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
            <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">t'</span></span> <span class="keyword2"><span class="keyword">where</span></span> qtp<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">q</span><span class="main">∥</span><span class="skolem">t'</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> tpv<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">t'</span><span class="main">∥</span><span class="skolem">v</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
            <span class="keyword1"><span class="command">from</span></span> tp kp kl <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">t</span><span class="main">∥</span><span class="skolem">l</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> M1 <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
            <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command"><span class="improper">with</span></span></span> qtp qvp upvp <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">u'</span><span class="main">∥</span><span class="skolem">t'</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> M1 <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
            <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command"><span class="improper">with</span></span></span> lz zup <span class="quoted"><span class="quoted">‹<span class="skolem">t</span><span class="main">∥</span><span class="skolem">l</span>›</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">lzu</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">t</span><span class="main">∥</span><span class="skolem">lzu</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">lzu</span><span class="main">∥</span><span class="skolem">t'</span>"</span></span> <span class="keyword1"><span class="command">using</span></span>  M5exist_var <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
            <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> x ov kpt tp kpq qtp tpv pv  <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span><span class="keyword1"><span class="command">}</span></span>
          <span class="keyword1"><span class="command">qed</span></span><span class="keyword1"><span class="command">}</span></span>
      <span class="keyword1"><span class="command">qed</span></span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">lemma</span></span> coviov<span class="main">:</span><span class="quoted"><span class="quoted">"ov<span class="main">^-1</span> <span class="keyword1">O</span> ov <span class="main">⊆</span> e <span class="main">∪</span> ov <span class="main">∪</span> ov<span class="main">^-1</span> <span class="main">∪</span> d <span class="main">∪</span> d<span class="main">^-1</span> <span class="main">∪</span> s <span class="main">∪</span> s<span class="main">^-1</span> <span class="main">∪</span> f <span class="main">∪</span> f<span class="main">^-1</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span>
  <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">x</span><span class="main">::</span><span class="quoted"><span class="quoted">"<span class="tfree">'a</span><span class="main">×</span><span class="tfree">'a</span>"</span></span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">∈</span> ov<span class="main">^-1</span> <span class="keyword1">O</span> ov"</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">p</span></span> <span class="skolem"><span class="skolem">q</span></span> <span class="skolem"><span class="skolem">z</span></span> <span class="keyword2"><span class="keyword">where</span></span> x<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">=</span> <span class="main">(</span><span class="skolem">p</span><span class="main">,</span><span class="skolem">q</span><span class="main">)</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">p</span><span class="main">,</span><span class="skolem">z</span><span class="main">)</span> <span class="main">∈</span> ov<span class="main">^-1</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">z</span><span class="main">,</span> <span class="skolem">q</span><span class="main">)</span> <span class="main">∈</span> ov"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="main">(</span><span class="skolem">p</span><span class="main">,</span><span class="skolem">z</span><span class="main">)</span> <span class="main">∈</span> ov<span class="main">^-1</span>›</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">k</span></span> <span class="skolem"><span class="skolem">l</span></span> <span class="skolem"><span class="skolem">c</span></span> <span class="skolem"><span class="skolem">u</span></span> <span class="skolem"><span class="skolem">v</span></span> <span class="keyword2"><span class="keyword">where</span></span> kz<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">k</span><span class="main">∥</span><span class="skolem">z</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> kl<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">k</span><span class="main">∥</span><span class="skolem">l</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> lp<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">l</span><span class="main">∥</span><span class="skolem">p</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> lc<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">l</span><span class="main">∥</span><span class="skolem">c</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> zu<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">z</span><span class="main">∥</span><span class="skolem">u</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> pv<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">p</span><span class="main">∥</span><span class="skolem">v</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> cu<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">c</span><span class="main">∥</span><span class="skolem">u</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> uv<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">u</span><span class="main">∥</span><span class="skolem">v</span>"</span></span>  <span class="keyword1"><span class="command">using</span></span> ov <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="main">(</span><span class="skolem">z</span><span class="main">,</span><span class="skolem">q</span><span class="main">)</span> <span class="main">∈</span> ov›</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">k'</span></span> <span class="skolem"><span class="skolem">l'</span></span> <span class="skolem"><span class="skolem">c'</span></span> <span class="skolem"><span class="skolem">u'</span></span> <span class="skolem"><span class="skolem">v'</span></span> <span class="keyword2"><span class="keyword">where</span></span> kpz<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">k'</span><span class="main">∥</span><span class="skolem">z</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> kplp<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">k'</span><span class="main">∥</span><span class="skolem">l'</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> lpq<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">l'</span><span class="main">∥</span><span class="skolem">q</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> lpcp<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">l'</span><span class="main">∥</span><span class="skolem">c'</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> qvp<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">q</span><span class="main">∥</span><span class="skolem">v'</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> zup<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">z</span><span class="main">∥</span><span class="skolem">u'</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> cpup<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">c'</span><span class="main">∥</span><span class="skolem">u'</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> upvp<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">u'</span><span class="main">∥</span><span class="skolem">v'</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> ov <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>

  <span class="keyword1"><span class="command">from</span></span> lp lpq  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">l</span><span class="main">∥</span><span class="skolem">q</span> <span class="main">⊕</span> <span class="main">(</span><span class="main">(</span><span class="main">∃</span><span class="bound">t</span><span class="main">.</span> <span class="skolem">l</span><span class="main">∥</span><span class="bound">t</span> <span class="main">∧</span> <span class="bound">t</span><span class="main">∥</span><span class="skolem">q</span><span class="main">)</span> <span class="main">⊕</span> <span class="main">(</span><span class="main">∃</span><span class="bound">t</span><span class="main">.</span> <span class="skolem">l'</span><span class="main">∥</span><span class="bound">t</span> <span class="main">∧</span> <span class="bound">t</span><span class="main">∥</span><span class="skolem">p</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">is</span></span> <span class="quoted"><span class="quoted">"<span class="var">?A</span> <span class="main">⊕</span> <span class="main">(</span><span class="var">?B</span> <span class="main">⊕</span> <span class="var">?C</span><span class="main">)</span>"</span></span><span class="main">)</span> <span class="keyword1"><span class="command">using</span></span> M2 <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="var">?A</span><span class="main">∧</span><span class="main">¬</span><span class="var">?B</span><span class="main">∧</span><span class="main">¬</span><span class="var">?C</span><span class="main">)</span> <span class="main">∨</span> <span class="main">(</span><span class="main">(</span><span class="main">¬</span><span class="var">?A</span><span class="main">∧</span><span class="var">?B</span><span class="main">∧</span><span class="main">¬</span><span class="var">?C</span><span class="main">)</span> <span class="main">∨</span> <span class="main">(</span><span class="main">¬</span><span class="var">?A</span><span class="main">∧</span><span class="main">¬</span><span class="var">?B</span><span class="main">∧</span><span class="var">?C</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">insert</span> xor_distr_L<span class="main"><span class="main">[</span></span><span class="operator">of</span> <span class="var"><span class="quoted"><span class="var">?A</span></span></span> <span class="var"><span class="quoted"><span class="var">?B</span></span></span> <span class="var"><span class="quoted"><span class="var">?C</span></span></span><span class="main"><span class="main">]</span></span><span class="main"><span class="keyword3">,</span></span> <span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span>elimmeets<span class="main">)</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">∈</span> e <span class="main">∪</span> ov <span class="main">∪</span> ov<span class="main">^-1</span> <span class="main">∪</span> d <span class="main">∪</span> d<span class="main">^-1</span> <span class="main">∪</span> s <span class="main">∪</span> s<span class="main">^-1</span> <span class="main">∪</span> f <span class="main">∪</span> f<span class="main">^-1</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">elim</span> disjE<span class="main">)</span>
      <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="var">?A</span><span class="main">∧</span><span class="main">¬</span><span class="var">?B</span><span class="main">∧</span><span class="main">¬</span><span class="var">?C</span>"</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> lq<span class="main">:</span><span class="var"><span class="quoted"><span class="var">?A</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
        <span class="keyword1"><span class="command">from</span></span> pv qvp <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">p</span><span class="main">∥</span><span class="skolem">v'</span> <span class="main">⊕</span> <span class="main">(</span><span class="main">(</span><span class="main">∃</span><span class="bound">t'</span><span class="main">.</span> <span class="skolem">p</span><span class="main">∥</span><span class="bound">t'</span> <span class="main">∧</span> <span class="bound">t'</span><span class="main">∥</span><span class="skolem">v'</span><span class="main">)</span> <span class="main">⊕</span> <span class="main">(</span><span class="main">∃</span><span class="bound">t'</span><span class="main">.</span> <span class="skolem">q</span><span class="main">∥</span><span class="bound">t'</span> <span class="main">∧</span> <span class="bound">t'</span><span class="main">∥</span><span class="skolem">v</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">is</span></span> <span class="quoted"><span class="quoted">"<span class="var">?A</span> <span class="main">⊕</span> <span class="main">(</span><span class="var">?B</span> <span class="main">⊕</span> <span class="var">?C</span><span class="main">)</span>"</span></span><span class="main">)</span> <span class="keyword1"><span class="command">using</span></span> M2 <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
        <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="var">?A</span><span class="main">∧</span><span class="main">¬</span><span class="var">?B</span><span class="main">∧</span><span class="main">¬</span><span class="var">?C</span><span class="main">)</span> <span class="main">∨</span> <span class="main">(</span><span class="main">(</span><span class="main">¬</span><span class="var">?A</span><span class="main">∧</span><span class="var">?B</span><span class="main">∧</span><span class="main">¬</span><span class="var">?C</span><span class="main">)</span> <span class="main">∨</span> <span class="main">(</span><span class="main">¬</span><span class="var">?A</span><span class="main">∧</span><span class="main">¬</span><span class="var">?B</span><span class="main">∧</span><span class="var">?C</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">insert</span> xor_distr_L<span class="main"><span class="main">[</span></span><span class="operator">of</span> <span class="var"><span class="quoted"><span class="var">?A</span></span></span> <span class="var"><span class="quoted"><span class="var">?B</span></span></span> <span class="var"><span class="quoted"><span class="var">?C</span></span></span><span class="main"><span class="main">]</span></span><span class="main"><span class="keyword3">,</span></span> <span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span>elimmeets<span class="main">)</span>
        <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
        <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">elim</span> disjE<span class="main">)</span>
          <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="var">?A</span><span class="main">∧</span><span class="main">¬</span><span class="var">?B</span><span class="main">∧</span><span class="main">¬</span><span class="var">?C</span>"</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="var"><span class="quoted"><span class="var">?A</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
            <span class="keyword1"><span class="command">with</span></span> lq lp qvp <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">p</span> <span class="main">=</span> <span class="skolem">q</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> M4 <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
            <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> x e <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span><span class="keyword1"><span class="command">}</span></span>
          <span class="keyword1"><span class="command">next</span></span>
          <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span><span class="var">?A</span><span class="main">∧</span><span class="var">?B</span><span class="main">∧</span><span class="main">¬</span><span class="var">?C</span>"</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="var"><span class="quoted"><span class="var">?B</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
            <span class="keyword1"><span class="command">with</span></span> lq lp qvp <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> x s <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span><span class="keyword1"><span class="command">}</span></span>
          <span class="keyword1"><span class="command">next</span></span>
          <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span><span class="var">?A</span><span class="main">∧</span><span class="main">¬</span><span class="var">?B</span><span class="main">∧</span><span class="var">?C</span>"</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="var"><span class="quoted"><span class="var">?C</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
            <span class="keyword1"><span class="command">with</span></span> lq lp pv <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> x s <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span><span class="keyword1"><span class="command">}</span></span>
        <span class="keyword1"><span class="command">qed</span></span><span class="keyword1"><span class="command">}</span></span>
      <span class="keyword1"><span class="command">next</span></span>
      <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span><span class="var">?A</span><span class="main">∧</span><span class="var">?B</span><span class="main">∧</span><span class="main">¬</span><span class="var">?C</span>"</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="var"><span class="quoted"><span class="var">?B</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
        <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">t</span></span> <span class="keyword2"><span class="keyword">where</span></span> lt<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">l</span><span class="main">∥</span><span class="skolem">t</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> tq<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">t</span><span class="main">∥</span><span class="skolem">q</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword1"><span class="command">from</span></span> pv qvp <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">p</span><span class="main">∥</span><span class="skolem">v'</span> <span class="main">⊕</span> <span class="main">(</span><span class="main">(</span><span class="main">∃</span><span class="bound">t'</span><span class="main">.</span> <span class="skolem">p</span><span class="main">∥</span><span class="bound">t'</span> <span class="main">∧</span> <span class="bound">t'</span><span class="main">∥</span><span class="skolem">v'</span><span class="main">)</span> <span class="main">⊕</span> <span class="main">(</span><span class="main">∃</span><span class="bound">t'</span><span class="main">.</span> <span class="skolem">q</span><span class="main">∥</span><span class="bound">t'</span> <span class="main">∧</span> <span class="bound">t'</span><span class="main">∥</span><span class="skolem">v</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">is</span></span> <span class="quoted"><span class="quoted">"<span class="var">?A</span> <span class="main">⊕</span> <span class="main">(</span><span class="var">?B</span> <span class="main">⊕</span> <span class="var">?C</span><span class="main">)</span>"</span></span><span class="main">)</span> <span class="keyword1"><span class="command">using</span></span> M2 <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
        <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="var">?A</span><span class="main">∧</span><span class="main">¬</span><span class="var">?B</span><span class="main">∧</span><span class="main">¬</span><span class="var">?C</span><span class="main">)</span> <span class="main">∨</span> <span class="main">(</span><span class="main">(</span><span class="main">¬</span><span class="var">?A</span><span class="main">∧</span><span class="var">?B</span><span class="main">∧</span><span class="main">¬</span><span class="var">?C</span><span class="main">)</span> <span class="main">∨</span> <span class="main">(</span><span class="main">¬</span><span class="var">?A</span><span class="main">∧</span><span class="main">¬</span><span class="var">?B</span><span class="main">∧</span><span class="var">?C</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">insert</span> xor_distr_L<span class="main"><span class="main">[</span></span><span class="operator">of</span> <span class="var"><span class="quoted"><span class="var">?A</span></span></span> <span class="var"><span class="quoted"><span class="var">?B</span></span></span> <span class="var"><span class="quoted"><span class="var">?C</span></span></span><span class="main"><span class="main">]</span></span><span class="main"><span class="keyword3">,</span></span> <span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span>elimmeets<span class="main">)</span>
        <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
        <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">elim</span> disjE<span class="main">)</span>
          <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="var">?A</span><span class="main">∧</span><span class="main">¬</span><span class="var">?B</span><span class="main">∧</span><span class="main">¬</span><span class="var">?C</span>"</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="var"><span class="quoted"><span class="var">?A</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
            <span class="keyword1"><span class="command">with</span></span> qvp lp lt tq  <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> x f  <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span><span class="keyword1"><span class="command">}</span></span>
          <span class="keyword1"><span class="command">next</span></span>
          <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span><span class="var">?A</span><span class="main">∧</span><span class="var">?B</span><span class="main">∧</span><span class="main">¬</span><span class="var">?C</span>"</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="var"><span class="quoted"><span class="var">?B</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
            <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">t'</span></span> <span class="keyword2"><span class="keyword">where</span></span> ptp<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">p</span><span class="main">∥</span><span class="skolem">t'</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> tpvp<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">t'</span><span class="main">∥</span><span class="skolem">v'</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
            <span class="keyword1"><span class="command">from</span></span> tq lpq lpcp <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">t</span><span class="main">∥</span><span class="skolem">c'</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> M1 <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
            <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command"><span class="improper">with</span></span></span> cpup zup zu <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">c'</span><span class="main">∥</span><span class="skolem">u</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> M1 <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
            <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command"><span class="improper">with</span></span></span> ptp pv uv <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">u</span><span class="main">∥</span><span class="skolem">t'</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> M1 <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
            <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">cu</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">t</span><span class="main">∥</span><span class="skolem">cu</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">cu</span><span class="main">∥</span><span class="skolem">t'</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> M5exist_var <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
            <span class="keyword1"><span class="command">with</span></span> lt tq lp ptp tpvp qvp  <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> x ov <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span><span class="keyword1"><span class="command">}</span></span>
          <span class="keyword1"><span class="command">next</span></span>
          <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span><span class="var">?A</span><span class="main">∧</span><span class="main">¬</span><span class="var">?B</span><span class="main">∧</span><span class="var">?C</span>"</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="var"><span class="quoted"><span class="var">?C</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
            <span class="keyword1"><span class="command">with</span></span> pv lp lt tq  <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> x d  <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span><span class="keyword1"><span class="command">}</span></span>

        <span class="keyword1"><span class="command">qed</span></span><span class="keyword1"><span class="command">}</span></span>
      <span class="keyword1"><span class="command">next</span></span>
      <span class="keyword1"><span class="command">{</span></span><span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span><span class="var">?A</span><span class="main">∧</span><span class="main">¬</span><span class="var">?B</span><span class="main">∧</span><span class="var">?C</span>"</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="var"><span class="quoted"><span class="var">?C</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
       <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">t</span></span> <span class="keyword2"><span class="keyword">where</span></span> lpt<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">l'</span><span class="main">∥</span><span class="skolem">t</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> tp<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">t</span><span class="main">∥</span><span class="skolem">p</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword1"><span class="command">from</span></span> pv qvp <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">p</span><span class="main">∥</span><span class="skolem">v'</span> <span class="main">⊕</span> <span class="main">(</span><span class="main">(</span><span class="main">∃</span><span class="bound">t'</span><span class="main">.</span> <span class="skolem">p</span><span class="main">∥</span><span class="bound">t'</span> <span class="main">∧</span> <span class="bound">t'</span><span class="main">∥</span><span class="skolem">v'</span><span class="main">)</span> <span class="main">⊕</span> <span class="main">(</span><span class="main">∃</span><span class="bound">t'</span><span class="main">.</span> <span class="skolem">q</span><span class="main">∥</span><span class="bound">t'</span> <span class="main">∧</span> <span class="bound">t'</span><span class="main">∥</span><span class="skolem">v</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">is</span></span> <span class="quoted"><span class="quoted">"<span class="var">?A</span> <span class="main">⊕</span> <span class="main">(</span><span class="var">?B</span> <span class="main">⊕</span> <span class="var">?C</span><span class="main">)</span>"</span></span><span class="main">)</span> <span class="keyword1"><span class="command">using</span></span> M2 <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
        <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="var">?A</span><span class="main">∧</span><span class="main">¬</span><span class="var">?B</span><span class="main">∧</span><span class="main">¬</span><span class="var">?C</span><span class="main">)</span> <span class="main">∨</span> <span class="main">(</span><span class="main">(</span><span class="main">¬</span><span class="var">?A</span><span class="main">∧</span><span class="var">?B</span><span class="main">∧</span><span class="main">¬</span><span class="var">?C</span><span class="main">)</span> <span class="main">∨</span> <span class="main">(</span><span class="main">¬</span><span class="var">?A</span><span class="main">∧</span><span class="main">¬</span><span class="var">?B</span><span class="main">∧</span><span class="var">?C</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">insert</span> xor_distr_L<span class="main"><span class="main">[</span></span><span class="operator">of</span> <span class="var"><span class="quoted"><span class="var">?A</span></span></span> <span class="var"><span class="quoted"><span class="var">?B</span></span></span> <span class="var"><span class="quoted"><span class="var">?C</span></span></span><span class="main"><span class="main">]</span></span><span class="main"><span class="keyword3">,</span></span> <span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span>elimmeets<span class="main">)</span>
        <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
        <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">elim</span> disjE<span class="main">)</span>
          <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="var">?A</span><span class="main">∧</span><span class="main">¬</span><span class="var">?B</span><span class="main">∧</span><span class="main">¬</span><span class="var">?C</span>"</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="var"><span class="quoted"><span class="var">?A</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
            <span class="keyword1"><span class="command">with</span></span> qvp lpq lpt tp <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> x f  <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span><span class="keyword1"><span class="command">}</span></span>
          <span class="keyword1"><span class="command">next</span></span>
          <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span><span class="var">?A</span><span class="main">∧</span><span class="var">?B</span><span class="main">∧</span><span class="main">¬</span><span class="var">?C</span>"</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="var"><span class="quoted"><span class="var">?B</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
            <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">t'</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">p</span><span class="main">∥</span><span class="skolem">t'</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">t'</span><span class="main">∥</span><span class="skolem">v'</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
            <span class="keyword1"><span class="command">with</span></span>  qvp lpq lpt tp <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> x d <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span><span class="keyword1"><span class="command">}</span></span>
          <span class="keyword1"><span class="command">next</span></span>
          <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span><span class="var">?A</span><span class="main">∧</span><span class="main">¬</span><span class="var">?B</span><span class="main">∧</span><span class="var">?C</span>"</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="var"><span class="quoted"><span class="var">?C</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
            <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">t'</span></span> <span class="keyword2"><span class="keyword">where</span></span> qtp<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">q</span><span class="main">∥</span><span class="skolem">t'</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> tpv<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">t'</span><span class="main">∥</span><span class="skolem">v</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
            <span class="keyword1"><span class="command">from</span></span> tp lp lc <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">t</span><span class="main">∥</span><span class="skolem">c</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> M1 <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
            <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command"><span class="improper">with</span></span></span> cu zu zup <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">c</span><span class="main">∥</span><span class="skolem">u'</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> M1 <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
            <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command"><span class="improper">with</span></span></span> qtp qvp upvp <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">u'</span><span class="main">∥</span><span class="skolem">t'</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> M1 <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
            <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">cu</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">t</span><span class="main">∥</span><span class="skolem">cu</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">cu</span><span class="main">∥</span><span class="skolem">t'</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> M5exist_var <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
            <span class="keyword1"><span class="command">with</span></span> lpt tp lpq pv qtp tpv <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> x ov <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span><span class="keyword1"><span class="command">}</span></span>
          <span class="keyword1"><span class="command">qed</span></span><span class="keyword1"><span class="command">}</span></span>
      <span class="keyword1"><span class="command">qed</span></span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="comment1">(* ===========$\delta$ composition =========*)</span>
<span class="keyword1"><span class="command">subsection</span></span> <span class="quoted"><span class="plain_text">‹$\gamma$-composition›</span></span>
<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹We prove compositions of the form $r_1 \circ r_2 \subseteq b \cup m \cup ov \cup s \cup d \cup f \cup e \cup f^{-1} \cup d^{-1} \cup s^{-1} \cup ov^{-1} \cup b^{-1} \cup m^{-1}$.›</span></span>


<span class="keyword1"><span class="command">lemma</span></span> cbbi<span class="main">:</span><span class="quoted"><span class="quoted">"b <span class="keyword1">O</span> b<span class="main">^-1</span> <span class="main">⊆</span> b <span class="main">∪</span> b<span class="main">^-1</span> <span class="main">∪</span> m <span class="main">∪</span> m<span class="main">^-1</span> <span class="main">∪</span> e <span class="main">∪</span> ov <span class="main">∪</span> ov<span class="main">^-1</span> <span class="main">∪</span> s <span class="main">∪</span> s<span class="main">^-1</span> <span class="main">∪</span> d <span class="main">∪</span> d<span class="main">^-1</span> <span class="main">∪</span> f <span class="main">∪</span> f<span class="main">^-1</span>"</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">is</span></span> <span class="quoted"><span class="quoted">"b <span class="keyword1">O</span> b<span class="main">^-1</span> <span class="main">⊆</span> <span class="var">?R</span>"</span></span><span class="main">)</span>
<span class="keyword1"><span class="command">proof</span></span>
  <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">x</span><span class="main">::</span><span class="quoted"><span class="quoted">"<span class="tfree">'a</span><span class="main">×</span><span class="tfree">'a</span>"</span></span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">∈</span> b <span class="keyword1">O</span> b<span class="main">^-1</span>"</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">p</span></span> <span class="skolem"><span class="skolem">q</span></span> <span class="skolem"><span class="skolem">z</span></span><span class="main">::</span><span class="tfree"><span class="quoted"><span class="tfree">'a</span></span></span> <span class="keyword2"><span class="keyword">where</span></span> x<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">=</span> <span class="main">(</span><span class="skolem">p</span><span class="main">,</span><span class="skolem">q</span><span class="main">)</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">p</span><span class="main">,</span><span class="skolem">z</span><span class="main">)</span> <span class="main">∈</span> b"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">z</span><span class="main">,</span><span class="skolem">q</span><span class="main">)</span> <span class="main">∈</span> b<span class="main">^-1</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="main">(</span><span class="skolem">p</span><span class="main">,</span><span class="skolem">z</span><span class="main">)</span><span class="main">∈</span>b›</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">c</span></span> <span class="keyword2"><span class="keyword">where</span></span> pc<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">p</span><span class="main">∥</span><span class="skolem">c</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">c</span><span class="main">∥</span><span class="skolem">z</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> b  <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="main">(</span><span class="skolem">z</span><span class="main">,</span><span class="skolem">q</span><span class="main">)</span> <span class="main">∈</span> b<span class="main">^-1</span>›</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">c'</span></span> <span class="keyword2"><span class="keyword">where</span></span> qcp<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">q</span><span class="main">∥</span><span class="skolem">c'</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">c'</span><span class="main">∥</span><span class="skolem">z</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> b  <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">k</span></span> <span class="skolem"><span class="skolem">k'</span></span> <span class="keyword2"><span class="keyword">where</span></span> kp<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">k</span><span class="main">∥</span><span class="skolem">p</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> kpq<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">k'</span><span class="main">∥</span><span class="skolem">q</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> M3 meets_wd pc qcp <span class="keyword1"><span class="command">by</span></span> <span class="operator">fastforce</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">k</span><span class="main">∥</span><span class="skolem">q</span> <span class="main">⊕</span> <span class="main">(</span><span class="main">(</span><span class="main">∃</span><span class="bound">t</span><span class="main">.</span> <span class="skolem">k</span><span class="main">∥</span><span class="bound">t</span> <span class="main">∧</span> <span class="bound">t</span><span class="main">∥</span><span class="skolem">q</span><span class="main">)</span> <span class="main">⊕</span> <span class="main">(</span><span class="main">∃</span><span class="bound">t</span><span class="main">.</span> <span class="skolem">k'</span><span class="main">∥</span><span class="bound">t</span> <span class="main">∧</span> <span class="bound">t</span><span class="main">∥</span><span class="skolem">p</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">is</span></span> <span class="quoted"><span class="quoted">"<span class="var">?A</span> <span class="main">⊕</span> <span class="main">(</span><span class="var">?B</span> <span class="main">⊕</span> <span class="var">?C</span><span class="main">)</span>"</span></span><span class="main">)</span> <span class="keyword1"><span class="command">using</span></span> M2 <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="var">?A</span><span class="main">∧</span><span class="main">¬</span><span class="var">?B</span><span class="main">∧</span><span class="main">¬</span><span class="var">?C</span><span class="main">)</span> <span class="main">∨</span> <span class="main">(</span><span class="main">(</span><span class="main">¬</span><span class="var">?A</span><span class="main">∧</span><span class="var">?B</span><span class="main">∧</span><span class="main">¬</span><span class="var">?C</span><span class="main">)</span> <span class="main">∨</span> <span class="main">(</span><span class="main">¬</span><span class="var">?A</span><span class="main">∧</span><span class="main">¬</span><span class="var">?B</span><span class="main">∧</span><span class="var">?C</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">insert</span> xor_distr_L<span class="main"><span class="main">[</span></span><span class="operator">of</span> <span class="var"><span class="quoted"><span class="var">?A</span></span></span> <span class="var"><span class="quoted"><span class="var">?B</span></span></span> <span class="var"><span class="quoted"><span class="var">?C</span></span></span><span class="main"><span class="main">]</span></span><span class="main"><span class="keyword3">,</span></span> <span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span>elimmeets<span class="main">)</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">∈</span><span class="var">?R</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">elim</span> disjE<span class="main">)</span>
      <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="var">?A</span><span class="main">∧</span><span class="main">¬</span><span class="var">?B</span><span class="main">∧</span><span class="main">¬</span><span class="var">?C</span>"</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> kq<span class="main">:</span><span class="var"><span class="quoted"><span class="var">?A</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
        <span class="keyword1"><span class="command">from</span></span> pc qcp <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">p</span><span class="main">∥</span><span class="skolem">c'</span> <span class="main">⊕</span> <span class="main">(</span><span class="main">(</span><span class="main">∃</span><span class="bound">t'</span><span class="main">.</span> <span class="skolem">p</span><span class="main">∥</span><span class="bound">t'</span> <span class="main">∧</span> <span class="bound">t'</span><span class="main">∥</span><span class="skolem">c'</span><span class="main">)</span> <span class="main">⊕</span> <span class="main">(</span><span class="main">∃</span><span class="bound">t'</span><span class="main">.</span> <span class="skolem">q</span><span class="main">∥</span><span class="bound">t'</span> <span class="main">∧</span> <span class="bound">t'</span><span class="main">∥</span><span class="skolem">c</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">is</span></span> <span class="quoted"><span class="quoted">"<span class="var">?A</span> <span class="main">⊕</span> <span class="main">(</span><span class="var">?B</span> <span class="main">⊕</span> <span class="var">?C</span><span class="main">)</span>"</span></span><span class="main">)</span> <span class="keyword1"><span class="command">using</span></span> M2 <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
        <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="var">?A</span><span class="main">∧</span><span class="main">¬</span><span class="var">?B</span><span class="main">∧</span><span class="main">¬</span><span class="var">?C</span><span class="main">)</span> <span class="main">∨</span> <span class="main">(</span><span class="main">(</span><span class="main">¬</span><span class="var">?A</span><span class="main">∧</span><span class="var">?B</span><span class="main">∧</span><span class="main">¬</span><span class="var">?C</span><span class="main">)</span> <span class="main">∨</span> <span class="main">(</span><span class="main">¬</span><span class="var">?A</span><span class="main">∧</span><span class="main">¬</span><span class="var">?B</span><span class="main">∧</span><span class="var">?C</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">insert</span> xor_distr_L<span class="main"><span class="main">[</span></span><span class="operator">of</span> <span class="var"><span class="quoted"><span class="var">?A</span></span></span> <span class="var"><span class="quoted"><span class="var">?B</span></span></span> <span class="var"><span class="quoted"><span class="var">?C</span></span></span><span class="main"><span class="main">]</span></span><span class="main"><span class="keyword3">,</span></span> <span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span>elimmeets<span class="main">)</span>
        <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
        <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">elim</span> disjE<span class="main">)</span>
          <span class="keyword1"><span class="command">{</span></span><span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="var">?A</span><span class="main">∧</span><span class="main">¬</span><span class="var">?B</span><span class="main">∧</span><span class="main">¬</span><span class="var">?C</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="var">?A</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
           <span class="keyword1"><span class="command">with</span></span> kp kq qcp <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">p</span> <span class="main">=</span> <span class="skolem">q</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> M4 <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
           <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> x e  <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span><span class="keyword1"><span class="command">}</span></span>
          <span class="keyword1"><span class="command">next</span></span>
          <span class="keyword1"><span class="command">{</span></span><span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span><span class="var">?A</span><span class="main">∧</span><span class="var">?B</span><span class="main">∧</span><span class="main">¬</span><span class="var">?C</span>"</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="var">?B</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
           <span class="keyword1"><span class="command">with</span></span> kq kp qcp <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> x s <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span><span class="keyword1"><span class="command">}</span></span>
          <span class="keyword1"><span class="command">next</span></span>
          <span class="keyword1"><span class="command">{</span></span><span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">¬</span><span class="var">?A</span><span class="main">∧</span><span class="main">¬</span><span class="var">?B</span><span class="main">∧</span><span class="var">?C</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="var">?C</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
           <span class="keyword1"><span class="command">with</span></span> kq kp pc <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> x s <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span><span class="keyword1"><span class="command">}</span></span>
        <span class="keyword1"><span class="command">qed</span></span><span class="keyword1"><span class="command">}</span></span>
      <span class="keyword1"><span class="command">next</span></span>
      <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span><span class="var">?A</span><span class="main">∧</span><span class="var">?B</span><span class="main">∧</span><span class="main">¬</span><span class="var">?C</span>"</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="var"><span class="quoted"><span class="var">?B</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
        <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">t</span></span> <span class="keyword2"><span class="keyword">where</span></span> kt<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">k</span><span class="main">∥</span><span class="skolem">t</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> tq<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">t</span><span class="main">∥</span><span class="skolem">q</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword1"><span class="command">from</span></span> pc qcp <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">p</span><span class="main">∥</span><span class="skolem">c'</span> <span class="main">⊕</span> <span class="main">(</span><span class="main">(</span><span class="main">∃</span><span class="bound">t'</span><span class="main">.</span> <span class="skolem">p</span><span class="main">∥</span><span class="bound">t'</span> <span class="main">∧</span> <span class="bound">t'</span><span class="main">∥</span><span class="skolem">c'</span><span class="main">)</span> <span class="main">⊕</span> <span class="main">(</span><span class="main">∃</span><span class="bound">t'</span><span class="main">.</span> <span class="skolem">q</span><span class="main">∥</span><span class="bound">t'</span> <span class="main">∧</span> <span class="bound">t'</span><span class="main">∥</span><span class="skolem">c</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">is</span></span> <span class="quoted"><span class="quoted">"<span class="var">?A</span> <span class="main">⊕</span> <span class="main">(</span><span class="var">?B</span> <span class="main">⊕</span> <span class="var">?C</span><span class="main">)</span>"</span></span><span class="main">)</span> <span class="keyword1"><span class="command">using</span></span> M2 <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
        <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="var">?A</span><span class="main">∧</span><span class="main">¬</span><span class="var">?B</span><span class="main">∧</span><span class="main">¬</span><span class="var">?C</span><span class="main">)</span> <span class="main">∨</span> <span class="main">(</span><span class="main">(</span><span class="main">¬</span><span class="var">?A</span><span class="main">∧</span><span class="var">?B</span><span class="main">∧</span><span class="main">¬</span><span class="var">?C</span><span class="main">)</span> <span class="main">∨</span> <span class="main">(</span><span class="main">¬</span><span class="var">?A</span><span class="main">∧</span><span class="main">¬</span><span class="var">?B</span><span class="main">∧</span><span class="var">?C</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">insert</span> xor_distr_L<span class="main"><span class="main">[</span></span><span class="operator">of</span> <span class="var"><span class="quoted"><span class="var">?A</span></span></span> <span class="var"><span class="quoted"><span class="var">?B</span></span></span> <span class="var"><span class="quoted"><span class="var">?C</span></span></span><span class="main"><span class="main">]</span></span><span class="main"><span class="keyword3">,</span></span> <span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span>elimmeets<span class="main">)</span>
        <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
        <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">elim</span> disjE<span class="main">)</span>
          <span class="keyword1"><span class="command">{</span></span><span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="var">?A</span><span class="main">∧</span><span class="main">¬</span><span class="var">?B</span><span class="main">∧</span><span class="main">¬</span><span class="var">?C</span>"</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="var"><span class="quoted"><span class="var">?A</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
           <span class="keyword1"><span class="command">with</span></span> kp qcp kt tq <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> f x <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span><span class="keyword1"><span class="command">}</span></span>
          <span class="keyword1"><span class="command">next</span></span>
          <span class="keyword1"><span class="command">{</span></span><span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span><span class="var">?A</span><span class="main">∧</span><span class="var">?B</span><span class="main">∧</span><span class="main">¬</span><span class="var">?C</span>"</span></span>  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="var"><span class="quoted"><span class="var">?B</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
           <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">t'</span></span> <span class="keyword2"><span class="keyword">where</span></span> ptp<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">p</span><span class="main">∥</span><span class="skolem">t'</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> tpcp<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">t'</span><span class="main">∥</span><span class="skolem">c'</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
           <span class="keyword1"><span class="command">from</span></span> pc tq  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">p</span><span class="main">∥</span><span class="skolem">q</span> <span class="main">⊕</span> <span class="main">(</span><span class="main">(</span><span class="main">∃</span><span class="bound">t''</span><span class="main">.</span> <span class="skolem">p</span><span class="main">∥</span><span class="bound">t''</span> <span class="main">∧</span> <span class="bound">t''</span><span class="main">∥</span><span class="skolem">q</span><span class="main">)</span> <span class="main">⊕</span> <span class="main">(</span><span class="main">∃</span><span class="bound">t''</span><span class="main">.</span> <span class="skolem">t</span><span class="main">∥</span><span class="bound">t''</span> <span class="main">∧</span> <span class="bound">t''</span><span class="main">∥</span><span class="skolem">c</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">is</span></span> <span class="quoted"><span class="quoted">"<span class="var">?A</span> <span class="main">⊕</span> <span class="main">(</span><span class="var">?B</span> <span class="main">⊕</span> <span class="var">?C</span><span class="main">)</span>"</span></span><span class="main">)</span> <span class="keyword1"><span class="command">using</span></span> M2 <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
           <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="var">?A</span><span class="main">∧</span><span class="main">¬</span><span class="var">?B</span><span class="main">∧</span><span class="main">¬</span><span class="var">?C</span><span class="main">)</span> <span class="main">∨</span> <span class="main">(</span><span class="main">(</span><span class="main">¬</span><span class="var">?A</span><span class="main">∧</span><span class="var">?B</span><span class="main">∧</span><span class="main">¬</span><span class="var">?C</span><span class="main">)</span> <span class="main">∨</span> <span class="main">(</span><span class="main">¬</span><span class="var">?A</span><span class="main">∧</span><span class="main">¬</span><span class="var">?B</span><span class="main">∧</span><span class="var">?C</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">insert</span> xor_distr_L<span class="main"><span class="main">[</span></span><span class="operator">of</span> <span class="var"><span class="quoted"><span class="var">?A</span></span></span> <span class="var"><span class="quoted"><span class="var">?B</span></span></span> <span class="var"><span class="quoted"><span class="var">?C</span></span></span><span class="main"><span class="main">]</span></span><span class="main"><span class="keyword3">,</span></span> <span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span>elimmeets<span class="main">)</span>
           <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
           <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">elim</span> disjE<span class="main">)</span>
              <span class="keyword1"><span class="command">{</span></span><span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="var">?A</span><span class="main">∧</span><span class="main">¬</span><span class="var">?B</span><span class="main">∧</span><span class="main">¬</span><span class="var">?C</span>"</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="var"><span class="quoted"><span class="var">?A</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
               <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> x m <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span><span class="keyword1"><span class="command">}</span></span>
              <span class="keyword1"><span class="command">next</span></span>
              <span class="keyword1"><span class="command">{</span></span><span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span><span class="var">?A</span><span class="main">∧</span><span class="var">?B</span><span class="main">∧</span><span class="main">¬</span><span class="var">?C</span>"</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="var"><span class="quoted"><span class="var">?B</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
               <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> x b <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span><span class="keyword1"><span class="command">}</span></span>
              <span class="keyword1"><span class="command">next</span></span>
              <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span><span class="var">?A</span><span class="main">∧</span><span class="main">¬</span><span class="var">?B</span><span class="main">∧</span><span class="var">?C</span>"</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="var"><span class="quoted"><span class="var">?C</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
                <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">g</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">t</span><span class="main">∥</span><span class="skolem">g</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">g</span><span class="main">∥</span><span class="skolem">c</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
                <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command"><span class="improper">with</span></span></span> pc ptp <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">g</span><span class="main">∥</span><span class="skolem">t'</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> M1 <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
                <span class="keyword1"><span class="command">ultimately</span></span>  <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> x ov kt tq kp ptp tpcp qcp   <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span><span class="keyword1"><span class="command">}</span></span>
           <span class="keyword1"><span class="command">qed</span></span><span class="keyword1"><span class="command">}</span></span>
         <span class="keyword1"><span class="command">next</span></span>
          <span class="keyword1"><span class="command">{</span></span><span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span><span class="var">?A</span><span class="main">∧</span><span class="main">¬</span><span class="var">?B</span><span class="main">∧</span><span class="var">?C</span>"</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="var"><span class="quoted"><span class="var">?C</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
           <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">t'</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">q</span><span class="main">∥</span><span class="skolem">t'</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">t'</span><span class="main">∥</span><span class="skolem">c</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
           <span class="keyword1"><span class="command">with</span></span> kp  kt tq pc <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> d x <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span><span class="keyword1"><span class="command">}</span></span>
         <span class="keyword1"><span class="command">qed</span></span><span class="keyword1"><span class="command">}</span></span>
      <span class="keyword1"><span class="command">next</span></span>
      <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span><span class="var">?A</span><span class="main">∧</span><span class="main">¬</span><span class="var">?B</span><span class="main">∧</span><span class="var">?C</span>"</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="var"><span class="quoted"><span class="var">?C</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
        <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">t</span></span> <span class="keyword2"><span class="keyword">where</span></span> kpt<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">k'</span><span class="main">∥</span><span class="skolem">t</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> tp<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">t</span><span class="main">∥</span><span class="skolem">p</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword1"><span class="command">from</span></span>  pc qcp <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">p</span><span class="main">∥</span><span class="skolem">c'</span> <span class="main">⊕</span> <span class="main">(</span><span class="main">(</span><span class="main">∃</span><span class="bound">t'</span><span class="main">.</span> <span class="skolem">p</span><span class="main">∥</span><span class="bound">t'</span> <span class="main">∧</span> <span class="bound">t'</span><span class="main">∥</span><span class="skolem">c'</span><span class="main">)</span> <span class="main">⊕</span> <span class="main">(</span><span class="main">∃</span><span class="bound">t'</span><span class="main">.</span> <span class="skolem">q</span><span class="main">∥</span><span class="bound">t'</span> <span class="main">∧</span> <span class="bound">t'</span><span class="main">∥</span><span class="skolem">c</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">is</span></span> <span class="quoted"><span class="quoted">"<span class="var">?A</span> <span class="main">⊕</span> <span class="main">(</span><span class="var">?B</span> <span class="main">⊕</span> <span class="var">?C</span><span class="main">)</span>"</span></span><span class="main">)</span> <span class="keyword1"><span class="command">using</span></span> M2 <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
        <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="var">?A</span><span class="main">∧</span><span class="main">¬</span><span class="var">?B</span><span class="main">∧</span><span class="main">¬</span><span class="var">?C</span><span class="main">)</span> <span class="main">∨</span> <span class="main">(</span><span class="main">(</span><span class="main">¬</span><span class="var">?A</span><span class="main">∧</span><span class="var">?B</span><span class="main">∧</span><span class="main">¬</span><span class="var">?C</span><span class="main">)</span> <span class="main">∨</span> <span class="main">(</span><span class="main">¬</span><span class="var">?A</span><span class="main">∧</span><span class="main">¬</span><span class="var">?B</span><span class="main">∧</span><span class="var">?C</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">insert</span> xor_distr_L<span class="main"><span class="main">[</span></span><span class="operator">of</span> <span class="var"><span class="quoted"><span class="var">?A</span></span></span> <span class="var"><span class="quoted"><span class="var">?B</span></span></span> <span class="var"><span class="quoted"><span class="var">?C</span></span></span><span class="main"><span class="main">]</span></span><span class="main"><span class="keyword3">,</span></span> <span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span>elimmeets<span class="main">)</span>
        <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
        <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">elim</span> disjE<span class="main">)</span>
          <span class="keyword1"><span class="command">{</span></span><span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="var">?A</span><span class="main">∧</span><span class="main">¬</span><span class="var">?B</span><span class="main">∧</span><span class="main">¬</span><span class="var">?C</span>"</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="var"><span class="quoted"><span class="var">?A</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
           <span class="keyword1"><span class="command">with</span></span> qcp kpt tp kpq <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> x f <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span><span class="keyword1"><span class="command">}</span></span>
          <span class="keyword1"><span class="command">next</span></span>
          <span class="keyword1"><span class="command">{</span></span><span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span><span class="var">?A</span><span class="main">∧</span><span class="var">?B</span><span class="main">∧</span><span class="main">¬</span><span class="var">?C</span>"</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="var"><span class="quoted"><span class="var">?B</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
           <span class="keyword1"><span class="command">with</span></span> qcp kpt tp kpq <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> x d <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span><span class="keyword1"><span class="command">}</span></span>
          <span class="keyword1"><span class="command">next</span></span>
          <span class="keyword1"><span class="command">{</span></span><span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span><span class="var">?A</span><span class="main">∧</span><span class="main">¬</span><span class="var">?B</span><span class="main">∧</span><span class="var">?C</span>"</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">t'</span></span> <span class="keyword2"><span class="keyword">where</span></span> qt'<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">q</span><span class="main">∥</span><span class="skolem">t'</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> tpc<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">t'</span><span class="main">∥</span><span class="skolem">c</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
           <span class="keyword1"><span class="command">from</span></span> qcp tp <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">q</span><span class="main">∥</span><span class="skolem">p</span> <span class="main">⊕</span> <span class="main">(</span><span class="main">(</span><span class="main">∃</span><span class="bound">t''</span><span class="main">.</span> <span class="skolem">q</span><span class="main">∥</span><span class="bound">t''</span> <span class="main">∧</span> <span class="bound">t''</span><span class="main">∥</span><span class="skolem">p</span><span class="main">)</span> <span class="main">⊕</span> <span class="main">(</span><span class="main">∃</span><span class="bound">t''</span><span class="main">.</span> <span class="skolem">t</span><span class="main">∥</span><span class="bound">t''</span> <span class="main">∧</span> <span class="bound">t''</span><span class="main">∥</span><span class="skolem">c'</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">is</span></span> <span class="quoted"><span class="quoted">"<span class="var">?A</span> <span class="main">⊕</span> <span class="main">(</span><span class="var">?B</span> <span class="main">⊕</span> <span class="var">?C</span><span class="main">)</span>"</span></span><span class="main">)</span> <span class="keyword1"><span class="command">using</span></span> M2 <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
           <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="var">?A</span><span class="main">∧</span><span class="main">¬</span><span class="var">?B</span><span class="main">∧</span><span class="main">¬</span><span class="var">?C</span><span class="main">)</span> <span class="main">∨</span> <span class="main">(</span><span class="main">(</span><span class="main">¬</span><span class="var">?A</span><span class="main">∧</span><span class="var">?B</span><span class="main">∧</span><span class="main">¬</span><span class="var">?C</span><span class="main">)</span> <span class="main">∨</span> <span class="main">(</span><span class="main">¬</span><span class="var">?A</span><span class="main">∧</span><span class="main">¬</span><span class="var">?B</span><span class="main">∧</span><span class="var">?C</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">insert</span> xor_distr_L<span class="main"><span class="main">[</span></span><span class="operator">of</span> <span class="var"><span class="quoted"><span class="var">?A</span></span></span> <span class="var"><span class="quoted"><span class="var">?B</span></span></span> <span class="var"><span class="quoted"><span class="var">?C</span></span></span><span class="main"><span class="main">]</span></span><span class="main"><span class="keyword3">,</span></span> <span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span>elimmeets<span class="main">)</span>
           <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
           <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">elim</span> disjE<span class="main">)</span>
              <span class="keyword1"><span class="command">{</span></span><span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="var">?A</span><span class="main">∧</span><span class="main">¬</span><span class="var">?B</span><span class="main">∧</span><span class="main">¬</span><span class="var">?C</span>"</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="var"><span class="quoted"><span class="var">?A</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
               <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> x m <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span><span class="keyword1"><span class="command">}</span></span>
              <span class="keyword1"><span class="command">next</span></span>
              <span class="keyword1"><span class="command">{</span></span><span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span><span class="var">?A</span><span class="main">∧</span><span class="var">?B</span><span class="main">∧</span><span class="main">¬</span><span class="var">?C</span>"</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="var"><span class="quoted"><span class="var">?B</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
               <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> x b <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span><span class="keyword1"><span class="command">}</span></span>
              <span class="keyword1"><span class="command">next</span></span>
              <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span><span class="var">?A</span><span class="main">∧</span><span class="main">¬</span><span class="var">?B</span><span class="main">∧</span><span class="var">?C</span>"</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">g</span></span> <span class="keyword2"><span class="keyword">where</span></span> tg<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">t</span><span class="main">∥</span><span class="skolem">g</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">g</span><span class="main">∥</span><span class="skolem">c'</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
                <span class="keyword1"><span class="command">with</span></span> qcp qt' <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">g</span><span class="main">∥</span><span class="skolem">t'</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> M1 <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
                <span class="keyword1"><span class="command">with</span></span> qt' tpc pc kpq kpt tp tg <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> x ov <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span><span class="keyword1"><span class="command">}</span></span>
          <span class="keyword1"><span class="command">qed</span></span><span class="keyword1"><span class="command">}</span></span>
     <span class="keyword1"><span class="command">qed</span></span><span class="keyword1"><span class="command">}</span></span>
 <span class="keyword1"><span class="command">qed</span></span>
<span class="keyword1"><span class="command">qed</span></span>
       


<span class="keyword1"><span class="command">lemma</span></span> cbib<span class="main">:</span><span class="quoted"><span class="quoted">"b<span class="main">^-1</span> <span class="keyword1">O</span> b <span class="main">⊆</span> b <span class="main">∪</span> b<span class="main">^-1</span> <span class="main">∪</span> m <span class="main">∪</span> m<span class="main">^-1</span> <span class="main">∪</span> e <span class="main">∪</span> ov <span class="main">∪</span> ov<span class="main">^-1</span> <span class="main">∪</span> s <span class="main">∪</span> s<span class="main">^-1</span> <span class="main">∪</span> d <span class="main">∪</span> d<span class="main">^-1</span> <span class="main">∪</span> f <span class="main">∪</span> f<span class="main">^-1</span>"</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">is</span></span> <span class="quoted"><span class="quoted">"b<span class="main">^-1</span> <span class="keyword1">O</span> b <span class="main">⊆</span> <span class="var">?R</span>"</span></span><span class="main">)</span>
<span class="keyword1"><span class="command">proof</span></span>
  <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">x</span><span class="main">::</span><span class="quoted"><span class="quoted">"<span class="tfree">'a</span><span class="main">×</span><span class="tfree">'a</span>"</span></span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">∈</span> b<span class="main">^-1</span> <span class="keyword1">O</span> b"</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">p</span></span> <span class="skolem"><span class="skolem">q</span></span> <span class="skolem"><span class="skolem">z</span></span><span class="main">::</span><span class="tfree"><span class="quoted"><span class="tfree">'a</span></span></span> <span class="keyword2"><span class="keyword">where</span></span> x<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">=</span> <span class="main">(</span><span class="skolem">p</span><span class="main">,</span><span class="skolem">q</span><span class="main">)</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">p</span><span class="main">,</span><span class="skolem">z</span><span class="main">)</span> <span class="main">∈</span> b<span class="main">^-1</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">z</span><span class="main">,</span><span class="skolem">q</span><span class="main">)</span> <span class="main">∈</span> b"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="main">(</span><span class="skolem">p</span><span class="main">,</span><span class="skolem">z</span><span class="main">)</span><span class="main">∈</span>b<span class="main">^-1</span>›</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">c</span></span> <span class="keyword2"><span class="keyword">where</span></span> zc<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">z</span><span class="main">∥</span><span class="skolem">c</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> cp<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">c</span><span class="main">∥</span><span class="skolem">p</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> b  <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="main">(</span><span class="skolem">z</span><span class="main">,</span><span class="skolem">q</span><span class="main">)</span> <span class="main">∈</span> b›</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">c'</span></span> <span class="keyword2"><span class="keyword">where</span></span> zcp<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">z</span><span class="main">∥</span><span class="skolem">c'</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> cpq<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">c'</span><span class="main">∥</span><span class="skolem">q</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> b  <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">u</span></span> <span class="skolem"><span class="skolem">u'</span></span> <span class="keyword2"><span class="keyword">where</span></span> pu<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">p</span><span class="main">∥</span><span class="skolem">u</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> qup<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">q</span><span class="main">∥</span><span class="skolem">u'</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> M3 meets_wd cp cpq <span class="keyword1"><span class="command">by</span></span> <span class="operator">fastforce</span>
  <span class="keyword1"><span class="command">from</span></span> cp cpq <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">c</span><span class="main">∥</span><span class="skolem">q</span> <span class="main">⊕</span> <span class="main">(</span><span class="main">(</span><span class="main">∃</span><span class="bound">t</span><span class="main">.</span> <span class="skolem">c</span><span class="main">∥</span><span class="bound">t</span> <span class="main">∧</span> <span class="bound">t</span><span class="main">∥</span><span class="skolem">q</span><span class="main">)</span> <span class="main">⊕</span> <span class="main">(</span><span class="main">∃</span><span class="bound">t</span><span class="main">.</span> <span class="skolem">c'</span><span class="main">∥</span><span class="bound">t</span> <span class="main">∧</span> <span class="bound">t</span><span class="main">∥</span><span class="skolem">p</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">is</span></span> <span class="quoted"><span class="quoted">"<span class="var">?A</span> <span class="main">⊕</span> <span class="main">(</span><span class="var">?B</span> <span class="main">⊕</span> <span class="var">?C</span><span class="main">)</span>"</span></span><span class="main">)</span> <span class="keyword1"><span class="command">using</span></span> M2 <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="var">?A</span><span class="main">∧</span><span class="main">¬</span><span class="var">?B</span><span class="main">∧</span><span class="main">¬</span><span class="var">?C</span><span class="main">)</span> <span class="main">∨</span> <span class="main">(</span><span class="main">(</span><span class="main">¬</span><span class="var">?A</span><span class="main">∧</span><span class="var">?B</span><span class="main">∧</span><span class="main">¬</span><span class="var">?C</span><span class="main">)</span> <span class="main">∨</span> <span class="main">(</span><span class="main">¬</span><span class="var">?A</span><span class="main">∧</span><span class="main">¬</span><span class="var">?B</span><span class="main">∧</span><span class="var">?C</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">insert</span> xor_distr_L<span class="main"><span class="main">[</span></span><span class="operator">of</span> <span class="var"><span class="quoted"><span class="var">?A</span></span></span> <span class="var"><span class="quoted"><span class="var">?B</span></span></span> <span class="var"><span class="quoted"><span class="var">?C</span></span></span><span class="main"><span class="main">]</span></span><span class="main"><span class="keyword3">,</span></span> <span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span>elimmeets<span class="main">)</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">∈</span><span class="var">?R</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">elim</span> disjE<span class="main">)</span>
      <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="var">?A</span><span class="main">∧</span><span class="main">¬</span><span class="var">?B</span><span class="main">∧</span><span class="main">¬</span><span class="var">?C</span>"</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> cq<span class="main">:</span><span class="var"><span class="quoted"><span class="var">?A</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
        <span class="keyword1"><span class="command">from</span></span> pu qup <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">p</span><span class="main">∥</span><span class="skolem">u'</span> <span class="main">⊕</span> <span class="main">(</span><span class="main">(</span><span class="main">∃</span><span class="bound">t'</span><span class="main">.</span> <span class="skolem">p</span><span class="main">∥</span><span class="bound">t'</span> <span class="main">∧</span> <span class="bound">t'</span><span class="main">∥</span><span class="skolem">u'</span><span class="main">)</span> <span class="main">⊕</span> <span class="main">(</span><span class="main">∃</span><span class="bound">t'</span><span class="main">.</span> <span class="skolem">q</span><span class="main">∥</span><span class="bound">t'</span> <span class="main">∧</span> <span class="bound">t'</span><span class="main">∥</span><span class="skolem">u</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">is</span></span> <span class="quoted"><span class="quoted">"<span class="var">?A</span> <span class="main">⊕</span> <span class="main">(</span><span class="var">?B</span> <span class="main">⊕</span> <span class="var">?C</span><span class="main">)</span>"</span></span><span class="main">)</span> <span class="keyword1"><span class="command">using</span></span> M2 <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
        <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="var">?A</span><span class="main">∧</span><span class="main">¬</span><span class="var">?B</span><span class="main">∧</span><span class="main">¬</span><span class="var">?C</span><span class="main">)</span> <span class="main">∨</span> <span class="main">(</span><span class="main">(</span><span class="main">¬</span><span class="var">?A</span><span class="main">∧</span><span class="var">?B</span><span class="main">∧</span><span class="main">¬</span><span class="var">?C</span><span class="main">)</span> <span class="main">∨</span> <span class="main">(</span><span class="main">¬</span><span class="var">?A</span><span class="main">∧</span><span class="main">¬</span><span class="var">?B</span><span class="main">∧</span><span class="var">?C</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">insert</span> xor_distr_L<span class="main"><span class="main">[</span></span><span class="operator">of</span> <span class="var"><span class="quoted"><span class="var">?A</span></span></span> <span class="var"><span class="quoted"><span class="var">?B</span></span></span> <span class="var"><span class="quoted"><span class="var">?C</span></span></span><span class="main"><span class="main">]</span></span><span class="main"><span class="keyword3">,</span></span> <span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span>elimmeets<span class="main">)</span>
        <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
        <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">elim</span> disjE<span class="main">)</span>
          <span class="keyword1"><span class="command">{</span></span><span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="var">?A</span><span class="main">∧</span><span class="main">¬</span><span class="var">?B</span><span class="main">∧</span><span class="main">¬</span><span class="var">?C</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="var">?A</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
           <span class="keyword1"><span class="command">with</span></span> cq cp qup <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">p</span> <span class="main">=</span> <span class="skolem">q</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> M4 <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
           <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> x e  <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span><span class="keyword1"><span class="command">}</span></span>
          <span class="keyword1"><span class="command">next</span></span>
          <span class="keyword1"><span class="command">{</span></span><span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span><span class="var">?A</span><span class="main">∧</span><span class="var">?B</span><span class="main">∧</span><span class="main">¬</span><span class="var">?C</span>"</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="var">?B</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
           <span class="keyword1"><span class="command">with</span></span> cq cp qup <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> x s <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span><span class="keyword1"><span class="command">}</span></span>
          <span class="keyword1"><span class="command">next</span></span>
          <span class="keyword1"><span class="command">{</span></span><span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">¬</span><span class="var">?A</span><span class="main">∧</span><span class="main">¬</span><span class="var">?B</span><span class="main">∧</span><span class="var">?C</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="var">?C</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
           <span class="keyword1"><span class="command">with</span></span> pu cq cp <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> x s <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span><span class="keyword1"><span class="command">}</span></span>
        <span class="keyword1"><span class="command">qed</span></span><span class="keyword1"><span class="command">}</span></span>
      <span class="keyword1"><span class="command">next</span></span>
      <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span><span class="var">?A</span><span class="main">∧</span><span class="var">?B</span><span class="main">∧</span><span class="main">¬</span><span class="var">?C</span>"</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="var"><span class="quoted"><span class="var">?B</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
        <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">t</span></span> <span class="keyword2"><span class="keyword">where</span></span> ct<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">c</span><span class="main">∥</span><span class="skolem">t</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> tq<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">t</span><span class="main">∥</span><span class="skolem">q</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword1"><span class="command">from</span></span> pu qup <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">p</span><span class="main">∥</span><span class="skolem">u'</span> <span class="main">⊕</span> <span class="main">(</span><span class="main">(</span><span class="main">∃</span><span class="bound">t'</span><span class="main">.</span> <span class="skolem">p</span><span class="main">∥</span><span class="bound">t'</span> <span class="main">∧</span> <span class="bound">t'</span><span class="main">∥</span><span class="skolem">u'</span><span class="main">)</span> <span class="main">⊕</span> <span class="main">(</span><span class="main">∃</span><span class="bound">t'</span><span class="main">.</span> <span class="skolem">q</span><span class="main">∥</span><span class="bound">t'</span> <span class="main">∧</span> <span class="bound">t'</span><span class="main">∥</span><span class="skolem">u</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">is</span></span> <span class="quoted"><span class="quoted">"<span class="var">?A</span> <span class="main">⊕</span> <span class="main">(</span><span class="var">?B</span> <span class="main">⊕</span> <span class="var">?C</span><span class="main">)</span>"</span></span><span class="main">)</span> <span class="keyword1"><span class="command">using</span></span> M2 <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
        <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="var">?A</span><span class="main">∧</span><span class="main">¬</span><span class="var">?B</span><span class="main">∧</span><span class="main">¬</span><span class="var">?C</span><span class="main">)</span> <span class="main">∨</span> <span class="main">(</span><span class="main">(</span><span class="main">¬</span><span class="var">?A</span><span class="main">∧</span><span class="var">?B</span><span class="main">∧</span><span class="main">¬</span><span class="var">?C</span><span class="main">)</span> <span class="main">∨</span> <span class="main">(</span><span class="main">¬</span><span class="var">?A</span><span class="main">∧</span><span class="main">¬</span><span class="var">?B</span><span class="main">∧</span><span class="var">?C</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">insert</span> xor_distr_L<span class="main"><span class="main">[</span></span><span class="operator">of</span> <span class="var"><span class="quoted"><span class="var">?A</span></span></span> <span class="var"><span class="quoted"><span class="var">?B</span></span></span> <span class="var"><span class="quoted"><span class="var">?C</span></span></span><span class="main"><span class="main">]</span></span><span class="main"><span class="keyword3">,</span></span> <span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span>elimmeets<span class="main">)</span>
        <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
        <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">elim</span> disjE<span class="main">)</span>
          <span class="keyword1"><span class="command">{</span></span><span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="var">?A</span><span class="main">∧</span><span class="main">¬</span><span class="var">?B</span><span class="main">∧</span><span class="main">¬</span><span class="var">?C</span>"</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="var"><span class="quoted"><span class="var">?A</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
           <span class="keyword1"><span class="command">with</span></span> qup ct tq cp <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> f x <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span><span class="keyword1"><span class="command">}</span></span>
          <span class="keyword1"><span class="command">next</span></span>
          <span class="keyword1"><span class="command">{</span></span><span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span><span class="var">?A</span><span class="main">∧</span><span class="var">?B</span><span class="main">∧</span><span class="main">¬</span><span class="var">?C</span>"</span></span>  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="var"><span class="quoted"><span class="var">?B</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
           <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">t'</span></span> <span class="keyword2"><span class="keyword">where</span></span> ptp<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">p</span><span class="main">∥</span><span class="skolem">t'</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> tpup<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">t'</span><span class="main">∥</span><span class="skolem">u'</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
           <span class="keyword1"><span class="command">from</span></span> pu tq  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">p</span><span class="main">∥</span><span class="skolem">q</span> <span class="main">⊕</span> <span class="main">(</span><span class="main">(</span><span class="main">∃</span><span class="bound">t''</span><span class="main">.</span> <span class="skolem">p</span><span class="main">∥</span><span class="bound">t''</span> <span class="main">∧</span> <span class="bound">t''</span><span class="main">∥</span><span class="skolem">q</span><span class="main">)</span> <span class="main">⊕</span> <span class="main">(</span><span class="main">∃</span><span class="bound">t''</span><span class="main">.</span> <span class="skolem">t</span><span class="main">∥</span><span class="bound">t''</span> <span class="main">∧</span> <span class="bound">t''</span><span class="main">∥</span><span class="skolem">u</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">is</span></span> <span class="quoted"><span class="quoted">"<span class="var">?A</span> <span class="main">⊕</span> <span class="main">(</span><span class="var">?B</span> <span class="main">⊕</span> <span class="var">?C</span><span class="main">)</span>"</span></span><span class="main">)</span> <span class="keyword1"><span class="command">using</span></span> M2 <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
           <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="var">?A</span><span class="main">∧</span><span class="main">¬</span><span class="var">?B</span><span class="main">∧</span><span class="main">¬</span><span class="var">?C</span><span class="main">)</span> <span class="main">∨</span> <span class="main">(</span><span class="main">(</span><span class="main">¬</span><span class="var">?A</span><span class="main">∧</span><span class="var">?B</span><span class="main">∧</span><span class="main">¬</span><span class="var">?C</span><span class="main">)</span> <span class="main">∨</span> <span class="main">(</span><span class="main">¬</span><span class="var">?A</span><span class="main">∧</span><span class="main">¬</span><span class="var">?B</span><span class="main">∧</span><span class="var">?C</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">insert</span> xor_distr_L<span class="main"><span class="main">[</span></span><span class="operator">of</span> <span class="var"><span class="quoted"><span class="var">?A</span></span></span> <span class="var"><span class="quoted"><span class="var">?B</span></span></span> <span class="var"><span class="quoted"><span class="var">?C</span></span></span><span class="main"><span class="main">]</span></span><span class="main"><span class="keyword3">,</span></span> <span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span>elimmeets<span class="main">)</span>
           <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
           <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">elim</span> disjE<span class="main">)</span>
              <span class="keyword1"><span class="command">{</span></span><span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="var">?A</span><span class="main">∧</span><span class="main">¬</span><span class="var">?B</span><span class="main">∧</span><span class="main">¬</span><span class="var">?C</span>"</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="var"><span class="quoted"><span class="var">?A</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
               <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> x m <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span><span class="keyword1"><span class="command">}</span></span>
              <span class="keyword1"><span class="command">next</span></span>
              <span class="keyword1"><span class="command">{</span></span><span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span><span class="var">?A</span><span class="main">∧</span><span class="var">?B</span><span class="main">∧</span><span class="main">¬</span><span class="var">?C</span>"</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="var"><span class="quoted"><span class="var">?B</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
               <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> x b <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span><span class="keyword1"><span class="command">}</span></span>
              <span class="keyword1"><span class="command">next</span></span>
              <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span><span class="var">?A</span><span class="main">∧</span><span class="main">¬</span><span class="var">?B</span><span class="main">∧</span><span class="var">?C</span>"</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="var"><span class="quoted"><span class="var">?C</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
                <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">g</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">t</span><span class="main">∥</span><span class="skolem">g</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">g</span><span class="main">∥</span><span class="skolem">u</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
                <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command"><span class="improper">with</span></span></span> pu ptp <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">g</span><span class="main">∥</span><span class="skolem">t'</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> M1 <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
                <span class="keyword1"><span class="command">ultimately</span></span>  <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> x ov ct tq cp ptp tpup qup   <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span><span class="keyword1"><span class="command">}</span></span>
           <span class="keyword1"><span class="command">qed</span></span><span class="keyword1"><span class="command">}</span></span>
         <span class="keyword1"><span class="command">next</span></span>
          <span class="keyword1"><span class="command">{</span></span><span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span><span class="var">?A</span><span class="main">∧</span><span class="main">¬</span><span class="var">?B</span><span class="main">∧</span><span class="var">?C</span>"</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="var"><span class="quoted"><span class="var">?C</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
           <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">t'</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">q</span><span class="main">∥</span><span class="skolem">t'</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">t'</span><span class="main">∥</span><span class="skolem">u</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
           <span class="keyword1"><span class="command">with</span></span> cp  ct tq pu  <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> d x <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span><span class="keyword1"><span class="command">}</span></span>
         <span class="keyword1"><span class="command">qed</span></span><span class="keyword1"><span class="command">}</span></span>
      <span class="keyword1"><span class="command">next</span></span>
      <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span><span class="var">?A</span><span class="main">∧</span><span class="main">¬</span><span class="var">?B</span><span class="main">∧</span><span class="var">?C</span>"</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="var"><span class="quoted"><span class="var">?C</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
        <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">t</span></span> <span class="keyword2"><span class="keyword">where</span></span> cpt<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">c'</span><span class="main">∥</span><span class="skolem">t</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> tp<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">t</span><span class="main">∥</span><span class="skolem">p</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword1"><span class="command">from</span></span>  pu qup <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">p</span><span class="main">∥</span><span class="skolem">u'</span> <span class="main">⊕</span> <span class="main">(</span><span class="main">(</span><span class="main">∃</span><span class="bound">t'</span><span class="main">.</span> <span class="skolem">p</span><span class="main">∥</span><span class="bound">t'</span> <span class="main">∧</span> <span class="bound">t'</span><span class="main">∥</span><span class="skolem">u'</span><span class="main">)</span> <span class="main">⊕</span> <span class="main">(</span><span class="main">∃</span><span class="bound">t'</span><span class="main">.</span> <span class="skolem">q</span><span class="main">∥</span><span class="bound">t'</span> <span class="main">∧</span> <span class="bound">t'</span><span class="main">∥</span><span class="skolem">u</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">is</span></span> <span class="quoted"><span class="quoted">"<span class="var">?A</span> <span class="main">⊕</span> <span class="main">(</span><span class="var">?B</span> <span class="main">⊕</span> <span class="var">?C</span><span class="main">)</span>"</span></span><span class="main">)</span> <span class="keyword1"><span class="command">using</span></span> M2 <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
        <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="var">?A</span><span class="main">∧</span><span class="main">¬</span><span class="var">?B</span><span class="main">∧</span><span class="main">¬</span><span class="var">?C</span><span class="main">)</span> <span class="main">∨</span> <span class="main">(</span><span class="main">(</span><span class="main">¬</span><span class="var">?A</span><span class="main">∧</span><span class="var">?B</span><span class="main">∧</span><span class="main">¬</span><span class="var">?C</span><span class="main">)</span> <span class="main">∨</span> <span class="main">(</span><span class="main">¬</span><span class="var">?A</span><span class="main">∧</span><span class="main">¬</span><span class="var">?B</span><span class="main">∧</span><span class="var">?C</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">insert</span> xor_distr_L<span class="main"><span class="main">[</span></span><span class="operator">of</span> <span class="var"><span class="quoted"><span class="var">?A</span></span></span> <span class="var"><span class="quoted"><span class="var">?B</span></span></span> <span class="var"><span class="quoted"><span class="var">?C</span></span></span><span class="main"><span class="main">]</span></span><span class="main"><span class="keyword3">,</span></span> <span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span>elimmeets<span class="main">)</span>
        <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
        <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">elim</span> disjE<span class="main">)</span>
          <span class="keyword1"><span class="command">{</span></span><span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="var">?A</span><span class="main">∧</span><span class="main">¬</span><span class="var">?B</span><span class="main">∧</span><span class="main">¬</span><span class="var">?C</span>"</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="var"><span class="quoted"><span class="var">?A</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
           <span class="keyword1"><span class="command">with</span></span> qup cpt tp cpq <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> x f <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span><span class="keyword1"><span class="command">}</span></span>
          <span class="keyword1"><span class="command">next</span></span>
          <span class="keyword1"><span class="command">{</span></span><span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span><span class="var">?A</span><span class="main">∧</span><span class="var">?B</span><span class="main">∧</span><span class="main">¬</span><span class="var">?C</span>"</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="var"><span class="quoted"><span class="var">?B</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
           <span class="keyword1"><span class="command">with</span></span> qup cpt tp cpq <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> x d <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span><span class="keyword1"><span class="command">}</span></span>
          <span class="keyword1"><span class="command">next</span></span>
          <span class="keyword1"><span class="command">{</span></span><span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span><span class="var">?A</span><span class="main">∧</span><span class="main">¬</span><span class="var">?B</span><span class="main">∧</span><span class="var">?C</span>"</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">t'</span></span> <span class="keyword2"><span class="keyword">where</span></span> qt'<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">q</span><span class="main">∥</span><span class="skolem">t'</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> tpc<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">t'</span><span class="main">∥</span><span class="skolem">u</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
           <span class="keyword1"><span class="command">from</span></span> qup tp <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">q</span><span class="main">∥</span><span class="skolem">p</span> <span class="main">⊕</span> <span class="main">(</span><span class="main">(</span><span class="main">∃</span><span class="bound">t''</span><span class="main">.</span> <span class="skolem">q</span><span class="main">∥</span><span class="bound">t''</span> <span class="main">∧</span> <span class="bound">t''</span><span class="main">∥</span><span class="skolem">p</span><span class="main">)</span> <span class="main">⊕</span> <span class="main">(</span><span class="main">∃</span><span class="bound">t''</span><span class="main">.</span> <span class="skolem">t</span><span class="main">∥</span><span class="bound">t''</span> <span class="main">∧</span> <span class="bound">t''</span><span class="main">∥</span><span class="skolem">u'</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">is</span></span> <span class="quoted"><span class="quoted">"<span class="var">?A</span> <span class="main">⊕</span> <span class="main">(</span><span class="var">?B</span> <span class="main">⊕</span> <span class="var">?C</span><span class="main">)</span>"</span></span><span class="main">)</span> <span class="keyword1"><span class="command">using</span></span> M2 <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
           <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="var">?A</span><span class="main">∧</span><span class="main">¬</span><span class="var">?B</span><span class="main">∧</span><span class="main">¬</span><span class="var">?C</span><span class="main">)</span> <span class="main">∨</span> <span class="main">(</span><span class="main">(</span><span class="main">¬</span><span class="var">?A</span><span class="main">∧</span><span class="var">?B</span><span class="main">∧</span><span class="main">¬</span><span class="var">?C</span><span class="main">)</span> <span class="main">∨</span> <span class="main">(</span><span class="main">¬</span><span class="var">?A</span><span class="main">∧</span><span class="main">¬</span><span class="var">?B</span><span class="main">∧</span><span class="var">?C</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">insert</span> xor_distr_L<span class="main"><span class="main">[</span></span><span class="operator">of</span> <span class="var"><span class="quoted"><span class="var">?A</span></span></span> <span class="var"><span class="quoted"><span class="var">?B</span></span></span> <span class="var"><span class="quoted"><span class="var">?C</span></span></span><span class="main"><span class="main">]</span></span><span class="main"><span class="keyword3">,</span></span> <span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span>elimmeets<span class="main">)</span>
           <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
           <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">elim</span> disjE<span class="main">)</span>
              <span class="keyword1"><span class="command">{</span></span><span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="var">?A</span><span class="main">∧</span><span class="main">¬</span><span class="var">?B</span><span class="main">∧</span><span class="main">¬</span><span class="var">?C</span>"</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="var"><span class="quoted"><span class="var">?A</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
               <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> x m <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span><span class="keyword1"><span class="command">}</span></span>
              <span class="keyword1"><span class="command">next</span></span>
              <span class="keyword1"><span class="command">{</span></span><span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span><span class="var">?A</span><span class="main">∧</span><span class="var">?B</span><span class="main">∧</span><span class="main">¬</span><span class="var">?C</span>"</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="var"><span class="quoted"><span class="var">?B</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
               <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> x b <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span><span class="keyword1"><span class="command">}</span></span>
              <span class="keyword1"><span class="command">next</span></span>
              <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span><span class="var">?A</span><span class="main">∧</span><span class="main">¬</span><span class="var">?B</span><span class="main">∧</span><span class="var">?C</span>"</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">g</span></span> <span class="keyword2"><span class="keyword">where</span></span> tg<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">t</span><span class="main">∥</span><span class="skolem">g</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">g</span><span class="main">∥</span><span class="skolem">u'</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
                <span class="keyword1"><span class="command">with</span></span> qup qt' <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">g</span><span class="main">∥</span><span class="skolem">t'</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> M1 <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
                <span class="keyword1"><span class="command">with</span></span> qt' tpc pu cpq cpt tp tg <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> x ov <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span><span class="keyword1"><span class="command">}</span></span>
          <span class="keyword1"><span class="command">qed</span></span><span class="keyword1"><span class="command">}</span></span>
     <span class="keyword1"><span class="command">qed</span></span><span class="keyword1"><span class="command">}</span></span>
 <span class="keyword1"><span class="command">qed</span></span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">lemma</span></span> cddi<span class="main">:</span><span class="quoted"><span class="quoted">"d <span class="keyword1">O</span> d<span class="main">^-1</span> <span class="main">⊆</span> b <span class="main">∪</span> b<span class="main">^-1</span> <span class="main">∪</span> m <span class="main">∪</span> m<span class="main">^-1</span> <span class="main">∪</span> e <span class="main">∪</span> ov <span class="main">∪</span> ov<span class="main">^-1</span> <span class="main">∪</span> s <span class="main">∪</span> s<span class="main">^-1</span> <span class="main">∪</span> d <span class="main">∪</span> d<span class="main">^-1</span> <span class="main">∪</span> f <span class="main">∪</span> f<span class="main">^-1</span>"</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">is</span></span> <span class="quoted"><span class="quoted">"d <span class="keyword1">O</span> d<span class="main">^-1</span> <span class="main">⊆</span> <span class="var">?R</span>"</span></span><span class="main">)</span>
<span class="keyword1"><span class="command">proof</span></span>
  <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">x</span><span class="main">::</span><span class="quoted"><span class="quoted">"<span class="tfree">'a</span><span class="main">×</span><span class="tfree">'a</span>"</span></span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">∈</span> d <span class="keyword1">O</span> d<span class="main">^-1</span>"</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">p</span></span> <span class="skolem"><span class="skolem">q</span></span> <span class="skolem"><span class="skolem">z</span></span><span class="main">::</span><span class="tfree"><span class="quoted"><span class="tfree">'a</span></span></span> <span class="keyword2"><span class="keyword">where</span></span> x<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">=</span> <span class="main">(</span><span class="skolem">p</span><span class="main">,</span><span class="skolem">q</span><span class="main">)</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">p</span><span class="main">,</span><span class="skolem">z</span><span class="main">)</span> <span class="main">∈</span> d"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">z</span><span class="main">,</span><span class="skolem">q</span><span class="main">)</span> <span class="main">∈</span> d<span class="main">^-1</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="main">(</span><span class="skolem">p</span><span class="main">,</span><span class="skolem">z</span><span class="main">)</span> <span class="main">∈</span> d›</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">k</span></span> <span class="skolem"><span class="skolem">l</span></span> <span class="skolem"><span class="skolem">u</span></span> <span class="skolem"><span class="skolem">v</span></span> <span class="keyword2"><span class="keyword">where</span></span> lp<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">l</span><span class="main">∥</span><span class="skolem">p</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> kl<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">k</span><span class="main">∥</span><span class="skolem">l</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> kz<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">k</span><span class="main">∥</span><span class="skolem">z</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> pu<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">p</span><span class="main">∥</span><span class="skolem">u</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> uv<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">u</span><span class="main">∥</span><span class="skolem">v</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> zv<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">z</span><span class="main">∥</span><span class="skolem">v</span>"</span></span>  <span class="keyword1"><span class="command">using</span></span> d  <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="main">(</span><span class="skolem">z</span><span class="main">,</span><span class="skolem">q</span><span class="main">)</span> <span class="main">∈</span> d<span class="main">^-1</span>›</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">k'</span></span> <span class="skolem"><span class="skolem">l'</span></span> <span class="skolem"><span class="skolem">u'</span></span> <span class="skolem"><span class="skolem">v'</span></span> <span class="keyword2"><span class="keyword">where</span></span> lpq<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">l'</span><span class="main">∥</span><span class="skolem">q</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> kplp<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">k'</span><span class="main">∥</span><span class="skolem">l'</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> kpz<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">k'</span><span class="main">∥</span><span class="skolem">z</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> qup<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">q</span><span class="main">∥</span><span class="skolem">u'</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> upvp<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">u'</span><span class="main">∥</span><span class="skolem">v'</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> zv'<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">z</span><span class="main">∥</span><span class="skolem">v'</span>"</span></span>  <span class="keyword1"><span class="command">using</span></span> d  <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">from</span></span> lp lpq <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">l</span><span class="main">∥</span><span class="skolem">q</span> <span class="main">⊕</span> <span class="main">(</span><span class="main">(</span><span class="main">∃</span><span class="bound">t</span><span class="main">.</span> <span class="skolem">l</span><span class="main">∥</span><span class="bound">t</span> <span class="main">∧</span> <span class="bound">t</span><span class="main">∥</span><span class="skolem">q</span><span class="main">)</span> <span class="main">⊕</span> <span class="main">(</span><span class="main">∃</span><span class="bound">t</span><span class="main">.</span> <span class="skolem">l'</span><span class="main">∥</span><span class="bound">t</span> <span class="main">∧</span> <span class="bound">t</span><span class="main">∥</span><span class="skolem">p</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">is</span></span> <span class="quoted"><span class="quoted">"<span class="var">?A</span> <span class="main">⊕</span> <span class="main">(</span><span class="var">?B</span> <span class="main">⊕</span> <span class="var">?C</span><span class="main">)</span>"</span></span><span class="main">)</span> <span class="keyword1"><span class="command">using</span></span> M2 <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="var">?A</span><span class="main">∧</span><span class="main">¬</span><span class="var">?B</span><span class="main">∧</span><span class="main">¬</span><span class="var">?C</span><span class="main">)</span> <span class="main">∨</span> <span class="main">(</span><span class="main">(</span><span class="main">¬</span><span class="var">?A</span><span class="main">∧</span><span class="var">?B</span><span class="main">∧</span><span class="main">¬</span><span class="var">?C</span><span class="main">)</span> <span class="main">∨</span> <span class="main">(</span><span class="main">¬</span><span class="var">?A</span><span class="main">∧</span><span class="main">¬</span><span class="var">?B</span><span class="main">∧</span><span class="var">?C</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">insert</span> xor_distr_L<span class="main"><span class="main">[</span></span><span class="operator">of</span> <span class="var"><span class="quoted"><span class="var">?A</span></span></span> <span class="var"><span class="quoted"><span class="var">?B</span></span></span> <span class="var"><span class="quoted"><span class="var">?C</span></span></span><span class="main"><span class="main">]</span></span><span class="main"><span class="keyword3">,</span></span> <span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span>elimmeets<span class="main">)</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">∈</span><span class="var">?R</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">elim</span> disjE<span class="main">)</span>
      <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="var">?A</span><span class="main">∧</span><span class="main">¬</span><span class="var">?B</span><span class="main">∧</span><span class="main">¬</span><span class="var">?C</span>"</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> lq<span class="main">:</span><span class="var"><span class="quoted"><span class="var">?A</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
        <span class="keyword1"><span class="command">from</span></span> pu qup <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">p</span><span class="main">∥</span><span class="skolem">u'</span> <span class="main">⊕</span> <span class="main">(</span><span class="main">(</span><span class="main">∃</span><span class="bound">t'</span><span class="main">.</span> <span class="skolem">p</span><span class="main">∥</span><span class="bound">t'</span> <span class="main">∧</span> <span class="bound">t'</span><span class="main">∥</span><span class="skolem">u'</span><span class="main">)</span> <span class="main">⊕</span> <span class="main">(</span><span class="main">∃</span><span class="bound">t'</span><span class="main">.</span> <span class="skolem">q</span><span class="main">∥</span><span class="bound">t'</span> <span class="main">∧</span> <span class="bound">t'</span><span class="main">∥</span><span class="skolem">u</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">is</span></span> <span class="quoted"><span class="quoted">"<span class="var">?A</span> <span class="main">⊕</span> <span class="main">(</span><span class="var">?B</span> <span class="main">⊕</span> <span class="var">?C</span><span class="main">)</span>"</span></span><span class="main">)</span> <span class="keyword1"><span class="command">using</span></span> M2 <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
        <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="var">?A</span><span class="main">∧</span><span class="main">¬</span><span class="var">?B</span><span class="main">∧</span><span class="main">¬</span><span class="var">?C</span><span class="main">)</span> <span class="main">∨</span> <span class="main">(</span><span class="main">(</span><span class="main">¬</span><span class="var">?A</span><span class="main">∧</span><span class="var">?B</span><span class="main">∧</span><span class="main">¬</span><span class="var">?C</span><span class="main">)</span> <span class="main">∨</span> <span class="main">(</span><span class="main">¬</span><span class="var">?A</span><span class="main">∧</span><span class="main">¬</span><span class="var">?B</span><span class="main">∧</span><span class="var">?C</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">insert</span> xor_distr_L<span class="main"><span class="main">[</span></span><span class="operator">of</span> <span class="var"><span class="quoted"><span class="var">?A</span></span></span> <span class="var"><span class="quoted"><span class="var">?B</span></span></span> <span class="var"><span class="quoted"><span class="var">?C</span></span></span><span class="main"><span class="main">]</span></span><span class="main"><span class="keyword3">,</span></span> <span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span>elimmeets<span class="main">)</span>
        <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
        <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">elim</span> disjE<span class="main">)</span>
          <span class="keyword1"><span class="command">{</span></span><span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="var">?A</span><span class="main">∧</span><span class="main">¬</span><span class="var">?B</span><span class="main">∧</span><span class="main">¬</span><span class="var">?C</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="var">?A</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
           <span class="keyword1"><span class="command">with</span></span> lq lp qup <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">p</span> <span class="main">=</span> <span class="skolem">q</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> M4 <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
           <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> x e  <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span><span class="keyword1"><span class="command">}</span></span>
          <span class="keyword1"><span class="command">next</span></span>
          <span class="keyword1"><span class="command">{</span></span><span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span><span class="var">?A</span><span class="main">∧</span><span class="var">?B</span><span class="main">∧</span><span class="main">¬</span><span class="var">?C</span>"</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="var">?B</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
           <span class="keyword1"><span class="command">with</span></span> lq lp qup <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> x s <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span><span class="keyword1"><span class="command">}</span></span>
          <span class="keyword1"><span class="command">next</span></span>
          <span class="keyword1"><span class="command">{</span></span><span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">¬</span><span class="var">?A</span><span class="main">∧</span><span class="main">¬</span><span class="var">?B</span><span class="main">∧</span><span class="var">?C</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="var">?C</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
           <span class="keyword1"><span class="command">with</span></span> pu lq lp <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> x s <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span><span class="keyword1"><span class="command">}</span></span>
        <span class="keyword1"><span class="command">qed</span></span><span class="keyword1"><span class="command">}</span></span>
      <span class="keyword1"><span class="command">next</span></span>
      <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span><span class="var">?A</span><span class="main">∧</span><span class="var">?B</span><span class="main">∧</span><span class="main">¬</span><span class="var">?C</span>"</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="var"><span class="quoted"><span class="var">?B</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
        <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">t</span></span> <span class="keyword2"><span class="keyword">where</span></span> lt<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">l</span><span class="main">∥</span><span class="skolem">t</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> tq<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">t</span><span class="main">∥</span><span class="skolem">q</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword1"><span class="command">from</span></span> pu qup <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">p</span><span class="main">∥</span><span class="skolem">u'</span> <span class="main">⊕</span> <span class="main">(</span><span class="main">(</span><span class="main">∃</span><span class="bound">t'</span><span class="main">.</span> <span class="skolem">p</span><span class="main">∥</span><span class="bound">t'</span> <span class="main">∧</span> <span class="bound">t'</span><span class="main">∥</span><span class="skolem">u'</span><span class="main">)</span> <span class="main">⊕</span> <span class="main">(</span><span class="main">∃</span><span class="bound">t'</span><span class="main">.</span> <span class="skolem">q</span><span class="main">∥</span><span class="bound">t'</span> <span class="main">∧</span> <span class="bound">t'</span><span class="main">∥</span><span class="skolem">u</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">is</span></span> <span class="quoted"><span class="quoted">"<span class="var">?A</span> <span class="main">⊕</span> <span class="main">(</span><span class="var">?B</span> <span class="main">⊕</span> <span class="var">?C</span><span class="main">)</span>"</span></span><span class="main">)</span> <span class="keyword1"><span class="command">using</span></span> M2 <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
        <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="var">?A</span><span class="main">∧</span><span class="main">¬</span><span class="var">?B</span><span class="main">∧</span><span class="main">¬</span><span class="var">?C</span><span class="main">)</span> <span class="main">∨</span> <span class="main">(</span><span class="main">(</span><span class="main">¬</span><span class="var">?A</span><span class="main">∧</span><span class="var">?B</span><span class="main">∧</span><span class="main">¬</span><span class="var">?C</span><span class="main">)</span> <span class="main">∨</span> <span class="main">(</span><span class="main">¬</span><span class="var">?A</span><span class="main">∧</span><span class="main">¬</span><span class="var">?B</span><span class="main">∧</span><span class="var">?C</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">insert</span> xor_distr_L<span class="main"><span class="main">[</span></span><span class="operator">of</span> <span class="var"><span class="quoted"><span class="var">?A</span></span></span> <span class="var"><span class="quoted"><span class="var">?B</span></span></span> <span class="var"><span class="quoted"><span class="var">?C</span></span></span><span class="main"><span class="main">]</span></span><span class="main"><span class="keyword3">,</span></span> <span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span>elimmeets<span class="main">)</span>
        <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
        <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">elim</span> disjE<span class="main">)</span>
          <span class="keyword1"><span class="command">{</span></span><span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="var">?A</span><span class="main">∧</span><span class="main">¬</span><span class="var">?B</span><span class="main">∧</span><span class="main">¬</span><span class="var">?C</span>"</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="var"><span class="quoted"><span class="var">?A</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
           <span class="keyword1"><span class="command">with</span></span> qup lt tq lp <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> f x <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span><span class="keyword1"><span class="command">}</span></span>
          <span class="keyword1"><span class="command">next</span></span>
          <span class="keyword1"><span class="command">{</span></span><span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span><span class="var">?A</span><span class="main">∧</span><span class="var">?B</span><span class="main">∧</span><span class="main">¬</span><span class="var">?C</span>"</span></span>  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="var"><span class="quoted"><span class="var">?B</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
           <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">t'</span></span> <span class="keyword2"><span class="keyword">where</span></span> ptp<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">p</span><span class="main">∥</span><span class="skolem">t'</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> tpup<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">t'</span><span class="main">∥</span><span class="skolem">u'</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
           <span class="keyword1"><span class="command">from</span></span> pu tq  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">p</span><span class="main">∥</span><span class="skolem">q</span> <span class="main">⊕</span> <span class="main">(</span><span class="main">(</span><span class="main">∃</span><span class="bound">t''</span><span class="main">.</span> <span class="skolem">p</span><span class="main">∥</span><span class="bound">t''</span> <span class="main">∧</span> <span class="bound">t''</span><span class="main">∥</span><span class="skolem">q</span><span class="main">)</span> <span class="main">⊕</span> <span class="main">(</span><span class="main">∃</span><span class="bound">t''</span><span class="main">.</span> <span class="skolem">t</span><span class="main">∥</span><span class="bound">t''</span> <span class="main">∧</span> <span class="bound">t''</span><span class="main">∥</span><span class="skolem">u</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">is</span></span> <span class="quoted"><span class="quoted">"<span class="var">?A</span> <span class="main">⊕</span> <span class="main">(</span><span class="var">?B</span> <span class="main">⊕</span> <span class="var">?C</span><span class="main">)</span>"</span></span><span class="main">)</span> <span class="keyword1"><span class="command">using</span></span> M2 <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
           <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="var">?A</span><span class="main">∧</span><span class="main">¬</span><span class="var">?B</span><span class="main">∧</span><span class="main">¬</span><span class="var">?C</span><span class="main">)</span> <span class="main">∨</span> <span class="main">(</span><span class="main">(</span><span class="main">¬</span><span class="var">?A</span><span class="main">∧</span><span class="var">?B</span><span class="main">∧</span><span class="main">¬</span><span class="var">?C</span><span class="main">)</span> <span class="main">∨</span> <span class="main">(</span><span class="main">¬</span><span class="var">?A</span><span class="main">∧</span><span class="main">¬</span><span class="var">?B</span><span class="main">∧</span><span class="var">?C</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">insert</span> xor_distr_L<span class="main"><span class="main">[</span></span><span class="operator">of</span> <span class="var"><span class="quoted"><span class="var">?A</span></span></span> <span class="var"><span class="quoted"><span class="var">?B</span></span></span> <span class="var"><span class="quoted"><span class="var">?C</span></span></span><span class="main"><span class="main">]</span></span><span class="main"><span class="keyword3">,</span></span> <span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span>elimmeets<span class="main">)</span>
           <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
           <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">elim</span> disjE<span class="main">)</span>
              <span class="keyword1"><span class="command">{</span></span><span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="var">?A</span><span class="main">∧</span><span class="main">¬</span><span class="var">?B</span><span class="main">∧</span><span class="main">¬</span><span class="var">?C</span>"</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="var"><span class="quoted"><span class="var">?A</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
               <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> x m <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span><span class="keyword1"><span class="command">}</span></span>
              <span class="keyword1"><span class="command">next</span></span>
              <span class="keyword1"><span class="command">{</span></span><span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span><span class="var">?A</span><span class="main">∧</span><span class="var">?B</span><span class="main">∧</span><span class="main">¬</span><span class="var">?C</span>"</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="var"><span class="quoted"><span class="var">?B</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
               <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> x b <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span><span class="keyword1"><span class="command">}</span></span>
              <span class="keyword1"><span class="command">next</span></span>
              <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span><span class="var">?A</span><span class="main">∧</span><span class="main">¬</span><span class="var">?B</span><span class="main">∧</span><span class="var">?C</span>"</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="var"><span class="quoted"><span class="var">?C</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
                <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">g</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">t</span><span class="main">∥</span><span class="skolem">g</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">g</span><span class="main">∥</span><span class="skolem">u</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
                <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command"><span class="improper">with</span></span></span> pu ptp <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">g</span><span class="main">∥</span><span class="skolem">t'</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> M1 <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
                <span class="keyword1"><span class="command">ultimately</span></span>  <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> x ov lt tq lp ptp tpup qup <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span><span class="keyword1"><span class="command">}</span></span>
           <span class="keyword1"><span class="command">qed</span></span><span class="keyword1"><span class="command">}</span></span>
         <span class="keyword1"><span class="command">next</span></span>
          <span class="keyword1"><span class="command">{</span></span><span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span><span class="var">?A</span><span class="main">∧</span><span class="main">¬</span><span class="var">?B</span><span class="main">∧</span><span class="var">?C</span>"</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="var"><span class="quoted"><span class="var">?C</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
           <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">t'</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">q</span><span class="main">∥</span><span class="skolem">t'</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">t'</span><span class="main">∥</span><span class="skolem">u</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
           <span class="keyword1"><span class="command">with</span></span> lp  lt tq pu  <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> d x <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span><span class="keyword1"><span class="command">}</span></span>
         <span class="keyword1"><span class="command">qed</span></span><span class="keyword1"><span class="command">}</span></span>
      <span class="keyword1"><span class="command">next</span></span>
      <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span><span class="var">?A</span><span class="main">∧</span><span class="main">¬</span><span class="var">?B</span><span class="main">∧</span><span class="var">?C</span>"</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="var"><span class="quoted"><span class="var">?C</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
        <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">t</span></span> <span class="keyword2"><span class="keyword">where</span></span> lpt<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">l'</span><span class="main">∥</span><span class="skolem">t</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> tp<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">t</span><span class="main">∥</span><span class="skolem">p</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword1"><span class="command">from</span></span>  pu qup <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">p</span><span class="main">∥</span><span class="skolem">u'</span> <span class="main">⊕</span> <span class="main">(</span><span class="main">(</span><span class="main">∃</span><span class="bound">t'</span><span class="main">.</span> <span class="skolem">p</span><span class="main">∥</span><span class="bound">t'</span> <span class="main">∧</span> <span class="bound">t'</span><span class="main">∥</span><span class="skolem">u'</span><span class="main">)</span> <span class="main">⊕</span> <span class="main">(</span><span class="main">∃</span><span class="bound">t'</span><span class="main">.</span> <span class="skolem">q</span><span class="main">∥</span><span class="bound">t'</span> <span class="main">∧</span> <span class="bound">t'</span><span class="main">∥</span><span class="skolem">u</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">is</span></span> <span class="quoted"><span class="quoted">"<span class="var">?A</span> <span class="main">⊕</span> <span class="main">(</span><span class="var">?B</span> <span class="main">⊕</span> <span class="var">?C</span><span class="main">)</span>"</span></span><span class="main">)</span> <span class="keyword1"><span class="command">using</span></span> M2 <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
        <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="var">?A</span><span class="main">∧</span><span class="main">¬</span><span class="var">?B</span><span class="main">∧</span><span class="main">¬</span><span class="var">?C</span><span class="main">)</span> <span class="main">∨</span> <span class="main">(</span><span class="main">(</span><span class="main">¬</span><span class="var">?A</span><span class="main">∧</span><span class="var">?B</span><span class="main">∧</span><span class="main">¬</span><span class="var">?C</span><span class="main">)</span> <span class="main">∨</span> <span class="main">(</span><span class="main">¬</span><span class="var">?A</span><span class="main">∧</span><span class="main">¬</span><span class="var">?B</span><span class="main">∧</span><span class="var">?C</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">insert</span> xor_distr_L<span class="main"><span class="main">[</span></span><span class="operator">of</span> <span class="var"><span class="quoted"><span class="var">?A</span></span></span> <span class="var"><span class="quoted"><span class="var">?B</span></span></span> <span class="var"><span class="quoted"><span class="var">?C</span></span></span><span class="main"><span class="main">]</span></span><span class="main"><span class="keyword3">,</span></span> <span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span>elimmeets<span class="main">)</span>
        <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
        <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">elim</span> disjE<span class="main">)</span>
          <span class="keyword1"><span class="command">{</span></span><span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="var">?A</span><span class="main">∧</span><span class="main">¬</span><span class="var">?B</span><span class="main">∧</span><span class="main">¬</span><span class="var">?C</span>"</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="var"><span class="quoted"><span class="var">?A</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
           <span class="keyword1"><span class="command">with</span></span> qup lpt tp lpq <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> x f <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span><span class="keyword1"><span class="command">}</span></span>
          <span class="keyword1"><span class="command">next</span></span>
          <span class="keyword1"><span class="command">{</span></span><span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span><span class="var">?A</span><span class="main">∧</span><span class="var">?B</span><span class="main">∧</span><span class="main">¬</span><span class="var">?C</span>"</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="var"><span class="quoted"><span class="var">?B</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
           <span class="keyword1"><span class="command">with</span></span> qup lpt tp lpq <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> x d <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span><span class="keyword1"><span class="command">}</span></span>
          <span class="keyword1"><span class="command">next</span></span>
          <span class="keyword1"><span class="command">{</span></span><span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span><span class="var">?A</span><span class="main">∧</span><span class="main">¬</span><span class="var">?B</span><span class="main">∧</span><span class="var">?C</span>"</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">t'</span></span> <span class="keyword2"><span class="keyword">where</span></span> qt'<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">q</span><span class="main">∥</span><span class="skolem">t'</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> tpc<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">t'</span><span class="main">∥</span><span class="skolem">u</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
           <span class="keyword1"><span class="command">from</span></span> qup tp <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">q</span><span class="main">∥</span><span class="skolem">p</span> <span class="main">⊕</span> <span class="main">(</span><span class="main">(</span><span class="main">∃</span><span class="bound">t''</span><span class="main">.</span> <span class="skolem">q</span><span class="main">∥</span><span class="bound">t''</span> <span class="main">∧</span> <span class="bound">t''</span><span class="main">∥</span><span class="skolem">p</span><span class="main">)</span> <span class="main">⊕</span> <span class="main">(</span><span class="main">∃</span><span class="bound">t''</span><span class="main">.</span> <span class="skolem">t</span><span class="main">∥</span><span class="bound">t''</span> <span class="main">∧</span> <span class="bound">t''</span><span class="main">∥</span><span class="skolem">u'</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">is</span></span> <span class="quoted"><span class="quoted">"<span class="var">?A</span> <span class="main">⊕</span> <span class="main">(</span><span class="var">?B</span> <span class="main">⊕</span> <span class="var">?C</span><span class="main">)</span>"</span></span><span class="main">)</span> <span class="keyword1"><span class="command">using</span></span> M2 <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
           <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="var">?A</span><span class="main">∧</span><span class="main">¬</span><span class="var">?B</span><span class="main">∧</span><span class="main">¬</span><span class="var">?C</span><span class="main">)</span> <span class="main">∨</span> <span class="main">(</span><span class="main">(</span><span class="main">¬</span><span class="var">?A</span><span class="main">∧</span><span class="var">?B</span><span class="main">∧</span><span class="main">¬</span><span class="var">?C</span><span class="main">)</span> <span class="main">∨</span> <span class="main">(</span><span class="main">¬</span><span class="var">?A</span><span class="main">∧</span><span class="main">¬</span><span class="var">?B</span><span class="main">∧</span><span class="var">?C</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">insert</span> xor_distr_L<span class="main"><span class="main">[</span></span><span class="operator">of</span> <span class="var"><span class="quoted"><span class="var">?A</span></span></span> <span class="var"><span class="quoted"><span class="var">?B</span></span></span> <span class="var"><span class="quoted"><span class="var">?C</span></span></span><span class="main"><span class="main">]</span></span><span class="main"><span class="keyword3">,</span></span> <span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span>elimmeets<span class="main">)</span>
           <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
           <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">elim</span> disjE<span class="main">)</span>
              <span class="keyword1"><span class="command">{</span></span><span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="var">?A</span><span class="main">∧</span><span class="main">¬</span><span class="var">?B</span><span class="main">∧</span><span class="main">¬</span><span class="var">?C</span>"</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="var"><span class="quoted"><span class="var">?A</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
               <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> x m <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span><span class="keyword1"><span class="command">}</span></span>
              <span class="keyword1"><span class="command">next</span></span>
              <span class="keyword1"><span class="command">{</span></span><span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span><span class="var">?A</span><span class="main">∧</span><span class="var">?B</span><span class="main">∧</span><span class="main">¬</span><span class="var">?C</span>"</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="var"><span class="quoted"><span class="var">?B</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
               <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> x b <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span><span class="keyword1"><span class="command">}</span></span>
              <span class="keyword1"><span class="command">next</span></span>
              <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span><span class="var">?A</span><span class="main">∧</span><span class="main">¬</span><span class="var">?B</span><span class="main">∧</span><span class="var">?C</span>"</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">g</span></span> <span class="keyword2"><span class="keyword">where</span></span> tg<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">t</span><span class="main">∥</span><span class="skolem">g</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">g</span><span class="main">∥</span><span class="skolem">u'</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
                <span class="keyword1"><span class="command">with</span></span> qup qt' <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">g</span><span class="main">∥</span><span class="skolem">t'</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> M1 <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
                <span class="keyword1"><span class="command">with</span></span> qt' tpc pu lpq lpt tp tg <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> x ov <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span><span class="keyword1"><span class="command">}</span></span>
          <span class="keyword1"><span class="command">qed</span></span><span class="keyword1"><span class="command">}</span></span>
     <span class="keyword1"><span class="command">qed</span></span><span class="keyword1"><span class="command">}</span></span>
 <span class="keyword1"><span class="command">qed</span></span>
<span class="keyword1"><span class="command">qed</span></span>


<span class="comment1">(* ========= inverse ========== *)</span>
<span class="keyword1"><span class="command">subsection</span></span> <span class="quoted"><span class="plain_text">‹The rest of the composition table›</span></span>
<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹Because of the symmetry $(r_1 \circ r_2)^{-1} = r_2^{-1} \circ r_1^{-1} $, the rest of the compositions is easily deduced.›</span></span>


<span class="keyword1"><span class="command">lemma</span></span> cmbi<span class="main">:</span><span class="quoted"><span class="quoted">"m <span class="keyword1">O</span> b<span class="main">^-1</span> <span class="main">⊆</span> b<span class="main">^-1</span> <span class="main">∪</span> m<span class="main">^-1</span> <span class="main">∪</span> s<span class="main">^-1</span> <span class="main">∪</span> ov<span class="main">^-1</span> <span class="main">∪</span> d<span class="main">^-1</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> cbmi <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>


<span class="keyword1"><span class="command">lemma</span></span> covmi<span class="main">:</span><span class="quoted"><span class="quoted">"ov <span class="keyword1">O</span> m<span class="main">^-1</span> <span class="main">⊆</span> ov<span class="main">^-1</span> <span class="main">∪</span> d<span class="main">^-1</span> <span class="main">∪</span> s<span class="main">^-1</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span>  cmovi <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">lemma</span></span> covbi<span class="main">:</span><span class="quoted"><span class="quoted">"ov <span class="keyword1">O</span> b<span class="main">^-1</span> <span class="main">⊆</span> b<span class="main">^-1</span> <span class="main">∪</span> m<span class="main">^-1</span> <span class="main">∪</span> s<span class="main">^-1</span> <span class="main">∪</span> ov<span class="main">^-1</span> <span class="main">∪</span> d<span class="main">^-1</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> cbovi <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">lemma</span></span> cfiovi<span class="main">:</span><span class="quoted"><span class="quoted">"f<span class="main">^-1</span> <span class="keyword1">O</span> ov<span class="main">^-1</span> <span class="main">⊆</span> ov<span class="main">^-1</span> <span class="main">∪</span> s<span class="main">^-1</span> <span class="main">∪</span> d<span class="main">^-1</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> covf <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">lemma</span></span> cfimi<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="main">(</span>f<span class="main">^-1</span> <span class="keyword1">O</span> m<span class="main">^-1</span><span class="main">)</span> <span class="main">⊆</span> s<span class="main">^-1</span> <span class="main">∪</span> ov<span class="main">^-1</span> <span class="main">∪</span> d<span class="main">^-1</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> cmf <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">lemma</span></span> cfibi<span class="main">:</span><span class="quoted"><span class="quoted">"f<span class="main">^-1</span> <span class="keyword1">O</span> b<span class="main">^-1</span> <span class="main">⊆</span> b<span class="main">^-1</span> <span class="main">∪</span> m<span class="main">^-1</span> <span class="main">∪</span> ov<span class="main">^-1</span> <span class="main">∪</span> s<span class="main">^-1</span> <span class="main">∪</span> d<span class="main">^-1</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> cbf <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">lemma</span></span> cdif<span class="main">:</span><span class="quoted"><span class="quoted">"d<span class="main">^-1</span> <span class="keyword1">O</span> f <span class="main">⊆</span> ov<span class="main">^-1</span> <span class="main">∪</span> s<span class="main">^-1</span> <span class="main">∪</span> d<span class="main">^-1</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> cfid <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">lemma</span></span> cdiovi<span class="main">:</span><span class="quoted"><span class="quoted">"d<span class="main">^-1</span> <span class="keyword1">O</span> ov <span class="main">^-1</span> <span class="main">⊆</span> ov<span class="main">^-1</span> <span class="main">∪</span> s<span class="main">^-1</span> <span class="main">∪</span> d<span class="main">^-1</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> covd <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">lemma</span></span> cdimi<span class="main">:</span><span class="quoted"><span class="quoted">"d<span class="main">^-1</span> <span class="keyword1">O</span> m<span class="main">^-1</span> <span class="main">⊆</span> s<span class="main">^-1</span> <span class="main">∪</span> ov<span class="main">^-1</span> <span class="main">∪</span> d<span class="main">^-1</span> "</span></span>
  <span class="keyword1"><span class="command">using</span></span> cmd <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">lemma</span></span> cdibi<span class="main">:</span><span class="quoted"><span class="quoted">"d<span class="main">^-1</span> <span class="keyword1">O</span> b<span class="main">^-1</span> <span class="main">⊆</span> b<span class="main">^-1</span> <span class="main">∪</span> m<span class="main">^-1</span> <span class="main">∪</span> ov<span class="main">^-1</span> <span class="main">∪</span> s<span class="main">^-1</span> <span class="main">∪</span> d<span class="main">^-1</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> cbd <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span> 

<span class="keyword1"><span class="command">lemma</span></span> csd<span class="main">:</span><span class="quoted"><span class="quoted">"s <span class="keyword1">O</span> d <span class="main">⊆</span> d"</span></span>
  <span class="keyword1"><span class="command">using</span></span> cdisi <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">lemma</span></span> csf<span class="main">:</span><span class="quoted"><span class="quoted">"s <span class="keyword1">O</span> f <span class="main">⊆</span> d"</span></span>
  <span class="keyword1"><span class="command">using</span></span> cfisi <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">lemma</span></span> csovi<span class="main">:</span><span class="quoted"><span class="quoted">"s <span class="keyword1">O</span> ov<span class="main">^-1</span> <span class="main">⊆</span> ov<span class="main">^-1</span> <span class="main">∪</span> f <span class="main">∪</span> d"</span></span>
  <span class="keyword1"><span class="command">using</span></span> covsi <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">lemma</span></span> csmi<span class="main">:</span><span class="quoted"><span class="quoted">"s <span class="keyword1">O</span> m<span class="main">^-1</span> <span class="main">⊆</span> m<span class="main">^-1</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> cmsi <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">lemma</span></span> csbi<span class="main">:</span><span class="quoted"><span class="quoted">"s <span class="keyword1">O</span> b<span class="main">^-1</span> <span class="main">⊆</span> b<span class="main">^-1</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> cbsi <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">lemma</span></span> csisi<span class="main">:</span><span class="quoted"><span class="quoted">"s<span class="main">^-1</span> <span class="keyword1">O</span> s<span class="main">^-1</span> <span class="main">⊆</span> s<span class="main">^-1</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> css <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">lemma</span></span> csid<span class="main">:</span><span class="quoted"><span class="quoted">"s<span class="main">^-1</span> <span class="keyword1">O</span> d <span class="main">⊆</span> ov<span class="main">^-1</span> <span class="main">∪</span> f <span class="main">∪</span> d"</span></span>
  <span class="keyword1"><span class="command">using</span></span> cdis <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">lemma</span></span> csif<span class="main">:</span><span class="quoted"><span class="quoted">"s<span class="main">^-1</span> <span class="keyword1">O</span> f <span class="main">⊆</span> ov<span class="main">^-1</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> cfis <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">lemma</span></span> csiovi<span class="main">:</span><span class="quoted"><span class="quoted">"s<span class="main">^-1</span> <span class="keyword1">O</span> ov<span class="main">^-1</span> <span class="main">⊆</span> ov<span class="main">^-1</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> covs <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">lemma</span></span> csimi<span class="main">:</span><span class="quoted"><span class="quoted">"s<span class="main">^-1</span> <span class="keyword1">O</span> m<span class="main">^-1</span> <span class="main">⊆</span> m<span class="main">^-1</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> cms <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">lemma</span></span> csibi<span class="main">:</span><span class="quoted"><span class="quoted">"s<span class="main">^-1</span> <span class="keyword1">O</span> b<span class="main">^-1</span> <span class="main">⊆</span> b<span class="main">^-1</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> cbs <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">lemma</span></span> cds<span class="main">:</span><span class="quoted"><span class="quoted">"d <span class="keyword1">O</span> s <span class="main">⊆</span> d"</span></span>
  <span class="keyword1"><span class="command">using</span></span> csidi <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">lemma</span></span> cdsi<span class="main">:</span><span class="quoted"><span class="quoted">"d <span class="keyword1">O</span> s<span class="main">^-1</span> <span class="main">⊆</span> b<span class="main">^-1</span> <span class="main">∪</span> m<span class="main">^-1</span> <span class="main">∪</span> ov<span class="main">^-1</span> <span class="main">∪</span> f <span class="main">∪</span> d"</span></span>
  <span class="keyword1"><span class="command">using</span></span> csdi <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">lemma</span></span> cdd<span class="main">:</span><span class="quoted"><span class="quoted">"d <span class="keyword1">O</span> d <span class="main">⊆</span> d"</span></span>
  <span class="keyword1"><span class="command">using</span></span> cdidi <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">lemma</span></span> cdf<span class="main">:</span><span class="quoted"><span class="quoted">"d <span class="keyword1">O</span> f <span class="main">⊆</span> d"</span></span> 
  <span class="keyword1"><span class="command">using</span></span> cfidi <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">lemma</span></span> cdovi<span class="main">:</span><span class="quoted"><span class="quoted">"d <span class="keyword1">O</span> ov<span class="main">^-1</span> <span class="main">⊆</span> b<span class="main">^-1</span> <span class="main">∪</span> m<span class="main">^-1</span> <span class="main">∪</span> ov<span class="main">^-1</span> <span class="main">∪</span> f <span class="main">∪</span> d"</span></span>
  <span class="keyword1"><span class="command">using</span></span> covdi <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">lemma</span></span> cdmi<span class="main">:</span><span class="quoted"><span class="quoted">"d <span class="keyword1">O</span> m<span class="main">^-1</span> <span class="main">⊆</span> b<span class="main">^-1</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> cmdi <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">lemma</span></span> cdbi<span class="main">:</span><span class="quoted"><span class="quoted">"d <span class="keyword1">O</span> b<span class="main">^-1</span> <span class="main">⊆</span> b<span class="main">^-1</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> cbdi <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">lemma</span></span> cfdi<span class="main">:</span><span class="quoted"><span class="quoted">"f <span class="keyword1">O</span> d<span class="main">^-1</span> <span class="main">⊆</span>  b<span class="main">^-1</span> <span class="main">∪</span> m<span class="main">^-1</span> <span class="main">∪</span> ov<span class="main">^-1</span> <span class="main">∪</span> s<span class="main">^-1</span> <span class="main">∪</span> d<span class="main">^-1</span> "</span></span>
  <span class="keyword1"><span class="command">using</span></span> cdfi <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">lemma</span></span> cfs<span class="main">:</span><span class="quoted"><span class="quoted">"f <span class="keyword1">O</span> s <span class="main">⊆</span> d"</span></span>
  <span class="keyword1"><span class="command">using</span></span> csifi <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">lemma</span></span> cfsi<span class="main">:</span><span class="quoted"><span class="quoted">"f <span class="keyword1">O</span> s<span class="main">^-1</span> <span class="main">⊆</span> b <span class="main">^-1</span> <span class="main">∪</span> m<span class="main">^-1</span> <span class="main">∪</span> ov <span class="main">^-1</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> csfi <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">lemma</span></span> cfd<span class="main">:</span><span class="quoted"><span class="quoted">"f <span class="keyword1">O</span> d <span class="main">⊆</span> d"</span></span>
  <span class="keyword1"><span class="command">using</span></span> cdifi <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>


<span class="keyword1"><span class="command">lemma</span></span> cff<span class="main">:</span><span class="quoted"><span class="quoted">"f <span class="keyword1">O</span> f <span class="main">⊆</span> f"</span></span>
  <span class="keyword1"><span class="command">using</span></span> cfifi <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">lemma</span></span> cfovi<span class="main">:</span><span class="quoted"><span class="quoted">"f <span class="keyword1">O</span> ov<span class="main">^-1</span> <span class="main">⊆</span> b<span class="main">^-1</span> <span class="main">∪</span> m<span class="main">^-1</span> <span class="main">∪</span> ov<span class="main">^-1</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> covfi <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">lemma</span></span> cfmi<span class="main">:</span><span class="quoted"><span class="quoted">"f <span class="keyword1">O</span> m<span class="main">^-1</span> <span class="main">⊆</span> b<span class="main">^-1</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> cmfi <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">lemma</span></span> cfbi<span class="main">:</span><span class="quoted"><span class="quoted">"f <span class="keyword1">O</span> b<span class="main">^-1</span> <span class="main">⊆</span> b<span class="main">^-1</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> cbfi <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">lemma</span></span> covifi<span class="main">:</span><span class="quoted"><span class="quoted">"ov<span class="main">^-1</span> <span class="keyword1">O</span> f<span class="main">^-1</span> <span class="main">⊆</span> ov<span class="main">^-1</span> <span class="main">∪</span> s<span class="main">^-1</span> <span class="main">∪</span> d<span class="main">^-1</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> cfov <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">lemma</span></span> covidi<span class="main">:</span><span class="quoted"><span class="quoted">"ov<span class="main">^-1</span> <span class="keyword1">O</span> d<span class="main">^-1</span> <span class="main">⊆</span> b<span class="main">^-1</span> <span class="main">∪</span> m<span class="main">^-1</span> <span class="main">∪</span> s<span class="main">^-1</span> <span class="main">∪</span> ov<span class="main">^-1</span> <span class="main">∪</span> d<span class="main">^-1</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> cdov <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">lemma</span></span> covis<span class="main">:</span><span class="quoted"><span class="quoted">"ov<span class="main">^-1</span> <span class="keyword1">O</span> s <span class="main">⊆</span> ov<span class="main">^-1</span> <span class="main">∪</span> f <span class="main">∪</span> d"</span></span>
  <span class="keyword1"><span class="command">using</span></span> csiov <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">lemma</span></span> covisi<span class="main">:</span><span class="quoted"><span class="quoted">"ov<span class="main">^-1</span> <span class="keyword1">O</span> s<span class="main">^-1</span> <span class="main">⊆</span> b<span class="main">^-1</span> <span class="main">∪</span> m<span class="main">^-1</span> <span class="main">∪</span> ov<span class="main">^-1</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> csov <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">lemma</span></span> covid<span class="main">:</span><span class="quoted"><span class="quoted">"ov<span class="main">^-1</span> <span class="keyword1">O</span> d <span class="main">⊆</span> ov<span class="main">^-1</span> <span class="main">∪</span> f <span class="main">∪</span> d"</span></span>
  <span class="keyword1"><span class="command">using</span></span> cdiov <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">lemma</span></span> covif<span class="main">:</span><span class="quoted"><span class="quoted">"ov<span class="main">^-1</span> <span class="keyword1">O</span> f <span class="main">⊆</span> ov<span class="main">^-1</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> cfiov <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">lemma</span></span> coviovi<span class="main">:</span><span class="quoted"><span class="quoted">"ov<span class="main">^-1</span> <span class="keyword1">O</span> ov<span class="main">^-1</span> <span class="main">⊆</span> b<span class="main">^-1</span> <span class="main">∪</span> m<span class="main">^-1</span> <span class="main">∪</span> ov<span class="main">^-1</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> covov <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">lemma</span></span> covimi<span class="main">:</span><span class="quoted"><span class="quoted">"ov<span class="main">^-1</span> <span class="keyword1">O</span> m<span class="main">^-1</span> <span class="main">⊆</span> b<span class="main">^-1</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> cmov <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">lemma</span></span> covibi<span class="main">:</span><span class="quoted"><span class="quoted">"ov<span class="main">^-1</span> <span class="keyword1">O</span> b<span class="main">^-1</span> <span class="main">⊆</span> b<span class="main">^-1</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> cbov <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">lemma</span></span> cmiov<span class="main">:</span><span class="quoted"><span class="quoted">"m<span class="main">^-1</span> <span class="keyword1">O</span> ov <span class="main">⊆</span> ov<span class="main">^-1</span> <span class="main">∪</span> d <span class="main">∪</span> f"</span></span>
  <span class="keyword1"><span class="command">using</span></span> covim <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">lemma</span></span> cmifi<span class="main">:</span><span class="quoted"><span class="quoted">"m<span class="main">^-1</span> <span class="keyword1">O</span> f<span class="main">^-1</span> <span class="main">⊆</span> m<span class="main">^-1</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> cfm <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">lemma</span></span> cmidi<span class="main">:</span><span class="quoted"><span class="quoted">"m<span class="main">^-1</span> <span class="keyword1">O</span> d<span class="main">^-1</span> <span class="main">⊆</span> b<span class="main">^-1</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> cdm <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">lemma</span></span> cmis<span class="main">:</span><span class="quoted"><span class="quoted">"m<span class="main">^-1</span> <span class="keyword1">O</span> s <span class="main">⊆</span> ov<span class="main">^-1</span> <span class="main">∪</span> d <span class="main">∪</span> f"</span></span>
  <span class="keyword1"><span class="command">using</span></span> csim <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">lemma</span></span> cmisi<span class="main">:</span><span class="quoted"><span class="quoted">"m<span class="main">^-1</span> <span class="keyword1">O</span> s<span class="main">^-1</span> <span class="main">⊆</span> b<span class="main">^-1</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> csm <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">lemma</span></span> cmid<span class="main">:</span><span class="quoted"><span class="quoted">"m<span class="main">^-1</span> <span class="keyword1">O</span> d <span class="main">⊆</span> ov<span class="main">^-1</span> <span class="main">∪</span> d <span class="main">∪</span> f"</span></span>
  <span class="keyword1"><span class="command">using</span></span> cdim <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">lemma</span></span> cmif<span class="main">:</span><span class="quoted"><span class="quoted">"m<span class="main">^-1</span> <span class="keyword1">O</span> f <span class="main">⊆</span> m<span class="main">^-1</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> cfim <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">lemma</span></span> cmiovi<span class="main">:</span><span class="quoted"><span class="quoted">"m<span class="main">^-1</span> <span class="keyword1">O</span> ov<span class="main">^-1</span> <span class="main">⊆</span> b<span class="main">^-1</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> covm <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">lemma</span></span> cmimi<span class="main">:</span><span class="quoted"><span class="quoted">"m<span class="main">^-1</span> <span class="keyword1">O</span> m<span class="main">^-1</span> <span class="main">⊆</span> b<span class="main">^-1</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> cmm <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">lemma</span></span> cmibi<span class="main">:</span><span class="quoted"><span class="quoted">"m<span class="main">^-1</span> <span class="keyword1">O</span> b<span class="main">^-1</span> <span class="main">⊆</span> b<span class="main">^-1</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> cbm <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">lemma</span></span> cbim<span class="main">:</span><span class="quoted"><span class="quoted">"b<span class="main">^-1</span> <span class="keyword1">O</span> m <span class="main">⊆</span> b<span class="main">^-1</span> <span class="main">∪</span> m<span class="main">^-1</span> <span class="main">∪</span> ov<span class="main">^-1</span> <span class="main">∪</span> f <span class="main">∪</span> d"</span></span>
  <span class="keyword1"><span class="command">using</span></span> cmib <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">lemma</span></span> cbiov<span class="main">:</span><span class="quoted"><span class="quoted">"b<span class="main">^-1</span> <span class="keyword1">O</span> ov <span class="main">⊆</span> b<span class="main">^-1</span> <span class="main">∪</span> m<span class="main">^-1</span> <span class="main">∪</span> ov<span class="main">^-1</span> <span class="main">∪</span> f <span class="main">∪</span> d"</span></span>
  <span class="keyword1"><span class="command">using</span></span> covib <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">lemma</span></span> cbifi<span class="main">:</span><span class="quoted"><span class="quoted">"b<span class="main">^-1</span> <span class="keyword1">O</span> f<span class="main">^-1</span> <span class="main">⊆</span> b<span class="main">^-1</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> cfb <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">lemma</span></span> cbidi<span class="main">:</span><span class="quoted"><span class="quoted">"b<span class="main">^-1</span> <span class="keyword1">O</span> d<span class="main">^-1</span> <span class="main">⊆</span> b<span class="main">^-1</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> cdb <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">lemma</span></span> cbis<span class="main">:</span><span class="quoted"><span class="quoted">"b<span class="main">^-1</span> <span class="keyword1">O</span> s <span class="main">⊆</span> b<span class="main">^-1</span> <span class="main">∪</span> m<span class="main">^-1</span> <span class="main">∪</span> ov<span class="main">^-1</span> <span class="main">∪</span> f <span class="main">∪</span> d"</span></span>
  <span class="keyword1"><span class="command">using</span></span> csib <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">lemma</span></span> cbisi<span class="main">:</span><span class="quoted"><span class="quoted">"b<span class="main">^-1</span> <span class="keyword1">O</span> s<span class="main">^-1</span> <span class="main">⊆</span> b<span class="main">^-1</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> csb <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">lemma</span></span> cbid<span class="main">:</span><span class="quoted"><span class="quoted">"b<span class="main">^-1</span> <span class="keyword1">O</span> d  <span class="main">⊆</span> b<span class="main">^-1</span> <span class="main">∪</span> m<span class="main">^-1</span> <span class="main">∪</span> ov<span class="main">^-1</span> <span class="main">∪</span> f <span class="main">∪</span> d"</span></span>
  <span class="keyword1"><span class="command">using</span></span> cdib <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">lemma</span></span> cbif<span class="main">:</span><span class="quoted"><span class="quoted">"b<span class="main">^-1</span> <span class="keyword1">O</span> f <span class="main">⊆</span> b<span class="main">^-1</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> cfib <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">lemma</span></span> cbiovi<span class="main">:</span><span class="quoted"><span class="quoted">"b<span class="main">^-1</span> <span class="keyword1">O</span> ov<span class="main">^-1</span> <span class="main">⊆</span> b<span class="main">^-1</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> covb <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">lemma</span></span> cbimi<span class="main">:</span><span class="quoted"><span class="quoted">"b<span class="main">^-1</span> <span class="keyword1">O</span> m<span class="main">^-1</span> <span class="main">⊆</span> b<span class="main">^-1</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> cmb <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">lemma</span></span> cbibi<span class="main">:</span><span class="quoted"><span class="quoted">"b<span class="main">^-1</span> <span class="keyword1">O</span> b<span class="main">^-1</span> <span class="main">⊆</span> b<span class="main">^-1</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> cbb <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span> 

<span class="comment1">(****)</span>

<span class="keyword1"><span class="command">subsection</span></span> <span class="quoted"><span class="plain_text">‹Composition rules›</span></span> 
<span class="keyword1"><span class="command">named_theorems</span></span> ce_rules <span class="keyword1"><span class="command">declare</span></span> cem<span class="main">[</span><span class="operator">ce_rules</span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span> ceb<span class="main">[</span><span class="operator">ce_rules</span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span> ceov<span class="main">[</span><span class="operator">ce_rules</span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span> ces<span class="main">[</span><span class="operator">ce_rules</span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span> cef<span class="main">[</span><span class="operator">ce_rules</span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span> ced<span class="main">[</span><span class="operator">ce_rules</span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span> 
cemi<span class="main">[</span><span class="operator">ce_rules</span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span> cebi<span class="main">[</span><span class="operator">ce_rules</span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span> ceovi<span class="main">[</span><span class="operator">ce_rules</span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span> cesi<span class="main">[</span><span class="operator">ce_rules</span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span> cefi<span class="main">[</span><span class="operator">ce_rules</span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span> cedi<span class="main">[</span><span class="operator">ce_rules</span><span class="main">]</span>

<span class="keyword1"><span class="command">named_theorems</span></span> cm_rules <span class="keyword1"><span class="command">declare</span></span> cme<span class="main">[</span><span class="operator">cm_rules</span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span> cmb<span class="main">[</span><span class="operator">cm_rules</span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span> cmm<span class="main">[</span><span class="operator">cm_rules</span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span> cmov<span class="main">[</span><span class="operator">cm_rules</span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span> cms <span class="main">[</span><span class="operator">cm_rules</span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span> cmd<span class="main">[</span><span class="operator">cm_rules</span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span> cmf<span class="main">[</span><span class="operator">cm_rules</span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span>
cmbi<span class="main">[</span><span class="operator">cm_rules</span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span> cmmi<span class="main">[</span><span class="operator">cm_rules</span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span> cmovi<span class="main">[</span><span class="operator">cm_rules</span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span> cmsi<span class="main">[</span><span class="operator">cm_rules</span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span> cmdi<span class="main">[</span><span class="operator">cm_rules</span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span> cmfi<span class="main">[</span><span class="operator">cm_rules</span><span class="main">]</span>

<span class="keyword1"><span class="command">named_theorems</span></span> cb_rules <span class="keyword1"><span class="command">declare</span></span> cbe<span class="main">[</span><span class="operator">cb_rules</span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span> cbm<span class="main">[</span><span class="operator">cb_rules</span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span> cbb<span class="main">[</span><span class="operator">cb_rules</span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span> cbov<span class="main">[</span><span class="operator">cb_rules</span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span> cbs <span class="main">[</span><span class="operator">cb_rules</span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span> cbd<span class="main">[</span><span class="operator">cb_rules</span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span> cbf<span class="main">[</span><span class="operator">cb_rules</span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span>
cbbi<span class="main">[</span><span class="operator">cb_rules</span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span> cbbi<span class="main">[</span><span class="operator">cb_rules</span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span> cbovi<span class="main">[</span><span class="operator">cb_rules</span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span> cbsi<span class="main">[</span><span class="operator">cb_rules</span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span> cbdi<span class="main">[</span><span class="operator">cb_rules</span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span> cbfi<span class="main">[</span><span class="operator">cb_rules</span><span class="main">]</span>

<span class="keyword1"><span class="command">named_theorems</span></span> cov_rules <span class="keyword1"><span class="command">declare</span></span> cove<span class="main">[</span><span class="operator">cov_rules</span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span> covb<span class="main">[</span><span class="operator">cov_rules</span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span> covb<span class="main">[</span><span class="operator">cov_rules</span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span> covov<span class="main">[</span><span class="operator">cov_rules</span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span> covs <span class="main">[</span><span class="operator">cov_rules</span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span> covd<span class="main">[</span><span class="operator">cov_rules</span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span> covf<span class="main">[</span><span class="operator">cov_rules</span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span>
covbi<span class="main">[</span><span class="operator">cov_rules</span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span> covbi<span class="main">[</span><span class="operator">cov_rules</span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span> covovi<span class="main">[</span><span class="operator">cov_rules</span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span> covsi<span class="main">[</span><span class="operator">cov_rules</span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span> covdi<span class="main">[</span><span class="operator">cov_rules</span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span> covfi<span class="main">[</span><span class="operator">cov_rules</span><span class="main">]</span>

<span class="keyword1"><span class="command">named_theorems</span></span> cs_rules <span class="keyword1"><span class="command">declare</span></span> cse<span class="main">[</span><span class="operator">cs_rules</span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span> csb<span class="main">[</span><span class="operator">cs_rules</span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span> csb<span class="main">[</span><span class="operator">cs_rules</span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span> csov<span class="main">[</span><span class="operator">cs_rules</span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span> css <span class="main">[</span><span class="operator">cs_rules</span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span> csd<span class="main">[</span><span class="operator">cs_rules</span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span> csf<span class="main">[</span><span class="operator">cs_rules</span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span>
csbi<span class="main">[</span><span class="operator">cs_rules</span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span> csbi<span class="main">[</span><span class="operator">cs_rules</span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span> csovi<span class="main">[</span><span class="operator">cs_rules</span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span> cssi<span class="main">[</span><span class="operator">cs_rules</span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span> csdi<span class="main">[</span><span class="operator">cs_rules</span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span> csfi<span class="main">[</span><span class="operator">cs_rules</span><span class="main">]</span>

<span class="keyword1"><span class="command">named_theorems</span></span> cf_rules <span class="keyword1"><span class="command">declare</span></span> cfe<span class="main">[</span><span class="operator">cf_rules</span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span> cfb<span class="main">[</span><span class="operator">cf_rules</span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span> cfb<span class="main">[</span><span class="operator">cf_rules</span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span> cfov<span class="main">[</span><span class="operator">cf_rules</span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span> cfs <span class="main">[</span><span class="operator">cf_rules</span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span> cfd<span class="main">[</span><span class="operator">cf_rules</span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span> cff<span class="main">[</span><span class="operator">cf_rules</span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span>
cfbi<span class="main">[</span><span class="operator">cf_rules</span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span> cfbi<span class="main">[</span><span class="operator">cf_rules</span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span> cfovi<span class="main">[</span><span class="operator">cf_rules</span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span> cfsi<span class="main">[</span><span class="operator">cf_rules</span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span> cfdi<span class="main">[</span><span class="operator">cf_rules</span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span> cffi<span class="main">[</span><span class="operator">cf_rules</span><span class="main">]</span>

<span class="keyword1"><span class="command">named_theorems</span></span> cd_rules <span class="keyword1"><span class="command">declare</span></span> cde<span class="main">[</span><span class="operator">cd_rules</span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span> cdb<span class="main">[</span><span class="operator">cd_rules</span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span> cdb<span class="main">[</span><span class="operator">cd_rules</span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span> cdov<span class="main">[</span><span class="operator">cd_rules</span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span> cds <span class="main">[</span><span class="operator">cd_rules</span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span> cdd<span class="main">[</span><span class="operator">cd_rules</span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span> cdf<span class="main">[</span><span class="operator">cd_rules</span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span>
cdbi<span class="main">[</span><span class="operator">cd_rules</span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span> cdbi<span class="main">[</span><span class="operator">cd_rules</span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span> cdovi<span class="main">[</span><span class="operator">cd_rules</span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span> cdsi<span class="main">[</span><span class="operator">cd_rules</span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span> cddi<span class="main">[</span><span class="operator">cd_rules</span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span> cdfi<span class="main">[</span><span class="operator">cd_rules</span><span class="main">]</span>

<span class="keyword1"><span class="command">named_theorems</span></span> cmi_rules <span class="keyword1"><span class="command">declare</span></span> cmie<span class="main">[</span><span class="operator">cmi_rules</span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span> cmib<span class="main">[</span><span class="operator">cmi_rules</span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span> cmib<span class="main">[</span><span class="operator">cmi_rules</span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span> cmiov<span class="main">[</span><span class="operator">cmi_rules</span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span> cmis <span class="main">[</span><span class="operator">cmi_rules</span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span> cmid<span class="main">[</span><span class="operator">cmi_rules</span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span> cmif<span class="main">[</span><span class="operator">cmi_rules</span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span>
cmibi<span class="main">[</span><span class="operator">cmi_rules</span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span> cmibi<span class="main">[</span><span class="operator">cmi_rules</span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span> cmiovi<span class="main">[</span><span class="operator">cmi_rules</span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span> cmisi<span class="main">[</span><span class="operator">cmi_rules</span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span> cmidi<span class="main">[</span><span class="operator">cmi_rules</span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span> cmifi<span class="main">[</span><span class="operator">cmi_rules</span><span class="main">]</span>

<span class="keyword1"><span class="command">named_theorems</span></span> cbi_rules <span class="keyword1"><span class="command">declare</span></span> cbie<span class="main">[</span><span class="operator">cbi_rules</span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span> cbim<span class="main">[</span><span class="operator">cbi_rules</span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span> cbib<span class="main">[</span><span class="operator">cbi_rules</span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span> cbiov<span class="main">[</span><span class="operator">cbi_rules</span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span> cbis <span class="main">[</span><span class="operator">cbi_rules</span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span> cbid<span class="main">[</span><span class="operator">cbi_rules</span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span> cbif<span class="main">[</span><span class="operator">cbi_rules</span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span>
cbimi<span class="main">[</span><span class="operator">cbi_rules</span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span> cbibi<span class="main">[</span><span class="operator">cbi_rules</span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span> cbiovi<span class="main">[</span><span class="operator">cbi_rules</span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span> cbisi<span class="main">[</span><span class="operator">cbi_rules</span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span> cbidi<span class="main">[</span><span class="operator">cbi_rules</span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span> cbifi<span class="main">[</span><span class="operator">cbi_rules</span><span class="main">]</span>

<span class="keyword1"><span class="command">named_theorems</span></span> covi_rules <span class="keyword1"><span class="command">declare</span></span> covie<span class="main">[</span><span class="operator">covi_rules</span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span> covib<span class="main">[</span><span class="operator">covi_rules</span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span> covib<span class="main">[</span><span class="operator">covi_rules</span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span> coviov<span class="main">[</span><span class="operator">covi_rules</span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span> covis <span class="main">[</span><span class="operator">covi_rules</span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span> covid<span class="main">[</span><span class="operator">covi_rules</span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span> covif<span class="main">[</span><span class="operator">covi_rules</span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span>
covibi<span class="main">[</span><span class="operator">covi_rules</span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span> covibi<span class="main">[</span><span class="operator">covi_rules</span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span> coviovi<span class="main">[</span><span class="operator">covi_rules</span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span> covisi<span class="main">[</span><span class="operator">covi_rules</span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span> covidi<span class="main">[</span><span class="operator">covi_rules</span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span> covifi<span class="main">[</span><span class="operator">covi_rules</span><span class="main">]</span>

<span class="keyword1"><span class="command">named_theorems</span></span> csi_rules <span class="keyword1"><span class="command">declare</span></span> csie<span class="main">[</span><span class="operator">csi_rules</span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span> csib<span class="main">[</span><span class="operator">csi_rules</span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span> csib<span class="main">[</span><span class="operator">csi_rules</span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span> csiov<span class="main">[</span><span class="operator">csi_rules</span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span> csis <span class="main">[</span><span class="operator">csi_rules</span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span> csid<span class="main">[</span><span class="operator">csi_rules</span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span> csif<span class="main">[</span><span class="operator">csi_rules</span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span>
csibi<span class="main">[</span><span class="operator">csi_rules</span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span> csibi<span class="main">[</span><span class="operator">csi_rules</span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span> csiovi<span class="main">[</span><span class="operator">csi_rules</span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span> csisi<span class="main">[</span><span class="operator">csi_rules</span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span> csidi<span class="main">[</span><span class="operator">csi_rules</span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span> csifi<span class="main">[</span><span class="operator">csi_rules</span><span class="main">]</span>

<span class="keyword1"><span class="command">named_theorems</span></span> cfi_rules <span class="keyword1"><span class="command">declare</span></span> cfie<span class="main">[</span><span class="operator">cfi_rules</span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span> cfib<span class="main">[</span><span class="operator">cfi_rules</span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span> cfib<span class="main">[</span><span class="operator">cfi_rules</span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span> cfiov<span class="main">[</span><span class="operator">cfi_rules</span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span> cfis <span class="main">[</span><span class="operator">cfi_rules</span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span> cfid<span class="main">[</span><span class="operator">cfi_rules</span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span> cfif<span class="main">[</span><span class="operator">cfi_rules</span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span>
cfibi<span class="main">[</span><span class="operator">cfi_rules</span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span> cfibi<span class="main">[</span><span class="operator">cfi_rules</span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span> cfiovi<span class="main">[</span><span class="operator">cfi_rules</span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span> cfisi<span class="main">[</span><span class="operator">cfi_rules</span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span> cfidi<span class="main">[</span><span class="operator">cfi_rules</span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span> cfifi<span class="main">[</span><span class="operator">cfi_rules</span><span class="main">]</span>

<span class="keyword1"><span class="command">named_theorems</span></span> cdi_rules <span class="keyword1"><span class="command">declare</span></span> cdie<span class="main">[</span><span class="operator">cdi_rules</span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span> cdib<span class="main">[</span><span class="operator">cdi_rules</span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span> cdib<span class="main">[</span><span class="operator">cdi_rules</span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span> cdiov<span class="main">[</span><span class="operator">cdi_rules</span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span> cdis <span class="main">[</span><span class="operator">cdi_rules</span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span> cdid<span class="main">[</span><span class="operator">cdi_rules</span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span> cdif<span class="main">[</span><span class="operator">cdi_rules</span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span>
cdibi<span class="main">[</span><span class="operator">cdi_rules</span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span> cdibi<span class="main">[</span><span class="operator">cdi_rules</span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span> cdiovi<span class="main">[</span><span class="operator">cdi_rules</span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span> cdisi<span class="main">[</span><span class="operator">cdi_rules</span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span> cdidi<span class="main">[</span><span class="operator">cdi_rules</span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span> cdifi<span class="main">[</span><span class="operator">cdi_rules</span><span class="main">]</span>
<span class="comment1">(**)</span>
<span class="keyword1"><span class="command">named_theorems</span></span> cre_rules <span class="keyword1"><span class="command">declare</span></span> cee<span class="main">[</span><span class="operator">cre_rules</span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span> cme<span class="main">[</span><span class="operator">cre_rules</span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span> cbe<span class="main">[</span><span class="operator">cre_rules</span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span> cove<span class="main">[</span><span class="operator">cre_rules</span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span> cse<span class="main">[</span><span class="operator">cre_rules</span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span> cfe<span class="main">[</span><span class="operator">cre_rules</span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span> cde<span class="main">[</span><span class="operator">cre_rules</span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span> 
cmie<span class="main">[</span><span class="operator">cre_rules</span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span> cbie<span class="main">[</span><span class="operator">cre_rules</span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span> covie<span class="main">[</span><span class="operator">cre_rules</span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span> csie<span class="main">[</span><span class="operator">cre_rules</span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span> cfie<span class="main">[</span><span class="operator">cre_rules</span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span> cdie<span class="main">[</span><span class="operator">cre_rules</span><span class="main">]</span>

<span class="keyword1"><span class="command">named_theorems</span></span> crm_rules <span class="keyword1"><span class="command">declare</span></span> cem<span class="main">[</span><span class="operator">crm_rules</span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span> cbm<span class="main">[</span><span class="operator">crm_rules</span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span> cmm<span class="main">[</span><span class="operator">crm_rules</span><span class="main">]</span>  <span class="keyword2"><span class="keyword">and</span></span> covm<span class="main">[</span><span class="operator">crm_rules</span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span> csm<span class="main">[</span><span class="operator">crm_rules</span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span> cfm<span class="main">[</span><span class="operator">crm_rules</span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span> cdm<span class="main">[</span><span class="operator">crm_rules</span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span> 
cmim<span class="main">[</span><span class="operator">crm_rules</span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span> cbim<span class="main">[</span><span class="operator">crm_rules</span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span> covim<span class="main">[</span><span class="operator">crm_rules</span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span> csim<span class="main">[</span><span class="operator">crm_rules</span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span> cfim<span class="main">[</span><span class="operator">crm_rules</span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span> cdim<span class="main">[</span><span class="operator">crm_rules</span><span class="main">]</span>

<span class="keyword1"><span class="command">named_theorems</span></span> crmi_rules <span class="keyword1"><span class="command">declare</span></span> cemi<span class="main">[</span><span class="operator">crmi_rules</span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span> cbmi<span class="main">[</span><span class="operator">crmi_rules</span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span> cmmi<span class="main">[</span><span class="operator">crmi_rules</span><span class="main">]</span>  <span class="keyword2"><span class="keyword">and</span></span> covmi<span class="main">[</span><span class="operator">crmi_rules</span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span> csmi<span class="main">[</span><span class="operator">crmi_rules</span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span> cfmi<span class="main">[</span><span class="operator">crmi_rules</span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span> cdmi<span class="main">[</span><span class="operator">crmi_rules</span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span> 
cmimi<span class="main">[</span><span class="operator">crmi_rules</span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span> cbimi<span class="main">[</span><span class="operator">crmi_rules</span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span> covimi<span class="main">[</span><span class="operator">crmi_rules</span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span> csimi<span class="main">[</span><span class="operator">crmi_rules</span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span> cfimi<span class="main">[</span><span class="operator">crmi_rules</span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span> cdimi<span class="main">[</span><span class="operator">crmi_rules</span><span class="main">]</span>

<span class="keyword1"><span class="command">named_theorems</span></span> crs_rules <span class="keyword1"><span class="command">declare</span></span> ces<span class="main">[</span><span class="operator">crs_rules</span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span> cbs<span class="main">[</span><span class="operator">crs_rules</span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span> cms<span class="main">[</span><span class="operator">crs_rules</span><span class="main">]</span>  <span class="keyword2"><span class="keyword">and</span></span> covs<span class="main">[</span><span class="operator">crs_rules</span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span> css<span class="main">[</span><span class="operator">crs_rules</span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span> cfs<span class="main">[</span><span class="operator">crs_rules</span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span> cds<span class="main">[</span><span class="operator">crs_rules</span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span> 
cmis<span class="main">[</span><span class="operator">crs_rules</span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span> cbis<span class="main">[</span><span class="operator">crs_rules</span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span> covis<span class="main">[</span><span class="operator">crs_rules</span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span> csis<span class="main">[</span><span class="operator">crs_rules</span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span> cfis<span class="main">[</span><span class="operator">crs_rules</span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span> cdis<span class="main">[</span><span class="operator">crs_rules</span><span class="main">]</span>

<span class="keyword1"><span class="command">named_theorems</span></span> crsi_rules <span class="keyword1"><span class="command">declare</span></span> cesi<span class="main">[</span><span class="operator">crsi_rules</span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span> cbsi<span class="main">[</span><span class="operator">crsi_rules</span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span> cmsi<span class="main">[</span><span class="operator">crsi_rules</span><span class="main">]</span>  <span class="keyword2"><span class="keyword">and</span></span> covsi<span class="main">[</span><span class="operator">crsi_rules</span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span> cssi<span class="main">[</span><span class="operator">crsi_rules</span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span> cfsi<span class="main">[</span><span class="operator">crsi_rules</span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span> cdsi<span class="main">[</span><span class="operator">crsi_rules</span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span> 
cmisi<span class="main">[</span><span class="operator">crsi_rules</span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span> cbisi<span class="main">[</span><span class="operator">crsi_rules</span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span> covisi<span class="main">[</span><span class="operator">crsi_rules</span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span> csisi<span class="main">[</span><span class="operator">crsi_rules</span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span> cfisi<span class="main">[</span><span class="operator">crsi_rules</span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span> cdisi<span class="main">[</span><span class="operator">crsi_rules</span><span class="main">]</span>

<span class="keyword1"><span class="command">named_theorems</span></span> crb_rules <span class="keyword1"><span class="command">declare</span></span> ceb<span class="main">[</span><span class="operator">crb_rules</span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span> cbb<span class="main">[</span><span class="operator">crb_rules</span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span> cmb<span class="main">[</span><span class="operator">crb_rules</span><span class="main">]</span>  <span class="keyword2"><span class="keyword">and</span></span> covb<span class="main">[</span><span class="operator">crb_rules</span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span> csb<span class="main">[</span><span class="operator">crb_rules</span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span> cfb<span class="main">[</span><span class="operator">crb_rules</span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span> cdb<span class="main">[</span><span class="operator">crb_rules</span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span> 
cmib<span class="main">[</span><span class="operator">crb_rules</span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span> cbib<span class="main">[</span><span class="operator">crb_rules</span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span> covib<span class="main">[</span><span class="operator">crb_rules</span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span> csib<span class="main">[</span><span class="operator">crb_rules</span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span> cfib<span class="main">[</span><span class="operator">crb_rules</span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span> cdib<span class="main">[</span><span class="operator">crb_rules</span><span class="main">]</span>

<span class="keyword1"><span class="command">named_theorems</span></span> crbi_rules <span class="keyword1"><span class="command">declare</span></span> cebi<span class="main">[</span><span class="operator">crbi_rules</span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span> cbbi<span class="main">[</span><span class="operator">crbi_rules</span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span> cmbi<span class="main">[</span><span class="operator">crbi_rules</span><span class="main">]</span>  <span class="keyword2"><span class="keyword">and</span></span> covbi<span class="main">[</span><span class="operator">crbi_rules</span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span> csbi<span class="main">[</span><span class="operator">crbi_rules</span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span> cfbi<span class="main">[</span><span class="operator">crbi_rules</span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span> cdbi<span class="main">[</span><span class="operator">crbi_rules</span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span> 
cmibi<span class="main">[</span><span class="operator">crbi_rules</span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span> cbibi<span class="main">[</span><span class="operator">crbi_rules</span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span> covibi<span class="main">[</span><span class="operator">crbi_rules</span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span> csibi<span class="main">[</span><span class="operator">crbi_rules</span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span> cfibi<span class="main">[</span><span class="operator">crbi_rules</span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span> cdibi<span class="main">[</span><span class="operator">crbi_rules</span><span class="main">]</span>

<span class="keyword1"><span class="command">named_theorems</span></span> crov_rules <span class="keyword1"><span class="command">declare</span></span> ceov<span class="main">[</span><span class="operator">crov_rules</span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span> cbov<span class="main">[</span><span class="operator">crov_rules</span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span> cmov<span class="main">[</span><span class="operator">crov_rules</span><span class="main">]</span>  <span class="keyword2"><span class="keyword">and</span></span> covov<span class="main">[</span><span class="operator">crov_rules</span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span> csov<span class="main">[</span><span class="operator">crov_rules</span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span> cfov<span class="main">[</span><span class="operator">crov_rules</span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span> cdov<span class="main">[</span><span class="operator">crov_rules</span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span> 
cmiov<span class="main">[</span><span class="operator">crov_rules</span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span> cbiov<span class="main">[</span><span class="operator">crov_rules</span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span> coviov<span class="main">[</span><span class="operator">crov_rules</span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span> csiov<span class="main">[</span><span class="operator">crov_rules</span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span> cfiov<span class="main">[</span><span class="operator">crov_rules</span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span> cdiov<span class="main">[</span><span class="operator">crov_rules</span><span class="main">]</span>

<span class="keyword1"><span class="command">named_theorems</span></span> crovi_rules <span class="keyword1"><span class="command">declare</span></span> ceovi<span class="main">[</span><span class="operator">crovi_rules</span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span> cbovi<span class="main">[</span><span class="operator">crovi_rules</span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span> cmovi<span class="main">[</span><span class="operator">crovi_rules</span><span class="main">]</span>  <span class="keyword2"><span class="keyword">and</span></span> covovi<span class="main">[</span><span class="operator">crovi_rules</span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span> csovi<span class="main">[</span><span class="operator">crovi_rules</span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span> cfovi<span class="main">[</span><span class="operator">crovi_rules</span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span> cdovi<span class="main">[</span><span class="operator">crovi_rules</span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span> 
cmiovi<span class="main">[</span><span class="operator">crovi_rules</span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span> cbiovi<span class="main">[</span><span class="operator">crovi_rules</span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span> coviovi<span class="main">[</span><span class="operator">crovi_rules</span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span> csiovi<span class="main">[</span><span class="operator">crovi_rules</span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span> cfiovi<span class="main">[</span><span class="operator">crovi_rules</span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span> cdiovi<span class="main">[</span><span class="operator">crovi_rules</span><span class="main">]</span>

<span class="keyword1"><span class="command">named_theorems</span></span> crf_rules <span class="keyword1"><span class="command">declare</span></span> cef<span class="main">[</span><span class="operator">crf_rules</span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span> cbf<span class="main">[</span><span class="operator">crf_rules</span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span> cmf<span class="main">[</span><span class="operator">crf_rules</span><span class="main">]</span>  <span class="keyword2"><span class="keyword">and</span></span> covf<span class="main">[</span><span class="operator">crf_rules</span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span> csf<span class="main">[</span><span class="operator">crf_rules</span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span> cff<span class="main">[</span><span class="operator">crf_rules</span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span> cdf<span class="main">[</span><span class="operator">crf_rules</span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span> 
cmif<span class="main">[</span><span class="operator">crf_rules</span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span> cbif<span class="main">[</span><span class="operator">crf_rules</span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span> covif<span class="main">[</span><span class="operator">crf_rules</span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span> csif<span class="main">[</span><span class="operator">crf_rules</span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span> cfif<span class="main">[</span><span class="operator">crf_rules</span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span> cdif<span class="main">[</span><span class="operator">crf_rules</span><span class="main">]</span>

<span class="keyword1"><span class="command">named_theorems</span></span> crfi_rules <span class="keyword1"><span class="command">declare</span></span> cefi<span class="main">[</span><span class="operator">crfi_rules</span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span> cbfi<span class="main">[</span><span class="operator">crfi_rules</span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span> cmfi<span class="main">[</span><span class="operator">crfi_rules</span><span class="main">]</span>  <span class="keyword2"><span class="keyword">and</span></span> covfi<span class="main">[</span><span class="operator">crfi_rules</span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span> csfi<span class="main">[</span><span class="operator">crfi_rules</span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span> cffi<span class="main">[</span><span class="operator">crfi_rules</span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span> cdfi<span class="main">[</span><span class="operator">crfi_rules</span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span> 
cmifi<span class="main">[</span><span class="operator">crfi_rules</span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span> cbifi<span class="main">[</span><span class="operator">crfi_rules</span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span> covifi<span class="main">[</span><span class="operator">crfi_rules</span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span> csifi<span class="main">[</span><span class="operator">crfi_rules</span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span> cfifi<span class="main">[</span><span class="operator">crfi_rules</span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span> cdifi<span class="main">[</span><span class="operator">crfi_rules</span><span class="main">]</span>

<span class="keyword1"><span class="command">named_theorems</span></span> crd_rules <span class="keyword1"><span class="command">declare</span></span> ced<span class="main">[</span><span class="operator">crd_rules</span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span> cbd<span class="main">[</span><span class="operator">crd_rules</span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span> cmd<span class="main">[</span><span class="operator">crd_rules</span><span class="main">]</span>  <span class="keyword2"><span class="keyword">and</span></span> covd<span class="main">[</span><span class="operator">crd_rules</span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span> csd<span class="main">[</span><span class="operator">crd_rules</span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span> cfd<span class="main">[</span><span class="operator">crd_rules</span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span> cdd<span class="main">[</span><span class="operator">crd_rules</span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span> 
cmid<span class="main">[</span><span class="operator">crd_rules</span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span> cbid<span class="main">[</span><span class="operator">crd_rules</span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span> covid<span class="main">[</span><span class="operator">crd_rules</span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span> csid<span class="main">[</span><span class="operator">crd_rules</span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span> cfid<span class="main">[</span><span class="operator">crd_rules</span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span> cdid<span class="main">[</span><span class="operator">crd_rules</span><span class="main">]</span>

<span class="keyword1"><span class="command">named_theorems</span></span> crdi_rules <span class="keyword1"><span class="command">declare</span></span> cedi<span class="main">[</span><span class="operator">crdi_rules</span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span> cbdi<span class="main">[</span><span class="operator">crdi_rules</span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span> cmdi<span class="main">[</span><span class="operator">crdi_rules</span><span class="main">]</span>  <span class="keyword2"><span class="keyword">and</span></span> covdi<span class="main">[</span><span class="operator">crdi_rules</span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span> csdi<span class="main">[</span><span class="operator">crdi_rules</span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span> cfdi<span class="main">[</span><span class="operator">crdi_rules</span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span> cddi<span class="main">[</span><span class="operator">crdi_rules</span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span> 
cmidi<span class="main">[</span><span class="operator">crdi_rules</span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span> cbidi<span class="main">[</span><span class="operator">crdi_rules</span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span> covidi<span class="main">[</span><span class="operator">crdi_rules</span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span> csidi<span class="main">[</span><span class="operator">crdi_rules</span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span> cfidi<span class="main">[</span><span class="operator">crdi_rules</span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span> cdidi<span class="main">[</span><span class="operator">crdi_rules</span><span class="main">]</span>



<span class="keyword2"><span class="keyword">end</span></span>
</pre>
</div><div id="disjoint_relations">
<div class="head">
<h1>Theory disjoint_relations</h1>
</div>
<pre class="source"><span class="comment1">(*
Title:  Allen's qualitative temporal calculus
Author:  Fadoua Ghourabi (fadouaghourabi@gmail.com)
Affiliation: Ochanomizu University, Japan
*)</span>


<span class="keyword1"><span class="command">theory</span></span> disjoint_relations

<span class="keyword2"><span class="keyword">imports</span></span>
  <a href="allen.html">allen</a>  

<span class="keyword2"><span class="keyword">begin</span></span>

<span class="keyword1"><span class="command">section</span></span> <span class="quoted"><span class="plain_text">‹PD property›</span></span>
<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹The 13 time interval relations (i.e. e, b, m, s, f, d, ov and their inverse relations) are pairwise disjoint.›</span></span>


 <span class="comment1">(**e**)</span>
<span class="keyword1"><span class="command">lemma</span></span> em <span class="comment1">(*[simp]*)</span><span class="main">:</span><span class="quoted"><span class="quoted">"e <span class="main">∩</span> m <span class="main">=</span> <span class="main">{}</span>"</span></span> 
<span class="keyword1"><span class="command">using</span></span> e m  meets_irrefl 
<span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> ComplI disjoint_eq_subset_Compl meets_wd subrelI<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span>  eb <span class="comment1">(*[simp]*)</span><span class="main">:</span><span class="quoted"><span class="quoted">"e <span class="main">∩</span> b <span class="main">=</span> <span class="main">{}</span>"</span></span> 
<span class="keyword1"><span class="command">using</span></span> b e meets_asym 
<span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> ComplI disjoint_eq_subset_Compl subrelI<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span>  eov <span class="comment1">(*[simp]*)</span><span class="main">:</span><span class="quoted"><span class="quoted">"e <span class="main">∩</span> ov <span class="main">=</span> <span class="main">{}</span>"</span></span> 
<span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> e ov<span class="main">)</span>
<span class="keyword1"><span class="command">using</span></span> elimmeets <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>

<span class="keyword1"><span class="command">lemma</span></span>  es <span class="comment1">(*[simp]*)</span><span class="main">:</span><span class="quoted"><span class="quoted">"e <span class="main">∩</span> s <span class="main">=</span> <span class="main">{}</span>"</span></span> 
<span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span>e s<span class="main">)</span>
<span class="keyword1"><span class="command">using</span></span> elimmeets <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>

<span class="keyword1"><span class="command">lemma</span></span>  ef <span class="comment1">(*[simp]*)</span><span class="main">:</span><span class="quoted"><span class="quoted">"e <span class="main">∩</span> f <span class="main">=</span> <span class="main">{}</span>"</span></span> 
<span class="keyword1"><span class="command">using</span></span> e f <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> <span class="main"><span class="main">(</span></span>no_types<span class="main"><span class="main">,</span></span> lifting<span class="main"><span class="main">)</span></span> ComplI disjoint_eq_subset_Compl meets_atrans subrelI<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span>  ed <span class="comment1">(*[simp]*)</span><span class="main">:</span><span class="quoted"><span class="quoted">"e <span class="main">∩</span> d <span class="main">=</span> <span class="main">{}</span>"</span></span> 
<span class="keyword1"><span class="command">using</span></span> e d <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> <span class="main"><span class="main">(</span></span>no_types<span class="main"><span class="main">,</span></span> lifting<span class="main"><span class="main">)</span></span> ComplI disjoint_eq_subset_Compl meets_atrans subrelI<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span>  emi <span class="comment1">(*[simp]*)</span><span class="main">:</span><span class="quoted"><span class="quoted">"e <span class="main">∩</span> m<span class="main">^-1</span> <span class="main">=</span> <span class="main">{}</span>"</span></span> 
<span class="keyword1"><span class="command">using</span></span> converseE em e 
<span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> disjoint_iff_not_equal<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span>  ebi <span class="comment1">(*[simp]*)</span><span class="main">:</span><span class="quoted"><span class="quoted">"e <span class="main">∩</span> b<span class="main">^-1</span> <span class="main">=</span> <span class="main">{}</span>"</span></span> 
<span class="keyword1"><span class="command">using</span></span> converseE eb e 
<span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> disjoint_iff_not_equal<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span>  eovi <span class="comment1">(*[simp]*)</span><span class="main">:</span><span class="quoted"><span class="quoted">"e <span class="main">∩</span> ov<span class="main">^-1</span> <span class="main">=</span> <span class="main">{}</span>"</span></span> 
<span class="keyword1"><span class="command">using</span></span> converseE eov e 
<span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> disjoint_iff_not_equal<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span>  esi <span class="comment1">(*[simp]*)</span><span class="main">:</span><span class="quoted"><span class="quoted">"e <span class="main">∩</span> s<span class="main">^-1</span> <span class="main">=</span> <span class="main">{}</span>"</span></span> 
<span class="keyword1"><span class="command">using</span></span> converseE es e 
<span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> disjoint_iff_not_equal<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span>  efi <span class="comment1">(*[simp]*)</span><span class="main">:</span><span class="quoted"><span class="quoted">"e <span class="main">∩</span> f<span class="main">^-1</span> <span class="main">=</span> <span class="main">{}</span>"</span></span> 
<span class="keyword1"><span class="command">using</span></span> converseE ef e 
<span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> disjoint_iff_not_equal<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> edi <span class="comment1">(*[simp]*)</span><span class="main">:</span><span class="quoted"><span class="quoted">"e <span class="main">∩</span> d<span class="main">^-1</span> <span class="main">=</span> <span class="main">{}</span>"</span></span> 
<span class="keyword1"><span class="command">using</span></span> converseE ed e 
<span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> disjoint_iff_not_equal<span class="main">)</span>


<span class="comment1">(**m**)</span>
<span class="keyword1"><span class="command">lemma</span></span>  mb <span class="comment1">(*[simp]*)</span><span class="main">:</span><span class="quoted"><span class="quoted">"m <span class="main">∩</span> b <span class="main">=</span> <span class="main">{}</span>"</span></span>
<span class="keyword1"><span class="command">using</span></span> m b
<span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">using</span></span> elimmeets <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>

<span class="keyword1"><span class="command">lemma</span></span>  mov <span class="comment1">(*[simp]*)</span><span class="main">:</span> <span class="quoted"><span class="quoted">"m <span class="main">∩</span> ov <span class="main">=</span> <span class="main">{}</span>"</span></span> 
<span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span>m ov<span class="main">)</span> 
<span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">meson</span> M1 elimmeets<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span>  ms <span class="comment1">(*[simp]*)</span><span class="main">:</span><span class="quoted"><span class="quoted">"m <span class="main">∩</span> s <span class="main">=</span> <span class="main">{}</span>"</span></span> 
<span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span>m s<span class="main">)</span>
<span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">meson</span> M1 elimmeets<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span>  mf <span class="comment1">(*[simp]*)</span><span class="main">:</span><span class="quoted"><span class="quoted">"m <span class="main">∩</span> f <span class="main">=</span> <span class="main">{}</span>"</span></span> 
<span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span>m f<span class="main">)</span>
<span class="keyword1"><span class="command">using</span></span> elimmeets <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>

<span class="keyword1"><span class="command">lemma</span></span>  md <span class="comment1">(*[simp]*)</span><span class="main">:</span><span class="quoted"><span class="quoted">"m <span class="main">∩</span> d <span class="main">=</span> <span class="main">{}</span>"</span></span> 
<span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> m d<span class="main">)</span>
<span class="keyword1"><span class="command">using</span></span> trans2 <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>

<span class="keyword1"><span class="command">lemma</span></span>  mi <span class="comment1">(*[simp]*)</span><span class="main">:</span><span class="quoted"><span class="quoted">"m <span class="main">∩</span> m<span class="main">^-1</span> <span class="main">=</span> <span class="main">{}</span>"</span></span> 
<span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span>m<span class="main">)</span>
<span class="keyword1"><span class="command">using</span></span> converseE m meets_asym <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>

<span class="keyword1"><span class="command">lemma</span></span>  mbi <span class="comment1">(*[simp]*)</span><span class="main">:</span><span class="quoted"><span class="quoted">"m <span class="main">∩</span> b<span class="main">^-1</span> <span class="main">=</span> <span class="main">{}</span>"</span></span> 
<span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span>mb<span class="main">)</span> 
<span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> m b<span class="main">)</span> 
<span class="keyword1"><span class="command">using</span></span> nontrans2 <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>

<span class="keyword1"><span class="command">lemma</span></span> movi <span class="comment1">(*[simp]*)</span><span class="main">:</span><span class="quoted"><span class="quoted">"m <span class="main">∩</span> ov<span class="main">^-1</span> <span class="main">=</span> <span class="main">{}</span>"</span></span> 
<span class="keyword1"><span class="command">using</span></span> m ov
<span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">using</span></span> trans2 <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>

<span class="keyword1"><span class="command">lemma</span></span>  msi <span class="comment1">(*[simp]*)</span><span class="main">:</span><span class="quoted"><span class="quoted">"m <span class="main">∩</span> s<span class="main">^-1</span> <span class="main">=</span> <span class="main">{}</span>"</span></span> 
<span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span>m s<span class="main">)</span>
<span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">meson</span> M1 elimmeets<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span>  mfi <span class="comment1">(*[simp]*)</span><span class="main">:</span><span class="quoted"><span class="quoted">"m <span class="main">∩</span> f<span class="main">^-1</span> <span class="main">=</span> <span class="main">{}</span>"</span></span> 
<span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span>m f<span class="main">)</span>
<span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">meson</span> M1 elimmeets<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span>  mdi <span class="comment1">(*[simp]*)</span><span class="main">:</span><span class="quoted"><span class="quoted">"m <span class="main">∩</span> d<span class="main">^-1</span> <span class="main">=</span> <span class="main">{}</span>"</span></span> 
<span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span>m d<span class="main">)</span>
<span class="keyword1"><span class="command">using</span></span> trans2 <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>

<span class="comment1">(**b**)</span>
<span class="keyword1"><span class="command">lemma</span></span> bov <span class="comment1">(*[simp]*)</span><span class="main">:</span><span class="quoted"><span class="quoted">"b <span class="main">∩</span> ov <span class="main">=</span> <span class="main">{}</span>"</span></span> 
<span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span>b ov<span class="main">)</span>
<span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">meson</span> M1 trans2<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> bs <span class="comment1">(*[simp]*)</span><span class="main">:</span><span class="quoted"><span class="quoted">"b <span class="main">∩</span> s <span class="main">=</span> <span class="main">{}</span>"</span></span> 
<span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span>b s<span class="main">)</span>
<span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">meson</span> M1 trans2<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span>  bf <span class="comment1">(*[simp]*)</span><span class="main">:</span><span class="quoted"><span class="quoted">"b <span class="main">∩</span> f <span class="main">=</span> <span class="main">{}</span>"</span></span> 
<span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> b f<span class="main">)</span>
<span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">meson</span> M1 trans2<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> bd <span class="comment1">(*[simp]*)</span><span class="main">:</span><span class="quoted"><span class="quoted">"b <span class="main">∩</span> d <span class="main">=</span> <span class="main">{}</span>"</span></span> 
<span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span>b d<span class="main">)</span>
<span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">meson</span> M1 nonmeets4<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span>  bmi <span class="comment1">(*[simp]*)</span><span class="main">:</span><span class="quoted"><span class="quoted">"b <span class="main">∩</span> m<span class="main">^-1</span> <span class="main">=</span> <span class="main">{}</span>"</span></span> 
<span class="keyword1"><span class="command">using</span></span> mbi <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">lemma</span></span>  bi <span class="comment1">(*[simp]*)</span><span class="main">:</span><span class="quoted"><span class="quoted">"b <span class="main">∩</span> b<span class="main">^-1</span> <span class="main">=</span> <span class="main">{}</span>"</span></span> 
<span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span>b<span class="main">)</span>
<span class="keyword1"><span class="command">using</span></span> M5exist_var3 trans2 <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>

<span class="keyword1"><span class="command">lemma</span></span> bovi <span class="comment1">(*[simp]*)</span><span class="main">:</span><span class="quoted"><span class="quoted">"b <span class="main">∩</span> ov<span class="main">^-1</span> <span class="main">=</span> <span class="main">{}</span>"</span></span> 
<span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span>bov<span class="main">)</span> 
<span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span>b ov<span class="main">)</span> 
<span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">meson</span> M1 nontrans2<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span>  bsi <span class="comment1">(*[simp]*)</span><span class="main">:</span><span class="quoted"><span class="quoted">"b <span class="main">∩</span> s<span class="main">^-1</span> <span class="main">=</span> <span class="main">{}</span>"</span></span> 
<span class="keyword1"><span class="command">using</span></span> bs <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="operator">auto</span> <span class="keyword1"><span class="command">using</span></span> b s <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="operator">auto</span> 
<span class="keyword1"><span class="command">using</span></span> trans2 <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>

<span class="keyword1"><span class="command">lemma</span></span> bfi <span class="comment1">(*[simp]*)</span><span class="main">:</span><span class="quoted"><span class="quoted">"b <span class="main">∩</span> f<span class="main">^-1</span> <span class="main">=</span> <span class="main">{}</span>"</span></span> 
<span class="keyword1"><span class="command">using</span></span> bf <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="operator">auto</span> <span class="keyword1"><span class="command">using</span></span> b f <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="operator">auto</span> 
<span class="keyword1"><span class="command">using</span></span> trans2 <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>

<span class="keyword1"><span class="command">lemma</span></span>  bdi <span class="comment1">(*[simp]*)</span><span class="main">:</span><span class="quoted"><span class="quoted">"b <span class="main">∩</span> d<span class="main">^-1</span> <span class="main">=</span> <span class="main">{}</span>"</span></span> 
<span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span>bd<span class="main">)</span> 
<span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span>b d<span class="main">)</span> 
<span class="keyword1"><span class="command">using</span></span> trans2 
<span class="keyword1"><span class="command">using</span></span> M1 nonmeets4 <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>


<span class="comment1">(**ov**)</span>
<span class="keyword1"><span class="command">lemma</span></span> ovs <span class="comment1">(*[simp]*)</span><span class="main">:</span><span class="quoted"><span class="quoted">"ov <span class="main">∩</span> s <span class="main">=</span> <span class="main">{}</span>"</span></span> 
<span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span>ov s<span class="main">)</span>
<span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">meson</span> M1 meets_atrans<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> ovf <span class="comment1">(*[simp]*)</span><span class="main">:</span><span class="quoted"><span class="quoted">"ov <span class="main">∩</span> f <span class="main">=</span> <span class="main">{}</span>"</span></span> 
<span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span>ov f<span class="main">)</span>
<span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">meson</span> M1 meets_atrans<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> ovd <span class="comment1">(*[simp]*)</span><span class="main">:</span><span class="quoted"><span class="quoted">"ov<span class="main">∩</span> d <span class="main">=</span> <span class="main">{}</span>"</span></span> 
<span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span>ov d<span class="main">)</span>
<span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">meson</span> M1 trans2<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> ovmi <span class="comment1">(*[simp]*)</span><span class="main">:</span><span class="quoted"><span class="quoted">"ov <span class="main">∩</span> m<span class="main">^-1</span> <span class="main">=</span> <span class="main">{}</span>"</span></span> 
<span class="keyword1"><span class="command">using</span></span> movi <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">lemma</span></span>  ovbi <span class="comment1">(*[simp]*)</span><span class="main">:</span><span class="quoted"><span class="quoted">"ov <span class="main">∩</span> b<span class="main">^-1</span> <span class="main">=</span> <span class="main">{}</span>"</span></span> 
<span class="keyword1"><span class="command">using</span></span> bovi <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>

<span class="keyword1"><span class="command">lemma</span></span> ovi <span class="comment1">(*[simp]*)</span><span class="main">:</span><span class="quoted"><span class="quoted">"ov <span class="main">∩</span> ov<span class="main">^-1</span> <span class="main">=</span> <span class="main">{}</span>"</span></span> 
<span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span>ov<span class="main">)</span>
<span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">meson</span> M1 trans2<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> ovsi <span class="comment1">(*[simp]*)</span><span class="main">:</span><span class="quoted"><span class="quoted">"ov <span class="main">∩</span> s<span class="main">^-1</span> <span class="main">=</span> <span class="main">{}</span>"</span></span> 
<span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span>ov s<span class="main">)</span>
<span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">meson</span> M1 elimmeets<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> ovfi <span class="comment1">(*[simp]*)</span><span class="main">:</span><span class="quoted"><span class="quoted">"ov <span class="main">∩</span> f<span class="main">^-1</span> <span class="main">=</span> <span class="main">{}</span>"</span></span> 
<span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span>ov f<span class="main">)</span> 
<span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">meson</span> M1 elimmeets<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> ovdi <span class="comment1">(*[simp]*)</span><span class="main">:</span><span class="quoted"><span class="quoted">"ov <span class="main">∩</span> d<span class="main">^-1</span> <span class="main">=</span> <span class="main">{}</span>"</span></span> 
<span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span>ov d<span class="main">)</span> 
<span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">meson</span> M1 trans2<span class="main">)</span>

<span class="comment1">(**s**)</span>
<span class="keyword1"><span class="command">lemma</span></span>  sf <span class="comment1">(*[simp]*)</span><span class="main">:</span><span class="quoted"><span class="quoted">"s <span class="main">∩</span> f <span class="main">=</span> <span class="main">{}</span>"</span></span> 
<span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span>s f<span class="main">)</span> 
<span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> M4 elimmeets<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> sd <span class="comment1">(*[simp]*)</span><span class="main">:</span><span class="quoted"><span class="quoted">"s <span class="main">∩</span> d <span class="main">=</span> <span class="main">{}</span>"</span></span> 
<span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span>s d<span class="main">)</span> 
<span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> M1 meets_atrans<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> smi <span class="comment1">(*[simp]*)</span><span class="main">:</span><span class="quoted"><span class="quoted">"s <span class="main">∩</span> m<span class="main">^-1</span> <span class="main">=</span> <span class="main">{}</span>"</span></span> 
<span class="keyword1"><span class="command">using</span></span> msi <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">lemma</span></span>  sbi <span class="comment1">(*[simp]*)</span><span class="main">:</span><span class="quoted"><span class="quoted">"s <span class="main">∩</span> b<span class="main">^-1</span> <span class="main">=</span> <span class="main">{}</span>"</span></span> 
<span class="keyword1"><span class="command">using</span></span> bsi <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>

<span class="keyword1"><span class="command">lemma</span></span>  sovi <span class="comment1">(*[simp]*)</span><span class="main">:</span><span class="quoted"><span class="quoted">"s <span class="main">∩</span> ov<span class="main">^-1</span> <span class="main">=</span> <span class="main">{}</span>"</span></span> 
<span class="keyword1"><span class="command">using</span></span> ovsi <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">lemma</span></span>  si <span class="comment1">(*[simp]*)</span><span class="main">:</span><span class="quoted"><span class="quoted">"s <span class="main">∩</span> s<span class="main">^-1</span> <span class="main">=</span> <span class="main">{}</span>"</span></span> 
<span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span>s<span class="main">)</span> 
<span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">meson</span> M1 trans2<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> sfi <span class="comment1">(*[simp]*)</span><span class="main">:</span><span class="quoted"><span class="quoted">"s <span class="main">∩</span> f<span class="main">^-1</span> <span class="main">=</span> <span class="main">{}</span>"</span></span> 
<span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span>s f<span class="main">)</span>
<span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> M4 elimmeets<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> sdi <span class="comment1">(*[simp]*)</span><span class="main">:</span><span class="quoted"><span class="quoted">"s<span class="main">∩</span> d<span class="main">^-1</span> <span class="main">=</span> <span class="main">{}</span>"</span></span> 
<span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span>s d<span class="main">)</span>
<span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">meson</span> M1 meets_atrans<span class="main">)</span>


<span class="comment1">(**f**)</span>
<span class="keyword1"><span class="command">lemma</span></span> fd <span class="comment1">(*[simp]*)</span><span class="main">:</span><span class="quoted"><span class="quoted">"f <span class="main">∩</span> d <span class="main">=</span> <span class="main">{}</span>"</span></span> 
<span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span>f d<span class="main">)</span>
<span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">meson</span> M1 meets_atrans<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> fmi <span class="comment1">(*[simp]*)</span><span class="main">:</span><span class="quoted"><span class="quoted">"f <span class="main">∩</span> m<span class="main">^-1</span> <span class="main">=</span> <span class="main">{}</span>"</span></span> 
<span class="keyword1"><span class="command">using</span></span> mfi <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">lemma</span></span>  fbi <span class="comment1">(*[simp]*)</span><span class="main">:</span><span class="quoted"><span class="quoted">"f <span class="main">∩</span> b<span class="main">^-1</span> <span class="main">=</span> <span class="main">{}</span>"</span></span> 
<span class="keyword1"><span class="command">using</span></span> bfi converse_Int <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">lemma</span></span> fovi <span class="comment1">(*[simp]*)</span><span class="main">:</span><span class="quoted"><span class="quoted">"f <span class="main">∩</span> ov<span class="main">^-1</span> <span class="main">=</span> <span class="main">{}</span>"</span></span> 
  <span class="keyword1"><span class="command">using</span></span> ovfi <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">lemma</span></span> fsi <span class="comment1">(*[simp]*)</span><span class="main">:</span><span class="quoted"><span class="quoted">"f <span class="main">∩</span> s<span class="main">^-1</span> <span class="main">=</span> <span class="main">{}</span>"</span></span> 
<span class="keyword1"><span class="command">using</span></span> sfi <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">lemma</span></span> fi <span class="comment1">(*[simp]*)</span><span class="main">:</span><span class="quoted"><span class="quoted">"f <span class="main">∩</span> f<span class="main">^-1</span> <span class="main">=</span> <span class="main">{}</span>"</span></span> 
<span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span>f<span class="main">)</span> 
<span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">meson</span> M1 trans2<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> fdi <span class="comment1">(*[simp]*)</span><span class="main">:</span><span class="quoted"><span class="quoted">"f <span class="main">∩</span> d<span class="main">^-1</span> <span class="main">=</span> <span class="main">{}</span>"</span></span> 
<span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span>f d<span class="main">)</span> 
<span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">meson</span> M1 trans2<span class="main">)</span>


<span class="comment1">(**d**)</span>
<span class="keyword1"><span class="command">lemma</span></span> dmi <span class="comment1">(*[simp]*)</span><span class="main">:</span><span class="quoted"><span class="quoted">"d <span class="main">∩</span> m<span class="main">^-1</span> <span class="main">=</span> <span class="main">{}</span>"</span></span> 
<span class="keyword1"><span class="command">using</span></span> mdi <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">lemma</span></span>  dbi <span class="comment1">(*[simp]*)</span><span class="main">:</span><span class="quoted"><span class="quoted">"d <span class="main">∩</span> b<span class="main">^-1</span> <span class="main">=</span> <span class="main">{}</span>"</span></span> 
<span class="keyword1"><span class="command">using</span></span> bdi <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>

<span class="keyword1"><span class="command">lemma</span></span> dovi <span class="comment1">(*[simp]*)</span><span class="main">:</span><span class="quoted"><span class="quoted">"d <span class="main">∩</span> ov<span class="main">^-1</span> <span class="main">=</span> <span class="main">{}</span>"</span></span> 
<span class="keyword1"><span class="command">using</span></span> ovdi <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">lemma</span></span>  dsi <span class="comment1">(*[simp]*)</span><span class="main">:</span><span class="quoted"><span class="quoted">"d <span class="main">∩</span> s<span class="main">^-1</span> <span class="main">=</span> <span class="main">{}</span>"</span></span> 
<span class="keyword1"><span class="command">using</span></span> sdi <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">lemma</span></span>  dfi <span class="comment1">(*[simp]*)</span><span class="main">:</span><span class="quoted"><span class="quoted">"d <span class="main">∩</span> f<span class="main">^-1</span> <span class="main">=</span> <span class="main">{}</span>"</span></span> 
<span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span>d f<span class="main">)</span> 
<span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">meson</span> M1 trans2<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span>  di <span class="comment1">(*[simp]*)</span><span class="main">:</span><span class="quoted"><span class="quoted">"d <span class="main">∩</span> d<span class="main">^-1</span> <span class="main">=</span> <span class="main">{}</span>"</span></span> 
<span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span>d<span class="main">)</span> 
<span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">meson</span> M1 trans2<span class="main">)</span>

<span class="comment1">(**m^-1**)</span>
<span class="keyword1"><span class="command">lemma</span></span> mibi <span class="comment1">(*[simp]*)</span><span class="main">:</span><span class="quoted"><span class="quoted">"m<span class="main">^-1</span> <span class="main">∩</span> b<span class="main">^-1</span> <span class="main">=</span> <span class="main">{}</span>"</span></span> 
<span class="keyword1"><span class="command">using</span></span> mb <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">lemma</span></span> miovi <span class="comment1">(*[simp]*)</span><span class="main">:</span><span class="quoted"><span class="quoted">"m<span class="main">^-1</span> <span class="main">∩</span> ov<span class="main">^-1</span> <span class="main">=</span> <span class="main">{}</span>"</span></span> 
<span class="keyword1"><span class="command">using</span></span> mov <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">lemma</span></span> misi <span class="comment1">(*[simp]*)</span><span class="main">:</span><span class="quoted"><span class="quoted">"m<span class="main">^-1</span> <span class="main">∩</span> s<span class="main">^-1</span> <span class="main">=</span> <span class="main">{}</span>"</span></span> 
<span class="keyword1"><span class="command">using</span></span> ms <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">lemma</span></span> mifi <span class="comment1">(*[simp]*)</span><span class="main">:</span><span class="quoted"><span class="quoted">"m<span class="main">^-1</span> <span class="main">∩</span> f<span class="main">^-1</span> <span class="main">=</span> <span class="main">{}</span>"</span></span> 
<span class="keyword1"><span class="command">using</span></span> mf <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">lemma</span></span> midi <span class="comment1">(*[simp]*)</span><span class="main">:</span><span class="quoted"><span class="quoted">"m<span class="main">^-1</span> <span class="main">∩</span> d<span class="main">^-1</span> <span class="main">=</span> <span class="main">{}</span>"</span></span> 
<span class="keyword1"><span class="command">using</span></span> md <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>


<span class="comment1">(**b^-1**)</span>
<span class="keyword1"><span class="command">lemma</span></span>  bid <span class="comment1">(*[simp]*)</span><span class="main">:</span><span class="quoted"><span class="quoted">"b<span class="main">^-1</span> <span class="main">∩</span> d <span class="main">=</span> <span class="main">{}</span>"</span></span> 
<span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> dbi inf_sup_aci<span class="main"><span class="main">(</span></span>1<span class="main"><span class="main">)</span></span><span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span>  bimi <span class="comment1">(*[simp]*)</span><span class="main">:</span><span class="quoted"><span class="quoted">"b<span class="main">^-1</span> <span class="main">∩</span> m<span class="main">^-1</span> <span class="main">=</span> <span class="main">{}</span>"</span></span> 
<span class="keyword1"><span class="command">using</span></span> mibi <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">lemma</span></span>  biovi <span class="comment1">(*[simp]*)</span><span class="main">:</span><span class="quoted"><span class="quoted">"b<span class="main">^-1</span> <span class="main">∩</span> ov<span class="main">^-1</span> <span class="main">=</span> <span class="main">{}</span>"</span></span> 
<span class="keyword1"><span class="command">using</span></span> bov <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>

<span class="keyword1"><span class="command">lemma</span></span>  bisi <span class="comment1">(*[simp]*)</span><span class="main">:</span><span class="quoted"><span class="quoted">"b<span class="main">^-1</span> <span class="main">∩</span> s<span class="main">^-1</span> <span class="main">=</span> <span class="main">{}</span>"</span></span> 
<span class="keyword1"><span class="command">using</span></span> bs <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>

<span class="keyword1"><span class="command">lemma</span></span> bifi <span class="comment1">(*[simp]*)</span><span class="main">:</span><span class="quoted"><span class="quoted">"b<span class="main">^-1</span> <span class="main">∩</span> f<span class="main">^-1</span> <span class="main">=</span> <span class="main">{}</span>"</span></span> 
<span class="keyword1"><span class="command">using</span></span> bf <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>

<span class="keyword1"><span class="command">lemma</span></span> bidi <span class="comment1">(*[simp]*)</span><span class="main">:</span><span class="quoted"><span class="quoted">"b<span class="main">^-1</span> <span class="main">∩</span> d<span class="main">^-1</span> <span class="main">=</span> <span class="main">{}</span>"</span></span> 
<span class="keyword1"><span class="command">using</span></span> bd <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>

<span class="comment1">(** ov^-1**)</span>
<span class="keyword1"><span class="command">lemma</span></span> ovisi <span class="comment1">(*[simp]*)</span><span class="main">:</span><span class="quoted"><span class="quoted">"ov<span class="main">^-1</span> <span class="main">∩</span> s<span class="main">^-1</span> <span class="main">=</span> <span class="main">{}</span>"</span></span>
<span class="keyword1"><span class="command">using</span></span> ovs <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>

<span class="keyword1"><span class="command">lemma</span></span> ovifi <span class="comment1">(*[simp]*)</span><span class="main">:</span><span class="quoted"><span class="quoted">"ov<span class="main">^-1</span> <span class="main">∩</span> f<span class="main">^-1</span> <span class="main">=</span> <span class="main">{}</span>"</span></span>
<span class="keyword1"><span class="command">using</span></span> ovf <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>

<span class="keyword1"><span class="command">lemma</span></span> ovidi <span class="comment1">(*[simp]*)</span><span class="main">:</span><span class="quoted"><span class="quoted">"ov<span class="main">^-1</span> <span class="main">∩</span> d<span class="main">^-1</span> <span class="main">=</span> <span class="main">{}</span>"</span></span>
<span class="keyword1"><span class="command">using</span></span> ovd <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>


<span class="comment1">(** s^-1 **)</span>
<span class="keyword1"><span class="command">lemma</span></span> sifi <span class="comment1">(*[simp]*)</span><span class="main">:</span><span class="quoted"><span class="quoted">"s<span class="main">^-1</span> <span class="main">∩</span> f<span class="main">^-1</span> <span class="main">=</span> <span class="main">{}</span>"</span></span>
<span class="keyword1"><span class="command">using</span></span> sf <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>

<span class="keyword1"><span class="command">lemma</span></span> sidi <span class="comment1">(*[simp]*)</span><span class="main">:</span><span class="quoted"><span class="quoted">"s<span class="main">^-1</span> <span class="main">∩</span> d<span class="main">^-1</span> <span class="main">=</span> <span class="main">{}</span>"</span></span>
<span class="keyword1"><span class="command">using</span></span> sd <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span> 

<span class="comment1">(** f^-1**)</span>
<span class="keyword1"><span class="command">lemma</span></span> fidi <span class="comment1">(*[simp]*)</span><span class="main">:</span><span class="quoted"><span class="quoted">"f<span class="main">^-1</span> <span class="main">∩</span> d<span class="main">^-1</span> <span class="main">=</span> <span class="main">{}</span>"</span></span>
<span class="keyword1"><span class="command">using</span></span> fd <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>

<span class="keyword1"><span class="command">lemma</span></span> eei<span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span><span class="quoted"><span class="quoted">"e<span class="main">^-1</span> <span class="main">=</span>  e"</span></span>
<span class="keyword1"><span class="command">using</span></span> e 
<span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> converse_iff subrelI subset_antisym<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> rdisj_sym<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="free">A</span> <span class="main">∩</span> <span class="free">B</span> <span class="main">=</span> <span class="main">{}</span> <span class="main">⟹</span> <span class="free">B</span> <span class="main">∩</span> <span class="free">A</span> <span class="main">=</span> <span class="main">{}</span>"</span></span>
<span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">subsection</span></span> <span class="quoted"><span class="plain_text">‹Intersection rules›</span></span>
<span class="keyword1"><span class="command">named_theorems</span></span> e_rules <span class="keyword1"><span class="command">declare</span></span> em<span class="main">[</span><span class="operator">e_rules</span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span> eb<span class="main">[</span><span class="operator">e_rules</span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span> eov<span class="main">[</span><span class="operator">e_rules</span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span> es<span class="main">[</span><span class="operator">e_rules</span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span> ef<span class="main">[</span><span class="operator">e_rules</span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span> ed<span class="main">[</span><span class="operator">e_rules</span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span> emi<span class="main">[</span><span class="operator">e_rules</span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span> ebi<span class="main">[</span><span class="operator">e_rules</span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span> eovi<span class="main">[</span><span class="operator">e_rules</span><span class="main">]</span> 
<span class="keyword2"><span class="keyword">and</span></span> esi<span class="main">[</span><span class="operator">e_rules</span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span> efi<span class="main">[</span><span class="operator">e_rules</span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span> edi<span class="main">[</span><span class="operator">e_rules</span><span class="main">]</span>

<span class="keyword1"><span class="command">named_theorems</span></span> m_rules <span class="keyword1"><span class="command">declare</span></span> em<span class="main">[</span><span class="operator">THEN</span> rdisj_sym<span class="main">,</span> <span class="operator">m_rules</span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span> mb <span class="main">[</span><span class="operator">m_rules</span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span> ms  <span class="main">[</span><span class="operator">m_rules</span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span> mov <span class="main">[</span><span class="operator">m_rules</span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span> mf<span class="main">[</span><span class="operator">m_rules</span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span> 
md<span class="main">[</span><span class="operator">m_rules</span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span> mi <span class="main">[</span><span class="operator">m_rules</span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span> mbi <span class="main">[</span><span class="operator">m_rules</span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span> movi <span class="main">[</span><span class="operator">m_rules</span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span> msi <span class="main">[</span><span class="operator">m_rules</span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span> mfi <span class="main">[</span><span class="operator">m_rules</span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span> mdi <span class="main">[</span><span class="operator">m_rules</span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span> emi<span class="main">[</span><span class="operator">m_rules</span><span class="main">]</span>

<span class="keyword1"><span class="command">named_theorems</span></span> b_rules <span class="keyword1"><span class="command">declare</span></span> eb<span class="main">[</span><span class="operator">THEN</span> rdisj_sym<span class="main">,</span> <span class="operator">b_rules</span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span> mb <span class="main">[</span><span class="operator">THEN</span> rdisj_sym<span class="main">,</span> <span class="operator">b_rules</span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span> bs  <span class="main">[</span><span class="operator">b_rules</span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span> bov <span class="main">[</span><span class="operator">b_rules</span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span> bf<span class="main">[</span><span class="operator">b_rules</span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span> 
bd<span class="main">[</span><span class="operator">b_rules</span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span> bmi <span class="main">[</span><span class="operator">b_rules</span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span> bi <span class="main">[</span><span class="operator">b_rules</span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span> bovi <span class="main">[</span><span class="operator">b_rules</span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span> bsi <span class="main">[</span><span class="operator">b_rules</span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span> bfi <span class="main">[</span><span class="operator">b_rules</span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span> bdi <span class="main">[</span><span class="operator">b_rules</span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span> ebi<span class="main">[</span><span class="operator">b_rules</span><span class="main">]</span>

<span class="keyword1"><span class="command">named_theorems</span></span> ov_rules <span class="keyword1"><span class="command">declare</span></span> eov<span class="main">[</span><span class="operator">THEN</span> rdisj_sym<span class="main">,</span> <span class="operator">ov_rules</span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span> mov <span class="main">[</span><span class="operator">THEN</span> rdisj_sym<span class="main">,</span> <span class="operator">ov_rules</span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span> ovs  <span class="main">[</span><span class="operator">ov_rules</span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span> bov <span class="main">[</span><span class="operator">THEN</span> rdisj_sym<span class="main">,</span><span class="operator">ov_rules</span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span> ovf<span class="main">[</span><span class="operator">ov_rules</span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span> 
ovd<span class="main">[</span><span class="operator">ov_rules</span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span> ovmi <span class="main">[</span><span class="operator">ov_rules</span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span>  ovi <span class="main">[</span><span class="operator">ov_rules</span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span> ovsi <span class="main">[</span><span class="operator">ov_rules</span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span> ovfi <span class="main">[</span><span class="operator">ov_rules</span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span> ovdi <span class="main">[</span><span class="operator">ov_rules</span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span> eovi<span class="main">[</span><span class="operator">ov_rules</span><span class="main">]</span>

<span class="keyword1"><span class="command">named_theorems</span></span> s_rules <span class="keyword1"><span class="command">declare</span></span> es<span class="main">[</span><span class="operator">THEN</span> rdisj_sym<span class="main">,</span> <span class="operator">s_rules</span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span> ms <span class="main">[</span><span class="operator">THEN</span> rdisj_sym<span class="main">,</span> <span class="operator">s_rules</span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span> ovs  <span class="main">[</span><span class="operator">THEN</span> rdisj_sym<span class="main">,</span> <span class="operator">s_rules</span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span> bs <span class="main">[</span><span class="operator">THEN</span> rdisj_sym<span class="main">,</span><span class="operator">s_rules</span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span> sf<span class="main">[</span><span class="operator">s_rules</span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span> 
sd<span class="main">[</span><span class="operator">s_rules</span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span> smi <span class="main">[</span><span class="operator">s_rules</span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span>  sovi <span class="main">[</span><span class="operator">s_rules</span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span> si <span class="main">[</span><span class="operator">s_rules</span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span> sfi <span class="main">[</span><span class="operator">s_rules</span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span> sdi <span class="main">[</span><span class="operator">s_rules</span><span class="main">]</span>

<span class="keyword1"><span class="command">named_theorems</span></span> d_rules <span class="keyword1"><span class="command">declare</span></span> ed<span class="main">[</span><span class="operator">THEN</span> rdisj_sym<span class="main">,</span> <span class="operator">d_rules</span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span> md <span class="main">[</span><span class="operator">THEN</span> rdisj_sym<span class="main">,</span> <span class="operator">d_rules</span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span> sd  <span class="main">[</span><span class="operator">THEN</span> rdisj_sym<span class="main">,</span> <span class="operator">d_rules</span><span class="main">]</span>  <span class="keyword2"><span class="keyword">and</span></span> fd<span class="main">[</span><span class="operator">THEN</span> rdisj_sym<span class="main">,</span> <span class="operator">d_rules</span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span> 
ovd<span class="main">[</span><span class="operator">THEN</span> rdisj_sym<span class="main">,</span><span class="operator">d_rules</span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span> dmi <span class="main">[</span><span class="operator">d_rules</span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span>  dovi <span class="main">[</span><span class="operator">d_rules</span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span> dsi <span class="main">[</span><span class="operator">d_rules</span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span> dfi <span class="main">[</span><span class="operator">d_rules</span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span> di <span class="main">[</span><span class="operator">d_rules</span><span class="main">]</span> 
 
<span class="keyword1"><span class="command">named_theorems</span></span> f_rules <span class="keyword1"><span class="command">declare</span></span> ef<span class="main">[</span><span class="operator">THEN</span> rdisj_sym<span class="main">,</span> <span class="operator">f_rules</span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span> mf <span class="main">[</span><span class="operator">THEN</span> rdisj_sym<span class="main">,</span> <span class="operator">f_rules</span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span> sf  <span class="main">[</span><span class="operator">THEN</span> rdisj_sym<span class="main">,</span> <span class="operator">f_rules</span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span> ovf <span class="main">[</span><span class="operator">THEN</span> rdisj_sym<span class="main">,</span><span class="operator">f_rules</span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span> fd<span class="main">[</span><span class="operator">f_rules</span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span> 
 fmi <span class="main">[</span><span class="operator">f_rules</span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span>  fovi <span class="main">[</span><span class="operator">f_rules</span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span> fsi <span class="main">[</span><span class="operator">f_rules</span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span> fi <span class="main">[</span><span class="operator">f_rules</span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span> fdi <span class="main">[</span><span class="operator">f_rules</span><span class="main">]</span> 

 
<span class="keyword2"><span class="keyword">end</span></span>
</pre>
</div><div id="jointly_exhaustive">
<div class="head">
<h1>Theory jointly_exhaustive</h1>
</div>
<pre class="source"><span class="comment1">(*
Title:  Allen's qualitative temporal calculus
Author:  Fadoua Ghourabi (fadouaghourabi@gmail.com)
Affiliation: Ochanomizu University, Japan
*)</span>



<span class="keyword1"><span class="command">theory</span></span> jointly_exhaustive

<span class="keyword2"><span class="keyword">imports</span></span>
  <a href="allen.html">allen</a>

<span class="keyword2"><span class="keyword">begin</span></span>

<span class="keyword1"><span class="command">section</span></span> <span class="quoted"><span class="plain_text">‹JE property›</span></span>
<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹The 13 time interval relations are jointly exhaustive. For any two intervals $x$ and $y$, we can find a basic relation $r$ such that $(x,y) \in r$.›</span></span>
 
<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> arelations<span class="main">)</span> jointly_exhaustive<span class="main">:</span>
<span class="keyword2"><span class="keyword">assumes</span></span>  <span class="quoted"><span class="quoted">"ℐ <span class="free">p</span>"</span></span> <span class="quoted"><span class="quoted">"ℐ <span class="free">q</span>"</span></span>
<span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">p</span><span class="main">::</span><span class="tfree">'a</span><span class="main">,</span><span class="free">q</span><span class="main">::</span><span class="tfree">'a</span><span class="main">)</span> <span class="main">∈</span> b <span class="main">∨</span> <span class="main">(</span><span class="free">p</span><span class="main">,</span><span class="free">q</span><span class="main">)</span> <span class="main">∈</span> m <span class="main">∨</span> <span class="main">(</span><span class="free">p</span><span class="main">,</span><span class="free">q</span><span class="main">)</span> <span class="main">∈</span> ov <span class="main">∨</span> <span class="main">(</span><span class="free">p</span><span class="main">,</span><span class="free">q</span><span class="main">)</span> <span class="main">∈</span> s <span class="main">∨</span> <span class="main">(</span><span class="free">p</span><span class="main">,</span><span class="free">q</span><span class="main">)</span> <span class="main">∈</span> d <span class="main">∨</span> <span class="main">(</span><span class="free">p</span><span class="main">,</span><span class="free">q</span><span class="main">)</span> <span class="main">∈</span> f<span class="main">^-1</span> <span class="main">∨</span> <span class="main">(</span><span class="free">p</span><span class="main">,</span><span class="free">q</span><span class="main">)</span> <span class="main">∈</span> e <span class="main">∨</span> 
                                    <span class="main">(</span><span class="free">p</span><span class="main">,</span><span class="free">q</span><span class="main">)</span> <span class="main">∈</span> f <span class="main">∨</span> <span class="main">(</span><span class="free">p</span><span class="main">,</span><span class="free">q</span><span class="main">)</span> <span class="main">∈</span> s<span class="main">^-1</span> <span class="main">∨</span> <span class="main">(</span><span class="free">p</span><span class="main">,</span><span class="free">q</span><span class="main">)</span> <span class="main">∈</span> d<span class="main">^-1</span> <span class="main">∨</span> <span class="main">(</span><span class="free">p</span><span class="main">,</span><span class="free">q</span><span class="main">)</span> <span class="main">∈</span> ov<span class="main">^-1</span> <span class="main">∨</span> <span class="main">(</span><span class="free">p</span><span class="main">,</span><span class="free">q</span><span class="main">)</span> <span class="main">∈</span> m<span class="main">^-1</span> <span class="main">∨</span> <span class="main">(</span><span class="free">p</span><span class="main">,</span><span class="free">q</span><span class="main">)</span> <span class="main">∈</span> b<span class="main">^-1</span> "</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">is</span></span> <span class="var"><span class="quoted"><span class="var">?R</span></span></span><span class="main">)</span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">k</span></span> <span class="skolem"><span class="skolem">k'</span></span> <span class="skolem"><span class="skolem">u</span></span> <span class="skolem"><span class="skolem">u'</span></span><span class="main">::</span><span class="tfree"><span class="quoted"><span class="tfree">'a</span></span></span> <span class="keyword2"><span class="keyword">where</span></span> kp<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">k</span><span class="main">∥</span><span class="free">p</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> kpq<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">k'</span><span class="main">∥</span><span class="free">q</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> pu<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="free">p</span><span class="main">∥</span><span class="skolem">u</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> qup<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="free">q</span><span class="main">∥</span><span class="skolem">u'</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> M3 meets_wd assms<span class="main">(</span>1<span class="main">,</span>2<span class="main">)</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">fastforce</span>
  <span class="keyword1"><span class="command">from</span></span> kp kpq <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">k</span><span class="main">∥</span><span class="free">q</span> <span class="main">⊕</span> <span class="main">(</span><span class="main">(</span><span class="main">∃</span><span class="bound">t</span><span class="main">.</span> <span class="skolem">k</span><span class="main">∥</span><span class="bound">t</span> <span class="main">∧</span> <span class="bound">t</span><span class="main">∥</span><span class="free">q</span><span class="main">)</span> <span class="main">⊕</span> <span class="main">(</span><span class="main">∃</span><span class="bound">t</span><span class="main">.</span> <span class="skolem">k'</span><span class="main">∥</span><span class="bound">t</span> <span class="main">∧</span> <span class="bound">t</span><span class="main">∥</span><span class="free">p</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">is</span></span> <span class="quoted"><span class="quoted">"<span class="var">?A</span> <span class="main">⊕</span> <span class="main">(</span><span class="var">?B</span> <span class="main">⊕</span> <span class="var">?C</span><span class="main">)</span>"</span></span><span class="main">)</span> <span class="keyword1"><span class="command">using</span></span> M2 <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="var">?A</span><span class="main">∧</span><span class="main">¬</span><span class="var">?B</span><span class="main">∧</span><span class="main">¬</span><span class="var">?C</span><span class="main">)</span> <span class="main">∨</span> <span class="main">(</span><span class="main">(</span><span class="main">¬</span><span class="var">?A</span><span class="main">∧</span><span class="var">?B</span><span class="main">∧</span><span class="main">¬</span><span class="var">?C</span><span class="main">)</span> <span class="main">∨</span> <span class="main">(</span><span class="main">¬</span><span class="var">?A</span><span class="main">∧</span><span class="main">¬</span><span class="var">?B</span><span class="main">∧</span><span class="var">?C</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">insert</span> xor_distr_L<span class="main"><span class="main">[</span></span><span class="operator">of</span> <span class="var"><span class="quoted"><span class="var">?A</span></span></span> <span class="var"><span class="quoted"><span class="var">?B</span></span></span> <span class="var"><span class="quoted"><span class="var">?C</span></span></span><span class="main"><span class="main">]</span></span><span class="main"><span class="keyword3">,</span></span> <span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span>elimmeets<span class="main">)</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">elim</span> disjE<span class="main">)</span>
      <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="var">?A</span><span class="main">∧</span><span class="main">¬</span><span class="var">?B</span><span class="main">∧</span><span class="main">¬</span><span class="var">?C</span>"</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> kq<span class="main">:</span><span class="var"><span class="quoted"><span class="var">?A</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
        <span class="keyword1"><span class="command">from</span></span> pu qup <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">p</span><span class="main">∥</span><span class="skolem">u'</span> <span class="main">⊕</span> <span class="main">(</span><span class="main">(</span><span class="main">∃</span><span class="bound">t'</span><span class="main">::</span><span class="tfree">'a</span><span class="main">.</span> <span class="free">p</span><span class="main">∥</span><span class="bound">t'</span> <span class="main">∧</span> <span class="bound">t'</span><span class="main">∥</span><span class="skolem">u'</span><span class="main">)</span> <span class="main">⊕</span> <span class="main">(</span><span class="main">∃</span><span class="bound">t'</span><span class="main">.</span> <span class="free">q</span><span class="main">∥</span><span class="bound">t'</span> <span class="main">∧</span> <span class="bound">t'</span><span class="main">∥</span><span class="skolem">u</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">is</span></span> <span class="quoted"><span class="quoted">"<span class="var">?A</span> <span class="main">⊕</span> <span class="main">(</span><span class="var">?B</span> <span class="main">⊕</span> <span class="var">?C</span><span class="main">)</span>"</span></span><span class="main">)</span> <span class="keyword1"><span class="command">using</span></span> M2 <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
        <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="var">?A</span><span class="main">∧</span><span class="main">¬</span><span class="var">?B</span><span class="main">∧</span><span class="main">¬</span><span class="var">?C</span><span class="main">)</span> <span class="main">∨</span> <span class="main">(</span><span class="main">(</span><span class="main">¬</span><span class="var">?A</span><span class="main">∧</span><span class="var">?B</span><span class="main">∧</span><span class="main">¬</span><span class="var">?C</span><span class="main">)</span> <span class="main">∨</span> <span class="main">(</span><span class="main">¬</span><span class="var">?A</span><span class="main">∧</span><span class="main">¬</span><span class="var">?B</span><span class="main">∧</span><span class="var">?C</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">insert</span> xor_distr_L<span class="main"><span class="main">[</span></span><span class="operator">of</span> <span class="var"><span class="quoted"><span class="var">?A</span></span></span> <span class="var"><span class="quoted"><span class="var">?B</span></span></span> <span class="var"><span class="quoted"><span class="var">?C</span></span></span><span class="main"><span class="main">]</span></span><span class="main"><span class="keyword3">,</span></span> <span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span>elimmeets<span class="main">)</span>
        <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
        <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">elim</span> disjE<span class="main">)</span>
          <span class="keyword1"><span class="command">{</span></span><span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="var">?A</span><span class="main">∧</span><span class="main">¬</span><span class="var">?B</span><span class="main">∧</span><span class="main">¬</span><span class="var">?C</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="var">?A</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
           <span class="keyword1"><span class="command">with</span></span> kp kq qup <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">p</span> <span class="main">=</span> <span class="free">q</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> M4 <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
           <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span>  e  <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span><span class="keyword1"><span class="command">}</span></span>
          <span class="keyword1"><span class="command">next</span></span>
          <span class="keyword1"><span class="command">{</span></span><span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span><span class="var">?A</span><span class="main">∧</span><span class="var">?B</span><span class="main">∧</span><span class="main">¬</span><span class="var">?C</span>"</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="var">?B</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
           <span class="keyword1"><span class="command">with</span></span> kq kp qup <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span>  s <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span><span class="keyword1"><span class="command">}</span></span>
          <span class="keyword1"><span class="command">next</span></span>
          <span class="keyword1"><span class="command">{</span></span><span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">¬</span><span class="var">?A</span><span class="main">∧</span><span class="main">¬</span><span class="var">?B</span><span class="main">∧</span><span class="var">?C</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="var">?C</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
           <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">t'</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="free">q</span><span class="main">∥</span><span class="skolem">t'</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">t'</span><span class="main">∥</span><span class="skolem">u</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
           <span class="keyword1"><span class="command">with</span></span> kq kp pu <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span>  s <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span> <span class="keyword1"><span class="command">}</span></span>
        <span class="keyword1"><span class="command">qed</span></span><span class="keyword1"><span class="command">}</span></span>
      <span class="keyword1"><span class="command">next</span></span>
      <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span><span class="var">?A</span><span class="main">∧</span><span class="var">?B</span><span class="main">∧</span><span class="main">¬</span><span class="var">?C</span>"</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="var"><span class="quoted"><span class="var">?B</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
        <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">t</span></span> <span class="keyword2"><span class="keyword">where</span></span> kt<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">k</span><span class="main">∥</span><span class="skolem">t</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> tq<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">t</span><span class="main">∥</span><span class="free">q</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword1"><span class="command">from</span></span> pu qup <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">p</span><span class="main">∥</span><span class="skolem">u'</span> <span class="main">⊕</span> <span class="main">(</span><span class="main">(</span><span class="main">∃</span><span class="bound">t'</span><span class="main">.</span> <span class="free">p</span><span class="main">∥</span><span class="bound">t'</span> <span class="main">∧</span> <span class="bound">t'</span><span class="main">∥</span><span class="skolem">u'</span><span class="main">)</span> <span class="main">⊕</span> <span class="main">(</span><span class="main">∃</span><span class="bound">t'</span><span class="main">.</span> <span class="free">q</span><span class="main">∥</span><span class="bound">t'</span> <span class="main">∧</span> <span class="bound">t'</span><span class="main">∥</span><span class="skolem">u</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">is</span></span> <span class="quoted"><span class="quoted">"<span class="var">?A</span> <span class="main">⊕</span> <span class="main">(</span><span class="var">?B</span> <span class="main">⊕</span> <span class="var">?C</span><span class="main">)</span>"</span></span><span class="main">)</span> <span class="keyword1"><span class="command">using</span></span> M2 <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
        <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="var">?A</span><span class="main">∧</span><span class="main">¬</span><span class="var">?B</span><span class="main">∧</span><span class="main">¬</span><span class="var">?C</span><span class="main">)</span> <span class="main">∨</span> <span class="main">(</span><span class="main">(</span><span class="main">¬</span><span class="var">?A</span><span class="main">∧</span><span class="var">?B</span><span class="main">∧</span><span class="main">¬</span><span class="var">?C</span><span class="main">)</span> <span class="main">∨</span> <span class="main">(</span><span class="main">¬</span><span class="var">?A</span><span class="main">∧</span><span class="main">¬</span><span class="var">?B</span><span class="main">∧</span><span class="var">?C</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">insert</span> xor_distr_L<span class="main"><span class="main">[</span></span><span class="operator">of</span> <span class="var"><span class="quoted"><span class="var">?A</span></span></span> <span class="var"><span class="quoted"><span class="var">?B</span></span></span> <span class="var"><span class="quoted"><span class="var">?C</span></span></span><span class="main"><span class="main">]</span></span><span class="main"><span class="keyword3">,</span></span> <span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span>elimmeets<span class="main">)</span>
        <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
        <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">elim</span> disjE<span class="main">)</span>
          <span class="keyword1"><span class="command">{</span></span><span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="var">?A</span><span class="main">∧</span><span class="main">¬</span><span class="var">?B</span><span class="main">∧</span><span class="main">¬</span><span class="var">?C</span>"</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="var"><span class="quoted"><span class="var">?A</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
           <span class="keyword1"><span class="command">with</span></span> kp qup kt tq <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> f  <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span><span class="keyword1"><span class="command">}</span></span>
          <span class="keyword1"><span class="command">next</span></span>
          <span class="keyword1"><span class="command">{</span></span><span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span><span class="var">?A</span><span class="main">∧</span><span class="var">?B</span><span class="main">∧</span><span class="main">¬</span><span class="var">?C</span>"</span></span>  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="var"><span class="quoted"><span class="var">?B</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
           <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">t'</span></span> <span class="keyword2"><span class="keyword">where</span></span> ptp<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="free">p</span><span class="main">∥</span><span class="skolem">t'</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> tpup<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">t'</span><span class="main">∥</span><span class="skolem">u'</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
           <span class="keyword1"><span class="command">from</span></span> pu tq  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">p</span><span class="main">∥</span><span class="free">q</span> <span class="main">⊕</span> <span class="main">(</span><span class="main">(</span><span class="main">∃</span><span class="bound">t''</span><span class="main">.</span> <span class="free">p</span><span class="main">∥</span><span class="bound">t''</span> <span class="main">∧</span> <span class="bound">t''</span><span class="main">∥</span><span class="free">q</span><span class="main">)</span> <span class="main">⊕</span> <span class="main">(</span><span class="main">∃</span><span class="bound">t''</span><span class="main">.</span> <span class="skolem">t</span><span class="main">∥</span><span class="bound">t''</span> <span class="main">∧</span> <span class="bound">t''</span><span class="main">∥</span><span class="skolem">u</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">is</span></span> <span class="quoted"><span class="quoted">"<span class="var">?A</span> <span class="main">⊕</span> <span class="main">(</span><span class="var">?B</span> <span class="main">⊕</span> <span class="var">?C</span><span class="main">)</span>"</span></span><span class="main">)</span> <span class="keyword1"><span class="command">using</span></span> M2 <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
           <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="var">?A</span><span class="main">∧</span><span class="main">¬</span><span class="var">?B</span><span class="main">∧</span><span class="main">¬</span><span class="var">?C</span><span class="main">)</span> <span class="main">∨</span> <span class="main">(</span><span class="main">(</span><span class="main">¬</span><span class="var">?A</span><span class="main">∧</span><span class="var">?B</span><span class="main">∧</span><span class="main">¬</span><span class="var">?C</span><span class="main">)</span> <span class="main">∨</span> <span class="main">(</span><span class="main">¬</span><span class="var">?A</span><span class="main">∧</span><span class="main">¬</span><span class="var">?B</span><span class="main">∧</span><span class="var">?C</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">insert</span> xor_distr_L<span class="main"><span class="main">[</span></span><span class="operator">of</span> <span class="var"><span class="quoted"><span class="var">?A</span></span></span> <span class="var"><span class="quoted"><span class="var">?B</span></span></span> <span class="var"><span class="quoted"><span class="var">?C</span></span></span><span class="main"><span class="main">]</span></span><span class="main"><span class="keyword3">,</span></span> <span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span>elimmeets<span class="main">)</span>
           <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
           <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">elim</span> disjE<span class="main">)</span>
              <span class="keyword1"><span class="command">{</span></span><span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="var">?A</span><span class="main">∧</span><span class="main">¬</span><span class="var">?B</span><span class="main">∧</span><span class="main">¬</span><span class="var">?C</span>"</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="var"><span class="quoted"><span class="var">?A</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
               <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span>  m <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span><span class="keyword1"><span class="command">}</span></span>
              <span class="keyword1"><span class="command">next</span></span>
              <span class="keyword1"><span class="command">{</span></span><span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span><span class="var">?A</span><span class="main">∧</span><span class="var">?B</span><span class="main">∧</span><span class="main">¬</span><span class="var">?C</span>"</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="var"><span class="quoted"><span class="var">?B</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
               <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span>  b <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span><span class="keyword1"><span class="command">}</span></span>
              <span class="keyword1"><span class="command">next</span></span>
              <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span><span class="var">?A</span><span class="main">∧</span><span class="main">¬</span><span class="var">?B</span><span class="main">∧</span><span class="var">?C</span>"</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="var"><span class="quoted"><span class="var">?C</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
                <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">g</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">t</span><span class="main">∥</span><span class="skolem">g</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">g</span><span class="main">∥</span><span class="skolem">u</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
                <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command"><span class="improper">with</span></span></span> pu ptp <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">g</span><span class="main">∥</span><span class="skolem">t'</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> M1 <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
                <span class="keyword1"><span class="command">ultimately</span></span>  <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span>  ov kt tq kp ptp tpup qup   <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span><span class="keyword1"><span class="command">}</span></span>
           <span class="keyword1"><span class="command">qed</span></span><span class="keyword1"><span class="command">}</span></span>
         <span class="keyword1"><span class="command">next</span></span>
          <span class="keyword1"><span class="command">{</span></span><span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span><span class="var">?A</span><span class="main">∧</span><span class="main">¬</span><span class="var">?B</span><span class="main">∧</span><span class="var">?C</span>"</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="var"><span class="quoted"><span class="var">?C</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
           <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">t'</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="free">q</span><span class="main">∥</span><span class="skolem">t'</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">t'</span><span class="main">∥</span><span class="skolem">u</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
           <span class="keyword1"><span class="command">with</span></span> kp  kt tq pu <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> d  <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span><span class="keyword1"><span class="command">}</span></span>
         <span class="keyword1"><span class="command">qed</span></span><span class="keyword1"><span class="command">}</span></span>
      <span class="keyword1"><span class="command">next</span></span>
      <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span><span class="var">?A</span><span class="main">∧</span><span class="main">¬</span><span class="var">?B</span><span class="main">∧</span><span class="var">?C</span>"</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="var"><span class="quoted"><span class="var">?C</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
        <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">t</span></span> <span class="keyword2"><span class="keyword">where</span></span> kpt<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">k'</span><span class="main">∥</span><span class="skolem">t</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> tp<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">t</span><span class="main">∥</span><span class="free">p</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword1"><span class="command">from</span></span>  pu qup <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">p</span><span class="main">∥</span><span class="skolem">u'</span> <span class="main">⊕</span> <span class="main">(</span><span class="main">(</span><span class="main">∃</span><span class="bound">t'</span><span class="main">.</span> <span class="free">p</span><span class="main">∥</span><span class="bound">t'</span> <span class="main">∧</span> <span class="bound">t'</span><span class="main">∥</span><span class="skolem">u'</span><span class="main">)</span> <span class="main">⊕</span> <span class="main">(</span><span class="main">∃</span><span class="bound">t'</span><span class="main">.</span> <span class="free">q</span><span class="main">∥</span><span class="bound">t'</span> <span class="main">∧</span> <span class="bound">t'</span><span class="main">∥</span><span class="skolem">u</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">is</span></span> <span class="quoted"><span class="quoted">"<span class="var">?A</span> <span class="main">⊕</span> <span class="main">(</span><span class="var">?B</span> <span class="main">⊕</span> <span class="var">?C</span><span class="main">)</span>"</span></span><span class="main">)</span> <span class="keyword1"><span class="command">using</span></span> M2 <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
        <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="var">?A</span><span class="main">∧</span><span class="main">¬</span><span class="var">?B</span><span class="main">∧</span><span class="main">¬</span><span class="var">?C</span><span class="main">)</span> <span class="main">∨</span> <span class="main">(</span><span class="main">(</span><span class="main">¬</span><span class="var">?A</span><span class="main">∧</span><span class="var">?B</span><span class="main">∧</span><span class="main">¬</span><span class="var">?C</span><span class="main">)</span> <span class="main">∨</span> <span class="main">(</span><span class="main">¬</span><span class="var">?A</span><span class="main">∧</span><span class="main">¬</span><span class="var">?B</span><span class="main">∧</span><span class="var">?C</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">insert</span> xor_distr_L<span class="main"><span class="main">[</span></span><span class="operator">of</span> <span class="var"><span class="quoted"><span class="var">?A</span></span></span> <span class="var"><span class="quoted"><span class="var">?B</span></span></span> <span class="var"><span class="quoted"><span class="var">?C</span></span></span><span class="main"><span class="main">]</span></span><span class="main"><span class="keyword3">,</span></span> <span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span>elimmeets<span class="main">)</span>
        <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
        <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">elim</span> disjE<span class="main">)</span>
          <span class="keyword1"><span class="command">{</span></span><span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="var">?A</span><span class="main">∧</span><span class="main">¬</span><span class="var">?B</span><span class="main">∧</span><span class="main">¬</span><span class="var">?C</span>"</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="var"><span class="quoted"><span class="var">?A</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
           <span class="keyword1"><span class="command">with</span></span> qup kpt tp kpq <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span>  f <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span><span class="keyword1"><span class="command">}</span></span>
          <span class="keyword1"><span class="command">next</span></span>
          <span class="keyword1"><span class="command">{</span></span><span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span><span class="var">?A</span><span class="main">∧</span><span class="var">?B</span><span class="main">∧</span><span class="main">¬</span><span class="var">?C</span>"</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="var"><span class="quoted"><span class="var">?B</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
           <span class="keyword1"><span class="command">with</span></span> qup kpt tp kpq <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span>  d <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span><span class="keyword1"><span class="command">}</span></span>
          <span class="keyword1"><span class="command">next</span></span>
          <span class="keyword1"><span class="command">{</span></span><span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span><span class="var">?A</span><span class="main">∧</span><span class="main">¬</span><span class="var">?B</span><span class="main">∧</span><span class="var">?C</span>"</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">t'</span></span> <span class="keyword2"><span class="keyword">where</span></span> qt'<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="free">q</span><span class="main">∥</span><span class="skolem">t'</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> tpc<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">t'</span><span class="main">∥</span><span class="skolem">u</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
           <span class="keyword1"><span class="command">from</span></span> qup tp <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">q</span><span class="main">∥</span><span class="free">p</span> <span class="main">⊕</span> <span class="main">(</span><span class="main">(</span><span class="main">∃</span><span class="bound">t''</span><span class="main">.</span> <span class="free">q</span><span class="main">∥</span><span class="bound">t''</span> <span class="main">∧</span> <span class="bound">t''</span><span class="main">∥</span><span class="free">p</span><span class="main">)</span> <span class="main">⊕</span> <span class="main">(</span><span class="main">∃</span><span class="bound">t''</span><span class="main">.</span> <span class="skolem">t</span><span class="main">∥</span><span class="bound">t''</span> <span class="main">∧</span> <span class="bound">t''</span><span class="main">∥</span><span class="skolem">u'</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">is</span></span> <span class="quoted"><span class="quoted">"<span class="var">?A</span> <span class="main">⊕</span> <span class="main">(</span><span class="var">?B</span> <span class="main">⊕</span> <span class="var">?C</span><span class="main">)</span>"</span></span><span class="main">)</span> <span class="keyword1"><span class="command">using</span></span> M2 <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
           <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="var">?A</span><span class="main">∧</span><span class="main">¬</span><span class="var">?B</span><span class="main">∧</span><span class="main">¬</span><span class="var">?C</span><span class="main">)</span> <span class="main">∨</span> <span class="main">(</span><span class="main">(</span><span class="main">¬</span><span class="var">?A</span><span class="main">∧</span><span class="var">?B</span><span class="main">∧</span><span class="main">¬</span><span class="var">?C</span><span class="main">)</span> <span class="main">∨</span> <span class="main">(</span><span class="main">¬</span><span class="var">?A</span><span class="main">∧</span><span class="main">¬</span><span class="var">?B</span><span class="main">∧</span><span class="var">?C</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">insert</span> xor_distr_L<span class="main"><span class="main">[</span></span><span class="operator">of</span> <span class="var"><span class="quoted"><span class="var">?A</span></span></span> <span class="var"><span class="quoted"><span class="var">?B</span></span></span> <span class="var"><span class="quoted"><span class="var">?C</span></span></span><span class="main"><span class="main">]</span></span><span class="main"><span class="keyword3">,</span></span> <span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span>elimmeets<span class="main">)</span>
           <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
           <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">elim</span> disjE<span class="main">)</span>
              <span class="keyword1"><span class="command">{</span></span><span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="var">?A</span><span class="main">∧</span><span class="main">¬</span><span class="var">?B</span><span class="main">∧</span><span class="main">¬</span><span class="var">?C</span>"</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="var"><span class="quoted"><span class="var">?A</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
               <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span>  m <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span><span class="keyword1"><span class="command">}</span></span>
              <span class="keyword1"><span class="command">next</span></span>
              <span class="keyword1"><span class="command">{</span></span><span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span><span class="var">?A</span><span class="main">∧</span><span class="var">?B</span><span class="main">∧</span><span class="main">¬</span><span class="var">?C</span>"</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="var"><span class="quoted"><span class="var">?B</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
               <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span>  b <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span><span class="keyword1"><span class="command">}</span></span>
              <span class="keyword1"><span class="command">next</span></span>
              <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span><span class="var">?A</span><span class="main">∧</span><span class="main">¬</span><span class="var">?B</span><span class="main">∧</span><span class="var">?C</span>"</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">g</span></span> <span class="keyword2"><span class="keyword">where</span></span> tg<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">t</span><span class="main">∥</span><span class="skolem">g</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">g</span><span class="main">∥</span><span class="skolem">u'</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
                <span class="keyword1"><span class="command">with</span></span> qup qt' <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">g</span><span class="main">∥</span><span class="skolem">t'</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> M1 <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
                <span class="keyword1"><span class="command">with</span></span> qt' tpc pu kpq kpt tp tg <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span>  ov <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span><span class="keyword1"><span class="command">}</span></span>
          <span class="keyword1"><span class="command">qed</span></span><span class="keyword1"><span class="command">}</span></span>
     <span class="keyword1"><span class="command">qed</span></span><span class="keyword1"><span class="command">}</span></span>
 <span class="keyword1"><span class="command">qed</span></span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> arelations<span class="main">)</span> JE<span class="main">:</span>
<span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"ℐ <span class="free">p</span>"</span></span> <span class="quoted"><span class="quoted">"ℐ <span class="free">q</span>"</span></span> 
<span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">p</span><span class="main">::</span><span class="tfree">'a</span><span class="main">,</span><span class="free">q</span><span class="main">::</span><span class="tfree">'a</span><span class="main">)</span> <span class="main">∈</span> b <span class="main">∪</span> m  <span class="main">∪</span> ov  <span class="main">∪</span> s <span class="main">∪</span> d <span class="main">∪</span> f<span class="main">^-1</span> <span class="main">∪</span> e <span class="main">∪</span> f  <span class="main">∪</span> s<span class="main">^-1</span>  <span class="main">∪</span> d<span class="main">^-1</span> <span class="main">∪</span> ov<span class="main">^-1</span> <span class="main">∪</span> m<span class="main">^-1</span>  <span class="main">∪</span> b<span class="main">^-1</span> "</span></span>
<span class="keyword1"><span class="command">using</span></span> jointly_exhaustive UnCI assms<span class="main">(</span>1<span class="main">,</span>2<span class="main">)</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>


<span class="keyword2"><span class="keyword">end</span></span>
</pre>
</div><div id="examples">
<div class="head">
<h1>Theory examples</h1>
</div>
<pre class="source"><span class="comment1">(*
Title:  Allen's Interval Algebra 
Author:  Fadoua Ghourabi (fadouaghourabi@gmail.com)
Affiliation: Ochanomizu University, Japan
*)</span>


<span class="keyword1"><span class="command">theory</span></span> examples


<span class="keyword2"><span class="keyword">imports</span></span>

  <a href="disjoint_relations.html">disjoint_relations</a>

<span class="keyword2"><span class="keyword">begin</span></span>

<span class="keyword1"><span class="command">section</span></span> <span class="quoted"><span class="plain_text">‹Examples›</span></span>
<span class="keyword1"><span class="command">subsection</span></span> <span class="quoted"><span class="plain_text">‹Compositions of non-basic relations›</span></span>
<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹Basic relations are the 13 time interval relations. The unions of basic relations are also relations and their compositions is the union of compositions.
We prove few of these compositions that are required in theory nest.thy.›</span></span>

<span class="keyword1"><span class="command">method</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> arelations<span class="main">)</span> e_compose <span class="main">=</span> <span class="main">(</span><span class="operator">match</span> <span class="keyword2"><span class="keyword"><span class="quasi_keyword">conclusion</span></span></span> <span class="keyword2"><span class="keyword"><span class="quasi_keyword">in</span></span></span> <span class="quoted"><span class="quoted">"e <span class="keyword1">O</span> b <span class="main">⊆</span> <span class="main">_</span>"</span></span>   <span class="main"><span class="main">⇒</span></span> <span class="quoted">‹<span class="operator">insert</span> ceb<span class="keyword3">,</span> <span class="operator">blast</span>›</span>  
                                      <span class="main"><span class="main">¦</span></span> <span class="quoted"><span class="main">_</span></span> <span class="main"><span class="main">⇒</span></span> <span class="quoted">‹<span class="operator">match</span> <span class="quasi_keyword">conclusion</span> <span class="quasi_keyword">in</span> <span class="quoted">"e <span class="keyword1">O</span> m <span class="main">⊆</span> <span class="main">_</span>"</span>  <span class="main">⇒</span> ‹<span class="operator">insert</span> cem<span class="keyword3">,</span> <span class="operator">blast</span>› <span class="main">¦</span> <span class="quoted"><span class="main">_</span></span> <span class="main">⇒</span> ‹<span class="operator">fail</span>››</span><span class="main">)</span>

<span class="keyword1"><span class="command">declare</span></span> <span class="main">[</span><span class="main">[</span><span class="operator">simp_trace_depth_limit</span><span class="main"><span class="main">=</span></span>4<span class="main">]</span><span class="main">]</span> 

<span class="keyword1"><span class="command">lemma</span></span> eovisidifmifiOm<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="main">(</span>e <span class="main">∪</span>  ov<span class="main">¯</span> <span class="main">∪</span> s<span class="main">¯</span> <span class="main">∪</span> d<span class="main">¯</span> <span class="main">∪</span> f <span class="main">∪</span> m<span class="main">¯</span> <span class="main">∪</span> f<span class="main">^-1</span><span class="main">)</span> <span class="keyword1">O</span> m <span class="main">⊆</span> m <span class="main">∪</span> ov <span class="main">∪</span> f<span class="main">^-1</span> <span class="main">∪</span> d<span class="main">^-1</span> <span class="main">∪</span> s <span class="main">∪</span> s<span class="main">¯</span> <span class="main">∪</span> e"</span></span> 
<span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">simp</span><span class="main"><span class="keyword3">,</span></span> <span class="operator">intro</span> conjI<span class="main">)</span>
  <span class="keyword1"><span class="command">using</span></span> cem <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="operator">blast</span>
    <span class="keyword1"><span class="command">using</span></span> <span class="dynamic"><span class="dynamic">crm_rules</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
 

<span class="keyword1"><span class="command">lemma</span></span> ovsmfidiesiOmi<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="main">(</span>ov <span class="main">∪</span> s<span class="main">∪</span> m  <span class="main">∪</span> f<span class="main">^-1</span> <span class="main">∪</span> d<span class="main">^-1</span> <span class="main">∪</span> e <span class="main">∪</span> s<span class="main">^-1</span><span class="main">)</span> <span class="keyword1">O</span> m<span class="main">^-1</span> <span class="main">⊆</span> d<span class="main">^-1</span> <span class="main">∪</span> s<span class="main">^-1</span> <span class="main">∪</span>  ov<span class="main">^-1</span> <span class="main">∪</span> m<span class="main">^-1</span> <span class="main">∪</span> f<span class="main">^-1</span> <span class="main">∪</span> f <span class="main">∪</span> e "</span></span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">simp</span><span class="main"><span class="keyword3">,</span></span> <span class="operator">intro</span> conjI<span class="main">)</span>
  <span class="keyword1"><span class="command">using</span></span> <span class="dynamic"><span class="dynamic">crmi_rules</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
 

<span class="keyword1"><span class="command">lemma</span></span> ovsmfidiesiOm<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="main">(</span>ov <span class="main">∪</span> s <span class="main">∪</span> m <span class="main">∪</span> f<span class="main">¯</span> <span class="main">∪</span> d<span class="main">¯</span> <span class="main">∪</span> e <span class="main">∪</span> s<span class="main">¯</span><span class="main">)</span> <span class="keyword1">O</span> m <span class="main">⊆</span> b <span class="main">∪</span> ov <span class="main">∪</span> f<span class="main">^-1</span> <span class="main">∪</span> d<span class="main">^-1</span> <span class="main">∪</span> m "</span></span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">simp</span><span class="main"><span class="keyword3">,</span></span> <span class="operator">intro</span> conjI<span class="main">)</span>
  <span class="keyword1"><span class="command">using</span></span> <span class="dynamic"><span class="dynamic">crm_rules</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  

<span class="keyword1"><span class="command">lemma</span></span> ovsmfidiesiOssie<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="main">(</span>ov <span class="main">∪</span> s <span class="main">∪</span> m <span class="main">∪</span> f<span class="main">¯</span> <span class="main">∪</span> d<span class="main">¯</span> <span class="main">∪</span> e <span class="main">∪</span> s<span class="main">¯</span><span class="main">)</span> <span class="keyword1">O</span> <span class="main">(</span>s <span class="main">∪</span> s<span class="main">^-1</span> <span class="main">∪</span> e<span class="main">)</span> <span class="main">⊆</span> ov <span class="main">∪</span> f<span class="main">^-1</span> <span class="main">∪</span> d<span class="main">^-1</span> <span class="main">∪</span> s <span class="main">∪</span> e <span class="main">∪</span> s<span class="main">^-1</span> <span class="main">∪</span> m "</span></span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">simp</span><span class="main"><span class="keyword3">,</span></span> <span class="operator">intro</span> conjI<span class="main">)</span>
  <span class="keyword1"><span class="command">using</span></span> <span class="dynamic"><span class="dynamic">crs_rules</span></span> <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="operator">auto</span><span class="main"><span class="keyword3">[</span></span>7<span class="main"><span class="keyword3">]</span></span>
    <span class="keyword1"><span class="command">using</span></span> <span class="dynamic"><span class="dynamic">crsi_rules</span></span> <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="operator">auto</span><span class="main"><span class="keyword3">[</span></span>7<span class="main"><span class="keyword3">]</span></span>
      <span class="keyword1"><span class="command">using</span></span> <span class="dynamic"><span class="dynamic">cre_rules</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span><span class="main"><span class="keyword3">[</span></span>7<span class="main"><span class="keyword3">]</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="quoted"><span class="quoted">" <span class="main">(</span>b <span class="main">∪</span> m <span class="main">∪</span> ov <span class="main">∪</span> s <span class="main">∪</span> d<span class="main">)</span> <span class="keyword1">O</span> <span class="main">(</span>b <span class="main">∪</span> m <span class="main">∪</span> ov <span class="main">∪</span> s <span class="main">∪</span> d<span class="main">)</span> <span class="main">⊆</span>  b <span class="main">∪</span> m <span class="main">∪</span> ov <span class="main">∪</span> s <span class="main">∪</span> d"</span></span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">simp</span><span class="main"><span class="keyword3">,</span></span> <span class="operator">intro</span> conjI<span class="main">)</span>
 <span class="keyword1"><span class="command">using</span></span> <span class="dynamic"><span class="dynamic">crb_rules</span></span> <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="operator">auto</span><span class="main"><span class="keyword3">[</span></span>5<span class="main"><span class="keyword3">]</span></span>
  <span class="keyword1"><span class="command">using</span></span> <span class="dynamic"><span class="dynamic">crm_rules</span></span> <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="operator">auto</span><span class="main"><span class="keyword3">[</span></span>5<span class="main"><span class="keyword3">]</span></span>
    <span class="keyword1"><span class="command">using</span></span> <span class="dynamic"><span class="dynamic">crov_rules</span></span> <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="operator">auto</span><span class="main"><span class="keyword3">[</span></span>5<span class="main"><span class="keyword3">]</span></span>
      <span class="keyword1"><span class="command">using</span></span> <span class="dynamic"><span class="dynamic">crs_rules</span></span> <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="operator">auto</span><span class="main"><span class="keyword3">[</span></span>5<span class="main"><span class="keyword3">]</span></span>
        <span class="keyword1"><span class="command">using</span></span> <span class="dynamic"><span class="dynamic">crd_rules</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span><span class="main"><span class="keyword3">[</span></span>5<span class="main"><span class="keyword3">]</span></span>

<span class="keyword1"><span class="command">lemma</span></span> ebmovovissifsiddib<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="main">(</span>e <span class="main">∪</span> b <span class="main">∪</span> m <span class="main">∪</span> ov <span class="main">∪</span> ov<span class="main">¯</span> <span class="main">∪</span> s <span class="main">∪</span> s<span class="main">¯</span> <span class="main">∪</span> f <span class="main">∪</span> f<span class="main">¯</span> <span class="main">∪</span> d <span class="main">∪</span> d<span class="main">¯</span><span class="main">)</span> <span class="keyword1">O</span> b <span class="main">⊆</span> b <span class="main">∪</span> m <span class="main">∪</span> ov <span class="main">∪</span> f<span class="main">^-1</span> <span class="main">∪</span> d<span class="main">^-1</span>"</span></span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">simp</span><span class="main"><span class="keyword3">,</span></span> <span class="operator">intro</span> conjI<span class="main">)</span>
   <span class="keyword1"><span class="command">using</span></span> <span class="dynamic"><span class="dynamic">crb_rules</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    

<span class="keyword1"><span class="command">lemma</span></span> ebmovovissiffiddibmovsd<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="main">(</span>e <span class="main">∪</span> b <span class="main">∪</span> m <span class="main">∪</span> ov <span class="main">∪</span> ov<span class="main">¯</span> <span class="main">∪</span> s <span class="main">∪</span> s<span class="main">¯</span> <span class="main">∪</span> f <span class="main">∪</span> f<span class="main">¯</span> <span class="main">∪</span> d <span class="main">∪</span> d<span class="main">¯</span><span class="main">)</span> <span class="keyword1">O</span> <span class="main">(</span> b <span class="main">∪</span> m <span class="main">∪</span> ov <span class="main">∪</span> s <span class="main">∪</span> d<span class="main">)</span> <span class="main">⊆</span> <span class="main">(</span>b <span class="main">∪</span> m <span class="main">∪</span> ov <span class="main">∪</span> s <span class="main">∪</span> d <span class="main">∪</span> f<span class="main">^-1</span> <span class="main">∪</span> d<span class="main">^-1</span> <span class="main">∪</span> ov<span class="main">^-1</span> <span class="main">∪</span> s<span class="main">¯</span> <span class="main">∪</span> f <span class="main">∪</span> e<span class="main">)</span> "</span></span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">simp</span><span class="main"><span class="keyword3">,</span></span> <span class="operator">intro</span> conjI<span class="main">)</span>
  <span class="keyword1"><span class="command">using</span></span> <span class="dynamic"><span class="dynamic">crb_rules</span></span> <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="operator">auto</span><span class="main"><span class="keyword3">[</span></span>11<span class="main"><span class="keyword3">]</span></span>
    <span class="keyword1"><span class="command">using</span></span> <span class="dynamic"><span class="dynamic">crm_rules</span></span> <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="operator">auto</span><span class="main"><span class="keyword3">[</span></span>11<span class="main"><span class="keyword3">]</span></span>
      <span class="keyword1"><span class="command">using</span></span> <span class="dynamic"><span class="dynamic">crov_rules</span></span> <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="operator">auto</span><span class="main"><span class="keyword3">[</span></span>11<span class="main"><span class="keyword3">]</span></span>
        <span class="keyword1"><span class="command">using</span></span> <span class="dynamic"><span class="dynamic">crs_rules</span></span> <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="operator">auto</span><span class="main"><span class="keyword3">[</span></span>11<span class="main"><span class="keyword3">]</span></span>
          <span class="keyword1"><span class="command">using</span></span> <span class="dynamic"><span class="dynamic">crd_rules</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">lemma</span></span> difimov<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="main">(</span>d<span class="main">^-1</span> <span class="main">∪</span> f<span class="main">^-1</span> <span class="main">∪</span> ov <span class="main">∪</span> e <span class="main">∪</span> f <span class="main">∪</span> m <span class="main">∪</span> b <span class="main">∪</span> s<span class="main">^-1</span> <span class="main">∪</span> s<span class="main">)</span> <span class="keyword1">O</span> <span class="main">(</span> m <span class="main">∪</span> ov <span class="main">∪</span> s <span class="main">∪</span> d <span class="main">∪</span> b <span class="main">∪</span> f<span class="main">^-1</span> <span class="main">∪</span> f <span class="main">∪</span> e<span class="main">)</span> <span class="main">⊆</span> <span class="main">(</span> e <span class="main">∪</span> b <span class="main">∪</span> m <span class="main">∪</span> ov <span class="main">∪</span> ov<span class="main">^-1</span> <span class="main">∪</span> s <span class="main">∪</span> s<span class="main">^-1</span> <span class="main">∪</span> f <span class="main">∪</span> f<span class="main">¯</span> <span class="main">∪</span> d <span class="main">∪</span> d<span class="main">¯</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">simp</span><span class="main"><span class="keyword3">,</span></span> <span class="operator">intro</span> conjI<span class="main">)</span>
  <span class="keyword1"><span class="command">using</span></span> <span class="dynamic"><span class="dynamic">crm_rules</span></span> <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="operator">auto</span><span class="main"><span class="keyword3">[</span></span>9<span class="main"><span class="keyword3">]</span></span>
    <span class="keyword1"><span class="command">using</span></span> <span class="dynamic"><span class="dynamic">crov_rules</span></span> <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="operator">auto</span><span class="main"><span class="keyword3">[</span></span>9<span class="main"><span class="keyword3">]</span></span>
      <span class="keyword1"><span class="command">using</span></span> <span class="dynamic"><span class="dynamic">crs_rules</span></span> <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="operator">auto</span><span class="main"><span class="keyword3">[</span></span>9<span class="main"><span class="keyword3">]</span></span>
        <span class="keyword1"><span class="command">using</span></span> <span class="dynamic"><span class="dynamic">crd_rules</span></span> <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="operator">auto</span><span class="main"><span class="keyword3">[</span></span>9<span class="main"><span class="keyword3">]</span></span>
          <span class="keyword1"><span class="command">using</span></span> <span class="dynamic"><span class="dynamic">crb_rules</span></span> <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="operator">auto</span><span class="main"><span class="keyword3">[</span></span>9<span class="main"><span class="keyword3">]</span></span>
            <span class="keyword1"><span class="command">using</span></span> <span class="dynamic"><span class="dynamic">crfi_rules</span></span> <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="operator">auto</span><span class="main"><span class="keyword3">[</span></span>9<span class="main"><span class="keyword3">]</span></span>
              <span class="keyword1"><span class="command">using</span></span> <span class="dynamic"><span class="dynamic">crf_rules</span></span> <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="operator">auto</span><span class="main"><span class="keyword3">[</span></span>9<span class="main"><span class="keyword3">]</span></span>
                <span class="keyword1"><span class="command">using</span></span> <span class="dynamic"><span class="dynamic">cre_rules</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">lemma</span></span> difibs<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="main">(</span>d<span class="main">¯</span> <span class="main">∪</span> f<span class="main">¯</span> <span class="main">∪</span> ov <span class="main">∪</span> e <span class="main">∪</span> f <span class="main">∪</span> m <span class="main">∪</span> b <span class="main">∪</span> s<span class="main">¯</span> <span class="main">∪</span> s<span class="main">)</span> <span class="keyword1">O</span> <span class="main">(</span>b <span class="main">∪</span> s <span class="main">∪</span> m<span class="main">)</span> <span class="main">⊆</span> <span class="main">(</span>b <span class="main">∪</span> m <span class="main">∪</span> ov <span class="main">∪</span> f<span class="main">¯</span> <span class="main">∪</span> d<span class="main">¯</span> <span class="main">∪</span> d <span class="main">∪</span> e <span class="main">∪</span> s <span class="main">∪</span> s<span class="main">¯</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">simp</span><span class="main"><span class="keyword3">,</span></span> <span class="operator">intro</span> conjI<span class="main">)</span>
  <span class="keyword1"><span class="command">using</span></span> <span class="dynamic"><span class="dynamic">crb_rules</span></span> <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="operator">auto</span><span class="main"><span class="keyword3">[</span></span>9<span class="main"><span class="keyword3">]</span></span>
    <span class="keyword1"><span class="command">using</span></span> <span class="dynamic"><span class="dynamic">crs_rules</span></span> <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="operator">auto</span><span class="main"><span class="keyword3">[</span></span>9<span class="main"><span class="keyword3">]</span></span>
      <span class="keyword1"><span class="command">using</span></span> <span class="dynamic"><span class="dynamic">crm_rules</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
     
<span class="keyword1"><span class="command">lemma</span></span> bebmovovissiffiddi<span class="main">:</span><span class="quoted"><span class="quoted">"b <span class="keyword1">O</span> <span class="main">(</span>e <span class="main">∪</span> b <span class="main">∪</span> m <span class="main">∪</span> ov <span class="main">∪</span> ov<span class="main">¯</span> <span class="main">∪</span> s <span class="main">∪</span> s<span class="main">¯</span> <span class="main">∪</span> f <span class="main">∪</span> f<span class="main">¯</span> <span class="main">∪</span> d <span class="main">∪</span> d<span class="main">¯</span><span class="main">)</span> <span class="main">⊆</span> <span class="main">(</span>b <span class="main">∪</span> m <span class="main">∪</span> ov <span class="main">∪</span> s <span class="main">∪</span> d<span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">simp</span><span class="main"><span class="keyword3">,</span></span> <span class="operator">intro</span> conjI<span class="main">)</span>
  <span class="keyword1"><span class="command">using</span></span> <span class="dynamic"><span class="dynamic">cb_rules</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span><span class="main"><span class="keyword3">[</span></span>11<span class="main"><span class="keyword3">]</span></span>

<span class="keyword1"><span class="command">lemma</span></span> ovsmfidiesi<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">(</span><span class="main">(</span>ov <span class="main">∪</span> s <span class="main">∪</span> m <span class="main">∪</span> f<span class="main">¯</span> <span class="main">∪</span> d<span class="main">¯</span> <span class="main">∪</span> e <span class="main">∪</span> s<span class="main">¯</span><span class="main">)</span> <span class="keyword1">O</span> <span class="main">(</span>ov<span class="main">^-1</span> <span class="main">∪</span> s<span class="main">^-1</span> <span class="main">∪</span> m<span class="main">^-1</span> <span class="main">∪</span> f <span class="main">∪</span> d <span class="main">∪</span> e <span class="main">∪</span> s<span class="main">)</span><span class="main">)</span> <span class="main">⊆</span> <span class="main">(</span>s <span class="main">∪</span> s<span class="main">^-1</span> <span class="main">∪</span> f <span class="main">∪</span> f<span class="main">^-1</span> <span class="main">∪</span> d <span class="main">∪</span> d<span class="main">^-1</span> <span class="main">∪</span> e <span class="main">∪</span> ov <span class="main">∪</span> ov<span class="main">^-1</span> <span class="main">∪</span> m <span class="main">∪</span> m<span class="main">^-1</span><span class="main">)</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">simp</span><span class="main"><span class="keyword3">,</span></span> <span class="operator">intro</span> conjI<span class="main">)</span>
  <span class="keyword1"><span class="command">using</span></span> <span class="dynamic"><span class="dynamic">crovi_rules</span></span> <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="operator">auto</span><span class="main"><span class="keyword3">[</span></span>7<span class="main"><span class="keyword3">]</span></span>
    <span class="keyword1"><span class="command">using</span></span> <span class="dynamic"><span class="dynamic">crsi_rules</span></span> <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="operator">auto</span><span class="main"><span class="keyword3">[</span></span>7<span class="main"><span class="keyword3">]</span></span>
      <span class="keyword1"><span class="command">using</span></span> <span class="dynamic"><span class="dynamic">crmi_rules</span></span> <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="operator">auto</span><span class="main"><span class="keyword3">[</span></span>7<span class="main"><span class="keyword3">]</span></span>
        <span class="keyword1"><span class="command">using</span></span> <span class="dynamic"><span class="dynamic">crf_rules</span></span> <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="operator">auto</span><span class="main"><span class="keyword3">[</span></span>7<span class="main"><span class="keyword3">]</span></span>
          <span class="keyword1"><span class="command">using</span></span> <span class="dynamic"><span class="dynamic">crd_rules</span></span> <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="operator">auto</span><span class="main"><span class="keyword3">[</span></span>7<span class="main"><span class="keyword3">]</span></span>
            <span class="keyword1"><span class="command">using</span></span> <span class="dynamic"><span class="dynamic">cre_rules</span></span> <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="operator">auto</span><span class="main"><span class="keyword3">[</span></span>7<span class="main"><span class="keyword3">]</span></span>  
              <span class="keyword1"><span class="command">using</span></span> <span class="dynamic"><span class="dynamic">crs_rules</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>                    

<span class="keyword1"><span class="command">lemma</span></span> piiq<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">p</span><span class="main">,</span><span class="free">i</span><span class="main">)</span> <span class="main">∈</span> ov <span class="main">∪</span> s <span class="main">∪</span> m <span class="main">∪</span> f<span class="main">¯</span> <span class="main">∪</span> d<span class="main">¯</span> <span class="main">∪</span> e <span class="main">∪</span> s<span class="main">¯</span> <span class="main">⟹</span> <span class="main">(</span><span class="free">i</span><span class="main">,</span><span class="free">q</span><span class="main">)</span> <span class="main">∈</span> ov<span class="main">^-1</span> <span class="main">∪</span> s<span class="main">^-1</span> <span class="main">∪</span> m<span class="main">^-1</span> <span class="main">∪</span> f <span class="main">∪</span> d <span class="main">∪</span> e <span class="main">∪</span> s <span class="main">⟹</span> <span class="main">(</span><span class="free">p</span><span class="main">,</span><span class="free">q</span><span class="main">)</span> <span class="main">∈</span> s <span class="main">∪</span> s<span class="main">^-1</span> <span class="main">∪</span> f <span class="main">∪</span> f<span class="main">^-1</span> <span class="main">∪</span> d <span class="main">∪</span> d<span class="main">^-1</span> <span class="main">∪</span> e <span class="main">∪</span> ov <span class="main">∪</span> ov<span class="main">^-1</span> <span class="main">∪</span> m <span class="main">∪</span> m<span class="main">^-1</span>"</span></span>     
<span class="keyword1"><span class="command">using</span></span> ovsmfidiesi relcomp.relcompI subsetCE <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>      


<span class="keyword1"><span class="command">lemma</span></span>  ceovisidiffimi_ffie<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="main">(</span>e <span class="main">∪</span> ov<span class="main">¯</span> <span class="main">∪</span> s<span class="main">¯</span> <span class="main">∪</span> d<span class="main">¯</span> <span class="main">∪</span> f <span class="main">∪</span> f<span class="main">¯</span> <span class="main">∪</span> m<span class="main">¯</span><span class="main">)</span> <span class="keyword1">O</span> <span class="main">(</span>f <span class="main">∪</span> f<span class="main">¯</span> <span class="main">∪</span> e<span class="main">)</span> <span class="main">⊆</span>  e <span class="main">∪</span> ov<span class="main">¯</span> <span class="main">∪</span> s<span class="main">¯</span> <span class="main">∪</span> d<span class="main">¯</span> <span class="main">∪</span> f <span class="main">∪</span> f<span class="main">¯</span> <span class="main">∪</span> m<span class="main">¯</span> "</span></span>    
<span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">simp</span><span class="main"><span class="keyword3">,</span></span> <span class="operator">intro</span> conjI<span class="main">)</span>
  <span class="keyword1"><span class="command">using</span></span> <span class="dynamic"><span class="dynamic">crf_rules</span></span> <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="operator">auto</span><span class="main"><span class="keyword3">[</span></span>7<span class="main"><span class="keyword3">]</span></span>
    <span class="keyword1"><span class="command">using</span></span> <span class="dynamic"><span class="dynamic">crfi_rules</span></span> <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="operator">auto</span><span class="main"><span class="keyword3">[</span></span>7<span class="main"><span class="keyword3">]</span></span>
      <span class="keyword1"><span class="command">using</span></span> <span class="dynamic"><span class="dynamic">cre_rules</span></span>  <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">lemma</span></span>  ceovisidiffimi_ffie_simp<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">p</span><span class="main">,</span><span class="free">i</span><span class="main">)</span> <span class="main">∈</span> <span class="main">(</span>e <span class="main">∪</span> ov<span class="main">¯</span> <span class="main">∪</span> s<span class="main">¯</span> <span class="main">∪</span> d<span class="main">¯</span> <span class="main">∪</span> f <span class="main">∪</span> f<span class="main">¯</span> <span class="main">∪</span> m<span class="main">¯</span><span class="main">)</span> <span class="main">⟹</span> <span class="main">(</span><span class="free">i</span><span class="main">,</span> <span class="free">q</span><span class="main">)</span> <span class="main">∈</span> <span class="main">(</span>f <span class="main">∪</span> f<span class="main">¯</span> <span class="main">∪</span> e<span class="main">)</span> <span class="main">⟹</span> <span class="main">(</span><span class="free">p</span><span class="main">,</span><span class="free">q</span><span class="main">)</span> <span class="main">∈</span> e <span class="main">∪</span> ov<span class="main">¯</span> <span class="main">∪</span> s<span class="main">¯</span> <span class="main">∪</span> d<span class="main">¯</span> <span class="main">∪</span> f <span class="main">∪</span> f<span class="main">¯</span> <span class="main">∪</span> m<span class="main">¯</span> "</span></span>    
<span class="keyword1"><span class="command">using</span></span> ceovisidiffimi_ffie relcomp.relcompI subsetCE <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>      

<span class="keyword1"><span class="command">lemma</span></span> ceovisidiffimi_fife<span class="main">:</span><span class="quoted"><span class="quoted">" <span class="main">(</span>e <span class="main">∪</span> ov<span class="main">¯</span> <span class="main">∪</span> s<span class="main">¯</span> <span class="main">∪</span> d<span class="main">¯</span> <span class="main">∪</span> f <span class="main">∪</span> f<span class="main">¯</span> <span class="main">∪</span> m<span class="main">¯</span><span class="main">)</span> <span class="keyword1">O</span> <span class="main">(</span>f<span class="main">¯</span> <span class="main">∪</span> f <span class="main">∪</span> e<span class="main">)</span>  <span class="main">⊆</span>  e <span class="main">∪</span> ov<span class="main">¯</span> <span class="main">∪</span> s<span class="main">¯</span> <span class="main">∪</span> d<span class="main">¯</span> <span class="main">∪</span> f <span class="main">∪</span> f<span class="main">¯</span> <span class="main">∪</span> m<span class="main">¯</span>"</span></span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">simp</span><span class="main"><span class="keyword3">,</span></span> <span class="operator">intro</span> conjI<span class="main">)</span>
 <span class="keyword1"><span class="command">using</span></span> cefi covifi csifi cdifi cffi  cfifi cmifi covifi csifi cdifi <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="operator">auto</span><span class="main"><span class="keyword3">[</span></span>7<span class="main"><span class="keyword3">]</span></span>
   <span class="keyword1"><span class="command">using</span></span> cef covif csif cdif cff cfif cmif <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="operator">auto</span><span class="main"><span class="keyword3">[</span></span>7<span class="main"><span class="keyword3">]</span></span>
     <span class="keyword1"><span class="command">using</span></span> cee covie csie cdie cfe cfie cmie <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span><span class="main"><span class="keyword3">[</span></span>7<span class="main"><span class="keyword3">]</span></span>
           
<span class="keyword1"><span class="command">lemma</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">x</span><span class="main">,</span> <span class="free">j</span><span class="main">)</span> <span class="main">∈</span> e <span class="main">∪</span> ov<span class="main">¯</span> <span class="main">∪</span> s<span class="main">¯</span> <span class="main">∪</span> d<span class="main">¯</span> <span class="main">∪</span> f <span class="main">∪</span> f<span class="main">¯</span> <span class="main">∪</span> m<span class="main">¯</span> <span class="main">⟹</span> <span class="main">(</span><span class="free">j</span><span class="main">,</span> <span class="free">i</span><span class="main">)</span> <span class="main">∈</span> f<span class="main">¯</span> <span class="main">∪</span> f <span class="main">∪</span> e <span class="main">⟹</span> <span class="main">(</span><span class="free">x</span><span class="main">,</span> <span class="free">i</span><span class="main">)</span> <span class="main">∈</span> e <span class="main">∪</span> ov<span class="main">¯</span> <span class="main">∪</span> s<span class="main">¯</span> <span class="main">∪</span> d<span class="main">¯</span> <span class="main">∪</span> f <span class="main">∪</span> f<span class="main">¯</span> <span class="main">∪</span> m<span class="main">¯</span>"</span></span>
<span class="keyword1"><span class="command">using</span></span> ceovisidiffimi_ffie_simp <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>

<span class="keyword1"><span class="command">lemma</span></span> m_ovsmfidiesi<span class="main">:</span><span class="quoted"><span class="quoted">"m <span class="keyword1">O</span> <span class="main">(</span>ov <span class="main">∪</span> s <span class="main">∪</span> m <span class="main">∪</span> f<span class="main">¯</span> <span class="main">∪</span> d<span class="main">¯</span> <span class="main">∪</span> e <span class="main">∪</span> s<span class="main">¯</span><span class="main">)</span> <span class="main">⊆</span> b <span class="main">∪</span> s <span class="main">∪</span> m"</span></span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">simp</span><span class="main"><span class="keyword3">,</span></span> <span class="operator">intro</span> conjI<span class="main">)</span>
 <span class="keyword1"><span class="command">using</span></span> <span class="dynamic"><span class="dynamic">cm_rules</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">lemma</span></span> ovsmfidiesi_d<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="main">(</span>ov <span class="main">∪</span> s <span class="main">∪</span> m <span class="main">∪</span> f<span class="main">¯</span> <span class="main">∪</span> d<span class="main">¯</span> <span class="main">∪</span> e <span class="main">∪</span> s<span class="main">¯</span><span class="main">)</span> <span class="keyword1">O</span> d <span class="main">⊆</span>  e <span class="main">∪</span>  s <span class="main">∪</span> d <span class="main">∪</span> ov <span class="main">∪</span> ov<span class="main">^-1</span> <span class="main">∪</span> s<span class="main">^-1</span> <span class="main">∪</span> f <span class="main">∪</span> f<span class="main">^-1</span>  <span class="main">∪</span> d<span class="main">^-1</span>"</span></span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">simp</span><span class="main"><span class="keyword3">,</span></span> <span class="operator">intro</span> conjI<span class="main">)</span>
  <span class="keyword1"><span class="command">using</span></span> <span class="dynamic"><span class="dynamic">crd_rules</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span><span class="main"><span class="keyword3">[</span></span>7<span class="main"><span class="keyword3">]</span></span>
    

<span class="keyword1"><span class="command">lemma</span></span> cbi_esdovovisiffidi<span class="main">:</span><span class="quoted"><span class="quoted">"b<span class="main">^-1</span> <span class="keyword1">O</span> <span class="main">(</span>e <span class="main">∪</span> s <span class="main">∪</span> d <span class="main">∪</span> ov <span class="main">∪</span> ov<span class="main">¯</span> <span class="main">∪</span> s<span class="main">¯</span> <span class="main">∪</span> f <span class="main">∪</span> f<span class="main">¯</span> <span class="main">∪</span> d<span class="main">¯</span><span class="main">)</span> <span class="main">⊆</span> b<span class="main">^-1</span> <span class="main">∪</span> m<span class="main">^-1</span> <span class="main">∪</span> ov<span class="main">^-1</span> <span class="main">∪</span> f <span class="main">∪</span> d "</span></span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">simp</span><span class="main"><span class="keyword3">,</span></span> <span class="operator">intro</span> conjI<span class="main">)</span>
  <span class="keyword1"><span class="command">using</span></span> <span class="dynamic"><span class="dynamic">cbi_rules</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span><span class="main"><span class="keyword3">[</span></span>9<span class="main"><span class="keyword3">]</span></span>
   
<span class="keyword1"><span class="command">lemma</span></span> cm_alpha1ialpha4mi<span class="main">:</span><span class="quoted"><span class="quoted">"m <span class="keyword1">O</span>  <span class="main">(</span>e <span class="main">∪</span> ov<span class="main">¯</span> <span class="main">∪</span> s<span class="main">¯</span> <span class="main">∪</span> d<span class="main">¯</span> <span class="main">∪</span> f <span class="main">∪</span> f<span class="main">¯</span> <span class="main">∪</span> m<span class="main">¯</span><span class="main">)</span> <span class="main">⊆</span>  m <span class="main">∪</span> ov <span class="main">∪</span> s <span class="main">∪</span> d <span class="main">∪</span> b <span class="main">∪</span> f<span class="main">^-1</span> <span class="main">∪</span> f <span class="main">∪</span> e"</span></span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">simp</span><span class="main"><span class="keyword3">,</span></span> <span class="operator">intro</span> conjI<span class="main">)</span>
<span class="keyword1"><span class="command">using</span></span> <span class="dynamic"><span class="dynamic">cm_rules</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>


<span class="keyword1"><span class="command">lemma</span></span> cbi_alpha1ialpha4mi<span class="main">:</span><span class="quoted"><span class="quoted">"b<span class="main">^-1</span> <span class="keyword1">O</span> <span class="main">(</span> e <span class="main">∪</span> ov<span class="main">¯</span> <span class="main">∪</span> s<span class="main">¯</span> <span class="main">∪</span> d<span class="main">¯</span> <span class="main">∪</span> f <span class="main">∪</span> f<span class="main">¯</span> <span class="main">∪</span> m<span class="main">¯</span><span class="main">)</span> <span class="main">⊆</span>  b<span class="main">^-1</span>"</span></span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">simp</span><span class="main"><span class="keyword3">,</span></span> <span class="operator">intro</span> conjI<span class="main">)</span>
  <span class="keyword1"><span class="command">using</span></span> <span class="dynamic"><span class="dynamic">cbi_rules</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">lemma</span></span> cbeta2_beta2<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="main">(</span> b <span class="main">∪</span> m <span class="main">∪</span> ov <span class="main">∪</span> f<span class="main">¯</span> <span class="main">∪</span> d<span class="main">¯</span><span class="main">)</span> <span class="keyword1">O</span> <span class="main">(</span> b <span class="main">∪</span> m <span class="main">∪</span> ov <span class="main">∪</span> f<span class="main">¯</span> <span class="main">∪</span> d<span class="main">¯</span><span class="main">)</span> <span class="main">⊆</span>  b <span class="main">∪</span> m <span class="main">∪</span> ov <span class="main">∪</span> f<span class="main">¯</span> <span class="main">∪</span> d<span class="main">¯</span>"</span></span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">simp</span><span class="main"><span class="keyword3">,</span></span> <span class="operator">intro</span> conjI<span class="main">)</span>
  <span class="keyword1"><span class="command">using</span></span> <span class="dynamic"><span class="dynamic">crb_rules</span></span> <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="operator">auto</span><span class="main"><span class="keyword3">[</span></span>5<span class="main"><span class="keyword3">]</span></span>
    <span class="keyword1"><span class="command">using</span></span> <span class="dynamic"><span class="dynamic">crm_rules</span></span> <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="operator">auto</span><span class="main"><span class="keyword3">[</span></span>5<span class="main"><span class="keyword3">]</span></span>
      <span class="keyword1"><span class="command">using</span></span> <span class="dynamic"><span class="dynamic">crov_rules</span></span> <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="operator">auto</span><span class="main"><span class="keyword3">[</span></span>5<span class="main"><span class="keyword3">]</span></span>
        <span class="keyword1"><span class="command">using</span></span> <span class="dynamic"><span class="dynamic">crfi_rules</span></span> <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="operator">auto</span><span class="main"><span class="keyword3">[</span></span>5<span class="main"><span class="keyword3">]</span></span>
          <span class="keyword1"><span class="command">using</span></span> <span class="dynamic"><span class="dynamic">crdi_rules</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">lemma</span></span> cbeta2_gammabm<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span>b <span class="main">∪</span> m <span class="main">∪</span> ov <span class="main">∪</span> f<span class="main">¯</span> <span class="main">∪</span> d<span class="main">¯</span><span class="main">)</span> <span class="keyword1">O</span> <span class="main">(</span> e <span class="main">∪</span> b <span class="main">∪</span> m <span class="main">∪</span> ov <span class="main">∪</span> ov<span class="main">¯</span> <span class="main">∪</span> s <span class="main">∪</span> s<span class="main">¯</span> <span class="main">∪</span> f <span class="main">∪</span> f<span class="main">¯</span> <span class="main">∪</span> d <span class="main">∪</span> d<span class="main">¯</span><span class="main">)</span> <span class="main">⊆</span> <span class="main">(</span> e <span class="main">∪</span> b <span class="main">∪</span> m <span class="main">∪</span> ov <span class="main">∪</span> ov<span class="main">¯</span> <span class="main">∪</span> s <span class="main">∪</span> s<span class="main">¯</span> <span class="main">∪</span> f <span class="main">∪</span> f<span class="main">¯</span> <span class="main">∪</span> d <span class="main">∪</span> d<span class="main">¯</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">simp</span><span class="main"><span class="keyword3">,</span></span> <span class="operator">intro</span> conjI<span class="main">)</span>
  <span class="keyword1"><span class="command">using</span></span> <span class="dynamic"><span class="dynamic">cre_rules</span></span> <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="operator">auto</span><span class="main"><span class="keyword3">[</span></span>5<span class="main"><span class="keyword3">]</span></span>
    <span class="keyword1"><span class="command">using</span></span> <span class="dynamic"><span class="dynamic">crb_rules</span></span> <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="operator">auto</span><span class="main"><span class="keyword3">[</span></span>5<span class="main"><span class="keyword3">]</span></span>
      <span class="keyword1"><span class="command">using</span></span> <span class="dynamic"><span class="dynamic">crm_rules</span></span> <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="operator">auto</span><span class="main"><span class="keyword3">[</span></span>5<span class="main"><span class="keyword3">]</span></span>
        <span class="keyword1"><span class="command">using</span></span> <span class="dynamic"><span class="dynamic">crov_rules</span></span> <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="operator">auto</span><span class="main"><span class="keyword3">[</span></span>5<span class="main"><span class="keyword3">]</span></span>
          <span class="keyword1"><span class="command">using</span></span> <span class="dynamic"><span class="dynamic">crovi_rules</span></span> <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="operator">auto</span><span class="main"><span class="keyword3">[</span></span>5<span class="main"><span class="keyword3">]</span></span>
            <span class="keyword1"><span class="command">using</span></span> <span class="dynamic"><span class="dynamic">crs_rules</span></span> <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="operator">auto</span><span class="main"><span class="keyword3">[</span></span>5<span class="main"><span class="keyword3">]</span></span>
              <span class="keyword1"><span class="command">using</span></span> <span class="dynamic"><span class="dynamic">crsi_rules</span></span> <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="operator">auto</span><span class="main"><span class="keyword3">[</span></span>5<span class="main"><span class="keyword3">]</span></span>
                <span class="keyword1"><span class="command">using</span></span> <span class="dynamic"><span class="dynamic">crf_rules</span></span> <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="operator">auto</span><span class="main"><span class="keyword3">[</span></span>5<span class="main"><span class="keyword3">]</span></span>
                  <span class="keyword1"><span class="command">using</span></span> <span class="dynamic"><span class="dynamic">crfi_rules</span></span> <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="operator">auto</span><span class="main"><span class="keyword3">[</span></span>5<span class="main"><span class="keyword3">]</span></span>
                    <span class="keyword1"><span class="command">using</span></span> <span class="dynamic"><span class="dynamic">crd_rules</span></span> <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="operator">auto</span><span class="main"><span class="keyword3">[</span></span>5<span class="main"><span class="keyword3">]</span></span>
                      <span class="keyword1"><span class="command">using</span></span> <span class="dynamic"><span class="dynamic">crdi_rules</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">lemma</span></span> calpha1_alpha1<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="main">(</span>b <span class="main">∪</span> m <span class="main">∪</span> ov <span class="main">∪</span> s <span class="main">∪</span> d<span class="main">)</span> <span class="keyword1">O</span> <span class="main">(</span> b <span class="main">∪</span> m <span class="main">∪</span> ov <span class="main">∪</span> s <span class="main">∪</span> d<span class="main">)</span> <span class="main">⊆</span> <span class="main">(</span> b <span class="main">∪</span> m <span class="main">∪</span> ov <span class="main">∪</span> s <span class="main">∪</span> d<span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">simp</span><span class="main"><span class="keyword3">,</span></span> <span class="operator">intro</span> conjI<span class="main">)</span>
  <span class="keyword1"><span class="command">using</span></span> <span class="dynamic"><span class="dynamic">crb_rules</span></span> <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="operator">auto</span><span class="main"><span class="keyword3">[</span></span>5<span class="main"><span class="keyword3">]</span></span>
    <span class="keyword1"><span class="command">using</span></span> <span class="dynamic"><span class="dynamic">crm_rules</span></span> <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="operator">auto</span><span class="main"><span class="keyword3">[</span></span>5<span class="main"><span class="keyword3">]</span></span>
      <span class="keyword1"><span class="command">using</span></span> <span class="dynamic"><span class="dynamic">crov_rules</span></span> <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="operator">auto</span><span class="main"><span class="keyword3">[</span></span>5<span class="main"><span class="keyword3">]</span></span>
        <span class="keyword1"><span class="command">using</span></span> <span class="dynamic"><span class="dynamic">crs_rules</span></span> <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="operator">auto</span><span class="main"><span class="keyword3">[</span></span>5<span class="main"><span class="keyword3">]</span></span>
          <span class="keyword1"><span class="command">using</span></span> <span class="dynamic"><span class="dynamic">crd_rules</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
   
<span class="keyword1"><span class="command">subsection</span></span> <span class="quoted"><span class="plain_text">‹Intersection of non-basic relations›</span></span>

<span class="keyword1"><span class="command">lemma</span></span>  inter_ov<span class="main">:</span>
<span class="keyword2"><span class="keyword">assumes</span></span>  <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">i</span><span class="main">,</span><span class="free">j</span><span class="main">)</span> <span class="main">∈</span>  <span class="main">(</span>b <span class="main">∪</span> m <span class="main">∪</span> ov <span class="main">∪</span> f<span class="main">¯</span> <span class="main">∪</span> d<span class="main">¯</span><span class="main">)</span> <span class="main">∩</span> <span class="main">(</span>e <span class="main">∪</span> b<span class="main">^-1</span> <span class="main">∪</span> m<span class="main">^-1</span> <span class="main">∪</span> ov<span class="main">^-1</span> <span class="main">∪</span> ov <span class="main">∪</span> s<span class="main">^-1</span> <span class="main">∪</span> s <span class="main">∪</span> f<span class="main">^-1</span> <span class="main">∪</span> f <span class="main">∪</span> d<span class="main">^-1</span> <span class="main">∪</span> d<span class="main">)</span> <span class="main">∩</span> <span class="main">(</span>b <span class="main">∪</span> m <span class="main">∪</span> ov <span class="main">∪</span> s <span class="main">∪</span> d<span class="main">)</span>"</span></span> 
<span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">i</span><span class="main">,</span><span class="free">j</span><span class="main">)</span> <span class="main">∈</span> ov"</span></span>
<span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="operator">auto</span> 
 <span class="keyword1"><span class="command">using</span></span> <span class="dynamic"><span class="dynamic">b_rules</span></span> <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="operator">auto</span><span class="main"><span class="keyword3">[</span></span>43<span class="main"><span class="keyword3">]</span></span>
  <span class="keyword1"><span class="command">using</span></span> <span class="dynamic"><span class="dynamic">e_rules</span></span> <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="operator">auto</span><span class="main"><span class="keyword3">[</span></span>9<span class="main"><span class="keyword3">]</span></span>
   <span class="keyword1"><span class="command">using</span></span> <span class="dynamic"><span class="dynamic">b_rules</span></span> <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="operator">auto</span><span class="main"><span class="keyword3">[</span></span>30<span class="main"><span class="keyword3">]</span></span>
    <span class="keyword1"><span class="command">using</span></span> <span class="dynamic"><span class="dynamic">m_rules</span></span> <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="operator">auto</span><span class="main"><span class="keyword3">[</span></span>24<span class="main"><span class="keyword3">]</span></span>
     <span class="keyword1"><span class="command">using</span></span> <span class="dynamic"><span class="dynamic">b_rules</span></span> <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="operator">auto</span><span class="main"><span class="keyword3">[</span></span>6<span class="main"><span class="keyword3">]</span></span>
      <span class="keyword1"><span class="command">using</span></span> <span class="dynamic"><span class="dynamic">m_rules</span></span> <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="operator">auto</span><span class="main"><span class="keyword3">[</span></span>20<span class="main"><span class="keyword3">]</span></span>
       <span class="keyword1"><span class="command">using</span></span> <span class="dynamic"><span class="dynamic">f_rules</span></span> <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="operator">auto</span><span class="main"><span class="keyword3">[</span></span>14<span class="main"><span class="keyword3">]</span></span>
        <span class="keyword1"><span class="command">using</span></span> <span class="dynamic"><span class="dynamic">d_rules</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">lemma</span></span> neq_beta2i_alpha2alpha5m<span class="main">:</span>
<span class="keyword2"><span class="keyword">assumes</span></span>  <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">q</span><span class="main">,</span> <span class="free">j</span><span class="main">)</span> <span class="main">∈</span> b<span class="main">¯</span> <span class="main">∪</span> d <span class="main">∪</span> f <span class="main">∪</span> ov<span class="main">¯</span> <span class="main">∪</span> m<span class="main">¯</span> "</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">" <span class="main">(</span><span class="free">q</span><span class="main">,</span> <span class="free">j</span><span class="main">)</span> <span class="main">∈</span> ov <span class="main">∪</span> s <span class="main">∪</span> m <span class="main">∪</span> f<span class="main">¯</span> <span class="main">∪</span> d<span class="main">¯</span> <span class="main">∪</span> e <span class="main">∪</span> s<span class="main">¯</span>"</span></span> 
<span class="keyword2"><span class="keyword">shows</span></span>  <span class="quoted">False</span>
<span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">using</span></span> <span class="dynamic"><span class="dynamic">b_rules</span></span> <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="operator">auto</span><span class="main"><span class="keyword3">[</span></span>7<span class="main"><span class="keyword3">]</span></span>
    <span class="keyword1"><span class="command">using</span></span> <span class="dynamic"><span class="dynamic">ov_rules</span></span> <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="operator">auto</span><span class="main"><span class="keyword3">[</span></span>4<span class="main"><span class="keyword3">]</span></span>
      <span class="keyword1"><span class="command">using</span></span> <span class="dynamic"><span class="dynamic">d_rules</span></span> <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="operator">auto</span><span class="main"><span class="keyword3">[</span></span>6<span class="main"><span class="keyword3">]</span></span>
        <span class="keyword1"><span class="command">using</span></span> <span class="dynamic"><span class="dynamic">s_rules</span></span> <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="operator">auto</span><span class="main"><span class="keyword3">[</span></span>3<span class="main"><span class="keyword3">]</span></span>
          <span class="keyword1"><span class="command">using</span></span> <span class="dynamic"><span class="dynamic">f_rules</span></span> <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="operator">auto</span><span class="main"><span class="keyword3">[</span></span>5<span class="main"><span class="keyword3">]</span></span>
            <span class="keyword1"><span class="command">using</span></span> <span class="dynamic"><span class="dynamic">m_rules</span></span> <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="operator">auto</span><span class="main"><span class="keyword3">[</span></span>2<span class="main"><span class="keyword3">]</span></span>
              <span class="keyword1"><span class="command">using</span></span> <span class="dynamic"><span class="dynamic">ov_rules</span></span> <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="operator">auto</span><span class="main"><span class="keyword3">[</span></span>4<span class="main"><span class="keyword3">]</span></span>
                <span class="keyword1"><span class="command">using</span></span> <span class="dynamic"><span class="dynamic">m_rules</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">lemma</span></span> neq_bi_alpha1ialpha4mi<span class="main">:</span>
<span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">q</span><span class="main">,</span><span class="free">i</span><span class="main">)</span> <span class="main">∈</span> b<span class="main">^-1</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">" <span class="main">(</span><span class="free">q</span><span class="main">,</span> <span class="free">i</span><span class="main">)</span> <span class="main">∈</span> e <span class="main">∪</span> ov<span class="main">¯</span> <span class="main">∪</span> s<span class="main">¯</span> <span class="main">∪</span> d<span class="main">¯</span> <span class="main">∪</span> f <span class="main">∪</span> f<span class="main">¯</span> <span class="main">∪</span> m<span class="main">¯</span>"</span></span>
<span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted">False</span>
<span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">using</span></span> <span class="dynamic"><span class="dynamic">b_rules</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>


<span class="keyword2"><span class="keyword">end</span></span>
</pre>
</div><div id="nest">
<div class="head">
<h1>Theory nest</h1>
</div>
<pre class="source"><span class="comment1">(*
Title:  Allen's qualitative temporal calculus
Author:  Fadoua Ghourabi (fadouaghourabi@gmail.com)
Affiliation: Ochanomizu University, Japan
*)</span>


<span class="keyword1"><span class="command">theory</span></span> nest

<span class="keyword2"><span class="keyword">imports</span></span> 
    <a href="../../HOL/HOL/Main.html">Main</a>  <a href="jointly_exhaustive.html">jointly_exhaustive</a> <a href="examples.html">examples</a>
    <span class="quoted">"<a href="../../HOL/HOL-Eisbach/Eisbach_Tools.html">HOL-Eisbach.Eisbach_Tools</a>"</span>

<span class="keyword2"><span class="keyword">begin</span></span>

<span class="keyword1"><span class="command">section</span></span> <span class="quoted"><span class="plain_text">‹Nests›</span></span>
<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹Nests are sets of intervals that share a meeting point. We define relation before between nests that give the ordering properties of points.›</span></span>

<span class="keyword1"><span class="command">subsection</span></span> <span class="quoted"><span class="plain_text">‹Definitions›</span></span>

<span class="keyword1"><span class="command">type_synonym</span></span> <span class="tfree">'a</span> nest <span class="main">=</span> <span class="quoted"><span class="quoted">"<span class="tfree">'a</span> set"</span></span>

<span class="keyword1"><span class="command">definition</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> arelations<span class="main">)</span> <span class="entity">BEGIN</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'a</span> <span class="main">⇒</span> <span class="tfree">'a</span> nest"</span></span> 
<span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="free">BEGIN</span> <span class="free"><span class="bound"><span class="entity">i</span></span></span>  <span class="main">=</span> <span class="main">{</span><span class="bound">j</span> <span class="main">|</span> <span class="bound">j</span><span class="main">.</span> <span class="main">(</span><span class="bound">j</span><span class="main">,</span><span class="free"><span class="bound"><span class="entity">i</span></span></span><span class="main">)</span> <span class="main">∈</span> ov <span class="main">∪</span> s <span class="main">∪</span> m <span class="main">∪</span> f<span class="main">^-1</span> <span class="main">∪</span> d<span class="main">^-1</span> <span class="main">∪</span> e <span class="main">∪</span> s<span class="main">^-1</span><span class="main">}</span>"</span></span>

<span class="keyword1"><span class="command">definition</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> arelations<span class="main">)</span> <span class="entity">END</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'a</span> <span class="main">⇒</span> <span class="tfree">'a</span> nest"</span></span> 
<span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="free">END</span> <span class="free"><span class="bound"><span class="entity">i</span></span></span>  <span class="main">=</span> <span class="main">{</span><span class="bound">j</span> <span class="main">|</span> <span class="bound">j</span><span class="main">.</span> <span class="main">(</span><span class="bound">j</span><span class="main">,</span><span class="free"><span class="bound"><span class="entity">i</span></span></span><span class="main">)</span> <span class="main">∈</span> e <span class="main">∪</span> ov<span class="main">^-1</span> <span class="main">∪</span> s<span class="main">^-1</span> <span class="main">∪</span> d<span class="main">^-1</span> <span class="main">∪</span> f <span class="main">∪</span> f<span class="main">^-1</span> <span class="main">∪</span> m<span class="main">^-1</span><span class="main">}</span>"</span></span>

<span class="keyword1"><span class="command">definition</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> arelations<span class="main">)</span> <span class="entity">NEST</span> <span class="main">::</span><span class="quoted"><span class="quoted">"<span class="tfree">'a</span> nest <span class="main">⇒</span> bool"</span></span>
<span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="free">NEST</span> <span class="free"><span class="bound"><span class="entity">S</span></span></span> <span class="main">≡</span> <span class="main">∃</span><span class="bound">i</span><span class="main">.</span> ℐ <span class="bound">i</span> <span class="main">∧</span> <span class="main">(</span><span class="free"><span class="bound"><span class="entity">S</span></span></span> <span class="main">=</span> BEGIN <span class="bound">i</span> <span class="main">∨</span> <span class="free"><span class="bound"><span class="entity">S</span></span></span> <span class="main">=</span> END <span class="bound">i</span><span class="main">)</span>"</span></span>

<span class="keyword1"><span class="command">definition</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> arelations<span class="main">)</span> <span class="entity">before</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'a</span> nest <span class="main">⇒</span> <span class="tfree">'a</span> nest <span class="main">⇒</span> bool"</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">infix</span></span> <span class="quoted">"<span class="keyword1">≪</span>"</span> 100<span class="main">)</span>
<span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="free">before</span> <span class="free"><span class="bound"><span class="entity">N</span></span></span> <span class="free"><span class="bound"><span class="entity">M</span></span></span> <span class="main">≡</span> NEST <span class="free"><span class="bound"><span class="entity">N</span></span></span> <span class="main">∧</span> NEST <span class="free"><span class="bound"><span class="entity">M</span></span></span> <span class="main">∧</span> <span class="main">(</span><span class="main">∃</span><span class="bound">n</span> <span class="bound">m</span><span class="main">.</span> <span class="comment1">⌦‹ℐ m ∧ ℐ n ∧›</span> <span class="bound">n</span> <span class="main">∈</span> <span class="free"><span class="bound"><span class="entity">N</span></span></span> <span class="main">∧</span> <span class="bound">m</span> <span class="main">∈</span> <span class="free"><span class="bound"><span class="entity">M</span></span></span> <span class="main">∧</span> <span class="main">(</span><span class="bound">n</span><span class="main">,</span><span class="bound">m</span><span class="main">)</span> <span class="main">∈</span> b<span class="main">)</span>"</span></span>

<span class="keyword1"><span class="command">subsection</span></span> <span class="quoted"><span class="plain_text">‹Properties of Nests›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> intv1<span class="main">:</span>
<span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"ℐ <span class="free">i</span>"</span></span> 
<span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">i</span> <span class="main">∈</span> BEGIN <span class="free">i</span>"</span></span>
<span class="keyword1"><span class="command">unfolding</span></span> BEGIN_def
<span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span>e assms<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> intv2<span class="main">:</span>
<span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"ℐ <span class="free">i</span>"</span></span> 
<span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">i</span> <span class="main">∈</span> END <span class="free">i</span>"</span></span>
<span class="keyword1"><span class="command">unfolding</span></span> END_def
<span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> e assms<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> NEST_nonempty<span class="main">:</span>
<span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"NEST <span class="free">S</span>"</span></span>
<span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">S</span> <span class="main">≠</span> <span class="main">{}</span>"</span></span> 
<span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">unfolding</span></span> NEST_def 
<span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">insert</span> intv1 intv2<span class="main"><span class="keyword3">,</span></span> <span class="operator">auto</span><span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> NEST_BEGIN<span class="main">:</span>
<span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"ℐ <span class="free">i</span>"</span></span> 
<span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"NEST <span class="main">(</span>BEGIN <span class="free">i</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">using</span></span> NEST_def assms <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">lemma</span></span> NEST_END<span class="main">:</span>
<span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"ℐ <span class="free">i</span>"</span></span> 
<span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"NEST <span class="main">(</span>END <span class="free">i</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">using</span></span> NEST_def assms <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">lemma</span></span> before<span class="main">:</span>
<span class="keyword2"><span class="keyword">assumes</span></span> a<span class="main">:</span><span class="quoted"><span class="quoted">"ℐ <span class="free">i</span>"</span></span> 
<span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"BEGIN <span class="free">i</span> <span class="main">≪</span> END <span class="free">i</span>"</span></span> 
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  
    <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">p</span></span> <span class="keyword2"><span class="keyword">where</span></span> pi<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">p</span><span class="main">,</span><span class="free">i</span><span class="main">)</span> <span class="main">∈</span> m"</span></span>
    <span class="keyword1"><span class="command">using</span></span>  a M3 m <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> p<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">p</span> <span class="main">∈</span> BEGIN <span class="free">i</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> BEGIN_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

    <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">q</span></span> <span class="keyword2"><span class="keyword">where</span></span> qi<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">q</span><span class="main">,</span><span class="free">i</span><span class="main">)</span> <span class="main">∈</span> m<span class="main">^-1</span>"</span></span> 
    <span class="keyword1"><span class="command">using</span></span> a M3 m <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> q<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">q</span> <span class="main">∈</span> END <span class="free">i</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> END_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

    <span class="keyword1"><span class="command">from</span></span> pi qi <span class="keyword1"><span class="command">have</span></span> c1<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">p</span><span class="main">,</span><span class="skolem">q</span><span class="main">)</span> <span class="main">∈</span> b"</span></span> <span class="keyword1"><span class="command">using</span></span> b  m
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span> 

    <span class="keyword1"><span class="command">with</span></span>  c1 p q assms <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span>NEST_def  before_def<span class="main">)</span>

<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">lemma</span></span>  meets<span class="main">:</span>
<span class="keyword2"><span class="keyword">fixes</span></span> <span class="free">i</span> <span class="free">j</span>
 <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"ℐ <span class="free">i</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"ℐ <span class="free">j</span>"</span></span> 
<span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">i</span><span class="main">,</span><span class="free">j</span><span class="main">)</span> <span class="main">∈</span> m <span class="main">=</span> <span class="main">(</span><span class="main">(</span>END <span class="free">i</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span>BEGIN <span class="free">j</span><span class="main">)</span><span class="main">)</span>"</span></span> 
<span class="keyword1"><span class="command">proof</span></span> 
  <span class="keyword3"><span class="command">assume</span></span> ij<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">i</span><span class="main">,</span><span class="free">j</span><span class="main">)</span> <span class="main">∈</span> m"</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> ibj<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="free">i</span> <span class="main">∈</span> <span class="main">(</span>BEGIN <span class="free">j</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> BEGIN_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">from</span></span> ij <span class="keyword1"><span class="command">have</span></span> ji<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">j</span><span class="main">,</span><span class="free">i</span><span class="main">)</span> <span class="main">∈</span> m<span class="main">^-1</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> jeo<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="free">j</span> <span class="main">∈</span> <span class="main">(</span>END <span class="free">i</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> END_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">(</span>END <span class="free">i</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span>BEGIN <span class="free">j</span><span class="main">)</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> 
      <span class="keyword1"><span class="command">{</span></span><span class="keyword3"><span class="command">fix</span></span> <span class="skolem">x</span><span class="main">::</span><span class="quoted"><span class="quoted">"<span class="tfree">'a</span>"</span></span> <span class="keyword3"><span class="command">assume</span></span> a<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">∈</span> <span class="main">(</span>END <span class="free">i</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> asimp<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">x</span><span class="main">,</span><span class="free">i</span><span class="main">)</span> <span class="main">∈</span> e <span class="main">∪</span>  ov<span class="main">¯</span> <span class="main">∪</span> s<span class="main">¯</span> <span class="main">∪</span> d<span class="main">¯</span> <span class="main">∪</span> f <span class="main">∪</span> m<span class="main">¯</span> <span class="main">∪</span> f<span class="main">^-1</span>"</span></span>
      <span class="keyword1"><span class="command">unfolding</span></span> END_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">∈</span> <span class="main">(</span>BEGIN <span class="free">j</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> ij eovisidifmifiOm
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span>BEGIN_def<span class="main">)</span>     
      <span class="keyword1"><span class="command">}</span></span>
      <span class="keyword3"><span class="command">thus</span></span> conc1<span class="main">:</span><span class="quoted"><span class="quoted">"END <span class="free">i</span> <span class="main">⊆</span> BEGIN <span class="free">j</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
   <span class="keyword1"><span class="command">next</span></span>
     <span class="keyword1"><span class="command">{</span></span><span class="keyword3"><span class="command">fix</span></span> <span class="skolem">x</span> <span class="keyword3"><span class="command">assume</span></span> b<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">∈</span> <span class="main">(</span>BEGIN <span class="free">j</span><span class="main">)</span>"</span></span>
     <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> bsimp<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">x</span><span class="main">,</span><span class="free">j</span><span class="main">)</span> <span class="main">∈</span> ov <span class="main">∪</span> s<span class="main">∪</span> m  <span class="main">∪</span> f<span class="main">^-1</span> <span class="main">∪</span> d<span class="main">^-1</span> <span class="main">∪</span> e <span class="main">∪</span> s<span class="main">^-1</span>"</span></span>
     <span class="keyword1"><span class="command">unfolding</span></span> BEGIN_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
     <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">∈</span> <span class="main">(</span>END <span class="free">i</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> ij ovsmfidiesiOmi
     <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span>END_def<span class="main">)</span>
     <span class="keyword1"><span class="command">}</span></span><span class="keyword3"><span class="command">thus</span></span> conc2<span class="main">:</span><span class="quoted"><span class="quoted">"BEGIN <span class="free">j</span> <span class="main">⊆</span> END <span class="free">i</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">qed</span></span>
<span class="keyword1"><span class="command">next</span></span>
  <span class="keyword3"><span class="command">assume</span></span> a0<span class="main">:</span><span class="quoted"><span class="quoted">"END <span class="main">(</span><span class="free">i</span><span class="main">::</span><span class="tfree">'a</span><span class="main">)</span> <span class="main">=</span> BEGIN <span class="main">(</span><span class="free">j</span><span class="main">::</span><span class="tfree">'a</span><span class="main">)</span>"</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">i</span><span class="main">,</span><span class="free">j</span><span class="main">)</span> <span class="main">∈</span> m"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">rule</span> ccontr<span class="main">)</span>
     <span class="keyword3"><span class="command">assume</span></span> a<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">i</span><span class="main">,</span><span class="free">j</span><span class="main">)</span> <span class="main">∉</span> m"</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span><span class="free">i</span><span class="main">∥</span><span class="free">j</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> m <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
     <span class="keyword1"><span class="command">from</span></span> a <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">i</span><span class="main">,</span><span class="free">j</span><span class="main">)</span> <span class="main">∈</span> b  <span class="main">∪</span> ov  <span class="main">∪</span> s <span class="main">∪</span> d <span class="main">∪</span> f<span class="main">^-1</span> <span class="main">∪</span> e <span class="main">∪</span> f  <span class="main">∪</span> s<span class="main">^-1</span>  <span class="main">∪</span> d<span class="main">^-1</span> <span class="main">∪</span> ov<span class="main">^-1</span> <span class="main">∪</span> m<span class="main">^-1</span>  <span class="main">∪</span> b<span class="main">^-1</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms JE <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
     <span class="keyword3"><span class="command">thus</span></span> <span class="quoted">False</span>
     <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">auto</span><span class="main">)</span>
       <span class="keyword1"><span class="command">{</span></span><span class="keyword3"><span class="command">assume</span></span> ij<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">i</span><span class="main">,</span><span class="free">j</span><span class="main">)</span> <span class="main">∈</span> e"</span></span> 
        <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">p</span></span> <span class="keyword2"><span class="keyword">where</span></span> ip<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="free">i</span><span class="main">∥</span><span class="skolem">p</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> M3 assms<span class="main">(</span>1<span class="main">)</span>  <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword1"><span class="command">then</span></span>  <span class="keyword1"><span class="command">have</span></span> pi<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">p</span><span class="main">,</span><span class="free">i</span><span class="main">)</span><span class="main">∈</span> m<span class="main">^-1</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> m <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">p</span> <span class="main">∈</span> END <span class="free">i</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> END_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword1"><span class="command">with</span></span> a0 <span class="keyword1"><span class="command">have</span></span> pj<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">p</span> <span class="main">∈</span> <span class="main">(</span>BEGIN <span class="free">j</span><span class="main">)</span> "</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword1"><span class="command">from</span></span> ij pi <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">p</span><span class="main">,</span><span class="free">j</span><span class="main">)</span> <span class="main">∈</span> m<span class="main">^-1</span>"</span></span>  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> e<span class="main">)</span>
        <span class="keyword1"><span class="command">with</span></span> pj <span class="keyword3"><span class="command">show</span></span>   <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
        <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span>BEGIN_def<span class="main">)</span>
        <span class="keyword1"><span class="command">using</span></span> <span class="dynamic"><span class="dynamic">m_rules</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span><span class="main"><span class="keyword3">[</span></span>7<span class="main"><span class="keyword3">]</span></span> <span class="keyword1"><span class="command">}</span></span>
       <span class="keyword1"><span class="command">next</span></span>
       <span class="keyword1"><span class="command">{</span></span><span class="keyword3"><span class="command">assume</span></span> ij<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">j</span><span class="main">,</span><span class="free">i</span><span class="main">)</span> <span class="main">∈</span> m"</span></span> 
        <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">p</span></span> <span class="keyword2"><span class="keyword">where</span></span> ip<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="free">i</span><span class="main">∥</span><span class="skolem">p</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> M3  assms<span class="main">(</span>1<span class="main">)</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword1"><span class="command">then</span></span>  <span class="keyword1"><span class="command">have</span></span> pi<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">p</span><span class="main">,</span><span class="free">i</span><span class="main">)</span><span class="main">∈</span> m<span class="main">^-1</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> m <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">p</span> <span class="main">∈</span> END <span class="free">i</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> END_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword1"><span class="command">with</span></span> a0 <span class="keyword1"><span class="command">have</span></span> pj<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">p</span> <span class="main">∈</span> <span class="main">(</span>BEGIN <span class="free">j</span><span class="main">)</span> "</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword1"><span class="command">from</span></span> ij <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">i</span><span class="main">,</span><span class="free">j</span><span class="main">)</span> <span class="main">∈</span> m<span class="main">^-1</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
        <span class="keyword1"><span class="command">with</span></span>  pi <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">p</span><span class="main">,</span><span class="free">j</span><span class="main">)</span> <span class="main">∈</span> b<span class="main">^-1</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> cmimi  <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword1"><span class="command">with</span></span> pj <span class="keyword3"><span class="command">show</span></span>   <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
        <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span>BEGIN_def<span class="main">)</span>
          <span class="keyword1"><span class="command">using</span></span> <span class="dynamic"><span class="dynamic">b_rules</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword1"><span class="command">}</span></span>

       <span class="keyword1"><span class="command">next</span></span> 

       <span class="keyword1"><span class="command">{</span></span><span class="keyword3"><span class="command">assume</span></span> ij<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">i</span><span class="main">,</span><span class="free">j</span><span class="main">)</span><span class="main">∈</span> b"</span></span>
        <span class="keyword1"><span class="command">have</span></span> ii<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">i</span><span class="main">,</span><span class="free">i</span><span class="main">)</span><span class="main">∈</span>e"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">i</span> <span class="main">∈</span> END <span class="free">i</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms  intv2 e <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword1"><span class="command">with</span></span> a0 <span class="keyword1"><span class="command">have</span></span> j<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="free">i</span> <span class="main">∈</span> BEGIN <span class="free">j</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
        <span class="keyword1"><span class="command">with</span></span> ij  <span class="keyword3"><span class="command">show</span></span>   <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> 
        <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span>BEGIN_def<span class="main">)</span>
          <span class="keyword1"><span class="command">using</span></span> <span class="dynamic"><span class="dynamic">b_rules</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
         <span class="keyword1"><span class="command">}</span></span>
       
        <span class="keyword1"><span class="command">next</span></span> 

        <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">assume</span></span> ji<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">j</span><span class="main">,</span><span class="free">i</span><span class="main">)</span> <span class="main">∈</span> b"</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> ij<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">i</span><span class="main">,</span><span class="free">j</span><span class="main">)</span> <span class="main">∈</span> b<span class="main">^-1</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
          <span class="keyword1"><span class="command">have</span></span> ii<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">i</span><span class="main">,</span><span class="free">i</span><span class="main">)</span><span class="main">∈</span>e"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">i</span> <span class="main">∈</span> END <span class="free">i</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms intv2 e <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
          <span class="keyword1"><span class="command">with</span></span> a0 <span class="keyword1"><span class="command">have</span></span> j<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="free">i</span> <span class="main">∈</span> BEGIN <span class="free">j</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
          <span class="keyword1"><span class="command">with</span></span> ij  <span class="keyword3"><span class="command">show</span></span>   <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> 
          <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span>BEGIN_def<span class="main">)</span>
            <span class="keyword1"><span class="command">using</span></span> <span class="dynamic"><span class="dynamic">b_rules</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span><span class="keyword1"><span class="command">}</span></span>
        
        <span class="keyword1"><span class="command">next</span></span>

        <span class="keyword1"><span class="command">{</span></span><span class="keyword3"><span class="command">assume</span></span> ij<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">i</span><span class="main">,</span><span class="free">j</span><span class="main">)</span><span class="main">∈</span>ov"</span></span>
         <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">u</span></span> <span class="skolem"><span class="skolem">v</span></span><span class="main">::</span><span class="quoted"><span class="quoted">"<span class="tfree">'a</span>"</span></span> <span class="keyword2"><span class="keyword">where</span></span> iu<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="free">i</span><span class="main">∥</span><span class="skolem">u</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> uv<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">u</span><span class="main">∥</span><span class="skolem">v</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> uv<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">u</span><span class="main">∥</span><span class="skolem">v</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> ov <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
         <span class="keyword1"><span class="command">from</span></span> iu <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">u</span> <span class="main">∈</span> END <span class="free">i</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> m END_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
         <span class="keyword1"><span class="command">with</span></span> a0 <span class="keyword1"><span class="command">have</span></span> u<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">u</span> <span class="main">∈</span> BEGIN <span class="free">j</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
         <span class="keyword1"><span class="command">from</span></span> iu <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">u</span><span class="main">,</span><span class="free">i</span><span class="main">)</span> <span class="main">∈</span> m<span class="main">^-1</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> m <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
         <span class="keyword1"><span class="command">with</span></span> ij <span class="keyword1"><span class="command">have</span></span> uj<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">u</span><span class="main">,</span><span class="free">j</span><span class="main">)</span> <span class="main">∈</span> ov<span class="main">^-1</span> <span class="main">∪</span> d <span class="main">∪</span> f"</span></span> <span class="keyword1"><span class="command">using</span></span> covim <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
         <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> u uj 
         <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span>BEGIN_def<span class="main">)</span>
           <span class="keyword1"><span class="command">using</span></span> <span class="dynamic"><span class="dynamic">ov_rules</span></span> eovi <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="operator">auto</span><span class="main"><span class="keyword3">[</span></span>9<span class="main"><span class="keyword3">]</span></span>
            <span class="keyword1"><span class="command">using</span></span> <span class="dynamic"><span class="dynamic">s_rules</span></span> <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="operator">auto</span><span class="main"><span class="keyword3">[</span></span>2<span class="main"><span class="keyword3">]</span></span>
              <span class="keyword1"><span class="command">using</span></span> <span class="dynamic"><span class="dynamic">d_rules</span></span> <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="operator">auto</span><span class="main"><span class="keyword3">[</span></span>5<span class="main"><span class="keyword3">]</span></span>
                <span class="keyword1"><span class="command">using</span></span> <span class="dynamic"><span class="dynamic">f_rules</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span><span class="main"><span class="keyword3">[</span></span>5<span class="main"><span class="keyword3">]</span></span>
        <span class="keyword1"><span class="command">}</span></span>

        <span class="keyword1"><span class="command">next</span></span> 
        
        <span class="keyword1"><span class="command">{</span></span><span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">j</span><span class="main">,</span><span class="free">i</span><span class="main">)</span> <span class="main">∈</span> ov"</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span>  ij<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">i</span><span class="main">,</span><span class="free">j</span><span class="main">)</span><span class="main">∈</span>ov<span class="main">^-1</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span> <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?p</span></span></span> <span class="main">=</span> <span class="quoted"><span class="free">i</span></span> 
        <span class="keyword1"><span class="command">from</span></span> ij <span class="keyword1"><span class="command">have</span></span> pi<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="main">(</span><span class="var">?p</span><span class="main">,</span> <span class="free">i</span><span class="main">)</span> <span class="main">∈</span> e"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span>e<span class="main">)</span>
        <span class="keyword1"><span class="command">from</span></span> ij <span class="keyword1"><span class="command">have</span></span> pj<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="main">(</span><span class="var">?p</span><span class="main">,</span><span class="free">j</span><span class="main">)</span> <span class="main">∈</span> ov<span class="main">^-1</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
        <span class="keyword1"><span class="command">from</span></span> pi <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="var">?p</span> <span class="main">∈</span> END <span class="free">i</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> END_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword1"><span class="command">with</span></span> a0 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="var">?p</span> <span class="main">∈</span> <span class="main">(</span>BEGIN <span class="free">j</span><span class="main">)</span> "</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword1"><span class="command">with</span></span> pj <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> 
        <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span>BEGIN_def<span class="main">)</span>
          <span class="keyword1"><span class="command">using</span></span> <span class="dynamic"><span class="dynamic">ov_rules</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword1"><span class="command">}</span></span>
        <span class="keyword1"><span class="command">next</span></span>
        <span class="keyword1"><span class="command">{</span></span><span class="keyword3"><span class="command">assume</span></span> ij<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">i</span><span class="main">,</span><span class="free">j</span><span class="main">)</span> <span class="main">∈</span> s"</span></span> 
         <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">p</span></span> <span class="skolem"><span class="skolem">q</span></span> <span class="skolem"><span class="skolem">t</span></span> <span class="keyword2"><span class="keyword">where</span></span> ip<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="free">i</span><span class="main">∥</span><span class="skolem">p</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> pq<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">p</span><span class="main">∥</span><span class="skolem">q</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span>  jq<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="free">j</span><span class="main">∥</span><span class="skolem">q</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> ti<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">t</span><span class="main">∥</span><span class="free">i</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> tj<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">t</span><span class="main">∥</span><span class="free">j</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> s <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
         <span class="keyword1"><span class="command">from</span></span> ip <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">p</span><span class="main">,</span><span class="free">i</span><span class="main">)</span> <span class="main">∈</span> m<span class="main">^-1</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> m <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
         <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">p</span> <span class="main">∈</span> END <span class="free">i</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> END_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
         <span class="keyword1"><span class="command">with</span></span> a0 <span class="keyword1"><span class="command">have</span></span> p<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">p</span> <span class="main">∈</span> BEGIN <span class="free">j</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
         <span class="keyword1"><span class="command">from</span></span> ti ip pq tj jq <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">p</span><span class="main">,</span><span class="free">j</span><span class="main">)</span> <span class="main">∈</span> f"</span></span> <span class="keyword1"><span class="command">using</span></span> f <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
         <span class="keyword1"><span class="command">with</span></span> p <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> 
         <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span>BEGIN_def<span class="main">)</span>
           <span class="keyword1"><span class="command">using</span></span> <span class="dynamic"><span class="dynamic">f_rules</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
            
         <span class="keyword1"><span class="command">}</span></span>
         <span class="keyword1"><span class="command">next</span></span>
         <span class="keyword1"><span class="command">{</span></span><span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">j</span><span class="main">,</span><span class="free">i</span><span class="main">)</span> <span class="main">∈</span> s"</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span>  ij<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">i</span><span class="main">,</span><span class="free">j</span><span class="main">)</span> <span class="main">∈</span> s<span class="main">^-1</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
          <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">u</span></span> <span class="skolem"><span class="skolem">v</span></span> <span class="keyword2"><span class="keyword">where</span></span> ju<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="free">j</span><span class="main">∥</span><span class="skolem">u</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> uv<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">u</span><span class="main">∥</span><span class="skolem">v</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> iv<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="free">i</span><span class="main">∥</span><span class="skolem">v</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> s <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
          <span class="keyword1"><span class="command">from</span></span> iv <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">v</span><span class="main">,</span><span class="free">i</span><span class="main">)</span> <span class="main">∈</span> m<span class="main">^-1</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> m <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
          <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">v</span> <span class="main">∈</span> END <span class="free">i</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> END_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
          <span class="keyword1"><span class="command">with</span></span> a0 <span class="keyword1"><span class="command">have</span></span> v<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">v</span> <span class="main">∈</span> BEGIN <span class="free">j</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
          <span class="keyword1"><span class="command">from</span></span> ju uv <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">v</span><span class="main">,</span><span class="free">j</span><span class="main">)</span> <span class="main">∈</span> b<span class="main">^-1</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> b <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
          <span class="keyword1"><span class="command">with</span></span> v <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> 
          <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span>BEGIN_def<span class="main">)</span>
            <span class="keyword1"><span class="command">using</span></span> <span class="dynamic"><span class="dynamic">b_rules</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span><span class="keyword1"><span class="command">}</span></span>
         <span class="keyword1"><span class="command">next</span></span>
         <span class="keyword1"><span class="command">{</span></span><span class="keyword3"><span class="command">assume</span></span> ij<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">i</span><span class="main">,</span><span class="free">j</span><span class="main">)</span> <span class="main">∈</span> f"</span></span>
          <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">i</span><span class="main">,</span><span class="free">i</span><span class="main">)</span> <span class="main">∈</span> e"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">i</span> <span class="main">∈</span> END <span class="free">i</span>"</span></span> 
          <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> e<span class="main">)</span>  <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> assms intv2 <span class="main">)</span>
          <span class="keyword1"><span class="command">with</span></span> a0 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">i</span> <span class="main">∈</span> BEGIN <span class="free">j</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
          <span class="keyword1"><span class="command">with</span></span> ij <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> 
          <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span>BEGIN_def<span class="main">)</span>
           <span class="keyword1"><span class="command">using</span></span> <span class="dynamic"><span class="dynamic">f_rules</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span> 
         <span class="keyword1"><span class="command">}</span></span>
         <span class="keyword1"><span class="command">next</span></span>
         <span class="keyword1"><span class="command">{</span></span><span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">j</span><span class="main">,</span><span class="free">i</span><span class="main">)</span> <span class="main">∈</span> f"</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">i</span><span class="main">,</span><span class="free">j</span><span class="main">)</span><span class="main">∈</span>f<span class="main">^-1</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
          <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">u</span></span> <span class="keyword2"><span class="keyword">where</span></span> ju<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="free">j</span><span class="main">∥</span><span class="skolem">u</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> iu<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="free">i</span><span class="main">∥</span><span class="skolem">u</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> f <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
          <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> ui<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">u</span><span class="main">,</span><span class="free">i</span><span class="main">)</span> <span class="main">∈</span> m<span class="main">^-1</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">u</span> <span class="main">∈</span> END <span class="free">i</span>"</span></span>  
          <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> converse.intros m<span class="main">)</span>
          <span class="keyword1"><span class="command">using</span></span> END_def iu m <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
          <span class="keyword1"><span class="command">with</span></span> a0 <span class="keyword1"><span class="command">have</span></span> ubj<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">u</span> <span class="main">∈</span> BEGIN <span class="free">j</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
          <span class="keyword1"><span class="command">from</span></span> ju <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">u</span><span class="main">,</span><span class="free">j</span><span class="main">)</span> <span class="main">∈</span> m<span class="main">^-1</span>"</span></span>  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> converse.intros m<span class="main">)</span>
          <span class="keyword1"><span class="command">with</span></span> ubj <span class="keyword3"><span class="command">show</span></span>  <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> 
          <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span>BEGIN_def<span class="main">)</span>
            <span class="keyword1"><span class="command">using</span></span> <span class="dynamic"><span class="dynamic">m_rules</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
         <span class="keyword1"><span class="command">}</span></span>
         <span class="keyword1"><span class="command">next</span></span>
         <span class="keyword1"><span class="command">{</span></span><span class="keyword3"><span class="command">assume</span></span> ij<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">i</span><span class="main">,</span><span class="free">j</span><span class="main">)</span> <span class="main">∈</span> d"</span></span> <span class="keyword1"><span class="command">then</span></span> 
          <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">i</span><span class="main">,</span><span class="free">i</span><span class="main">)</span> <span class="main">∈</span> e"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">i</span> <span class="main">∈</span> END <span class="free">i</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms e <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">blast</span><span class="main"><span class="keyword3">,</span></span> <span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span>  intv2<span class="main">)</span>
          <span class="keyword1"><span class="command">with</span></span> a0 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">i</span> <span class="main">∈</span> BEGIN <span class="free">j</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
          <span class="keyword1"><span class="command">with</span></span> ij <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> 
          <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span>BEGIN_def<span class="main">)</span>
            <span class="keyword1"><span class="command">using</span></span> <span class="dynamic"><span class="dynamic">d_rules</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span><span class="keyword1"><span class="command">}</span></span>
          <span class="keyword1"><span class="command">next</span></span>
          <span class="keyword1"><span class="command">{</span></span><span class="keyword3"><span class="command">assume</span></span> ji<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">j</span><span class="main">,</span><span class="free">i</span><span class="main">)</span> <span class="main">∈</span> d"</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">i</span><span class="main">,</span><span class="free">j</span><span class="main">)</span> <span class="main">∈</span> d<span class="main">^-1</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> d <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
           <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">u</span></span> <span class="skolem"><span class="skolem">v</span></span> <span class="keyword2"><span class="keyword">where</span></span> ju<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="free">j</span><span class="main">∥</span><span class="skolem">u</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> uv<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">u</span><span class="main">∥</span><span class="skolem">v</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> iv<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="free">i</span><span class="main">∥</span><span class="skolem">v</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> d <span class="keyword1"><span class="command">using</span></span> ji <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
           <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">v</span><span class="main">,</span><span class="free">i</span><span class="main">)</span> <span class="main">∈</span> m<span class="main">^-1</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">v</span> <span class="main">∈</span> END <span class="free">i</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> m END_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
           <span class="keyword1"><span class="command">with</span></span> a0 ju uv <span class="keyword1"><span class="command">have</span></span>  vj<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">v</span><span class="main">,</span><span class="free">j</span><span class="main">)</span> <span class="main">∈</span> b<span class="main">^-1</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span>  <span class="quoted"><span class="quoted">"<span class="skolem">v</span> <span class="main">∈</span> BEGIN <span class="free">j</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> b <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
           <span class="keyword1"><span class="command">with</span></span> vj <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> 
           <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span>BEGIN_def<span class="main">)</span>
             <span class="keyword1"><span class="command">using</span></span> <span class="dynamic"><span class="dynamic">b_rules</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span><span class="keyword1"><span class="command">}</span></span>
          
        <span class="keyword1"><span class="command">qed</span></span>
    <span class="keyword1"><span class="command">qed</span></span>
<span class="keyword1"><span class="command">qed</span></span>


<span class="keyword1"><span class="command">lemma</span></span> starts<span class="main">:</span>
<span class="keyword2"><span class="keyword">fixes</span></span> <span class="free">i</span> <span class="free">j</span>
<span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"ℐ <span class="free">i</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"ℐ <span class="free">j</span>"</span></span> 
<span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">(</span><span class="free">i</span><span class="main">,</span><span class="free">j</span><span class="main">)</span> <span class="main">∈</span> s <span class="main">∪</span> s<span class="main">^-1</span> <span class="main">∪</span> e<span class="main">)</span> <span class="main">=</span> <span class="main">(</span>BEGIN <span class="free">i</span> <span class="main">=</span> BEGIN <span class="free">j</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> 
   <span class="keyword3"><span class="command">assume</span></span> a3<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">i</span><span class="main">,</span><span class="free">j</span><span class="main">)</span> <span class="main">∈</span> s <span class="main">∪</span> s<span class="main">^-1</span> <span class="main">∪</span> e"</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"BEGIN <span class="free">i</span> <span class="main">=</span> BEGIN <span class="free">j</span>"</span></span>
   <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
    <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">x</span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">∈</span> BEGIN <span class="free">i</span>"</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">x</span><span class="main">,</span><span class="free">i</span><span class="main">)</span> <span class="main">∈</span> ov <span class="main">∪</span> s <span class="main">∪</span> m <span class="main">∪</span> f<span class="main">¯</span> <span class="main">∪</span> d<span class="main">¯</span> <span class="main">∪</span> e <span class="main">∪</span> s<span class="main">¯</span>"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> BEGIN_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">∈</span> BEGIN <span class="free">j</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> a3 ovsmfidiesiOssie
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span>BEGIN_def<span class="main">)</span>
    <span class="keyword1"><span class="command">}</span></span> <span class="keyword1"><span class="command">note</span></span> c1 <span class="main">=</span> this

    <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">x</span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">∈</span> BEGIN <span class="free">j</span>"</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> xj<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">x</span><span class="main">,</span><span class="free">j</span><span class="main">)</span> <span class="main">∈</span> ov <span class="main">∪</span> s <span class="main">∪</span> m <span class="main">∪</span> f<span class="main">¯</span> <span class="main">∪</span> d<span class="main">¯</span> <span class="main">∪</span> e <span class="main">∪</span> s<span class="main">¯</span>"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> BEGIN_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">∈</span> BEGIN <span class="free">i</span>"</span></span> 
    <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">insert</span> converseI<span class="main"><span class="main">[</span></span><span class="operator">OF</span> a3<span class="main"><span class="main">]</span></span> xj<span class="main">)</span>
    <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">subst</span> <span class="main"><span class="main">(</span></span><span class="quasi_keyword">asm</span><span class="main"><span class="main">)</span></span> converse_Un<span class="main">)</span><span class="main"><span class="keyword3">+</span></span>
    <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">subst</span> <span class="main"><span class="main">(</span></span><span class="quasi_keyword">asm</span><span class="main"><span class="main">)</span></span> converse_converse<span class="main">)</span>
    <span class="keyword1"><span class="command">using</span></span> ovsmfidiesiOssie  
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span>BEGIN_def<span class="main">)</span>
    <span class="keyword1"><span class="command">}</span></span> <span class="keyword1"><span class="command">note</span></span> c2 <span class="main">=</span> this

    <span class="keyword1"><span class="command">from</span></span> c1 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"BEGIN <span class="free">i</span> <span class="main">⊆</span> BEGIN <span class="free">j</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command"><span class="improper">with</span></span></span> c2 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"BEGIN <span class="free">j</span> <span class="main">⊆</span> BEGIN <span class="free">i</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>  
 <span class="keyword1"><span class="command">qed</span></span>
<span class="keyword1"><span class="command">next</span></span>
   <span class="keyword3"><span class="command">assume</span></span> a4<span class="main">:</span><span class="quoted"><span class="quoted">"BEGIN <span class="free">i</span> <span class="main">=</span> BEGIN <span class="free">j</span>"</span></span>
   <span class="keyword1"><span class="command">with</span></span> assms <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">i</span> <span class="main">∈</span> BEGIN <span class="free">j</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">j</span> <span class="main">∈</span> BEGIN <span class="free">i</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> intv1 <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
   <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> ij<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">i</span><span class="main">,</span><span class="free">j</span><span class="main">)</span> <span class="main">∈</span> ov <span class="main">∪</span> s <span class="main">∪</span> m <span class="main">∪</span> f<span class="main">^-1</span> <span class="main">∪</span> d<span class="main">^-1</span> <span class="main">∪</span> e <span class="main">∪</span> s<span class="main">^-1</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> ji<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">j</span><span class="main">,</span><span class="free">i</span><span class="main">)</span> <span class="main">∈</span>  ov <span class="main">∪</span> s <span class="main">∪</span> m <span class="main">∪</span> f<span class="main">^-1</span> <span class="main">∪</span> d<span class="main">^-1</span> <span class="main">∪</span> e <span class="main">∪</span> s<span class="main">^-1</span>"</span></span>
   <span class="keyword1"><span class="command">unfolding</span></span> BEGIN_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
   <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> ijov<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">i</span><span class="main">,</span><span class="free">j</span><span class="main">)</span> <span class="main">∉</span> ov"</span></span>  
    <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">using</span></span> <span class="dynamic"><span class="dynamic">ov_rules</span></span>  <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
   
   <span class="keyword1"><span class="command">from</span></span> ij ji <span class="keyword1"><span class="command">have</span></span> ijm<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">i</span><span class="main">,</span><span class="free">j</span><span class="main">)</span> <span class="main">∉</span> m"</span></span>  
   <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">simp_all</span><span class="main"><span class="keyword3">,</span></span> <span class="operator">elim</span> disjE<span class="main"><span class="keyword3">,</span></span> <span class="operator">simp_all</span><span class="main">)</span>
    <span class="keyword1"><span class="command">using</span></span> <span class="dynamic"><span class="dynamic">ov_rules</span></span> <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="operator">auto</span><span class="main"><span class="keyword3">[</span></span>13<span class="main"><span class="keyword3">]</span></span>
      <span class="keyword1"><span class="command">using</span></span> <span class="dynamic"><span class="dynamic">s_rules</span></span> <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="operator">auto</span><span class="main"><span class="keyword3">[</span></span>11<span class="main"><span class="keyword3">]</span></span>
        <span class="keyword1"><span class="command">using</span></span> <span class="dynamic"><span class="dynamic">m_rules</span></span> <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="operator">auto</span><span class="main"><span class="keyword3">[</span></span>9<span class="main"><span class="keyword3">]</span></span>
          <span class="keyword1"><span class="command">using</span></span> <span class="dynamic"><span class="dynamic">f_rules</span></span> <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="operator">auto</span><span class="main"><span class="keyword3">[</span></span>7<span class="main"><span class="keyword3">]</span></span>
            <span class="keyword1"><span class="command">using</span></span> <span class="dynamic"><span class="dynamic">d_rules</span></span> <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="operator">auto</span><span class="main"><span class="keyword3">[</span></span>5<span class="main"><span class="keyword3">]</span></span>
              <span class="keyword1"><span class="command">using</span></span> <span class="dynamic"><span class="dynamic">m_rules</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span><span class="main"><span class="keyword3">[</span></span>4<span class="main"><span class="keyword3">]</span></span>

   <span class="keyword1"><span class="command">from</span></span> ij ji <span class="keyword1"><span class="command">have</span></span>  ijfi<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">i</span><span class="main">,</span><span class="free">j</span><span class="main">)</span> <span class="main">∉</span> f<span class="main">^-1</span>"</span></span>  
   <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">simp_all</span><span class="main"><span class="keyword3">,</span></span> <span class="operator">elim</span> disjE<span class="main"><span class="keyword3">,</span></span> <span class="operator">simp_all</span><span class="main">)</span>
    <span class="keyword1"><span class="command">using</span></span> <span class="dynamic"><span class="dynamic">ov_rules</span></span> <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="operator">auto</span><span class="main"><span class="keyword3">[</span></span>13<span class="main"><span class="keyword3">]</span></span>
     <span class="keyword1"><span class="command">using</span></span> <span class="dynamic"><span class="dynamic">s_rules</span></span> <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="operator">auto</span><span class="main"><span class="keyword3">[</span></span>11<span class="main"><span class="keyword3">]</span></span>
      <span class="keyword1"><span class="command">using</span></span> <span class="dynamic"><span class="dynamic">m_rules</span></span> <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="operator">auto</span><span class="main"><span class="keyword3">[</span></span>9<span class="main"><span class="keyword3">]</span></span>
          <span class="keyword1"><span class="command">using</span></span> <span class="dynamic"><span class="dynamic">f_rules</span></span> <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="operator">auto</span><span class="main"><span class="keyword3">[</span></span>7<span class="main"><span class="keyword3">]</span></span>
            <span class="keyword1"><span class="command">using</span></span> <span class="dynamic"><span class="dynamic">d_rules</span></span> <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="operator">auto</span><span class="main"><span class="keyword3">[</span></span>5<span class="main"><span class="keyword3">]</span></span>
              <span class="keyword1"><span class="command">using</span></span> <span class="dynamic"><span class="dynamic">f_rules</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span><span class="main"><span class="keyword3">[</span></span>4<span class="main"><span class="keyword3">]</span></span>

   <span class="keyword1"><span class="command">from</span></span> ij ji <span class="keyword1"><span class="command">have</span></span>  ijdi<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">i</span><span class="main">,</span><span class="free">j</span><span class="main">)</span> <span class="main">∉</span> d<span class="main">^-1</span>"</span></span>  
   <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">simp_all</span><span class="main"><span class="keyword3">,</span></span> <span class="operator">elim</span> disjE<span class="main"><span class="keyword3">,</span></span> <span class="operator">simp_all</span><span class="main">)</span>
    <span class="keyword1"><span class="command">using</span></span> <span class="dynamic"><span class="dynamic">ov_rules</span></span> <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="operator">auto</span><span class="main"><span class="keyword3">[</span></span>13<span class="main"><span class="keyword3">]</span></span>
     <span class="keyword1"><span class="command">using</span></span> <span class="dynamic"><span class="dynamic">s_rules</span></span> <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="operator">auto</span><span class="main"><span class="keyword3">[</span></span>11<span class="main"><span class="keyword3">]</span></span>
      <span class="keyword1"><span class="command">using</span></span> <span class="dynamic"><span class="dynamic">m_rules</span></span> <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="operator">auto</span><span class="main"><span class="keyword3">[</span></span>9<span class="main"><span class="keyword3">]</span></span>
          <span class="keyword1"><span class="command">using</span></span> <span class="dynamic"><span class="dynamic">f_rules</span></span> <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="operator">auto</span><span class="main"><span class="keyword3">[</span></span>7<span class="main"><span class="keyword3">]</span></span>
            <span class="keyword1"><span class="command">using</span></span> <span class="dynamic"><span class="dynamic">d_rules</span></span> <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="operator">auto</span><span class="main"><span class="keyword3">[</span></span>5<span class="main"><span class="keyword3">]</span></span>
              <span class="keyword1"><span class="command">using</span></span> <span class="dynamic"><span class="dynamic">d_rules</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span><span class="main"><span class="keyword3">[</span></span>4<span class="main"><span class="keyword3">]</span></span>

   <span class="keyword1"><span class="command">from</span></span> ij ijm ijov ijfi ijdi <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">i</span><span class="main">,</span> <span class="free">j</span><span class="main">)</span> <span class="main">∈</span> s <span class="main">∪</span> s<span class="main">¯</span> <span class="main">∪</span> e"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span> 

<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">lemma</span></span> xj_set<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main">∈</span> <span class="main">{</span><span class="bound">a</span> <span class="main">|</span><span class="bound">a</span><span class="main">.</span> <span class="main">(</span><span class="bound">a</span><span class="main">,</span> <span class="free">j</span><span class="main">)</span> <span class="main">∈</span> e <span class="main">∪</span> ov<span class="main">¯</span> <span class="main">∪</span> s<span class="main">¯</span> <span class="main">∪</span> d<span class="main">¯</span> <span class="main">∪</span> f <span class="main">∪</span> f<span class="main">¯</span> <span class="main">∪</span> m<span class="main">¯</span><span class="main">}</span> <span class="main">=</span> <span class="main">(</span><span class="main">(</span><span class="free">x</span><span class="main">,</span><span class="free">j</span><span class="main">)</span> <span class="main">∈</span>  e <span class="main">∪</span> ov<span class="main">¯</span> <span class="main">∪</span> s<span class="main">¯</span> <span class="main">∪</span> d<span class="main">¯</span> <span class="main">∪</span> f <span class="main">∪</span> f<span class="main">¯</span> <span class="main">∪</span> m<span class="main">¯</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>

<span class="keyword1"><span class="command">lemma</span></span> ends<span class="main">:</span>
<span class="keyword2"><span class="keyword">fixes</span></span> <span class="free">i</span> <span class="free">j</span>
<span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"ℐ <span class="free">i</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"ℐ <span class="free">j</span>"</span></span>
<span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">(</span><span class="free">i</span><span class="main">,</span><span class="free">j</span><span class="main">)</span> <span class="main">∈</span> f <span class="main">∪</span> f<span class="main">^-1</span> <span class="main">∪</span> e<span class="main">)</span> <span class="main">=</span> <span class="main">(</span>END <span class="free">i</span> <span class="main">=</span> END <span class="free">j</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> 
   <span class="keyword3"><span class="command">assume</span></span> a3<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">i</span><span class="main">,</span><span class="free">j</span><span class="main">)</span> <span class="main">∈</span> f <span class="main">∪</span> f<span class="main">^-1</span> <span class="main">∪</span> e"</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"END <span class="free">i</span> <span class="main">=</span> END <span class="free">j</span>"</span></span>
   <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
    <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">x</span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">∈</span> END <span class="free">i</span>"</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">x</span><span class="main">,</span><span class="free">i</span><span class="main">)</span> <span class="main">∈</span> e <span class="main">∪</span> ov<span class="main">¯</span> <span class="main">∪</span> s<span class="main">¯</span> <span class="main">∪</span> d<span class="main">¯</span> <span class="main">∪</span> f <span class="main">∪</span> f<span class="main">¯</span> <span class="main">∪</span> m<span class="main">¯</span>"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> END_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">∈</span> END <span class="free">j</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> a3 <span class="keyword1"><span class="command">unfolding</span></span> END_def 
      <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">subst</span> xj_set<span class="main">)</span>
      <span class="keyword1"><span class="command">using</span></span> ceovisidiffimi_ffie_simp <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
     <span class="keyword1"><span class="command">}</span></span> <span class="keyword1"><span class="command">note</span></span> c1 <span class="main">=</span>this

    <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">x</span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">∈</span> END <span class="free">j</span>"</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">x</span><span class="main">,</span><span class="free">j</span><span class="main">)</span> <span class="main">∈</span> e <span class="main">∪</span> ov<span class="main">¯</span> <span class="main">∪</span> s<span class="main">¯</span> <span class="main">∪</span> d<span class="main">¯</span> <span class="main">∪</span> f <span class="main">∪</span> f<span class="main">¯</span> <span class="main">∪</span> m<span class="main">¯</span>"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> END_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">∈</span> END <span class="free">i</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> a3 <span class="keyword1"><span class="command">unfolding</span></span> END_def  
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> Un_iff ceovisidiffimi_ffie_simp converse_iff eei mem_Collect_eq<span class="main">)</span>  
     <span class="keyword1"><span class="command">}</span></span>  <span class="keyword1"><span class="command">note</span></span> c2 <span class="main">=</span> this

    <span class="keyword1"><span class="command">from</span></span> c1 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"END <span class="free">i</span> <span class="main">⊆</span> END <span class="free">j</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command"><span class="improper">with</span></span></span> c2 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"END <span class="free">j</span> <span class="main">⊆</span> END <span class="free">i</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>  
  <span class="keyword1"><span class="command">qed</span></span> <span class="comment1">(*} note conc = this *)</span>
  <span class="keyword1"><span class="command">next</span></span>
  <span class="keyword3"><span class="command">assume</span></span> a4<span class="main">:</span><span class="quoted"><span class="quoted">"END <span class="free">i</span> <span class="main">=</span> END <span class="free">j</span>"</span></span>
  <span class="keyword1"><span class="command">with</span></span> assms <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">i</span> <span class="main">∈</span> END <span class="free">j</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">j</span> <span class="main">∈</span> END <span class="free">i</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> intv2 <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> ij<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">i</span><span class="main">,</span><span class="free">j</span><span class="main">)</span> <span class="main">∈</span> e <span class="main">∪</span> ov<span class="main">¯</span> <span class="main">∪</span> s<span class="main">¯</span> <span class="main">∪</span> d<span class="main">¯</span> <span class="main">∪</span> f <span class="main">∪</span> f<span class="main">¯</span> <span class="main">∪</span> m<span class="main">¯</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> ji<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">j</span><span class="main">,</span><span class="free">i</span><span class="main">)</span> <span class="main">∈</span>  e <span class="main">∪</span> ov<span class="main">¯</span> <span class="main">∪</span> s<span class="main">¯</span> <span class="main">∪</span> d<span class="main">¯</span> <span class="main">∪</span> f <span class="main">∪</span> f<span class="main">¯</span> <span class="main">∪</span> m<span class="main">¯</span>"</span></span>
  <span class="keyword1"><span class="command">unfolding</span></span> END_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">then</span></span>  <span class="keyword1"><span class="command">have</span></span> ijov<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">i</span><span class="main">,</span><span class="free">j</span><span class="main">)</span> <span class="main">∉</span> ov<span class="main">^-1</span>"</span></span>  
  <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">simp_all</span><span class="main"><span class="keyword3">,</span></span> <span class="operator">elim</span> disjE<span class="main"><span class="keyword3">,</span></span> <span class="operator">simp_all</span><span class="main">)</span>
   <span class="keyword1"><span class="command">using</span></span> eov es ed efi ef em eov  <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="operator">auto</span><span class="main"><span class="keyword3">[</span></span>13<span class="main"><span class="keyword3">]</span></span> 
    <span class="keyword1"><span class="command">using</span></span> <span class="dynamic"><span class="dynamic">ov_rules</span></span> <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="operator">auto</span><span class="main"><span class="keyword3">[</span></span>11<span class="main"><span class="keyword3">]</span></span>
     <span class="keyword1"><span class="command">using</span></span> <span class="dynamic"><span class="dynamic">s_rules</span></span> <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="operator">auto</span><span class="main"><span class="keyword3">[</span></span>9<span class="main"><span class="keyword3">]</span></span>
      <span class="keyword1"><span class="command">using</span></span> <span class="dynamic"><span class="dynamic">d_rules</span></span> <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="operator">auto</span><span class="main"><span class="keyword3">[</span></span>7<span class="main"><span class="keyword3">]</span></span>
        <span class="keyword1"><span class="command">using</span></span> <span class="dynamic"><span class="dynamic">f_rules</span></span> <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="operator">auto</span><span class="main"><span class="keyword3">[</span></span>8<span class="main"><span class="keyword3">]</span></span>
          <span class="keyword1"><span class="command">using</span></span> movi <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
   
  <span class="keyword1"><span class="command">from</span></span> ij ji <span class="keyword1"><span class="command">have</span></span>  ijm<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">i</span><span class="main">,</span><span class="free">j</span><span class="main">)</span> <span class="main">∉</span> m<span class="main">^-1</span>"</span></span>  
  <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">simp_all</span><span class="main"><span class="keyword3">,</span></span> <span class="operator">elim</span> disjE<span class="main"><span class="keyword3">,</span></span> <span class="operator">simp_all</span><span class="main">)</span>
    <span class="keyword1"><span class="command">using</span></span> <span class="dynamic"><span class="dynamic">m_rules</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

  <span class="keyword1"><span class="command">from</span></span> ij ji <span class="keyword1"><span class="command">have</span></span>  ijfi<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">i</span><span class="main">,</span><span class="free">j</span><span class="main">)</span> <span class="main">∉</span> s<span class="main">^-1</span>"</span></span>  
  <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">simp_all</span><span class="main"><span class="keyword3">,</span></span> <span class="operator">elim</span> disjE<span class="main"><span class="keyword3">,</span></span> <span class="operator">simp_all</span><span class="main">)</span>
    <span class="keyword1"><span class="command">using</span></span> <span class="dynamic"><span class="dynamic">s_rules</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

  <span class="keyword1"><span class="command">from</span></span> ij ji <span class="keyword1"><span class="command">have</span></span>  ijdi<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">i</span><span class="main">,</span><span class="free">j</span><span class="main">)</span> <span class="main">∉</span> d<span class="main">^-1</span>"</span></span>  
  <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">simp_all</span><span class="main"><span class="keyword3">,</span></span> <span class="operator">elim</span> disjE<span class="main"><span class="keyword3">,</span></span> <span class="operator">simp_all</span><span class="main">)</span>
    <span class="keyword1"><span class="command">using</span></span> <span class="dynamic"><span class="dynamic">d_rules</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

  <span class="keyword1"><span class="command">from</span></span> ij ijm ijov ijfi ijdi  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">i</span><span class="main">,</span> <span class="free">j</span><span class="main">)</span> <span class="main">∈</span> f <span class="main">∪</span> f<span class="main">¯</span> <span class="main">∪</span> e"</span></span>  <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">lemma</span></span> before_irrefl<span class="main">:</span>
<span class="keyword2"><span class="keyword">fixes</span></span> <span class="free">a</span>
<span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> <span class="free">a</span> <span class="main">≪</span> <span class="free">a</span>"</span></span> 
<span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">rule</span> ccontr<span class="main"><span class="keyword3">,</span></span> <span class="operator">auto</span><span class="main">)</span>
  <span class="keyword3"><span class="command">assume</span></span> a0<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="free">a</span> <span class="main">≪</span> <span class="free">a</span>"</span></span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"NEST <span class="free">a</span>"</span></span>  <span class="keyword1"><span class="command">unfolding</span></span> before_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">i</span></span> <span class="keyword2"><span class="keyword">where</span></span>   i<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="free">a</span> <span class="main">=</span> BEGIN <span class="skolem">i</span> <span class="main">∨</span> <span class="free">a</span> <span class="main">=</span> END <span class="skolem">i</span>"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> NEST_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">from</span></span> i <span class="keyword3"><span class="command">show</span></span> <span class="quoted">False</span>
  <span class="keyword1"><span class="command">proof</span></span>
      <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span> <span class="main">=</span> BEGIN <span class="skolem">i</span>"</span></span>
      <span class="keyword1"><span class="command">with</span></span> a0 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"BEGIN <span class="skolem">i</span> <span class="main">≪</span> BEGIN <span class="skolem">i</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
      <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">p</span></span> <span class="skolem"><span class="skolem">q</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">p</span><span class="main">∈</span> BEGIN <span class="skolem">i</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">q</span> <span class="main">∈</span> BEGIN <span class="skolem">i</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> b<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">p</span><span class="main">,</span><span class="skolem">q</span><span class="main">)</span> <span class="main">∈</span> b"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> before_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">then</span></span>  <span class="keyword1"><span class="command">have</span></span> a1<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">p</span><span class="main">,</span><span class="skolem">i</span><span class="main">)</span> <span class="main">∈</span> ov <span class="main">∪</span> s <span class="main">∪</span> m <span class="main">∪</span> f<span class="main">¯</span> <span class="main">∪</span> d<span class="main">¯</span> <span class="main">∪</span> e <span class="main">∪</span> s<span class="main">¯</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> a2<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">i</span><span class="main">,</span><span class="skolem">q</span><span class="main">)</span> <span class="main">∈</span> ov<span class="main">^-1</span> <span class="main">∪</span> s<span class="main">^-1</span> <span class="main">∪</span> m<span class="main">^-1</span> <span class="main">∪</span> f <span class="main">∪</span> d <span class="main">∪</span> e <span class="main">∪</span> s"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> BEGIN_def  
      <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="operator">auto</span> 
      <span class="keyword1"><span class="command">using</span></span> eei <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="operator">fastforce</span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> e<span class="main">)</span><span class="main"><span class="keyword3">+</span></span>
      <span class="keyword1"><span class="command">with</span></span> b <span class="keyword3"><span class="command">show</span></span> <span class="quoted">False</span> 
      <span class="keyword1"><span class="command">using</span></span> piiq<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="skolem">p</span></span> <span class="quoted"><span class="skolem">i</span></span> <span class="quoted"><span class="skolem">q</span></span><span class="main">]</span> 
      <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="operator">auto</span>
        <span class="keyword1"><span class="command">using</span></span>  <span class="dynamic"><span class="dynamic">b_rules</span></span> <span class="keyword1"><span class="command">using</span></span> disjoint_iff_not_equal <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">next</span></span>
      <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span> <span class="main">=</span> END <span class="skolem">i</span>"</span></span>
      <span class="keyword1"><span class="command">with</span></span> a0 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"END <span class="skolem">i</span> <span class="main">≪</span> END <span class="skolem">i</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
      <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">p</span></span> <span class="skolem"><span class="skolem">q</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">p</span><span class="main">∈</span> END <span class="skolem">i</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">q</span> <span class="main">∈</span> END <span class="skolem">i</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> b<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">p</span><span class="main">,</span><span class="skolem">q</span><span class="main">)</span> <span class="main">∈</span> b"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> before_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">then</span></span>  <span class="keyword1"><span class="command">have</span></span> a1<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">p</span><span class="main">,</span><span class="skolem">i</span><span class="main">)</span> <span class="main">∈</span> e <span class="main">∪</span> ov<span class="main">¯</span> <span class="main">∪</span> s<span class="main">¯</span> <span class="main">∪</span> d<span class="main">¯</span> <span class="main">∪</span> f <span class="main">∪</span> f<span class="main">¯</span> <span class="main">∪</span> m<span class="main">¯</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> a2<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">q</span><span class="main">,</span><span class="skolem">i</span><span class="main">)</span> <span class="main">∈</span> e <span class="main">∪</span> ov<span class="main">¯</span> <span class="main">∪</span> s<span class="main">¯</span> <span class="main">∪</span> d<span class="main">¯</span> <span class="main">∪</span> f <span class="main">∪</span> f<span class="main">¯</span> <span class="main">∪</span> m<span class="main">¯</span>"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> END_def  
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span> 
      <span class="keyword1"><span class="command">with</span></span> b <span class="keyword3"><span class="command">show</span></span> <span class="quoted">False</span>
      <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">subst</span> <span class="main"><span class="main">(</span></span><span class="quasi_keyword">asm</span><span class="main"><span class="main">)</span></span> converse_iff<span class="main"><span class="main">[</span></span><span class="operator">THEN</span> sym<span class="main"><span class="main">]</span></span><span class="main">)</span>
      <span class="keyword1"><span class="command">using</span></span> cbi_alpha1ialpha4mi neq_bi_alpha1ialpha4mi relcomp.relcompI subsetCE <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>        
     <span class="keyword1"><span class="command">qed</span></span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">lemma</span></span> BEGIN_before<span class="main">:</span>
<span class="keyword2"><span class="keyword">fixes</span></span> <span class="free">i</span> <span class="free">j</span>
<span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"ℐ <span class="free">i</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"ℐ <span class="free">j</span>"</span></span> 
<span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"BEGIN <span class="free">i</span> <span class="main">≪</span> BEGIN <span class="free">j</span> <span class="main">=</span> <span class="main">(</span><span class="main">(</span><span class="free">i</span><span class="main">,</span><span class="free">j</span><span class="main">)</span> <span class="main">∈</span> b <span class="main">∪</span> m <span class="main">∪</span> ov <span class="main">∪</span> f<span class="main">¯</span> <span class="main">∪</span> d<span class="main">¯</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> 
    
     <span class="keyword3"><span class="command">assume</span></span> a3<span class="main">:</span><span class="quoted"><span class="quoted">"BEGIN <span class="free">i</span> <span class="main">≪</span> BEGIN <span class="free">j</span>"</span></span>
     <span class="keyword1"><span class="command">from</span></span> a3 <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">p</span></span> <span class="skolem"><span class="skolem">q</span></span> <span class="keyword2"><span class="keyword">where</span></span> pa<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">p</span> <span class="main">∈</span> BEGIN <span class="free">i</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> qc<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">q</span> <span class="main">∈</span> BEGIN <span class="free">j</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> pq<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">p</span><span class="main">,</span><span class="skolem">q</span><span class="main">)</span> <span class="main">∈</span> b"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> before_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
     <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">r</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">p</span><span class="main">∥</span><span class="skolem">r</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">r</span><span class="main">∥</span><span class="skolem">q</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> b <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
     <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> pr<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">p</span><span class="main">,</span><span class="skolem">r</span><span class="main">)</span> <span class="main">∈</span> m"</span></span> <span class="keyword2"><span class="keyword">and</span></span> rq<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">r</span><span class="main">,</span><span class="skolem">q</span><span class="main">)</span> <span class="main">∈</span> m"</span></span> <span class="keyword1"><span class="command">using</span></span> m <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
     <span class="keyword1"><span class="command">from</span></span> pa  <span class="keyword1"><span class="command">have</span></span> pi<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">p</span><span class="main">,</span><span class="free">i</span><span class="main">)</span> <span class="main">∈</span> ov <span class="main">∪</span> s <span class="main">∪</span> m <span class="main">∪</span> f<span class="main">¯</span> <span class="main">∪</span> d<span class="main">¯</span> <span class="main">∪</span> e <span class="main">∪</span> s<span class="main">¯</span>"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> BEGIN_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
     <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command"><span class="improper">with</span></span></span> pr <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">r</span><span class="main">,</span><span class="skolem">p</span><span class="main">)</span> <span class="main">∈</span> m<span class="main">^-1</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
     <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">r</span><span class="main">,</span><span class="free">i</span><span class="main">)</span> <span class="main">∈</span> d <span class="main">∪</span> f <span class="main">∪</span> ov<span class="main">^-1</span> <span class="main">∪</span> e <span class="main">∪</span> f<span class="main">^-1</span> <span class="main">∪</span> m<span class="main">^-1</span> <span class="main">∪</span> b<span class="main">^-1</span> <span class="main">∪</span> s <span class="main">∪</span> s<span class="main">^-1</span>"</span></span>
     <span class="keyword1"><span class="command">using</span></span> cmiov cmis cmim cmifi cmidi  cmisi
     <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span> <span class="operator">simp_all</span><span class="main"><span class="keyword3">,</span></span><span class="operator">elim</span> disjE<span class="main"><span class="keyword3">,</span></span> <span class="operator">auto</span><span class="main">)</span>
        <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> e<span class="main">)</span>
     

     <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> ir<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">i</span><span class="main">,</span><span class="skolem">r</span><span class="main">)</span> <span class="main">∈</span> d<span class="main">^-1</span> <span class="main">∪</span> f<span class="main">^-1</span> <span class="main">∪</span> ov <span class="main">∪</span> e <span class="main">∪</span> f <span class="main">∪</span> m <span class="main">∪</span> b <span class="main">∪</span> s<span class="main">^-1</span> <span class="main">∪</span> s"</span></span> 
     <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> <span class="main"><span class="main">(</span></span>mono_tags<span class="main"><span class="main">,</span></span> lifting<span class="main"><span class="main">)</span></span> converseD converse_Un converse_converse eei<span class="main">)</span>

     <span class="keyword1"><span class="command">from</span></span> qc  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">q</span><span class="main">,</span><span class="free">j</span><span class="main">)</span> <span class="main">∈</span>  ov <span class="main">∪</span> s <span class="main">∪</span> m <span class="main">∪</span> f<span class="main">¯</span> <span class="main">∪</span> d<span class="main">¯</span> <span class="main">∪</span> e <span class="main">∪</span> s<span class="main">¯</span>"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> BEGIN_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
     <span class="keyword1"><span class="command">with</span></span> rq <span class="keyword1"><span class="command">have</span></span> rj<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">r</span><span class="main">,</span><span class="free">j</span><span class="main">)</span> <span class="main">∈</span> b <span class="main">∪</span> s <span class="main">∪</span> m "</span></span>
     <span class="keyword1"><span class="command">using</span></span> m_ovsmfidiesi <span class="keyword1"><span class="command">using</span></span> contra_subsetD relcomp.relcompI <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
      
     <span class="keyword1"><span class="command">with</span></span> ir <span class="keyword1"><span class="command">have</span></span> c1<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">i</span><span class="main">,</span><span class="free">j</span><span class="main">)</span> <span class="main">∈</span> b <span class="main">∪</span> m <span class="main">∪</span> ov <span class="main">∪</span> f<span class="main">¯</span> <span class="main">∪</span> d<span class="main">¯</span> <span class="main">∪</span> d <span class="main">∪</span> e <span class="main">∪</span> s <span class="main">∪</span> s<span class="main">¯</span>"</span></span>
     <span class="keyword1"><span class="command">using</span></span> difibs <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
     <span class="keyword1"><span class="command">{</span></span><span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">i</span><span class="main">,</span><span class="free">j</span><span class="main">)</span> <span class="main">∈</span> s<span class="main">∨</span> <span class="main">(</span><span class="free">i</span><span class="main">,</span><span class="free">j</span><span class="main">)</span><span class="main">∈</span>s<span class="main">^-1</span> <span class="main">∨</span> <span class="main">(</span><span class="free">i</span><span class="main">,</span><span class="free">j</span><span class="main">)</span> <span class="main">∈</span> e"</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"BEGIN <span class="free">i</span> <span class="main">=</span> BEGIN <span class="free">j</span>"</span></span> 
      <span class="keyword1"><span class="command">using</span></span> starts Un_iff assms<span class="main">(</span>1<span class="main">)</span> assms<span class="main">(</span>2<span class="main">)</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
      <span class="keyword1"><span class="command">with</span></span> a3 <span class="keyword1"><span class="command">have</span></span> <span class="quoted">False</span>  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> before_irrefl<span class="main">)</span><span class="keyword1"><span class="command">}</span></span>

      <span class="keyword1"><span class="command">from</span></span> c1 <span class="keyword1"><span class="command">have</span></span> c1'<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">i</span><span class="main">,</span><span class="free">j</span><span class="main">)</span> <span class="main">∈</span> b <span class="main">∪</span> m <span class="main">∪</span> ov <span class="main">∪</span> f<span class="main">¯</span> <span class="main">∪</span> d<span class="main">¯</span> <span class="main">∪</span> d "</span></span> 
      <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="main">(</span><span class="free">i</span><span class="main">,</span> <span class="free">j</span><span class="main">)</span> <span class="main">∈</span> s <span class="main">∨</span> <span class="main">(</span><span class="free">i</span><span class="main">,</span> <span class="free">j</span><span class="main">)</span> <span class="main">∈</span> s<span class="main">¯</span> <span class="main">∨</span> <span class="main">(</span><span class="free">i</span><span class="main">,</span> <span class="free">j</span><span class="main">)</span> <span class="main">∈</span> e <span class="main">⟹</span> False›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>

     <span class="keyword1"><span class="command">{</span></span><span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">i</span><span class="main">,</span><span class="free">j</span><span class="main">)</span> <span class="main">∈</span> d"</span></span> <span class="keyword1"><span class="command">with</span></span> pi <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">p</span><span class="main">,</span><span class="free">j</span><span class="main">)</span> <span class="main">∈</span> e <span class="main">∪</span>  s <span class="main">∪</span> d <span class="main">∪</span> ov <span class="main">∪</span> ov<span class="main">^-1</span> <span class="main">∪</span> s<span class="main">^-1</span> <span class="main">∪</span> f <span class="main">∪</span> f<span class="main">^-1</span>  <span class="main">∪</span> d<span class="main">^-1</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> ovsmfidiesi_d <span class="keyword1"><span class="command">using</span></span> relcomp.relcompI subsetCE <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
      <span class="keyword1"><span class="command">with</span></span> pq <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">q</span><span class="main">,</span><span class="free">j</span><span class="main">)</span> <span class="main">∈</span>  b<span class="main">^-1</span> <span class="main">∪</span> d <span class="main">∪</span> f <span class="main">∪</span> ov<span class="main">^-1</span> <span class="main">∪</span> m<span class="main">^-1</span>"</span></span>
      <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">subst</span> <span class="main"><span class="main">(</span></span><span class="quasi_keyword">asm</span><span class="main"><span class="main">)</span></span> converse_iff<span class="main"><span class="main">[</span></span><span class="operator">THEN</span> sym<span class="main"><span class="main">]</span></span><span class="main">)</span>
      <span class="keyword1"><span class="command">using</span></span> cbi_esdovovisiffidi <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
      <span class="keyword1"><span class="command">with</span></span> qc <span class="keyword1"><span class="command">have</span></span> <span class="quoted">False</span> <span class="keyword1"><span class="command">unfolding</span></span> BEGIN_def 
      <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">subgoal_tac</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">q</span><span class="main">,</span> <span class="free">j</span><span class="main">)</span> <span class="main">∈</span> ov <span class="main">∪</span> s <span class="main">∪</span> m <span class="main">∪</span> f<span class="main">¯</span> <span class="main">∪</span> d<span class="main">¯</span> <span class="main">∪</span> e <span class="main">∪</span> s<span class="main">¯</span>"</span></span><span class="main">)</span>
        <span class="keyword1"><span class="command"><span class="improper"><span class="command">prefer</span></span></span></span> 2
        <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="operator">simp</span> 
          <span class="keyword1"><span class="command">using</span></span> neq_beta2i_alpha2alpha5m <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">}</span></span>

     <span class="keyword1"><span class="command">with</span></span> c1' <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">(</span><span class="free">i</span><span class="main">,</span> <span class="free">j</span><span class="main">)</span> <span class="main">∈</span> b <span class="main">∪</span> m <span class="main">∪</span> ov <span class="main">∪</span> f<span class="main">¯</span> <span class="main">∪</span> d<span class="main">¯</span><span class="main">)</span>"</span></span>   <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>  
   <span class="keyword1"><span class="command">next</span></span>
      <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">i</span><span class="main">,</span> <span class="free">j</span><span class="main">)</span> <span class="main">∈</span> b <span class="main">∪</span> m <span class="main">∪</span> ov <span class="main">∪</span> f<span class="main">¯</span> <span class="main">∪</span> d<span class="main">¯</span>"</span></span>
      <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"BEGIN <span class="free">i</span> <span class="main">≪</span> BEGIN <span class="free">j</span>"</span></span>
      <span class="keyword1"><span class="command">proof</span></span>  <span class="main">(</span> <span class="operator">simp_all</span><span class="main"><span class="keyword3">,</span></span><span class="operator">elim</span> disjE<span class="main"><span class="keyword3">,</span></span> <span class="operator">simp_all</span><span class="main">)</span>
        <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">i</span><span class="main">,</span><span class="free">j</span><span class="main">)</span> <span class="main">∈</span> b"</span></span> <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> intv1  <span class="keyword1"><span class="command">using</span></span> before_def NEST_BEGIN assms <span class="keyword1"><span class="command">by</span></span> <span class="operator">metis</span>
        <span class="keyword1"><span class="command">next</span></span>
        <span class="keyword3"><span class="command">assume</span></span> iu<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">i</span><span class="main">,</span><span class="free">j</span><span class="main">)</span> <span class="main">∈</span> m"</span></span> 
        <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">l</span></span> <span class="keyword2"><span class="keyword">where</span></span> li<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">l</span><span class="main">,</span><span class="free">i</span><span class="main">)</span> <span class="main">∈</span> m"</span></span> <span class="keyword1"><span class="command">using</span></span> M3 m meets_wd assms <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
        <span class="keyword1"><span class="command">with</span></span> iu <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">l</span><span class="main">,</span><span class="free">j</span><span class="main">)</span> <span class="main">∈</span> b"</span></span> <span class="keyword1"><span class="command">using</span></span> cmm <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> li  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">l</span> <span class="main">∈</span> <span class="main">(</span>BEGIN <span class="free">i</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> BEGIN_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> intv1  before_def NEST_BEGIN assms <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
        <span class="keyword1"><span class="command">next</span></span>
        <span class="keyword3"><span class="command">assume</span></span> iu<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">i</span><span class="main">,</span><span class="free">j</span><span class="main">)</span> <span class="main">∈</span> ov"</span></span>
        <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">l</span></span> <span class="keyword2"><span class="keyword">where</span></span> li<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">l</span><span class="main">,</span><span class="free">i</span><span class="main">)</span> <span class="main">∈</span> m"</span></span> <span class="keyword1"><span class="command">using</span></span> M3 m meets_wd assms <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
        <span class="keyword1"><span class="command">with</span></span> iu <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">l</span><span class="main">,</span><span class="free">j</span><span class="main">)</span> <span class="main">∈</span> b"</span></span> <span class="keyword1"><span class="command">using</span></span> cmov <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> li <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">l</span> <span class="main">∈</span> <span class="main">(</span>BEGIN <span class="free">i</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> BEGIN_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> intv1 before_def NEST_BEGIN assms <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
        <span class="keyword1"><span class="command">next</span></span>
        <span class="keyword3"><span class="command">assume</span></span> iu<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">j</span><span class="main">,</span><span class="free">i</span><span class="main">)</span> <span class="main">∈</span> f"</span></span> 
        <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">l</span></span> <span class="keyword2"><span class="keyword">where</span></span> li<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">l</span><span class="main">,</span><span class="free">i</span><span class="main">)</span> <span class="main">∈</span> m"</span></span> <span class="keyword1"><span class="command">using</span></span> M3 m meets_wd assms <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
        <span class="keyword1"><span class="command">with</span></span> iu <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">l</span><span class="main">,</span><span class="free">j</span><span class="main">)</span> <span class="main">∈</span> b"</span></span> <span class="keyword1"><span class="command">using</span></span> cmfi <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> li <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">l</span> <span class="main">∈</span> <span class="main">(</span>BEGIN <span class="free">i</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> BEGIN_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> intv1  before_def NEST_BEGIN assms <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
        <span class="keyword1"><span class="command">next</span></span>
        <span class="keyword3"><span class="command">assume</span></span> iu<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">j</span><span class="main">,</span><span class="free">i</span><span class="main">)</span> <span class="main">∈</span> d"</span></span> 
        <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">l</span></span> <span class="keyword2"><span class="keyword">where</span></span> li<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">l</span><span class="main">,</span><span class="free">i</span><span class="main">)</span> <span class="main">∈</span> m"</span></span> <span class="keyword1"><span class="command">using</span></span> M3 m meets_wd assms <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
        <span class="keyword1"><span class="command">with</span></span> iu <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">l</span><span class="main">,</span><span class="free">j</span><span class="main">)</span> <span class="main">∈</span> b"</span></span> <span class="keyword1"><span class="command">using</span></span> cmdi <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> li <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">l</span> <span class="main">∈</span> <span class="main">(</span>BEGIN <span class="free">i</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> BEGIN_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> intv1 before_def NEST_BEGIN assms <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
        
     <span class="keyword1"><span class="command">qed</span></span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">lemma</span></span> BEGIN_END_before<span class="main">:</span>
<span class="keyword2"><span class="keyword">fixes</span></span> <span class="free">i</span> <span class="free">j</span>
<span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"ℐ <span class="free">i</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"ℐ <span class="free">j</span>"</span></span>
<span class="keyword2"><span class="keyword">shows</span></span>  <span class="quoted"><span class="quoted">"BEGIN <span class="free">i</span> <span class="main">≪</span> END <span class="free">j</span> <span class="main">=</span> <span class="main">(</span><span class="main">(</span><span class="free">i</span><span class="main">,</span><span class="free">j</span><span class="main">)</span> <span class="main">∈</span> e <span class="main">∪</span> b <span class="main">∪</span> m <span class="main">∪</span> ov <span class="main">∪</span> ov<span class="main">^-1</span> <span class="main">∪</span> s <span class="main">∪</span> s<span class="main">^-1</span> <span class="main">∪</span> f <span class="main">∪</span> f<span class="main">¯</span> <span class="main">∪</span> d <span class="main">∪</span> d<span class="main">¯</span><span class="main">)</span> "</span></span>
<span class="keyword1"><span class="command">proof</span></span> 
     <span class="keyword3"><span class="command">assume</span></span> a3<span class="main">:</span><span class="quoted"><span class="quoted">"BEGIN <span class="free">i</span> <span class="main">≪</span> END <span class="free">j</span>"</span></span>
     <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">p</span></span> <span class="skolem"><span class="skolem">q</span></span> <span class="keyword2"><span class="keyword">where</span></span> pa<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">p</span> <span class="main">∈</span> BEGIN <span class="free">i</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> qc<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">q</span> <span class="main">∈</span> END <span class="free">j</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> pq<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">p</span><span class="main">,</span><span class="skolem">q</span><span class="main">)</span> <span class="main">∈</span> b"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> before_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
     <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">r</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">p</span><span class="main">∥</span><span class="skolem">r</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">r</span><span class="main">∥</span><span class="skolem">q</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> b <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
     <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> pr<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">p</span><span class="main">,</span><span class="skolem">r</span><span class="main">)</span> <span class="main">∈</span> m"</span></span> <span class="keyword2"><span class="keyword">and</span></span> rq<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">r</span><span class="main">,</span><span class="skolem">q</span><span class="main">)</span> <span class="main">∈</span> m"</span></span> <span class="keyword1"><span class="command">using</span></span> m <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
     <span class="keyword1"><span class="command">from</span></span> pa  <span class="keyword1"><span class="command">have</span></span> pi<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">p</span><span class="main">,</span><span class="free">i</span><span class="main">)</span> <span class="main">∈</span> ov <span class="main">∪</span> s <span class="main">∪</span> m <span class="main">∪</span> f<span class="main">¯</span> <span class="main">∪</span> d<span class="main">¯</span> <span class="main">∪</span> e <span class="main">∪</span> s<span class="main">¯</span>"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> BEGIN_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
     <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command"><span class="improper">with</span></span></span> pr <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">r</span><span class="main">,</span><span class="skolem">p</span><span class="main">)</span> <span class="main">∈</span> m<span class="main">^-1</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
     <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">r</span><span class="main">,</span><span class="free">i</span><span class="main">)</span> <span class="main">∈</span> d <span class="main">∪</span> f <span class="main">∪</span> ov<span class="main">^-1</span> <span class="main">∪</span> e <span class="main">∪</span> f<span class="main">^-1</span> <span class="main">∪</span> m<span class="main">^-1</span> <span class="main">∪</span> b<span class="main">^-1</span> <span class="main">∪</span> s <span class="main">∪</span> s<span class="main">^-1</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> cmiov cmis cmim cmifi cmidi e cmisi
     <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span> <span class="operator">simp_all</span><span class="main"><span class="keyword3">,</span></span><span class="operator">elim</span> disjE<span class="main"><span class="keyword3">,</span></span> <span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span>e<span class="main">)</span>
     
     <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> ir<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">i</span><span class="main">,</span><span class="skolem">r</span><span class="main">)</span> <span class="main">∈</span> d<span class="main">^-1</span> <span class="main">∪</span> f<span class="main">^-1</span> <span class="main">∪</span> ov <span class="main">∪</span> e <span class="main">∪</span> f <span class="main">∪</span> m <span class="main">∪</span> b <span class="main">∪</span> s<span class="main">^-1</span> <span class="main">∪</span> s"</span></span> 
     <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> <span class="main"><span class="main">(</span></span>mono_tags<span class="main"><span class="main">,</span></span> lifting<span class="main"><span class="main">)</span></span> converseD converse_Un converse_converse eei<span class="main">)</span>

     <span class="keyword1"><span class="command">from</span></span> qc  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">q</span><span class="main">,</span><span class="free">j</span><span class="main">)</span> <span class="main">∈</span> e <span class="main">∪</span> ov<span class="main">¯</span> <span class="main">∪</span> s<span class="main">¯</span> <span class="main">∪</span> d<span class="main">¯</span> <span class="main">∪</span> f <span class="main">∪</span> f<span class="main">¯</span> <span class="main">∪</span> m<span class="main">¯</span>"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> END_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
     <span class="keyword1"><span class="command">with</span></span> rq <span class="keyword1"><span class="command">have</span></span> rj<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">r</span><span class="main">,</span><span class="free">j</span><span class="main">)</span> <span class="main">∈</span> m <span class="main">∪</span> ov <span class="main">∪</span> s <span class="main">∪</span> d <span class="main">∪</span> b <span class="main">∪</span> f<span class="main">^-1</span> <span class="main">∪</span> f <span class="main">∪</span> e"</span></span> <span class="keyword1"><span class="command">using</span></span> cm_alpha1ialpha4mi <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>

     <span class="keyword1"><span class="command">with</span></span> ir <span class="keyword3"><span class="command">show</span></span>  c1<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">i</span><span class="main">,</span><span class="free">j</span><span class="main">)</span> <span class="main">∈</span> e <span class="main">∪</span> b <span class="main">∪</span> m <span class="main">∪</span> ov <span class="main">∪</span> ov<span class="main">^-1</span> <span class="main">∪</span> s <span class="main">∪</span> s<span class="main">^-1</span> <span class="main">∪</span> f <span class="main">∪</span> f<span class="main">¯</span> <span class="main">∪</span> d <span class="main">∪</span> d<span class="main">¯</span>"</span></span>
     <span class="keyword1"><span class="command">using</span></span> difimov <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
     <span class="keyword1"><span class="command">next</span></span>
     <span class="keyword3"><span class="command">assume</span></span> a4<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">i</span><span class="main">,</span> <span class="free">j</span><span class="main">)</span> <span class="main">∈</span> e <span class="main">∪</span> b <span class="main">∪</span> m <span class="main">∪</span> ov <span class="main">∪</span> ov<span class="main">¯</span> <span class="main">∪</span> s <span class="main">∪</span> s<span class="main">¯</span> <span class="main">∪</span> f <span class="main">∪</span> f<span class="main">¯</span> <span class="main">∪</span> d <span class="main">∪</span> d<span class="main">¯</span>"</span></span>
     <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"BEGIN <span class="free">i</span> <span class="main">≪</span> END <span class="free">j</span>"</span></span>
     <span class="keyword1"><span class="command">proof</span></span>  <span class="main">(</span> <span class="operator">simp_all</span><span class="main"><span class="keyword3">,</span></span><span class="operator">elim</span> disjE<span class="main"><span class="keyword3">,</span></span> <span class="operator">simp_all</span><span class="main">)</span>
           <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">i</span><span class="main">,</span><span class="free">j</span><span class="main">)</span> <span class="main">∈</span> e"</span></span> 
           <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">l</span></span> <span class="skolem"><span class="skolem">k</span></span> <span class="keyword2"><span class="keyword">where</span></span> l<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">l</span><span class="main">∥</span><span class="free">i</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">i</span><span class="main">∥</span><span class="skolem">k</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> M3 meets_wd assms  <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
           <span class="keyword1"><span class="command">with</span></span> <span class="quoted"><span class="quoted">‹<span class="main">(</span><span class="free">i</span><span class="main">,</span><span class="free">j</span><span class="main">)</span> <span class="main">∈</span> e›</span></span> <span class="keyword1"><span class="command">have</span></span> k<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="free">j</span><span class="main">∥</span><span class="skolem">k</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> e<span class="main">)</span>
           <span class="keyword1"><span class="command">from</span></span> l k <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">l</span><span class="main">,</span><span class="free">i</span><span class="main">)</span> <span class="main">∈</span> m"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">k</span><span class="main">,</span><span class="free">j</span><span class="main">)</span> <span class="main">∈</span> m<span class="main">^-1</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> m <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
           <span class="keyword1"><span class="command">then</span></span>  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">l</span> <span class="main">∈</span> BEGIN <span class="free">i</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">k</span> <span class="main">∈</span> END <span class="free">j</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> BEGIN_def END_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span> 
           <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> l <span class="quoted"><span class="quoted">‹<span class="free">i</span><span class="main">∥</span><span class="skolem">k</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">l</span><span class="main">,</span><span class="skolem">k</span><span class="main">)</span> <span class="main">∈</span> b"</span></span> <span class="keyword1"><span class="command">using</span></span> b <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
           <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> before_def assms NEST_BEGIN NEST_END  <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
          <span class="keyword1"><span class="command">next</span></span>
           <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">i</span><span class="main">,</span><span class="free">j</span><span class="main">)</span> <span class="main">∈</span> b"</span></span>
           <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> before_def assms NEST_BEGIN NEST_END intv1<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="free">i</span></span><span class="main">]</span> intv2<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="free">j</span></span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
          <span class="keyword1"><span class="command">next</span></span>
            <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">i</span><span class="main">,</span><span class="free">j</span><span class="main">)</span> <span class="main">∈</span> m"</span></span>
            <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">l</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">l</span><span class="main">∥</span><span class="free">i</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> M3 assms <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
            <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">l</span><span class="main">∈</span>BEGIN <span class="free">i</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> m BEGIN_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
            <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="main">(</span><span class="free">i</span><span class="main">,</span><span class="free">j</span><span class="main">)</span><span class="main">∈</span>m›</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">l</span><span class="main">∥</span><span class="free">i</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">l</span><span class="main">,</span><span class="free">j</span><span class="main">)</span> <span class="main">∈</span> b"</span></span> <span class="keyword1"><span class="command">using</span></span> b m <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
            <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> intv2<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="free">j</span></span><span class="main">]</span> assms NEST_BEGIN NEST_END before_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
          <span class="keyword1"><span class="command">next</span></span>
           <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">i</span><span class="main">,</span><span class="free">j</span><span class="main">)</span> <span class="main">∈</span> ov"</span></span>
           <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">l</span></span> <span class="skolem"><span class="skolem">k</span></span> <span class="keyword2"><span class="keyword">where</span></span> li<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">l</span><span class="main">∥</span><span class="free">i</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> lk<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">l</span><span class="main">∥</span><span class="skolem">k</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> ku<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">k</span><span class="main">∥</span><span class="free">j</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> ov <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
           <span class="keyword1"><span class="command">from</span></span> li <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">l</span> <span class="main">∈</span> BEGIN <span class="free">i</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> m BEGIN_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
           <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> lk ku <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">l</span><span class="main">,</span><span class="free">j</span><span class="main">)</span> <span class="main">∈</span> b"</span></span> <span class="keyword1"><span class="command">using</span></span> b <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
           <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> intv2<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="free">j</span></span><span class="main">]</span> assms NEST_BEGIN NEST_END before_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
          <span class="keyword1"><span class="command">next</span></span>
           <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">j</span><span class="main">,</span><span class="free">i</span><span class="main">)</span> <span class="main">∈</span> ov"</span></span>
           <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">l</span></span> <span class="skolem"><span class="skolem">k</span></span> <span class="skolem"><span class="skolem">v</span></span> <span class="keyword2"><span class="keyword">where</span></span> uv<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="free">j</span><span class="main">∥</span><span class="skolem">v</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> lk<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">l</span><span class="main">∥</span><span class="skolem">k</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> kv<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">k</span><span class="main">∥</span><span class="skolem">v</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> li<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">l</span><span class="main">∥</span><span class="free">i</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> ov <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
           <span class="keyword1"><span class="command">from</span></span> li <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">l</span> <span class="main">∈</span> BEGIN <span class="free">i</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> m BEGIN_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
           <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> uv <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">v</span> <span class="main">∈</span> END <span class="free">j</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> m END_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
           <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> lk kv <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">l</span><span class="main">,</span><span class="skolem">v</span><span class="main">)</span> <span class="main">∈</span> b"</span></span> <span class="keyword1"><span class="command">using</span></span> b <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
           <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span>  assms NEST_BEGIN NEST_END before_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
          <span class="keyword1"><span class="command">next</span></span>
           <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">i</span><span class="main">,</span><span class="free">j</span><span class="main">)</span> <span class="main">∈</span> s"</span></span>
           <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">v</span></span> <span class="skolem"><span class="skolem">v'</span></span> <span class="keyword2"><span class="keyword">where</span></span> iv<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="free">i</span><span class="main">∥</span><span class="skolem">v</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> vvp<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">v</span><span class="main">∥</span><span class="skolem">v'</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">j</span><span class="main">∥</span><span class="skolem">v'</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> s <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
           <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">v'</span> <span class="main">∈</span> END <span class="free">j</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> END_def m <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
           <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> iv vvp <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">i</span><span class="main">,</span><span class="skolem">v'</span><span class="main">)</span> <span class="main">∈</span> b"</span></span> <span class="keyword1"><span class="command">using</span></span> b <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
           <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> intv1<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="free">i</span></span><span class="main">]</span>  assms NEST_BEGIN NEST_END before_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
          <span class="keyword1"><span class="command">next</span></span>
           <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">j</span><span class="main">,</span><span class="free">i</span><span class="main">)</span> <span class="main">∈</span> s"</span></span>
           <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">l</span></span> <span class="skolem"><span class="skolem">v</span></span> <span class="keyword2"><span class="keyword">where</span></span> li<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">l</span><span class="main">∥</span><span class="free">i</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> lu<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">l</span><span class="main">∥</span><span class="free">j</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">j</span><span class="main">∥</span><span class="skolem">v</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> s <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
           <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">v</span> <span class="main">∈</span> END <span class="free">j</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> m END_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
           <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> li <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">l</span> <span class="main">∈</span> BEGIN <span class="free">i</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> m BEGIN_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
           <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> lu <span class="quoted"><span class="quoted">‹<span class="free">j</span><span class="main">∥</span><span class="skolem">v</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">l</span><span class="main">,</span><span class="skolem">v</span><span class="main">)</span> <span class="main">∈</span> b"</span></span> <span class="keyword1"><span class="command">using</span></span> b <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
           <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span>  assms NEST_BEGIN NEST_END before_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
          <span class="keyword1"><span class="command">next</span></span>
           <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">i</span><span class="main">,</span><span class="free">j</span><span class="main">)</span> <span class="main">:</span> f"</span></span>
           <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">l</span></span> <span class="skolem"><span class="skolem">v</span></span> <span class="keyword2"><span class="keyword">where</span></span> li<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">l</span><span class="main">∥</span><span class="free">i</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> iv<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="free">i</span><span class="main">∥</span><span class="skolem">v</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">j</span><span class="main">∥</span><span class="skolem">v</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> f <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
           <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">v</span> <span class="main">∈</span> END <span class="free">j</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> m END_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
           <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> li <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">l</span> <span class="main">∈</span> BEGIN <span class="free">i</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> m BEGIN_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
           <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> iv li <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">l</span><span class="main">,</span><span class="skolem">v</span><span class="main">)</span> <span class="main">∈</span> b"</span></span> <span class="keyword1"><span class="command">using</span></span> b <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
           <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> assms NEST_BEGIN NEST_END before_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
          <span class="keyword1"><span class="command">next</span></span>
           <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">j</span><span class="main">,</span><span class="free">i</span><span class="main">)</span> <span class="main">∈</span> f"</span></span>
           <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">l</span></span> <span class="skolem"><span class="skolem">v</span></span> <span class="keyword2"><span class="keyword">where</span></span> li<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">l</span><span class="main">∥</span><span class="free">i</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> iv<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="free">i</span><span class="main">∥</span><span class="skolem">v</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">j</span><span class="main">∥</span><span class="skolem">v</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> f <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
           <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">v</span> <span class="main">∈</span> END <span class="free">j</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> m END_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
           <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> li <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">l</span> <span class="main">∈</span> BEGIN <span class="free">i</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> m BEGIN_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
           <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> iv li <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">l</span><span class="main">,</span><span class="skolem">v</span><span class="main">)</span> <span class="main">∈</span> b"</span></span> <span class="keyword1"><span class="command">using</span></span> b <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
           <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span>  assms NEST_BEGIN NEST_END before_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
          <span class="keyword1"><span class="command">next</span></span>
           <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">i</span><span class="main">,</span><span class="free">j</span><span class="main">)</span> <span class="main">:</span> d"</span></span>
           <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">k</span></span> <span class="skolem"><span class="skolem">v</span></span> <span class="keyword2"><span class="keyword">where</span></span> ik<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="free">i</span><span class="main">∥</span><span class="skolem">k</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> kv<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">k</span><span class="main">∥</span><span class="skolem">v</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">j</span><span class="main">∥</span><span class="skolem">v</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> d <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
           <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">v</span> <span class="main">∈</span> END <span class="free">j</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> END_def m <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
           <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> ik kv <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">i</span><span class="main">,</span><span class="skolem">v</span><span class="main">)</span> <span class="main">∈</span> b"</span></span> <span class="keyword1"><span class="command">using</span></span> b <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
           <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> intv1<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="free">i</span></span><span class="main">]</span>  assms NEST_BEGIN NEST_END before_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
          <span class="keyword1"><span class="command">next</span></span>
           <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">j</span><span class="main">,</span><span class="free">i</span><span class="main">)</span> <span class="main">∈</span> d"</span></span>
           <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">l</span></span> <span class="skolem"><span class="skolem">k</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">l</span><span class="main">∥</span><span class="free">i</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> lk<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">l</span><span class="main">∥</span><span class="skolem">k</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> ku<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">k</span><span class="main">∥</span><span class="free">j</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> d <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
           <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">l</span> <span class="main">∈</span> BEGIN <span class="free">i</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> BEGIN_def m <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
           <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> lk ku <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">l</span><span class="main">,</span><span class="free">j</span><span class="main">)</span> <span class="main">∈</span> b"</span></span> <span class="keyword1"><span class="command">using</span></span> b <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
           <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> intv2<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="free">j</span></span><span class="main">]</span> assms NEST_BEGIN NEST_END before_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
       <span class="keyword1"><span class="command">qed</span></span>           
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">lemma</span></span> END_BEGIN_before<span class="main">:</span>
<span class="keyword2"><span class="keyword">fixes</span></span> <span class="free">i</span> <span class="free">j</span>
<span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"ℐ <span class="free">i</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"ℐ <span class="free">j</span>"</span></span>
<span class="keyword2"><span class="keyword">shows</span></span>  <span class="quoted"><span class="quoted">"END <span class="free">i</span> <span class="main">≪</span> BEGIN <span class="free">j</span> <span class="main">=</span>  <span class="main">(</span><span class="main">(</span><span class="free">i</span><span class="main">,</span><span class="free">j</span><span class="main">)</span> <span class="main">∈</span> b<span class="main">)</span> "</span></span>
<span class="keyword1"><span class="command">proof</span></span> 
     <span class="keyword3"><span class="command">assume</span></span> a3<span class="main">:</span><span class="quoted"><span class="quoted">"END <span class="free">i</span> <span class="main">≪</span> BEGIN <span class="free">j</span>"</span></span>
     <span class="keyword1"><span class="command">from</span></span> a3 <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">p</span></span> <span class="skolem"><span class="skolem">q</span></span> <span class="keyword2"><span class="keyword">where</span></span> pa<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">p</span> <span class="main">∈</span> END <span class="free">i</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> qc<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">q</span> <span class="main">∈</span> BEGIN <span class="free">j</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> pq<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">p</span><span class="main">,</span><span class="skolem">q</span><span class="main">)</span> <span class="main">∈</span> b"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> before_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
     <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">r</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">p</span><span class="main">∥</span><span class="skolem">r</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">r</span><span class="main">∥</span><span class="skolem">q</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> b <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
     <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> pr<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">p</span><span class="main">,</span><span class="skolem">r</span><span class="main">)</span> <span class="main">∈</span> m"</span></span> <span class="keyword2"><span class="keyword">and</span></span> rq<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">r</span><span class="main">,</span><span class="skolem">q</span><span class="main">)</span> <span class="main">∈</span> m"</span></span> <span class="keyword1"><span class="command">using</span></span> m <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
     <span class="keyword1"><span class="command">from</span></span> pa  <span class="keyword1"><span class="command">have</span></span> pi<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">p</span><span class="main">,</span><span class="free">i</span><span class="main">)</span> <span class="main">∈</span>  e <span class="main">∪</span> ov<span class="main">¯</span> <span class="main">∪</span> s<span class="main">¯</span> <span class="main">∪</span> d<span class="main">¯</span> <span class="main">∪</span> f <span class="main">∪</span> f<span class="main">¯</span> <span class="main">∪</span> m<span class="main">¯</span>"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> END_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
     <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command"><span class="improper">with</span></span></span> pr <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">r</span><span class="main">,</span><span class="skolem">p</span><span class="main">)</span> <span class="main">∈</span> m<span class="main">^-1</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
     <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">r</span><span class="main">,</span><span class="free">i</span><span class="main">)</span> <span class="main">∈</span> m<span class="main">^-1</span> <span class="main">∪</span> b<span class="main">^-1</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> e cmiovi cmisi cmidi cmif cmifi cmimi 
     <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span> <span class="operator">simp_all</span><span class="main"><span class="keyword3">,</span></span><span class="operator">elim</span> disjE<span class="main"><span class="keyword3">,</span></span> <span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span>e<span class="main">)</span>
     
     <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> ir<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">i</span><span class="main">,</span><span class="skolem">r</span><span class="main">)</span> <span class="main">∈</span> m <span class="main">∪</span> b"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
     
     <span class="keyword1"><span class="command">from</span></span> qc  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">q</span><span class="main">,</span><span class="free">j</span><span class="main">)</span> <span class="main">∈</span>  ov <span class="main">∪</span> s <span class="main">∪</span> m <span class="main">∪</span> f<span class="main">¯</span> <span class="main">∪</span> d<span class="main">¯</span> <span class="main">∪</span> e <span class="main">∪</span> s<span class="main">¯</span>"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> BEGIN_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
     <span class="keyword1"><span class="command">with</span></span> rq <span class="keyword1"><span class="command">have</span></span> rj<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">r</span><span class="main">,</span><span class="free">j</span><span class="main">)</span> <span class="main">∈</span> b <span class="main">∪</span> m "</span></span> <span class="keyword1"><span class="command">using</span></span> cmov cms cmm cmfi cmdi e cmsi
     <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp_all</span><span class="main"><span class="keyword3">,</span></span> <span class="operator">elim</span> disjE<span class="main"><span class="keyword3">,</span></span> <span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span>e<span class="main">)</span>
     
     <span class="keyword1"><span class="command">with</span></span> ir <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">i</span><span class="main">,</span><span class="free">j</span><span class="main">)</span> <span class="main">∈</span> b"</span></span> <span class="keyword1"><span class="command">using</span></span> cmb cmm cbm cbb <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

   <span class="keyword1"><span class="command">next</span></span>
     <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">i</span><span class="main">,</span><span class="free">j</span><span class="main">)</span> <span class="main">∈</span> b"</span></span> <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"END <span class="free">i</span> <span class="main">≪</span> BEGIN <span class="free">j</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> intv1<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="free">j</span></span><span class="main">]</span> intv2<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="free">i</span></span><span class="main">]</span> assms before_def NEST_END NEST_BEGIN <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">lemma</span></span> END_END_before<span class="main">:</span>
<span class="keyword2"><span class="keyword">fixes</span></span> <span class="free">i</span> <span class="free">j</span>
<span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"ℐ <span class="free">i</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"ℐ <span class="free">j</span>"</span></span>
<span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"END <span class="free">i</span> <span class="main">≪</span> END <span class="free">j</span> <span class="main">=</span> <span class="main">(</span><span class="main">(</span><span class="free">i</span><span class="main">,</span><span class="free">j</span><span class="main">)</span> <span class="main">∈</span> b <span class="main">∪</span> m <span class="main">∪</span> ov <span class="main">∪</span> s <span class="main">∪</span> d<span class="main">)</span> "</span></span>
<span class="keyword1"><span class="command">proof</span></span> 
     <span class="keyword3"><span class="command">assume</span></span> a3<span class="main">:</span><span class="quoted"><span class="quoted">"END <span class="free">i</span> <span class="main">≪</span> END <span class="free">j</span>"</span></span>
     <span class="keyword1"><span class="command">from</span></span> a3 <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">p</span></span> <span class="skolem"><span class="skolem">q</span></span> <span class="keyword2"><span class="keyword">where</span></span> pa<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">p</span> <span class="main">∈</span> END <span class="free">i</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> qc<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">q</span> <span class="main">∈</span> END <span class="free">j</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> pq<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">p</span><span class="main">,</span><span class="skolem">q</span><span class="main">)</span> <span class="main">∈</span> b"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> before_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
     <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">r</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">p</span><span class="main">∥</span><span class="skolem">r</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">r</span><span class="main">∥</span><span class="skolem">q</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> b <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
     <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> pr<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">p</span><span class="main">,</span><span class="skolem">r</span><span class="main">)</span> <span class="main">∈</span> m"</span></span> <span class="keyword2"><span class="keyword">and</span></span> rq<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">r</span><span class="main">,</span><span class="skolem">q</span><span class="main">)</span> <span class="main">∈</span> m"</span></span> <span class="keyword1"><span class="command">using</span></span> m <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
     <span class="keyword1"><span class="command">from</span></span> pa  <span class="keyword1"><span class="command">have</span></span> pi<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">p</span><span class="main">,</span><span class="free">i</span><span class="main">)</span> <span class="main">∈</span>  e <span class="main">∪</span> ov<span class="main">¯</span> <span class="main">∪</span> s<span class="main">¯</span> <span class="main">∪</span> d<span class="main">¯</span> <span class="main">∪</span> f <span class="main">∪</span> f<span class="main">¯</span> <span class="main">∪</span> m<span class="main">¯</span>"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> END_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
     <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command"><span class="improper">with</span></span></span> pr <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">r</span><span class="main">,</span><span class="skolem">p</span><span class="main">)</span> <span class="main">∈</span> m<span class="main">^-1</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
     <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">r</span><span class="main">,</span><span class="free">i</span><span class="main">)</span> <span class="main">∈</span> m<span class="main">^-1</span> <span class="main">∪</span> b<span class="main">^-1</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> e cmiovi cmisi cmidi cmif cmifi cmimi 
     <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span> <span class="operator">simp_all</span><span class="main"><span class="keyword3">,</span></span><span class="operator">elim</span> disjE<span class="main"><span class="keyword3">,</span></span> <span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span>e<span class="main">)</span>
     
     <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> ir<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">i</span><span class="main">,</span><span class="skolem">r</span><span class="main">)</span> <span class="main">∈</span> m <span class="main">∪</span> b"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
     
     <span class="keyword1"><span class="command">from</span></span> qc  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">q</span><span class="main">,</span><span class="free">j</span><span class="main">)</span> <span class="main">∈</span> e <span class="main">∪</span> ov<span class="main">¯</span> <span class="main">∪</span> s<span class="main">¯</span> <span class="main">∪</span> d<span class="main">¯</span> <span class="main">∪</span> f <span class="main">∪</span> f<span class="main">¯</span> <span class="main">∪</span> m<span class="main">¯</span>"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> END_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
     <span class="keyword1"><span class="command">with</span></span> rq <span class="keyword1"><span class="command">have</span></span> rj<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">r</span><span class="main">,</span><span class="free">j</span><span class="main">)</span> <span class="main">∈</span> m <span class="main">∪</span> ov <span class="main">∪</span> s <span class="main">∪</span> d <span class="main">∪</span> b <span class="main">∪</span> f<span class="main">^-1</span> <span class="main">∪</span> e <span class="main">∪</span> f "</span></span> <span class="keyword1"><span class="command">using</span></span> e cmovi cmsi cmdi cmf cmfi cmmi
     <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp_all</span><span class="main"><span class="keyword3">,</span></span> <span class="operator">elim</span> disjE<span class="main"><span class="keyword3">,</span></span> <span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span>e<span class="main">)</span>
     
     <span class="keyword1"><span class="command">with</span></span> ir <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">i</span><span class="main">,</span><span class="free">j</span><span class="main">)</span> <span class="main">∈</span> b <span class="main">∪</span> m <span class="main">∪</span> ov <span class="main">∪</span> s <span class="main">∪</span> d"</span></span> <span class="keyword1"><span class="command">using</span></span> cmm cmov cms cmd cmb cmfi e cmf cbm cbov cbs cbd cbb cbfi cbf
     <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp_all</span><span class="main"><span class="keyword3">,</span></span> <span class="operator">elim</span> disjE<span class="main"><span class="keyword3">,</span></span> <span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span>e<span class="main">)</span>
    <span class="keyword1"><span class="command">next</span></span>
     <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">i</span><span class="main">,</span> <span class="free">j</span><span class="main">)</span> <span class="main">∈</span> b <span class="main">∪</span> m <span class="main">∪</span> ov <span class="main">∪</span> s <span class="main">∪</span> d"</span></span>
     <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"END <span class="free">i</span> <span class="main">≪</span> END <span class="free">j</span>"</span></span>
     <span class="keyword1"><span class="command">proof</span></span>  <span class="main">(</span> <span class="operator">simp_all</span><span class="main"><span class="keyword3">,</span></span><span class="operator">elim</span> disjE<span class="main"><span class="keyword3">,</span></span> <span class="operator">simp_all</span><span class="main">)</span>
        <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">i</span><span class="main">,</span><span class="free">j</span><span class="main">)</span> <span class="main">∈</span> b"</span></span> <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> intv2<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="free">i</span></span><span class="main">]</span> intv2<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="free">j</span></span><span class="main">]</span> assms NEST_END before_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
       <span class="keyword1"><span class="command">next</span></span>
        <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">i</span><span class="main">,</span><span class="free">j</span><span class="main">)</span> <span class="main">∈</span> m"</span></span> 
        <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">v</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="free">j</span><span class="main">∥</span><span class="skolem">v</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> M3 assms <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
        <span class="keyword1"><span class="command">with</span></span> <span class="quoted"><span class="quoted">‹<span class="main">(</span><span class="free">i</span><span class="main">,</span><span class="free">j</span><span class="main">)</span> <span class="main">∈</span> m›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">i</span><span class="main">,</span><span class="skolem">v</span><span class="main">)</span> <span class="main">∈</span>b"</span></span> <span class="keyword1"><span class="command">using</span></span> b m <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
        <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="free">j</span><span class="main">∥</span><span class="skolem">v</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">v</span> <span class="main">∈</span> END <span class="free">j</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> m END_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> intv2<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="free">i</span></span><span class="main">]</span> assms NEST_END before_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
       <span class="keyword1"><span class="command">next</span></span>
        <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">i</span><span class="main">,</span><span class="free">j</span><span class="main">)</span> <span class="main">:</span> ov"</span></span>
        <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">v</span></span> <span class="skolem"><span class="skolem">v'</span></span> <span class="keyword2"><span class="keyword">where</span></span> iv<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="free">i</span><span class="main">∥</span><span class="skolem">v</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> vvp<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">v</span><span class="main">∥</span><span class="skolem">v'</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">j</span><span class="main">∥</span><span class="skolem">v'</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> ov <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
        <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">v'</span> <span class="main">∈</span> END <span class="free">j</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> m END_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> iv vvp <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">i</span><span class="main">,</span><span class="skolem">v'</span><span class="main">)</span> <span class="main">∈</span> b"</span></span> <span class="keyword1"><span class="command">using</span></span> b <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> intv2<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="free">i</span></span><span class="main">]</span> assms NEST_END before_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
       <span class="keyword1"><span class="command">next</span></span>
        <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">i</span><span class="main">,</span><span class="free">j</span><span class="main">)</span> <span class="main">∈</span> s"</span></span>
        <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">v</span></span> <span class="skolem"><span class="skolem">v'</span></span> <span class="keyword2"><span class="keyword">where</span></span> iv<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="free">i</span><span class="main">∥</span><span class="skolem">v</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> vvp<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">v</span><span class="main">∥</span><span class="skolem">v'</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">j</span><span class="main">∥</span><span class="skolem">v'</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> s <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
        <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">v'</span> <span class="main">∈</span> END <span class="free">j</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> m END_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> iv vvp <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">i</span><span class="main">,</span><span class="skolem">v'</span><span class="main">)</span> <span class="main">∈</span> b"</span></span> <span class="keyword1"><span class="command">using</span></span> b <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> intv2<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="free">i</span></span><span class="main">]</span> assms NEST_END before_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
       <span class="keyword1"><span class="command">next</span></span>
        <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">i</span><span class="main">,</span><span class="free">j</span><span class="main">)</span> <span class="main">∈</span> d"</span></span>
        <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">v</span></span> <span class="skolem"><span class="skolem">v'</span></span> <span class="keyword2"><span class="keyword">where</span></span> iv<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="free">i</span><span class="main">∥</span><span class="skolem">v</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> vvp<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">v</span><span class="main">∥</span><span class="skolem">v'</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">j</span><span class="main">∥</span><span class="skolem">v'</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> d <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
        <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">v'</span> <span class="main">∈</span> END <span class="free">j</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> m END_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> iv vvp <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">i</span><span class="main">,</span><span class="skolem">v'</span><span class="main">)</span> <span class="main">∈</span> b"</span></span> <span class="keyword1"><span class="command">using</span></span> b <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> intv2<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="free">i</span></span><span class="main">]</span> assms NEST_END before_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
       <span class="keyword1"><span class="command">qed</span></span> 
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">lemma</span></span> overlaps<span class="main">:</span>
<span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"ℐ <span class="free">i</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"ℐ <span class="free">j</span>"</span></span>
<span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">i</span><span class="main">,</span><span class="free">j</span><span class="main">)</span> <span class="main">∈</span> ov <span class="main">=</span> <span class="main">(</span><span class="main">(</span>BEGIN <span class="free">i</span> <span class="main">≪</span> BEGIN <span class="free">j</span><span class="main">)</span> <span class="main">∧</span> <span class="main">(</span>BEGIN <span class="free">j</span> <span class="main">≪</span> END <span class="free">i</span><span class="main">)</span> <span class="main">∧</span> <span class="main">(</span>END <span class="free">i</span> <span class="main">≪</span> END <span class="free">j</span><span class="main">)</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> 

    <span class="keyword3"><span class="command">assume</span></span> a<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">i</span><span class="main">,</span><span class="free">j</span><span class="main">)</span> <span class="main">∈</span> ov"</span></span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">n</span></span> <span class="skolem"><span class="skolem">t</span></span> <span class="skolem"><span class="skolem">q</span></span>  <span class="skolem"><span class="skolem">u</span></span> <span class="skolem"><span class="skolem">v</span></span> <span class="keyword2"><span class="keyword">where</span></span> nt<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">n</span><span class="main">∥</span><span class="skolem">t</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> tj<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">t</span><span class="main">∥</span><span class="free">j</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> tq<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">t</span><span class="main">∥</span><span class="skolem">q</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> qu<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">q</span><span class="main">∥</span><span class="skolem">u</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span>  iu<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="free">i</span><span class="main">∥</span><span class="skolem">u</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> uv<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">u</span><span class="main">∥</span><span class="skolem">v</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> jv<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="free">j</span><span class="main">∥</span><span class="skolem">v</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">n</span><span class="main">∥</span><span class="free">i</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> ov <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> ni<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">n</span><span class="main">,</span><span class="free">i</span><span class="main">)</span> <span class="main">∈</span> m"</span></span>  <span class="keyword1"><span class="command">using</span></span>  m  <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span>  n<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">n</span> <span class="main">∈</span> BEGIN <span class="free">i</span>"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> BEGIN_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">from</span></span> nt tj <span class="keyword1"><span class="command">have</span></span> nj<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">n</span><span class="main">,</span><span class="free">j</span><span class="main">)</span> <span class="main">∈</span> b"</span></span> <span class="keyword1"><span class="command">using</span></span> b <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">have</span></span>  <span class="quoted"><span class="quoted">"<span class="free">j</span> <span class="main">∈</span> BEGIN <span class="free">j</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>2<span class="main">)</span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> intv1<span class="main">)</span>
    <span class="keyword1"><span class="command">with</span></span> assms n nj  <span class="keyword1"><span class="command">have</span></span> c1<span class="main">:</span><span class="quoted"><span class="quoted">"BEGIN <span class="free">i</span> <span class="main">≪</span> BEGIN <span class="free">j</span>"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> before_def <span class="keyword1"><span class="command">using</span></span> NEST_BEGIN <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  
    <span class="keyword1"><span class="command">from</span></span> tj <span class="keyword1"><span class="command">have</span></span> a1<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">t</span><span class="main">,</span><span class="free">j</span><span class="main">)</span> <span class="main">∈</span> m"</span></span> <span class="keyword2"><span class="keyword">and</span></span> a2<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">t</span> <span class="main">∈</span> BEGIN <span class="free">j</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> m BEGIN_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">from</span></span> iu <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">u</span><span class="main">,</span><span class="free">i</span><span class="main">)</span> <span class="main">∈</span> m<span class="main">^-1</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">u</span> <span class="main">∈</span> END <span class="free">i</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> m END_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">with</span></span> assms  tq qu a2 <span class="keyword1"><span class="command">have</span></span> c2<span class="main">:</span><span class="quoted"><span class="quoted">"BEGIN <span class="free">j</span> <span class="main">≪</span> END <span class="free">i</span>"</span></span>  <span class="keyword1"><span class="command">unfolding</span></span> before_def <span class="keyword1"><span class="command">using</span></span> b  NEST_BEGIN NEST_END <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>

    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">i</span> <span class="main">∈</span> END <span class="free">i</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> assms  intv2<span class="main">)</span> 
    <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command"><span class="improper">with</span></span></span> jv  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">v</span> <span class="main">∈</span> END <span class="free">j</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> m END_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command"><span class="improper">with</span></span></span> iu uv <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">i</span><span class="main">,</span><span class="skolem">v</span><span class="main">)</span> <span class="main">∈</span> b"</span></span> <span class="keyword1"><span class="command">using</span></span> b <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> c3<span class="main">:</span><span class="quoted"><span class="quoted">"END <span class="free">i</span> <span class="main">≪</span> END <span class="free">j</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms NEST_END before_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>

    <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">(</span>BEGIN <span class="free">i</span> <span class="main">≪</span> BEGIN <span class="free">j</span><span class="main">)</span> <span class="main">∧</span> <span class="main">(</span>BEGIN <span class="free">j</span> <span class="main">≪</span> END <span class="free">i</span><span class="main">)</span> <span class="main">∧</span> <span class="main">(</span>END <span class="free">i</span> <span class="main">≪</span> END <span class="free">j</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> c1 c2 c3 <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>     
  <span class="keyword1"><span class="command">next</span></span>
    <span class="keyword3"><span class="command">assume</span></span> a0<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">(</span>BEGIN <span class="free">i</span> <span class="main">≪</span> BEGIN <span class="free">j</span><span class="main">)</span> <span class="main">∧</span> <span class="main">(</span>BEGIN <span class="free">j</span> <span class="main">≪</span> END <span class="free">i</span><span class="main">)</span> <span class="main">∧</span> <span class="main">(</span>END <span class="free">i</span> <span class="main">≪</span> END <span class="free">j</span><span class="main">)</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">i</span><span class="main">,</span><span class="free">j</span><span class="main">)</span> <span class="main">∈</span> b <span class="main">∪</span> m <span class="main">∪</span> ov <span class="main">∪</span> f<span class="main">¯</span> <span class="main">∪</span> d<span class="main">¯</span> <span class="main">∧</span> <span class="main">(</span><span class="free">i</span><span class="main">,</span><span class="free">j</span><span class="main">)</span> <span class="main">∈</span> e <span class="main">∪</span> b<span class="main">^-1</span> <span class="main">∪</span> m<span class="main">^-1</span> <span class="main">∪</span> ov<span class="main">^-1</span> <span class="main">∪</span> ov <span class="main">∪</span> s<span class="main">^-1</span> <span class="main">∪</span> s <span class="main">∪</span> f<span class="main">^-1</span> <span class="main">∪</span> f <span class="main">∪</span> d<span class="main">^-1</span> <span class="main">∪</span> d
                                                                                                              <span class="main">∧</span> <span class="main">(</span><span class="free">i</span><span class="main">,</span><span class="free">j</span><span class="main">)</span> <span class="main">∈</span> b <span class="main">∪</span> m <span class="main">∪</span> ov <span class="main">∪</span> s <span class="main">∪</span> d"</span></span>
    <span class="keyword1"><span class="command">using</span></span> BEGIN_before BEGIN_END_before END_END_before assms 
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> <span class="main"><span class="main">(</span></span>no_types<span class="main"><span class="main">,</span></span> lifting<span class="main"><span class="main">)</span></span> converseD converse_Un converse_converse eei<span class="main">)</span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">i</span><span class="main">,</span><span class="free">j</span><span class="main">)</span> <span class="main">∈</span>  <span class="main">(</span>b <span class="main">∪</span> m <span class="main">∪</span> ov <span class="main">∪</span> f<span class="main">¯</span> <span class="main">∪</span> d<span class="main">¯</span><span class="main">)</span> <span class="main">∩</span> <span class="main">(</span>e <span class="main">∪</span> b<span class="main">^-1</span> <span class="main">∪</span> m<span class="main">^-1</span> <span class="main">∪</span> ov<span class="main">^-1</span> <span class="main">∪</span> ov <span class="main">∪</span> s<span class="main">^-1</span> <span class="main">∪</span> s <span class="main">∪</span> f<span class="main">^-1</span> <span class="main">∪</span> f <span class="main">∪</span> d<span class="main">^-1</span> <span class="main">∪</span> d<span class="main">)</span> <span class="main">∩</span> <span class="main">(</span>b <span class="main">∪</span> m <span class="main">∪</span> ov <span class="main">∪</span> s <span class="main">∪</span> d<span class="main">)</span>"</span></span> 
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span><span class="main">)</span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">i</span><span class="main">,</span><span class="free">j</span><span class="main">)</span> <span class="main">∈</span> ov"</span></span>
    <span class="keyword1"><span class="command">using</span></span> inter_ov <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>

<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">subsection</span></span> <span class="quoted"><span class="plain_text">‹Ordering of nests›</span></span>

<span class="keyword1"><span class="command">class</span></span>  strict_order <span class="main">=</span>
<span class="keyword2"><span class="keyword">fixes</span></span> <span class="free"><span class="free"><span class="free">ls</span></span></span><span class="main">::</span><span class="quoted"><span class="quoted">"<span class="tfree">'a</span> nest <span class="main">⇒</span> <span class="tfree">'a</span> nest <span class="main">⇒</span> bool"</span></span>
<span class="keyword2"><span class="keyword">assumes</span></span> 
  irrefl<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="main">¬</span> <span class="free">ls</span> <span class="free">a</span> <span class="free">a</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span>
  trans<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="free">ls</span> <span class="free">a</span> <span class="free">c</span> <span class="main">⟹</span> <span class="free">ls</span> <span class="free">c</span> <span class="free">g</span> <span class="main">⟹</span> <span class="free">ls</span> <span class="free">a</span> <span class="free">g</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> 
  asym<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="free">ls</span> <span class="free">a</span> <span class="free">c</span> <span class="main">⟹</span> <span class="main">¬</span> <span class="free">ls</span> <span class="free">c</span> <span class="free">a</span>"</span></span>  

<span class="keyword1"><span class="command">class</span></span> total_strict_order <span class="main">=</span> strict_order <span class="main">+</span>
<span class="keyword2"><span class="keyword">assumes</span></span> trichotomy<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">a</span> <span class="main">=</span> <span class="free">c</span> <span class="main">⟹</span> <span class="main">(</span><span class="main">¬</span> <span class="main">(</span>ls <span class="free">a</span>  <span class="free">c</span><span class="main">)</span> <span class="main">∧</span> <span class="main">¬</span> <span class="main">(</span>ls <span class="free">c</span>  <span class="free">a</span><span class="main">)</span><span class="main">)</span>"</span></span>

<span class="keyword1"><span class="command">interpretation</span></span> nest<span class="main">:</span>total_strict_order <span class="quoted"><span class="quoted">"<span class="main">(≪)</span> "</span></span>
<span class="keyword1"><span class="command">proof</span></span>
<span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">a</span><span class="main">::</span><span class="quoted"><span class="quoted">"<span class="tfree">'a</span> nest"</span></span>
<span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> <span class="skolem">a</span> <span class="main">≪</span> <span class="skolem">a</span>"</span></span>
<span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> before_irrefl<span class="main">)</span> <span class="keyword1"><span class="command">}</span></span> <span class="keyword1"><span class="command">note</span></span>  irrefl_nest <span class="main">=</span> this

<span class="keyword1"><span class="command">{</span></span><span class="keyword3"><span class="command">fix</span></span> <span class="skolem">a</span> <span class="skolem">c</span><span class="main">::</span><span class="quoted"><span class="quoted">"<span class="tfree">'a</span> nest"</span></span>
<span class="keyword3"><span class="command">assume</span></span>  <span class="quoted"><span class="quoted">"<span class="skolem">a</span> <span class="main">=</span> <span class="skolem">c</span>"</span></span>
<span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> <span class="skolem">a</span> <span class="main">≪</span> <span class="skolem">c</span> <span class="main">∧</span> <span class="main">¬</span> <span class="skolem">c</span> <span class="main">≪</span> <span class="skolem">a</span>"</span></span> 
<span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">a</span> <span class="main">=</span> <span class="skolem">c</span>›</span></span> irrefl_nest<span class="main">)</span><span class="keyword1"><span class="command">}</span></span> <span class="keyword1"><span class="command">note</span></span> trichotomy_nest <span class="main">=</span> this

<span class="keyword1"><span class="command">{</span></span><span class="keyword3"><span class="command">fix</span></span> <span class="skolem">a</span> <span class="skolem">c</span> <span class="skolem">g</span><span class="main">::</span><span class="quoted"><span class="quoted">"<span class="tfree">'a</span> nest"</span></span>
<span class="keyword3"><span class="command">assume</span></span> a<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">a</span> <span class="main">≪</span> <span class="skolem">c</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> c<span class="main">:</span><span class="quoted"><span class="quoted">" <span class="skolem">c</span> <span class="main">≪</span> <span class="skolem">g</span>"</span></span>
<span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">" <span class="skolem">a</span> <span class="main">≪</span> <span class="skolem">g</span>"</span></span> 
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
   <span class="keyword1"><span class="command">from</span></span> a c <span class="keyword1"><span class="command">have</span></span> na<span class="main">:</span><span class="quoted"><span class="quoted">"NEST <span class="skolem">a</span>"</span></span>  <span class="keyword2"><span class="keyword">and</span></span> nc<span class="main">:</span><span class="quoted"><span class="quoted">"NEST <span class="skolem">c</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> ng<span class="main">:</span><span class="quoted"><span class="quoted">"NEST <span class="skolem">g</span>"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> before_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
   <span class="keyword1"><span class="command">from</span></span> na <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">i</span></span> <span class="keyword2"><span class="keyword">where</span></span>  i<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">a</span> <span class="main">=</span> BEGIN <span class="skolem">i</span> <span class="main">∨</span> <span class="skolem">a</span> <span class="main">=</span> END <span class="skolem">i</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> wdi<span class="main">:</span><span class="quoted"><span class="quoted">"ℐ <span class="skolem">i</span>"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> NEST_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
   <span class="keyword1"><span class="command">from</span></span> nc <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">j</span></span> <span class="keyword2"><span class="keyword">where</span></span>  j<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">c</span> <span class="main">=</span> BEGIN <span class="skolem">j</span> <span class="main">∨</span> <span class="skolem">c</span> <span class="main">=</span> END <span class="skolem">j</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> wdj<span class="main">:</span><span class="quoted"><span class="quoted">"ℐ <span class="skolem">j</span>"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> NEST_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
   <span class="keyword1"><span class="command">from</span></span> ng <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">u</span></span> <span class="keyword2"><span class="keyword">where</span></span>  u<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">g</span> <span class="main">=</span> BEGIN <span class="skolem">u</span> <span class="main">∨</span> <span class="skolem">g</span> <span class="main">=</span> END <span class="skolem">u</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> wdu<span class="main">:</span><span class="quoted"><span class="quoted">"ℐ <span class="skolem">u</span>"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> NEST_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
   <span class="keyword1"><span class="command">from</span></span> i j u <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
   <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">elim</span> disjE<span class="main"><span class="keyword3">,</span></span> <span class="operator">auto</span><span class="main">)</span>
     <span class="keyword3"><span class="command">assume</span></span> abi<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">a</span> <span class="main">=</span> BEGIN <span class="skolem">i</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span>  cbj<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">c</span> <span class="main">=</span> BEGIN <span class="skolem">j</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span>  gbu<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">g</span> <span class="main">=</span> BEGIN <span class="skolem">u</span>"</span></span>
     <span class="keyword1"><span class="command">from</span></span> abi cbj a wdi wdj <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">i</span><span class="main">,</span><span class="skolem">j</span><span class="main">)</span> <span class="main">∈</span> b <span class="main">∪</span> m <span class="main">∪</span> ov <span class="main">∪</span> f<span class="main">¯</span> <span class="main">∪</span> d<span class="main">¯</span> "</span></span> <span class="keyword1"><span class="command">using</span></span> BEGIN_before <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
     <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> cbj gbu c wdj wdu <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">j</span><span class="main">,</span><span class="skolem">u</span><span class="main">)</span> <span class="main">∈</span> b <span class="main">∪</span> m <span class="main">∪</span> ov <span class="main">∪</span> f<span class="main">¯</span> <span class="main">∪</span> d<span class="main">¯</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> BEGIN_before <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

     <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> c1<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">i</span><span class="main">,</span><span class="skolem">u</span><span class="main">)</span> <span class="main">∈</span> b <span class="main">∪</span> m <span class="main">∪</span> ov <span class="main">∪</span> f<span class="main">^-1</span> <span class="main">∪</span> d<span class="main">^-1</span>"</span></span>
     <span class="keyword1"><span class="command">using</span></span> cbeta2_beta2 <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
      
     <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">a</span> <span class="main">≪</span> <span class="skolem">g</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> BEGIN_before abi gbu wdi wdu<span class="main">)</span>
    
     <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"BEGIN <span class="skolem">i</span> <span class="main">≪</span> BEGIN <span class="skolem">u</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> abi gbu <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">next</span></span>
     <span class="keyword3"><span class="command">assume</span></span>  abi<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">a</span> <span class="main">=</span> BEGIN <span class="skolem">i</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span>  cbj<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">c</span> <span class="main">=</span> BEGIN <span class="skolem">j</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span>  geu<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">g</span> <span class="main">=</span> END <span class="skolem">u</span>"</span></span> 
     <span class="keyword1"><span class="command">from</span></span> abi cbj a wdi wdj <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">i</span><span class="main">,</span><span class="skolem">j</span><span class="main">)</span> <span class="main">∈</span> b <span class="main">∪</span> m <span class="main">∪</span> ov <span class="main">∪</span> f<span class="main">¯</span> <span class="main">∪</span> d<span class="main">¯</span> "</span></span> <span class="keyword1"><span class="command">using</span></span> BEGIN_before <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
     <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> cbj geu c wdj wdu <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">j</span><span class="main">,</span><span class="skolem">u</span><span class="main">)</span> <span class="main">:</span>  e <span class="main">∪</span> b <span class="main">∪</span> m <span class="main">∪</span> ov <span class="main">∪</span> ov<span class="main">¯</span> <span class="main">∪</span> s <span class="main">∪</span> s<span class="main">¯</span> <span class="main">∪</span> f <span class="main">∪</span> f<span class="main">¯</span> <span class="main">∪</span> d <span class="main">∪</span> d<span class="main">¯</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> BEGIN_END_before <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
     <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">i</span><span class="main">,</span><span class="skolem">u</span><span class="main">)</span> <span class="main">∈</span> e <span class="main">∪</span> b <span class="main">∪</span> m <span class="main">∪</span> ov <span class="main">∪</span> ov<span class="main">¯</span> <span class="main">∪</span> s <span class="main">∪</span> s<span class="main">¯</span> <span class="main">∪</span> f <span class="main">∪</span> f<span class="main">¯</span> <span class="main">∪</span> d <span class="main">∪</span> d<span class="main">¯</span>"</span></span>
     <span class="keyword1"><span class="command">using</span></span> cbeta2_gammabm <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
          
     <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">a</span> <span class="main">≪</span> <span class="skolem">g</span>"</span></span> 
     <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> BEGIN_END_before abi geu wdi wdj wdu<span class="main">)</span>
       
     <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"BEGIN <span class="skolem">i</span> <span class="main">≪</span> END <span class="skolem">u</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> abi geu <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">next</span></span>
     <span class="keyword3"><span class="command">assume</span></span> abi<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">a</span> <span class="main">=</span> BEGIN <span class="skolem">i</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span>  cej<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">c</span> <span class="main">=</span> END <span class="skolem">j</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span>  gbu<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">g</span> <span class="main">=</span> BEGIN <span class="skolem">u</span>"</span></span>
     <span class="keyword1"><span class="command">from</span></span> abi cej a wdi wdj  <span class="keyword1"><span class="command">have</span></span> ij<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">i</span><span class="main">,</span><span class="skolem">j</span><span class="main">)</span> <span class="main">:</span>  e <span class="main">∪</span> b <span class="main">∪</span> m <span class="main">∪</span> ov <span class="main">∪</span> ov<span class="main">¯</span> <span class="main">∪</span> s <span class="main">∪</span> s<span class="main">¯</span> <span class="main">∪</span> f <span class="main">∪</span> f<span class="main">¯</span> <span class="main">∪</span> d <span class="main">∪</span> d<span class="main">¯</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> BEGIN_END_before <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
     <span class="keyword1"><span class="command">from</span></span> cej gbu c wdj wdu  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">j</span><span class="main">,</span><span class="skolem">u</span><span class="main">)</span> <span class="main">∈</span> b "</span></span> <span class="keyword1"><span class="command">using</span></span> END_BEGIN_before <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
     <span class="keyword1"><span class="command">with</span></span> ij <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">i</span><span class="main">,</span><span class="skolem">u</span><span class="main">)</span> <span class="main">∈</span> b <span class="main">∪</span> m <span class="main">∪</span> ov <span class="main">∪</span> f<span class="main">^-1</span> <span class="main">∪</span> d<span class="main">^-1</span>"</span></span> 
     <span class="keyword1"><span class="command">using</span></span> ebmovovissifsiddib <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span> <span class="operator">auto</span><span class="main">)</span>

     <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"BEGIN <span class="skolem">i</span> <span class="main">≪</span> BEGIN <span class="skolem">u</span>"</span></span>
     <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> BEGIN_before abi gbu wdi wdu<span class="main">)</span>
    <span class="keyword1"><span class="command">next</span></span>
     <span class="keyword3"><span class="command">assume</span></span> abi<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">a</span> <span class="main">=</span> BEGIN <span class="skolem">i</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span>  cej<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">c</span> <span class="main">=</span> END <span class="skolem">j</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span>  geu<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">g</span> <span class="main">=</span> END <span class="skolem">u</span>"</span></span>
     <span class="keyword1"><span class="command">with</span></span> a  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">i</span><span class="main">,</span><span class="skolem">j</span><span class="main">)</span> <span class="main">∈</span>  e <span class="main">∪</span> b <span class="main">∪</span> m <span class="main">∪</span> ov <span class="main">∪</span> ov<span class="main">¯</span> <span class="main">∪</span> s <span class="main">∪</span> s<span class="main">¯</span> <span class="main">∪</span> f <span class="main">∪</span> f<span class="main">¯</span> <span class="main">∪</span> d <span class="main">∪</span> d<span class="main">¯</span>"</span></span>
     <span class="keyword1"><span class="command">using</span></span> BEGIN_END_before wdi wdj <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
     <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> cej geu c wdj wdu  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">j</span><span class="main">,</span><span class="skolem">u</span><span class="main">)</span> <span class="main">∈</span> b <span class="main">∪</span> m <span class="main">∪</span> ov <span class="main">∪</span> s <span class="main">∪</span> d"</span></span>
     <span class="keyword1"><span class="command">using</span></span> END_END_before <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
     <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">i</span><span class="main">,</span><span class="skolem">u</span><span class="main">)</span> <span class="main">∈</span> b <span class="main">∪</span> m <span class="main">∪</span> ov <span class="main">∪</span> s <span class="main">∪</span> d <span class="main">∪</span> f<span class="main">^-1</span> <span class="main">∪</span> d<span class="main">^-1</span> <span class="main">∪</span> ov<span class="main">^-1</span> <span class="main">∪</span> s<span class="main">¯</span> <span class="main">∪</span> f <span class="main">∪</span> e"</span></span>
     <span class="keyword1"><span class="command">using</span></span> ebmovovissiffiddibmovsd <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
                  
     <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"BEGIN <span class="skolem">i</span> <span class="main">≪</span> END <span class="skolem">u</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> BEGIN_END_before wdi wdu  <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">next</span></span>
     <span class="keyword3"><span class="command">assume</span></span> aei<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">a</span> <span class="main">=</span> END <span class="skolem">i</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> cbj<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">c</span> <span class="main">=</span> BEGIN <span class="skolem">j</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> gbu<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">g</span> <span class="main">=</span> BEGIN <span class="skolem">u</span>"</span></span>
     <span class="keyword1"><span class="command">from</span></span> a  aei cbj wdi wdj <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">i</span><span class="main">,</span><span class="skolem">j</span><span class="main">)</span> <span class="main">∈</span> b"</span></span>
     <span class="keyword1"><span class="command">using</span></span> END_BEGIN_before <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
     <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> c  cbj gbu wdj wdu <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">j</span><span class="main">,</span><span class="skolem">u</span><span class="main">)</span> <span class="main">∈</span> b <span class="main">∪</span> m <span class="main">∪</span> ov <span class="main">∪</span> f<span class="main">¯</span> <span class="main">∪</span> d<span class="main">¯</span>"</span></span> 
     <span class="keyword1"><span class="command">using</span></span> BEGIN_before <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span> 
     <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">i</span><span class="main">,</span><span class="skolem">u</span><span class="main">)</span> <span class="main">:</span> b"</span></span> <span class="keyword1"><span class="command">using</span></span> cbb cbm cbov cbfi cbdi 
     <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp_all</span><span class="main"><span class="keyword3">,</span></span> <span class="operator">elim</span> disjE<span class="main"><span class="keyword3">,</span></span> <span class="operator">auto</span><span class="main">)</span>
     <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"END <span class="skolem">i</span> <span class="main">≪</span> BEGIN <span class="skolem">u</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> END_BEGIN_before wdi wdu  <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">next</span></span>
     <span class="keyword3"><span class="command">assume</span></span>  aei<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">a</span> <span class="main">=</span> END <span class="skolem">i</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> cbj<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">c</span> <span class="main">=</span> BEGIN <span class="skolem">j</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span>  geu<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">g</span> <span class="main">=</span> END <span class="skolem">u</span>"</span></span>
     <span class="keyword1"><span class="command">from</span></span> a  aei cbj wdi wdj <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">i</span><span class="main">,</span><span class="skolem">j</span><span class="main">)</span> <span class="main">∈</span> b"</span></span>
     <span class="keyword1"><span class="command">using</span></span> END_BEGIN_before <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
     <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> c  cbj geu wdj wdu <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">j</span><span class="main">,</span><span class="skolem">u</span><span class="main">)</span> <span class="main">∈</span> e <span class="main">∪</span> b <span class="main">∪</span> m <span class="main">∪</span> ov <span class="main">∪</span> ov<span class="main">¯</span> <span class="main">∪</span> s <span class="main">∪</span> s<span class="main">¯</span> <span class="main">∪</span> f <span class="main">∪</span> f<span class="main">¯</span> <span class="main">∪</span> d <span class="main">∪</span> d<span class="main">¯</span>"</span></span> 
     <span class="keyword1"><span class="command">using</span></span> BEGIN_END_before <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span> 
     <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">i</span><span class="main">,</span><span class="skolem">u</span><span class="main">)</span> <span class="main">∈</span> b <span class="main">∪</span> m <span class="main">∪</span> ov <span class="main">∪</span> s <span class="main">∪</span> d"</span></span>
     <span class="keyword1"><span class="command">using</span></span> bebmovovissiffiddi <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
     <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"END <span class="skolem">i</span> <span class="main">≪</span> END <span class="skolem">u</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> END_END_before wdi wdu <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">next</span></span>
     <span class="keyword3"><span class="command">assume</span></span> aei<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">a</span> <span class="main">=</span> END <span class="skolem">i</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> cej<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">c</span> <span class="main">=</span> END <span class="skolem">j</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span>  gbu<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">g</span> <span class="main">=</span> BEGIN <span class="skolem">u</span>"</span></span> 
     <span class="keyword1"><span class="command">from</span></span> aei cej wdi wdj <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">i</span><span class="main">,</span><span class="skolem">j</span><span class="main">)</span> <span class="main">∈</span> b <span class="main">∪</span> m <span class="main">∪</span> ov <span class="main">∪</span> s <span class="main">∪</span> d"</span></span> <span class="keyword1"><span class="command">using</span></span> END_END_before a <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
     <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> cej gbu c wdj wdu <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">j</span><span class="main">,</span><span class="skolem">u</span><span class="main">)</span> <span class="main">∈</span> b"</span></span> <span class="keyword1"><span class="command">using</span></span> END_BEGIN_before <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
     <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">i</span><span class="main">,</span><span class="skolem">u</span><span class="main">)</span> <span class="main">∈</span> b"</span></span>
     <span class="keyword1"><span class="command">using</span></span> cbb cmb covb csb cdb
     <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp_all</span><span class="main"><span class="keyword3">,</span></span> <span class="operator">elim</span> disjE<span class="main"><span class="keyword3">,</span></span> <span class="operator">auto</span><span class="main">)</span>
     <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"END <span class="skolem">i</span> <span class="main">≪</span> BEGIN <span class="skolem">u</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> END_BEGIN_before wdi wdu  <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">next</span></span>
     <span class="keyword3"><span class="command">assume</span></span> aei<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">a</span> <span class="main">=</span> END <span class="skolem">i</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> cej<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">c</span> <span class="main">=</span> END <span class="skolem">j</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> geu<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">g</span> <span class="main">=</span> END <span class="skolem">u</span>"</span></span>
     <span class="keyword1"><span class="command">from</span></span> aei cej wdi wdj  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">i</span><span class="main">,</span><span class="skolem">j</span><span class="main">)</span> <span class="main">∈</span> b <span class="main">∪</span> m <span class="main">∪</span> ov <span class="main">∪</span> s <span class="main">∪</span> d"</span></span> <span class="keyword1"><span class="command">using</span></span>  END_END_before a <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
     <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> cej geu c wdj wdu <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">j</span><span class="main">,</span><span class="skolem">u</span><span class="main">)</span> <span class="main">∈</span>  b <span class="main">∪</span> m <span class="main">∪</span> ov <span class="main">∪</span> s <span class="main">∪</span> d"</span></span> <span class="keyword1"><span class="command">using</span></span> END_END_before <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
     <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">i</span><span class="main">,</span><span class="skolem">u</span><span class="main">)</span> <span class="main">∈</span> b <span class="main">∪</span> m <span class="main">∪</span> ov <span class="main">∪</span> s <span class="main">∪</span> d"</span></span> 
     <span class="keyword1"><span class="command">using</span></span> calpha1_alpha1 <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
     <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"END <span class="skolem">i</span> <span class="main">≪</span> END <span class="skolem">u</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> END_END_before wdi wdu <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
   <span class="keyword1"><span class="command">qed</span></span>
<span class="keyword1"><span class="command">qed</span></span><span class="keyword1"><span class="command">}</span></span> <span class="keyword1"><span class="command">note</span></span> trans_nest <span class="main">=</span> this    

<span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">a</span> <span class="skolem">c</span><span class="main">::</span><span class="quoted"><span class="quoted">"<span class="tfree">'a</span> nest"</span></span>
  <span class="keyword3"><span class="command">assume</span></span> a<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">a</span> <span class="main">≪</span> <span class="skolem">c</span>"</span></span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> <span class="skolem">c</span> <span class="main">≪</span> <span class="skolem">a</span>"</span></span>
  <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">rule</span> ccontr<span class="main"><span class="keyword3">,</span></span> <span class="operator">auto</span><span class="main">)</span>
  <span class="keyword1"><span class="command">using</span></span> a  irrefl_nest trans_nest <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span><span class="keyword1"><span class="command">}</span></span>
<span class="keyword1"><span class="command">qed</span></span>  
         
<span class="keyword2"><span class="keyword">end</span></span>

</pre>
</div>
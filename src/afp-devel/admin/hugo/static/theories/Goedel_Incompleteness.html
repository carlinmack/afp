<div id="Deduction2">
<div class="head">
<h1>Theory Deduction2</h1>
</div>
<pre class="source"><span class="keyword1"><span class="command">chapter</span></span> <span class="quoted"><span class="plain_text">‹Deduction with Two Provability Relations›</span></span>
<span class="comment1">(*&lt;*)</span>
<span class="keyword1"><span class="command">theory</span></span> Deduction2 <span class="keyword2"><span class="keyword">imports</span></span> <span class="quoted">"<a href="../Syntax_Independent_Logic/Deduction.html">Syntax_Independent_Logic.Deduction</a>"</span>
<span class="keyword2"><span class="keyword">begin</span></span>
<span class="comment1">(*&gt;*)</span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹We work with two provability relations:
provability <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">term</span></span> <span class="quoted"><span class="free"><span class="quoted"><span class="free">prv</span></span></span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span> and basic provability <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">term</span></span> <span class="quoted"><span class="free"><span class="quoted"><span class="free">bprv</span></span></span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span>.›</span></span>

<span class="keyword1"><span class="command">section</span></span> <span class="quoted"><span class="plain_text">‹From Deduction with One Provability Relation to Two›</span></span>

<span class="keyword1"><span class="command">locale</span></span> Deduct2 <span class="main">=</span>
Deduct
  <span class="quoted"><span class="free">var</span></span> <span class="quoted"><span class="free">trm</span></span> <span class="quoted"><span class="free">fmla</span></span> <span class="quoted"><span class="free">Var</span></span> <span class="quoted"><span class="free">FvarsT</span></span> <span class="quoted"><span class="free">substT</span></span> <span class="quoted"><span class="free">Fvars</span></span> <span class="quoted"><span class="free">subst</span></span>
  <span class="quoted"><span class="free">num</span></span>
  <span class="quoted"><span class="free">eql</span></span> <span class="quoted"><span class="free">cnj</span></span> <span class="quoted"><span class="free">imp</span></span> <span class="quoted"><span class="free">all</span></span> <span class="quoted"><span class="free">exi</span></span>
  <span class="quoted"><span class="free">prv</span></span>
<span class="main">+</span>
B<span class="main">:</span> Deduct
  <span class="quoted"><span class="free">var</span></span> <span class="quoted"><span class="free">trm</span></span> <span class="quoted"><span class="free">fmla</span></span> <span class="quoted"><span class="free">Var</span></span> <span class="quoted"><span class="free">FvarsT</span></span> <span class="quoted"><span class="free">substT</span></span> <span class="quoted"><span class="free">Fvars</span></span> <span class="quoted"><span class="free">subst</span></span>
  <span class="quoted"><span class="free">num</span></span>
  <span class="quoted"><span class="free">eql</span></span> <span class="quoted"><span class="free">cnj</span></span> <span class="quoted"><span class="free">imp</span></span> <span class="quoted"><span class="free">all</span></span> <span class="quoted"><span class="free">exi</span></span>
  <span class="quoted"><span class="free">bprv</span></span>
<span class="keyword2"><span class="keyword">for</span></span>
<span class="free">var</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'var</span> set"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="free">trm</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'trm</span> set"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="free">fmla</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'fmla</span> set"</span></span>
<span class="keyword2"><span class="keyword">and</span></span> <span class="free">Var</span> <span class="free">FvarsT</span> <span class="free">substT</span> <span class="free">Fvars</span> <span class="free">subst</span>
<span class="keyword2"><span class="keyword">and</span></span> <span class="free">num</span>
<span class="keyword2"><span class="keyword">and</span></span> <span class="free">eql</span> <span class="free">cnj</span> <span class="free">imp</span> <span class="free">all</span> <span class="free">exi</span>
<span class="keyword2"><span class="keyword">and</span></span> <span class="free">prv</span> <span class="free">bprv</span>
<span class="main">+</span>
<span class="keyword2"><span class="keyword">assumes</span></span> bprv_prv<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">⋀</span><span class="bound">φ</span><span class="main">.</span> <span class="bound">φ</span> <span class="main">∈</span> <span class="free">fmla</span> <span class="main">⟹</span> <span class="free">Fvars</span> <span class="bound">φ</span> <span class="main">=</span> <span class="main">{}</span> <span class="main">⟹</span> <span class="free">bprv</span> <span class="bound">φ</span> <span class="main">⟹</span> <span class="free">prv</span> <span class="bound">φ</span>"</span></span>
<span class="keyword2"><span class="keyword">begin</span></span>

<span class="comment1">(* Removing the sentence (empty Fvars) hypothesis from bprv_prv *)</span>
<span class="keyword1"><span class="command">lemma</span></span> bprv_prv'<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> φ<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">φ</span> <span class="main">∈</span> <span class="free">fmla</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> b<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">bprv</span> <span class="free">φ</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">prv</span> <span class="free">φ</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
  <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">V</span></span> <span class="keyword2"><span class="keyword">where</span></span> V<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">Fvars</span> <span class="free">φ</span> <span class="main">=</span> <span class="skolem">V</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">have</span></span> VV<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">V</span> <span class="main">⊆</span> <span class="free">var</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> Fvars V φ <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">have</span></span> f<span class="main">:</span> <span class="quoted"><span class="quoted">"finite <span class="skolem">V</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> V finite_Fvars<span class="main">[</span><span class="operator">OF</span> φ<span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> φ b V VV
  <span class="keyword1"><span class="command">proof</span></span><span class="main">(</span><span class="operator">induction</span> <span class="quoted"><span class="skolem">V</span></span> <span class="quasi_keyword">arbitrary</span><span class="main"><span class="main">:</span></span> <span class="quoted"><span class="free">φ</span></span> <span class="quasi_keyword">rule</span><span class="main"><span class="main">:</span></span> finite.induct<span class="main">)</span>
    <span class="keyword3"><span class="command">case</span></span> <span class="main">(</span>emptyI <span class="skolem">φ</span><span class="main">)</span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?case</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> bprv_prv<span class="main">)</span>
  <span class="keyword1"><span class="command">next</span></span>
    <span class="keyword3"><span class="command">case</span></span> <span class="main">(</span>insertI <span class="skolem">W</span> <span class="skolem">v</span> <span class="skolem">φ</span><span class="main">)</span>
    <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?case</span></span></span> <span class="keyword1"><span class="command">proof</span></span><span class="main">(</span><span class="operator">cases</span> <span class="quoted"><span class="quoted">"<span class="skolem">v</span> <span class="main">∈</span> <span class="skolem">W</span>"</span></span><span class="main">)</span>
      <span class="keyword3"><span class="command">case</span></span> True
      <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
      <span class="keyword1"><span class="command">using</span></span> insertI.IH<span class="main">[</span><span class="operator">OF</span> <span class="quoted"><span class="quoted">‹<span class="skolem">φ</span> <span class="main">∈</span> <span class="free">fmla</span>›</span></span><span class="main">]</span> insertI.prems
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> insert_absorb<span class="main">)</span>
    <span class="keyword1"><span class="command">next</span></span>
      <span class="keyword3"><span class="command">case</span></span> False
      <span class="keyword1"><span class="command">hence</span></span> 1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">Fvars</span> <span class="main">(</span><span class="free">all</span> <span class="skolem">v</span> <span class="skolem">φ</span><span class="main">)</span> <span class="main">=</span> <span class="skolem">W</span>"</span></span>
        <span class="keyword1"><span class="command">using</span></span> insertI.prems <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">bprv</span> <span class="main">(</span><span class="free">all</span> <span class="skolem">v</span> <span class="skolem">φ</span><span class="main">)</span>"</span></span>
        <span class="keyword1"><span class="command">using</span></span> B.prv_all_gen insertI.prems <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">prv</span> <span class="main">(</span><span class="free">all</span> <span class="skolem">v</span> <span class="skolem">φ</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> insertI <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> allE_id insertI.prems <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
    <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">qed</span></span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword2"><span class="keyword">end</span></span> <span class="comment1">― ‹context <span class="antiquoted"><span class="antiquote">@{</span><span class="operator">locale</span> Deduct2<span class="antiquote">}</span></span>›</span>


<span class="keyword1"><span class="command">locale</span></span> Deduct2_with_False <span class="main">=</span>
Deduct_with_False
  <span class="quoted"><span class="free">var</span></span> <span class="quoted"><span class="free">trm</span></span> <span class="quoted"><span class="free">fmla</span></span> <span class="quoted"><span class="free">Var</span></span> <span class="quoted"><span class="free">FvarsT</span></span> <span class="quoted"><span class="free">substT</span></span> <span class="quoted"><span class="free">Fvars</span></span> <span class="quoted"><span class="free">subst</span></span>
  <span class="quoted"><span class="free">eql</span></span> <span class="quoted"><span class="free">cnj</span></span> <span class="quoted"><span class="free">imp</span></span> <span class="quoted"><span class="free">all</span></span> <span class="quoted"><span class="free">exi</span></span>
  <span class="quoted"><span class="free">fls</span></span>
  <span class="quoted"><span class="free">num</span></span>
  <span class="quoted"><span class="free">prv</span></span>
<span class="main">+</span>
B<span class="main">:</span> Deduct_with_False
  <span class="quoted"><span class="free">var</span></span> <span class="quoted"><span class="free">trm</span></span> <span class="quoted"><span class="free">fmla</span></span> <span class="quoted"><span class="free">Var</span></span> <span class="quoted"><span class="free">FvarsT</span></span> <span class="quoted"><span class="free">substT</span></span> <span class="quoted"><span class="free">Fvars</span></span> <span class="quoted"><span class="free">subst</span></span>
  <span class="quoted"><span class="free">eql</span></span> <span class="quoted"><span class="free">cnj</span></span> <span class="quoted"><span class="free">imp</span></span> <span class="quoted"><span class="free">all</span></span> <span class="quoted"><span class="free">exi</span></span>
  <span class="quoted"><span class="free">fls</span></span>
  <span class="quoted"><span class="free">num</span></span>
  <span class="quoted"><span class="free">bprv</span></span>
<span class="keyword2"><span class="keyword">for</span></span>
<span class="free">var</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'var</span> set"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="free">trm</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'trm</span> set"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="free">fmla</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'fmla</span> set"</span></span>
<span class="keyword2"><span class="keyword">and</span></span> <span class="free">Var</span> <span class="free">FvarsT</span> <span class="free">substT</span> <span class="free">Fvars</span> <span class="free">subst</span>
<span class="keyword2"><span class="keyword">and</span></span> <span class="free">eql</span> <span class="free">cnj</span> <span class="free">imp</span> <span class="free">all</span> <span class="free">exi</span>
<span class="keyword2"><span class="keyword">and</span></span> <span class="free">fls</span>
<span class="keyword2"><span class="keyword">and</span></span> <span class="free">num</span>
<span class="keyword2"><span class="keyword">and</span></span> <span class="free">prv</span> <span class="free">bprv</span>
<span class="main">+</span>
<span class="keyword2"><span class="keyword">assumes</span></span> bprv_prv<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">⋀</span><span class="bound">φ</span><span class="main">.</span> <span class="bound">φ</span> <span class="main">∈</span> <span class="free">fmla</span> <span class="main">⟹</span> <span class="free">Fvars</span> <span class="bound">φ</span> <span class="main">=</span> <span class="main">{}</span> <span class="main">⟹</span> <span class="free">bprv</span> <span class="bound">φ</span> <span class="main">⟹</span> <span class="free">prv</span> <span class="bound">φ</span>"</span></span>

<span class="keyword1"><span class="command">sublocale</span></span> Deduct2_with_False <span class="main">&lt;</span> d_dwf<span class="main">:</span> Deduct2
  <span class="keyword1"><span class="command">by</span></span> <span class="operator">standard</span> <span class="main">(</span><span class="operator">fact</span> bprv_prv<span class="main">)</span>

<span class="keyword1"><span class="command">context</span></span> Deduct2_with_False <span class="keyword2"><span class="keyword">begin</span></span>

<span class="keyword1"><span class="command">lemma</span></span> consistent_B_consistent<span class="main">:</span> <span class="quoted"><span class="quoted">"consistent <span class="main">⟹</span> B.consistent"</span></span>
  <span class="keyword1"><span class="command">using</span></span> B.consistent_def bprv_prv consistent_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>

<span class="keyword2"><span class="keyword">end</span></span> <span class="comment1">― ‹context <span class="antiquoted"><span class="antiquote">@{</span><span class="operator">locale</span> Deduct2_with_False<span class="antiquote">}</span></span>›</span>

<span class="keyword1"><span class="command">locale</span></span> Deduct2_with_False_Disj <span class="main">=</span>
Deduct_with_False_Disj
  <span class="quoted"><span class="free">var</span></span> <span class="quoted"><span class="free">trm</span></span> <span class="quoted"><span class="free">fmla</span></span> <span class="quoted"><span class="free">Var</span></span> <span class="quoted"><span class="free">FvarsT</span></span> <span class="quoted"><span class="free">substT</span></span> <span class="quoted"><span class="free">Fvars</span></span> <span class="quoted"><span class="free">subst</span></span>
  <span class="quoted"><span class="free">eql</span></span> <span class="quoted"><span class="free">cnj</span></span> <span class="quoted"><span class="free">imp</span></span> <span class="quoted"><span class="free">all</span></span> <span class="quoted"><span class="free">exi</span></span>
  <span class="quoted"><span class="free">fls</span></span>
  <span class="quoted"><span class="free">dsj</span></span>
  <span class="quoted"><span class="free">num</span></span>
  <span class="quoted"><span class="free">prv</span></span>
<span class="main">+</span>
B<span class="main">:</span> Deduct_with_False_Disj
  <span class="quoted"><span class="free">var</span></span> <span class="quoted"><span class="free">trm</span></span> <span class="quoted"><span class="free">fmla</span></span> <span class="quoted"><span class="free">Var</span></span> <span class="quoted"><span class="free">FvarsT</span></span> <span class="quoted"><span class="free">substT</span></span> <span class="quoted"><span class="free">Fvars</span></span> <span class="quoted"><span class="free">subst</span></span>
  <span class="quoted"><span class="free">eql</span></span> <span class="quoted"><span class="free">cnj</span></span> <span class="quoted"><span class="free">imp</span></span> <span class="quoted"><span class="free">all</span></span> <span class="quoted"><span class="free">exi</span></span>
  <span class="quoted"><span class="free">fls</span></span>
  <span class="quoted"><span class="free">dsj</span></span>
  <span class="quoted"><span class="free">num</span></span>
  <span class="quoted"><span class="free">bprv</span></span>
<span class="keyword2"><span class="keyword">for</span></span>
<span class="free">var</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'var</span> set"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="free">trm</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'trm</span> set"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="free">fmla</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'fmla</span> set"</span></span>
<span class="keyword2"><span class="keyword">and</span></span> <span class="free">Var</span> <span class="free">FvarsT</span> <span class="free">substT</span> <span class="free">Fvars</span> <span class="free">subst</span>
<span class="keyword2"><span class="keyword">and</span></span> <span class="free">eql</span> <span class="free">cnj</span> <span class="free">imp</span> <span class="free">all</span> <span class="free">exi</span>
<span class="keyword2"><span class="keyword">and</span></span> <span class="free">fls</span>
<span class="keyword2"><span class="keyword">and</span></span> <span class="free">dsj</span>
<span class="keyword2"><span class="keyword">and</span></span> <span class="free">num</span>
<span class="keyword2"><span class="keyword">and</span></span> <span class="free">prv</span> <span class="free">bprv</span>
<span class="main">+</span>
<span class="keyword2"><span class="keyword">assumes</span></span> bprv_prv<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">⋀</span><span class="bound">φ</span><span class="main">.</span> <span class="bound">φ</span> <span class="main">∈</span> <span class="free">fmla</span> <span class="main">⟹</span> <span class="free">Fvars</span> <span class="bound">φ</span> <span class="main">=</span> <span class="main">{}</span> <span class="main">⟹</span> <span class="free">bprv</span> <span class="bound">φ</span> <span class="main">⟹</span> <span class="free">prv</span> <span class="bound">φ</span>"</span></span>

<span class="keyword1"><span class="command">sublocale</span></span> Deduct2_with_False_Disj <span class="main">&lt;</span> dwf_dwfd<span class="main">:</span> Deduct2_with_False
  <span class="keyword1"><span class="command">by</span></span> <span class="operator">standard</span> <span class="main">(</span><span class="operator">fact</span> bprv_prv<span class="main">)</span>

<span class="comment1">(* Factoring in a strict-order-like relation (not actually required to be an order): *)</span>
<span class="keyword1"><span class="command">locale</span></span> Deduct2_with_PseudoOrder <span class="main">=</span>
Deduct2_with_False_Disj
  <span class="quoted"><span class="free">var</span></span> <span class="quoted"><span class="free">trm</span></span> <span class="quoted"><span class="free">fmla</span></span> <span class="quoted"><span class="free">Var</span></span> <span class="quoted"><span class="free">FvarsT</span></span> <span class="quoted"><span class="free">substT</span></span> <span class="quoted"><span class="free">Fvars</span></span> <span class="quoted"><span class="free">subst</span></span>
  <span class="quoted"><span class="free">eql</span></span> <span class="quoted"><span class="free">cnj</span></span> <span class="quoted"><span class="free">imp</span></span> <span class="quoted"><span class="free">all</span></span> <span class="quoted"><span class="free">exi</span></span>
  <span class="quoted"><span class="free">fls</span></span>
  <span class="quoted"><span class="free">dsj</span></span>
  <span class="quoted"><span class="free">num</span></span>
  <span class="quoted"><span class="free">prv</span></span> <span class="quoted"><span class="free">bprv</span></span>
<span class="main">+</span>
Syntax_PseudoOrder
  <span class="quoted"><span class="free">var</span></span> <span class="quoted"><span class="free">trm</span></span> <span class="quoted"><span class="free">fmla</span></span> <span class="quoted"><span class="free">Var</span></span> <span class="quoted"><span class="free">FvarsT</span></span> <span class="quoted"><span class="free">substT</span></span> <span class="quoted"><span class="free">Fvars</span></span> <span class="quoted"><span class="free">subst</span></span>
  <span class="quoted"><span class="free">eql</span></span> <span class="quoted"><span class="free">cnj</span></span> <span class="quoted"><span class="free">imp</span></span> <span class="quoted"><span class="free">all</span></span> <span class="quoted"><span class="free">exi</span></span>
  <span class="quoted"><span class="free">fls</span></span>
  <span class="quoted"><span class="free">dsj</span></span>
  <span class="quoted"><span class="free">num</span></span>
  <span class="quoted"><span class="free">Lq</span></span>
<span class="keyword2"><span class="keyword">for</span></span>
<span class="free">var</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'var</span> set"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="free">trm</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'trm</span> set"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="free">fmla</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'fmla</span> set"</span></span>
<span class="keyword2"><span class="keyword">and</span></span> <span class="free">Var</span> <span class="free">FvarsT</span> <span class="free">substT</span> <span class="free">Fvars</span> <span class="free">subst</span>
<span class="keyword2"><span class="keyword">and</span></span> <span class="free">eql</span> <span class="free">cnj</span> <span class="free">imp</span> <span class="free">all</span> <span class="free">exi</span>
<span class="keyword2"><span class="keyword">and</span></span> <span class="free">fls</span>
<span class="keyword2"><span class="keyword">and</span></span> <span class="free">dsj</span>
<span class="keyword2"><span class="keyword">and</span></span> <span class="free">num</span>
<span class="keyword2"><span class="keyword">and</span></span> <span class="free">prv</span> <span class="free">bprv</span>
<span class="keyword2"><span class="keyword">and</span></span> <span class="free">Lq</span>
<span class="main">+</span>
<span class="keyword2"><span class="keyword">assumes</span></span>
<span class="comment1">(* We do not assume any ordering properties, but only these two axioms, Lq_num and Lq_num2,
which (interestingly) would be satisfied by both ≤ and &lt; within a sufficiently strong
arithmetic such as Robinson's Q *)</span>
<span class="comment1">(* For each formula φ(z) and numeral q, if φ(p) is provable for all p
then ∀ z ≤ q. φ(z) is provable.
(Note that a more natural property would assume φ(p) is provable for all p≤q,
but we can get away with the stronger assumption (on the left of the implication). )
*)</span>
Lq_num<span class="main">:</span>
<span class="quoted"><span class="quoted">"<span class="keyword1">let</span> <span class="bound">LLq</span> <span class="main">=</span> <span class="main">(</span><span class="main">λ</span> <span class="bound">t1</span> <span class="bound">t2</span><span class="main">.</span> psubst <span class="free">Lq</span> <span class="main">[</span><span class="main">(</span><span class="bound">t1</span><span class="main">,</span>zz<span class="main">)</span><span class="main">,</span> <span class="main">(</span><span class="bound">t2</span><span class="main">,</span>yy<span class="main">)</span><span class="main">]</span><span class="main">)</span> <span class="keyword1">in</span>
 <span class="main">∀</span> <span class="bound">φ</span> <span class="main">∈</span> <span class="free">fmla</span><span class="main">.</span> <span class="main">∀</span> <span class="bound">q</span> <span class="main">∈</span> <span class="free">num</span><span class="main">.</span> <span class="free">Fvars</span> <span class="bound">φ</span> <span class="main">=</span> <span class="main">{</span>zz<span class="main">}</span> <span class="main">∧</span> <span class="main">(</span><span class="main">∀</span> <span class="bound">p</span> <span class="main">∈</span> <span class="free">num</span><span class="main">.</span> <span class="free">bprv</span> <span class="main">(</span><span class="free">subst</span> <span class="bound">φ</span> <span class="bound">p</span> zz<span class="main">)</span><span class="main">)</span>
    <span class="main">⟶</span> <span class="free">prv</span> <span class="main">(</span><span class="free">all</span> zz <span class="main">(</span><span class="free">imp</span> <span class="main">(</span><span class="bound">LLq</span> <span class="main">(</span><span class="free">Var</span> zz<span class="main">)</span> <span class="bound">q</span><span class="main">)</span> <span class="bound">φ</span><span class="main">)</span><span class="main">)</span>"</span></span>
<span class="keyword2"><span class="keyword">and</span></span>
<span class="comment1">(* For each numeral p, there exists a finite set P such that it is provable that
∀ y. (⋁p∈P. x = p) ∨ y ≤ p
(where we write ≤ instead of Lq, but could also think of &lt;):
*)</span>
Lq_num2<span class="main">:</span>
<span class="quoted"><span class="quoted">"<span class="keyword1">let</span> <span class="bound">LLq</span> <span class="main">=</span> <span class="main">(</span><span class="main">λ</span> <span class="bound">t1</span> <span class="bound">t2</span><span class="main">.</span> psubst <span class="free">Lq</span> <span class="main">[</span><span class="main">(</span><span class="bound">t1</span><span class="main">,</span>zz<span class="main">)</span><span class="main">,</span> <span class="main">(</span><span class="bound">t2</span><span class="main">,</span>yy<span class="main">)</span><span class="main">]</span><span class="main">)</span> <span class="keyword1">in</span>
 <span class="main">∀</span> <span class="bound">p</span> <span class="main">∈</span> <span class="free">num</span><span class="main">.</span> <span class="main">∃</span> <span class="bound"><span class="bound">P</span></span> <span class="main">⊆</span> <span class="free">num</span><span class="main">.</span> finite <span class="bound">P</span> <span class="main">∧</span> <span class="free">prv</span> <span class="main">(</span><span class="free">dsj</span> <span class="main">(</span>sdsj <span class="main">{</span><span class="free">eql</span> <span class="main">(</span><span class="free">Var</span> yy<span class="main">)</span> <span class="bound">r</span> <span class="main">|</span> <span class="bound">r</span><span class="main">.</span> <span class="bound">r</span> <span class="main">∈</span> <span class="bound">P</span><span class="main">}</span><span class="main">)</span> <span class="main">(</span><span class="bound">LLq</span> <span class="bound">p</span> <span class="main">(</span><span class="free">Var</span> yy<span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span>
<span class="keyword2"><span class="keyword">begin</span></span>

<span class="keyword1"><span class="command">lemma</span></span> LLq_num<span class="main">:</span>
<span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">φ</span> <span class="main">∈</span> <span class="free">fmla</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="free">q</span> <span class="main">∈</span> <span class="free">num</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="free">Fvars</span> <span class="free">φ</span> <span class="main">=</span> <span class="main">{</span>zz<span class="main">}</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span> <span class="bound">p</span> <span class="main">∈</span> <span class="free">num</span><span class="main">.</span> <span class="free">bprv</span> <span class="main">(</span><span class="free">subst</span> <span class="free">φ</span> <span class="bound">p</span> zz<span class="main">)</span>"</span></span>
<span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">prv</span> <span class="main">(</span><span class="free">all</span> zz <span class="main">(</span><span class="free">imp</span> <span class="main">(</span>LLq <span class="main">(</span><span class="free">Var</span> zz<span class="main">)</span> <span class="free">q</span><span class="main">)</span> <span class="free">φ</span><span class="main">)</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">using</span></span> assms Lq_num <span class="keyword1"><span class="command">unfolding</span></span> LLq_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">lemma</span></span> LLq_num2<span class="main">:</span>
<span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">p</span> <span class="main">∈</span> <span class="free">num</span>"</span></span>
<span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span> <span class="bound"><span class="bound">P</span></span> <span class="main">⊆</span> <span class="free">num</span><span class="main">.</span> finite <span class="bound">P</span> <span class="main">∧</span> <span class="free">prv</span> <span class="main">(</span><span class="free">dsj</span> <span class="main">(</span>sdsj <span class="main">{</span><span class="free">eql</span> <span class="main">(</span><span class="free">Var</span> yy<span class="main">)</span> <span class="bound">r</span> <span class="main">|</span> <span class="bound">r</span><span class="main">.</span> <span class="bound">r</span> <span class="main">∈</span> <span class="bound">P</span><span class="main">}</span><span class="main">)</span> <span class="main">(</span>LLq <span class="free">p</span> <span class="main">(</span><span class="free">Var</span> yy<span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">using</span></span> assms Lq_num2 <span class="keyword1"><span class="command">unfolding</span></span> LLq_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword2"><span class="keyword">end</span></span> <span class="comment1">― ‹context <span class="antiquoted"><span class="antiquote">@{</span><span class="operator">locale</span> Deduct2_with_PseudoOrder<span class="antiquote">}</span></span>›</span>

<span class="keyword1"><span class="command">section</span></span> <span class="quoted"><span class="plain_text">‹Factoring In Explicit Proofs›</span></span>

<span class="keyword1"><span class="command">locale</span></span> Deduct_with_Proofs <span class="main">=</span>
Deduct_with_False_Disj
  <span class="quoted"><span class="free">var</span></span> <span class="quoted"><span class="free">trm</span></span> <span class="quoted"><span class="free">fmla</span></span> <span class="quoted"><span class="free">Var</span></span> <span class="quoted"><span class="free">FvarsT</span></span> <span class="quoted"><span class="free">substT</span></span> <span class="quoted"><span class="free">Fvars</span></span> <span class="quoted"><span class="free">subst</span></span>
  <span class="quoted"><span class="free">eql</span></span> <span class="quoted"><span class="free">cnj</span></span> <span class="quoted"><span class="free">imp</span></span> <span class="quoted"><span class="free">all</span></span> <span class="quoted"><span class="free">exi</span></span>
  <span class="quoted"><span class="free">fls</span></span>
  <span class="quoted"><span class="free">dsj</span></span>
  <span class="quoted"><span class="free">num</span></span>
  <span class="quoted"><span class="free">prv</span></span>
<span class="keyword2"><span class="keyword">for</span></span>
<span class="free">var</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'var</span> set"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="free">trm</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'trm</span> set"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="free">fmla</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'fmla</span> set"</span></span>
<span class="keyword2"><span class="keyword">and</span></span> <span class="free">Var</span> <span class="free">FvarsT</span> <span class="free">substT</span> <span class="free">Fvars</span> <span class="free">subst</span>
<span class="keyword2"><span class="keyword">and</span></span> <span class="free">eql</span> <span class="free">cnj</span> <span class="free">imp</span> <span class="free">all</span> <span class="free">exi</span>
<span class="keyword2"><span class="keyword">and</span></span> <span class="free">fls</span>
<span class="keyword2"><span class="keyword">and</span></span> <span class="free">dsj</span>
<span class="keyword2"><span class="keyword">and</span></span> <span class="free">num</span>
<span class="keyword2"><span class="keyword">and</span></span> <span class="free">prv</span>
<span class="main">+</span>
<span class="keyword2"><span class="keyword">fixes</span></span>
<span class="quoted">"<span class="free">proof</span>"</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'proof</span> set"</span></span>
<span class="keyword2"><span class="keyword">and</span></span>
<span class="free">prfOf</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'proof</span> <span class="main">⇒</span> <span class="tfree">'fmla</span> <span class="main">⇒</span> bool"</span></span>
<span class="keyword2"><span class="keyword">assumes</span></span>
<span class="comment1">― ‹Provability means there exists a proof (only needed for sentences):›</span>
prv_prfOf<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">⋀</span> <span class="bound">φ</span><span class="main">.</span> <span class="bound">φ</span> <span class="main">∈</span> <span class="free">fmla</span> <span class="main">⟹</span> <span class="free">Fvars</span> <span class="bound">φ</span> <span class="main">=</span> <span class="main">{}</span> <span class="main">⟹</span> <span class="free">prv</span> <span class="bound">φ</span> <span class="main">⟷</span> <span class="main">(</span><span class="main">∃</span> <span class="bound">prf</span> <span class="main">∈</span> <span class="free">proof</span><span class="main">.</span> <span class="free">prfOf</span> <span class="bound">prf</span> <span class="bound">φ</span><span class="main">)</span>"</span></span>

<span class="comment1">(* We consider proof structure only for prv, not for bprv *)</span>
<span class="keyword1"><span class="command">locale</span></span> Deduct2_with_Proofs <span class="main">=</span>
Deduct2_with_False_Disj
  <span class="quoted"><span class="free">var</span></span> <span class="quoted"><span class="free">trm</span></span> <span class="quoted"><span class="free">fmla</span></span> <span class="quoted"><span class="free">Var</span></span> <span class="quoted"><span class="free">FvarsT</span></span> <span class="quoted"><span class="free">substT</span></span> <span class="quoted"><span class="free">Fvars</span></span> <span class="quoted"><span class="free">subst</span></span>
  <span class="quoted"><span class="free">eql</span></span> <span class="quoted"><span class="free">cnj</span></span> <span class="quoted"><span class="free">imp</span></span> <span class="quoted"><span class="free">all</span></span> <span class="quoted"><span class="free">exi</span></span>
  <span class="quoted"><span class="free">fls</span></span>
  <span class="quoted"><span class="free">dsj</span></span>
  <span class="quoted"><span class="free">num</span></span>
  <span class="quoted"><span class="free">prv</span></span> <span class="quoted"><span class="free">bprv</span></span>
<span class="main">+</span>
Deduct_with_Proofs
  <span class="quoted"><span class="free">var</span></span> <span class="quoted"><span class="free">trm</span></span> <span class="quoted"><span class="free">fmla</span></span> <span class="quoted"><span class="free">Var</span></span> <span class="quoted"><span class="free">FvarsT</span></span> <span class="quoted"><span class="free">substT</span></span> <span class="quoted"><span class="free">Fvars</span></span> <span class="quoted"><span class="free">subst</span></span>
  <span class="quoted"><span class="free">eql</span></span> <span class="quoted"><span class="free">cnj</span></span> <span class="quoted"><span class="free">imp</span></span> <span class="quoted"><span class="free">all</span></span> <span class="quoted"><span class="free">exi</span></span>
  <span class="quoted"><span class="free">fls</span></span>
  <span class="quoted"><span class="free">dsj</span></span>
  <span class="quoted"><span class="free">num</span></span>
  <span class="quoted"><span class="free">prv</span></span>
  <span class="quoted"><span class="quoted">"<span class="free">proof</span>"</span></span> <span class="quoted"><span class="free">prfOf</span></span>
<span class="keyword2"><span class="keyword">for</span></span>
<span class="free">var</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'var</span> set"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="free">trm</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'trm</span> set"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="free">fmla</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'fmla</span> set"</span></span>
<span class="keyword2"><span class="keyword">and</span></span> <span class="free">Var</span> <span class="free">FvarsT</span> <span class="free">substT</span> <span class="free">Fvars</span> <span class="free">subst</span>
<span class="keyword2"><span class="keyword">and</span></span> <span class="free">eql</span> <span class="free">cnj</span> <span class="free">imp</span> <span class="free">all</span> <span class="free">exi</span>
<span class="keyword2"><span class="keyword">and</span></span> <span class="free">fls</span>
<span class="keyword2"><span class="keyword">and</span></span> <span class="free">dsj</span>
<span class="keyword2"><span class="keyword">and</span></span> <span class="free">num</span>
<span class="keyword2"><span class="keyword">and</span></span> <span class="free">prv</span> <span class="free">bprv</span>
<span class="keyword2"><span class="keyword">and</span></span> <span class="quoted">"<span class="free">proof</span>"</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'proof</span> set"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="free">prfOf</span>

<span class="keyword1"><span class="command">locale</span></span> Deduct2_with_Proofs_PseudoOrder <span class="main">=</span>
Deduct2_with_Proofs
  <span class="quoted"><span class="free">var</span></span> <span class="quoted"><span class="free">trm</span></span> <span class="quoted"><span class="free">fmla</span></span> <span class="quoted"><span class="free">Var</span></span> <span class="quoted"><span class="free">FvarsT</span></span> <span class="quoted"><span class="free">substT</span></span> <span class="quoted"><span class="free">Fvars</span></span> <span class="quoted"><span class="free">subst</span></span>
  <span class="quoted"><span class="free">eql</span></span> <span class="quoted"><span class="free">cnj</span></span> <span class="quoted"><span class="free">imp</span></span> <span class="quoted"><span class="free">all</span></span> <span class="quoted"><span class="free">exi</span></span>
  <span class="quoted"><span class="free">fls</span></span>
  <span class="quoted"><span class="free">dsj</span></span>
  <span class="quoted"><span class="free">num</span></span>
  <span class="quoted"><span class="free">prv</span></span> <span class="quoted"><span class="free">bprv</span></span>
  <span class="quoted"><span class="quoted">"<span class="free">proof</span>"</span></span> <span class="quoted"><span class="free">prfOf</span></span>
<span class="main">+</span>
Deduct2_with_PseudoOrder
  <span class="quoted"><span class="free">var</span></span> <span class="quoted"><span class="free">trm</span></span> <span class="quoted"><span class="free">fmla</span></span> <span class="quoted"><span class="free">Var</span></span> <span class="quoted"><span class="free">FvarsT</span></span> <span class="quoted"><span class="free">substT</span></span> <span class="quoted"><span class="free">Fvars</span></span> <span class="quoted"><span class="free">subst</span></span>
  <span class="quoted"><span class="free">eql</span></span> <span class="quoted"><span class="free">cnj</span></span> <span class="quoted"><span class="free">imp</span></span> <span class="quoted"><span class="free">all</span></span> <span class="quoted"><span class="free">exi</span></span>
  <span class="quoted"><span class="free">fls</span></span>
  <span class="quoted"><span class="free">dsj</span></span>
  <span class="quoted"><span class="free">num</span></span>
  <span class="quoted"><span class="free">prv</span></span> <span class="quoted"><span class="free">bprv</span></span>
  <span class="quoted"><span class="free">Lq</span></span>
<span class="keyword2"><span class="keyword">for</span></span>
<span class="free">var</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'var</span> set"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="free">trm</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'trm</span> set"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="free">fmla</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'fmla</span> set"</span></span>
<span class="keyword2"><span class="keyword">and</span></span> <span class="free">Var</span> <span class="free">FvarsT</span> <span class="free">substT</span> <span class="free">Fvars</span> <span class="free">subst</span>
<span class="keyword2"><span class="keyword">and</span></span> <span class="free">eql</span> <span class="free">cnj</span> <span class="free">imp</span> <span class="free">all</span> <span class="free">exi</span>
<span class="keyword2"><span class="keyword">and</span></span> <span class="free">fls</span>
<span class="keyword2"><span class="keyword">and</span></span> <span class="free">dsj</span>
<span class="keyword2"><span class="keyword">and</span></span> <span class="free">num</span>
<span class="keyword2"><span class="keyword">and</span></span> <span class="free">prv</span> <span class="free">bprv</span>
<span class="keyword2"><span class="keyword">and</span></span> <span class="quoted">"<span class="free">proof</span>"</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'proof</span> set"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="free">prfOf</span>
<span class="keyword2"><span class="keyword">and</span></span> <span class="free">Lq</span>

<span class="comment1">(*&lt;*)</span>
<span class="keyword2"><span class="keyword">end</span></span>
<span class="comment1">(*&gt;*)</span></pre>
</div><div id="Abstract_Encoding">
<div class="head">
<h1>Theory Abstract_Encoding</h1>
</div>
<pre class="source"><span class="keyword1"><span class="command">chapter</span></span> <span class="quoted"><span class="plain_text">‹Abstract Encoding›</span></span>

<span class="comment1">(*&lt;*)</span>
<span class="keyword1"><span class="command">theory</span></span> Abstract_Encoding <span class="keyword2"><span class="keyword">imports</span></span> <a href="Deduction2.html">Deduction2</a>
<span class="keyword2"><span class="keyword">begin</span></span>
<span class="comment1">(*&gt;*)</span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹Here we simply fix some unspecified encoding functions: encoding formulas
and proofs as numerals.›</span></span>

<span class="keyword1"><span class="command">locale</span></span> Encode <span class="main">=</span>
Syntax_with_Numerals
  <span class="quoted"><span class="free">var</span></span> <span class="quoted"><span class="free">trm</span></span> <span class="quoted"><span class="free">fmla</span></span> <span class="quoted"><span class="free">Var</span></span> <span class="quoted"><span class="free">FvarsT</span></span> <span class="quoted"><span class="free">substT</span></span> <span class="quoted"><span class="free">Fvars</span></span> <span class="quoted"><span class="free">subst</span></span>
  <span class="quoted"><span class="free">num</span></span>
<span class="keyword2"><span class="keyword">for</span></span>
<span class="free">var</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'var</span> set"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="free">trm</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'trm</span> set"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="free">fmla</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'fmla</span> set"</span></span>
<span class="keyword2"><span class="keyword">and</span></span> <span class="free">Var</span> <span class="free">FvarsT</span> <span class="free">substT</span> <span class="free">Fvars</span> <span class="free">subst</span>
<span class="keyword2"><span class="keyword">and</span></span> <span class="free">num</span>
<span class="main">+</span>
<span class="keyword2"><span class="keyword">fixes</span></span> <span class="free">enc</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'fmla</span> <span class="main">⇒</span> <span class="tfree">'trm</span>"</span></span> <span class="main">(</span><span class="quoted">"<span class="keyword1">⟨</span>_<span class="keyword1">⟩</span>"</span><span class="main">)</span>
<span class="keyword2"><span class="keyword">assumes</span></span>
enc<span class="main">[</span><span class="operator">simp</span><span class="main">,</span><span class="operator">intro</span><span class="main"><span class="main">!</span></span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">⋀</span> <span class="bound">φ</span><span class="main">.</span> <span class="bound">φ</span> <span class="main">∈</span> <span class="free">fmla</span> <span class="main">⟹</span> <span class="free">enc</span> <span class="bound">φ</span> <span class="main">∈</span> <span class="free">num</span>"</span></span>
<span class="keyword2"><span class="keyword">begin</span></span>

<span class="keyword2"><span class="keyword">end</span></span> <span class="comment1">― ‹context <span class="antiquoted"><span class="antiquote">@{</span><span class="operator">locale</span> Encode<span class="antiquote">}</span></span>›</span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹Explicit proofs (encoded as numbers), needed only for the harder half of
Goedel's first, and for both half's of Rosser's version; not needed in Goedel's
second.›</span></span>

<span class="keyword1"><span class="command">locale</span></span> Encode_Proofs <span class="main">=</span>
Encode
  <span class="quoted"><span class="free">var</span></span> <span class="quoted"><span class="free">trm</span></span> <span class="quoted"><span class="free">fmla</span></span> <span class="quoted"><span class="free">Var</span></span> <span class="quoted"><span class="free">FvarsT</span></span> <span class="quoted"><span class="free">substT</span></span> <span class="quoted"><span class="free">Fvars</span></span> <span class="quoted"><span class="free">subst</span></span>
  <span class="quoted"><span class="free">num</span></span>
  <span class="quoted"><span class="free">enc</span></span>
<span class="main">+</span>
Deduct2_with_Proofs
  <span class="quoted"><span class="free">var</span></span> <span class="quoted"><span class="free">trm</span></span> <span class="quoted"><span class="free">fmla</span></span> <span class="quoted"><span class="free">Var</span></span> <span class="quoted"><span class="free">FvarsT</span></span> <span class="quoted"><span class="free">substT</span></span> <span class="quoted"><span class="free">Fvars</span></span> <span class="quoted"><span class="free">subst</span></span>
  <span class="quoted"><span class="free">eql</span></span> <span class="quoted"><span class="free">cnj</span></span> <span class="quoted"><span class="free">imp</span></span> <span class="quoted"><span class="free">all</span></span> <span class="quoted"><span class="free">exi</span></span>
  <span class="quoted"><span class="free">fls</span></span>
  <span class="quoted"><span class="free">dsj</span></span>
  <span class="quoted"><span class="free">num</span></span>
  <span class="quoted"><span class="free">prv</span></span> <span class="quoted"><span class="free">bprv</span></span>
  <span class="quoted"><span class="quoted">"<span class="free">proof</span>"</span></span> <span class="quoted"><span class="free">prfOf</span></span>
<span class="keyword2"><span class="keyword">for</span></span>
<span class="free">var</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'var</span> set"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="free">trm</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'trm</span> set"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="free">fmla</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'fmla</span> set"</span></span>
<span class="keyword2"><span class="keyword">and</span></span> <span class="free">Var</span> <span class="free">FvarsT</span> <span class="free">substT</span> <span class="free">Fvars</span> <span class="free">subst</span>
<span class="keyword2"><span class="keyword">and</span></span> <span class="free">num</span>
<span class="keyword2"><span class="keyword">and</span></span> <span class="free">eql</span> <span class="free">cnj</span> <span class="free">imp</span> <span class="free">all</span> <span class="free">exi</span>
<span class="keyword2"><span class="keyword">and</span></span> <span class="free">prv</span> <span class="free">bprv</span>
<span class="keyword2"><span class="keyword">and</span></span> <span class="free">enc</span> <span class="main">(</span><span class="quoted">"<span class="keyword1">⟨</span>_<span class="keyword1">⟩</span>"</span><span class="main">)</span>
<span class="keyword2"><span class="keyword">and</span></span> <span class="free">fls</span> <span class="free">dsj</span>
<span class="keyword2"><span class="keyword">and</span></span> <span class="quoted">"<span class="free">proof</span>"</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'proof</span> set"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="free">prfOf</span>
<span class="main">+</span>
<span class="keyword2"><span class="keyword">fixes</span></span> <span class="free">encPf</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'proof</span> <span class="main">⇒</span> <span class="tfree">'trm</span>"</span></span>
<span class="keyword2"><span class="keyword">assumes</span></span>
encPf<span class="main">[</span><span class="operator">simp</span><span class="main">,</span><span class="operator">intro</span><span class="main"><span class="main">!</span></span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">⋀</span> <span class="bound">pf</span><span class="main">.</span> <span class="bound">pf</span> <span class="main">∈</span> <span class="free">proof</span> <span class="main">⟹</span> <span class="free">encPf</span> <span class="bound">pf</span> <span class="main">∈</span> <span class="free">num</span>"</span></span>


<span class="comment1">(*&lt;*)</span>
<span class="keyword2"><span class="keyword">end</span></span>
<span class="comment1">(*&gt;*)</span></pre>
</div><div id="Abstract_Representability">
<div class="head">
<h1>Theory Abstract_Representability</h1>
</div>
<pre class="source"><span class="keyword1"><span class="command">chapter</span></span> <span class="quoted"><span class="plain_text">‹Representability Assumptions›</span></span>

<span class="comment1">(*&lt;*)</span>
<span class="keyword1"><span class="command">theory</span></span> Abstract_Representability <span class="keyword2"><span class="keyword">imports</span></span> <a href="Abstract_Encoding.html">Abstract_Encoding</a>
<span class="keyword2"><span class="keyword">begin</span></span>
<span class="comment1">(*&gt;*)</span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹Here we make assumptions about various functions or relations being
representable.›</span></span>


<span class="keyword1"><span class="command">section</span></span> <span class="quoted"><span class="plain_text">‹Representability of Negation›</span></span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹The negation function neg is assumed to be representable by a
two-variable formula N.›</span></span>

<span class="keyword1"><span class="command">locale</span></span> Repr_Neg <span class="main">=</span>
Deduct2_with_False
  <span class="quoted"><span class="free">var</span></span> <span class="quoted"><span class="free">trm</span></span> <span class="quoted"><span class="free">fmla</span></span> <span class="quoted"><span class="free">Var</span></span> <span class="quoted"><span class="free">FvarsT</span></span> <span class="quoted"><span class="free">substT</span></span> <span class="quoted"><span class="free">Fvars</span></span> <span class="quoted"><span class="free">subst</span></span>
  <span class="quoted"><span class="free">eql</span></span> <span class="quoted"><span class="free">cnj</span></span> <span class="quoted"><span class="free">imp</span></span> <span class="quoted"><span class="free">all</span></span> <span class="quoted"><span class="free">exi</span></span>
  <span class="quoted"><span class="free">fls</span></span>
  <span class="quoted"><span class="free">num</span></span>
  <span class="quoted"><span class="free">prv</span></span> <span class="quoted"><span class="free">bprv</span></span>
<span class="main">+</span>
Encode
  <span class="quoted"><span class="free">var</span></span> <span class="quoted"><span class="free">trm</span></span> <span class="quoted"><span class="free">fmla</span></span> <span class="quoted"><span class="free">Var</span></span> <span class="quoted"><span class="free">FvarsT</span></span> <span class="quoted"><span class="free">substT</span></span> <span class="quoted"><span class="free">Fvars</span></span> <span class="quoted"><span class="free">subst</span></span>
  <span class="quoted"><span class="free">num</span></span>
  <span class="quoted"><span class="free">enc</span></span>
<span class="keyword2"><span class="keyword">for</span></span>
<span class="free">var</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'var</span> set"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="free">trm</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'trm</span> set"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="free">fmla</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'fmla</span> set"</span></span>
<span class="keyword2"><span class="keyword">and</span></span> <span class="free">Var</span> <span class="free">FvarsT</span> <span class="free">substT</span> <span class="free">Fvars</span> <span class="free">subst</span>
<span class="keyword2"><span class="keyword">and</span></span> <span class="free">eql</span> <span class="free">cnj</span> <span class="free">imp</span> <span class="free">all</span> <span class="free">exi</span>
<span class="keyword2"><span class="keyword">and</span></span> <span class="free">fls</span>
<span class="keyword2"><span class="keyword">and</span></span> <span class="free">num</span>
<span class="keyword2"><span class="keyword">and</span></span> <span class="free">prv</span> <span class="free">bprv</span>
<span class="keyword2"><span class="keyword">and</span></span> <span class="free">enc</span> <span class="main">(</span><span class="quoted">"<span class="keyword1">⟨</span>_<span class="keyword1">⟩</span>"</span><span class="main">)</span>
<span class="main">+</span>
<span class="keyword2"><span class="keyword">fixes</span></span> <span class="free">N</span> <span class="main">::</span> <span class="tfree"><span class="quoted"><span class="tfree">'fmla</span></span></span>
<span class="keyword2"><span class="keyword">assumes</span></span>
N<span class="main">[</span><span class="operator">simp</span><span class="main">,</span><span class="operator">intro</span><span class="main"><span class="main">!</span></span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">N</span> <span class="main">∈</span> <span class="free">fmla</span>"</span></span>
<span class="keyword2"><span class="keyword">and</span></span>
Fvars_N<span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">Fvars</span> <span class="free">N</span> <span class="main">=</span> <span class="main">{</span>xx<span class="main">,</span>yy<span class="main">}</span>"</span></span>
<span class="keyword2"><span class="keyword">and</span></span>
neg_implies_prv_N<span class="main">:</span>
<span class="quoted"><span class="quoted">"<span class="main">⋀</span> <span class="bound">φ</span><span class="main">.</span>
  <span class="keyword1">let</span> <span class="bound">NN</span> <span class="main">=</span> <span class="main">(</span><span class="main">λ</span> <span class="bound">t1</span> <span class="bound">t2</span><span class="main">.</span> psubst <span class="free">N</span> <span class="main">[</span><span class="main">(</span><span class="bound">t1</span><span class="main">,</span>xx<span class="main">)</span><span class="main">,</span> <span class="main">(</span><span class="bound">t2</span><span class="main">,</span>yy<span class="main">)</span><span class="main">]</span><span class="main">)</span> <span class="keyword1">in</span>
   <span class="bound">φ</span> <span class="main">∈</span> <span class="free">fmla</span> <span class="main">⟶</span> <span class="free">Fvars</span> <span class="bound">φ</span> <span class="main">=</span> <span class="main">{}</span> <span class="main">⟶</span> <span class="free">bprv</span> <span class="main">(</span><span class="bound">NN</span> <span class="main"><span class="free">⟨</span></span><span class="bound">φ</span><span class="main"><span class="free">⟩</span></span> <span class="main"><span class="free">⟨</span></span>neg <span class="bound">φ</span><span class="main"><span class="free">⟩</span></span><span class="main">)</span>"</span></span>
<span class="keyword2"><span class="keyword">and</span></span>
N_unique<span class="main">:</span>
<span class="quoted"><span class="quoted">"<span class="main">⋀</span> <span class="bound">φ</span><span class="main">.</span>
  <span class="keyword1">let</span> <span class="bound">NN</span> <span class="main">=</span> <span class="main">(</span><span class="main">λ</span> <span class="bound">t1</span> <span class="bound">t2</span><span class="main">.</span> psubst <span class="free">N</span> <span class="main">[</span><span class="main">(</span><span class="bound">t1</span><span class="main">,</span>xx<span class="main">)</span><span class="main">,</span> <span class="main">(</span><span class="bound">t2</span><span class="main">,</span>yy<span class="main">)</span><span class="main">]</span><span class="main">)</span> <span class="keyword1">in</span>
  <span class="bound">φ</span> <span class="main">∈</span> <span class="free">fmla</span> <span class="main">⟶</span> <span class="free">Fvars</span> <span class="bound">φ</span> <span class="main">=</span> <span class="main">{}</span> <span class="main">⟶</span>
  <span class="free">bprv</span> <span class="main">(</span><span class="free">all</span> yy <span class="main">(</span><span class="free">all</span> yy'
    <span class="main">(</span><span class="free">imp</span> <span class="main">(</span><span class="free">cnj</span> <span class="main">(</span><span class="bound">NN</span> <span class="main"><span class="free">⟨</span></span><span class="bound">φ</span><span class="main"><span class="free">⟩</span></span> <span class="main">(</span><span class="free">Var</span> yy<span class="main">)</span><span class="main">)</span> <span class="main">(</span><span class="bound">NN</span> <span class="main"><span class="free">⟨</span></span><span class="bound">φ</span><span class="main"><span class="free">⟩</span></span> <span class="main">(</span><span class="free">Var</span> yy'<span class="main">)</span><span class="main">)</span><span class="main">)</span>
         <span class="main">(</span><span class="free">eql</span> <span class="main">(</span><span class="free">Var</span> yy<span class="main">)</span> <span class="main">(</span><span class="free">Var</span> yy'<span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span>
<span class="keyword2"><span class="keyword">begin</span></span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹NN is a notation for the predicate that takes terms and returns corresponding instances
of N, obtained by substituting its free variables with these terms. This is very convenient
for reasoning, and will be done for all the representing formulas we will consider.›</span></span>

<span class="keyword1"><span class="command">definition</span></span> <span class="entity">NN</span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="free">NN</span> <span class="main">≡</span> <span class="main">λ</span> <span class="bound">t1</span> <span class="bound">t2</span><span class="main">.</span> psubst <span class="free">N</span> <span class="main">[</span><span class="main">(</span><span class="bound">t1</span><span class="main">,</span>xx<span class="main">)</span><span class="main">,</span> <span class="main">(</span><span class="bound">t2</span><span class="main">,</span>yy<span class="main">)</span><span class="main">]</span>"</span></span>

<span class="keyword1"><span class="command">lemma</span></span> NN_def2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">t1</span> <span class="main">∈</span> <span class="free">trm</span> <span class="main">⟹</span> <span class="free">t2</span> <span class="main">∈</span> <span class="free">trm</span> <span class="main">⟹</span> yy <span class="main">∉</span> <span class="free">FvarsT</span> <span class="free">t1</span> <span class="main">⟹</span>
 NN <span class="free">t1</span> <span class="free">t2</span> <span class="main">=</span> <span class="free">subst</span> <span class="main">(</span><span class="free">subst</span> <span class="free">N</span> <span class="free">t1</span> xx<span class="main">)</span> <span class="free">t2</span> yy"</span></span>
  <span class="keyword1"><span class="command">unfolding</span></span> NN_def <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> psubst_eq_rawpsubst2<span class="main"><span class="main">[</span></span><span class="operator">simplified</span><span class="main"><span class="main">]</span></span><span class="main">)</span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">lemma</span></span> NN_neg<span class="main">:</span>
<span class="quoted"><span class="quoted">"<span class="free">φ</span> <span class="main">∈</span> <span class="free">fmla</span> <span class="main">⟹</span> <span class="free">Fvars</span> <span class="free">φ</span> <span class="main">=</span> <span class="main">{}</span> <span class="main">⟹</span> <span class="free">bprv</span> <span class="main">(</span>NN <span class="main"><span class="free">⟨</span></span><span class="free">φ</span><span class="main"><span class="free">⟩</span></span> <span class="main"><span class="free">⟨</span></span>neg <span class="free">φ</span><span class="main"><span class="free">⟩</span></span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> neg_implies_prv_N <span class="keyword1"><span class="command">unfolding</span></span> Let_def NN_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">meson</span>

<span class="keyword1"><span class="command">lemma</span></span> NN_unique<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">φ</span> <span class="main">∈</span> <span class="free">fmla</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="free">Fvars</span> <span class="free">φ</span> <span class="main">=</span> <span class="main">{}</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">bprv</span> <span class="main">(</span><span class="free">all</span> yy <span class="main">(</span><span class="free">all</span> yy'
    <span class="main">(</span><span class="free">imp</span> <span class="main">(</span><span class="free">cnj</span> <span class="main">(</span>NN <span class="main"><span class="free">⟨</span></span><span class="free">φ</span><span class="main"><span class="free">⟩</span></span> <span class="main">(</span><span class="free">Var</span> yy<span class="main">)</span><span class="main">)</span> <span class="main">(</span>NN <span class="main"><span class="free">⟨</span></span><span class="free">φ</span><span class="main"><span class="free">⟩</span></span> <span class="main">(</span><span class="free">Var</span> yy'<span class="main">)</span><span class="main">)</span><span class="main">)</span>
         <span class="main">(</span><span class="free">eql</span> <span class="main">(</span><span class="free">Var</span> yy<span class="main">)</span> <span class="main">(</span><span class="free">Var</span> yy'<span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> assms N_unique <span class="keyword1"><span class="command">unfolding</span></span> Let_def NN_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">meson</span>

<span class="keyword1"><span class="command">lemma</span></span> NN<span class="main">[</span><span class="operator">simp</span><span class="main">,</span><span class="operator">intro</span><span class="main">]</span><span class="main">:</span>
<span class="quoted"><span class="quoted">"<span class="free">t1</span> <span class="main">∈</span> <span class="free">trm</span> <span class="main">⟹</span> <span class="free">t2</span> <span class="main">∈</span> <span class="free">trm</span> <span class="main">⟹</span> NN <span class="free">t1</span> <span class="free">t2</span> <span class="main">∈</span> <span class="free">fmla</span>"</span></span>
<span class="keyword1"><span class="command">unfolding</span></span> NN_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">lemma</span></span> Fvars_NN<span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">t1</span> <span class="main">∈</span> <span class="free">trm</span> <span class="main">⟹</span> <span class="free">t2</span> <span class="main">∈</span> <span class="free">trm</span> <span class="main">⟹</span> yy <span class="main">∉</span> <span class="free">FvarsT</span> <span class="free">t1</span> <span class="main">⟹</span>
<span class="free">Fvars</span> <span class="main">(</span>NN <span class="free">t1</span> <span class="free">t2</span><span class="main">)</span> <span class="main">=</span> <span class="free">FvarsT</span> <span class="free">t1</span> <span class="main">∪</span> <span class="free">FvarsT</span> <span class="free">t2</span>"</span></span>
<span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> NN_def2 subst2_fresh_switch<span class="main">)</span>

<span class="comment1">(* Here and elsewhere: hard to make into one or two uniform statements,
given that we don't assume sufficiently powerful properties for trm substitution.
So such lists would need to be maintained on an ad hoc basis, keeping adding instances
when needed. *)</span>
<span class="keyword1"><span class="command">lemma</span></span> <span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span>
<span class="quoted"><span class="quoted">"<span class="free">m</span> <span class="main">∈</span> <span class="free">num</span> <span class="main">⟹</span> <span class="free">n</span> <span class="main">∈</span> <span class="free">num</span> <span class="main">⟹</span> <span class="free">subst</span> <span class="main">(</span>NN <span class="free">m</span> <span class="main">(</span><span class="free">Var</span> yy<span class="main">)</span><span class="main">)</span> <span class="free">n</span> yy <span class="main">=</span> NN <span class="free">m</span> <span class="free">n</span>"</span></span>
<span class="quoted"><span class="quoted">"<span class="free">m</span> <span class="main">∈</span> <span class="free">num</span> <span class="main">⟹</span> <span class="free">n</span> <span class="main">∈</span> <span class="free">num</span> <span class="main">⟹</span> <span class="free">subst</span> <span class="main">(</span>NN <span class="free">m</span> <span class="main">(</span><span class="free">Var</span> yy'<span class="main">)</span><span class="main">)</span> <span class="free">n</span> yy <span class="main">=</span> NN <span class="free">m</span> <span class="main">(</span><span class="free">Var</span> yy'<span class="main">)</span>"</span></span>
<span class="quoted"><span class="quoted">"<span class="free">m</span> <span class="main">∈</span> <span class="free">num</span> <span class="main">⟹</span> <span class="free">subst</span> <span class="main">(</span>NN <span class="free">m</span> <span class="main">(</span><span class="free">Var</span> yy'<span class="main">)</span><span class="main">)</span> <span class="main">(</span><span class="free">Var</span> yy<span class="main">)</span> yy' <span class="main">=</span> NN <span class="free">m</span> <span class="main">(</span><span class="free">Var</span> yy<span class="main">)</span>"</span></span>
<span class="quoted"><span class="quoted">"<span class="free">n</span> <span class="main">∈</span> <span class="free">num</span> <span class="main">⟹</span> <span class="free">subst</span> <span class="main">(</span>NN <span class="main">(</span><span class="free">Var</span> xx<span class="main">)</span> <span class="main">(</span><span class="free">Var</span> yy<span class="main">)</span><span class="main">)</span> <span class="free">n</span> xx <span class="main">=</span> NN <span class="free">n</span> <span class="main">(</span><span class="free">Var</span> yy<span class="main">)</span>"</span></span>
<span class="quoted"><span class="quoted">"<span class="free">n</span> <span class="main">∈</span> <span class="free">num</span> <span class="main">⟹</span> <span class="free">subst</span> <span class="main">(</span>NN <span class="main">(</span><span class="free">Var</span> xx<span class="main">)</span> <span class="main">(</span><span class="free">Var</span> xx'<span class="main">)</span><span class="main">)</span> <span class="free">n</span> xx <span class="main">=</span> NN <span class="free">n</span> <span class="main">(</span><span class="free">Var</span> xx'<span class="main">)</span>"</span></span>
<span class="quoted"><span class="quoted">"<span class="free">m</span> <span class="main">∈</span> <span class="free">num</span> <span class="main">⟹</span> <span class="free">n</span> <span class="main">∈</span> <span class="free">num</span> <span class="main">⟹</span> <span class="free">subst</span> <span class="main">(</span>NN <span class="free">m</span> <span class="main">(</span><span class="free">Var</span> xx'<span class="main">)</span><span class="main">)</span> <span class="free">n</span> zz <span class="main">=</span> NN <span class="free">m</span> <span class="main">(</span><span class="free">Var</span> xx'<span class="main">)</span>"</span></span>
<span class="quoted"><span class="quoted">"<span class="free">n</span> <span class="main">∈</span> <span class="free">num</span> <span class="main">⟹</span> <span class="free">subst</span> <span class="main">(</span>NN <span class="free">n</span> <span class="main">(</span><span class="free">Var</span> yy<span class="main">)</span><span class="main">)</span> <span class="main">(</span><span class="free">Var</span> xx'<span class="main">)</span> yy <span class="main">=</span> NN <span class="free">n</span> <span class="main">(</span><span class="free">Var</span> xx'<span class="main">)</span>"</span></span>
<span class="quoted"><span class="quoted">"<span class="free">m</span> <span class="main">∈</span> <span class="free">num</span> <span class="main">⟹</span> <span class="free">n</span> <span class="main">∈</span> <span class="free">num</span> <span class="main">⟹</span> <span class="free">subst</span> <span class="main">(</span>NN <span class="free">m</span> <span class="main">(</span><span class="free">Var</span> xx'<span class="main">)</span><span class="main">)</span> <span class="free">n</span> xx' <span class="main">=</span> NN <span class="free">m</span> <span class="free">n</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> NN_def2 subst2_fresh_switch<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> NN_unique2<span class="main">:</span>
<span class="keyword2"><span class="keyword">assumes</span></span> <span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span><span class="quoted"><span class="quoted">"<span class="free">φ</span> <span class="main">∈</span> <span class="free">fmla</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="free">Fvars</span> <span class="free">φ</span> <span class="main">=</span> <span class="main">{}</span>"</span></span>
<span class="keyword2"><span class="keyword">shows</span></span>
<span class="quoted"><span class="quoted">"<span class="free">bprv</span> <span class="main">(</span><span class="free">all</span> yy
     <span class="main">(</span><span class="free">imp</span> <span class="main">(</span>NN <span class="main"><span class="free">⟨</span></span><span class="free">φ</span><span class="main"><span class="free">⟩</span></span> <span class="main">(</span><span class="free">Var</span> yy<span class="main">)</span><span class="main">)</span>
          <span class="main">(</span><span class="free">eql</span> <span class="main"><span class="free">⟨</span></span>neg <span class="free">φ</span><span class="main"><span class="free">⟩</span></span> <span class="main">(</span><span class="free">Var</span> yy<span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> 1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">bprv</span> <span class="main">(</span>NN <span class="main"><span class="free">⟨</span></span><span class="free">φ</span><span class="main"><span class="free">⟩</span></span> <span class="main"><span class="free">⟨</span></span>neg <span class="free">φ</span><span class="main"><span class="free">⟩</span></span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> NN_neg<span class="main">[</span><span class="operator">OF</span> assms<span class="main">]</span> <span class="keyword1"><span class="command">.</span></span>
  <span class="keyword1"><span class="command">have</span></span> 2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">bprv</span> <span class="main">(</span><span class="free">all</span> yy' <span class="main">(</span>
             <span class="free">imp</span> <span class="main">(</span><span class="free">cnj</span> <span class="main">(</span>NN <span class="main"><span class="free">⟨</span></span><span class="free">φ</span><span class="main"><span class="free">⟩</span></span> <span class="main"><span class="free">⟨</span></span>neg <span class="free">φ</span><span class="main"><span class="free">⟩</span></span><span class="main">)</span>
                      <span class="main">(</span>NN <span class="main"><span class="free">⟨</span></span><span class="free">φ</span><span class="main"><span class="free">⟩</span></span> <span class="main">(</span><span class="free">Var</span> yy'<span class="main">)</span><span class="main">)</span><span class="main">)</span>
                 <span class="main">(</span><span class="free">eql</span> <span class="main"><span class="free">⟨</span></span>neg <span class="free">φ</span><span class="main"><span class="free">⟩</span></span> <span class="main">(</span><span class="free">Var</span> yy'<span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> B.prv_allE<span class="main">[</span><span class="operator">of</span> <span class="quoted">yy</span><span class="main">,</span> <span class="operator">OF</span> _ _ _ NN_unique<span class="main">,</span> <span class="operator">of</span> <span class="quoted"><span class="quoted">"<span class="free">φ</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="main"><span class="free">⟨</span></span>neg <span class="free">φ</span><span class="main"><span class="free">⟩</span></span>"</span></span><span class="main">]</span>
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">fastforce</span>
  <span class="keyword1"><span class="command">have</span></span> 31<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">bprv</span> <span class="main">(</span><span class="free">all</span> yy' <span class="main">(</span>
             <span class="free">imp</span> <span class="main">(</span>NN <span class="main"><span class="free">⟨</span></span><span class="free">φ</span><span class="main"><span class="free">⟩</span></span> <span class="main"><span class="free">⟨</span></span>neg <span class="free">φ</span><span class="main"><span class="free">⟩</span></span><span class="main">)</span>
                 <span class="main">(</span><span class="free">imp</span> <span class="main">(</span>NN <span class="main"><span class="free">⟨</span></span><span class="free">φ</span><span class="main"><span class="free">⟩</span></span> <span class="main">(</span><span class="free">Var</span> yy'<span class="main">)</span><span class="main">)</span>
                      <span class="main">(</span><span class="free">eql</span> <span class="main"><span class="free">⟨</span></span>neg <span class="free">φ</span><span class="main"><span class="free">⟩</span></span> <span class="main">(</span><span class="free">Var</span> yy'<span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> B.prv_all_imp_cnj_rev<span class="main">[</span><span class="operator">OF</span> _ _ _ _ 2<span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">have</span></span> 32<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">bprv</span> <span class="main">(</span><span class="free">imp</span> <span class="main">(</span>NN <span class="main"><span class="free">⟨</span></span><span class="free">φ</span><span class="main"><span class="free">⟩</span></span> <span class="main"><span class="free">⟨</span></span>neg <span class="free">φ</span><span class="main"><span class="free">⟩</span></span><span class="main">)</span>
                      <span class="main">(</span><span class="free">all</span> yy' <span class="main">(</span><span class="free">imp</span> <span class="main">(</span>NN <span class="main"><span class="free">⟨</span></span><span class="free">φ</span><span class="main"><span class="free">⟩</span></span> <span class="main">(</span><span class="free">Var</span> yy'<span class="main">)</span><span class="main">)</span>
                                    <span class="main">(</span><span class="free">eql</span> <span class="main"><span class="free">⟨</span></span>neg <span class="free">φ</span><span class="main"><span class="free">⟩</span></span> <span class="main">(</span><span class="free">Var</span> yy'<span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> B.prv_all_imp<span class="main"><span class="main">[</span></span><span class="operator">OF</span> _ _ _ _ 31<span class="main"><span class="main">]</span></span><span class="main">)</span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> NN_def2<span class="main">)</span>
  <span class="keyword1"><span class="command">have</span></span> 33<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">bprv</span> <span class="main">(</span><span class="free">all</span> yy' <span class="main">(</span><span class="free">imp</span> <span class="main">(</span>NN <span class="main"><span class="free">⟨</span></span><span class="free">φ</span><span class="main"><span class="free">⟩</span></span> <span class="main">(</span><span class="free">Var</span> yy'<span class="main">)</span><span class="main">)</span>
                              <span class="main">(</span><span class="free">eql</span> <span class="main"><span class="free">⟨</span></span>neg <span class="free">φ</span><span class="main"><span class="free">⟩</span></span> <span class="main">(</span><span class="free">Var</span> yy'<span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> B.prv_imp_mp <span class="main"><span class="main">[</span></span><span class="operator">OF</span> _ _ 32 1<span class="main"><span class="main">]</span></span><span class="main">)</span> <span class="operator">auto</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> B.all_subst_rename_prv<span class="main">[</span><span class="operator">OF</span> _ _ _ _ 33<span class="main">,</span> <span class="operator">of</span> <span class="quoted">yy</span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">lemma</span></span> NN_neg_unique<span class="main">:</span>
<span class="keyword2"><span class="keyword">assumes</span></span> <span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span><span class="quoted"><span class="quoted">"<span class="free">φ</span> <span class="main">∈</span> <span class="free">fmla</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="free">Fvars</span> <span class="free">φ</span> <span class="main">=</span> <span class="main">{}</span>"</span></span>
<span class="keyword2"><span class="keyword">shows</span></span>
<span class="quoted"><span class="quoted">"<span class="free">bprv</span> <span class="main">(</span><span class="free">imp</span> <span class="main">(</span>NN <span class="main"><span class="free">⟨</span></span><span class="free">φ</span><span class="main"><span class="free">⟩</span></span> <span class="main">(</span><span class="free">Var</span> yy<span class="main">)</span><span class="main">)</span>
           <span class="main">(</span><span class="free">eql</span> <span class="main"><span class="free">⟨</span></span>neg <span class="free">φ</span><span class="main"><span class="free">⟩</span></span> <span class="main">(</span><span class="free">Var</span> yy<span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">is</span></span> <span class="quoted"><span class="quoted">"<span class="free">bprv</span> <span class="var">?A</span>"</span></span><span class="main">)</span>
<span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> 0<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">bprv</span> <span class="main">(</span><span class="free">all</span> yy <span class="var">?A</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> NN_unique2<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="quoted">"<span class="free">φ</span>"</span></span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> B.allE_id<span class="main"><span class="main">[</span></span><span class="operator">OF</span> _ _ 0<span class="main"><span class="main">]</span></span><span class="main">)</span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">lemma</span></span> NN_exi_cnj<span class="main">:</span>
<span class="keyword2"><span class="keyword">assumes</span></span> φ<span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">φ</span> <span class="main">∈</span> <span class="free">fmla</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="free">Fvars</span> <span class="free">φ</span> <span class="main">=</span> <span class="main">{}</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> χ<span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">χ</span> <span class="main">∈</span> <span class="free">fmla</span>"</span></span>
<span class="keyword2"><span class="keyword">assumes</span></span> f<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">Fvars</span> <span class="free">χ</span> <span class="main">=</span> <span class="main">{</span>yy<span class="main">}</span>"</span></span>
<span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">bprv</span> <span class="main">(</span>eqv <span class="main">(</span><span class="free">subst</span> <span class="free">χ</span> <span class="main"><span class="free">⟨</span></span>neg <span class="free">φ</span><span class="main"><span class="free">⟩</span></span> yy<span class="main">)</span>
                 <span class="main">(</span><span class="free">exi</span> yy <span class="main">(</span><span class="free">cnj</span> <span class="free">χ</span> <span class="main">(</span>NN <span class="main"><span class="free">⟨</span></span><span class="free">φ</span><span class="main"><span class="free">⟩</span></span> <span class="main">(</span><span class="free">Var</span> yy<span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span>
<span class="main">(</span><span class="keyword2"><span class="keyword">is</span></span> <span class="quoted"><span class="quoted">"<span class="free">bprv</span> <span class="main">(</span>eqv <span class="var">?A</span> <span class="var">?B</span><span class="main">)</span>"</span></span><span class="main">)</span>
<span class="keyword1"><span class="command">proof</span></span><span class="main">(</span><span class="operator">intro</span> B.prv_eqvI<span class="main">)</span>
  <span class="keyword1"><span class="command">have</span></span> yy<span class="main">:</span> <span class="quoted"><span class="quoted">"yy <span class="main">∈</span> <span class="free">var</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?N</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"NN <span class="main"><span class="free">⟨</span></span><span class="free">φ</span><span class="main"><span class="free">⟩</span></span> <span class="main">(</span><span class="free">Var</span> yy<span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">bprv</span> <span class="main">(</span><span class="free">imp</span> <span class="main">(</span><span class="free">subst</span> <span class="free">χ</span> <span class="main"><span class="free">⟨</span></span>neg <span class="free">φ</span><span class="main"><span class="free">⟩</span></span> yy<span class="main">)</span> <span class="main">(</span><span class="main">(</span><span class="free">subst</span> <span class="main">(</span><span class="free">cnj</span> <span class="free">χ</span> <span class="var">?N</span><span class="main">)</span> <span class="main"><span class="free">⟨</span></span>neg <span class="free">φ</span><span class="main"><span class="free">⟩</span></span> yy<span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> NN_neg<span class="main">[</span><span class="operator">OF</span> φ<span class="main">]</span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> B.prv_imp_cnj B.prv_imp_refl B.prv_imp_triv<span class="main">)</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"<span class="free">bprv</span> <span class="main">(</span><span class="free">imp</span> <span class="var">?A</span> <span class="var">?B</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">elim</span> B.prv_prv_imp_trans<span class="main"><span class="main">[</span></span><span class="operator">rotated</span> 3<span class="main"><span class="main">]</span></span><span class="main"><span class="keyword3">,</span></span> <span class="operator">intro</span> B.prv_exi_inst<span class="main">)</span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">next</span></span>
  <span class="keyword1"><span class="command">have</span></span> 00<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">bprv</span> <span class="main">(</span><span class="free">imp</span> <span class="main">(</span><span class="free">eql</span> <span class="main"><span class="free">⟨</span></span>neg <span class="free">φ</span><span class="main"><span class="free">⟩</span></span> <span class="main">(</span><span class="free">Var</span> yy<span class="main">)</span><span class="main">)</span> <span class="main">(</span><span class="free">imp</span> <span class="free">χ</span> <span class="main">(</span><span class="free">subst</span> <span class="free">χ</span> <span class="main"><span class="free">⟨</span></span>neg <span class="free">φ</span><span class="main"><span class="free">⟩</span></span> yy<span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> B.prv_eql_subst_trm_id_rev<span class="main">)</span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">have</span></span> 11<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">bprv</span> <span class="main">(</span><span class="free">imp</span> <span class="main">(</span>NN <span class="main"><span class="free">⟨</span></span><span class="free">φ</span><span class="main"><span class="free">⟩</span></span> <span class="main">(</span><span class="free">Var</span> yy<span class="main">)</span><span class="main">)</span> <span class="main">(</span><span class="free">imp</span> <span class="free">χ</span> <span class="main">(</span><span class="free">subst</span> <span class="free">χ</span> <span class="main"><span class="free">⟨</span></span>neg <span class="free">φ</span><span class="main"><span class="free">⟩</span></span> yy<span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> 00 NN_neg_unique<span class="main">[</span><span class="operator">OF</span> φ<span class="main">]</span>
    <span class="keyword1"><span class="command">using</span></span> NN num Var Variable φ χ eql imp subst B.prv_prv_imp_trans
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> <span class="main"><span class="main">(</span></span>no_types<span class="main"><span class="main">,</span></span> lifting<span class="main"><span class="main">)</span></span> enc in_num neg<span class="main">)</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="free">bprv</span> <span class="main">(</span><span class="free">imp</span> <span class="main">(</span><span class="free">cnj</span> <span class="free">χ</span> <span class="main">(</span>NN <span class="main"><span class="free">⟨</span></span><span class="free">φ</span><span class="main"><span class="free">⟩</span></span> <span class="main">(</span><span class="free">Var</span> yy<span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">(</span><span class="free">subst</span> <span class="free">χ</span> <span class="main"><span class="free">⟨</span></span>neg <span class="free">φ</span><span class="main"><span class="free">⟩</span></span> yy<span class="main">)</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> 11 B.prv_cnj_imp_monoR2 B.prv_imp_com<span class="main">)</span>
  <span class="keyword1"><span class="command">hence</span></span> 1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">bprv</span> <span class="main">(</span><span class="free">all</span> yy <span class="main">(</span><span class="free">imp</span> <span class="main">(</span><span class="free">cnj</span> <span class="free">χ</span> <span class="main">(</span>NN <span class="main"><span class="free">⟨</span></span><span class="free">φ</span><span class="main"><span class="free">⟩</span></span> <span class="main">(</span><span class="free">Var</span> yy<span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">(</span><span class="free">subst</span> <span class="free">χ</span> <span class="main"><span class="free">⟨</span></span>neg <span class="free">φ</span><span class="main"><span class="free">⟩</span></span> yy<span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> B.prv_all_gen<span class="main">)</span>
  <span class="keyword1"><span class="command">have</span></span> 2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">Fvars</span> <span class="main">(</span><span class="free">subst</span> <span class="free">χ</span> <span class="main"><span class="free">⟨</span></span>neg <span class="free">φ</span><span class="main"><span class="free">⟩</span></span> yy<span class="main">)</span> <span class="main">=</span> <span class="main">{}</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> f <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="free">bprv</span> <span class="main">(</span><span class="free">imp</span> <span class="var">?B</span> <span class="var">?A</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> 1 2
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> B.prv_exi_imp<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span> <span class="operator">auto</span>

<span class="keyword2"><span class="keyword">end</span></span> <span class="comment1">― ‹context <span class="antiquoted"><span class="antiquote">@{</span><span class="operator">locale</span> Repr_Neg<span class="antiquote">}</span></span>›</span>


<span class="keyword1"><span class="command">section</span></span> <span class="quoted"><span class="plain_text">‹Representability of Self-Substitution›</span></span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹Self-substitution is the function that takes a formula <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">term</span></span> <span class="quoted"><span class="free"><span class="quoted"><span class="free">φ</span></span></span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span>
and returns $\phi[\langle\phi\rangle/\mathit{xx}]$ (for the fixed variable <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">term</span></span> <span class="quoted"><span class="free"><span class="quoted"><span class="free">xx</span></span></span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span>). This is all that
will be needed for the diagonalization lemma.›</span></span>

<span class="keyword1"><span class="command">locale</span></span> Repr_SelfSubst <span class="main">=</span>
Encode
  <span class="quoted"><span class="free">var</span></span> <span class="quoted"><span class="free">trm</span></span> <span class="quoted"><span class="free">fmla</span></span> <span class="quoted"><span class="free">Var</span></span> <span class="quoted"><span class="free">FvarsT</span></span> <span class="quoted"><span class="free">substT</span></span> <span class="quoted"><span class="free">Fvars</span></span> <span class="quoted"><span class="free">subst</span></span>
  <span class="quoted"><span class="free">num</span></span>
  <span class="quoted"><span class="free">enc</span></span>
<span class="main">+</span>
Deduct2
  <span class="quoted"><span class="free">var</span></span> <span class="quoted"><span class="free">trm</span></span> <span class="quoted"><span class="free">fmla</span></span> <span class="quoted"><span class="free">Var</span></span> <span class="quoted"><span class="free">FvarsT</span></span> <span class="quoted"><span class="free">substT</span></span> <span class="quoted"><span class="free">Fvars</span></span> <span class="quoted"><span class="free">subst</span></span>
  <span class="quoted"><span class="free">num</span></span>
  <span class="quoted"><span class="free">eql</span></span> <span class="quoted"><span class="free">cnj</span></span> <span class="quoted"><span class="free">imp</span></span> <span class="quoted"><span class="free">all</span></span> <span class="quoted"><span class="free">exi</span></span>
  <span class="quoted"><span class="free">prv</span></span> <span class="quoted"><span class="free">bprv</span></span>
<span class="keyword2"><span class="keyword">for</span></span>
<span class="free">var</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'var</span> set"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="free">trm</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'trm</span> set"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="free">fmla</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'fmla</span> set"</span></span>
<span class="keyword2"><span class="keyword">and</span></span> <span class="free">Var</span> <span class="free">FvarsT</span> <span class="free">substT</span> <span class="free">Fvars</span> <span class="free">subst</span>
<span class="keyword2"><span class="keyword">and</span></span> <span class="free">num</span>
<span class="keyword2"><span class="keyword">and</span></span> <span class="free">eql</span> <span class="free">cnj</span> <span class="free">imp</span> <span class="free">all</span> <span class="free">exi</span>
<span class="keyword2"><span class="keyword">and</span></span> <span class="free">prv</span> <span class="free">bprv</span>
<span class="keyword2"><span class="keyword">and</span></span> <span class="free">enc</span> <span class="main">(</span><span class="quoted">"<span class="keyword1">⟨</span>_<span class="keyword1">⟩</span>"</span><span class="main">)</span>
<span class="main">+</span>
<span class="keyword2"><span class="keyword">fixes</span></span> <span class="free">S</span> <span class="main">::</span> <span class="tfree"><span class="quoted"><span class="tfree">'fmla</span></span></span>
<span class="keyword2"><span class="keyword">assumes</span></span>
S<span class="main">[</span><span class="operator">simp</span><span class="main">,</span><span class="operator">intro</span><span class="main"><span class="main">!</span></span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">S</span> <span class="main">∈</span> <span class="free">fmla</span>"</span></span>
<span class="keyword2"><span class="keyword">and</span></span>
Fvars_S<span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">Fvars</span> <span class="free">S</span> <span class="main">=</span> <span class="main">{</span>xx<span class="main">,</span>yy<span class="main">}</span>"</span></span>
<span class="keyword2"><span class="keyword">and</span></span>
subst_implies_prv_S<span class="main">:</span>
<span class="quoted"><span class="quoted">"<span class="main">⋀</span> <span class="bound">φ</span><span class="main">.</span>
  <span class="keyword1">let</span> <span class="bound">SS</span> <span class="main">=</span> <span class="main">(</span><span class="main">λ</span> <span class="bound">t1</span> <span class="bound">t2</span><span class="main">.</span> psubst <span class="free">S</span> <span class="main">[</span><span class="main">(</span><span class="bound">t1</span><span class="main">,</span>xx<span class="main">)</span><span class="main">,</span> <span class="main">(</span><span class="bound">t2</span><span class="main">,</span>yy<span class="main">)</span><span class="main">]</span><span class="main">)</span> <span class="keyword1">in</span>
  <span class="bound">φ</span> <span class="main">∈</span> <span class="free">fmla</span> <span class="main">⟶</span> <span class="free">Fvars</span> <span class="bound">φ</span> <span class="main">=</span> <span class="main">{</span>xx<span class="main">}</span> <span class="main">⟶</span>
  <span class="free">bprv</span> <span class="main">(</span><span class="bound">SS</span> <span class="main"><span class="free">⟨</span></span><span class="bound">φ</span><span class="main"><span class="free">⟩</span></span> <span class="main"><span class="free">⟨</span></span><span class="free">subst</span> <span class="bound">φ</span> <span class="main"><span class="free">⟨</span></span><span class="bound">φ</span><span class="main"><span class="free">⟩</span></span> xx<span class="main"><span class="free">⟩</span></span><span class="main">)</span>"</span></span>
<span class="keyword2"><span class="keyword">and</span></span>
S_unique<span class="main">:</span>
<span class="quoted"><span class="quoted">"<span class="main">⋀</span> <span class="bound">φ</span><span class="main">.</span>
  <span class="keyword1">let</span> <span class="bound">SS</span> <span class="main">=</span> <span class="main">(</span><span class="main">λ</span> <span class="bound">t1</span> <span class="bound">t2</span><span class="main">.</span> psubst <span class="free">S</span> <span class="main">[</span><span class="main">(</span><span class="bound">t1</span><span class="main">,</span>xx<span class="main">)</span><span class="main">,</span> <span class="main">(</span><span class="bound">t2</span><span class="main">,</span>yy<span class="main">)</span><span class="main">]</span><span class="main">)</span> <span class="keyword1">in</span>
  <span class="bound">φ</span> <span class="main">∈</span> <span class="free">fmla</span> <span class="main">⟶</span> <span class="free">Fvars</span> <span class="bound">φ</span> <span class="main">=</span> <span class="main">{</span>xx<span class="main">}</span> <span class="main">⟶</span>
  <span class="free">bprv</span> <span class="main">(</span><span class="free">all</span> yy <span class="main">(</span><span class="free">all</span> yy'
     <span class="main">(</span><span class="free">imp</span> <span class="main">(</span><span class="free">cnj</span> <span class="main">(</span><span class="bound">SS</span> <span class="main"><span class="free">⟨</span></span><span class="bound">φ</span><span class="main"><span class="free">⟩</span></span> <span class="main">(</span><span class="free">Var</span> yy<span class="main">)</span><span class="main">)</span> <span class="main">(</span><span class="bound">SS</span> <span class="main"><span class="free">⟨</span></span><span class="bound">φ</span><span class="main"><span class="free">⟩</span></span> <span class="main">(</span><span class="free">Var</span> yy'<span class="main">)</span><span class="main">)</span><span class="main">)</span>
          <span class="main">(</span><span class="free">eql</span> <span class="main">(</span><span class="free">Var</span> yy<span class="main">)</span> <span class="main">(</span><span class="free">Var</span> yy'<span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span>
<span class="keyword2"><span class="keyword">begin</span></span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹SS is the instantiation combinator of S:›</span></span>
<span class="keyword1"><span class="command">definition</span></span> <span class="entity">SS</span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="free">SS</span> <span class="main">≡</span> <span class="main">λ</span> <span class="bound">t1</span> <span class="bound">t2</span><span class="main">.</span> psubst <span class="free">S</span> <span class="main">[</span><span class="main">(</span><span class="bound">t1</span><span class="main">,</span>xx<span class="main">)</span><span class="main">,</span> <span class="main">(</span><span class="bound">t2</span><span class="main">,</span>yy<span class="main">)</span><span class="main">]</span>"</span></span>

<span class="keyword1"><span class="command">lemma</span></span> SS_def2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">t1</span> <span class="main">∈</span> <span class="free">trm</span> <span class="main">⟹</span> <span class="free">t2</span> <span class="main">∈</span> <span class="free">trm</span> <span class="main">⟹</span>
 yy <span class="main">∉</span> <span class="free">FvarsT</span> <span class="free">t1</span> <span class="main">⟹</span>
 SS <span class="free">t1</span> <span class="free">t2</span> <span class="main">=</span> <span class="free">subst</span> <span class="main">(</span><span class="free">subst</span> <span class="free">S</span> <span class="free">t1</span> xx<span class="main">)</span> <span class="free">t2</span> yy"</span></span>
  <span class="keyword1"><span class="command">unfolding</span></span> SS_def <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> psubst_eq_rawpsubst2<span class="main"><span class="main">[</span></span><span class="operator">simplified</span><span class="main"><span class="main">]</span></span><span class="main">)</span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">lemma</span></span> subst_implies_prv_SS<span class="main">:</span>
<span class="quoted"><span class="quoted">"<span class="free">φ</span> <span class="main">∈</span> <span class="free">fmla</span> <span class="main">⟹</span> <span class="free">Fvars</span> <span class="free">φ</span> <span class="main">=</span> <span class="main">{</span>xx<span class="main">}</span> <span class="main">⟹</span> <span class="free">bprv</span> <span class="main">(</span>SS <span class="main"><span class="free">⟨</span></span><span class="free">φ</span><span class="main"><span class="free">⟩</span></span> <span class="main"><span class="free">⟨</span></span><span class="free">subst</span> <span class="free">φ</span> <span class="main"><span class="free">⟨</span></span><span class="free">φ</span><span class="main"><span class="free">⟩</span></span> xx<span class="main"><span class="free">⟩</span></span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">using</span></span> subst_implies_prv_S <span class="keyword1"><span class="command">unfolding</span></span> Let_def SS_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">meson</span>

<span class="keyword1"><span class="command">lemma</span></span> SS_unique<span class="main">:</span>
<span class="quoted"><span class="quoted">"<span class="free">φ</span> <span class="main">∈</span> <span class="free">fmla</span> <span class="main">⟹</span> <span class="free">Fvars</span> <span class="free">φ</span> <span class="main">=</span> <span class="main">{</span>xx<span class="main">}</span> <span class="main">⟹</span>
 <span class="free">bprv</span> <span class="main">(</span><span class="free">all</span> yy <span class="main">(</span><span class="free">all</span> yy'
      <span class="main">(</span><span class="free">imp</span> <span class="main">(</span><span class="free">cnj</span> <span class="main">(</span>SS <span class="main"><span class="free">⟨</span></span><span class="free">φ</span><span class="main"><span class="free">⟩</span></span> <span class="main">(</span><span class="free">Var</span> yy<span class="main">)</span><span class="main">)</span> <span class="main">(</span>SS <span class="main"><span class="free">⟨</span></span><span class="free">φ</span><span class="main"><span class="free">⟩</span></span> <span class="main">(</span><span class="free">Var</span> yy'<span class="main">)</span><span class="main">)</span><span class="main">)</span>
           <span class="main">(</span><span class="free">eql</span> <span class="main">(</span><span class="free">Var</span> yy<span class="main">)</span> <span class="main">(</span><span class="free">Var</span> yy'<span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">using</span></span> S_unique <span class="keyword1"><span class="command">unfolding</span></span> Let_def SS_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">meson</span>

<span class="keyword1"><span class="command">lemma</span></span> SS<span class="main">[</span><span class="operator">simp</span><span class="main">,</span><span class="operator">intro</span><span class="main">]</span><span class="main">:</span>
<span class="quoted"><span class="quoted">"<span class="free">t1</span> <span class="main">∈</span> <span class="free">trm</span> <span class="main">⟹</span> <span class="free">t2</span> <span class="main">∈</span> <span class="free">trm</span> <span class="main">⟹</span> SS <span class="free">t1</span> <span class="free">t2</span> <span class="main">∈</span> <span class="free">fmla</span>"</span></span>
<span class="keyword1"><span class="command">unfolding</span></span> SS_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">lemma</span></span> Fvars_SS<span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">t1</span> <span class="main">∈</span> <span class="free">trm</span> <span class="main">⟹</span> <span class="free">t2</span> <span class="main">∈</span> <span class="free">trm</span> <span class="main">⟹</span> yy <span class="main">∉</span> <span class="free">FvarsT</span> <span class="free">t1</span> <span class="main">⟹</span>
<span class="free">Fvars</span> <span class="main">(</span>SS <span class="free">t1</span> <span class="free">t2</span><span class="main">)</span> <span class="main">=</span> <span class="free">FvarsT</span> <span class="free">t1</span> <span class="main">∪</span> <span class="free">FvarsT</span> <span class="free">t2</span>"</span></span>
<span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> SS_def2 subst2_fresh_switch<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span>
<span class="quoted"><span class="quoted">"<span class="free">m</span> <span class="main">∈</span> <span class="free">num</span> <span class="main">⟹</span> <span class="free">p</span> <span class="main">∈</span> <span class="free">num</span> <span class="main">⟹</span> <span class="free">subst</span> <span class="main">(</span>SS <span class="free">m</span> <span class="main">(</span><span class="free">Var</span> yy<span class="main">)</span><span class="main">)</span> <span class="free">p</span> yy <span class="main">=</span> SS <span class="free">m</span> <span class="free">p</span>"</span></span>
<span class="quoted"><span class="quoted">"<span class="free">m</span> <span class="main">∈</span> <span class="free">num</span> <span class="main">⟹</span> <span class="free">subst</span> <span class="main">(</span>SS <span class="free">m</span> <span class="main">(</span><span class="free">Var</span> yy'<span class="main">)</span><span class="main">)</span> <span class="main">(</span><span class="free">Var</span> yy<span class="main">)</span> yy' <span class="main">=</span> SS <span class="free">m</span> <span class="main">(</span><span class="free">Var</span> yy<span class="main">)</span>"</span></span>
<span class="quoted"><span class="quoted">"<span class="free">m</span> <span class="main">∈</span> <span class="free">num</span> <span class="main">⟹</span> <span class="free">p</span> <span class="main">∈</span> <span class="free">num</span> <span class="main">⟹</span> <span class="free">subst</span> <span class="main">(</span>SS <span class="free">m</span> <span class="main">(</span><span class="free">Var</span> yy'<span class="main">)</span><span class="main">)</span> <span class="free">p</span> yy' <span class="main">=</span> SS <span class="free">m</span> <span class="free">p</span>"</span></span>
<span class="quoted"><span class="quoted">"<span class="free">m</span> <span class="main">∈</span> <span class="free">num</span> <span class="main">⟹</span> <span class="free">p</span> <span class="main">∈</span> <span class="free">num</span> <span class="main">⟹</span> <span class="free">subst</span> <span class="main">(</span>SS <span class="free">m</span> <span class="main">(</span><span class="free">Var</span> yy'<span class="main">)</span><span class="main">)</span> <span class="free">p</span> yy <span class="main">=</span> SS <span class="free">m</span> <span class="main">(</span><span class="free">Var</span> yy'<span class="main">)</span>"</span></span>
<span class="quoted"><span class="quoted">"<span class="free">m</span> <span class="main">∈</span> <span class="free">num</span> <span class="main">⟹</span> <span class="free">subst</span> <span class="main">(</span>SS <span class="main">(</span><span class="free">Var</span> xx<span class="main">)</span> <span class="main">(</span><span class="free">Var</span> yy<span class="main">)</span><span class="main">)</span> <span class="free">m</span> xx <span class="main">=</span> SS <span class="free">m</span> <span class="main">(</span><span class="free">Var</span> yy<span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> SS_def2 subst_comp_num Let_def<span class="main">)</span>

<span class="keyword2"><span class="keyword">end</span></span> <span class="comment1">― ‹context <span class="antiquoted"><span class="antiquote">@{</span><span class="operator">locale</span> Repr_SelfSubst<span class="antiquote">}</span></span>›</span>


<span class="keyword1"><span class="command">section</span></span> <span class="quoted"><span class="plain_text">‹Representability of Self-Soft-Substitution›</span></span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹The soft substitution function performs substitution logically instead of
syntactically. In particular, its "self" version sends <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">term</span></span> <span class="quoted"><span class="free"><span class="quoted"><span class="free">φ</span></span></span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span> to
<span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">term</span></span> <span class="quoted"><span class="quoted">"<span class="free"><span class="free">exi</span></span> <span class="free"><span class="free">xx</span></span> <span class="main"><span class="main">(</span></span><span class="free"><span class="free">cnj</span></span> <span class="main"><span class="main">(</span></span><span class="free"><span class="free">eql</span></span> <span class="main"><span class="main">(</span></span><span class="free"><span class="free">Var</span></span> <span class="free"><span class="free">xx</span></span><span class="main"><span class="main">)</span></span> <span class="main"><span class="main">(</span></span><span class="free"><span class="free">enc</span></span> <span class="free"><span class="free">φ</span></span><span class="main"><span class="main">)</span></span><span class="main"><span class="main">)</span></span> <span class="free"><span class="free">φ</span></span><span class="main"><span class="main">)</span></span>"</span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span>. Representability of self-soft-substitution will be
an alternative assumption in the diagonalization lemma.›</span></span>

<span class="keyword1"><span class="command">locale</span></span> Repr_SelfSoftSubst <span class="main">=</span>
Encode
  <span class="quoted"><span class="free">var</span></span> <span class="quoted"><span class="free">trm</span></span> <span class="quoted"><span class="free">fmla</span></span> <span class="quoted"><span class="free">Var</span></span> <span class="quoted"><span class="free">FvarsT</span></span> <span class="quoted"><span class="free">substT</span></span> <span class="quoted"><span class="free">Fvars</span></span> <span class="quoted"><span class="free">subst</span></span>
  <span class="quoted"><span class="free">num</span></span>
  <span class="quoted"><span class="free">enc</span></span>
<span class="main">+</span>
Deduct2
  <span class="quoted"><span class="free">var</span></span> <span class="quoted"><span class="free">trm</span></span> <span class="quoted"><span class="free">fmla</span></span> <span class="quoted"><span class="free">Var</span></span> <span class="quoted"><span class="free">FvarsT</span></span> <span class="quoted"><span class="free">substT</span></span> <span class="quoted"><span class="free">Fvars</span></span> <span class="quoted"><span class="free">subst</span></span>
  <span class="quoted"><span class="free">num</span></span>
  <span class="quoted"><span class="free">eql</span></span> <span class="quoted"><span class="free">cnj</span></span> <span class="quoted"><span class="free">imp</span></span> <span class="quoted"><span class="free">all</span></span> <span class="quoted"><span class="free">exi</span></span>
  <span class="quoted"><span class="free">prv</span></span> <span class="quoted"><span class="free">bprv</span></span>
<span class="keyword2"><span class="keyword">for</span></span>
<span class="free">var</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'var</span> set"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="free">trm</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'trm</span> set"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="free">fmla</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'fmla</span> set"</span></span>
<span class="keyword2"><span class="keyword">and</span></span> <span class="free">Var</span> <span class="free">FvarsT</span> <span class="free">substT</span> <span class="free">Fvars</span> <span class="free">subst</span>
<span class="keyword2"><span class="keyword">and</span></span> <span class="free">num</span>
<span class="keyword2"><span class="keyword">and</span></span> <span class="free">eql</span> <span class="free">cnj</span> <span class="free">imp</span> <span class="free">all</span> <span class="free">exi</span>
<span class="keyword2"><span class="keyword">and</span></span> <span class="free">prv</span> <span class="free">bprv</span>
<span class="keyword2"><span class="keyword">and</span></span> <span class="free">enc</span> <span class="main">(</span><span class="quoted">"<span class="keyword1">⟨</span>_<span class="keyword1">⟩</span>"</span><span class="main">)</span>
<span class="main">+</span>
<span class="keyword2"><span class="keyword">fixes</span></span> <span class="free">S</span> <span class="main">::</span> <span class="tfree"><span class="quoted"><span class="tfree">'fmla</span></span></span>
<span class="keyword2"><span class="keyword">assumes</span></span>
S<span class="main">[</span><span class="operator">simp</span><span class="main">,</span><span class="operator">intro</span><span class="main"><span class="main">!</span></span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">S</span> <span class="main">∈</span> <span class="free">fmla</span>"</span></span>
<span class="keyword2"><span class="keyword">and</span></span>
Fvars_S<span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">Fvars</span> <span class="free">S</span> <span class="main">=</span> <span class="main">{</span>xx<span class="main">,</span>yy<span class="main">}</span>"</span></span>
<span class="keyword2"><span class="keyword">and</span></span>
softSubst_implies_prv_S<span class="main">:</span>
<span class="quoted"><span class="quoted">"<span class="main">⋀</span> <span class="bound">φ</span><span class="main">.</span>
  <span class="keyword1">let</span> <span class="bound">SS</span> <span class="main">=</span> <span class="main">(</span><span class="main">λ</span> <span class="bound">t1</span> <span class="bound">t2</span><span class="main">.</span> psubst <span class="free">S</span> <span class="main">[</span><span class="main">(</span><span class="bound">t1</span><span class="main">,</span>xx<span class="main">)</span><span class="main">,</span> <span class="main">(</span><span class="bound">t2</span><span class="main">,</span>yy<span class="main">)</span><span class="main">]</span><span class="main">)</span> <span class="keyword1">in</span>
  <span class="bound">φ</span> <span class="main">∈</span> <span class="free">fmla</span> <span class="main">⟶</span> <span class="free">Fvars</span> <span class="bound">φ</span> <span class="main">=</span> <span class="main">{</span>xx<span class="main">}</span> <span class="main">⟶</span>
  <span class="free">bprv</span> <span class="main">(</span><span class="bound">SS</span> <span class="main"><span class="free">⟨</span></span><span class="bound">φ</span><span class="main"><span class="free">⟩</span></span> <span class="main"><span class="free">⟨</span></span>softSubst <span class="bound">φ</span> <span class="main"><span class="free">⟨</span></span><span class="bound">φ</span><span class="main"><span class="free">⟩</span></span> xx<span class="main"><span class="free">⟩</span></span><span class="main">)</span>"</span></span>
<span class="keyword2"><span class="keyword">and</span></span>
S_unique<span class="main">:</span>
<span class="quoted"><span class="quoted">"<span class="main">⋀</span> <span class="bound">φ</span><span class="main">.</span>
  <span class="keyword1">let</span> <span class="bound">SS</span> <span class="main">=</span> <span class="main">(</span><span class="main">λ</span> <span class="bound">t1</span> <span class="bound">t2</span><span class="main">.</span> psubst <span class="free">S</span> <span class="main">[</span><span class="main">(</span><span class="bound">t1</span><span class="main">,</span>xx<span class="main">)</span><span class="main">,</span> <span class="main">(</span><span class="bound">t2</span><span class="main">,</span>yy<span class="main">)</span><span class="main">]</span><span class="main">)</span> <span class="keyword1">in</span>
  <span class="bound">φ</span> <span class="main">∈</span> <span class="free">fmla</span> <span class="main">⟶</span> <span class="free">Fvars</span> <span class="bound">φ</span> <span class="main">=</span> <span class="main">{</span>xx<span class="main">}</span> <span class="main">⟶</span>
  <span class="free">bprv</span> <span class="main">(</span><span class="free">all</span> yy <span class="main">(</span><span class="free">all</span> yy'
     <span class="main">(</span><span class="free">imp</span> <span class="main">(</span><span class="free">cnj</span> <span class="main">(</span><span class="bound">SS</span> <span class="main"><span class="free">⟨</span></span><span class="bound">φ</span><span class="main"><span class="free">⟩</span></span> <span class="main">(</span><span class="free">Var</span> yy<span class="main">)</span><span class="main">)</span> <span class="main">(</span><span class="bound">SS</span> <span class="main"><span class="free">⟨</span></span><span class="bound">φ</span><span class="main"><span class="free">⟩</span></span> <span class="main">(</span><span class="free">Var</span> yy'<span class="main">)</span><span class="main">)</span><span class="main">)</span>
          <span class="main">(</span><span class="free">eql</span> <span class="main">(</span><span class="free">Var</span> yy<span class="main">)</span> <span class="main">(</span><span class="free">Var</span> yy'<span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span>
<span class="keyword2"><span class="keyword">begin</span></span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹SS is the instantiation combinator of S:›</span></span>
<span class="keyword1"><span class="command">definition</span></span> <span class="entity">SS</span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="free">SS</span> <span class="main">≡</span> <span class="main">λ</span> <span class="bound">t1</span> <span class="bound">t2</span><span class="main">.</span> psubst <span class="free">S</span> <span class="main">[</span><span class="main">(</span><span class="bound">t1</span><span class="main">,</span>xx<span class="main">)</span><span class="main">,</span> <span class="main">(</span><span class="bound">t2</span><span class="main">,</span>yy<span class="main">)</span><span class="main">]</span>"</span></span>

<span class="keyword1"><span class="command">lemma</span></span> SS_def2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">t1</span> <span class="main">∈</span> <span class="free">trm</span> <span class="main">⟹</span> <span class="free">t2</span> <span class="main">∈</span> <span class="free">trm</span> <span class="main">⟹</span>
 yy <span class="main">∉</span> <span class="free">FvarsT</span> <span class="free">t1</span> <span class="main">⟹</span>
 SS <span class="free">t1</span> <span class="free">t2</span> <span class="main">=</span> <span class="free">subst</span> <span class="main">(</span><span class="free">subst</span> <span class="free">S</span> <span class="free">t1</span> xx<span class="main">)</span> <span class="free">t2</span> yy"</span></span>
  <span class="keyword1"><span class="command">unfolding</span></span> SS_def <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> psubst_eq_rawpsubst2<span class="main"><span class="main">[</span></span><span class="operator">simplified</span><span class="main"><span class="main">]</span></span><span class="main">)</span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">lemma</span></span> softSubst_implies_prv_SS<span class="main">:</span>
<span class="quoted"><span class="quoted">"<span class="free">φ</span> <span class="main">∈</span> <span class="free">fmla</span> <span class="main">⟹</span> <span class="free">Fvars</span> <span class="free">φ</span> <span class="main">=</span> <span class="main">{</span>xx<span class="main">}</span> <span class="main">⟹</span> <span class="free">bprv</span> <span class="main">(</span>SS <span class="main"><span class="free">⟨</span></span><span class="free">φ</span><span class="main"><span class="free">⟩</span></span> <span class="main"><span class="free">⟨</span></span>softSubst <span class="free">φ</span> <span class="main"><span class="free">⟨</span></span><span class="free">φ</span><span class="main"><span class="free">⟩</span></span> xx<span class="main"><span class="free">⟩</span></span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">using</span></span> softSubst_implies_prv_S <span class="keyword1"><span class="command">unfolding</span></span> Let_def SS_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">meson</span>

<span class="keyword1"><span class="command">lemma</span></span> SS_unique<span class="main">:</span>
<span class="quoted"><span class="quoted">"<span class="free">φ</span> <span class="main">∈</span> <span class="free">fmla</span> <span class="main">⟹</span> <span class="free">Fvars</span> <span class="free">φ</span> <span class="main">=</span> <span class="main">{</span>xx<span class="main">}</span> <span class="main">⟹</span>
 <span class="free">bprv</span> <span class="main">(</span><span class="free">all</span> yy <span class="main">(</span><span class="free">all</span> yy'
     <span class="main">(</span><span class="free">imp</span> <span class="main">(</span><span class="free">cnj</span> <span class="main">(</span>SS <span class="main"><span class="free">⟨</span></span><span class="free">φ</span><span class="main"><span class="free">⟩</span></span> <span class="main">(</span><span class="free">Var</span> yy<span class="main">)</span><span class="main">)</span> <span class="main">(</span>SS <span class="main"><span class="free">⟨</span></span><span class="free">φ</span><span class="main"><span class="free">⟩</span></span> <span class="main">(</span><span class="free">Var</span> yy'<span class="main">)</span><span class="main">)</span><span class="main">)</span>
          <span class="main">(</span><span class="free">eql</span> <span class="main">(</span><span class="free">Var</span> yy<span class="main">)</span> <span class="main">(</span><span class="free">Var</span> yy'<span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">using</span></span> S_unique <span class="keyword1"><span class="command">unfolding</span></span> Let_def SS_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">meson</span>

<span class="keyword1"><span class="command">lemma</span></span> SS<span class="main">[</span><span class="operator">simp</span><span class="main">,</span><span class="operator">intro</span><span class="main">]</span><span class="main">:</span>
<span class="quoted"><span class="quoted">"<span class="free">t1</span> <span class="main">∈</span> <span class="free">trm</span> <span class="main">⟹</span> <span class="free">t2</span> <span class="main">∈</span> <span class="free">trm</span> <span class="main">⟹</span> SS <span class="free">t1</span> <span class="free">t2</span> <span class="main">∈</span> <span class="free">fmla</span>"</span></span>
<span class="keyword1"><span class="command">unfolding</span></span> SS_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">lemma</span></span> Fvars_SS<span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">t1</span> <span class="main">∈</span> <span class="free">trm</span> <span class="main">⟹</span> <span class="free">t2</span> <span class="main">∈</span> <span class="free">trm</span> <span class="main">⟹</span> yy <span class="main">∉</span> <span class="free">FvarsT</span> <span class="free">t1</span> <span class="main">⟹</span>
<span class="free">Fvars</span> <span class="main">(</span>SS <span class="free">t1</span> <span class="free">t2</span><span class="main">)</span> <span class="main">=</span> <span class="free">FvarsT</span> <span class="free">t1</span> <span class="main">∪</span> <span class="free">FvarsT</span> <span class="free">t2</span>"</span></span>
<span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> SS_def2 subst2_fresh_switch<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span>
<span class="quoted"><span class="quoted">"<span class="free">m</span> <span class="main">∈</span> <span class="free">num</span> <span class="main">⟹</span> <span class="free">p</span> <span class="main">∈</span> <span class="free">num</span> <span class="main">⟹</span> <span class="free">subst</span> <span class="main">(</span>SS <span class="free">m</span> <span class="main">(</span><span class="free">Var</span> yy<span class="main">)</span><span class="main">)</span> <span class="free">p</span> yy <span class="main">=</span> SS <span class="free">m</span> <span class="free">p</span>"</span></span>
<span class="quoted"><span class="quoted">"<span class="free">m</span> <span class="main">∈</span> <span class="free">num</span> <span class="main">⟹</span> <span class="free">subst</span> <span class="main">(</span>SS <span class="free">m</span> <span class="main">(</span><span class="free">Var</span> yy'<span class="main">)</span><span class="main">)</span> <span class="main">(</span><span class="free">Var</span> yy<span class="main">)</span> yy' <span class="main">=</span> SS <span class="free">m</span> <span class="main">(</span><span class="free">Var</span> yy<span class="main">)</span>"</span></span>
<span class="quoted"><span class="quoted">"<span class="free">m</span> <span class="main">∈</span> <span class="free">num</span> <span class="main">⟹</span> <span class="free">p</span> <span class="main">∈</span> <span class="free">num</span> <span class="main">⟹</span> <span class="free">subst</span> <span class="main">(</span>SS <span class="free">m</span> <span class="main">(</span><span class="free">Var</span> yy'<span class="main">)</span><span class="main">)</span> <span class="free">p</span> yy' <span class="main">=</span> SS <span class="free">m</span> <span class="free">p</span>"</span></span>
<span class="quoted"><span class="quoted">"<span class="free">m</span> <span class="main">∈</span> <span class="free">num</span> <span class="main">⟹</span> <span class="free">p</span> <span class="main">∈</span> <span class="free">num</span> <span class="main">⟹</span> <span class="free">subst</span> <span class="main">(</span>SS <span class="free">m</span> <span class="main">(</span><span class="free">Var</span> yy'<span class="main">)</span><span class="main">)</span> <span class="free">p</span> yy <span class="main">=</span> SS <span class="free">m</span> <span class="main">(</span><span class="free">Var</span> yy'<span class="main">)</span>"</span></span>
<span class="quoted"><span class="quoted">"<span class="free">m</span> <span class="main">∈</span> <span class="free">num</span> <span class="main">⟹</span> <span class="free">subst</span> <span class="main">(</span>SS <span class="main">(</span><span class="free">Var</span> xx<span class="main">)</span> <span class="main">(</span><span class="free">Var</span> yy<span class="main">)</span><span class="main">)</span> <span class="free">m</span> xx <span class="main">=</span> SS <span class="free">m</span> <span class="main">(</span><span class="free">Var</span> yy<span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> SS_def2 subst_comp_num Let_def<span class="main">)</span>

<span class="keyword2"><span class="keyword">end</span></span> <span class="comment1">― ‹context <span class="antiquoted"><span class="antiquote">@{</span><span class="operator">locale</span> Repr_SelfSoftSubst<span class="antiquote">}</span></span>›</span>


<span class="keyword1"><span class="command">section</span></span> <span class="quoted"><span class="plain_text">‹Clean Representability of the "Proof-of" Relation›</span></span>


<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹For the proof-of relation, we must assume a stronger version of
representability, namely clean representability on the first argument, which
is dedicated to encoding the proof component. The property asks that the
representation predicate is provably false on numerals that do not encode
proofs; it would hold trivially for surjective proof encodings.

Cleanness is not a standard concept in the literature -- we have
introduced it in our CADE 2019 paper~\cite{DBLP:conf/cade/0001T19}.›</span></span>

<span class="keyword1"><span class="command">locale</span></span> CleanRepr_Proofs <span class="main">=</span>
Encode_Proofs
  <span class="quoted"><span class="free">var</span></span> <span class="quoted"><span class="free">trm</span></span> <span class="quoted"><span class="free">fmla</span></span> <span class="quoted"><span class="free">Var</span></span> <span class="quoted"><span class="free">FvarsT</span></span> <span class="quoted"><span class="free">substT</span></span> <span class="quoted"><span class="free">Fvars</span></span> <span class="quoted"><span class="free">subst</span></span>
  <span class="quoted"><span class="free">num</span></span>
  <span class="quoted"><span class="free">eql</span></span> <span class="quoted"><span class="free">cnj</span></span> <span class="quoted"><span class="free">imp</span></span> <span class="quoted"><span class="free">all</span></span> <span class="quoted"><span class="free">exi</span></span>
  <span class="quoted"><span class="free">prv</span></span> <span class="quoted"><span class="free">bprv</span></span>
  <span class="quoted"><span class="free">enc</span></span>
  <span class="quoted"><span class="free">fls</span></span>
  <span class="quoted"><span class="free">dsj</span></span>
  <span class="quoted"><span class="quoted">"<span class="free">proof</span>"</span></span> <span class="quoted"><span class="free">prfOf</span></span>
  <span class="quoted"><span class="free">encPf</span></span>
<span class="keyword2"><span class="keyword">for</span></span>
<span class="free">var</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'var</span> set"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="free">trm</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'trm</span> set"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="free">fmla</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'fmla</span> set"</span></span>
<span class="keyword2"><span class="keyword">and</span></span> <span class="free">Var</span> <span class="free">FvarsT</span> <span class="free">substT</span> <span class="free">Fvars</span> <span class="free">subst</span>
<span class="keyword2"><span class="keyword">and</span></span> <span class="free">num</span>
<span class="keyword2"><span class="keyword">and</span></span> <span class="free">eql</span> <span class="free">cnj</span> <span class="free">imp</span> <span class="free">all</span> <span class="free">exi</span>
<span class="keyword2"><span class="keyword">and</span></span> <span class="free">prv</span> <span class="free">bprv</span>
<span class="keyword2"><span class="keyword">and</span></span> <span class="free">enc</span> <span class="main">(</span><span class="quoted">"<span class="keyword1">⟨</span>_<span class="keyword1">⟩</span>"</span><span class="main">)</span>
<span class="keyword2"><span class="keyword">and</span></span> <span class="free">fls</span> <span class="free">dsj</span>
<span class="keyword2"><span class="keyword">and</span></span> <span class="quoted">"<span class="free">proof</span>"</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'proof</span> set"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="free">prfOf</span>
<span class="keyword2"><span class="keyword">and</span></span> <span class="free">encPf</span>
<span class="main">+</span>
<span class="keyword2"><span class="keyword">fixes</span></span> <span class="free">Pf</span> <span class="main">::</span> <span class="tfree"><span class="quoted"><span class="tfree">'fmla</span></span></span>
<span class="keyword2"><span class="keyword">assumes</span></span>
Pf<span class="main">[</span><span class="operator">simp</span><span class="main">,</span><span class="operator">intro</span><span class="main"><span class="main">!</span></span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">Pf</span> <span class="main">∈</span> <span class="free">fmla</span>"</span></span>
<span class="keyword2"><span class="keyword">and</span></span>
Fvars_Pf<span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">Fvars</span> <span class="free">Pf</span> <span class="main">=</span> <span class="main">{</span>yy<span class="main">,</span>xx<span class="main">}</span>"</span></span>
<span class="keyword2"><span class="keyword">and</span></span>
prfOf_Pf<span class="main">:</span>
<span class="quoted"><span class="quoted">"<span class="main">⋀</span> <span class="bound">prf</span> <span class="bound">φ</span><span class="main">.</span>
  <span class="keyword1">let</span> <span class="bound">PPf</span> <span class="main">=</span> <span class="main">(</span><span class="main">λ</span> <span class="bound">t1</span> <span class="bound">t2</span><span class="main">.</span> psubst <span class="free">Pf</span> <span class="main">[</span><span class="main">(</span><span class="bound">t1</span><span class="main">,</span>yy<span class="main">)</span><span class="main">,</span> <span class="main">(</span><span class="bound">t2</span><span class="main">,</span>xx<span class="main">)</span><span class="main">]</span><span class="main">)</span> <span class="keyword1">in</span>
  <span class="main">(</span><span class="bound">prf</span> <span class="main">∈</span> <span class="free">proof</span> <span class="main">∧</span> <span class="bound">φ</span> <span class="main">∈</span> <span class="free">fmla</span> <span class="main">∧</span> <span class="free">Fvars</span> <span class="bound">φ</span> <span class="main">=</span> <span class="main">{}</span> <span class="main">⟶</span>
   <span class="free">prfOf</span> <span class="bound">prf</span> <span class="bound">φ</span>
   <span class="main">⟶</span>
   <span class="free">bprv</span> <span class="main">(</span><span class="bound">PPf</span> <span class="main">(</span><span class="free">encPf</span> <span class="bound">prf</span><span class="main">)</span> <span class="main"><span class="free">⟨</span></span><span class="bound">φ</span><span class="main"><span class="free">⟩</span></span><span class="main">)</span><span class="main">)</span>"</span></span>
<span class="keyword2"><span class="keyword">and</span></span>
not_prfOf_Pf<span class="main">:</span>
<span class="quoted"><span class="quoted">"<span class="main">⋀</span> <span class="bound">prf</span> <span class="bound">φ</span><span class="main">.</span>
  <span class="keyword1">let</span> <span class="bound">PPf</span> <span class="main">=</span> <span class="main">(</span><span class="main">λ</span> <span class="bound">t1</span> <span class="bound">t2</span><span class="main">.</span> psubst <span class="free">Pf</span> <span class="main">[</span><span class="main">(</span><span class="bound">t1</span><span class="main">,</span>yy<span class="main">)</span><span class="main">,</span> <span class="main">(</span><span class="bound">t2</span><span class="main">,</span>xx<span class="main">)</span><span class="main">]</span><span class="main">)</span> <span class="keyword1">in</span>
  <span class="main">(</span><span class="bound">prf</span> <span class="main">∈</span> <span class="free">proof</span> <span class="main">∧</span> <span class="bound">φ</span> <span class="main">∈</span> <span class="free">fmla</span> <span class="main">∧</span> <span class="free">Fvars</span> <span class="bound">φ</span> <span class="main">=</span> <span class="main">{}</span> <span class="main">⟶</span>
   <span class="main">¬</span> <span class="free">prfOf</span> <span class="bound">prf</span> <span class="bound">φ</span>
   <span class="main">⟶</span>
   <span class="free">bprv</span> <span class="main">(</span>neg <span class="main">(</span><span class="bound">PPf</span> <span class="main">(</span><span class="free">encPf</span> <span class="bound">prf</span><span class="main">)</span> <span class="main"><span class="free">⟨</span></span><span class="bound">φ</span><span class="main"><span class="free">⟩</span></span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span>
<span class="keyword2"><span class="keyword">and</span></span>
Clean_Pf_encPf<span class="main">:</span>
<span class="quoted"><span class="quoted">"<span class="main">⋀</span> <span class="bound">p</span> <span class="bound">φ</span><span class="main">.</span> <span class="keyword1">let</span> <span class="bound">PPf</span> <span class="main">=</span> <span class="main">(</span><span class="main">λ</span> <span class="bound">t1</span> <span class="bound">t2</span><span class="main">.</span> psubst <span class="free">Pf</span> <span class="main">[</span><span class="main">(</span><span class="bound">t1</span><span class="main">,</span>yy<span class="main">)</span><span class="main">,</span> <span class="main">(</span><span class="bound">t2</span><span class="main">,</span>xx<span class="main">)</span><span class="main">]</span><span class="main">)</span> <span class="keyword1">in</span>
  <span class="bound">p</span> <span class="main">∈</span> <span class="free">num</span> <span class="main">∧</span> <span class="bound">φ</span> <span class="main">∈</span> <span class="free">fmla</span> <span class="main">∧</span> <span class="free">Fvars</span> <span class="bound">φ</span> <span class="main">=</span> <span class="main">{}</span> <span class="main">⟶</span> <span class="bound">p</span> <span class="main">∉</span> <span class="free">encPf</span> <span class="main">`</span> <span class="free">proof</span> <span class="main">⟶</span> <span class="free">bprv</span> <span class="main">(</span>neg <span class="main">(</span><span class="bound">PPf</span> <span class="bound">p</span> <span class="main"><span class="free">⟨</span></span><span class="bound">φ</span><span class="main"><span class="free">⟩</span></span><span class="main">)</span><span class="main">)</span>"</span></span>
<span class="keyword2"><span class="keyword">begin</span></span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹PPf is the instantiation combinator of Pf:›</span></span>
<span class="keyword1"><span class="command">definition</span></span> <span class="entity">PPf</span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="free">PPf</span> <span class="main">≡</span> <span class="main">λ</span> <span class="bound">t1</span> <span class="bound">t2</span><span class="main">.</span> psubst <span class="free">Pf</span> <span class="main">[</span><span class="main">(</span><span class="bound">t1</span><span class="main">,</span>yy<span class="main">)</span><span class="main">,</span> <span class="main">(</span><span class="bound">t2</span><span class="main">,</span>xx<span class="main">)</span><span class="main">]</span>"</span></span>

<span class="keyword1"><span class="command">lemma</span></span> prfOf_PPf<span class="main">:</span>
<span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">prf</span> <span class="main">∈</span> <span class="free">proof</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="free">φ</span> <span class="main">∈</span> <span class="free">fmla</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="free">Fvars</span> <span class="free">φ</span> <span class="main">=</span> <span class="main">{}</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="free">prfOf</span> <span class="free">prf</span> <span class="free">φ</span>"</span></span>
<span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">bprv</span> <span class="main">(</span>PPf <span class="main">(</span><span class="free">encPf</span> <span class="free">prf</span><span class="main">)</span> <span class="main"><span class="free">⟨</span></span><span class="free">φ</span><span class="main"><span class="free">⟩</span></span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> assms prfOf_Pf <span class="keyword1"><span class="command">unfolding</span></span> PPf_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">lemma</span></span> not_prfOf_PPf<span class="main">:</span>
<span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">prf</span> <span class="main">∈</span> <span class="free">proof</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="free">φ</span> <span class="main">∈</span> <span class="free">fmla</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="free">Fvars</span> <span class="free">φ</span> <span class="main">=</span> <span class="main">{}</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> <span class="free">prfOf</span> <span class="free">prf</span> <span class="free">φ</span>"</span></span>
<span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">bprv</span> <span class="main">(</span>neg <span class="main">(</span>PPf <span class="main">(</span><span class="free">encPf</span> <span class="free">prf</span><span class="main">)</span> <span class="main"><span class="free">⟨</span></span><span class="free">φ</span><span class="main"><span class="free">⟩</span></span><span class="main">)</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> assms not_prfOf_Pf <span class="keyword1"><span class="command">unfolding</span></span> PPf_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">lemma</span></span> Clean_PPf_encPf<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">φ</span> <span class="main">∈</span> <span class="free">fmla</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="free">Fvars</span> <span class="free">φ</span> <span class="main">=</span> <span class="main">{}</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">p</span> <span class="main">∈</span> <span class="free">num</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="free">p</span> <span class="main">∉</span> <span class="free">encPf</span> <span class="main">`</span> <span class="free">proof</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">bprv</span> <span class="main">(</span>neg <span class="main">(</span>PPf <span class="free">p</span> <span class="main"><span class="free">⟨</span></span><span class="free">φ</span><span class="main"><span class="free">⟩</span></span><span class="main">)</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">using</span></span> assms Clean_Pf_encPf <span class="keyword1"><span class="command">unfolding</span></span> PPf_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">lemma</span></span> PPf<span class="main">[</span><span class="operator">simp</span><span class="main">,</span><span class="operator">intro</span><span class="main"><span class="main"><span class="main">!</span></span></span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">t1</span> <span class="main">∈</span> <span class="free">trm</span> <span class="main">⟹</span> <span class="free">t2</span> <span class="main">∈</span> <span class="free">trm</span> <span class="main">⟹</span> xx <span class="main">∉</span> <span class="free">FvarsT</span> <span class="free">t1</span> <span class="main">⟹</span> PPf <span class="free">t1</span> <span class="free">t2</span> <span class="main">∈</span> <span class="free">fmla</span>"</span></span>
  <span class="keyword1"><span class="command">unfolding</span></span> PPf_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">lemma</span></span> PPf_def2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">t1</span> <span class="main">∈</span> <span class="free">trm</span> <span class="main">⟹</span> <span class="free">t2</span> <span class="main">∈</span> <span class="free">trm</span> <span class="main">⟹</span> xx <span class="main">∉</span> <span class="free">FvarsT</span> <span class="free">t1</span> <span class="main">⟹</span>
  PPf <span class="free">t1</span> <span class="free">t2</span> <span class="main">=</span> <span class="free">subst</span> <span class="main">(</span><span class="free">subst</span> <span class="free">Pf</span> <span class="free">t1</span> yy<span class="main">)</span> <span class="free">t2</span> xx"</span></span>
  <span class="keyword1"><span class="command">unfolding</span></span> PPf_def <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> psubst_eq_rawpsubst2<span class="main"><span class="main">[</span></span><span class="operator">simplified</span><span class="main"><span class="main">]</span></span><span class="main">)</span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">lemma</span></span> Fvars_PPf<span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span>
<span class="quoted"><span class="quoted">"<span class="free">t1</span> <span class="main">∈</span> <span class="free">trm</span> <span class="main">⟹</span> <span class="free">t2</span> <span class="main">∈</span> <span class="free">trm</span> <span class="main">⟹</span> xx <span class="main">∉</span> <span class="free">FvarsT</span> <span class="free">t1</span> <span class="main">⟹</span>
 <span class="free">Fvars</span> <span class="main">(</span>PPf <span class="free">t1</span> <span class="free">t2</span><span class="main">)</span> <span class="main">=</span> <span class="free">FvarsT</span> <span class="free">t1</span> <span class="main">∪</span> <span class="free">FvarsT</span> <span class="free">t2</span>"</span></span>
<span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> PPf_def2 subst2_fresh_switch<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span>
<span class="quoted"><span class="quoted">"<span class="free">n</span> <span class="main">∈</span> <span class="free">num</span> <span class="main">⟹</span> <span class="free">subst</span> <span class="main">(</span>PPf <span class="main">(</span><span class="free">Var</span> yy<span class="main">)</span> <span class="main">(</span><span class="free">Var</span> xx<span class="main">)</span><span class="main">)</span> <span class="free">n</span> xx <span class="main">=</span> PPf <span class="main">(</span><span class="free">Var</span> yy<span class="main">)</span> <span class="free">n</span>"</span></span>
<span class="quoted"><span class="quoted">"<span class="free">m</span> <span class="main">∈</span> <span class="free">num</span> <span class="main">⟹</span> <span class="free">n</span> <span class="main">∈</span> <span class="free">num</span> <span class="main">⟹</span> <span class="free">subst</span> <span class="main">(</span>PPf <span class="main">(</span><span class="free">Var</span> yy<span class="main">)</span> <span class="free">m</span><span class="main">)</span> <span class="free">n</span> yy <span class="main">=</span> PPf <span class="free">n</span> <span class="free">m</span>"</span></span>
<span class="quoted"><span class="quoted">"<span class="free">n</span> <span class="main">∈</span> <span class="free">num</span> <span class="main">⟹</span> <span class="free">subst</span> <span class="main">(</span>PPf <span class="main">(</span><span class="free">Var</span> yy<span class="main">)</span> <span class="main">(</span><span class="free">Var</span> xx<span class="main">)</span><span class="main">)</span> <span class="free">n</span> yy <span class="main">=</span> PPf <span class="free">n</span> <span class="main">(</span><span class="free">Var</span> xx<span class="main">)</span>"</span></span>
<span class="quoted"><span class="quoted">"<span class="free">m</span> <span class="main">∈</span> <span class="free">num</span> <span class="main">⟹</span> <span class="free">n</span> <span class="main">∈</span> <span class="free">num</span> <span class="main">⟹</span> <span class="free">subst</span> <span class="main">(</span>PPf <span class="free">m</span> <span class="main">(</span><span class="free">Var</span> xx<span class="main">)</span><span class="main">)</span> <span class="free">n</span> xx <span class="main">=</span> PPf <span class="free">m</span> <span class="free">n</span>"</span></span>
<span class="quoted"><span class="quoted">"<span class="free">m</span> <span class="main">∈</span> <span class="free">num</span> <span class="main">⟹</span> <span class="free">subst</span> <span class="main">(</span>PPf <span class="main">(</span><span class="free">Var</span> zz<span class="main">)</span> <span class="main">(</span><span class="free">Var</span> xx'<span class="main">)</span><span class="main">)</span> <span class="free">m</span> zz <span class="main">=</span> PPf <span class="free">m</span> <span class="main">(</span><span class="free">Var</span> xx'<span class="main">)</span>"</span></span>
<span class="quoted"><span class="quoted">"<span class="free">m</span> <span class="main">∈</span> <span class="free">num</span> <span class="main">⟹</span> <span class="free">n</span> <span class="main">∈</span> <span class="free">num</span> <span class="main">⟹</span> <span class="free">subst</span> <span class="main">(</span>PPf <span class="free">m</span> <span class="main">(</span><span class="free">Var</span> xx'<span class="main">)</span><span class="main">)</span> <span class="free">n</span> xx' <span class="main">=</span> PPf <span class="free">m</span> <span class="free">n</span>"</span></span>
<span class="quoted"><span class="quoted">"<span class="free">n</span> <span class="main">∈</span> <span class="free">num</span> <span class="main">⟹</span> <span class="free">subst</span> <span class="main">(</span>PPf <span class="main">(</span><span class="free">Var</span> zz<span class="main">)</span> <span class="main">(</span><span class="free">Var</span> xx'<span class="main">)</span><span class="main">)</span> <span class="free">n</span> xx' <span class="main">=</span> PPf <span class="main">(</span><span class="free">Var</span> zz<span class="main">)</span> <span class="free">n</span>"</span></span>
<span class="quoted"><span class="quoted">"<span class="free">m</span> <span class="main">∈</span> <span class="free">num</span> <span class="main">⟹</span> <span class="free">n</span> <span class="main">∈</span> <span class="free">num</span> <span class="main">⟹</span> <span class="free">subst</span> <span class="main">(</span>PPf <span class="main">(</span><span class="free">Var</span> zz<span class="main">)</span> <span class="free">n</span><span class="main">)</span> <span class="free">m</span> zz <span class="main">=</span> PPf <span class="free">m</span> <span class="free">n</span>"</span></span>
<span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> PPf_def2 subst2_fresh_switch<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> B_consistent_prfOf_iff_PPf<span class="main">:</span>
<span class="quoted"><span class="quoted">"B.consistent <span class="main">⟹</span> <span class="free">prf</span> <span class="main">∈</span> <span class="free">proof</span> <span class="main">⟹</span> <span class="free">φ</span> <span class="main">∈</span> <span class="free">fmla</span> <span class="main">⟹</span> <span class="free">Fvars</span> <span class="free">φ</span> <span class="main">=</span> <span class="main">{}</span> <span class="main">⟶</span> <span class="free">prfOf</span> <span class="free">prf</span> <span class="free">φ</span> <span class="main">⟷</span> <span class="free">bprv</span> <span class="main">(</span>PPf <span class="main">(</span><span class="free">encPf</span> <span class="free">prf</span><span class="main">)</span> <span class="main"><span class="free">⟨</span></span><span class="free">φ</span><span class="main"><span class="free">⟩</span></span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">unfolding</span></span> B.consistent_def3 <span class="keyword1"><span class="command">using</span></span> not_prfOf_PPf<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="quoted">"<span class="free">prf</span>"</span></span> <span class="quoted"><span class="free">φ</span></span><span class="main">]</span> prfOf_PPf<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="quoted">"<span class="free">prf</span>"</span></span> <span class="quoted"><span class="free">φ</span></span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">force</span>

<span class="keyword1"><span class="command">lemma</span></span> consistent_prfOf_iff_PPf<span class="main">:</span>
<span class="quoted"><span class="quoted">"consistent <span class="main">⟹</span> <span class="free">prf</span> <span class="main">∈</span> <span class="free">proof</span> <span class="main">⟹</span> <span class="free">φ</span> <span class="main">∈</span> <span class="free">fmla</span> <span class="main">⟹</span> <span class="free">Fvars</span> <span class="free">φ</span> <span class="main">=</span> <span class="main">{}</span> <span class="main">⟶</span> <span class="free">prfOf</span> <span class="free">prf</span> <span class="free">φ</span> <span class="main">⟷</span> <span class="free">bprv</span> <span class="main">(</span>PPf <span class="main">(</span><span class="free">encPf</span> <span class="free">prf</span><span class="main">)</span> <span class="main"><span class="free">⟨</span></span><span class="free">φ</span><span class="main"><span class="free">⟩</span></span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> B_consistent_prfOf_iff_PPf<span class="main">[</span><span class="operator">OF</span> dwf_dwfd.consistent_B_consistent<span class="main">]</span> <span class="keyword1"><span class="command">.</span></span>

<span class="keyword2"><span class="keyword">end</span></span> <span class="comment1">― ‹context <span class="antiquoted"><span class="antiquote">@{</span><span class="operator">locale</span> CleanRepr_Proofs<span class="antiquote">}</span></span>›</span>

<span class="comment1">(*&lt;*)</span>
<span class="keyword2"><span class="keyword">end</span></span>
<span class="comment1">(*&gt;*)</span>
</pre>
</div><div id="Diagonalization">
<div class="head">
<h1>Theory Diagonalization</h1>
</div>
<pre class="source"><span class="keyword1"><span class="command">chapter</span></span> <span class="quoted"><span class="plain_text">‹Diagonalization›</span></span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹This theory proves abstract versions of the diagonalization lemma,
with both hard and soft substitution.›</span></span>


<span class="keyword1"><span class="command">section</span></span> <span class="quoted"><span class="plain_text">‹Alternative Diagonalization via Self-Substitution›</span></span>

<span class="comment1">(*&lt;*)</span>
<span class="keyword1"><span class="command">theory</span></span> Diagonalization <span class="keyword2"><span class="keyword">imports</span></span> <a href="Abstract_Representability.html">Abstract_Representability</a>
<span class="keyword2"><span class="keyword">begin</span></span>
<span class="comment1">(*&gt;*)</span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹
Assuming representability of the diagonal instance of the substitution function,
we prove the standard diagonalization lemma. More precisely, we show that it applies
to any logic that
-- embeds intuitionistic first-order logic over numerals
-- has a countable number of formulas
-- has formula self-substitution representable
›</span></span>

<span class="keyword1"><span class="command">context</span></span> Repr_SelfSubst
<span class="keyword2"><span class="keyword">begin</span></span>

<span class="keyword1"><span class="command">theorem</span></span> diagonalization<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> φ<span class="main">[</span><span class="operator">simp</span><span class="main">,</span><span class="operator">intro</span><span class="main"><span class="main">!</span></span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">φ</span> <span class="main">∈</span> <span class="free">fmla</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="free">Fvars</span> <span class="free">φ</span> <span class="main">=</span> <span class="main">{</span>xx<span class="main">}</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span> <span class="bound">ψ</span><span class="main">.</span> <span class="bound">ψ</span> <span class="main">∈</span> <span class="free">fmla</span> <span class="main">∧</span> <span class="free">Fvars</span> <span class="bound">ψ</span> <span class="main">=</span> <span class="main">{}</span> <span class="main">∧</span> <span class="free">bprv</span> <span class="main">(</span>eqv <span class="bound">ψ</span> <span class="main">(</span><span class="free">subst</span> <span class="free">φ</span> <span class="main"><span class="free">⟨</span></span><span class="bound">ψ</span><span class="main"><span class="free">⟩</span></span> xx<span class="main">)</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?phi</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"<span class="main">λ</span> <span class="bound">t</span><span class="main">.</span> <span class="free">subst</span> <span class="free">φ</span> <span class="bound">t</span> xx"</span></span>
  <span class="keyword3"><span class="command">define</span></span> <span class="skolem"><span class="skolem">χ</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">χ</span> <span class="main">≡</span> <span class="free">exi</span> yy <span class="main">(</span><span class="free">cnj</span> <span class="main">(</span><span class="var">?phi</span> <span class="main">(</span><span class="free">Var</span> yy<span class="main">)</span><span class="main">)</span> <span class="main">(</span>SS <span class="main">(</span><span class="free">Var</span> xx<span class="main">)</span> <span class="main">(</span><span class="free">Var</span> yy<span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">have</span></span> χ<span class="main">[</span><span class="operator">simp</span><span class="main">,</span><span class="operator">intro</span><span class="main"><span class="main">!</span></span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">χ</span> <span class="main">∈</span> <span class="free">fmla</span>"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> χ_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?chi</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"<span class="main">λ</span> <span class="bound">t</span><span class="main">.</span> <span class="free">subst</span> <span class="skolem">χ</span> <span class="bound">t</span> xx"</span></span>
  <span class="keyword3"><span class="command">define</span></span> <span class="skolem"><span class="skolem">ψ</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">ψ</span> <span class="main">≡</span> <span class="var">?chi</span> <span class="main"><span class="free">⟨</span></span><span class="skolem">χ</span><span class="main"><span class="free">⟩</span></span>"</span></span>
  <span class="keyword1"><span class="command">have</span></span> ψ<span class="main">[</span><span class="operator">simp</span><span class="main">,</span><span class="operator">intro</span><span class="main"><span class="main">!</span></span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">ψ</span> <span class="main">∈</span> <span class="free">fmla</span>"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> ψ_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">have</span></span> fχ<span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">Fvars</span> <span class="skolem">χ</span> <span class="main">=</span> <span class="main">{</span>xx<span class="main">}</span>"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> χ_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">hence</span></span> Fvars_ψ<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">Fvars</span> <span class="skolem">ψ</span> <span class="main">=</span> <span class="main">{}</span>"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> ψ_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">have</span></span> 1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">bprv</span> <span class="main">(</span>SS <span class="main"><span class="free">⟨</span></span><span class="skolem">χ</span><span class="main"><span class="free">⟩</span></span> <span class="main"><span class="free">⟨</span></span><span class="skolem">ψ</span><span class="main"><span class="free">⟩</span></span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> subst_implies_prv_SS<span class="main">[</span><span class="operator">OF</span> χ<span class="main">]</span> <span class="keyword1"><span class="command">unfolding</span></span> ψ_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">have</span></span> 2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">bprv</span> <span class="main">(</span><span class="free">all</span> yy' <span class="main">(</span>
             <span class="free">imp</span> <span class="main">(</span><span class="free">cnj</span> <span class="main">(</span>SS <span class="main"><span class="free">⟨</span></span><span class="skolem">χ</span><span class="main"><span class="free">⟩</span></span> <span class="main"><span class="free">⟨</span></span><span class="skolem">ψ</span><span class="main"><span class="free">⟩</span></span><span class="main">)</span>
                      <span class="main">(</span>SS <span class="main"><span class="free">⟨</span></span><span class="skolem">χ</span><span class="main"><span class="free">⟩</span></span> <span class="main">(</span><span class="free">Var</span> yy'<span class="main">)</span><span class="main">)</span><span class="main">)</span>
                 <span class="main">(</span><span class="free">eql</span> <span class="main"><span class="free">⟨</span></span><span class="skolem">ψ</span><span class="main"><span class="free">⟩</span></span> <span class="main">(</span><span class="free">Var</span> yy'<span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> Fvars_ψ B.prv_allE<span class="main">[</span><span class="operator">OF</span> _ _ _ SS_unique<span class="main">,</span> <span class="operator">of</span> <span class="quoted"><span class="skolem">χ</span></span> <span class="quoted"><span class="quoted">"<span class="main"><span class="free">⟨</span></span><span class="skolem">ψ</span><span class="main"><span class="free">⟩</span></span>"</span></span><span class="main">]</span>
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">fastforce</span>
  <span class="keyword1"><span class="command">have</span></span> 31<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">bprv</span> <span class="main">(</span><span class="free">all</span> yy'
                     <span class="main">(</span><span class="free">imp</span> <span class="main">(</span>SS <span class="main"><span class="free">⟨</span></span><span class="skolem">χ</span><span class="main"><span class="free">⟩</span></span> <span class="main"><span class="free">⟨</span></span><span class="skolem">ψ</span><span class="main"><span class="free">⟩</span></span><span class="main">)</span>
                          <span class="main">(</span><span class="free">imp</span> <span class="main">(</span>SS <span class="main"><span class="free">⟨</span></span><span class="skolem">χ</span><span class="main"><span class="free">⟩</span></span> <span class="main">(</span><span class="free">Var</span> yy'<span class="main">)</span><span class="main">)</span>
                               <span class="main">(</span><span class="free">eql</span> <span class="main"><span class="free">⟨</span></span><span class="skolem">ψ</span><span class="main"><span class="free">⟩</span></span> <span class="main">(</span><span class="free">Var</span> yy'<span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> B.prv_all_imp_cnj_rev<span class="main">[</span><span class="operator">OF</span> _ _ _ _ 2<span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">have</span></span> 32<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">bprv</span> <span class="main">(</span><span class="free">imp</span> <span class="main">(</span>SS <span class="main"><span class="free">⟨</span></span><span class="skolem">χ</span><span class="main"><span class="free">⟩</span></span> <span class="main"><span class="free">⟨</span></span><span class="skolem">ψ</span><span class="main"><span class="free">⟩</span></span><span class="main">)</span>
                      <span class="main">(</span><span class="free">all</span> yy' <span class="main">(</span><span class="free">imp</span> <span class="main">(</span>SS <span class="main"><span class="free">⟨</span></span><span class="skolem">χ</span><span class="main"><span class="free">⟩</span></span> <span class="main">(</span><span class="free">Var</span> yy'<span class="main">)</span><span class="main">)</span>
                                    <span class="main">(</span><span class="free">eql</span> <span class="main"><span class="free">⟨</span></span><span class="skolem">ψ</span><span class="main"><span class="free">⟩</span></span> <span class="main">(</span><span class="free">Var</span> yy'<span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">intro</span> B.prv_all_imp<span class="main"><span class="main">[</span></span><span class="operator">OF</span> _ _ _ _ 31<span class="main"><span class="main">]</span></span><span class="main">)</span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> SS_def2<span class="main">)</span>
  <span class="keyword1"><span class="command">have</span></span> 33<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">bprv</span> <span class="main">(</span><span class="free">all</span> yy' <span class="main">(</span><span class="free">imp</span> <span class="main">(</span>SS <span class="main"><span class="free">⟨</span></span><span class="skolem">χ</span><span class="main"><span class="free">⟩</span></span> <span class="main">(</span><span class="free">Var</span> yy'<span class="main">)</span><span class="main">)</span>
                               <span class="main">(</span><span class="free">eql</span> <span class="main"><span class="free">⟨</span></span><span class="skolem">ψ</span><span class="main"><span class="free">⟩</span></span> <span class="main">(</span><span class="free">Var</span> yy'<span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> B.prv_imp_mp <span class="main"><span class="main">[</span></span><span class="operator">OF</span> _ _ 32 1<span class="main"><span class="main">]</span></span><span class="main">)</span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">have</span></span> 3<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">bprv</span> <span class="main">(</span><span class="free">all</span> yy <span class="main">(</span><span class="free">imp</span> <span class="main">(</span>SS <span class="main"><span class="free">⟨</span></span><span class="skolem">χ</span><span class="main"><span class="free">⟩</span></span> <span class="main">(</span><span class="free">Var</span> yy<span class="main">)</span><span class="main">)</span>
                             <span class="main">(</span><span class="free">eql</span> <span class="main"><span class="free">⟨</span></span><span class="skolem">ψ</span><span class="main"><span class="free">⟩</span></span> <span class="main">(</span><span class="free">Var</span> yy<span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> B.all_subst_rename_prv<span class="main">[</span><span class="operator">OF</span> _ _ _ _ 33<span class="main">,</span> <span class="operator">of</span> <span class="quoted">yy</span><span class="main">]</span>
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">fastforce</span>
  <span class="keyword1"><span class="command">have</span></span> 41<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">bprv</span> <span class="main">(</span><span class="free">imp</span> <span class="main">(</span><span class="var">?phi</span> <span class="main"><span class="free">⟨</span></span><span class="skolem">ψ</span><span class="main"><span class="free">⟩</span></span><span class="main">)</span>
                      <span class="main">(</span><span class="free">cnj</span> <span class="main">(</span><span class="var">?phi</span> <span class="main"><span class="free">⟨</span></span><span class="skolem">ψ</span><span class="main"><span class="free">⟩</span></span><span class="main">)</span>
                           <span class="main">(</span>SS <span class="main"><span class="free">⟨</span></span><span class="skolem">χ</span><span class="main"><span class="free">⟩</span></span> <span class="main"><span class="free">⟨</span></span><span class="skolem">ψ</span><span class="main"><span class="free">⟩</span></span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">intro</span><span class="main"><span class="main">:</span></span> in_num B.prv_imp_cnj B.prv_imp_refl B.prv_imp_triv<span class="main"><span class="main">[</span></span><span class="operator">OF</span> _ _ 1<span class="main"><span class="main">]</span></span><span class="main">)</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">subst</span> <span class="main">(</span><span class="free">subst</span> <span class="free">φ</span> <span class="main"><span class="free">⟨</span></span><span class="skolem">ψ</span><span class="main"><span class="free">⟩</span></span> xx<span class="main">)</span> <span class="main"><span class="free">⟨</span></span><span class="skolem">ψ</span><span class="main"><span class="free">⟩</span></span> yy <span class="main">=</span> <span class="free">subst</span> <span class="free">φ</span> <span class="main"><span class="free">⟨</span></span><span class="skolem">ψ</span><span class="main"><span class="free">⟩</span></span> xx"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">intro</span> subst_notIn<span class="main">)</span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">subst</span> <span class="main">(</span><span class="free">subst</span> <span class="free">φ</span> <span class="main">(</span><span class="free">Var</span> yy<span class="main">)</span> xx<span class="main">)</span> <span class="main"><span class="free">⟨</span></span><span class="skolem">ψ</span><span class="main"><span class="free">⟩</span></span> yy <span class="main">=</span> <span class="free">subst</span> <span class="free">φ</span> <span class="main"><span class="free">⟨</span></span><span class="skolem">ψ</span><span class="main"><span class="free">⟩</span></span> xx"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">intro</span> subst_subst<span class="main">)</span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">have</span></span> 42<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">bprv</span> <span class="main">(</span><span class="free">exi</span> yy <span class="main">(</span><span class="free">imp</span> <span class="main">(</span><span class="var">?phi</span> <span class="main"><span class="free">⟨</span></span><span class="skolem">ψ</span><span class="main"><span class="free">⟩</span></span><span class="main">)</span>
                              <span class="main">(</span><span class="free">cnj</span> <span class="main">(</span><span class="var">?phi</span> <span class="main">(</span><span class="free">Var</span> yy<span class="main">)</span><span class="main">)</span>
                                   <span class="main">(</span>SS <span class="main"><span class="free">⟨</span></span><span class="skolem">χ</span><span class="main"><span class="free">⟩</span></span> <span class="main">(</span><span class="free">Var</span> yy<span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> 41 <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">intro</span> B.prv_exiI<span class="main"><span class="main">[</span></span><span class="operator">of</span> <span class="main"><span class="main">_</span></span> <span class="main"><span class="main">_</span></span> <span class="quoted"><span class="quoted">"<span class="main"><span class="free">⟨</span></span><span class="skolem">ψ</span><span class="main"><span class="free">⟩</span></span>"</span></span><span class="main"><span class="main">]</span></span><span class="main">)</span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">have</span></span> 4<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">bprv</span> <span class="main">(</span><span class="free">imp</span> <span class="main">(</span><span class="var">?phi</span> <span class="main"><span class="free">⟨</span></span><span class="skolem">ψ</span><span class="main"><span class="free">⟩</span></span><span class="main">)</span> <span class="main">(</span><span class="var">?chi</span> <span class="main"><span class="free">⟨</span></span><span class="skolem">χ</span><span class="main"><span class="free">⟩</span></span><span class="main">)</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> B.prv_imp_exi<span class="main">[</span><span class="operator">OF</span> _ _ _ _ 42<span class="main">,</span><span class="operator">simplified</span><span class="main">]</span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">subst</span> χ_def<span class="main">)</span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> subst_comp_num<span class="main">)</span>
  <span class="keyword1"><span class="command">have</span></span> 50<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">bprv</span> <span class="main">(</span><span class="free">all</span> yy <span class="main">(</span>
          <span class="main">(</span><span class="free">imp</span> <span class="main">(</span><span class="free">eql</span> <span class="main"><span class="free">⟨</span></span><span class="skolem">ψ</span><span class="main"><span class="free">⟩</span></span> <span class="main">(</span><span class="free">Var</span> yy<span class="main">)</span><span class="main">)</span>
               <span class="main">(</span><span class="free">imp</span> <span class="main">(</span><span class="var">?phi</span> <span class="main">(</span><span class="free">Var</span> yy<span class="main">)</span><span class="main">)</span>
                    <span class="main">(</span><span class="var">?phi</span> <span class="main"><span class="free">⟨</span></span><span class="skolem">ψ</span><span class="main"><span class="free">⟩</span></span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> B.prv_all_eql<span class="main">[</span><span class="operator">of</span> <span class="quoted">yy</span> <span class="quoted">xx</span> <span class="quoted"><span class="free">φ</span></span> <span class="quoted"><span class="quoted">"<span class="main"><span class="free">⟨</span></span><span class="skolem">ψ</span><span class="main"><span class="free">⟩</span></span>"</span></span> <span class="quoted"><span class="quoted">"<span class="free">Var</span> yy"</span></span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">have</span></span> 51<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">bprv</span> <span class="main">(</span><span class="free">all</span> yy <span class="main">(</span>
          <span class="main">(</span><span class="free">imp</span> <span class="main">(</span>SS <span class="main"><span class="free">⟨</span></span><span class="skolem">χ</span><span class="main"><span class="free">⟩</span></span> <span class="main">(</span><span class="free">Var</span> yy<span class="main">)</span><span class="main">)</span>
               <span class="main">(</span><span class="free">imp</span> <span class="main">(</span><span class="var">?phi</span> <span class="main">(</span><span class="free">Var</span> yy<span class="main">)</span><span class="main">)</span>
               <span class="main">(</span><span class="var">?phi</span> <span class="main"><span class="free">⟨</span></span><span class="skolem">ψ</span><span class="main"><span class="free">⟩</span></span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> B.prv_all_imp_trans<span class="main">[</span><span class="operator">OF</span> _ _ _ _ 3 50<span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">have</span></span> 52<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">bprv</span> <span class="main">(</span><span class="free">all</span> yy <span class="main">(</span>
          <span class="main">(</span><span class="free">imp</span> <span class="main">(</span><span class="free">cnj</span> <span class="main">(</span><span class="var">?phi</span> <span class="main">(</span><span class="free">Var</span> yy<span class="main">)</span><span class="main">)</span>
                    <span class="main">(</span>SS <span class="main"><span class="free">⟨</span></span><span class="skolem">χ</span><span class="main"><span class="free">⟩</span></span> <span class="main">(</span><span class="free">Var</span> yy<span class="main">)</span><span class="main">)</span><span class="main">)</span>
               <span class="main">(</span><span class="var">?phi</span> <span class="main"><span class="free">⟨</span></span><span class="skolem">ψ</span><span class="main"><span class="free">⟩</span></span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> B.prv_all_imp_cnj<span class="main">[</span><span class="operator">OF</span> _ _ _ _ 51<span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">have</span></span> 5<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">bprv</span> <span class="main">(</span><span class="free">imp</span> <span class="main">(</span><span class="var">?chi</span> <span class="main"><span class="free">⟨</span></span><span class="skolem">χ</span><span class="main"><span class="free">⟩</span></span><span class="main">)</span> <span class="main">(</span><span class="var">?phi</span> <span class="main"><span class="free">⟨</span></span><span class="skolem">ψ</span><span class="main"><span class="free">⟩</span></span><span class="main">)</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> B.prv_exi_imp<span class="main">[</span><span class="operator">OF</span> _ _ _ _ 52<span class="main">,</span><span class="operator">simplified</span><span class="main">]</span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">subst</span> χ_def<span class="main">)</span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> subst_comp_num<span class="main">)</span>
  <span class="keyword1"><span class="command">have</span></span> 6<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">bprv</span> <span class="main">(</span>eqv <span class="main">(</span><span class="var">?chi</span> <span class="main"><span class="free">⟨</span></span><span class="skolem">χ</span><span class="main"><span class="free">⟩</span></span><span class="main">)</span> <span class="main">(</span><span class="var">?phi</span> <span class="main"><span class="free">⟨</span></span><span class="skolem">ψ</span><span class="main"><span class="free">⟩</span></span><span class="main">)</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> B.prv_cnjI<span class="main">[</span><span class="operator">OF</span> _ _ 5 4<span class="main">]</span> <span class="keyword1"><span class="command">unfolding</span></span> eqv_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">have</span></span> 7<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">bprv</span> <span class="main">(</span>eqv <span class="skolem">ψ</span> <span class="main">(</span><span class="var">?phi</span> <span class="main"><span class="free">⟨</span></span><span class="skolem">ψ</span><span class="main"><span class="free">⟩</span></span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> 6 <span class="keyword1"><span class="command">unfolding</span></span> ψ_def <span class="keyword1"><span class="command">.</span></span>
  <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> ψ 7 Fvars_ψ <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹Making this existential into a function.›</span></span>

<span class="keyword1"><span class="command">definition</span></span> <span class="entity">diag</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'fmla</span> <span class="main">⇒</span> <span class="tfree">'fmla</span>"</span></span> <span class="keyword2"><span class="keyword">where</span></span>
  <span class="quoted"><span class="quoted">"<span class="free">diag</span> <span class="free"><span class="bound"><span class="entity">φ</span></span></span> <span class="main">≡</span> <span class="keyword1">SOME</span> <span class="bound">ψ</span><span class="main">.</span> <span class="bound">ψ</span> <span class="main">∈</span> <span class="free">fmla</span> <span class="main">∧</span> <span class="free">Fvars</span> <span class="bound">ψ</span> <span class="main">=</span> <span class="main">{}</span> <span class="main">∧</span> <span class="free">bprv</span> <span class="main">(</span>eqv <span class="bound">ψ</span> <span class="main">(</span><span class="free">subst</span> <span class="free"><span class="bound"><span class="entity">φ</span></span></span> <span class="main"><span class="free">⟨</span></span><span class="bound">ψ</span><span class="main"><span class="free">⟩</span></span> xx<span class="main">)</span><span class="main">)</span>"</span></span>

<span class="keyword1"><span class="command">theorem</span></span> diag_everything<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">φ</span> <span class="main">∈</span> <span class="free">fmla</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">Fvars</span> <span class="free">φ</span> <span class="main">=</span> <span class="main">{</span>xx<span class="main">}</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"diag <span class="free">φ</span> <span class="main">∈</span> <span class="free">fmla</span> <span class="main">∧</span> <span class="free">Fvars</span> <span class="main">(</span>diag <span class="free">φ</span><span class="main">)</span> <span class="main">=</span> <span class="main">{}</span> <span class="main">∧</span> <span class="free">bprv</span> <span class="main">(</span>eqv <span class="main">(</span>diag <span class="free">φ</span><span class="main">)</span> <span class="main">(</span><span class="free">subst</span> <span class="free">φ</span> <span class="main"><span class="free">⟨</span></span>diag <span class="free">φ</span><span class="main"><span class="free">⟩</span></span> xx<span class="main">)</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">unfolding</span></span> diag_def <span class="keyword1"><span class="command">using</span></span> someI_ex<span class="main">[</span><span class="operator">OF</span> diagonalization<span class="main"><span class="main">[</span></span><span class="operator">OF</span> assms<span class="main"><span class="main">]</span></span><span class="main">]</span> <span class="keyword1"><span class="command">.</span></span>

<span class="keyword1"><span class="command">lemmas</span></span> diag<span class="main">[</span><span class="operator">simp</span><span class="main">]</span> <span class="main">=</span> diag_everything<span class="main">[</span><span class="operator">THEN</span> conjunct1<span class="main">]</span>
<span class="keyword1"><span class="command">lemmas</span></span> Fvars_diag<span class="main">[</span><span class="operator">simp</span><span class="main">]</span> <span class="main">=</span> diag_everything<span class="main">[</span><span class="operator">THEN</span> conjunct2<span class="main">,</span> <span class="operator">THEN</span> conjunct1<span class="main">]</span>
<span class="keyword1"><span class="command">lemmas</span></span> bprv_diag_eqv <span class="main">=</span> diag_everything<span class="main">[</span><span class="operator">THEN</span> conjunct2<span class="main">,</span> <span class="operator">THEN</span> conjunct2<span class="main">]</span>

<span class="keyword2"><span class="keyword">end</span></span> <span class="comment1">― ‹context <span class="antiquoted"><span class="antiquote">@{</span><span class="operator">locale</span> Repr_SelfSubst<span class="antiquote">}</span></span>›</span>


<span class="keyword1"><span class="command">section</span></span> <span class="quoted"><span class="plain_text">‹Alternative Diagonalization via Soft Self-Substitution›</span></span>

<span class="keyword1"><span class="command">context</span></span> Repr_SelfSoftSubst
<span class="keyword2"><span class="keyword">begin</span></span>

<span class="keyword1"><span class="command">theorem</span></span> diagonalization<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> φ<span class="main">[</span><span class="operator">simp</span><span class="main">,</span><span class="operator">intro</span><span class="main"><span class="main">!</span></span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">φ</span> <span class="main">∈</span> <span class="free">fmla</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="free">Fvars</span> <span class="free">φ</span> <span class="main">=</span> <span class="main">{</span>xx<span class="main">}</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span> <span class="bound">ψ</span><span class="main">.</span> <span class="bound">ψ</span> <span class="main">∈</span> <span class="free">fmla</span> <span class="main">∧</span> <span class="free">Fvars</span> <span class="bound">ψ</span> <span class="main">=</span> <span class="main">{}</span> <span class="main">∧</span> <span class="free">bprv</span> <span class="main">(</span>eqv <span class="bound">ψ</span> <span class="main">(</span><span class="free">subst</span> <span class="free">φ</span> <span class="main"><span class="free">⟨</span></span><span class="bound">ψ</span><span class="main"><span class="free">⟩</span></span> xx<span class="main">)</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?phi</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"<span class="main">λ</span> <span class="bound">t</span><span class="main">.</span> <span class="free">subst</span> <span class="free">φ</span> <span class="bound">t</span> xx"</span></span>
  <span class="keyword3"><span class="command">define</span></span> <span class="skolem"><span class="skolem">χ</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">χ</span> <span class="main">≡</span> <span class="free">exi</span> yy <span class="main">(</span><span class="free">cnj</span> <span class="main">(</span><span class="var">?phi</span> <span class="main">(</span><span class="free">Var</span> yy<span class="main">)</span><span class="main">)</span> <span class="main">(</span>SS <span class="main">(</span><span class="free">Var</span> xx<span class="main">)</span> <span class="main">(</span><span class="free">Var</span> yy<span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">have</span></span> χ<span class="main">[</span><span class="operator">simp</span><span class="main">,</span><span class="operator">intro</span><span class="main"><span class="main">!</span></span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">χ</span> <span class="main">∈</span> <span class="free">fmla</span>"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> χ_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?chi</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"<span class="main">λ</span> <span class="bound">t</span><span class="main">.</span> softSubst <span class="skolem">χ</span> <span class="bound">t</span> xx"</span></span>
  <span class="keyword3"><span class="command">define</span></span> <span class="skolem"><span class="skolem">ψ</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">ψ</span> <span class="main">≡</span> <span class="var">?chi</span> <span class="main"><span class="free">⟨</span></span><span class="skolem">χ</span><span class="main"><span class="free">⟩</span></span>"</span></span>
  <span class="keyword1"><span class="command">have</span></span> ψ<span class="main">[</span><span class="operator">simp</span><span class="main">,</span><span class="operator">intro</span><span class="main"><span class="main">!</span></span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">ψ</span> <span class="main">∈</span> <span class="free">fmla</span>"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> ψ_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">have</span></span> fχ<span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">Fvars</span> <span class="skolem">χ</span> <span class="main">=</span> <span class="main">{</span>xx<span class="main">}</span>"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> χ_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">hence</span></span> Fvars_ψ<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">Fvars</span> <span class="skolem">ψ</span> <span class="main">=</span> <span class="main">{}</span>"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> ψ_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">have</span></span> 1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">bprv</span> <span class="main">(</span>SS <span class="main"><span class="free">⟨</span></span><span class="skolem">χ</span><span class="main"><span class="free">⟩</span></span> <span class="main"><span class="free">⟨</span></span><span class="skolem">ψ</span><span class="main"><span class="free">⟩</span></span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> softSubst_implies_prv_SS<span class="main">[</span><span class="operator">OF</span> χ<span class="main">]</span> <span class="keyword1"><span class="command">unfolding</span></span> ψ_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">have</span></span> 2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">bprv</span> <span class="main">(</span><span class="free">all</span> yy' <span class="main">(</span>
             <span class="free">imp</span> <span class="main">(</span><span class="free">cnj</span> <span class="main">(</span>SS <span class="main"><span class="free">⟨</span></span><span class="skolem">χ</span><span class="main"><span class="free">⟩</span></span> <span class="main"><span class="free">⟨</span></span><span class="skolem">ψ</span><span class="main"><span class="free">⟩</span></span><span class="main">)</span>
                      <span class="main">(</span>SS <span class="main"><span class="free">⟨</span></span><span class="skolem">χ</span><span class="main"><span class="free">⟩</span></span> <span class="main">(</span><span class="free">Var</span> yy'<span class="main">)</span><span class="main">)</span><span class="main">)</span>
                 <span class="main">(</span><span class="free">eql</span> <span class="main"><span class="free">⟨</span></span><span class="skolem">ψ</span><span class="main"><span class="free">⟩</span></span> <span class="main">(</span><span class="free">Var</span> yy'<span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> Fvars_ψ B.prv_allE<span class="main">[</span><span class="operator">OF</span> _ _ _ SS_unique<span class="main">,</span> <span class="operator">of</span> <span class="quoted"><span class="skolem">χ</span></span> <span class="quoted"><span class="quoted">"<span class="main"><span class="free">⟨</span></span><span class="skolem">ψ</span><span class="main"><span class="free">⟩</span></span>"</span></span><span class="main">]</span>
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">fastforce</span>
  <span class="keyword1"><span class="command">have</span></span> 31<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">bprv</span> <span class="main">(</span><span class="free">all</span> yy'
                     <span class="main">(</span><span class="free">imp</span> <span class="main">(</span>SS <span class="main"><span class="free">⟨</span></span><span class="skolem">χ</span><span class="main"><span class="free">⟩</span></span> <span class="main"><span class="free">⟨</span></span><span class="skolem">ψ</span><span class="main"><span class="free">⟩</span></span><span class="main">)</span>
                          <span class="main">(</span><span class="free">imp</span> <span class="main">(</span>SS <span class="main"><span class="free">⟨</span></span><span class="skolem">χ</span><span class="main"><span class="free">⟩</span></span> <span class="main">(</span><span class="free">Var</span> yy'<span class="main">)</span><span class="main">)</span>
                               <span class="main">(</span><span class="free">eql</span> <span class="main"><span class="free">⟨</span></span><span class="skolem">ψ</span><span class="main"><span class="free">⟩</span></span> <span class="main">(</span><span class="free">Var</span> yy'<span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> B.prv_all_imp_cnj_rev<span class="main">[</span><span class="operator">OF</span> _ _ _ _ 2<span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">have</span></span> 32<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">bprv</span> <span class="main">(</span><span class="free">imp</span> <span class="main">(</span>SS <span class="main"><span class="free">⟨</span></span><span class="skolem">χ</span><span class="main"><span class="free">⟩</span></span> <span class="main"><span class="free">⟨</span></span><span class="skolem">ψ</span><span class="main"><span class="free">⟩</span></span><span class="main">)</span>
                     <span class="main">(</span><span class="free">all</span> yy' <span class="main">(</span><span class="free">imp</span> <span class="main">(</span>SS <span class="main"><span class="free">⟨</span></span><span class="skolem">χ</span><span class="main"><span class="free">⟩</span></span> <span class="main">(</span><span class="free">Var</span> yy'<span class="main">)</span><span class="main">)</span>
                                   <span class="main">(</span><span class="free">eql</span> <span class="main"><span class="free">⟨</span></span><span class="skolem">ψ</span><span class="main"><span class="free">⟩</span></span> <span class="main">(</span><span class="free">Var</span> yy'<span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">intro</span> B.prv_all_imp<span class="main"><span class="main">[</span></span><span class="operator">OF</span> _ _ _ _ 31<span class="main"><span class="main">]</span></span><span class="main">)</span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> SS_def2<span class="main">)</span>
  <span class="keyword1"><span class="command">have</span></span> 33<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">bprv</span> <span class="main">(</span><span class="free">all</span> yy' <span class="main">(</span><span class="free">imp</span> <span class="main">(</span>SS <span class="main"><span class="free">⟨</span></span><span class="skolem">χ</span><span class="main"><span class="free">⟩</span></span> <span class="main">(</span><span class="free">Var</span> yy'<span class="main">)</span><span class="main">)</span>
                              <span class="main">(</span><span class="free">eql</span> <span class="main"><span class="free">⟨</span></span><span class="skolem">ψ</span><span class="main"><span class="free">⟩</span></span> <span class="main">(</span><span class="free">Var</span> yy'<span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> B.prv_imp_mp <span class="main"><span class="main">[</span></span><span class="operator">OF</span> _ _ 32 1<span class="main"><span class="main">]</span></span><span class="main">)</span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">have</span></span> 3<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">bprv</span> <span class="main">(</span><span class="free">all</span> yy <span class="main">(</span><span class="free">imp</span> <span class="main">(</span>SS <span class="main"><span class="free">⟨</span></span><span class="skolem">χ</span><span class="main"><span class="free">⟩</span></span> <span class="main">(</span><span class="free">Var</span> yy<span class="main">)</span><span class="main">)</span>
                            <span class="main">(</span><span class="free">eql</span> <span class="main"><span class="free">⟨</span></span><span class="skolem">ψ</span><span class="main"><span class="free">⟩</span></span> <span class="main">(</span><span class="free">Var</span> yy<span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> B.all_subst_rename_prv<span class="main">[</span><span class="operator">OF</span> _ _ _ _ 33<span class="main">,</span> <span class="operator">of</span> <span class="quoted">yy</span><span class="main">]</span>
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">fastforce</span>
  <span class="keyword1"><span class="command">have</span></span> 41<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">bprv</span> <span class="main">(</span><span class="free">imp</span> <span class="main">(</span><span class="var">?phi</span> <span class="main"><span class="free">⟨</span></span><span class="skolem">ψ</span><span class="main"><span class="free">⟩</span></span><span class="main">)</span>
                     <span class="main">(</span><span class="free">cnj</span> <span class="main">(</span><span class="var">?phi</span> <span class="main"><span class="free">⟨</span></span><span class="skolem">ψ</span><span class="main"><span class="free">⟩</span></span><span class="main">)</span>
                          <span class="main">(</span>SS <span class="main"><span class="free">⟨</span></span><span class="skolem">χ</span><span class="main"><span class="free">⟩</span></span> <span class="main"><span class="free">⟨</span></span><span class="skolem">ψ</span><span class="main"><span class="free">⟩</span></span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">intro</span><span class="main"><span class="main">:</span></span> in_num B.prv_imp_cnj B.prv_imp_refl B.prv_imp_triv<span class="main"><span class="main">[</span></span><span class="operator">OF</span> _ _ 1<span class="main"><span class="main">]</span></span><span class="main">)</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">subst</span> <span class="main">(</span><span class="free">subst</span> <span class="free">φ</span> <span class="main"><span class="free">⟨</span></span><span class="skolem">ψ</span><span class="main"><span class="free">⟩</span></span> xx<span class="main">)</span> <span class="main"><span class="free">⟨</span></span><span class="skolem">ψ</span><span class="main"><span class="free">⟩</span></span> yy <span class="main">=</span> <span class="free">subst</span> <span class="free">φ</span> <span class="main"><span class="free">⟨</span></span><span class="skolem">ψ</span><span class="main"><span class="free">⟩</span></span> xx"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">intro</span> subst_notIn<span class="main">)</span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">subst</span> <span class="main">(</span><span class="free">subst</span> <span class="free">φ</span> <span class="main">(</span><span class="free">Var</span> yy<span class="main">)</span> xx<span class="main">)</span> <span class="main"><span class="free">⟨</span></span><span class="skolem">ψ</span><span class="main"><span class="free">⟩</span></span> yy <span class="main">=</span> <span class="free">subst</span> <span class="free">φ</span> <span class="main"><span class="free">⟨</span></span><span class="skolem">ψ</span><span class="main"><span class="free">⟩</span></span> xx"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">intro</span> subst_subst<span class="main">)</span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">have</span></span> 42<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">bprv</span> <span class="main">(</span><span class="free">exi</span> yy <span class="main">(</span><span class="free">imp</span> <span class="main">(</span><span class="var">?phi</span> <span class="main"><span class="free">⟨</span></span><span class="skolem">ψ</span><span class="main"><span class="free">⟩</span></span><span class="main">)</span>
                             <span class="main">(</span><span class="free">cnj</span> <span class="main">(</span><span class="var">?phi</span> <span class="main">(</span><span class="free">Var</span> yy<span class="main">)</span><span class="main">)</span>
                                  <span class="main">(</span>SS <span class="main"><span class="free">⟨</span></span><span class="skolem">χ</span><span class="main"><span class="free">⟩</span></span> <span class="main">(</span><span class="free">Var</span> yy<span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> 41 <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">intro</span> B.prv_exiI<span class="main"><span class="main">[</span></span><span class="operator">of</span> <span class="main"><span class="main">_</span></span> <span class="main"><span class="main">_</span></span> <span class="quoted"><span class="quoted">"<span class="main"><span class="free">⟨</span></span><span class="skolem">ψ</span><span class="main"><span class="free">⟩</span></span>"</span></span><span class="main"><span class="main">]</span></span><span class="main">)</span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">have</span></span> 4<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">bprv</span> <span class="main">(</span><span class="free">imp</span> <span class="main">(</span><span class="var">?phi</span> <span class="main"><span class="free">⟨</span></span><span class="skolem">ψ</span><span class="main"><span class="free">⟩</span></span><span class="main">)</span> <span class="main">(</span><span class="free">subst</span> <span class="skolem">χ</span> <span class="main"><span class="free">⟨</span></span><span class="skolem">χ</span><span class="main"><span class="free">⟩</span></span> xx<span class="main">)</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> B.prv_imp_exi<span class="main">[</span><span class="operator">OF</span> _ _ _ _ 42<span class="main">,</span><span class="operator">simplified</span><span class="main">]</span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">subst</span> χ_def<span class="main">)</span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> subst_comp_num<span class="main">)</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">bprv</span> <span class="main">(</span><span class="free">imp</span> <span class="main">(</span><span class="free">subst</span> <span class="skolem">χ</span> <span class="main"><span class="free">⟨</span></span><span class="skolem">χ</span><span class="main"><span class="free">⟩</span></span> xx<span class="main">)</span> <span class="main">(</span><span class="var">?chi</span> <span class="main"><span class="free">⟨</span></span><span class="skolem">χ</span><span class="main"><span class="free">⟩</span></span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> B.prv_subst_imp_softSubst<span class="main">)</span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> 4<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">bprv</span> <span class="main">(</span><span class="free">imp</span> <span class="main">(</span><span class="var">?phi</span> <span class="main"><span class="free">⟨</span></span><span class="skolem">ψ</span><span class="main"><span class="free">⟩</span></span><span class="main">)</span> <span class="main">(</span><span class="var">?chi</span> <span class="main"><span class="free">⟨</span></span><span class="skolem">χ</span><span class="main"><span class="free">⟩</span></span><span class="main">)</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> B.prv_prv_imp_trans<span class="main"><span class="main">[</span></span><span class="operator">rotated</span> -2<span class="main"><span class="main">]</span></span><span class="main">)</span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">have</span></span> 50<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">bprv</span> <span class="main">(</span><span class="free">all</span> yy <span class="main">(</span>
          <span class="main">(</span><span class="free">imp</span> <span class="main">(</span><span class="free">eql</span> <span class="main"><span class="free">⟨</span></span><span class="skolem">ψ</span><span class="main"><span class="free">⟩</span></span> <span class="main">(</span><span class="free">Var</span> yy<span class="main">)</span><span class="main">)</span>
               <span class="main">(</span><span class="free">imp</span> <span class="main">(</span><span class="var">?phi</span> <span class="main">(</span><span class="free">Var</span> yy<span class="main">)</span><span class="main">)</span>
                    <span class="main">(</span><span class="var">?phi</span> <span class="main"><span class="free">⟨</span></span><span class="skolem">ψ</span><span class="main"><span class="free">⟩</span></span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> B.prv_all_eql<span class="main">[</span><span class="operator">of</span> <span class="quoted">yy</span> <span class="quoted">xx</span> <span class="quoted"><span class="free">φ</span></span> <span class="quoted"><span class="quoted">"<span class="main"><span class="free">⟨</span></span><span class="skolem">ψ</span><span class="main"><span class="free">⟩</span></span>"</span></span> <span class="quoted"><span class="quoted">"<span class="free">Var</span> yy"</span></span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">have</span></span> 51<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">bprv</span> <span class="main">(</span><span class="free">all</span> yy <span class="main">(</span>
          <span class="main">(</span><span class="free">imp</span> <span class="main">(</span>SS <span class="main"><span class="free">⟨</span></span><span class="skolem">χ</span><span class="main"><span class="free">⟩</span></span> <span class="main">(</span><span class="free">Var</span> yy<span class="main">)</span><span class="main">)</span>
               <span class="main">(</span><span class="free">imp</span> <span class="main">(</span><span class="var">?phi</span> <span class="main">(</span><span class="free">Var</span> yy<span class="main">)</span><span class="main">)</span>
               <span class="main">(</span><span class="var">?phi</span> <span class="main"><span class="free">⟨</span></span><span class="skolem">ψ</span><span class="main"><span class="free">⟩</span></span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> B.prv_all_imp_trans<span class="main">[</span><span class="operator">OF</span> _ _ _ _ 3 50<span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">have</span></span> 52<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">bprv</span> <span class="main">(</span><span class="free">all</span> yy <span class="main">(</span>
          <span class="main">(</span><span class="free">imp</span> <span class="main">(</span><span class="free">cnj</span> <span class="main">(</span><span class="var">?phi</span> <span class="main">(</span><span class="free">Var</span> yy<span class="main">)</span><span class="main">)</span>
                    <span class="main">(</span>SS <span class="main"><span class="free">⟨</span></span><span class="skolem">χ</span><span class="main"><span class="free">⟩</span></span> <span class="main">(</span><span class="free">Var</span> yy<span class="main">)</span><span class="main">)</span><span class="main">)</span>
               <span class="main">(</span><span class="var">?phi</span> <span class="main"><span class="free">⟨</span></span><span class="skolem">ψ</span><span class="main"><span class="free">⟩</span></span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> B.prv_all_imp_cnj<span class="main">[</span><span class="operator">OF</span> _ _ _ _ 51<span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">bprv</span> <span class="main">(</span><span class="free">imp</span> <span class="main">(</span><span class="var">?chi</span> <span class="main"><span class="free">⟨</span></span><span class="skolem">χ</span><span class="main"><span class="free">⟩</span></span><span class="main">)</span> <span class="main">(</span><span class="free">subst</span> <span class="skolem">χ</span> <span class="main"><span class="free">⟨</span></span><span class="skolem">χ</span><span class="main"><span class="free">⟩</span></span> xx<span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> B.prv_softSubst_imp_subst<span class="main">)</span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">bprv</span> <span class="main">(</span><span class="free">imp</span> <span class="main">(</span><span class="free">subst</span> <span class="skolem">χ</span> <span class="main"><span class="free">⟨</span></span><span class="skolem">χ</span><span class="main"><span class="free">⟩</span></span> xx<span class="main">)</span> <span class="main">(</span><span class="var">?phi</span> <span class="main"><span class="free">⟨</span></span><span class="skolem">ψ</span><span class="main"><span class="free">⟩</span></span><span class="main">)</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> B.prv_exi_imp<span class="main">[</span><span class="operator">OF</span> _ _ _ _ 52<span class="main">,</span><span class="operator">simplified</span><span class="main">]</span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">subst</span> χ_def<span class="main">)</span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> subst_comp_num<span class="main">)</span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> 5<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">bprv</span> <span class="main">(</span><span class="free">imp</span> <span class="main">(</span><span class="var">?chi</span> <span class="main"><span class="free">⟨</span></span><span class="skolem">χ</span><span class="main"><span class="free">⟩</span></span><span class="main">)</span> <span class="main">(</span><span class="var">?phi</span> <span class="main"><span class="free">⟨</span></span><span class="skolem">ψ</span><span class="main"><span class="free">⟩</span></span><span class="main">)</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> B.prv_prv_imp_trans<span class="main"><span class="main">[</span></span><span class="operator">rotated</span> -2<span class="main"><span class="main">]</span></span><span class="main">)</span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">have</span></span> 6<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">bprv</span> <span class="main">(</span>eqv <span class="main">(</span><span class="var">?chi</span> <span class="main"><span class="free">⟨</span></span><span class="skolem">χ</span><span class="main"><span class="free">⟩</span></span><span class="main">)</span> <span class="main">(</span><span class="var">?phi</span> <span class="main"><span class="free">⟨</span></span><span class="skolem">ψ</span><span class="main"><span class="free">⟩</span></span><span class="main">)</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> B.prv_cnjI<span class="main">[</span><span class="operator">OF</span> _ _ 5 4<span class="main">]</span> <span class="keyword1"><span class="command">unfolding</span></span> eqv_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">have</span></span> 7<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">bprv</span> <span class="main">(</span>eqv <span class="skolem">ψ</span> <span class="main">(</span><span class="var">?phi</span> <span class="main"><span class="free">⟨</span></span><span class="skolem">ψ</span><span class="main"><span class="free">⟩</span></span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> 6 <span class="keyword1"><span class="command">unfolding</span></span> ψ_def <span class="keyword1"><span class="command">.</span></span>
  <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> ψ 7 Fvars_ψ <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹Making this existential into a function.›</span></span>

<span class="keyword1"><span class="command">definition</span></span> <span class="entity">diag</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'fmla</span> <span class="main">⇒</span> <span class="tfree">'fmla</span>"</span></span> <span class="keyword2"><span class="keyword">where</span></span>
  <span class="quoted"><span class="quoted">"<span class="free">diag</span> <span class="free"><span class="bound"><span class="entity">φ</span></span></span> <span class="main">≡</span> <span class="keyword1">SOME</span> <span class="bound">ψ</span><span class="main">.</span> <span class="bound">ψ</span> <span class="main">∈</span> <span class="free">fmla</span> <span class="main">∧</span> <span class="free">Fvars</span> <span class="bound">ψ</span> <span class="main">=</span> <span class="main">{}</span> <span class="main">∧</span> <span class="free">bprv</span> <span class="main">(</span>eqv <span class="bound">ψ</span> <span class="main">(</span><span class="free">subst</span> <span class="free"><span class="bound"><span class="entity">φ</span></span></span> <span class="main"><span class="free">⟨</span></span><span class="bound">ψ</span><span class="main"><span class="free">⟩</span></span> xx<span class="main">)</span><span class="main">)</span>"</span></span>

<span class="keyword1"><span class="command">theorem</span></span> diag_everything<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">φ</span> <span class="main">∈</span> <span class="free">fmla</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">Fvars</span> <span class="free">φ</span> <span class="main">=</span> <span class="main">{</span>xx<span class="main">}</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"diag <span class="free">φ</span> <span class="main">∈</span> <span class="free">fmla</span> <span class="main">∧</span> <span class="free">Fvars</span> <span class="main">(</span>diag <span class="free">φ</span><span class="main">)</span> <span class="main">=</span> <span class="main">{}</span> <span class="main">∧</span> <span class="free">bprv</span> <span class="main">(</span>eqv <span class="main">(</span>diag <span class="free">φ</span><span class="main">)</span> <span class="main">(</span><span class="free">subst</span> <span class="free">φ</span> <span class="main"><span class="free">⟨</span></span>diag <span class="free">φ</span><span class="main"><span class="free">⟩</span></span> xx<span class="main">)</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">unfolding</span></span> diag_def <span class="keyword1"><span class="command">using</span></span> someI_ex<span class="main">[</span><span class="operator">OF</span> diagonalization<span class="main"><span class="main">[</span></span><span class="operator">OF</span> assms<span class="main"><span class="main">]</span></span><span class="main">]</span> <span class="keyword1"><span class="command">.</span></span>

<span class="keyword1"><span class="command">lemmas</span></span> diag<span class="main">[</span><span class="operator">simp</span><span class="main">]</span> <span class="main">=</span> diag_everything<span class="main">[</span><span class="operator">THEN</span> conjunct1<span class="main">]</span>
<span class="keyword1"><span class="command">lemmas</span></span> Fvars_diag<span class="main">[</span><span class="operator">simp</span><span class="main">]</span> <span class="main">=</span> diag_everything<span class="main">[</span><span class="operator">THEN</span> conjunct2<span class="main">,</span> <span class="operator">THEN</span> conjunct1<span class="main">]</span>
<span class="keyword1"><span class="command">lemmas</span></span> prv_diag_eqv <span class="main">=</span> diag_everything<span class="main">[</span><span class="operator">THEN</span> conjunct2<span class="main">,</span> <span class="operator">THEN</span> conjunct2<span class="main">]</span>

<span class="keyword2"><span class="keyword">end</span></span> <span class="comment1">― ‹context <span class="antiquoted"><span class="antiquote">@{</span><span class="operator">locale</span> Repr_SelfSoftSubst<span class="antiquote">}</span></span>›</span>

<span class="comment1">(*&lt;*)</span>
<span class="keyword2"><span class="keyword">end</span></span>
<span class="comment1">(*&gt;*)</span>
</pre>
</div><div id="Derivability_Conditions">
<div class="head">
<h1>Theory Derivability_Conditions</h1>
</div>
<pre class="source"><span class="keyword1"><span class="command">chapter</span></span> <span class="quoted"><span class="plain_text">‹The Hilbert-Bernays-Löb (HBL) Derivability Conditions›</span></span>

<span class="comment1">(*&lt;*)</span>
<span class="keyword1"><span class="command">theory</span></span> Derivability_Conditions <span class="keyword2"><span class="keyword">imports</span></span> <a href="Abstract_Representability.html">Abstract_Representability</a>
<span class="keyword2"><span class="keyword">begin</span></span>
<span class="comment1">(*&gt;*)</span>

<span class="keyword1"><span class="command">section</span></span> <span class="quoted"><span class="plain_text">‹First Derivability Condition›</span></span>

<span class="comment1">(* Assume the provability predicate is "very-weakly" representable,
in that one implication of the weak representability condition holds.   *)</span>
<span class="keyword1"><span class="command">locale</span></span> HBL1 <span class="main">=</span>
Encode
  <span class="quoted"><span class="free">var</span></span> <span class="quoted"><span class="free">trm</span></span> <span class="quoted"><span class="free">fmla</span></span> <span class="quoted"><span class="free">Var</span></span> <span class="quoted"><span class="free">FvarsT</span></span> <span class="quoted"><span class="free">substT</span></span> <span class="quoted"><span class="free">Fvars</span></span> <span class="quoted"><span class="free">subst</span></span>
  <span class="quoted"><span class="free">num</span></span>
  <span class="quoted"><span class="free">enc</span></span>
<span class="main">+</span>
Deduct2
  <span class="quoted"><span class="free">var</span></span> <span class="quoted"><span class="free">trm</span></span> <span class="quoted"><span class="free">fmla</span></span> <span class="quoted"><span class="free">Var</span></span> <span class="quoted"><span class="free">FvarsT</span></span> <span class="quoted"><span class="free">substT</span></span> <span class="quoted"><span class="free">Fvars</span></span> <span class="quoted"><span class="free">subst</span></span>
  <span class="quoted"><span class="free">num</span></span>
  <span class="quoted"><span class="free">eql</span></span> <span class="quoted"><span class="free">cnj</span></span> <span class="quoted"><span class="free">imp</span></span> <span class="quoted"><span class="free">all</span></span> <span class="quoted"><span class="free">exi</span></span>
  <span class="quoted"><span class="free">prv</span></span> <span class="quoted"><span class="free">bprv</span></span>
<span class="keyword2"><span class="keyword">for</span></span>
<span class="free">var</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'var</span> set"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="free">trm</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'trm</span> set"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="free">fmla</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'fmla</span> set"</span></span>
<span class="keyword2"><span class="keyword">and</span></span> <span class="free">Var</span> <span class="free">FvarsT</span> <span class="free">substT</span> <span class="free">Fvars</span> <span class="free">subst</span>
<span class="keyword2"><span class="keyword">and</span></span> <span class="free">num</span>
<span class="keyword2"><span class="keyword">and</span></span> <span class="free">eql</span> <span class="free">cnj</span> <span class="free">imp</span> <span class="free">all</span> <span class="free">exi</span>
<span class="keyword2"><span class="keyword">and</span></span> <span class="free">prv</span> <span class="free">bprv</span>
<span class="keyword2"><span class="keyword">and</span></span> <span class="free">enc</span> <span class="main">(</span><span class="quoted">"<span class="keyword1">⟨</span>_<span class="keyword1">⟩</span>"</span><span class="main">)</span>
<span class="main">+</span>
<span class="comment1">(* Very-weak represenatbility of provability, as a one-variable formula P, usually called the provability predicate: *)</span>
<span class="keyword2"><span class="keyword">fixes</span></span> <span class="free">P</span> <span class="main">::</span> <span class="tfree"><span class="quoted"><span class="tfree">'fmla</span></span></span>
<span class="keyword2"><span class="keyword">assumes</span></span>
P<span class="main">[</span><span class="operator">intro</span><span class="main"><span class="main">!</span></span><span class="main">,</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">P</span> <span class="main">∈</span> <span class="free">fmla</span>"</span></span>
<span class="keyword2"><span class="keyword">and</span></span>
Fvars_P<span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">Fvars</span> <span class="free">P</span> <span class="main">=</span> <span class="main">{</span>xx<span class="main">}</span>"</span></span>
<span class="keyword2"><span class="keyword">and</span></span>
HBL1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">⋀</span><span class="bound">φ</span><span class="main">.</span> <span class="bound">φ</span> <span class="main">∈</span> <span class="free">fmla</span> <span class="main">⟹</span> <span class="free">Fvars</span> <span class="bound">φ</span> <span class="main">=</span> <span class="main">{}</span> <span class="main">⟹</span> <span class="free">prv</span> <span class="bound">φ</span> <span class="main">⟹</span> <span class="free">bprv</span> <span class="main">(</span><span class="free">subst</span> <span class="free">P</span> <span class="main"><span class="free">⟨</span></span><span class="bound">φ</span><span class="main"><span class="free">⟩</span></span> xx<span class="main">)</span>"</span></span>
<span class="keyword2"><span class="keyword">begin</span></span>

<span class="comment1">(* For all our (very-weak) representability assumptions, in addition to
 the representing formulas,
here, P, we define a corresponding instantiation combinator, here the
predicate PP.
If we think of P as P(xx), then PP t is the instance PP(t)  *)</span>
<span class="keyword1"><span class="command">definition</span></span> <span class="entity">PP</span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="free">PP</span> <span class="main">≡</span> <span class="main">λ</span><span class="bound">t</span><span class="main">.</span> <span class="free">subst</span> <span class="free">P</span> <span class="bound">t</span> xx"</span></span>

<span class="keyword1"><span class="command">lemma</span></span> PP<span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">⋀</span><span class="bound">t</span><span class="main">.</span> <span class="bound">t</span> <span class="main">∈</span> <span class="free">trm</span> <span class="main">⟹</span> PP <span class="bound">t</span> <span class="main">∈</span> <span class="free">fmla</span>"</span></span>
  <span class="keyword1"><span class="command">unfolding</span></span> PP_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">lemma</span></span> Fvars_PP<span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">⋀</span><span class="bound">t</span><span class="main">.</span> <span class="bound">t</span> <span class="main">∈</span> <span class="free">trm</span> <span class="main">⟹</span> <span class="free">Fvars</span> <span class="main">(</span>PP <span class="bound">t</span><span class="main">)</span> <span class="main">=</span> <span class="free">FvarsT</span> <span class="bound">t</span>"</span></span>
  <span class="keyword1"><span class="command">unfolding</span></span> PP_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span>
<span class="quoted"><span class="quoted">"<span class="free">n</span> <span class="main">∈</span> <span class="free">num</span> <span class="main">⟹</span> <span class="free">subst</span> <span class="main">(</span>PP <span class="main">(</span><span class="free">Var</span> yy<span class="main">)</span><span class="main">)</span> <span class="free">n</span> yy <span class="main">=</span> PP <span class="free">n</span>"</span></span>
<span class="quoted"><span class="quoted">"<span class="free">n</span> <span class="main">∈</span> <span class="free">num</span> <span class="main">⟹</span> <span class="free">subst</span> <span class="main">(</span>PP <span class="main">(</span><span class="free">Var</span> xx<span class="main">)</span><span class="main">)</span> <span class="free">n</span> xx <span class="main">=</span> PP <span class="free">n</span>"</span></span>
  <span class="keyword1"><span class="command">unfolding</span></span> PP_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">lemma</span></span> HBL1_PP<span class="main">:</span>
<span class="quoted"><span class="quoted">"<span class="free">φ</span> <span class="main">∈</span> <span class="free">fmla</span> <span class="main">⟹</span> <span class="free">Fvars</span> <span class="free">φ</span> <span class="main">=</span> <span class="main">{}</span> <span class="main">⟹</span> <span class="free">prv</span> <span class="free">φ</span> <span class="main">⟹</span> <span class="free">bprv</span> <span class="main">(</span>PP <span class="main"><span class="free">⟨</span></span><span class="free">φ</span><span class="main"><span class="free">⟩</span></span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> HBL1 <span class="keyword1"><span class="command">unfolding</span></span> PP_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword2"><span class="keyword">end</span></span> <span class="comment1">― ‹context <span class="antiquoted"><span class="antiquote">@{</span><span class="operator">locale</span> HBL1<span class="antiquote">}</span></span>›</span>


<span class="keyword1"><span class="command">section</span></span> <span class="quoted"><span class="plain_text">‹Connections between Proof Representability,
First Derivability Condition, and Its Converse›</span></span>

<span class="keyword1"><span class="command">context</span></span> CleanRepr_Proofs
<span class="keyword2"><span class="keyword">begin</span></span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹Defining <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">term</span></span> <span class="quoted"><span class="free"><span class="quoted"><span class="free">P</span></span></span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span>, the internal notion of provability,
from <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">term</span></span> <span class="quoted"><span class="free"><span class="quoted"><span class="free">Pf</span></span></span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span> (in its predicate form <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">term</span></span> <span class="quoted"><span class="quoted">PPf</span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span>), the internal notion of "proof-of".
NB: In the technical sense of the term "represents", we have that
<span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">term</span></span> <span class="quoted"><span class="free"><span class="quoted"><span class="free">Pf</span></span></span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span> represents <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">term</span></span> <span class="quoted"><span class="free"><span class="quoted"><span class="free">pprv</span></span></span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span>, whereas <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">term</span></span> <span class="quoted"><span class="free"><span class="quoted"><span class="free">P</span></span></span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span> will not represent <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">term</span></span> <span class="quoted"><span class="free"><span class="quoted"><span class="free">prv</span></span></span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span>, but satisfy a weaker
condition (weaker than weak representability), namely HBL1.›</span></span>

<span class="keyword1"><span class="command">subsection</span></span> <span class="quoted"><span class="plain_text">‹HBL1 from "proof-of" representability›</span></span>

<span class="keyword1"><span class="command">definition</span></span> <span class="entity">P</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'fmla</span>"</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="free">P</span> <span class="main">≡</span> <span class="free">exi</span> yy <span class="main">(</span>PPf <span class="main">(</span><span class="free">Var</span> yy<span class="main">)</span> <span class="main">(</span><span class="free">Var</span> xx<span class="main">)</span><span class="main">)</span>"</span></span>

<span class="keyword1"><span class="command">lemma</span></span> P<span class="main">[</span><span class="operator">simp</span><span class="main">,</span><span class="operator">intro</span><span class="main"><span class="main"><span class="main">!</span></span></span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"P <span class="main">∈</span> <span class="free">fmla</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> Fvars_P<span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">Fvars</span> P <span class="main">=</span> <span class="main">{</span>xx<span class="main">}</span>"</span></span>
  <span class="keyword1"><span class="command">unfolding</span></span> P_def <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> PPf_def2<span class="main">)</span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹We infer HBL1 from Pf representing prv:›</span></span>
<span class="keyword1"><span class="command">lemma</span></span> HBL1<span class="main">:</span>
<span class="keyword2"><span class="keyword">assumes</span></span> φ<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">φ</span> <span class="main">∈</span> <span class="free">fmla</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="free">Fvars</span> <span class="free">φ</span> <span class="main">=</span> <span class="main">{}</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> pφ<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">prv</span> <span class="free">φ</span>"</span></span>
<span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">bprv</span> <span class="main">(</span><span class="free">subst</span> P <span class="main"><span class="free">⟨</span></span><span class="free">φ</span><span class="main"><span class="free">⟩</span></span> xx<span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
  <span class="keyword3"><span class="command">obtain</span></span> <span class="quoted">"<span class="skolem"><span class="skolem">prf</span></span>"</span> <span class="keyword2"><span class="keyword">where</span></span> pf<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">prf</span> <span class="main">∈</span> <span class="free">proof</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">prfOf</span> <span class="skolem">prf</span> <span class="free">φ</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> prv_prfOf assms <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">hence</span></span> 0<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">bprv</span> <span class="main">(</span>PPf <span class="main">(</span><span class="free">encPf</span> <span class="skolem">prf</span><span class="main">)</span> <span class="main">(</span><span class="free">enc</span> <span class="free">φ</span><span class="main">)</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> prfOf_PPf φ <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">have</span></span> 1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">subst</span> <span class="main">(</span><span class="free">subst</span> <span class="free">Pf</span> <span class="main">(</span><span class="free">encPf</span> <span class="skolem">prf</span><span class="main">)</span> yy<span class="main">)</span> <span class="main"><span class="free">⟨</span></span><span class="free">φ</span><span class="main"><span class="free">⟩</span></span> xx <span class="main">=</span> <span class="free">subst</span> <span class="main">(</span><span class="free">subst</span> <span class="free">Pf</span> <span class="main"><span class="free">⟨</span></span><span class="free">φ</span><span class="main"><span class="free">⟩</span></span> xx<span class="main">)</span> <span class="main">(</span><span class="free">substT</span> <span class="main">(</span><span class="free">encPf</span> <span class="skolem">prf</span><span class="main">)</span> <span class="main"><span class="free">⟨</span></span><span class="free">φ</span><span class="main"><span class="free">⟩</span></span> xx<span class="main">)</span> yy"</span></span>
     <span class="keyword1"><span class="command">using</span></span> assms pf <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">intro</span> subst_compose_diff<span class="main">)</span> <span class="operator">auto</span>
  <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> 0 <span class="keyword1"><span class="command">unfolding</span></span> P_def <span class="keyword1"><span class="command">using</span></span> assms
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> PPf_def2 1 pf <span class="quasi_keyword">intro</span><span class="main"><span class="main">!</span></span><span class="main"><span class="main">:</span></span> B.prv_exiI<span class="main"><span class="main">[</span></span><span class="operator">of</span> <span class="main"><span class="main">_</span></span> <span class="main"><span class="main">_</span></span> <span class="quoted"><span class="quoted">"<span class="free">encPf</span> <span class="skolem">prf</span>"</span></span><span class="main"><span class="main">]</span></span><span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹This is used in several places, including for the hard half of
Gödel's First and the truth of Gödel formulas (and also for the Rosser variants
of these).›</span></span>
<span class="keyword1"><span class="command">lemma</span></span> not_prv_prv_neg_PPf<span class="main">:</span>
<span class="keyword2"><span class="keyword">assumes</span></span> <span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">φ</span> <span class="main">∈</span> <span class="free">fmla</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="free">Fvars</span> <span class="free">φ</span> <span class="main">=</span> <span class="main">{}</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> p<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> <span class="free">prv</span> <span class="free">φ</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> n<span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">n</span> <span class="main">∈</span> <span class="free">num</span>"</span></span>
<span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">bprv</span> <span class="main">(</span>neg <span class="main">(</span>PPf <span class="free">n</span> <span class="main"><span class="free">⟨</span></span><span class="free">φ</span><span class="main"><span class="free">⟩</span></span><span class="main">)</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">prf</span><span class="main">∈</span><span class="free">proof</span><span class="main">.</span> <span class="main">¬</span> <span class="free">prfOf</span> <span class="bound">prf</span> <span class="free">φ</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> prv_prfOf p <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">prf</span><span class="main">∈</span><span class="free">proof</span><span class="main">.</span> <span class="free">bprv</span> <span class="main">(</span>neg <span class="main">(</span>PPf <span class="main">(</span><span class="free">encPf</span> <span class="bound">prf</span><span class="main">)</span> <span class="main"><span class="free">⟨</span></span><span class="free">φ</span><span class="main"><span class="free">⟩</span></span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> not_prfOf_PPf <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> not_prfOf_PPf <span class="keyword1"><span class="command">using</span></span> Clean_PPf_encPf <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">cases</span> <span class="quoted"><span class="quoted">"<span class="free">n</span> <span class="main">∈</span> <span class="free">encPf</span> <span class="main">`</span> <span class="free">proof</span>"</span></span><span class="main">)</span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">lemma</span></span> consistent_not_prv_not_prv_PPf<span class="main">:</span>
<span class="keyword2"><span class="keyword">assumes</span></span> c<span class="main">:</span> <span class="quoted">consistent</span>
<span class="keyword2"><span class="keyword">and</span></span> 0<span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">φ</span> <span class="main">∈</span> <span class="free">fmla</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="free">Fvars</span> <span class="free">φ</span> <span class="main">=</span> <span class="main">{}</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> <span class="free">prv</span> <span class="free">φ</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="free">n</span> <span class="main">∈</span> <span class="free">num</span>"</span></span>
<span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> <span class="free">bprv</span> <span class="main">(</span>PPf <span class="free">n</span> <span class="main"><span class="free">⟨</span></span><span class="free">φ</span><span class="main"><span class="free">⟩</span></span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> not_prv_prv_neg_PPf<span class="main">[</span><span class="operator">OF</span> 0<span class="main">]</span> c<span class="main">[</span><span class="operator">THEN</span> dwf_dwfd.consistent_B_consistent<span class="main">]</span> <span class="keyword1"><span class="command">unfolding</span></span> B.consistent_def3 <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword2"><span class="keyword">end</span></span> <span class="comment1">― ‹context <span class="antiquoted"><span class="antiquote">@{</span><span class="operator">locale</span> CleanRepr_Proofs<span class="antiquote">}</span></span>›</span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹The inference of HBL1 from "proof-of" representability, in locale form:›</span></span>
<span class="keyword1"><span class="command">sublocale</span></span> CleanRepr_Proofs <span class="main">&lt;</span> wrepr<span class="main">:</span> HBL1
  <span class="keyword2"><span class="keyword">where</span></span> P <span class="main">=</span> <span class="quoted">P</span>
  <span class="keyword1"><span class="command">using</span></span> HBL1 <span class="keyword1"><span class="command">by</span></span> <span class="operator">unfold_locales</span> <span class="operator">auto</span>


<span class="keyword1"><span class="command">subsection</span></span> <span class="quoted"><span class="plain_text">‹Sufficient condition for the converse of HBL1›</span></span>

<span class="keyword1"><span class="command">context</span></span> CleanRepr_Proofs
<span class="keyword2"><span class="keyword">begin</span></span>

<span class="keyword1"><span class="command">lemma</span></span> PP_PPf<span class="main">:</span>
<span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">φ</span> <span class="main">∈</span> <span class="free">fmla</span>"</span></span>
<span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"wrepr.PP <span class="main"><span class="free">⟨</span></span><span class="free">φ</span><span class="main"><span class="free">⟩</span></span> <span class="main">=</span> <span class="free">exi</span> yy <span class="main">(</span>PPf <span class="main">(</span><span class="free">Var</span> yy<span class="main">)</span> <span class="main"><span class="free">⟨</span></span><span class="free">φ</span><span class="main"><span class="free">⟩</span></span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">unfolding</span></span> wrepr.PP_def <span class="keyword1"><span class="command">using</span></span> assms
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> PPf_def2 P_def<span class="main">)</span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹The converse of HLB1 condition follows from (the standard notion of)
$\omega$-consistency for <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">term</span></span> <span class="quoted"><span class="free"><span class="quoted"><span class="free">bprv</span></span></span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span> and strong representability of proofs:›</span></span>
<span class="keyword1"><span class="command">lemma</span></span> ωconsistentStd1_HBL1_rev<span class="main">:</span>
<span class="keyword2"><span class="keyword">assumes</span></span> oc<span class="main">:</span> <span class="quoted"><span class="quoted">"B.ωconsistentStd1"</span></span>
<span class="keyword2"><span class="keyword">and</span></span> φ<span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">φ</span> <span class="main">∈</span> <span class="free">fmla</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="free">Fvars</span> <span class="free">φ</span> <span class="main">=</span> <span class="main">{}</span>"</span></span>
<span class="keyword2"><span class="keyword">and</span></span> iPP<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">bprv</span> <span class="main">(</span>wrepr.PP <span class="main"><span class="free">⟨</span></span><span class="free">φ</span><span class="main"><span class="free">⟩</span></span><span class="main">)</span>"</span></span>
<span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">prv</span> <span class="free">φ</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> 0<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">bprv</span> <span class="main">(</span><span class="free">exi</span> yy <span class="main">(</span>PPf <span class="main">(</span><span class="free">Var</span> yy<span class="main">)</span> <span class="main"><span class="free">⟨</span></span><span class="free">φ</span><span class="main"><span class="free">⟩</span></span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> iPP <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> PP_PPf<span class="main">)</span>
  <span class="keyword1"><span class="command">{</span></span><span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> <span class="free">prv</span> <span class="free">φ</span>"</span></span>
   <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">n</span> <span class="main">∈</span> <span class="free">num</span><span class="main">.</span> <span class="free">bprv</span> <span class="main">(</span>neg <span class="main">(</span>PPf <span class="bound">n</span> <span class="main"><span class="free">⟨</span></span><span class="free">φ</span><span class="main"><span class="free">⟩</span></span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> not_prv_prv_neg_PPf <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
   <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> <span class="free">bprv</span> <span class="main">(</span><span class="free">exi</span> yy <span class="main">(</span>PPf <span class="main">(</span><span class="free">Var</span> yy<span class="main">)</span> <span class="main"><span class="free">⟨</span></span><span class="free">φ</span><span class="main"><span class="free">⟩</span></span><span class="main">)</span><span class="main">)</span>"</span></span>
   <span class="keyword1"><span class="command">using</span></span> oc <span class="keyword1"><span class="command">unfolding</span></span> B.ωconsistentStd1_def <span class="keyword1"><span class="command">using</span></span> φ <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
   <span class="keyword1"><span class="command">hence</span></span> <span class="quoted">False</span> <span class="keyword1"><span class="command">using</span></span> 0 <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">}</span></span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword2"><span class="keyword">end</span></span> <span class="comment1">― ‹context <span class="antiquoted"><span class="antiquote">@{</span><span class="operator">locale</span> CleanRepr_Proofs<span class="antiquote">}</span></span>›</span>


<span class="keyword1"><span class="command">section</span></span> <span class="quoted"><span class="plain_text">‹Second and Third Derivability Conditions›</span></span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹These are only needed for Gödel's Second.›</span></span>

<span class="keyword1"><span class="command">locale</span></span> HBL1_2_3 <span class="main">=</span>
HBL1
  <span class="quoted"><span class="free">var</span></span> <span class="quoted"><span class="free">trm</span></span> <span class="quoted"><span class="free">fmla</span></span> <span class="quoted"><span class="free">Var</span></span> <span class="quoted"><span class="free">FvarsT</span></span> <span class="quoted"><span class="free">substT</span></span> <span class="quoted"><span class="free">Fvars</span></span> <span class="quoted"><span class="free">subst</span></span>
  <span class="quoted"><span class="free">num</span></span>
  <span class="quoted"><span class="free">eql</span></span> <span class="quoted"><span class="free">cnj</span></span> <span class="quoted"><span class="free">imp</span></span> <span class="quoted"><span class="free">all</span></span> <span class="quoted"><span class="free">exi</span></span>
  <span class="quoted"><span class="free">prv</span></span> <span class="quoted"><span class="free">bprv</span></span>
  <span class="quoted"><span class="free">enc</span></span>
  <span class="quoted"><span class="free">P</span></span>
<span class="keyword2"><span class="keyword">for</span></span>
<span class="free">var</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'var</span> set"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="free">trm</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'trm</span> set"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="free">fmla</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'fmla</span> set"</span></span>
<span class="keyword2"><span class="keyword">and</span></span> <span class="free">Var</span> <span class="free">FvarsT</span> <span class="free">substT</span> <span class="free">Fvars</span> <span class="free">subst</span>
<span class="keyword2"><span class="keyword">and</span></span> <span class="free">num</span>
<span class="keyword2"><span class="keyword">and</span></span> <span class="free">eql</span> <span class="free">cnj</span> <span class="free">imp</span> <span class="free">all</span> <span class="free">exi</span>
<span class="keyword2"><span class="keyword">and</span></span> <span class="free">prv</span> <span class="free">bprv</span>
<span class="keyword2"><span class="keyword">and</span></span> <span class="free">enc</span> <span class="main">(</span><span class="quoted">"<span class="keyword1">⟨</span>_<span class="keyword1">⟩</span>"</span><span class="main">)</span>
<span class="keyword2"><span class="keyword">and</span></span> <span class="free">P</span>
<span class="main">+</span>
<span class="keyword2"><span class="keyword">assumes</span></span>
HBL2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">⋀</span><span class="bound">φ</span> <span class="bound">χ</span><span class="main">.</span> <span class="bound">φ</span> <span class="main">∈</span> <span class="free">fmla</span> <span class="main">⟹</span> <span class="bound">χ</span> <span class="main">∈</span> <span class="free">fmla</span> <span class="main">⟹</span> <span class="free">Fvars</span> <span class="bound">φ</span> <span class="main">=</span> <span class="main">{}</span> <span class="main">⟹</span> <span class="free">Fvars</span> <span class="bound">χ</span> <span class="main">=</span> <span class="main">{}</span> <span class="main">⟹</span>
  <span class="free">bprv</span> <span class="main">(</span><span class="free">imp</span> <span class="main">(</span><span class="free">cnj</span> <span class="main">(</span>PP <span class="main"><span class="free">⟨</span></span><span class="bound">φ</span><span class="main"><span class="free">⟩</span></span><span class="main">)</span> <span class="main">(</span>PP <span class="main"><span class="free">⟨</span></span><span class="free">imp</span> <span class="bound">φ</span> <span class="bound">χ</span><span class="main"><span class="free">⟩</span></span><span class="main">)</span><span class="main">)</span>
           <span class="main">(</span>PP <span class="main"><span class="free">⟨</span></span><span class="bound">χ</span><span class="main"><span class="free">⟩</span></span><span class="main">)</span><span class="main">)</span>"</span></span>
<span class="keyword2"><span class="keyword">and</span></span>
HBL3<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">⋀</span><span class="bound">φ</span><span class="main">.</span> <span class="bound">φ</span> <span class="main">∈</span> <span class="free">fmla</span> <span class="main">⟹</span> <span class="free">Fvars</span> <span class="bound">φ</span> <span class="main">=</span> <span class="main">{}</span> <span class="main">⟹</span> <span class="free">bprv</span> <span class="main">(</span><span class="free">imp</span> <span class="main">(</span>PP <span class="main"><span class="free">⟨</span></span><span class="bound">φ</span><span class="main"><span class="free">⟩</span></span><span class="main">)</span> <span class="main">(</span>PP <span class="main"><span class="free">⟨</span></span>PP <span class="main"><span class="free">⟨</span></span><span class="bound">φ</span><span class="main"><span class="free">⟩</span></span><span class="main"><span class="free">⟩</span></span><span class="main">)</span><span class="main">)</span>"</span></span>
<span class="keyword2"><span class="keyword">begin</span></span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹The implicational form of HBL2:›</span></span>
<span class="keyword1"><span class="command">lemma</span></span> HBL2_imp<span class="main">:</span>
 <span class="quoted"><span class="quoted">"<span class="main">⋀</span><span class="bound">φ</span> <span class="bound">χ</span><span class="main">.</span> <span class="bound">φ</span> <span class="main">∈</span> <span class="free">fmla</span> <span class="main">⟹</span> <span class="bound">χ</span> <span class="main">∈</span> <span class="free">fmla</span> <span class="main">⟹</span> <span class="free">Fvars</span> <span class="bound">φ</span> <span class="main">=</span> <span class="main">{}</span> <span class="main">⟹</span> <span class="free">Fvars</span> <span class="bound">χ</span> <span class="main">=</span> <span class="main">{}</span> <span class="main">⟹</span>
  <span class="free">bprv</span> <span class="main">(</span><span class="free">imp</span> <span class="main">(</span>PP <span class="main"><span class="free">⟨</span></span><span class="free">imp</span> <span class="bound">φ</span> <span class="bound">χ</span><span class="main"><span class="free">⟩</span></span><span class="main">)</span> <span class="main">(</span><span class="free">imp</span> <span class="main">(</span>PP <span class="main"><span class="free">⟨</span></span><span class="bound">φ</span><span class="main"><span class="free">⟩</span></span><span class="main">)</span> <span class="main">(</span>PP <span class="main"><span class="free">⟨</span></span><span class="bound">χ</span><span class="main"><span class="free">⟩</span></span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">using</span></span> HBL2 <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> B.prv_cnj_imp B.prv_imp_com<span class="main">)</span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹... and its weaker, "detached" version:›</span></span>
<span class="keyword1"><span class="command">lemma</span></span> HBL2_imp2<span class="main">:</span>
<span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">φ</span> <span class="main">∈</span> <span class="free">fmla</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">χ</span> <span class="main">∈</span> <span class="free">fmla</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="free">Fvars</span> <span class="free">φ</span> <span class="main">=</span> <span class="main">{}</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="free">Fvars</span> <span class="free">χ</span> <span class="main">=</span> <span class="main">{}</span>"</span></span>
<span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">bprv</span> <span class="main">(</span>PP <span class="main"><span class="free">⟨</span></span><span class="free">imp</span> <span class="free">φ</span> <span class="free">χ</span><span class="main"><span class="free">⟩</span></span><span class="main">)</span>"</span></span>
<span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">bprv</span> <span class="main">(</span><span class="free">imp</span> <span class="main">(</span>PP <span class="main"><span class="free">⟨</span></span><span class="free">φ</span><span class="main"><span class="free">⟩</span></span><span class="main">)</span> <span class="main">(</span>PP <span class="main"><span class="free">⟨</span></span><span class="free">χ</span><span class="main"><span class="free">⟩</span></span><span class="main">)</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">meson</span> HBL2_imp PP enc imp num B.prv_imp_mp subsetCE<span class="main">)</span>

<span class="keyword2"><span class="keyword">end</span></span> <span class="comment1">― ‹context <span class="antiquoted"><span class="antiquote">@{</span><span class="operator">locale</span> HBL1_2_3<span class="antiquote">}</span></span>›</span>

<span class="comment1">(*&lt;*)</span>
<span class="keyword2"><span class="keyword">end</span></span>
<span class="comment1">(*&gt;*)</span>


</pre>
</div><div id="Goedel_Formula">
<div class="head">
<h1>Theory Goedel_Formula</h1>
</div>
<pre class="source"><span class="keyword1"><span class="command">chapter</span></span> <span class="quoted"><span class="plain_text">‹Gödel Formulas›</span></span>

<span class="comment1">(*&lt;*)</span>
<span class="keyword1"><span class="command">theory</span></span> Goedel_Formula <span class="keyword2"><span class="keyword">imports</span></span> <a href="Diagonalization.html">Diagonalization</a> <a href="Derivability_Conditions.html">Derivability_Conditions</a>
<span class="keyword2"><span class="keyword">begin</span></span>
<span class="comment1">(*&gt;*)</span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹Gödel formulas are defined by diagonalizing the negation of the provability predicate.›</span></span>

<span class="keyword1"><span class="command">locale</span></span> Goedel_Form <span class="main">=</span>
<span class="comment1">― ‹Assuming the <span class="antiquoted"><span class="antiquote">@{</span><span class="operator">term</span> <span class="quoted"><span class="free">fls</span></span><span class="antiquote">}</span></span> (False) connective gives us negation:›</span>
Deduct2_with_False
  <span class="quoted"><span class="free">var</span></span> <span class="quoted"><span class="free">trm</span></span> <span class="quoted"><span class="free">fmla</span></span> <span class="quoted"><span class="free">Var</span></span> <span class="quoted"><span class="free">FvarsT</span></span> <span class="quoted"><span class="free">substT</span></span> <span class="quoted"><span class="free">Fvars</span></span> <span class="quoted"><span class="free">subst</span></span>
  <span class="quoted"><span class="free">eql</span></span> <span class="quoted"><span class="free">cnj</span></span> <span class="quoted"><span class="free">imp</span></span> <span class="quoted"><span class="free">all</span></span> <span class="quoted"><span class="free">exi</span></span>
  <span class="quoted"><span class="free">fls</span></span>
  <span class="quoted"><span class="free">num</span></span>
  <span class="quoted"><span class="free">prv</span></span> <span class="quoted"><span class="free">bprv</span></span>
<span class="main">+</span>
Repr_SelfSubst
  <span class="quoted"><span class="free">var</span></span> <span class="quoted"><span class="free">trm</span></span> <span class="quoted"><span class="free">fmla</span></span> <span class="quoted"><span class="free">Var</span></span> <span class="quoted"><span class="free">FvarsT</span></span> <span class="quoted"><span class="free">substT</span></span> <span class="quoted"><span class="free">Fvars</span></span> <span class="quoted"><span class="free">subst</span></span>
  <span class="quoted"><span class="free">num</span></span>
  <span class="quoted"><span class="free">eql</span></span> <span class="quoted"><span class="free">cnj</span></span> <span class="quoted"><span class="free">imp</span></span> <span class="quoted"><span class="free">all</span></span> <span class="quoted"><span class="free">exi</span></span>
  <span class="quoted"><span class="free">prv</span></span> <span class="quoted"><span class="free">bprv</span></span>
  <span class="quoted"><span class="free">enc</span></span>
  <span class="quoted"><span class="free">S</span></span>
<span class="main">+</span>
HBL1
  <span class="quoted"><span class="free">var</span></span> <span class="quoted"><span class="free">trm</span></span> <span class="quoted"><span class="free">fmla</span></span> <span class="quoted"><span class="free">Var</span></span> <span class="quoted"><span class="free">FvarsT</span></span> <span class="quoted"><span class="free">substT</span></span> <span class="quoted"><span class="free">Fvars</span></span> <span class="quoted"><span class="free">subst</span></span>
  <span class="quoted"><span class="free">num</span></span>
  <span class="quoted"><span class="free">eql</span></span> <span class="quoted"><span class="free">cnj</span></span> <span class="quoted"><span class="free">imp</span></span> <span class="quoted"><span class="free">all</span></span> <span class="quoted"><span class="free">exi</span></span>
  <span class="quoted"><span class="free">prv</span></span> <span class="quoted"><span class="free">bprv</span></span>
  <span class="quoted"><span class="free">enc</span></span>
  <span class="quoted"><span class="free">P</span></span>
<span class="keyword2"><span class="keyword">for</span></span>
<span class="free">var</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'var</span> set"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="free">trm</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'trm</span> set"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="free">fmla</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'fmla</span> set"</span></span>
<span class="keyword2"><span class="keyword">and</span></span> <span class="free">Var</span> <span class="free">num</span> <span class="free">FvarsT</span> <span class="free">substT</span> <span class="free">Fvars</span> <span class="free">subst</span>
<span class="keyword2"><span class="keyword">and</span></span> <span class="free">eql</span> <span class="free">cnj</span> <span class="free">imp</span> <span class="free">all</span> <span class="free">exi</span>
<span class="keyword2"><span class="keyword">and</span></span> <span class="free">fls</span>
<span class="keyword2"><span class="keyword">and</span></span> <span class="free">prv</span> <span class="free">bprv</span>
<span class="keyword2"><span class="keyword">and</span></span> <span class="free">enc</span> <span class="main">(</span><span class="quoted">"<span class="keyword1">⟨</span>_<span class="keyword1">⟩</span>"</span><span class="main">)</span>
<span class="keyword2"><span class="keyword">and</span></span> <span class="free">S</span>
<span class="keyword2"><span class="keyword">and</span></span> <span class="free">P</span>
<span class="keyword2"><span class="keyword">begin</span></span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹The Gödel formula.
NB, we speak of "the" Gödel formula because the diagonalization function makes a choice.›</span></span>
<span class="keyword1"><span class="command">definition</span></span> <span class="entity">φG</span> <span class="main">::</span> <span class="tfree"><span class="quoted"><span class="tfree">'fmla</span></span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="free">φG</span> <span class="main">≡</span> diag <span class="main">(</span>neg <span class="free">P</span><span class="main">)</span>"</span></span>

<span class="keyword1"><span class="command">lemma</span></span> φG<span class="main">[</span><span class="operator">simp</span><span class="main">,</span><span class="operator">intro</span><span class="main"><span class="main"><span class="main">!</span></span></span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"φG <span class="main">∈</span> <span class="free">fmla</span>"</span></span>
<span class="keyword2"><span class="keyword">and</span></span>
Fvars_φG<span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">Fvars</span> φG <span class="main">=</span> <span class="main">{}</span>"</span></span>
  <span class="keyword1"><span class="command">unfolding</span></span> φG_def PP_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">lemma</span></span> bprv_φG_eqv<span class="main">:</span>
<span class="quoted"><span class="quoted">"<span class="free">bprv</span> <span class="main">(</span>eqv φG <span class="main">(</span>neg <span class="main">(</span>PP <span class="main"><span class="free">⟨</span></span>φG<span class="main"><span class="free">⟩</span></span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">unfolding</span></span> φG_def PP_def <span class="keyword1"><span class="command">using</span></span> bprv_diag_eqv<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="quoted">"neg <span class="free">P</span>"</span></span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>

<span class="keyword1"><span class="command">lemma</span></span> prv_φG_eqv<span class="main">:</span>
<span class="quoted"><span class="quoted">"<span class="free">prv</span> <span class="main">(</span>eqv φG <span class="main">(</span>neg <span class="main">(</span>PP <span class="main"><span class="free">⟨</span></span>φG<span class="main"><span class="free">⟩</span></span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> bprv_prv<span class="main">[</span><span class="operator">OF</span> _ _ bprv_φG_eqv<span class="main">,</span> <span class="operator">simplified</span><span class="main">]</span> <span class="keyword1"><span class="command">.</span></span>

<span class="keyword2"><span class="keyword">end</span></span> <span class="comment1">― ‹context <span class="antiquoted"><span class="antiquote">@{</span><span class="operator">locale</span> Goedel_Form<span class="antiquote">}</span></span>›</span>


<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹Adding cleanly representable proofs to the assumptions
behind Gödel formulas:›</span></span>

<span class="keyword1"><span class="command">locale</span></span> Goedel_Form_Proofs <span class="main">=</span>
Repr_SelfSubst
  <span class="quoted"><span class="free">var</span></span> <span class="quoted"><span class="free">trm</span></span> <span class="quoted"><span class="free">fmla</span></span> <span class="quoted"><span class="free">Var</span></span> <span class="quoted"><span class="free">FvarsT</span></span> <span class="quoted"><span class="free">substT</span></span> <span class="quoted"><span class="free">Fvars</span></span> <span class="quoted"><span class="free">subst</span></span>
  <span class="quoted"><span class="free">num</span></span>
  <span class="quoted"><span class="free">eql</span></span> <span class="quoted"><span class="free">cnj</span></span> <span class="quoted"><span class="free">imp</span></span> <span class="quoted"><span class="free">all</span></span> <span class="quoted"><span class="free">exi</span></span>
  <span class="quoted"><span class="free">prv</span></span> <span class="quoted"><span class="free">bprv</span></span>
  <span class="quoted"><span class="free">enc</span></span>
  <span class="quoted"><span class="free">S</span></span>
<span class="main">+</span>
CleanRepr_Proofs
  <span class="quoted"><span class="free">var</span></span> <span class="quoted"><span class="free">trm</span></span> <span class="quoted"><span class="free">fmla</span></span> <span class="quoted"><span class="free">Var</span></span> <span class="quoted"><span class="free">FvarsT</span></span> <span class="quoted"><span class="free">substT</span></span> <span class="quoted"><span class="free">Fvars</span></span> <span class="quoted"><span class="free">subst</span></span>
  <span class="quoted"><span class="free">num</span></span>
  <span class="quoted"><span class="free">eql</span></span> <span class="quoted"><span class="free">cnj</span></span> <span class="quoted"><span class="free">imp</span></span> <span class="quoted"><span class="free">all</span></span> <span class="quoted"><span class="free">exi</span></span>
  <span class="quoted"><span class="free">prv</span></span> <span class="quoted"><span class="free">bprv</span></span>
  <span class="quoted"><span class="free">enc</span></span>
  <span class="quoted"><span class="free">fls</span></span>
  <span class="quoted"><span class="free">dsj</span></span>
  <span class="quoted"><span class="quoted">"<span class="free">proof</span>"</span></span> <span class="quoted"><span class="free">prfOf</span></span>
  <span class="quoted"><span class="free">encPf</span></span>
  <span class="quoted"><span class="free">Pf</span></span>
<span class="keyword2"><span class="keyword">for</span></span>
<span class="free">var</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'var</span> set"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="free">trm</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'trm</span> set"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="free">fmla</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'fmla</span> set"</span></span>
<span class="keyword2"><span class="keyword">and</span></span> <span class="free">Var</span> <span class="free">FvarsT</span> <span class="free">substT</span> <span class="free">Fvars</span> <span class="free">subst</span> <span class="free">num</span>
<span class="keyword2"><span class="keyword">and</span></span> <span class="free">eql</span> <span class="free">cnj</span> <span class="free">imp</span> <span class="free">all</span> <span class="free">exi</span>
<span class="keyword2"><span class="keyword">and</span></span> <span class="free">fls</span>
<span class="keyword2"><span class="keyword">and</span></span> <span class="free">prv</span> <span class="free">bprv</span>
<span class="keyword2"><span class="keyword">and</span></span> <span class="free">enc</span> <span class="main">(</span><span class="quoted">"<span class="keyword1">⟨</span>_<span class="keyword1">⟩</span>"</span><span class="main">)</span>
<span class="keyword2"><span class="keyword">and</span></span> <span class="free">S</span>
<span class="keyword2"><span class="keyword">and</span></span> <span class="free">dsj</span>
<span class="keyword2"><span class="keyword">and</span></span> <span class="quoted">"<span class="free">proof</span>"</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'proof</span> set"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="free">prfOf</span> <span class="free">encPf</span>
<span class="keyword2"><span class="keyword">and</span></span> <span class="free">Pf</span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹... and extending the sublocale relationship <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">locale</span></span> CleanRepr_Proofs<span class="antiquote"><span class="antiquote">}</span></span></span></span> &lt; <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">locale</span></span> HBL1<span class="antiquote"><span class="antiquote">}</span></span></span></span>:›</span></span>
<span class="keyword1"><span class="command">sublocale</span></span> Goedel_Form_Proofs <span class="main">&lt;</span> Goedel_Form <span class="keyword2"><span class="keyword">where</span></span> P <span class="main">=</span> <span class="quoted">P</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">standard</span>


<span class="keyword1"><span class="command">context</span></span> Goedel_Form_Proofs
<span class="keyword2"><span class="keyword">begin</span></span>

<span class="keyword1"><span class="command">lemma</span></span> bprv_φG_eqv_not_exi_PPf<span class="main">:</span>
<span class="quoted"><span class="quoted">"<span class="free">bprv</span> <span class="main">(</span>eqv φG <span class="main">(</span>neg <span class="main">(</span><span class="free">exi</span> yy <span class="main">(</span>PPf <span class="main">(</span><span class="free">Var</span> yy<span class="main">)</span> <span class="main"><span class="free">⟨</span></span>φG<span class="main"><span class="free">⟩</span></span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> P<span class="main">:</span> <span class="quoted"><span class="quoted">"P <span class="main">=</span> <span class="free">exi</span> yy <span class="free">Pf</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> P_def <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> PPf_def2<span class="main">)</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="free">subst</span> P <span class="main"><span class="free">⟨</span></span>φG<span class="main"><span class="free">⟩</span></span> xx <span class="main">=</span> <span class="free">subst</span> <span class="main">(</span><span class="free">exi</span> yy <span class="free">Pf</span><span class="main">)</span> <span class="main"><span class="free">⟨</span></span>φG<span class="main"><span class="free">⟩</span></span> xx"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="free">subst</span> P <span class="main"><span class="free">⟨</span></span>φG<span class="main"><span class="free">⟩</span></span> xx <span class="main">=</span> <span class="free">exi</span> yy <span class="main">(</span><span class="free">subst</span> <span class="free">Pf</span> <span class="main"><span class="free">⟨</span></span>φG<span class="main"><span class="free">⟩</span></span> xx<span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> bprv_φG_eqv <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> wrepr.PP_def PPf_def2<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">lemma</span></span> prv_φG_eqv_not_exi_PPf<span class="main">:</span>
<span class="quoted"><span class="quoted">"<span class="free">prv</span> <span class="main">(</span>eqv φG <span class="main">(</span>neg <span class="main">(</span><span class="free">exi</span> yy <span class="main">(</span>PPf <span class="main">(</span><span class="free">Var</span> yy<span class="main">)</span> <span class="main"><span class="free">⟨</span></span>φG<span class="main"><span class="free">⟩</span></span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">using</span></span> bprv_prv<span class="main">[</span><span class="operator">OF</span> _ _ bprv_φG_eqv_not_exi_PPf<span class="main">,</span> <span class="operator">simplified</span><span class="main">]</span> <span class="keyword1"><span class="command">.</span></span>

<span class="keyword1"><span class="command">lemma</span></span> bprv_φG_eqv_all_not_PPf<span class="main">:</span>
<span class="quoted"><span class="quoted">"<span class="free">bprv</span> <span class="main">(</span>eqv φG <span class="main">(</span><span class="free">all</span> yy <span class="main">(</span>neg <span class="main">(</span>PPf <span class="main">(</span><span class="free">Var</span> yy<span class="main">)</span> <span class="main"><span class="free">⟨</span></span>φG<span class="main"><span class="free">⟩</span></span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> B.prv_eqv_trans<span class="main"><span class="main">[</span></span><span class="operator">OF</span> _ _ _ bprv_φG_eqv_not_exi_PPf B.prv_neg_exi_eqv_all_neg<span class="main"><span class="main">]</span></span><span class="main">)</span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">lemma</span></span> prv_φG_eqv_all_not_PPf<span class="main">:</span>
<span class="quoted"><span class="quoted">"<span class="free">prv</span> <span class="main">(</span>eqv φG <span class="main">(</span><span class="free">all</span> yy <span class="main">(</span>neg <span class="main">(</span>PPf <span class="main">(</span><span class="free">Var</span> yy<span class="main">)</span> <span class="main"><span class="free">⟨</span></span>φG<span class="main"><span class="free">⟩</span></span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">using</span></span> bprv_prv<span class="main">[</span><span class="operator">OF</span> _ _ bprv_φG_eqv_all_not_PPf<span class="main">,</span> <span class="operator">simplified</span><span class="main">]</span> <span class="keyword1"><span class="command">.</span></span>

<span class="keyword1"><span class="command">lemma</span></span> bprv_eqv_all_not_PPf_imp_φG<span class="main">:</span>
<span class="quoted"><span class="quoted">"<span class="free">bprv</span> <span class="main">(</span><span class="free">imp</span> <span class="main">(</span><span class="free">all</span> yy <span class="main">(</span>neg <span class="main">(</span>PPf <span class="main">(</span><span class="free">Var</span> yy<span class="main">)</span> <span class="main"><span class="free">⟨</span></span>φG<span class="main"><span class="free">⟩</span></span><span class="main">)</span><span class="main">)</span><span class="main">)</span> φG<span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> bprv_φG_eqv_all_not_PPf <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">intro</span><span class="main"><span class="main">:</span></span> B.prv_imp_eqvER<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> prv_eqv_all_not_PPf_imp_φG<span class="main">:</span>
<span class="quoted"><span class="quoted">"<span class="free">prv</span> <span class="main">(</span><span class="free">imp</span> <span class="main">(</span><span class="free">all</span> yy <span class="main">(</span>neg <span class="main">(</span>PPf <span class="main">(</span><span class="free">Var</span> yy<span class="main">)</span> <span class="main"><span class="free">⟨</span></span>φG<span class="main"><span class="free">⟩</span></span><span class="main">)</span><span class="main">)</span><span class="main">)</span> φG<span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">using</span></span> bprv_prv<span class="main">[</span><span class="operator">OF</span> _ _ bprv_eqv_all_not_PPf_imp_φG<span class="main">,</span> <span class="operator">simplified</span><span class="main">]</span> <span class="keyword1"><span class="command">.</span></span>


<span class="keyword2"><span class="keyword">end</span></span> <span class="comment1">― ‹context <span class="antiquoted"><span class="antiquote">@{</span><span class="operator">locale</span> Goedel_Form_Proofs<span class="antiquote">}</span></span>›</span>


<span class="comment1">(*&lt;*)</span>
<span class="keyword2"><span class="keyword">end</span></span>
<span class="comment1">(*&gt;*)</span>
</pre>
</div><div id="Standard_Model_More">
<div class="head">
<h1>Theory Standard_Model_More</h1>
</div>
<pre class="source"><span class="keyword1"><span class="command">chapter</span></span> <span class="quoted"><span class="plain_text">‹Standard Models with Two Provability Relations›</span></span>

<span class="comment1">(*&lt;*)</span>
<span class="comment1">(* Abstract notion of standard model and truth  *)</span>
<span class="keyword1"><span class="command">theory</span></span> Standard_Model_More
<span class="keyword2"><span class="keyword">imports</span></span> <a href="Derivability_Conditions.html">Derivability_Conditions</a> <span class="quoted">"<a href="../Syntax_Independent_Logic/Standard_Model.html">Syntax_Independent_Logic.Standard_Model</a>"</span>
<span class="keyword2"><span class="keyword">begin</span></span>
<span class="comment1">(*&gt;*)</span>

<span class="keyword1"><span class="command">locale</span></span> Minimal_Truth_Soundness_Proof_Repr <span class="main">=</span>
CleanRepr_Proofs
  <span class="quoted"><span class="free">var</span></span> <span class="quoted"><span class="free">trm</span></span> <span class="quoted"><span class="free">fmla</span></span> <span class="quoted"><span class="free">Var</span></span> <span class="quoted"><span class="free">FvarsT</span></span> <span class="quoted"><span class="free">substT</span></span> <span class="quoted"><span class="free">Fvars</span></span> <span class="quoted"><span class="free">subst</span></span>
  <span class="quoted"><span class="free">num</span></span>
  <span class="quoted"><span class="free">eql</span></span> <span class="quoted"><span class="free">cnj</span></span> <span class="quoted"><span class="free">imp</span></span> <span class="quoted"><span class="free">all</span></span> <span class="quoted"><span class="free">exi</span></span>
  <span class="quoted"><span class="free">prv</span></span> <span class="quoted"><span class="free">bprv</span></span>
  <span class="quoted"><span class="free">enc</span></span>
  <span class="quoted"><span class="free">fls</span></span>
  <span class="quoted"><span class="free">dsj</span></span>
  <span class="quoted"><span class="quoted">"<span class="free">proof</span>"</span></span> <span class="quoted"><span class="free">prfOf</span></span>
  <span class="quoted"><span class="free">encPf</span></span>
  <span class="quoted"><span class="free">Pf</span></span>
<span class="main">+</span> <span class="comment1">― ‹The label "B" stands for "basic", as a reminder that soundness
refers to the basic provability relation:›</span>
B<span class="main">:</span> Minimal_Truth_Soundness
  <span class="quoted"><span class="free">var</span></span> <span class="quoted"><span class="free">trm</span></span> <span class="quoted"><span class="free">fmla</span></span> <span class="quoted"><span class="free">Var</span></span> <span class="quoted"><span class="free">FvarsT</span></span> <span class="quoted"><span class="free">substT</span></span> <span class="quoted"><span class="free">Fvars</span></span> <span class="quoted"><span class="free">subst</span></span>
  <span class="quoted"><span class="free">eql</span></span> <span class="quoted"><span class="free">cnj</span></span> <span class="quoted"><span class="free">imp</span></span> <span class="quoted"><span class="free">all</span></span> <span class="quoted"><span class="free">exi</span></span>
  <span class="quoted"><span class="free">fls</span></span>
  <span class="quoted"><span class="free">dsj</span></span>
  <span class="quoted"><span class="free">num</span></span>
  <span class="quoted"><span class="free">bprv</span></span>
  <span class="quoted"><span class="free">isTrue</span></span>
<span class="keyword2"><span class="keyword">for</span></span>
<span class="free">var</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'var</span> set"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="free">trm</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'trm</span> set"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="free">fmla</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'fmla</span> set"</span></span>
<span class="keyword2"><span class="keyword">and</span></span> <span class="free">Var</span> <span class="free">FvarsT</span> <span class="free">substT</span> <span class="free">Fvars</span> <span class="free">subst</span>
<span class="keyword2"><span class="keyword">and</span></span> <span class="free">eql</span> <span class="free">cnj</span> <span class="free">imp</span> <span class="free">all</span> <span class="free">exi</span>
<span class="keyword2"><span class="keyword">and</span></span> <span class="free">fls</span>
<span class="keyword2"><span class="keyword">and</span></span> <span class="free">dsj</span>
<span class="keyword2"><span class="keyword">and</span></span> <span class="free">num</span>
<span class="keyword2"><span class="keyword">and</span></span> <span class="free">prv</span> <span class="free">bprv</span>
<span class="keyword2"><span class="keyword">and</span></span> <span class="free">isTrue</span>
<span class="keyword2"><span class="keyword">and</span></span> <span class="free">enc</span> <span class="main">(</span><span class="quoted">"<span class="keyword1">⟨</span>_<span class="keyword1">⟩</span>"</span><span class="main">)</span>
<span class="keyword2"><span class="keyword">and</span></span> <span class="quoted">"<span class="free">proof</span>"</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'proof</span> set"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="free">prfOf</span>
<span class="keyword2"><span class="keyword">and</span></span> <span class="free">encPf</span> <span class="free">Pf</span>
<span class="keyword2"><span class="keyword">begin</span></span>

<span class="keyword1"><span class="command">lemmas</span></span> prfOf_iff_PPf <span class="main">=</span> B_consistent_prfOf_iff_PPf<span class="main">[</span><span class="operator">OF</span> B.consistent<span class="main">]</span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹The provability predicate is decided by basic provability on encodings:›</span></span>
<span class="keyword1"><span class="command">lemma</span></span> isTrue_prv_PPf_prf_or_neg<span class="main">:</span>
<span class="quoted"><span class="quoted">"<span class="free">prf</span> <span class="main">∈</span> <span class="free">proof</span> <span class="main">⟹</span> <span class="free">φ</span> <span class="main">∈</span> <span class="free">fmla</span> <span class="main">⟹</span> <span class="free">Fvars</span> <span class="free">φ</span> <span class="main">=</span> <span class="main">{}</span> <span class="main">⟹</span>
    <span class="free">bprv</span> <span class="main">(</span>PPf <span class="main">(</span><span class="free">encPf</span> <span class="free">prf</span><span class="main">)</span> <span class="main"><span class="free">⟨</span></span><span class="free">φ</span><span class="main"><span class="free">⟩</span></span><span class="main">)</span> <span class="main">∨</span> <span class="free">bprv</span> <span class="main">(</span>neg <span class="main">(</span>PPf <span class="main">(</span><span class="free">encPf</span> <span class="free">prf</span><span class="main">)</span> <span class="main"><span class="free">⟨</span></span><span class="free">φ</span><span class="main"><span class="free">⟩</span></span><span class="main">)</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> not_prfOf_PPf prfOf_PPf <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹... hence that predicate is complete w.r.t. truth:›</span></span>
<span class="keyword1"><span class="command">lemma</span></span> isTrue_PPf_Implies_bprv_PPf<span class="main">:</span>
<span class="quoted"><span class="quoted">"<span class="free">prf</span> <span class="main">∈</span> <span class="free">proof</span> <span class="main">⟹</span> <span class="free">φ</span> <span class="main">∈</span> <span class="free">fmla</span> <span class="main">⟹</span> <span class="free">Fvars</span> <span class="free">φ</span> <span class="main">=</span> <span class="main">{}</span> <span class="main">⟹</span>
   <span class="free">isTrue</span> <span class="main">(</span>PPf <span class="main">(</span><span class="free">encPf</span> <span class="free">prf</span><span class="main">)</span> <span class="main"><span class="free">⟨</span></span><span class="free">φ</span><span class="main"><span class="free">⟩</span></span><span class="main">)</span> <span class="main">⟹</span> <span class="free">bprv</span> <span class="main">(</span>PPf <span class="main">(</span><span class="free">encPf</span> <span class="free">prf</span><span class="main">)</span> <span class="main"><span class="free">⟨</span></span><span class="free">φ</span><span class="main"><span class="free">⟩</span></span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> FvarsT_num Fvars_PPf Fvars_fls PPf
Un_empty empty_iff enc encPf fls in_num isTrue_prv_PPf_prf_or_neg
neg_def B.not_isTrue_fls B.prv_imp_implies_isTrue<span class="main">)</span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹... and thanks cleanness we can replace encoded proofs
with arbitrary numerals in the completeness property:›</span></span>
<span class="keyword1"><span class="command">lemma</span></span> isTrue_implies_bprv_PPf<span class="main">:</span>
<span class="keyword2"><span class="keyword">assumes</span></span> <span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">n</span> <span class="main">∈</span> <span class="free">num</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="free">φ</span> <span class="main">∈</span> <span class="free">fmla</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="free">Fvars</span> <span class="free">φ</span> <span class="main">=</span> <span class="main">{}</span>"</span></span>
<span class="keyword2"><span class="keyword">and</span></span> iT<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">isTrue</span> <span class="main">(</span>PPf <span class="free">n</span> <span class="main"><span class="free">⟨</span></span><span class="free">φ</span><span class="main"><span class="free">⟩</span></span><span class="main">)</span>"</span></span>
<span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">bprv</span> <span class="main">(</span>PPf <span class="free">n</span> <span class="main"><span class="free">⟨</span></span><span class="free">φ</span><span class="main"><span class="free">⟩</span></span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span><span class="main">(</span><span class="operator">cases</span> <span class="quoted"><span class="quoted">"<span class="free">n</span> <span class="main">∈</span> <span class="free">encPf</span> <span class="main">`</span> <span class="free">proof</span>"</span></span><span class="main">)</span>
  <span class="keyword3"><span class="command">case</span></span> True
  <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
    <span class="keyword1"><span class="command">using</span></span> iT isTrue_PPf_Implies_bprv_PPf <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">next</span></span>
  <span class="keyword3"><span class="command">case</span></span> False
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="free">bprv</span> <span class="main">(</span>neg <span class="main">(</span>PPf <span class="free">n</span> <span class="main"><span class="free">⟨</span></span><span class="free">φ</span><span class="main"><span class="free">⟩</span></span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> Clean_PPf_encPf<span class="main">)</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="free">isTrue</span> <span class="main">(</span>neg <span class="main">(</span>PPf <span class="free">n</span> <span class="main"><span class="free">⟨</span></span><span class="free">φ</span><span class="main"><span class="free">⟩</span></span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">intro</span> B.sound_isTrue<span class="main">)</span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted">False</span> <span class="keyword1"><span class="command">using</span></span> iT <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">intro</span> B.isTrue_neg_excl<span class="main">)</span> <span class="operator">auto</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹... in fact, by <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">locale</span></span> Minimal_Truth_Soundness<span class="antiquote"><span class="antiquote">}</span></span></span></span> we even have an iff:›</span></span>
<span class="keyword1"><span class="command">lemma</span></span> isTrue_iff_bprv_PPf<span class="main">:</span>
<span class="quoted"><span class="quoted">"<span class="main">⋀</span> <span class="bound">n</span> <span class="bound">φ</span><span class="main">.</span> <span class="bound">n</span> <span class="main">∈</span> <span class="free">num</span> <span class="main">⟹</span> <span class="bound">φ</span> <span class="main">∈</span> <span class="free">fmla</span> <span class="main">⟹</span> <span class="free">Fvars</span> <span class="bound">φ</span> <span class="main">=</span> <span class="main">{}</span> <span class="main">⟹</span> <span class="free">isTrue</span> <span class="main">(</span>PPf <span class="bound">n</span> <span class="main"><span class="free">⟨</span></span><span class="bound">φ</span><span class="main"><span class="free">⟩</span></span><span class="main">)</span> <span class="main">⟷</span> <span class="free">bprv</span> <span class="main">(</span>PPf <span class="bound">n</span> <span class="main"><span class="free">⟨</span></span><span class="bound">φ</span><span class="main"><span class="free">⟩</span></span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">using</span></span> isTrue_implies_bprv_PPf
<span class="keyword1"><span class="command">using</span></span> exists_no_Fvars B.not_isTrue_fls B.sound_isTrue <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹Truth of the provability representation implies provability (TIP):›</span></span>
<span class="keyword1"><span class="command">lemma</span></span> TIP<span class="main">:</span>
<span class="keyword2"><span class="keyword">assumes</span></span> φ<span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">φ</span> <span class="main">∈</span> <span class="free">fmla</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="free">Fvars</span> <span class="free">φ</span> <span class="main">=</span> <span class="main">{}</span>"</span></span>
<span class="keyword2"><span class="keyword">and</span></span> iPP<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">isTrue</span> <span class="main">(</span>wrepr.PP <span class="main"><span class="free">⟨</span></span><span class="free">φ</span><span class="main"><span class="free">⟩</span></span><span class="main">)</span>"</span></span>
<span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">prv</span> <span class="free">φ</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">isTrue</span> <span class="main">(</span><span class="free">exi</span> yy <span class="main">(</span>PPf <span class="main">(</span><span class="free">Var</span> yy<span class="main">)</span> <span class="main"><span class="free">⟨</span></span><span class="free">φ</span><span class="main"><span class="free">⟩</span></span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> iPP <span class="keyword1"><span class="command">unfolding</span></span> PP_PPf<span class="main">[</span><span class="operator">OF</span> φ<span class="main"><span class="main">(</span></span>1<span class="main"><span class="main">)</span></span><span class="main">]</span> <span class="keyword1"><span class="command">.</span></span>
  <span class="keyword1"><span class="command">from</span></span> B.isTrue_exi<span class="main">[</span><span class="operator">OF</span> _ _ _ this<span class="main">]</span>
  <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">n</span></span> <span class="keyword2"><span class="keyword">where</span></span> n<span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">n</span> <span class="main">∈</span> <span class="free">num</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">isTrue</span> <span class="main">(</span>PPf <span class="skolem">n</span> <span class="main"><span class="free">⟨</span></span><span class="free">φ</span><span class="main"><span class="free">⟩</span></span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">hence</span></span> pP<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">bprv</span> <span class="main">(</span>PPf <span class="skolem">n</span> <span class="main"><span class="free">⟨</span></span><span class="free">φ</span><span class="main"><span class="free">⟩</span></span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> isTrue_implies_bprv_PPf <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> <span class="free">bprv</span> <span class="main">(</span>neg <span class="main">(</span>PPf <span class="skolem">n</span> <span class="main"><span class="free">⟨</span></span><span class="free">φ</span><span class="main"><span class="free">⟩</span></span><span class="main">)</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> B.prv_neg_excl<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="quoted">"PPf <span class="skolem">n</span> <span class="main"><span class="free">⟨</span></span><span class="free">φ</span><span class="main"><span class="free">⟩</span></span>"</span></span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="quoted">"<span class="skolem"><span class="skolem">prf</span></span>"</span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted">"prf"</span><span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">prf</span> <span class="main">∈</span> <span class="free">proof</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> nn<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">n</span> <span class="main">=</span> <span class="free">encPf</span> <span class="skolem">prf</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> assms n Clean_PPf_encPf φ<span class="main">(</span>1<span class="main">)</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">prfOf</span> <span class="skolem">prf</span> <span class="free">φ</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> pP <span class="keyword1"><span class="command">unfolding</span></span> nn <span class="keyword1"><span class="command">using</span></span> prfOf_iff_PPf <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> prv_prfOf <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹The reverse HBL1 -- now without the $\omega$-consistency assumption which holds here
thanks to our truth-in-standard-model assumption:›</span></span>

<span class="keyword1"><span class="command">lemmas</span></span> HBL1_rev <span class="main">=</span> ωconsistentStd1_HBL1_rev<span class="main">[</span><span class="operator">OF</span> B.ωconsistentStd1<span class="main">]</span>
<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹Note that the above would also follow by <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">locale</span></span> Minimal_Truth_Soundness<span class="antiquote"><span class="antiquote">}</span></span></span></span> from TIP:›</span></span>
<span class="keyword1"><span class="command">lemma</span></span> TIP_implies_HBL1_rev<span class="main">:</span>
<span class="keyword2"><span class="keyword">assumes</span></span> TIP<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">φ</span><span class="main">.</span> <span class="bound">φ</span> <span class="main">∈</span> <span class="free">fmla</span> <span class="main">∧</span> <span class="free">Fvars</span> <span class="bound">φ</span> <span class="main">=</span> <span class="main">{}</span> <span class="main">∧</span> <span class="free">isTrue</span> <span class="main">(</span>wrepr.PP <span class="main"><span class="free">⟨</span></span><span class="bound">φ</span><span class="main"><span class="free">⟩</span></span><span class="main">)</span> <span class="main">⟶</span> <span class="free">prv</span> <span class="bound">φ</span>"</span></span>
<span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">φ</span><span class="main">.</span> <span class="bound">φ</span> <span class="main">∈</span> <span class="free">fmla</span> <span class="main">∧</span> <span class="free">Fvars</span> <span class="bound">φ</span> <span class="main">=</span> <span class="main">{}</span> <span class="main">∧</span> <span class="free">bprv</span> <span class="main">(</span>wrepr.PP <span class="main"><span class="free">⟨</span></span><span class="bound">φ</span><span class="main"><span class="free">⟩</span></span><span class="main">)</span> <span class="main">⟶</span> <span class="free">prv</span> <span class="bound">φ</span>"</span></span>
<span class="keyword1"><span class="command">using</span></span> B.sound_isTrue<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="quoted">"wrepr.PP <span class="main"><span class="free">⟨</span></span><span class="main">_</span><span class="main"><span class="free">⟩</span></span>"</span></span><span class="main">]</span> TIP <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword2"><span class="keyword">end</span></span> <span class="comment1">― ‹context <span class="antiquoted"><span class="antiquote">@{</span><span class="operator">locale</span> Minimal_Truth_Soundness_Proof_Repr<span class="antiquote">}</span></span>›</span>


<span class="keyword1"><span class="command">section</span></span> <span class="quoted"><span class="plain_text">‹Proof recovery from $\mathit{HBL1\_iff}$›</span></span>

<span class="keyword1"><span class="command">locale</span></span> Minimal_Truth_Soundness_HBL1iff_Compl_Pf <span class="main">=</span>
HBL1
  <span class="quoted"><span class="free">var</span></span> <span class="quoted"><span class="free">trm</span></span> <span class="quoted"><span class="free">fmla</span></span> <span class="quoted"><span class="free">Var</span></span> <span class="quoted"><span class="free">FvarsT</span></span> <span class="quoted"><span class="free">substT</span></span> <span class="quoted"><span class="free">Fvars</span></span> <span class="quoted"><span class="free">subst</span></span>
  <span class="quoted"><span class="free">num</span></span>
  <span class="quoted"><span class="free">eql</span></span> <span class="quoted"><span class="free">cnj</span></span> <span class="quoted"><span class="free">imp</span></span> <span class="quoted"><span class="free">all</span></span> <span class="quoted"><span class="free">exi</span></span>
  <span class="quoted"><span class="free">prv</span></span> <span class="quoted"><span class="free">bprv</span></span>
  <span class="quoted"><span class="free">enc</span></span>
  <span class="quoted"><span class="free">P</span></span>
<span class="main">+</span>
B <span class="main">:</span> Minimal_Truth_Soundness
  <span class="quoted"><span class="free">var</span></span> <span class="quoted"><span class="free">trm</span></span> <span class="quoted"><span class="free">fmla</span></span> <span class="quoted"><span class="free">Var</span></span> <span class="quoted"><span class="free">FvarsT</span></span> <span class="quoted"><span class="free">substT</span></span> <span class="quoted"><span class="free">Fvars</span></span> <span class="quoted"><span class="free">subst</span></span>
  <span class="quoted"><span class="free">eql</span></span> <span class="quoted"><span class="free">cnj</span></span> <span class="quoted"><span class="free">imp</span></span> <span class="quoted"><span class="free">all</span></span> <span class="quoted"><span class="free">exi</span></span>
  <span class="quoted"><span class="free">fls</span></span>
  <span class="quoted"><span class="free">dsj</span></span>
  <span class="quoted"><span class="free">num</span></span>
  <span class="quoted"><span class="free">bprv</span></span>
  <span class="quoted"><span class="free">isTrue</span></span>
<span class="main">+</span>
Deduct_with_False_Disj
  <span class="quoted"><span class="free">var</span></span> <span class="quoted"><span class="free">trm</span></span> <span class="quoted"><span class="free">fmla</span></span> <span class="quoted"><span class="free">Var</span></span> <span class="quoted"><span class="free">FvarsT</span></span> <span class="quoted"><span class="free">substT</span></span> <span class="quoted"><span class="free">Fvars</span></span> <span class="quoted"><span class="free">subst</span></span>
  <span class="quoted"><span class="free">eql</span></span> <span class="quoted"><span class="free">cnj</span></span> <span class="quoted"><span class="free">imp</span></span> <span class="quoted"><span class="free">all</span></span> <span class="quoted"><span class="free">exi</span></span>
  <span class="quoted"><span class="free">fls</span></span>
  <span class="quoted"><span class="free">dsj</span></span>
  <span class="quoted"><span class="free">num</span></span>
  <span class="quoted"><span class="free">prv</span></span>
<span class="keyword2"><span class="keyword">for</span></span>
<span class="free">var</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'var</span> set"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="free">trm</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'trm</span> set"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="free">fmla</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'fmla</span> set"</span></span>
<span class="keyword2"><span class="keyword">and</span></span> <span class="free">Var</span> <span class="free">FvarsT</span> <span class="free">substT</span> <span class="free">Fvars</span> <span class="free">subst</span>
<span class="keyword2"><span class="keyword">and</span></span> <span class="free">eql</span> <span class="free">cnj</span> <span class="free">imp</span> <span class="free">all</span> <span class="free">exi</span>
<span class="keyword2"><span class="keyword">and</span></span> <span class="free">fls</span>
<span class="keyword2"><span class="keyword">and</span></span> <span class="free">dsj</span>
<span class="keyword2"><span class="keyword">and</span></span> <span class="free">num</span>
<span class="keyword2"><span class="keyword">and</span></span> <span class="free">enc</span> <span class="main">(</span><span class="quoted">"<span class="keyword1">⟨</span>_<span class="keyword1">⟩</span>"</span><span class="main">)</span>
<span class="keyword2"><span class="keyword">and</span></span> <span class="free">prv</span> <span class="free">bprv</span>
<span class="keyword2"><span class="keyword">and</span></span> <span class="free">P</span>
<span class="keyword2"><span class="keyword">and</span></span> <span class="free">isTrue</span>
<span class="main">+</span>
<span class="keyword2"><span class="keyword">fixes</span></span> <span class="free">Pf</span> <span class="main">::</span> <span class="tfree"><span class="quoted"><span class="tfree">'fmla</span></span></span>
<span class="keyword2"><span class="keyword">assumes</span></span>
<span class="comment1">― ‹<span class="antiquoted"><span class="antiquote">@{</span><span class="operator">term</span> <span class="quoted"><span class="free">Pf</span></span><span class="antiquote">}</span></span> is a formula with free variables <span class="antiquoted"><span class="antiquote">@{</span><span class="operator">term</span> <span class="quoted">xx</span><span class="antiquote">}</span></span> <span class="antiquoted"><span class="antiquote">@{</span><span class="operator">term</span> <span class="quoted">yy</span><span class="antiquote">}</span></span>:›</span>
Pf<span class="main">[</span><span class="operator">simp</span><span class="main">,</span><span class="operator">intro</span><span class="main"><span class="main">!</span></span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">Pf</span> <span class="main">∈</span> <span class="free">fmla</span>"</span></span>
<span class="keyword2"><span class="keyword">and</span></span>
Fvars_Pf<span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">Fvars</span> <span class="free">Pf</span> <span class="main">=</span> <span class="main">{</span>yy<span class="main">,</span>xx<span class="main">}</span>"</span></span>
<span class="keyword2"><span class="keyword">and</span></span>
<span class="comment1">― ‹<span class="antiquoted"><span class="antiquote">@{</span><span class="operator">term</span> <span class="quoted"><span class="free">P</span></span><span class="antiquote">}</span></span> relates to <span class="antiquoted"><span class="antiquote">@{</span><span class="operator">term</span> <span class="quoted"><span class="free">Pf</span></span><span class="antiquote">}</span></span> internally (inside basic provability)
just like a <span class="antiquoted"><span class="antiquote">@{</span><span class="operator">term</span> <span class="quoted"><span class="free">prv</span></span><span class="antiquote">}</span></span> and a <span class="antiquoted"><span class="antiquote">@{</span><span class="operator">term</span> <span class="quoted"><span class="free">prfOf</span></span><span class="antiquote">}</span></span> would relate---via an existential:›</span>
P_Pf<span class="main">:</span>
<span class="quoted"><span class="quoted">"<span class="free">φ</span> <span class="main">∈</span> <span class="free">fmla</span> <span class="main">⟹</span> <span class="free">Fvars</span> <span class="free">φ</span> <span class="main">=</span> <span class="main">{}</span> <span class="main">⟹</span>
 <span class="keyword1">let</span> <span class="bound">PPf</span> <span class="main">=</span> <span class="main">(</span><span class="main">λ</span> <span class="bound">t1</span> <span class="bound">t2</span><span class="main">.</span> psubst <span class="free">Pf</span> <span class="main">[</span><span class="main">(</span><span class="bound">t1</span><span class="main">,</span>yy<span class="main">)</span><span class="main">,</span> <span class="main">(</span><span class="bound">t2</span><span class="main">,</span>xx<span class="main">)</span><span class="main">]</span><span class="main">)</span> <span class="keyword1">in</span>
 <span class="free">bprv</span> <span class="main">(</span>eqv <span class="main">(</span><span class="free">subst</span> <span class="free">P</span> <span class="main"><span class="free">⟨</span></span><span class="free">φ</span><span class="main"><span class="free">⟩</span></span> xx<span class="main">)</span> <span class="main">(</span><span class="free">exi</span> yy <span class="main">(</span><span class="bound">PPf</span> <span class="main">(</span><span class="free">Var</span> yy<span class="main">)</span> <span class="main"><span class="free">⟨</span></span><span class="free">φ</span><span class="main"><span class="free">⟩</span></span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span>
<span class="keyword2"><span class="keyword">assumes</span></span>
<span class="comment1">― ‹We assume both $\mathit{HBL1}$ and $\mathit{HBL1\_rev}$, i.e., an iff version:›</span>
HBL1_iff<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">⋀</span> <span class="bound">φ</span><span class="main">.</span> <span class="bound">φ</span> <span class="main">∈</span> <span class="free">fmla</span> <span class="main">⟹</span> <span class="free">Fvars</span> <span class="bound">φ</span> <span class="main">=</span> <span class="main">{}</span> <span class="main">⟹</span> <span class="free">bprv</span> <span class="main">(</span>PP <span class="main"><span class="free">⟨</span></span><span class="bound">φ</span><span class="main"><span class="free">⟩</span></span><span class="main">)</span> <span class="main">⟷</span> <span class="free">prv</span> <span class="bound">φ</span>"</span></span>
<span class="keyword2"><span class="keyword">and</span></span>
Compl_Pf<span class="main">:</span>
<span class="quoted"><span class="quoted">"<span class="main">⋀</span> <span class="bound">n</span> <span class="bound">φ</span><span class="main">.</span> <span class="bound">n</span> <span class="main">∈</span> <span class="free">num</span> <span class="main">⟹</span> <span class="bound">φ</span> <span class="main">∈</span> <span class="free">fmla</span> <span class="main">⟹</span> <span class="free">Fvars</span> <span class="bound">φ</span> <span class="main">=</span> <span class="main">{}</span> <span class="main">⟹</span>
 <span class="keyword1">let</span> <span class="bound">PPf</span> <span class="main">=</span> <span class="main">(</span><span class="main">λ</span> <span class="bound">t1</span> <span class="bound">t2</span><span class="main">.</span> psubst <span class="free">Pf</span> <span class="main">[</span><span class="main">(</span><span class="bound">t1</span><span class="main">,</span>yy<span class="main">)</span><span class="main">,</span> <span class="main">(</span><span class="bound">t2</span><span class="main">,</span>xx<span class="main">)</span><span class="main">]</span><span class="main">)</span> <span class="keyword1">in</span>
 <span class="free">isTrue</span> <span class="main">(</span><span class="bound">PPf</span> <span class="bound">n</span> <span class="main"><span class="free">⟨</span></span><span class="bound">φ</span><span class="main"><span class="free">⟩</span></span><span class="main">)</span> <span class="main">⟶</span> <span class="free">bprv</span> <span class="main">(</span><span class="bound">PPf</span> <span class="bound">n</span> <span class="main"><span class="free">⟨</span></span><span class="bound">φ</span><span class="main"><span class="free">⟩</span></span><span class="main">)</span>"</span></span>
<span class="keyword2"><span class="keyword">begin</span></span>

<span class="keyword1"><span class="command">definition</span></span> <span class="entity">PPf</span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="free">PPf</span> <span class="main">≡</span> <span class="main">λ</span> <span class="bound">t1</span> <span class="bound">t2</span><span class="main">.</span> psubst <span class="free">Pf</span> <span class="main">[</span><span class="main">(</span><span class="bound">t1</span><span class="main">,</span>yy<span class="main">)</span><span class="main">,</span> <span class="main">(</span><span class="bound">t2</span><span class="main">,</span>xx<span class="main">)</span><span class="main">]</span>"</span></span>

<span class="keyword1"><span class="command">lemma</span></span> PP_deff<span class="main">:</span> <span class="quoted"><span class="quoted">"PP <span class="free">t</span> <span class="main">=</span> <span class="free">subst</span> <span class="free">P</span> <span class="free">t</span> xx"</span></span> <span class="keyword1"><span class="command">using</span></span> PP_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">lemma</span></span> PP_PPf_eqv<span class="main">:</span>
  <span class="quoted"><span class="quoted">"<span class="free">φ</span> <span class="main">∈</span> <span class="free">fmla</span> <span class="main">⟹</span> <span class="free">Fvars</span> <span class="free">φ</span> <span class="main">=</span> <span class="main">{}</span> <span class="main">⟹</span> <span class="free">bprv</span> <span class="main">(</span>eqv <span class="main">(</span>PP <span class="main"><span class="free">⟨</span></span><span class="free">φ</span><span class="main"><span class="free">⟩</span></span><span class="main">)</span> <span class="main">(</span><span class="free">exi</span> yy <span class="main">(</span>PPf <span class="main">(</span><span class="free">Var</span> yy<span class="main">)</span> <span class="main"><span class="free">⟨</span></span><span class="free">φ</span><span class="main"><span class="free">⟩</span></span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> PP_deff PPf_def P_Pf <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="comment1">(*  *)</span>

<span class="keyword1"><span class="command">lemma</span></span> PPf<span class="main">[</span><span class="operator">simp</span><span class="main">,</span><span class="operator">intro</span><span class="main"><span class="main"><span class="main">!</span></span></span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">t1</span> <span class="main">∈</span> <span class="free">trm</span> <span class="main">⟹</span> <span class="free">t2</span> <span class="main">∈</span> <span class="free">trm</span> <span class="main">⟹</span> xx <span class="main">∉</span> <span class="free">FvarsT</span> <span class="free">t1</span> <span class="main">⟹</span> PPf <span class="free">t1</span> <span class="free">t2</span> <span class="main">∈</span> <span class="free">fmla</span>"</span></span>
  <span class="keyword1"><span class="command">unfolding</span></span> PPf_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">lemma</span></span> PPf_def2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">t1</span> <span class="main">∈</span> <span class="free">trm</span> <span class="main">⟹</span> <span class="free">t2</span> <span class="main">∈</span> <span class="free">trm</span> <span class="main">⟹</span> xx <span class="main">∉</span> <span class="free">FvarsT</span> <span class="free">t1</span> <span class="main">⟹</span>
  PPf <span class="free">t1</span> <span class="free">t2</span> <span class="main">=</span> <span class="free">subst</span> <span class="main">(</span><span class="free">subst</span> <span class="free">Pf</span> <span class="free">t1</span> yy<span class="main">)</span> <span class="free">t2</span> xx"</span></span>
  <span class="keyword1"><span class="command">unfolding</span></span> PPf_def <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> psubst_eq_rawpsubst2<span class="main"><span class="main">[</span></span><span class="operator">simplified</span><span class="main"><span class="main">]</span></span><span class="main">)</span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">lemma</span></span> Fvars_PPf<span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span>
  <span class="quoted"><span class="quoted">"<span class="free">t1</span> <span class="main">∈</span> <span class="free">trm</span> <span class="main">⟹</span> <span class="free">t2</span> <span class="main">∈</span> <span class="free">trm</span> <span class="main">⟹</span> xx <span class="main">∉</span> <span class="free">FvarsT</span> <span class="free">t1</span> <span class="main">⟹</span> <span class="free">Fvars</span> <span class="main">(</span>PPf <span class="free">t1</span> <span class="free">t2</span><span class="main">)</span> <span class="main">=</span> <span class="free">FvarsT</span> <span class="free">t1</span> <span class="main">∪</span> <span class="free">FvarsT</span> <span class="free">t2</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> PPf_def2 subst2_fresh_switch<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span>
<span class="quoted"><span class="quoted">"<span class="free">n</span> <span class="main">∈</span> <span class="free">num</span> <span class="main">⟹</span> <span class="free">subst</span> <span class="main">(</span>PPf <span class="main">(</span><span class="free">Var</span> yy<span class="main">)</span> <span class="main">(</span><span class="free">Var</span> xx<span class="main">)</span><span class="main">)</span> <span class="free">n</span> xx <span class="main">=</span> PPf <span class="main">(</span><span class="free">Var</span> yy<span class="main">)</span> <span class="free">n</span>"</span></span>
<span class="quoted"><span class="quoted">"<span class="free">m</span> <span class="main">∈</span> <span class="free">num</span> <span class="main">⟹</span> <span class="free">n</span> <span class="main">∈</span> <span class="free">num</span> <span class="main">⟹</span> <span class="free">subst</span> <span class="main">(</span>PPf <span class="main">(</span><span class="free">Var</span> yy<span class="main">)</span> <span class="free">m</span><span class="main">)</span> <span class="free">n</span> yy <span class="main">=</span> PPf <span class="free">n</span> <span class="free">m</span>"</span></span>
<span class="quoted"><span class="quoted">"<span class="free">n</span> <span class="main">∈</span> <span class="free">num</span> <span class="main">⟹</span> <span class="free">subst</span> <span class="main">(</span>PPf <span class="main">(</span><span class="free">Var</span> yy<span class="main">)</span> <span class="main">(</span><span class="free">Var</span> xx<span class="main">)</span><span class="main">)</span> <span class="free">n</span> yy <span class="main">=</span> PPf <span class="free">n</span> <span class="main">(</span><span class="free">Var</span> xx<span class="main">)</span>"</span></span>
<span class="quoted"><span class="quoted">"<span class="free">m</span> <span class="main">∈</span> <span class="free">num</span> <span class="main">⟹</span> <span class="free">n</span> <span class="main">∈</span> <span class="free">num</span> <span class="main">⟹</span> <span class="free">subst</span> <span class="main">(</span>PPf <span class="free">m</span> <span class="main">(</span><span class="free">Var</span> xx<span class="main">)</span><span class="main">)</span> <span class="free">n</span> xx <span class="main">=</span> PPf <span class="free">m</span> <span class="free">n</span>"</span></span>
<span class="quoted"><span class="quoted">"<span class="free">m</span> <span class="main">∈</span> <span class="free">num</span> <span class="main">⟹</span> <span class="free">subst</span> <span class="main">(</span>PPf <span class="main">(</span><span class="free">Var</span> zz<span class="main">)</span> <span class="main">(</span><span class="free">Var</span> xx'<span class="main">)</span><span class="main">)</span> <span class="free">m</span> zz <span class="main">=</span> PPf <span class="free">m</span> <span class="main">(</span><span class="free">Var</span> xx'<span class="main">)</span>"</span></span>
<span class="quoted"><span class="quoted">"<span class="free">m</span> <span class="main">∈</span> <span class="free">num</span> <span class="main">⟹</span> <span class="free">n</span> <span class="main">∈</span> <span class="free">num</span> <span class="main">⟹</span> <span class="free">subst</span> <span class="main">(</span>PPf <span class="free">m</span> <span class="main">(</span><span class="free">Var</span> xx'<span class="main">)</span><span class="main">)</span> <span class="free">n</span> xx' <span class="main">=</span> PPf <span class="free">m</span> <span class="free">n</span>"</span></span>
<span class="quoted"><span class="quoted">"<span class="free">n</span> <span class="main">∈</span> <span class="free">num</span> <span class="main">⟹</span> <span class="free">subst</span> <span class="main">(</span>PPf <span class="main">(</span><span class="free">Var</span> zz<span class="main">)</span> <span class="main">(</span><span class="free">Var</span> xx'<span class="main">)</span><span class="main">)</span> <span class="free">n</span> xx' <span class="main">=</span> PPf <span class="main">(</span><span class="free">Var</span> zz<span class="main">)</span> <span class="free">n</span>"</span></span>
<span class="quoted"><span class="quoted">"<span class="free">m</span> <span class="main">∈</span> <span class="free">num</span> <span class="main">⟹</span> <span class="free">n</span> <span class="main">∈</span> <span class="free">num</span> <span class="main">⟹</span> <span class="free">subst</span> <span class="main">(</span>PPf <span class="main">(</span><span class="free">Var</span> zz<span class="main">)</span> <span class="free">n</span><span class="main">)</span> <span class="free">m</span> zz <span class="main">=</span> PPf <span class="free">m</span> <span class="free">n</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> PPf_def2 subst2_fresh_switch<span class="main">)</span>

<span class="comment1">(* *)</span>

<span class="keyword1"><span class="command">lemma</span></span> PP_PPf<span class="main">:</span>
<span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">φ</span> <span class="main">∈</span> <span class="free">fmla</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="free">Fvars</span> <span class="free">φ</span> <span class="main">=</span> <span class="main">{}</span>"</span></span> <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">bprv</span> <span class="main">(</span>PP <span class="main"><span class="free">⟨</span></span><span class="free">φ</span><span class="main"><span class="free">⟩</span></span><span class="main">)</span> <span class="main">⟷</span> <span class="free">bprv</span> <span class="main">(</span><span class="free">exi</span> yy <span class="main">(</span>PPf <span class="main">(</span><span class="free">Var</span> yy<span class="main">)</span> <span class="main"><span class="free">⟨</span></span><span class="free">φ</span><span class="main"><span class="free">⟩</span></span><span class="main">)</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> assms PP_PPf_eqv<span class="main">[</span><span class="operator">OF</span> assms<span class="main">]</span> B.prv_eqv_sym<span class="main">[</span><span class="operator">OF</span> _ _ PP_PPf_eqv<span class="main"><span class="main">[</span></span><span class="operator">OF</span> assms<span class="main"><span class="main">]</span></span><span class="main">]</span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">intro</span><span class="main"><span class="main">!</span></span><span class="main"><span class="main">:</span></span> B.prv_eqv_prv<span class="main"><span class="main">[</span></span><span class="operator">of</span> <span class="quoted"><span class="quoted">"PP <span class="main"><span class="free">⟨</span></span><span class="free">φ</span><span class="main"><span class="free">⟩</span></span>"</span></span> <span class="quoted"><span class="quoted">"<span class="free">exi</span> yy <span class="main">(</span>PPf <span class="main">(</span><span class="free">Var</span> yy<span class="main">)</span> <span class="main"><span class="free">⟨</span></span><span class="free">φ</span><span class="main"><span class="free">⟩</span></span><span class="main">)</span>"</span></span><span class="main"><span class="main">]</span></span>
    B.prv_eqv_prv<span class="main"><span class="main">[</span></span><span class="operator">of</span> <span class="quoted"><span class="quoted">"<span class="free">exi</span> yy <span class="main">(</span>PPf <span class="main">(</span><span class="free">Var</span> yy<span class="main">)</span> <span class="main"><span class="free">⟨</span></span><span class="free">φ</span><span class="main"><span class="free">⟩</span></span><span class="main">)</span>"</span></span> <span class="quoted"><span class="quoted">"PP <span class="main"><span class="free">⟨</span></span><span class="free">φ</span><span class="main"><span class="free">⟩</span></span>"</span></span><span class="main"><span class="main">]</span></span><span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> isTrue_implies_bprv_PPf<span class="main">:</span>
<span class="quoted"><span class="quoted">"<span class="main">⋀</span> <span class="bound">n</span> <span class="bound">φ</span><span class="main">.</span> <span class="bound">n</span> <span class="main">∈</span> <span class="free">num</span> <span class="main">⟹</span> <span class="bound">φ</span> <span class="main">∈</span> <span class="free">fmla</span> <span class="main">⟹</span> <span class="free">Fvars</span> <span class="bound">φ</span> <span class="main">=</span> <span class="main">{}</span> <span class="main">⟹</span>
 <span class="free">isTrue</span> <span class="main">(</span>PPf <span class="bound">n</span> <span class="main"><span class="free">⟨</span></span><span class="bound">φ</span><span class="main"><span class="free">⟩</span></span><span class="main">)</span> <span class="main">⟹</span> <span class="free">bprv</span> <span class="main">(</span>PPf <span class="bound">n</span> <span class="main"><span class="free">⟨</span></span><span class="bound">φ</span><span class="main"><span class="free">⟩</span></span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> Compl_Pf <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> PPf_def<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> isTrue_iff_bprv_PPf<span class="main">:</span>
<span class="quoted"><span class="quoted">"<span class="main">⋀</span> <span class="bound">n</span> <span class="bound">φ</span><span class="main">.</span> <span class="bound">n</span> <span class="main">∈</span> <span class="free">num</span> <span class="main">⟹</span> <span class="bound">φ</span> <span class="main">∈</span> <span class="free">fmla</span> <span class="main">⟹</span> <span class="free">Fvars</span> <span class="bound">φ</span> <span class="main">=</span> <span class="main">{}</span> <span class="main">⟹</span> <span class="free">isTrue</span> <span class="main">(</span>PPf <span class="bound">n</span> <span class="main"><span class="free">⟨</span></span><span class="bound">φ</span><span class="main"><span class="free">⟩</span></span><span class="main">)</span> <span class="main">⟷</span> <span class="free">bprv</span> <span class="main">(</span>PPf <span class="bound">n</span> <span class="main"><span class="free">⟨</span></span><span class="bound">φ</span><span class="main"><span class="free">⟩</span></span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">using</span></span> isTrue_implies_bprv_PPf
  <span class="keyword1"><span class="command">using</span></span> exists_no_Fvars B.not_isTrue_fls B.sound_isTrue <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹Preparing to instantiate this "proof recovery" alternative into our
mainstream locale hierarchy, which assumes proofs.
We define the "missing" proofs to be numerals, we encode them as the identity,
and we "copy" <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">term</span></span> <span class="quoted"><span class="free"><span class="quoted"><span class="free">prfOf</span></span></span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span> from the corresponding predicate one-level-up, <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">term</span></span> <span class="quoted"><span class="quoted">PPf</span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span>:›</span></span>

<span class="keyword1"><span class="command">definition</span></span> <span class="quoted">"<span class="entity">proof</span>"</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'trm</span> set"</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">proof</span> <span class="main">=</span> <span class="free">num</span>"</span></span>
<span class="keyword1"><span class="command">definition</span></span> <span class="entity">prfOf</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'trm</span> <span class="main">⇒</span> <span class="tfree">'fmla</span> <span class="main">⇒</span> bool"</span></span> <span class="keyword2"><span class="keyword">where</span></span>
  <span class="quoted"><span class="quoted">"<span class="free">prfOf</span> <span class="free"><span class="bound"><span class="entity">n</span></span></span> <span class="free"><span class="bound"><span class="entity">φ</span></span></span> <span class="main">≡</span> <span class="free">bprv</span> <span class="main">(</span>PPf <span class="free"><span class="bound"><span class="entity">n</span></span></span> <span class="main"><span class="free">⟨</span></span><span class="free"><span class="bound"><span class="entity">φ</span></span></span><span class="main"><span class="free">⟩</span></span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">definition</span></span> <span class="entity">encPf</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'trm</span> <span class="main">⇒</span> <span class="tfree">'trm</span>"</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">encPf</span> <span class="main">≡</span> id"</span></span>
<span class="comment1">(*  *)</span>

<span class="keyword1"><span class="command">lemma</span></span> prv_exi_PPf_iff_isTrue<span class="main">:</span>
<span class="keyword2"><span class="keyword">assumes</span></span> <span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">φ</span> <span class="main">∈</span> <span class="free">fmla</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="free">Fvars</span> <span class="free">φ</span> <span class="main">=</span> <span class="main">{}</span>"</span></span>
<span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">bprv</span> <span class="main">(</span><span class="free">exi</span> yy <span class="main">(</span>PPf <span class="main">(</span><span class="free">Var</span> yy<span class="main">)</span> <span class="main"><span class="free">⟨</span></span><span class="free">φ</span><span class="main"><span class="free">⟩</span></span><span class="main">)</span><span class="main">)</span> <span class="main">⟷</span> <span class="free">isTrue</span> <span class="main">(</span><span class="free">exi</span> yy <span class="main">(</span>PPf <span class="main">(</span><span class="free">Var</span> yy<span class="main">)</span> <span class="main"><span class="free">⟨</span></span><span class="free">φ</span><span class="main"><span class="free">⟩</span></span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">is</span></span> <span class="quoted"><span class="quoted">"<span class="var">?L</span> <span class="main">⟷</span> <span class="var">?R</span>"</span></span><span class="main">)</span>
<span class="keyword1"><span class="command">proof</span></span>
  <span class="keyword3"><span class="command">assume</span></span> <span class="var"><span class="quoted"><span class="var">?L</span></span></span> <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?R</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">intro</span> B.sound_isTrue<span class="main">)</span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">next</span></span>
  <span class="keyword3"><span class="command">assume</span></span> <span class="var"><span class="quoted"><span class="var">?R</span></span></span>
  <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">n</span></span> <span class="keyword2"><span class="keyword">where</span></span> n<span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">n</span> <span class="main">∈</span> <span class="free">num</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> i<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">isTrue</span> <span class="main">(</span>PPf <span class="skolem">n</span> <span class="main"><span class="free">⟨</span></span><span class="free">φ</span><span class="main"><span class="free">⟩</span></span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> B.isTrue_exi<span class="main">[</span><span class="operator">OF</span> _ _ _ <span class="quoted"><span class="quoted">‹<span class="var">?R</span>›</span></span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="free">bprv</span> <span class="main">(</span>PPf <span class="skolem">n</span> <span class="main"><span class="free">⟨</span></span><span class="free">φ</span><span class="main"><span class="free">⟩</span></span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> isTrue_iff_bprv_PPf<span class="main">)</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?L</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">intro</span> B.prv_exiI<span class="main"><span class="main">[</span></span><span class="operator">of</span> <span class="main"><span class="main">_</span></span> <span class="main"><span class="main">_</span></span> <span class="quoted"><span class="skolem">n</span></span><span class="main"><span class="main">]</span></span><span class="main">)</span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">lemma</span></span> isTrue_exi_iff<span class="main">:</span>
<span class="keyword2"><span class="keyword">assumes</span></span> <span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">φ</span> <span class="main">∈</span> <span class="free">fmla</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="free">Fvars</span> <span class="free">φ</span> <span class="main">=</span> <span class="main">{}</span>"</span></span>
<span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">isTrue</span> <span class="main">(</span><span class="free">exi</span> yy <span class="main">(</span>PPf <span class="main">(</span><span class="free">Var</span> yy<span class="main">)</span> <span class="main"><span class="free">⟨</span></span><span class="free">φ</span><span class="main"><span class="free">⟩</span></span><span class="main">)</span><span class="main">)</span> <span class="main">⟷</span> <span class="main">(</span><span class="main">∃</span><span class="bound">n</span><span class="main">∈</span><span class="free">num</span><span class="main">.</span> <span class="free">isTrue</span> <span class="main">(</span>PPf <span class="bound">n</span> <span class="main"><span class="free">⟨</span></span><span class="free">φ</span><span class="main"><span class="free">⟩</span></span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">is</span></span> <span class="quoted"><span class="quoted">"<span class="var">?L</span> <span class="main">⟷</span> <span class="var">?R</span>"</span></span><span class="main">)</span>
<span class="keyword1"><span class="command">proof</span></span>
  <span class="keyword3"><span class="command">assume</span></span> <span class="var"><span class="quoted"><span class="var">?L</span></span></span> <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?R</span></span></span> <span class="keyword1"><span class="command">using</span></span> B.isTrue_exi<span class="main">[</span><span class="operator">OF</span> _ _ _ <span class="quoted"><span class="quoted">‹<span class="var">?L</span>›</span></span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">next</span></span>
  <span class="keyword3"><span class="command">assume</span></span> <span class="var"><span class="quoted"><span class="var">?R</span></span></span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">n</span></span> <span class="keyword2"><span class="keyword">where</span></span> n<span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">n</span> <span class="main">∈</span> <span class="free">num</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> i<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">isTrue</span> <span class="main">(</span>PPf <span class="skolem">n</span> <span class="main"><span class="free">⟨</span></span><span class="free">φ</span><span class="main"><span class="free">⟩</span></span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="free">bprv</span> <span class="main">(</span>PPf <span class="skolem">n</span> <span class="main"><span class="free">⟨</span></span><span class="free">φ</span><span class="main"><span class="free">⟩</span></span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> isTrue_iff_bprv_PPf<span class="main">)</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="free">bprv</span> <span class="main">(</span><span class="free">exi</span> yy <span class="main">(</span>PPf <span class="main">(</span><span class="free">Var</span> yy<span class="main">)</span> <span class="main"><span class="free">⟨</span></span><span class="free">φ</span><span class="main"><span class="free">⟩</span></span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">intro</span> B.prv_exiI<span class="main"><span class="main">[</span></span><span class="operator">of</span> <span class="main"><span class="main">_</span></span> <span class="main"><span class="main">_</span></span> <span class="quoted"><span class="skolem">n</span></span><span class="main"><span class="main">]</span></span><span class="main">)</span> <span class="operator">auto</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?L</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">intro</span> B.sound_isTrue<span class="main">)</span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">lemma</span></span> prv_prfOf<span class="main">:</span>
<span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">φ</span> <span class="main">∈</span> <span class="free">fmla</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="free">Fvars</span> <span class="free">φ</span> <span class="main">=</span> <span class="main">{}</span>"</span></span>
<span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">prv</span> <span class="free">φ</span> <span class="main">⟷</span> <span class="main">(</span><span class="main">∃</span><span class="bound">n</span><span class="main">∈</span><span class="free">num</span><span class="main">.</span> prfOf <span class="bound">n</span> <span class="free">φ</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">prv</span> <span class="free">φ</span> <span class="main">⟷</span> <span class="free">bprv</span> <span class="main">(</span>PP <span class="main"><span class="free">⟨</span></span><span class="free">φ</span><span class="main"><span class="free">⟩</span></span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> HBL1_iff<span class="main">[</span><span class="operator">OF</span> assms<span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">…</span> <span class="main">⟷</span> <span class="free">bprv</span> <span class="main">(</span><span class="free">exi</span> yy <span class="main">(</span>PPf <span class="main">(</span><span class="free">Var</span> yy<span class="main">)</span> <span class="main"><span class="free">⟨</span></span><span class="free">φ</span><span class="main"><span class="free">⟩</span></span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> PP_PPf<span class="main">[</span><span class="operator">OF</span> assms<span class="main">]</span> <span class="keyword1"><span class="command">..</span></span>
  <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">…</span> <span class="main">⟷</span> <span class="free">isTrue</span> <span class="main">(</span><span class="free">exi</span> yy <span class="main">(</span>PPf <span class="main">(</span><span class="free">Var</span> yy<span class="main">)</span> <span class="main"><span class="free">⟨</span></span><span class="free">φ</span><span class="main"><span class="free">⟩</span></span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> prv_exi_PPf_iff_isTrue<span class="main">[</span><span class="operator">OF</span> assms<span class="main">]</span> <span class="keyword1"><span class="command">.</span></span>
  <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">…</span> <span class="main">⟷</span> <span class="main">(</span><span class="main">∃</span><span class="bound">n</span><span class="main">∈</span><span class="free">num</span><span class="main">.</span> <span class="free">isTrue</span> <span class="main">(</span>PPf <span class="bound">n</span> <span class="main"><span class="free">⟨</span></span><span class="free">φ</span><span class="main"><span class="free">⟩</span></span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> isTrue_exi_iff<span class="main">[</span><span class="operator">OF</span> assms<span class="main">]</span> <span class="keyword1"><span class="command">.</span></span>
  <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">…</span> <span class="main">⟷</span> <span class="main">(</span><span class="main">∃</span><span class="bound">n</span><span class="main">∈</span><span class="free">num</span><span class="main">.</span> <span class="free">bprv</span> <span class="main">(</span>PPf <span class="bound">n</span> <span class="main"><span class="free">⟨</span></span><span class="free">φ</span><span class="main"><span class="free">⟩</span></span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> isTrue_iff_bprv_PPf<span class="main">[</span><span class="operator">OF</span> _ assms<span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">…</span> <span class="main">⟷</span> <span class="main">(</span><span class="main">∃</span><span class="bound">n</span><span class="main">∈</span><span class="free">num</span><span class="main">.</span> prfOf <span class="bound">n</span> <span class="free">φ</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> prfOf_def <span class="keyword1"><span class="command">..</span></span>
  <span class="keyword1"><span class="command">finally</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">.</span></span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">lemma</span></span> prfOf_prv_Pf<span class="main">:</span>
<span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">n</span> <span class="main">∈</span> <span class="free">num</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">φ</span> <span class="main">∈</span> <span class="free">fmla</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="free">Fvars</span> <span class="free">φ</span> <span class="main">=</span> <span class="main">{}</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"prfOf <span class="free">n</span> <span class="free">φ</span>"</span></span>
<span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">bprv</span> <span class="main">(</span>psubst <span class="free">Pf</span> <span class="main">[</span><span class="main">(</span><span class="free">n</span><span class="main">,</span> yy<span class="main">)</span><span class="main">,</span> <span class="main">(</span><span class="main"><span class="free">⟨</span></span><span class="free">φ</span><span class="main"><span class="free">⟩</span></span><span class="main">,</span> xx<span class="main">)</span><span class="main">]</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">unfolding</span></span> prfOf_def <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> PPf_def2 psubst_eq_rawpsubst2<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> isTrue_exi_iff_PP<span class="main">:</span>
<span class="keyword2"><span class="keyword">assumes</span></span> <span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">φ</span> <span class="main">∈</span> <span class="free">fmla</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="free">Fvars</span> <span class="free">φ</span> <span class="main">=</span> <span class="main">{}</span>"</span></span>
<span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">isTrue</span> <span class="main">(</span>PP <span class="main"><span class="free">⟨</span></span><span class="free">φ</span><span class="main"><span class="free">⟩</span></span><span class="main">)</span> <span class="main">⟷</span> <span class="main">(</span><span class="main">∃</span><span class="bound">n</span><span class="main">∈</span><span class="free">num</span><span class="main">.</span> <span class="free">isTrue</span> <span class="main">(</span>PPf <span class="bound">n</span> <span class="main"><span class="free">⟨</span></span><span class="free">φ</span><span class="main"><span class="free">⟩</span></span><span class="main">)</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">bprv</span> <span class="main">(</span>eqv <span class="main">(</span>PP <span class="main"><span class="free">⟨</span></span><span class="free">φ</span><span class="main"><span class="free">⟩</span></span><span class="main">)</span> <span class="main">(</span><span class="free">exi</span> yy <span class="main">(</span>PPf <span class="main">(</span><span class="free">Var</span> yy<span class="main">)</span> <span class="main"><span class="free">⟨</span></span><span class="free">φ</span><span class="main"><span class="free">⟩</span></span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> PP_PPf_eqv <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="free">bprv</span> <span class="main">(</span><span class="free">imp</span> <span class="main">(</span>PP <span class="main"><span class="free">⟨</span></span><span class="free">φ</span><span class="main"><span class="free">⟩</span></span><span class="main">)</span> <span class="main">(</span><span class="free">exi</span> yy <span class="main">(</span>PPf <span class="main">(</span><span class="free">Var</span> yy<span class="main">)</span> <span class="main"><span class="free">⟨</span></span><span class="free">φ</span><span class="main"><span class="free">⟩</span></span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">bprv</span> <span class="main">(</span><span class="free">imp</span> <span class="main">(</span><span class="free">exi</span> yy <span class="main">(</span>PPf <span class="main">(</span><span class="free">Var</span> yy<span class="main">)</span> <span class="main"><span class="free">⟨</span></span><span class="free">φ</span><span class="main"><span class="free">⟩</span></span><span class="main">)</span><span class="main">)</span> <span class="main">(</span>PP <span class="main"><span class="free">⟨</span></span><span class="free">φ</span><span class="main"><span class="free">⟩</span></span><span class="main">)</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp_all</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> B.prv_imp_eqvEL B.prv_imp_eqvER<span class="main">)</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">unfolding</span></span> isTrue_exi_iff<span class="main">[</span><span class="operator">OF</span> assms<span class="main">,</span> <span class="operator">symmetric</span><span class="main">]</span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">intro</span> iffI<span class="main">)</span> <span class="main">(</span><span class="operator">rule</span> B.prv_imp_implies_isTrue<span class="main"><span class="keyword3">;</span></span> <span class="operator">simp</span><span class="main">)</span><span class="main"><span class="keyword3">+</span></span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">lemma</span></span> bprv_compl_isTrue_PP_enc<span class="main">:</span>
<span class="keyword2"><span class="keyword">assumes</span></span> 1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">φ</span> <span class="main">∈</span> <span class="free">fmla</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="free">Fvars</span> <span class="free">φ</span> <span class="main">=</span> <span class="main">{}</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> 2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">isTrue</span> <span class="main">(</span>PP <span class="main"><span class="free">⟨</span></span><span class="free">φ</span><span class="main"><span class="free">⟩</span></span><span class="main">)</span>"</span></span>
<span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">bprv</span> <span class="main">(</span>PP <span class="main"><span class="free">⟨</span></span><span class="free">φ</span><span class="main"><span class="free">⟩</span></span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
  <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">n</span></span> <span class="keyword2"><span class="keyword">where</span></span> nn<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">n</span> <span class="main">∈</span> <span class="free">num</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> i<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">isTrue</span> <span class="main">(</span>PPf <span class="skolem">n</span> <span class="main"><span class="free">⟨</span></span><span class="free">φ</span><span class="main"><span class="free">⟩</span></span><span class="main">)</span>"</span></span>
   <span class="keyword1"><span class="command">using</span></span> 2 <span class="keyword1"><span class="command">unfolding</span></span> isTrue_exi_iff_PP<span class="main">[</span><span class="operator">OF</span> 1<span class="main">]</span> <span class="keyword1"><span class="command">..</span></span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="free">bprv</span> <span class="main">(</span>PPf <span class="skolem">n</span> <span class="main"><span class="free">⟨</span></span><span class="free">φ</span><span class="main"><span class="free">⟩</span></span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> i <span class="keyword1"><span class="command">using</span></span> nn assms isTrue_iff_bprv_PPf <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="free">bprv</span> <span class="main">(</span><span class="free">exi</span> yy <span class="main">(</span>PPf <span class="main">(</span><span class="free">Var</span> yy<span class="main">)</span> <span class="main"><span class="free">⟨</span></span><span class="free">φ</span><span class="main"><span class="free">⟩</span></span><span class="main">)</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> 2 assms isTrue_exi_iff isTrue_exi_iff_PP prv_exi_PPf_iff_isTrue <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> PP_PPf 1 <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">lemma</span></span> TIP<span class="main">:</span>
<span class="keyword2"><span class="keyword">assumes</span></span> 1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">φ</span> <span class="main">∈</span> <span class="free">fmla</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="free">Fvars</span> <span class="free">φ</span> <span class="main">=</span> <span class="main">{}</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> 2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">isTrue</span> <span class="main">(</span>PP <span class="main"><span class="free">⟨</span></span><span class="free">φ</span><span class="main"><span class="free">⟩</span></span><span class="main">)</span>"</span></span>
<span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">prv</span> <span class="free">φ</span>"</span></span>
<span class="keyword1"><span class="command">using</span></span> bprv_compl_isTrue_PP_enc<span class="main">[</span><span class="operator">OF</span> assms<span class="main">]</span> HBL1_iff assms <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>


<span class="keyword2"><span class="keyword">end</span></span> <span class="comment1">― ‹context <span class="antiquoted"><span class="antiquote">@{</span><span class="operator">locale</span> Minimal_Truth_Soundness_HBL1iff_Compl_Pf<span class="antiquote">}</span></span>›</span>


<span class="keyword1"><span class="command">locale</span></span> Minimal_Truth_Soundness_HBL1iff_Compl_Pf_Compl_NegPf <span class="main">=</span>
Minimal_Truth_Soundness_HBL1iff_Compl_Pf
<span class="main">+</span>
<span class="keyword2"><span class="keyword">assumes</span></span>
Compl_NegPf<span class="main">:</span>
<span class="quoted"><span class="quoted">"<span class="main">⋀</span> <span class="bound">n</span> <span class="bound">φ</span><span class="main">.</span> <span class="bound">n</span> <span class="main">∈</span> <span class="free">num</span> <span class="main">⟹</span> <span class="bound">φ</span> <span class="main">∈</span> <span class="free">fmla</span> <span class="main">⟹</span> <span class="free">Fvars</span> <span class="bound">φ</span> <span class="main">=</span> <span class="main">{}</span> <span class="main">⟹</span>
 <span class="keyword1">let</span> <span class="bound">PPf</span> <span class="main">=</span> <span class="main">(</span><span class="main">λ</span> <span class="bound">t1</span> <span class="bound">t2</span><span class="main">.</span> psubst <span class="free">Pf</span> <span class="main">[</span><span class="main">(</span><span class="bound">t1</span><span class="main">,</span>yy<span class="main">)</span><span class="main">,</span> <span class="main">(</span><span class="bound">t2</span><span class="main">,</span>xx<span class="main">)</span><span class="main">]</span><span class="main">)</span> <span class="keyword1">in</span>
 <span class="free">isTrue</span> <span class="main">(</span>B.neg <span class="main">(</span><span class="bound">PPf</span> <span class="bound">n</span> <span class="main"><span class="free">⟨</span></span><span class="bound">φ</span><span class="main"><span class="free">⟩</span></span><span class="main">)</span><span class="main">)</span> <span class="main">⟶</span> <span class="free">bprv</span> <span class="main">(</span>B.neg <span class="main">(</span><span class="bound">PPf</span> <span class="bound">n</span> <span class="main"><span class="free">⟨</span></span><span class="bound">φ</span><span class="main"><span class="free">⟩</span></span><span class="main">)</span><span class="main">)</span>"</span></span>
<span class="keyword2"><span class="keyword">begin</span></span>

<span class="keyword1"><span class="command">lemma</span></span> isTrue_implies_prv_neg_PPf<span class="main">:</span>
<span class="quoted"><span class="quoted">"<span class="main">⋀</span> <span class="bound">n</span> <span class="bound">φ</span><span class="main">.</span> <span class="bound">n</span> <span class="main">∈</span> <span class="free">num</span> <span class="main">⟹</span> <span class="bound">φ</span> <span class="main">∈</span> <span class="free">fmla</span> <span class="main">⟹</span> <span class="free">Fvars</span> <span class="bound">φ</span> <span class="main">=</span> <span class="main">{}</span> <span class="main">⟹</span>
 <span class="free">isTrue</span> <span class="main">(</span>B.neg <span class="main">(</span>PPf <span class="bound">n</span> <span class="main"><span class="free">⟨</span></span><span class="bound">φ</span><span class="main"><span class="free">⟩</span></span><span class="main">)</span><span class="main">)</span> <span class="main">⟹</span> <span class="free">bprv</span> <span class="main">(</span>B.neg <span class="main">(</span>PPf <span class="bound">n</span> <span class="main"><span class="free">⟨</span></span><span class="bound">φ</span><span class="main"><span class="free">⟩</span></span><span class="main">)</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> Compl_NegPf <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> PPf_def<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> isTrue_iff_prv_neg_PPf<span class="main">:</span>
<span class="quoted"><span class="quoted">"<span class="main">⋀</span> <span class="bound">n</span> <span class="bound">φ</span><span class="main">.</span> <span class="bound">n</span> <span class="main">∈</span> <span class="free">num</span> <span class="main">⟹</span> <span class="bound">φ</span> <span class="main">∈</span> <span class="free">fmla</span> <span class="main">⟹</span> <span class="free">Fvars</span> <span class="bound">φ</span> <span class="main">=</span> <span class="main">{}</span> <span class="main">⟹</span> <span class="free">isTrue</span> <span class="main">(</span>B.neg <span class="main">(</span>PPf <span class="bound">n</span> <span class="main"><span class="free">⟨</span></span><span class="bound">φ</span><span class="main"><span class="free">⟩</span></span><span class="main">)</span><span class="main">)</span> <span class="main">⟷</span> <span class="free">bprv</span> <span class="main">(</span>B.neg <span class="main">(</span>PPf <span class="bound">n</span> <span class="main"><span class="free">⟨</span></span><span class="bound">φ</span><span class="main"><span class="free">⟩</span></span><span class="main">)</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">using</span></span> isTrue_implies_prv_neg_PPf
  <span class="keyword1"><span class="command">using</span></span> exists_no_Fvars B.not_isTrue_fls B.sound_isTrue <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">lemma</span></span> prv_PPf_decide<span class="main">:</span>
<span class="keyword2"><span class="keyword">assumes</span></span> <span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">n</span> <span class="main">∈</span> <span class="free">num</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="free">φ</span> <span class="main">∈</span> <span class="free">fmla</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="free">Fvars</span> <span class="free">φ</span> <span class="main">=</span> <span class="main">{}</span>"</span></span>
<span class="keyword2"><span class="keyword">and</span></span> np<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> <span class="free">bprv</span> <span class="main">(</span>PPf <span class="free">n</span> <span class="main"><span class="free">⟨</span></span><span class="free">φ</span><span class="main"><span class="free">⟩</span></span><span class="main">)</span>"</span></span>
<span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">bprv</span> <span class="main">(</span>B.neg <span class="main">(</span>PPf <span class="free">n</span> <span class="main"><span class="free">⟨</span></span><span class="free">φ</span><span class="main"><span class="free">⟩</span></span><span class="main">)</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> <span class="free">isTrue</span> <span class="main">(</span>PPf <span class="free">n</span> <span class="main"><span class="free">⟨</span></span><span class="free">φ</span><span class="main"><span class="free">⟩</span></span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> isTrue_iff_bprv_PPf<span class="main">)</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="free">isTrue</span> <span class="main">(</span>B.neg <span class="main">(</span>PPf <span class="free">n</span> <span class="main"><span class="free">⟨</span></span><span class="free">φ</span><span class="main"><span class="free">⟩</span></span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> B.isTrue_neg<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="quoted">"PPf <span class="free">n</span> <span class="main"><span class="free">⟨</span></span><span class="free">φ</span><span class="main"><span class="free">⟩</span></span>"</span></span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> isTrue_iff_prv_neg_PPf<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">lemma</span></span> not_prfOf_prv_neg_Pf<span class="main">:</span>
<span class="keyword2"><span class="keyword">assumes</span></span> nφ<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">n</span> <span class="main">∈</span> <span class="free">num</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="free">φ</span> <span class="main">∈</span> <span class="free">fmla</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="free">Fvars</span> <span class="free">φ</span> <span class="main">=</span> <span class="main">{}</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> prfOf <span class="free">n</span> <span class="free">φ</span>"</span></span>
<span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">bprv</span> <span class="main">(</span>B.neg <span class="main">(</span>psubst <span class="free">Pf</span> <span class="main">[</span><span class="main">(</span><span class="free">n</span><span class="main">,</span> yy<span class="main">)</span><span class="main">,</span> <span class="main">(</span><span class="main"><span class="free">⟨</span></span><span class="free">φ</span><span class="main"><span class="free">⟩</span></span><span class="main">,</span> xx<span class="main">)</span><span class="main">]</span><span class="main">)</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> assms prv_PPf_decide<span class="main">[</span><span class="operator">OF</span> nφ<span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> prfOf_def PPf_def2 psubst_eq_rawpsubst2<span class="main">)</span>

<span class="keyword2"><span class="keyword">end</span></span> <span class="comment1">― ‹context <span class="antiquoted"><span class="antiquote">@{</span><span class="operator">locale</span> Minimal_Truth_Soundness_HBL1iff_Compl_Pf_Compl_NegPf<span class="antiquote">}</span></span>›</span>

<span class="keyword1"><span class="command">sublocale</span></span> Minimal_Truth_Soundness_HBL1iff_Compl_Pf_Compl_NegPf <span class="main">&lt;</span>
   repr<span class="main">:</span> CleanRepr_Proofs
<span class="comment1">(* added label to avoid duplicated constant P, which is assumed
in Minimal_Truth_Soundness_HBL1iff_Compl_Pf but defined in CleanRepr_Proofs
(they are of course extensionally equal).
*)</span>
  <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted">"proof"</span> <span class="main">=</span> <span class="quoted"><span class="quoted">"proof"</span></span> <span class="keyword2"><span class="keyword">and</span></span> prfOf <span class="main">=</span> <span class="quoted">prfOf</span> <span class="keyword2"><span class="keyword">and</span></span> encPf <span class="main">=</span> <span class="quoted">encPf</span>
  <span class="keyword1"><span class="command">by</span></span> <span class="operator">standard</span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> bprv_prv prv_prfOf prfOf_prv_Pf not_prfOf_prv_neg_Pf<span class="main">)</span>

<span class="comment1">(* Lemma 6 ("proof recovery") from the JAR paper: *)</span>
<span class="keyword1"><span class="command">sublocale</span></span> Minimal_Truth_Soundness_HBL1iff_Compl_Pf_Compl_NegPf <span class="main">&lt;</span>
  min_truth<span class="main">:</span> Minimal_Truth_Soundness_Proof_Repr
<span class="keyword2"><span class="keyword">where</span></span> <span class="quoted">"proof"</span> <span class="main">=</span> <span class="quoted"><span class="quoted">"proof"</span></span> <span class="keyword2"><span class="keyword">and</span></span> prfOf <span class="main">=</span> <span class="quoted">prfOf</span> <span class="keyword2"><span class="keyword">and</span></span> encPf <span class="main">=</span> <span class="quoted">encPf</span>
  <span class="keyword1"><span class="command">by</span></span> <span class="operator">standard</span>



<span class="comment1">(* FOR THE CLASSICAL REASONING VERSION *)</span>

<span class="keyword1"><span class="command">locale</span></span> Minimal_Truth_Soundness_HBL1iff_prv_Compl_Pf <span class="main">=</span>
HBL1
  <span class="quoted"><span class="free">var</span></span> <span class="quoted"><span class="free">trm</span></span> <span class="quoted"><span class="free">fmla</span></span> <span class="quoted"><span class="free">Var</span></span> <span class="quoted"><span class="free">FvarsT</span></span> <span class="quoted"><span class="free">substT</span></span> <span class="quoted"><span class="free">Fvars</span></span> <span class="quoted"><span class="free">subst</span></span>
  <span class="quoted"><span class="free">num</span></span>
  <span class="quoted"><span class="free">eql</span></span> <span class="quoted"><span class="free">cnj</span></span> <span class="quoted"><span class="free">imp</span></span> <span class="quoted"><span class="free">all</span></span> <span class="quoted"><span class="free">exi</span></span>
  <span class="quoted"><span class="free">prv</span></span> <span class="quoted"><span class="free">bprv</span></span>
  <span class="quoted"><span class="free">enc</span></span>
  <span class="quoted"><span class="free">P</span></span>
<span class="main">+</span>
B<span class="main">:</span> Minimal_Truth_Soundness
  <span class="quoted"><span class="free">var</span></span> <span class="quoted"><span class="free">trm</span></span> <span class="quoted"><span class="free">fmla</span></span> <span class="quoted"><span class="free">Var</span></span> <span class="quoted"><span class="free">FvarsT</span></span> <span class="quoted"><span class="free">substT</span></span> <span class="quoted"><span class="free">Fvars</span></span> <span class="quoted"><span class="free">subst</span></span>
  <span class="quoted"><span class="free">eql</span></span> <span class="quoted"><span class="free">cnj</span></span> <span class="quoted"><span class="free">imp</span></span> <span class="quoted"><span class="free">all</span></span> <span class="quoted"><span class="free">exi</span></span>
  <span class="quoted"><span class="free">fls</span></span>
  <span class="quoted"><span class="free">dsj</span></span>
  <span class="quoted"><span class="free">num</span></span>
  <span class="quoted"><span class="free">bprv</span></span>
  <span class="quoted"><span class="free">isTrue</span></span>
<span class="main">+</span>
Deduct_with_False_Disj
  <span class="quoted"><span class="free">var</span></span> <span class="quoted"><span class="free">trm</span></span> <span class="quoted"><span class="free">fmla</span></span> <span class="quoted"><span class="free">Var</span></span> <span class="quoted"><span class="free">FvarsT</span></span> <span class="quoted"><span class="free">substT</span></span> <span class="quoted"><span class="free">Fvars</span></span> <span class="quoted"><span class="free">subst</span></span>
  <span class="quoted"><span class="free">eql</span></span> <span class="quoted"><span class="free">cnj</span></span> <span class="quoted"><span class="free">imp</span></span> <span class="quoted"><span class="free">all</span></span> <span class="quoted"><span class="free">exi</span></span>
  <span class="quoted"><span class="free">fls</span></span>
  <span class="quoted"><span class="free">dsj</span></span>
  <span class="quoted"><span class="free">num</span></span>
  <span class="quoted"><span class="free">prv</span></span>
<span class="keyword2"><span class="keyword">for</span></span>
<span class="free">var</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'var</span> set"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="free">trm</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'trm</span> set"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="free">fmla</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'fmla</span> set"</span></span>
<span class="keyword2"><span class="keyword">and</span></span> <span class="free">Var</span> <span class="free">FvarsT</span> <span class="free">substT</span> <span class="free">Fvars</span> <span class="free">subst</span>
<span class="keyword2"><span class="keyword">and</span></span> <span class="free">eql</span> <span class="free">cnj</span> <span class="free">imp</span> <span class="free">all</span> <span class="free">exi</span>
<span class="keyword2"><span class="keyword">and</span></span> <span class="free">fls</span>
<span class="keyword2"><span class="keyword">and</span></span> <span class="free">dsj</span>
<span class="keyword2"><span class="keyword">and</span></span> <span class="free">num</span>
<span class="keyword2"><span class="keyword">and</span></span> <span class="free">enc</span> <span class="main">(</span><span class="quoted">"<span class="keyword1">⟨</span>_<span class="keyword1">⟩</span>"</span><span class="main">)</span>
<span class="keyword2"><span class="keyword">and</span></span> <span class="free">prv</span> <span class="free">bprv</span>
<span class="keyword2"><span class="keyword">and</span></span> <span class="free">P</span>
<span class="keyword2"><span class="keyword">and</span></span> <span class="free">isTrue</span>
<span class="main">+</span>
<span class="keyword2"><span class="keyword">fixes</span></span> <span class="free">Pf</span> <span class="main">::</span> <span class="tfree"><span class="quoted"><span class="tfree">'fmla</span></span></span>
<span class="keyword2"><span class="keyword">assumes</span></span>
<span class="comment1">(* Pf is a formula with free variables xx yy  *)</span>
Pf<span class="main">[</span><span class="operator">simp</span><span class="main">,</span><span class="operator">intro</span><span class="main"><span class="main">!</span></span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">Pf</span> <span class="main">∈</span> <span class="free">fmla</span>"</span></span>
<span class="keyword2"><span class="keyword">and</span></span>
Fvars_Pf<span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">Fvars</span> <span class="free">Pf</span> <span class="main">=</span> <span class="main">{</span>yy<span class="main">,</span>xx<span class="main">}</span>"</span></span>
<span class="keyword2"><span class="keyword">and</span></span>
<span class="comment1">(* P relates to Pf internally just like a prv and a proofOf would
relate: via an existential *)</span>
P_Pf<span class="main">:</span>
<span class="quoted"><span class="quoted">"<span class="free">φ</span> <span class="main">∈</span> <span class="free">fmla</span> <span class="main">⟹</span>
 <span class="keyword1">let</span> <span class="bound">PPf</span> <span class="main">=</span> <span class="main">(</span><span class="main">λ</span> <span class="bound">t1</span> <span class="bound">t2</span><span class="main">.</span> psubst <span class="free">Pf</span> <span class="main">[</span><span class="main">(</span><span class="bound">t1</span><span class="main">,</span>yy<span class="main">)</span><span class="main">,</span> <span class="main">(</span><span class="bound">t2</span><span class="main">,</span>xx<span class="main">)</span><span class="main">]</span><span class="main">)</span> <span class="keyword1">in</span>
 <span class="free">bprv</span> <span class="main">(</span>eqv <span class="main">(</span><span class="free">subst</span> <span class="free">P</span> <span class="main"><span class="free">⟨</span></span><span class="free">φ</span><span class="main"><span class="free">⟩</span></span> xx<span class="main">)</span> <span class="main">(</span><span class="free">exi</span> yy <span class="main">(</span><span class="bound">PPf</span> <span class="main">(</span><span class="free">Var</span> yy<span class="main">)</span> <span class="main"><span class="free">⟨</span></span><span class="free">φ</span><span class="main"><span class="free">⟩</span></span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span>
<span class="keyword2"><span class="keyword">assumes</span></span>
<span class="comment1">(* We assume, in addition to HBL1, the strong form of HBL1_rev: *)</span>
HBL1_rev_prv<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">⋀</span> <span class="bound">φ</span><span class="main">.</span> <span class="bound">φ</span> <span class="main">∈</span> <span class="free">fmla</span> <span class="main">⟹</span> <span class="free">Fvars</span> <span class="bound">φ</span> <span class="main">=</span> <span class="main">{}</span> <span class="main">⟹</span> <span class="free">prv</span> <span class="main">(</span>PP <span class="main"><span class="free">⟨</span></span><span class="bound">φ</span><span class="main"><span class="free">⟩</span></span><span class="main">)</span> <span class="main">⟹</span> <span class="free">prv</span> <span class="bound">φ</span>"</span></span>
<span class="keyword2"><span class="keyword">and</span></span>
Compl_Pf<span class="main">:</span>
<span class="quoted"><span class="quoted">"<span class="main">⋀</span> <span class="bound">n</span> <span class="bound">φ</span><span class="main">.</span> <span class="bound">n</span> <span class="main">∈</span> <span class="free">num</span> <span class="main">⟹</span> <span class="bound">φ</span> <span class="main">∈</span> <span class="free">fmla</span> <span class="main">⟹</span> <span class="free">Fvars</span> <span class="bound">φ</span> <span class="main">=</span> <span class="main">{}</span> <span class="main">⟹</span>
 <span class="keyword1">let</span> <span class="bound">PPf</span> <span class="main">=</span> <span class="main">(</span><span class="main">λ</span> <span class="bound">t1</span> <span class="bound">t2</span><span class="main">.</span> psubst <span class="free">Pf</span> <span class="main">[</span><span class="main">(</span><span class="bound">t1</span><span class="main">,</span>yy<span class="main">)</span><span class="main">,</span> <span class="main">(</span><span class="bound">t2</span><span class="main">,</span>xx<span class="main">)</span><span class="main">]</span><span class="main">)</span> <span class="keyword1">in</span>
 <span class="free">isTrue</span> <span class="main">(</span><span class="bound">PPf</span> <span class="bound">n</span> <span class="main"><span class="free">⟨</span></span><span class="bound">φ</span><span class="main"><span class="free">⟩</span></span><span class="main">)</span> <span class="main">⟶</span> <span class="free">bprv</span> <span class="main">(</span><span class="bound">PPf</span> <span class="bound">n</span> <span class="main"><span class="free">⟨</span></span><span class="bound">φ</span><span class="main"><span class="free">⟩</span></span><span class="main">)</span>"</span></span>
<span class="keyword2"><span class="keyword">begin</span></span>

<span class="keyword1"><span class="command">lemma</span></span> HBL1_rev<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> f<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">φ</span> <span class="main">∈</span> <span class="free">fmla</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> fv<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">Fvars</span> <span class="free">φ</span> <span class="main">=</span> <span class="main">{}</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> bp<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">bprv</span> <span class="main">(</span>PP <span class="main"><span class="free">⟨</span></span><span class="free">φ</span><span class="main"><span class="free">⟩</span></span><span class="main">)</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">prv</span> <span class="free">φ</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">intro</span><span class="main"><span class="main">!</span></span><span class="main"><span class="main">:</span></span> HBL1_rev_prv bprv_prv<span class="main"><span class="main">[</span></span><span class="operator">OF</span> _ _ bp<span class="main"><span class="main">]</span></span><span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> HBL1_iff<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">φ</span> <span class="main">∈</span> <span class="free">fmla</span> <span class="main">⟹</span> <span class="free">Fvars</span> <span class="free">φ</span> <span class="main">=</span> <span class="main">{}</span> <span class="main">⟹</span> <span class="free">bprv</span> <span class="main">(</span>PP <span class="main"><span class="free">⟨</span></span><span class="free">φ</span><span class="main"><span class="free">⟩</span></span><span class="main">)</span> <span class="main">⟷</span> <span class="free">prv</span> <span class="free">φ</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> HBL1 HBL1_rev <span class="keyword1"><span class="command">unfolding</span></span> PP_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">lemma</span></span> HBL1_iff_prv<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">φ</span> <span class="main">∈</span> <span class="free">fmla</span> <span class="main">⟹</span> <span class="free">Fvars</span> <span class="free">φ</span> <span class="main">=</span> <span class="main">{}</span> <span class="main">⟹</span> <span class="free">prv</span> <span class="main">(</span>PP <span class="main"><span class="free">⟨</span></span><span class="free">φ</span><span class="main"><span class="free">⟩</span></span><span class="main">)</span> <span class="main">⟷</span> <span class="free">prv</span> <span class="free">φ</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">intro</span> iffI bprv_prv<span class="main"><span class="main">[</span></span><span class="operator">OF</span> _ _ HBL1_PP<span class="main"><span class="main">]</span></span><span class="main"><span class="keyword3">,</span></span> <span class="operator">elim</span> HBL1_rev_prv<span class="main"><span class="main">[</span></span><span class="operator">rotated</span> -1<span class="main"><span class="main">]</span></span><span class="main">)</span> <span class="operator">auto</span>

<span class="keyword2"><span class="keyword">end</span></span> <span class="comment1">― ‹context <span class="antiquoted"><span class="antiquote">@{</span><span class="operator">locale</span> Minimal_Truth_Soundness_HBL1iff_prv_Compl_Pf<span class="antiquote">}</span></span>›</span>

<span class="keyword1"><span class="command">sublocale</span></span> Minimal_Truth_Soundness_HBL1iff_prv_Compl_Pf <span class="main">&lt;</span>
  mts_prv_mts<span class="main">:</span> Minimal_Truth_Soundness_HBL1iff_Compl_Pf <span class="keyword2"><span class="keyword">where</span></span> Pf <span class="main">=</span> <span class="quoted"><span class="free">Pf</span></span>
  <span class="keyword1"><span class="command">using</span></span> P_Pf HBL1_rev HBL1_PP Compl_Pf
  <span class="keyword1"><span class="command">by</span></span> <span class="operator">unfold_locales</span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">locale</span></span> Minimal_Truth_Soundness_HBL1iff_prv_Compl_Pf_Classical <span class="main">=</span>
Minimal_Truth_Soundness_HBL1iff_prv_Compl_Pf
<span class="main">+</span>
<span class="keyword2"><span class="keyword">assumes</span></span>
<span class="comment1">― ‹NB: we don't really need to assume classical reasoning (double negation) all throughout,
but only for the provability predicate:›</span>
classical_P<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">⋀</span> <span class="bound">φ</span><span class="main">.</span> <span class="bound">φ</span> <span class="main">∈</span> <span class="free">fmla</span> <span class="main">⟹</span> <span class="free">Fvars</span> <span class="bound">φ</span> <span class="main">=</span> <span class="main">{}</span> <span class="main">⟹</span> <span class="keyword1">let</span> <span class="bound">PP</span> <span class="main">=</span> <span class="main">(</span><span class="main">λ</span><span class="bound">t</span><span class="main">.</span> <span class="free">subst</span> <span class="free">P</span> <span class="bound">t</span> xx<span class="main">)</span> <span class="keyword1">in</span>
  <span class="free">prv</span> <span class="main">(</span>B.neg <span class="main">(</span>B.neg <span class="main">(</span><span class="bound">PP</span> <span class="main"><span class="free">⟨</span></span><span class="bound">φ</span><span class="main"><span class="free">⟩</span></span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">⟹</span> <span class="free">prv</span> <span class="main">(</span>PP <span class="main"><span class="free">⟨</span></span><span class="bound">φ</span><span class="main"><span class="free">⟩</span></span><span class="main">)</span>"</span></span>
<span class="keyword2"><span class="keyword">begin</span></span>

<span class="keyword1"><span class="command">lemma</span></span> classical_PP<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">φ</span> <span class="main">∈</span> <span class="free">fmla</span> <span class="main">⟹</span> <span class="free">Fvars</span> <span class="free">φ</span> <span class="main">=</span> <span class="main">{}</span> <span class="main">⟹</span> <span class="free">prv</span> <span class="main">(</span>B.neg <span class="main">(</span>B.neg <span class="main">(</span>PP <span class="main"><span class="free">⟨</span></span><span class="free">φ</span><span class="main"><span class="free">⟩</span></span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">⟹</span> <span class="free">prv</span> <span class="main">(</span>PP <span class="main"><span class="free">⟨</span></span><span class="free">φ</span><span class="main"><span class="free">⟩</span></span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> classical_P <span class="keyword1"><span class="command">unfolding</span></span> PP_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword2"><span class="keyword">end</span></span> <span class="comment1">― ‹context <span class="antiquoted"><span class="antiquote">@{</span><span class="operator">locale</span> Minimal_Truth_Soundness_HBL1iff_prv_Compl_Pf_Classical<span class="antiquote">}</span></span>›</span>

<span class="comment1">(*&lt;*)</span>
<span class="keyword2"><span class="keyword">end</span></span>
<span class="comment1">(*&gt;*)</span>
</pre>
</div><div id="Abstract_First_Goedel">
<div class="head">
<h1>Theory Abstract_First_Goedel</h1>
</div>
<pre class="source"><span class="keyword1"><span class="command">chapter</span></span> <span class="quoted"><span class="plain_text">‹Abstract Formulations of Gödel's First Incompleteness Theorem›</span></span>

<span class="comment1">(*&lt;*)</span>
<span class="keyword1"><span class="command">theory</span></span> Abstract_First_Goedel <span class="keyword2"><span class="keyword">imports</span></span> <a href="Goedel_Formula.html">Goedel_Formula</a> <a href="Standard_Model_More.html">Standard_Model_More</a>
<span class="keyword2"><span class="keyword">begin</span></span>
<span class="comment1">(*&gt;*)</span>

<span class="keyword1"><span class="command">section</span></span> <span class="quoted"><span class="plain_text">‹Proof-Theoretic Versions of Gödel's First›</span></span>

<span class="keyword1"><span class="command">context</span></span> Goedel_Form
<span class="keyword2"><span class="keyword">begin</span></span>

<span class="keyword1"><span class="command">subsection</span></span> <span class="quoted"><span class="plain_text">‹The easy half›</span></span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹First the "direct", positive formulation:›</span></span>
<span class="keyword1"><span class="command">lemma</span></span> goedel_first_theEasyHalf_pos<span class="main">:</span>
<span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">prv</span> φG"</span></span>   <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">prv</span> <span class="free">fls</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">prv</span> <span class="main">(</span>neg <span class="main">(</span>PP <span class="main"><span class="free">⟨</span></span>φG<span class="main"><span class="free">⟩</span></span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> prv_eqv_prv<span class="main">[</span><span class="operator">OF</span> _ _ assms prv_φG_eqv<span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">moreover</span></span>
  <span class="keyword1"><span class="command">{</span></span><span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">bprv</span> <span class="main">(</span>PP <span class="main"><span class="free">⟨</span></span>φG<span class="main"><span class="free">⟩</span></span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> HBL1<span class="main">[</span><span class="operator">OF</span> φG Fvars_φG assms<span class="main">]</span> <span class="keyword1"><span class="command">unfolding</span></span> PP_def <span class="keyword1"><span class="command">.</span></span>
   <span class="keyword1"><span class="command">from</span></span> bprv_prv<span class="main">[</span><span class="operator">OF</span> _ _ this<span class="main">,</span> <span class="operator">simplified</span><span class="main">]</span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">prv</span> <span class="main">(</span>PP <span class="main"><span class="free">⟨</span></span>φG<span class="main"><span class="free">⟩</span></span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">.</span></span>
  <span class="keyword1"><span class="command">}</span></span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> PP prv_neg_fls <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">meson</span> φG enc in_num<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹... then the more standard contrapositive formulation:›</span></span>
<span class="keyword1"><span class="command">corollary</span></span> goedel_first_theEasyHalf<span class="main">:</span>
<span class="quoted"><span class="quoted">"consistent <span class="main">⟹</span> <span class="main">¬</span> <span class="free">prv</span> φG"</span></span>
<span class="keyword1"><span class="command">using</span></span> goedel_first_theEasyHalf_pos <span class="keyword1"><span class="command">unfolding</span></span> consistent_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword2"><span class="keyword">end</span></span> <span class="comment1">― ‹context <span class="antiquoted"><span class="antiquote">@{</span><span class="operator">locale</span> Goedel_Form<span class="antiquote">}</span></span>›</span>


<span class="keyword1"><span class="command">subsection</span></span> <span class="quoted"><span class="plain_text">‹The hard half›</span></span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹The hard half needs explicit proofs:›</span></span>
<span class="keyword1"><span class="command">context</span></span> Goedel_Form_Proofs <span class="keyword2"><span class="keyword">begin</span></span>

<span class="keyword1"><span class="command">lemma</span></span> goedel_first_theHardHalf<span class="main">:</span>
<span class="keyword2"><span class="keyword">assumes</span></span> oc<span class="main">:</span> <span class="quoted"><span class="quoted">"ωconsistent"</span></span>
<span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> <span class="free">prv</span> <span class="main">(</span>neg φG<span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span>
  <span class="keyword3"><span class="command">assume</span></span> pn<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">prv</span> <span class="main">(</span>neg φG<span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">hence</span></span> pnn<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">prv</span> <span class="main">(</span>neg <span class="main">(</span>neg <span class="main">(</span>wrepr.PP <span class="main"><span class="free">⟨</span></span>φG<span class="main"><span class="free">⟩</span></span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> prv_eqv_imp_transi num wrepr.PP φG fls neg neg_def prv_φG_eqv prv_eqv_sym
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> <span class="main"><span class="main">(</span></span>full_types<span class="main"><span class="main">)</span></span> enc in_num<span class="main">)</span>
  <span class="keyword1"><span class="command">note</span></span> c <span class="main">=</span> ωconsistent_implies_consistent<span class="main">[</span><span class="operator">OF</span> oc<span class="main">]</span>
  <span class="keyword1"><span class="command">have</span></span> np<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> <span class="free">prv</span> φG"</span></span> <span class="keyword1"><span class="command">using</span></span> pn c <span class="keyword1"><span class="command">unfolding</span></span> consistent_def3 <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">p</span> <span class="main">∈</span> <span class="free">num</span><span class="main">.</span> <span class="free">bprv</span> <span class="main">(</span>neg <span class="main">(</span>PPf <span class="bound">p</span> <span class="main"><span class="free">⟨</span></span>φG<span class="main"><span class="free">⟩</span></span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> not_prv_prv_neg_PPf<span class="main">[</span><span class="operator">OF</span> _ _ np<span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">hence</span></span> 0<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">p</span> <span class="main">∈</span> <span class="free">num</span><span class="main">.</span> <span class="free">prv</span> <span class="main">(</span>neg <span class="main">(</span>PPf <span class="bound">p</span> <span class="main"><span class="free">⟨</span></span>φG<span class="main"><span class="free">⟩</span></span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> not_prv_prv_neg_PPf<span class="main">[</span><span class="operator">OF</span> _ _ np<span class="main">]</span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">fastforce</span> <span class="quasi_keyword">intro</span><span class="main"><span class="main">:</span></span> bprv_prv<span class="main">)</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> <span class="free">prv</span> <span class="main">(</span>neg <span class="main">(</span>neg <span class="main">(</span><span class="free">exi</span> yy <span class="main">(</span>PPf <span class="main">(</span><span class="free">Var</span> yy<span class="main">)</span> <span class="main"><span class="free">⟨</span></span>φG<span class="main"><span class="free">⟩</span></span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> 0 oc <span class="keyword1"><span class="command">unfolding</span></span> ωconsistent_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> <span class="free">prv</span> <span class="main">(</span>neg <span class="main">(</span>neg <span class="main">(</span>wrepr.PP <span class="main"><span class="free">⟨</span></span>φG<span class="main"><span class="free">⟩</span></span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">unfolding</span></span> wrepr.PP_def <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">subst</span> P_def<span class="main">)</span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span>  PPf_def2<span class="main">)</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="quoted">False</span> <span class="keyword1"><span class="command">using</span></span> pnn <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">theorem</span></span> goedel_first<span class="main">:</span>
<span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"ωconsistent"</span></span>
<span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> <span class="free">prv</span> φG <span class="main">∧</span> <span class="main">¬</span> <span class="free">prv</span> <span class="main">(</span>neg φG<span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> assms goedel_first_theEasyHalf goedel_first_theHardHalf ωconsistent_implies_consistent <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>

<span class="keyword1"><span class="command">theorem</span></span> goedel_first_ex<span class="main">:</span>
<span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"ωconsistent"</span></span>
<span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span> <span class="bound">φ</span><span class="main">.</span> <span class="bound">φ</span> <span class="main">∈</span> <span class="free">fmla</span> <span class="main">∧</span> <span class="main">¬</span> <span class="free">prv</span> <span class="bound">φ</span> <span class="main">∧</span> <span class="main">¬</span> <span class="free">prv</span> <span class="main">(</span>neg <span class="bound">φ</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> assms goedel_first <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">intro</span> exI<span class="main"><span class="main">[</span></span><span class="operator">of</span> <span class="main"><span class="main">_</span></span> <span class="quoted">φG</span><span class="main"><span class="main">]</span></span><span class="main">)</span> <span class="operator">blast</span>


<span class="keyword2"><span class="keyword">end</span></span> <span class="comment1">― ‹context <span class="antiquoted"><span class="antiquote">@{</span><span class="operator">locale</span> Goedel_Form_Proofs<span class="antiquote">}</span></span>›</span>


<span class="keyword1"><span class="command">section</span></span> <span class="quoted"><span class="plain_text">‹Model-Theoretic Versions of Gödel's First›</span></span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹The model-theoretic twist is that of additionally proving
the truth of Gödel sentences.›</span></span>


<span class="keyword1"><span class="command">subsection</span></span> <span class="quoted"><span class="plain_text">‹First model-theoretic version›</span></span>

<span class="keyword1"><span class="command">locale</span></span> Goedel_Form_Proofs_Minimal_Truth <span class="main">=</span>
Goedel_Form_Proofs
  <span class="quoted"><span class="free">var</span></span> <span class="quoted"><span class="free">trm</span></span> <span class="quoted"><span class="free">fmla</span></span> <span class="quoted"><span class="free">Var</span></span> <span class="quoted"><span class="free">FvarsT</span></span> <span class="quoted"><span class="free">substT</span></span> <span class="quoted"><span class="free">Fvars</span></span> <span class="quoted"><span class="free">subst</span></span>
  <span class="quoted"><span class="free">num</span></span>
  <span class="quoted"><span class="free">eql</span></span> <span class="quoted"><span class="free">cnj</span></span> <span class="quoted"><span class="free">imp</span></span> <span class="quoted"><span class="free">all</span></span> <span class="quoted"><span class="free">exi</span></span>
  <span class="quoted"><span class="free">fls</span></span>
  <span class="quoted"><span class="free">prv</span></span> <span class="quoted"><span class="free">bprv</span></span>
  <span class="quoted"><span class="free">enc</span></span>
  <span class="quoted"><span class="free">S</span></span>
  <span class="quoted"><span class="free">dsj</span></span>
  <span class="quoted"><span class="quoted">"<span class="free">proof</span>"</span></span> <span class="quoted"><span class="free">prfOf</span></span> <span class="quoted"><span class="free">encPf</span></span>
  <span class="quoted"><span class="free">Pf</span></span>
<span class="main">+</span>
Minimal_Truth_Soundness
  <span class="quoted"><span class="free">var</span></span> <span class="quoted"><span class="free">trm</span></span> <span class="quoted"><span class="free">fmla</span></span> <span class="quoted"><span class="free">Var</span></span> <span class="quoted"><span class="free">FvarsT</span></span> <span class="quoted"><span class="free">substT</span></span> <span class="quoted"><span class="free">Fvars</span></span> <span class="quoted"><span class="free">subst</span></span>
  <span class="quoted"><span class="free">eql</span></span> <span class="quoted"><span class="free">cnj</span></span> <span class="quoted"><span class="free">imp</span></span> <span class="quoted"><span class="free">all</span></span> <span class="quoted"><span class="free">exi</span></span>
  <span class="quoted"><span class="free">fls</span></span>
  <span class="quoted"><span class="free">dsj</span></span>
  <span class="quoted"><span class="free">num</span></span>
  <span class="quoted"><span class="free">bprv</span></span>
  <span class="quoted"><span class="free">isTrue</span></span>
<span class="keyword2"><span class="keyword">for</span></span>
<span class="free">var</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'var</span> set"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="free">trm</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'trm</span> set"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="free">fmla</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'fmla</span> set"</span></span>
<span class="keyword2"><span class="keyword">and</span></span> <span class="free">Var</span> <span class="free">FvarsT</span> <span class="free">substT</span> <span class="free">Fvars</span> <span class="free">subst</span>
<span class="keyword2"><span class="keyword">and</span></span> <span class="free">eql</span> <span class="free">cnj</span> <span class="free">imp</span> <span class="free">all</span> <span class="free">exi</span>
<span class="keyword2"><span class="keyword">and</span></span> <span class="free">fls</span>
<span class="keyword2"><span class="keyword">and</span></span> <span class="free">dsj</span>
<span class="keyword2"><span class="keyword">and</span></span> <span class="free">num</span>
<span class="keyword2"><span class="keyword">and</span></span> <span class="free">prv</span> <span class="free">bprv</span>
<span class="keyword2"><span class="keyword">and</span></span> <span class="free">enc</span> <span class="main">(</span><span class="quoted">"<span class="keyword1">⟨</span>_<span class="keyword1">⟩</span>"</span><span class="main">)</span>
<span class="keyword2"><span class="keyword">and</span></span> <span class="free">S</span>
<span class="keyword2"><span class="keyword">and</span></span> <span class="quoted">"<span class="free">proof</span>"</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'proof</span> set"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="free">prfOf</span> <span class="free">encPf</span>
<span class="keyword2"><span class="keyword">and</span></span> <span class="free">Pf</span>
<span class="keyword2"><span class="keyword">and</span></span> <span class="free">isTrue</span>
<span class="keyword2"><span class="keyword">begin</span></span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹Recall that "consistent" and "$\omega$-consistent" refer to <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">term</span></span> <span class="quoted"><span class="free"><span class="quoted"><span class="free">prv</span></span></span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span>, not to <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">term</span></span> <span class="quoted"><span class="free"><span class="quoted"><span class="free">bprv</span></span></span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span>.›</span></span>

<span class="keyword1"><span class="command">theorem</span></span> isTrue_φG<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"consistent"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">isTrue</span> φG"</span></span>
<span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span> <span class="bound">n</span> <span class="main">∈</span> <span class="free">num</span><span class="main">.</span> <span class="free">bprv</span> <span class="main">(</span>neg <span class="main">(</span>PPf <span class="bound">n</span> <span class="main"><span class="free">⟨</span></span>φG<span class="main"><span class="free">⟩</span></span><span class="main">)</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> not_prv_prv_neg_PPf<span class="main">[</span><span class="operator">OF</span> _ _ goedel_first_theEasyHalf<span class="main"><span class="main">[</span></span><span class="operator">OF</span> assms<span class="main"><span class="main">]</span></span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span> <span class="bound">n</span> <span class="main">∈</span> <span class="free">num</span><span class="main">.</span> <span class="free">isTrue</span> <span class="main">(</span>neg <span class="main">(</span>PPf <span class="bound">n</span> <span class="main"><span class="free">⟨</span></span>φG<span class="main"><span class="free">⟩</span></span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">intro</span><span class="main"><span class="main">:</span></span> sound_isTrue<span class="main">)</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="free">isTrue</span> <span class="main">(</span><span class="free">all</span> yy <span class="main">(</span>neg <span class="main">(</span>PPf <span class="main">(</span><span class="free">Var</span> yy<span class="main">)</span> <span class="main"><span class="free">⟨</span></span>φG<span class="main"><span class="free">⟩</span></span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">intro</span><span class="main"><span class="main">:</span></span> isTrue_all<span class="main">)</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">isTrue</span> <span class="main">(</span><span class="free">imp</span> <span class="main">(</span><span class="free">all</span> yy <span class="main">(</span>neg <span class="main">(</span>PPf <span class="main">(</span><span class="free">Var</span> yy<span class="main">)</span> <span class="main"><span class="free">⟨</span></span>φG<span class="main"><span class="free">⟩</span></span><span class="main">)</span><span class="main">)</span><span class="main">)</span> φG<span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> bprv_eqv_all_not_PPf_imp_φG <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">intro</span><span class="main"><span class="main">!</span></span><span class="main"><span class="main">:</span></span> sound_isTrue<span class="main">)</span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> isTrue_imp<span class="main"><span class="main">[</span></span><span class="operator">rotated</span> -2<span class="main"><span class="main">]</span></span><span class="main">)</span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹The "strong" form of Gödel's First (also asserting the truth of
the Gödel sentences):›</span></span>

<span class="keyword1"><span class="command">theorem</span></span> goedel_first_strong<span class="main">:</span>
<span class="quoted"><span class="quoted">"ωconsistent <span class="main">⟹</span> <span class="main">¬</span> <span class="free">prv</span> φG <span class="main">∧</span> <span class="main">¬</span> <span class="free">prv</span> <span class="main">(</span>neg φG<span class="main">)</span> <span class="main">∧</span> <span class="free">isTrue</span> φG"</span></span>
  <span class="keyword1"><span class="command">using</span></span> goedel_first isTrue_φG ωconsistent_implies_consistent <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>

<span class="keyword1"><span class="command">theorem</span></span> goedel_first_strong_ex<span class="main">:</span>
<span class="quoted"><span class="quoted">"ωconsistent <span class="main">⟹</span> <span class="main">∃</span> <span class="bound">φ</span><span class="main">.</span> <span class="bound">φ</span> <span class="main">∈</span> <span class="free">fmla</span> <span class="main">∧</span> <span class="main">¬</span> <span class="free">prv</span> <span class="bound">φ</span> <span class="main">∧</span> <span class="main">¬</span> <span class="free">prv</span> <span class="main">(</span>neg <span class="bound">φ</span><span class="main">)</span> <span class="main">∧</span> <span class="free">isTrue</span> <span class="bound">φ</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> goedel_first_strong <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">intro</span> exI<span class="main"><span class="main">[</span></span><span class="operator">of</span> <span class="main"><span class="main">_</span></span> <span class="quoted">φG</span><span class="main"><span class="main">]</span></span><span class="main">)</span> <span class="operator">blast</span>

<span class="keyword2"><span class="keyword">end</span></span> <span class="comment1">― ‹context <span class="antiquoted"><span class="antiquote">@{</span><span class="operator">locale</span> Goedel_Form_Proofs_Minimal_Truth<span class="antiquote">}</span></span>›</span>


<span class="keyword1"><span class="command">subsection</span></span> <span class="quoted"><span class="plain_text">‹Second model-theoretic version›</span></span>

<span class="keyword1"><span class="command">locale</span></span> Goedel_Form_Minimal_Truth_Soundness_HBL1iff_Compl_Pf <span class="main">=</span>
Goedel_Form
  <span class="quoted"><span class="free">var</span></span> <span class="quoted"><span class="free">trm</span></span> <span class="quoted"><span class="free">fmla</span></span> <span class="quoted"><span class="free">Var</span></span> <span class="quoted"><span class="free">num</span></span>
  <span class="quoted"><span class="free">FvarsT</span></span> <span class="quoted"><span class="free">substT</span></span> <span class="quoted"><span class="free">Fvars</span></span> <span class="quoted"><span class="free">subst</span></span>
  <span class="quoted"><span class="free">eql</span></span> <span class="quoted"><span class="free">cnj</span></span> <span class="quoted"><span class="free">imp</span></span> <span class="quoted"><span class="free">all</span></span> <span class="quoted"><span class="free">exi</span></span>
  <span class="quoted"><span class="free">fls</span></span>
  <span class="quoted"><span class="free">prv</span></span> <span class="quoted"><span class="free">bprv</span></span>
  <span class="quoted"><span class="free">enc</span></span>
  <span class="quoted"><span class="free">S</span></span>
  <span class="quoted"><span class="free">P</span></span>
<span class="main">+</span>
Minimal_Truth_Soundness_HBL1iff_Compl_Pf
  <span class="quoted"><span class="free">var</span></span> <span class="quoted"><span class="free">trm</span></span> <span class="quoted"><span class="free">fmla</span></span> <span class="quoted"><span class="free">Var</span></span> <span class="quoted"><span class="free">FvarsT</span></span> <span class="quoted"><span class="free">substT</span></span> <span class="quoted"><span class="free">Fvars</span></span> <span class="quoted"><span class="free">subst</span></span>
  <span class="quoted"><span class="free">eql</span></span> <span class="quoted"><span class="free">cnj</span></span> <span class="quoted"><span class="free">imp</span></span> <span class="quoted"><span class="free">all</span></span> <span class="quoted"><span class="free">exi</span></span>
  <span class="quoted"><span class="free">fls</span></span>
  <span class="quoted"><span class="free">dsj</span></span>
  <span class="quoted"><span class="free">num</span></span>
  <span class="quoted"><span class="free">enc</span></span>
  <span class="quoted"><span class="free">prv</span></span> <span class="quoted"><span class="free">bprv</span></span>
  <span class="quoted"><span class="free">P</span></span>
  <span class="quoted"><span class="free">isTrue</span></span>
  <span class="quoted"><span class="free">Pf</span></span>
<span class="keyword2"><span class="keyword">for</span></span>
<span class="free">var</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'var</span> set"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="free">trm</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'trm</span> set"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="free">fmla</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'fmla</span> set"</span></span>
<span class="keyword2"><span class="keyword">and</span></span> <span class="free">Var</span> <span class="free">FvarsT</span> <span class="free">substT</span> <span class="free">Fvars</span> <span class="free">subst</span>
<span class="keyword2"><span class="keyword">and</span></span> <span class="free">eql</span> <span class="free">cnj</span> <span class="free">imp</span> <span class="free">all</span> <span class="free">exi</span>
<span class="keyword2"><span class="keyword">and</span></span> <span class="free">fls</span>
<span class="keyword2"><span class="keyword">and</span></span> <span class="free">dsj</span>
<span class="keyword2"><span class="keyword">and</span></span> <span class="free">num</span>
<span class="keyword2"><span class="keyword">and</span></span> <span class="free">prv</span> <span class="free">bprv</span>
<span class="keyword2"><span class="keyword">and</span></span> <span class="free">enc</span> <span class="main">(</span><span class="quoted">"<span class="keyword1">⟨</span>_<span class="keyword1">⟩</span>"</span><span class="main">)</span>
<span class="keyword2"><span class="keyword">and</span></span> <span class="free">S</span>
<span class="keyword2"><span class="keyword">and</span></span> <span class="free">isTrue</span>
<span class="keyword2"><span class="keyword">and</span></span> <span class="free">P</span>
<span class="keyword2"><span class="keyword">and</span></span> <span class="free">Pf</span>


<span class="keyword1"><span class="command">locale</span></span> Goedel_Form_Minimal_Truth_Soundness_HBL1iff_Compl_Pf_Compl_NegPf <span class="main">=</span>
Goedel_Form_Minimal_Truth_Soundness_HBL1iff_Compl_Pf
  <span class="quoted"><span class="free">var</span></span> <span class="quoted"><span class="free">trm</span></span> <span class="quoted"><span class="free">fmla</span></span> <span class="quoted"><span class="free">Var</span></span> <span class="quoted"><span class="free">FvarsT</span></span> <span class="quoted"><span class="free">substT</span></span> <span class="quoted"><span class="free">Fvars</span></span> <span class="quoted"><span class="free">subst</span></span>
  <span class="quoted"><span class="free">eql</span></span> <span class="quoted"><span class="free">cnj</span></span> <span class="quoted"><span class="free">imp</span></span> <span class="quoted"><span class="free">all</span></span> <span class="quoted"><span class="free">exi</span></span>
  <span class="quoted"><span class="free">fls</span></span>
  <span class="quoted"><span class="free">dsj</span></span>
  <span class="quoted"><span class="free">num</span></span>
  <span class="quoted"><span class="free">prv</span></span> <span class="quoted"><span class="free">bprv</span></span>
  <span class="quoted"><span class="free">enc</span></span>
  <span class="quoted"><span class="free">S</span></span>
  <span class="quoted"><span class="free">isTrue</span></span>
  <span class="quoted"><span class="free">P</span></span>
  <span class="quoted"><span class="free">Pf</span></span>
<span class="main">+</span>
Minimal_Truth_Soundness_HBL1iff_Compl_Pf_Compl_NegPf
  <span class="quoted"><span class="free">var</span></span> <span class="quoted"><span class="free">trm</span></span> <span class="quoted"><span class="free">fmla</span></span> <span class="quoted"><span class="free">Var</span></span> <span class="quoted"><span class="free">FvarsT</span></span> <span class="quoted"><span class="free">substT</span></span> <span class="quoted"><span class="free">Fvars</span></span> <span class="quoted"><span class="free">subst</span></span>
  <span class="quoted"><span class="free">eql</span></span> <span class="quoted"><span class="free">cnj</span></span> <span class="quoted"><span class="free">imp</span></span> <span class="quoted"><span class="free">all</span></span> <span class="quoted"><span class="free">exi</span></span>
  <span class="quoted"><span class="free">fls</span></span>
  <span class="quoted"><span class="free">dsj</span></span>
  <span class="quoted"><span class="free">num</span></span>
  <span class="quoted"><span class="free">enc</span></span>
  <span class="quoted"><span class="free">prv</span></span> <span class="quoted"><span class="free">bprv</span></span>
  <span class="quoted"><span class="free">P</span></span>
  <span class="quoted"><span class="free">isTrue</span></span>
  <span class="quoted"><span class="free">Pf</span></span>
<span class="keyword2"><span class="keyword">for</span></span>
<span class="free">var</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'var</span> set"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="free">trm</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'trm</span> set"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="free">fmla</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'fmla</span> set"</span></span>
<span class="keyword2"><span class="keyword">and</span></span> <span class="free">Var</span> <span class="free">FvarsT</span> <span class="free">substT</span> <span class="free">Fvars</span> <span class="free">subst</span>
<span class="keyword2"><span class="keyword">and</span></span> <span class="free">eql</span> <span class="free">cnj</span> <span class="free">imp</span> <span class="free">all</span> <span class="free">exi</span>
<span class="keyword2"><span class="keyword">and</span></span> <span class="free">fls</span>
<span class="keyword2"><span class="keyword">and</span></span> <span class="free">dsj</span>
<span class="keyword2"><span class="keyword">and</span></span> <span class="free">num</span>
<span class="keyword2"><span class="keyword">and</span></span> <span class="free">prv</span> <span class="free">bprv</span>
<span class="keyword2"><span class="keyword">and</span></span> <span class="free">enc</span> <span class="main">(</span><span class="quoted">"<span class="keyword1">⟨</span>_<span class="keyword1">⟩</span>"</span><span class="main">)</span>
<span class="keyword2"><span class="keyword">and</span></span> <span class="free">S</span>
<span class="keyword2"><span class="keyword">and</span></span> <span class="free">isTrue</span>
<span class="keyword2"><span class="keyword">and</span></span> <span class="free">P</span>
<span class="keyword2"><span class="keyword">and</span></span> <span class="free">Pf</span>
<span class="main">+</span>
<span class="keyword2"><span class="keyword">assumes</span></span> prv_ωconsistent<span class="main">:</span> <span class="quoted"><span class="quoted">"ωconsistent"</span></span>

<span class="comment1">(* Semantic Goedel's first, Goedel-style, second variant
... established as a sublocale statement *)</span>
<span class="keyword1"><span class="command">sublocale</span></span>
  Goedel_Form_Minimal_Truth_Soundness_HBL1iff_Compl_Pf_Compl_NegPf <span class="main">&lt;</span>
  recover_proofs<span class="main">:</span> Goedel_Form_Proofs_Minimal_Truth
  <span class="keyword2"><span class="keyword">where</span></span> prfOf <span class="main">=</span> <span class="quoted">prfOf</span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted">"proof"</span> <span class="main">=</span> <span class="quoted"><span class="quoted">"proof"</span></span> <span class="keyword2"><span class="keyword">and</span></span> encPf <span class="main">=</span> <span class="quoted">encPf</span>
  <span class="keyword2"><span class="keyword">and</span></span> prv <span class="main">=</span> <span class="quoted"><span class="free">prv</span></span> <span class="keyword2"><span class="keyword">and</span></span> bprv <span class="main">=</span> <span class="quoted"><span class="free">bprv</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="operator">standard</span>

<span class="comment1">(* ... and here is the explicit statement, inside the locale that
provides all the assumptions *)</span>
<span class="keyword1"><span class="command">context</span></span> Goedel_Form_Minimal_Truth_Soundness_HBL1iff_Compl_Pf_Compl_NegPf <span class="keyword2"><span class="keyword">begin</span></span>
<span class="keyword1"><span class="command">thm</span></span> recover_proofs.goedel_first_strong

<span class="keyword2"><span class="keyword">end</span></span>


<span class="keyword1"><span class="command">section</span></span> <span class="quoted"><span class="plain_text">‹Classical-Logic Versions of Gödel's First›</span></span>


<span class="keyword1"><span class="command">subsection</span></span> <span class="quoted"><span class="plain_text">‹First classical-logic version›</span></span>

<span class="keyword1"><span class="command">locale</span></span> Goedel_Form_Classical_HBL1_rev_prv <span class="main">=</span>
Goedel_Form
  <span class="quoted"><span class="free">var</span></span> <span class="quoted"><span class="free">trm</span></span> <span class="quoted"><span class="free">fmla</span></span> <span class="quoted"><span class="free">Var</span></span> <span class="quoted"><span class="free">num</span></span> <span class="quoted"><span class="free">FvarsT</span></span> <span class="quoted"><span class="free">substT</span></span> <span class="quoted"><span class="free">Fvars</span></span> <span class="quoted"><span class="free">subst</span></span>
  <span class="quoted"><span class="free">eql</span></span> <span class="quoted"><span class="free">cnj</span></span> <span class="quoted"><span class="free">imp</span></span> <span class="quoted"><span class="free">all</span></span> <span class="quoted"><span class="free">exi</span></span>
  <span class="quoted"><span class="free">fls</span></span>
  <span class="quoted"><span class="free">prv</span></span> <span class="quoted"><span class="free">bprv</span></span>
  <span class="quoted"><span class="free">enc</span></span>
  <span class="quoted"><span class="free">S</span></span>
  <span class="quoted"><span class="free">P</span></span>
<span class="keyword2"><span class="keyword">for</span></span>
<span class="free">var</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'var</span> set"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="free">trm</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'trm</span> set"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="free">fmla</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'fmla</span> set"</span></span>
<span class="keyword2"><span class="keyword">and</span></span> <span class="free">Var</span> <span class="free">num</span> <span class="free">FvarsT</span> <span class="free">substT</span> <span class="free">Fvars</span> <span class="free">subst</span>
<span class="keyword2"><span class="keyword">and</span></span> <span class="free">eql</span> <span class="free">cnj</span> <span class="free">imp</span> <span class="free">all</span> <span class="free">exi</span>
<span class="keyword2"><span class="keyword">and</span></span> <span class="free">fls</span>
<span class="keyword2"><span class="keyword">and</span></span> <span class="free">prv</span> <span class="free">bprv</span>
<span class="keyword2"><span class="keyword">and</span></span> <span class="free">enc</span> <span class="main">(</span><span class="quoted">"<span class="keyword1">⟨</span>_<span class="keyword1">⟩</span>"</span><span class="main">)</span>
<span class="keyword2"><span class="keyword">and</span></span> <span class="free">S</span>
<span class="keyword2"><span class="keyword">and</span></span> <span class="free">P</span>
<span class="main">+</span>
<span class="keyword2"><span class="keyword">assumes</span></span>
<span class="comment1">― ‹NB: we don't really need to assume classical reasoning (double negation)
for all formulas, but only for the provability predicate:›</span>
classical_P_prv<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">⋀</span> <span class="bound">φ</span><span class="main">.</span> <span class="bound">φ</span> <span class="main">∈</span> <span class="free">fmla</span> <span class="main">⟹</span> <span class="free">Fvars</span> <span class="bound">φ</span> <span class="main">=</span> <span class="main">{}</span> <span class="main">⟹</span> <span class="keyword1">let</span> <span class="bound">PP</span> <span class="main">=</span> <span class="main">(</span><span class="main">λ</span><span class="bound">t</span><span class="main">.</span> <span class="free">subst</span> <span class="free">P</span> <span class="bound">t</span> xx<span class="main">)</span> <span class="keyword1">in</span>
  <span class="free">prv</span> <span class="main">(</span>neg <span class="main">(</span>neg <span class="main">(</span><span class="bound">PP</span> <span class="main"><span class="free">⟨</span></span><span class="bound">φ</span><span class="main"><span class="free">⟩</span></span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">⟹</span> <span class="free">prv</span> <span class="main">(</span>PP <span class="main"><span class="free">⟨</span></span><span class="bound">φ</span><span class="main"><span class="free">⟩</span></span><span class="main">)</span>"</span></span>
<span class="keyword2"><span class="keyword">and</span></span>
HBL1_rev_prv<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">⋀</span> <span class="bound">φ</span><span class="main">.</span> <span class="bound">φ</span> <span class="main">∈</span> <span class="free">fmla</span> <span class="main">⟹</span> <span class="free">Fvars</span> <span class="bound">φ</span> <span class="main">=</span> <span class="main">{}</span> <span class="main">⟹</span> <span class="free">prv</span> <span class="main">(</span>PP <span class="main"><span class="free">⟨</span></span><span class="bound">φ</span><span class="main"><span class="free">⟩</span></span><span class="main">)</span> <span class="main">⟹</span> <span class="free">prv</span> <span class="bound">φ</span>"</span></span>
<span class="keyword2"><span class="keyword">begin</span></span>

<span class="keyword1"><span class="command">lemma</span></span> HBL1_rev<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> f<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">φ</span> <span class="main">∈</span> <span class="free">fmla</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> fv<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">Fvars</span> <span class="free">φ</span> <span class="main">=</span> <span class="main">{}</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> bp<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">bprv</span> <span class="main">(</span>PP <span class="main"><span class="free">⟨</span></span><span class="free">φ</span><span class="main"><span class="free">⟩</span></span><span class="main">)</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">prv</span> <span class="free">φ</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">intro</span><span class="main"><span class="main">!</span></span><span class="main"><span class="main">:</span></span> HBL1_rev_prv bprv_prv<span class="main"><span class="main">[</span></span><span class="operator">OF</span> _ _ bp<span class="main"><span class="main">]</span></span><span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> classical_PP_prv<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">φ</span> <span class="main">∈</span> <span class="free">fmla</span> <span class="main">⟹</span> <span class="free">Fvars</span> <span class="free">φ</span> <span class="main">=</span> <span class="main">{}</span> <span class="main">⟹</span> <span class="free">prv</span> <span class="main">(</span>neg <span class="main">(</span>neg <span class="main">(</span>PP <span class="main"><span class="free">⟨</span></span><span class="free">φ</span><span class="main"><span class="free">⟩</span></span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">⟹</span> <span class="free">prv</span> <span class="main">(</span>PP <span class="main"><span class="free">⟨</span></span><span class="free">φ</span><span class="main"><span class="free">⟩</span></span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> classical_P_prv <span class="keyword1"><span class="command">unfolding</span></span> PP_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">lemma</span></span> HBL1_iff<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">φ</span> <span class="main">∈</span> <span class="free">fmla</span> <span class="main">⟹</span> <span class="free">Fvars</span> <span class="free">φ</span> <span class="main">=</span> <span class="main">{}</span> <span class="main">⟹</span> <span class="free">bprv</span> <span class="main">(</span>PP <span class="main"><span class="free">⟨</span></span><span class="free">φ</span><span class="main"><span class="free">⟩</span></span><span class="main">)</span> <span class="main">⟷</span> <span class="free">prv</span> <span class="free">φ</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> HBL1 HBL1_rev <span class="keyword1"><span class="command">unfolding</span></span> PP_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">lemma</span></span> HBL1_iff_prv<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">φ</span> <span class="main">∈</span> <span class="free">fmla</span> <span class="main">⟹</span> <span class="free">Fvars</span> <span class="free">φ</span> <span class="main">=</span> <span class="main">{}</span> <span class="main">⟹</span> <span class="free">prv</span> <span class="main">(</span>PP <span class="main"><span class="free">⟨</span></span><span class="free">φ</span><span class="main"><span class="free">⟩</span></span><span class="main">)</span> <span class="main">⟷</span> <span class="free">prv</span> <span class="free">φ</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">meson</span> HBL1_PP HBL1_rev_prv PP d_dwf.bprv_prv' enc in_num<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> goedel_first_theHardHalf_pos<span class="main">:</span>
<span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">prv</span> <span class="main">(</span>neg φG<span class="main">)</span>"</span></span>   <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">prv</span> <span class="free">fls</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">prv</span> <span class="main">(</span>neg <span class="main">(</span>neg <span class="main">(</span>PP <span class="main"><span class="free">⟨</span></span>φG<span class="main"><span class="free">⟩</span></span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> assms neg_def prv_φG_eqv prv_eqv_imp_transi_rev <span class="keyword1"><span class="command">by</span></span> <span class="operator">fastforce</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="free">prv</span> <span class="main">(</span>PP <span class="main"><span class="free">⟨</span></span>φG<span class="main"><span class="free">⟩</span></span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> classical_PP_prv <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="free">prv</span> φG"</span></span> <span class="keyword1"><span class="command">using</span></span> Fvars_φG HBL1_rev_prv <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> assms prv_neg_fls <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">corollary</span></span> goedel_first_theHardHalf<span class="main">:</span>
<span class="quoted"><span class="quoted">"consistent <span class="main">⟹</span> <span class="main">¬</span> <span class="free">prv</span> <span class="main">(</span>neg φG<span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> goedel_first_theHardHalf_pos <span class="keyword1"><span class="command">unfolding</span></span> consistent_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">theorem</span></span> goedel_first_classic<span class="main">:</span>
<span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"consistent"</span></span>
<span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> <span class="free">prv</span> φG <span class="main">∧</span> <span class="main">¬</span> <span class="free">prv</span> <span class="main">(</span>neg φG<span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> assms goedel_first_theEasyHalf goedel_first_theHardHalf <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>

<span class="keyword1"><span class="command">theorem</span></span> goedel_first_classic_ex<span class="main">:</span>
<span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"consistent"</span></span>
<span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span> <span class="bound">φ</span><span class="main">.</span> <span class="bound">φ</span> <span class="main">∈</span> <span class="free">fmla</span> <span class="main">∧</span> <span class="main">¬</span> <span class="free">prv</span> <span class="bound">φ</span> <span class="main">∧</span> <span class="main">¬</span> <span class="free">prv</span> <span class="main">(</span>neg <span class="bound">φ</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> assms goedel_first_classic <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">intro</span> exI<span class="main"><span class="main">[</span></span><span class="operator">of</span> <span class="main"><span class="main">_</span></span> <span class="quoted">φG</span><span class="main"><span class="main">]</span></span><span class="main">)</span> <span class="operator">blast</span>

<span class="keyword2"><span class="keyword">end</span></span> <span class="comment1">― ‹context <span class="antiquoted"><span class="antiquote">@{</span><span class="operator">locale</span> Goedel_Form_Classical_HBL1_rev_prv<span class="antiquote">}</span></span>›</span>


<span class="keyword1"><span class="command">subsection</span></span> <span class="quoted"><span class="plain_text">‹Second classical-logic version›</span></span>

<span class="keyword1"><span class="command">locale</span></span> Goedel_Form_Classical_HBL1_rev_prv_Minimal_Truth_Soundness_TIP <span class="main">=</span>
Goedel_Form_Classical_HBL1_rev_prv
  <span class="quoted"><span class="free">var</span></span> <span class="quoted"><span class="free">trm</span></span> <span class="quoted"><span class="free">fmla</span></span> <span class="quoted"><span class="free">Var</span></span> <span class="quoted"><span class="free">num</span></span> <span class="quoted"><span class="free">FvarsT</span></span> <span class="quoted"><span class="free">substT</span></span> <span class="quoted"><span class="free">Fvars</span></span> <span class="quoted"><span class="free">subst</span></span>
  <span class="quoted"><span class="free">eql</span></span> <span class="quoted"><span class="free">cnj</span></span> <span class="quoted"><span class="free">imp</span></span> <span class="quoted"><span class="free">all</span></span> <span class="quoted"><span class="free">exi</span></span>
  <span class="quoted"><span class="free">fls</span></span>
  <span class="quoted"><span class="free">prv</span></span> <span class="quoted"><span class="free">bprv</span></span>
  <span class="quoted"><span class="free">enc</span></span>
  <span class="quoted"><span class="free">S</span></span>
  <span class="quoted"><span class="free">P</span></span>
<span class="main">+</span>
Minimal_Truth_Soundness
  <span class="quoted"><span class="free">var</span></span> <span class="quoted"><span class="free">trm</span></span> <span class="quoted"><span class="free">fmla</span></span> <span class="quoted"><span class="free">Var</span></span> <span class="quoted"><span class="free">FvarsT</span></span> <span class="quoted"><span class="free">substT</span></span> <span class="quoted"><span class="free">Fvars</span></span> <span class="quoted"><span class="free">subst</span></span>
  <span class="quoted"><span class="free">eql</span></span> <span class="quoted"><span class="free">cnj</span></span> <span class="quoted"><span class="free">imp</span></span> <span class="quoted"><span class="free">all</span></span> <span class="quoted"><span class="free">exi</span></span>
  <span class="quoted"><span class="free">fls</span></span>
  <span class="quoted"><span class="free">dsj</span></span>
  <span class="quoted"><span class="free">num</span></span>
  <span class="quoted"><span class="free">bprv</span></span>
  <span class="quoted"><span class="free">isTrue</span></span>
<span class="keyword2"><span class="keyword">for</span></span>
<span class="free">var</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'var</span> set"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="free">trm</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'trm</span> set"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="free">fmla</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'fmla</span> set"</span></span>
<span class="keyword2"><span class="keyword">and</span></span> <span class="free">Var</span> <span class="free">num</span> <span class="free">FvarsT</span> <span class="free">substT</span> <span class="free">Fvars</span> <span class="free">subst</span>
<span class="keyword2"><span class="keyword">and</span></span> <span class="free">eql</span> <span class="free">cnj</span> <span class="free">dsj</span> <span class="free">imp</span> <span class="free">all</span> <span class="free">exi</span>
<span class="keyword2"><span class="keyword">and</span></span> <span class="free">fls</span>
<span class="keyword2"><span class="keyword">and</span></span> <span class="free">prv</span> <span class="free">bprv</span>
<span class="keyword2"><span class="keyword">and</span></span> <span class="free">enc</span> <span class="main">(</span><span class="quoted">"<span class="keyword1">⟨</span>_<span class="keyword1">⟩</span>"</span><span class="main">)</span>
<span class="keyword2"><span class="keyword">and</span></span> <span class="free">S</span>
<span class="keyword2"><span class="keyword">and</span></span> <span class="free">P</span>
<span class="keyword2"><span class="keyword">and</span></span> <span class="free">isTrue</span>
<span class="main">+</span>
<span class="keyword2"><span class="keyword">assumes</span></span>
<span class="comment1">―‹Truth of <span class="antiquoted"><span class="antiquote">@{</span><span class="operator">term</span> <span class="quoted"><span class="free">φ</span></span><span class="antiquote">}</span></span> implies provability (TIP) of (the internal representation of) <span class="antiquoted"><span class="antiquote">@{</span><span class="operator">term</span> <span class="quoted"><span class="free">φ</span></span><span class="antiquote">}</span></span>›</span>
TIP<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">⋀</span> <span class="bound">φ</span><span class="main">.</span> <span class="bound">φ</span> <span class="main">∈</span> <span class="free">fmla</span> <span class="main">⟹</span> <span class="free">Fvars</span> <span class="bound">φ</span> <span class="main">=</span> <span class="main">{}</span> <span class="main">⟹</span>
  <span class="keyword1">let</span> <span class="bound">PP</span> <span class="main">=</span> <span class="main">(</span><span class="main">λ</span><span class="bound">t</span><span class="main">.</span> <span class="free">subst</span> <span class="free">P</span> <span class="bound">t</span> xx<span class="main">)</span> <span class="keyword1">in</span>
  <span class="free">isTrue</span> <span class="main">(</span><span class="bound">PP</span> <span class="main"><span class="free">⟨</span></span><span class="bound">φ</span><span class="main"><span class="free">⟩</span></span><span class="main">)</span> <span class="main">⟹</span> <span class="free">prv</span> <span class="bound">φ</span>"</span></span>
<span class="keyword2"><span class="keyword">begin</span></span>

<span class="keyword1"><span class="command">lemma</span></span> TIP_PP<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">φ</span> <span class="main">∈</span> <span class="free">fmla</span> <span class="main">⟹</span> <span class="free">Fvars</span> <span class="free">φ</span> <span class="main">=</span> <span class="main">{}</span> <span class="main">⟹</span> <span class="free">isTrue</span> <span class="main">(</span>PP <span class="main"><span class="free">⟨</span></span><span class="free">φ</span><span class="main"><span class="free">⟩</span></span><span class="main">)</span> <span class="main">⟹</span> <span class="free">prv</span> <span class="free">φ</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> TIP <span class="keyword1"><span class="command">unfolding</span></span> PP_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">theorem</span></span> isTrue_φG<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted">consistent</span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">isTrue</span> φG"</span></span>
<span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
  <span class="keyword1"><span class="command">{</span></span><span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> <span class="free">isTrue</span> φG"</span></span>
   <span class="keyword1"><span class="command">hence</span></span> 1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">isTrue</span> <span class="main">(</span>neg φG<span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> isTrue_neg <span class="keyword1"><span class="command">by</span></span> <span class="operator">fastforce</span>
   <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">bprv</span> <span class="main">(</span><span class="free">imp</span> <span class="main">(</span>neg φG<span class="main">)</span> <span class="main">(</span>neg <span class="main">(</span>neg <span class="main">(</span>PP <span class="main"><span class="free">⟨</span></span>φG<span class="main"><span class="free">⟩</span></span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span>
   <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> bprv_φG_eqv B.prv_imp_eqvER B.prv_imp_neg_rev<span class="main">)</span>
   <span class="keyword1"><span class="command">from</span></span> prv_imp_implies_isTrue<span class="main">[</span><span class="operator">OF</span> _ _ _ _ this 1<span class="main">,</span> <span class="operator">simplified</span><span class="main">]</span>
   <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">isTrue</span> <span class="main">(</span>neg <span class="main">(</span>neg <span class="main">(</span>PP <span class="main"><span class="free">⟨</span></span>φG<span class="main"><span class="free">⟩</span></span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">.</span></span>
   <span class="keyword1"><span class="command">from</span></span> isTrue_neg_neg<span class="main">[</span><span class="operator">OF</span> _ _ this<span class="main">,</span> <span class="operator">simplified</span><span class="main">]</span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">isTrue</span> <span class="main">(</span>PP <span class="main"><span class="free">⟨</span></span>φG<span class="main"><span class="free">⟩</span></span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">.</span></span>
   <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="free">prv</span> φG"</span></span> <span class="keyword1"><span class="command">using</span></span> assms TIP_PP <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
   <span class="keyword1"><span class="command">hence</span></span> <span class="quoted">False</span> <span class="keyword1"><span class="command">using</span></span> goedel_first_classic assms <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">}</span></span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">theorem</span></span> goedel_first_classic_strong<span class="main">:</span> <span class="quoted"><span class="quoted">"consistent <span class="main">⟹</span> <span class="main">¬</span> <span class="free">prv</span> φG <span class="main">∧</span> <span class="main">¬</span> <span class="free">prv</span> <span class="main">(</span>neg φG<span class="main">)</span> <span class="main">∧</span> <span class="free">isTrue</span> φG"</span></span>
  <span class="keyword1"><span class="command">using</span></span> goedel_first_classic isTrue_φG <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>

<span class="keyword1"><span class="command">theorem</span></span> goedel_first_classic_strong_ex<span class="main">:</span>
<span class="quoted"><span class="quoted">"consistent <span class="main">⟹</span> <span class="main">∃</span> <span class="bound">φ</span><span class="main">.</span> <span class="bound">φ</span> <span class="main">∈</span> <span class="free">fmla</span> <span class="main">∧</span> <span class="main">¬</span> <span class="free">prv</span> <span class="bound">φ</span> <span class="main">∧</span> <span class="main">¬</span> <span class="free">prv</span> <span class="main">(</span>neg <span class="bound">φ</span><span class="main">)</span> <span class="main">∧</span> <span class="free">isTrue</span> <span class="bound">φ</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> goedel_first_classic_strong <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">intro</span> exI<span class="main"><span class="main">[</span></span><span class="operator">of</span> <span class="main"><span class="main">_</span></span> <span class="quoted">φG</span><span class="main"><span class="main">]</span></span><span class="main">)</span> <span class="operator">blast</span>

<span class="keyword2"><span class="keyword">end</span></span> <span class="comment1">― ‹context <span class="antiquoted"><span class="antiquote">@{</span><span class="operator">locale</span> Goedel_Form_Classical_HBL1_rev_prv_Minimal_Truth_Soundness_TIP<span class="antiquote">}</span></span>›</span>


<span class="keyword1"><span class="command">subsection</span></span> <span class="quoted"><span class="plain_text">‹Third classical-logic version›</span></span>

<span class="keyword1"><span class="command">locale</span></span> Goedel_Form_Minimal_Truth_Soundness_HBL1iff_prv_Compl_Pf_Classical <span class="main">=</span>
Goedel_Form
  <span class="quoted"><span class="free">var</span></span> <span class="quoted"><span class="free">trm</span></span> <span class="quoted"><span class="free">fmla</span></span> <span class="quoted"><span class="free">Var</span></span> <span class="quoted"><span class="free">num</span></span> <span class="quoted"><span class="free">FvarsT</span></span> <span class="quoted"><span class="free">substT</span></span> <span class="quoted"><span class="free">Fvars</span></span> <span class="quoted"><span class="free">subst</span></span>
  <span class="quoted"><span class="free">eql</span></span> <span class="quoted"><span class="free">cnj</span></span> <span class="quoted"><span class="free">imp</span></span> <span class="quoted"><span class="free">all</span></span> <span class="quoted"><span class="free">exi</span></span>
  <span class="quoted"><span class="free">fls</span></span>
  <span class="quoted"><span class="free">prv</span></span> <span class="quoted"><span class="free">bprv</span></span>
  <span class="quoted"><span class="free">enc</span></span>
  <span class="quoted"><span class="free">S</span></span>
  <span class="quoted"><span class="free">P</span></span>
<span class="main">+</span>
Minimal_Truth_Soundness_HBL1iff_prv_Compl_Pf_Classical
  <span class="quoted"><span class="free">var</span></span> <span class="quoted"><span class="free">trm</span></span> <span class="quoted"><span class="free">fmla</span></span> <span class="quoted"><span class="free">Var</span></span> <span class="quoted"><span class="free">FvarsT</span></span> <span class="quoted"><span class="free">substT</span></span> <span class="quoted"><span class="free">Fvars</span></span> <span class="quoted"><span class="free">subst</span></span>
  <span class="quoted"><span class="free">eql</span></span> <span class="quoted"><span class="free">cnj</span></span> <span class="quoted"><span class="free">imp</span></span> <span class="quoted"><span class="free">all</span></span> <span class="quoted"><span class="free">exi</span></span>
  <span class="quoted"><span class="free">fls</span></span>
  <span class="quoted"><span class="free">dsj</span></span>
  <span class="quoted"><span class="free">num</span></span>
  <span class="quoted"><span class="free">enc</span></span>
  <span class="quoted"><span class="free">prv</span></span> <span class="quoted"><span class="free">bprv</span></span>
  <span class="quoted"><span class="free">P</span></span>
  <span class="quoted"><span class="free">isTrue</span></span>
  <span class="quoted"><span class="free">Pf</span></span>
<span class="keyword2"><span class="keyword">for</span></span>
<span class="free">var</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'var</span> set"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="free">trm</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'trm</span> set"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="free">fmla</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'fmla</span> set"</span></span>
<span class="keyword2"><span class="keyword">and</span></span> <span class="free">Var</span> <span class="free">FvarsT</span> <span class="free">substT</span> <span class="free">Fvars</span> <span class="free">subst</span>
<span class="keyword2"><span class="keyword">and</span></span> <span class="free">eql</span> <span class="free">cnj</span> <span class="free">imp</span> <span class="free">all</span> <span class="free">exi</span>
<span class="keyword2"><span class="keyword">and</span></span> <span class="free">fls</span>
<span class="keyword2"><span class="keyword">and</span></span> <span class="free">dsj</span>
<span class="keyword2"><span class="keyword">and</span></span> <span class="free">num</span>
<span class="keyword2"><span class="keyword">and</span></span> <span class="free">prv</span> <span class="free">bprv</span>
<span class="keyword2"><span class="keyword">and</span></span> <span class="free">enc</span> <span class="main">(</span><span class="quoted">"<span class="keyword1">⟨</span>_<span class="keyword1">⟩</span>"</span><span class="main">)</span>
<span class="keyword2"><span class="keyword">and</span></span> <span class="free">S</span>
<span class="keyword2"><span class="keyword">and</span></span> <span class="free">isTrue</span>
<span class="keyword2"><span class="keyword">and</span></span> <span class="free">P</span>
<span class="keyword2"><span class="keyword">and</span></span> <span class="free">Pf</span>


<span class="keyword1"><span class="command">sublocale</span></span> Goedel_Form_Minimal_Truth_Soundness_HBL1iff_prv_Compl_Pf_Classical <span class="main">&lt;</span>
  recover_proofs<span class="main">:</span> Goedel_Form_Classical_HBL1_rev_prv_Minimal_Truth_Soundness_TIP <span class="keyword2"><span class="keyword">where</span></span> prv <span class="main">=</span> <span class="quoted"><span class="free">prv</span></span> <span class="keyword2"><span class="keyword">and</span></span> bprv <span class="main">=</span> <span class="quoted"><span class="free">bprv</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">standard</span><span class="main"><span class="keyword3">,</span></span> <span class="operator">goal_cases</span> classical rev_rpv TIPf<span class="main">)</span>
  <span class="keyword3"><span class="command">case</span></span> <span class="main">(</span>classical <span class="skolem">φ</span><span class="main">)</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?case</span></span></span> <span class="keyword1"><span class="command">using</span></span> HBL1_iff classical_P <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> mts_prv_mts.PP_deff<span class="main">)</span>
<span class="keyword1"><span class="command">next</span></span>
  <span class="keyword3"><span class="command">case</span></span> <span class="main">(</span>rev_rpv <span class="skolem">φ</span><span class="main">)</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?case</span></span></span> <span class="keyword1"><span class="command">using</span></span> HBL1_iff_prv PP_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">next</span></span>
  <span class="keyword3"><span class="command">case</span></span> <span class="main">(</span>TIPf <span class="skolem">φ</span><span class="main">)</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?case</span></span></span> <span class="keyword1"><span class="command">using</span></span> classical_P <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> SS_def PP_def mts_prv_mts.TIP<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">context</span></span> Goedel_Form_Minimal_Truth_Soundness_HBL1iff_prv_Compl_Pf_Classical <span class="keyword2"><span class="keyword">begin</span></span>
<span class="keyword1"><span class="command">thm</span></span> recover_proofs.goedel_first_classic_strong
<span class="keyword2"><span class="keyword">end</span></span> <span class="comment1">―‹context <span class="antiquoted"><span class="antiquote">@{</span><span class="operator">locale</span> Goedel_Form_Minimal_Truth_Soundness_HBL1iff_prv_Compl_Pf_Classical<span class="antiquote">}</span></span>›</span>

<span class="comment1">(*&lt;*)</span>
<span class="keyword2"><span class="keyword">end</span></span>
<span class="comment1">(*&gt;*)</span>
</pre>
</div><div id="Rosser_Formula">
<div class="head">
<h1>Theory Rosser_Formula</h1>
</div>
<pre class="source"><span class="keyword1"><span class="command">chapter</span></span> <span class="quoted"><span class="plain_text">‹Rosser Formulas›</span></span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹The Rosser formula is a modification of the Gödel formula that
is undecidable assuming consistency only (not $\omega$-consistency).›</span></span>

<span class="comment1">(*&lt;*)</span>
<span class="keyword1"><span class="command">theory</span></span> Rosser_Formula
  <span class="keyword2"><span class="keyword">imports</span></span> <a href="Diagonalization.html">Diagonalization</a> <a href="Goedel_Formula.html">Goedel_Formula</a>
<span class="keyword2"><span class="keyword">begin</span></span>
<span class="comment1">(*&gt;*)</span>

<span class="keyword1"><span class="command">locale</span></span> Rosser_Form <span class="main">=</span>
Deduct2_with_PseudoOrder
  <span class="quoted"><span class="free">var</span></span> <span class="quoted"><span class="free">trm</span></span> <span class="quoted"><span class="free">fmla</span></span> <span class="quoted"><span class="free">Var</span></span> <span class="quoted"><span class="free">FvarsT</span></span> <span class="quoted"><span class="free">substT</span></span> <span class="quoted"><span class="free">Fvars</span></span> <span class="quoted"><span class="free">subst</span></span>
  <span class="quoted"><span class="free">eql</span></span> <span class="quoted"><span class="free">cnj</span></span> <span class="quoted"><span class="free">imp</span></span> <span class="quoted"><span class="free">all</span></span> <span class="quoted"><span class="free">exi</span></span>
  <span class="quoted"><span class="free">fls</span></span>
  <span class="quoted"><span class="free">dsj</span></span>
  <span class="quoted"><span class="free">num</span></span>
  <span class="quoted"><span class="free">prv</span></span> <span class="quoted"><span class="free">bprv</span></span>
  <span class="quoted"><span class="free">Lq</span></span>
  <span class="main">+</span>
Repr_Neg
  <span class="quoted"><span class="free">var</span></span> <span class="quoted"><span class="free">trm</span></span> <span class="quoted"><span class="free">fmla</span></span> <span class="quoted"><span class="free">Var</span></span> <span class="quoted"><span class="free">FvarsT</span></span> <span class="quoted"><span class="free">substT</span></span> <span class="quoted"><span class="free">Fvars</span></span> <span class="quoted"><span class="free">subst</span></span>
  <span class="quoted"><span class="free">eql</span></span> <span class="quoted"><span class="free">cnj</span></span> <span class="quoted"><span class="free">imp</span></span> <span class="quoted"><span class="free">all</span></span> <span class="quoted"><span class="free">exi</span></span>
  <span class="quoted"><span class="free">fls</span></span>
  <span class="quoted"><span class="free">num</span></span>
  <span class="quoted"><span class="free">prv</span></span> <span class="quoted"><span class="free">bprv</span></span>
  <span class="quoted"><span class="free">enc</span></span>
  <span class="quoted"><span class="free">N</span></span>
  <span class="main">+</span>
Repr_SelfSubst
  <span class="quoted"><span class="free">var</span></span> <span class="quoted"><span class="free">trm</span></span> <span class="quoted"><span class="free">fmla</span></span> <span class="quoted"><span class="free">Var</span></span> <span class="quoted"><span class="free">FvarsT</span></span> <span class="quoted"><span class="free">substT</span></span> <span class="quoted"><span class="free">Fvars</span></span> <span class="quoted"><span class="free">subst</span></span>
  <span class="quoted"><span class="free">num</span></span>
  <span class="quoted"><span class="free">eql</span></span> <span class="quoted"><span class="free">cnj</span></span> <span class="quoted"><span class="free">imp</span></span> <span class="quoted"><span class="free">all</span></span> <span class="quoted"><span class="free">exi</span></span>
  <span class="quoted"><span class="free">prv</span></span> <span class="quoted"><span class="free">bprv</span></span>
  <span class="quoted"><span class="free">enc</span></span>
  <span class="quoted"><span class="free">S</span></span>
  <span class="main">+</span>
HBL1
  <span class="quoted"><span class="free">var</span></span> <span class="quoted"><span class="free">trm</span></span> <span class="quoted"><span class="free">fmla</span></span> <span class="quoted"><span class="free">Var</span></span> <span class="quoted"><span class="free">FvarsT</span></span> <span class="quoted"><span class="free">substT</span></span> <span class="quoted"><span class="free">Fvars</span></span> <span class="quoted"><span class="free">subst</span></span>
  <span class="quoted"><span class="free">num</span></span>
  <span class="quoted"><span class="free">eql</span></span> <span class="quoted"><span class="free">cnj</span></span> <span class="quoted"><span class="free">imp</span></span> <span class="quoted"><span class="free">all</span></span> <span class="quoted"><span class="free">exi</span></span>
  <span class="quoted"><span class="free">prv</span></span> <span class="quoted"><span class="free">bprv</span></span>
  <span class="quoted"><span class="free">enc</span></span>
  <span class="quoted"><span class="free">P</span></span>
  <span class="keyword2"><span class="keyword">for</span></span>
    <span class="free">var</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'var</span> set"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="free">trm</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'trm</span> set"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="free">fmla</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'fmla</span> set"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="free">Var</span> <span class="free">FvarsT</span> <span class="free">substT</span> <span class="free">Fvars</span> <span class="free">subst</span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="free">num</span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="free">eql</span> <span class="free">cnj</span> <span class="free">imp</span> <span class="free">all</span> <span class="free">exi</span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="free">fls</span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="free">prv</span> <span class="free">bprv</span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="free">Lq</span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="free">dsj</span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="free">enc</span> <span class="main">(</span><span class="quoted">"<span class="keyword1">⟨</span>_<span class="keyword1">⟩</span>"</span><span class="main">)</span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="free">N</span> <span class="free">S</span> <span class="free">P</span>


<span class="keyword1"><span class="command">locale</span></span> Rosser_Form_Proofs <span class="main">=</span>
Deduct2_with_PseudoOrder
  <span class="quoted"><span class="free">var</span></span> <span class="quoted"><span class="free">trm</span></span> <span class="quoted"><span class="free">fmla</span></span> <span class="quoted"><span class="free">Var</span></span> <span class="quoted"><span class="free">FvarsT</span></span> <span class="quoted"><span class="free">substT</span></span> <span class="quoted"><span class="free">Fvars</span></span> <span class="quoted"><span class="free">subst</span></span>
  <span class="quoted"><span class="free">eql</span></span> <span class="quoted"><span class="free">cnj</span></span> <span class="quoted"><span class="free">imp</span></span> <span class="quoted"><span class="free">all</span></span> <span class="quoted"><span class="free">exi</span></span>
  <span class="quoted"><span class="free">fls</span></span>
  <span class="quoted"><span class="free">dsj</span></span>
  <span class="quoted"><span class="free">num</span></span>
  <span class="quoted"><span class="free">prv</span></span> <span class="quoted"><span class="free">bprv</span></span>
  <span class="quoted"><span class="free">Lq</span></span>
  <span class="main">+</span>
Repr_Neg
  <span class="quoted"><span class="free">var</span></span> <span class="quoted"><span class="free">trm</span></span> <span class="quoted"><span class="free">fmla</span></span> <span class="quoted"><span class="free">Var</span></span> <span class="quoted"><span class="free">FvarsT</span></span> <span class="quoted"><span class="free">substT</span></span> <span class="quoted"><span class="free">Fvars</span></span> <span class="quoted"><span class="free">subst</span></span>
  <span class="quoted"><span class="free">eql</span></span> <span class="quoted"><span class="free">cnj</span></span> <span class="quoted"><span class="free">imp</span></span> <span class="quoted"><span class="free">all</span></span> <span class="quoted"><span class="free">exi</span></span>
  <span class="quoted"><span class="free">fls</span></span>
  <span class="quoted"><span class="free">num</span></span>
  <span class="quoted"><span class="free">prv</span></span> <span class="quoted"><span class="free">bprv</span></span>
  <span class="quoted"><span class="free">enc</span></span>
  <span class="quoted"><span class="free">N</span></span>
  <span class="main">+</span>
Repr_SelfSubst
  <span class="quoted"><span class="free">var</span></span> <span class="quoted"><span class="free">trm</span></span> <span class="quoted"><span class="free">fmla</span></span> <span class="quoted"><span class="free">Var</span></span> <span class="quoted"><span class="free">FvarsT</span></span> <span class="quoted"><span class="free">substT</span></span> <span class="quoted"><span class="free">Fvars</span></span> <span class="quoted"><span class="free">subst</span></span>
  <span class="quoted"><span class="free">num</span></span>
  <span class="quoted"><span class="free">eql</span></span> <span class="quoted"><span class="free">cnj</span></span> <span class="quoted"><span class="free">imp</span></span> <span class="quoted"><span class="free">all</span></span> <span class="quoted"><span class="free">exi</span></span>
  <span class="quoted"><span class="free">prv</span></span> <span class="quoted"><span class="free">bprv</span></span>
  <span class="quoted"><span class="free">enc</span></span>
  <span class="quoted"><span class="free">S</span></span>
  <span class="main">+</span>
CleanRepr_Proofs
  <span class="quoted"><span class="free">var</span></span> <span class="quoted"><span class="free">trm</span></span> <span class="quoted"><span class="free">fmla</span></span> <span class="quoted"><span class="free">Var</span></span> <span class="quoted"><span class="free">FvarsT</span></span> <span class="quoted"><span class="free">substT</span></span> <span class="quoted"><span class="free">Fvars</span></span> <span class="quoted"><span class="free">subst</span></span>
  <span class="quoted"><span class="free">num</span></span>
  <span class="quoted"><span class="free">eql</span></span> <span class="quoted"><span class="free">cnj</span></span> <span class="quoted"><span class="free">imp</span></span> <span class="quoted"><span class="free">all</span></span> <span class="quoted"><span class="free">exi</span></span>
  <span class="quoted"><span class="free">prv</span></span> <span class="quoted"><span class="free">bprv</span></span>
  <span class="quoted"><span class="free">enc</span></span>
  <span class="quoted"><span class="free">fls</span></span>
  <span class="quoted"><span class="free">dsj</span></span>
  <span class="quoted"><span class="quoted">"<span class="free">proof</span>"</span></span> <span class="quoted"><span class="free">prfOf</span></span>
  <span class="quoted"><span class="free">encPf</span></span>
  <span class="quoted"><span class="free">Pf</span></span>
  <span class="keyword2"><span class="keyword">for</span></span>
    <span class="free">var</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'var</span> set"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="free">trm</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'trm</span> set"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="free">fmla</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'fmla</span> set"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="free">Var</span> <span class="free">FvarsT</span> <span class="free">substT</span> <span class="free">Fvars</span> <span class="free">subst</span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="free">num</span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="free">eql</span> <span class="free">cnj</span> <span class="free">imp</span> <span class="free">all</span> <span class="free">exi</span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="free">fls</span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="free">prv</span> <span class="free">bprv</span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="free">Lq</span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="free">dsj</span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted">"<span class="free">proof</span>"</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'proof</span> set"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="free">prfOf</span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="free">enc</span> <span class="main">(</span><span class="quoted">"<span class="keyword1">⟨</span>_<span class="keyword1">⟩</span>"</span><span class="main">)</span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="free">N</span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="free">S</span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="free">encPf</span> <span class="free">Pf</span>

<span class="keyword1"><span class="command">context</span></span> Rosser_Form_Proofs
<span class="keyword2"><span class="keyword">begin</span></span>

<span class="keyword1"><span class="command">definition</span></span> <span class="entity">R</span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="free">R</span> <span class="main">=</span> <span class="free">all</span> zz <span class="main">(</span><span class="free">imp</span> <span class="main">(</span>LLq <span class="main">(</span><span class="free">Var</span> zz<span class="main">)</span> <span class="main">(</span><span class="free">Var</span> yy<span class="main">)</span><span class="main">)</span>
                                     <span class="main">(</span><span class="free">all</span> xx' <span class="main">(</span><span class="free">imp</span> <span class="main">(</span>NN <span class="main">(</span><span class="free">Var</span> xx<span class="main">)</span> <span class="main">(</span><span class="free">Var</span> xx'<span class="main">)</span><span class="main">)</span>
                                                   <span class="main">(</span>neg <span class="main">(</span>PPf <span class="main">(</span><span class="free">Var</span> zz<span class="main">)</span> <span class="main">(</span><span class="free">Var</span> xx'<span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span>

<span class="keyword1"><span class="command">definition</span></span> <span class="entity">RR</span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="free">RR</span> <span class="free"><span class="bound"><span class="entity">t1</span></span></span> <span class="free"><span class="bound"><span class="entity">t2</span></span></span> <span class="main">=</span> psubst R <span class="main">[</span><span class="main">(</span><span class="free"><span class="bound"><span class="entity">t1</span></span></span><span class="main">,</span>yy<span class="main">)</span><span class="main">,</span> <span class="main">(</span><span class="free"><span class="bound"><span class="entity">t2</span></span></span><span class="main">,</span>xx<span class="main">)</span><span class="main">]</span>"</span></span>

<span class="keyword1"><span class="command">lemma</span></span> R<span class="main">[</span><span class="operator">simp</span><span class="main">,</span><span class="operator">intro</span><span class="main"><span class="main"><span class="main">!</span></span></span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"R <span class="main">∈</span> <span class="free">fmla</span>"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> R_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">lemma</span></span> RR_def2<span class="main">:</span>
  <span class="quoted"><span class="quoted">"<span class="free">t1</span> <span class="main">∈</span> <span class="free">trm</span> <span class="main">⟹</span> <span class="free">t2</span> <span class="main">∈</span> <span class="free">trm</span> <span class="main">⟹</span> xx <span class="main">∉</span> <span class="free">FvarsT</span> <span class="free">t1</span> <span class="main">⟹</span> RR <span class="free">t1</span> <span class="free">t2</span> <span class="main">=</span> <span class="free">subst</span> <span class="main">(</span><span class="free">subst</span> R <span class="free">t1</span> yy<span class="main">)</span> <span class="free">t2</span> xx"</span></span>
  <span class="keyword1"><span class="command">unfolding</span></span> RR_def <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> psubst_eq_rawpsubst2<span class="main"><span class="main">[</span></span><span class="operator">simplified</span><span class="main"><span class="main">]</span></span><span class="main">)</span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">definition</span></span> <span class="entity">P'</span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="free">P'</span> <span class="main">=</span> <span class="free">exi</span> yy <span class="main">(</span><span class="free">cnj</span> <span class="main">(</span>PPf <span class="main">(</span><span class="free">Var</span> yy<span class="main">)</span> <span class="main">(</span><span class="free">Var</span> xx<span class="main">)</span><span class="main">)</span> <span class="main">(</span>RR <span class="main">(</span><span class="free">Var</span> yy<span class="main">)</span> <span class="main">(</span><span class="free">Var</span> xx<span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span>

<span class="keyword1"><span class="command">definition</span></span> <span class="entity">PP'</span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="free">PP'</span> <span class="free"><span class="bound"><span class="entity">t</span></span></span> <span class="main">=</span> <span class="free">subst</span> P' <span class="free"><span class="bound"><span class="entity">t</span></span></span> xx"</span></span>

<span class="keyword1"><span class="command">lemma</span></span> Fvars_R<span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">Fvars</span> R <span class="main">=</span> <span class="main">{</span>xx<span class="main">,</span>yy<span class="main">}</span>"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> R_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">Fvars</span> <span class="main">(</span>RR <span class="main">(</span><span class="free">Var</span> yy<span class="main">)</span> <span class="main">(</span><span class="free">Var</span> xx<span class="main">)</span><span class="main">)</span> <span class="main">=</span> <span class="main">{</span>yy<span class="main">,</span>xx<span class="main">}</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> RR_def2<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> P'<span class="main">[</span><span class="operator">simp</span><span class="main">,</span><span class="operator">intro</span><span class="main"><span class="main"><span class="main">!</span></span></span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"P' <span class="main">∈</span> <span class="free">fmla</span>"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> P'_def <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> PPf_def2 RR_def2<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> Fvars_P'<span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">Fvars</span> P' <span class="main">=</span> <span class="main">{</span>xx<span class="main">}</span>"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> P'_def <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> PPf_def2 RR_def2<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> PP'<span class="main">[</span><span class="operator">simp</span><span class="main">,</span><span class="operator">intro</span><span class="main"><span class="main"><span class="main">!</span></span></span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">t</span> <span class="main">∈</span> <span class="free">trm</span> <span class="main">⟹</span> PP' <span class="free">t</span> <span class="main">∈</span> <span class="free">fmla</span>"</span></span>
  <span class="keyword1"><span class="command">unfolding</span></span> PP'_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">lemma</span></span> RR<span class="main">[</span><span class="operator">simp</span><span class="main">,</span><span class="operator">intro</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">t1</span> <span class="main">∈</span> <span class="free">trm</span> <span class="main">⟹</span> <span class="free">t2</span> <span class="main">∈</span> <span class="free">trm</span> <span class="main">⟹</span> RR <span class="free">t1</span> <span class="free">t2</span> <span class="main">∈</span> <span class="free">fmla</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> RR_def<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> RR_simps<span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span>
   <span class="quoted"><span class="quoted">"<span class="free">n</span> <span class="main">∈</span> <span class="free">num</span> <span class="main">⟹</span> <span class="free">subst</span> <span class="main">(</span>RR <span class="main">(</span><span class="free">Var</span> yy<span class="main">)</span> <span class="main">(</span><span class="free">Var</span> xx<span class="main">)</span><span class="main">)</span> <span class="free">n</span> xx <span class="main">=</span> RR <span class="main">(</span><span class="free">Var</span> yy<span class="main">)</span> <span class="free">n</span>"</span></span>
   <span class="quoted"><span class="quoted">"<span class="free">m</span> <span class="main">∈</span> <span class="free">num</span> <span class="main">⟹</span> <span class="free">n</span> <span class="main">∈</span> <span class="free">num</span> <span class="main">⟹</span> <span class="free">subst</span> <span class="main">(</span>RR <span class="main">(</span><span class="free">Var</span> yy<span class="main">)</span> <span class="free">m</span><span class="main">)</span> <span class="free">n</span> yy <span class="main">=</span> RR <span class="free">n</span> <span class="free">m</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> RR_def2 subst2_fresh_switch<span class="main">)</span><span class="main"><span class="keyword3">+</span></span>


<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹The Rosser modification of the Gödel formula›</span></span>
<span class="keyword1"><span class="command">definition</span></span> <span class="entity">φR</span> <span class="main">::</span> <span class="tfree"><span class="quoted"><span class="tfree">'fmla</span></span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="free">φR</span> <span class="main">≡</span> diag <span class="main">(</span>neg P'<span class="main">)</span>"</span></span>

<span class="keyword1"><span class="command">lemma</span></span> φR<span class="main">[</span><span class="operator">simp</span><span class="main">,</span><span class="operator">intro</span><span class="main"><span class="main"><span class="main">!</span></span></span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"φR <span class="main">∈</span> <span class="free">fmla</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> Fvars_φR<span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">Fvars</span> φR <span class="main">=</span> <span class="main">{}</span>"</span></span>
  <span class="keyword1"><span class="command">unfolding</span></span> φR_def wrepr.PP_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">lemma</span></span> bprv_φR_eqv<span class="main">:</span>
  <span class="quoted"><span class="quoted">"<span class="free">bprv</span> <span class="main">(</span>eqv φR <span class="main">(</span>neg <span class="main">(</span>PP' <span class="main"><span class="free">⟨</span></span>φR<span class="main"><span class="free">⟩</span></span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">unfolding</span></span> φR_def PP'_def <span class="keyword1"><span class="command">using</span></span> bprv_diag_eqv<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="quoted">"neg P'"</span></span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>

<span class="keyword1"><span class="command">lemma</span></span> bprv_imp_φR<span class="main">:</span>
  <span class="quoted"><span class="quoted">"<span class="free">bprv</span> <span class="main">(</span><span class="free">imp</span> <span class="main">(</span>neg <span class="main">(</span>PP' <span class="main"><span class="free">⟨</span></span>φR<span class="main"><span class="free">⟩</span></span><span class="main">)</span><span class="main">)</span> φR<span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> B.prv_imp_eqvER<span class="main">)</span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">intro</span><span class="main"><span class="main">:</span></span> bprv_φR_eqv<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> prv_φR_eqv<span class="main">:</span>
  <span class="quoted"><span class="quoted">"<span class="free">prv</span> <span class="main">(</span>eqv φR <span class="main">(</span>neg <span class="main">(</span>PP' <span class="main"><span class="free">⟨</span></span>φR<span class="main"><span class="free">⟩</span></span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> dwf_dwfd.d_dwf.bprv_prv'<span class="main">[</span><span class="operator">OF</span> _ bprv_φR_eqv<span class="main">,</span> <span class="operator">simplified</span><span class="main">]</span> <span class="keyword1"><span class="command">.</span></span>

<span class="keyword1"><span class="command">lemma</span></span> prv_imp_φR<span class="main">:</span>
  <span class="quoted"><span class="quoted">"<span class="free">prv</span> <span class="main">(</span><span class="free">imp</span> <span class="main">(</span>neg <span class="main">(</span>PP' <span class="main"><span class="free">⟨</span></span>φR<span class="main"><span class="free">⟩</span></span><span class="main">)</span><span class="main">)</span> φR<span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> prv_imp_eqvER<span class="main">)</span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">intro</span><span class="main"><span class="main">:</span></span> prv_φR_eqv<span class="main">)</span>

<span class="keyword2"><span class="keyword">end</span></span> <span class="comment1">― ‹context <span class="antiquoted"><span class="antiquote">@{</span><span class="operator">locale</span> Rosser_Form<span class="antiquote">}</span></span>›</span>


<span class="keyword1"><span class="command">sublocale</span></span> Rosser_Form_Proofs <span class="main">&lt;</span> Rosser_Form <span class="keyword2"><span class="keyword">where</span></span> P <span class="main">=</span> <span class="quoted">P</span>
  <span class="keyword1"><span class="command">by</span></span> <span class="operator">standard</span>

<span class="keyword1"><span class="command">sublocale</span></span> Rosser_Form_Proofs <span class="main">&lt;</span> Goedel_Form <span class="keyword2"><span class="keyword">where</span></span> P <span class="main">=</span> <span class="quoted">P</span>
  <span class="keyword1"><span class="command">by</span></span> <span class="operator">standard</span>

<span class="comment1">(*&lt;*)</span>
<span class="keyword2"><span class="keyword">end</span></span>
<span class="comment1">(*&gt;*)</span>
</pre>
</div><div id="Abstract_First_Goedel_Rosser">
<div class="head">
<h1>Theory Abstract_First_Goedel_Rosser</h1>
</div>
<pre class="source"><span class="keyword1"><span class="command">chapter</span></span> <span class="quoted"><span class="plain_text">‹Abstract Formulations of Gödel-Rosser's First Incompleteness Theorem›</span></span>

<span class="comment1">(*&lt;*)</span>
<span class="keyword1"><span class="command">theory</span></span> Abstract_First_Goedel_Rosser
  <span class="keyword2"><span class="keyword">imports</span></span> <a href="Rosser_Formula.html">Rosser_Formula</a> <a href="Standard_Model_More.html">Standard_Model_More</a>
<span class="keyword2"><span class="keyword">begin</span></span>
<span class="comment1">(*&gt;*)</span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹The development here is very similar to that of Gödel First Incompleteness Theorem.
It lacks classical logical variants, since for them Rosser's trick does bring
any extra value.›</span></span>

<span class="keyword1"><span class="command">section</span></span> <span class="quoted"><span class="plain_text">‹Proof-Theoretic Versions›</span></span>

<span class="keyword1"><span class="command">context</span></span> Rosser_Form_Proofs
<span class="keyword2"><span class="keyword">begin</span></span>

<span class="keyword1"><span class="command">lemma</span></span> NN_neg_unique_xx'<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span><span class="quoted"><span class="quoted">"<span class="free">φ</span> <span class="main">∈</span> <span class="free">fmla</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="free">Fvars</span> <span class="free">φ</span> <span class="main">=</span> <span class="main">{}</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span>
    <span class="quoted"><span class="quoted">"<span class="free">bprv</span> <span class="main">(</span><span class="free">imp</span> <span class="main">(</span>NN <span class="main"><span class="free">⟨</span></span><span class="free">φ</span><span class="main"><span class="free">⟩</span></span> <span class="main">(</span><span class="free">Var</span> xx'<span class="main">)</span><span class="main">)</span>
          <span class="main">(</span><span class="free">eql</span> <span class="main"><span class="free">⟨</span></span>neg <span class="free">φ</span><span class="main"><span class="free">⟩</span></span> <span class="main">(</span><span class="free">Var</span> xx'<span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> B.prv_subst<span class="main">[</span><span class="operator">of</span> <span class="quoted">yy</span> <span class="main">_</span> <span class="quoted"><span class="quoted">"<span class="free">Var</span> xx'"</span></span><span class="main">,</span> <span class="operator">OF</span> _ _ _ NN_neg_unique<span class="main"><span class="main">[</span></span><span class="operator">OF</span> assms<span class="main"><span class="main">]</span></span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">fastforce</span>

<span class="keyword1"><span class="command">lemma</span></span> NN_imp_xx'<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">φ</span> <span class="main">∈</span> <span class="free">fmla</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="free">Fvars</span> <span class="free">φ</span> <span class="main">=</span> <span class="main">{}</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="free">χ</span> <span class="main">∈</span> <span class="free">fmla</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">bprv</span> <span class="main">(</span><span class="free">imp</span> <span class="main">(</span><span class="free">subst</span> <span class="free">χ</span> <span class="main"><span class="free">⟨</span></span>neg <span class="free">φ</span><span class="main"><span class="free">⟩</span></span> xx'<span class="main">)</span>
                   <span class="main">(</span><span class="free">all</span> xx' <span class="main">(</span><span class="free">imp</span> <span class="main">(</span>NN <span class="main"><span class="free">⟨</span></span><span class="free">φ</span><span class="main"><span class="free">⟩</span></span> <span class="main">(</span><span class="free">Var</span> xx'<span class="main">)</span><span class="main">)</span> <span class="free">χ</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> 2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">bprv</span> <span class="main">(</span><span class="free">imp</span> <span class="main">(</span><span class="free">eql</span> <span class="main"><span class="free">⟨</span></span>neg <span class="free">φ</span><span class="main"><span class="free">⟩</span></span> <span class="main">(</span><span class="free">Var</span> xx'<span class="main">)</span><span class="main">)</span> <span class="main">(</span><span class="free">imp</span> <span class="main">(</span><span class="free">subst</span> <span class="free">χ</span> <span class="main"><span class="free">⟨</span></span>neg <span class="free">φ</span><span class="main"><span class="free">⟩</span></span> xx'<span class="main">)</span> <span class="free">χ</span><span class="main">)</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> B.prv_eql_subst_trm<span class="main">[</span><span class="operator">of</span> <span class="quoted">xx'</span> <span class="quoted"><span class="free">χ</span></span> <span class="quoted"><span class="quoted">"<span class="main"><span class="free">⟨</span></span>neg <span class="free">φ</span><span class="main"><span class="free">⟩</span></span>"</span></span> <span class="quoted"><span class="quoted">"<span class="free">Var</span> xx'"</span></span><span class="main">,</span> <span class="operator">simplified</span><span class="main">]</span> <span class="keyword1"><span class="command">.</span></span>
  <span class="keyword1"><span class="command">have</span></span> 1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">bprv</span> <span class="main">(</span><span class="free">imp</span> <span class="main">(</span><span class="free">subst</span> <span class="free">χ</span> <span class="main"><span class="free">⟨</span></span>neg <span class="free">φ</span><span class="main"><span class="free">⟩</span></span> xx'<span class="main">)</span> <span class="main">(</span><span class="free">imp</span> <span class="main">(</span><span class="free">eql</span> <span class="main"><span class="free">⟨</span></span>neg <span class="free">φ</span><span class="main"><span class="free">⟩</span></span> <span class="main">(</span><span class="free">Var</span> xx'<span class="main">)</span><span class="main">)</span> <span class="free">χ</span><span class="main">)</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> <span class="quoted">"2"</span> B.prv_imp_com<span class="main">)</span>
  <span class="keyword1"><span class="command">have</span></span> 0<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">bprv</span> <span class="main">(</span><span class="free">imp</span> <span class="main">(</span><span class="free">subst</span> <span class="free">χ</span> <span class="main"><span class="free">⟨</span></span>neg <span class="free">φ</span><span class="main"><span class="free">⟩</span></span> xx'<span class="main">)</span> <span class="main">(</span><span class="free">imp</span> <span class="main">(</span>NN <span class="main"><span class="free">⟨</span></span><span class="free">φ</span><span class="main"><span class="free">⟩</span></span> <span class="main">(</span><span class="free">Var</span> xx'<span class="main">)</span><span class="main">)</span> <span class="free">χ</span><span class="main">)</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> 1
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">elim</span> B.prv_prv_imp_trans<span class="main"><span class="main">[</span></span><span class="operator">rotated</span> 3<span class="main"><span class="main">]</span></span><span class="main">)</span>
      <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> B.prv_imp_com B.prv_imp_monoR NN_neg_unique_xx'<span class="main">)</span>
  <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> B.prv_all_imp_gen<span class="main">)</span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> 0<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">lemma</span></span> goedel_rosser_first_theEasyHalf<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> c<span class="main">:</span> <span class="quoted"><span class="quoted">"consistent"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> <span class="free">prv</span> φR"</span></span>
<span class="keyword1"><span class="command">proof</span></span>
  <span class="keyword3"><span class="command">assume</span></span> 0<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">prv</span> φR"</span></span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="quoted">"<span class="skolem"><span class="skolem">prf</span></span>"</span> <span class="keyword2"><span class="keyword">where</span></span> <span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">prf</span> <span class="main">∈</span> <span class="free">proof</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">prfOf</span> <span class="skolem">prf</span> φR"</span></span> <span class="keyword1"><span class="command">using</span></span> prv_prfOf <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">hence</span></span> 00<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">bprv</span> <span class="main">(</span>PPf <span class="main">(</span><span class="free">encPf</span> <span class="skolem">prf</span><span class="main">)</span> <span class="main"><span class="free">⟨</span></span>φR<span class="main"><span class="free">⟩</span></span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> prfOf_PPf <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">from</span></span> dwf_dwfd.d_dwf.bprv_prv'<span class="main">[</span><span class="operator">OF</span> _ 00<span class="main">,</span> <span class="operator">simplified</span><span class="main">]</span> <span class="keyword1"><span class="command">have</span></span> b00<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">prv</span> <span class="main">(</span>PPf <span class="main">(</span><span class="free">encPf</span> <span class="skolem">prf</span><span class="main">)</span> <span class="main"><span class="free">⟨</span></span>φR<span class="main"><span class="free">⟩</span></span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">.</span></span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> <span class="free">prv</span> <span class="main">(</span>neg φR<span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> 0 c <span class="keyword1"><span class="command">unfolding</span></span> consistent_def3 <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span> <span class="bound">prf</span> <span class="main">∈</span> <span class="free">proof</span><span class="main">.</span>  <span class="main">¬</span> <span class="free">prfOf</span> <span class="bound">prf</span> <span class="main">(</span>neg φR<span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> 00 prv_prfOf <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="free">bprv</span> <span class="main">(</span>neg <span class="main">(</span>PPf <span class="skolem">p</span> <span class="main"><span class="free">⟨</span></span>neg φR<span class="main"><span class="free">⟩</span></span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword2"><span class="keyword">if</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">p</span> <span class="main">∈</span> <span class="free">num</span>"</span></span> <span class="keyword2"><span class="keyword">for</span></span> <span class="skolem">p</span> <span class="keyword1"><span class="command">using</span></span> not_prfOf_PPf Clean_PPf_encPf that
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">cases</span> <span class="quoted"><span class="quoted">"<span class="skolem">p</span> <span class="main">∈</span> <span class="free">encPf</span> <span class="main">`</span> <span class="free">proof</span>"</span></span><span class="main">)</span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">hence</span></span> 1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">prv</span> <span class="main">(</span><span class="free">all</span> zz <span class="main">(</span><span class="free">imp</span> <span class="main">(</span>LLq <span class="main">(</span><span class="free">Var</span> zz<span class="main">)</span> <span class="main">(</span><span class="free">encPf</span> <span class="skolem">prf</span><span class="main">)</span><span class="main">)</span> <span class="main">(</span>neg <span class="main">(</span>PPf <span class="main">(</span><span class="free">Var</span> zz<span class="main">)</span> <span class="main"><span class="free">⟨</span></span>neg φR<span class="main"><span class="free">⟩</span></span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span>
    <span class="comment1">(* here use locale assumption about the order-like relation: *)</span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">intro</span> LLq_num<span class="main">)</span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">have</span></span> 11<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">prv</span> <span class="main">(</span>RR <span class="main">(</span><span class="free">encPf</span> <span class="skolem">prf</span><span class="main">)</span> <span class="main"><span class="free">⟨</span></span>φR<span class="main"><span class="free">⟩</span></span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> NN_imp_xx'<span class="main">[</span><span class="operator">of</span> <span class="quoted">φR</span> <span class="quoted"><span class="quoted">"neg <span class="main">(</span>PPf <span class="main">(</span><span class="free">Var</span> zz<span class="main">)</span> <span class="main">(</span><span class="free">Var</span> xx'<span class="main">)</span><span class="main">)</span>"</span></span><span class="main">,</span> <span class="operator">simplified</span><span class="main">]</span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> RR_def2 R_def
      <span class="quasi_keyword">intro</span><span class="main"><span class="main">!</span></span><span class="main"><span class="main">:</span></span> prv_all_congW<span class="main"><span class="main">[</span></span><span class="operator">OF</span> _ _ _ _ 1<span class="main"><span class="main">]</span></span> prv_imp_monoL<span class="main"><span class="main">[</span></span><span class="operator">OF</span> _ _ _ dwf_dwfd.d_dwf.bprv_prv'<span class="main"><span class="main">]</span></span><span class="main">)</span>
  <span class="keyword1"><span class="command">have</span></span> 3<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">prv</span> <span class="main">(</span><span class="free">cnj</span> <span class="main">(</span>PPf <span class="main">(</span><span class="free">encPf</span> <span class="skolem">prf</span><span class="main">)</span> <span class="main"><span class="free">⟨</span></span>φR<span class="main"><span class="free">⟩</span></span><span class="main">)</span> <span class="main">(</span>RR <span class="main">(</span><span class="free">encPf</span> <span class="skolem">prf</span><span class="main">)</span> <span class="main"><span class="free">⟨</span></span>φR<span class="main"><span class="free">⟩</span></span><span class="main">)</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> prv_cnjI<span class="main"><span class="main">[</span></span><span class="operator">OF</span> _ _ b00 11<span class="main"><span class="main">]</span></span><span class="main">)</span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">prv</span> <span class="main">(</span><span class="main">(</span>PP' <span class="main"><span class="free">⟨</span></span>φR<span class="main"><span class="free">⟩</span></span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> PP'_def P'_def
     <span class="keyword1"><span class="command">using</span></span> 3 <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">intro</span><span class="main"><span class="main">:</span></span> prv_exiI<span class="main"><span class="main">[</span></span><span class="operator">of</span> <span class="main"><span class="main">_</span></span> <span class="main"><span class="main">_</span></span> <span class="quoted"><span class="quoted">"<span class="free">encPf</span> <span class="skolem">prf</span>"</span></span><span class="main"><span class="main">]</span></span><span class="main">)</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">prv</span> <span class="main">(</span>neg <span class="main">(</span>PP' <span class="main"><span class="free">⟨</span></span>φR<span class="main"><span class="free">⟩</span></span><span class="main">)</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> prv_eqv_prv<span class="main">[</span><span class="operator">OF</span> _ _ 0 prv_φR_eqv<span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted">False</span> <span class="keyword1"><span class="command">using</span></span> c <span class="keyword1"><span class="command">unfolding</span></span> consistent_def3 <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">lemma</span></span> goedel_rosser_first_theHardHalf<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> c<span class="main">:</span> <span class="quoted"><span class="quoted">"consistent"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> <span class="free">prv</span> <span class="main">(</span>neg φR<span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span>
  <span class="keyword3"><span class="command">assume</span></span> 0<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">prv</span> <span class="main">(</span>neg φR<span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="quoted">"<span class="skolem"><span class="skolem">prf</span></span>"</span> <span class="keyword2"><span class="keyword">where</span></span> <span class="main">[</span><span class="operator">simp</span><span class="main">,</span><span class="operator">intro</span><span class="main"><span class="main">!</span></span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">prf</span> <span class="main">∈</span> <span class="free">proof</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> pr<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">prfOf</span> <span class="skolem">prf</span> <span class="main">(</span>neg φR<span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> prv_prfOf <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword3"><span class="command">define</span></span> <span class="skolem"><span class="skolem">p</span></span> <span class="keyword2"><span class="keyword">where</span></span> p<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">p</span> <span class="main">=</span> <span class="free">encPf</span> <span class="skolem">prf</span>"</span></span>
  <span class="keyword1"><span class="command">have</span></span> <span class="main">[</span><span class="operator">simp</span><span class="main">,</span><span class="operator">intro</span><span class="main"><span class="main">!</span></span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">p</span> <span class="main">∈</span> <span class="free">num</span>"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> p <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">have</span></span> 11<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">bprv</span> <span class="main">(</span>PPf <span class="skolem">p</span> <span class="main"><span class="free">⟨</span></span>neg φR<span class="main"><span class="free">⟩</span></span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> pr prfOf_PPf <span class="keyword1"><span class="command">unfolding</span></span> p <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">have</span></span> 1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">bprv</span> <span class="main">(</span>NN <span class="main"><span class="free">⟨</span></span>φR<span class="main"><span class="free">⟩</span></span> <span class="main"><span class="free">⟨</span></span>neg φR<span class="main"><span class="free">⟩</span></span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> NN_neg <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>

  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> <span class="free">prv</span> φR"</span></span> <span class="keyword1"><span class="command">using</span></span> 0 c <span class="keyword1"><span class="command">unfolding</span></span> consistent_def3 <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">from</span></span> not_prv_prv_neg_PPf<span class="main">[</span><span class="operator">OF</span> _ _ this<span class="main">]</span>
  <span class="keyword1"><span class="command">have</span></span> b2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">∀</span> <span class="bound">r</span> <span class="main">∈</span> <span class="free">num</span><span class="main">.</span> <span class="free">bprv</span> <span class="main">(</span>neg <span class="main">(</span>PPf <span class="bound">r</span> <span class="main"><span class="free">⟨</span></span>φR<span class="main"><span class="free">⟩</span></span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">hence</span></span> 2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">∀</span> <span class="bound">r</span> <span class="main">∈</span> <span class="free">num</span><span class="main">.</span> <span class="free">prv</span> <span class="main">(</span>neg <span class="main">(</span>PPf <span class="bound">r</span> <span class="main"><span class="free">⟨</span></span>φR<span class="main"><span class="free">⟩</span></span><span class="main">)</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">intro</span><span class="main"><span class="main">:</span></span> dwf_dwfd.d_dwf.bprv_prv'<span class="main">)</span>

  <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">P</span></span> <span class="keyword2"><span class="keyword">where</span></span> P<span class="main">[</span><span class="operator">simp</span><span class="main">,</span><span class="operator">intro</span><span class="main"><span class="main"><span class="main">!</span></span></span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">P</span> <span class="main">⊆</span><span class="free">num</span>"</span></span> <span class="quoted"><span class="quoted">"finite <span class="skolem">P</span>"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> 3<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">prv</span> <span class="main">(</span><span class="free">dsj</span> <span class="main">(</span>sdsj <span class="main">{</span><span class="free">eql</span> <span class="main">(</span><span class="free">Var</span> yy<span class="main">)</span> <span class="bound">r</span> <span class="main">|</span><span class="bound">r</span><span class="main">.</span> <span class="bound">r</span> <span class="main">∈</span> <span class="skolem">P</span><span class="main">}</span><span class="main">)</span> <span class="main">(</span>LLq <span class="skolem">p</span> <span class="main">(</span><span class="free">Var</span> yy<span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span>
    <span class="comment1">(* here use the other locale assumption about the order-like relation: *)</span>
    <span class="keyword1"><span class="command">using</span></span> LLq_num2 <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">prv</span> <span class="main">(</span><span class="free">imp</span> <span class="main">(</span><span class="free">cnj</span> <span class="main">(</span>PPf <span class="main">(</span><span class="free">Var</span> yy<span class="main">)</span> <span class="main"><span class="free">⟨</span></span>φR<span class="main"><span class="free">⟩</span></span><span class="main">)</span> <span class="main">(</span>RR <span class="main">(</span><span class="free">Var</span> yy<span class="main">)</span> <span class="main"><span class="free">⟨</span></span>φR<span class="main"><span class="free">⟩</span></span><span class="main">)</span><span class="main">)</span> <span class="free">fls</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span><span class="main">(</span><span class="operator">rule</span> prv_dsj_cases<span class="main"><span class="main">[</span></span><span class="operator">OF</span> _ _ _ 3<span class="main"><span class="main">]</span></span><span class="main">)</span>
    <span class="keyword1"><span class="command">{</span></span><span class="keyword3"><span class="command">fix</span></span> <span class="skolem">r</span> <span class="keyword3"><span class="command">assume</span></span> r<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">r</span> <span class="main">∈</span> <span class="skolem">P</span>"</span></span> <span class="keyword1"><span class="command">hence</span></span> rn<span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">r</span> <span class="main">∈</span> <span class="free">num</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> P<span class="main">(</span>1<span class="main">)</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
      <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">prv</span> <span class="main">(</span><span class="free">imp</span> <span class="main">(</span><span class="free">cnj</span> <span class="main">(</span>PPf <span class="skolem">r</span> <span class="main"><span class="free">⟨</span></span>φR<span class="main"><span class="free">⟩</span></span><span class="main">)</span> <span class="main">(</span>RR <span class="skolem">r</span> <span class="main"><span class="free">⟨</span></span>φR<span class="main"><span class="free">⟩</span></span><span class="main">)</span><span class="main">)</span> <span class="free">fls</span><span class="main">)</span>"</span></span>
        <span class="keyword1"><span class="command">using</span></span> 2 <span class="keyword1"><span class="command">unfolding</span></span> neg_def
        <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> FvarsT_num PPf RR rn φR all_not_in_conv cnj enc fls imp in_num prv_imp_cnj3L prv_imp_mp<span class="main">)</span>
      <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="free">prv</span> <span class="main">(</span><span class="free">imp</span> <span class="main">(</span><span class="free">eql</span> <span class="main">(</span><span class="free">Var</span> yy<span class="main">)</span> <span class="skolem">r</span><span class="main">)</span>
                <span class="main">(</span><span class="free">imp</span> <span class="main">(</span><span class="free">cnj</span> <span class="main">(</span>PPf <span class="main">(</span><span class="free">Var</span> yy<span class="main">)</span> <span class="main"><span class="free">⟨</span></span>φR<span class="main"><span class="free">⟩</span></span><span class="main">)</span> <span class="main">(</span>RR <span class="main">(</span><span class="free">Var</span> yy<span class="main">)</span> <span class="main"><span class="free">⟨</span></span>φR<span class="main"><span class="free">⟩</span></span><span class="main">)</span><span class="main">)</span> <span class="free">fls</span><span class="main">)</span><span class="main">)</span>"</span></span>
        <span class="keyword1"><span class="command">using</span></span> prv_eql_subst_trm_id<span class="main">[</span><span class="operator">of</span> <span class="quoted">yy</span> <span class="quoted"><span class="quoted">"<span class="free">cnj</span> <span class="main">(</span>PPf <span class="main">(</span><span class="free">Var</span> yy<span class="main">)</span> <span class="main"><span class="free">⟨</span></span>φR<span class="main"><span class="free">⟩</span></span><span class="main">)</span> <span class="main">(</span>RR <span class="main">(</span><span class="free">Var</span> yy<span class="main">)</span> <span class="main"><span class="free">⟨</span></span>φR<span class="main"><span class="free">⟩</span></span><span class="main">)</span>"</span></span> <span class="quoted"><span class="skolem">r</span></span><span class="main">,</span><span class="operator">simplified</span><span class="main">]</span>
        <span class="keyword1"><span class="command">unfolding</span></span> neg_def<span class="main">[</span><span class="operator">symmetric</span><span class="main">]</span>
        <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">intro</span> prv_neg_imp_imp_trans<span class="main">)</span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">}</span></span>
    <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"<span class="free">prv</span> <span class="main">(</span><span class="free">imp</span> <span class="main">(</span>sdsj <span class="main">{</span><span class="free">eql</span> <span class="main">(</span><span class="free">Var</span> yy<span class="main">)</span> <span class="bound">r</span> <span class="main">|</span><span class="bound">r</span><span class="main">.</span> <span class="bound">r</span> <span class="main">∈</span> <span class="skolem">P</span><span class="main">}</span><span class="main">)</span>
              <span class="main">(</span><span class="free">imp</span> <span class="main">(</span><span class="free">cnj</span> <span class="main">(</span>PPf <span class="main">(</span><span class="free">Var</span> yy<span class="main">)</span> <span class="main"><span class="free">⟨</span></span>φR<span class="main"><span class="free">⟩</span></span><span class="main">)</span> <span class="main">(</span>RR <span class="main">(</span><span class="free">Var</span> yy<span class="main">)</span> <span class="main"><span class="free">⟨</span></span>φR<span class="main"><span class="free">⟩</span></span><span class="main">)</span><span class="main">)</span> <span class="free">fls</span><span class="main">)</span><span class="main">)</span>"</span></span>
       <span class="keyword1"><span class="command">using</span></span> Var P<span class="main">(</span>1<span class="main">)</span> eql <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">intro</span> prv_sdsj_imp<span class="main">)</span> <span class="main">(</span><span class="operator">auto</span> 0 0 <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> set_rev_mp<span class="main">)</span>
  <span class="keyword1"><span class="command">next</span></span>
    <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?φ</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"<span class="free">all</span> xx' <span class="main">(</span><span class="free">imp</span> <span class="main">(</span>NN <span class="main"><span class="free">⟨</span></span>φR<span class="main"><span class="free">⟩</span></span> <span class="main">(</span><span class="free">Var</span> xx'<span class="main">)</span><span class="main">)</span> <span class="main">(</span>neg <span class="main">(</span>PPf <span class="skolem">p</span> <span class="main">(</span><span class="free">Var</span> xx'<span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">bprv</span> <span class="main">(</span>neg <span class="var">?φ</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> 1 11 <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">intro</span> B.prv_imp_neg_allWI<span class="main"><span class="main">[</span></span><span class="keyword2"><span class="keyword"><span class="operator">where</span></span></span> t <span class="main"><span class="main"><span class="main">=</span></span></span> <span class="quoted"><span class="quoted">"<span class="main"><span class="free">⟨</span></span>neg φR<span class="main"><span class="free">⟩</span></span>"</span></span><span class="main"><span class="main">]</span></span><span class="main">)</span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">intro</span><span class="main"><span class="main">:</span></span> B.prv_prv_neg_imp_neg<span class="main">)</span>
    <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="free">prv</span> <span class="main">(</span>neg <span class="var">?φ</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">intro</span><span class="main"><span class="main">:</span></span> dwf_dwfd.d_dwf.bprv_prv'<span class="main">)</span>
    <span class="keyword1"><span class="command">hence</span></span> 00<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">prv</span> <span class="main">(</span><span class="free">imp</span> <span class="main">(</span>LLq <span class="skolem">p</span> <span class="main">(</span><span class="free">Var</span> yy<span class="main">)</span><span class="main">)</span>
                       <span class="main">(</span><span class="free">imp</span> <span class="main">(</span><span class="free">imp</span> <span class="main">(</span>LLq <span class="skolem">p</span> <span class="main">(</span><span class="free">Var</span> yy<span class="main">)</span><span class="main">)</span> <span class="var">?φ</span><span class="main">)</span> <span class="free">fls</span><span class="main">)</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">unfolding</span></span> neg_def<span class="main">[</span><span class="operator">symmetric</span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">intro</span> prv_imp_neg_imp_neg_imp<span class="main">)</span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">prv</span> <span class="main">(</span><span class="free">imp</span> <span class="main">(</span>LLq <span class="skolem">p</span> <span class="main">(</span><span class="free">Var</span> yy<span class="main">)</span><span class="main">)</span>
              <span class="main">(</span><span class="free">imp</span> <span class="main">(</span>RR <span class="main">(</span><span class="free">Var</span> yy<span class="main">)</span> <span class="main"><span class="free">⟨</span></span>φR<span class="main"><span class="free">⟩</span></span><span class="main">)</span> <span class="free">fls</span><span class="main">)</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">unfolding</span></span> neg_def<span class="main">[</span><span class="operator">symmetric</span><span class="main">]</span> <span class="keyword1"><span class="command">using</span></span> 00<span class="main">[</span><span class="operator">folded</span> neg_def<span class="main">]</span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> RR_def2 R_def <span class="quasi_keyword">intro</span><span class="main"><span class="main">!</span></span><span class="main"><span class="main">:</span></span> prv_imp_neg_allI<span class="main"><span class="main">[</span></span><span class="keyword2"><span class="keyword"><span class="operator">where</span></span></span> t <span class="main"><span class="main"><span class="main">=</span></span></span> <span class="quoted"><span class="skolem">p</span></span><span class="main"><span class="main">]</span></span><span class="main">)</span>
    <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"<span class="free">prv</span> <span class="main">(</span><span class="free">imp</span> <span class="main">(</span>LLq <span class="skolem">p</span> <span class="main">(</span><span class="free">Var</span> yy<span class="main">)</span><span class="main">)</span>
              <span class="main">(</span><span class="free">imp</span> <span class="main">(</span><span class="free">cnj</span> <span class="main">(</span>PPf <span class="main">(</span><span class="free">Var</span> yy<span class="main">)</span> <span class="main"><span class="free">⟨</span></span>φR<span class="main"><span class="free">⟩</span></span><span class="main">)</span> <span class="main">(</span>RR <span class="main">(</span><span class="free">Var</span> yy<span class="main">)</span> <span class="main"><span class="free">⟨</span></span>φR<span class="main"><span class="free">⟩</span></span><span class="main">)</span><span class="main">)</span> <span class="free">fls</span><span class="main">)</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">unfolding</span></span> neg_def<span class="main">[</span><span class="operator">symmetric</span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">intro</span> prv_imp_neg_imp_cnjR<span class="main">)</span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">qed</span></span><span class="main">(</span><span class="operator">auto</span><span class="main"><span class="keyword3">,</span></span> <span class="operator">insert</span> Var P<span class="main"><span class="main">(</span></span>1<span class="main"><span class="main">)</span></span> eql<span class="main"><span class="keyword3">,</span></span> <span class="operator">simp_all</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> set_rev_mp<span class="main">)</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="free">prv</span> <span class="main">(</span>neg <span class="main">(</span><span class="free">exi</span> yy <span class="main">(</span><span class="free">cnj</span> <span class="main">(</span>PPf <span class="main">(</span><span class="free">Var</span> yy<span class="main">)</span> <span class="main"><span class="free">⟨</span></span>φR<span class="main"><span class="free">⟩</span></span><span class="main">)</span> <span class="main">(</span>RR <span class="main">(</span><span class="free">Var</span> yy<span class="main">)</span> <span class="main"><span class="free">⟨</span></span>φR<span class="main"><span class="free">⟩</span></span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">unfolding</span></span> neg_def<span class="main">[</span><span class="operator">symmetric</span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">intro</span> prv_neg_neg_exi<span class="main">)</span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="free">prv</span> <span class="main">(</span>neg <span class="main">(</span>PP' <span class="main"><span class="free">⟨</span></span>φR<span class="main"><span class="free">⟩</span></span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> PP'_def P'_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="free">prv</span> φR"</span></span> <span class="keyword1"><span class="command">using</span></span> prv_φR_eqv <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">meson</span> PP' φR enc in_num neg prv_eqv_prv_rev<span class="main">)</span>
  <span class="keyword1"><span class="command">with</span></span> <span class="quoted"><span class="quoted">‹<span class="main">¬</span> <span class="free">prv</span> φR›</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted">False</span> <span class="keyword1"><span class="command">using</span></span> c <span class="keyword1"><span class="command">unfolding</span></span> consistent_def3 <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">theorem</span></span> goedel_rosser_first<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"consistent"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> <span class="free">prv</span> φR <span class="main">∧</span> <span class="main">¬</span> <span class="free">prv</span> <span class="main">(</span>neg φR<span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> assms goedel_rosser_first_theEasyHalf goedel_rosser_first_theHardHalf <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>

<span class="keyword1"><span class="command">theorem</span></span> goedel_rosser_first_ex<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"consistent"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span> <span class="bound">φ</span><span class="main">.</span> <span class="bound">φ</span> <span class="main">∈</span> <span class="free">fmla</span> <span class="main">∧</span> <span class="main">¬</span> <span class="free">prv</span> <span class="bound">φ</span> <span class="main">∧</span> <span class="main">¬</span> <span class="free">prv</span> <span class="main">(</span>neg <span class="bound">φ</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> assms goedel_rosser_first <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">intro</span> exI<span class="main"><span class="main">[</span></span><span class="operator">of</span> <span class="main"><span class="main">_</span></span> <span class="quoted">φR</span><span class="main"><span class="main">]</span></span><span class="main">)</span> <span class="operator">blast</span>

<span class="keyword2"><span class="keyword">end</span></span> <span class="comment1">― ‹context <span class="antiquoted"><span class="antiquote">@{</span><span class="operator">locale</span> Rosser_Form<span class="antiquote">}</span></span>›</span>


<span class="keyword1"><span class="command">section</span></span> <span class="quoted"><span class="plain_text">‹Model-Theoretic Versions›</span></span>

<span class="keyword1"><span class="command">subsection</span></span> <span class="quoted"><span class="plain_text">‹First model-theoretic version›</span></span>

<span class="keyword1"><span class="command">locale</span></span> Rosser_Form_Proofs_Minimal_Truth <span class="main">=</span>
Rosser_Form_Proofs
  <span class="quoted"><span class="free">var</span></span> <span class="quoted"><span class="free">trm</span></span> <span class="quoted"><span class="free">fmla</span></span> <span class="quoted"><span class="free">Var</span></span> <span class="quoted"><span class="free">FvarsT</span></span> <span class="quoted"><span class="free">substT</span></span> <span class="quoted"><span class="free">Fvars</span></span> <span class="quoted"><span class="free">subst</span></span>
  <span class="quoted"><span class="free">num</span></span>
  <span class="quoted"><span class="free">eql</span></span> <span class="quoted"><span class="free">cnj</span></span> <span class="quoted"><span class="free">imp</span></span> <span class="quoted"><span class="free">all</span></span> <span class="quoted"><span class="free">exi</span></span>
  <span class="quoted"><span class="free">fls</span></span>
  <span class="quoted"><span class="free">prv</span></span> <span class="quoted"><span class="free">bprv</span></span>
  <span class="quoted"><span class="free">Lq</span></span>
  <span class="quoted"><span class="free">dsj</span></span>
  <span class="quoted"><span class="quoted">"<span class="free">proof</span>"</span></span> <span class="quoted"><span class="free">prfOf</span></span>
  <span class="quoted"><span class="free">enc</span></span>
  <span class="quoted"><span class="free">N</span></span> <span class="quoted"><span class="free">S</span></span>
  <span class="quoted"><span class="free">encPf</span></span>
  <span class="quoted"><span class="free">Pf</span></span>
<span class="main">+</span>
Minimal_Truth_Soundness
  <span class="quoted"><span class="free">var</span></span> <span class="quoted"><span class="free">trm</span></span> <span class="quoted"><span class="free">fmla</span></span> <span class="quoted"><span class="free">Var</span></span> <span class="quoted"><span class="free">FvarsT</span></span> <span class="quoted"><span class="free">substT</span></span> <span class="quoted"><span class="free">Fvars</span></span> <span class="quoted"><span class="free">subst</span></span>
  <span class="quoted"><span class="free">eql</span></span> <span class="quoted"><span class="free">cnj</span></span> <span class="quoted"><span class="free">imp</span></span> <span class="quoted"><span class="free">all</span></span> <span class="quoted"><span class="free">exi</span></span>
  <span class="quoted"><span class="free">fls</span></span>
  <span class="quoted"><span class="free">dsj</span></span>
  <span class="quoted"><span class="free">num</span></span>
  <span class="quoted"><span class="free">bprv</span></span>
  <span class="quoted"><span class="free">isTrue</span></span>
<span class="keyword2"><span class="keyword">for</span></span>
<span class="free">var</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'var</span> set"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="free">trm</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'trm</span> set"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="free">fmla</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'fmla</span> set"</span></span>
<span class="keyword2"><span class="keyword">and</span></span> <span class="free">Var</span> <span class="free">FvarsT</span> <span class="free">substT</span> <span class="free">Fvars</span> <span class="free">subst</span>
<span class="keyword2"><span class="keyword">and</span></span> <span class="free">eql</span> <span class="free">cnj</span> <span class="free">imp</span> <span class="free">all</span> <span class="free">exi</span>
<span class="keyword2"><span class="keyword">and</span></span> <span class="free">fls</span>
<span class="keyword2"><span class="keyword">and</span></span> <span class="free">dsj</span>
<span class="keyword2"><span class="keyword">and</span></span> <span class="free">num</span>
<span class="keyword2"><span class="keyword">and</span></span> <span class="free">Lq</span>
<span class="keyword2"><span class="keyword">and</span></span> <span class="free">prv</span> <span class="free">bprv</span>
<span class="keyword2"><span class="keyword">and</span></span> <span class="free">enc</span> <span class="main">(</span><span class="quoted">"<span class="keyword1">⟨</span>_<span class="keyword1">⟩</span>"</span><span class="main">)</span>
<span class="keyword2"><span class="keyword">and</span></span> <span class="free">N</span> <span class="free">S</span> <span class="free">P</span>
<span class="keyword2"><span class="keyword">and</span></span> <span class="quoted">"<span class="free">proof</span>"</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'proof</span> set"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="free">prfOf</span> <span class="free">encPf</span>
<span class="keyword2"><span class="keyword">and</span></span> <span class="free">Pf</span>
<span class="keyword2"><span class="keyword">and</span></span> <span class="free">isTrue</span>
<span class="keyword2"><span class="keyword">begin</span></span>

<span class="keyword1"><span class="command">lemma</span></span> Fvars_PP'<span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">Fvars</span> <span class="main">(</span>PP' <span class="main"><span class="free">⟨</span></span>φR<span class="main"><span class="free">⟩</span></span><span class="main">)</span> <span class="main">=</span> <span class="main">{}</span>"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> PP'_def
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">subst</span> Fvars_subst<span class="main">)</span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">lemma</span></span> Fvars_RR'<span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">Fvars</span> <span class="main">(</span>RR <span class="main">(</span><span class="free">Var</span> yy<span class="main">)</span> <span class="main"><span class="free">⟨</span></span>φR<span class="main"><span class="free">⟩</span></span><span class="main">)</span> <span class="main">=</span> <span class="main">{</span>yy<span class="main">}</span>"</span></span>
  <span class="keyword1"><span class="command">unfolding</span></span> RR_def
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">subst</span> Fvars_psubst<span class="main">)</span> <span class="main">(</span><span class="operator">fastforce</span> <span class="quasi_keyword">intro</span><span class="main"><span class="main">!</span></span><span class="main"><span class="main">:</span></span> exI<span class="main"><span class="main">[</span></span><span class="operator">of</span> <span class="main"><span class="main">_</span></span> <span class="quoted"><span class="quoted">"<span class="main">{</span>yy<span class="main">}</span>"</span></span><span class="main"><span class="main">]</span></span><span class="main">)</span><span class="main"><span class="keyword3">+</span></span>

<span class="keyword1"><span class="command">lemma</span></span> isTrue_PPf_implies_φR<span class="main">:</span>
<span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">isTrue</span> <span class="main">(</span><span class="free">all</span> yy <span class="main">(</span>neg <span class="main">(</span>PPf <span class="main">(</span><span class="free">Var</span> yy<span class="main">)</span> <span class="main"><span class="free">⟨</span></span>φR<span class="main"><span class="free">⟩</span></span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span>
<span class="main">(</span><span class="keyword2"><span class="keyword">is</span></span> <span class="quoted"><span class="quoted">"<span class="free">isTrue</span> <span class="var">?H</span>"</span></span><span class="main">)</span>
<span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">isTrue</span> φR"</span></span>
<span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
  <span class="keyword3"><span class="command">define</span></span> <span class="skolem"><span class="skolem">F</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">F</span> <span class="main">≡</span> RR <span class="main">(</span><span class="free">Var</span> yy<span class="main">)</span> <span class="main"><span class="free">⟨</span></span>φR<span class="main"><span class="free">⟩</span></span>"</span></span>
  <span class="keyword1"><span class="command">have</span></span> <span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">F</span> <span class="main">∈</span> <span class="free">fmla</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="free">Fvars</span> <span class="skolem">F</span> <span class="main">=</span> <span class="main">{</span>yy<span class="main">}</span>"</span></span>
    <span class="keyword1"><span class="command">unfolding</span></span> F_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">exi</span> yy <span class="main">(</span>PPf <span class="main">(</span><span class="free">Var</span> yy<span class="main">)</span> <span class="main"><span class="free">⟨</span></span>φR<span class="main"><span class="free">⟩</span></span><span class="main">)</span> <span class="main">∈</span> <span class="free">fmla</span>"</span></span>
    <span class="keyword1"><span class="command">unfolding</span></span> PPf_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

  <span class="keyword1"><span class="command">have</span></span> 1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">bprv</span>
     <span class="main">(</span><span class="free">imp</span> <span class="main">(</span><span class="free">all</span> yy <span class="main">(</span>neg <span class="main">(</span>PPf <span class="main">(</span><span class="free">Var</span> yy<span class="main">)</span> <span class="main"><span class="free">⟨</span></span>φR<span class="main"><span class="free">⟩</span></span><span class="main">)</span><span class="main">)</span><span class="main">)</span>
       <span class="main">(</span>neg <span class="main">(</span><span class="free">exi</span> yy <span class="main">(</span>PPf <span class="main">(</span><span class="free">Var</span> yy<span class="main">)</span> <span class="main"><span class="free">⟨</span></span>φR<span class="main"><span class="free">⟩</span></span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span>
  <span class="main">(</span><span class="keyword2"><span class="keyword">is</span></span> <span class="quoted"><span class="quoted">"<span class="free">bprv</span> <span class="main">(</span><span class="free">imp</span> <span class="main">(</span><span class="free">all</span> yy <span class="main">(</span>neg <span class="var">?G</span><span class="main">)</span><span class="main">)</span> <span class="main">(</span>neg <span class="main">(</span><span class="free">exi</span> yy <span class="var">?G</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span><span class="main">)</span>
    <span class="keyword1"><span class="command">using</span></span> B.prv_all_neg_imp_neg_exi<span class="main">[</span><span class="operator">of</span> <span class="quoted">yy</span> <span class="var"><span class="quoted"><span class="var">?G</span></span></span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">have</span></span> 2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">bprv</span> <span class="main">(</span><span class="free">imp</span> <span class="main">(</span>neg <span class="main">(</span><span class="free">exi</span> yy <span class="var">?G</span><span class="main">)</span><span class="main">)</span> <span class="main">(</span>neg <span class="main">(</span><span class="free">exi</span> yy <span class="main">(</span><span class="free">cnj</span> <span class="var">?G</span> <span class="skolem">F</span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">intro</span><span class="main"><span class="main">!</span></span><span class="main"><span class="main">:</span></span> B.prv_imp_neg_rev B.prv_exi_cong B.prv_imp_cnjL<span class="main">)</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">bprv</span> <span class="main">(</span><span class="free">imp</span> <span class="main">(</span><span class="free">all</span> yy <span class="main">(</span>neg <span class="var">?G</span><span class="main">)</span><span class="main">)</span> <span class="main">(</span>neg <span class="main">(</span><span class="free">exi</span> yy <span class="main">(</span><span class="free">cnj</span> <span class="var">?G</span> <span class="skolem">F</span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> B.prv_prv_imp_trans<span class="main">[</span><span class="operator">OF</span> _ _ _  1 2<span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="free">bprv</span> <span class="main">(</span><span class="free">imp</span> <span class="var">?H</span> <span class="main">(</span>neg <span class="main">(</span>PP' <span class="main"><span class="free">⟨</span></span>φR<span class="main"><span class="free">⟩</span></span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">unfolding</span></span> PP'_def P'_def
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> F_def<span class="main">)</span>
  <span class="keyword1"><span class="command">from</span></span> B.prv_prv_imp_trans<span class="main">[</span><span class="operator">OF</span> _ _ _  this bprv_imp_φR<span class="main">]</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">bprv</span> <span class="main">(</span><span class="free">imp</span> <span class="var">?H</span> φR<span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">from</span></span> prv_imp_implies_isTrue<span class="main">[</span><span class="operator">OF</span> _ _ _ _ this assms<span class="main">,</span> <span class="operator">simplified</span><span class="main">]</span>
  <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">.</span></span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">theorem</span></span> isTrue_φR<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"consistent"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">isTrue</span> φR"</span></span>
<span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span> <span class="bound">n</span> <span class="main">∈</span> <span class="free">num</span><span class="main">.</span> <span class="free">bprv</span> <span class="main">(</span>neg <span class="main">(</span>PPf <span class="bound">n</span> <span class="main"><span class="free">⟨</span></span>φR<span class="main"><span class="free">⟩</span></span><span class="main">)</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> not_prv_prv_neg_PPf<span class="main">[</span><span class="operator">OF</span> _ _ goedel_rosser_first_theEasyHalf<span class="main"><span class="main">[</span></span><span class="operator">OF</span> assms<span class="main"><span class="main">]</span></span><span class="main">]</span>
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span> <span class="bound">n</span> <span class="main">∈</span> <span class="free">num</span><span class="main">.</span> <span class="free">isTrue</span> <span class="main">(</span>neg <span class="main">(</span>PPf <span class="bound">n</span> <span class="main"><span class="free">⟨</span></span>φR<span class="main"><span class="free">⟩</span></span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">intro</span><span class="main"><span class="main">:</span></span> sound_isTrue<span class="main">)</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="free">isTrue</span> <span class="main">(</span><span class="free">all</span> yy <span class="main">(</span>neg <span class="main">(</span>PPf <span class="main">(</span><span class="free">Var</span> yy<span class="main">)</span> <span class="main"><span class="free">⟨</span></span>φR<span class="main"><span class="free">⟩</span></span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">intro</span><span class="main"><span class="main">:</span></span> isTrue_all<span class="main">)</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> isTrue_PPf_implies_φR <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>


<span class="keyword1"><span class="command">theorem</span></span> goedel_rosser_first_strong<span class="main">:</span> <span class="quoted"><span class="quoted">"consistent <span class="main">⟹</span> <span class="main">¬</span> <span class="free">prv</span> φR <span class="main">∧</span> <span class="main">¬</span> <span class="free">prv</span> <span class="main">(</span>neg φR<span class="main">)</span> <span class="main">∧</span> <span class="free">isTrue</span> φR"</span></span>
  <span class="keyword1"><span class="command">using</span></span> isTrue_φR goedel_rosser_first <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>

<span class="keyword1"><span class="command">theorem</span></span> goedel_rosser_first_strong_ex<span class="main">:</span>
<span class="quoted"><span class="quoted">"consistent <span class="main">⟹</span> <span class="main">∃</span> <span class="bound">φ</span><span class="main">.</span> <span class="bound">φ</span> <span class="main">∈</span> <span class="free">fmla</span> <span class="main">∧</span> <span class="main">¬</span> <span class="free">prv</span> <span class="bound">φ</span> <span class="main">∧</span> <span class="main">¬</span> <span class="free">prv</span> <span class="main">(</span>neg <span class="bound">φ</span><span class="main">)</span> <span class="main">∧</span> <span class="free">isTrue</span> <span class="bound">φ</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> goedel_rosser_first_strong <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">intro</span> exI<span class="main"><span class="main">[</span></span><span class="operator">of</span> <span class="main"><span class="main">_</span></span> <span class="quoted">φR</span><span class="main"><span class="main">]</span></span><span class="main">)</span> <span class="operator">blast</span>

<span class="keyword2"><span class="keyword">end</span></span> <span class="comment1">― ‹context <span class="antiquoted"><span class="antiquote">@{</span><span class="operator">locale</span> Rosser_Form_Proofs_Minimal_Truth<span class="antiquote">}</span></span>›</span>


<span class="keyword1"><span class="command">subsection</span></span> <span class="quoted"><span class="plain_text">‹Second model-theoretic version›</span></span>

<span class="keyword1"><span class="command">context</span></span> Rosser_Form
<span class="keyword2"><span class="keyword">begin</span></span>
<span class="keyword1"><span class="command">print_context</span></span>
<span class="keyword2"><span class="keyword">end</span></span>

<span class="keyword1"><span class="command">locale</span></span> Rosser_Form_Minimal_Truth_Soundness_HBL1iff_Compl_Pf <span class="main">=</span>
Rosser_Form
  <span class="quoted"><span class="free">var</span></span> <span class="quoted"><span class="free">trm</span></span> <span class="quoted"><span class="free">fmla</span></span> <span class="quoted"><span class="free">Var</span></span>
  <span class="quoted"><span class="free">FvarsT</span></span> <span class="quoted"><span class="free">substT</span></span> <span class="quoted"><span class="free">Fvars</span></span> <span class="quoted"><span class="free">subst</span></span>
  <span class="quoted"><span class="free">num</span></span>
  <span class="quoted"><span class="free">eql</span></span> <span class="quoted"><span class="free">cnj</span></span> <span class="quoted"><span class="free">imp</span></span> <span class="quoted"><span class="free">all</span></span> <span class="quoted"><span class="free">exi</span></span>
  <span class="quoted"><span class="free">fls</span></span>
  <span class="quoted"><span class="free">prv</span></span> <span class="quoted"><span class="free">bprv</span></span>
  <span class="quoted"><span class="free">Lq</span></span>
  <span class="quoted"><span class="free">dsj</span></span>
  <span class="quoted"><span class="free">enc</span></span>
  <span class="quoted"><span class="free">N</span></span>
  <span class="quoted"><span class="free">S</span></span>
  <span class="quoted"><span class="free">P</span></span>
<span class="main">+</span>
Minimal_Truth_Soundness_HBL1iff_Compl_Pf
  <span class="quoted"><span class="free">var</span></span> <span class="quoted"><span class="free">trm</span></span> <span class="quoted"><span class="free">fmla</span></span> <span class="quoted"><span class="free">Var</span></span> <span class="quoted"><span class="free">FvarsT</span></span> <span class="quoted"><span class="free">substT</span></span> <span class="quoted"><span class="free">Fvars</span></span> <span class="quoted"><span class="free">subst</span></span>
  <span class="quoted"><span class="free">eql</span></span> <span class="quoted"><span class="free">cnj</span></span> <span class="quoted"><span class="free">imp</span></span> <span class="quoted"><span class="free">all</span></span> <span class="quoted"><span class="free">exi</span></span>
  <span class="quoted"><span class="free">fls</span></span>
  <span class="quoted"><span class="free">dsj</span></span>
  <span class="quoted"><span class="free">num</span></span>
  <span class="quoted"><span class="free">enc</span></span>
  <span class="quoted"><span class="free">prv</span></span> <span class="quoted"><span class="free">bprv</span></span>
  <span class="quoted"><span class="free">P</span></span>
  <span class="quoted"><span class="free">isTrue</span></span>
  <span class="quoted"><span class="free">Pf</span></span>
<span class="keyword2"><span class="keyword">for</span></span>
<span class="free">var</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'var</span> set"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="free">trm</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'trm</span> set"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="free">fmla</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'fmla</span> set"</span></span>
<span class="keyword2"><span class="keyword">and</span></span> <span class="free">Var</span> <span class="free">FvarsT</span> <span class="free">substT</span> <span class="free">Fvars</span> <span class="free">subst</span>
<span class="keyword2"><span class="keyword">and</span></span> <span class="free">eql</span> <span class="free">cnj</span> <span class="free">imp</span> <span class="free">all</span> <span class="free">exi</span>
<span class="keyword2"><span class="keyword">and</span></span> <span class="free">fls</span>
<span class="keyword2"><span class="keyword">and</span></span> <span class="free">dsj</span>
<span class="keyword2"><span class="keyword">and</span></span> <span class="free">num</span>
<span class="keyword2"><span class="keyword">and</span></span> <span class="free">prv</span> <span class="free">bprv</span>
<span class="keyword2"><span class="keyword">and</span></span> <span class="free">Lq</span>
<span class="keyword2"><span class="keyword">and</span></span> <span class="free">enc</span> <span class="main">(</span><span class="quoted">"<span class="keyword1">⟨</span>_<span class="keyword1">⟩</span>"</span><span class="main">)</span>
<span class="keyword2"><span class="keyword">and</span></span> <span class="free">N</span> <span class="free">S</span>
<span class="keyword2"><span class="keyword">and</span></span> <span class="free">isTrue</span>
<span class="keyword2"><span class="keyword">and</span></span> <span class="free">P</span> <span class="free">Pf</span>



<span class="keyword1"><span class="command">locale</span></span> Rosser_Form_Minimal_Truth_Soundness_HBL1iff_Compl_Pf_Compl_NegPf <span class="main">=</span>
Rosser_Form_Minimal_Truth_Soundness_HBL1iff_Compl_Pf
  <span class="quoted"><span class="free">var</span></span> <span class="quoted"><span class="free">trm</span></span> <span class="quoted"><span class="free">fmla</span></span> <span class="quoted"><span class="free">Var</span></span> <span class="quoted"><span class="free">FvarsT</span></span> <span class="quoted"><span class="free">substT</span></span> <span class="quoted"><span class="free">Fvars</span></span> <span class="quoted"><span class="free">subst</span></span>
  <span class="quoted"><span class="free">eql</span></span> <span class="quoted"><span class="free">cnj</span></span> <span class="quoted"><span class="free">imp</span></span> <span class="quoted"><span class="free">all</span></span> <span class="quoted"><span class="free">exi</span></span>
  <span class="quoted"><span class="free">fls</span></span>
  <span class="quoted"><span class="free">dsj</span></span>
  <span class="quoted"><span class="free">num</span></span>
  <span class="quoted"><span class="free">prv</span></span> <span class="quoted"><span class="free">bprv</span></span>
  <span class="quoted"><span class="free">Lq</span></span>
  <span class="quoted"><span class="free">enc</span></span>
  <span class="quoted"><span class="free">N</span></span> <span class="quoted"><span class="free">S</span></span>
  <span class="quoted"><span class="free">isTrue</span></span>
  <span class="quoted"><span class="free">P</span></span>
  <span class="quoted"><span class="free">Pf</span></span>
<span class="main">+</span>
M <span class="main">:</span> Minimal_Truth_Soundness_HBL1iff_Compl_Pf_Compl_NegPf
  <span class="quoted"><span class="free">var</span></span> <span class="quoted"><span class="free">trm</span></span> <span class="quoted"><span class="free">fmla</span></span> <span class="quoted"><span class="free">Var</span></span> <span class="quoted"><span class="free">FvarsT</span></span> <span class="quoted"><span class="free">substT</span></span> <span class="quoted"><span class="free">Fvars</span></span> <span class="quoted"><span class="free">subst</span></span>
  <span class="quoted"><span class="free">eql</span></span> <span class="quoted"><span class="free">cnj</span></span> <span class="quoted"><span class="free">imp</span></span> <span class="quoted"><span class="free">all</span></span> <span class="quoted"><span class="free">exi</span></span>
  <span class="quoted"><span class="free">fls</span></span>
  <span class="quoted"><span class="free">dsj</span></span>
  <span class="quoted"><span class="free">num</span></span>
  <span class="quoted"><span class="free">enc</span></span>
  <span class="quoted"><span class="free">prv</span></span> <span class="quoted"><span class="free">bprv</span></span>
  <span class="quoted"><span class="free">N</span></span>
  <span class="quoted"><span class="free">isTrue</span></span>
  <span class="quoted"><span class="free">Pf</span></span>
<span class="keyword2"><span class="keyword">for</span></span>
<span class="free">var</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'var</span> set"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="free">trm</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'trm</span> set"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="free">fmla</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'fmla</span> set"</span></span>
<span class="keyword2"><span class="keyword">and</span></span> <span class="free">Var</span> <span class="free">FvarsT</span> <span class="free">substT</span> <span class="free">Fvars</span> <span class="free">subst</span>
<span class="keyword2"><span class="keyword">and</span></span> <span class="free">eql</span> <span class="free">cnj</span> <span class="free">imp</span> <span class="free">all</span> <span class="free">exi</span>
<span class="keyword2"><span class="keyword">and</span></span> <span class="free">fls</span>
<span class="keyword2"><span class="keyword">and</span></span> <span class="free">dsj</span>
<span class="keyword2"><span class="keyword">and</span></span> <span class="free">num</span>
<span class="keyword2"><span class="keyword">and</span></span> <span class="free">prv</span> <span class="free">bprv</span>
<span class="keyword2"><span class="keyword">and</span></span> <span class="free">Lq</span>
<span class="keyword2"><span class="keyword">and</span></span> <span class="free">enc</span> <span class="main">(</span><span class="quoted">"<span class="keyword1">⟨</span>_<span class="keyword1">⟩</span>"</span><span class="main">)</span>
<span class="keyword2"><span class="keyword">and</span></span> <span class="free">N</span> <span class="free">S</span> <span class="free">P</span>
<span class="keyword2"><span class="keyword">and</span></span> <span class="free">isTrue</span>
<span class="keyword2"><span class="keyword">and</span></span> <span class="free">Pf</span>

<span class="keyword1"><span class="command">sublocale</span></span>
  Rosser_Form_Minimal_Truth_Soundness_HBL1iff_Compl_Pf_Compl_NegPf <span class="main">&lt;</span>
  recover_proofs<span class="main">:</span> Rosser_Form_Proofs_Minimal_Truth
  <span class="keyword2"><span class="keyword">where</span></span> prfOf <span class="main">=</span> <span class="quoted">prfOf</span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted">"proof"</span> <span class="main">=</span> <span class="quoted"><span class="quoted">"proof"</span></span> <span class="keyword2"><span class="keyword">and</span></span> encPf <span class="main">=</span> <span class="quoted">encPf</span>
  <span class="keyword2"><span class="keyword">and</span></span> prv <span class="main">=</span> <span class="quoted"><span class="free">prv</span></span> <span class="keyword2"><span class="keyword">and</span></span> bprv <span class="main">=</span> <span class="quoted"><span class="free">bprv</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="operator">standard</span>

<span class="keyword1"><span class="command">context</span></span> Rosser_Form_Minimal_Truth_Soundness_HBL1iff_Compl_Pf_Compl_NegPf
<span class="keyword2"><span class="keyword">begin</span></span>
<span class="keyword1"><span class="command">thm</span></span> recover_proofs.goedel_rosser_first_strong
<span class="keyword2"><span class="keyword">end</span></span>

<span class="comment1">(*&lt;*)</span>
<span class="keyword2"><span class="keyword">end</span></span>
<span class="comment1">(*&gt;*)</span>

</pre>
</div><div id="Abstract_Second_Goedel">
<div class="head">
<h1>Theory Abstract_Second_Goedel</h1>
</div>
<pre class="source"><span class="keyword1"><span class="command">chapter</span></span> <span class="quoted"><span class="plain_text">‹Abstract Formulation of Gödel's Second Incompleteness Theorem›</span></span>

<span class="comment1">(*&lt;*)</span>
<span class="keyword1"><span class="command">theory</span></span> Abstract_Second_Goedel <span class="keyword2"><span class="keyword">imports</span></span> <a href="Abstract_First_Goedel.html">Abstract_First_Goedel</a> <a href="Derivability_Conditions.html">Derivability_Conditions</a>
<span class="keyword2"><span class="keyword">begin</span></span>
<span class="comment1">(*&gt;*)</span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹We assume all three derivability conditions, and assumptions
behind Gödel formulas:›</span></span>
<span class="keyword1"><span class="command">locale</span></span> Goedel_Second_Assumptions <span class="main">=</span>
HBL1_2_3
  <span class="quoted"><span class="free">var</span></span> <span class="quoted"><span class="free">trm</span></span> <span class="quoted"><span class="free">fmla</span></span> <span class="quoted"><span class="free">Var</span></span> <span class="quoted"><span class="free">FvarsT</span></span> <span class="quoted"><span class="free">substT</span></span> <span class="quoted"><span class="free">Fvars</span></span> <span class="quoted"><span class="free">subst</span></span>
  <span class="quoted"><span class="free">num</span></span>
  <span class="quoted"><span class="free">eql</span></span> <span class="quoted"><span class="free">cnj</span></span> <span class="quoted"><span class="free">imp</span></span> <span class="quoted"><span class="free">all</span></span> <span class="quoted"><span class="free">exi</span></span>
  <span class="quoted"><span class="free">prv</span></span> <span class="quoted"><span class="free">bprv</span></span>
  <span class="quoted"><span class="free">enc</span></span>
  <span class="quoted"><span class="free">P</span></span>
<span class="main">+</span>
Goedel_Form
  <span class="quoted"><span class="free">var</span></span> <span class="quoted"><span class="free">trm</span></span> <span class="quoted"><span class="free">fmla</span></span> <span class="quoted"><span class="free">Var</span></span> <span class="quoted"><span class="free">num</span></span> <span class="quoted"><span class="free">FvarsT</span></span> <span class="quoted"><span class="free">substT</span></span> <span class="quoted"><span class="free">Fvars</span></span> <span class="quoted"><span class="free">subst</span></span>
  <span class="quoted"><span class="free">eql</span></span> <span class="quoted"><span class="free">cnj</span></span> <span class="quoted"><span class="free">imp</span></span> <span class="quoted"><span class="free">all</span></span> <span class="quoted"><span class="free">exi</span></span>
  <span class="quoted"><span class="free">fls</span></span>
  <span class="quoted"><span class="free">prv</span></span> <span class="quoted"><span class="free">bprv</span></span>
  <span class="quoted"><span class="free">enc</span></span>
  <span class="quoted"><span class="free">S</span></span>
  <span class="quoted"><span class="free">P</span></span>
<span class="keyword2"><span class="keyword">for</span></span>
<span class="free">var</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'var</span> set"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="free">trm</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'trm</span> set"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="free">fmla</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'fmla</span> set"</span></span>
<span class="keyword2"><span class="keyword">and</span></span> <span class="free">Var</span> <span class="free">FvarsT</span> <span class="free">substT</span> <span class="free">Fvars</span> <span class="free">subst</span>
<span class="keyword2"><span class="keyword">and</span></span> <span class="free">num</span>
<span class="keyword2"><span class="keyword">and</span></span> <span class="free">eql</span> <span class="free">cnj</span> <span class="free">imp</span> <span class="free">all</span> <span class="free">exi</span>
<span class="keyword2"><span class="keyword">and</span></span> <span class="free">prv</span> <span class="free">bprv</span>
<span class="keyword2"><span class="keyword">and</span></span> <span class="free">enc</span> <span class="main">(</span><span class="quoted">"<span class="keyword1">⟨</span>_<span class="keyword1">⟩</span>"</span><span class="main">)</span>
<span class="keyword2"><span class="keyword">and</span></span> <span class="free">S</span>
<span class="keyword2"><span class="keyword">and</span></span> <span class="free">P</span>
<span class="keyword2"><span class="keyword">and</span></span> <span class="free">fls</span>
<span class="keyword2"><span class="keyword">begin</span></span>

<span class="keyword1"><span class="command">lemma</span></span> P_G<span class="main">:</span>
<span class="quoted"><span class="quoted">"<span class="free">bprv</span> <span class="main">(</span><span class="free">imp</span> <span class="main">(</span>PP <span class="main"><span class="free">⟨</span></span>φG<span class="main"><span class="free">⟩</span></span><span class="main">)</span> <span class="main">(</span>PP <span class="main"><span class="free">⟨</span></span><span class="free">fls</span><span class="main"><span class="free">⟩</span></span><span class="main">)</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> 0<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">prv</span> <span class="main">(</span><span class="free">imp</span> φG <span class="main">(</span>neg <span class="main">(</span>PP <span class="main"><span class="free">⟨</span></span>φG<span class="main"><span class="free">⟩</span></span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> prv_φG_eqv <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">intro</span> prv_imp_eqvEL<span class="main">)</span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">have</span></span> 1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">bprv</span> <span class="main">(</span>PP <span class="main"><span class="free">⟨</span></span><span class="free">imp</span> φG <span class="main">(</span>neg <span class="main">(</span>PP <span class="main"><span class="free">⟨</span></span>φG<span class="main"><span class="free">⟩</span></span><span class="main">)</span><span class="main">)</span><span class="main"><span class="free">⟩</span></span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> HBL1_PP<span class="main">[</span><span class="operator">OF</span> _ _ 0<span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">have</span></span> 2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">bprv</span> <span class="main">(</span><span class="free">imp</span> <span class="main">(</span>PP <span class="main"><span class="free">⟨</span></span>φG<span class="main"><span class="free">⟩</span></span><span class="main">)</span> <span class="main">(</span>PP <span class="main"><span class="free">⟨</span></span>neg <span class="main">(</span>PP <span class="main"><span class="free">⟨</span></span>φG<span class="main"><span class="free">⟩</span></span><span class="main">)</span><span class="main"><span class="free">⟩</span></span><span class="main">)</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> HBL2_imp2<span class="main">[</span><span class="operator">OF</span> _ _  _ _ 1<span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">have</span></span> 3<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">bprv</span> <span class="main">(</span><span class="free">imp</span> <span class="main">(</span>PP <span class="main"><span class="free">⟨</span></span>φG<span class="main"><span class="free">⟩</span></span><span class="main">)</span> <span class="main">(</span>PP <span class="main"><span class="free">⟨</span></span>PP <span class="main"><span class="free">⟨</span></span>φG<span class="main"><span class="free">⟩</span></span><span class="main"><span class="free">⟩</span></span><span class="main">)</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> HBL3<span class="main">[</span><span class="operator">OF</span> φG<span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">have</span></span> 23<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">bprv</span> <span class="main">(</span><span class="free">imp</span> <span class="main">(</span>PP <span class="main"><span class="free">⟨</span></span>φG<span class="main"><span class="free">⟩</span></span><span class="main">)</span>
                      <span class="main">(</span><span class="free">cnj</span> <span class="main">(</span>PP <span class="main"><span class="free">⟨</span></span>PP <span class="main"><span class="free">⟨</span></span>φG<span class="main"><span class="free">⟩</span></span><span class="main"><span class="free">⟩</span></span><span class="main">)</span>
                           <span class="main">(</span>PP <span class="main"><span class="free">⟨</span></span>neg <span class="main">(</span>PP <span class="main"><span class="free">⟨</span></span>φG<span class="main"><span class="free">⟩</span></span><span class="main">)</span><span class="main"><span class="free">⟩</span></span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> B.prv_imp_cnj<span class="main">[</span><span class="operator">OF</span> _ _ _ 3 2<span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">have</span></span> 4<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">bprv</span> <span class="main">(</span><span class="free">imp</span> <span class="main">(</span><span class="free">cnj</span> <span class="main">(</span>PP <span class="main"><span class="free">⟨</span></span>PP <span class="main"><span class="free">⟨</span></span>φG<span class="main"><span class="free">⟩</span></span><span class="main"><span class="free">⟩</span></span><span class="main">)</span>
                          <span class="main">(</span>PP <span class="main"><span class="free">⟨</span></span>neg <span class="main">(</span>PP <span class="main"><span class="free">⟨</span></span>φG<span class="main"><span class="free">⟩</span></span><span class="main">)</span><span class="main"><span class="free">⟩</span></span><span class="main">)</span><span class="main">)</span>
                     <span class="main">(</span>PP <span class="main"><span class="free">⟨</span></span><span class="free">fls</span><span class="main"><span class="free">⟩</span></span><span class="main">)</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> HBL2<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="quoted">"PP <span class="main"><span class="free">⟨</span></span>φG<span class="main"><span class="free">⟩</span></span>"</span></span> <span class="quoted"><span class="free">fls</span></span><span class="main">]</span> <span class="keyword1"><span class="command">unfolding</span></span> neg_def<span class="main">[</span><span class="operator">symmetric</span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> B.prv_prv_imp_trans<span class="main">[</span><span class="operator">OF</span> _ _ _ 23 4<span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹First the "direct", positive formulation:›</span></span>
<span class="keyword1"><span class="command">lemma</span></span> goedel_second_pos<span class="main">:</span>
<span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">prv</span> <span class="main">(</span>neg <span class="main">(</span>PP <span class="main"><span class="free">⟨</span></span><span class="free">fls</span><span class="main"><span class="free">⟩</span></span><span class="main">)</span><span class="main">)</span>"</span></span>
<span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">prv</span> <span class="free">fls</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
  <span class="keyword1"><span class="command">note</span></span> PG <span class="main">=</span> bprv_prv<span class="main">[</span><span class="operator">OF</span> _ _ P_G<span class="main">,</span> <span class="operator">simplified</span><span class="main">]</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">prv</span> <span class="main">(</span>neg <span class="main">(</span>PP <span class="main"><span class="free">⟨</span></span>φG<span class="main"><span class="free">⟩</span></span><span class="main">)</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> PG assms <span class="keyword1"><span class="command">unfolding</span></span> neg_def <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> prv_prv_imp_trans<span class="main"><span class="main">[</span></span><span class="operator">rotated</span> 3<span class="main"><span class="main">]</span></span><span class="main">)</span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="free">prv</span> φG"</span></span> <span class="keyword1"><span class="command">using</span></span> prv_φG_eqv <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> prv_eqv_prv_rev<span class="main"><span class="main">[</span></span><span class="operator">rotated</span> 2<span class="main"><span class="main">]</span></span><span class="main">)</span> <span class="operator">auto</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
  <span class="comment1">―‹The only part of Goedel's first theorem that is needed:›</span>
  <span class="keyword1"><span class="command">using</span></span> goedel_first_theEasyHalf_pos <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹Then the more standard, counterpositive formulation:›</span></span>
<span class="keyword1"><span class="command">theorem</span></span> goedel_second<span class="main">:</span>
<span class="quoted"><span class="quoted">"consistent <span class="main">⟹</span> <span class="main">¬</span> <span class="free">prv</span> <span class="main">(</span>neg <span class="main">(</span>PP <span class="main"><span class="free">⟨</span></span><span class="free">fls</span><span class="main"><span class="free">⟩</span></span><span class="main">)</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">using</span></span> goedel_second_pos <span class="keyword1"><span class="command">unfolding</span></span> consistent_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>


<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹It is an immediate consequence of Gödel's Second HLB1, HLB2 that
(assuming consistency)  <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">term</span></span> <span class="quoted"><span class="quoted">"<span class="free"><span class="free">prv</span></span> <span class="main"><span class="main">(</span></span>neg <span class="main"><span class="main">(</span></span>PP <span class="main"><span class="free"><span class="main"><span class="free">⟨</span></span></span></span><span class="free"><span class="free">φ</span></span><span class="main"><span class="free"><span class="main"><span class="free">⟩</span></span></span></span><span class="main"><span class="main">)</span></span><span class="main"><span class="main">)</span></span>"</span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span> holds for no sentence, be it
provable or not. The theory is omniscient about what it can prove
(thanks to HLB1), but completely ignorant about what it cannot prove.›</span></span>

<span class="keyword1"><span class="command">corollary</span></span> not_prv_neg_PP<span class="main">:</span>
<span class="keyword2"><span class="keyword">assumes</span></span> c<span class="main">:</span> <span class="quoted"><span class="quoted">"consistent"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">φ</span> <span class="main">∈</span> <span class="free">fmla</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="free">Fvars</span> <span class="free">φ</span> <span class="main">=</span> <span class="main">{}</span>"</span></span>
<span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> <span class="free">prv</span> <span class="main">(</span>neg <span class="main">(</span>PP <span class="main"><span class="free">⟨</span></span><span class="free">φ</span><span class="main"><span class="free">⟩</span></span><span class="main">)</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span>
  <span class="keyword3"><span class="command">assume</span></span> 0<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">prv</span> <span class="main">(</span>neg <span class="main">(</span>PP <span class="main"><span class="free">⟨</span></span><span class="free">φ</span><span class="main"><span class="free">⟩</span></span><span class="main">)</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">prv</span> <span class="main">(</span><span class="free">imp</span> <span class="free">fls</span> <span class="free">φ</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="free">bprv</span> <span class="main">(</span>PP <span class="main"><span class="free">⟨</span></span><span class="free">imp</span> <span class="free">fls</span> <span class="free">φ</span><span class="main"><span class="free">⟩</span></span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">intro</span> HBL1_PP<span class="main">)</span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="free">bprv</span> <span class="main">(</span><span class="free">imp</span> <span class="main">(</span>PP <span class="main"><span class="free">⟨</span></span><span class="free">fls</span><span class="main"><span class="free">⟩</span></span><span class="main">)</span> <span class="main">(</span>PP <span class="main"><span class="free">⟨</span></span><span class="free">φ</span><span class="main"><span class="free">⟩</span></span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">intro</span> HBL2_imp2<span class="main">)</span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="free">bprv</span> <span class="main">(</span><span class="free">imp</span> <span class="main">(</span>neg <span class="main">(</span>PP <span class="main"><span class="free">⟨</span></span><span class="free">φ</span><span class="main"><span class="free">⟩</span></span><span class="main">)</span><span class="main">)</span> <span class="main">(</span>neg <span class="main">(</span>PP <span class="main"><span class="free">⟨</span></span><span class="free">fls</span><span class="main"><span class="free">⟩</span></span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">intro</span> B.prv_imp_neg_rev<span class="main">)</span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">from</span></span> prv_imp_mp<span class="main">[</span><span class="operator">OF</span> _ _ bprv_prv<span class="main"><span class="main">[</span></span><span class="operator">OF</span> _ _ this<span class="main"><span class="main">,</span></span> <span class="operator">simplified</span><span class="main"><span class="main">]</span></span> 0<span class="main">,</span> <span class="operator">simplified</span><span class="main">]</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">prv</span> <span class="main">(</span>neg <span class="main">(</span>PP <span class="main"><span class="free">⟨</span></span><span class="free">fls</span><span class="main"><span class="free">⟩</span></span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">.</span></span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="quoted">False</span> <span class="keyword1"><span class="command">using</span></span> goedel_second<span class="main">[</span><span class="operator">OF</span> c<span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword2"><span class="keyword">end</span></span> <span class="comment1">― ‹context <span class="antiquoted"><span class="antiquote">@{</span><span class="operator">locale</span> Goedel_Second_Assumptions<span class="antiquote">}</span></span>›</span>

<span class="comment1">(*&lt;*)</span>
<span class="keyword2"><span class="keyword">end</span></span>
<span class="comment1">(*&gt;*)</span>




</pre>
</div><div id="Abstract_Jeroslow_Encoding">
<div class="head">
<h1>Theory Abstract_Jeroslow_Encoding</h1>
</div>
<pre class="source"><span class="keyword1"><span class="command">chapter</span></span> <span class="quoted"><span class="plain_text">‹Jeroslow's Variant of G\"odel's Second Incompleteness Theorem›</span></span>

<span class="comment1">(*&lt;*)</span>
<span class="keyword1"><span class="command">theory</span></span> Abstract_Jeroslow_Encoding <span class="keyword2"><span class="keyword">imports</span></span>
<span class="quoted">"<a href="../Syntax_Independent_Logic/Deduction.html">Syntax_Independent_Logic.Deduction</a>"</span>
<span class="keyword2"><span class="keyword">begin</span></span>
<span class="comment1">(*&gt;*)</span>

<span class="keyword1"><span class="command">section</span></span> <span class="quoted"><span class="plain_text">‹Encodings and Derivability›</span></span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹Here we formalize some of the assumptions of Jeroslow's theorem:
encoding, term-encoding and the First Derivability Condition.›</span></span>


<span class="keyword1"><span class="command">subsection</span></span> <span class="quoted"><span class="plain_text">‹Encoding of formulas›</span></span>

<span class="keyword1"><span class="command">locale</span></span> Encode <span class="main">=</span>
Syntax_with_Numerals
  <span class="quoted"><span class="free">var</span></span> <span class="quoted"><span class="free">trm</span></span> <span class="quoted"><span class="free">fmla</span></span> <span class="quoted"><span class="free">Var</span></span> <span class="quoted"><span class="free">FvarsT</span></span> <span class="quoted"><span class="free">substT</span></span> <span class="quoted"><span class="free">Fvars</span></span> <span class="quoted"><span class="free">subst</span></span>
  <span class="quoted"><span class="free">num</span></span>
<span class="keyword2"><span class="keyword">for</span></span>
<span class="free">var</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'var</span> set"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="free">trm</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'trm</span> set"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="free">fmla</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'fmla</span> set"</span></span>
<span class="keyword2"><span class="keyword">and</span></span> <span class="free">Var</span> <span class="free">FvarsT</span> <span class="free">substT</span> <span class="free">Fvars</span> <span class="free">subst</span>
<span class="keyword2"><span class="keyword">and</span></span> <span class="free">num</span>
<span class="main">+</span>
<span class="keyword2"><span class="keyword">fixes</span></span>
<span class="comment1">(*************************************)</span>
<span class="comment1">(* Numeric formulas are assumed to be encoded as numerals: *)</span>
<span class="free">enc</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'fmla</span> <span class="main">⇒</span> <span class="tfree">'trm</span>"</span></span> <span class="main">(</span><span class="quoted">"<span class="keyword1">⟨</span>_<span class="keyword1">⟩</span>"</span><span class="main">)</span>
<span class="keyword2"><span class="keyword">assumes</span></span>
enc<span class="main">[</span><span class="operator">simp</span><span class="main">,</span><span class="operator">intro</span><span class="main"><span class="main">!</span></span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">⋀</span> <span class="bound">φ</span><span class="main">.</span> <span class="bound">φ</span> <span class="main">∈</span> <span class="free">fmla</span> <span class="main">⟹</span> <span class="free">enc</span> <span class="bound">φ</span> <span class="main">∈</span> <span class="free">num</span>"</span></span>
<span class="keyword2"><span class="keyword">begin</span></span>

<span class="keyword2"><span class="keyword">end</span></span> <span class="comment1">― ‹context <span class="antiquoted"><span class="antiquote">@{</span><span class="operator">locale</span> Encode<span class="antiquote">}</span></span>›</span>


<span class="keyword1"><span class="command">subsection</span></span> <span class="quoted"><span class="plain_text">‹Encoding of computable functions›</span></span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹Jeroslow assumes the encodability of an abstract (unspecified) class of
computable functions and the assumption that a particular function, <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">term</span></span> <span class="quoted"><span class="quoted">"<span class="free"><span class="free">sub</span></span> <span class="free"><span class="free">φ</span></span>"</span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span> for each formula
<span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">term</span></span> <span class="quoted"><span class="free"><span class="quoted"><span class="free">φ</span></span></span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span>, is in this collection. This is used to prove a different flavor of the diagonalization
lemma (Jeroslow 1973). It turns out that only an encoding of unary computable functions
is needed, so we only assume that.›</span></span>

<span class="keyword1"><span class="command">locale</span></span> Encode_UComput <span class="main">=</span>
Encode
  <span class="quoted"><span class="free">var</span></span> <span class="quoted"><span class="free">trm</span></span> <span class="quoted"><span class="free">fmla</span></span> <span class="quoted"><span class="free">Var</span></span> <span class="quoted"><span class="free">FvarsT</span></span> <span class="quoted"><span class="free">substT</span></span> <span class="quoted"><span class="free">Fvars</span></span> <span class="quoted"><span class="free">subst</span></span>
  <span class="quoted"><span class="free">num</span></span>
  <span class="quoted"><span class="free">enc</span></span>
<span class="keyword2"><span class="keyword">for</span></span>
<span class="free">var</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'var</span> set"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="free">trm</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'trm</span> set"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="free">fmla</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'fmla</span> set"</span></span>
<span class="keyword2"><span class="keyword">and</span></span> <span class="free">Var</span> <span class="free">FvarsT</span> <span class="free">substT</span> <span class="free">Fvars</span> <span class="free">subst</span>
<span class="keyword2"><span class="keyword">and</span></span> <span class="free">num</span>
<span class="keyword2"><span class="keyword">and</span></span> <span class="free">enc</span> <span class="main">(</span><span class="quoted">"<span class="keyword1">⟨</span>_<span class="keyword1">⟩</span>"</span><span class="main">)</span>
<span class="main">+</span>
<span class="comment1">― ‹Abstract (unspeficied) notion of unary "computable" function
between numerals, which are encoded as numerals. They
contain a special substitution-like function <span class="antiquoted"><span class="antiquote">@{</span><span class="operator">term</span> <span class="quoted">"<span class="free">sub</span> <span class="free">φ</span>"</span><span class="antiquote">}</span></span> for each formula <span class="antiquoted"><span class="antiquote">@{</span><span class="operator">term</span> <span class="quoted">"<span class="free">φ</span>"</span><span class="antiquote">}</span></span>.›</span>
<span class="keyword2"><span class="keyword">fixes</span></span> <span class="free">ucfunc</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="tfree">'trm</span> <span class="main">⇒</span> <span class="tfree">'trm</span><span class="main">)</span> set"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> <span class="free">encF</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="tfree">'trm</span> <span class="main">⇒</span> <span class="tfree">'trm</span><span class="main">)</span> <span class="main">⇒</span> <span class="tfree">'trm</span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> <span class="free">sub</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'fmla</span> <span class="main">⇒</span> <span class="tfree">'trm</span> <span class="main">⇒</span> <span class="tfree">'trm</span>"</span></span>
<span class="keyword2"><span class="keyword">assumes</span></span>
<span class="comment1">― ‹NB: Due to the limitations of the type system, we define <span class="antiquoted"><span class="antiquote">@{</span><span class="operator">term</span> <span class="quoted">"<span class="free">ufunc</span>"</span><span class="antiquote">}</span></span> as a set of functions
between terms, but we only care about their actions on numerals ...
so we assume they send numerals to numerals:›</span>
ucfunc<span class="main">[</span><span class="operator">simp</span><span class="main">,</span><span class="operator">intro</span><span class="main"><span class="main">!</span></span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">⋀</span> <span class="bound">f</span> <span class="bound">n</span><span class="main">.</span> <span class="bound">f</span> <span class="main">∈</span> <span class="free">ucfunc</span> <span class="main">⟹</span> <span class="bound">n</span> <span class="main">∈</span> <span class="free">num</span> <span class="main">⟹</span> <span class="bound">f</span> <span class="bound">n</span> <span class="main">∈</span> <span class="free">num</span>"</span></span>
<span class="keyword2"><span class="keyword">and</span></span>
encF<span class="main">[</span><span class="operator">simp</span><span class="main">,</span><span class="operator">intro</span><span class="main"><span class="main">!</span></span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">⋀</span> <span class="bound">f</span><span class="main">.</span> <span class="bound">f</span> <span class="main">∈</span> <span class="free">ucfunc</span> <span class="main">⟹</span> <span class="free">encF</span> <span class="bound">f</span> <span class="main">∈</span> <span class="free">num</span>"</span></span>
<span class="keyword2"><span class="keyword">and</span></span>
sub<span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">⋀</span><span class="bound">φ</span><span class="main">.</span> <span class="bound">φ</span> <span class="main">∈</span> <span class="free">fmla</span> <span class="main">⟹</span> <span class="free">sub</span> <span class="bound">φ</span> <span class="main">∈</span> <span class="free">ucfunc</span>"</span></span>
<span class="keyword2"><span class="keyword">and</span></span>
<span class="comment1">― ‹The function <span class="antiquoted"><span class="antiquote">@{</span><span class="operator">term</span> <span class="quoted">"<span class="free">sub</span> <span class="free">φ</span>"</span><span class="antiquote">}</span></span> takes any encoding of a function <span class="antiquoted"><span class="antiquote">@{</span><span class="operator">term</span> <span class="quoted">"<span class="free">f</span>"</span><span class="antiquote">}</span></span> and returns the encoding of
the formula obtained by substituting for <span class="antiquoted"><span class="antiquote">@{</span><span class="operator">term</span> <span class="quoted">"xx"</span><span class="antiquote">}</span></span> the value of <span class="antiquoted"><span class="antiquote">@{</span><span class="operator">term</span> <span class="quoted">"<span class="free">f</span>"</span><span class="antiquote">}</span></span> applied to its own encoding:›</span>
sub_enc<span class="main">:</span>
<span class="quoted"><span class="quoted">"<span class="main">⋀</span> <span class="bound">φ</span> <span class="bound">f</span><span class="main">.</span> <span class="bound">φ</span> <span class="main">∈</span> <span class="free">fmla</span> <span class="main">⟹</span> <span class="free">Fvars</span> <span class="bound">φ</span> <span class="main">=</span> <span class="main">{</span>xx<span class="main">}</span> <span class="main">⟹</span> <span class="bound">f</span> <span class="main">∈</span> <span class="free">ucfunc</span> <span class="main">⟹</span>
    <span class="free">sub</span> <span class="bound">φ</span> <span class="main">(</span><span class="free">encF</span> <span class="bound">f</span><span class="main">)</span> <span class="main">=</span> <span class="free">enc</span> <span class="main">(</span>inst <span class="bound">φ</span> <span class="main">(</span><span class="bound">f</span> <span class="main">(</span><span class="free">encF</span> <span class="bound">f</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span>


<span class="keyword1"><span class="command">subsection</span></span> <span class="quoted"><span class="plain_text">‹Term-encoding of computable functons›</span></span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹For handling the notion of term-representation (which we introduce later),
we assume we are given a set <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">term</span></span> <span class="quoted"><span class="quoted">"<span class="free"><span class="free">Ops</span></span>"</span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span> of term operators and their encodings as numerals.
We additionally assume that the term operators behave well w.r.t. free variables and
substitution.›</span></span>

<span class="keyword1"><span class="command">locale</span></span> TermEncode <span class="main">=</span>
Syntax_with_Numerals
  <span class="quoted"><span class="free">var</span></span> <span class="quoted"><span class="free">trm</span></span> <span class="quoted"><span class="free">fmla</span></span> <span class="quoted"><span class="free">Var</span></span> <span class="quoted"><span class="free">FvarsT</span></span> <span class="quoted"><span class="free">substT</span></span> <span class="quoted"><span class="free">Fvars</span></span> <span class="quoted"><span class="free">subst</span></span>
  <span class="quoted"><span class="free">num</span></span>
<span class="keyword2"><span class="keyword">for</span></span>
<span class="free">var</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'var</span> set"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="free">trm</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'trm</span> set"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="free">fmla</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'fmla</span> set"</span></span>
<span class="keyword2"><span class="keyword">and</span></span> <span class="free">Var</span> <span class="free">FvarsT</span> <span class="free">substT</span> <span class="free">Fvars</span> <span class="free">subst</span>
<span class="keyword2"><span class="keyword">and</span></span> <span class="free">num</span>
<span class="main">+</span>
<span class="keyword2"><span class="keyword">fixes</span></span>
<span class="free">Ops</span> <span class="main">::</span>  <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="tfree">'trm</span> <span class="main">⇒</span> <span class="tfree">'trm</span><span class="main">)</span> set"</span></span>
<span class="keyword2"><span class="keyword">and</span></span>
<span class="free">enc</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="tfree">'trm</span> <span class="main">⇒</span> <span class="tfree">'trm</span><span class="main">)</span> <span class="main">⇒</span> <span class="tfree">'trm</span>"</span></span> <span class="main">(</span><span class="quoted">"<span class="keyword1">⟨</span>_<span class="keyword1">⟩</span>"</span><span class="main">)</span>
<span class="keyword2"><span class="keyword">assumes</span></span>
Ops<span class="main">[</span><span class="operator">simp</span><span class="main">,</span><span class="operator">intro</span><span class="main"><span class="main">!</span></span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">⋀</span><span class="bound">f</span> <span class="bound">t</span><span class="main">.</span> <span class="bound">f</span> <span class="main">∈</span> <span class="free">Ops</span> <span class="main">⟹</span> <span class="bound">t</span> <span class="main">∈</span> <span class="free">trm</span> <span class="main">⟹</span> <span class="bound">f</span> <span class="bound">t</span> <span class="main">∈</span> <span class="free">trm</span>"</span></span>
<span class="keyword2"><span class="keyword">and</span></span>
enc<span class="main">[</span><span class="operator">simp</span><span class="main">,</span><span class="operator">intro</span><span class="main"><span class="main">!</span></span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">⋀</span> <span class="bound">f</span><span class="main">.</span> <span class="bound">f</span> <span class="main">∈</span> <span class="free">Ops</span> <span class="main">⟹</span> <span class="free">enc</span> <span class="bound">f</span> <span class="main">∈</span> <span class="free">num</span>"</span></span>
<span class="keyword2"><span class="keyword">and</span></span>
Ops_FvarsT<span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">⋀</span> <span class="bound">f</span> <span class="bound">t</span><span class="main">.</span> <span class="bound">f</span> <span class="main">∈</span> <span class="free">Ops</span> <span class="main">⟹</span> <span class="bound">t</span> <span class="main">∈</span> <span class="free">trm</span> <span class="main">⟹</span> <span class="free">FvarsT</span> <span class="main">(</span><span class="bound">f</span> <span class="bound">t</span><span class="main">)</span> <span class="main">=</span> <span class="free">FvarsT</span> <span class="bound">t</span>"</span></span>
<span class="keyword2"><span class="keyword">and</span></span>
Ops_substT<span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">⋀</span> <span class="bound">f</span> <span class="bound">t</span><span class="main">.</span> <span class="bound">f</span> <span class="main">∈</span> <span class="free">Ops</span> <span class="main">⟹</span> <span class="bound">t</span> <span class="main">∈</span> <span class="free">trm</span> <span class="main">⟹</span> <span class="free">t1</span> <span class="main">∈</span> <span class="free">trm</span> <span class="main">⟹</span> <span class="free">x</span> <span class="main">∈</span> <span class="free">var</span> <span class="main">⟹</span>
  <span class="free">substT</span> <span class="main">(</span><span class="bound">f</span> <span class="bound">t</span><span class="main">)</span> <span class="free">t1</span> <span class="free">x</span> <span class="main">=</span> <span class="bound">f</span> <span class="main">(</span><span class="free">substT</span> <span class="bound">t</span> <span class="free">t1</span> <span class="free">x</span><span class="main">)</span>"</span></span>
<span class="keyword2"><span class="keyword">begin</span></span>

<span class="keyword2"><span class="keyword">end</span></span> <span class="comment1">― ‹context <span class="antiquoted"><span class="antiquote">@{</span><span class="operator">locale</span> TermEncode<span class="antiquote">}</span></span>›</span>


<span class="keyword1"><span class="command">subsection</span></span> <span class="quoted"><span class="plain_text">‹The first Hilbert-Bernays-Löb derivability condition›</span></span>

<span class="keyword1"><span class="command">locale</span></span> HBL1 <span class="main">=</span>
Encode
  <span class="quoted"><span class="free">var</span></span> <span class="quoted"><span class="free">trm</span></span> <span class="quoted"><span class="free">fmla</span></span> <span class="quoted"><span class="free">Var</span></span> <span class="quoted"><span class="free">FvarsT</span></span> <span class="quoted"><span class="free">substT</span></span> <span class="quoted"><span class="free">Fvars</span></span> <span class="quoted"><span class="free">subst</span></span>
  <span class="quoted"><span class="free">num</span></span>
  <span class="quoted"><span class="free">enc</span></span>
<span class="main">+</span>
Deduct
  <span class="quoted"><span class="free">var</span></span> <span class="quoted"><span class="free">trm</span></span> <span class="quoted"><span class="free">fmla</span></span> <span class="quoted"><span class="free">Var</span></span> <span class="quoted"><span class="free">FvarsT</span></span> <span class="quoted"><span class="free">substT</span></span> <span class="quoted"><span class="free">Fvars</span></span> <span class="quoted"><span class="free">subst</span></span>
  <span class="quoted"><span class="free">num</span></span>
  <span class="quoted"><span class="free">eql</span></span> <span class="quoted"><span class="free">cnj</span></span> <span class="quoted"><span class="free">imp</span></span> <span class="quoted"><span class="free">all</span></span> <span class="quoted"><span class="free">exi</span></span>
  <span class="quoted"><span class="free">prv</span></span>
<span class="keyword2"><span class="keyword">for</span></span>
<span class="free">var</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'var</span> set"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="free">trm</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'trm</span> set"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="free">fmla</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'fmla</span> set"</span></span>
<span class="keyword2"><span class="keyword">and</span></span> <span class="free">Var</span> <span class="free">FvarsT</span> <span class="free">substT</span> <span class="free">Fvars</span> <span class="free">subst</span>
<span class="keyword2"><span class="keyword">and</span></span> <span class="free">num</span>
<span class="keyword2"><span class="keyword">and</span></span> <span class="free">eql</span> <span class="free">cnj</span> <span class="free">imp</span> <span class="free">all</span> <span class="free">exi</span>
<span class="keyword2"><span class="keyword">and</span></span> <span class="free">prv</span> <span class="free">bprv</span>
<span class="keyword2"><span class="keyword">and</span></span> <span class="free">enc</span> <span class="main">(</span><span class="quoted">"<span class="keyword1">⟨</span>_<span class="keyword1">⟩</span>"</span><span class="main">)</span>
<span class="main">+</span>
<span class="keyword2"><span class="keyword">fixes</span></span> <span class="free">P</span> <span class="main">::</span> <span class="tfree"><span class="quoted"><span class="tfree">'fmla</span></span></span>
<span class="keyword2"><span class="keyword">assumes</span></span>
P<span class="main">[</span><span class="operator">intro</span><span class="main"><span class="main">!</span></span><span class="main">,</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">P</span> <span class="main">∈</span> <span class="free">fmla</span>"</span></span>
<span class="keyword2"><span class="keyword">and</span></span>
Fvars_P<span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">Fvars</span> <span class="free">P</span> <span class="main">=</span> <span class="main">{</span>xx<span class="main">}</span>"</span></span>
<span class="keyword2"><span class="keyword">and</span></span>
HBL1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">⋀</span><span class="bound">φ</span><span class="main">.</span> <span class="bound">φ</span> <span class="main">∈</span> <span class="free">fmla</span> <span class="main">⟹</span> <span class="free">Fvars</span> <span class="bound">φ</span> <span class="main">=</span> <span class="main">{}</span> <span class="main">⟹</span> <span class="free">prv</span> <span class="bound">φ</span> <span class="main">⟹</span> <span class="free">prv</span> <span class="main">(</span><span class="free">subst</span> <span class="free">P</span> <span class="main"><span class="free">⟨</span></span><span class="bound">φ</span><span class="main"><span class="free">⟩</span></span> xx<span class="main">)</span>"</span></span>
<span class="keyword2"><span class="keyword">begin</span></span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹Predicate version of the provability formula›</span></span>
<span class="keyword1"><span class="command">definition</span></span> <span class="entity">PP</span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="free">PP</span> <span class="main">≡</span> <span class="main">λ</span><span class="bound">t</span><span class="main">.</span> <span class="free">subst</span> <span class="free">P</span> <span class="bound">t</span> xx"</span></span>

<span class="keyword1"><span class="command">lemma</span></span> PP<span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">⋀</span><span class="bound">t</span><span class="main">.</span> <span class="bound">t</span> <span class="main">∈</span> <span class="free">trm</span> <span class="main">⟹</span> PP <span class="bound">t</span> <span class="main">∈</span> <span class="free">fmla</span>"</span></span>
  <span class="keyword1"><span class="command">unfolding</span></span> PP_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">lemma</span></span> Fvars_PP<span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">⋀</span><span class="bound">t</span><span class="main">.</span> <span class="bound">t</span> <span class="main">∈</span> <span class="free">trm</span> <span class="main">⟹</span> <span class="free">Fvars</span> <span class="main">(</span>PP <span class="bound">t</span><span class="main">)</span> <span class="main">=</span> <span class="free">FvarsT</span> <span class="bound">t</span>"</span></span>
  <span class="keyword1"><span class="command">unfolding</span></span> PP_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span>
<span class="quoted"><span class="quoted">"<span class="free">n</span> <span class="main">∈</span> <span class="free">num</span> <span class="main">⟹</span> <span class="free">subst</span> <span class="main">(</span>PP <span class="main">(</span><span class="free">Var</span> yy<span class="main">)</span><span class="main">)</span> <span class="free">n</span> yy <span class="main">=</span> PP <span class="free">n</span>"</span></span>
<span class="quoted"><span class="quoted">"<span class="free">n</span> <span class="main">∈</span> <span class="free">num</span> <span class="main">⟹</span> <span class="free">subst</span> <span class="main">(</span>PP <span class="main">(</span><span class="free">Var</span> xx<span class="main">)</span><span class="main">)</span> <span class="free">n</span> xx <span class="main">=</span> PP <span class="free">n</span>"</span></span>
  <span class="keyword1"><span class="command">unfolding</span></span> PP_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">lemma</span></span> HBL1_PP<span class="main">:</span>
<span class="quoted"><span class="quoted">"<span class="free">φ</span> <span class="main">∈</span> <span class="free">fmla</span> <span class="main">⟹</span> <span class="free">Fvars</span> <span class="free">φ</span> <span class="main">=</span> <span class="main">{}</span> <span class="main">⟹</span> <span class="free">prv</span> <span class="free">φ</span> <span class="main">⟹</span> <span class="free">prv</span> <span class="main">(</span>PP <span class="main"><span class="free">⟨</span></span><span class="free">φ</span><span class="main"><span class="free">⟩</span></span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> HBL1 <span class="keyword1"><span class="command">unfolding</span></span> PP_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword2"><span class="keyword">end</span></span> <span class="comment1">― ‹context <span class="antiquoted"><span class="antiquote">@{</span><span class="operator">locale</span> HBL1<span class="antiquote">}</span></span>›</span>

<span class="comment1">(*&lt;*)</span>
<span class="keyword2"><span class="keyword">end</span></span>
<span class="comment1">(*&gt;*)</span></pre>
</div><div id="Jeroslow_Original">
<div class="head">
<h1>Theory Jeroslow_Original</h1>
</div>
<pre class="source"><span class="keyword1"><span class="command">section</span></span> <span class="quoted"><span class="plain_text">‹A Formalization of Jeroslow's Original Argument›</span></span>

<span class="comment1">(*&lt;*)</span>
<span class="keyword1"><span class="command">theory</span></span> Jeroslow_Original <span class="keyword2"><span class="keyword">imports</span></span>
<span class="quoted">"<a href="../Syntax_Independent_Logic/Pseudo_Term.html">Syntax_Independent_Logic.Pseudo_Term</a>"</span>
<a href="Abstract_Jeroslow_Encoding.html">Abstract_Jeroslow_Encoding</a>
<span class="keyword2"><span class="keyword">begin</span></span>
<span class="comment1">(*&gt;*)</span>

<span class="keyword1"><span class="command">subsection</span></span> <span class="quoted"><span class="plain_text">‹Preliminaries›</span></span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹The First Derivability Condition was stated using a formula
with free variable <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">term</span></span> <span class="quoted"><span class="free"><span class="quoted"><span class="free">xx</span></span></span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span>, whereas the pseudo-term theory employs a different variable,
inp. The distinction is of course immaterial, because we can perform
a change of variable in the instantiation:›</span></span>

<span class="keyword1"><span class="command">context</span></span> HBL1
<span class="keyword2"><span class="keyword">begin</span></span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹Changing the variable (from <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">term</span></span> <span class="quoted"><span class="quoted">xx</span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span> to <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">term</span></span> <span class="quoted"><span class="quoted">inp</span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span>) in the provability predicate:›</span></span>
<span class="keyword1"><span class="command">definition</span></span> <span class="quoted"><span class="quoted">"<span class="free">Pinp</span> <span class="main">≡</span> <span class="free">subst</span> <span class="free">P</span> <span class="main">(</span><span class="free">Var</span> inp<span class="main">)</span> xx"</span></span>
<span class="keyword1"><span class="command">lemma</span></span> PP_Pinp<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">t</span> <span class="main">∈</span> <span class="free">trm</span> <span class="main">⟹</span> PP <span class="free">t</span> <span class="main">=</span> instInp Pinp <span class="free">t</span>"</span></span>
<span class="keyword1"><span class="command">unfolding</span></span> PP_def Pinp_def instInp_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹A version of HBL1 that uses the <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">term</span></span> <span class="quoted"><span class="quoted">inp</span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span> variable:›</span></span>
<span class="keyword1"><span class="command">lemma</span></span> HBL1_inp<span class="main">:</span>
<span class="quoted"><span class="quoted">"<span class="free">φ</span> <span class="main">∈</span> <span class="free">fmla</span> <span class="main">⟹</span> <span class="free">Fvars</span> <span class="free">φ</span> <span class="main">=</span> <span class="main">{}</span> <span class="main">⟹</span> <span class="free">prv</span> <span class="free">φ</span> <span class="main">⟹</span> <span class="free">prv</span> <span class="main">(</span>instInp Pinp <span class="main"><span class="free">⟨</span></span><span class="free">φ</span><span class="main"><span class="free">⟩</span></span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">unfolding</span></span> Pinp_def instInp_def <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">intro</span><span class="main"><span class="main">:</span></span> HBL1<span class="main">)</span>

<span class="keyword2"><span class="keyword">end</span></span> <span class="comment1">― ‹context <span class="antiquoted"><span class="antiquote">@{</span><span class="operator">locale</span> HBL1 <span class="antiquote">}</span></span>›</span>


<span class="keyword1"><span class="command">subsection</span></span> <span class="quoted"><span class="plain_text">‹Jeroslow-style diagonalization›</span></span>

<span class="keyword1"><span class="command">locale</span></span> Jeroslow_Diagonalization <span class="main">=</span>
Deduct_with_False_Disj_Rename
  <span class="quoted"><span class="free">var</span></span> <span class="quoted"><span class="free">trm</span></span> <span class="quoted"><span class="free">fmla</span></span> <span class="quoted"><span class="free">Var</span></span> <span class="quoted"><span class="free">FvarsT</span></span> <span class="quoted"><span class="free">substT</span></span> <span class="quoted"><span class="free">Fvars</span></span> <span class="quoted"><span class="free">subst</span></span>
  <span class="quoted"><span class="free">eql</span></span> <span class="quoted"><span class="free">cnj</span></span> <span class="quoted"><span class="free">imp</span></span> <span class="quoted"><span class="free">all</span></span> <span class="quoted"><span class="free">exi</span></span>
  <span class="quoted"><span class="free">fls</span></span>
  <span class="quoted"><span class="free">dsj</span></span>
  <span class="quoted"><span class="free">num</span></span>
  <span class="quoted"><span class="free">prv</span></span>
<span class="main">+</span>
Encode
  <span class="quoted"><span class="free">var</span></span> <span class="quoted"><span class="free">trm</span></span> <span class="quoted"><span class="free">fmla</span></span> <span class="quoted"><span class="free">Var</span></span> <span class="quoted"><span class="free">FvarsT</span></span> <span class="quoted"><span class="free">substT</span></span> <span class="quoted"><span class="free">Fvars</span></span> <span class="quoted"><span class="free">subst</span></span>
  <span class="quoted"><span class="free">num</span></span>
  <span class="quoted"><span class="free">enc</span></span>
<span class="keyword2"><span class="keyword">for</span></span>
<span class="free">var</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'var</span> set"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="free">trm</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'trm</span> set"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="free">fmla</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'fmla</span> set"</span></span>
<span class="keyword2"><span class="keyword">and</span></span> <span class="free">Var</span> <span class="free">FvarsT</span> <span class="free">substT</span> <span class="free">Fvars</span> <span class="free">subst</span>
<span class="keyword2"><span class="keyword">and</span></span> <span class="free">eql</span> <span class="free">cnj</span> <span class="free">imp</span> <span class="free">all</span> <span class="free">exi</span>
<span class="keyword2"><span class="keyword">and</span></span> <span class="free">fls</span>
<span class="keyword2"><span class="keyword">and</span></span> <span class="free">dsj</span>
<span class="keyword2"><span class="keyword">and</span></span> <span class="free">num</span>
<span class="keyword2"><span class="keyword">and</span></span> <span class="free">prv</span>
<span class="keyword2"><span class="keyword">and</span></span> <span class="free">enc</span> <span class="main">(</span><span class="quoted">"<span class="keyword1">⟨</span>_<span class="keyword1">⟩</span>"</span><span class="main">)</span>
<span class="main">+</span>
<span class="keyword2"><span class="keyword">fixes</span></span> <span class="free">F</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="tfree">'trm</span> <span class="main">⇒</span> <span class="tfree">'trm</span><span class="main">)</span> set"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> <span class="free">encF</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="tfree">'trm</span> <span class="main">⇒</span> <span class="tfree">'trm</span><span class="main">)</span> <span class="main">⇒</span> <span class="tfree">'fmla</span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> <span class="free">N</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'trm</span> <span class="main">⇒</span> <span class="tfree">'trm</span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> <span class="free">ssap</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'fmla</span> <span class="main">⇒</span> <span class="tfree">'trm</span> <span class="main">⇒</span> <span class="tfree">'trm</span>"</span></span>
<span class="keyword2"><span class="keyword">assumes</span></span>
<span class="comment1">― ‹For the members <span class="antiquoted"><span class="antiquote">@{</span><span class="operator">term</span> <span class="quoted"><span class="free">f</span></span><span class="antiquote">}</span></span> of <span class="antiquoted"><span class="antiquote">@{</span><span class="operator">term</span> <span class="quoted"><span class="free">F</span></span><span class="antiquote">}</span></span>, we will only care about their action on numerals,
and we assume that they send numerals to numerals.›</span>
F<span class="main">[</span><span class="operator">simp</span><span class="main">,</span><span class="operator">intro</span><span class="main"><span class="main">!</span></span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">⋀</span> <span class="bound">f</span> <span class="bound">n</span><span class="main">.</span> <span class="bound">f</span> <span class="main">∈</span> <span class="free">F</span> <span class="main">⟹</span> <span class="bound">n</span> <span class="main">∈</span> <span class="free">num</span> <span class="main">⟹</span> <span class="bound">f</span> <span class="bound">n</span> <span class="main">∈</span> <span class="free">num</span>"</span></span>
<span class="keyword2"><span class="keyword">and</span></span>
encF<span class="main">[</span><span class="operator">simp</span><span class="main">,</span><span class="operator">intro</span><span class="main"><span class="main">!</span></span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">⋀</span> <span class="bound">f</span><span class="main">.</span> <span class="bound">f</span> <span class="main">∈</span> <span class="free">F</span> <span class="main">⟹</span> <span class="free">encF</span> <span class="bound">f</span> <span class="main">∈</span> ptrm <span class="main">(</span>Suc <span class="main">0</span><span class="main">)</span>"</span></span>
<span class="keyword2"><span class="keyword">and</span></span>
N<span class="main">[</span><span class="operator">simp</span><span class="main">,</span><span class="operator">intro</span><span class="main"><span class="main">!</span></span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">N</span> <span class="main">∈</span> <span class="free">F</span>"</span></span>
<span class="keyword2"><span class="keyword">and</span></span>
ssap<span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">⋀</span><span class="bound">φ</span><span class="main">.</span> <span class="bound">φ</span> <span class="main">∈</span> <span class="free">fmla</span> <span class="main">⟹</span> <span class="free">Fvars</span> <span class="bound">φ</span> <span class="main">=</span> <span class="main">{</span>inp<span class="main">}</span> <span class="main">⟹</span> <span class="free">ssap</span> <span class="bound">φ</span> <span class="main">∈</span> <span class="free">F</span>"</span></span>
<span class="keyword2"><span class="keyword">and</span></span>
ReprF<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">⋀</span><span class="bound">f</span> <span class="bound">n</span><span class="main">.</span> <span class="bound">f</span> <span class="main">∈</span> <span class="free">F</span> <span class="main">⟹</span> <span class="bound">n</span> <span class="main">∈</span> <span class="free">num</span> <span class="main">⟹</span> prveqlPT <span class="main">(</span>instInp <span class="main">(</span><span class="free">encF</span> <span class="bound">f</span><span class="main">)</span> <span class="bound">n</span><span class="main">)</span> <span class="main">(</span><span class="bound">f</span> <span class="bound">n</span><span class="main">)</span>"</span></span>
<span class="keyword2"><span class="keyword">and</span></span>
CapN<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">⋀</span><span class="bound">φ</span><span class="main">.</span> <span class="bound">φ</span> <span class="main">∈</span> <span class="free">fmla</span> <span class="main">⟹</span> <span class="free">Fvars</span> <span class="bound">φ</span> <span class="main">=</span> <span class="main">{}</span> <span class="main">⟹</span> <span class="free">N</span> <span class="main"><span class="free">⟨</span></span><span class="bound">φ</span><span class="main"><span class="free">⟩</span></span> <span class="main">=</span> <span class="main"><span class="free">⟨</span></span>neg <span class="bound">φ</span><span class="main"><span class="free">⟩</span></span>"</span></span>
<span class="keyword2"><span class="keyword">and</span></span>
CapSS<span class="main">:</span> <span class="comment1">― ‹We consider formulas <span class="antiquoted"><span class="antiquote">@{</span><span class="operator">term</span> <span class="quoted"><span class="free">ψ</span></span><span class="antiquote">}</span></span> of one variable, called <span class="antiquoted"><span class="antiquote">@{</span><span class="operator">term</span> <span class="quoted">inp</span><span class="antiquote">}</span></span>:›</span>
<span class="quoted"><span class="quoted">"<span class="main">⋀</span> <span class="bound">ψ</span> <span class="bound">f</span><span class="main">.</span> <span class="bound">ψ</span> <span class="main">∈</span> <span class="free">fmla</span> <span class="main">⟹</span> <span class="free">Fvars</span> <span class="bound">ψ</span> <span class="main">=</span> <span class="main">{</span>inp<span class="main">}</span> <span class="main">⟹</span> <span class="bound">f</span> <span class="main">∈</span> <span class="free">F</span> <span class="main">⟹</span>
    <span class="free">ssap</span> <span class="bound">ψ</span> <span class="main"><span class="free">⟨</span></span><span class="free">encF</span> <span class="bound">f</span><span class="main"><span class="free">⟩</span></span> <span class="main">=</span> <span class="main"><span class="free">⟨</span></span>instInpP <span class="bound">ψ</span> <span class="main">0</span> <span class="main">(</span>instInp <span class="main">(</span><span class="free">encF</span> <span class="bound">f</span><span class="main">)</span> <span class="main"><span class="free">⟨</span></span><span class="free">encF</span> <span class="bound">f</span><span class="main"><span class="free">⟩</span></span><span class="main">)</span><span class="main"><span class="free">⟩</span></span>"</span></span>
<span class="keyword2"><span class="keyword">begin</span></span>

<span class="keyword1"><span class="command">lemma</span></span> encF_fmla<span class="main">[</span><span class="operator">simp</span><span class="main">,</span><span class="operator">intro</span><span class="main"><span class="main"><span class="main">!</span></span></span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">⋀</span> <span class="bound">f</span><span class="main">.</span> <span class="bound">f</span> <span class="main">∈</span> <span class="free">F</span> <span class="main">⟹</span> <span class="free">encF</span> <span class="bound">f</span> <span class="main">∈</span> <span class="free">fmla</span>"</span></span>
<span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">lemma</span></span> enc_trm<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">φ</span> <span class="main">∈</span> <span class="free">fmla</span> <span class="main">⟹</span> <span class="main"><span class="free">⟨</span></span><span class="free">φ</span><span class="main"><span class="free">⟩</span></span> <span class="main">∈</span> <span class="free">trm</span>"</span></span>
<span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">definition</span></span> <span class="entity">τJ</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'fmla</span> <span class="main">⇒</span> <span class="tfree">'fmla</span>"</span></span> <span class="keyword2"><span class="keyword">where</span></span>
<span class="quoted"><span class="quoted">"<span class="free">τJ</span> <span class="free"><span class="bound"><span class="entity">ψ</span></span></span> <span class="main">≡</span> instInp <span class="main">(</span><span class="free">encF</span> <span class="main">(</span><span class="free">ssap</span> <span class="free"><span class="bound"><span class="entity">ψ</span></span></span><span class="main">)</span><span class="main">)</span> <span class="main">(</span><span class="main"><span class="free">⟨</span></span><span class="free">encF</span> <span class="main">(</span><span class="free">ssap</span> <span class="free"><span class="bound"><span class="entity">ψ</span></span></span><span class="main">)</span><span class="main"><span class="free">⟩</span></span><span class="main">)</span>"</span></span>

<span class="keyword1"><span class="command">definition</span></span> <span class="entity">φJ</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'fmla</span> <span class="main">⇒</span> <span class="tfree">'fmla</span>"</span></span> <span class="keyword2"><span class="keyword">where</span></span>
<span class="quoted"><span class="quoted">"<span class="free">φJ</span> <span class="free"><span class="bound"><span class="entity">ψ</span></span></span> <span class="main">≡</span> instInpP <span class="free"><span class="bound"><span class="entity">ψ</span></span></span> <span class="main">0</span> <span class="main">(</span>τJ <span class="free"><span class="bound"><span class="entity">ψ</span></span></span><span class="main">)</span>"</span></span>

<span class="keyword1"><span class="command">lemma</span></span> τJ<span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span>
<span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">ψ</span> <span class="main">∈</span> <span class="free">fmla</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">Fvars</span> <span class="free">ψ</span> <span class="main">=</span> <span class="main">{</span>inp<span class="main">}</span>"</span></span>
<span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"τJ <span class="free">ψ</span> <span class="main">∈</span> ptrm <span class="main">0</span>"</span></span>
<span class="keyword1"><span class="command">unfolding</span></span> τJ_def <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="main">(</span><span class="operator">rule</span> instInp<span class="main">)</span>
<span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">lemma</span></span> τJ_fmla<span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span>
<span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">ψ</span> <span class="main">∈</span> <span class="free">fmla</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">Fvars</span> <span class="free">ψ</span> <span class="main">=</span> <span class="main">{</span>inp<span class="main">}</span>"</span></span>
<span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"τJ <span class="free">ψ</span> <span class="main">∈</span> <span class="free">fmla</span>"</span></span>
<span class="keyword1"><span class="command">using</span></span> τJ<span class="main">[</span><span class="operator">OF</span> assms<span class="main">]</span> <span class="keyword1"><span class="command">unfolding</span></span> ptrm_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">lemma</span></span> FvarsT_τJ<span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span>
<span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">ψ</span> <span class="main">∈</span> <span class="free">fmla</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">Fvars</span> <span class="free">ψ</span> <span class="main">=</span> <span class="main">{</span>inp<span class="main">}</span>"</span></span>
<span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">Fvars</span> <span class="main">(</span>τJ <span class="free">ψ</span><span class="main">)</span> <span class="main">=</span> <span class="main">{</span>out<span class="main">}</span>"</span></span>
<span class="keyword1"><span class="command">using</span></span> τJ<span class="main">[</span><span class="operator">OF</span> assms<span class="main">]</span> <span class="keyword1"><span class="command">unfolding</span></span> ptrm_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">lemma</span></span> φJ<span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span>
<span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">ψ</span> <span class="main">∈</span> <span class="free">fmla</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">Fvars</span> <span class="free">ψ</span> <span class="main">=</span> <span class="main">{</span>inp<span class="main">}</span>"</span></span>
<span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"φJ <span class="free">ψ</span> <span class="main">∈</span> <span class="free">fmla</span>"</span></span>
<span class="keyword1"><span class="command">unfolding</span></span> φJ_def <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">intro</span> instInpP_fmla<span class="main">)</span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">lemma</span></span> Fvars_φJ<span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span>
<span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">ψ</span> <span class="main">∈</span> <span class="free">fmla</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">Fvars</span> <span class="free">ψ</span> <span class="main">=</span> <span class="main">{</span>inp<span class="main">}</span>"</span></span>
<span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">Fvars</span> <span class="main">(</span>φJ <span class="free">ψ</span><span class="main">)</span> <span class="main">=</span> <span class="main">{}</span>"</span></span>
<span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">unfolding</span></span> φJ_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">lemma</span></span> diagonalization<span class="main">:</span>
<span class="keyword2"><span class="keyword">assumes</span></span> ψ<span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">ψ</span> <span class="main">∈</span> <span class="free">fmla</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">Fvars</span> <span class="free">ψ</span> <span class="main">=</span> <span class="main">{</span>inp<span class="main">}</span>"</span></span>
<span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"prveqlPT <span class="main">(</span>τJ <span class="free">ψ</span><span class="main">)</span> <span class="main"><span class="free">⟨</span></span>instInpP <span class="free">ψ</span> <span class="main">0</span> <span class="main">(</span>τJ <span class="free">ψ</span><span class="main">)</span><span class="main"><span class="free">⟩</span></span> <span class="main">∧</span>
       <span class="free">prv</span> <span class="main">(</span>eqv <span class="main">(</span>φJ <span class="free">ψ</span><span class="main">)</span> <span class="main">(</span>instInp <span class="free">ψ</span> <span class="main"><span class="free">⟨</span></span>φJ <span class="free">ψ</span><span class="main"><span class="free">⟩</span></span><span class="main">)</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span>
  <span class="keyword3"><span class="command">define</span></span> <span class="skolem"><span class="skolem">f</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">f</span> <span class="main">≡</span> <span class="free">ssap</span> <span class="free">ψ</span>"</span></span>
  <span class="keyword1"><span class="command">have</span></span> f<span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">f</span> <span class="main">∈</span> <span class="free">F</span>"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> f_def <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">have</span></span> ff<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">f</span> <span class="main"><span class="free">⟨</span></span><span class="free">encF</span> <span class="skolem">f</span><span class="main"><span class="free">⟩</span></span> <span class="main">=</span> <span class="main"><span class="free">⟨</span></span>instInpP <span class="free">ψ</span> <span class="main">0</span> <span class="main">(</span>τJ <span class="free">ψ</span><span class="main">)</span><span class="main"><span class="free">⟩</span></span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">unfolding</span></span> f_def τJ_def <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">intro</span> CapSS<span class="main">)</span> <span class="operator">auto</span>

  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"prveqlPT <span class="main">(</span>τJ <span class="free">ψ</span><span class="main">)</span> <span class="main"><span class="free">⟨</span></span>instInpP <span class="free">ψ</span> <span class="main">0</span> <span class="main">(</span>τJ <span class="free">ψ</span><span class="main">)</span><span class="main"><span class="free">⟩</span></span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> ReprF<span class="main">[</span><span class="operator">OF</span> f<span class="main">,</span> <span class="operator">of</span> <span class="quoted"><span class="quoted">"<span class="main"><span class="free">⟨</span></span><span class="free">encF</span> <span class="skolem">f</span><span class="main"><span class="free">⟩</span></span>"</span></span><span class="main">]</span>
  <span class="keyword1"><span class="command">unfolding</span></span> τJ_def<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="free">ψ</span></span><span class="main">,</span> <span class="operator">unfolded</span> f_def<span class="main"><span class="main">[</span></span><span class="operator">symmetric</span><span class="main"><span class="main">]</span></span><span class="main">,</span><span class="operator">symmetric</span><span class="main">]</span> ff<span class="main">[</span><span class="operator">symmetric</span><span class="main">]</span>
  <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">from</span></span> prveqlPT_prv_instInp_eqv_instInpP<span class="main">[</span><span class="operator">OF</span> ψ<span class="main">,</span> <span class="operator">of</span> <span class="quoted"><span class="quoted">"τJ <span class="free">ψ</span>"</span></span><span class="main">,</span> <span class="operator">OF</span> _ _ _ _ this<span class="main">,</span>
           <span class="operator">unfolded</span> φJ_def<span class="main"><span class="main">[</span></span><span class="operator">symmetric</span><span class="main"><span class="main">]</span></span><span class="main">]</span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="free">prv</span> <span class="main">(</span>eqv <span class="main">(</span>φJ <span class="free">ψ</span><span class="main">)</span> <span class="main">(</span>instInp <span class="free">ψ</span> <span class="main"><span class="free">⟨</span></span>φJ <span class="free">ψ</span><span class="main"><span class="free">⟩</span></span><span class="main">)</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword2"><span class="keyword">end</span></span> <span class="comment1">― ‹context <span class="antiquoted"><span class="antiquote">@{</span><span class="operator">locale</span> Jeroslow_Diagonalization<span class="antiquote">}</span></span>›</span>


<span class="keyword1"><span class="command">subsection</span></span> <span class="quoted"><span class="plain_text">‹Jeroslow's Second Incompleteness Theorem›</span></span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹We follow Jeroslow's pseudo-term-based development of the
Second Incompleteness Theorem and point out the location in the proof that
implicitly uses an unstated assumption: the fact that, for certain two provably
equivalent formulas <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">term</span></span> <span class="quoted"><span class="free"><span class="quoted"><span class="free">φ</span></span></span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span> and <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">term</span></span> <span class="quoted"><span class="free"><span class="quoted"><span class="free">φ'</span></span></span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span>, it is provable that
the provability of the encoding of <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">term</span></span> <span class="quoted"><span class="free"><span class="quoted"><span class="free">φ'</span></span></span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span> implies
the provability of the encoding of <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">term</span></span> <span class="quoted"><span class="free"><span class="quoted"><span class="free">φ</span></span></span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span>. ›</span></span>

<span class="keyword1"><span class="command">locale</span></span> Jeroslow_Godel_Second <span class="main">=</span>
Jeroslow_Diagonalization
  <span class="quoted"><span class="free">var</span></span> <span class="quoted"><span class="free">trm</span></span> <span class="quoted"><span class="free">fmla</span></span> <span class="quoted"><span class="free">Var</span></span> <span class="quoted"><span class="free">FvarsT</span></span> <span class="quoted"><span class="free">substT</span></span> <span class="quoted"><span class="free">Fvars</span></span> <span class="quoted"><span class="free">subst</span></span>
  <span class="quoted"><span class="free">eql</span></span> <span class="quoted"><span class="free">cnj</span></span> <span class="quoted"><span class="free">imp</span></span> <span class="quoted"><span class="free">all</span></span> <span class="quoted"><span class="free">exi</span></span>
  <span class="quoted"><span class="free">fls</span></span>
  <span class="quoted"><span class="free">dsj</span></span>
  <span class="quoted"><span class="free">num</span></span>
  <span class="quoted"><span class="free">prv</span></span>
  <span class="quoted"><span class="free">enc</span></span>
  <span class="quoted"><span class="free">F</span></span> <span class="quoted"><span class="free">encF</span></span> <span class="quoted"><span class="free">N</span></span> <span class="quoted"><span class="free">ssap</span></span>
<span class="main">+</span>
HBL1
  <span class="quoted"><span class="free">var</span></span> <span class="quoted"><span class="free">trm</span></span> <span class="quoted"><span class="free">fmla</span></span> <span class="quoted"><span class="free">Var</span></span> <span class="quoted"><span class="free">FvarsT</span></span> <span class="quoted"><span class="free">substT</span></span> <span class="quoted"><span class="free">Fvars</span></span> <span class="quoted"><span class="free">subst</span></span>
  <span class="quoted"><span class="free">num</span></span>
  <span class="quoted"><span class="free">eql</span></span> <span class="quoted"><span class="free">cnj</span></span> <span class="quoted"><span class="free">imp</span></span> <span class="quoted"><span class="free">all</span></span> <span class="quoted"><span class="free">exi</span></span>
  <span class="quoted"><span class="free">prv</span></span> <span class="quoted"><span class="free">prv</span></span>
  <span class="quoted"><span class="free">enc</span></span>
  <span class="quoted"><span class="free">P</span></span>
<span class="keyword2"><span class="keyword">for</span></span>
<span class="free">var</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'var</span> set"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="free">trm</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'trm</span> set"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="free">fmla</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'fmla</span> set"</span></span>
<span class="keyword2"><span class="keyword">and</span></span> <span class="free">Var</span> <span class="free">FvarsT</span> <span class="free">substT</span> <span class="free">Fvars</span> <span class="free">subst</span>
<span class="keyword2"><span class="keyword">and</span></span> <span class="free">eql</span> <span class="free">cnj</span> <span class="free">imp</span> <span class="free">all</span> <span class="free">exi</span>
<span class="keyword2"><span class="keyword">and</span></span> <span class="free">fls</span>
<span class="keyword2"><span class="keyword">and</span></span> <span class="free">dsj</span>
<span class="keyword2"><span class="keyword">and</span></span> <span class="free">num</span>
<span class="keyword2"><span class="keyword">and</span></span> <span class="free">prv</span>
<span class="keyword2"><span class="keyword">and</span></span> <span class="free">enc</span> <span class="main">(</span><span class="quoted">"<span class="keyword1">⟨</span>_<span class="keyword1">⟩</span>"</span><span class="main">)</span>
<span class="keyword2"><span class="keyword">and</span></span> <span class="free">P</span>
<span class="keyword2"><span class="keyword">and</span></span> <span class="free">F</span> <span class="free">encF</span> <span class="free">N</span> <span class="free">ssap</span>
<span class="main">+</span>
<span class="keyword2"><span class="keyword">assumes</span></span>
SHBL3<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">⋀</span><span class="bound">τ</span><span class="main">.</span> <span class="bound">τ</span> <span class="main">∈</span> ptrm <span class="main">0</span> <span class="main">⟹</span> <span class="free">prv</span> <span class="main">(</span><span class="free">imp</span> <span class="main">(</span>instInpP Pinp <span class="main">0</span> <span class="bound">τ</span><span class="main">)</span> <span class="main">(</span>instInp Pinp <span class="main"><span class="free">⟨</span></span>instInpP Pinp <span class="main">0</span> <span class="bound">τ</span><span class="main"><span class="free">⟩</span></span><span class="main">)</span><span class="main">)</span>"</span></span>
<span class="keyword2"><span class="keyword">begin</span></span>


<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹Consistency formula a la Jeroslow:›</span></span>
<span class="keyword1"><span class="command">definition</span></span> <span class="entity">jcons</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'fmla</span>"</span></span> <span class="keyword2"><span class="keyword">where</span></span>
<span class="quoted"><span class="quoted">"<span class="free">jcons</span> <span class="main">≡</span> <span class="free">all</span> xx <span class="main">(</span>neg <span class="main">(</span><span class="free">cnj</span> <span class="main">(</span>instInp Pinp <span class="main">(</span><span class="free">Var</span> xx<span class="main">)</span><span class="main">)</span>
                           <span class="main">(</span>instInpP Pinp <span class="main">0</span> <span class="main">(</span>instInp <span class="main">(</span><span class="free">encF</span> <span class="free">N</span><span class="main">)</span> <span class="main">(</span><span class="free">Var</span> <span class="main">(</span>xx<span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span>

<span class="keyword1"><span class="command">lemma</span></span> prv_eql_subst_trm3<span class="main">:</span>
<span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main">∈</span> <span class="free">var</span> <span class="main">⟹</span> <span class="free">φ</span> <span class="main">∈</span> <span class="free">fmla</span> <span class="main">⟹</span> <span class="free">t1</span> <span class="main">∈</span> <span class="free">trm</span> <span class="main">⟹</span> <span class="free">t2</span> <span class="main">∈</span> <span class="free">trm</span> <span class="main">⟹</span>
<span class="free">prv</span> <span class="main">(</span><span class="free">eql</span> <span class="free">t1</span> <span class="free">t2</span><span class="main">)</span> <span class="main">⟹</span> <span class="free">prv</span> <span class="main">(</span><span class="free">subst</span> <span class="free">φ</span> <span class="free">t1</span> <span class="free">x</span><span class="main">)</span> <span class="main">⟹</span> <span class="free">prv</span> <span class="main">(</span><span class="free">subst</span> <span class="free">φ</span> <span class="free">t2</span> <span class="free">x</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">using</span></span> prv_eql_subst_trm2
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">meson</span> subst prv_imp_mp<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> Pinp<span class="main">[</span><span class="operator">simp</span><span class="main">,</span><span class="operator">intro</span><span class="main"><span class="main"><span class="main">!</span></span></span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"Pinp <span class="main">∈</span> <span class="free">fmla</span>"</span></span>
<span class="keyword2"><span class="keyword">and</span></span> Fvars_Pinp<span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">Fvars</span> Pinp <span class="main">=</span> <span class="main">{</span>inp<span class="main">}</span>"</span></span>
<span class="keyword1"><span class="command">unfolding</span></span> Pinp_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">lemma</span></span> ReprF_combineWith_CapN<span class="main">:</span>
<span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">φ</span> <span class="main">∈</span> <span class="free">fmla</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">Fvars</span> <span class="free">φ</span> <span class="main">=</span> <span class="main">{}</span>"</span></span>
<span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"prveqlPT <span class="main">(</span>instInp <span class="main">(</span><span class="free">encF</span> <span class="free">N</span><span class="main">)</span> <span class="main"><span class="free">⟨</span></span><span class="free">φ</span><span class="main"><span class="free">⟩</span></span><span class="main">)</span> <span class="main"><span class="free">⟨</span></span>neg <span class="free">φ</span><span class="main"><span class="free">⟩</span></span>"</span></span>
<span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">unfolding</span></span> CapN<span class="main">[</span><span class="operator">symmetric</span><span class="main">,</span> <span class="operator">OF</span> assms<span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">intro</span> ReprF<span class="main">)</span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">theorem</span></span> jeroslow_godel_second<span class="main">:</span>
<span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted">consistent</span>
<span class="comment1">― ‹Assumption that is not stated by Jeroslow, but seems to be needed:›</span>
<span class="keyword2"><span class="keyword">assumes</span></span> unstated<span class="main">:</span>
        <span class="quoted"><span class="quoted">"<span class="keyword1">let</span> <span class="bound">ψ</span> <span class="main">=</span> instInpP Pinp <span class="main">(</span>Suc <span class="main">0</span><span class="main">)</span> <span class="main">(</span><span class="free">encF</span> <span class="free">N</span><span class="main">)</span><span class="main">;</span>
             <span class="bound">τ</span> <span class="main">=</span> τJ <span class="bound">ψ</span><span class="main">;</span>
             <span class="bound">φ</span> <span class="main">=</span> instInpP <span class="main">(</span>instInpP Pinp <span class="main">(</span>Suc <span class="main">0</span><span class="main">)</span> <span class="main">(</span><span class="free">encF</span> <span class="free">N</span><span class="main">)</span><span class="main">)</span> <span class="main">0</span> <span class="bound">τ</span><span class="main">;</span>
             <span class="bound">φ'</span> <span class="main">=</span> instInpP Pinp <span class="main">0</span> <span class="main">(</span>instInpP <span class="main">(</span><span class="free">encF</span> <span class="free">N</span><span class="main">)</span> <span class="main">0</span> <span class="bound">τ</span><span class="main">)</span>
         <span class="keyword1">in</span> <span class="free">prv</span> <span class="main">(</span><span class="free">imp</span> <span class="main">(</span>instInp Pinp <span class="main"><span class="free">⟨</span></span><span class="bound">φ'</span><span class="main"><span class="free">⟩</span></span><span class="main">)</span> <span class="main">(</span>instInp Pinp <span class="main"><span class="free">⟨</span></span><span class="bound">φ</span><span class="main"><span class="free">⟩</span></span><span class="main">)</span><span class="main">)</span>"</span></span>
<span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> <span class="free">prv</span> jcons"</span></span>
<span class="keyword1"><span class="command">proof</span></span>
  <span class="keyword3"><span class="command">assume</span></span> *<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">prv</span> jcons"</span></span>

  <span class="keyword3"><span class="command">define</span></span> <span class="skolem"><span class="skolem">ψ</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">ψ</span> <span class="main">≡</span> instInpP Pinp <span class="main">(</span>Suc <span class="main">0</span><span class="main">)</span> <span class="main">(</span><span class="free">encF</span> <span class="free">N</span><span class="main">)</span>"</span></span>
  <span class="keyword3"><span class="command">define</span></span> <span class="skolem"><span class="skolem">τ</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">τ</span> <span class="main">≡</span> τJ <span class="skolem">ψ</span>"</span></span>
  <span class="keyword3"><span class="command">define</span></span> <span class="skolem"><span class="skolem">φ</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">φ</span> <span class="main">≡</span> φJ <span class="skolem">ψ</span>"</span></span>
  <span class="keyword1"><span class="command">have</span></span> ψ<span class="main">[</span><span class="operator">simp</span><span class="main">,</span><span class="operator">intro</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">ψ</span> <span class="main">∈</span> <span class="free">fmla</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="free">Fvars</span> <span class="skolem">ψ</span> <span class="main">=</span> <span class="main">{</span>inp<span class="main">}</span>"</span></span>
  <span class="keyword1"><span class="command">unfolding</span></span> ψ_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">have</span></span> τ<span class="main">[</span><span class="operator">simp</span><span class="main">,</span><span class="operator">intro</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">τ</span> <span class="main">∈</span> ptrm <span class="main">0</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">τ</span> <span class="main">∈</span> <span class="free">fmla</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="free">Fvars</span> <span class="skolem">τ</span> <span class="main">=</span> <span class="main">{</span>out<span class="main">}</span>"</span></span>
    <span class="keyword1"><span class="command">unfolding</span></span> τ_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">φ</span> <span class="main">∈</span> <span class="free">fmla</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="free">Fvars</span> <span class="skolem">φ</span> <span class="main">=</span> <span class="main">{}</span>"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> φ_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

  <span class="keyword3"><span class="command">define</span></span> <span class="skolem"><span class="skolem">eNτ</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">eNτ</span> <span class="main">≡</span> instInpP <span class="main">(</span><span class="free">encF</span> <span class="free">N</span><span class="main">)</span> <span class="main">0</span> <span class="skolem">τ</span>"</span></span>
  <span class="keyword1"><span class="command">have</span></span> eNτ<span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">eNτ</span> <span class="main">∈</span> ptrm <span class="main">0</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">eNτ</span> <span class="main">∈</span> <span class="free">fmla</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="free">Fvars</span> <span class="skolem">eNτ</span> <span class="main">=</span> <span class="main">{</span>out<span class="main">}</span>"</span></span>
   <span class="keyword1"><span class="command">unfolding</span></span> eNτ_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword3"><span class="command">define</span></span> <span class="skolem"><span class="skolem">φ'</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">φ'</span> <span class="main">≡</span> instInpP Pinp <span class="main">0</span> <span class="skolem">eNτ</span>"</span></span>
  <span class="keyword1"><span class="command">have</span></span> <span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">φ'</span> <span class="main">∈</span> <span class="free">fmla</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="free">Fvars</span> <span class="skolem">φ'</span> <span class="main">=</span> <span class="main">{}</span>"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> φ'_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

  <span class="keyword1"><span class="command">have</span></span> φφ'<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">prv</span> <span class="main">(</span><span class="free">imp</span> <span class="skolem">φ</span> <span class="skolem">φ'</span><span class="main">)</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> φ'φ<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">prv</span> <span class="main">(</span><span class="free">imp</span> <span class="skolem">φ'</span> <span class="skolem">φ</span><span class="main">)</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> φeφ'<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">prv</span> <span class="main">(</span>eqv <span class="skolem">φ</span> <span class="skolem">φ'</span><span class="main">)</span>"</span></span>
   <span class="keyword1"><span class="command">unfolding</span></span> φ_def φJ_def φ'_def eNτ_def τ_def<span class="main">[</span><span class="operator">symmetric</span><span class="main">]</span> <span class="keyword1"><span class="command">unfolding</span></span> ψ_def
   <span class="keyword1"><span class="command">using</span></span> prv_instInpP_compose<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="quoted"><span class="quoted">Pinp</span></span></span> <span class="quoted"><span class="quoted"><span class="quoted"><span class="quoted">"<span class="free"><span class="free"><span class="free">encF</span></span></span> <span class="free"><span class="free"><span class="free">N</span></span></span>"</span></span></span></span> <span class="quoted"><span class="skolem"><span class="quoted"><span class="skolem"><span class="quoted"><span class="skolem">τ</span></span></span></span></span></span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

  <span class="keyword1"><span class="command">from</span></span> diagonalization<span class="main">[</span><span class="operator">OF</span> ψ<span class="main">]</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"prveqlPT <span class="skolem">τ</span> <span class="main"><span class="free">⟨</span></span>instInpP <span class="skolem">ψ</span> <span class="main">0</span> <span class="skolem">τ</span><span class="main"><span class="free">⟩</span></span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> **<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">prv</span> <span class="main">(</span>eqv <span class="skolem">φ</span> <span class="main">(</span>instInp <span class="skolem">ψ</span> <span class="main"><span class="free">⟨</span></span><span class="skolem">φ</span><span class="main"><span class="free">⟩</span></span><span class="main">)</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">unfolding</span></span> τ_def<span class="main">[</span><span class="operator">symmetric</span><span class="main">]</span> φ_def<span class="main">[</span><span class="operator">symmetric</span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted">"**1"</span><span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">prv</span> <span class="main">(</span><span class="free">imp</span> <span class="skolem">φ</span> <span class="main">(</span>instInp <span class="skolem">ψ</span> <span class="main"><span class="free">⟨</span></span><span class="skolem">φ</span><span class="main"><span class="free">⟩</span></span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="free">prv</span> <span class="main">(</span><span class="free">imp</span> <span class="main">(</span>instInp <span class="skolem">ψ</span> <span class="main"><span class="free">⟨</span></span><span class="skolem">φ</span><span class="main"><span class="free">⟩</span></span><span class="main">)</span> <span class="skolem">φ</span><span class="main">)</span>"</span></span>
   <span class="keyword1"><span class="command">using</span></span> prv_imp_eqvEL<span class="main">[</span><span class="operator">OF</span> _ _ **<span class="main">]</span> prv_imp_eqvER<span class="main">[</span><span class="operator">OF</span> _ _ **<span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

  <span class="keyword1"><span class="command">from</span></span> SHBL3<span class="main">[</span><span class="operator">OF</span> eNτ<span class="main"><span class="main">(</span></span>1<span class="main"><span class="main">)</span></span><span class="main">]</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">prv</span> <span class="main">(</span><span class="free">imp</span> <span class="main">(</span>instInpP Pinp <span class="main">0</span> <span class="skolem">eNτ</span><span class="main">)</span> <span class="main">(</span>instInp Pinp <span class="main"><span class="free">⟨</span></span>instInpP Pinp <span class="main">0</span> <span class="skolem">eNτ</span><span class="main"><span class="free">⟩</span></span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">.</span></span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="free">prv</span> <span class="main">(</span><span class="free">imp</span> <span class="skolem">φ'</span> <span class="main">(</span>instInp Pinp <span class="main"><span class="free">⟨</span></span><span class="skolem">φ'</span><span class="main"><span class="free">⟩</span></span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> φ'_def <span class="keyword1"><span class="command">.</span></span>
  <span class="keyword1"><span class="command">from</span></span> prv_prv_imp_trans<span class="main">[</span><span class="operator">OF</span> _ _ _ φφ' this<span class="main">]</span>
  <span class="keyword1"><span class="command">have</span></span> 0<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">prv</span> <span class="main">(</span><span class="free">imp</span> <span class="skolem">φ</span> <span class="main">(</span>instInp Pinp <span class="main"><span class="free">⟨</span></span><span class="skolem">φ'</span><span class="main"><span class="free">⟩</span></span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

  <span class="keyword1"><span class="command">note</span></span> unr <span class="main">=</span> unstated<span class="main">[</span><span class="operator">unfolded</span> Let_def
    φ_def<span class="main"><span class="main">[</span></span><span class="operator">unfolded</span> φJ_def τ_def<span class="main"><span class="main">[</span></span><span class="operator">symmetric</span><span class="main"><span class="main">]</span></span><span class="main"><span class="main">,</span></span> <span class="operator">symmetric</span><span class="main"><span class="main">]</span></span> ψ_def<span class="main"><span class="main">[</span></span><span class="operator">symmetric</span><span class="main"><span class="main">]</span></span>
      τ_def<span class="main"><span class="main">[</span></span><span class="operator">symmetric</span><span class="main"><span class="main">]</span></span> eNτ_def<span class="main"><span class="main">[</span></span><span class="operator">symmetric</span><span class="main"><span class="main">]</span></span> φ'_def<span class="main"><span class="main">[</span></span><span class="operator">symmetric</span><span class="main"><span class="main">]</span></span> φJ_def<span class="main">]</span>

  <span class="keyword1"><span class="command">have</span></span> 1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">prv</span> <span class="main">(</span><span class="free">imp</span> <span class="skolem">φ</span> <span class="main">(</span>instInp Pinp <span class="main"><span class="free">⟨</span></span><span class="skolem">φ</span><span class="main"><span class="free">⟩</span></span><span class="main">)</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="main">(</span><span class="operator">nrule</span> <span class="quasi_keyword">r</span><span class="main"><span class="main">:</span></span> nprv_prvI<span class="main">)</span>
  <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="main">(</span><span class="operator">nrule</span> <span class="quasi_keyword">r</span><span class="main"><span class="main">:</span></span> nprv_impI<span class="main">)</span>
  <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="main">(</span><span class="operator">nrule</span> <span class="quasi_keyword">r</span><span class="main"><span class="main">:</span></span> nprv_addLemmaE<span class="main"><span class="main">[</span></span><span class="operator">OF</span> unr<span class="main"><span class="main">]</span></span><span class="main">)</span>
  <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="main">(</span><span class="operator">nrule</span> <span class="quasi_keyword">r</span><span class="main"><span class="main">:</span></span> nprv_addImpLemmaE<span class="main"><span class="main">[</span></span><span class="operator">OF</span> 0<span class="main"><span class="main">]</span></span><span class="main">)</span>
  <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="main">(</span><span class="operator">nrule</span> <span class="quasi_keyword">r</span><span class="main"><span class="main">:</span></span> nprv_clear3_3<span class="main">)</span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> nprv_clear2_2 prv_nprv1I unr<span class="main">)</span>

  <span class="keyword1"><span class="command">have</span></span> 2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">prv</span> <span class="main">(</span><span class="free">imp</span> <span class="skolem">φ</span> <span class="main">(</span><span class="free">cnj</span> <span class="main">(</span>instInp Pinp <span class="main"><span class="free">⟨</span></span><span class="skolem">φ</span><span class="main"><span class="free">⟩</span></span><span class="main">)</span>
                           <span class="main">(</span>instInp <span class="skolem">ψ</span> <span class="main"><span class="free">⟨</span></span><span class="skolem">φ</span><span class="main"><span class="free">⟩</span></span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="main">(</span><span class="operator">nrule</span> <span class="quasi_keyword">r</span><span class="main"><span class="main">:</span></span> nprv_prvI<span class="main">)</span>
  <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="main">(</span><span class="operator">nrule</span> <span class="quasi_keyword">r</span><span class="main"><span class="main">:</span></span> nprv_impI<span class="main">)</span>
  <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="main">(</span><span class="operator">nrule</span> <span class="quasi_keyword">r</span><span class="main"><span class="main">:</span></span> nprv_cnjI<span class="main">)</span>
  <span class="keyword1"><span class="command"><span class="improper"><span class="command">subgoal</span></span></span></span> <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="main">(</span><span class="operator">nrule</span> <span class="quasi_keyword">r</span><span class="main"><span class="main">:</span></span> nprv_addImpLemmaE<span class="main"><span class="main">[</span></span><span class="operator">OF</span> 1<span class="main"><span class="main">]</span></span><span class="main">)</span> <span class="keyword1"><span class="command">.</span></span>
  <span class="keyword1"><span class="command"><span class="improper"><span class="command">subgoal</span></span></span></span> <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="main">(</span><span class="operator">nrule</span> <span class="quasi_keyword">r</span><span class="main"><span class="main">:</span></span> nprv_addImpLemmaE<span class="main"><span class="main">[</span></span><span class="operator">OF</span> <span class="quoted">"**1"</span><span class="main"><span class="main">(</span></span>1<span class="main"><span class="main">)</span></span><span class="main"><span class="main">]</span></span><span class="main">)</span> <span class="keyword1"><span class="command">.</span></span> <span class="keyword1"><span class="command">.</span></span>

  <span class="keyword3"><span class="command">define</span></span> <span class="skolem"><span class="skolem">z</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">z</span> <span class="main">≡</span> Variable <span class="main">(</span>Suc <span class="main">(</span>Suc <span class="main">0</span><span class="main">)</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">have</span></span> z_facts<span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">z</span> <span class="main">∈</span> <span class="free">var</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">z</span> <span class="main">≠</span> xx"</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">z</span> <span class="main">∉</span> <span class="free">Fvars</span> Pinp"</span></span>
    <span class="quoted"><span class="quoted">"out <span class="main">≠</span> <span class="skolem">z</span> <span class="main">∧</span> <span class="skolem">z</span> <span class="main">≠</span> out"</span></span> <span class="quoted"><span class="quoted">"inp <span class="main">≠</span> <span class="skolem">z</span> <span class="main">∧</span> <span class="skolem">z</span> <span class="main">≠</span> inp"</span></span>
   <span class="keyword1"><span class="command">unfolding</span></span> z_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

  <span class="keyword1"><span class="command">have</span></span> 30<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">subst</span> <span class="main">(</span>instInpP Pinp <span class="main">0</span> <span class="main">(</span>instInp <span class="main">(</span><span class="free">encF</span> <span class="free">N</span><span class="main">)</span> <span class="main">(</span><span class="free">Var</span> xx<span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main"><span class="free">⟨</span></span><span class="skolem">φ</span><span class="main"><span class="free">⟩</span></span> xx <span class="main">=</span>
            instInpP Pinp <span class="main">0</span> <span class="main">(</span>instInp <span class="main">(</span><span class="free">encF</span> <span class="free">N</span><span class="main">)</span> <span class="main"><span class="free">⟨</span></span><span class="skolem">φ</span><span class="main"><span class="free">⟩</span></span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">unfolding</span></span> z_def<span class="main">[</span><span class="operator">symmetric</span><span class="main">]</span> instInp_def instInpP_def Let_def
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">variousSubsts4</span> <span class="operator">auto</span>
        <span class="quasi_keyword">s1</span><span class="main"><span class="main">:</span></span> subst_compose_diff <span class="quasi_keyword">s2</span><span class="main"><span class="main">:</span></span> subst_subst
        <span class="quasi_keyword">s3</span><span class="main"><span class="main">:</span></span> subst_notIn<span class="main"><span class="main">[</span></span><span class="operator">of</span> <span class="main"><span class="main">_</span></span> <span class="main"><span class="main">_</span></span> <span class="quoted">xx</span><span class="main"><span class="main">]</span></span> <span class="quasi_keyword">s4</span><span class="main"><span class="main">:</span></span> subst_compose_diff<span class="main">)</span>
  <span class="keyword1"><span class="command">have</span></span> 31<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">subst</span> <span class="main">(</span>instInp Pinp <span class="main">(</span><span class="free">Var</span> xx<span class="main">)</span><span class="main">)</span> <span class="main"><span class="free">⟨</span></span><span class="skolem">φ</span><span class="main"><span class="free">⟩</span></span> xx <span class="main">=</span>
            instInp Pinp <span class="main"><span class="free">⟨</span></span><span class="skolem">φ</span><span class="main"><span class="free">⟩</span></span>"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> instInp_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"instInp <span class="main">(</span>instInpP Pinp <span class="main">(</span>Suc <span class="main">0</span><span class="main">)</span> <span class="main">(</span><span class="free">encF</span> <span class="free">N</span><span class="main">)</span><span class="main">)</span> <span class="main"><span class="free">⟨</span></span><span class="skolem">φ</span><span class="main"><span class="free">⟩</span></span> <span class="main">=</span>
           instInpP Pinp <span class="main">0</span> <span class="main">(</span>instInp <span class="main">(</span><span class="free">encF</span> <span class="free">N</span><span class="main">)</span> <span class="main"><span class="free">⟨</span></span><span class="skolem">φ</span><span class="main"><span class="free">⟩</span></span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> instInp_instInpP ψ_def<span class="main">)</span>

  <span class="keyword1"><span class="command">have</span></span> 3<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">prv</span> <span class="main">(</span>neg <span class="main">(</span><span class="free">cnj</span> <span class="main">(</span>instInp Pinp <span class="main"><span class="free">⟨</span></span><span class="skolem">φ</span><span class="main"><span class="free">⟩</span></span><span class="main">)</span>
                         <span class="main">(</span>instInp <span class="skolem">ψ</span> <span class="main"><span class="free">⟨</span></span><span class="skolem">φ</span><span class="main"><span class="free">⟩</span></span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="main">(</span><span class="operator">nrule</span> <span class="quasi_keyword">r</span><span class="main"><span class="main">:</span></span> nprv_prvI<span class="main">)</span>
  <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="main">(</span><span class="operator">nrule</span> <span class="quasi_keyword">r</span><span class="main"><span class="main">:</span></span> nprv_addLemmaE<span class="main"><span class="main">[</span></span><span class="operator">OF</span> *<span class="main"><span class="main">,</span></span> <span class="operator">unfolded</span> jcons_def<span class="main"><span class="main">]</span></span><span class="main">)</span>
  <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="main">(</span><span class="operator">rule</span> nprv_allE0<span class="main"><span class="main">[</span></span><span class="operator">of</span> <span class="main"><span class="main">_</span></span> <span class="main"><span class="main">_</span></span> <span class="main"><span class="main">_</span></span> <span class="quoted"><span class="quoted">"<span class="main"><span class="free">⟨</span></span><span class="skolem">φ</span><span class="main"><span class="free">⟩</span></span>"</span></span><span class="main"><span class="main">]</span></span><span class="main"><span class="keyword3">,</span></span> <span class="operator">auto</span><span class="main">)</span>
  <span class="keyword1"><span class="command">unfolding</span></span> 30 31
  <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="main">(</span><span class="operator">nrule</span> <span class="quasi_keyword">r</span><span class="main"><span class="main">:</span></span> nprv_clear2_2<span class="main">)</span>
  <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="main">(</span><span class="operator">nrule</span> <span class="quasi_keyword">r</span><span class="main"><span class="main">:</span></span> nprv_negI<span class="main">)</span>
  <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="main">(</span><span class="operator">nrule</span> <span class="quasi_keyword">r</span><span class="main"><span class="main">:</span></span> nprv_negE0<span class="main">)</span>
  <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="main">(</span><span class="operator">nrule</span> <span class="quasi_keyword">r</span><span class="main"><span class="main">:</span></span> nprv_clear2_2<span class="main">)</span>
  <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="main">(</span><span class="operator">nrule</span> <span class="quasi_keyword">r</span><span class="main"><span class="main">:</span></span> nprv_cnjE0<span class="main">)</span>
  <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="main">(</span><span class="operator">nrule</span> <span class="quasi_keyword">r</span><span class="main"><span class="main">:</span></span> nprv_clear3_3<span class="main">)</span>
  <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="main">(</span><span class="operator">nrule</span> <span class="quasi_keyword">r</span><span class="main"><span class="main">:</span></span> nprv_cnjI<span class="main">)</span>
  <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="main">(</span><span class="operator">nrule</span> <span class="quasi_keyword">r</span><span class="main"><span class="main">:</span></span> nprv_clear2_1<span class="main">)</span>
  <span class="keyword1"><span class="command">unfolding</span></span> ψ_def
  <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="main">(</span><span class="operator">nrule</span> <span class="quasi_keyword">r</span><span class="main"><span class="main">:</span></span> nprv_hyp<span class="main">)</span> <span class="keyword1"><span class="command">.</span></span>

  <span class="keyword1"><span class="command">have</span></span> ***<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">prv</span> <span class="main">(</span>neg <span class="skolem">φ</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="main">(</span><span class="operator">nrule</span> <span class="quasi_keyword">r</span><span class="main"><span class="main">:</span></span> nprv_prvI<span class="main">)</span>
  <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="main">(</span><span class="operator">nrule</span> <span class="quasi_keyword">r</span><span class="main"><span class="main">:</span></span> nprv_negI<span class="main">)</span>
  <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="main">(</span><span class="operator">nrule</span> <span class="quasi_keyword">r</span><span class="main"><span class="main">:</span></span> nprv_addImpLemmaE<span class="main"><span class="main">[</span></span><span class="operator">OF</span> 2<span class="main"><span class="main">]</span></span><span class="main">)</span>
  <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="main">(</span><span class="operator">nrule</span> <span class="quasi_keyword">r</span><span class="main"><span class="main">:</span></span> nprv_addLemmaE<span class="main"><span class="main">[</span></span><span class="operator">OF</span> 3<span class="main"><span class="main">]</span></span><span class="main">)</span>
  <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="main">(</span><span class="operator">nrule</span> <span class="quasi_keyword">r</span><span class="main"><span class="main">:</span></span> nprv_negE0<span class="main">)</span> <span class="keyword1"><span class="command">.</span></span>

  <span class="keyword1"><span class="command">have</span></span> 4<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">prv</span> <span class="main">(</span>instInp Pinp <span class="main"><span class="free">⟨</span></span>neg <span class="skolem">φ</span><span class="main"><span class="free">⟩</span></span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> HBL1_inp<span class="main">[</span><span class="operator">OF</span> _ _ ***<span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

  <span class="keyword1"><span class="command">have</span></span> 5<span class="main">:</span> <span class="quoted"><span class="quoted">"prveqlPT <span class="main">(</span>instInp <span class="main">(</span><span class="free">encF</span> <span class="free">N</span><span class="main">)</span> <span class="main"><span class="free">⟨</span></span><span class="skolem">φ</span><span class="main"><span class="free">⟩</span></span><span class="main">)</span> <span class="main"><span class="free">⟨</span></span>neg <span class="skolem">φ</span><span class="main"><span class="free">⟩</span></span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> ReprF_combineWith_CapN<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="skolem">φ</span></span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

  <span class="keyword1"><span class="command">have</span></span> <span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"instInp <span class="main">(</span><span class="free">encF</span> <span class="free">N</span><span class="main">)</span> <span class="main"><span class="free">⟨</span></span><span class="skolem">φ</span><span class="main"><span class="free">⟩</span></span> <span class="main">∈</span> ptrm <span class="main">0</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> instInp <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

  <span class="keyword1"><span class="command">have</span></span> 6<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">prv</span> <span class="main">(</span>instInpP Pinp <span class="main">0</span> <span class="main">(</span>instInp <span class="main">(</span><span class="free">encF</span> <span class="free">N</span><span class="main">)</span> <span class="main"><span class="free">⟨</span></span><span class="skolem">φ</span><span class="main"><span class="free">⟩</span></span><span class="main">)</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="main">(</span><span class="operator">nrule</span> <span class="quasi_keyword">r</span><span class="main"><span class="main">:</span></span> nprv_prvI<span class="main">)</span>
  <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="main">(</span><span class="operator">nrule</span> <span class="quasi_keyword">r</span><span class="main"><span class="main">:</span></span> nprv_addLemmaE<span class="main"><span class="main">[</span></span><span class="operator">OF</span> 4<span class="main"><span class="main">]</span></span><span class="main">)</span>
  <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="main">(</span><span class="operator">nrule</span> <span class="quasi_keyword">r</span><span class="main"><span class="main">:</span></span> prveqlPT_nprv_instInpP_instInp<span class="main"><span class="main">[</span></span><span class="operator">OF</span> _ _ _ _ _ 5<span class="main"><span class="main">]</span></span><span class="main">)</span> <span class="keyword1"><span class="command">.</span></span>

  <span class="keyword1"><span class="command">note</span></span> lem <span class="main">=</span> <span class="quoted">"**1"</span><span class="main">(</span>2<span class="main">)</span><span class="main">[</span><span class="operator">unfolded</span> ψ_def<span class="main">]</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">prv</span> <span class="skolem">φ</span>"</span></span>
  <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="main">(</span><span class="operator">nrule</span> <span class="quasi_keyword">r</span><span class="main"><span class="main">:</span></span> nprv_prvI<span class="main">)</span>
  <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="main">(</span><span class="operator">nrule</span> <span class="quasi_keyword">r</span><span class="main"><span class="main">:</span></span> nprv_addLemmaE<span class="main"><span class="main">[</span></span><span class="operator">OF</span> 6<span class="main"><span class="main">]</span></span><span class="main">)</span>
  <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="main">(</span><span class="operator">nrule</span> <span class="quasi_keyword">r</span><span class="main"><span class="main">:</span></span> nprv_addImpLemmaE<span class="main"><span class="main">[</span></span><span class="operator">OF</span> lem<span class="main"><span class="main">]</span></span><span class="main">)</span> <span class="keyword1"><span class="command">.</span></span>

  <span class="keyword1"><span class="command">from</span></span> this *** <span class="quoted"><span class="quoted">‹consistent›</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted">False</span> <span class="keyword1"><span class="command">unfolding</span></span> consistent_def3 <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword2"><span class="keyword">end</span></span> <span class="comment1">― ‹context <span class="antiquoted"><span class="antiquote">@{</span><span class="operator">locale</span> Jeroslow_Godel_Second<span class="antiquote">}</span></span>›</span>

<span class="comment1">(*&lt;*)</span>
<span class="keyword2"><span class="keyword">end</span></span>
<span class="comment1">(*&gt;*)</span>
</pre>
</div><div id="Jeroslow_Simplified">
<div class="head">
<h1>Theory Jeroslow_Simplified</h1>
</div>
<pre class="source"><span class="keyword1"><span class="command">section</span></span> <span class="quoted"><span class="plain_text">‹A Simplification of Jeroslow's Original Argument›</span></span>

<span class="comment1">(*&lt;*)</span>
<span class="keyword1"><span class="command">theory</span></span> Jeroslow_Simplified <span class="keyword2"><span class="keyword">imports</span></span> <a href="Abstract_Jeroslow_Encoding.html">Abstract_Jeroslow_Encoding</a>
<span class="keyword2"><span class="keyword">begin</span></span>
<span class="comment1">(*&gt;*)</span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹This is the simplified version of Jeroslow's Second Incompleteness Theorem
reported in our CADE 2019 paper~\cite{DBLP:conf/cade/0001T19}.
The simplification consists of replacing pseudo-terms with plain terms
and representability with (what we call in the paper) term-representability.
This simplified version does not incur the complications of the original.›</span></span>


<span class="keyword1"><span class="command">subsection</span></span> <span class="quoted"><span class="plain_text">‹Jeroslow-style term-based diagonalization›</span></span>

<span class="keyword1"><span class="command">locale</span></span> Jeroslow_Diagonalization <span class="main">=</span>
Deduct_with_False
  <span class="quoted"><span class="free">var</span></span> <span class="quoted"><span class="free">trm</span></span> <span class="quoted"><span class="free">fmla</span></span> <span class="quoted"><span class="free">Var</span></span> <span class="quoted"><span class="free">FvarsT</span></span> <span class="quoted"><span class="free">substT</span></span> <span class="quoted"><span class="free">Fvars</span></span> <span class="quoted"><span class="free">subst</span></span>
  <span class="quoted"><span class="free">eql</span></span> <span class="quoted"><span class="free">cnj</span></span> <span class="quoted"><span class="free">imp</span></span> <span class="quoted"><span class="free">all</span></span> <span class="quoted"><span class="free">exi</span></span>
  <span class="quoted"><span class="free">fls</span></span>
  <span class="quoted"><span class="free">num</span></span>
  <span class="quoted"><span class="free">prv</span></span>
<span class="main">+</span>
Encode
  <span class="quoted"><span class="free">var</span></span> <span class="quoted"><span class="free">trm</span></span> <span class="quoted"><span class="free">fmla</span></span> <span class="quoted"><span class="free">Var</span></span> <span class="quoted"><span class="free">FvarsT</span></span> <span class="quoted"><span class="free">substT</span></span> <span class="quoted"><span class="free">Fvars</span></span> <span class="quoted"><span class="free">subst</span></span>
  <span class="quoted"><span class="free">num</span></span>
  <span class="quoted"><span class="free">enc</span></span>
<span class="main">+</span>
TermEncode
  <span class="quoted"><span class="free">var</span></span> <span class="quoted"><span class="free">trm</span></span> <span class="quoted"><span class="free">fmla</span></span> <span class="quoted"><span class="free">Var</span></span> <span class="quoted"><span class="free">FvarsT</span></span> <span class="quoted"><span class="free">substT</span></span> <span class="quoted"><span class="free">Fvars</span></span> <span class="quoted"><span class="free">subst</span></span>
  <span class="quoted"><span class="free">num</span></span>
  <span class="quoted"><span class="free">Ops</span></span> <span class="quoted"><span class="free">tenc</span></span>
<span class="keyword2"><span class="keyword">for</span></span>
<span class="free">var</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'var</span> set"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="free">trm</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'trm</span> set"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="free">fmla</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'fmla</span> set"</span></span>
<span class="keyword2"><span class="keyword">and</span></span> <span class="free">Var</span> <span class="free">FvarsT</span> <span class="free">substT</span> <span class="free">Fvars</span> <span class="free">subst</span>
<span class="keyword2"><span class="keyword">and</span></span> <span class="free">eql</span> <span class="free">cnj</span> <span class="free">imp</span> <span class="free">all</span> <span class="free">exi</span>
<span class="keyword2"><span class="keyword">and</span></span> <span class="free">fls</span>
<span class="keyword2"><span class="keyword">and</span></span> <span class="free">num</span>
<span class="keyword2"><span class="keyword">and</span></span> <span class="free">prv</span>
<span class="keyword2"><span class="keyword">and</span></span> <span class="free">enc</span> <span class="main">(</span><span class="quoted">"<span class="keyword1">⟨</span>_<span class="keyword1">⟩</span>"</span><span class="main">)</span>
<span class="keyword2"><span class="keyword">and</span></span> <span class="free">Ops</span> <span class="keyword2"><span class="keyword">and</span></span> <span class="free">tenc</span>
<span class="main">+</span>
<span class="keyword2"><span class="keyword">fixes</span></span> <span class="free">F</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="tfree">'trm</span> <span class="main">⇒</span> <span class="tfree">'trm</span><span class="main">)</span> set"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> <span class="free">encF</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="tfree">'trm</span> <span class="main">⇒</span> <span class="tfree">'trm</span><span class="main">)</span> <span class="main">⇒</span> <span class="main">(</span><span class="tfree">'trm</span> <span class="main">⇒</span> <span class="tfree">'trm</span><span class="main">)</span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> <span class="free">N</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'trm</span> <span class="main">⇒</span> <span class="tfree">'trm</span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> <span class="free">ssap</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'fmla</span> <span class="main">⇒</span> <span class="tfree">'trm</span> <span class="main">⇒</span> <span class="tfree">'trm</span>"</span></span>
<span class="keyword2"><span class="keyword">assumes</span></span>
F<span class="main">[</span><span class="operator">simp</span><span class="main">,</span><span class="operator">intro</span><span class="main"><span class="main">!</span></span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">⋀</span> <span class="bound">f</span> <span class="bound">n</span><span class="main">.</span> <span class="bound">f</span> <span class="main">∈</span> <span class="free">F</span> <span class="main">⟹</span> <span class="bound">n</span> <span class="main">∈</span> <span class="free">num</span> <span class="main">⟹</span> <span class="bound">f</span> <span class="bound">n</span> <span class="main">∈</span> <span class="free">num</span>"</span></span>
<span class="keyword2"><span class="keyword">and</span></span>
encF<span class="main">[</span><span class="operator">simp</span><span class="main">,</span><span class="operator">intro</span><span class="main"><span class="main">!</span></span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">⋀</span> <span class="bound">f</span><span class="main">.</span> <span class="bound">f</span> <span class="main">∈</span> <span class="free">F</span> <span class="main">⟹</span> <span class="free">encF</span> <span class="bound">f</span> <span class="main">∈</span> <span class="free">Ops</span>"</span></span>
<span class="keyword2"><span class="keyword">and</span></span>
N<span class="main">[</span><span class="operator">simp</span><span class="main">,</span><span class="operator">intro</span><span class="main"><span class="main">!</span></span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">N</span> <span class="main">∈</span> <span class="free">F</span>"</span></span>
<span class="keyword2"><span class="keyword">and</span></span>
ssap<span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">⋀</span><span class="bound">φ</span><span class="main">.</span> <span class="bound">φ</span> <span class="main">∈</span> <span class="free">fmla</span> <span class="main">⟹</span> <span class="free">Fvars</span> <span class="bound">φ</span> <span class="main">=</span> <span class="main">{</span>xx<span class="main">}</span> <span class="main">⟹</span> <span class="free">ssap</span> <span class="bound">φ</span> <span class="main">∈</span> <span class="free">F</span>"</span></span>
<span class="keyword2"><span class="keyword">and</span></span>
ReprF<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">⋀</span><span class="bound">f</span> <span class="bound">n</span><span class="main">.</span> <span class="bound">f</span> <span class="main">∈</span> <span class="free">F</span> <span class="main">⟹</span> <span class="bound">n</span> <span class="main">∈</span> <span class="free">num</span> <span class="main">⟹</span> <span class="free">prv</span> <span class="main">(</span><span class="free">eql</span> <span class="main">(</span><span class="free">encF</span> <span class="bound">f</span> <span class="bound">n</span><span class="main">)</span> <span class="main">(</span><span class="bound">f</span> <span class="bound">n</span><span class="main">)</span><span class="main">)</span>"</span></span>
<span class="keyword2"><span class="keyword">and</span></span>
CapN<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">⋀</span><span class="bound">φ</span><span class="main">.</span> <span class="bound">φ</span> <span class="main">∈</span> <span class="free">fmla</span> <span class="main">⟹</span> <span class="free">Fvars</span> <span class="bound">φ</span> <span class="main">=</span> <span class="main">{}</span> <span class="main">⟹</span> <span class="free">N</span> <span class="main"><span class="free">⟨</span></span><span class="bound">φ</span><span class="main"><span class="free">⟩</span></span> <span class="main">=</span> <span class="main"><span class="free">⟨</span></span>neg <span class="bound">φ</span><span class="main"><span class="free">⟩</span></span>"</span></span>
<span class="keyword2"><span class="keyword">and</span></span>
CapSS<span class="main">:</span>
<span class="quoted"><span class="quoted">"<span class="main">⋀</span> <span class="bound">ψ</span> <span class="bound">f</span><span class="main">.</span> <span class="bound">ψ</span> <span class="main">∈</span> <span class="free">fmla</span> <span class="main">⟹</span> <span class="free">Fvars</span> <span class="bound">ψ</span> <span class="main">=</span> <span class="main">{</span>xx<span class="main">}</span> <span class="main">⟹</span> <span class="bound">f</span> <span class="main">∈</span> <span class="free">F</span> <span class="main">⟹</span>
    <span class="free">ssap</span> <span class="bound">ψ</span> <span class="main">(</span><span class="free">tenc</span> <span class="main">(</span><span class="free">encF</span> <span class="bound">f</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> <span class="main"><span class="free">⟨</span></span>inst <span class="bound">ψ</span> <span class="main">(</span><span class="free">encF</span> <span class="bound">f</span> <span class="main">(</span><span class="free">tenc</span> <span class="main">(</span><span class="free">encF</span> <span class="bound">f</span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main"><span class="free">⟩</span></span>"</span></span>
<span class="keyword2"><span class="keyword">begin</span></span>

<span class="keyword1"><span class="command">definition</span></span> <span class="entity">tJ</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'fmla</span> <span class="main">⇒</span> <span class="tfree">'trm</span>"</span></span> <span class="keyword2"><span class="keyword">where</span></span>
<span class="quoted"><span class="quoted">"<span class="free">tJ</span> <span class="free"><span class="bound"><span class="entity">ψ</span></span></span> <span class="main">≡</span> <span class="free">encF</span> <span class="main">(</span><span class="free">ssap</span> <span class="free"><span class="bound"><span class="entity">ψ</span></span></span><span class="main">)</span> <span class="main">(</span><span class="free">tenc</span> <span class="main">(</span><span class="free">encF</span> <span class="main">(</span><span class="free">ssap</span> <span class="free"><span class="bound"><span class="entity">ψ</span></span></span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span>

<span class="keyword1"><span class="command">definition</span></span> <span class="entity">φJ</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'fmla</span> <span class="main">⇒</span> <span class="tfree">'fmla</span>"</span></span> <span class="keyword2"><span class="keyword">where</span></span>
<span class="quoted"><span class="quoted">"<span class="free">φJ</span> <span class="free"><span class="bound"><span class="entity">ψ</span></span></span> <span class="main">≡</span> <span class="free">subst</span> <span class="free"><span class="bound"><span class="entity">ψ</span></span></span> <span class="main">(</span>tJ <span class="free"><span class="bound"><span class="entity">ψ</span></span></span><span class="main">)</span> xx"</span></span>

<span class="keyword1"><span class="command">lemma</span></span> tJ<span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span>
<span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">ψ</span> <span class="main">∈</span> <span class="free">fmla</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">Fvars</span> <span class="free">ψ</span> <span class="main">=</span> <span class="main">{</span>xx<span class="main">}</span>"</span></span>
<span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"tJ <span class="free">ψ</span> <span class="main">∈</span> <span class="free">trm</span>"</span></span>
<span class="keyword1"><span class="command">using</span></span> assms tJ_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">lemma</span></span> FvarsT_tJ<span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span>
<span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">ψ</span> <span class="main">∈</span> <span class="free">fmla</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">Fvars</span> <span class="free">ψ</span> <span class="main">=</span> <span class="main">{</span>xx<span class="main">}</span>"</span></span>
<span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">FvarsT</span> <span class="main">(</span>tJ <span class="free">ψ</span><span class="main">)</span> <span class="main">=</span> <span class="main">{}</span>"</span></span>
<span class="keyword1"><span class="command">using</span></span> assms tJ_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">lemma</span></span> φJ<span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span>
<span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">ψ</span> <span class="main">∈</span> <span class="free">fmla</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">Fvars</span> <span class="free">ψ</span> <span class="main">=</span> <span class="main">{</span>xx<span class="main">}</span>"</span></span>
<span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"φJ <span class="free">ψ</span> <span class="main">∈</span> <span class="free">fmla</span>"</span></span>
<span class="keyword1"><span class="command">using</span></span> assms φJ_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">lemma</span></span> Fvars_φJ<span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span>
<span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">ψ</span> <span class="main">∈</span> <span class="free">fmla</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">Fvars</span> <span class="free">ψ</span> <span class="main">=</span> <span class="main">{</span>xx<span class="main">}</span>"</span></span>
<span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">Fvars</span> <span class="main">(</span>φJ <span class="free">ψ</span><span class="main">)</span> <span class="main">=</span> <span class="main">{}</span>"</span></span>
<span class="keyword1"><span class="command">using</span></span> assms φJ_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">lemma</span></span> diagonalization<span class="main">:</span>
<span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">ψ</span> <span class="main">∈</span> <span class="free">fmla</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">Fvars</span> <span class="free">ψ</span> <span class="main">=</span> <span class="main">{</span>xx<span class="main">}</span>"</span></span>
<span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">prv</span> <span class="main">(</span><span class="free">eql</span> <span class="main">(</span>tJ <span class="free">ψ</span><span class="main">)</span> <span class="main"><span class="free">⟨</span></span>inst <span class="free">ψ</span> <span class="main">(</span>tJ <span class="free">ψ</span><span class="main">)</span><span class="main"><span class="free">⟩</span></span><span class="main">)</span> <span class="main">∧</span>
       <span class="free">prv</span> <span class="main">(</span>eqv <span class="main">(</span>φJ <span class="free">ψ</span><span class="main">)</span> <span class="main">(</span>inst <span class="free">ψ</span> <span class="main"><span class="free">⟨</span></span>φJ <span class="free">ψ</span><span class="main"><span class="free">⟩</span></span><span class="main">)</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span>
  <span class="keyword3"><span class="command">define</span></span> <span class="skolem"><span class="skolem">fJ</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">fJ</span> <span class="main">≡</span> <span class="free">ssap</span> <span class="free">ψ</span>"</span></span>
  <span class="keyword1"><span class="command">have</span></span> fJ<span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">fJ</span> <span class="main">∈</span> <span class="free">F</span>"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> fJ_def <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">fJ</span> <span class="main">(</span><span class="free">tenc</span> <span class="main">(</span><span class="free">encF</span> <span class="skolem">fJ</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> <span class="main"><span class="free">⟨</span></span>inst <span class="free">ψ</span> <span class="main">(</span>tJ <span class="free">ψ</span><span class="main">)</span><span class="main"><span class="free">⟩</span></span>"</span></span>
   <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> CapSS assms fJ_def tJ_def<span class="main">)</span>
  <span class="keyword3"><span class="command">thus</span></span> **<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">prv</span> <span class="main">(</span><span class="free">eql</span> <span class="main">(</span>tJ <span class="free">ψ</span><span class="main">)</span> <span class="main"><span class="free">⟨</span></span>inst <span class="free">ψ</span> <span class="main">(</span>tJ <span class="free">ψ</span><span class="main">)</span><span class="main"><span class="free">⟩</span></span><span class="main">)</span>"</span></span>
   <span class="keyword1"><span class="command">using</span></span> ReprF fJ fJ_def tJ_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">fastforce</span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="free">prv</span> <span class="main">(</span>eqv <span class="main">(</span>φJ <span class="free">ψ</span><span class="main">)</span> <span class="main">(</span>inst <span class="free">ψ</span> <span class="main"><span class="free">⟨</span></span>φJ <span class="free">ψ</span><span class="main"><span class="free">⟩</span></span><span class="main">)</span><span class="main">)</span>"</span></span>
   <span class="keyword1"><span class="command">using</span></span> assms prv_eql_subst_trm_eqv<span class="main">[</span><span class="operator">OF</span> xx _  _ _ **<span class="main">,</span> <span class="operator">of</span> <span class="quoted"><span class="quoted">"<span class="free">ψ</span>"</span></span><span class="main">]</span>
   <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> φJ_def inst_def<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword2"><span class="keyword">end</span></span> <span class="comment1">― ‹context <span class="antiquoted"><span class="antiquote">@{</span><span class="operator">locale</span> Jeroslow_Diagonalization<span class="antiquote">}</span></span>›</span>


<span class="keyword1"><span class="command">subsection</span></span> <span class="quoted"><span class="plain_text">‹Term-based version of Jeroslow's Second Incompleteness Theorem›</span></span>

<span class="keyword1"><span class="command">locale</span></span> Jeroslow_Godel_Second <span class="main">=</span>
Jeroslow_Diagonalization
  <span class="quoted"><span class="free">var</span></span> <span class="quoted"><span class="free">trm</span></span> <span class="quoted"><span class="free">fmla</span></span> <span class="quoted"><span class="free">Var</span></span> <span class="quoted"><span class="free">FvarsT</span></span> <span class="quoted"><span class="free">substT</span></span> <span class="quoted"><span class="free">Fvars</span></span> <span class="quoted"><span class="free">subst</span></span>
  <span class="quoted"><span class="free">eql</span></span> <span class="quoted"><span class="free">cnj</span></span> <span class="quoted"><span class="free">imp</span></span> <span class="quoted"><span class="free">all</span></span> <span class="quoted"><span class="free">exi</span></span>
  <span class="quoted"><span class="free">fls</span></span>
  <span class="quoted"><span class="free">num</span></span>
  <span class="quoted"><span class="free">prv</span></span>
  <span class="quoted"><span class="free">enc</span></span>
  <span class="quoted"><span class="free">Ops</span></span> <span class="quoted"><span class="free">tenc</span></span>
  <span class="quoted"><span class="free">F</span></span> <span class="quoted"><span class="free">encF</span></span> <span class="quoted"><span class="free">N</span></span> <span class="quoted"><span class="free">ssap</span></span>
<span class="main">+</span>
HBL1
  <span class="quoted"><span class="free">var</span></span> <span class="quoted"><span class="free">trm</span></span> <span class="quoted"><span class="free">fmla</span></span> <span class="quoted"><span class="free">Var</span></span> <span class="quoted"><span class="free">FvarsT</span></span> <span class="quoted"><span class="free">substT</span></span> <span class="quoted"><span class="free">Fvars</span></span> <span class="quoted"><span class="free">subst</span></span>
  <span class="quoted"><span class="free">num</span></span>
  <span class="quoted"><span class="free">eql</span></span> <span class="quoted"><span class="free">cnj</span></span> <span class="quoted"><span class="free">imp</span></span> <span class="quoted"><span class="free">all</span></span> <span class="quoted"><span class="free">exi</span></span>
  <span class="quoted"><span class="free">prv</span></span> <span class="quoted"><span class="free">prv</span></span>
  <span class="quoted"><span class="free">enc</span></span>
  <span class="quoted"><span class="free">P</span></span>
<span class="keyword2"><span class="keyword">for</span></span>
<span class="free">var</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'var</span> set"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="free">trm</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'trm</span> set"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="free">fmla</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'fmla</span> set"</span></span>
<span class="keyword2"><span class="keyword">and</span></span> <span class="free">Var</span> <span class="free">FvarsT</span> <span class="free">substT</span> <span class="free">Fvars</span> <span class="free">subst</span>
<span class="keyword2"><span class="keyword">and</span></span> <span class="free">eql</span> <span class="free">cnj</span> <span class="free">imp</span> <span class="free">all</span> <span class="free">exi</span>
<span class="keyword2"><span class="keyword">and</span></span> <span class="free">fls</span>
<span class="keyword2"><span class="keyword">and</span></span> <span class="free">num</span>
<span class="keyword2"><span class="keyword">and</span></span> <span class="free">prv</span>
<span class="keyword2"><span class="keyword">and</span></span> <span class="free">enc</span> <span class="main">(</span><span class="quoted">"<span class="keyword1">⟨</span>_<span class="keyword1">⟩</span>"</span><span class="main">)</span>
<span class="keyword2"><span class="keyword">and</span></span> <span class="free">Ops</span> <span class="keyword2"><span class="keyword">and</span></span> <span class="free">tenc</span>
<span class="keyword2"><span class="keyword">and</span></span> <span class="free">P</span>
<span class="keyword2"><span class="keyword">and</span></span> <span class="free">F</span> <span class="free">encF</span> <span class="free">N</span> <span class="free">ssap</span>
<span class="main">+</span>
<span class="keyword2"><span class="keyword">assumes</span></span>
SHBL3<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">⋀</span><span class="bound">t</span><span class="main">.</span> <span class="bound">t</span> <span class="main">∈</span> <span class="free">trm</span> <span class="main">⟹</span> <span class="free">FvarsT</span> <span class="bound">t</span> <span class="main">=</span> <span class="main">{}</span> <span class="main">⟹</span> <span class="free">prv</span> <span class="main">(</span><span class="free">imp</span> <span class="main">(</span>PP <span class="bound">t</span><span class="main">)</span> <span class="main">(</span>PP <span class="main"><span class="free">⟨</span></span>PP <span class="bound">t</span><span class="main"><span class="free">⟩</span></span><span class="main">)</span><span class="main">)</span>"</span></span>
<span class="keyword2"><span class="keyword">begin</span></span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹Consistency formula a la Jeroslow:›</span></span>
<span class="keyword1"><span class="command">definition</span></span> <span class="entity">jcons</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'fmla</span>"</span></span> <span class="keyword2"><span class="keyword">where</span></span>
<span class="quoted"><span class="quoted">"<span class="free">jcons</span> <span class="main">≡</span> <span class="free">all</span> xx <span class="main">(</span>neg <span class="main">(</span><span class="free">cnj</span> <span class="main">(</span>PP <span class="main">(</span><span class="free">Var</span> xx<span class="main">)</span><span class="main">)</span> <span class="main">(</span>PP <span class="main">(</span><span class="free">encF</span> <span class="free">N</span> <span class="main">(</span><span class="free">Var</span> <span class="main">(</span>xx<span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span>

<span class="keyword1"><span class="command">lemma</span></span> prv_eql_subst_trm3<span class="main">:</span>
<span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main">∈</span> <span class="free">var</span> <span class="main">⟹</span> <span class="free">φ</span> <span class="main">∈</span> <span class="free">fmla</span> <span class="main">⟹</span> <span class="free">t1</span> <span class="main">∈</span> <span class="free">trm</span> <span class="main">⟹</span> <span class="free">t2</span> <span class="main">∈</span> <span class="free">trm</span> <span class="main">⟹</span>
<span class="free">prv</span> <span class="main">(</span><span class="free">eql</span> <span class="free">t1</span> <span class="free">t2</span><span class="main">)</span> <span class="main">⟹</span> <span class="free">prv</span> <span class="main">(</span><span class="free">subst</span> <span class="free">φ</span> <span class="free">t1</span> <span class="free">x</span><span class="main">)</span> <span class="main">⟹</span> <span class="free">prv</span> <span class="main">(</span><span class="free">subst</span> <span class="free">φ</span> <span class="free">t2</span> <span class="free">x</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">using</span></span> prv_eql_subst_trm2
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">meson</span> subst prv_imp_mp<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> prv_eql_neg_encF_N<span class="main">:</span>
<span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">φ</span> <span class="main">∈</span> <span class="free">fmla</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">Fvars</span> <span class="free">φ</span> <span class="main">=</span> <span class="main">{}</span>"</span></span>
<span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">prv</span> <span class="main">(</span><span class="free">eql</span> <span class="main"><span class="free">⟨</span></span>neg <span class="free">φ</span><span class="main"><span class="free">⟩</span></span> <span class="main">(</span><span class="free">encF</span> <span class="free">N</span> <span class="main"><span class="free">⟨</span></span><span class="free">φ</span><span class="main"><span class="free">⟩</span></span><span class="main">)</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">unfolding</span></span> CapN<span class="main">[</span><span class="operator">symmetric</span><span class="main">,</span> <span class="operator">OF</span> assms<span class="main">]</span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> prv_prv_eql_sym<span class="main">)</span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> assms <span class="quasi_keyword">intro</span><span class="main"><span class="main">:</span></span> ReprF<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> prv_imp_neg_encF_N_aux<span class="main">:</span>
<span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">φ</span> <span class="main">∈</span> <span class="free">fmla</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">Fvars</span> <span class="free">φ</span> <span class="main">=</span> <span class="main">{}</span>"</span></span>
<span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">prv</span> <span class="main">(</span><span class="free">imp</span> <span class="main">(</span>PP <span class="main"><span class="free">⟨</span></span>neg <span class="free">φ</span><span class="main"><span class="free">⟩</span></span><span class="main">)</span> <span class="main">(</span>PP <span class="main">(</span><span class="free">encF</span> <span class="free">N</span> <span class="main"><span class="free">⟨</span></span><span class="free">φ</span><span class="main"><span class="free">⟩</span></span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">using</span></span> assms prv_eql_subst_trm2<span class="main">[</span><span class="operator">OF</span> _ _ _ _ prv_eql_neg_encF_N<span class="main"><span class="main">[</span></span><span class="operator">OF</span> assms<span class="main"><span class="main">]</span></span><span class="main">,</span>
  <span class="operator">of</span> <span class="quoted">xx</span> <span class="quoted"><span class="quoted">"PP <span class="main">(</span><span class="free">Var</span> xx<span class="main">)</span>"</span></span><span class="main">]</span>
  <span class="keyword1"><span class="command">unfolding</span></span> PP_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">lemma</span></span> prv_cnj_neg_encF_N_aux<span class="main">:</span>
<span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">φ</span> <span class="main">∈</span> <span class="free">fmla</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">Fvars</span> <span class="free">φ</span> <span class="main">=</span> <span class="main">{}</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="free">χ</span> <span class="main">∈</span> <span class="free">fmla</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="free">Fvars</span> <span class="free">χ</span> <span class="main">=</span> <span class="main">{}</span>"</span></span>
<span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">prv</span> <span class="main">(</span>neg <span class="main">(</span><span class="free">cnj</span> <span class="free">χ</span> <span class="main">(</span>PP <span class="main"><span class="free">⟨</span></span>neg <span class="free">φ</span><span class="main"><span class="free">⟩</span></span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span>
<span class="keyword2"><span class="keyword">shows</span></span><span class="quoted"><span class="quoted">"<span class="free">prv</span> <span class="main">(</span>neg <span class="main">(</span><span class="free">cnj</span> <span class="free">χ</span> <span class="main">(</span>PP <span class="main">(</span><span class="free">encF</span> <span class="free">N</span> <span class="main"><span class="free">⟨</span></span><span class="free">φ</span><span class="main"><span class="free">⟩</span></span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">using</span></span> assms prv_eql_subst_trm3<span class="main">[</span><span class="operator">OF</span> _ _ _ _ prv_eql_neg_encF_N<span class="main">,</span>
  <span class="operator">of</span> <span class="quoted">xx</span> <span class="quoted"><span class="quoted">"neg <span class="main">(</span><span class="free">cnj</span> <span class="free">χ</span> <span class="main">(</span>PP <span class="main">(</span><span class="free">Var</span> xx<span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span><span class="main">]</span>
  <span class="keyword1"><span class="command">unfolding</span></span> PP_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">theorem</span></span> jeroslow_godel_second<span class="main">:</span>
<span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted">consistent</span>
<span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> <span class="free">prv</span> jcons"</span></span>
<span class="keyword1"><span class="command">proof</span></span>
  <span class="keyword3"><span class="command">assume</span></span> *<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">prv</span> jcons"</span></span>
  <span class="keyword3"><span class="command">define</span></span> <span class="skolem"><span class="skolem">ψ</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">ψ</span> <span class="main">≡</span> PP <span class="main">(</span><span class="free">encF</span> <span class="free">N</span> <span class="main">(</span><span class="free">Var</span> xx<span class="main">)</span><span class="main">)</span>"</span></span>
  <span class="keyword3"><span class="command">define</span></span> <span class="skolem"><span class="skolem">t</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">t</span> <span class="main">≡</span> tJ <span class="skolem">ψ</span>"</span></span>
  <span class="keyword1"><span class="command">have</span></span> ψ<span class="main">[</span><span class="operator">simp</span><span class="main">,</span><span class="operator">intro</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">ψ</span> <span class="main">∈</span> <span class="free">fmla</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="free">Fvars</span> <span class="skolem">ψ</span> <span class="main">=</span> <span class="main">{</span>xx<span class="main">}</span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> t<span class="main">[</span><span class="operator">simp</span><span class="main">,</span><span class="operator">intro</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">t</span> <span class="main">∈</span> <span class="free">trm</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="free">FvarsT</span> <span class="skolem">t</span> <span class="main">=</span> <span class="main">{}</span>"</span></span>
    <span class="keyword1"><span class="command">unfolding</span></span> ψ_def t_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

  <span class="keyword1"><span class="command">have</span></span> sPP<span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">subst</span> <span class="main">(</span>PP <span class="main">(</span><span class="free">encF</span> <span class="free">N</span> <span class="main">(</span><span class="free">Var</span> xx<span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main"><span class="free">⟨</span></span>PP <span class="main">(</span><span class="free">encF</span> <span class="free">N</span> <span class="skolem">t</span><span class="main">)</span><span class="main"><span class="free">⟩</span></span> xx <span class="main">=</span>
             PP <span class="main">(</span><span class="free">encF</span> <span class="free">N</span> <span class="main"><span class="free">⟨</span></span>PP <span class="main">(</span><span class="free">encF</span> <span class="free">N</span> <span class="skolem">t</span><span class="main">)</span><span class="main"><span class="free">⟩</span></span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">unfolding</span></span> PP_def <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">subst</span> subst_compose_eq_or<span class="main">)</span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">have</span></span> sPP2<span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">subst</span> <span class="main">(</span>PP <span class="main">(</span><span class="free">encF</span> <span class="free">N</span> <span class="main">(</span><span class="free">Var</span> xx<span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="skolem">t</span> xx <span class="main">=</span> PP <span class="main">(</span><span class="free">encF</span> <span class="free">N</span> <span class="skolem">t</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">unfolding</span></span> PP_def <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">subst</span> subst_compose_eq_or<span class="main">)</span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">have</span></span> 00<span class="main">:</span> <span class="quoted"><span class="quoted">"PP <span class="main">(</span><span class="free">encF</span> <span class="free">N</span> <span class="skolem">t</span><span class="main">)</span> <span class="main">=</span> inst <span class="skolem">ψ</span> <span class="skolem">t</span>"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> ψ_def inst_def PP_def
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">subst</span> subst_compose_eq_or<span class="main">)</span> <span class="operator">auto</span>

  <span class="keyword3"><span class="command">define</span></span> <span class="skolem"><span class="skolem">φ</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">φ</span> <span class="main">≡</span> φJ <span class="skolem">ψ</span>"</span></span>
  <span class="keyword1"><span class="command">have</span></span> <span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">φ</span> <span class="main">∈</span> <span class="free">fmla</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="free">Fvars</span> <span class="skolem">φ</span> <span class="main">=</span> <span class="main">{}</span>"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> φ_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">have</span></span> **<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">prv</span> <span class="main">(</span><span class="free">eql</span> <span class="skolem">t</span> <span class="main"><span class="free">⟨</span></span><span class="skolem">φ</span><span class="main"><span class="free">⟩</span></span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">unfolding</span></span> 00 φ_def
    <span class="keyword1"><span class="command">using</span></span> φJ_def diagonalization inst_def t_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">have</span></span> φ<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">φ</span> <span class="main">=</span> PP <span class="main">(</span><span class="free">encF</span> <span class="free">N</span> <span class="skolem">t</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> φ_def φJ_def t_def ψ_def
    <span class="keyword1"><span class="command">using</span></span> sPP2 ψ_def t_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">have</span></span> 1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">prv</span> <span class="main">(</span><span class="free">imp</span> <span class="skolem">φ</span> <span class="main">(</span>PP <span class="main"><span class="free">⟨</span></span><span class="skolem">φ</span><span class="main"><span class="free">⟩</span></span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> SHBL3<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="quoted">"<span class="free">encF</span> <span class="free">N</span> <span class="skolem">t</span>"</span></span><span class="main">]</span>
    <span class="keyword1"><span class="command">using</span></span> 00 φJ_def φ_def ψ_def inst_def t_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">have</span></span> eqv_φ<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">prv</span> <span class="main">(</span>eqv <span class="skolem">φ</span> <span class="main">(</span>PP <span class="main">(</span><span class="free">encF</span> <span class="free">N</span> <span class="main"><span class="free">⟨</span></span><span class="skolem">φ</span><span class="main"><span class="free">⟩</span></span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span>  <span class="keyword1"><span class="command">using</span></span> diagonalization
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> <span class="quoted">"00"</span> sPP φJ_def φ_def ψ ψ_def diagonalization inst_def t_def<span class="main">)</span>
  <span class="keyword1"><span class="command">have</span></span> 2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">prv</span> <span class="main">(</span><span class="free">imp</span> <span class="skolem">φ</span> <span class="main">(</span>PP <span class="main">(</span><span class="free">encF</span> <span class="free">N</span> <span class="main"><span class="free">⟨</span></span><span class="skolem">φ</span><span class="main"><span class="free">⟩</span></span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span>
   <span class="keyword1"><span class="command">using</span></span> prv_cnjEL<span class="main">[</span><span class="operator">OF</span> _ _ eqv_φ<span class="main"><span class="main">[</span></span><span class="operator">unfolded</span> eqv_def<span class="main"><span class="main">]</span></span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">prv</span> <span class="main">(</span><span class="free">imp</span> <span class="main">(</span>PP <span class="main">(</span><span class="free">encF</span> <span class="free">N</span> <span class="main"><span class="free">⟨</span></span><span class="skolem">φ</span><span class="main"><span class="free">⟩</span></span><span class="main">)</span><span class="main">)</span> <span class="skolem">φ</span><span class="main">)</span>"</span></span>
   <span class="keyword1"><span class="command">using</span></span> prv_cnjER<span class="main">[</span><span class="operator">OF</span> _ _ eqv_φ<span class="main"><span class="main">[</span></span><span class="operator">unfolded</span> eqv_def<span class="main"><span class="main">]</span></span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">from</span></span>  prv_prv_imp_trans<span class="main">[</span><span class="operator">OF</span> _ _ _ prv_imp_neg_encF_N_aux this<span class="main">]</span>
  <span class="keyword1"><span class="command">have</span></span> 22<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">prv</span> <span class="main">(</span><span class="free">imp</span> <span class="main">(</span>PP <span class="main"><span class="free">⟨</span></span>neg <span class="skolem">φ</span><span class="main"><span class="free">⟩</span></span><span class="main">)</span> <span class="skolem">φ</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">have</span></span> 3<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">prv</span> <span class="main">(</span><span class="free">imp</span> <span class="skolem">φ</span> <span class="main">(</span><span class="free">cnj</span> <span class="main">(</span>PP <span class="main"><span class="free">⟨</span></span><span class="skolem">φ</span><span class="main"><span class="free">⟩</span></span><span class="main">)</span> <span class="main">(</span>PP <span class="main">(</span><span class="free">encF</span> <span class="free">N</span> <span class="main"><span class="free">⟨</span></span><span class="skolem">φ</span><span class="main"><span class="free">⟩</span></span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> prv_imp_cnj<span class="main"><span class="main">[</span></span><span class="operator">OF</span> _ _ _ 1 2<span class="main"><span class="main">]</span></span><span class="main">)</span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> φ_def<span class="main">)</span>
  <span class="keyword1"><span class="command">have</span></span> 4<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">prv</span> <span class="main">(</span>neg <span class="main">(</span><span class="free">cnj</span> <span class="main">(</span>PP <span class="main"><span class="free">⟨</span></span><span class="skolem">φ</span><span class="main"><span class="free">⟩</span></span><span class="main">)</span> <span class="main">(</span>PP <span class="main">(</span><span class="free">encF</span> <span class="free">N</span> <span class="main"><span class="free">⟨</span></span><span class="skolem">φ</span><span class="main"><span class="free">⟩</span></span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span>
     <span class="keyword1"><span class="command">using</span></span> prv_allE<span class="main">[</span><span class="operator">OF</span> _ _ _ *<span class="main"><span class="main">[</span></span><span class="operator">unfolded</span> jcons_def<span class="main"><span class="main">]</span></span><span class="main">,</span> <span class="operator">of</span> <span class="quoted"><span class="quoted">"<span class="main"><span class="free">⟨</span></span><span class="skolem">φ</span><span class="main"><span class="free">⟩</span></span>"</span></span><span class="main">]</span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> φ ψ_def<span class="main">)</span>
  <span class="keyword1"><span class="command">have</span></span> 5<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">prv</span> <span class="main">(</span>neg <span class="skolem">φ</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">unfolding</span></span> neg_def
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> prv_prv_imp_trans<span class="main"><span class="main">[</span></span><span class="operator">OF</span> _ _ _ 3 4<span class="main"><span class="main">[</span></span><span class="operator">unfolded</span> neg_def<span class="main"><span class="main">]</span></span><span class="main"><span class="main">]</span></span><span class="main">)</span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="free">prv</span> <span class="main">(</span>PP <span class="main"><span class="free">⟨</span></span>neg <span class="skolem">φ</span><span class="main"><span class="free">⟩</span></span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span>
      HBL1_PP<span class="main">[</span><span class="operator">OF</span> _ _ 5<span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="free">prv</span> <span class="skolem">φ</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> prv_imp_mp<span class="main">[</span><span class="operator">OF</span> _ _ 22<span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">with</span></span> 5 assms <span class="keyword3"><span class="command">show</span></span> <span class="quoted">False</span> <span class="keyword1"><span class="command">unfolding</span></span> consistent_def3 <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>


<span class="keyword1"><span class="command">subsection</span></span> <span class="quoted"><span class="plain_text">‹A variant of the Second Incompleteness Theorem›</span></span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹This variant (also discussed in our CADE 2019 paper~\cite{DBLP:conf/cade/0001T19}) strengthens
the conclusion of the theorem to the standard formulation
of "does not prove its own consistency" at the expense of two
additional derivability-like conditions, HBL4 and WHBL2.›</span></span>

<span class="keyword1"><span class="command">theorem</span></span> jeroslow_godel_second_standardCon<span class="main">:</span>
<span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted">consistent</span>
<span class="keyword2"><span class="keyword">and</span></span> HBL4<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">⋀</span><span class="bound">φ1</span> <span class="bound">φ2</span><span class="main">.</span> <span class="main">{</span><span class="bound">φ1</span><span class="main">,</span><span class="bound">φ2</span><span class="main">}</span> <span class="main">⊆</span> <span class="free">fmla</span> <span class="main">⟹</span> <span class="free">Fvars</span> <span class="bound">φ1</span> <span class="main">=</span> <span class="main">{}</span> <span class="main">⟹</span> <span class="free">Fvars</span> <span class="bound">φ2</span> <span class="main">=</span> <span class="main">{}</span> <span class="main">⟹</span>
   <span class="free">prv</span> <span class="main">(</span><span class="free">imp</span> <span class="main">(</span><span class="free">cnj</span> <span class="main">(</span>PP <span class="main"><span class="free">⟨</span></span><span class="bound">φ1</span><span class="main"><span class="free">⟩</span></span><span class="main">)</span> <span class="main">(</span>PP <span class="main"><span class="free">⟨</span></span><span class="bound">φ2</span><span class="main"><span class="free">⟩</span></span><span class="main">)</span><span class="main">)</span> <span class="main">(</span>PP <span class="main"><span class="free">⟨</span></span><span class="free">cnj</span> <span class="bound">φ1</span> <span class="bound">φ2</span><span class="main"><span class="free">⟩</span></span><span class="main">)</span><span class="main">)</span>"</span></span>
<span class="keyword2"><span class="keyword">and</span></span> WHBL2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">⋀</span><span class="bound">φ1</span> <span class="bound">φ2</span><span class="main">.</span> <span class="main">{</span><span class="bound">φ1</span><span class="main">,</span><span class="bound">φ2</span><span class="main">}</span> <span class="main">⊆</span> <span class="free">fmla</span> <span class="main">⟹</span> <span class="free">Fvars</span> <span class="bound">φ1</span> <span class="main">=</span> <span class="main">{}</span> <span class="main">⟹</span> <span class="free">Fvars</span> <span class="bound">φ2</span> <span class="main">=</span> <span class="main">{}</span> <span class="main">⟹</span>
   <span class="free">prv</span> <span class="main">(</span><span class="free">imp</span> <span class="bound">φ1</span> <span class="bound">φ2</span><span class="main">)</span> <span class="main">⟹</span> <span class="free">prv</span> <span class="main">(</span><span class="free">imp</span> <span class="main">(</span>PP <span class="main"><span class="free">⟨</span></span><span class="bound">φ1</span><span class="main"><span class="free">⟩</span></span><span class="main">)</span> <span class="main">(</span>PP <span class="main"><span class="free">⟨</span></span><span class="bound">φ2</span><span class="main"><span class="free">⟩</span></span><span class="main">)</span><span class="main">)</span>"</span></span>
<span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> <span class="free">prv</span> <span class="main">(</span>neg <span class="main">(</span>PP <span class="main"><span class="free">⟨</span></span><span class="free">fls</span><span class="main"><span class="free">⟩</span></span><span class="main">)</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span>
  <span class="keyword3"><span class="command">assume</span></span> *<span class="main">:</span>  <span class="quoted"><span class="quoted">"<span class="free">prv</span> <span class="main">(</span>neg <span class="main">(</span>PP <span class="main"><span class="free">⟨</span></span><span class="free">fls</span><span class="main"><span class="free">⟩</span></span><span class="main">)</span><span class="main">)</span>"</span></span>
  <span class="keyword3"><span class="command">define</span></span> <span class="skolem"><span class="skolem">ψ</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">ψ</span> <span class="main">≡</span> PP <span class="main">(</span><span class="free">encF</span> <span class="free">N</span> <span class="main">(</span><span class="free">Var</span> xx<span class="main">)</span><span class="main">)</span>"</span></span>
  <span class="keyword3"><span class="command">define</span></span> <span class="skolem"><span class="skolem">t</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">t</span> <span class="main">≡</span> tJ <span class="skolem">ψ</span>"</span></span>
  <span class="keyword1"><span class="command">have</span></span> ψ<span class="main">[</span><span class="operator">simp</span><span class="main">,</span><span class="operator">intro</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">ψ</span> <span class="main">∈</span> <span class="free">fmla</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="free">Fvars</span> <span class="skolem">ψ</span> <span class="main">=</span> <span class="main">{</span>xx<span class="main">}</span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> t<span class="main">[</span><span class="operator">simp</span><span class="main">,</span><span class="operator">intro</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">t</span> <span class="main">∈</span> <span class="free">trm</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="free">FvarsT</span> <span class="skolem">t</span> <span class="main">=</span> <span class="main">{}</span>"</span></span>
    <span class="keyword1"><span class="command">unfolding</span></span> ψ_def t_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

  <span class="keyword1"><span class="command">have</span></span> <span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">subst</span> <span class="main">(</span>PP <span class="main">(</span><span class="free">encF</span> <span class="free">N</span> <span class="main">(</span><span class="free">Var</span> xx<span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main"><span class="free">⟨</span></span>PP <span class="main">(</span><span class="free">encF</span> <span class="free">N</span> <span class="skolem">t</span><span class="main">)</span><span class="main"><span class="free">⟩</span></span> xx <span class="main">=</span>
             PP <span class="main">(</span><span class="free">encF</span> <span class="free">N</span> <span class="main"><span class="free">⟨</span></span>PP <span class="main">(</span><span class="free">encF</span> <span class="free">N</span> <span class="skolem">t</span><span class="main">)</span><span class="main"><span class="free">⟩</span></span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">unfolding</span></span> PP_def <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">subst</span> subst_compose_eq_or<span class="main">)</span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">subst</span> <span class="main">(</span>PP <span class="main">(</span><span class="free">encF</span> <span class="free">N</span> <span class="main">(</span><span class="free">Var</span> xx<span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="skolem">t</span> xx <span class="main">=</span> PP <span class="main">(</span><span class="free">encF</span> <span class="free">N</span> <span class="skolem">t</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">unfolding</span></span> PP_def <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">subst</span> subst_compose_eq_or<span class="main">)</span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">have</span></span> 00<span class="main">:</span> <span class="quoted"><span class="quoted">"PP <span class="main">(</span><span class="free">encF</span> <span class="free">N</span> <span class="skolem">t</span><span class="main">)</span> <span class="main">=</span> inst <span class="skolem">ψ</span> <span class="skolem">t</span>"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> ψ_def inst_def PP_def
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">subst</span> subst_compose_eq_or<span class="main">)</span> <span class="operator">auto</span>

  <span class="keyword3"><span class="command">define</span></span> <span class="skolem"><span class="skolem">φ</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">φ</span> <span class="main">=</span> PP <span class="main">(</span><span class="free">encF</span> <span class="free">N</span> <span class="skolem">t</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">have</span></span> <span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">φ</span> <span class="main">∈</span> <span class="free">fmla</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="free">Fvars</span> <span class="skolem">φ</span> <span class="main">=</span> <span class="main">{}</span>"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> φ_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">have</span></span> **<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">prv</span> <span class="main">(</span><span class="free">eql</span> <span class="skolem">t</span> <span class="main"><span class="free">⟨</span></span>PP <span class="main">(</span><span class="free">encF</span> <span class="free">N</span> <span class="skolem">t</span><span class="main">)</span><span class="main"><span class="free">⟩</span></span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">unfolding</span></span> 00 <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> diagonalization t_def<span class="main">)</span>
  <span class="keyword1"><span class="command">have</span></span> 1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">prv</span> <span class="main">(</span><span class="free">imp</span> <span class="skolem">φ</span> <span class="main">(</span>PP <span class="main"><span class="free">⟨</span></span><span class="skolem">φ</span><span class="main"><span class="free">⟩</span></span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> SHBL3<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="quoted">"<span class="free">encF</span> <span class="free">N</span> <span class="skolem">t</span>"</span></span><span class="main">]</span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> φ_def<span class="main">)</span>
  <span class="keyword1"><span class="command">have</span></span> 2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">prv</span> <span class="main">(</span><span class="free">imp</span> <span class="skolem">φ</span> <span class="main">(</span>PP <span class="main">(</span><span class="free">encF</span> <span class="free">N</span> <span class="main"><span class="free">⟨</span></span><span class="skolem">φ</span><span class="main"><span class="free">⟩</span></span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span>
   <span class="keyword1"><span class="command">using</span></span> prv_eql_subst_trm2<span class="main">[</span><span class="operator">OF</span> xx _  _ _ **<span class="main">,</span> <span class="operator">of</span> <span class="quoted"><span class="quoted">"PP <span class="main">(</span><span class="free">encF</span> <span class="free">N</span> <span class="main">(</span><span class="free">Var</span> xx<span class="main">)</span><span class="main">)</span>"</span></span><span class="main">]</span>
   <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> φ_def<span class="main">)</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">prv</span> <span class="main">(</span><span class="free">imp</span> <span class="main">(</span>PP <span class="main">(</span><span class="free">encF</span> <span class="free">N</span> <span class="main"><span class="free">⟨</span></span><span class="skolem">φ</span><span class="main"><span class="free">⟩</span></span><span class="main">)</span><span class="main">)</span> <span class="skolem">φ</span><span class="main">)</span>"</span></span>
   <span class="keyword1"><span class="command">using</span></span> prv_eql_subst_trm_rev2<span class="main">[</span><span class="operator">OF</span> xx _  _ _ **<span class="main">,</span> <span class="operator">of</span> <span class="quoted"><span class="quoted">"PP <span class="main">(</span><span class="free">encF</span> <span class="free">N</span> <span class="main">(</span><span class="free">Var</span> xx<span class="main">)</span><span class="main">)</span>"</span></span><span class="main">]</span>
   <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> φ_def<span class="main">)</span>
  <span class="keyword1"><span class="command">from</span></span> prv_prv_imp_trans<span class="main">[</span><span class="operator">OF</span> _ _ _ prv_imp_neg_encF_N_aux this<span class="main">]</span>
  <span class="keyword1"><span class="command">have</span></span> 22<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">prv</span> <span class="main">(</span><span class="free">imp</span> <span class="main">(</span>PP <span class="main"><span class="free">⟨</span></span>neg <span class="skolem">φ</span><span class="main"><span class="free">⟩</span></span><span class="main">)</span> <span class="skolem">φ</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">have</span></span> 3<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">prv</span> <span class="main">(</span><span class="free">imp</span> <span class="skolem">φ</span> <span class="main">(</span><span class="free">cnj</span> <span class="main">(</span>PP <span class="main"><span class="free">⟨</span></span><span class="skolem">φ</span><span class="main"><span class="free">⟩</span></span><span class="main">)</span> <span class="main">(</span>PP <span class="main">(</span><span class="free">encF</span> <span class="free">N</span> <span class="main"><span class="free">⟨</span></span><span class="skolem">φ</span><span class="main"><span class="free">⟩</span></span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> prv_imp_cnj<span class="main"><span class="main">[</span></span><span class="operator">OF</span> _ _ _ 1 2<span class="main"><span class="main">]</span></span><span class="main">)</span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> φ_def<span class="main">)</span>

  <span class="comment1">― ‹This is the modification from the proof of <span class="antiquoted"><span class="antiquote">@{</span><span class="operator">thm</span> jeroslow_godel_second<span class="antiquote">}</span></span>:›</span>
  <span class="keyword1"><span class="command">have</span></span> 41<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">prv</span> <span class="main">(</span><span class="free">imp</span> <span class="main">(</span><span class="free">cnj</span> <span class="main">(</span>PP <span class="main"><span class="free">⟨</span></span><span class="skolem">φ</span><span class="main"><span class="free">⟩</span></span><span class="main">)</span> <span class="main">(</span>PP <span class="main"><span class="free">⟨</span></span>neg <span class="skolem">φ</span><span class="main"><span class="free">⟩</span></span><span class="main">)</span><span class="main">)</span> <span class="main">(</span>PP <span class="main"><span class="free">⟨</span></span><span class="free">cnj</span> <span class="skolem">φ</span> <span class="main">(</span>neg <span class="skolem">φ</span><span class="main">)</span><span class="main"><span class="free">⟩</span></span><span class="main">)</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> HBL4<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="skolem">φ</span></span> <span class="quoted"><span class="quoted">"neg <span class="skolem">φ</span>"</span></span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">prv</span> <span class="main">(</span><span class="free">imp</span> <span class="main">(</span><span class="free">cnj</span> <span class="skolem">φ</span> <span class="main">(</span>neg <span class="skolem">φ</span><span class="main">)</span><span class="main">)</span> <span class="main">(</span><span class="free">fls</span><span class="main">)</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> prv_cnj_imp_monoR2 prv_imp_neg_fls<span class="main">)</span>
  <span class="keyword1"><span class="command">from</span></span> WHBL2<span class="main">[</span><span class="operator">OF</span> _ _ _ this<span class="main">]</span>
  <span class="keyword1"><span class="command">have</span></span> 42<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">prv</span> <span class="main">(</span><span class="free">imp</span> <span class="main">(</span>PP <span class="main"><span class="free">⟨</span></span><span class="free">cnj</span> <span class="skolem">φ</span> <span class="main">(</span>neg <span class="skolem">φ</span><span class="main">)</span><span class="main"><span class="free">⟩</span></span><span class="main">)</span> <span class="main">(</span>PP <span class="main"><span class="free">⟨</span></span><span class="free">fls</span><span class="main"><span class="free">⟩</span></span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">from</span></span> prv_prv_imp_trans<span class="main">[</span><span class="operator">OF</span> _ _ _ 41 42<span class="main">]</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">prv</span> <span class="main">(</span><span class="free">imp</span> <span class="main">(</span><span class="free">cnj</span> <span class="main">(</span>PP <span class="main"><span class="free">⟨</span></span><span class="skolem">φ</span><span class="main"><span class="free">⟩</span></span><span class="main">)</span> <span class="main">(</span>PP <span class="main"><span class="free">⟨</span></span>neg <span class="skolem">φ</span><span class="main"><span class="free">⟩</span></span><span class="main">)</span><span class="main">)</span> <span class="main">(</span>PP <span class="main"><span class="free">⟨</span></span><span class="free">fls</span><span class="main"><span class="free">⟩</span></span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">from</span></span> prv_prv_imp_trans<span class="main">[</span><span class="operator">OF</span> _ _ _ this *<span class="main"><span class="main">[</span></span><span class="operator">unfolded</span> neg_def<span class="main"><span class="main">]</span></span><span class="main">]</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">prv</span> <span class="main">(</span>neg <span class="main">(</span><span class="free">cnj</span> <span class="main">(</span>PP <span class="main"><span class="free">⟨</span></span><span class="skolem">φ</span><span class="main"><span class="free">⟩</span></span><span class="main">)</span> <span class="main">(</span>PP <span class="main"><span class="free">⟨</span></span>neg <span class="skolem">φ</span><span class="main"><span class="free">⟩</span></span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">unfolding</span></span> neg_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">from</span></span> prv_cnj_neg_encF_N_aux<span class="main">[</span><span class="operator">OF</span> _ _ _ _ this<span class="main">]</span>
  <span class="keyword1"><span class="command">have</span></span> 4<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">prv</span> <span class="main">(</span>neg <span class="main">(</span><span class="free">cnj</span> <span class="main">(</span>PP <span class="main"><span class="free">⟨</span></span><span class="skolem">φ</span><span class="main"><span class="free">⟩</span></span><span class="main">)</span> <span class="main">(</span>PP <span class="main">(</span><span class="free">encF</span> <span class="free">N</span> <span class="main"><span class="free">⟨</span></span><span class="skolem">φ</span><span class="main"><span class="free">⟩</span></span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="comment1">― ‹End modification›</span>

  <span class="keyword1"><span class="command">have</span></span> 5<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">prv</span> <span class="main">(</span>neg <span class="skolem">φ</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">unfolding</span></span> neg_def
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> prv_prv_imp_trans<span class="main"><span class="main">[</span></span><span class="operator">OF</span> _ _ _ 3 4<span class="main"><span class="main">[</span></span><span class="operator">unfolded</span> neg_def<span class="main"><span class="main">]</span></span><span class="main"><span class="main">]</span></span><span class="main">)</span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="free">prv</span> <span class="main">(</span>PP <span class="main"><span class="free">⟨</span></span>neg <span class="skolem">φ</span><span class="main"><span class="free">⟩</span></span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> HBL1_PP<span class="main">[</span><span class="operator">OF</span> _ _ 5<span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="free">prv</span> <span class="skolem">φ</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> prv_imp_mp<span class="main">[</span><span class="operator">OF</span> _ _ 22<span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">with</span></span> 5 assms <span class="keyword3"><span class="command">show</span></span> <span class="quoted">False</span> <span class="keyword1"><span class="command">unfolding</span></span> consistent_def3 <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹Next we perform a formal analysis of some connection between the
above theorems' hypotheses.›</span></span>

<span class="keyword1"><span class="command">definition</span></span> <span class="entity">noContr</span> <span class="main">::</span> <span class="quoted">bool</span> <span class="keyword2"><span class="keyword">where</span></span>
<span class="quoted"><span class="quoted">"<span class="free">noContr</span> <span class="main">≡</span> <span class="main">∀</span> <span class="bound">φ</span> <span class="main">∈</span> <span class="free">fmla</span><span class="main">.</span> <span class="free">Fvars</span> <span class="bound">φ</span> <span class="main">=</span> <span class="main">{}</span> <span class="main">⟶</span> <span class="free">prv</span> <span class="main">(</span>neg <span class="main">(</span><span class="free">cnj</span> <span class="main">(</span>PP <span class="main"><span class="free">⟨</span></span><span class="bound">φ</span><span class="main"><span class="free">⟩</span></span><span class="main">)</span> <span class="main">(</span>PP <span class="main"><span class="free">⟨</span></span>neg <span class="bound">φ</span><span class="main"><span class="free">⟩</span></span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span>

<span class="keyword1"><span class="command">lemma</span></span> jcons_noContr<span class="main">:</span>
<span class="keyword2"><span class="keyword">assumes</span></span> j<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">prv</span> jcons"</span></span>
<span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"noContr"</span></span>
<span class="keyword1"><span class="command">unfolding</span></span> noContr_def <span class="keyword1"><span class="command">proof</span></span> <span class="operator">safe</span>
  <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">φ</span> <span class="keyword3"><span class="command">assume</span></span> φ<span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">φ</span> <span class="main">∈</span> <span class="free">fmla</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="free">Fvars</span> <span class="skolem">φ</span> <span class="main">=</span> <span class="main">{}</span>"</span></span>
  <span class="keyword1"><span class="command">have</span></span> <span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">subst</span> <span class="main">(</span>PP <span class="main">(</span><span class="free">encF</span> <span class="free">N</span> <span class="main">(</span><span class="free">Var</span> xx<span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main"><span class="free">⟨</span></span><span class="skolem">φ</span><span class="main"><span class="free">⟩</span></span> xx <span class="main">=</span>
               PP <span class="main">(</span><span class="free">encF</span> <span class="free">N</span> <span class="main"><span class="free">⟨</span></span><span class="skolem">φ</span><span class="main"><span class="free">⟩</span></span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">unfolding</span></span> PP_def <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> subst_compose_same<span class="main">)</span>
  <span class="keyword1"><span class="command">note</span></span> j <span class="main">=</span> allE_id<span class="main">[</span><span class="operator">OF</span> _ _ j<span class="main"><span class="main">[</span></span><span class="operator">unfolded</span> jcons_def<span class="main"><span class="main">]</span></span><span class="main">,</span> <span class="operator">simplified</span><span class="main">]</span>
  <span class="keyword1"><span class="command">have</span></span> 0<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">prv</span> <span class="main">(</span>neg <span class="main">(</span><span class="free">cnj</span> <span class="main">(</span>PP <span class="main"><span class="free">⟨</span></span><span class="skolem">φ</span><span class="main"><span class="free">⟩</span></span><span class="main">)</span>
                         <span class="main">(</span>PP <span class="main">(</span><span class="free">encF</span> <span class="free">N</span> <span class="main"><span class="free">⟨</span></span><span class="skolem">φ</span><span class="main"><span class="free">⟩</span></span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span>
  <span class="main">(</span><span class="keyword2"><span class="keyword">is</span></span> <span class="quoted"><span class="quoted">"<span class="free">prv</span> <span class="main">(</span>neg <span class="main">(</span><span class="free">cnj</span> <span class="main">(</span>PP <span class="main"><span class="free">⟨</span></span><span class="skolem">φ</span><span class="main"><span class="free">⟩</span></span><span class="main">)</span> <span class="var">?j</span><span class="main">)</span><span class="main">)</span>"</span></span><span class="main">)</span>
    <span class="keyword1"><span class="command">using</span></span> prv_subst<span class="main">[</span><span class="operator">OF</span> _ _ _ j<span class="main">,</span> <span class="operator">of</span> <span class="quoted">xx</span> <span class="quoted"><span class="quoted">"<span class="main"><span class="free">⟨</span></span><span class="skolem">φ</span><span class="main"><span class="free">⟩</span></span>"</span></span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">have</span></span> 1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">prv</span> <span class="main">(</span><span class="free">imp</span> <span class="main">(</span>PP <span class="main"><span class="free">⟨</span></span>neg <span class="skolem">φ</span><span class="main"><span class="free">⟩</span></span><span class="main">)</span> <span class="var">?j</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> prv_eql_neg_encF_N<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="skolem">φ</span></span><span class="main">,</span> <span class="operator">simplified</span><span class="main">]</span>
  <span class="keyword1"><span class="command">using</span></span> prv_imp_neg_encF_N_aux <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">have</span></span> 2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">prv</span> <span class="main">(</span><span class="free">imp</span> <span class="main">(</span><span class="free">cnj</span> <span class="main">(</span>PP <span class="main"><span class="free">⟨</span></span><span class="skolem">φ</span><span class="main"><span class="free">⟩</span></span><span class="main">)</span> <span class="main">(</span>PP <span class="main"><span class="free">⟨</span></span>neg <span class="skolem">φ</span><span class="main"><span class="free">⟩</span></span><span class="main">)</span><span class="main">)</span>
                    <span class="main">(</span><span class="free">cnj</span> <span class="main">(</span>PP <span class="main"><span class="free">⟨</span></span><span class="skolem">φ</span><span class="main"><span class="free">⟩</span></span><span class="main">)</span> <span class="var">?j</span><span class="main">)</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> 0 1 <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span>  prv_cnj_mono prv_imp_refl<span class="main">)</span>

  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">prv</span> <span class="main">(</span><span class="free">imp</span> <span class="main">(</span><span class="free">cnj</span> <span class="main">(</span>PP <span class="main"><span class="free">⟨</span></span><span class="skolem">φ</span><span class="main"><span class="free">⟩</span></span><span class="main">)</span> <span class="main">(</span>PP <span class="main"><span class="free">⟨</span></span>neg <span class="skolem">φ</span><span class="main"><span class="free">⟩</span></span><span class="main">)</span><span class="main">)</span>
                 <span class="main">(</span><span class="free">cnj</span> <span class="main">(</span>PP <span class="main"><span class="free">⟨</span></span><span class="skolem">φ</span><span class="main"><span class="free">⟩</span></span><span class="main">)</span> <span class="var">?j</span><span class="main">)</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> 2 prv_cnj_mono prv_imp_refl<span class="main">)</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"<span class="free">prv</span> <span class="main">(</span>neg <span class="main">(</span><span class="free">cnj</span> <span class="main">(</span>PP <span class="main"><span class="free">⟨</span></span><span class="skolem">φ</span><span class="main"><span class="free">⟩</span></span><span class="main">)</span> <span class="main">(</span>PP <span class="main"><span class="free">⟨</span></span>neg <span class="skolem">φ</span><span class="main"><span class="free">⟩</span></span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> 0
    <span class="keyword1"><span class="command">unfolding</span></span> neg_def
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">elim</span> prv_prv_imp_trans<span class="main"><span class="main">[</span></span><span class="operator">rotated</span> 3<span class="main"><span class="main">]</span></span><span class="main">)</span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹<span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">term</span></span> <span class="quoted"><span class="quoted">noContr</span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span> is still stronger than the standard notion of proving own consistency:›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> noContr_implies_neg_PP_fls<span class="main">:</span>
 <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"noContr"</span></span>
 <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">prv</span> <span class="main">(</span>neg <span class="main">(</span>PP <span class="main"><span class="free">⟨</span></span><span class="free">fls</span><span class="main"><span class="free">⟩</span></span><span class="main">)</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">prv</span> <span class="main">(</span>neg <span class="main">(</span><span class="free">cnj</span> <span class="main">(</span>PP <span class="main"><span class="free">⟨</span></span><span class="free">fls</span><span class="main"><span class="free">⟩</span></span><span class="main">)</span> <span class="main">(</span>PP <span class="main"><span class="free">⟨</span></span>neg <span class="free">fls</span><span class="main"><span class="free">⟩</span></span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">unfolding</span></span> noContr_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
  <span class="keyword1"><span class="command">using</span></span> Fvars_tru enc in_num tru_def PP PP_def fls imp HBL1 neg_def
       prv_cnj_imp prv_fls prv_imp_com prv_imp_mp
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> Encode.enc HBL1_axioms HBL1_def<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">corollary</span></span> jcons_implies_neg_PP_fls<span class="main">:</span>
<span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">prv</span> jcons"</span></span>
<span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">prv</span> <span class="main">(</span>neg <span class="main">(</span>PP <span class="main"><span class="free">⟨</span></span><span class="free">fls</span><span class="main"><span class="free">⟩</span></span><span class="main">)</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> assms noContr_implies_neg_PP_fls jcons_noContr<span class="main">)</span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹However, unlike <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">term</span></span> <span class="quoted"><span class="quoted">jcons</span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span>, which seems to be quite a bit stronger,
<span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">term</span></span> <span class="quoted"><span class="quoted">noContr</span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span> is equivalent to the standard notion under a slightly
stronger assumption than our WWHBL2, namely, a binary version of that:›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> neg_PP_fls_implies_noContr<span class="main">:</span>
 <span class="keyword2"><span class="keyword">assumes</span></span> WWHBL22<span class="main">:</span>
<span class="quoted"><span class="quoted">"<span class="main">⋀</span><span class="bound">φ</span> <span class="bound">χ</span> <span class="bound">ψ</span><span class="main">.</span> <span class="bound">φ</span> <span class="main">∈</span> <span class="free">fmla</span> <span class="main">⟹</span> <span class="bound">χ</span> <span class="main">∈</span> <span class="free">fmla</span> <span class="main">⟹</span> <span class="bound">ψ</span> <span class="main">∈</span> <span class="free">fmla</span> <span class="main">⟹</span>
   <span class="free">Fvars</span> <span class="bound">φ</span> <span class="main">=</span> <span class="main">{}</span> <span class="main">⟹</span> <span class="free">Fvars</span> <span class="bound">χ</span> <span class="main">=</span> <span class="main">{}</span> <span class="main">⟹</span> <span class="free">Fvars</span> <span class="bound">ψ</span> <span class="main">=</span> <span class="main">{}</span> <span class="main">⟹</span>
   <span class="free">prv</span> <span class="main">(</span><span class="free">imp</span> <span class="bound">φ</span> <span class="main">(</span><span class="free">imp</span> <span class="bound">χ</span> <span class="bound">ψ</span><span class="main">)</span><span class="main">)</span> <span class="main">⟹</span> <span class="free">prv</span> <span class="main">(</span><span class="free">imp</span> <span class="main">(</span>PP <span class="main"><span class="free">⟨</span></span><span class="bound">φ</span><span class="main"><span class="free">⟩</span></span><span class="main">)</span> <span class="main">(</span><span class="free">imp</span> <span class="main">(</span>PP <span class="main"><span class="free">⟨</span></span><span class="bound">χ</span><span class="main"><span class="free">⟩</span></span><span class="main">)</span> <span class="main">(</span>PP <span class="main"><span class="free">⟨</span></span><span class="bound">ψ</span><span class="main"><span class="free">⟩</span></span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span>
 <span class="keyword2"><span class="keyword">assumes</span></span> p<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">prv</span> <span class="main">(</span>neg <span class="main">(</span>PP <span class="main"><span class="free">⟨</span></span><span class="free">fls</span><span class="main"><span class="free">⟩</span></span><span class="main">)</span><span class="main">)</span>"</span></span>
 <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"noContr"</span></span>
<span class="keyword1"><span class="command">unfolding</span></span> noContr_def <span class="keyword1"><span class="command">proof</span></span> <span class="operator">safe</span>
  <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">φ</span> <span class="keyword3"><span class="command">assume</span></span> φ<span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">φ</span> <span class="main">∈</span> <span class="free">fmla</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="free">Fvars</span> <span class="skolem">φ</span> <span class="main">=</span> <span class="main">{}</span>"</span></span>
  <span class="keyword1"><span class="command">have</span></span> 0<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">prv</span> <span class="main">(</span><span class="free">imp</span> <span class="skolem">φ</span> <span class="main">(</span><span class="free">imp</span> <span class="main">(</span>neg <span class="skolem">φ</span><span class="main">)</span> <span class="free">fls</span><span class="main">)</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> prv_imp_neg_fls<span class="main">)</span>
  <span class="keyword1"><span class="command">have</span></span> 1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">prv</span> <span class="main">(</span><span class="free">imp</span> <span class="main">(</span>PP <span class="main"><span class="free">⟨</span></span><span class="skolem">φ</span><span class="main"><span class="free">⟩</span></span><span class="main">)</span> <span class="main">(</span><span class="free">imp</span> <span class="main">(</span>PP <span class="main"><span class="free">⟨</span></span>neg <span class="skolem">φ</span><span class="main"><span class="free">⟩</span></span><span class="main">)</span> <span class="main">(</span>PP <span class="main"><span class="free">⟨</span></span><span class="free">fls</span><span class="main"><span class="free">⟩</span></span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> WWHBL22<span class="main">[</span><span class="operator">OF</span> _ _ _ _ _ _ 0<span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="free">prv</span> <span class="main">(</span>neg <span class="main">(</span><span class="free">cnj</span> <span class="main">(</span>PP <span class="main"><span class="free">⟨</span></span><span class="skolem">φ</span><span class="main"><span class="free">⟩</span></span><span class="main">)</span> <span class="main">(</span>PP <span class="main"><span class="free">⟨</span></span>neg <span class="skolem">φ</span><span class="main"><span class="free">⟩</span></span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> 1 p
    <span class="keyword1"><span class="command">unfolding</span></span> neg_def
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">elim</span> prv_cnj_imp_monoR2<span class="main"><span class="main">[</span></span><span class="operator">rotated</span> 3<span class="main"><span class="main">,</span></span> <span class="operator">OF</span> prv_prv_imp_trans<span class="main"><span class="main">[</span></span><span class="operator">rotated</span> 3<span class="main"><span class="main">]</span></span><span class="main"><span class="main">]</span></span><span class="main">)</span>
      <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">intro</span><span class="main"><span class="main">!</span></span><span class="main"><span class="main">:</span></span> prv_imp_monoL<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword2"><span class="keyword">end</span></span> <span class="comment1">― ‹context <span class="antiquoted"><span class="antiquote">@{</span><span class="operator">locale</span> Jeroslow_Godel_Second<span class="antiquote">}</span></span>›</span>

<span class="comment1">(*&lt;*)</span>
<span class="keyword2"><span class="keyword">end</span></span>
<span class="comment1">(*&gt;*)</span>
</pre>
</div><div id="Loeb_Formula">
<div class="head">
<h1>Theory Loeb_Formula</h1>
</div>
<pre class="source"><span class="keyword1"><span class="command">chapter</span></span> <span class="quoted"><span class="plain_text">‹Löb  Formulas›</span></span>

<span class="comment1">(*&lt;*)</span>
<span class="keyword1"><span class="command">theory</span></span> Loeb_Formula <span class="keyword2"><span class="keyword">imports</span></span> <a href="Diagonalization.html">Diagonalization</a> <a href="Derivability_Conditions.html">Derivability_Conditions</a>
<span class="keyword2"><span class="keyword">begin</span></span>
<span class="comment1">(*&gt;*)</span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹The Löb formula, parameterized by a sentence <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">term</span></span> <span class="quoted"><span class="free"><span class="quoted"><span class="free">φ</span></span></span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span>, is defined by diagonalizing <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">term</span></span> <span class="quoted"><span class="quoted">"<span class="free"><span class="free">imp</span></span> <span class="free"><span class="free">P</span></span> <span class="free"><span class="free">φ</span></span>"</span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span>.›</span></span>


<span class="keyword1"><span class="command">locale</span></span> Loeb_Form <span class="main">=</span>
Deduct2
  <span class="quoted"><span class="free">var</span></span> <span class="quoted"><span class="free">trm</span></span> <span class="quoted"><span class="free">fmla</span></span> <span class="quoted"><span class="free">Var</span></span> <span class="quoted"><span class="free">FvarsT</span></span> <span class="quoted"><span class="free">substT</span></span> <span class="quoted"><span class="free">Fvars</span></span> <span class="quoted"><span class="free">subst</span></span>
  <span class="quoted"><span class="free">num</span></span>
  <span class="quoted"><span class="free">eql</span></span> <span class="quoted"><span class="free">cnj</span></span> <span class="quoted"><span class="free">imp</span></span> <span class="quoted"><span class="free">all</span></span> <span class="quoted"><span class="free">exi</span></span>
  <span class="quoted"><span class="free">prv</span></span> <span class="quoted"><span class="free">bprv</span></span>
<span class="main">+</span>
Repr_SelfSubst
  <span class="quoted"><span class="free">var</span></span> <span class="quoted"><span class="free">trm</span></span> <span class="quoted"><span class="free">fmla</span></span> <span class="quoted"><span class="free">Var</span></span> <span class="quoted"><span class="free">FvarsT</span></span> <span class="quoted"><span class="free">substT</span></span> <span class="quoted"><span class="free">Fvars</span></span> <span class="quoted"><span class="free">subst</span></span>
  <span class="quoted"><span class="free">num</span></span>
  <span class="quoted"><span class="free">eql</span></span> <span class="quoted"><span class="free">cnj</span></span> <span class="quoted"><span class="free">imp</span></span> <span class="quoted"><span class="free">all</span></span> <span class="quoted"><span class="free">exi</span></span>
  <span class="quoted"><span class="free">prv</span></span> <span class="quoted"><span class="free">bprv</span></span>
  <span class="quoted"><span class="free">enc</span></span>
  <span class="quoted"><span class="free">S</span></span>
<span class="main">+</span>
HBL1
  <span class="quoted"><span class="free">var</span></span> <span class="quoted"><span class="free">trm</span></span> <span class="quoted"><span class="free">fmla</span></span> <span class="quoted"><span class="free">Var</span></span> <span class="quoted"><span class="free">FvarsT</span></span> <span class="quoted"><span class="free">substT</span></span> <span class="quoted"><span class="free">Fvars</span></span> <span class="quoted"><span class="free">subst</span></span>
  <span class="quoted"><span class="free">num</span></span>
  <span class="quoted"><span class="free">eql</span></span> <span class="quoted"><span class="free">cnj</span></span> <span class="quoted"><span class="free">imp</span></span> <span class="quoted"><span class="free">all</span></span> <span class="quoted"><span class="free">exi</span></span>
  <span class="quoted"><span class="free">prv</span></span> <span class="quoted"><span class="free">bprv</span></span>
  <span class="quoted"><span class="free">enc</span></span>
  <span class="quoted"><span class="free">P</span></span>
<span class="keyword2"><span class="keyword">for</span></span>
<span class="free">var</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'var</span> set"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="free">trm</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'trm</span> set"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="free">fmla</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'fmla</span> set"</span></span>
<span class="keyword2"><span class="keyword">and</span></span> <span class="free">Var</span> <span class="free">num</span> <span class="free">FvarsT</span> <span class="free">substT</span> <span class="free">Fvars</span> <span class="free">subst</span>
<span class="keyword2"><span class="keyword">and</span></span> <span class="free">eql</span> <span class="free">cnj</span> <span class="free">imp</span> <span class="free">all</span> <span class="free">exi</span>
<span class="keyword2"><span class="keyword">and</span></span> <span class="free">prv</span> <span class="free">bprv</span>
<span class="keyword2"><span class="keyword">and</span></span> <span class="free">enc</span> <span class="main">(</span><span class="quoted">"<span class="keyword1">⟨</span>_<span class="keyword1">⟩</span>"</span><span class="main">)</span>
<span class="keyword2"><span class="keyword">and</span></span> <span class="free">S</span>
<span class="keyword2"><span class="keyword">and</span></span> <span class="free">P</span>
<span class="keyword2"><span class="keyword">begin</span></span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹The Löb formula associated to a formula <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">term</span></span> <span class="quoted"><span class="free"><span class="quoted"><span class="free">φ</span></span></span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span>:›</span></span>
<span class="keyword1"><span class="command">definition</span></span> <span class="entity">φL</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'fmla</span> <span class="main">⇒</span> <span class="tfree">'fmla</span>"</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="free">φL</span> <span class="free"><span class="bound"><span class="entity">φ</span></span></span> <span class="main">≡</span> diag <span class="main">(</span><span class="free">imp</span> <span class="free">P</span> <span class="free"><span class="bound"><span class="entity">φ</span></span></span><span class="main">)</span>"</span></span>

<span class="keyword1"><span class="command">lemma</span></span> φL<span class="main">[</span><span class="operator">simp</span><span class="main">,</span><span class="operator">intro</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">⋀</span><span class="bound">φ</span><span class="main">.</span> <span class="bound">φ</span> <span class="main">∈</span> <span class="free">fmla</span> <span class="main">⟹</span> <span class="free">Fvars</span> <span class="bound">φ</span> <span class="main">=</span> <span class="main">{}</span> <span class="main">⟹</span> φL <span class="bound">φ</span> <span class="main">∈</span> <span class="free">fmla</span>"</span></span>
<span class="keyword2"><span class="keyword">and</span></span>
Fvars_φL<span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">φ</span> <span class="main">∈</span> <span class="free">fmla</span> <span class="main">⟹</span> <span class="free">Fvars</span> <span class="free">φ</span> <span class="main">=</span> <span class="main">{}</span> <span class="main">⟹</span> <span class="free">Fvars</span> <span class="main">(</span>φL <span class="free">φ</span><span class="main">)</span> <span class="main">=</span> <span class="main">{}</span>"</span></span>
  <span class="keyword1"><span class="command">unfolding</span></span> φL_def PP_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">lemma</span></span> bprv_φL_eqv<span class="main">:</span>
<span class="quoted"><span class="quoted">"<span class="free">φ</span> <span class="main">∈</span> <span class="free">fmla</span> <span class="main">⟹</span> <span class="free">Fvars</span> <span class="free">φ</span>  <span class="main">=</span> <span class="main">{}</span> <span class="main">⟹</span> <span class="free">bprv</span> <span class="main">(</span>eqv <span class="main">(</span>φL <span class="free">φ</span><span class="main">)</span> <span class="main">(</span><span class="free">imp</span> <span class="main">(</span>PP <span class="main"><span class="free">⟨</span></span>φL <span class="free">φ</span><span class="main"><span class="free">⟩</span></span><span class="main">)</span> <span class="free">φ</span><span class="main">)</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">unfolding</span></span> φL_def PP_def <span class="keyword1"><span class="command">using</span></span> bprv_diag_eqv<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="quoted">"<span class="free">imp</span> <span class="free">P</span> <span class="free">φ</span>"</span></span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">lemma</span></span> prv_φL_eqv<span class="main">:</span>
<span class="quoted"><span class="quoted">"<span class="free">φ</span> <span class="main">∈</span> <span class="free">fmla</span> <span class="main">⟹</span> <span class="free">Fvars</span> <span class="free">φ</span>  <span class="main">=</span> <span class="main">{}</span> <span class="main">⟹</span> <span class="free">prv</span> <span class="main">(</span>eqv <span class="main">(</span>φL <span class="free">φ</span><span class="main">)</span> <span class="main">(</span><span class="free">imp</span> <span class="main">(</span>PP <span class="main"><span class="free">⟨</span></span>φL <span class="free">φ</span><span class="main"><span class="free">⟩</span></span><span class="main">)</span> <span class="free">φ</span><span class="main">)</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> bprv_prv<span class="main">[</span><span class="operator">OF</span> _ _ bprv_φL_eqv<span class="main">,</span> <span class="operator">simplified</span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword2"><span class="keyword">end</span></span> <span class="comment1">― ‹context <span class="antiquoted"><span class="antiquote">@{</span><span class="operator">locale</span> Loeb_Form<span class="antiquote">}</span></span>›</span>

<span class="comment1">(*&lt;*)</span>
<span class="keyword2"><span class="keyword">end</span></span>
<span class="comment1">(*&gt;*)</span>
</pre>
</div><div id="Loeb">
<div class="head">
<h1>Theory Loeb</h1>
</div>
<pre class="source"><span class="keyword1"><span class="command">chapter</span></span> <span class="quoted"><span class="plain_text">‹Löb's Theorem›</span></span>

<span class="comment1">(*&lt;*)</span>
<span class="keyword1"><span class="command">theory</span></span> Loeb <span class="keyword2"><span class="keyword">imports</span></span> <a href="Loeb_Formula.html">Loeb_Formula</a> <a href="Derivability_Conditions.html">Derivability_Conditions</a>
<span class="keyword2"><span class="keyword">begin</span></span>
<span class="comment1">(*&gt;*)</span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹We have set up the formalization of Gödel's first (easy half) and Gödel's second
so that the following generalizations, leading to Löb's theorem, are trivial
modifications of these, replacing negation with "implies <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">term</span></span> <span class="quoted"><span class="free"><span class="quoted"><span class="free">φ</span></span></span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span>" in all proofs.›</span></span>

<span class="keyword1"><span class="command">locale</span></span> Loeb_Assumptions <span class="main">=</span>
HBL1_2_3
  <span class="quoted"><span class="free">var</span></span> <span class="quoted"><span class="free">trm</span></span> <span class="quoted"><span class="free">fmla</span></span> <span class="quoted"><span class="free">Var</span></span> <span class="quoted"><span class="free">FvarsT</span></span> <span class="quoted"><span class="free">substT</span></span> <span class="quoted"><span class="free">Fvars</span></span> <span class="quoted"><span class="free">subst</span></span>
  <span class="quoted"><span class="free">num</span></span>
  <span class="quoted"><span class="free">eql</span></span> <span class="quoted"><span class="free">cnj</span></span> <span class="quoted"><span class="free">imp</span></span> <span class="quoted"><span class="free">all</span></span> <span class="quoted"><span class="free">exi</span></span>
  <span class="quoted"><span class="free">prv</span></span> <span class="quoted"><span class="free">bprv</span></span>
  <span class="quoted"><span class="free">enc</span></span>
  <span class="quoted"><span class="free">P</span></span>
<span class="main">+</span>
Loeb_Form
  <span class="quoted"><span class="free">var</span></span> <span class="quoted"><span class="free">trm</span></span> <span class="quoted"><span class="free">fmla</span></span> <span class="quoted"><span class="free">Var</span></span> <span class="quoted"><span class="free">num</span></span> <span class="quoted"><span class="free">FvarsT</span></span> <span class="quoted"><span class="free">substT</span></span> <span class="quoted"><span class="free">Fvars</span></span> <span class="quoted"><span class="free">subst</span></span>
  <span class="quoted"><span class="free">eql</span></span> <span class="quoted"><span class="free">cnj</span></span> <span class="quoted"><span class="free">imp</span></span> <span class="quoted"><span class="free">all</span></span> <span class="quoted"><span class="free">exi</span></span>
  <span class="quoted"><span class="free">prv</span></span> <span class="quoted"><span class="free">bprv</span></span>
  <span class="quoted"><span class="free">enc</span></span>
  <span class="quoted"><span class="free">S</span></span>
  <span class="quoted"><span class="free">P</span></span>
<span class="keyword2"><span class="keyword">for</span></span>
<span class="free">var</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'var</span> set"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="free">trm</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'trm</span> set"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="free">fmla</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'fmla</span> set"</span></span>
<span class="keyword2"><span class="keyword">and</span></span> <span class="free">Var</span> <span class="free">num</span> <span class="free">FvarsT</span> <span class="free">substT</span> <span class="free">Fvars</span> <span class="free">subst</span>
<span class="keyword2"><span class="keyword">and</span></span> <span class="free">eql</span> <span class="free">cnj</span> <span class="free">imp</span> <span class="free">all</span> <span class="free">exi</span>
<span class="keyword2"><span class="keyword">and</span></span> <span class="free">prv</span> <span class="free">bprv</span>
<span class="keyword2"><span class="keyword">and</span></span> <span class="free">enc</span> <span class="main">(</span><span class="quoted">"<span class="keyword1">⟨</span>_<span class="keyword1">⟩</span>"</span><span class="main">)</span>
<span class="keyword2"><span class="keyword">and</span></span> <span class="free">S</span>
<span class="keyword2"><span class="keyword">and</span></span> <span class="free">P</span>
<span class="keyword2"><span class="keyword">begin</span></span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹Generalization of $\mathit{goedel\_first\_theEasyHalf\_pos}$, replacing <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">term</span></span> <span class="quoted"><span class="free"><span class="quoted"><span class="free">fls</span></span></span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span> with a sentence <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">term</span></span> <span class="quoted"><span class="free"><span class="quoted"><span class="free">φ</span></span></span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span>:›</span></span>
<span class="keyword1"><span class="command">lemma</span></span> loeb_aux_prv<span class="main">:</span>
<span class="keyword2"><span class="keyword">assumes</span></span> φ<span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">φ</span> <span class="main">∈</span> <span class="free">fmla</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="free">Fvars</span> <span class="free">φ</span> <span class="main">=</span> <span class="main">{}</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> p<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">prv</span> <span class="main">(</span>φL <span class="free">φ</span><span class="main">)</span>"</span></span>
<span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">prv</span> <span class="free">φ</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">prv</span> <span class="main">(</span><span class="free">imp</span> <span class="main">(</span>PP <span class="main"><span class="free">⟨</span></span>φL <span class="free">φ</span><span class="main"><span class="free">⟩</span></span><span class="main">)</span> <span class="free">φ</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms prv_eqv_prv<span class="main">[</span><span class="operator">OF</span> _ _ p prv_φL_eqv<span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">bprv</span> <span class="main">(</span>PP <span class="main"><span class="free">⟨</span></span>φL <span class="free">φ</span><span class="main"><span class="free">⟩</span></span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> HBL1<span class="main">[</span><span class="operator">OF</span> φL<span class="main"><span class="main">[</span></span><span class="operator">OF</span> φ<span class="main"><span class="main">]</span></span> _ p<span class="main">]</span> <span class="keyword1"><span class="command">unfolding</span></span> PP_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">from</span></span> bprv_prv<span class="main">[</span><span class="operator">OF</span> _ _ this<span class="main">,</span> <span class="operator">simplified</span><span class="main">]</span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">prv</span> <span class="main">(</span>PP <span class="main"><span class="free">⟨</span></span>φL <span class="free">φ</span><span class="main"><span class="free">⟩</span></span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">.</span></span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> PP φL <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">meson</span> assms enc in_num prv_imp_mp<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">lemma</span></span> loeb_aux_bprv<span class="main">:</span>
<span class="keyword2"><span class="keyword">assumes</span></span> φ<span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">φ</span> <span class="main">∈</span> <span class="free">fmla</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="free">Fvars</span> <span class="free">φ</span> <span class="main">=</span> <span class="main">{}</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> p<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">bprv</span> <span class="main">(</span>φL <span class="free">φ</span><span class="main">)</span>"</span></span>
<span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">bprv</span> <span class="free">φ</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
  <span class="keyword1"><span class="command">note</span></span> pp <span class="main">=</span> bprv_prv<span class="main">[</span><span class="operator">OF</span> _ _ p<span class="main">,</span> <span class="operator">simplified</span><span class="main">]</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">bprv</span> <span class="main">(</span><span class="free">imp</span> <span class="main">(</span>PP <span class="main"><span class="free">⟨</span></span>φL <span class="free">φ</span><span class="main"><span class="free">⟩</span></span><span class="main">)</span> <span class="free">φ</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms B.prv_eqv_prv<span class="main">[</span><span class="operator">OF</span> _ _ p bprv_φL_eqv<span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">bprv</span> <span class="main">(</span>PP <span class="main"><span class="free">⟨</span></span>φL <span class="free">φ</span><span class="main"><span class="free">⟩</span></span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> HBL1<span class="main">[</span><span class="operator">OF</span> φL<span class="main"><span class="main">[</span></span><span class="operator">OF</span> φ<span class="main"><span class="main">]</span></span> _ pp<span class="main">]</span> <span class="keyword1"><span class="command">unfolding</span></span> PP_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> PP φL <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">meson</span> assms enc in_num B.prv_imp_mp<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹Generalization of $\mathit{P\_G}$, the main lemma used for Gödel's second:›</span></span>
<span class="keyword1"><span class="command">lemma</span></span> P_L<span class="main">:</span>
<span class="keyword2"><span class="keyword">assumes</span></span> φ<span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">φ</span> <span class="main">∈</span> <span class="free">fmla</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="free">Fvars</span> <span class="free">φ</span> <span class="main">=</span> <span class="main">{}</span>"</span></span>
<span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">bprv</span> <span class="main">(</span><span class="free">imp</span> <span class="main">(</span>PP <span class="main"><span class="free">⟨</span></span>φL <span class="free">φ</span><span class="main"><span class="free">⟩</span></span><span class="main">)</span> <span class="main">(</span>PP <span class="main"><span class="free">⟨</span></span><span class="free">φ</span><span class="main"><span class="free">⟩</span></span><span class="main">)</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> 0<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">prv</span> <span class="main">(</span><span class="free">imp</span> <span class="main">(</span>φL <span class="free">φ</span><span class="main">)</span> <span class="main">(</span><span class="free">imp</span> <span class="main">(</span>PP <span class="main"><span class="free">⟨</span></span>φL <span class="free">φ</span><span class="main"><span class="free">⟩</span></span><span class="main">)</span> <span class="free">φ</span><span class="main">)</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> prv_φL_eqv <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">intro</span> prv_imp_eqvEL<span class="main">)</span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">have</span></span> 1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">bprv</span> <span class="main">(</span>PP <span class="main"><span class="free">⟨</span></span><span class="free">imp</span> <span class="main">(</span>φL <span class="free">φ</span><span class="main">)</span> <span class="main">(</span><span class="free">imp</span> <span class="main">(</span>PP <span class="main"><span class="free">⟨</span></span>φL <span class="free">φ</span><span class="main"><span class="free">⟩</span></span><span class="main">)</span> <span class="free">φ</span><span class="main">)</span><span class="main"><span class="free">⟩</span></span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> HBL1_PP<span class="main">[</span><span class="operator">OF</span> _ _ 0<span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">have</span></span> 2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">bprv</span> <span class="main">(</span><span class="free">imp</span> <span class="main">(</span>PP <span class="main"><span class="free">⟨</span></span>φL <span class="free">φ</span><span class="main"><span class="free">⟩</span></span><span class="main">)</span> <span class="main">(</span>PP <span class="main"><span class="free">⟨</span></span><span class="free">imp</span> <span class="main">(</span>PP <span class="main"><span class="free">⟨</span></span>φL <span class="free">φ</span><span class="main"><span class="free">⟩</span></span><span class="main">)</span> <span class="free">φ</span><span class="main"><span class="free">⟩</span></span><span class="main">)</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> HBL2_imp2<span class="main">[</span><span class="operator">OF</span> _ _ _ _ 1<span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">have</span></span> 3<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">bprv</span> <span class="main">(</span><span class="free">imp</span> <span class="main">(</span>PP <span class="main"><span class="free">⟨</span></span>φL <span class="free">φ</span><span class="main"><span class="free">⟩</span></span><span class="main">)</span> <span class="main">(</span>PP <span class="main"><span class="free">⟨</span></span>PP <span class="main"><span class="free">⟨</span></span>φL <span class="free">φ</span><span class="main"><span class="free">⟩</span></span><span class="main"><span class="free">⟩</span></span><span class="main">)</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> HBL3<span class="main">[</span><span class="operator">OF</span> φL<span class="main"><span class="main">[</span></span><span class="operator">OF</span> φ<span class="main"><span class="main">]</span></span> _<span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">have</span></span> 23<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">bprv</span> <span class="main">(</span><span class="free">imp</span> <span class="main">(</span>PP <span class="main"><span class="free">⟨</span></span>φL <span class="free">φ</span><span class="main"><span class="free">⟩</span></span><span class="main">)</span>
                      <span class="main">(</span><span class="free">cnj</span> <span class="main">(</span>PP <span class="main"><span class="free">⟨</span></span>PP <span class="main"><span class="free">⟨</span></span>φL <span class="free">φ</span><span class="main"><span class="free">⟩</span></span><span class="main"><span class="free">⟩</span></span><span class="main">)</span>
                           <span class="main">(</span>PP <span class="main"><span class="free">⟨</span></span><span class="free">imp</span> <span class="main">(</span>PP <span class="main"><span class="free">⟨</span></span>φL <span class="free">φ</span><span class="main"><span class="free">⟩</span></span><span class="main">)</span> <span class="free">φ</span><span class="main"><span class="free">⟩</span></span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> B.prv_imp_cnj<span class="main">[</span><span class="operator">OF</span> _ _ _ 3 2<span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">have</span></span> 4<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">bprv</span> <span class="main">(</span><span class="free">imp</span> <span class="main">(</span><span class="free">cnj</span> <span class="main">(</span>PP <span class="main"><span class="free">⟨</span></span>PP <span class="main"><span class="free">⟨</span></span>φL <span class="free">φ</span><span class="main"><span class="free">⟩</span></span><span class="main"><span class="free">⟩</span></span><span class="main">)</span>
                          <span class="main">(</span>PP <span class="main"><span class="free">⟨</span></span><span class="free">imp</span> <span class="main">(</span>PP <span class="main"><span class="free">⟨</span></span>φL <span class="free">φ</span><span class="main"><span class="free">⟩</span></span><span class="main">)</span> <span class="free">φ</span><span class="main"><span class="free">⟩</span></span><span class="main">)</span><span class="main">)</span>
                    <span class="main">(</span>PP <span class="main"><span class="free">⟨</span></span><span class="free">φ</span><span class="main"><span class="free">⟩</span></span><span class="main">)</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> HBL2<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="quoted">"PP <span class="main"><span class="free">⟨</span></span>φL <span class="free">φ</span><span class="main"><span class="free">⟩</span></span>"</span></span> <span class="quoted"><span class="free">φ</span></span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> B.prv_prv_imp_trans<span class="main">[</span><span class="operator">OF</span> _ _ _ 23 4<span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹Löb's theorem generalizes the positive formulation Gödel's Second
($\mathit{goedel\_second}$). In our two-provability-relation framework, we get two variants of Löb's theorem.
A stronger variant, assuming <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">term</span></span> <span class="quoted"><span class="free"><span class="quoted"><span class="free">prv</span></span></span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span> and proving <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">term</span></span> <span class="quoted"><span class="free"><span class="quoted"><span class="free">bprv</span></span></span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span>, seems impossible.›</span></span>

<span class="keyword1"><span class="command">theorem</span></span> loeb_bprv<span class="main">:</span>
<span class="keyword2"><span class="keyword">assumes</span></span> φ<span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">φ</span> <span class="main">∈</span> <span class="free">fmla</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="free">Fvars</span> <span class="free">φ</span> <span class="main">=</span> <span class="main">{}</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> p<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">bprv</span> <span class="main">(</span><span class="free">imp</span> <span class="main">(</span>PP <span class="main"><span class="free">⟨</span></span><span class="free">φ</span><span class="main"><span class="free">⟩</span></span><span class="main">)</span> <span class="free">φ</span><span class="main">)</span>"</span></span>
<span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">bprv</span> <span class="free">φ</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">bprv</span> <span class="main">(</span><span class="free">imp</span> <span class="main">(</span>PP <span class="main"><span class="free">⟨</span></span>φL <span class="free">φ</span><span class="main"><span class="free">⟩</span></span><span class="main">)</span> <span class="free">φ</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> B.prv_prv_imp_trans<span class="main"><span class="main">[</span></span><span class="operator">OF</span> _ _ _ P_L p<span class="main"><span class="main">]</span></span><span class="main">)</span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="free">bprv</span> <span class="main">(</span>φL <span class="free">φ</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> B.prv_eqv_prv_rev<span class="main"><span class="main">[</span></span><span class="operator">OF</span> _ _ _ bprv_φL_eqv<span class="main"><span class="main">,</span></span> <span class="operator">rotated</span> 2<span class="main"><span class="main">]</span></span><span class="main">)</span> <span class="operator">auto</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> loeb_aux_bprv<span class="main">[</span><span class="operator">OF</span> φ<span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">theorem</span></span> loeb_prv<span class="main">:</span>
<span class="keyword2"><span class="keyword">assumes</span></span> φ<span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">φ</span> <span class="main">∈</span> <span class="free">fmla</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="free">Fvars</span> <span class="free">φ</span> <span class="main">=</span> <span class="main">{}</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> p<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">prv</span> <span class="main">(</span><span class="free">imp</span> <span class="main">(</span>PP <span class="main"><span class="free">⟨</span></span><span class="free">φ</span><span class="main"><span class="free">⟩</span></span><span class="main">)</span> <span class="free">φ</span><span class="main">)</span>"</span></span>
<span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">prv</span> <span class="free">φ</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
  <span class="keyword1"><span class="command">note</span></span> PL <span class="main">=</span> bprv_prv<span class="main">[</span><span class="operator">OF</span> _ _ P_L<span class="main">,</span> <span class="operator">simplified</span><span class="main">]</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">prv</span> <span class="main">(</span><span class="free">imp</span> <span class="main">(</span>PP <span class="main"><span class="free">⟨</span></span>φL <span class="free">φ</span><span class="main"><span class="free">⟩</span></span><span class="main">)</span> <span class="free">φ</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> prv_prv_imp_trans<span class="main"><span class="main">[</span></span><span class="operator">OF</span> _ _ _ PL p<span class="main"><span class="main">]</span></span><span class="main">)</span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="free">prv</span> <span class="main">(</span>φL <span class="free">φ</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> prv_eqv_prv_rev<span class="main"><span class="main">[</span></span><span class="operator">OF</span> _ _ _ prv_φL_eqv<span class="main"><span class="main">,</span></span> <span class="operator">rotated</span> 2<span class="main"><span class="main">]</span></span><span class="main">)</span> <span class="operator">auto</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> loeb_aux_prv<span class="main">[</span><span class="operator">OF</span> φ<span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹We could have of course inferred $\mathit{goedel\_first\_theEasyHalf\_pos}$
and $\mathit{goedel\_second}$ from these more general versions, but we leave the original
arguments as they are more instructive.›</span></span>

<span class="keyword2"><span class="keyword">end</span></span> <span class="comment1">― ‹context <span class="antiquoted"><span class="antiquote">@{</span><span class="operator">locale</span> Loeb_Assumptions<span class="antiquote">}</span></span>›</span>

<span class="comment1">(*&lt;*)</span>
<span class="keyword2"><span class="keyword">end</span></span>
<span class="comment1">(*&gt;*)</span>



</pre>
</div><div id="Tarski">
<div class="head">
<h1>Theory Tarski</h1>
</div>
<pre class="source"><span class="keyword1"><span class="command">chapter</span></span> <span class="quoted"><span class="plain_text">‹Abstract Formulation of Tarski's Theorems›</span></span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹We prove Tarski's proof-theoretic and semantic theorems about the
non-definability and respectively non-expressiveness (in the standard model) of truth›</span></span>

<span class="comment1">(*&lt;*)</span>
<span class="keyword1"><span class="command">theory</span></span> Tarski
  <span class="keyword2"><span class="keyword">imports</span></span> <a href="Goedel_Formula.html">Goedel_Formula</a> <a href="Standard_Model_More.html">Standard_Model_More</a>
<span class="keyword2"><span class="keyword">begin</span></span>
<span class="comment1">(*&gt;*)</span>

<span class="keyword1"><span class="command">section</span></span> <span class="quoted"><span class="plain_text">‹Non-Definability of Truth›</span></span>

<span class="keyword1"><span class="command">context</span></span> Goedel_Form
<span class="keyword2"><span class="keyword">begin</span></span>

<span class="keyword1"><span class="command">context</span></span>
  <span class="keyword2"><span class="keyword">fixes</span></span> <span class="free">T</span> <span class="main">::</span> <span class="tfree"><span class="quoted"><span class="tfree">'fmla</span></span></span>
  <span class="keyword2"><span class="keyword">assumes</span></span> T<span class="main">[</span><span class="operator">simp</span><span class="main">,</span><span class="operator">intro</span><span class="main"><span class="main">!</span></span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">T</span> <span class="main">∈</span> <span class="free">fmla</span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> Fvars_T<span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">Fvars</span> <span class="free">T</span> <span class="main">=</span> <span class="main">{</span>xx<span class="main">}</span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> prv_T<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">⋀</span><span class="bound">φ</span><span class="main">.</span> <span class="bound">φ</span> <span class="main">∈</span> <span class="free">fmla</span> <span class="main">⟹</span> <span class="free">Fvars</span> <span class="bound">φ</span> <span class="main">=</span> <span class="main">{}</span> <span class="main">⟹</span> <span class="free">prv</span> <span class="main">(</span>eqv <span class="main">(</span><span class="free">subst</span> <span class="free">T</span> <span class="main"><span class="free">⟨</span></span><span class="bound">φ</span><span class="main"><span class="free">⟩</span></span> xx<span class="main">)</span> <span class="bound">φ</span><span class="main">)</span>"</span></span>
<span class="keyword2"><span class="keyword">begin</span></span>

<span class="keyword1"><span class="command">definition</span></span> <span class="entity">φT</span> <span class="main">::</span> <span class="tfree"><span class="quoted"><span class="tfree">'fmla</span></span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="free">φT</span> <span class="main">≡</span> diag <span class="main">(</span>neg <span class="free">T</span><span class="main">)</span>"</span></span>

<span class="keyword1"><span class="command">lemma</span></span> φT<span class="main">[</span><span class="operator">simp</span><span class="main">,</span><span class="operator">intro</span><span class="main"><span class="main"><span class="main">!</span></span></span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"φT <span class="main">∈</span> <span class="free">fmla</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span>
Fvars_φT<span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">Fvars</span> φT <span class="main">=</span> <span class="main">{}</span>"</span></span>
  <span class="keyword1"><span class="command">unfolding</span></span> φT_def PP_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">lemma</span></span> bprv_φT_eqv<span class="main">:</span>
<span class="quoted"><span class="quoted">"<span class="free">bprv</span> <span class="main">(</span>eqv φT <span class="main">(</span>neg <span class="main">(</span><span class="free">subst</span> <span class="free">T</span> <span class="main"><span class="free">⟨</span></span>φT<span class="main"><span class="free">⟩</span></span> xx<span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">unfolding</span></span> φT_def <span class="keyword1"><span class="command">using</span></span> bprv_diag_eqv<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="quoted">"neg <span class="free">T</span>"</span></span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>

<span class="keyword1"><span class="command">lemma</span></span> prv_φT_eqv<span class="main">:</span>
<span class="quoted"><span class="quoted">"<span class="free">prv</span> <span class="main">(</span>eqv φT <span class="main">(</span>neg <span class="main">(</span><span class="free">subst</span> <span class="free">T</span> <span class="main"><span class="free">⟨</span></span>φT<span class="main"><span class="free">⟩</span></span> xx<span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> d_dwf.bprv_prv'<span class="main">[</span><span class="operator">OF</span> _ bprv_φT_eqv<span class="main">,</span> <span class="operator">simplified</span><span class="main">]</span> <span class="keyword1"><span class="command">.</span></span>

<span class="keyword1"><span class="command">lemma</span></span> φT_prv_fls<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">prv</span> <span class="free">fls</span>"</span></span>
<span class="keyword1"><span class="command">using</span></span> prv_eqv_eqv_neg_prv_fls2<span class="main">[</span><span class="operator">OF</span> _ _ prv_T<span class="main"><span class="main">[</span></span><span class="operator">OF</span> φT Fvars_φT<span class="main"><span class="main">]</span></span> prv_φT_eqv<span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword2"><span class="keyword">end</span></span> <span class="comment1">― ‹context›</span>

<span class="keyword1"><span class="command">theorem</span></span> Tarski_proof_theoretic<span class="main">:</span>
<span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">T</span> <span class="main">∈</span> <span class="free">fmla</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="free">Fvars</span> <span class="free">T</span> <span class="main">=</span> <span class="main">{</span>xx<span class="main">}</span>"</span></span>
<span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">⋀</span><span class="bound">φ</span><span class="main">.</span> <span class="bound">φ</span> <span class="main">∈</span> <span class="free">fmla</span> <span class="main">⟹</span> <span class="free">Fvars</span> <span class="bound">φ</span> <span class="main">=</span> <span class="main">{}</span> <span class="main">⟹</span> <span class="free">prv</span> <span class="main">(</span>eqv <span class="main">(</span><span class="free">subst</span> <span class="free">T</span> <span class="main"><span class="free">⟨</span></span><span class="bound">φ</span><span class="main"><span class="free">⟩</span></span> xx<span class="main">)</span> <span class="bound">φ</span><span class="main">)</span>"</span></span>
<span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> consistent"</span></span>
<span class="keyword1"><span class="command">using</span></span> φT_prv_fls<span class="main">[</span><span class="operator">OF</span> assms<span class="main">]</span> consistent_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword2"><span class="keyword">end</span></span> <span class="comment1">― ‹context <span class="antiquoted"><span class="antiquote">@{</span><span class="operator">locale</span> Goedel_Form<span class="antiquote">}</span></span>›</span>


<span class="keyword1"><span class="command">section</span></span> <span class="quoted"><span class="plain_text">‹Non-Expressiveness of Truth›</span></span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹This follows as a corollary of the syntactic version, after taking prv
to be isTrue on sentences.Indeed, this is a virtue of our abstract treatment
of provability: We don't work with a particular predicate, but with any predicate
that is closed under some rules --- which could as well be a semantic notion of truth (for sentences).›</span></span>

<span class="keyword1"><span class="command">locale</span></span> Goedel_Form_prv_eq_isTrue <span class="main">=</span>
Goedel_Form
  <span class="quoted"><span class="free">var</span></span> <span class="quoted"><span class="free">trm</span></span> <span class="quoted"><span class="free">fmla</span></span> <span class="quoted"><span class="free">Var</span></span> <span class="quoted"><span class="free">num</span></span> <span class="quoted"><span class="free">FvarsT</span></span> <span class="quoted"><span class="free">substT</span></span> <span class="quoted"><span class="free">Fvars</span></span> <span class="quoted"><span class="free">subst</span></span>
  <span class="quoted"><span class="free">eql</span></span> <span class="quoted"><span class="free">cnj</span></span> <span class="quoted"><span class="free">imp</span></span> <span class="quoted"><span class="free">all</span></span> <span class="quoted"><span class="free">exi</span></span>
  <span class="quoted"><span class="free">fls</span></span>
  <span class="quoted"><span class="free">prv</span></span> <span class="quoted"><span class="free">bprv</span></span>
  <span class="quoted"><span class="free">enc</span></span>
  <span class="quoted"><span class="free">P</span></span>
  <span class="quoted"><span class="free">S</span></span>
<span class="keyword2"><span class="keyword">for</span></span>
<span class="free">var</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'var</span> set"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="free">trm</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'trm</span> set"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="free">fmla</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'fmla</span> set"</span></span>
<span class="keyword2"><span class="keyword">and</span></span> <span class="free">Var</span> <span class="free">num</span> <span class="free">FvarsT</span> <span class="free">substT</span> <span class="free">Fvars</span> <span class="free">subst</span>
<span class="keyword2"><span class="keyword">and</span></span> <span class="free">eql</span> <span class="free">cnj</span> <span class="free">imp</span> <span class="free">all</span> <span class="free">exi</span>
<span class="keyword2"><span class="keyword">and</span></span> <span class="free">fls</span>
<span class="keyword2"><span class="keyword">and</span></span> <span class="free">prv</span> <span class="free">bprv</span>
<span class="keyword2"><span class="keyword">and</span></span> <span class="free">enc</span> <span class="main">(</span><span class="quoted">"<span class="keyword1">⟨</span>_<span class="keyword1">⟩</span>"</span><span class="main">)</span>
<span class="keyword2"><span class="keyword">and</span></span> <span class="free">S</span>
<span class="keyword2"><span class="keyword">and</span></span> <span class="free">P</span>
<span class="main">+</span>
<span class="keyword2"><span class="keyword">fixes</span></span> <span class="free">isTrue</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'fmla</span> <span class="main">⇒</span> bool"</span></span>
<span class="keyword2"><span class="keyword">assumes</span></span> prv_eq_isTrue<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">⋀</span> <span class="bound">φ</span><span class="main">.</span> <span class="bound">φ</span> <span class="main">∈</span> <span class="free">fmla</span> <span class="main">⟹</span> <span class="free">Fvars</span> <span class="bound">φ</span> <span class="main">=</span> <span class="main">{}</span> <span class="main">⟹</span> <span class="free">prv</span> <span class="bound">φ</span> <span class="main">=</span> <span class="free">isTrue</span> <span class="bound">φ</span>"</span></span>
<span class="keyword2"><span class="keyword">begin</span></span>

<span class="keyword1"><span class="command">theorem</span></span> Tarski_semantic<span class="main">:</span>
<span class="keyword2"><span class="keyword">assumes</span></span> 0<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">T</span> <span class="main">∈</span> <span class="free">fmla</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="free">Fvars</span> <span class="free">T</span> <span class="main">=</span> <span class="main">{</span>xx<span class="main">}</span>"</span></span>
<span class="keyword2"><span class="keyword">and</span></span> 1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">⋀</span><span class="bound">φ</span><span class="main">.</span> <span class="bound">φ</span> <span class="main">∈</span> <span class="free">fmla</span> <span class="main">⟹</span> <span class="free">Fvars</span> <span class="bound">φ</span> <span class="main">=</span> <span class="main">{}</span> <span class="main">⟹</span> <span class="free">isTrue</span> <span class="main">(</span>eqv <span class="main">(</span><span class="free">subst</span> <span class="free">T</span> <span class="main"><span class="free">⟨</span></span><span class="bound">φ</span><span class="main"><span class="free">⟩</span></span> xx<span class="main">)</span> <span class="bound">φ</span><span class="main">)</span>"</span></span>
<span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> consistent"</span></span>
<span class="keyword1"><span class="command">using</span></span> assms prv_eq_isTrue<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="quoted">"eqv <span class="main">(</span><span class="free">subst</span> <span class="free">T</span> <span class="main"><span class="free">⟨</span></span><span class="main">_</span><span class="main"><span class="free">⟩</span></span> xx<span class="main">)</span> <span class="main">_</span>"</span></span><span class="main">]</span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">intro</span> Tarski_proof_theoretic<span class="main"><span class="main">[</span></span><span class="operator">OF</span> 0<span class="main"><span class="main">]</span></span><span class="main">)</span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹NB: To instantiate the semantic version of Tarski's theorem for a truth predicate
isTruth on sentences, one needs to extend it to a predicate "prv" on formulas and verify
that "prv" satisfies the rules of intuitionistic logic.›</span></span>

<span class="keyword2"><span class="keyword">end</span></span> <span class="comment1">― ‹context <span class="antiquoted"><span class="antiquote">@{</span><span class="operator">locale</span> Goedel_Form_prv_eq_isTrue<span class="antiquote">}</span></span>›</span>

<span class="comment1">(*&lt;*)</span>
<span class="keyword2"><span class="keyword">end</span></span>
<span class="comment1">(*&gt;*)</span>
</pre>
</div><div id="All_Abstract">
<div class="head">
<h1>Theory All_Abstract</h1>
</div>
<pre class="source"><span class="comment1">(*&lt;*)</span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹This puts together all the theories of the abstract development›</span></span>

<span class="keyword1"><span class="command">theory</span></span> All_Abstract
<span class="keyword2"><span class="keyword">imports</span></span>
  <a href="Abstract_First_Goedel.html">Abstract_First_Goedel</a>
  <a href="Abstract_First_Goedel_Rosser.html">Abstract_First_Goedel_Rosser</a>
  <a href="Abstract_Second_Goedel.html">Abstract_Second_Goedel</a>
  <a href="Jeroslow_Original.html">Jeroslow_Original</a>
  <a href="Jeroslow_Simplified.html">Jeroslow_Simplified</a>
  <a href="Loeb.html">Loeb</a>
  <a href="Tarski.html">Tarski</a>
<span class="keyword2"><span class="keyword">begin</span></span>

<span class="keyword2"><span class="keyword">end</span></span>
<span class="comment1">(*&gt;*)</span>
</pre>
</div>
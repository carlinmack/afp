<div id="Arith_Prog_Rel_Primes">
<div class="head">
<h1>Theory Arith_Prog_Rel_Primes</h1>
</div>
<pre class="source"><span class="comment1">(*
  File:   Arith_Prog_Rel_Primes.thy
  Author: Jose Manuel Rodriguez Caballero, University of Tartu
*)</span>
<span class="keyword1"><span class="command">section</span></span> <span class="quoted"><span class="plain_text">‹Problem ARITHMETIC PROGRESSIONS (Putnam exam problems 2002)›</span></span>
<span class="keyword1"><span class="command">theory</span></span> Arith_Prog_Rel_Primes
  <span class="keyword2"><span class="keyword">imports</span></span>
    <a href="../../HOL/HOL/Complex_Main.html">Complex_Main</a> 
    <span class="quoted">"<a href="../../HOL/HOL-Number_Theory/Number_Theory.html">HOL-Number_Theory.Number_Theory</a>"</span>
<span class="keyword2"><span class="keyword">begin</span></span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹
 Statement of the problem (from ~\cite{putnam}): For which integers $n&gt;1$ does the set of positive 
 integers less than and relatively prime to $n$ constitute an arithmetic progression?
 
 The solution of the above problem is theorem <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">text</span></span> <span class="raw_text"><span class="raw_text">arith_prog_rel_primes_solution</span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span>.

 First, we will require some auxiliary material before we get started with the actual
 solution.
›</span></span>

<span class="keyword1"><span class="command">subsection</span></span> <span class="quoted"><span class="plain_text">‹Auxiliary results›</span></span>

<span class="keyword1" id="Arith_Prog_Rel_Primes-even_and_odd_parts"><span class="command">lemma</span></span> even_and_odd_parts<span class="main">:</span>
  <span class="keyword2"><span class="keyword">fixes</span></span> <span class="free">n</span><span class="main">::</span><span class="quoted">nat</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">‹<span class="free">n</span> <span class="main">≠</span> <span class="main">0</span>›</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">‹<span class="main">∃</span> <span class="bound">k</span> <span class="bound">q</span><span class="main">::</span>nat<span class="main">.</span> <span class="free">n</span> <span class="main">=</span> <span class="main">(</span><span class="numeral">2</span><span class="main">::</span>nat<span class="main">)</span><span class="main">^</span><span class="bound">k</span><span class="main">*</span><span class="bound">q</span> <span class="main">∧</span> odd <span class="bound">q</span>›</span></span>
<span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹prime <span class="main">(</span><span class="numeral">2</span><span class="main">::</span>nat<span class="main">)</span>›</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>    
  <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
    <span class="keyword1"><span class="command">using</span></span> prime_power_canonical<span class="main">[</span><span class="keyword2"><span class="keyword"><span class="operator">where</span></span></span> p <span class="main"><span class="main">=</span></span> <span class="quoted"><span class="quoted">"<span class="numeral">2</span>"</span></span> <span class="keyword2"><span class="keyword"><span class="quasi_keyword">and</span></span></span> m <span class="main"><span class="main">=</span></span> <span class="quoted"><span class="quoted">"<span class="free">n</span>"</span></span><span class="main">]</span>
      assms semiring_normalization_rules<span class="main">(</span>7<span class="main">)</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>    
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="Arith_Prog_Rel_Primes-only_one_odd_div_power2"><span class="command">lemma</span></span> only_one_odd_div_power2<span class="main">:</span>
  <span class="keyword2"><span class="keyword">fixes</span></span> <span class="free">n</span><span class="main">::</span><span class="quoted">nat</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">‹<span class="free">n</span> <span class="main">≠</span> <span class="main">0</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span>  <span class="quoted"><span class="quoted">‹<span class="main">⋀</span> <span class="bound">x</span><span class="main">.</span> <span class="bound">x</span> <span class="keyword1">dvd</span> <span class="free">n</span> <span class="main">⟹</span> odd <span class="bound">x</span> <span class="main">⟹</span> <span class="bound">x</span> <span class="main">=</span> <span class="main">1</span>›</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">‹<span class="main">∃</span> <span class="bound">k</span><span class="main">.</span> <span class="free">n</span> <span class="main">=</span> <span class="main">(</span><span class="numeral">2</span><span class="main">::</span>nat<span class="main">)</span><span class="main">^</span><span class="bound">k</span>›</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> even_and_odd_parts assms<span class="main"><span class="main">(</span></span>1<span class="main"><span class="main">)</span></span> assms<span class="main"><span class="main">(</span></span>2<span class="main"><span class="main">)</span></span> dvd_triv_left semiring_normalization_rules<span class="main"><span class="main">(</span></span>11<span class="main"><span class="main">)</span></span>
      semiring_normalization_rules<span class="main"><span class="main">(</span></span>7<span class="main"><span class="main">)</span></span><span class="main">)</span>

<span class="keyword1" id="Arith_Prog_Rel_Primes-coprime_power2"><span class="command">lemma</span></span> coprime_power2<span class="main">:</span>
  <span class="keyword2"><span class="keyword">fixes</span></span> <span class="free">n</span><span class="main">::</span><span class="quoted">nat</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">‹<span class="free">n</span> <span class="main">≠</span> <span class="main">0</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹<span class="main">⋀</span> <span class="bound">x</span><span class="main">.</span> <span class="bound">x</span> <span class="main">&lt;</span> <span class="free">n</span> <span class="main">⟹</span> <span class="main">(</span>coprime <span class="bound">x</span> <span class="free">n</span> <span class="main">⟷</span> odd <span class="bound">x</span><span class="main">)</span>›</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">‹<span class="main">∃</span> <span class="bound">k</span><span class="main">.</span> <span class="free">n</span> <span class="main">=</span> <span class="main">(</span><span class="numeral">2</span><span class="main">::</span>nat<span class="main">)</span><span class="main">^</span><span class="bound">k</span>›</span></span>
<span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">x</span> <span class="keyword1">dvd</span> <span class="free">n</span> <span class="main">⟹</span> odd <span class="skolem">x</span> <span class="main">⟹</span> <span class="skolem">x</span> <span class="main">=</span> <span class="main">1</span>›</span></span>
    <span class="keyword2"><span class="keyword">for</span></span> <span class="skolem">x</span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> neq0_conv One_nat_def Suc_1 Suc_lessI assms<span class="main"><span class="main">(</span></span>1<span class="main"><span class="main">)</span></span> assms<span class="main"><span class="main">(</span></span>2<span class="main"><span class="main">)</span></span> coprime_left_2_iff_odd
        dvd_refl linorder_neqE_nat nat_dvd_1_iff_1 nat_dvd_not_less not_coprimeI<span class="main">)</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
    <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>1<span class="main">)</span> only_one_odd_div_power2 
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span> 
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">subsection</span></span> <span class="quoted"><span class="plain_text">‹Main result›</span></span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹
  The solution to the problem  ARITHMETIC PROGRESSIONS (Putnam exam problems 2002)
›</span></span>

<span class="keyword1"><span class="command">theorem</span></span> arith_prog_rel_primes_solution<span class="main">:</span>
  <span class="keyword2"><span class="keyword">fixes</span></span> <span class="free">n</span> <span class="main">::</span> <span class="quoted">nat</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">‹<span class="free">n</span> <span class="main">&gt;</span> <span class="main">1</span>›</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">‹<span class="main">(</span>prime <span class="free">n</span> <span class="main">∨</span> <span class="main">(</span><span class="main">∃</span> <span class="bound">k</span><span class="main">.</span> <span class="free">n</span> <span class="main">=</span> <span class="numeral">2</span><span class="main">^</span><span class="bound">k</span><span class="main">)</span> <span class="main">∨</span> <span class="free">n</span> <span class="main">=</span> <span class="numeral">6</span><span class="main">)</span> <span class="main">⟷</span>  
<span class="main">(</span><span class="main">∃</span> <span class="bound">a</span> <span class="bound">b</span> <span class="bound">m</span><span class="main">.</span> <span class="bound">m</span> <span class="main">≠</span> <span class="main">0</span> <span class="main">∧</span> <span class="main">{</span><span class="bound">x</span> <span class="main">|</span> <span class="bound">x</span><span class="main">.</span> <span class="bound">x</span> <span class="main">&lt;</span> <span class="free">n</span> <span class="main">∧</span> coprime <span class="bound">x</span> <span class="free">n</span><span class="main">}</span> <span class="main">=</span> <span class="main">{</span><span class="bound">a</span><span class="main">+</span><span class="bound">j</span><span class="main">*</span><span class="bound">b</span><span class="main">|</span> <span class="bound">j</span><span class="main">::</span>nat<span class="main">.</span> <span class="bound">j</span> <span class="main">&lt;</span> <span class="bound">m</span><span class="main">}</span><span class="main">)</span>›</span></span>
<span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹ <span class="main">(</span>prime <span class="free">n</span> <span class="main">∨</span> <span class="main">(</span><span class="main">∃</span> <span class="bound">k</span><span class="main">.</span> <span class="free">n</span> <span class="main">=</span> <span class="numeral">2</span><span class="main">^</span><span class="bound">k</span><span class="main">)</span> <span class="main">∨</span>  <span class="free">n</span> <span class="main">=</span> <span class="numeral">6</span><span class="main">)</span> <span class="main">⟷</span>
 <span class="main">(</span><span class="main">∃</span> <span class="bound">b</span> <span class="bound">m</span><span class="main">.</span> <span class="bound">m</span> <span class="main">≠</span> <span class="main">0</span> <span class="main">∧</span> <span class="main">{</span><span class="bound">x</span> <span class="main">|</span> <span class="bound">x</span> <span class="main">::</span> nat<span class="main">.</span> <span class="bound">x</span> <span class="main">&lt;</span> <span class="free">n</span> <span class="main">∧</span> coprime <span class="bound">x</span> <span class="free">n</span><span class="main">}</span> <span class="main">=</span> <span class="main">{</span><span class="main">1</span><span class="main">+</span><span class="bound">j</span><span class="main">*</span><span class="bound">b</span><span class="main">|</span> <span class="bound">j</span><span class="main">::</span>nat<span class="main">.</span> <span class="bound">j</span> <span class="main">&lt;</span> <span class="bound">m</span><span class="main">}</span><span class="main">)</span>›</span></span>
  <span class="keyword1"><span class="command">proof</span></span>
    <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound">b</span> <span class="bound">m</span><span class="main">.</span> <span class="bound">m</span> <span class="main">≠</span> <span class="main">0</span> <span class="main">∧</span> <span class="main">{</span><span class="bound">x</span> <span class="main">|</span><span class="bound">x</span><span class="main">.</span> <span class="bound">x</span> <span class="main">&lt;</span> <span class="free">n</span> <span class="main">∧</span> coprime <span class="bound">x</span> <span class="free">n</span><span class="main">}</span> <span class="main">=</span> <span class="main">{</span><span class="main">1</span> <span class="main">+</span> <span class="bound">j</span> <span class="main">*</span> <span class="bound">b</span> <span class="main">|</span><span class="bound">j</span><span class="main">.</span> <span class="bound">j</span> <span class="main">&lt;</span> <span class="bound">m</span><span class="main">}</span>"</span></span>
      <span class="keyword2"><span class="keyword">if</span></span> <span class="quoted"><span class="quoted">"prime <span class="free">n</span> <span class="main">∨</span> <span class="main">(</span><span class="main">∃</span><span class="bound">k</span><span class="main">.</span> <span class="free">n</span> <span class="main">=</span> <span class="numeral">2</span> <span class="main">^</span> <span class="bound">k</span><span class="main">)</span> <span class="main">∨</span> <span class="free">n</span> <span class="main">=</span> <span class="numeral">6</span>"</span></span>
    <span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
      <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound">b</span> <span class="bound">m</span><span class="main">.</span> <span class="bound">m</span> <span class="main">≠</span> <span class="main">0</span> <span class="main">∧</span> <span class="main">{</span><span class="bound">x</span> <span class="main">|</span><span class="bound">x</span><span class="main">.</span> <span class="bound">x</span> <span class="main">&lt;</span> <span class="free">n</span> <span class="main">∧</span> coprime <span class="bound">x</span> <span class="free">n</span><span class="main">}</span> <span class="main">=</span> <span class="main">{</span><span class="main">1</span> <span class="main">+</span> <span class="bound">j</span> <span class="main">*</span> <span class="bound">b</span> <span class="main">|</span><span class="bound">j</span><span class="main">.</span> <span class="bound">j</span> <span class="main">&lt;</span> <span class="bound">m</span><span class="main">}</span>"</span></span>
        <span class="keyword2"><span class="keyword">if</span></span> <span class="quoted"><span class="quoted">"prime <span class="free">n</span>"</span></span>
      <span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
        <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹<span class="main">∃</span><span class="bound">m</span><span class="main">.</span>   <span class="bound">m</span> <span class="main">≠</span> <span class="main">0</span> <span class="main">∧</span> <span class="main">{</span><span class="bound">x</span> <span class="main">|</span> <span class="bound">x</span> <span class="main">::</span> nat<span class="main">.</span> <span class="bound">x</span> <span class="main">&lt;</span> <span class="free">n</span> <span class="main">∧</span> coprime <span class="bound">x</span> <span class="free">n</span><span class="main">}</span> <span class="main">=</span> <span class="main">{</span><span class="main">1</span><span class="main">+</span><span class="bound">j</span><span class="main">|</span> <span class="bound">j</span><span class="main">::</span>nat<span class="main">.</span> <span class="bound">j</span> <span class="main">&lt;</span> <span class="bound">m</span><span class="main">}</span>›</span></span>
        <span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
          <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹<span class="main">{</span><span class="bound">x</span> <span class="main">|</span> <span class="bound">x</span> <span class="main">::</span> nat<span class="main">.</span> <span class="bound">x</span> <span class="main">&lt;</span> <span class="free">n</span> <span class="main">∧</span> coprime <span class="bound">x</span> <span class="free">n</span><span class="main">}</span> <span class="main">=</span>  <span class="main">{</span><span class="bound">x</span> <span class="main">|</span> <span class="bound">x</span> <span class="main">::</span> nat<span class="main">.</span> <span class="bound">x</span> <span class="main">≠</span> <span class="main">0</span> <span class="main">∧</span> <span class="bound">x</span> <span class="main">&lt;</span> <span class="free">n</span><span class="main">}</span>›</span></span> 
          <span class="keyword1"><span class="command">proof</span></span>
            <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">{</span><span class="bound">x</span> <span class="main">|</span><span class="bound">x</span><span class="main">.</span> <span class="bound">x</span> <span class="main">&lt;</span> <span class="free">n</span> <span class="main">∧</span> coprime <span class="bound">x</span> <span class="free">n</span><span class="main">}</span> <span class="main">⊆</span> <span class="main">{</span><span class="bound">x</span> <span class="main">|</span><span class="bound">x</span><span class="main">.</span> <span class="bound">x</span> <span class="main">≠</span> <span class="main">0</span> <span class="main">∧</span> <span class="bound">x</span> <span class="main">&lt;</span> <span class="free">n</span><span class="main">}</span>"</span></span>
              <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">smt</span> Collect_mono not_le ord_0_nat ord_eq_0 order_refl prime_gt_1_nat that zero_neq_one<span class="main">)</span>
            <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">{</span><span class="bound">x</span> <span class="main">|</span><span class="bound">x</span><span class="main">.</span> <span class="bound">x</span> <span class="main">≠</span> <span class="main">0</span> <span class="main">∧</span> <span class="bound">x</span> <span class="main">&lt;</span> <span class="free">n</span><span class="main">}</span> <span class="main">⊆</span> <span class="main">{</span><span class="bound">x</span> <span class="main">|</span><span class="bound">x</span><span class="main">.</span> <span class="bound">x</span> <span class="main">&lt;</span> <span class="free">n</span> <span class="main">∧</span> coprime <span class="bound">x</span> <span class="free">n</span><span class="main">}</span>"</span></span>
              <span class="keyword1"><span class="command">using</span></span> coprime_commute prime_nat_iff'' that 
              <span class="keyword1"><span class="command">by</span></span> <span class="operator">fastforce</span>              
          <span class="keyword1"><span class="command">qed</span></span>
          <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">m</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">m</span><span class="main">+</span><span class="main">1</span> <span class="main">=</span> <span class="free">n</span>›</span></span>
            <span class="keyword1"><span class="command">using</span></span> add.commute assms less_imp_add_positive <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
          <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹<span class="main">{</span><span class="main">1</span><span class="main">+</span><span class="bound">j</span><span class="main">|</span> <span class="bound">j</span><span class="main">::</span>nat<span class="main">.</span> <span class="bound">j</span> <span class="main">&lt;</span> <span class="main">(</span><span class="skolem">m</span><span class="main">::</span>nat<span class="main">)</span><span class="main">}</span> <span class="main">=</span>  <span class="main">{</span><span class="bound">x</span> <span class="main">|</span> <span class="bound">x</span> <span class="main">::</span> nat<span class="main">.</span> <span class="bound">x</span> <span class="main">≠</span> <span class="main">0</span> <span class="main">∧</span> <span class="bound">x</span> <span class="main">&lt;</span> <span class="skolem">m</span><span class="main">+</span><span class="main">1</span><span class="main">}</span>›</span></span> 
            <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> Suc_eq_plus1   <span class="quoted"><span class="quoted">‹<span class="skolem">m</span> <span class="main">+</span> <span class="main">1</span> <span class="main">=</span> <span class="free">n</span>›</span></span> gr0_implies_Suc le_simps<span class="main"><span class="main">(</span></span>3<span class="main"><span class="main">)</span></span>   less_nat_zero_code   linorder_not_less nat.simps<span class="main"><span class="main">(</span></span>3<span class="main"><span class="main">)</span></span> nat_neq_iff  plus_1_eq_Suc <span class="main">)</span>
          <span class="keyword1"><span class="command">hence</span></span>  <span class="quoted"><span class="quoted">‹<span class="main">{</span><span class="bound">x</span> <span class="main">|</span> <span class="bound">x</span> <span class="main">::</span> nat<span class="main">.</span> <span class="bound">x</span> <span class="main">&lt;</span> <span class="free">n</span> <span class="main">∧</span> coprime <span class="bound">x</span> <span class="free">n</span><span class="main">}</span> <span class="main">=</span> <span class="main">{</span><span class="main">1</span><span class="main">+</span><span class="bound">j</span><span class="main">|</span> <span class="bound">j</span><span class="main">::</span>nat<span class="main">.</span> <span class="bound">j</span> <span class="main">&lt;</span> <span class="main">(</span><span class="skolem">m</span><span class="main">::</span>nat<span class="main">)</span><span class="main">}</span>›</span></span>
            <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="main">{</span><span class="bound">x</span> <span class="main">|</span> <span class="bound">x</span> <span class="main">::</span> nat<span class="main">.</span> <span class="bound">x</span> <span class="main">&lt;</span> <span class="free">n</span> <span class="main">∧</span> coprime <span class="bound">x</span> <span class="free">n</span><span class="main">}</span> <span class="main">=</span>  <span class="main">{</span><span class="bound">x</span> <span class="main">|</span> <span class="bound">x</span> <span class="main">::</span> nat<span class="main">.</span> <span class="bound">x</span> <span class="main">≠</span> <span class="main">0</span> <span class="main">∧</span> <span class="bound">x</span> <span class="main">&lt;</span> <span class="free">n</span><span class="main">}</span>›</span></span>  <span class="quoted"><span class="quoted">‹<span class="skolem">m</span><span class="main">+</span><span class="main">1</span> <span class="main">=</span> <span class="free">n</span>›</span></span> 
            <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
          <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="free">n</span> <span class="main">&gt;</span> <span class="main">1</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">m</span> <span class="main">≠</span> <span class="main">0</span>›</span></span> 
            <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">m</span> <span class="main">+</span> <span class="main">1</span> <span class="main">=</span> <span class="free">n</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">linarith</span>
          <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹<span class="main">{</span><span class="bound">x</span> <span class="main">|</span> <span class="bound">x</span> <span class="main">::</span> nat<span class="main">.</span> <span class="bound">x</span> <span class="main">&lt;</span> <span class="free">n</span> <span class="main">∧</span> coprime <span class="bound">x</span> <span class="free">n</span><span class="main">}</span> <span class="main">=</span> <span class="main">{</span><span class="main">1</span><span class="main">+</span><span class="bound">j</span><span class="main">|</span> <span class="bound">j</span><span class="main">::</span>nat<span class="main">.</span> <span class="bound">j</span> <span class="main">&lt;</span> <span class="skolem">m</span><span class="main">}</span>›</span></span> 
            <span class="keyword1"><span class="command">using</span></span> Suc_eq_plus1 <span class="quoted"><span class="quoted">‹<span class="main">1</span> <span class="main">&lt;</span> <span class="free">n</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="main">{</span><span class="bound">x</span> <span class="main">|</span><span class="bound">x</span><span class="main">.</span> <span class="bound">x</span> <span class="main">&lt;</span> <span class="free">n</span> <span class="main">∧</span> coprime <span class="bound">x</span> <span class="free">n</span><span class="main">}</span> <span class="main">=</span> <span class="main">{</span><span class="main">1</span> <span class="main">+</span> <span class="bound">j</span> <span class="main">|</span><span class="bound">j</span><span class="main">.</span> <span class="bound">j</span> <span class="main">&lt;</span> <span class="skolem">m</span><span class="main">}</span>›</span></span> 
            <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
          <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">‹<span class="main">(</span><span class="main">∃</span> <span class="bound">m</span><span class="main">.</span>  <span class="bound">m</span> <span class="main">≠</span> <span class="main">0</span> <span class="main">∧</span> <span class="main">{</span><span class="bound">x</span> <span class="main">|</span> <span class="bound">x</span> <span class="main">::</span> nat<span class="main">.</span> <span class="bound">x</span> <span class="main">&lt;</span> <span class="free">n</span> <span class="main">∧</span> coprime <span class="bound">x</span> <span class="free">n</span><span class="main">}</span> <span class="main">=</span> <span class="main">{</span><span class="main">1</span><span class="main">+</span><span class="bound">j</span><span class="main">|</span> <span class="bound">j</span><span class="main">::</span>nat<span class="main">.</span> <span class="bound">j</span> <span class="main">&lt;</span> <span class="bound">m</span><span class="main">}</span><span class="main">)</span>›</span></span>
            <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">m</span> <span class="main">≠</span> <span class="main">0</span>›</span></span> 
            <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
          <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
        <span class="keyword1"><span class="command">qed</span></span>
        <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">‹<span class="main">∃</span><span class="bound">m</span><span class="main">.</span>  <span class="bound">m</span> <span class="main">≠</span> <span class="main">0</span> <span class="main">∧</span> <span class="main">{</span><span class="bound">x</span> <span class="main">|</span> <span class="bound">x</span> <span class="main">::</span> nat<span class="main">.</span> <span class="bound">x</span> <span class="main">&lt;</span> <span class="free">n</span> <span class="main">∧</span> coprime <span class="bound">x</span> <span class="free">n</span><span class="main">}</span> <span class="main">=</span> <span class="main">{</span><span class="main">1</span><span class="main">+</span><span class="bound">j</span><span class="main">*</span><span class="main">1</span><span class="main">|</span> <span class="bound">j</span><span class="main">::</span>nat<span class="main">.</span> <span class="bound">j</span> <span class="main">&lt;</span> <span class="bound">m</span><span class="main">}</span>›</span></span>
          <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
          <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span> 
      <span class="keyword1"><span class="command">qed</span></span>
      <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound">b</span> <span class="bound">m</span><span class="main">.</span> <span class="bound">m</span> <span class="main">≠</span> <span class="main">0</span> <span class="main">∧</span> <span class="main">{</span><span class="bound">x</span> <span class="main">|</span><span class="bound">x</span><span class="main">.</span> <span class="bound">x</span> <span class="main">&lt;</span> <span class="free">n</span> <span class="main">∧</span> coprime <span class="bound">x</span> <span class="free">n</span><span class="main">}</span> <span class="main">=</span> <span class="main">{</span><span class="main">1</span> <span class="main">+</span> <span class="bound">j</span> <span class="main">*</span> <span class="bound">b</span> <span class="main">|</span><span class="bound">j</span><span class="main">.</span> <span class="bound">j</span> <span class="main">&lt;</span> <span class="bound">m</span><span class="main">}</span>"</span></span>
        <span class="keyword2"><span class="keyword">if</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound">k</span><span class="main">.</span> <span class="free">n</span> <span class="main">=</span> <span class="numeral">2</span> <span class="main">^</span> <span class="bound">k</span>"</span></span>
      <span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
        <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">k</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">‹<span class="free">n</span> <span class="main">=</span> <span class="numeral">2</span> <span class="main">^</span> <span class="skolem">k</span>›</span></span>
          <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="main">∃</span><span class="bound">k</span><span class="main">.</span> <span class="free">n</span> <span class="main">=</span> <span class="numeral">2</span> <span class="main">^</span> <span class="bound">k</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">k</span> <span class="main">≠</span> <span class="main">0</span>›</span></span> 
          <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> <span class="quoted"><span class="quoted">‹<span class="main">1</span> <span class="main">&lt;</span> <span class="free">n</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="free">n</span> <span class="main">=</span> <span class="numeral">2</span> <span class="main">^</span> <span class="skolem">k</span>›</span></span> nat_less_le power.simps<span class="main"><span class="main">(</span></span>1<span class="main"><span class="main">)</span></span><span class="main">)</span>
        <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">t</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">‹Suc <span class="skolem">t</span> <span class="main">=</span> <span class="skolem">k</span>›</span></span> 
          <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> <span class="quoted"><span class="quoted">‹<span class="skolem">k</span> <span class="main">≠</span> <span class="main">0</span>›</span></span> fib.cases<span class="main">)</span>
        <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹<span class="free">n</span> <span class="main">=</span> <span class="numeral">2</span><span class="main">^</span><span class="main">(</span>Suc <span class="skolem">t</span><span class="main">)</span>›</span></span> 
          <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> <span class="quoted"><span class="quoted">‹Suc <span class="skolem">t</span> <span class="main">=</span> <span class="skolem">k</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="free">n</span> <span class="main">=</span> <span class="numeral">2</span> <span class="main">^</span> <span class="skolem">k</span>›</span></span><span class="main">)</span>
        <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹<span class="main">{</span><span class="bound">x</span> <span class="main">|</span> <span class="bound">x</span> <span class="main">::</span> nat<span class="main">.</span> <span class="bound">x</span> <span class="main">&lt;</span> <span class="free">n</span> <span class="main">∧</span> coprime <span class="bound">x</span> <span class="free">n</span><span class="main">}</span> <span class="main">=</span> <span class="main">{</span><span class="main">1</span><span class="main">+</span><span class="bound">j</span><span class="main">*</span><span class="numeral">2</span><span class="main">|</span> <span class="bound">j</span><span class="main">::</span>nat<span class="main">.</span> <span class="bound">j</span> <span class="main">&lt;</span> <span class="numeral">2</span><span class="main">^</span><span class="skolem">t</span><span class="main">}</span>›</span></span>
        <span class="keyword1"><span class="command">proof</span></span>
          <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">{</span><span class="bound">x</span> <span class="main">|</span><span class="bound">x</span><span class="main">.</span> <span class="bound">x</span> <span class="main">&lt;</span> <span class="free">n</span> <span class="main">∧</span> coprime <span class="bound">x</span> <span class="free">n</span><span class="main">}</span> <span class="main">⊆</span> <span class="main">{</span><span class="main">1</span> <span class="main">+</span> <span class="bound">j</span> <span class="main">*</span> <span class="numeral">2</span> <span class="main">|</span><span class="bound">j</span><span class="main">.</span> <span class="bound">j</span> <span class="main">&lt;</span> <span class="numeral">2</span><span class="main">^</span><span class="skolem">t</span><span class="main">}</span>"</span></span>
          <span class="keyword1"><span class="command">proof</span></span>
            <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">x</span>
            <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">x</span> <span class="main">∈</span> <span class="main">{</span><span class="bound">x</span> <span class="main">|</span><span class="bound">x</span><span class="main">.</span> <span class="bound">x</span> <span class="main">&lt;</span> <span class="free">n</span> <span class="main">∧</span> coprime <span class="bound">x</span> <span class="free">n</span><span class="main">}</span>›</span></span>
            <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">x</span> <span class="main">&lt;</span> <span class="free">n</span>›</span></span>
              <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
            <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹coprime <span class="skolem">x</span> <span class="free">n</span>›</span></span>
              <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">x</span> <span class="main">∈</span> <span class="main">{</span><span class="bound">x</span> <span class="main">|</span><span class="bound">x</span><span class="main">.</span> <span class="bound">x</span> <span class="main">&lt;</span> <span class="free">n</span> <span class="main">∧</span> coprime <span class="bound">x</span> <span class="free">n</span><span class="main">}</span>›</span></span>
              <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
            <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">‹coprime <span class="skolem">x</span> <span class="main">(</span><span class="numeral">2</span><span class="main">^</span><span class="main">(</span>Suc <span class="skolem">k</span><span class="main">)</span><span class="main">)</span>›</span></span>
              <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">k</span> <span class="main">≠</span> <span class="main">0</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="free">n</span> <span class="main">=</span> <span class="numeral">2</span> <span class="main">^</span> <span class="skolem">k</span>›</span></span><span class="main">)</span>              
            <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹odd <span class="skolem">x</span>›</span></span>
              <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹coprime <span class="skolem">x</span> <span class="free">n</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">k</span> <span class="main">≠</span> <span class="main">0</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="free">n</span> <span class="main">=</span> <span class="numeral">2</span> <span class="main">^</span> <span class="skolem">k</span>›</span></span> 
              <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span> 
            <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">j</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">x</span> <span class="main">=</span> <span class="main">1</span><span class="main">+</span><span class="skolem">j</span><span class="main">*</span><span class="numeral">2</span>›</span></span>
              <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> add.commute add.left_commute left_add_twice mult_2_right oddE<span class="main">)</span>
            <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">x</span> <span class="main">&lt;</span> <span class="numeral">2</span><span class="main">^</span><span class="skolem">k</span>›</span></span>
              <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="free">n</span> <span class="main">=</span> <span class="numeral">2</span> <span class="main">^</span> <span class="skolem">k</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">x</span> <span class="main">&lt;</span> <span class="free">n</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">x</span> <span class="main">=</span> <span class="main">1</span><span class="main">+</span><span class="skolem">j</span><span class="main">*</span><span class="numeral">2</span>›</span></span> 
              <span class="keyword1"><span class="command">by</span></span> <span class="operator">linarith</span>
            <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">‹<span class="main">1</span><span class="main">+</span><span class="skolem">j</span><span class="main">*</span><span class="numeral">2</span> <span class="main">&lt;</span> <span class="numeral">2</span><span class="main">^</span><span class="skolem">k</span>›</span></span>
              <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">x</span> <span class="main">=</span> <span class="main">1</span><span class="main">+</span><span class="skolem">j</span><span class="main">*</span><span class="numeral">2</span>›</span></span>
              <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
            <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">j</span> <span class="main">&lt;</span> <span class="numeral">2</span><span class="main">^</span><span class="skolem">t</span>›</span></span>
              <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹Suc <span class="skolem">t</span> <span class="main">=</span> <span class="skolem">k</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>              
            <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">x</span> <span class="main">∈</span> <span class="main">{</span><span class="main">1</span> <span class="main">+</span> <span class="bound">j</span> <span class="main">*</span> <span class="numeral">2</span> <span class="main">|</span><span class="bound">j</span><span class="main">.</span> <span class="bound">j</span> <span class="main">&lt;</span> <span class="numeral">2</span><span class="main">^</span><span class="skolem">t</span><span class="main">}</span>›</span></span>
              <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">x</span> <span class="main">=</span> <span class="main">1</span><span class="main">+</span><span class="skolem">j</span><span class="main">*</span><span class="numeral">2</span>›</span></span>
              <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
          <span class="keyword1"><span class="command">qed</span></span>
          <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">{</span><span class="main">1</span> <span class="main">+</span> <span class="bound">j</span> <span class="main">*</span> <span class="numeral">2</span> <span class="main">|</span><span class="bound">j</span><span class="main">.</span> <span class="bound">j</span> <span class="main">&lt;</span> <span class="numeral">2</span> <span class="main">^</span> <span class="skolem">t</span><span class="main">}</span> <span class="main">⊆</span> <span class="main">{</span><span class="bound">x</span> <span class="main">|</span><span class="bound">x</span><span class="main">.</span> <span class="bound">x</span> <span class="main">&lt;</span> <span class="free">n</span> <span class="main">∧</span> coprime <span class="bound">x</span> <span class="free">n</span><span class="main">}</span>"</span></span>
          <span class="keyword1"><span class="command">proof</span></span>
            <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">x</span><span class="main">::</span><span class="quoted">nat</span>
            <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">x</span> <span class="main">∈</span> <span class="main">{</span><span class="main">1</span> <span class="main">+</span> <span class="bound">j</span> <span class="main">*</span> <span class="numeral">2</span> <span class="main">|</span><span class="bound">j</span><span class="main">.</span> <span class="bound">j</span> <span class="main">&lt;</span> <span class="numeral">2</span> <span class="main">^</span> <span class="skolem">t</span><span class="main">}</span>›</span></span>
            <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">j</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">x</span> <span class="main">=</span> <span class="main">1</span> <span class="main">+</span> <span class="skolem">j</span> <span class="main">*</span> <span class="numeral">2</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">j</span> <span class="main">&lt;</span> <span class="numeral">2</span> <span class="main">^</span> <span class="skolem">t</span>›</span></span>
              <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
            <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">x</span> <span class="main">&lt;</span> <span class="numeral">2</span><span class="main">*</span><span class="main">(</span><span class="numeral">2</span><span class="main">^</span><span class="skolem">t</span><span class="main">)</span>›</span></span>
              <span class="keyword1"><span class="command">using</span></span>  <span class="quoted"><span class="quoted">‹<span class="skolem">x</span> <span class="main">=</span> <span class="main">1</span> <span class="main">+</span> <span class="skolem">j</span> <span class="main">*</span> <span class="numeral">2</span>›</span></span>  <span class="quoted"><span class="quoted">‹<span class="skolem">j</span> <span class="main">&lt;</span> <span class="numeral">2</span> <span class="main">^</span> <span class="skolem">t</span>›</span></span>
              <span class="keyword1"><span class="command">by</span></span> <span class="operator">linarith</span>              
            <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">x</span> <span class="main">&lt;</span> <span class="free">n</span>›</span></span>
              <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> <span class="quoted"><span class="quoted">‹<span class="free">n</span> <span class="main">=</span> <span class="numeral">2</span> <span class="main">^</span> Suc <span class="skolem">t</span>›</span></span><span class="main">)</span>
            <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹coprime <span class="skolem">x</span> <span class="free">n</span>›</span></span>
              <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> <span class="main"><span class="main">(</span></span>no_types<span class="main"><span class="main">)</span></span> <span class="quoted"><span class="quoted">‹<span class="main">⋀</span><span class="bound">thesis</span><span class="main">.</span> <span class="main">(</span><span class="main">⋀</span><span class="bound">j</span><span class="main">.</span> <span class="main">⟦</span><span class="skolem">x</span> <span class="main">=</span> <span class="main">1</span> <span class="main">+</span> <span class="bound">j</span> <span class="main">*</span> <span class="numeral">2</span><span class="main">;</span> <span class="bound">j</span> <span class="main">&lt;</span> <span class="numeral">2</span> <span class="main">^</span> <span class="skolem">t</span><span class="main">⟧</span> <span class="main">⟹</span> <span class="bound">thesis</span><span class="main">)</span> <span class="main">⟹</span> <span class="bound">thesis</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="free">n</span> <span class="main">=</span> <span class="numeral">2</span> <span class="main">^</span> <span class="skolem">k</span>›</span></span> coprime_Suc_left_nat coprime_mult_right_iff coprime_power_right_iff plus_1_eq_Suc<span class="main">)</span>              
            <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">x</span> <span class="main">∈</span> <span class="main">{</span><span class="bound">x</span> <span class="main">|</span><span class="bound">x</span><span class="main">.</span> <span class="bound">x</span> <span class="main">&lt;</span> <span class="free">n</span> <span class="main">∧</span> coprime <span class="bound">x</span> <span class="free">n</span><span class="main">}</span>›</span></span>
              <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
          <span class="keyword1"><span class="command">qed</span></span>
        <span class="keyword1"><span class="command">qed</span></span>
        <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹<span class="main">(</span><span class="numeral">2</span><span class="main">::</span>nat<span class="main">)</span><span class="main">^</span><span class="main">(</span><span class="skolem">t</span><span class="main">::</span>nat<span class="main">)</span> <span class="main">≠</span> <span class="main">0</span>›</span></span> 
          <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
        <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">m</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">m</span> <span class="main">=</span> <span class="main">(</span><span class="numeral">2</span><span class="main">::</span>nat<span class="main">)</span><span class="main">^</span><span class="skolem">t</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
        <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">m</span> <span class="main">≠</span> <span class="main">0</span>›</span></span> 
          <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">m</span> <span class="main">=</span> <span class="numeral">2</span> <span class="main">^</span> <span class="skolem">t</span>›</span></span> 
          <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹<span class="main">{</span><span class="bound">x</span> <span class="main">|</span> <span class="bound">x</span> <span class="main">::</span> nat<span class="main">.</span> <span class="bound">x</span> <span class="main">&lt;</span> <span class="free">n</span> <span class="main">∧</span> coprime <span class="bound">x</span> <span class="free">n</span><span class="main">}</span> <span class="main">=</span> <span class="main">{</span><span class="main">1</span><span class="main">+</span><span class="bound">j</span><span class="main">*</span><span class="numeral">2</span><span class="main">|</span> <span class="bound">j</span><span class="main">::</span>nat<span class="main">.</span> <span class="bound">j</span> <span class="main">&lt;</span> <span class="skolem">m</span><span class="main">}</span>›</span></span>
          <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">m</span> <span class="main">=</span> <span class="numeral">2</span> <span class="main">^</span> <span class="skolem">t</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="main">{</span><span class="bound">x</span> <span class="main">|</span><span class="bound">x</span><span class="main">.</span> <span class="bound">x</span> <span class="main">&lt;</span> <span class="free">n</span> <span class="main">∧</span> coprime <span class="bound">x</span> <span class="free">n</span><span class="main">}</span> <span class="main">=</span> <span class="main">{</span><span class="main">1</span> <span class="main">+</span> <span class="bound">j</span> <span class="main">*</span> <span class="numeral">2</span> <span class="main">|</span><span class="bound">j</span><span class="main">.</span> <span class="bound">j</span> <span class="main">&lt;</span> <span class="numeral">2</span> <span class="main">^</span> <span class="skolem">t</span><span class="main">}</span>›</span></span> 
          <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword1"><span class="command">from</span></span>  <span class="quoted"><span class="quoted">‹<span class="skolem">m</span> <span class="main">≠</span> <span class="main">0</span>›</span></span>  <span class="quoted"><span class="quoted">‹<span class="main">{</span><span class="bound">x</span> <span class="main">|</span> <span class="bound">x</span> <span class="main">::</span> nat<span class="main">.</span> <span class="bound">x</span> <span class="main">&lt;</span> <span class="free">n</span> <span class="main">∧</span> coprime <span class="bound">x</span> <span class="free">n</span><span class="main">}</span> <span class="main">=</span> <span class="main">{</span><span class="main">1</span><span class="main">+</span><span class="bound">j</span><span class="main">*</span><span class="numeral">2</span><span class="main">|</span> <span class="bound">j</span><span class="main">::</span>nat<span class="main">.</span> <span class="bound">j</span> <span class="main">&lt;</span> <span class="skolem">m</span><span class="main">}</span>›</span></span>
        <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
      <span class="keyword1"><span class="command">qed</span></span>
      <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound">b</span> <span class="bound">m</span><span class="main">.</span> <span class="bound">m</span> <span class="main">≠</span> <span class="main">0</span> <span class="main">∧</span> <span class="main">{</span><span class="bound">x</span> <span class="main">|</span><span class="bound">x</span><span class="main">.</span> <span class="bound">x</span> <span class="main">&lt;</span> <span class="free">n</span> <span class="main">∧</span> coprime <span class="bound">x</span> <span class="free">n</span><span class="main">}</span> <span class="main">=</span> <span class="main">{</span><span class="main">1</span> <span class="main">+</span> <span class="bound">j</span> <span class="main">*</span> <span class="bound">b</span> <span class="main">|</span><span class="bound">j</span><span class="main">.</span> <span class="bound">j</span> <span class="main">&lt;</span> <span class="bound">m</span><span class="main">}</span>"</span></span>
        <span class="keyword2"><span class="keyword">if</span></span> <span class="quoted"><span class="quoted">"<span class="free">n</span> <span class="main">=</span> <span class="numeral">6</span>"</span></span>
      <span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
        <span class="keyword1"><span class="command">have</span></span>  <span class="quoted"><span class="quoted">‹<span class="main">{</span><span class="bound">x</span> <span class="main">|</span> <span class="bound">x</span><span class="main">.</span> <span class="bound">x</span> <span class="main">&lt;</span> <span class="numeral">6</span> <span class="main">∧</span> coprime <span class="bound">x</span> <span class="numeral">6</span><span class="main">}</span> <span class="main">=</span> <span class="main">{</span><span class="main">1</span><span class="main">+</span><span class="bound">j</span><span class="main">*</span><span class="numeral">4</span><span class="main">|</span> <span class="bound">j</span><span class="main">::</span>nat<span class="main">.</span> <span class="bound">j</span> <span class="main">&lt;</span> <span class="numeral">2</span><span class="main">}</span>›</span></span>
        <span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
          <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹<span class="main">{</span><span class="bound">x</span> <span class="main">|</span> <span class="bound">x</span><span class="main">::</span>nat<span class="main">.</span> <span class="bound">x</span> <span class="main">&lt;</span> <span class="numeral">6</span> <span class="main">∧</span> coprime <span class="bound">x</span> <span class="numeral">6</span><span class="main">}</span> <span class="main">=</span> <span class="main">{</span><span class="main">1</span><span class="main">,</span> <span class="numeral">5</span><span class="main">}</span>›</span></span>
          <span class="keyword1"><span class="command">proof</span></span>
            <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">{</span><span class="bound">u</span><span class="main">.</span> <span class="main">∃</span><span class="bound">x</span><span class="main">.</span> <span class="bound">u</span> <span class="main">=</span> <span class="main">(</span><span class="bound">x</span><span class="main">::</span>nat<span class="main">)</span> <span class="main">∧</span> <span class="bound">x</span> <span class="main">&lt;</span> <span class="numeral">6</span> <span class="main">∧</span> coprime <span class="bound">x</span> <span class="numeral">6</span><span class="main">}</span> <span class="main">⊆</span> <span class="main">{</span><span class="main">1</span><span class="main">,</span> <span class="numeral">5</span><span class="main">}</span>"</span></span>
            <span class="keyword1"><span class="command">proof</span></span>
              <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">u</span><span class="main">::</span><span class="quoted">nat</span>
              <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">u</span> <span class="main">∈</span> <span class="main">{</span><span class="bound">u</span><span class="main">.</span> <span class="main">∃</span><span class="bound">x</span><span class="main">.</span> <span class="bound">u</span> <span class="main">=</span> <span class="bound">x</span> <span class="main">∧</span> <span class="bound">x</span> <span class="main">&lt;</span> <span class="numeral">6</span> <span class="main">∧</span> coprime <span class="bound">x</span> <span class="numeral">6</span><span class="main">}</span>›</span></span>
              <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">‹coprime <span class="skolem">u</span> <span class="numeral">6</span>›</span></span>
                <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
              <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">u</span> <span class="main">&lt;</span> <span class="numeral">6</span>›</span></span>
                <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">u</span> <span class="main">∈</span> <span class="main">{</span><span class="bound">u</span><span class="main">.</span> <span class="main">∃</span><span class="bound">x</span><span class="main">.</span> <span class="bound">u</span> <span class="main">=</span> <span class="bound">x</span> <span class="main">∧</span> <span class="bound">x</span> <span class="main">&lt;</span> <span class="numeral">6</span> <span class="main">∧</span> coprime <span class="bound">x</span> <span class="numeral">6</span><span class="main">}</span>›</span></span>
                <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
              <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">u</span> <span class="main">≠</span> <span class="main">0</span>›</span></span>
                <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹coprime <span class="skolem">u</span> <span class="numeral">6</span>›</span></span> ord_eq_0 
                <span class="keyword1"><span class="command">by</span></span> <span class="operator">fastforce</span>
              <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">u</span> <span class="main">≠</span> <span class="numeral">2</span>›</span></span>
                <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹coprime <span class="skolem">u</span> <span class="numeral">6</span>›</span></span>
                <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
              <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">u</span> <span class="main">≠</span> <span class="numeral">3</span>›</span></span>
              <span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
                <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹gcd <span class="main">(</span><span class="numeral">3</span><span class="main">::</span>nat<span class="main">)</span> <span class="numeral">6</span> <span class="main">=</span> <span class="numeral">3</span>›</span></span>
                  <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
                <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> 
                  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> <span class="main"><span class="main">(</span></span>no_types<span class="main"><span class="main">)</span></span> <span class="quoted"><span class="quoted">‹coprime <span class="skolem">u</span> <span class="numeral">6</span>›</span></span> <span class="quoted"><span class="quoted">‹gcd <span class="numeral">3</span> <span class="numeral">6</span> <span class="main">=</span> <span class="numeral">3</span>›</span></span> coprime_iff_gcd_eq_1 
                      numeral_eq_one_iff semiring_norm<span class="main"><span class="main">(</span></span>86<span class="main"><span class="main">)</span></span><span class="main">)</span>
              <span class="keyword1"><span class="command">qed</span></span>
              <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">u</span> <span class="main">≠</span> <span class="numeral">4</span>›</span></span>
              <span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
                <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹gcd <span class="main">(</span><span class="numeral">4</span><span class="main">::</span>nat<span class="main">)</span> <span class="numeral">6</span> <span class="main">=</span> <span class="numeral">2</span>›</span></span>
                  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> <span class="main"><span class="main">(</span></span>no_types<span class="main"><span class="main">,</span></span> lifting<span class="main"><span class="main">)</span></span> add_numeral_left gcd_add1 gcd_add2 gcd_nat.idem
                      numeral_Bit0 numeral_One one_plus_numeral semiring_norm<span class="main"><span class="main">(</span></span>4<span class="main"><span class="main">)</span></span> semiring_norm<span class="main"><span class="main">(</span></span>5<span class="main"><span class="main">)</span></span><span class="main">)</span>
                <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
                  <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹coprime <span class="skolem">u</span> <span class="numeral">6</span>›</span></span> coprime_iff_gcd_eq_1 
                  <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span> 
              <span class="keyword1"><span class="command">qed</span></span>
              <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">u</span> <span class="main">=</span> <span class="main">1</span> <span class="main">∨</span> <span class="skolem">u</span> <span class="main">=</span> <span class="numeral">5</span>›</span></span>
                <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
              <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">u</span> <span class="main">∈</span> <span class="main">{</span><span class="main">1</span><span class="main">,</span> <span class="numeral">5</span><span class="main">}</span>›</span></span>
                <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
            <span class="keyword1"><span class="command">qed</span></span>
            <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">{</span><span class="main">1</span><span class="main">::</span>nat<span class="main">,</span> <span class="numeral">5</span><span class="main">}</span> <span class="main">⊆</span> <span class="main">{</span><span class="bound">x</span> <span class="main">|</span><span class="bound">x</span><span class="main">.</span> <span class="bound">x</span> <span class="main">&lt;</span> <span class="numeral">6</span> <span class="main">∧</span> coprime <span class="bound">x</span> <span class="numeral">6</span><span class="main">}</span>"</span></span>
            <span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
              <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹<span class="main">(</span><span class="main">1</span><span class="main">::</span>nat<span class="main">)</span> <span class="main">∈</span> <span class="main">{</span><span class="bound">x</span> <span class="main">|</span><span class="bound">x</span><span class="main">.</span> <span class="bound">x</span> <span class="main">&lt;</span> <span class="numeral">6</span> <span class="main">∧</span> coprime <span class="bound">x</span> <span class="numeral">6</span><span class="main">}</span>›</span></span>
                <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>                
              <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹<span class="main">(</span><span class="numeral">5</span><span class="main">::</span>nat<span class="main">)</span> <span class="main">∈</span> <span class="main">{</span><span class="bound">x</span> <span class="main">|</span><span class="bound">x</span><span class="main">.</span> <span class="bound">x</span> <span class="main">&lt;</span> <span class="numeral">6</span> <span class="main">∧</span> coprime <span class="bound">x</span> <span class="numeral">6</span><span class="main">}</span>›</span></span>
                <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> Suc_numeral coprime_Suc_right_nat less_add_one mem_Collect_eq
                    numeral_plus_one semiring_norm<span class="main"><span class="main">(</span></span>5<span class="main"><span class="main">)</span></span> semiring_norm<span class="main"><span class="main">(</span></span>8<span class="main"><span class="main">)</span></span><span class="main">)</span>                
              <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> 
                <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
            <span class="keyword1"><span class="command">qed</span></span>
          <span class="keyword1"><span class="command">qed</span></span>
          <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹<span class="main">{</span><span class="main">1</span><span class="main">+</span><span class="bound">j</span><span class="main">*</span><span class="numeral">4</span><span class="main">|</span> <span class="bound">j</span><span class="main">::</span>nat<span class="main">.</span> <span class="bound">j</span> <span class="main">&lt;</span> <span class="numeral">2</span><span class="main">}</span> <span class="main">=</span> <span class="main">{</span><span class="main">1</span><span class="main">,</span> <span class="numeral">5</span><span class="main">}</span>›</span></span>
            <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
          <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword1"><span class="command">qed</span></span>
        <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹<span class="main">(</span><span class="numeral">2</span><span class="main">::</span>nat<span class="main">)</span> <span class="main">≠</span> <span class="main">0</span>›</span></span>
          <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>          
        <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹<span class="main">∃</span> <span class="bound">m</span><span class="main">.</span>  <span class="bound">m</span> <span class="main">≠</span> <span class="main">0</span> <span class="main">∧</span> <span class="main">{</span><span class="bound">x</span> <span class="main">|</span> <span class="bound">x</span> <span class="main">::</span> nat<span class="main">.</span> <span class="bound">x</span> <span class="main">&lt;</span> <span class="numeral">6</span> <span class="main">∧</span> coprime <span class="bound">x</span> <span class="numeral">6</span><span class="main">}</span> <span class="main">=</span> <span class="main">{</span><span class="main">1</span><span class="main">+</span><span class="bound">j</span><span class="main">*</span><span class="numeral">4</span><span class="main">|</span> <span class="bound">j</span><span class="main">::</span>nat<span class="main">.</span> <span class="bound">j</span> <span class="main">&lt;</span> <span class="bound">m</span><span class="main">}</span>›</span></span>
          <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
        <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
          <span class="keyword1"><span class="command">using</span></span> that 
          <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span> 
      <span class="keyword1"><span class="command">qed</span></span>
      <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
        <span class="keyword1"><span class="command">using</span></span> that 
        <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span> 
    <span class="keyword1"><span class="command">qed</span></span>
    <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"prime <span class="free">n</span> <span class="main">∨</span> <span class="main">(</span><span class="main">∃</span><span class="bound">k</span><span class="main">.</span> <span class="free">n</span> <span class="main">=</span> <span class="numeral">2</span> <span class="main">^</span> <span class="bound">k</span><span class="main">)</span> <span class="main">∨</span> <span class="free">n</span> <span class="main">=</span> <span class="numeral">6</span>"</span></span>
      <span class="keyword2"><span class="keyword">if</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound">b</span> <span class="bound">m</span><span class="main">.</span> <span class="bound">m</span> <span class="main">≠</span> <span class="main">0</span> <span class="main">∧</span> <span class="main">{</span><span class="bound">x</span> <span class="main">|</span><span class="bound">x</span><span class="main">.</span> <span class="bound">x</span> <span class="main">&lt;</span> <span class="free">n</span> <span class="main">∧</span> coprime <span class="bound">x</span> <span class="free">n</span><span class="main">}</span> <span class="main">=</span> <span class="main">{</span><span class="main">1</span> <span class="main">+</span> <span class="bound">j</span> <span class="main">*</span> <span class="bound">b</span> <span class="main">|</span><span class="bound">j</span><span class="main">.</span> <span class="bound">j</span> <span class="main">&lt;</span> <span class="bound">m</span><span class="main">}</span>"</span></span>
    <span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
      <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">b</span></span> <span class="skolem"><span class="skolem">m</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">m</span> <span class="main">≠</span> <span class="main">0</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹<span class="main">{</span><span class="bound">x</span> <span class="main">|</span><span class="bound">x</span><span class="main">.</span> <span class="bound">x</span> <span class="main">&lt;</span> <span class="free">n</span> <span class="main">∧</span> coprime <span class="bound">x</span> <span class="free">n</span><span class="main">}</span> <span class="main">=</span> <span class="main">{</span><span class="main">1</span> <span class="main">+</span> <span class="bound">j</span> <span class="main">*</span> <span class="skolem">b</span> <span class="main">|</span><span class="bound">j</span><span class="main">.</span> <span class="bound">j</span> <span class="main">&lt;</span> <span class="skolem">m</span><span class="main">}</span>›</span></span>
        <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="main">∃</span><span class="bound">b</span> <span class="bound">m</span><span class="main">.</span> <span class="bound">m</span> <span class="main">≠</span> <span class="main">0</span> <span class="main">∧</span> <span class="main">{</span><span class="bound">x</span> <span class="main">|</span><span class="bound">x</span><span class="main">.</span> <span class="bound">x</span> <span class="main">&lt;</span> <span class="free">n</span> <span class="main">∧</span> coprime <span class="bound">x</span> <span class="free">n</span><span class="main">}</span> <span class="main">=</span> <span class="main">{</span><span class="main">1</span> <span class="main">+</span> <span class="bound">j</span> <span class="main">*</span> <span class="bound">b</span> <span class="main">|</span><span class="bound">j</span><span class="main">.</span> <span class="bound">j</span> <span class="main">&lt;</span> <span class="bound">m</span><span class="main">}</span>›</span></span> 
        <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
      <span class="keyword1"><span class="command">proof</span></span><span class="main">(</span><span class="operator">cases</span> <span class="quoted"><span class="quoted">‹<span class="free">n</span> <span class="main">=</span> <span class="numeral">2</span>›</span></span><span class="main">)</span>
        <span class="keyword3"><span class="command">case</span></span> True
        <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
          <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span> 
      <span class="keyword1"><span class="command">next</span></span>
        <span class="keyword3"><span class="command">case</span></span> False
        <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">b</span> <span class="main">≤</span> <span class="numeral">4</span>›</span></span>
        <span class="keyword1"><span class="command">proof</span></span><span class="main">(</span><span class="operator">cases</span> <span class="quoted"><span class="quoted">‹odd <span class="skolem">b</span>›</span></span><span class="main">)</span>
          <span class="keyword3"><span class="command">case</span></span> True
          <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
          <span class="keyword1"><span class="command">proof</span></span><span class="main">(</span><span class="operator">rule</span> classical<span class="main">)</span>
            <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">‹<span class="main">¬</span><span class="main">(</span><span class="skolem">b</span> <span class="main">≤</span> <span class="numeral">4</span><span class="main">)</span>›</span></span>
            <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">b</span> <span class="main">&gt;</span> <span class="numeral">4</span>›</span></span> 
              <span class="keyword1"><span class="command">using</span></span> le_less_linear 
              <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
            <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">m</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">m</span> <span class="main">≠</span> <span class="main">0</span>›</span></span> 
              <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹<span class="main">{</span><span class="bound">x</span> <span class="main">|</span> <span class="bound">x</span> <span class="main">::</span> nat<span class="main">.</span> <span class="bound">x</span> <span class="main">&lt;</span> <span class="free">n</span> <span class="main">∧</span> coprime <span class="bound">x</span> <span class="free">n</span><span class="main">}</span> <span class="main">=</span> <span class="main">{</span><span class="main">1</span><span class="main">+</span><span class="bound">j</span><span class="main">*</span><span class="skolem">b</span><span class="main">|</span> <span class="bound">j</span><span class="main">::</span>nat<span class="main">.</span> <span class="bound">j</span> <span class="main">&lt;</span> <span class="skolem">m</span><span class="main">}</span>›</span></span>
              <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">m</span> <span class="main">≠</span> <span class="main">0</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="main">{</span><span class="bound">x</span> <span class="main">|</span><span class="bound">x</span><span class="main">.</span> <span class="bound">x</span> <span class="main">&lt;</span> <span class="free">n</span> <span class="main">∧</span> coprime <span class="bound">x</span> <span class="free">n</span><span class="main">}</span> <span class="main">=</span> <span class="main">{</span><span class="main">1</span> <span class="main">+</span> <span class="bound">j</span> <span class="main">*</span> <span class="skolem">b</span> <span class="main">|</span><span class="bound">j</span><span class="main">.</span> <span class="bound">j</span> <span class="main">&lt;</span> <span class="skolem">m</span><span class="main">}</span>›</span></span> 
              <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
            <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">b</span> <span class="main">≠</span> <span class="main">0</span>›</span></span> 
              <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="numeral">4</span> <span class="main">&lt;</span> <span class="skolem">b</span>›</span></span> 
              <span class="keyword1"><span class="command">by</span></span> <span class="operator">linarith</span>
            <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹<span class="free">n</span> <span class="main">=</span> <span class="numeral">2</span> <span class="main">+</span> <span class="main">(</span><span class="skolem">m</span><span class="main">-</span><span class="main">1</span><span class="main">)</span><span class="main">*</span><span class="skolem">b</span>›</span></span> 
            <span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
              <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹<span class="free">n</span><span class="main">-</span><span class="main">1</span> <span class="main">∈</span> <span class="main">{</span><span class="bound">x</span> <span class="main">|</span> <span class="bound">x</span> <span class="main">::</span> nat<span class="main">.</span> <span class="bound">x</span> <span class="main">&lt;</span> <span class="free">n</span> <span class="main">∧</span> coprime <span class="bound">x</span> <span class="free">n</span><span class="main">}</span>›</span></span> 
                <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="main">1</span> <span class="main">&lt;</span> <span class="free">n</span>›</span></span> coprime_diff_one_left_nat 
                <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
              <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹<span class="free">n</span><span class="main">-</span><span class="main">1</span> <span class="main">∈</span> <span class="main">{</span><span class="main">1</span><span class="main">+</span><span class="bound">j</span><span class="main">*</span><span class="skolem">b</span><span class="main">|</span> <span class="bound">j</span><span class="main">::</span>nat<span class="main">.</span> <span class="bound">j</span> <span class="main">&lt;</span> <span class="skolem">m</span><span class="main">}</span>›</span></span> 
                <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="free">n</span> <span class="main">-</span> <span class="main">1</span> <span class="main">∈</span> <span class="main">{</span><span class="bound">x</span> <span class="main">|</span><span class="bound">x</span><span class="main">.</span> <span class="bound">x</span> <span class="main">&lt;</span> <span class="free">n</span> <span class="main">∧</span> coprime <span class="bound">x</span> <span class="free">n</span><span class="main">}</span>›</span></span> 
                  <span class="quoted"><span class="quoted">‹<span class="main">{</span><span class="bound">x</span> <span class="main">|</span><span class="bound">x</span><span class="main">.</span> <span class="bound">x</span> <span class="main">&lt;</span> <span class="free">n</span> <span class="main">∧</span> coprime <span class="bound">x</span> <span class="free">n</span><span class="main">}</span> <span class="main">=</span> <span class="main">{</span><span class="main">1</span> <span class="main">+</span> <span class="bound">j</span> <span class="main">*</span> <span class="skolem">b</span> <span class="main">|</span><span class="bound">j</span><span class="main">.</span> <span class="bound">j</span> <span class="main">&lt;</span> <span class="skolem">m</span><span class="main">}</span>›</span></span> 
                <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
              <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">i</span></span><span class="main">::</span><span class="quoted">nat</span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">‹<span class="free">n</span><span class="main">-</span><span class="main">1</span> <span class="main">=</span> <span class="main">1</span><span class="main">+</span><span class="skolem">i</span><span class="main">*</span><span class="skolem">b</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">i</span> <span class="main">&lt;</span> <span class="skolem">m</span>›</span></span> 
                <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
              <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">i</span> <span class="main">≤</span> <span class="skolem">m</span><span class="main">-</span><span class="main">1</span>›</span></span> 
                <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">i</span> <span class="main">&lt;</span> <span class="skolem">m</span>›</span></span> 
                <span class="keyword1"><span class="command">by</span></span> <span class="operator">linarith</span>
              <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹<span class="main">1</span> <span class="main">+</span> <span class="main">(</span><span class="skolem">m</span><span class="main">-</span><span class="main">1</span><span class="main">)</span><span class="main">*</span><span class="skolem">b</span> <span class="main">∈</span> <span class="main">{</span><span class="main">1</span><span class="main">+</span><span class="bound">j</span><span class="main">*</span><span class="skolem">b</span><span class="main">|</span> <span class="bound">j</span><span class="main">::</span>nat<span class="main">.</span> <span class="bound">j</span> <span class="main">&lt;</span> <span class="skolem">m</span><span class="main">}</span>›</span></span> 
                <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">m</span> <span class="main">≠</span> <span class="main">0</span>›</span></span> 
                <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
              <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">‹<span class="main">1</span> <span class="main">+</span> <span class="main">(</span><span class="skolem">m</span><span class="main">-</span><span class="main">1</span><span class="main">)</span><span class="main">*</span><span class="skolem">b</span> <span class="main">∈</span> <span class="main">{</span><span class="bound">x</span> <span class="main">|</span> <span class="bound">x</span><span class="main">::</span>nat<span class="main">.</span> <span class="bound">x</span> <span class="main">&lt;</span> <span class="free">n</span> <span class="main">∧</span> coprime <span class="bound">x</span> <span class="free">n</span><span class="main">}</span>›</span></span> 
                <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="main">{</span><span class="bound">x</span> <span class="main">|</span><span class="bound">x</span><span class="main">.</span> <span class="bound">x</span> <span class="main">&lt;</span> <span class="free">n</span> <span class="main">∧</span> coprime <span class="bound">x</span> <span class="free">n</span><span class="main">}</span> <span class="main">=</span> <span class="main">{</span><span class="main">1</span> <span class="main">+</span> <span class="bound">j</span> <span class="main">*</span> <span class="skolem">b</span> <span class="main">|</span><span class="bound">j</span><span class="main">.</span> <span class="bound">j</span> <span class="main">&lt;</span> <span class="skolem">m</span><span class="main">}</span>›</span></span> 
                <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
              <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">‹<span class="main">1</span> <span class="main">+</span> <span class="main">(</span><span class="skolem">m</span><span class="main">-</span><span class="main">1</span><span class="main">)</span><span class="main">*</span><span class="skolem">b</span> <span class="main">&lt;</span> <span class="free">n</span>›</span></span> 
                <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
              <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">‹<span class="main">1</span> <span class="main">+</span> <span class="main">(</span><span class="skolem">m</span><span class="main">-</span><span class="main">1</span><span class="main">)</span><span class="main">*</span><span class="skolem">b</span> <span class="main">≤</span> <span class="free">n</span><span class="main">-</span><span class="main">1</span>›</span></span> 
                <span class="keyword1"><span class="command">by</span></span> <span class="operator">linarith</span>
              <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">‹<span class="main">1</span> <span class="main">+</span> <span class="main">(</span><span class="skolem">m</span><span class="main">-</span><span class="main">1</span><span class="main">)</span><span class="main">*</span><span class="skolem">b</span> <span class="main">≤</span> <span class="main">1</span><span class="main">+</span><span class="skolem">i</span><span class="main">*</span><span class="skolem">b</span>›</span></span> 
                <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="free">n</span> <span class="main">-</span> <span class="main">1</span> <span class="main">=</span> <span class="main">1</span> <span class="main">+</span> <span class="skolem">i</span> <span class="main">*</span> <span class="skolem">b</span>›</span></span> 
                <span class="keyword1"><span class="command">by</span></span> <span class="operator">linarith</span>
              <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">‹<span class="main">(</span><span class="skolem">m</span><span class="main">-</span><span class="main">1</span><span class="main">)</span><span class="main">*</span><span class="skolem">b</span> <span class="main">≤</span> <span class="skolem">i</span><span class="main">*</span><span class="skolem">b</span>›</span></span> 
                <span class="keyword1"><span class="command">by</span></span> <span class="operator">linarith</span>
              <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">m</span><span class="main">-</span><span class="main">1</span> <span class="main">≤</span> <span class="skolem">i</span>›</span></span> 
                <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">b</span> <span class="main">≠</span> <span class="main">0</span>›</span></span> 
                <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
              <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">m</span><span class="main">-</span><span class="main">1</span> <span class="main">=</span> <span class="skolem">i</span>›</span></span> 
                <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">i</span> <span class="main">≤</span> <span class="skolem">m</span> <span class="main">-</span> <span class="main">1</span>›</span></span> le_antisym 
                <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
              <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> 
                <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">m</span> <span class="main">≠</span> <span class="main">0</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="free">n</span> <span class="main">-</span> <span class="main">1</span> <span class="main">=</span> <span class="main">1</span> <span class="main">+</span> <span class="skolem">i</span> <span class="main">*</span> <span class="skolem">b</span>›</span></span> 
                <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
            <span class="keyword1"><span class="command">qed</span></span>
            <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">m</span> <span class="main">≥</span> <span class="numeral">2</span>›</span></span> 
              <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="free">n</span> <span class="main">=</span> <span class="numeral">2</span> <span class="main">+</span> <span class="main">(</span><span class="skolem">m</span> <span class="main">-</span> <span class="main">1</span><span class="main">)</span><span class="main">*</span><span class="skolem">b</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="free">n</span> <span class="main">≠</span> <span class="numeral">2</span>›</span></span> 
              <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
            <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">‹<span class="main">1</span><span class="main">+</span><span class="skolem">b</span> <span class="main">∈</span> <span class="main">{</span><span class="main">1</span><span class="main">+</span><span class="bound">j</span><span class="main">*</span><span class="skolem">b</span><span class="main">|</span> <span class="bound">j</span><span class="main">.</span> <span class="bound">j</span> <span class="main">&lt;</span> <span class="skolem">m</span><span class="main">}</span>›</span></span> 
              <span class="keyword1"><span class="command">by</span></span> <span class="operator">fastforce</span>
            <span class="keyword1"><span class="command">hence</span></span>  <span class="quoted"><span class="quoted">‹<span class="main">1</span><span class="main">+</span><span class="skolem">b</span> <span class="main">∈</span> <span class="main">{</span><span class="bound">x</span> <span class="main">|</span> <span class="bound">x</span><span class="main">::</span>nat<span class="main">.</span> <span class="bound">x</span> <span class="main">&lt;</span> <span class="free">n</span> <span class="main">∧</span> coprime <span class="bound">x</span> <span class="free">n</span><span class="main">}</span>›</span></span>
              <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="main">{</span><span class="bound">x</span> <span class="main">|</span><span class="bound">x</span><span class="main">.</span> <span class="bound">x</span> <span class="main">&lt;</span> <span class="free">n</span> <span class="main">∧</span> coprime <span class="bound">x</span> <span class="free">n</span><span class="main">}</span> <span class="main">=</span> <span class="main">{</span><span class="main">1</span> <span class="main">+</span> <span class="bound">j</span> <span class="main">*</span> <span class="skolem">b</span> <span class="main">|</span><span class="bound">j</span><span class="main">.</span> <span class="bound">j</span> <span class="main">&lt;</span> <span class="skolem">m</span><span class="main">}</span>›</span></span> 
              <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
            <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">‹coprime <span class="main">(</span><span class="main">1</span><span class="main">+</span><span class="skolem">b</span><span class="main">)</span> <span class="free">n</span>›</span></span> 
              <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
            <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹<span class="main">(</span><span class="numeral">2</span><span class="main">::</span>nat<span class="main">)</span> <span class="keyword1">dvd</span> <span class="main">(</span><span class="main">1</span><span class="main">+</span><span class="skolem">b</span><span class="main">)</span>›</span></span> 
              <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹odd <span class="skolem">b</span>›</span></span> 
              <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
            <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">‹coprime <span class="main">(</span><span class="numeral">2</span><span class="main">::</span>nat<span class="main">)</span> <span class="free">n</span>›</span></span> 
              <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹coprime <span class="main">(</span><span class="main">1</span> <span class="main">+</span> <span class="skolem">b</span><span class="main">)</span> <span class="free">n</span>›</span></span> coprime_common_divisor coprime_left_2_iff_odd odd_one 
              <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
            <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹<span class="main">(</span><span class="numeral">2</span><span class="main">::</span>nat<span class="main">)</span> <span class="main">&lt;</span> <span class="free">n</span>›</span></span> 
              <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="main">1</span> <span class="main">&lt;</span> <span class="free">n</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="free">n</span> <span class="main">≠</span> <span class="numeral">2</span>›</span></span> 
              <span class="keyword1"><span class="command">by</span></span> <span class="operator">linarith</span>
            <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹<span class="numeral">2</span> <span class="main">∈</span> <span class="main">{</span><span class="bound">x</span> <span class="main">|</span> <span class="bound">x</span> <span class="main">::</span> nat<span class="main">.</span> <span class="bound">x</span> <span class="main">&lt;</span> <span class="free">n</span> <span class="main">∧</span> coprime <span class="bound">x</span> <span class="free">n</span><span class="main">}</span>›</span></span> 
              <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="numeral">2</span> <span class="main">&lt;</span> <span class="free">n</span>›</span></span> <span class="quoted"><span class="quoted">‹coprime <span class="numeral">2</span> <span class="free">n</span>›</span></span> 
              <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span> 
            <span class="keyword1"><span class="command">hence</span></span>  <span class="quoted"><span class="quoted">‹<span class="numeral">2</span> <span class="main">∈</span> <span class="main">{</span><span class="main">1</span><span class="main">+</span><span class="bound">j</span><span class="main">*</span><span class="skolem">b</span><span class="main">|</span> <span class="bound">j</span><span class="main">::</span>nat<span class="main">.</span> <span class="bound">j</span> <span class="main">&lt;</span> <span class="skolem">m</span><span class="main">}</span>›</span></span> 
              <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="main">{</span><span class="bound">x</span> <span class="main">|</span><span class="bound">x</span><span class="main">.</span> <span class="bound">x</span> <span class="main">&lt;</span> <span class="free">n</span> <span class="main">∧</span> coprime <span class="bound">x</span> <span class="free">n</span><span class="main">}</span> <span class="main">=</span> <span class="main">{</span><span class="main">1</span> <span class="main">+</span> <span class="bound">j</span> <span class="main">*</span> <span class="skolem">b</span> <span class="main">|</span><span class="bound">j</span><span class="main">.</span> <span class="bound">j</span> <span class="main">&lt;</span> <span class="skolem">m</span><span class="main">}</span>›</span></span> 
              <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
            <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">j</span></span><span class="main">::</span><span class="quoted">nat</span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">‹<span class="numeral">2</span> <span class="main">=</span> <span class="main">1</span><span class="main">+</span><span class="skolem">j</span><span class="main">*</span><span class="skolem">b</span>›</span></span> 
              <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span> 
            <span class="keyword1"><span class="command">have</span></span>  <span class="quoted"><span class="quoted">‹<span class="main">1</span> <span class="main">=</span> <span class="skolem">j</span><span class="main">*</span><span class="skolem">b</span>›</span></span> 
              <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="numeral">2</span> <span class="main">=</span> <span class="main">1</span><span class="main">+</span><span class="skolem">j</span><span class="main">*</span><span class="skolem">b</span>›</span></span>
              <span class="keyword1"><span class="command">by</span></span> <span class="operator">linarith</span>
            <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> 
              <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
          <span class="keyword1"><span class="command">qed</span></span>
        <span class="keyword1"><span class="command">next</span></span>
          <span class="keyword3"><span class="command">case</span></span> False
          <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">‹even <span class="skolem">b</span>›</span></span>
            <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
          <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
          <span class="keyword1"><span class="command">proof</span></span><span class="main">(</span><span class="operator">rule</span> classical<span class="main">)</span>
            <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">‹<span class="main">¬</span><span class="main">(</span><span class="skolem">b</span> <span class="main">≤</span> <span class="numeral">4</span><span class="main">)</span>›</span></span>
            <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">b</span> <span class="main">&gt;</span> <span class="numeral">4</span>›</span></span> 
              <span class="keyword1"><span class="command">using</span></span> le_less_linear 
              <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
            <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">m</span></span> <span class="keyword2"><span class="keyword">where</span></span>  <span class="quoted"><span class="quoted">‹ <span class="skolem">m</span> <span class="main">≠</span> <span class="main">0</span>›</span></span>
              <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹<span class="main">{</span><span class="bound">x</span> <span class="main">|</span> <span class="bound">x</span><span class="main">::</span>nat<span class="main">.</span> <span class="bound">x</span> <span class="main">&lt;</span> <span class="free">n</span> <span class="main">∧</span> coprime <span class="bound">x</span> <span class="free">n</span><span class="main">}</span> <span class="main">=</span> <span class="main">{</span><span class="main">1</span><span class="main">+</span><span class="bound">j</span><span class="main">*</span><span class="skolem">b</span><span class="main">|</span> <span class="bound">j</span><span class="main">::</span>nat<span class="main">.</span> <span class="bound">j</span> <span class="main">&lt;</span> <span class="skolem">m</span><span class="main">}</span>›</span></span>
              <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">m</span> <span class="main">≠</span> <span class="main">0</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="main">{</span><span class="bound">x</span> <span class="main">|</span><span class="bound">x</span><span class="main">.</span> <span class="bound">x</span> <span class="main">&lt;</span> <span class="free">n</span> <span class="main">∧</span> coprime <span class="bound">x</span> <span class="free">n</span><span class="main">}</span> <span class="main">=</span> <span class="main">{</span><span class="main">1</span> <span class="main">+</span> <span class="bound">j</span> <span class="main">*</span> <span class="skolem">b</span> <span class="main">|</span><span class="bound">j</span><span class="main">.</span> <span class="bound">j</span> <span class="main">&lt;</span> <span class="skolem">m</span><span class="main">}</span>›</span></span> 
              <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
            <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">b</span> <span class="main">≠</span> <span class="main">0</span>›</span></span> 
              <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="numeral">4</span> <span class="main">&lt;</span> <span class="skolem">b</span>›</span></span> 
              <span class="keyword1"><span class="command">by</span></span> <span class="operator">linarith</span>
            <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹<span class="free">n</span> <span class="main">=</span> <span class="numeral">2</span> <span class="main">+</span> <span class="main">(</span><span class="skolem">m</span><span class="main">-</span><span class="main">1</span><span class="main">)</span><span class="main">*</span><span class="skolem">b</span>›</span></span> 
            <span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
              <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹<span class="free">n</span><span class="main">-</span><span class="main">1</span> <span class="main">∈</span> <span class="main">{</span><span class="bound">x</span> <span class="main">|</span> <span class="bound">x</span><span class="main">::</span>nat<span class="main">.</span> <span class="bound">x</span> <span class="main">&lt;</span> <span class="free">n</span> <span class="main">∧</span> coprime <span class="bound">x</span> <span class="free">n</span><span class="main">}</span>›</span></span> 
                <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="main">1</span> <span class="main">&lt;</span> <span class="free">n</span>›</span></span> coprime_diff_one_left_nat 
                <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
              <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹<span class="free">n</span><span class="main">-</span><span class="main">1</span> <span class="main">∈</span> <span class="main">{</span><span class="main">1</span><span class="main">+</span><span class="bound">j</span><span class="main">*</span><span class="skolem">b</span><span class="main">|</span> <span class="bound">j</span><span class="main">::</span>nat<span class="main">.</span> <span class="bound">j</span> <span class="main">&lt;</span> <span class="skolem">m</span><span class="main">}</span>›</span></span> 
                <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="free">n</span> <span class="main">-</span> <span class="main">1</span> <span class="main">∈</span> <span class="main">{</span><span class="bound">x</span> <span class="main">|</span><span class="bound">x</span><span class="main">.</span> <span class="bound">x</span> <span class="main">&lt;</span> <span class="free">n</span> <span class="main">∧</span> coprime <span class="bound">x</span> <span class="free">n</span><span class="main">}</span>›</span></span> 
                  <span class="quoted"><span class="quoted">‹<span class="main">{</span><span class="bound">x</span> <span class="main">|</span><span class="bound">x</span><span class="main">.</span> <span class="bound">x</span> <span class="main">&lt;</span> <span class="free">n</span> <span class="main">∧</span> coprime <span class="bound">x</span> <span class="free">n</span><span class="main">}</span> <span class="main">=</span> <span class="main">{</span><span class="main">1</span> <span class="main">+</span> <span class="bound">j</span> <span class="main">*</span> <span class="skolem">b</span> <span class="main">|</span><span class="bound">j</span><span class="main">.</span> <span class="bound">j</span> <span class="main">&lt;</span> <span class="skolem">m</span><span class="main">}</span>›</span></span> 
                <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
              <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">i</span></span><span class="main">::</span><span class="quoted">nat</span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">‹<span class="free">n</span><span class="main">-</span><span class="main">1</span> <span class="main">=</span> <span class="main">1</span><span class="main">+</span><span class="skolem">i</span><span class="main">*</span><span class="skolem">b</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">i</span> <span class="main">&lt;</span> <span class="skolem">m</span>›</span></span> 
                <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
              <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">i</span> <span class="main">≤</span> <span class="skolem">m</span><span class="main">-</span><span class="main">1</span>›</span></span> 
                <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">i</span> <span class="main">&lt;</span> <span class="skolem">m</span>›</span></span> 
                <span class="keyword1"><span class="command">by</span></span> <span class="operator">linarith</span>
              <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹<span class="main">1</span> <span class="main">+</span> <span class="main">(</span><span class="skolem">m</span><span class="main">-</span><span class="main">1</span><span class="main">)</span><span class="main">*</span><span class="skolem">b</span> <span class="main">∈</span> <span class="main">{</span><span class="main">1</span><span class="main">+</span><span class="bound">j</span><span class="main">*</span><span class="skolem">b</span><span class="main">|</span> <span class="bound">j</span><span class="main">::</span>nat<span class="main">.</span> <span class="bound">j</span> <span class="main">&lt;</span> <span class="skolem">m</span><span class="main">}</span>›</span></span> 
                <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">m</span> <span class="main">≠</span> <span class="main">0</span>›</span></span> 
                <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
              <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">‹<span class="main">1</span> <span class="main">+</span> <span class="main">(</span><span class="skolem">m</span><span class="main">-</span><span class="main">1</span><span class="main">)</span><span class="main">*</span><span class="skolem">b</span> <span class="main">∈</span> <span class="main">{</span><span class="bound">x</span> <span class="main">|</span> <span class="bound">x</span> <span class="main">::</span> nat<span class="main">.</span> <span class="bound">x</span> <span class="main">&lt;</span> <span class="free">n</span> <span class="main">∧</span> coprime <span class="bound">x</span> <span class="free">n</span><span class="main">}</span>›</span></span> 
                <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="main">{</span><span class="bound">x</span> <span class="main">|</span><span class="bound">x</span><span class="main">.</span> <span class="bound">x</span> <span class="main">&lt;</span> <span class="free">n</span> <span class="main">∧</span> coprime <span class="bound">x</span> <span class="free">n</span><span class="main">}</span> <span class="main">=</span> <span class="main">{</span><span class="main">1</span> <span class="main">+</span> <span class="bound">j</span> <span class="main">*</span> <span class="skolem">b</span> <span class="main">|</span><span class="bound">j</span><span class="main">.</span> <span class="bound">j</span> <span class="main">&lt;</span> <span class="skolem">m</span><span class="main">}</span>›</span></span> 
                <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
              <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">‹<span class="main">1</span> <span class="main">+</span> <span class="main">(</span><span class="skolem">m</span><span class="main">-</span><span class="main">1</span><span class="main">)</span><span class="main">*</span><span class="skolem">b</span> <span class="main">&lt;</span> <span class="free">n</span>›</span></span> 
                <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
              <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">‹<span class="main">1</span> <span class="main">+</span> <span class="main">(</span><span class="skolem">m</span><span class="main">-</span><span class="main">1</span><span class="main">)</span><span class="main">*</span><span class="skolem">b</span> <span class="main">≤</span> <span class="free">n</span><span class="main">-</span><span class="main">1</span>›</span></span> 
                <span class="keyword1"><span class="command">by</span></span> <span class="operator">linarith</span>
              <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">‹<span class="main">1</span> <span class="main">+</span> <span class="main">(</span><span class="skolem">m</span><span class="main">-</span><span class="main">1</span><span class="main">)</span><span class="main">*</span><span class="skolem">b</span> <span class="main">≤</span> <span class="main">1</span><span class="main">+</span><span class="skolem">i</span><span class="main">*</span><span class="skolem">b</span>›</span></span> 
                <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="free">n</span> <span class="main">-</span> <span class="main">1</span> <span class="main">=</span> <span class="main">1</span> <span class="main">+</span> <span class="skolem">i</span> <span class="main">*</span> <span class="skolem">b</span>›</span></span> 
                <span class="keyword1"><span class="command">by</span></span> <span class="operator">linarith</span>
              <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">‹<span class="main">(</span><span class="skolem">m</span><span class="main">-</span><span class="main">1</span><span class="main">)</span><span class="main">*</span><span class="skolem">b</span> <span class="main">≤</span> <span class="skolem">i</span><span class="main">*</span><span class="skolem">b</span>›</span></span> 
                <span class="keyword1"><span class="command">by</span></span> <span class="operator">linarith</span>
              <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">m</span><span class="main">-</span><span class="main">1</span> <span class="main">≤</span> <span class="skolem">i</span>›</span></span> 
                <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">b</span> <span class="main">≠</span> <span class="main">0</span>›</span></span> 
                <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
              <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">m</span><span class="main">-</span><span class="main">1</span> <span class="main">=</span> <span class="skolem">i</span>›</span></span> 
                <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">i</span> <span class="main">≤</span> <span class="skolem">m</span> <span class="main">-</span> <span class="main">1</span>›</span></span> le_antisym 
                <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
              <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> 
                <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">m</span> <span class="main">≠</span> <span class="main">0</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="free">n</span> <span class="main">-</span> <span class="main">1</span> <span class="main">=</span> <span class="main">1</span> <span class="main">+</span> <span class="skolem">i</span> <span class="main">*</span> <span class="skolem">b</span>›</span></span> 
                <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
            <span class="keyword1"><span class="command">qed</span></span>
            <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">k</span></span> <span class="main">::</span> <span class="quoted">nat</span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">b</span> <span class="main">=</span> <span class="numeral">2</span><span class="main">*</span><span class="skolem">k</span>›</span></span> 
              <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹even <span class="skolem">b</span>›</span></span>
              <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
            <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹<span class="free">n</span> <span class="main">=</span> <span class="numeral">2</span><span class="main">*</span><span class="main">(</span><span class="main">1</span> <span class="main">+</span> <span class="main">(</span><span class="skolem">m</span><span class="main">-</span><span class="main">1</span><span class="main">)</span><span class="main">*</span><span class="skolem">k</span><span class="main">)</span>›</span></span>
              <span class="keyword1"><span class="command">using</span></span>  <span class="quoted"><span class="quoted">‹<span class="free">n</span> <span class="main">=</span> <span class="numeral">2</span> <span class="main">+</span> <span class="main">(</span><span class="skolem">m</span><span class="main">-</span><span class="main">1</span><span class="main">)</span><span class="main">*</span><span class="skolem">b</span>›</span></span>  <span class="quoted"><span class="quoted">‹<span class="skolem">b</span> <span class="main">=</span> <span class="numeral">2</span><span class="main">*</span><span class="skolem">k</span>›</span></span> 
              <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
            <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
            <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">cases</span> <span class="quoted"><span class="quoted">‹odd <span class="skolem">m</span>›</span></span><span class="main">)</span>
              <span class="keyword3"><span class="command">case</span></span> True
              <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">‹odd <span class="skolem">m</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
              <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">t</span></span><span class="main">::</span><span class="quoted">nat</span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">m</span><span class="main">-</span><span class="main">1</span> <span class="main">=</span> <span class="numeral">2</span><span class="main">*</span><span class="skolem">t</span>›</span></span> 
                <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> odd_two_times_div_two_nat<span class="main">)</span>
              <span class="keyword1"><span class="command">have</span></span>  <span class="quoted"><span class="quoted">‹<span class="free">n</span> <span class="main">=</span> <span class="numeral">2</span><span class="main">*</span><span class="main">(</span><span class="main">1</span> <span class="main">+</span> <span class="skolem">b</span><span class="main">*</span><span class="skolem">t</span><span class="main">)</span>›</span></span> 
                <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">m</span> <span class="main">-</span> <span class="main">1</span> <span class="main">=</span> <span class="numeral">2</span> <span class="main">*</span> <span class="skolem">t</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="free">n</span> <span class="main">=</span> <span class="numeral">2</span> <span class="main">+</span> <span class="main">(</span><span class="skolem">m</span> <span class="main">-</span> <span class="main">1</span><span class="main">)</span> <span class="main">*</span> <span class="skolem">b</span>›</span></span> 
                <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
              <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">t</span> <span class="main">&lt;</span> <span class="skolem">m</span>›</span></span> 
                <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">m</span> <span class="main">-</span> <span class="main">1</span> <span class="main">=</span> <span class="numeral">2</span> <span class="main">*</span> <span class="skolem">t</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">m</span> <span class="main">≠</span> <span class="main">0</span>›</span></span> 
                <span class="keyword1"><span class="command">by</span></span> <span class="operator">linarith</span>
              <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹<span class="main">1</span> <span class="main">+</span> <span class="skolem">b</span><span class="main">*</span><span class="skolem">t</span> <span class="main">∈</span> <span class="main">{</span><span class="main">1</span><span class="main">+</span><span class="bound">j</span><span class="main">*</span><span class="skolem">b</span><span class="main">|</span> <span class="bound">j</span><span class="main">::</span>nat<span class="main">.</span> <span class="bound">j</span> <span class="main">&lt;</span> <span class="skolem">m</span><span class="main">}</span>›</span></span> 
                <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">t</span> <span class="main">&lt;</span> <span class="skolem">m</span>›</span></span> 
                <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span> 
              <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">‹<span class="main">1</span> <span class="main">+</span> <span class="skolem">b</span><span class="main">*</span><span class="skolem">t</span> <span class="main">∈</span> <span class="main">{</span><span class="bound">x</span> <span class="main">|</span> <span class="bound">x</span><span class="main">::</span>nat<span class="main">.</span> <span class="bound">x</span> <span class="main">&lt;</span> <span class="free">n</span> <span class="main">∧</span> coprime <span class="bound">x</span> <span class="free">n</span><span class="main">}</span>›</span></span> 
                <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="main">{</span><span class="bound">x</span> <span class="main">|</span><span class="bound">x</span><span class="main">.</span> <span class="bound">x</span> <span class="main">&lt;</span> <span class="free">n</span> <span class="main">∧</span> coprime <span class="bound">x</span> <span class="free">n</span><span class="main">}</span> <span class="main">=</span> <span class="main">{</span><span class="main">1</span> <span class="main">+</span> <span class="bound">j</span> <span class="main">*</span> <span class="skolem">b</span> <span class="main">|</span><span class="bound">j</span><span class="main">.</span> <span class="bound">j</span> <span class="main">&lt;</span> <span class="skolem">m</span><span class="main">}</span>›</span></span> 
                <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span> 
              <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">‹coprime <span class="main">(</span><span class="main">1</span> <span class="main">+</span> <span class="skolem">b</span><span class="main">*</span><span class="skolem">t</span><span class="main">)</span> <span class="free">n</span>›</span></span> 
                <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
              <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> 
                <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> <span class="main"><span class="main">(</span></span>no_types<span class="main"><span class="main">,</span></span> lifting<span class="main"><span class="main">)</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">b</span> <span class="main">=</span> <span class="numeral">2</span> <span class="main">*</span> <span class="skolem">k</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="free">n</span> <span class="main">=</span> <span class="numeral">2</span> <span class="main">*</span> <span class="main">(</span><span class="main">1</span> <span class="main">+</span> <span class="main">(</span><span class="skolem">m</span> <span class="main">-</span> <span class="main">1</span><span class="main">)</span> <span class="main">*</span> <span class="skolem">k</span><span class="main">)</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="free">n</span> <span class="main">=</span> <span class="numeral">2</span> <span class="main">*</span> <span class="main">(</span><span class="main">1</span> <span class="main">+</span> <span class="skolem">b</span> <span class="main">*</span> <span class="skolem">t</span><span class="main">)</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="free">n</span> <span class="main">=</span> <span class="numeral">2</span> <span class="main">+</span> <span class="main">(</span><span class="skolem">m</span> <span class="main">-</span> <span class="main">1</span><span class="main">)</span> <span class="main">*</span> <span class="skolem">b</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="free">n</span> <span class="main">≠</span> <span class="numeral">2</span>›</span></span> add_cancel_right_right coprime_mult_right_iff coprime_self mult_cancel_left mult_is_0 nat_dvd_1_iff_1<span class="main">)</span>
            <span class="keyword1"><span class="command">next</span></span>
              <span class="keyword3"><span class="command">case</span></span> False
              <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
              <span class="keyword1"><span class="command">proof</span></span><span class="main">(</span><span class="operator">cases</span> <span class="quoted"><span class="quoted">‹odd <span class="skolem">k</span>›</span></span><span class="main">)</span>
                <span class="keyword3"><span class="command">case</span></span> True
                <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">‹odd <span class="skolem">k</span>›</span></span>
                  <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
                <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹even <span class="main">(</span><span class="main">1</span> <span class="main">+</span> <span class="main">(</span><span class="skolem">m</span> <span class="main">-</span> <span class="main">1</span><span class="main">)</span> <span class="main">*</span> <span class="skolem">k</span><span class="main">)</span>›</span></span> 
                  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> False True <span class="quoted"><span class="quoted">‹<span class="skolem">m</span> <span class="main">≠</span> <span class="main">0</span>›</span></span><span class="main">)</span>
                <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹coprime <span class="main">(</span><span class="numeral">2</span> <span class="main">+</span> <span class="main">(</span><span class="skolem">m</span> <span class="main">-</span> <span class="main">1</span><span class="main">)</span> <span class="main">*</span> <span class="skolem">k</span><span class="main">)</span> <span class="main">(</span><span class="main">1</span> <span class="main">+</span> <span class="main">(</span><span class="skolem">m</span> <span class="main">-</span> <span class="main">1</span><span class="main">)</span> <span class="main">*</span> <span class="skolem">k</span><span class="main">)</span>›</span></span> 
                  <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
                <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹coprime <span class="main">(</span><span class="numeral">2</span> <span class="main">+</span> <span class="main">(</span><span class="skolem">m</span> <span class="main">-</span> <span class="main">1</span><span class="main">)</span> <span class="main">*</span> <span class="skolem">k</span><span class="main">)</span> <span class="free">n</span>›</span></span> 
                  <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹coprime <span class="main">(</span><span class="numeral">2</span> <span class="main">+</span> <span class="main">(</span><span class="skolem">m</span> <span class="main">-</span> <span class="main">1</span><span class="main">)</span> <span class="main">*</span> <span class="skolem">k</span><span class="main">)</span> <span class="main">(</span><span class="main">1</span> <span class="main">+</span> <span class="main">(</span><span class="skolem">m</span> <span class="main">-</span> <span class="main">1</span><span class="main">)</span> <span class="main">*</span> <span class="skolem">k</span><span class="main">)</span>›</span></span> <span class="quoted"><span class="quoted">‹even <span class="main">(</span><span class="main">1</span> <span class="main">+</span> <span class="main">(</span><span class="skolem">m</span> <span class="main">-</span> <span class="main">1</span><span class="main">)</span> <span class="main">*</span> <span class="skolem">k</span><span class="main">)</span>›</span></span> 
                    <span class="quoted"><span class="quoted">‹<span class="free">n</span> <span class="main">=</span> <span class="numeral">2</span> <span class="main">*</span> <span class="main">(</span><span class="main">1</span> <span class="main">+</span> <span class="main">(</span><span class="skolem">m</span> <span class="main">-</span> <span class="main">1</span><span class="main">)</span> <span class="main">*</span> <span class="skolem">k</span><span class="main">)</span>›</span></span> coprime_common_divisor coprime_mult_right_iff
                    coprime_right_2_iff_odd odd_one 
                  <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
                <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹<span class="numeral">2</span> <span class="main">+</span> <span class="main">(</span><span class="skolem">m</span> <span class="main">-</span> <span class="main">1</span><span class="main">)</span> <span class="main">*</span> <span class="skolem">k</span> <span class="main">&lt;</span> <span class="free">n</span>›</span></span> 
                  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> <span class="main"><span class="main">(</span></span>no_types<span class="main"><span class="main">,</span></span> lifting<span class="main"><span class="main">)</span></span> <span class="quoted"><span class="quoted">‹even <span class="main">(</span><span class="main">1</span> <span class="main">+</span> <span class="main">(</span><span class="skolem">m</span> <span class="main">-</span> <span class="main">1</span><span class="main">)</span> <span class="main">*</span> <span class="skolem">k</span><span class="main">)</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="free">n</span> <span class="main">=</span> <span class="numeral">2</span> <span class="main">*</span> <span class="main">(</span><span class="main">1</span> <span class="main">+</span> <span class="main">(</span><span class="skolem">m</span> <span class="main">-</span> <span class="main">1</span><span class="main">)</span> <span class="main">*</span> <span class="skolem">k</span><span class="main">)</span>›</span></span>
                      add_gr_0 add_mono_thms_linordered_semiring<span class="main"><span class="main">(</span></span>1<span class="main"><span class="main">)</span></span> dvd_add_left_iff dvd_add_triv_left_iff dvd_imp_le le_add2 le_neq_implies_less less_numeral_extra<span class="main"><span class="main">(</span></span>1<span class="main"><span class="main">)</span></span> mult_2 odd_one<span class="main">)</span>
                <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹<span class="numeral">2</span> <span class="main">+</span> <span class="main">(</span><span class="skolem">m</span> <span class="main">-</span> <span class="main">1</span><span class="main">)</span> <span class="main">*</span> <span class="skolem">k</span>  <span class="main">∈</span> <span class="main">{</span><span class="bound">x</span> <span class="main">|</span> <span class="bound">x</span> <span class="main">::</span> nat<span class="main">.</span> <span class="bound">x</span> <span class="main">&lt;</span> <span class="free">n</span> <span class="main">∧</span> coprime <span class="bound">x</span> <span class="free">n</span><span class="main">}</span>›</span></span> 
                  <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="numeral">2</span> <span class="main">+</span> <span class="main">(</span><span class="skolem">m</span> <span class="main">-</span> <span class="main">1</span><span class="main">)</span> <span class="main">*</span> <span class="skolem">k</span> <span class="main">&lt;</span> <span class="free">n</span>›</span></span> <span class="quoted"><span class="quoted">‹coprime <span class="main">(</span><span class="numeral">2</span> <span class="main">+</span> <span class="main">(</span><span class="skolem">m</span> <span class="main">-</span> <span class="main">1</span><span class="main">)</span> <span class="main">*</span> <span class="skolem">k</span><span class="main">)</span> <span class="free">n</span>›</span></span> 
                  <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
                <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">‹<span class="numeral">2</span> <span class="main">+</span> <span class="main">(</span><span class="skolem">m</span> <span class="main">-</span> <span class="main">1</span><span class="main">)</span> <span class="main">*</span> <span class="skolem">k</span>  <span class="main">∈</span> <span class="main">{</span><span class="main">1</span> <span class="main">+</span> <span class="bound">j</span> <span class="main">*</span> <span class="skolem">b</span> <span class="main">|</span><span class="bound">j</span><span class="main">.</span> <span class="bound">j</span> <span class="main">&lt;</span> <span class="skolem">m</span><span class="main">}</span>›</span></span> 
                  <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="main">{</span><span class="bound">x</span> <span class="main">|</span><span class="bound">x</span><span class="main">.</span> <span class="bound">x</span> <span class="main">&lt;</span> <span class="free">n</span> <span class="main">∧</span> coprime <span class="bound">x</span> <span class="free">n</span><span class="main">}</span> <span class="main">=</span> <span class="main">{</span><span class="main">1</span> <span class="main">+</span> <span class="bound">j</span> <span class="main">*</span> <span class="skolem">b</span> <span class="main">|</span><span class="bound">j</span><span class="main">.</span> <span class="bound">j</span> <span class="main">&lt;</span> <span class="skolem">m</span><span class="main">}</span>›</span></span> 
                  <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
                <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">j</span></span><span class="main">::</span><span class="quoted">nat</span> <span class="keyword2"><span class="keyword">where</span></span>  <span class="quoted"><span class="quoted">‹<span class="numeral">2</span> <span class="main">+</span> <span class="main">(</span><span class="skolem">m</span> <span class="main">-</span> <span class="main">1</span><span class="main">)</span> <span class="main">*</span> <span class="skolem">k</span>  <span class="main">=</span> <span class="main">1</span> <span class="main">+</span> <span class="skolem">j</span> <span class="main">*</span> <span class="skolem">b</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">j</span> <span class="main">&lt;</span> <span class="skolem">m</span>›</span></span>
                  <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
                <span class="keyword1"><span class="command">have</span></span>  <span class="quoted"><span class="quoted">‹<span class="main">1</span> <span class="main">+</span> <span class="main">(</span><span class="skolem">m</span> <span class="main">-</span> <span class="main">1</span><span class="main">)</span> <span class="main">*</span> <span class="skolem">k</span>  <span class="main">=</span> <span class="skolem">j</span> <span class="main">*</span> <span class="skolem">b</span>›</span></span>
                  <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="numeral">2</span> <span class="main">+</span> <span class="main">(</span><span class="skolem">m</span> <span class="main">-</span> <span class="main">1</span><span class="main">)</span> <span class="main">*</span> <span class="skolem">k</span>  <span class="main">=</span> <span class="main">1</span> <span class="main">+</span> <span class="skolem">j</span> <span class="main">*</span> <span class="skolem">b</span>›</span></span>
                  <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
                <span class="keyword1"><span class="command">hence</span></span>  <span class="quoted"><span class="quoted">‹<span class="main">1</span> <span class="main">+</span> <span class="main">(</span><span class="skolem">m</span> <span class="main">-</span> <span class="main">1</span><span class="main">)</span> <span class="main">*</span> <span class="skolem">k</span>  <span class="main">=</span> <span class="skolem">j</span> <span class="main">*</span> <span class="main">(</span><span class="numeral">2</span><span class="main">*</span><span class="skolem">k</span><span class="main">)</span>›</span></span> 
                  <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">b</span> <span class="main">=</span> <span class="numeral">2</span> <span class="main">*</span> <span class="skolem">k</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
                <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> 
                  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> <span class="quoted"><span class="quoted">‹<span class="skolem">b</span> <span class="main">=</span> <span class="numeral">2</span> <span class="main">*</span> <span class="skolem">k</span>›</span></span> <span class="quoted"><span class="quoted">‹even <span class="skolem">b</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="free">n</span> <span class="main">=</span> <span class="numeral">2</span> <span class="main">*</span> <span class="main">(</span><span class="main">1</span> <span class="main">+</span> <span class="main">(</span><span class="skolem">m</span> <span class="main">-</span> <span class="main">1</span><span class="main">)</span> <span class="main">*</span> <span class="skolem">k</span><span class="main">)</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="free">n</span> <span class="main">=</span> <span class="numeral">2</span> <span class="main">+</span> <span class="main">(</span><span class="skolem">m</span> <span class="main">-</span> <span class="main">1</span><span class="main">)</span> <span class="main">*</span> <span class="skolem">b</span>›</span></span> dvd_add_times_triv_right_iff dvd_antisym dvd_imp_le dvd_triv_right even_numeral mult_2 zero_less_numeral<span class="main">)</span>
              <span class="keyword1"><span class="command">next</span></span>
                <span class="keyword3"><span class="command">case</span></span> False
                <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">‹even <span class="skolem">k</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
                <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹odd <span class="main">(</span><span class="main">1</span> <span class="main">+</span> <span class="main">(</span><span class="skolem">m</span> <span class="main">-</span> <span class="main">1</span><span class="main">)</span> <span class="main">*</span> <span class="skolem">k</span><span class="main">)</span>›</span></span> 
                  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> <span class="quoted"><span class="quoted">‹even <span class="skolem">k</span>›</span></span> <span class="main">)</span>
                <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">‹coprime <span class="main">(</span><span class="numeral">3</span> <span class="main">+</span> <span class="main">(</span><span class="skolem">m</span> <span class="main">-</span> <span class="main">1</span><span class="main">)</span> <span class="main">*</span> <span class="skolem">k</span><span class="main">)</span> <span class="main">(</span><span class="main">1</span> <span class="main">+</span> <span class="main">(</span><span class="skolem">m</span> <span class="main">-</span> <span class="main">1</span><span class="main">)</span> <span class="main">*</span> <span class="skolem">k</span><span class="main">)</span>›</span></span> 
                  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">smt</span> add_numeral_left coprime_common_divisor coprime_right_2_iff_odd dvd_add_left_iff not_coprimeE numeral_Bit1 numeral_One numeral_plus_one one_add_one<span class="main">)</span>
                <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">‹coprime <span class="main">(</span><span class="numeral">3</span> <span class="main">+</span> <span class="main">(</span><span class="skolem">m</span> <span class="main">-</span> <span class="main">1</span><span class="main">)</span> <span class="main">*</span> <span class="skolem">k</span><span class="main">)</span> <span class="free">n</span>›</span></span> 
                  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> <span class="quoted"><span class="quoted">‹even <span class="skolem">k</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="free">n</span> <span class="main">=</span> <span class="numeral">2</span> <span class="main">*</span> <span class="main">(</span><span class="main">1</span> <span class="main">+</span> <span class="main">(</span><span class="skolem">m</span> <span class="main">-</span> <span class="main">1</span><span class="main">)</span> <span class="main">*</span> <span class="skolem">k</span><span class="main">)</span>›</span></span> coprime_mult_right_iff coprime_right_2_iff_odd even_add even_mult_iff odd_numeral<span class="main">)</span>
                <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹<span class="numeral">3</span> <span class="main">+</span> <span class="main">(</span><span class="skolem">m</span> <span class="main">-</span> <span class="main">1</span><span class="main">)</span> <span class="main">*</span> <span class="skolem">k</span> <span class="main">&lt;</span> <span class="free">n</span>›</span></span> 
                  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">smt</span> Groups.add_ac<span class="main"><span class="main">(</span></span>2<span class="main"><span class="main">)</span></span> <span class="quoted"><span class="quoted">‹even <span class="skolem">k</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="free">n</span> <span class="main">=</span> <span class="numeral">2</span> <span class="main">*</span> <span class="main">(</span><span class="main">1</span> <span class="main">+</span> <span class="main">(</span><span class="skolem">m</span> <span class="main">-</span> <span class="main">1</span><span class="main">)</span> <span class="main">*</span> <span class="skolem">k</span><span class="main">)</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="free">n</span> <span class="main">=</span> <span class="numeral">2</span> <span class="main">+</span> <span class="main">(</span><span class="skolem">m</span> <span class="main">-</span> <span class="main">1</span><span class="main">)</span> <span class="main">*</span> <span class="skolem">b</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="free">n</span> <span class="main">≠</span> <span class="numeral">2</span>›</span></span> add_Suc_right add_cancel_right_right add_mono_thms_linordered_semiring<span class="main"><span class="main">(</span></span>1<span class="main"><span class="main">)</span></span> dvd_imp_le even_add even_mult_iff le_add2 le_neq_implies_less left_add_twice mult_2 neq0_conv numeral_Bit1 numeral_One odd_numeral one_add_one plus_1_eq_Suc<span class="main">)</span>
                <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹<span class="numeral">3</span> <span class="main">+</span> <span class="main">(</span><span class="skolem">m</span> <span class="main">-</span> <span class="main">1</span><span class="main">)</span> <span class="main">*</span> <span class="skolem">k</span> <span class="main">∈</span> <span class="main">{</span><span class="bound">x</span> <span class="main">|</span><span class="bound">x</span><span class="main">.</span> <span class="bound">x</span> <span class="main">&lt;</span> <span class="free">n</span> <span class="main">∧</span> coprime <span class="bound">x</span> <span class="free">n</span><span class="main">}</span>›</span></span> 
                  <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="numeral">3</span> <span class="main">+</span> <span class="main">(</span><span class="skolem">m</span> <span class="main">-</span> <span class="main">1</span><span class="main">)</span> <span class="main">*</span> <span class="skolem">k</span> <span class="main">&lt;</span> <span class="free">n</span>›</span></span> <span class="quoted"><span class="quoted">‹coprime <span class="main">(</span><span class="numeral">3</span> <span class="main">+</span> <span class="main">(</span><span class="skolem">m</span> <span class="main">-</span> <span class="main">1</span><span class="main">)</span> <span class="main">*</span> <span class="skolem">k</span><span class="main">)</span> <span class="free">n</span>›</span></span> 
                  <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
                <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">‹<span class="numeral">3</span> <span class="main">+</span> <span class="main">(</span><span class="skolem">m</span> <span class="main">-</span> <span class="main">1</span><span class="main">)</span> <span class="main">*</span> <span class="skolem">k</span> <span class="main">∈</span> <span class="main">{</span><span class="main">1</span> <span class="main">+</span> <span class="bound">j</span> <span class="main">*</span> <span class="skolem">b</span> <span class="main">|</span><span class="bound">j</span><span class="main">.</span> <span class="bound">j</span> <span class="main">&lt;</span> <span class="skolem">m</span><span class="main">}</span>›</span></span> 
                  <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="main">{</span><span class="bound">x</span> <span class="main">|</span><span class="bound">x</span><span class="main">.</span> <span class="bound">x</span> <span class="main">&lt;</span> <span class="free">n</span> <span class="main">∧</span> coprime <span class="bound">x</span> <span class="free">n</span><span class="main">}</span> <span class="main">=</span> <span class="main">{</span><span class="main">1</span> <span class="main">+</span> <span class="bound">j</span> <span class="main">*</span> <span class="skolem">b</span> <span class="main">|</span><span class="bound">j</span><span class="main">.</span> <span class="bound">j</span> <span class="main">&lt;</span> <span class="skolem">m</span><span class="main">}</span>›</span></span> 
                  <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span> 
                <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">j</span></span><span class="main">::</span><span class="quoted">nat</span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">‹<span class="numeral">3</span> <span class="main">+</span> <span class="main">(</span><span class="skolem">m</span> <span class="main">-</span> <span class="main">1</span><span class="main">)</span> <span class="main">*</span> <span class="skolem">k</span> <span class="main">=</span> <span class="main">1</span> <span class="main">+</span> <span class="skolem">j</span> <span class="main">*</span> <span class="skolem">b</span>›</span></span> 
                  <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>  
                <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹<span class="numeral">2</span> <span class="main">+</span> <span class="main">(</span><span class="skolem">m</span> <span class="main">-</span> <span class="main">1</span><span class="main">)</span> <span class="main">*</span> <span class="skolem">k</span> <span class="main">=</span> <span class="skolem">j</span> <span class="main">*</span> <span class="skolem">b</span>›</span></span> 
                  <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="numeral">3</span> <span class="main">+</span> <span class="main">(</span><span class="skolem">m</span> <span class="main">-</span> <span class="main">1</span><span class="main">)</span> <span class="main">*</span> <span class="skolem">k</span> <span class="main">=</span> <span class="main">1</span> <span class="main">+</span> <span class="skolem">j</span> <span class="main">*</span> <span class="skolem">b</span>›</span></span> 
                  <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
                <span class="keyword1"><span class="command">hence</span></span>  <span class="quoted"><span class="quoted">‹<span class="numeral">2</span> <span class="main">+</span> <span class="main">(</span><span class="skolem">m</span> <span class="main">-</span> <span class="main">1</span><span class="main">)</span> <span class="main">*</span> <span class="skolem">k</span> <span class="main">=</span> <span class="skolem">j</span> <span class="main">*</span> <span class="numeral">2</span><span class="main">*</span><span class="skolem">k</span>›</span></span> 
                  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">b</span> <span class="main">=</span> <span class="numeral">2</span> <span class="main">*</span> <span class="skolem">k</span>›</span></span><span class="main">)</span>
                <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> 
                  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> <span class="quoted"><span class="quoted">‹<span class="numeral">4</span> <span class="main">&lt;</span> <span class="skolem">b</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">b</span> <span class="main">=</span> <span class="numeral">2</span> <span class="main">*</span> <span class="skolem">k</span>›</span></span> <span class="quoted"><span class="quoted">‹even <span class="skolem">k</span>›</span></span> dvd_add_times_triv_right_iff dvd_antisym 
                      dvd_triv_right mult_2 nat_neq_iff numeral_Bit0<span class="main">)</span>
              <span class="keyword1"><span class="command">qed</span></span>
            <span class="keyword1"><span class="command">qed</span></span>
          <span class="keyword1"><span class="command">qed</span></span>
        <span class="keyword1"><span class="command">qed</span></span>
        <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">b</span> <span class="main">≠</span> <span class="numeral">3</span>›</span></span>
        <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">rule</span> classical<span class="main">)</span>
          <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">‹<span class="main">¬</span> <span class="main">(</span><span class="skolem">b</span> <span class="main">≠</span> <span class="numeral">3</span><span class="main">)</span>›</span></span>
          <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">b</span> <span class="main">=</span> <span class="numeral">3</span>›</span></span> 
            <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
          <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">m</span></span> <span class="keyword2"><span class="keyword">where</span></span>  <span class="quoted"><span class="quoted">‹<span class="skolem">m</span> <span class="main">≠</span> <span class="main">0</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> 
            <span class="quoted"><span class="quoted">‹<span class="main">{</span><span class="bound">x</span> <span class="main">|</span> <span class="bound">x</span><span class="main">::</span>nat<span class="main">.</span> <span class="bound">x</span> <span class="main">&lt;</span> <span class="free">n</span> <span class="main">∧</span> coprime <span class="bound">x</span> <span class="free">n</span><span class="main">}</span> <span class="main">=</span> <span class="main">{</span><span class="main">1</span><span class="main">+</span><span class="bound">j</span><span class="main">*</span><span class="skolem">b</span><span class="main">|</span> <span class="bound">j</span><span class="main">::</span>nat<span class="main">.</span> <span class="bound">j</span> <span class="main">&lt;</span> <span class="skolem">m</span><span class="main">}</span>›</span></span>
            <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">m</span> <span class="main">≠</span> <span class="main">0</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="main">{</span><span class="bound">x</span> <span class="main">|</span><span class="bound">x</span><span class="main">.</span> <span class="bound">x</span> <span class="main">&lt;</span> <span class="free">n</span> <span class="main">∧</span> coprime <span class="bound">x</span> <span class="free">n</span><span class="main">}</span> <span class="main">=</span> <span class="main">{</span><span class="main">1</span> <span class="main">+</span> <span class="bound">j</span> <span class="main">*</span> <span class="skolem">b</span> <span class="main">|</span><span class="bound">j</span><span class="main">.</span> <span class="bound">j</span> <span class="main">&lt;</span> <span class="skolem">m</span><span class="main">}</span>›</span></span> 
            <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
          <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">b</span> <span class="main">≠</span> <span class="main">0</span>›</span></span> 
            <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">b</span> <span class="main">=</span> <span class="numeral">3</span>›</span></span><span class="main">)</span>
          <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹<span class="free">n</span> <span class="main">=</span> <span class="numeral">2</span> <span class="main">+</span> <span class="main">(</span><span class="skolem">m</span><span class="main">-</span><span class="main">1</span><span class="main">)</span><span class="main">*</span><span class="skolem">b</span>›</span></span> 
          <span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
            <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹<span class="free">n</span><span class="main">-</span><span class="main">1</span> <span class="main">∈</span> <span class="main">{</span><span class="bound">x</span> <span class="main">|</span> <span class="bound">x</span><span class="main">::</span>nat<span class="main">.</span> <span class="bound">x</span> <span class="main">&lt;</span> <span class="free">n</span> <span class="main">∧</span> coprime <span class="bound">x</span> <span class="free">n</span><span class="main">}</span>›</span></span> 
              <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="main">1</span> <span class="main">&lt;</span> <span class="free">n</span>›</span></span> coprime_diff_one_left_nat 
              <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
            <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹<span class="free">n</span><span class="main">-</span><span class="main">1</span> <span class="main">∈</span> <span class="main">{</span><span class="main">1</span><span class="main">+</span><span class="bound">j</span><span class="main">*</span><span class="skolem">b</span><span class="main">|</span> <span class="bound">j</span><span class="main">::</span>nat<span class="main">.</span> <span class="bound">j</span> <span class="main">&lt;</span> <span class="skolem">m</span><span class="main">}</span>›</span></span> 
              <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="free">n</span> <span class="main">-</span> <span class="main">1</span> <span class="main">∈</span> <span class="main">{</span><span class="bound">x</span> <span class="main">|</span><span class="bound">x</span><span class="main">.</span> <span class="bound">x</span> <span class="main">&lt;</span> <span class="free">n</span> <span class="main">∧</span> coprime <span class="bound">x</span> <span class="free">n</span><span class="main">}</span>›</span></span> 
                <span class="quoted"><span class="quoted">‹<span class="main">{</span><span class="bound">x</span> <span class="main">|</span><span class="bound">x</span><span class="main">.</span> <span class="bound">x</span> <span class="main">&lt;</span> <span class="free">n</span> <span class="main">∧</span> coprime <span class="bound">x</span> <span class="free">n</span><span class="main">}</span> <span class="main">=</span> <span class="main">{</span><span class="main">1</span> <span class="main">+</span> <span class="bound">j</span> <span class="main">*</span> <span class="skolem">b</span> <span class="main">|</span><span class="bound">j</span><span class="main">.</span> <span class="bound">j</span> <span class="main">&lt;</span> <span class="skolem">m</span><span class="main">}</span>›</span></span> 
              <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
            <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">i</span></span><span class="main">::</span><span class="quoted">nat</span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">‹<span class="free">n</span><span class="main">-</span><span class="main">1</span> <span class="main">=</span> <span class="main">1</span><span class="main">+</span><span class="skolem">i</span><span class="main">*</span><span class="skolem">b</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">i</span> <span class="main">&lt;</span> <span class="skolem">m</span>›</span></span> 
              <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
            <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">i</span> <span class="main">≤</span> <span class="skolem">m</span><span class="main">-</span><span class="main">1</span>›</span></span> 
              <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">i</span> <span class="main">&lt;</span> <span class="skolem">m</span>›</span></span> 
              <span class="keyword1"><span class="command">by</span></span> <span class="operator">linarith</span>
            <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹<span class="main">1</span> <span class="main">+</span> <span class="main">(</span><span class="skolem">m</span><span class="main">-</span><span class="main">1</span><span class="main">)</span><span class="main">*</span><span class="skolem">b</span> <span class="main">∈</span> <span class="main">{</span><span class="main">1</span><span class="main">+</span><span class="bound">j</span><span class="main">*</span><span class="skolem">b</span><span class="main">|</span> <span class="bound">j</span><span class="main">::</span>nat<span class="main">.</span> <span class="bound">j</span> <span class="main">&lt;</span> <span class="skolem">m</span><span class="main">}</span>›</span></span> 
              <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">m</span> <span class="main">≠</span> <span class="main">0</span>›</span></span> 
              <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
            <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">‹<span class="main">1</span> <span class="main">+</span> <span class="main">(</span><span class="skolem">m</span><span class="main">-</span><span class="main">1</span><span class="main">)</span><span class="main">*</span><span class="skolem">b</span> <span class="main">∈</span> <span class="main">{</span><span class="bound">x</span> <span class="main">|</span> <span class="bound">x</span> <span class="main">::</span> nat<span class="main">.</span> <span class="bound">x</span> <span class="main">&lt;</span> <span class="free">n</span> <span class="main">∧</span> coprime <span class="bound">x</span> <span class="free">n</span><span class="main">}</span>›</span></span> 
              <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="main">{</span><span class="bound">x</span> <span class="main">|</span><span class="bound">x</span><span class="main">.</span> <span class="bound">x</span> <span class="main">&lt;</span> <span class="free">n</span> <span class="main">∧</span> coprime <span class="bound">x</span> <span class="free">n</span><span class="main">}</span> <span class="main">=</span> <span class="main">{</span><span class="main">1</span> <span class="main">+</span> <span class="bound">j</span> <span class="main">*</span> <span class="skolem">b</span> <span class="main">|</span><span class="bound">j</span><span class="main">.</span> <span class="bound">j</span> <span class="main">&lt;</span> <span class="skolem">m</span><span class="main">}</span>›</span></span> 
              <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
            <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">‹<span class="main">1</span> <span class="main">+</span> <span class="main">(</span><span class="skolem">m</span><span class="main">-</span><span class="main">1</span><span class="main">)</span><span class="main">*</span><span class="skolem">b</span> <span class="main">&lt;</span> <span class="free">n</span>›</span></span> 
              <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
            <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">‹<span class="main">1</span> <span class="main">+</span> <span class="main">(</span><span class="skolem">m</span><span class="main">-</span><span class="main">1</span><span class="main">)</span><span class="main">*</span><span class="skolem">b</span> <span class="main">≤</span> <span class="free">n</span><span class="main">-</span><span class="main">1</span>›</span></span> 
              <span class="keyword1"><span class="command">by</span></span> <span class="operator">linarith</span>
            <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">‹<span class="main">1</span> <span class="main">+</span> <span class="main">(</span><span class="skolem">m</span><span class="main">-</span><span class="main">1</span><span class="main">)</span><span class="main">*</span><span class="skolem">b</span> <span class="main">≤</span> <span class="main">1</span><span class="main">+</span><span class="skolem">i</span><span class="main">*</span><span class="skolem">b</span>›</span></span> 
              <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="free">n</span> <span class="main">-</span> <span class="main">1</span> <span class="main">=</span> <span class="main">1</span> <span class="main">+</span> <span class="skolem">i</span> <span class="main">*</span> <span class="skolem">b</span>›</span></span> 
              <span class="keyword1"><span class="command">by</span></span> <span class="operator">linarith</span>
            <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">‹<span class="main">(</span><span class="skolem">m</span><span class="main">-</span><span class="main">1</span><span class="main">)</span><span class="main">*</span><span class="skolem">b</span> <span class="main">≤</span> <span class="skolem">i</span><span class="main">*</span><span class="skolem">b</span>›</span></span> 
              <span class="keyword1"><span class="command">by</span></span> <span class="operator">linarith</span>
            <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">m</span><span class="main">-</span><span class="main">1</span> <span class="main">≤</span> <span class="skolem">i</span>›</span></span> 
              <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">b</span> <span class="main">≠</span> <span class="main">0</span>›</span></span> 
              <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
            <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">m</span><span class="main">-</span><span class="main">1</span> <span class="main">=</span> <span class="skolem">i</span>›</span></span> 
              <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">i</span> <span class="main">≤</span> <span class="skolem">m</span> <span class="main">-</span> <span class="main">1</span>›</span></span> le_antisym 
              <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
            <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> 
              <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">m</span> <span class="main">≠</span> <span class="main">0</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="free">n</span> <span class="main">-</span> <span class="main">1</span> <span class="main">=</span> <span class="main">1</span> <span class="main">+</span> <span class="skolem">i</span> <span class="main">*</span> <span class="skolem">b</span>›</span></span> 
              <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
          <span class="keyword1"><span class="command">qed</span></span>
          <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹<span class="free">n</span> <span class="main">&gt;</span> <span class="numeral">2</span>›</span></span> 
            <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="main">1</span> <span class="main">&lt;</span> <span class="free">n</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="free">n</span> <span class="main">≠</span> <span class="numeral">2</span>›</span></span> 
            <span class="keyword1"><span class="command">by</span></span> <span class="operator">linarith</span>
          <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">‹ <span class="skolem">m</span> <span class="main">≥</span> <span class="numeral">2</span> ›</span></span> <span class="keyword1"><span class="command">using</span></span>  <span class="quoted"><span class="quoted">‹<span class="free">n</span> <span class="main">=</span> <span class="numeral">2</span> <span class="main">+</span> <span class="main">(</span><span class="skolem">m</span><span class="main">-</span><span class="main">1</span><span class="main">)</span><span class="main">*</span><span class="skolem">b</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">b</span> <span class="main">=</span> <span class="numeral">3</span>›</span></span> 
            <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
          <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹<span class="numeral">4</span> <span class="main">∈</span> <span class="main">{</span><span class="main">1</span><span class="main">+</span><span class="bound">j</span><span class="main">*</span><span class="main">(</span><span class="skolem">b</span><span class="main">::</span>nat<span class="main">)</span><span class="main">|</span> <span class="bound">j</span><span class="main">::</span>nat<span class="main">.</span> <span class="bound">j</span> <span class="main">&lt;</span> <span class="skolem">m</span><span class="main">}</span>›</span></span> 
            <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="numeral">2</span> <span class="main">≤</span> <span class="skolem">m</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">b</span> <span class="main">=</span> <span class="numeral">3</span>›</span></span> 
            <span class="keyword1"><span class="command">by</span></span> <span class="operator">force</span>
          <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">‹<span class="main">(</span><span class="numeral">4</span><span class="main">::</span>nat<span class="main">)</span> <span class="main">∈</span>  <span class="main">{</span><span class="bound">x</span> <span class="main">|</span> <span class="bound">x</span> <span class="main">::</span> nat<span class="main">.</span> <span class="bound">x</span> <span class="main">&lt;</span> <span class="free">n</span> <span class="main">∧</span> coprime <span class="bound">x</span> <span class="free">n</span><span class="main">}</span>›</span></span> 
            <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="main">{</span><span class="bound">x</span> <span class="main">|</span><span class="bound">x</span><span class="main">.</span> <span class="bound">x</span> <span class="main">&lt;</span> <span class="free">n</span> <span class="main">∧</span> coprime <span class="bound">x</span> <span class="free">n</span><span class="main">}</span> <span class="main">=</span> <span class="main">{</span><span class="main">1</span> <span class="main">+</span> <span class="bound">j</span> <span class="main">*</span> <span class="skolem">b</span> <span class="main">|</span><span class="bound">j</span><span class="main">.</span> <span class="bound">j</span> <span class="main">&lt;</span> <span class="skolem">m</span><span class="main">}</span>›</span></span>
            <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
          <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">‹coprime <span class="main">(</span><span class="numeral">4</span><span class="main">::</span>nat<span class="main">)</span> <span class="free">n</span>›</span></span> 
            <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
          <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹<span class="main">(</span><span class="numeral">2</span><span class="main">::</span>nat<span class="main">)</span> <span class="keyword1">dvd</span> <span class="numeral">4</span>›</span></span> 
            <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
          <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">‹coprime <span class="main">(</span><span class="numeral">2</span><span class="main">::</span>nat<span class="main">)</span> <span class="free">n</span>›</span></span> 
            <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹coprime <span class="main">(</span><span class="numeral">4</span><span class="main">::</span>nat<span class="main">)</span> <span class="free">n</span>›</span></span> coprime_divisors dvd_refl 
            <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
          <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹<span class="numeral">4</span> <span class="main">&lt;</span> <span class="free">n</span>›</span></span> 
            <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="numeral">4</span> <span class="main">∈</span> <span class="main">{</span><span class="bound">x</span> <span class="main">|</span><span class="bound">x</span><span class="main">.</span> <span class="bound">x</span> <span class="main">&lt;</span> <span class="free">n</span> <span class="main">∧</span> coprime <span class="bound">x</span> <span class="free">n</span><span class="main">}</span>›</span></span> 
            <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
          <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹<span class="numeral">2</span> <span class="main">&lt;</span> <span class="main">(</span><span class="numeral">4</span><span class="main">::</span>nat<span class="main">)</span>›</span></span> 
            <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
          <span class="keyword1"><span class="command">have</span></span>  <span class="quoted"><span class="quoted">‹<span class="numeral">2</span> <span class="main">&lt;</span> <span class="free">n</span>›</span></span> 
            <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> <span class="quoted"><span class="quoted">‹<span class="numeral">2</span> <span class="main">&lt;</span> <span class="free">n</span>›</span></span><span class="main">)</span>
          <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">‹<span class="numeral">2</span> <span class="main">∈</span> <span class="main">{</span><span class="bound">x</span> <span class="main">|</span> <span class="bound">x</span> <span class="main">::</span> nat<span class="main">.</span> <span class="bound">x</span> <span class="main">&lt;</span> <span class="free">n</span> <span class="main">∧</span> coprime <span class="bound">x</span> <span class="free">n</span><span class="main">}</span>›</span></span> 
            <span class="keyword1"><span class="command">using</span></span>  <span class="quoted"><span class="quoted">‹coprime <span class="main">(</span><span class="numeral">2</span><span class="main">::</span>nat<span class="main">)</span> <span class="free">n</span>›</span></span> 
            <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
          <span class="keyword1"><span class="command">hence</span></span>  <span class="quoted"><span class="quoted">‹<span class="numeral">2</span> <span class="main">∈</span> <span class="main">{</span><span class="main">1</span><span class="main">+</span><span class="bound">j</span><span class="main">*</span><span class="main">(</span><span class="skolem">b</span><span class="main">::</span>nat<span class="main">)</span><span class="main">|</span> <span class="bound">j</span><span class="main">::</span>nat<span class="main">.</span> <span class="bound">j</span> <span class="main">&lt;</span> <span class="skolem">m</span><span class="main">}</span>›</span></span> 
            <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="main">{</span><span class="bound">x</span> <span class="main">|</span><span class="bound">x</span><span class="main">.</span> <span class="bound">x</span> <span class="main">&lt;</span> <span class="free">n</span> <span class="main">∧</span> coprime <span class="bound">x</span> <span class="free">n</span><span class="main">}</span> <span class="main">=</span> <span class="main">{</span><span class="main">1</span> <span class="main">+</span> <span class="bound">j</span> <span class="main">*</span> <span class="skolem">b</span> <span class="main">|</span><span class="bound">j</span><span class="main">.</span> <span class="bound">j</span> <span class="main">&lt;</span> <span class="skolem">m</span><span class="main">}</span>›</span></span> 
            <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
          <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">j</span></span><span class="main">::</span><span class="quoted">nat</span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">‹<span class="numeral">2</span> <span class="main">=</span> <span class="main">1</span><span class="main">+</span><span class="skolem">j</span><span class="main">*</span><span class="numeral">3</span>›</span></span> 
            <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">b</span> <span class="main">=</span> <span class="numeral">3</span>›</span></span> 
            <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
          <span class="keyword1"><span class="command">from</span></span>  <span class="quoted"><span class="quoted">‹<span class="numeral">2</span> <span class="main">=</span> <span class="main">1</span><span class="main">+</span><span class="skolem">j</span><span class="main">*</span><span class="numeral">3</span>›</span></span>
          <span class="keyword1"><span class="command">have</span></span>  <span class="quoted"><span class="quoted">‹<span class="main">1</span> <span class="main">=</span> <span class="skolem">j</span><span class="main">*</span><span class="numeral">3</span>›</span></span> 
            <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
          <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">‹<span class="numeral">3</span> <span class="keyword1">dvd</span> <span class="main">1</span>›</span></span> 
            <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
          <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
            <span class="keyword1"><span class="command">using</span></span> nat_dvd_1_iff_1 numeral_eq_one_iff 
            <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
        <span class="keyword1"><span class="command">qed</span></span>
        <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">b</span> <span class="main">=</span> <span class="main">0</span> <span class="main">∨</span> <span class="skolem">b</span> <span class="main">=</span> <span class="main">1</span> <span class="main">∨</span> <span class="skolem">b</span> <span class="main">=</span> <span class="numeral">2</span> <span class="main">∨</span> <span class="skolem">b</span> <span class="main">=</span> <span class="numeral">4</span>›</span></span>
          <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">b</span> <span class="main">=</span> <span class="main">0</span> <span class="main">⟹</span> <span class="main">∃</span><span class="bound">k</span><span class="main">.</span> <span class="free">n</span> <span class="main">=</span> <span class="numeral">2</span><span class="main">^</span><span class="bound">k</span>›</span></span>
        <span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
          <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">b</span> <span class="main">=</span> <span class="main">0</span>›</span></span>
          <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹<span class="main">{</span><span class="main">1</span> <span class="main">+</span> <span class="bound">j</span> <span class="main">*</span> <span class="skolem">b</span> <span class="main">|</span><span class="bound">j</span><span class="main">.</span> <span class="bound">j</span> <span class="main">&lt;</span> <span class="skolem">m</span><span class="main">}</span> <span class="main">=</span> <span class="main">{</span><span class="main">1</span><span class="main">}</span>›</span></span>
            <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">b</span> <span class="main">=</span> <span class="main">0</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">m</span> <span class="main">≠</span> <span class="main">0</span>›</span></span> 
            <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
          <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">‹<span class="main">{</span><span class="bound">x</span> <span class="main">|</span><span class="bound">x</span><span class="main">.</span> <span class="bound">x</span> <span class="main">&lt;</span> <span class="free">n</span> <span class="main">∧</span> coprime <span class="bound">x</span> <span class="free">n</span><span class="main">}</span> <span class="main">=</span> <span class="main">{</span><span class="main">1</span><span class="main">}</span>›</span></span>
            <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="main">{</span><span class="bound">x</span> <span class="main">|</span><span class="bound">x</span><span class="main">.</span> <span class="bound">x</span> <span class="main">&lt;</span> <span class="free">n</span> <span class="main">∧</span> coprime <span class="bound">x</span> <span class="free">n</span><span class="main">}</span> <span class="main">=</span> <span class="main">{</span><span class="main">1</span> <span class="main">+</span> <span class="bound">j</span> <span class="main">*</span> <span class="skolem">b</span> <span class="main">|</span><span class="bound">j</span><span class="main">.</span> <span class="bound">j</span> <span class="main">&lt;</span> <span class="skolem">m</span><span class="main">}</span>›</span></span>
            <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
          <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">‹<span class="free">n</span> <span class="main">=</span> <span class="numeral">2</span>›</span></span>
          <span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
            <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹<span class="free">n</span><span class="main">-</span><span class="main">1</span> <span class="main">∈</span>  <span class="main">{</span><span class="bound">x</span> <span class="main">|</span> <span class="bound">x</span> <span class="main">::</span> nat<span class="main">.</span> <span class="bound">x</span> <span class="main">&lt;</span> <span class="free">n</span> <span class="main">∧</span> coprime <span class="bound">x</span> <span class="free">n</span><span class="main">}</span>›</span></span> 
              <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="main">1</span> <span class="main">&lt;</span> <span class="free">n</span>›</span></span> coprime_diff_one_left_nat 
              <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
            <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹<span class="free">n</span><span class="main">-</span><span class="main">1</span> <span class="main">∈</span> <span class="main">{</span><span class="main">1</span><span class="main">}</span>›</span></span> 
              <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="free">n</span> <span class="main">-</span> <span class="main">1</span> <span class="main">∈</span> <span class="main">{</span><span class="bound">x</span> <span class="main">|</span><span class="bound">x</span><span class="main">.</span> <span class="bound">x</span> <span class="main">&lt;</span> <span class="free">n</span> <span class="main">∧</span> coprime <span class="bound">x</span> <span class="free">n</span><span class="main">}</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="main">{</span><span class="bound">x</span> <span class="main">|</span><span class="bound">x</span><span class="main">.</span> <span class="bound">x</span> <span class="main">&lt;</span> <span class="free">n</span> <span class="main">∧</span> coprime <span class="bound">x</span> <span class="free">n</span><span class="main">}</span> <span class="main">=</span> <span class="main">{</span><span class="main">1</span><span class="main">}</span>›</span></span> 
              <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
            <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">‹<span class="free">n</span><span class="main">-</span><span class="main">1</span> <span class="main">=</span> <span class="main">1</span>›</span></span> 
              <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
            <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">‹<span class="free">n</span> <span class="main">=</span> <span class="numeral">2</span>›</span></span> 
              <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
            <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> 
              <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
          <span class="keyword1"><span class="command">qed</span></span>
          <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">‹<span class="free">n</span> <span class="main">=</span> <span class="numeral">2</span><span class="main">^</span><span class="main">1</span>›</span></span>
            <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
          <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
            <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span> 
        <span class="keyword1"><span class="command">qed</span></span>
        <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">b</span> <span class="main">=</span> <span class="main">1</span> <span class="main">⟹</span> prime <span class="free">n</span>›</span></span>
        <span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
          <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">b</span> <span class="main">=</span> <span class="main">1</span>›</span></span>
          <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">x</span> <span class="main">&lt;</span> <span class="free">n</span> <span class="main">⟹</span> <span class="skolem">x</span> <span class="main">≠</span> <span class="main">0</span> <span class="main">⟹</span> coprime <span class="skolem">x</span> <span class="free">n</span>›</span></span>
            <span class="keyword2"><span class="keyword">for</span></span> <span class="skolem">x</span>
          <span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
            <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">x</span> <span class="main">&lt;</span> <span class="free">n</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">x</span> <span class="main">≠</span> <span class="main">0</span>›</span></span>
            <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹<span class="main">{</span><span class="main">1</span><span class="main">+</span><span class="bound">j</span><span class="main">|</span> <span class="bound">j</span><span class="main">::</span>nat<span class="main">.</span> <span class="bound">j</span> <span class="main">&lt;</span> <span class="skolem">m</span><span class="main">}</span> <span class="main">=</span> <span class="main">{</span><span class="bound">x</span> <span class="main">|</span> <span class="bound">x</span><span class="main">::</span>nat<span class="main">.</span> <span class="bound">x</span> <span class="main">&lt;</span> <span class="skolem">m</span><span class="main">+</span><span class="main">1</span> <span class="main">∧</span> <span class="bound">x</span> <span class="main">≠</span> <span class="main">0</span><span class="main">}</span>›</span></span> 
              <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> <span class="main"><span class="main">(</span></span>full_types<span class="main"><span class="main">)</span></span> Suc_eq_plus1  add_mono1 less_Suc_eq_0_disj  nat.simps<span class="main"><span class="main">(</span></span>3<span class="main"><span class="main">)</span></span> plus_1_eq_Suc <span class="main">)</span>
            <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">‹<span class="main">{</span><span class="bound">x</span> <span class="main">|</span> <span class="bound">x</span> <span class="main">::</span> nat<span class="main">.</span> <span class="bound">x</span> <span class="main">&lt;</span> <span class="free">n</span> <span class="main">∧</span> coprime <span class="bound">x</span> <span class="free">n</span><span class="main">}</span> <span class="main">=</span> <span class="main">{</span><span class="bound">x</span> <span class="main">|</span> <span class="bound">x</span> <span class="main">::</span> nat<span class="main">.</span> <span class="bound">x</span> <span class="main">&lt;</span> <span class="skolem">m</span><span class="main">+</span><span class="main">1</span> <span class="main">∧</span> <span class="bound">x</span> <span class="main">≠</span> <span class="main">0</span><span class="main">}</span>›</span></span>
              <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">b</span> <span class="main">=</span> <span class="main">1</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="main">{</span><span class="bound">x</span> <span class="main">|</span><span class="bound">x</span><span class="main">.</span> <span class="bound">x</span> <span class="main">&lt;</span> <span class="free">n</span> <span class="main">∧</span> coprime <span class="bound">x</span> <span class="free">n</span><span class="main">}</span> <span class="main">=</span> <span class="main">{</span><span class="main">1</span> <span class="main">+</span> <span class="bound">j</span> <span class="main">*</span> <span class="skolem">b</span> <span class="main">|</span><span class="bound">j</span><span class="main">.</span> <span class="bound">j</span> <span class="main">&lt;</span> <span class="skolem">m</span><span class="main">}</span>›</span></span> 
              <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
            <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹coprime <span class="main">(</span><span class="free">n</span><span class="main">-</span><span class="main">1</span><span class="main">)</span> <span class="free">n</span>›</span></span> 
              <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="main">1</span> <span class="main">&lt;</span> <span class="free">n</span>›</span></span> coprime_diff_one_left_nat 
              <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
            <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹<span class="free">n</span><span class="main">-</span><span class="main">1</span> <span class="main">&lt;</span> <span class="free">n</span>›</span></span> 
              <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="main">1</span> <span class="main">&lt;</span> <span class="free">n</span>›</span></span> 
              <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
            <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹<span class="free">n</span><span class="main">-</span><span class="main">1</span> <span class="main">∈</span> <span class="main">{</span><span class="bound">x</span> <span class="main">|</span><span class="bound">x</span><span class="main">.</span> <span class="bound">x</span> <span class="main">&lt;</span> <span class="free">n</span> <span class="main">∧</span> coprime <span class="bound">x</span> <span class="free">n</span><span class="main">}</span>›</span></span> 
              <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹coprime <span class="main">(</span><span class="free">n</span> <span class="main">-</span> <span class="main">1</span><span class="main">)</span> <span class="free">n</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="free">n</span> <span class="main">-</span> <span class="main">1</span> <span class="main">&lt;</span> <span class="free">n</span>›</span></span> 
              <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
            <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹<span class="free">n</span><span class="main">-</span><span class="main">1</span> <span class="main">≤</span> <span class="skolem">m</span>›</span></span> 
              <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> <span class="main"><span class="main">(</span></span>no_types<span class="main"><span class="main">,</span></span> lifting<span class="main"><span class="main">)</span></span> CollectD Suc_eq_plus1 Suc_less_eq2 <span class="quoted"><span class="quoted">‹<span class="free">n</span> <span class="main">-</span> <span class="main">1</span> <span class="main">∈</span> <span class="main">{</span><span class="bound">x</span> <span class="main">|</span><span class="bound">x</span><span class="main">.</span> <span class="bound">x</span> <span class="main">&lt;</span> <span class="free">n</span> <span class="main">∧</span> coprime <span class="bound">x</span> <span class="free">n</span><span class="main">}</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="main">{</span><span class="bound">x</span> <span class="main">|</span><span class="bound">x</span><span class="main">.</span> <span class="bound">x</span> <span class="main">&lt;</span> <span class="free">n</span> <span class="main">∧</span> coprime <span class="bound">x</span> <span class="free">n</span><span class="main">}</span> <span class="main">=</span> <span class="main">{</span><span class="bound">x</span> <span class="main">|</span><span class="bound">x</span><span class="main">.</span> <span class="bound">x</span> <span class="main">&lt;</span> <span class="skolem">m</span> <span class="main">+</span> <span class="main">1</span> <span class="main">∧</span> <span class="bound">x</span> <span class="main">≠</span> <span class="main">0</span><span class="main">}</span>›</span></span>   leD  le_less_linear not_less_eq_eq <span class="main">)</span>
            <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">m</span> <span class="main">∈</span>  <span class="main">{</span><span class="bound">x</span> <span class="main">|</span> <span class="bound">x</span> <span class="main">::</span> nat<span class="main">.</span> <span class="bound">x</span> <span class="main">&lt;</span> <span class="skolem">m</span><span class="main">+</span><span class="main">1</span> <span class="main">∧</span> <span class="bound">x</span> <span class="main">≠</span> <span class="main">0</span><span class="main">}</span>›</span></span> 
              <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">m</span> <span class="main">≠</span> <span class="main">0</span>›</span></span> 
              <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
            <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">m</span> <span class="main">∈</span> <span class="main">{</span><span class="bound">x</span> <span class="main">|</span><span class="bound">x</span><span class="main">.</span> <span class="bound">x</span> <span class="main">&lt;</span> <span class="free">n</span> <span class="main">∧</span> coprime <span class="bound">x</span> <span class="free">n</span><span class="main">}</span> ›</span></span> 
              <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">m</span> <span class="main">∈</span> <span class="main">{</span><span class="bound">x</span> <span class="main">|</span><span class="bound">x</span><span class="main">.</span> <span class="bound">x</span> <span class="main">&lt;</span> <span class="skolem">m</span> <span class="main">+</span> <span class="main">1</span> <span class="main">∧</span> <span class="bound">x</span> <span class="main">≠</span> <span class="main">0</span><span class="main">}</span>›</span></span> 
                <span class="quoted"><span class="quoted">‹<span class="main">{</span><span class="bound">x</span> <span class="main">|</span><span class="bound">x</span><span class="main">.</span> <span class="bound">x</span> <span class="main">&lt;</span> <span class="free">n</span> <span class="main">∧</span> coprime <span class="bound">x</span> <span class="free">n</span><span class="main">}</span> <span class="main">=</span> <span class="main">{</span><span class="bound">x</span> <span class="main">|</span><span class="bound">x</span><span class="main">.</span> <span class="bound">x</span> <span class="main">&lt;</span> <span class="skolem">m</span> <span class="main">+</span> <span class="main">1</span> <span class="main">∧</span> <span class="bound">x</span> <span class="main">≠</span> <span class="main">0</span><span class="main">}</span>›</span></span> 
              <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
            <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">m</span> <span class="main">&lt;</span> <span class="free">n</span>›</span></span> 
              <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">m</span> <span class="main">∈</span> <span class="main">{</span><span class="bound">x</span> <span class="main">|</span><span class="bound">x</span><span class="main">.</span> <span class="bound">x</span> <span class="main">&lt;</span> <span class="free">n</span> <span class="main">∧</span> coprime <span class="bound">x</span> <span class="free">n</span><span class="main">}</span>›</span></span> 
              <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
            <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">m</span><span class="main">+</span><span class="main">1</span> <span class="main">=</span> <span class="free">n</span>›</span></span> 
              <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">m</span> <span class="main">&lt;</span> <span class="free">n</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="free">n</span> <span class="main">-</span> <span class="main">1</span> <span class="main">≤</span> <span class="skolem">m</span>›</span></span> 
              <span class="keyword1"><span class="command">by</span></span> <span class="operator">linarith</span>
            <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">x</span> <span class="main">∈</span>  <span class="main">{</span><span class="bound">x</span> <span class="main">|</span> <span class="bound">x</span> <span class="main">::</span> nat<span class="main">.</span> <span class="bound">x</span> <span class="main">&lt;</span> <span class="skolem">m</span><span class="main">+</span><span class="main">1</span> <span class="main">∧</span> <span class="bound">x</span> <span class="main">≠</span> <span class="main">0</span><span class="main">}</span>›</span></span> 
              <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">m</span> <span class="main">+</span> <span class="main">1</span> <span class="main">=</span> <span class="free">n</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">x</span> <span class="main">&lt;</span> <span class="free">n</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">x</span> <span class="main">≠</span> <span class="main">0</span>›</span></span> 
              <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
            <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">x</span> <span class="main">∈</span> <span class="main">{</span><span class="bound">x</span> <span class="main">|</span><span class="bound">x</span><span class="main">.</span> <span class="bound">x</span> <span class="main">&lt;</span> <span class="free">n</span> <span class="main">∧</span> coprime <span class="bound">x</span> <span class="free">n</span><span class="main">}</span>›</span></span> 
              <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="main">{</span><span class="bound">x</span> <span class="main">|</span><span class="bound">x</span><span class="main">.</span> <span class="bound">x</span> <span class="main">&lt;</span> <span class="free">n</span> <span class="main">∧</span> coprime <span class="bound">x</span> <span class="free">n</span><span class="main">}</span> <span class="main">=</span> <span class="main">{</span><span class="bound">x</span> <span class="main">|</span><span class="bound">x</span><span class="main">.</span> <span class="bound">x</span> <span class="main">&lt;</span> <span class="skolem">m</span> <span class="main">+</span> <span class="main">1</span> <span class="main">∧</span> <span class="bound">x</span> <span class="main">≠</span> <span class="main">0</span><span class="main">}</span>›</span></span> 
              <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
            <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> 
              <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
          <span class="keyword1"><span class="command">qed</span></span>
          <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
            <span class="keyword1"><span class="command">using</span></span> assms coprime_commute nat_neq_iff prime_nat_iff'' <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span> 
        <span class="keyword1"><span class="command">qed</span></span>
        <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">b</span> <span class="main">=</span> <span class="numeral">2</span> <span class="main">⟹</span> <span class="main">∃</span> <span class="bound">k</span><span class="main">.</span> <span class="free">n</span> <span class="main">=</span> <span class="numeral">2</span><span class="main">^</span><span class="bound">k</span>›</span></span>
        <span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
          <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">b</span> <span class="main">=</span> <span class="numeral">2</span>›</span></span>
          <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹<span class="main">{</span><span class="bound">x</span> <span class="main">|</span> <span class="bound">x</span> <span class="main">::</span> nat<span class="main">.</span> <span class="bound">x</span> <span class="main">&lt;</span> <span class="free">n</span> <span class="main">∧</span> coprime <span class="bound">x</span> <span class="free">n</span><span class="main">}</span> <span class="main">=</span> <span class="main">{</span><span class="main">1</span><span class="main">+</span><span class="bound">j</span><span class="main">*</span><span class="numeral">2</span><span class="main">|</span> <span class="bound">j</span><span class="main">::</span>nat<span class="main">.</span> <span class="bound">j</span> <span class="main">&lt;</span> <span class="skolem">m</span><span class="main">}</span>›</span></span>
            <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">b</span> <span class="main">=</span> <span class="numeral">2</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="main">{</span><span class="bound">x</span> <span class="main">|</span><span class="bound">x</span><span class="main">.</span> <span class="bound">x</span> <span class="main">&lt;</span> <span class="free">n</span> <span class="main">∧</span> coprime <span class="bound">x</span> <span class="free">n</span><span class="main">}</span> <span class="main">=</span> <span class="main">{</span><span class="main">1</span> <span class="main">+</span> <span class="bound">j</span> <span class="main">*</span> <span class="skolem">b</span> <span class="main">|</span><span class="bound">j</span><span class="main">.</span> <span class="bound">j</span> <span class="main">&lt;</span> <span class="skolem">m</span><span class="main">}</span>›</span></span> 
            <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
          <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">x</span> <span class="main">&lt;</span> <span class="free">n</span> <span class="main">⟹</span> coprime <span class="skolem">x</span> <span class="free">n</span> <span class="main">⟷</span> odd <span class="skolem">x</span>›</span></span>
            <span class="keyword2"><span class="keyword">for</span></span> <span class="skolem">x</span><span class="main">::</span><span class="quoted">nat</span>
          <span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
            <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">x</span> <span class="main">&lt;</span> <span class="free">n</span>›</span></span>
            <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹coprime <span class="skolem">x</span> <span class="free">n</span> <span class="main">⟹</span> odd <span class="skolem">x</span>›</span></span>
            <span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
              <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">‹coprime <span class="skolem">x</span> <span class="free">n</span>›</span></span>
              <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">x</span> <span class="main">∈</span> <span class="main">{</span><span class="bound">x</span> <span class="main">|</span> <span class="bound">x</span> <span class="main">::</span> nat<span class="main">.</span> <span class="bound">x</span> <span class="main">&lt;</span> <span class="free">n</span> <span class="main">∧</span> coprime <span class="bound">x</span> <span class="free">n</span><span class="main">}</span>›</span></span> 
                <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> <span class="quoted"><span class="quoted">‹coprime <span class="skolem">x</span> <span class="free">n</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">x</span> <span class="main">&lt;</span> <span class="free">n</span>›</span></span><span class="main">)</span>
              <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">x</span> <span class="main">∈</span> <span class="main">{</span><span class="main">1</span><span class="main">+</span><span class="bound">j</span><span class="main">*</span><span class="numeral">2</span><span class="main">|</span> <span class="bound">j</span><span class="main">::</span>nat<span class="main">.</span> <span class="bound">j</span> <span class="main">&lt;</span> <span class="skolem">m</span><span class="main">}</span>›</span></span> 
                <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="main">{</span><span class="bound">x</span> <span class="main">|</span><span class="bound">x</span><span class="main">.</span> <span class="bound">x</span> <span class="main">&lt;</span> <span class="free">n</span> <span class="main">∧</span> coprime <span class="bound">x</span> <span class="free">n</span><span class="main">}</span> <span class="main">=</span> <span class="main">{</span><span class="main">1</span> <span class="main">+</span> <span class="bound">j</span> <span class="main">*</span> <span class="numeral">2</span> <span class="main">|</span><span class="bound">j</span><span class="main">.</span> <span class="bound">j</span> <span class="main">&lt;</span> <span class="skolem">m</span><span class="main">}</span>›</span></span> 
                <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
              <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">j</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">x</span> <span class="main">=</span> <span class="main">1</span><span class="main">+</span><span class="skolem">j</span><span class="main">*</span><span class="numeral">2</span>›</span></span> 
                <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
              <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
                <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
            <span class="keyword1"><span class="command">qed</span></span>
            <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹odd <span class="skolem">x</span> <span class="main">⟹</span> coprime <span class="skolem">x</span> <span class="free">n</span>›</span></span>
            <span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
              <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">‹odd <span class="skolem">x</span>›</span></span>
              <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">j</span></span><span class="main">::</span><span class="quoted">nat</span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">x</span> <span class="main">=</span> <span class="main">1</span><span class="main">+</span><span class="skolem">j</span><span class="main">*</span><span class="numeral">2</span>›</span></span> 
                <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> <span class="quoted"><span class="quoted">‹odd <span class="skolem">x</span>›</span></span> add.commute mult_2_right odd_two_times_div_two_succ one_add_one semiring_normalization_rules<span class="main"><span class="main">(</span></span>16<span class="main"><span class="main">)</span></span><span class="main">)</span> 
              <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">j</span> <span class="main">&lt;</span> <span class="main">(</span><span class="free">n</span><span class="main">-</span><span class="main">1</span><span class="main">)</span><span class="main">/</span><span class="numeral">2</span>›</span></span> 
                <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">x</span> <span class="main">&lt;</span> <span class="free">n</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">x</span> <span class="main">=</span> <span class="main">1</span> <span class="main">+</span> <span class="skolem">j</span> <span class="main">*</span> <span class="numeral">2</span>›</span></span> 
                <span class="keyword1"><span class="command">by</span></span> <span class="operator">linarith</span>
              <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹<span class="free">n</span> <span class="main">=</span> <span class="numeral">2</span><span class="main">*</span><span class="skolem">m</span>›</span></span>
              <span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
                <span class="keyword1"><span class="command">have</span></span>  <span class="quoted"><span class="quoted">‹<span class="main">(</span><span class="numeral">2</span><span class="main">::</span>nat<span class="main">)</span> <span class="main">≠</span> <span class="main">0</span>›</span></span> 
                  <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
                <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹<span class="free">n</span> <span class="main">=</span> <span class="numeral">2</span><span class="main">+</span><span class="main">(</span><span class="skolem">m</span><span class="main">-</span><span class="main">1</span><span class="main">)</span><span class="main">*</span><span class="numeral">2</span>›</span></span> 
                <span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
                  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹<span class="free">n</span><span class="main">-</span><span class="main">1</span> <span class="main">∈</span> <span class="main">{</span><span class="bound">x</span> <span class="main">|</span> <span class="bound">x</span> <span class="main">::</span> nat<span class="main">.</span> <span class="bound">x</span> <span class="main">&lt;</span> <span class="free">n</span> <span class="main">∧</span> coprime <span class="bound">x</span> <span class="free">n</span><span class="main">}</span>›</span></span> 
                    <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="main">1</span> <span class="main">&lt;</span> <span class="free">n</span>›</span></span> coprime_diff_one_left_nat 
                    <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
                  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹<span class="free">n</span><span class="main">-</span><span class="main">1</span> <span class="main">∈</span> <span class="main">{</span><span class="main">1</span><span class="main">+</span><span class="bound">j</span><span class="main">*</span><span class="skolem">b</span><span class="main">|</span> <span class="bound">j</span><span class="main">::</span>nat<span class="main">.</span> <span class="bound">j</span> <span class="main">&lt;</span> <span class="skolem">m</span><span class="main">}</span>›</span></span> 
                    <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="free">n</span> <span class="main">-</span> <span class="main">1</span> <span class="main">∈</span> <span class="main">{</span><span class="bound">x</span> <span class="main">|</span><span class="bound">x</span><span class="main">.</span> <span class="bound">x</span> <span class="main">&lt;</span> <span class="free">n</span> <span class="main">∧</span> coprime <span class="bound">x</span> <span class="free">n</span><span class="main">}</span>›</span></span> 
                      <span class="quoted"><span class="quoted">‹<span class="main">{</span><span class="bound">x</span> <span class="main">|</span><span class="bound">x</span><span class="main">.</span> <span class="bound">x</span> <span class="main">&lt;</span> <span class="free">n</span> <span class="main">∧</span> coprime <span class="bound">x</span> <span class="free">n</span><span class="main">}</span> <span class="main">=</span> <span class="main">{</span><span class="main">1</span> <span class="main">+</span> <span class="bound">j</span> <span class="main">*</span> <span class="skolem">b</span> <span class="main">|</span><span class="bound">j</span><span class="main">.</span> <span class="bound">j</span> <span class="main">&lt;</span> <span class="skolem">m</span><span class="main">}</span>›</span></span> 
                    <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
                  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">i</span></span><span class="main">::</span><span class="quoted">nat</span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">‹<span class="free">n</span><span class="main">-</span><span class="main">1</span> <span class="main">=</span> <span class="main">1</span><span class="main">+</span><span class="skolem">i</span><span class="main">*</span><span class="skolem">b</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">i</span> <span class="main">&lt;</span> <span class="skolem">m</span>›</span></span> 
                    <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
                  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">i</span> <span class="main">≤</span> <span class="skolem">m</span><span class="main">-</span><span class="main">1</span>›</span></span> 
                    <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">i</span> <span class="main">&lt;</span> <span class="skolem">m</span>›</span></span> 
                    <span class="keyword1"><span class="command">by</span></span> <span class="operator">linarith</span>
                  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹<span class="main">1</span> <span class="main">+</span> <span class="main">(</span><span class="skolem">m</span><span class="main">-</span><span class="main">1</span><span class="main">)</span><span class="main">*</span><span class="skolem">b</span> <span class="main">∈</span> <span class="main">{</span><span class="main">1</span><span class="main">+</span><span class="bound">j</span><span class="main">*</span><span class="skolem">b</span><span class="main">|</span> <span class="bound">j</span><span class="main">::</span>nat<span class="main">.</span> <span class="bound">j</span> <span class="main">&lt;</span> <span class="skolem">m</span><span class="main">}</span>›</span></span> 
                    <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">m</span> <span class="main">≠</span> <span class="main">0</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
                  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">‹<span class="main">1</span> <span class="main">+</span> <span class="main">(</span><span class="skolem">m</span><span class="main">-</span><span class="main">1</span><span class="main">)</span><span class="main">*</span><span class="skolem">b</span> <span class="main">∈</span> <span class="main">{</span><span class="bound">x</span> <span class="main">|</span> <span class="bound">x</span> <span class="main">::</span> nat<span class="main">.</span> <span class="bound">x</span> <span class="main">&lt;</span> <span class="free">n</span> <span class="main">∧</span> coprime <span class="bound">x</span> <span class="free">n</span><span class="main">}</span>›</span></span> 
                    <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="main">{</span><span class="bound">x</span> <span class="main">|</span><span class="bound">x</span><span class="main">.</span> <span class="bound">x</span> <span class="main">&lt;</span> <span class="free">n</span> <span class="main">∧</span> coprime <span class="bound">x</span> <span class="free">n</span><span class="main">}</span> <span class="main">=</span> <span class="main">{</span><span class="main">1</span> <span class="main">+</span> <span class="bound">j</span> <span class="main">*</span> <span class="skolem">b</span> <span class="main">|</span><span class="bound">j</span><span class="main">.</span> <span class="bound">j</span> <span class="main">&lt;</span> <span class="skolem">m</span><span class="main">}</span>›</span></span> 
                    <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
                  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">‹<span class="main">1</span> <span class="main">+</span> <span class="main">(</span><span class="skolem">m</span><span class="main">-</span><span class="main">1</span><span class="main">)</span><span class="main">*</span><span class="skolem">b</span> <span class="main">&lt;</span> <span class="free">n</span>›</span></span> 
                    <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
                  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">‹<span class="main">1</span> <span class="main">+</span> <span class="main">(</span><span class="skolem">m</span><span class="main">-</span><span class="main">1</span><span class="main">)</span><span class="main">*</span><span class="skolem">b</span> <span class="main">≤</span> <span class="free">n</span><span class="main">-</span><span class="main">1</span>›</span></span> 
                    <span class="keyword1"><span class="command">by</span></span> <span class="operator">linarith</span>
                  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">‹<span class="main">1</span> <span class="main">+</span> <span class="main">(</span><span class="skolem">m</span><span class="main">-</span><span class="main">1</span><span class="main">)</span><span class="main">*</span><span class="skolem">b</span> <span class="main">≤</span> <span class="main">1</span><span class="main">+</span><span class="skolem">i</span><span class="main">*</span><span class="skolem">b</span>›</span></span> 
                    <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="free">n</span> <span class="main">-</span> <span class="main">1</span> <span class="main">=</span> <span class="main">1</span> <span class="main">+</span> <span class="skolem">i</span> <span class="main">*</span> <span class="skolem">b</span>›</span></span> 
                    <span class="keyword1"><span class="command">by</span></span> <span class="operator">linarith</span>
                  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">‹<span class="main">(</span><span class="skolem">m</span><span class="main">-</span><span class="main">1</span><span class="main">)</span><span class="main">*</span><span class="skolem">b</span> <span class="main">≤</span> <span class="skolem">i</span><span class="main">*</span><span class="skolem">b</span>›</span></span> 
                    <span class="keyword1"><span class="command">by</span></span> <span class="operator">linarith</span>
                  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">m</span><span class="main">-</span><span class="main">1</span> <span class="main">≤</span> <span class="skolem">i</span>›</span></span> 
                  <span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
                    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">b</span> <span class="main">≠</span> <span class="main">0</span>›</span></span>
                      <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">b</span> <span class="main">=</span> <span class="numeral">2</span>›</span></span>
                      <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
                    <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
                      <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="main">(</span><span class="skolem">m</span> <span class="main">-</span> <span class="main">1</span><span class="main">)</span> <span class="main">*</span> <span class="skolem">b</span> <span class="main">≤</span> <span class="skolem">i</span> <span class="main">*</span> <span class="skolem">b</span>›</span></span> mult_le_cancel2 
                      <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span> 
                  <span class="keyword1"><span class="command">qed</span></span>
                  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">m</span><span class="main">-</span><span class="main">1</span> <span class="main">=</span> <span class="skolem">i</span>›</span></span> 
                    <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">i</span> <span class="main">≤</span> <span class="skolem">m</span> <span class="main">-</span> <span class="main">1</span>›</span></span> le_antisym 
                    <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
                  <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> 
                    <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">m</span> <span class="main">≠</span> <span class="main">0</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="free">n</span> <span class="main">-</span> <span class="main">1</span> <span class="main">=</span> <span class="main">1</span> <span class="main">+</span> <span class="skolem">i</span> <span class="main">*</span> <span class="skolem">b</span>›</span></span>
                    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">b</span> <span class="main">=</span> <span class="numeral">2</span>›</span></span><span class="main">)</span>
                <span class="keyword1"><span class="command">qed</span></span>
                <span class="keyword3"><span class="command">thus</span></span>  <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> 
                  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">m</span> <span class="main">≠</span> <span class="main">0</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="free">n</span> <span class="main">=</span> <span class="numeral">2</span> <span class="main">+</span> <span class="main">(</span><span class="skolem">m</span> <span class="main">-</span> <span class="main">1</span><span class="main">)</span> <span class="main">*</span> <span class="numeral">2</span>›</span></span> mult.commute mult_eq_if<span class="main">)</span>
              <span class="keyword1"><span class="command">qed</span></span>
              <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">j</span> <span class="main">&lt;</span> <span class="skolem">m</span>›</span></span> 
                <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">x</span> <span class="main">&lt;</span> <span class="free">n</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">x</span> <span class="main">=</span> <span class="main">1</span> <span class="main">+</span> <span class="skolem">j</span> <span class="main">*</span> <span class="numeral">2</span>›</span></span> 
                <span class="keyword1"><span class="command">by</span></span> <span class="operator">linarith</span>
              <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">x</span> <span class="main">∈</span> <span class="main">{</span><span class="main">1</span><span class="main">+</span><span class="bound">j</span><span class="main">*</span><span class="numeral">2</span><span class="main">|</span> <span class="bound">j</span><span class="main">::</span>nat<span class="main">.</span> <span class="bound">j</span> <span class="main">&lt;</span> <span class="skolem">m</span><span class="main">}</span>›</span></span> 
                <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">x</span> <span class="main">=</span> <span class="main">1</span> <span class="main">+</span> <span class="skolem">j</span> <span class="main">*</span> <span class="numeral">2</span>›</span></span> 
                <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
              <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">x</span> <span class="main">∈</span> <span class="main">{</span><span class="bound">x</span> <span class="main">|</span> <span class="bound">x</span> <span class="main">::</span> nat<span class="main">.</span> <span class="bound">x</span> <span class="main">&lt;</span> <span class="free">n</span> <span class="main">∧</span> coprime <span class="bound">x</span> <span class="free">n</span><span class="main">}</span>›</span></span> 
                <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="main">{</span><span class="bound">x</span> <span class="main">|</span><span class="bound">x</span><span class="main">.</span> <span class="bound">x</span> <span class="main">&lt;</span> <span class="free">n</span> <span class="main">∧</span> coprime <span class="bound">x</span> <span class="free">n</span><span class="main">}</span> <span class="main">=</span> <span class="main">{</span><span class="main">1</span> <span class="main">+</span> <span class="bound">j</span> <span class="main">*</span> <span class="numeral">2</span> <span class="main">|</span><span class="bound">j</span><span class="main">.</span> <span class="bound">j</span> <span class="main">&lt;</span> <span class="skolem">m</span><span class="main">}</span>›</span></span> 
                <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
              <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> 
                <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
            <span class="keyword1"><span class="command">qed</span></span>
            <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> 
              <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
          <span class="keyword1"><span class="command">qed</span></span>
          <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> 
            <span class="keyword1"><span class="command">using</span></span> coprime_power2 assms 
            <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword1"><span class="command">qed</span></span>
        <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">b</span> <span class="main">=</span> <span class="numeral">4</span> <span class="main">⟹</span> <span class="free">n</span> <span class="main">=</span> <span class="numeral">6</span>›</span></span>
        <span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
          <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">b</span> <span class="main">=</span> <span class="numeral">4</span>›</span></span>
          <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹<span class="free">n</span> <span class="main">=</span> <span class="numeral">2</span> <span class="main">∨</span> <span class="free">n</span> <span class="main">=</span> <span class="numeral">6</span>›</span></span>
          <span class="keyword1"><span class="command">proof</span></span><span class="main">(</span><span class="operator">rule</span> classical<span class="main">)</span>
            <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">‹<span class="main">¬</span> <span class="main">(</span><span class="free">n</span> <span class="main">=</span> <span class="numeral">2</span> <span class="main">∨</span> <span class="free">n</span> <span class="main">=</span> <span class="numeral">6</span><span class="main">)</span>›</span></span>
            <span class="keyword1"><span class="command">have</span></span>  <span class="quoted"><span class="quoted">‹<span class="main">(</span><span class="numeral">4</span><span class="main">::</span>nat<span class="main">)</span> <span class="main">≠</span> <span class="main">0</span>›</span></span> 
              <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
            <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹<span class="free">n</span> <span class="main">=</span>  <span class="numeral">2</span><span class="main">+</span><span class="main">(</span><span class="skolem">m</span><span class="main">-</span><span class="main">1</span><span class="main">)</span><span class="main">*</span><span class="numeral">4</span>›</span></span> 
            <span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
              <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹<span class="free">n</span><span class="main">-</span><span class="main">1</span> <span class="main">∈</span> <span class="main">{</span><span class="bound">x</span> <span class="main">|</span> <span class="bound">x</span> <span class="main">::</span> nat<span class="main">.</span> <span class="bound">x</span> <span class="main">&lt;</span> <span class="free">n</span> <span class="main">∧</span> coprime <span class="bound">x</span> <span class="free">n</span><span class="main">}</span>›</span></span> 
                <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="main">1</span> <span class="main">&lt;</span> <span class="free">n</span>›</span></span> coprime_diff_one_left_nat 
                <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
              <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹<span class="free">n</span><span class="main">-</span><span class="main">1</span> <span class="main">∈</span> <span class="main">{</span><span class="main">1</span><span class="main">+</span><span class="bound">j</span><span class="main">*</span><span class="skolem">b</span><span class="main">|</span> <span class="bound">j</span><span class="main">::</span>nat<span class="main">.</span> <span class="bound">j</span> <span class="main">&lt;</span> <span class="skolem">m</span><span class="main">}</span>›</span></span> 
                <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="free">n</span> <span class="main">-</span> <span class="main">1</span> <span class="main">∈</span> <span class="main">{</span><span class="bound">x</span> <span class="main">|</span><span class="bound">x</span><span class="main">.</span> <span class="bound">x</span> <span class="main">&lt;</span> <span class="free">n</span> <span class="main">∧</span> coprime <span class="bound">x</span> <span class="free">n</span><span class="main">}</span>›</span></span> 
                  <span class="quoted"><span class="quoted">‹<span class="main">{</span><span class="bound">x</span> <span class="main">|</span><span class="bound">x</span><span class="main">.</span> <span class="bound">x</span> <span class="main">&lt;</span> <span class="free">n</span> <span class="main">∧</span> coprime <span class="bound">x</span> <span class="free">n</span><span class="main">}</span> <span class="main">=</span> <span class="main">{</span><span class="main">1</span> <span class="main">+</span> <span class="bound">j</span> <span class="main">*</span> <span class="skolem">b</span> <span class="main">|</span><span class="bound">j</span><span class="main">.</span> <span class="bound">j</span> <span class="main">&lt;</span> <span class="skolem">m</span><span class="main">}</span>›</span></span> 
                <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
              <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">i</span></span><span class="main">::</span><span class="quoted">nat</span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">‹<span class="free">n</span><span class="main">-</span><span class="main">1</span> <span class="main">=</span> <span class="main">1</span><span class="main">+</span><span class="skolem">i</span><span class="main">*</span><span class="skolem">b</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">i</span> <span class="main">&lt;</span> <span class="skolem">m</span>›</span></span> 
                <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
              <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">i</span> <span class="main">≤</span> <span class="skolem">m</span><span class="main">-</span><span class="main">1</span>›</span></span> 
                <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">i</span> <span class="main">&lt;</span> <span class="skolem">m</span>›</span></span> 
                <span class="keyword1"><span class="command">by</span></span> <span class="operator">linarith</span>
              <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹<span class="main">1</span> <span class="main">+</span> <span class="main">(</span><span class="skolem">m</span><span class="main">-</span><span class="main">1</span><span class="main">)</span><span class="main">*</span><span class="skolem">b</span> <span class="main">∈</span> <span class="main">{</span><span class="main">1</span><span class="main">+</span><span class="bound">j</span><span class="main">*</span><span class="skolem">b</span><span class="main">|</span> <span class="bound">j</span><span class="main">::</span>nat<span class="main">.</span> <span class="bound">j</span> <span class="main">&lt;</span> <span class="skolem">m</span><span class="main">}</span>›</span></span> 
                <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">m</span> <span class="main">≠</span> <span class="main">0</span>›</span></span> 
                <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
              <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">‹<span class="main">1</span> <span class="main">+</span> <span class="main">(</span><span class="skolem">m</span><span class="main">-</span><span class="main">1</span><span class="main">)</span><span class="main">*</span><span class="skolem">b</span> <span class="main">∈</span> <span class="main">{</span><span class="bound">x</span> <span class="main">|</span> <span class="bound">x</span> <span class="main">::</span> nat<span class="main">.</span> <span class="bound">x</span> <span class="main">&lt;</span> <span class="free">n</span> <span class="main">∧</span> coprime <span class="bound">x</span> <span class="free">n</span><span class="main">}</span>›</span></span> 
                <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="main">{</span><span class="bound">x</span> <span class="main">|</span><span class="bound">x</span><span class="main">.</span> <span class="bound">x</span> <span class="main">&lt;</span> <span class="free">n</span> <span class="main">∧</span> coprime <span class="bound">x</span> <span class="free">n</span><span class="main">}</span> <span class="main">=</span> <span class="main">{</span><span class="main">1</span> <span class="main">+</span> <span class="bound">j</span> <span class="main">*</span> <span class="skolem">b</span> <span class="main">|</span><span class="bound">j</span><span class="main">.</span> <span class="bound">j</span> <span class="main">&lt;</span> <span class="skolem">m</span><span class="main">}</span>›</span></span> 
                <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
              <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">‹<span class="main">1</span> <span class="main">+</span> <span class="main">(</span><span class="skolem">m</span><span class="main">-</span><span class="main">1</span><span class="main">)</span><span class="main">*</span><span class="skolem">b</span> <span class="main">&lt;</span> <span class="free">n</span>›</span></span> 
                <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
              <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">‹<span class="main">1</span> <span class="main">+</span> <span class="main">(</span><span class="skolem">m</span><span class="main">-</span><span class="main">1</span><span class="main">)</span><span class="main">*</span><span class="skolem">b</span> <span class="main">≤</span> <span class="free">n</span><span class="main">-</span><span class="main">1</span>›</span></span> 
                <span class="keyword1"><span class="command">by</span></span> <span class="operator">linarith</span>
              <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">‹<span class="main">1</span> <span class="main">+</span> <span class="main">(</span><span class="skolem">m</span><span class="main">-</span><span class="main">1</span><span class="main">)</span><span class="main">*</span><span class="skolem">b</span> <span class="main">≤</span> <span class="main">1</span><span class="main">+</span><span class="skolem">i</span><span class="main">*</span><span class="skolem">b</span>›</span></span> 
                <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="free">n</span> <span class="main">-</span> <span class="main">1</span> <span class="main">=</span> <span class="main">1</span> <span class="main">+</span> <span class="skolem">i</span> <span class="main">*</span> <span class="skolem">b</span>›</span></span> 
                <span class="keyword1"><span class="command">by</span></span> <span class="operator">linarith</span>
              <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">‹<span class="main">(</span><span class="skolem">m</span><span class="main">-</span><span class="main">1</span><span class="main">)</span><span class="main">*</span><span class="skolem">b</span> <span class="main">≤</span> <span class="skolem">i</span><span class="main">*</span><span class="skolem">b</span>›</span></span> 
                <span class="keyword1"><span class="command">by</span></span> <span class="operator">linarith</span>
              <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">m</span><span class="main">-</span><span class="main">1</span> <span class="main">≤</span> <span class="skolem">i</span>›</span></span> 
              <span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
                <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">b</span> <span class="main">≠</span> <span class="main">0</span>›</span></span>
                  <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">b</span> <span class="main">=</span> <span class="numeral">4</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
                <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
                  <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="main">(</span><span class="skolem">m</span> <span class="main">-</span> <span class="main">1</span><span class="main">)</span> <span class="main">*</span> <span class="skolem">b</span> <span class="main">≤</span> <span class="skolem">i</span> <span class="main">*</span> <span class="skolem">b</span>›</span></span> mult_le_cancel2 
                  <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span> 
              <span class="keyword1"><span class="command">qed</span></span>
              <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">m</span><span class="main">-</span><span class="main">1</span> <span class="main">=</span> <span class="skolem">i</span>›</span></span> 
                <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">i</span> <span class="main">≤</span> <span class="skolem">m</span> <span class="main">-</span> <span class="main">1</span>›</span></span> le_antisym 
                <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
              <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> 
                <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">m</span> <span class="main">≠</span> <span class="main">0</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="free">n</span> <span class="main">-</span> <span class="main">1</span> <span class="main">=</span> <span class="main">1</span> <span class="main">+</span> <span class="skolem">i</span> <span class="main">*</span> <span class="skolem">b</span>›</span></span>
                <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">b</span> <span class="main">=</span> <span class="numeral">4</span>›</span></span><span class="main">)</span> 
            <span class="keyword1"><span class="command">qed</span></span>
            <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">‹<span class="free">n</span> <span class="main">=</span> <span class="numeral">4</span><span class="main">*</span><span class="skolem">m</span> <span class="main">-</span> <span class="numeral">2</span>›</span></span> 
              <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">m</span> <span class="main">≠</span> <span class="main">0</span>›</span></span> mult.commute mult_eq_if<span class="main">)</span>
            <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">m</span> <span class="main">≥</span> <span class="numeral">3</span>›</span></span> 
              <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="main">¬</span> <span class="main">(</span><span class="free">n</span> <span class="main">=</span> <span class="numeral">2</span> <span class="main">∨</span> <span class="free">n</span> <span class="main">=</span> <span class="numeral">6</span><span class="main">)</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="free">n</span> <span class="main">=</span> <span class="numeral">2</span> <span class="main">+</span> <span class="main">(</span><span class="skolem">m</span> <span class="main">-</span> <span class="main">1</span><span class="main">)</span> <span class="main">*</span> <span class="numeral">4</span>›</span></span> 
              <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
            <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">‹ <span class="main">{</span><span class="main">1</span><span class="main">+</span><span class="bound">j</span><span class="main">*</span><span class="numeral">4</span><span class="main">|</span> <span class="bound">j</span><span class="main">::</span>nat<span class="main">.</span> <span class="bound">j</span> <span class="main">&lt;</span> <span class="numeral">3</span><span class="main">}</span> <span class="main">⊆</span> <span class="main">{</span><span class="main">1</span><span class="main">+</span><span class="bound">j</span><span class="main">*</span><span class="numeral">4</span><span class="main">|</span> <span class="bound">j</span><span class="main">::</span>nat<span class="main">.</span> <span class="bound">j</span> <span class="main">&lt;</span> <span class="skolem">m</span><span class="main">}</span>›</span></span>
              <span class="keyword1"><span class="command">by</span></span> <span class="operator">force</span>
            <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">‹<span class="numeral">9</span> <span class="main">∈</span> <span class="main">{</span><span class="main">1</span><span class="main">+</span><span class="bound">j</span><span class="main">*</span><span class="numeral">4</span><span class="main">|</span> <span class="bound">j</span><span class="main">::</span>nat<span class="main">.</span> <span class="bound">j</span> <span class="main">&lt;</span> <span class="numeral">3</span><span class="main">}</span>›</span></span> 
              <span class="keyword1"><span class="command">by</span></span> <span class="operator">force</span>
            <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">‹<span class="numeral">9</span> <span class="main">∈</span> <span class="main">{</span><span class="main">1</span><span class="main">+</span><span class="bound">j</span><span class="main">*</span><span class="numeral">4</span><span class="main">|</span> <span class="bound">j</span><span class="main">::</span>nat<span class="main">.</span> <span class="bound">j</span> <span class="main">&lt;</span> <span class="skolem">m</span><span class="main">}</span>›</span></span> 
              <span class="keyword1"><span class="command">using</span></span>  <span class="quoted"><span class="quoted">‹ <span class="main">{</span><span class="main">1</span><span class="main">+</span><span class="bound">j</span><span class="main">*</span><span class="numeral">4</span><span class="main">|</span> <span class="bound">j</span><span class="main">::</span>nat<span class="main">.</span> <span class="bound">j</span> <span class="main">&lt;</span> <span class="numeral">3</span><span class="main">}</span> <span class="main">⊆</span> <span class="main">{</span><span class="main">1</span><span class="main">+</span><span class="bound">j</span><span class="main">*</span><span class="numeral">4</span><span class="main">|</span> <span class="bound">j</span><span class="main">::</span>nat<span class="main">.</span> <span class="bound">j</span> <span class="main">&lt;</span> <span class="skolem">m</span><span class="main">}</span>›</span></span> 
              <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
            <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">‹<span class="numeral">9</span> <span class="main">∈</span> <span class="main">{</span><span class="bound">x</span> <span class="main">|</span> <span class="bound">x</span> <span class="main">::</span> nat<span class="main">.</span> <span class="bound">x</span> <span class="main">&lt;</span> <span class="free">n</span> <span class="main">∧</span> coprime <span class="bound">x</span> <span class="free">n</span><span class="main">}</span>›</span></span>
              <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">b</span> <span class="main">=</span> <span class="numeral">4</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="main">{</span><span class="bound">x</span> <span class="main">|</span><span class="bound">x</span><span class="main">.</span> <span class="bound">x</span> <span class="main">&lt;</span> <span class="free">n</span> <span class="main">∧</span> coprime <span class="bound">x</span> <span class="free">n</span><span class="main">}</span> <span class="main">=</span> <span class="main">{</span><span class="main">1</span> <span class="main">+</span> <span class="bound">j</span> <span class="main">*</span> <span class="skolem">b</span> <span class="main">|</span><span class="bound">j</span><span class="main">.</span> <span class="bound">j</span> <span class="main">&lt;</span> <span class="skolem">m</span><span class="main">}</span>›</span></span> 
              <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
            <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">‹coprime <span class="main">(</span><span class="numeral">9</span><span class="main">::</span>nat<span class="main">)</span> <span class="free">n</span>›</span></span> 
              <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
            <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹<span class="main">(</span><span class="numeral">3</span><span class="main">::</span>nat<span class="main">)</span> <span class="keyword1">dvd</span> <span class="numeral">9</span>›</span></span> 
              <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
            <span class="keyword1"><span class="command">have</span></span>  <span class="quoted"><span class="quoted">‹coprime <span class="main">(</span><span class="numeral">3</span><span class="main">::</span>nat<span class="main">)</span> <span class="free">n</span>›</span></span> <span class="keyword1"><span class="command">using</span></span>  <span class="quoted"><span class="quoted">‹coprime <span class="main">(</span><span class="numeral">9</span><span class="main">::</span>nat<span class="main">)</span> <span class="free">n</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="main">(</span><span class="numeral">3</span><span class="main">::</span>nat<span class="main">)</span> <span class="keyword1">dvd</span> <span class="numeral">9</span>›</span></span>
              <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> coprime_commute coprime_mult_right_iff dvd_def<span class="main">)</span>
            <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹<span class="main">(</span><span class="numeral">3</span><span class="main">::</span>nat<span class="main">)</span> <span class="main">&lt;</span> <span class="free">n</span>›</span></span> 
              <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> One_nat_def Suc_lessI <span class="quoted"><span class="quoted">‹<span class="main">1</span> <span class="main">&lt;</span> <span class="free">n</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="main">¬</span> <span class="main">(</span><span class="free">n</span> <span class="main">=</span> <span class="numeral">2</span> <span class="main">∨</span> <span class="free">n</span> <span class="main">=</span> <span class="numeral">6</span><span class="main">)</span>›</span></span> <span class="quoted"><span class="quoted">‹coprime <span class="numeral">3</span> <span class="free">n</span>›</span></span>
                  coprime_self numeral_2_eq_2 numeral_3_eq_3 less_numeral_extra<span class="main"><span class="main">(</span></span>1<span class="main"><span class="main">)</span></span> nat_dvd_not_less<span class="main">)</span>
            <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹<span class="numeral">3</span> <span class="main">∈</span>  <span class="main">{</span><span class="bound">x</span> <span class="main">|</span> <span class="bound">x</span> <span class="main">::</span> nat<span class="main">.</span> <span class="bound">x</span> <span class="main">&lt;</span> <span class="free">n</span> <span class="main">∧</span> coprime <span class="bound">x</span> <span class="free">n</span><span class="main">}</span>›</span></span> 
              <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="numeral">3</span> <span class="main">&lt;</span> <span class="free">n</span>›</span></span> <span class="quoted"><span class="quoted">‹coprime <span class="numeral">3</span> <span class="free">n</span>›</span></span> 
              <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
            <span class="keyword1"><span class="command">hence</span></span>  <span class="quoted"><span class="quoted">‹<span class="main">(</span><span class="numeral">3</span><span class="main">::</span>nat<span class="main">)</span> <span class="main">∈</span> <span class="main">{</span><span class="main">1</span><span class="main">+</span><span class="bound">j</span><span class="main">*</span><span class="numeral">4</span><span class="main">|</span> <span class="bound">j</span><span class="main">::</span>nat<span class="main">.</span> <span class="bound">j</span> <span class="main">&lt;</span> <span class="skolem">m</span><span class="main">}</span>›</span></span>
              <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">b</span> <span class="main">=</span> <span class="numeral">4</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="main">{</span><span class="bound">x</span> <span class="main">|</span><span class="bound">x</span><span class="main">.</span> <span class="bound">x</span> <span class="main">&lt;</span> <span class="free">n</span> <span class="main">∧</span> coprime <span class="bound">x</span> <span class="free">n</span><span class="main">}</span> <span class="main">=</span> <span class="main">{</span><span class="main">1</span> <span class="main">+</span> <span class="bound">j</span> <span class="main">*</span> <span class="skolem">b</span> <span class="main">|</span><span class="bound">j</span><span class="main">.</span> <span class="bound">j</span> <span class="main">&lt;</span> <span class="skolem">m</span><span class="main">}</span>›</span></span> 
              <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
            <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">j</span></span><span class="main">::</span><span class="quoted">nat</span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">‹<span class="main">(</span><span class="numeral">3</span><span class="main">::</span>nat<span class="main">)</span> <span class="main">=</span> <span class="main">1</span> <span class="main">+</span> <span class="skolem">j</span><span class="main">*</span><span class="numeral">4</span>›</span></span> 
              <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>  
            <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹<span class="numeral">2</span> <span class="main">=</span> <span class="skolem">j</span><span class="main">*</span><span class="numeral">4</span>›</span></span> 
              <span class="keyword1"><span class="command">using</span></span> numeral_3_eq_3 <span class="quoted"><span class="quoted">‹<span class="main">(</span><span class="numeral">3</span><span class="main">::</span>nat<span class="main">)</span> <span class="main">=</span> <span class="main">1</span> <span class="main">+</span> <span class="skolem">j</span><span class="main">*</span><span class="numeral">4</span>›</span></span>
              <span class="keyword1"><span class="command">by</span></span> <span class="operator">linarith</span>
            <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">‹<span class="main">1</span> <span class="main">=</span> <span class="skolem">j</span><span class="main">*</span><span class="numeral">2</span>›</span></span> 
              <span class="keyword1"><span class="command">by</span></span> <span class="operator">linarith</span>
            <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">‹even <span class="main">1</span>›</span></span> 
              <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
            <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> 
              <span class="keyword1"><span class="command">using</span></span> odd_one 
              <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
          <span class="keyword1"><span class="command">qed</span></span>
          <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
            <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> False<span class="main">)</span>            
        <span class="keyword1"><span class="command">qed</span></span>
        <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> 
          <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
      <span class="keyword1"><span class="command">qed</span></span>
    <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹<span class="main">(</span><span class="main">∃</span> <span class="bound">b</span> <span class="bound">m</span><span class="main">.</span> <span class="bound">m</span> <span class="main">≠</span> <span class="main">0</span> <span class="main">∧</span> <span class="main">{</span><span class="bound">x</span> <span class="main">|</span> <span class="bound">x</span> <span class="main">::</span> nat<span class="main">.</span> <span class="bound">x</span> <span class="main">&lt;</span> <span class="free">n</span> <span class="main">∧</span> coprime <span class="bound">x</span> <span class="free">n</span><span class="main">}</span> <span class="main">=</span> <span class="main">{</span><span class="main">1</span><span class="main">+</span><span class="bound">j</span><span class="main">*</span><span class="bound">b</span><span class="main">|</span> <span class="bound">j</span><span class="main">::</span>nat<span class="main">.</span> <span class="bound">j</span> <span class="main">&lt;</span> <span class="bound">m</span><span class="main">}</span><span class="main">)</span>
  <span class="main">⟷</span> <span class="main">(</span><span class="main">∃</span> <span class="bound">a</span> <span class="bound">b</span> <span class="bound">m</span><span class="main">.</span> <span class="bound">m</span> <span class="main">≠</span> <span class="main">0</span> <span class="main">∧</span> <span class="main">{</span><span class="bound">x</span> <span class="main">|</span> <span class="bound">x</span> <span class="main">::</span> nat<span class="main">.</span> <span class="bound">x</span> <span class="main">&lt;</span> <span class="free">n</span> <span class="main">∧</span> coprime <span class="bound">x</span> <span class="free">n</span><span class="main">}</span> <span class="main">=</span> <span class="main">{</span><span class="bound">a</span><span class="main">+</span><span class="bound">j</span><span class="main">*</span><span class="bound">b</span><span class="main">|</span> <span class="bound">j</span><span class="main">::</span>nat<span class="main">.</span> <span class="bound">j</span> <span class="main">&lt;</span> <span class="bound">m</span><span class="main">}</span><span class="main">)</span>›</span></span>
  <span class="keyword1"><span class="command">proof</span></span>
    <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound">a</span> <span class="bound">b</span> <span class="bound">m</span><span class="main">.</span> <span class="bound">m</span> <span class="main">≠</span> <span class="main">0</span> <span class="main">∧</span> <span class="main">{</span><span class="bound">x</span> <span class="main">|</span><span class="bound">x</span><span class="main">.</span> <span class="bound">x</span> <span class="main">&lt;</span> <span class="free">n</span> <span class="main">∧</span> coprime <span class="bound">x</span> <span class="free">n</span><span class="main">}</span> <span class="main">=</span> <span class="main">{</span><span class="bound">a</span> <span class="main">+</span> <span class="bound">j</span> <span class="main">*</span> <span class="bound">b</span> <span class="main">|</span><span class="bound">j</span><span class="main">.</span> <span class="bound">j</span> <span class="main">&lt;</span> <span class="bound">m</span><span class="main">}</span>"</span></span>
      <span class="keyword2"><span class="keyword">if</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound">b</span> <span class="bound">m</span><span class="main">.</span> <span class="bound">m</span> <span class="main">≠</span> <span class="main">0</span> <span class="main">∧</span> <span class="main">{</span><span class="bound">x</span> <span class="main">|</span><span class="bound">x</span><span class="main">.</span> <span class="bound">x</span> <span class="main">&lt;</span> <span class="free">n</span> <span class="main">∧</span> coprime <span class="bound">x</span> <span class="free">n</span><span class="main">}</span> <span class="main">=</span> <span class="main">{</span><span class="main">1</span> <span class="main">+</span> <span class="bound">j</span> <span class="main">*</span> <span class="bound">b</span> <span class="main">|</span><span class="bound">j</span><span class="main">.</span> <span class="bound">j</span> <span class="main">&lt;</span> <span class="bound">m</span><span class="main">}</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> that
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span> 
    <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound">b</span> <span class="bound">m</span><span class="main">.</span> <span class="bound">m</span> <span class="main">≠</span> <span class="main">0</span> <span class="main">∧</span> <span class="main">{</span><span class="bound">x</span> <span class="main">|</span><span class="bound">x</span><span class="main">.</span> <span class="bound">x</span> <span class="main">&lt;</span> <span class="free">n</span> <span class="main">∧</span> coprime <span class="bound">x</span> <span class="free">n</span><span class="main">}</span> <span class="main">=</span> <span class="main">{</span><span class="main">1</span> <span class="main">+</span> <span class="bound">j</span> <span class="main">*</span> <span class="bound">b</span> <span class="main">|</span><span class="bound">j</span><span class="main">.</span> <span class="bound">j</span> <span class="main">&lt;</span> <span class="bound">m</span><span class="main">}</span>"</span></span>
      <span class="keyword2"><span class="keyword">if</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound">a</span> <span class="bound">b</span> <span class="bound">m</span><span class="main">.</span> <span class="bound">m</span> <span class="main">≠</span> <span class="main">0</span> <span class="main">∧</span> <span class="main">{</span><span class="bound">x</span> <span class="main">|</span><span class="bound">x</span><span class="main">.</span> <span class="bound">x</span> <span class="main">&lt;</span> <span class="free">n</span> <span class="main">∧</span> coprime <span class="bound">x</span> <span class="free">n</span><span class="main">}</span> <span class="main">=</span> <span class="main">{</span><span class="bound">a</span> <span class="main">+</span> <span class="bound">j</span> <span class="main">*</span> <span class="bound">b</span> <span class="main">|</span><span class="bound">j</span><span class="main">.</span> <span class="bound">j</span> <span class="main">&lt;</span> <span class="bound">m</span><span class="main">}</span>"</span></span>
    <span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
      <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">a</span></span> <span class="skolem"><span class="skolem">b</span></span> <span class="skolem"><span class="skolem">m</span></span><span class="main">::</span><span class="quoted">nat</span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">m</span> <span class="main">≠</span> <span class="main">0</span>›</span></span>
        <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹<span class="main">{</span><span class="bound">x</span> <span class="main">|</span> <span class="bound">x</span> <span class="main">::</span> nat<span class="main">.</span> <span class="bound">x</span> <span class="main">&lt;</span> <span class="free">n</span> <span class="main">∧</span> coprime <span class="bound">x</span> <span class="free">n</span><span class="main">}</span> <span class="main">=</span> <span class="main">{</span><span class="skolem">a</span><span class="main">+</span><span class="bound">j</span><span class="main">*</span><span class="skolem">b</span><span class="main">|</span> <span class="bound">j</span><span class="main">::</span>nat<span class="main">.</span> <span class="bound">j</span> <span class="main">&lt;</span> <span class="skolem">m</span><span class="main">}</span>›</span></span>
        <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="main">∃</span><span class="bound">a</span> <span class="bound">b</span> <span class="bound">m</span><span class="main">.</span> <span class="bound">m</span> <span class="main">≠</span> <span class="main">0</span> <span class="main">∧</span> <span class="main">{</span><span class="bound">x</span> <span class="main">|</span><span class="bound">x</span><span class="main">.</span> <span class="bound">x</span> <span class="main">&lt;</span> <span class="free">n</span> <span class="main">∧</span> coprime <span class="bound">x</span> <span class="free">n</span><span class="main">}</span> <span class="main">=</span> <span class="main">{</span><span class="bound">a</span> <span class="main">+</span> <span class="bound">j</span> <span class="main">*</span> <span class="bound">b</span> <span class="main">|</span><span class="bound">j</span><span class="main">.</span> <span class="bound">j</span> <span class="main">&lt;</span> <span class="bound">m</span><span class="main">}</span>›</span></span> 
        <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>        
      <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">a</span> <span class="main">=</span> <span class="main">1</span>›</span></span> 
      <span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
        <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹<span class="main">{</span><span class="bound">x</span> <span class="main">|</span> <span class="bound">x</span> <span class="main">::</span> nat<span class="main">.</span> <span class="bound">x</span> <span class="main">&lt;</span> <span class="free">n</span> <span class="main">∧</span> coprime <span class="bound">x</span> <span class="free">n</span><span class="main">}</span> <span class="main">=</span> <span class="main">{</span><span class="main">(</span><span class="skolem">a</span><span class="main">::</span>nat<span class="main">)</span><span class="main">+</span><span class="bound">j</span><span class="main">*</span><span class="main">(</span><span class="skolem">b</span><span class="main">::</span>nat<span class="main">)</span><span class="main">|</span> <span class="bound">j</span><span class="main">::</span>nat<span class="main">.</span> <span class="bound">j</span> <span class="main">&lt;</span> <span class="skolem">m</span><span class="main">}</span> <span class="main">⟹</span> <span class="skolem">a</span> <span class="main">=</span> <span class="main">1</span>›</span></span>
        <span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
          <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹Min <span class="main">{</span><span class="bound">x</span> <span class="main">|</span> <span class="bound">x</span> <span class="main">::</span> nat<span class="main">.</span> <span class="bound">x</span> <span class="main">&lt;</span> <span class="free">n</span> <span class="main">∧</span> coprime <span class="bound">x</span> <span class="free">n</span><span class="main">}</span> <span class="main">=</span> Min <span class="main">{</span><span class="skolem">a</span><span class="main">+</span><span class="bound">j</span><span class="main">*</span><span class="skolem">b</span><span class="main">|</span> <span class="bound">j</span><span class="main">::</span>nat<span class="main">.</span> <span class="bound">j</span> <span class="main">&lt;</span> <span class="skolem">m</span><span class="main">}</span>›</span></span>
            <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="main">{</span><span class="bound">x</span> <span class="main">|</span><span class="bound">x</span><span class="main">.</span> <span class="bound">x</span> <span class="main">&lt;</span> <span class="free">n</span> <span class="main">∧</span> coprime <span class="bound">x</span> <span class="free">n</span><span class="main">}</span> <span class="main">=</span> <span class="main">{</span><span class="skolem">a</span> <span class="main">+</span> <span class="bound">j</span> <span class="main">*</span> <span class="skolem">b</span> <span class="main">|</span><span class="bound">j</span><span class="main">.</span> <span class="bound">j</span> <span class="main">&lt;</span> <span class="skolem">m</span><span class="main">}</span>›</span></span> 
            <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>            
          <span class="keyword1"><span class="command">have</span></span>  <span class="quoted"><span class="quoted">‹Min <span class="main">{</span><span class="bound">x</span> <span class="main">|</span> <span class="bound">x</span> <span class="main">::</span> nat<span class="main">.</span> <span class="bound">x</span> <span class="main">&lt;</span> <span class="free">n</span> <span class="main">∧</span> coprime <span class="bound">x</span> <span class="free">n</span><span class="main">}</span> <span class="main">=</span> <span class="main">1</span>›</span></span>
          <span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
            <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹finite <span class="main">{</span><span class="bound">x</span> <span class="main">|</span> <span class="bound">x</span> <span class="main">::</span> nat<span class="main">.</span> <span class="bound">x</span> <span class="main">&lt;</span> <span class="free">n</span> <span class="main">∧</span> coprime <span class="bound">x</span> <span class="free">n</span><span class="main">}</span>›</span></span>
              <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
            <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹<span class="main">{</span><span class="bound">x</span> <span class="main">|</span> <span class="bound">x</span> <span class="main">::</span> nat<span class="main">.</span> <span class="bound">x</span> <span class="main">&lt;</span> <span class="free">n</span> <span class="main">∧</span> coprime <span class="bound">x</span> <span class="free">n</span><span class="main">}</span> <span class="main">≠</span> <span class="main">{}</span>›</span></span> 
              <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="main">1</span> <span class="main">&lt;</span> <span class="free">n</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
            <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹<span class="main">1</span> <span class="main">∈</span> <span class="main">{</span><span class="bound">x</span> <span class="main">|</span> <span class="bound">x</span> <span class="main">::</span> nat<span class="main">.</span> <span class="bound">x</span> <span class="main">&lt;</span> <span class="free">n</span> <span class="main">∧</span> coprime <span class="bound">x</span> <span class="free">n</span><span class="main">}</span>›</span></span> 
              <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="main">1</span> <span class="main">&lt;</span> <span class="free">n</span>›</span></span> 
              <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
            <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹<span class="main">∀</span> <span class="bound">x</span><span class="main">.</span> coprime <span class="bound">x</span> <span class="free">n</span> <span class="main">⟶</span> <span class="bound">x</span> <span class="main">≥</span> <span class="main">1</span>›</span></span> 
              <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="main">1</span> <span class="main">&lt;</span> <span class="free">n</span>›</span></span> le_less_linear 
              <span class="keyword1"><span class="command">by</span></span> <span class="operator">fastforce</span>
            <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">‹<span class="main">∀</span> <span class="bound">x</span><span class="main">.</span>  <span class="bound">x</span> <span class="main">&lt;</span> <span class="free">n</span> <span class="main">∧</span> coprime <span class="bound">x</span> <span class="free">n</span> <span class="main">⟶</span> <span class="bound">x</span> <span class="main">≥</span> <span class="main">1</span>›</span></span> 
              <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
            <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">‹<span class="main">∀</span> <span class="bound">x</span> <span class="main">∈</span> <span class="main">{</span><span class="bound">x</span> <span class="main">|</span> <span class="bound">x</span> <span class="main">::</span> nat<span class="main">.</span> <span class="bound">x</span> <span class="main">&lt;</span> <span class="free">n</span> <span class="main">∧</span> coprime <span class="bound">x</span> <span class="free">n</span><span class="main">}</span><span class="main">.</span> <span class="bound">x</span> <span class="main">≥</span> <span class="main">1</span>›</span></span> 
              <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
            <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">‹Min <span class="main">{</span><span class="bound">x</span> <span class="main">|</span> <span class="bound">x</span> <span class="main">::</span> nat<span class="main">.</span> <span class="bound">x</span> <span class="main">&lt;</span> <span class="free">n</span> <span class="main">∧</span> coprime <span class="bound">x</span> <span class="free">n</span><span class="main">}</span> <span class="main">≥</span> <span class="main">1</span>›</span></span> 
              <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹finite <span class="main">{</span><span class="bound">x</span> <span class="main">|</span> <span class="bound">x</span> <span class="main">::</span> nat<span class="main">.</span> <span class="bound">x</span> <span class="main">&lt;</span> <span class="free">n</span> <span class="main">∧</span> coprime <span class="bound">x</span> <span class="free">n</span><span class="main">}</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="main">{</span><span class="bound">x</span> <span class="main">|</span><span class="bound">x</span><span class="main">.</span> <span class="bound">x</span> <span class="main">&lt;</span> <span class="free">n</span> <span class="main">∧</span> coprime <span class="bound">x</span> <span class="free">n</span><span class="main">}</span> <span class="main">≠</span> <span class="main">{}</span>›</span></span>
              <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
            <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> 
              <span class="keyword1"><span class="command">using</span></span> Min_le <span class="quoted"><span class="quoted">‹<span class="main">1</span> <span class="main">∈</span> <span class="main">{</span><span class="bound">x</span> <span class="main">|</span><span class="bound">x</span><span class="main">.</span> <span class="bound">x</span> <span class="main">&lt;</span> <span class="free">n</span> <span class="main">∧</span> coprime <span class="bound">x</span> <span class="free">n</span><span class="main">}</span>›</span></span> <span class="quoted"><span class="quoted">‹finite <span class="main">{</span><span class="bound">x</span> <span class="main">|</span><span class="bound">x</span><span class="main">.</span> <span class="bound">x</span> <span class="main">&lt;</span> <span class="free">n</span> <span class="main">∧</span> coprime <span class="bound">x</span> <span class="free">n</span><span class="main">}</span>›</span></span>
                antisym <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
          <span class="keyword1"><span class="command">qed</span></span>
          <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹Min  <span class="main">{</span><span class="skolem">a</span><span class="main">+</span><span class="bound">j</span><span class="main">*</span><span class="skolem">b</span><span class="main">|</span> <span class="bound">j</span><span class="main">::</span>nat<span class="main">.</span> <span class="bound">j</span> <span class="main">&lt;</span> <span class="skolem">m</span><span class="main">}</span> <span class="main">=</span> <span class="skolem">a</span>›</span></span>
          <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
            <span class="keyword1"><span class="command">have</span></span> f1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound">n</span><span class="main">.</span> <span class="skolem">a</span> <span class="main">=</span> <span class="skolem">a</span> <span class="main">+</span> <span class="bound">n</span> <span class="main">*</span> <span class="skolem">b</span> <span class="main">∧</span> <span class="bound">n</span> <span class="main">&lt;</span> <span class="skolem">m</span>"</span></span>
              <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">m</span> <span class="main">≠</span> <span class="main">0</span>›</span></span> 
              <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
            <span class="keyword1"><span class="command">have</span></span> f2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound">n</span><span class="main">.</span> <span class="main">1</span> <span class="main">=</span> <span class="skolem">a</span> <span class="main">+</span> <span class="bound">n</span> <span class="main">*</span> <span class="skolem">b</span> <span class="main">∧</span> <span class="bound">n</span> <span class="main">&lt;</span> <span class="skolem">m</span>"</span></span>
              <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="main">{</span><span class="bound">x</span> <span class="main">|</span><span class="bound">x</span><span class="main">.</span> <span class="bound">x</span> <span class="main">&lt;</span> <span class="free">n</span> <span class="main">∧</span> coprime <span class="bound">x</span> <span class="free">n</span><span class="main">}</span> <span class="main">=</span> <span class="main">{</span><span class="skolem">a</span> <span class="main">+</span> <span class="bound">j</span> <span class="main">*</span> <span class="skolem">b</span> <span class="main">|</span><span class="bound">j</span><span class="main">.</span> <span class="bound">j</span> <span class="main">&lt;</span> <span class="skolem">m</span><span class="main">}</span>›</span></span> assms coprime_1_left 
              <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
            <span class="keyword1"><span class="command">have</span></span> f3<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound">na</span><span class="main">.</span> <span class="skolem">a</span> <span class="main">=</span> <span class="bound">na</span> <span class="main">∧</span> <span class="bound">na</span> <span class="main">&lt;</span> <span class="free">n</span> <span class="main">∧</span> coprime <span class="bound">na</span> <span class="free">n</span>"</span></span>
              <span class="keyword1"><span class="command">using</span></span> f1 <span class="quoted"><span class="quoted">‹<span class="main">{</span><span class="bound">x</span> <span class="main">|</span><span class="bound">x</span><span class="main">.</span> <span class="bound">x</span> <span class="main">&lt;</span> <span class="free">n</span> <span class="main">∧</span> coprime <span class="bound">x</span> <span class="free">n</span><span class="main">}</span> <span class="main">=</span> <span class="main">{</span><span class="skolem">a</span> <span class="main">+</span> <span class="bound">j</span> <span class="main">*</span> <span class="skolem">b</span> <span class="main">|</span><span class="bound">j</span><span class="main">.</span> <span class="bound">j</span> <span class="main">&lt;</span> <span class="skolem">m</span><span class="main">}</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
            <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">n</span> <span class="main">≠</span> <span class="main">1</span>"</span></span>
              <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> <span class="main"><span class="main">(</span></span>lifting<span class="main"><span class="main">)</span></span> assms less_irrefl_nat<span class="main">)</span>
            <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> coprime <span class="main">0</span> <span class="free">n</span>"</span></span>
              <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
            <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
              <span class="keyword1"><span class="command">using</span></span> f3 f2 <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> <span class="quoted"><span class="quoted">‹Min <span class="main">{</span><span class="bound">x</span> <span class="main">|</span><span class="bound">x</span><span class="main">.</span> <span class="bound">x</span> <span class="main">&lt;</span> <span class="free">n</span> <span class="main">∧</span> coprime <span class="bound">x</span> <span class="free">n</span><span class="main">}</span> <span class="main">=</span> <span class="main">1</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="main">{</span><span class="bound">x</span> <span class="main">|</span><span class="bound">x</span><span class="main">.</span> <span class="bound">x</span> <span class="main">&lt;</span> <span class="free">n</span> <span class="main">∧</span> coprime <span class="bound">x</span> <span class="free">n</span><span class="main">}</span> <span class="main">=</span> <span class="main">{</span><span class="skolem">a</span> <span class="main">+</span> <span class="bound">j</span> <span class="main">*</span> <span class="skolem">b</span> <span class="main">|</span><span class="bound">j</span><span class="main">.</span> <span class="bound">j</span> <span class="main">&lt;</span> <span class="skolem">m</span><span class="main">}</span>›</span></span> less_one linorder_neqE_nat not_add_less1<span class="main">)</span>
          <span class="keyword1"><span class="command">qed</span></span>
          <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">‹Min  <span class="main">{</span><span class="skolem">a</span><span class="main">+</span><span class="bound">j</span><span class="main">*</span><span class="skolem">b</span><span class="main">|</span> <span class="bound">j</span><span class="main">::</span>nat<span class="main">.</span> <span class="bound">j</span> <span class="main">&lt;</span> <span class="skolem">m</span><span class="main">}</span> <span class="main">=</span> <span class="skolem">a</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
          <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> 
            <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹Min <span class="main">{</span><span class="bound">x</span> <span class="main">|</span> <span class="bound">x</span> <span class="main">::</span> nat<span class="main">.</span> <span class="bound">x</span> <span class="main">&lt;</span> <span class="free">n</span> <span class="main">∧</span> coprime <span class="bound">x</span> <span class="free">n</span><span class="main">}</span> <span class="main">=</span> <span class="main">1</span>›</span></span> <span class="quoted"><span class="quoted">‹Min <span class="main">{</span><span class="bound">x</span> <span class="main">|</span> <span class="bound">x</span> <span class="main">::</span> nat<span class="main">.</span> <span class="bound">x</span> <span class="main">&lt;</span> <span class="free">n</span> <span class="main">∧</span> coprime <span class="bound">x</span> <span class="free">n</span><span class="main">}</span> <span class="main">=</span> Min <span class="main">{</span><span class="skolem">a</span><span class="main">+</span><span class="bound">j</span><span class="main">*</span><span class="skolem">b</span><span class="main">|</span> <span class="bound">j</span><span class="main">::</span>nat<span class="main">.</span> <span class="bound">j</span> <span class="main">&lt;</span> <span class="skolem">m</span><span class="main">}</span>›</span></span>
            <span class="keyword1"><span class="command">by</span></span> <span class="operator">linarith</span>
        <span class="keyword1"><span class="command">qed</span></span>
        <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
          <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="main">{</span><span class="bound">x</span> <span class="main">|</span><span class="bound">x</span><span class="main">.</span> <span class="bound">x</span> <span class="main">&lt;</span> <span class="free">n</span> <span class="main">∧</span> coprime <span class="bound">x</span> <span class="free">n</span><span class="main">}</span> <span class="main">=</span> <span class="main">{</span><span class="skolem">a</span> <span class="main">+</span> <span class="bound">j</span> <span class="main">*</span> <span class="skolem">b</span> <span class="main">|</span><span class="bound">j</span><span class="main">.</span> <span class="bound">j</span> <span class="main">&lt;</span> <span class="skolem">m</span><span class="main">}</span>›</span></span> 
          <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span> 
      <span class="keyword1"><span class="command">qed</span></span>
      <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span>  <span class="quoted"><span class="quoted">‹<span class="skolem">m</span> <span class="main">≠</span> <span class="main">0</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="main">{</span><span class="bound">x</span> <span class="main">|</span> <span class="bound">x</span><span class="main">.</span> <span class="bound">x</span> <span class="main">&lt;</span> <span class="free">n</span> <span class="main">∧</span> coprime <span class="bound">x</span> <span class="free">n</span><span class="main">}</span> <span class="main">=</span> <span class="main">{</span><span class="skolem">a</span><span class="main">+</span><span class="bound">j</span><span class="main">*</span><span class="skolem">b</span><span class="main">|</span> <span class="bound">j</span><span class="main">::</span>nat<span class="main">.</span> <span class="bound">j</span> <span class="main">&lt;</span> <span class="skolem">m</span><span class="main">}</span>›</span></span> 
        <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">qed</span></span> 
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span> 
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword2"><span class="keyword">end</span></span></pre>
</div>
<div id="Configuration_Traces">
<div class="head">
<h1>Theory Configuration_Traces</h1>
</div>
<pre class="source"><span class="comment1">(*
  Title:      Configuration_Traces.thy
  Author:     Diego Marmsoler
*)</span>
<span class="keyword1"><span class="command">section</span></span> <span class="quoted"><span class="plain_text">"A Theory of Dynamic Architectures"</span></span>
<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹
  The following theory formalizes configuration traces~\cite{Marmsoler2016a,Marmsoler2016} as a model for dynamic architectures.
  Since configuration traces may be finite as well as infinite, the theory depends on Lochbihler's theory of co-inductive lists~\cite{Lochbihler2010}.
›</span></span>
<span class="keyword1"><span class="command">theory</span></span> Configuration_Traces
  <span class="keyword2"><span class="keyword">imports</span></span> <a href="../Coinductive/Coinductive_List.html">Coinductive.Coinductive_List</a>
<span class="keyword2"><span class="keyword">begin</span></span>
<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹
  In the following we first provide some preliminary results for natural numbers, extended natural numbers, and lazy lists.
  Then, we introduce a locale @text{dynamic\_architectures} which introduces basic definitions and corresponding properties for dynamic architectures.
›</span></span>
  
<span class="keyword1"><span class="command">subsection</span></span> <span class="quoted"><span class="plain_text">"Natural Numbers"</span></span>
<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹
  We provide one additional property for natural numbers.
›</span></span>
<span class="keyword1" id="Configuration_Traces-boundedGreatest"><span class="command">lemma</span></span> boundedGreatest<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">P</span> <span class="main">(</span><span class="free">i</span><span class="main">::</span>nat<span class="main">)</span>"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound"><span class="bound">n'</span></span> <span class="main">&gt;</span> <span class="free">n</span><span class="main">.</span> <span class="main">¬</span> <span class="free">P</span> <span class="bound">n'</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound"><span class="bound">i'</span></span><span class="main">≤</span><span class="free">n</span><span class="main">.</span> <span class="free">P</span> <span class="bound">i'</span> <span class="main">∧</span> <span class="main">(</span><span class="main">∀</span><span class="bound">n'</span><span class="main">.</span> <span class="free">P</span> <span class="bound">n'</span> <span class="main">⟶</span> <span class="bound">n'</span><span class="main">≤</span><span class="bound">i'</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">P</span> <span class="main">(</span><span class="free">i</span><span class="main">::</span>nat<span class="main">)</span> <span class="main">⟹</span> <span class="free">n</span><span class="main">≥</span><span class="free">i</span> <span class="main">⟹</span> <span class="main">∀</span><span class="bound"><span class="bound">n'</span></span> <span class="main">&gt;</span> <span class="free">n</span><span class="main">.</span> <span class="main">¬</span> <span class="free">P</span> <span class="bound">n'</span> <span class="main">⟹</span> <span class="main">(</span><span class="main">∃</span><span class="bound"><span class="bound">i'</span></span><span class="main">≤</span><span class="free">n</span><span class="main">.</span> <span class="free">P</span> <span class="bound">i'</span> <span class="main">∧</span> <span class="main">(</span><span class="main">∀</span><span class="bound"><span class="bound">n'</span></span><span class="main">≤</span><span class="free">n</span><span class="main">.</span> <span class="free">P</span> <span class="bound">n'</span> <span class="main">⟶</span> <span class="bound">n'</span><span class="main">≤</span><span class="bound">i'</span><span class="main">)</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">induction</span> <span class="quoted"><span class="free">n</span></span><span class="main">)</span>
    <span class="keyword3"><span class="command">case</span></span> 0
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?case</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">next</span></span>
    <span class="keyword3"><span class="command">case</span></span> <span class="main">(</span>Suc <span class="skolem">n</span><span class="main">)</span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?case</span></span></span>
    <span class="keyword1"><span class="command">proof</span></span> <span class="operator">cases</span>
      <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="free">i</span> <span class="main">=</span> Suc <span class="skolem">n</span>"</span></span>
      <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> Suc.prems <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">next</span></span>
      <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span><span class="main">(</span><span class="free">i</span> <span class="main">=</span> Suc <span class="skolem">n</span><span class="main">)</span>"</span></span>
      <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
      <span class="keyword1"><span class="command">proof</span></span> <span class="operator">cases</span>
        <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="free">P</span> <span class="main">(</span>Suc <span class="skolem">n</span><span class="main">)</span>"</span></span>
        <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">next</span></span>
        <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> <span class="free">P</span> <span class="main">(</span>Suc <span class="skolem">n</span><span class="main">)</span>"</span></span>
        <span class="keyword1"><span class="command">with</span></span> Suc.prems <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound"><span class="bound">n'</span></span> <span class="main">&gt;</span> <span class="skolem">n</span><span class="main">.</span> <span class="main">¬</span> <span class="free">P</span> <span class="bound">n'</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> Suc_lessI <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
        <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="main">¬</span><span class="main">(</span><span class="free">i</span> <span class="main">=</span> Suc <span class="skolem">n</span><span class="main">)</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">i</span> <span class="main">≤</span> <span class="skolem">n</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">P</span> <span class="free">i</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> Suc.prems <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">i'</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">i'</span><span class="main">≤</span><span class="skolem">n</span> <span class="main">∧</span> <span class="free">P</span> <span class="skolem">i'</span> <span class="main">∧</span> <span class="main">(</span><span class="main">∀</span><span class="bound"><span class="bound">n'</span></span><span class="main">≤</span><span class="skolem">n</span><span class="main">.</span> <span class="free">P</span> <span class="bound">n'</span> <span class="main">⟶</span> <span class="bound">n'</span> <span class="main">≤</span> <span class="skolem">i'</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> Suc.IH <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
        <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">i'</span> <span class="main">≤</span> <span class="skolem">n</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">P</span> <span class="skolem">i'</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">∀</span><span class="bound"><span class="bound">n'</span></span><span class="main">≤</span><span class="skolem">n</span><span class="main">.</span> <span class="free">P</span> <span class="bound">n'</span> <span class="main">⟶</span> <span class="bound">n'</span> <span class="main">≤</span> <span class="skolem">i'</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> le_SucI le_Suc_eq<span class="main">)</span>
      <span class="keyword1"><span class="command">qed</span></span>
    <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">n</span><span class="main">≥</span><span class="free">i</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">rule</span> ccontr<span class="main">)</span>
    <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> <span class="main">(</span><span class="free">n</span> <span class="main">≥</span> <span class="free">i</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="free">n</span> <span class="main">&lt;</span> <span class="free">i</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">arith</span>
    <span class="keyword3"><span class="command">thus</span></span> <span class="quoted">False</span> <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">i'</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">i'</span><span class="main">≤</span><span class="free">n</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">P</span> <span class="skolem">i'</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound"><span class="bound">n'</span></span><span class="main">≤</span><span class="free">n</span><span class="main">.</span> <span class="free">P</span> <span class="bound">n'</span> <span class="main">⟶</span> <span class="bound">n'</span> <span class="main">≤</span> <span class="skolem">i'</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">with</span></span> assms <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">n'</span><span class="main">.</span> <span class="free">P</span> <span class="bound">n'</span> <span class="main">⟶</span> <span class="bound">n'</span> <span class="main">≤</span> <span class="skolem">i'</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> not_le_imp_less <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">with</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">i'</span> <span class="main">≤</span> <span class="free">n</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹<span class="free">P</span> <span class="skolem">i'</span>›</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">subsection</span></span> <span class="quoted"><span class="plain_text">"Extended Natural Numbers"</span></span>
<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹
  We provide one simple property for the \emph{strict} order over extended natural numbers.
›</span></span>
<span class="keyword1" id="Configuration_Traces-enat_min"><span class="command">lemma</span></span> enat_min<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">m</span> <span class="main">≥</span> enat <span class="free">n'</span>"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"enat <span class="free">n</span> <span class="main">&lt;</span> <span class="free">m</span> <span class="main">-</span> enat <span class="free">n'</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"enat <span class="free">n</span> <span class="main">+</span> enat <span class="free">n'</span> <span class="main">&lt;</span> <span class="free">m</span>"</span></span> 
  <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> add.commute enat.simps<span class="main"><span class="main">(</span></span>3<span class="main"><span class="main">)</span></span> enat_add_mono enat_add_sub_same le_iff_add<span class="main">)</span>

<span class="keyword1"><span class="command">subsection</span></span> <span class="quoted"><span class="plain_text">"Lazy Lists"</span></span>
<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹
  In the following we provide some additional notation and properties for lazy lists.
›</span></span>
<span class="keyword1"><span class="command">notation</span></span> LNil <span class="main">(</span><span class="quoted">"<span class="keyword1">[]<span class="hidden">⇩</span><sub>l</sub></span>"</span><span class="main">)</span>
<span class="keyword1"><span class="command">notation</span></span> LCons <span class="main">(</span><span class="keyword2"><span class="keyword">infixl</span></span> <span class="quoted">"<span class="keyword1">#<span class="hidden">⇩</span><sub>l</sub></span>"</span> 60<span class="main">)</span>
<span class="keyword1"><span class="command">notation</span></span> lappend <span class="main">(</span><span class="keyword2"><span class="keyword">infixl</span></span> <span class="quoted">"<span class="keyword1">@<span class="hidden">⇩</span><sub>l</sub></span>"</span> 60<span class="main">)</span>

<span class="keyword1" id="Configuration_Traces-lnth_lappend"><span class="command">lemma</span></span> lnth_lappend<span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"lfinite <span class="free">xs</span>"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> lnull <span class="free">ys</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"lnth <span class="main">(</span><span class="free">xs</span> <span class="keyword1">@<span class="hidden">⇩</span><sub>l</sub></span> <span class="free">ys</span><span class="main">)</span> <span class="main">(</span>the_enat <span class="main">(</span>llength <span class="free">xs</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> lhd <span class="free">ys</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">from</span></span> assms <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound">k</span><span class="main">.</span> llength <span class="free">xs</span> <span class="main">=</span> enat <span class="bound">k</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> lfinite_conv_llength_enat <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">k</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"llength <span class="free">xs</span> <span class="main">=</span> enat <span class="skolem">k</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"lnth <span class="main">(</span><span class="free">xs</span> <span class="keyword1">@<span class="hidden">⇩</span><sub>l</sub></span> <span class="free">ys</span><span class="main">)</span> <span class="main">(</span>the_enat <span class="main">(</span>llength <span class="free">xs</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> lnth <span class="free">ys</span> <span class="main">0</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> lnth_lappend2<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="free">xs</span></span> <span class="quoted"><span class="skolem">k</span></span> <span class="quoted"><span class="skolem">k</span></span> <span class="quoted"><span class="free">ys</span></span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">with</span></span> assms <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> lnth_0_conv_lhd <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="Configuration_Traces-lfilter_ltake"><span class="command">lemma</span></span> lfilter_ltake<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="main">(</span><span class="bound"><span class="bound">n</span></span><span class="main">::</span>nat<span class="main">)</span><span class="main">≤</span>llength <span class="free">xs</span><span class="main">.</span> <span class="bound">n</span><span class="main">≥</span><span class="free">i</span> <span class="main">⟶</span> <span class="main">(</span><span class="main">¬</span> <span class="free">P</span> <span class="main">(</span>lnth <span class="free">xs</span> <span class="bound">n</span><span class="main">)</span><span class="main">)</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"lfilter <span class="free">P</span> <span class="free">xs</span> <span class="main">=</span> lfilter <span class="free">P</span> <span class="main">(</span>ltake <span class="free">i</span> <span class="free">xs</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"lfilter <span class="free">P</span> <span class="free">xs</span> <span class="main">=</span> lfilter <span class="free">P</span> <span class="main">(</span><span class="main">(</span>ltake <span class="free">i</span> <span class="free">xs</span><span class="main">)</span> <span class="keyword1">@<span class="hidden">⇩</span><sub>l</sub></span> <span class="main">(</span>ldrop <span class="free">i</span> <span class="free">xs</span><span class="main">)</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> lappend_ltake_ldrop<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="quoted">"<span class="main">(</span>enat <span class="free">i</span><span class="main">)</span>"</span></span> <span class="quoted"><span class="free">xs</span></span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"lfilter <span class="free">P</span> <span class="free">xs</span> <span class="main">=</span> <span class="main">(</span>lfilter <span class="free">P</span> <span class="main">(</span><span class="main">(</span>ltake <span class="free">i</span><span class="main">)</span> <span class="free">xs</span><span class="main">)</span><span class="main">)</span> <span class="keyword1">@<span class="hidden">⇩</span><sub>l</sub></span> <span class="main">(</span>lfilter <span class="free">P</span> <span class="main">(</span>ldrop <span class="free">i</span> <span class="free">xs</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="operator">cases</span>
    <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"enat <span class="free">i</span> <span class="main">≤</span> llength <span class="free">xs</span>"</span></span>
  
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound"><span class="bound">x</span></span><span class="main">&lt;</span>llength <span class="main">(</span>ldrop <span class="free">i</span> <span class="free">xs</span><span class="main">)</span><span class="main">.</span> <span class="main">¬</span> <span class="free">P</span> <span class="main">(</span>lnth <span class="main">(</span>ldrop <span class="free">i</span> <span class="free">xs</span><span class="main">)</span> <span class="bound">x</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">rule</span> allI<span class="main">)</span>
      <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">x</span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"enat <span class="skolem">x</span> <span class="main">&lt;</span> llength <span class="main">(</span>ldrop <span class="main">(</span>enat <span class="free">i</span><span class="main">)</span> <span class="free">xs</span><span class="main">)</span> <span class="main">⟶</span> <span class="main">¬</span> <span class="free">P</span> <span class="main">(</span>lnth <span class="main">(</span>ldrop <span class="main">(</span>enat <span class="free">i</span><span class="main">)</span> <span class="free">xs</span><span class="main">)</span> <span class="skolem">x</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">proof</span></span>
        <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"enat <span class="skolem">x</span> <span class="main">&lt;</span> llength <span class="main">(</span>ldrop <span class="main">(</span>enat <span class="free">i</span><span class="main">)</span> <span class="free">xs</span><span class="main">)</span>"</span></span>
        <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"llength <span class="main">(</span>ldrop <span class="main">(</span>enat <span class="free">i</span><span class="main">)</span> <span class="free">xs</span><span class="main">)</span> <span class="main">=</span> llength <span class="free">xs</span> <span class="main">-</span> enat <span class="free">i</span>"</span></span>
          <span class="keyword1"><span class="command">using</span></span> llength_ldrop<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="quoted">"enat <span class="free">i</span>"</span></span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
        <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"enat <span class="skolem">x</span> <span class="main">&lt;</span> llength <span class="free">xs</span> <span class="main">-</span> enat <span class="free">i</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
        <span class="keyword1"><span class="command">with</span></span> <span class="quoted"><span class="quoted">‹enat <span class="free">i</span> <span class="main">≤</span> llength <span class="free">xs</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"enat <span class="skolem">x</span> <span class="main">+</span> enat <span class="free">i</span> <span class="main">&lt;</span> llength <span class="free">xs</span>"</span></span>
          <span class="keyword1"><span class="command">using</span></span> enat_min<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="free">i</span></span> <span class="quoted"><span class="quoted">"llength <span class="free">xs</span>"</span></span> <span class="quoted"><span class="skolem">x</span></span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
        <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"enat <span class="free">i</span> <span class="main">+</span> enat <span class="skolem">x</span> <span class="main">=</span> enat <span class="skolem">x</span> <span class="main">+</span> enat <span class="free">i</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
        <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"enat <span class="free">i</span> <span class="main">+</span> enat <span class="skolem">x</span> <span class="main">&lt;</span> llength <span class="free">xs</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">arith</span>
        <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="free">i</span> <span class="main">+</span> <span class="skolem">x</span> <span class="main">&lt;</span> llength <span class="free">xs</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
        <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"lnth <span class="main">(</span>ldrop <span class="free">i</span> <span class="free">xs</span><span class="main">)</span> <span class="skolem">x</span> <span class="main">=</span> lnth <span class="free">xs</span> <span class="main">(</span><span class="skolem">x</span> <span class="main">+</span> the_enat <span class="free">i</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> lnth_ldrop<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="quoted">"enat <span class="free">i</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span>"</span></span> <span class="quoted"><span class="free">xs</span></span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
        <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">+</span> <span class="free">i</span> <span class="main">≥</span> <span class="free">i</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
        <span class="keyword1"><span class="command">with</span></span> assms <span class="quoted"><span class="quoted">‹<span class="free">i</span> <span class="main">+</span> <span class="skolem">x</span> <span class="main">&lt;</span> llength <span class="free">xs</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> <span class="free">P</span> <span class="main">(</span>lnth <span class="free">xs</span> <span class="main">(</span><span class="skolem">x</span> <span class="main">+</span> the_enat <span class="free">i</span><span class="main">)</span><span class="main">)</span>"</span></span>
          <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> assms<span class="main"><span class="main">(</span></span>1<span class="main"><span class="main">)</span></span> add.commute<span class="main">)</span>
        <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> <span class="free">P</span> <span class="main">(</span>lnth <span class="main">(</span>ldrop <span class="free">i</span> <span class="free">xs</span><span class="main">)</span> <span class="skolem">x</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
      <span class="keyword1"><span class="command">qed</span></span>
    <span class="keyword1"><span class="command">qed</span></span>
    <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"lfilter <span class="free">P</span> <span class="main">(</span>ldrop <span class="free">i</span> <span class="free">xs</span><span class="main">)</span> <span class="main">=</span> <span class="keyword1">[]<span class="hidden">⇩</span><sub>l</sub></span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> diverge_lfilter_LNil in_lset_conv_lnth<span class="main">)</span>
    <span class="keyword1"><span class="command">with</span></span> <span class="quoted"><span class="quoted">‹lfilter <span class="free">P</span> <span class="free">xs</span> <span class="main">=</span> <span class="main">(</span>lfilter <span class="free">P</span> <span class="main">(</span><span class="main">(</span>ltake <span class="free">i</span><span class="main">)</span> <span class="free">xs</span><span class="main">)</span><span class="main">)</span> <span class="keyword1">@<span class="hidden">⇩</span><sub>l</sub></span> <span class="main">(</span>lfilter <span class="free">P</span> <span class="main">(</span>ldrop <span class="free">i</span> <span class="free">xs</span><span class="main">)</span><span class="main">)</span>›</span></span>
      <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"lfilter <span class="free">P</span> <span class="free">xs</span> <span class="main">=</span> lfilter <span class="free">P</span> <span class="main">(</span>ltake <span class="free">i</span> <span class="free">xs</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">next</span></span>
    <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> enat <span class="free">i</span> <span class="main">≤</span> llength <span class="free">xs</span>"</span></span>
    <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"enat <span class="free">i</span> <span class="main">&gt;</span> llength <span class="free">xs</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"ldrop <span class="free">i</span> <span class="free">xs</span> <span class="main">=</span> <span class="keyword1">[]<span class="hidden">⇩</span><sub>l</sub></span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"lfilter <span class="free">P</span> <span class="main">(</span>ldrop <span class="free">i</span> <span class="free">xs</span><span class="main">)</span> <span class="main">=</span> <span class="keyword1">[]<span class="hidden">⇩</span><sub>l</sub></span>"</span></span> <span class="keyword1"><span class="command">using</span></span> lfilter_LNil<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="free">P</span></span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">arith</span>
    <span class="keyword1"><span class="command">with</span></span> <span class="quoted"><span class="quoted">‹lfilter <span class="free">P</span> <span class="free">xs</span> <span class="main">=</span> <span class="main">(</span>lfilter <span class="free">P</span> <span class="main">(</span><span class="main">(</span>ltake <span class="free">i</span><span class="main">)</span> <span class="free">xs</span><span class="main">)</span><span class="main">)</span> <span class="keyword1">@<span class="hidden">⇩</span><sub>l</sub></span> <span class="main">(</span>lfilter <span class="free">P</span> <span class="main">(</span>ldrop <span class="free">i</span> <span class="free">xs</span><span class="main">)</span><span class="main">)</span>›</span></span>
      <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"lfilter <span class="free">P</span> <span class="free">xs</span> <span class="main">=</span> lfilter <span class="free">P</span> <span class="main">(</span>ltake <span class="free">i</span> <span class="free">xs</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>        
  <span class="keyword1"><span class="command">qed</span></span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="Configuration_Traces-lfilter_lfinite"><span class="command">lemma</span></span> lfilter_lfinite<span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"lfinite <span class="main">(</span>lfilter <span class="free">P</span> <span class="free">t</span><span class="main">)</span>"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> lfinite <span class="free">t</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound">n</span><span class="main">.</span> <span class="main">∀</span><span class="bound"><span class="bound">n'</span></span><span class="main">&gt;</span><span class="bound">n</span><span class="main">.</span> <span class="main">¬</span> <span class="free">P</span> <span class="main">(</span>lnth <span class="free">t</span> <span class="bound">n'</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">from</span></span> assms <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"finite <span class="main">{</span><span class="bound">n</span><span class="main">.</span> enat <span class="bound">n</span> <span class="main">&lt;</span> llength <span class="free">t</span> <span class="main">∧</span> <span class="free">P</span> <span class="main">(</span>lnth <span class="free">t</span> <span class="bound">n</span><span class="main">)</span><span class="main">}</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> lfinite_lfilter <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">k</span></span>
    <span class="keyword2"><span class="keyword">where</span></span> sset<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">{</span><span class="bound">n</span><span class="main">.</span> enat <span class="bound">n</span> <span class="main">&lt;</span> llength <span class="free">t</span> <span class="main">∧</span> <span class="free">P</span> <span class="main">(</span>lnth <span class="free">t</span> <span class="bound">n</span><span class="main">)</span><span class="main">}</span> <span class="main">⊆</span> <span class="main">{</span><span class="bound">n</span><span class="main">.</span> <span class="bound">n</span><span class="main">&lt;</span><span class="skolem">k</span> <span class="main">∧</span> enat <span class="bound">n</span> <span class="main">&lt;</span> llength <span class="free">t</span> <span class="main">∧</span> <span class="free">P</span> <span class="main">(</span>lnth <span class="free">t</span> <span class="bound">n</span><span class="main">)</span><span class="main">}</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> finite_nat_bounded<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="quoted">"<span class="main">{</span><span class="bound">n</span><span class="main">.</span> enat <span class="bound">n</span> <span class="main">&lt;</span> llength <span class="free">t</span> <span class="main">∧</span> <span class="free">P</span> <span class="main">(</span>lnth <span class="free">t</span> <span class="bound">n</span><span class="main">)</span><span class="main">}</span>"</span></span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">rule</span> ccontr<span class="main">)</span>
    <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span><span class="main">(</span><span class="main">∃</span><span class="bound">n</span><span class="main">.</span> <span class="main">∀</span><span class="bound"><span class="bound">n'</span></span><span class="main">&gt;</span><span class="bound">n</span><span class="main">.</span> <span class="main">¬</span> <span class="free">P</span> <span class="main">(</span>lnth <span class="free">t</span> <span class="bound">n'</span><span class="main">)</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">n</span><span class="main">.</span> <span class="main">∃</span><span class="bound"><span class="bound">n'</span></span><span class="main">&gt;</span><span class="bound">n</span><span class="main">.</span> <span class="free">P</span> <span class="main">(</span>lnth <span class="free">t</span> <span class="bound">n'</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">n'</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">n'</span><span class="main">&gt;</span><span class="skolem">k</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">P</span> <span class="main">(</span>lnth <span class="free">t</span> <span class="skolem">n'</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="main">¬</span> lfinite <span class="free">t</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">n'</span> <span class="main">&lt;</span> llength <span class="free">t</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> not_lfinite_llength<span class="main">)</span>
    <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">n'</span> <span class="main">∉</span> <span class="main">{</span><span class="bound">n</span><span class="main">.</span> <span class="bound">n</span><span class="main">&lt;</span><span class="skolem">k</span> <span class="main">∧</span> enat <span class="bound">n</span> <span class="main">&lt;</span> llength <span class="free">t</span> <span class="main">∧</span> <span class="free">P</span> <span class="main">(</span>lnth <span class="free">t</span> <span class="bound">n</span><span class="main">)</span><span class="main">}</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span>
      <span class="quoted"><span class="quoted">"<span class="skolem">n'</span><span class="main">∈</span><span class="main">{</span><span class="bound">n</span><span class="main">.</span> enat <span class="bound">n</span> <span class="main">&lt;</span> llength <span class="free">t</span> <span class="main">∧</span> <span class="free">P</span> <span class="main">(</span>lnth <span class="free">t</span> <span class="bound">n</span><span class="main">)</span><span class="main">}</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">with</span></span> sset <span class="keyword3"><span class="command">show</span></span> <span class="quoted">False</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">qed</span></span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">subsection</span></span> <span class="quoted"><span class="plain_text">"Specifying Dynamic Architectures"</span></span>
<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹
  In the following we formalize dynamic architectures in terms of configuration traces, i.e., sequences of architecture configurations.
  Moreover, we introduce definitions for operations to support the specification of configuration traces.
›</span></span>
<span class="keyword1"><span class="command">typedecl</span></span> cnf
<span class="keyword1"><span class="command">type_synonym</span></span> trace <span class="main">=</span> <span class="quoted"><span class="quoted">"nat <span class="main">⇒</span> cnf"</span></span>
<span class="keyword1"><span class="command">consts</span></span> arch<span class="main">::</span> <span class="quoted"><span class="quoted">"trace set"</span></span>

<span class="keyword1"><span class="command">type_synonym</span></span> cta <span class="main">=</span> <span class="quoted"><span class="quoted">"trace <span class="main">⇒</span> nat <span class="main">⇒</span> bool"</span></span>

<span class="keyword1"><span class="command">subsubsection</span></span> <span class="quoted"><span class="plain_text">"Implication"</span></span>

<span class="keyword1"><span class="command">definition</span></span> <span class="entity">imp</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"cta <span class="main">⇒</span> cta <span class="main">⇒</span> cta"</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">infixl</span></span> <span class="quoted">"<span class="keyword1">⟶<span class="hidden">⇧</span><sup>c</sup></span>"</span> 10<span class="main">)</span>
  <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="free"><span class="bound"><span class="entity">γ</span></span></span> <span class="keyword1"><span class="free">⟶<span class="hidden">⇧</span><sup>c</sup></span></span> <span class="free"><span class="bound"><span class="entity">γ'</span></span></span> <span class="main">≡</span> <span class="main">λ</span> <span class="bound">t</span> <span class="bound">n</span><span class="main">.</span> <span class="free"><span class="bound"><span class="entity">γ</span></span></span> <span class="bound">t</span> <span class="bound">n</span> <span class="main">⟶</span> <span class="free"><span class="bound"><span class="entity">γ'</span></span></span> <span class="bound">t</span> <span class="bound">n</span>"</span></span>

<span class="keyword1"><span class="command">declare</span></span> imp_def<span class="main">[</span><span class="operator">simp</span><span class="main">]</span>

<span class="keyword1" id="Configuration_Traces-impI"><span class="command">lemma</span></span> impI<span class="main">[</span><span class="operator">intro</span><span class="main"><span class="main"><span class="main"><span class="main">!</span></span></span></span><span class="main">]</span><span class="main">:</span>
  <span class="keyword2"><span class="keyword">fixes</span></span> <span class="free">t</span> <span class="free">n</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">γ</span> <span class="free">t</span> <span class="free">n</span> <span class="main">⟹</span> <span class="free">γ'</span> <span class="free">t</span> <span class="free">n</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">γ</span> <span class="keyword1">⟶<span class="hidden">⇧</span><sup>c</sup></span> <span class="free">γ'</span><span class="main">)</span> <span class="free">t</span> <span class="free">n</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>

<span class="keyword1" id="Configuration_Traces-impE"><span class="command">lemma</span></span> impE<span class="main">[</span><span class="operator">elim</span><span class="main"><span class="main"><span class="main"><span class="main">!</span></span></span></span><span class="main">]</span><span class="main">:</span>
  <span class="keyword2"><span class="keyword">fixes</span></span> <span class="free">t</span> <span class="free">n</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">γ</span> <span class="keyword1">⟶<span class="hidden">⇧</span><sup>c</sup></span> <span class="free">γ'</span><span class="main">)</span> <span class="free">t</span> <span class="free">n</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">γ</span> <span class="free">t</span> <span class="free">n</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">γ'</span> <span class="free">t</span> <span class="free">n</span> <span class="main">⟹</span> <span class="free">γ''</span> <span class="free">t</span> <span class="free">n</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">γ''</span> <span class="free">t</span> <span class="free">n</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>

<span class="keyword1"><span class="command">subsubsection</span></span> <span class="quoted"><span class="plain_text">"Disjunction"</span></span>  
    
<span class="keyword1"><span class="command">definition</span></span> <span class="entity">disj</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"cta <span class="main">⇒</span> cta <span class="main">⇒</span> cta"</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">infixl</span></span> <span class="quoted">"<span class="keyword1">∨<span class="hidden">⇧</span><sup>c</sup></span>"</span> 15<span class="main">)</span>
  <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="free"><span class="bound"><span class="entity">γ</span></span></span> <span class="keyword1"><span class="free">∨<span class="hidden">⇧</span><sup>c</sup></span></span> <span class="free"><span class="bound"><span class="entity">γ'</span></span></span> <span class="main">≡</span> <span class="main">λ</span> <span class="bound">t</span> <span class="bound">n</span><span class="main">.</span> <span class="free"><span class="bound"><span class="entity">γ</span></span></span> <span class="bound">t</span> <span class="bound">n</span> <span class="main">∨</span> <span class="free"><span class="bound"><span class="entity">γ'</span></span></span> <span class="bound">t</span> <span class="bound">n</span>"</span></span>

<span class="keyword1"><span class="command">declare</span></span> disj_def<span class="main">[</span><span class="operator">simp</span><span class="main">]</span>

<span class="keyword1" id="Configuration_Traces-disjI1"><span class="command">lemma</span></span> disjI1<span class="main">[</span><span class="operator">intro</span><span class="main">]</span><span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">γ</span> <span class="free">t</span> <span class="free">n</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">γ</span> <span class="keyword1">∨<span class="hidden">⇧</span><sup>c</sup></span> <span class="free">γ'</span><span class="main">)</span> <span class="free">t</span> <span class="free">n</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>

<span class="keyword1" id="Configuration_Traces-disjI2"><span class="command">lemma</span></span> disjI2<span class="main">[</span><span class="operator">intro</span><span class="main">]</span><span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">γ'</span> <span class="free">t</span> <span class="free">n</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">γ</span> <span class="keyword1">∨<span class="hidden">⇧</span><sup>c</sup></span> <span class="free">γ'</span><span class="main">)</span> <span class="free">t</span> <span class="free">n</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>

<span class="keyword1" id="Configuration_Traces-disjE"><span class="command">lemma</span></span> disjE<span class="main">[</span><span class="operator">elim</span><span class="main"><span class="main"><span class="main"><span class="main">!</span></span></span></span><span class="main">]</span><span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">γ</span> <span class="keyword1">∨<span class="hidden">⇧</span><sup>c</sup></span> <span class="free">γ'</span><span class="main">)</span> <span class="free">t</span> <span class="free">n</span>"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">γ</span> <span class="free">t</span> <span class="free">n</span> <span class="main">⟹</span> <span class="free">γ''</span> <span class="free">t</span> <span class="free">n</span>"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">γ'</span> <span class="free">t</span> <span class="free">n</span> <span class="main">⟹</span> <span class="free">γ''</span> <span class="free">t</span> <span class="free">n</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">γ''</span> <span class="free">t</span> <span class="free">n</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">subsubsection</span></span> <span class="quoted"><span class="plain_text">"Conjunction"</span></span>
  
<span class="keyword1"><span class="command">definition</span></span> <span class="entity">conj</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"cta <span class="main">⇒</span> cta <span class="main">⇒</span> cta"</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">infixl</span></span> <span class="quoted">"<span class="keyword1">∧<span class="hidden">⇧</span><sup>c</sup></span>"</span> 20<span class="main">)</span>
  <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="free"><span class="bound"><span class="entity">γ</span></span></span> <span class="keyword1"><span class="free">∧<span class="hidden">⇧</span><sup>c</sup></span></span> <span class="free"><span class="bound"><span class="entity">γ'</span></span></span> <span class="main">≡</span> <span class="main">λ</span> <span class="bound">t</span> <span class="bound">n</span><span class="main">.</span> <span class="free"><span class="bound"><span class="entity">γ</span></span></span> <span class="bound">t</span> <span class="bound">n</span> <span class="main">∧</span> <span class="free"><span class="bound"><span class="entity">γ'</span></span></span> <span class="bound">t</span> <span class="bound">n</span>"</span></span>

<span class="keyword1"><span class="command">declare</span></span> conj_def<span class="main">[</span><span class="operator">simp</span><span class="main">]</span>

<span class="keyword1" id="Configuration_Traces-conjI"><span class="command">lemma</span></span> conjI<span class="main">[</span><span class="operator">intro</span><span class="main"><span class="main"><span class="main"><span class="main">!</span></span></span></span><span class="main">]</span><span class="main">:</span>
  <span class="keyword2"><span class="keyword">fixes</span></span> <span class="free">n</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">γ</span> <span class="free">t</span> <span class="free">n</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">γ'</span> <span class="free">t</span> <span class="free">n</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">γ</span> <span class="keyword1">∧<span class="hidden">⇧</span><sup>c</sup></span> <span class="free">γ'</span><span class="main">)</span> <span class="free">t</span> <span class="free">n</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>

<span class="keyword1" id="Configuration_Traces-conjE"><span class="command">lemma</span></span> conjE<span class="main">[</span><span class="operator">elim</span><span class="main"><span class="main"><span class="main"><span class="main">!</span></span></span></span><span class="main">]</span><span class="main">:</span>
  <span class="keyword2"><span class="keyword">fixes</span></span> <span class="free">n</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">γ</span> <span class="keyword1">∧<span class="hidden">⇧</span><sup>c</sup></span> <span class="free">γ'</span><span class="main">)</span> <span class="free">t</span> <span class="free">n</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">γ</span> <span class="free">t</span> <span class="free">n</span> <span class="main">⟹</span> <span class="free">γ'</span> <span class="free">t</span> <span class="free">n</span> <span class="main">⟹</span> <span class="free">γ''</span> <span class="free">t</span> <span class="free">n</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">γ''</span> <span class="free">t</span> <span class="free">n</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>

<span class="keyword1"><span class="command">subsubsection</span></span> <span class="quoted"><span class="plain_text">"Negation"</span></span>
  
<span class="keyword1"><span class="command">definition</span></span> <span class="entity">neg</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"cta <span class="main">⇒</span> cta"</span></span> <span class="main">(</span><span class="quoted">"<span class="keyword1">¬<span class="hidden">⇧</span><sup>c</sup></span> _"</span> <span class="main">[</span>19<span class="main">]</span> 19<span class="main">)</span>
  <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1"><span class="free">¬<span class="hidden">⇧</span><sup>c</sup></span></span> <span class="free"><span class="bound"><span class="entity">γ</span></span></span> <span class="main">≡</span> <span class="main">λ</span> <span class="bound">t</span> <span class="bound">n</span><span class="main">.</span> <span class="main">¬</span> <span class="free"><span class="bound"><span class="entity">γ</span></span></span> <span class="bound">t</span> <span class="bound">n</span>"</span></span>

<span class="keyword1"><span class="command">declare</span></span> neg_def<span class="main">[</span><span class="operator">simp</span><span class="main">]</span>

<span class="keyword1" id="Configuration_Traces-negI"><span class="command">lemma</span></span> negI<span class="main">[</span><span class="operator">intro</span><span class="main"><span class="main"><span class="main"><span class="main">!</span></span></span></span><span class="main">]</span><span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">γ</span> <span class="free">t</span> <span class="free">n</span> <span class="main">⟹</span> False"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="keyword1">¬<span class="hidden">⇧</span><sup>c</sup></span> <span class="free">γ</span><span class="main">)</span> <span class="free">t</span> <span class="free">n</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1" id="Configuration_Traces-negE"><span class="command">lemma</span></span> negE<span class="main">[</span><span class="operator">elim</span><span class="main"><span class="main"><span class="main"><span class="main">!</span></span></span></span><span class="main">]</span><span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="keyword1">¬<span class="hidden">⇧</span><sup>c</sup></span> <span class="free">γ</span><span class="main">)</span> <span class="free">t</span> <span class="free">n</span>"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">γ</span> <span class="free">t</span> <span class="free">n</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">γ'</span> <span class="free">t</span> <span class="free">n</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>

<span class="keyword1"><span class="command">subsubsection</span></span> <span class="quoted"><span class="plain_text">"Quantifiers"</span></span>

<span class="keyword1"><span class="command">definition</span></span> <span class="entity">all</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="tfree">'a</span> <span class="main">⇒</span> cta<span class="main">)</span>
  <span class="main">⇒</span> cta"</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">binder</span></span> <span class="quoted">"<span class="keyword1">∀<span class="hidden">⇩</span><sub>c</sub></span>"</span> 10<span class="main">)</span>
  <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="free">all</span> <span class="free"><span class="bound"><span class="entity">P</span></span></span> <span class="main">≡</span> <span class="main">λ</span><span class="bound">t</span> <span class="bound">n</span><span class="main">.</span> <span class="main">(</span><span class="main">∀</span><span class="bound">y</span><span class="main">.</span> <span class="main">(</span><span class="free"><span class="bound"><span class="entity">P</span></span></span> <span class="bound">y</span> <span class="bound">t</span> <span class="bound">n</span><span class="main">)</span><span class="main">)</span>"</span></span>

<span class="keyword1"><span class="command">declare</span></span> all_def<span class="main">[</span><span class="operator">simp</span><span class="main">]</span>

<span class="keyword1" id="Configuration_Traces-allI"><span class="command">lemma</span></span> allI<span class="main">[</span><span class="operator">intro</span><span class="main"><span class="main"><span class="main"><span class="main">!</span></span></span></span><span class="main">]</span><span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="main">⋀</span><span class="bound">x</span><span class="main">.</span> <span class="free">γ</span> <span class="bound">x</span> <span class="free">t</span> <span class="free">n</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="keyword1">∀<span class="hidden">⇩</span><sub>c</sub></span><span class="bound">x</span><span class="main">.</span> <span class="free">γ</span> <span class="bound">x</span><span class="main">)</span> <span class="free">t</span> <span class="free">n</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>

<span class="keyword1" id="Configuration_Traces-allE"><span class="command">lemma</span></span> allE<span class="main">[</span><span class="operator">elim</span><span class="main"><span class="main"><span class="main"><span class="main">!</span></span></span></span><span class="main">]</span><span class="main">:</span>
  <span class="keyword2"><span class="keyword">fixes</span></span> <span class="free">n</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="keyword1">∀<span class="hidden">⇩</span><sub>c</sub></span><span class="bound">x</span><span class="main">.</span> <span class="free">γ</span> <span class="bound">x</span><span class="main">)</span> <span class="free">t</span> <span class="free">n</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">γ</span> <span class="free">x</span> <span class="free">t</span> <span class="free">n</span> <span class="main">⟹</span> <span class="free">γ'</span> <span class="free">t</span> <span class="free">n</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">γ'</span> <span class="free">t</span> <span class="free">n</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>

<span class="keyword1"><span class="command">definition</span></span> <span class="entity">ex</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="tfree">'a</span> <span class="main">⇒</span> cta<span class="main">)</span>
  <span class="main">⇒</span> cta"</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">binder</span></span> <span class="quoted">"<span class="keyword1">∃<span class="hidden">⇩</span><sub>c</sub></span>"</span> 10<span class="main">)</span>
  <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="free">ex</span> <span class="free"><span class="bound"><span class="entity">P</span></span></span> <span class="main">≡</span> <span class="main">λ</span><span class="bound">t</span> <span class="bound">n</span><span class="main">.</span> <span class="main">(</span><span class="main">∃</span><span class="bound">y</span><span class="main">.</span> <span class="main">(</span><span class="free"><span class="bound"><span class="entity">P</span></span></span> <span class="bound">y</span> <span class="bound">t</span> <span class="bound">n</span><span class="main">)</span><span class="main">)</span>"</span></span>

<span class="keyword1"><span class="command">declare</span></span> ex_def<span class="main">[</span><span class="operator">simp</span><span class="main">]</span>

<span class="keyword1" id="Configuration_Traces-exI"><span class="command">lemma</span></span> exI<span class="main">[</span><span class="operator">intro</span><span class="main"><span class="main"><span class="main"><span class="main">!</span></span></span></span><span class="main">]</span><span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">γ</span> <span class="free">x</span> <span class="free">t</span> <span class="free">n</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="keyword1">∃<span class="hidden">⇩</span><sub>c</sub></span><span class="bound">x</span><span class="main">.</span> <span class="free">γ</span> <span class="bound">x</span><span class="main">)</span> <span class="free">t</span> <span class="free">n</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms HOL.exI <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>

<span class="keyword1" id="Configuration_Traces-exE"><span class="command">lemma</span></span> exE<span class="main">[</span><span class="operator">elim</span><span class="main"><span class="main"><span class="main"><span class="main">!</span></span></span></span><span class="main">]</span><span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="keyword1">∃<span class="hidden">⇩</span><sub>c</sub></span><span class="bound">x</span><span class="main">.</span> <span class="free">γ</span> <span class="bound">x</span><span class="main">)</span> <span class="free">t</span> <span class="free">n</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">⋀</span><span class="bound">x</span><span class="main">.</span> <span class="free">γ</span> <span class="bound">x</span> <span class="free">t</span> <span class="free">n</span> <span class="main">⟹</span> <span class="free">γ'</span> <span class="free">t</span> <span class="free">n</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">γ'</span> <span class="free">t</span> <span class="free">n</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms HOL.exE <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">subsubsection</span></span> <span class="quoted"><span class="plain_text">"Atomic Assertions"</span></span>
<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹
  First we provide rules for basic behavior assertions.
›</span></span>

<span class="keyword1"><span class="command">definition</span></span> <span class="entity">ca</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="main">(</span>cnf <span class="main">⇒</span> bool<span class="main">)</span> <span class="main">⇒</span> cta"</span></span>
  <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="free">ca</span> <span class="free"><span class="bound"><span class="entity">φ</span></span></span> <span class="main">≡</span> <span class="main">λ</span> <span class="bound">t</span> <span class="bound">n</span><span class="main">.</span> <span class="free"><span class="bound"><span class="entity">φ</span></span></span> <span class="main">(</span><span class="bound">t</span> <span class="bound">n</span><span class="main">)</span>"</span></span>

<span class="keyword1" id="Configuration_Traces-caI"><span class="command">lemma</span></span> caI<span class="main">[</span><span class="operator">intro</span><span class="main">]</span><span class="main">:</span>
  <span class="keyword2"><span class="keyword">fixes</span></span> <span class="free">n</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">φ</span> <span class="main">(</span><span class="free">t</span> <span class="free">n</span><span class="main">)</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span>ca <span class="free">φ</span><span class="main">)</span> <span class="free">t</span> <span class="free">n</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms ca_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>

<span class="keyword1" id="Configuration_Traces-caE"><span class="command">lemma</span></span> caE<span class="main">[</span><span class="operator">elim</span><span class="main">]</span><span class="main">:</span>
  <span class="keyword2"><span class="keyword">fixes</span></span> <span class="free">n</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span>ca <span class="free">φ</span><span class="main">)</span> <span class="free">t</span> <span class="free">n</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">φ</span> <span class="main">(</span><span class="free">t</span> <span class="free">n</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms ca_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>

<span class="keyword1"><span class="command">subsubsection</span></span> <span class="quoted"><span class="plain_text">"Next Operator"</span></span>

<span class="keyword1"><span class="command">definition</span></span> <span class="entity">nxt</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"cta <span class="main">⇒</span> cta"</span></span> <span class="main">(</span><span class="quoted">"<span class="keyword1">○<span class="hidden">⇩</span><sub>c</sub></span><span class="keyword3">(</span>_<span class="keyword3">)</span>"</span> 24<span class="main">)</span>
  <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1"><span class="free">○<span class="hidden">⇩</span><sub>c</sub></span></span><span class="main">(</span><span class="free"><span class="bound"><span class="entity">γ</span></span></span><span class="main">)</span> <span class="main">≡</span> <span class="main">λ</span><span class="main">(</span><span class="bound">t</span><span class="main">::</span><span class="main">(</span>nat <span class="main">⇒</span> cnf<span class="main">)</span><span class="main">)</span> <span class="bound">n</span><span class="main">.</span> <span class="free"><span class="bound"><span class="entity">γ</span></span></span> <span class="bound">t</span> <span class="main">(</span>Suc <span class="bound">n</span><span class="main">)</span>"</span></span>

<span class="keyword1"><span class="command">subsubsection</span></span> <span class="quoted"><span class="plain_text">"Eventually Operator"</span></span>  

<span class="keyword1"><span class="command">definition</span></span> <span class="entity">evt</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"cta <span class="main">⇒</span> cta"</span></span> <span class="main">(</span><span class="quoted">"<span class="keyword1">◇<span class="hidden">⇩</span><sub>c</sub></span><span class="keyword3">(</span>_<span class="keyword3">)</span>"</span> 23<span class="main">)</span>
  <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1"><span class="free">◇<span class="hidden">⇩</span><sub>c</sub></span></span><span class="main">(</span><span class="free"><span class="bound"><span class="entity">γ</span></span></span><span class="main">)</span> <span class="main">≡</span> <span class="main">λ</span><span class="main">(</span><span class="bound">t</span><span class="main">::</span><span class="main">(</span>nat <span class="main">⇒</span> cnf<span class="main">)</span><span class="main">)</span> <span class="bound">n</span><span class="main">.</span> <span class="main">∃</span><span class="bound"><span class="bound">n'</span></span><span class="main">≥</span><span class="bound">n</span><span class="main">.</span> <span class="free"><span class="bound"><span class="entity">γ</span></span></span> <span class="bound">t</span> <span class="bound">n'</span>"</span></span>

<span class="keyword1"><span class="command">subsubsection</span></span> <span class="quoted"><span class="plain_text">"Globally Operator"</span></span>

<span class="keyword1"><span class="command">definition</span></span> <span class="entity">glob</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"cta <span class="main">⇒</span> cta"</span></span> <span class="main">(</span><span class="quoted">"<span class="keyword1">□<span class="hidden">⇩</span><sub>c</sub></span><span class="keyword3">(</span>_<span class="keyword3">)</span>"</span> 22<span class="main">)</span>
  <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1"><span class="free">□<span class="hidden">⇩</span><sub>c</sub></span></span><span class="main">(</span><span class="free"><span class="bound"><span class="entity">γ</span></span></span><span class="main">)</span> <span class="main">≡</span> <span class="main">λ</span><span class="main">(</span><span class="bound">t</span><span class="main">::</span><span class="main">(</span>nat <span class="main">⇒</span> cnf<span class="main">)</span><span class="main">)</span> <span class="bound">n</span><span class="main">.</span> <span class="main">∀</span><span class="bound"><span class="bound">n'</span></span><span class="main">≥</span><span class="bound">n</span><span class="main">.</span> <span class="free"><span class="bound"><span class="entity">γ</span></span></span> <span class="bound">t</span> <span class="bound">n'</span>"</span></span>

<span class="keyword1" id="Configuration_Traces-globI"><span class="command">lemma</span></span> globI<span class="main">[</span><span class="operator">intro</span><span class="main"><span class="main"><span class="main"><span class="main">!</span></span></span></span><span class="main">]</span><span class="main">:</span>
  <span class="keyword2"><span class="keyword">fixes</span></span> <span class="free">n'</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound"><span class="bound">n</span></span><span class="main">≥</span><span class="free">n'</span><span class="main">.</span> <span class="free">γ</span> <span class="free">t</span> <span class="bound">n</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="keyword1">□<span class="hidden">⇩</span><sub>c</sub></span><span class="main">(</span><span class="free">γ</span><span class="main">)</span><span class="main">)</span> <span class="free">t</span> <span class="free">n'</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms glob_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>

<span class="keyword1" id="Configuration_Traces-globE"><span class="command">lemma</span></span> globE<span class="main">[</span><span class="operator">elim</span><span class="main"><span class="main"><span class="main"><span class="main">!</span></span></span></span><span class="main">]</span><span class="main">:</span>
  <span class="keyword2"><span class="keyword">fixes</span></span> <span class="free">n</span> <span class="free">n'</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="keyword1">□<span class="hidden">⇩</span><sub>c</sub></span><span class="main">(</span><span class="free">γ</span><span class="main">)</span><span class="main">)</span> <span class="free">t</span> <span class="free">n</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">n'</span><span class="main">≥</span><span class="free">n</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">γ</span> <span class="free">t</span> <span class="free">n'</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms glob_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>

<span class="keyword1"><span class="command">subsubsection</span></span> <span class="quoted"><span class="plain_text">"Until Operator"</span></span>

<span class="keyword1"><span class="command">definition</span></span> <span class="entity">until</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"cta <span class="main">⇒</span> cta <span class="main">⇒</span> cta"</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">infixl</span></span> <span class="quoted">"<span class="keyword1">𝔘<span class="hidden">⇩</span><sub>c</sub></span>"</span> 21<span class="main">)</span>
  <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="free"><span class="bound"><span class="entity">γ'</span></span></span> <span class="keyword1"><span class="free">𝔘<span class="hidden">⇩</span><sub>c</sub></span></span> <span class="free"><span class="bound"><span class="entity">γ</span></span></span> <span class="main">≡</span> <span class="main">λ</span><span class="main">(</span><span class="bound">t</span><span class="main">::</span><span class="main">(</span>nat <span class="main">⇒</span> cnf<span class="main">)</span><span class="main">)</span> <span class="bound">n</span><span class="main">.</span> <span class="main">∃</span><span class="bound"><span class="bound">n''</span></span><span class="main">≥</span><span class="bound">n</span><span class="main">.</span> <span class="free"><span class="bound"><span class="entity">γ</span></span></span> <span class="bound">t</span> <span class="bound">n''</span> <span class="main">∧</span> <span class="main">(</span><span class="main">∀</span><span class="bound"><span class="bound">n'</span></span><span class="main">≥</span><span class="bound">n</span><span class="main">.</span> <span class="bound">n'</span> <span class="main">&lt;</span> <span class="bound">n''</span> <span class="main">⟶</span> <span class="free"><span class="bound"><span class="entity">γ'</span></span></span> <span class="bound">t</span> <span class="bound">n'</span><span class="main">)</span>"</span></span>

<span class="keyword1" id="Configuration_Traces-untilI"><span class="command">lemma</span></span> untilI<span class="main">[</span><span class="operator">intro</span><span class="main">]</span><span class="main">:</span>
  <span class="keyword2"><span class="keyword">fixes</span></span> <span class="free">n</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound"><span class="bound">n''</span></span><span class="main">≥</span><span class="free">n</span><span class="main">.</span> <span class="free">γ</span> <span class="free">t</span> <span class="bound">n''</span> <span class="main">∧</span> <span class="main">(</span><span class="main">∀</span><span class="bound"><span class="bound">n'</span></span><span class="main">≥</span><span class="free">n</span><span class="main">.</span> <span class="bound">n'</span><span class="main">&lt;</span><span class="bound">n''</span> <span class="main">⟶</span> <span class="free">γ'</span> <span class="free">t</span> <span class="bound">n'</span><span class="main">)</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">γ'</span> <span class="keyword1">𝔘<span class="hidden">⇩</span><sub>c</sub></span> <span class="free">γ</span><span class="main">)</span> <span class="free">t</span> <span class="free">n</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms until_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>

<span class="keyword1" id="Configuration_Traces-untilE"><span class="command">lemma</span></span> untilE<span class="main">[</span><span class="operator">elim</span><span class="main">]</span><span class="main">:</span>
  <span class="keyword2"><span class="keyword">fixes</span></span> <span class="free">n</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">γ'</span> <span class="keyword1">𝔘<span class="hidden">⇩</span><sub>c</sub></span> <span class="free">γ</span><span class="main">)</span> <span class="free">t</span> <span class="free">n</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound"><span class="bound">n''</span></span><span class="main">≥</span><span class="free">n</span><span class="main">.</span> <span class="free">γ</span> <span class="free">t</span> <span class="bound">n''</span> <span class="main">∧</span> <span class="main">(</span><span class="main">∀</span><span class="bound"><span class="bound">n'</span></span><span class="main">≥</span><span class="free">n</span><span class="main">.</span> <span class="bound">n'</span><span class="main">&lt;</span><span class="bound">n''</span> <span class="main">⟶</span> <span class="free">γ'</span> <span class="free">t</span> <span class="bound">n'</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms until_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>

<span class="keyword1"><span class="command">subsubsection</span></span> <span class="quoted"><span class="plain_text">"Weak Until"</span></span>

<span class="keyword1"><span class="command">definition</span></span> <span class="entity">wuntil</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"cta <span class="main">⇒</span> cta <span class="main">⇒</span> cta"</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">infixl</span></span> <span class="quoted">"<span class="keyword1">𝔚<span class="hidden">⇩</span><sub>c</sub></span>"</span> 20<span class="main">)</span>
  <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="free"><span class="bound"><span class="entity">γ'</span></span></span> <span class="keyword1"><span class="free">𝔚<span class="hidden">⇩</span><sub>c</sub></span></span> <span class="free"><span class="bound"><span class="entity">γ</span></span></span> <span class="main">≡</span> <span class="free"><span class="bound"><span class="entity">γ'</span></span></span> <span class="keyword1">𝔘<span class="hidden">⇩</span><sub>c</sub></span> <span class="free"><span class="bound"><span class="entity">γ</span></span></span> <span class="keyword1">∨<span class="hidden">⇧</span><sup>c</sup></span> <span class="keyword1">□<span class="hidden">⇩</span><sub>c</sub></span><span class="main">(</span><span class="free"><span class="bound"><span class="entity">γ'</span></span></span><span class="main">)</span>"</span></span>

<span class="keyword1" id="Configuration_Traces-wUntilI"><span class="command">lemma</span></span> wUntilI<span class="main">[</span><span class="operator">intro</span><span class="main">]</span><span class="main">:</span>
  <span class="keyword2"><span class="keyword">fixes</span></span> <span class="free">n</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">∃</span><span class="bound"><span class="bound">n''</span></span><span class="main">≥</span><span class="free">n</span><span class="main">.</span> <span class="free">γ</span> <span class="free">t</span> <span class="bound">n''</span> <span class="main">∧</span> <span class="main">(</span><span class="main">∀</span><span class="bound"><span class="bound">n'</span></span><span class="main">≥</span><span class="free">n</span><span class="main">.</span> <span class="bound">n'</span><span class="main">&lt;</span><span class="bound">n''</span> <span class="main">⟶</span> <span class="free">γ'</span> <span class="free">t</span> <span class="bound">n'</span><span class="main">)</span><span class="main">)</span> <span class="main">∨</span> <span class="main">(</span><span class="main">∀</span><span class="bound"><span class="bound">n'</span></span><span class="main">≥</span><span class="free">n</span><span class="main">.</span> <span class="free">γ'</span> <span class="free">t</span> <span class="bound">n'</span><span class="main">)</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">γ'</span> <span class="keyword1">𝔚<span class="hidden">⇩</span><sub>c</sub></span> <span class="free">γ</span><span class="main">)</span> <span class="free">t</span> <span class="free">n</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms wuntil_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1" id="Configuration_Traces-wUntilE"><span class="command">lemma</span></span> wUntilE<span class="main">[</span><span class="operator">elim</span><span class="main">]</span><span class="main">:</span>
  <span class="keyword2"><span class="keyword">fixes</span></span> <span class="free">n</span> <span class="free">n'</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">γ'</span> <span class="keyword1">𝔚<span class="hidden">⇩</span><sub>c</sub></span> <span class="free">γ</span><span class="main">)</span> <span class="free">t</span> <span class="free">n</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">∃</span><span class="bound"><span class="bound">n''</span></span><span class="main">≥</span><span class="free">n</span><span class="main">.</span> <span class="free">γ</span> <span class="free">t</span> <span class="bound">n''</span> <span class="main">∧</span> <span class="main">(</span><span class="main">∀</span><span class="bound"><span class="bound">n'</span></span><span class="main">≥</span><span class="free">n</span><span class="main">.</span> <span class="bound">n'</span><span class="main">&lt;</span><span class="bound">n''</span> <span class="main">⟶</span> <span class="free">γ'</span> <span class="free">t</span> <span class="bound">n'</span><span class="main">)</span><span class="main">)</span> <span class="main">∨</span> <span class="main">(</span><span class="main">∀</span><span class="bound"><span class="bound">n'</span></span><span class="main">≥</span><span class="free">n</span><span class="main">.</span> <span class="free">γ'</span> <span class="free">t</span> <span class="bound">n'</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">from</span></span> assms <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">γ'</span> <span class="keyword1">𝔘<span class="hidden">⇩</span><sub>c</sub></span> <span class="free">γ</span> <span class="keyword1">∨<span class="hidden">⇧</span><sup>c</sup></span> <span class="keyword1">□<span class="hidden">⇩</span><sub>c</sub></span><span class="main">(</span><span class="free">γ'</span><span class="main">)</span><span class="main">)</span> <span class="free">t</span> <span class="free">n</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> wuntil_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">γ'</span> <span class="keyword1">𝔘<span class="hidden">⇩</span><sub>c</sub></span> <span class="free">γ</span><span class="main">)</span> <span class="free">t</span> <span class="free">n</span> <span class="main">∨</span> <span class="main">(</span><span class="keyword1">□<span class="hidden">⇩</span><sub>c</sub></span><span class="main">(</span><span class="free">γ'</span><span class="main">)</span><span class="main">)</span> <span class="free">t</span> <span class="free">n</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
  <span class="keyword1"><span class="command">proof</span></span>
    <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">γ'</span> <span class="keyword1">𝔘<span class="hidden">⇩</span><sub>c</sub></span> <span class="free">γ</span><span class="main">)</span> <span class="free">t</span> <span class="free">n</span>"</span></span>
    <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound"><span class="bound">n''</span></span><span class="main">≥</span><span class="free">n</span><span class="main">.</span> <span class="free">γ</span> <span class="free">t</span> <span class="bound">n''</span> <span class="main">∧</span> <span class="main">(</span><span class="main">∀</span><span class="bound"><span class="bound">n'</span></span><span class="main">≥</span><span class="free">n</span><span class="main">.</span> <span class="bound">n'</span> <span class="main">&lt;</span> <span class="bound">n''</span> <span class="main">⟶</span> <span class="free">γ'</span> <span class="free">t</span> <span class="bound">n'</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">next</span></span>
    <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="keyword1">□<span class="hidden">⇩</span><sub>c</sub></span><span class="free">γ'</span><span class="main">)</span> <span class="free">t</span> <span class="free">n</span>"</span></span>
    <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound"><span class="bound">n'</span></span><span class="main">≥</span><span class="free">n</span><span class="main">.</span> <span class="free">γ'</span> <span class="free">t</span> <span class="bound">n'</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">qed</span></span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="Configuration_Traces-wUntil_Glob"><span class="command">lemma</span></span> wUntil_Glob<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">γ'</span> <span class="keyword1">𝔚<span class="hidden">⇩</span><sub>c</sub></span> <span class="free">γ</span><span class="main">)</span> <span class="free">t</span> <span class="free">n</span>"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="keyword1">□<span class="hidden">⇩</span><sub>c</sub></span><span class="main">(</span><span class="free">γ'</span> <span class="keyword1">⟶<span class="hidden">⇧</span><sup>c</sup></span> <span class="free">γ''</span><span class="main">)</span><span class="main">)</span> <span class="free">t</span> <span class="free">n</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">γ''</span> <span class="keyword1">𝔚<span class="hidden">⇩</span><sub>c</sub></span> <span class="free">γ</span><span class="main">)</span> <span class="free">t</span> <span class="free">n</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span>
  <span class="keyword1"><span class="command">from</span></span> assms<span class="main">(</span>1<span class="main">)</span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">∃</span><span class="bound"><span class="bound">n''</span></span><span class="main">≥</span><span class="free">n</span><span class="main">.</span> <span class="free">γ</span> <span class="free">t</span> <span class="bound">n''</span> <span class="main">∧</span> <span class="main">(</span><span class="main">∀</span><span class="bound"><span class="bound">n'</span></span><span class="main">≥</span><span class="free">n</span><span class="main">.</span> <span class="bound">n'</span> <span class="main">&lt;</span> <span class="bound">n''</span> <span class="main">⟶</span> <span class="free">γ'</span> <span class="free">t</span> <span class="bound">n'</span><span class="main">)</span><span class="main">)</span> <span class="main">∨</span> <span class="main">(</span><span class="main">∀</span><span class="bound"><span class="bound">n'</span></span><span class="main">≥</span><span class="free">n</span><span class="main">.</span> <span class="free">γ'</span> <span class="free">t</span> <span class="bound">n'</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> wUntilE <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">∃</span><span class="bound"><span class="bound">n''</span></span><span class="main">≥</span><span class="free">n</span><span class="main">.</span> <span class="free">γ</span> <span class="free">t</span> <span class="bound">n''</span> <span class="main">∧</span> <span class="main">(</span><span class="main">∀</span><span class="bound"><span class="bound">n'</span></span><span class="main">≥</span><span class="free">n</span><span class="main">.</span> <span class="bound">n'</span> <span class="main">&lt;</span> <span class="bound">n''</span> <span class="main">⟶</span> <span class="free">γ''</span> <span class="free">t</span> <span class="bound">n'</span><span class="main">)</span><span class="main">)</span> <span class="main">∨</span> <span class="main">(</span><span class="main">∀</span><span class="bound"><span class="bound">n'</span></span><span class="main">≥</span><span class="free">n</span><span class="main">.</span> <span class="free">γ''</span> <span class="free">t</span> <span class="bound">n'</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span>
    <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound"><span class="bound">n''</span></span><span class="main">≥</span><span class="free">n</span><span class="main">.</span> <span class="free">γ</span> <span class="free">t</span> <span class="bound">n''</span> <span class="main">∧</span> <span class="main">(</span><span class="main">∀</span><span class="bound"><span class="bound">n'</span></span><span class="main">≥</span><span class="free">n</span><span class="main">.</span> <span class="bound">n'</span> <span class="main">&lt;</span> <span class="bound">n''</span> <span class="main">⟶</span> <span class="free">γ'</span> <span class="free">t</span> <span class="bound">n'</span><span class="main">)</span>"</span></span>
    <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">∃</span><span class="bound"><span class="bound">n''</span></span><span class="main">≥</span><span class="free">n</span><span class="main">.</span> <span class="free">γ</span> <span class="free">t</span> <span class="bound">n''</span> <span class="main">∧</span> <span class="main">(</span><span class="main">∀</span><span class="bound"><span class="bound">n'</span></span><span class="main">≥</span><span class="free">n</span><span class="main">.</span> <span class="bound">n'</span> <span class="main">&lt;</span> <span class="bound">n''</span> <span class="main">⟶</span> <span class="free">γ''</span> <span class="free">t</span> <span class="bound">n'</span><span class="main">)</span><span class="main">)</span> <span class="main">∨</span> <span class="main">(</span><span class="main">∀</span><span class="bound"><span class="bound">n'</span></span><span class="main">≥</span><span class="free">n</span><span class="main">.</span> <span class="free">γ''</span> <span class="free">t</span> <span class="bound">n'</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
      <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="main">∃</span><span class="bound"><span class="bound">n''</span></span><span class="main">≥</span><span class="free">n</span><span class="main">.</span> <span class="free">γ</span> <span class="free">t</span> <span class="bound">n''</span> <span class="main">∧</span> <span class="main">(</span><span class="main">∀</span><span class="bound"><span class="bound">n'</span></span><span class="main">≥</span><span class="free">n</span><span class="main">.</span> <span class="bound">n'</span> <span class="main">&lt;</span> <span class="bound">n''</span> <span class="main">⟶</span> <span class="free">γ'</span> <span class="free">t</span> <span class="bound">n'</span><span class="main">)</span>›</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">n''</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">n''</span><span class="main">≥</span><span class="free">n</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">γ</span> <span class="free">t</span> <span class="skolem">n''</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> a1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound"><span class="bound">n'</span></span><span class="main">≥</span><span class="free">n</span><span class="main">.</span> <span class="bound">n'</span> <span class="main">&lt;</span> <span class="skolem">n''</span> <span class="main">⟶</span> <span class="free">γ'</span> <span class="free">t</span> <span class="bound">n'</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound"><span class="bound">n'</span></span><span class="main">≥</span><span class="free">n</span><span class="main">.</span> <span class="bound">n'</span> <span class="main">&lt;</span> <span class="skolem">n''</span> <span class="main">⟶</span> <span class="free">γ''</span> <span class="free">t</span> <span class="bound">n'</span>"</span></span>
      <span class="keyword1"><span class="command">proof</span></span>
        <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">n'</span>
        <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">n'</span><span class="main">≥</span><span class="free">n</span> <span class="main">⟶</span> <span class="skolem">n'</span><span class="main">&lt;</span> <span class="skolem">n''</span> <span class="main">⟶</span> <span class="free">γ''</span> <span class="free">t</span> <span class="skolem">n'</span>"</span></span>
        <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">rule</span> HOL.impI<span class="main"><span class="main">[</span></span><span class="operator">OF</span> HOL.impI<span class="main"><span class="main">]</span></span><span class="main">)</span>
          <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">n'</span><span class="main">≥</span><span class="free">n</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">n'</span><span class="main">&lt;</span><span class="skolem">n''</span>"</span></span>
          <span class="keyword1"><span class="command">with</span></span> assms<span class="main">(</span>2<span class="main">)</span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">γ'</span> <span class="keyword1">⟶<span class="hidden">⇧</span><sup>c</sup></span> <span class="free">γ''</span><span class="main">)</span> <span class="free">t</span> <span class="skolem">n'</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> globE <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
          <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="free">γ'</span> <span class="free">t</span> <span class="skolem">n'</span> <span class="main">⟶</span> <span class="free">γ''</span> <span class="free">t</span> <span class="skolem">n'</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> impE <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
          <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> a1 <span class="quoted"><span class="quoted">‹<span class="skolem">n'</span><span class="main">≥</span><span class="free">n</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">n'</span><span class="main">&lt;</span><span class="skolem">n''</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">γ'</span> <span class="free">t</span> <span class="skolem">n'</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
          <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="free">γ''</span> <span class="free">t</span> <span class="skolem">n'</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
        <span class="keyword1"><span class="command">qed</span></span>
      <span class="keyword1"><span class="command">qed</span></span>
      <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">next</span></span>
    <span class="keyword3"><span class="command">assume</span></span> a1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound"><span class="bound">n'</span></span><span class="main">≥</span><span class="free">n</span><span class="main">.</span> <span class="free">γ'</span> <span class="free">t</span> <span class="bound">n'</span>"</span></span>
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound"><span class="bound">n'</span></span><span class="main">≥</span><span class="free">n</span><span class="main">.</span> <span class="free">γ''</span> <span class="free">t</span> <span class="bound">n'</span>"</span></span>
    <span class="keyword1"><span class="command">proof</span></span>
      <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">n'</span>
      <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">n'</span><span class="main">≥</span><span class="free">n</span> <span class="main">⟶</span> <span class="free">γ''</span> <span class="free">t</span> <span class="skolem">n'</span>"</span></span>
      <span class="keyword1"><span class="command">proof</span></span>
        <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">n'</span><span class="main">≥</span><span class="free">n</span>"</span></span>
        <span class="keyword1"><span class="command">with</span></span> assms<span class="main">(</span>2<span class="main">)</span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">γ'</span> <span class="keyword1">⟶<span class="hidden">⇧</span><sup>c</sup></span> <span class="free">γ''</span><span class="main">)</span> <span class="free">t</span> <span class="skolem">n'</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> globE <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
        <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="free">γ'</span> <span class="free">t</span> <span class="skolem">n'</span> <span class="main">⟶</span> <span class="free">γ''</span> <span class="free">t</span> <span class="skolem">n'</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> impE <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> a1 <span class="quoted"><span class="quoted">‹<span class="skolem">n'</span><span class="main">≥</span><span class="free">n</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">γ'</span> <span class="free">t</span> <span class="skolem">n'</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
        <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="free">γ''</span> <span class="free">t</span> <span class="skolem">n'</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
      <span class="keyword1"><span class="command">qed</span></span>
    <span class="keyword1"><span class="command">qed</span></span>
    <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">∃</span><span class="bound"><span class="bound">n''</span></span><span class="main">≥</span><span class="free">n</span><span class="main">.</span> <span class="free">γ</span> <span class="free">t</span> <span class="bound">n''</span> <span class="main">∧</span> <span class="main">(</span><span class="main">∀</span><span class="bound"><span class="bound">n'</span></span><span class="main">≥</span><span class="free">n</span><span class="main">.</span> <span class="bound">n'</span> <span class="main">&lt;</span> <span class="bound">n''</span> <span class="main">⟶</span> <span class="free">γ''</span> <span class="free">t</span> <span class="bound">n'</span><span class="main">)</span><span class="main">)</span> <span class="main">∨</span> <span class="main">(</span><span class="main">∀</span><span class="bound"><span class="bound">n'</span></span><span class="main">≥</span><span class="free">n</span><span class="main">.</span> <span class="free">γ''</span> <span class="free">t</span> <span class="bound">n'</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">qed</span></span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">subsection</span></span> <span class="quoted"><span class="plain_text">"Dynamic Components"</span></span>
<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹
  To support the specification of patterns over dynamic architectures we provide a locale for dynamic components.
  It takes the following type parameters:
  \begin{itemize}
    \item id: a type for component identifiers
    \item cmp: a type for components
    \item cnf: a type for architecture configurations
  \end{itemize}
›</span></span>
<span class="keyword1"><span class="command">locale</span></span> dynamic_component <span class="main">=</span>
  <span class="keyword2"><span class="keyword">fixes</span></span> <span class="free">tCMP</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'id</span> <span class="main">⇒</span> cnf <span class="main">⇒</span> <span class="tfree">'cmp</span>"</span></span> <span class="main">(</span><span class="quoted">"<span class="keyword1">σ⇘</span>_<span class="keyword1">⇙</span><span class="keyword3">(</span>_<span class="keyword3">)</span>"</span> <span class="main">[</span>0<span class="main">,</span>110<span class="main">]</span>60<span class="main">)</span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="free">active</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'id</span> <span class="main">⇒</span> cnf <span class="main">⇒</span> bool"</span></span> <span class="main">(</span><span class="quoted">"<span class="keyword1">∥</span>_<span class="keyword1">∥⇘</span>_<span class="keyword1">⇙</span>"</span> <span class="main">[</span>0<span class="main">,</span>110<span class="main">]</span>60<span class="main">)</span>
<span class="keyword2"><span class="keyword">begin</span></span>
  
<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹
  The locale requires two parameters:
  \begin{itemize}
    \item <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">term</span></span> <span class="quoted"><span class="free"><span class="quoted"><span class="free">tCMP</span></span></span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span> is an operator to obtain a component with a certain identifier from an architecture configuration.
    \item <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">term</span></span> <span class="quoted"><span class="free"><span class="quoted"><span class="free">active</span></span></span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span> is a predicate to assert whether a certain component is activated within an architecture configuration.
  \end{itemize}
›</span></span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹
  The locale provides some general properties about its parameters and introduces six important operators over configuration traces:
  \begin{itemize}
    \item An operator to extract the behavior of a certain component out of a given configuration trace.
    \item An operator to obtain the number of activations of a certain component within a given configuration trace.
    \item An operator to obtain the least point in time (before a certain point in time) from which on a certain component is not activated anymore.
    \item An operator to obtain the latest point in time where a certain component was activated.
    \item Two operators to map time-points between configuration traces and behavior traces.
  \end{itemize}
  Moreover, the locale provides several properties about the operators and their relationships.
›</span></span>

<span class="keyword1" id="Configuration_Traces-nact_active"><span class="command">lemma</span></span> nact_active<span class="main">:</span>
  <span class="keyword2"><span class="keyword">fixes</span></span> <span class="free">t</span><span class="main">::</span><span class="quoted"><span class="quoted">"nat <span class="main">⇒</span> cnf"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="free">n</span><span class="main">::</span><span class="quoted">nat</span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="free">n''</span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="free">id</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="main"><span class="free">∥</span></span><span class="free">id</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="free">n</span></sub><span class="hidden">⇙</span>"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">n''</span> <span class="main">≥</span> <span class="free">n</span>"</span></span>    
    <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> <span class="main">(</span><span class="main">∃</span><span class="bound"><span class="bound">n'</span></span><span class="main">≥</span><span class="free">n</span><span class="main">.</span> <span class="bound">n'</span> <span class="main">&lt;</span> <span class="free">n''</span> <span class="main">∧</span> <span class="main"><span class="free">∥</span></span><span class="free">id</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">n'</span></sub><span class="hidden">⇙</span><span class="main">)</span>"</span></span>    
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">n</span><span class="main">=</span><span class="free">n''</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> assms le_eq_less_or_eq <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1" id="Configuration_Traces-nact_exists"><span class="command">lemma</span></span> nact_exists<span class="main">:</span>
  <span class="keyword2"><span class="keyword">fixes</span></span> <span class="free">t</span><span class="main">::</span><span class="quoted"><span class="quoted">"nat <span class="main">⇒</span> cnf"</span></span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound"><span class="bound">i</span></span><span class="main">≥</span><span class="free">n</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i</span></sub><span class="hidden">⇙</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound"><span class="bound">i</span></span><span class="main">≥</span><span class="free">n</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i</span></sub><span class="hidden">⇙</span> <span class="main">∧</span> <span class="main">(</span><span class="main">∄</span><span class="bound">k</span><span class="main">.</span> <span class="free">n</span><span class="main">≤</span><span class="bound">k</span> <span class="main">∧</span> <span class="bound">k</span><span class="main">&lt;</span><span class="bound">i</span> <span class="main">∧</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">k</span></sub><span class="hidden">⇙</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?L</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"<span class="keyword1">LEAST</span> <span class="bound">i</span><span class="main">.</span> <span class="main">(</span><span class="bound">i</span><span class="main">≥</span><span class="free">n</span> <span class="main">∧</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i</span></sub><span class="hidden">⇙</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">from</span></span> assms <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="var">?L</span><span class="main">≥</span><span class="free">n</span> <span class="main">∧</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="var">?L</span></sub><span class="hidden">⇙</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> LeastI<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="quoted">"<span class="main">λ</span><span class="bound">x</span><span class="main">::</span>nat<span class="main">.</span> <span class="main">(</span><span class="bound">x</span><span class="main">≥</span><span class="free">n</span> <span class="main">∧</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">x</span></sub><span class="hidden">⇙</span><span class="main">)</span>"</span></span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">∄</span><span class="bound">k</span><span class="main">.</span> <span class="free">n</span><span class="main">≤</span><span class="bound">k</span> <span class="main">∧</span> <span class="bound">k</span><span class="main">&lt;</span><span class="var">?L</span> <span class="main">∧</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">k</span></sub><span class="hidden">⇙</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> not_less_Least <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="Configuration_Traces-lActive_least"><span class="command">lemma</span></span> lActive_least<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound"><span class="bound">i</span></span><span class="main">≥</span><span class="free">n</span><span class="main">.</span> <span class="bound">i</span> <span class="main">&lt;</span> llength <span class="free">t</span> <span class="main">∧</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub>lnth <span class="free">t</span> <span class="bound">i</span></sub><span class="hidden">⇙</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound"><span class="bound">i</span></span><span class="main">≥</span><span class="free">n</span><span class="main">.</span> <span class="main">(</span><span class="bound">i</span> <span class="main">&lt;</span> llength <span class="free">t</span> <span class="main">∧</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub>lnth <span class="free">t</span> <span class="bound">i</span></sub><span class="hidden">⇙</span> <span class="main">∧</span> <span class="main">(</span><span class="main">∄</span><span class="bound">k</span><span class="main">.</span> <span class="free">n</span><span class="main">≤</span><span class="bound">k</span> <span class="main">∧</span> <span class="bound">k</span><span class="main">&lt;</span><span class="bound">i</span> <span class="main">∧</span> <span class="bound">k</span><span class="main">&lt;</span>llength <span class="free">t</span> <span class="main">∧</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub>lnth <span class="free">t</span> <span class="bound">k</span></sub><span class="hidden">⇙</span><span class="main">)</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?L</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"<span class="keyword1">LEAST</span> <span class="bound">i</span><span class="main">.</span> <span class="main">(</span><span class="bound">i</span><span class="main">≥</span><span class="free">n</span> <span class="main">∧</span> <span class="bound">i</span> <span class="main">&lt;</span> llength <span class="free">t</span> <span class="main">∧</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub>lnth <span class="free">t</span> <span class="bound">i</span></sub><span class="hidden">⇙</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">from</span></span> assms <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="var">?L</span><span class="main">≥</span><span class="free">n</span> <span class="main">∧</span> <span class="var">?L</span> <span class="main">&lt;</span> llength <span class="free">t</span> <span class="main">∧</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub>lnth <span class="free">t</span> <span class="var">?L</span></sub><span class="hidden">⇙</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> LeastI<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="quoted">"<span class="main">λ</span><span class="bound">x</span><span class="main">::</span>nat<span class="main">.</span><span class="main">(</span><span class="bound">x</span><span class="main">≥</span><span class="free">n</span> <span class="main">∧</span> <span class="bound">x</span><span class="main">&lt;</span>llength <span class="free">t</span> <span class="main">∧</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub>lnth <span class="free">t</span> <span class="bound">x</span></sub><span class="hidden">⇙</span><span class="main">)</span>"</span></span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">∄</span><span class="bound">k</span><span class="main">.</span> <span class="free">n</span><span class="main">≤</span><span class="bound">k</span> <span class="main">∧</span> <span class="bound">k</span><span class="main">&lt;</span>llength <span class="free">t</span> <span class="main">∧</span> <span class="bound">k</span><span class="main">&lt;</span><span class="var">?L</span> <span class="main">∧</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub>lnth <span class="free">t</span> <span class="bound">k</span></sub><span class="hidden">⇙</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> not_less_Least <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">subsection</span></span> <span class="quoted"><span class="plain_text">"Projection"</span></span>
<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹
  In the following we introduce an operator which extracts the behavior of a certain component out of a given configuration trace.
›</span></span>

<span class="keyword1"><span class="command">definition</span></span> <span class="entity">proj</span><span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'id</span> <span class="main">⇒</span> <span class="main">(</span>cnf llist<span class="main">)</span> <span class="main">⇒</span> <span class="main">(</span><span class="tfree">'cmp</span> llist<span class="main">)</span>"</span></span> <span class="main">(</span><span class="quoted">"<span class="keyword1">π⇘</span>_<span class="keyword1">⇙</span><span class="keyword3">(</span>_<span class="keyword3">)</span>"</span> <span class="main">[</span>0<span class="main">,</span>110<span class="main">]</span>60<span class="main">)</span> 
  <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="free">proj</span> <span class="free"><span class="bound"><span class="entity">c</span></span></span> <span class="main">=</span> lmap <span class="main">(</span><span class="main">λ</span><span class="bound">cnf</span><span class="main">.</span> <span class="main">(</span>σ<span class="hidden">⇘</span><sub><span class="free"><span class="bound"><span class="entity">c</span></span></span></sub><span class="hidden">⇙</span><span class="main">(</span><span class="bound">cnf</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">∘</span> <span class="main">(</span>lfilter <span class="main">(</span><span class="free">active</span> <span class="free"><span class="bound"><span class="entity">c</span></span></span><span class="main">)</span><span class="main">)</span>"</span></span>

<span class="keyword1" id="Configuration_Traces-proj_lnil"><span class="command">lemma</span></span> proj_lnil <span class="main">[</span><span class="operator">simp</span><span class="main">,</span><span class="operator">intro</span><span class="main">]</span><span class="main">:</span>
  <span class="quoted"><span class="quoted">"π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span><span class="keyword1">[]<span class="hidden">⇩</span><sub>l</sub></span><span class="main">)</span> <span class="main">=</span> <span class="keyword1">[]<span class="hidden">⇩</span><sub>l</sub></span>"</span></span> <span class="keyword1"><span class="command">using</span></span> proj_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>

<span class="keyword1" id="Configuration_Traces-proj_lnull"><span class="command">lemma</span></span> proj_lnull <span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span>
  <span class="quoted"><span class="quoted">"π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span><span class="free">t</span><span class="main">)</span> <span class="main">=</span> <span class="keyword1">[]<span class="hidden">⇩</span><sub>l</sub></span> <span class="main">⟷</span> <span class="main">(</span><span class="main">∀</span><span class="bound">k</span> <span class="main">∈</span> lset <span class="free">t</span><span class="main">.</span> <span class="main">¬</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="bound">k</span></sub><span class="hidden">⇙</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span>
  <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span><span class="free">t</span><span class="main">)</span> <span class="main">=</span> <span class="keyword1">[]<span class="hidden">⇩</span><sub>l</sub></span>"</span></span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"lfilter <span class="main">(</span><span class="free">active</span> <span class="free">c</span><span class="main">)</span> <span class="free">t</span> <span class="main">=</span> <span class="keyword1">[]<span class="hidden">⇩</span><sub>l</sub></span>"</span></span> <span class="keyword1"><span class="command">using</span></span> proj_def lmap_eq_LNil <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">k</span> <span class="main">∈</span> lset <span class="free">t</span><span class="main">.</span> <span class="main">¬</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="bound">k</span></sub><span class="hidden">⇙</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> lfilter_eq_LNil<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="quoted">"<span class="free">active</span> <span class="free">c</span>"</span></span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">next</span></span>
  <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">k</span><span class="main">∈</span>lset <span class="free">t</span><span class="main">.</span> <span class="main">¬</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="bound">k</span></sub><span class="hidden">⇙</span>"</span></span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"lfilter <span class="main">(</span><span class="free">active</span> <span class="free">c</span><span class="main">)</span> <span class="free">t</span> <span class="main">=</span> <span class="keyword1">[]<span class="hidden">⇩</span><sub>l</sub></span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span><span class="free">t</span><span class="main">)</span> <span class="main">=</span> <span class="keyword1">[]<span class="hidden">⇩</span><sub>l</sub></span>"</span></span> <span class="keyword1"><span class="command">using</span></span> proj_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>
  
<span class="keyword1" id="Configuration_Traces-proj_LCons"><span class="command">lemma</span></span> proj_LCons <span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span>
  <span class="quoted"><span class="quoted">"π<span class="hidden">⇘</span><sub><span class="free">i</span></sub><span class="hidden">⇙</span><span class="main">(</span><span class="free">x</span> <span class="keyword1">#<span class="hidden">⇩</span><sub>l</sub></span> <span class="free">xs</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="keyword1">if</span> <span class="main"><span class="free">∥</span></span><span class="free">i</span>∥<span class="hidden">⇘</span><sub><span class="free">x</span></sub><span class="hidden">⇙</span> <span class="keyword1">then</span> <span class="main">(</span>σ<span class="hidden">⇘</span><sub><span class="free">i</span></sub><span class="hidden">⇙</span><span class="main">(</span><span class="free">x</span><span class="main">)</span><span class="main">)</span> <span class="keyword1">#<span class="hidden">⇩</span><sub>l</sub></span> <span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">i</span></sub><span class="hidden">⇙</span><span class="main">(</span><span class="free">xs</span><span class="main">)</span><span class="main">)</span> <span class="keyword1">else</span> π<span class="hidden">⇘</span><sub><span class="free">i</span></sub><span class="hidden">⇙</span><span class="main">(</span><span class="free">xs</span><span class="main">)</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> proj_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    
<span class="keyword1" id="Configuration_Traces-proj_llength"><span class="command">lemma</span></span> proj_llength<span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span>
  <span class="quoted"><span class="quoted">"llength <span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span><span class="free">t</span><span class="main">)</span><span class="main">)</span> <span class="main">≤</span> llength <span class="free">t</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> llength_lfilter_ile proj_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>

<span class="keyword1" id="Configuration_Traces-proj_ltake"><span class="command">lemma</span></span> proj_ltake<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="main">(</span><span class="bound"><span class="bound">n'</span></span><span class="main">::</span>nat<span class="main">)</span><span class="main">≤</span>llength <span class="free">t</span><span class="main">.</span> <span class="bound">n'</span><span class="main">≥</span><span class="free">n</span> <span class="main">⟶</span> <span class="main">(</span><span class="main">¬</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub>lnth <span class="free">t</span> <span class="bound">n'</span></sub><span class="hidden">⇙</span><span class="main">)</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span><span class="free">t</span><span class="main">)</span> <span class="main">=</span> π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>ltake <span class="free">n</span> <span class="free">t</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> lfilter_ltake proj_def assms <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> comp_apply<span class="main">)</span>
    
<span class="keyword1" id="Configuration_Traces-proj_finite_bound"><span class="command">lemma</span></span> proj_finite_bound<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"lfinite <span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>inf_llist <span class="free">t</span><span class="main">)</span><span class="main">)</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound">n</span><span class="main">.</span> <span class="main">∀</span><span class="bound"><span class="bound">n'</span></span><span class="main">&gt;</span><span class="bound">n</span><span class="main">.</span> <span class="main">¬</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">n'</span></sub><span class="hidden">⇙</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> assms lfilter_lfinite<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="quoted">"<span class="free">active</span> <span class="free">c</span>"</span></span> <span class="quoted"><span class="quoted">"inf_llist <span class="free">t</span>"</span></span><span class="main">]</span> proj_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>

<span class="keyword1"><span class="command">subsubsection</span></span> <span class="quoted"><span class="plain_text">"Monotonicity and Continuity"</span></span>

<span class="keyword1" id="Configuration_Traces-proj_mcont"><span class="command">lemma</span></span> proj_mcont<span class="main">:</span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"mcont lSup lprefix lSup lprefix <span class="main">(</span>proj <span class="free">c</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"mcont lSup lprefix lSup lprefix <span class="main">(</span><span class="main">λ</span><span class="bound">x</span><span class="main">.</span> lmap <span class="main">(</span><span class="main">λ</span><span class="bound">cnf</span><span class="main">.</span> σ<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span><span class="bound">cnf</span><span class="main">)</span><span class="main">)</span> <span class="main">(</span>lfilter <span class="main">(</span><span class="free">active</span> <span class="free">c</span><span class="main">)</span> <span class="bound">x</span><span class="main">)</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">λ</span><span class="bound">x</span><span class="main">.</span> lmap <span class="main">(</span><span class="main">λ</span><span class="bound">cnf</span><span class="main">.</span> σ<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span><span class="bound">cnf</span><span class="main">)</span><span class="main">)</span> <span class="main">(</span>lfilter <span class="main">(</span><span class="free">active</span> <span class="free">c</span><span class="main">)</span> <span class="bound">x</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span>
    lmap <span class="main">(</span><span class="main">λ</span><span class="bound">cnf</span><span class="main">.</span> σ<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span><span class="bound">cnf</span><span class="main">)</span><span class="main">)</span> <span class="main">∘</span> lfilter <span class="main">(</span><span class="free">active</span> <span class="free">c</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> proj_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="Configuration_Traces-proj_mcont2mcont"><span class="command">lemma</span></span> proj_mcont2mcont<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"mcont <span class="free">lub</span> <span class="free">ord</span> lSup lprefix <span class="free">f</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"mcont <span class="free">lub</span> <span class="free">ord</span> lSup lprefix <span class="main">(</span><span class="main">λ</span><span class="bound">x</span><span class="main">.</span> π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span><span class="free">f</span> <span class="bound">x</span><span class="main">)</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"mcont lSup lprefix lSup lprefix <span class="main">(</span>proj <span class="free">c</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> proj_mcont <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">with</span></span> assms <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> llist.mcont2mcont<span class="main">[</span><span class="operator">of</span> <span class="quoted">lSup</span> <span class="quoted">lprefix</span> <span class="quoted"><span class="quoted">"proj <span class="free">c</span>"</span></span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>
    
<span class="keyword1" id="Configuration_Traces-proj_mono_prefix"><span class="command">lemma</span></span> proj_mono_prefix<span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"lprefix <span class="free">t</span> <span class="free">t'</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"lprefix <span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span><span class="free">t</span><span class="main">)</span><span class="main">)</span> <span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span><span class="free">t'</span><span class="main">)</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">from</span></span> assms <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"lprefix <span class="main">(</span>lfilter <span class="main">(</span><span class="free">active</span> <span class="free">c</span><span class="main">)</span> <span class="free">t</span><span class="main">)</span> <span class="main">(</span>lfilter <span class="main">(</span><span class="free">active</span> <span class="free">c</span><span class="main">)</span> <span class="free">t'</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> lprefix_lfilterI <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"lprefix <span class="main">(</span>lmap <span class="main">(</span><span class="main">λ</span><span class="bound">cnf</span><span class="main">.</span> σ<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span><span class="bound">cnf</span><span class="main">)</span><span class="main">)</span> <span class="main">(</span>lfilter <span class="main">(</span><span class="free">active</span> <span class="free">c</span><span class="main">)</span> <span class="free">t</span><span class="main">)</span><span class="main">)</span>
    <span class="main">(</span>lmap <span class="main">(</span><span class="main">λ</span><span class="bound">cnf</span><span class="main">.</span> σ<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span><span class="bound">cnf</span><span class="main">)</span><span class="main">)</span> <span class="main">(</span>lfilter <span class="main">(</span><span class="free">active</span> <span class="free">c</span><span class="main">)</span> <span class="free">t'</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> lmap_lprefix <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> proj_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>
 
<span class="keyword1"><span class="command">subsubsection</span></span> <span class="quoted"><span class="plain_text">"Finiteness"</span></span>
    
<span class="keyword1" id="Configuration_Traces-proj_finite"><span class="command">lemma</span></span> proj_finite<span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"lfinite <span class="free">t</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"lfinite <span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span><span class="free">t</span><span class="main">)</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> assms proj_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>

<span class="keyword1" id="Configuration_Traces-proj_finite2"><span class="command">lemma</span></span> proj_finite2<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="main">(</span><span class="bound"><span class="bound">n'</span></span><span class="main">::</span>nat<span class="main">)</span><span class="main">≤</span>llength <span class="free">t</span><span class="main">.</span> <span class="bound">n'</span><span class="main">≥</span><span class="free">n</span> <span class="main">⟶</span> <span class="main">(</span><span class="main">¬</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub>lnth <span class="free">t</span> <span class="bound">n'</span></sub><span class="hidden">⇙</span><span class="main">)</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"lfinite <span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span><span class="free">t</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms proj_ltake proj_finite <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>

<span class="keyword1" id="Configuration_Traces-proj_append_lfinite"><span class="command">lemma</span></span> proj_append_lfinite<span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span>
  <span class="keyword2"><span class="keyword">fixes</span></span> <span class="free">t</span> <span class="free">t'</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"lfinite <span class="free">t</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span><span class="free">t</span> <span class="keyword1">@<span class="hidden">⇩</span><sub>l</sub></span> <span class="free">t'</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span><span class="free">t</span><span class="main">)</span><span class="main">)</span> <span class="keyword1">@<span class="hidden">⇩</span><sub>l</sub></span> <span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span><span class="free">t'</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">is</span></span> <span class="quoted"><span class="quoted">"<span class="var">?lhs</span><span class="main">=</span><span class="var">?rhs</span>"</span></span><span class="main">)</span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="var">?lhs</span> <span class="main">=</span> <span class="main">(</span>lmap <span class="main">(</span><span class="main">λ</span><span class="bound">cnf</span><span class="main">.</span> σ<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span><span class="bound">cnf</span><span class="main">)</span><span class="main">)</span> <span class="main">∘</span> <span class="main">(</span>lfilter <span class="main">(</span><span class="free">active</span> <span class="free">c</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">(</span><span class="free">t</span> <span class="keyword1">@<span class="hidden">⇩</span><sub>l</sub></span> <span class="free">t'</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> proj_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">…</span> <span class="main">=</span> lmap <span class="main">(</span><span class="main">λ</span><span class="bound">cnf</span><span class="main">.</span> σ<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span><span class="bound">cnf</span><span class="main">)</span><span class="main">)</span> <span class="main">(</span>lfilter <span class="main">(</span><span class="free">active</span> <span class="free">c</span><span class="main">)</span> <span class="main">(</span><span class="free">t</span> <span class="keyword1">@<span class="hidden">⇩</span><sub>l</sub></span> <span class="free">t'</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">from</span></span> assms <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">…</span> <span class="main">=</span> lmap <span class="main">(</span><span class="main">λ</span><span class="bound">cnf</span><span class="main">.</span> σ<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span><span class="bound">cnf</span><span class="main">)</span><span class="main">)</span>
    <span class="main">(</span><span class="main">(</span>lfilter <span class="main">(</span><span class="free">active</span> <span class="free">c</span><span class="main">)</span> <span class="free">t</span><span class="main">)</span> <span class="keyword1">@<span class="hidden">⇩</span><sub>l</sub></span> <span class="main">(</span>lfilter <span class="main">(</span><span class="free">active</span> <span class="free">c</span><span class="main">)</span> <span class="free">t'</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">…</span> <span class="main">=</span> <span class="keyword1">(@<span class="hidden">⇩</span><sub>l</sub>)</span> <span class="main">(</span>lmap <span class="main">(</span><span class="main">λ</span><span class="bound">cnf</span><span class="main">.</span> σ<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span><span class="bound">cnf</span><span class="main">)</span><span class="main">)</span> <span class="main">(</span>lfilter <span class="main">(</span><span class="free">active</span> <span class="free">c</span><span class="main">)</span> <span class="free">t</span><span class="main">)</span><span class="main">)</span>
    <span class="main">(</span>lmap <span class="main">(</span><span class="main">λ</span><span class="bound">cnf</span><span class="main">.</span> σ<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span><span class="bound">cnf</span><span class="main">)</span><span class="main">)</span> <span class="main">(</span>lfilter <span class="main">(</span><span class="free">active</span> <span class="free">c</span><span class="main">)</span> <span class="free">t'</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> lmap_lappend_distrib <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">…</span> <span class="main">=</span> <span class="var">?rhs</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> proj_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">finally</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">.</span></span>
<span class="keyword1"><span class="command">qed</span></span>
  
<span class="keyword1" id="Configuration_Traces-proj_one"><span class="command">lemma</span></span> proj_one<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound">i</span><span class="main">.</span> <span class="bound">i</span> <span class="main">&lt;</span> llength <span class="free">t</span> <span class="main">∧</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub>lnth <span class="free">t</span> <span class="bound">i</span></sub><span class="hidden">⇙</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"llength <span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span><span class="free">t</span><span class="main">)</span><span class="main">)</span> <span class="main">≥</span> <span class="main">1</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">from</span></span> assms <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound">x</span><span class="main">∈</span>lset <span class="free">t</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="bound">x</span></sub><span class="hidden">⇙</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> lset_conv_lnth <span class="keyword1"><span class="command">by</span></span> <span class="operator">force</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> lfilter <span class="main">(</span><span class="main">λ</span><span class="bound">k</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="bound">k</span></sub><span class="hidden">⇙</span><span class="main">)</span> <span class="free">t</span> <span class="main">=</span> <span class="keyword1">[]<span class="hidden">⇩</span><sub>l</sub></span>"</span></span> <span class="keyword1"><span class="command">using</span></span> lfilter_eq_LNil<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">λ</span><span class="bound">k</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="bound">k</span></sub><span class="hidden">⇙</span><span class="main">)</span>"</span></span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span><span class="free">t</span><span class="main">)</span> <span class="main">=</span> <span class="keyword1">[]<span class="hidden">⇩</span><sub>l</sub></span>"</span></span> <span class="keyword1"><span class="command">using</span></span> proj_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">fastforce</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> ileI1 lnull_def one_eSuc<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">subsubsection</span></span> <span class="quoted"><span class="plain_text">"Projection not Active"</span></span>
  
<span class="keyword1" id="Configuration_Traces-proj_not_active"><span class="command">lemma</span></span> proj_not_active<span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"enat <span class="free">n</span> <span class="main">&lt;</span> llength <span class="free">t</span>"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub>lnth <span class="free">t</span> <span class="free">n</span></sub><span class="hidden">⇙</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>ltake <span class="main">(</span>Suc <span class="free">n</span><span class="main">)</span> <span class="free">t</span><span class="main">)</span> <span class="main">=</span> π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>ltake <span class="free">n</span> <span class="free">t</span><span class="main">)</span>"</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">is</span></span> <span class="quoted"><span class="quoted">"<span class="var">?lhs</span> <span class="main">=</span> <span class="var">?rhs</span>"</span></span><span class="main">)</span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">from</span></span> assms <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"ltake <span class="main">(</span>enat <span class="main">(</span>Suc <span class="free">n</span><span class="main">)</span><span class="main">)</span> <span class="free">t</span> <span class="main">=</span> <span class="main">(</span>ltake <span class="main">(</span>enat <span class="free">n</span><span class="main">)</span> <span class="free">t</span><span class="main">)</span> <span class="keyword1">@<span class="hidden">⇩</span><sub>l</sub></span> <span class="main">(</span><span class="main">(</span>lnth <span class="free">t</span> <span class="free">n</span><span class="main">)</span> <span class="keyword1">#<span class="hidden">⇩</span><sub>l</sub></span> <span class="keyword1">[]<span class="hidden">⇩</span><sub>l</sub></span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> ltake_Suc_conv_snoc_lnth <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="var">?lhs</span> <span class="main">=</span> π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span><span class="main">(</span>ltake <span class="main">(</span>enat <span class="free">n</span><span class="main">)</span> <span class="free">t</span><span class="main">)</span> <span class="keyword1">@<span class="hidden">⇩</span><sub>l</sub></span> <span class="main">(</span><span class="main">(</span>lnth <span class="free">t</span> <span class="free">n</span><span class="main">)</span> <span class="keyword1">#<span class="hidden">⇩</span><sub>l</sub></span> <span class="keyword1">[]<span class="hidden">⇩</span><sub>l</sub></span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">…</span> <span class="main">=</span> <span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>ltake <span class="main">(</span>enat <span class="free">n</span><span class="main">)</span> <span class="free">t</span><span class="main">)</span><span class="main">)</span> <span class="keyword1">@<span class="hidden">⇩</span><sub>l</sub></span> <span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span><span class="main">(</span>lnth <span class="free">t</span> <span class="free">n</span><span class="main">)</span> <span class="keyword1">#<span class="hidden">⇩</span><sub>l</sub></span> <span class="keyword1">[]<span class="hidden">⇩</span><sub>l</sub></span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> assms <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span><span class="main">(</span>lnth <span class="free">t</span> <span class="free">n</span><span class="main">)</span> <span class="keyword1">#<span class="hidden">⇩</span><sub>l</sub></span> <span class="keyword1">[]<span class="hidden">⇩</span><sub>l</sub></span><span class="main">)</span> <span class="main">=</span> <span class="keyword1">[]<span class="hidden">⇩</span><sub>l</sub></span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="Configuration_Traces-proj_not_active_same"><span class="command">lemma</span></span> proj_not_active_same<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"enat <span class="free">n</span> <span class="main">≤</span> <span class="main">(</span><span class="free">n'</span><span class="main">::</span>enat<span class="main">)</span>"</span></span>
      <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> lfinite <span class="free">t</span> <span class="main">∨</span> <span class="free">n'</span><span class="main">-</span><span class="main">1</span> <span class="main">&lt;</span> llength <span class="free">t</span>"</span></span>
      <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">∄</span><span class="bound">k</span><span class="main">.</span> <span class="bound">k</span><span class="main">≥</span><span class="free">n</span> <span class="main">∧</span> <span class="bound">k</span><span class="main">&lt;</span><span class="free">n'</span> <span class="main">∧</span> <span class="bound">k</span> <span class="main">&lt;</span> llength <span class="free">t</span> <span class="main">∧</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub>lnth <span class="free">t</span> <span class="bound">k</span></sub><span class="hidden">⇙</span>"</span></span>
    <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>ltake <span class="free">n'</span> <span class="free">t</span><span class="main">)</span> <span class="main">=</span> π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>ltake <span class="free">n</span> <span class="free">t</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>ltake <span class="main">(</span><span class="free">n</span> <span class="main">+</span> <span class="main">(</span><span class="free">n'</span> <span class="main">-</span> <span class="free">n</span><span class="main">)</span><span class="main">)</span> <span class="free">t</span><span class="main">)</span> <span class="main">=</span> π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span><span class="main">(</span>ltake <span class="free">n</span> <span class="free">t</span><span class="main">)</span> <span class="keyword1">@<span class="hidden">⇩</span><sub>l</sub></span> <span class="main">(</span>ltake <span class="main">(</span><span class="free">n'</span><span class="main">-</span><span class="free">n</span><span class="main">)</span> <span class="main">(</span>ldrop <span class="free">n</span> <span class="free">t</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> ltake_plus_conv_lappend<span class="main">)</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>ltake <span class="main">(</span><span class="free">n</span> <span class="main">+</span> <span class="main">(</span><span class="free">n'</span> <span class="main">-</span> <span class="free">n</span><span class="main">)</span><span class="main">)</span> <span class="free">t</span><span class="main">)</span> <span class="main">=</span>
    <span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>ltake <span class="free">n</span> <span class="free">t</span><span class="main">)</span><span class="main">)</span> <span class="keyword1">@<span class="hidden">⇩</span><sub>l</sub></span> <span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>ltake <span class="main">(</span><span class="free">n'</span><span class="main">-</span><span class="free">n</span><span class="main">)</span> <span class="main">(</span>ldrop <span class="free">n</span> <span class="free">t</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>ltake <span class="main">(</span><span class="free">n'</span><span class="main">-</span><span class="free">n</span><span class="main">)</span> <span class="main">(</span>ldrop <span class="free">n</span> <span class="free">t</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> <span class="keyword1">[]<span class="hidden">⇩</span><sub>l</sub></span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">k</span><span class="main">∈</span><span class="main">{</span>lnth <span class="main">(</span>ltake <span class="main">(</span><span class="free">n'</span> <span class="main">-</span> enat <span class="free">n</span><span class="main">)</span> <span class="main">(</span>ldrop <span class="main">(</span>enat <span class="free">n</span><span class="main">)</span> <span class="free">t</span><span class="main">)</span><span class="main">)</span> <span class="bound">na</span> <span class="main">|</span>
      <span class="bound">na</span><span class="main">.</span> enat <span class="bound">na</span> <span class="main">&lt;</span> llength <span class="main">(</span>ltake <span class="main">(</span><span class="free">n'</span> <span class="main">-</span> enat <span class="free">n</span><span class="main">)</span> <span class="main">(</span>ldrop <span class="main">(</span>enat <span class="free">n</span><span class="main">)</span> <span class="free">t</span><span class="main">)</span><span class="main">)</span><span class="main">}</span><span class="main">.</span> <span class="main">¬</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="bound">k</span></sub><span class="hidden">⇙</span>"</span></span>
    <span class="keyword1"><span class="command">proof</span></span>
      <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">k</span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">k</span><span class="main">∈</span><span class="main">{</span>lnth <span class="main">(</span>ltake <span class="main">(</span><span class="free">n'</span> <span class="main">-</span> enat <span class="free">n</span><span class="main">)</span> <span class="main">(</span>ldrop <span class="main">(</span>enat <span class="free">n</span><span class="main">)</span> <span class="free">t</span><span class="main">)</span><span class="main">)</span> <span class="bound">na</span> <span class="main">|</span>
        <span class="bound">na</span><span class="main">.</span> enat <span class="bound">na</span> <span class="main">&lt;</span> llength <span class="main">(</span>ltake <span class="main">(</span><span class="free">n'</span> <span class="main">-</span> enat <span class="free">n</span><span class="main">)</span> <span class="main">(</span>ldrop <span class="main">(</span>enat <span class="free">n</span><span class="main">)</span> <span class="free">t</span><span class="main">)</span><span class="main">)</span><span class="main">}</span>"</span></span>
      <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">k'</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"enat <span class="skolem">k'</span> <span class="main">&lt;</span> llength <span class="main">(</span>ltake <span class="main">(</span><span class="free">n'</span> <span class="main">-</span> enat <span class="free">n</span><span class="main">)</span> <span class="main">(</span>ldrop <span class="main">(</span>enat <span class="free">n</span><span class="main">)</span> <span class="free">t</span><span class="main">)</span><span class="main">)</span>"</span></span>
        <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">k</span><span class="main">=</span>lnth <span class="main">(</span>ltake <span class="main">(</span><span class="free">n'</span> <span class="main">-</span> enat <span class="free">n</span><span class="main">)</span> <span class="main">(</span>ldrop <span class="main">(</span>enat <span class="free">n</span><span class="main">)</span> <span class="free">t</span><span class="main">)</span><span class="main">)</span> <span class="skolem">k'</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"enat <span class="main">(</span><span class="skolem">k'</span> <span class="main">+</span> <span class="free">n</span><span class="main">)</span> <span class="main">&lt;</span> llength <span class="free">t</span>"</span></span>
      <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
        <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹enat <span class="skolem">k'</span> <span class="main">&lt;</span> llength <span class="main">(</span>ltake <span class="main">(</span><span class="free">n'</span> <span class="main">-</span> enat <span class="free">n</span><span class="main">)</span> <span class="main">(</span>ldrop <span class="main">(</span>enat <span class="free">n</span><span class="main">)</span> <span class="free">t</span><span class="main">)</span><span class="main">)</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"enat <span class="skolem">k'</span> <span class="main">&lt;</span> <span class="free">n'</span><span class="main">-</span><span class="free">n</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
        <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"enat <span class="skolem">k'</span> <span class="main">+</span> <span class="free">n</span> <span class="main">&lt;</span> <span class="free">n'</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>1<span class="main">)</span> enat_min <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
        <span class="keyword1"><span class="command">proof</span></span> <span class="operator">cases</span>
          <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"lfinite <span class="free">t</span>"</span></span>
          <span class="keyword1"><span class="command">with</span></span> <span class="quoted"><span class="quoted">‹<span class="main">¬</span> lfinite <span class="free">t</span> <span class="main">∨</span> <span class="free">n'</span><span class="main">-</span><span class="main">1</span> <span class="main">&lt;</span> llength <span class="free">t</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">n'</span><span class="main">-</span><span class="main">1</span><span class="main">&lt;</span>llength <span class="free">t</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
          <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="free">n'</span><span class="main">&lt;</span> eSuc <span class="main">(</span>llength <span class="free">t</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> eSuc_minus_1 enat_minus_mono1 leD leI<span class="main">)</span>
          <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="free">n'</span><span class="main">≤</span> llength <span class="free">t</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> eSuc_ile_mono ileI1 <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
          <span class="keyword1"><span class="command">with</span></span> <span class="quoted"><span class="quoted">‹enat <span class="skolem">k'</span> <span class="main">+</span> <span class="free">n</span> <span class="main">&lt;</span> <span class="free">n'</span>›</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> add.commute<span class="main">)</span>
        <span class="keyword1"><span class="command">next</span></span>
          <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> lfinite <span class="free">t</span>"</span></span>
          <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"llength <span class="free">t</span> <span class="main">=</span> <span class="main">∞</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> not_lfinite_llength <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
          <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
        <span class="keyword1"><span class="command">qed</span></span>
      <span class="keyword1"><span class="command">qed</span></span>
      <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">k</span> <span class="main">=</span> lnth <span class="free">t</span> <span class="main">(</span><span class="skolem">k'</span> <span class="main">+</span> <span class="free">n</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
        <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹enat <span class="skolem">k'</span> <span class="main">&lt;</span> llength <span class="main">(</span>ltake <span class="main">(</span><span class="free">n'</span> <span class="main">-</span> enat <span class="free">n</span><span class="main">)</span> <span class="main">(</span>ldrop <span class="main">(</span>enat <span class="free">n</span><span class="main">)</span> <span class="free">t</span><span class="main">)</span><span class="main">)</span>›</span></span>
          <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"enat <span class="skolem">k'</span><span class="main">&lt;</span><span class="free">n'</span> <span class="main">-</span> enat <span class="free">n</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"lnth <span class="main">(</span>ltake <span class="main">(</span><span class="free">n'</span> <span class="main">-</span> enat <span class="free">n</span><span class="main">)</span> <span class="main">(</span>ldrop <span class="main">(</span>enat <span class="free">n</span><span class="main">)</span> <span class="free">t</span><span class="main">)</span><span class="main">)</span> <span class="skolem">k'</span> <span class="main">=</span> lnth <span class="main">(</span>ldrop <span class="main">(</span>enat <span class="free">n</span><span class="main">)</span> <span class="free">t</span><span class="main">)</span> <span class="skolem">k'</span>"</span></span>
          <span class="keyword1"><span class="command">using</span></span> lnth_ltake<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="skolem">k'</span></span> <span class="quoted"><span class="quoted">"<span class="free">n'</span> <span class="main">-</span> enat <span class="free">n</span>"</span></span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
        <span class="keyword1"><span class="command">with</span></span> <span class="quoted"><span class="quoted">‹enat <span class="main">(</span><span class="skolem">k'</span> <span class="main">+</span> <span class="free">n</span><span class="main">)</span> <span class="main">&lt;</span> llength <span class="free">t</span>›</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> lnth_ldrop<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="free">n</span></span> <span class="quoted"><span class="skolem">k'</span></span> <span class="quoted"><span class="free">t</span></span> <span class="main">]</span>
          <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">k</span> <span class="main">=</span> lnth <span class="main">(</span>ltake <span class="main">(</span><span class="free">n'</span> <span class="main">-</span> enat <span class="free">n</span><span class="main">)</span> <span class="main">(</span>ldrop <span class="main">(</span>enat <span class="free">n</span><span class="main">)</span> <span class="free">t</span><span class="main">)</span><span class="main">)</span> <span class="skolem">k'</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> add.commute<span class="main">)</span>
      <span class="keyword1"><span class="command">qed</span></span>
      <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹enat <span class="free">n</span> <span class="main">≤</span> <span class="main">(</span><span class="free">n'</span><span class="main">::</span>enat<span class="main">)</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">k'</span> <span class="main">+</span> the_enat <span class="free">n</span><span class="main">≥</span><span class="free">n</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹enat <span class="skolem">k'</span> <span class="main">&lt;</span> llength <span class="main">(</span>ltake <span class="main">(</span><span class="free">n'</span> <span class="main">-</span> enat <span class="free">n</span><span class="main">)</span> <span class="main">(</span>ldrop <span class="main">(</span>enat <span class="free">n</span><span class="main">)</span> <span class="free">t</span><span class="main">)</span><span class="main">)</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">k'</span> <span class="main">+</span> <span class="free">n</span><span class="main">&lt;</span><span class="free">n'</span>"</span></span>
        <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>1<span class="main">)</span> enat_min <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="skolem">k</span></sub><span class="hidden">⇙</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="main">∄</span><span class="bound">k</span><span class="main">.</span> <span class="bound">k</span><span class="main">≥</span><span class="free">n</span> <span class="main">∧</span> <span class="bound">k</span><span class="main">&lt;</span><span class="free">n'</span> <span class="main">∧</span> <span class="bound">k</span> <span class="main">&lt;</span> llength <span class="free">t</span> <span class="main">∧</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub>lnth <span class="free">t</span> <span class="bound">k</span></sub><span class="hidden">⇙</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">qed</span></span>
    <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">k</span><span class="main">∈</span>lset <span class="main">(</span>ltake <span class="main">(</span><span class="free">n'</span><span class="main">-</span><span class="free">n</span><span class="main">)</span> <span class="main">(</span>ldrop <span class="free">n</span> <span class="free">t</span><span class="main">)</span><span class="main">)</span><span class="main">.</span> <span class="main">¬</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="bound">k</span></sub><span class="hidden">⇙</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> lset_conv_lnth<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="quoted">"<span class="main">(</span>ltake <span class="main">(</span><span class="free">n'</span> <span class="main">-</span> enat <span class="free">n</span><span class="main">)</span> <span class="main">(</span>ldrop <span class="main">(</span>enat <span class="free">n</span><span class="main">)</span> <span class="free">t</span><span class="main">)</span><span class="main">)</span>"</span></span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> proj_lnull <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> assms <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">n</span> <span class="main">+</span> <span class="main">(</span><span class="free">n'</span> <span class="main">-</span> <span class="free">n</span><span class="main">)</span> <span class="main">=</span> <span class="free">n'</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">meson</span> enat.distinct<span class="main"><span class="main">(</span></span>1<span class="main"><span class="main">)</span></span> enat_add_sub_same enat_diff_cancel_left enat_le_plus_same<span class="main"><span class="main">(</span></span>1<span class="main"><span class="main">)</span></span> less_imp_le<span class="main">)</span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>
  
<span class="keyword1"><span class="command">subsubsection</span></span> <span class="quoted"><span class="plain_text">"Projection Active"</span></span>

<span class="keyword1" id="Configuration_Traces-proj_active"><span class="command">lemma</span></span> proj_active<span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"enat <span class="free">i</span> <span class="main">&lt;</span> llength <span class="free">t</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub>lnth <span class="free">t</span> <span class="free">i</span></sub><span class="hidden">⇙</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>ltake <span class="main">(</span>Suc <span class="free">i</span><span class="main">)</span> <span class="free">t</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>ltake <span class="free">i</span> <span class="free">t</span><span class="main">)</span><span class="main">)</span> <span class="keyword1">@<span class="hidden">⇩</span><sub>l</sub></span> <span class="main">(</span><span class="main">(</span>σ<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>lnth <span class="free">t</span> <span class="free">i</span><span class="main">)</span><span class="main">)</span> <span class="keyword1">#<span class="hidden">⇩</span><sub>l</sub></span> <span class="keyword1">[]<span class="hidden">⇩</span><sub>l</sub></span><span class="main">)</span>"</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">is</span></span> <span class="quoted"><span class="quoted">"<span class="var">?lhs</span> <span class="main">=</span> <span class="var">?rhs</span>"</span></span><span class="main">)</span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">from</span></span> assms <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"ltake <span class="main">(</span>enat <span class="main">(</span>Suc <span class="free">i</span><span class="main">)</span><span class="main">)</span> <span class="free">t</span> <span class="main">=</span> <span class="main">(</span>ltake <span class="main">(</span>enat <span class="free">i</span><span class="main">)</span> <span class="free">t</span><span class="main">)</span> <span class="keyword1">@<span class="hidden">⇩</span><sub>l</sub></span> <span class="main">(</span><span class="main">(</span>lnth <span class="free">t</span> <span class="free">i</span><span class="main">)</span> <span class="keyword1">#<span class="hidden">⇩</span><sub>l</sub></span> <span class="keyword1">[]<span class="hidden">⇩</span><sub>l</sub></span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> ltake_Suc_conv_snoc_lnth <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="var">?lhs</span> <span class="main">=</span> π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span><span class="main">(</span>ltake <span class="main">(</span>enat <span class="free">i</span><span class="main">)</span> <span class="free">t</span><span class="main">)</span> <span class="keyword1">@<span class="hidden">⇩</span><sub>l</sub></span> <span class="main">(</span><span class="main">(</span>lnth <span class="free">t</span> <span class="free">i</span><span class="main">)</span> <span class="keyword1">#<span class="hidden">⇩</span><sub>l</sub></span> <span class="keyword1">[]<span class="hidden">⇩</span><sub>l</sub></span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">…</span> <span class="main">=</span> <span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>ltake <span class="main">(</span>enat <span class="free">i</span><span class="main">)</span> <span class="free">t</span><span class="main">)</span><span class="main">)</span> <span class="keyword1">@<span class="hidden">⇩</span><sub>l</sub></span> <span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span><span class="main">(</span>lnth <span class="free">t</span> <span class="free">i</span><span class="main">)</span> <span class="keyword1">#<span class="hidden">⇩</span><sub>l</sub></span> <span class="keyword1">[]<span class="hidden">⇩</span><sub>l</sub></span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> assms <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span><span class="main">(</span>lnth <span class="free">t</span> <span class="free">i</span><span class="main">)</span> <span class="keyword1">#<span class="hidden">⇩</span><sub>l</sub></span> <span class="keyword1">[]<span class="hidden">⇩</span><sub>l</sub></span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span>σ<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>lnth <span class="free">t</span> <span class="free">i</span><span class="main">)</span><span class="main">)</span> <span class="keyword1">#<span class="hidden">⇩</span><sub>l</sub></span> <span class="keyword1">[]<span class="hidden">⇩</span><sub>l</sub></span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>
  
<span class="keyword1" id="Configuration_Traces-proj_active_append"><span class="command">lemma</span></span> proj_active_append<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> a1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">n</span><span class="main">::</span>nat<span class="main">)</span> <span class="main">≤</span> <span class="free">i</span>"</span></span>
      <span class="keyword2"><span class="keyword">and</span></span> a2<span class="main">:</span> <span class="quoted"><span class="quoted">"enat <span class="free">i</span> <span class="main">&lt;</span> <span class="main">(</span><span class="free">n'</span><span class="main">::</span>enat<span class="main">)</span>"</span></span>
      <span class="keyword2"><span class="keyword">and</span></span> a3<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> lfinite <span class="free">t</span> <span class="main">∨</span> <span class="free">n'</span><span class="main">-</span><span class="main">1</span> <span class="main">&lt;</span> llength <span class="free">t</span>"</span></span>
      <span class="keyword2"><span class="keyword">and</span></span> a4<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub>lnth <span class="free">t</span> <span class="free">i</span></sub><span class="hidden">⇙</span>"</span></span>
      <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">i'</span><span class="main">.</span> <span class="main">(</span><span class="free">n</span> <span class="main">≤</span> <span class="bound">i'</span> <span class="main">∧</span> enat <span class="bound">i'</span><span class="main">&lt;</span><span class="free">n'</span> <span class="main">∧</span> <span class="bound">i'</span> <span class="main">&lt;</span> llength <span class="free">t</span> <span class="main">∧</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub>lnth <span class="free">t</span> <span class="bound">i'</span></sub><span class="hidden">⇙</span><span class="main">)</span> <span class="main">⟶</span> <span class="main">(</span><span class="bound">i'</span> <span class="main">=</span> <span class="free">i</span><span class="main">)</span>"</span></span>
    <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>ltake <span class="free">n'</span> <span class="free">t</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>ltake <span class="free">n</span> <span class="free">t</span><span class="main">)</span><span class="main">)</span> <span class="keyword1">@<span class="hidden">⇩</span><sub>l</sub></span> <span class="main">(</span><span class="main">(</span>σ<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>lnth <span class="free">t</span> <span class="free">i</span><span class="main">)</span><span class="main">)</span> <span class="keyword1">#<span class="hidden">⇩</span><sub>l</sub></span> <span class="keyword1">[]<span class="hidden">⇩</span><sub>l</sub></span><span class="main">)</span>"</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">is</span></span> <span class="quoted"><span class="quoted">"<span class="var">?lhs</span> <span class="main">=</span> <span class="var">?rhs</span>"</span></span><span class="main">)</span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="var">?lhs</span> <span class="main">=</span> π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>ltake <span class="main">(</span>Suc <span class="free">i</span><span class="main">)</span> <span class="free">t</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
    <span class="keyword1"><span class="command">from</span></span> a2 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"Suc <span class="free">i</span> <span class="main">≤</span> <span class="free">n'</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> Suc_ile_eq<span class="main">)</span>
    <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> a3 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> lfinite <span class="free">t</span> <span class="main">∨</span> <span class="free">n'</span><span class="main">-</span><span class="main">1</span> <span class="main">&lt;</span> llength <span class="free">t</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">∄</span><span class="bound">k</span><span class="main">.</span> enat <span class="bound">k</span><span class="main">≥</span>enat <span class="main">(</span>Suc <span class="free">i</span><span class="main">)</span> <span class="main">∧</span> <span class="bound">k</span><span class="main">&lt;</span><span class="free">n'</span> <span class="main">∧</span> <span class="bound">k</span> <span class="main">&lt;</span> llength <span class="free">t</span> <span class="main">∧</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub>lnth <span class="free">t</span> <span class="bound">k</span></sub><span class="hidden">⇙</span>"</span></span>
    <span class="keyword1"><span class="command">proof</span></span>
      <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound">k</span><span class="main">.</span> enat <span class="bound">k</span><span class="main">≥</span>enat <span class="main">(</span>Suc <span class="free">i</span><span class="main">)</span> <span class="main">∧</span> <span class="bound">k</span><span class="main">&lt;</span><span class="free">n'</span> <span class="main">∧</span> <span class="bound">k</span> <span class="main">&lt;</span> llength <span class="free">t</span> <span class="main">∧</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub>lnth <span class="free">t</span> <span class="bound">k</span></sub><span class="hidden">⇙</span>"</span></span>
      <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">k</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"enat <span class="skolem">k</span><span class="main">≥</span>enat <span class="main">(</span>Suc <span class="free">i</span><span class="main">)</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">k</span><span class="main">&lt;</span><span class="free">n'</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">k</span> <span class="main">&lt;</span> llength <span class="free">t</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub>lnth <span class="free">t</span> <span class="skolem">k</span></sub><span class="hidden">⇙</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
      <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹enat <span class="skolem">k</span><span class="main">≥</span>enat <span class="main">(</span>Suc <span class="free">i</span><span class="main">)</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"enat <span class="skolem">k</span><span class="main">≥</span><span class="free">n</span>"</span></span>
        <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">meson</span> dual_order.trans enat_ord_simps<span class="main"><span class="main">(</span></span>1<span class="main"><span class="main">)</span></span> le_SucI<span class="main">)</span>
      <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"enat <span class="skolem">k</span><span class="main">=</span>enat <span class="free">i</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">using</span></span> enat_ord_simps<span class="main">(</span>1<span class="main">)</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
      <span class="keyword1"><span class="command">with</span></span> <span class="quoted"><span class="quoted">‹enat <span class="skolem">k</span><span class="main">≥</span>enat <span class="main">(</span>Suc <span class="free">i</span><span class="main">)</span>›</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted">False</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">qed</span></span>
    <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> proj_not_active_same<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="quoted">"Suc <span class="free">i</span>"</span></span> <span class="quoted"><span class="free">n'</span></span> <span class="quoted"><span class="free">t</span></span> <span class="quoted"><span class="free">c</span></span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">…</span> <span class="main">=</span> <span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>ltake <span class="free">i</span> <span class="free">t</span><span class="main">)</span><span class="main">)</span> <span class="keyword1">@<span class="hidden">⇩</span><sub>l</sub></span> <span class="main">(</span><span class="main">(</span>σ<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>lnth <span class="free">t</span> <span class="free">i</span><span class="main">)</span><span class="main">)</span> <span class="keyword1">#<span class="hidden">⇩</span><sub>l</sub></span> <span class="keyword1">[]<span class="hidden">⇩</span><sub>l</sub></span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">i</span> <span class="main">&lt;</span> llength <span class="free">t</span>"</span></span>
    <span class="keyword1"><span class="command">proof</span></span> <span class="operator">cases</span>
      <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"lfinite <span class="free">t</span>"</span></span>
      <span class="keyword1"><span class="command">with</span></span> a3 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">n'</span><span class="main">-</span><span class="main">1</span> <span class="main">&lt;</span> llength <span class="free">t</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
      <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="free">n'</span> <span class="main">≤</span> llength <span class="free">t</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> eSuc_minus_1 enat_minus_mono1 ileI1 not_le<span class="main">)</span>
      <span class="keyword1"><span class="command">with</span></span> a2 <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"enat <span class="free">i</span> <span class="main">&lt;</span> llength <span class="free">t</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">next</span></span>
      <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> lfinite <span class="free">t</span>"</span></span>
      <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> enat_ord_code<span class="main"><span class="main">(</span></span>4<span class="main"><span class="main">)</span></span> llength_eq_infty_conv_lfinite<span class="main">)</span>
    <span class="keyword1"><span class="command">qed</span></span>
    <span class="keyword1"><span class="command">with</span></span> a4 <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">…</span> <span class="main">=</span> <span class="var">?rhs</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
    <span class="keyword1"><span class="command">from</span></span> a1 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"enat <span class="free">n</span> <span class="main">≤</span> enat <span class="free">i</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> a2 a3 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> lfinite <span class="free">t</span> <span class="main">∨</span> enat <span class="free">i</span><span class="main">-</span><span class="main">1</span> <span class="main">&lt;</span> llength <span class="free">t</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> enat_minus_mono1 less_imp_le order.strict_trans1 <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
    <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">∄</span><span class="bound">k</span><span class="main">.</span> <span class="bound">k</span><span class="main">≥</span><span class="free">n</span> <span class="main">∧</span> enat <span class="bound">k</span><span class="main">&lt;</span>enat <span class="free">i</span> <span class="main">∧</span> enat <span class="bound">k</span> <span class="main">&lt;</span> llength <span class="free">t</span> <span class="main">∧</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub>lnth <span class="free">t</span> <span class="bound">k</span></sub><span class="hidden">⇙</span>"</span></span>
    <span class="keyword1"><span class="command">proof</span></span>
      <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound">k</span><span class="main">.</span> <span class="bound">k</span><span class="main">≥</span><span class="free">n</span> <span class="main">∧</span> enat <span class="bound">k</span><span class="main">&lt;</span>enat <span class="free">i</span> <span class="main">∧</span> enat <span class="bound">k</span> <span class="main">&lt;</span> llength <span class="free">t</span> <span class="main">∧</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub>lnth <span class="free">t</span> <span class="bound">k</span></sub><span class="hidden">⇙</span>"</span></span>
      <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">k</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">k</span><span class="main">≥</span><span class="free">n</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"enat <span class="skolem">k</span><span class="main">&lt;</span>enat <span class="free">i</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"enat <span class="skolem">k</span> <span class="main">&lt;</span> llength <span class="free">t</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub>lnth <span class="free">t</span> <span class="skolem">k</span></sub><span class="hidden">⇙</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
      <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹enat <span class="skolem">k</span><span class="main">&lt;</span>enat <span class="free">i</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"enat <span class="skolem">k</span><span class="main">&lt;</span><span class="free">n'</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms dual_order.strict_trans <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
      <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"enat <span class="skolem">k</span><span class="main">=</span>enat <span class="free">i</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
      <span class="keyword1"><span class="command">with</span></span> <span class="quoted"><span class="quoted">‹enat <span class="skolem">k</span><span class="main">&lt;</span>enat <span class="free">i</span>›</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted">False</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">qed</span></span>
    <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> proj_not_active_same<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="free">n</span></span> <span class="quoted"><span class="free">i</span></span> <span class="quoted"><span class="free">t</span></span> <span class="quoted"><span class="free">c</span></span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">qed</span></span>    
  <span class="keyword1"><span class="command">finally</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>
  
<span class="keyword1"><span class="command">subsubsection</span></span> <span class="quoted"><span class="plain_text">"Same and not Same"</span></span>

<span class="keyword1" id="Configuration_Traces-proj_same_not_active"><span class="command">lemma</span></span> proj_same_not_active<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">n</span> <span class="main">≤</span> <span class="free">n'</span>"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"enat <span class="main">(</span><span class="free">n'</span><span class="main">-</span><span class="main">1</span><span class="main">)</span> <span class="main">&lt;</span> llength <span class="free">t</span>"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>ltake <span class="free">n'</span> <span class="free">t</span><span class="main">)</span> <span class="main">=</span> π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>ltake <span class="free">n</span> <span class="free">t</span><span class="main">)</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">∄</span><span class="bound">k</span><span class="main">.</span> <span class="bound">k</span><span class="main">≥</span><span class="free">n</span> <span class="main">∧</span> <span class="bound">k</span><span class="main">&lt;</span><span class="free">n'</span> <span class="main">∧</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub>lnth <span class="free">t</span> <span class="bound">k</span></sub><span class="hidden">⇙</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span>
  <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound">k</span><span class="main">.</span> <span class="bound">k</span><span class="main">≥</span><span class="free">n</span> <span class="main">∧</span> <span class="bound">k</span><span class="main">&lt;</span><span class="free">n'</span> <span class="main">∧</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub>lnth <span class="free">t</span> <span class="bound">k</span></sub><span class="hidden">⇙</span>"</span></span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">i</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">i</span><span class="main">≥</span><span class="free">n</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">i</span><span class="main">&lt;</span><span class="free">n'</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub>lnth <span class="free">t</span> <span class="skolem">i</span></sub><span class="hidden">⇙</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹enat <span class="main">(</span><span class="free">n'</span><span class="main">-</span><span class="main">1</span><span class="main">)</span><span class="main">&lt;</span>llength <span class="free">t</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">i</span><span class="main">&lt;</span><span class="free">n'</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">i</span><span class="main">&lt;</span>llength <span class="free">t</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> diff_Suc_1 dual_order.strict_trans enat_ord_simps<span class="main"><span class="main">(</span></span>2<span class="main"><span class="main">)</span></span> lessE<span class="main">)</span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>ltake <span class="main">(</span>Suc <span class="skolem">i</span><span class="main">)</span> <span class="free">t</span><span class="main">)</span> <span class="main">=</span>
    <span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>ltake <span class="skolem">i</span> <span class="free">t</span><span class="main">)</span><span class="main">)</span> <span class="keyword1">@<span class="hidden">⇩</span><sub>l</sub></span> <span class="main">(</span><span class="main">(</span>σ<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>lnth <span class="free">t</span> <span class="skolem">i</span><span class="main">)</span><span class="main">)</span> <span class="keyword1">#<span class="hidden">⇩</span><sub>l</sub></span> <span class="keyword1">[]<span class="hidden">⇩</span><sub>l</sub></span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">i</span><span class="main">&lt;</span><span class="free">n'</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"Suc <span class="skolem">i</span> <span class="main">≤</span> <span class="free">n'</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"lprefix<span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>ltake <span class="main">(</span>Suc <span class="skolem">i</span><span class="main">)</span> <span class="free">t</span><span class="main">)</span><span class="main">)</span> <span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>ltake <span class="free">n'</span> <span class="free">t</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="quoted">"<span class="skolem"><span class="skolem">tl</span></span>"</span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>ltake <span class="free">n'</span> <span class="free">t</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>ltake <span class="main">(</span>Suc <span class="skolem">i</span><span class="main">)</span> <span class="free">t</span><span class="main">)</span><span class="main">)</span> <span class="keyword1">@<span class="hidden">⇩</span><sub>l</sub></span> <span class="skolem">tl</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> lprefix_conv_lappend <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="free">n</span><span class="main">≤</span><span class="skolem">i</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"lprefix<span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>ltake <span class="free">n</span> <span class="free">t</span><span class="main">)</span><span class="main">)</span> <span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>ltake <span class="skolem">i</span> <span class="free">t</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"lprefix<span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>ltake <span class="free">n</span> <span class="free">t</span><span class="main">)</span><span class="main">)</span> <span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>ltake <span class="skolem">i</span> <span class="free">t</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="quoted">"<span class="skolem"><span class="skolem">hd</span></span>"</span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>ltake <span class="skolem">i</span> <span class="free">t</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>ltake <span class="free">n</span> <span class="free">t</span><span class="main">)</span><span class="main">)</span> <span class="keyword1">@<span class="hidden">⇩</span><sub>l</sub></span> <span class="skolem">hd</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> lprefix_conv_lappend <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>ltake <span class="free">n'</span> <span class="free">t</span><span class="main">)</span> <span class="main">=</span>
    <span class="main">(</span><span class="main">(</span><span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>ltake <span class="free">n</span> <span class="free">t</span><span class="main">)</span><span class="main">)</span> <span class="keyword1">@<span class="hidden">⇩</span><sub>l</sub></span> <span class="skolem">hd</span><span class="main">)</span> <span class="keyword1">@<span class="hidden">⇩</span><sub>l</sub></span> <span class="main">(</span><span class="main">(</span>σ<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>lnth <span class="free">t</span> <span class="skolem">i</span><span class="main">)</span><span class="main">)</span> <span class="keyword1">#<span class="hidden">⇩</span><sub>l</sub></span> <span class="keyword1">[]<span class="hidden">⇩</span><sub>l</sub></span><span class="main">)</span><span class="main">)</span> <span class="keyword1">@<span class="hidden">⇩</span><sub>l</sub></span> <span class="skolem">tl</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">…</span> <span class="main">=</span> <span class="main">(</span><span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>ltake <span class="free">n</span> <span class="free">t</span><span class="main">)</span><span class="main">)</span> <span class="keyword1">@<span class="hidden">⇩</span><sub>l</sub></span> <span class="skolem">hd</span><span class="main">)</span> <span class="keyword1">@<span class="hidden">⇩</span><sub>l</sub></span> <span class="main">(</span><span class="main">(</span>σ<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>lnth <span class="free">t</span> <span class="skolem">i</span><span class="main">)</span><span class="main">)</span> <span class="keyword1">#<span class="hidden">⇩</span><sub>l</sub></span> <span class="skolem">tl</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> lappend_snocL1_conv_LCons2<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="quoted">"<span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>ltake <span class="free">n</span> <span class="free">t</span><span class="main">)</span><span class="main">)</span> <span class="keyword1">@<span class="hidden">⇩</span><sub>l</sub></span> <span class="skolem">hd</span>"</span></span> <span class="quoted"><span class="quoted">"σ<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>lnth <span class="free">t</span> <span class="skolem">i</span><span class="main">)</span>"</span></span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">…</span> <span class="main">=</span> <span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>ltake <span class="free">n</span> <span class="free">t</span><span class="main">)</span><span class="main">)</span> <span class="keyword1">@<span class="hidden">⇩</span><sub>l</sub></span> <span class="main">(</span><span class="skolem">hd</span> <span class="keyword1">@<span class="hidden">⇩</span><sub>l</sub></span> <span class="main">(</span><span class="main">(</span>σ<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>lnth <span class="free">t</span> <span class="skolem">i</span><span class="main">)</span><span class="main">)</span> <span class="keyword1">#<span class="hidden">⇩</span><sub>l</sub></span> <span class="skolem">tl</span><span class="main">)</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> lappend_assoc <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>ltake <span class="free">n'</span> <span class="free">t</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>ltake <span class="free">n'</span> <span class="free">t</span><span class="main">)</span><span class="main">)</span> <span class="keyword1">@<span class="hidden">⇩</span><sub>l</sub></span> <span class="keyword1">[]<span class="hidden">⇩</span><sub>l</sub></span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">finally</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>ltake <span class="free">n'</span> <span class="free">t</span><span class="main">)</span><span class="main">)</span> <span class="keyword1">@<span class="hidden">⇩</span><sub>l</sub></span> <span class="keyword1">[]<span class="hidden">⇩</span><sub>l</sub></span> <span class="main">=</span> <span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>ltake <span class="free">n</span> <span class="free">t</span><span class="main">)</span><span class="main">)</span> <span class="keyword1">@<span class="hidden">⇩</span><sub>l</sub></span> <span class="main">(</span><span class="skolem">hd</span> <span class="keyword1">@<span class="hidden">⇩</span><sub>l</sub></span> <span class="main">(</span><span class="main">(</span>σ<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>lnth <span class="free">t</span> <span class="skolem">i</span><span class="main">)</span><span class="main">)</span> <span class="keyword1">#<span class="hidden">⇩</span><sub>l</sub></span> <span class="skolem">tl</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">.</span></span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> assms<span class="main">(</span>3<span class="main">)</span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"llength <span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>ltake <span class="free">n'</span> <span class="free">t</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> llength <span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>ltake <span class="free">n</span> <span class="free">t</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"lfinite <span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>ltake <span class="free">n'</span> <span class="free">t</span><span class="main">)</span><span class="main">)</span> <span class="main">⟶</span> <span class="keyword1">[]<span class="hidden">⇩</span><sub>l</sub></span> <span class="main">=</span> <span class="skolem">hd</span> <span class="keyword1">@<span class="hidden">⇩</span><sub>l</sub></span> <span class="main">(</span><span class="main">(</span>σ<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>lnth <span class="free">t</span> <span class="skolem">i</span><span class="main">)</span><span class="main">)</span> <span class="keyword1">#<span class="hidden">⇩</span><sub>l</sub></span> <span class="skolem">tl</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>3<span class="main">)</span> lappend_eq_lappend_conv<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="quoted">"π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>ltake <span class="free">n'</span> <span class="free">t</span><span class="main">)</span>"</span></span> <span class="quoted"><span class="quoted">"π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>ltake <span class="free">n</span> <span class="free">t</span><span class="main">)</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">[]<span class="hidden">⇩</span><sub>l</sub></span>"</span></span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"lfinite <span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>ltake <span class="free">n'</span> <span class="free">t</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">[]<span class="hidden">⇩</span><sub>l</sub></span> <span class="main">=</span> <span class="skolem">hd</span> <span class="keyword1">@<span class="hidden">⇩</span><sub>l</sub></span> <span class="main">(</span><span class="main">(</span>σ<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>lnth <span class="free">t</span> <span class="skolem">i</span><span class="main">)</span><span class="main">)</span> <span class="keyword1">#<span class="hidden">⇩</span><sub>l</sub></span> <span class="skolem">tl</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span>σ<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>lnth <span class="free">t</span> <span class="skolem">i</span><span class="main">)</span><span class="main">)</span> <span class="keyword1">#<span class="hidden">⇩</span><sub>l</sub></span> <span class="skolem">tl</span> <span class="main">=</span> <span class="keyword1">[]<span class="hidden">⇩</span><sub>l</sub></span>"</span></span> <span class="keyword1"><span class="command">using</span></span> LNil_eq_lappend_iff <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="quoted">False</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="Configuration_Traces-proj_not_same_active"><span class="command">lemma</span></span> proj_not_same_active<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"enat <span class="free">n</span> <span class="main">≤</span> <span class="main">(</span><span class="free">n'</span><span class="main">::</span>enat<span class="main">)</span>"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">¬</span> lfinite <span class="free">t</span><span class="main">)</span> <span class="main">∨</span> <span class="free">n'</span><span class="main">-</span><span class="main">1</span> <span class="main">&lt;</span> llength <span class="free">t</span>"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span><span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>ltake <span class="free">n'</span> <span class="free">t</span><span class="main">)</span> <span class="main">=</span> π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>ltake <span class="free">n</span> <span class="free">t</span><span class="main">)</span><span class="main">)</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound">k</span><span class="main">.</span> <span class="bound">k</span><span class="main">≥</span><span class="free">n</span> <span class="main">∧</span> <span class="bound">k</span><span class="main">&lt;</span><span class="free">n'</span> <span class="main">∧</span> enat <span class="bound">k</span> <span class="main">&lt;</span> llength <span class="free">t</span> <span class="main">∧</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub>lnth <span class="free">t</span> <span class="bound">k</span></sub><span class="hidden">⇙</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">rule</span> ccontr<span class="main">)</span>
  <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span><span class="main">(</span><span class="main">∃</span><span class="bound">k</span><span class="main">.</span> <span class="bound">k</span><span class="main">≥</span><span class="free">n</span> <span class="main">∧</span> <span class="bound">k</span><span class="main">&lt;</span><span class="free">n'</span> <span class="main">∧</span> enat <span class="bound">k</span> <span class="main">&lt;</span> llength <span class="free">t</span> <span class="main">∧</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub>lnth <span class="free">t</span> <span class="bound">k</span></sub><span class="hidden">⇙</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>ltake <span class="free">n'</span> <span class="free">t</span><span class="main">)</span> <span class="main">=</span> π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>ltake <span class="main">(</span>enat <span class="free">n</span><span class="main">)</span> <span class="free">t</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="operator">cases</span>
    <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"lfinite <span class="free">t</span>"</span></span>
    <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"llength <span class="free">t</span><span class="main">≠</span><span class="main">∞</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> lfinite_llength_enat<span class="main">)</span> 
    <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"enat <span class="main">(</span>the_enat <span class="main">(</span>llength <span class="free">t</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> llength <span class="free">t</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">with</span></span> assms <span class="quoted"><span class="quoted">‹<span class="main">¬</span> <span class="main">(</span><span class="main">∃</span><span class="bound"><span class="bound">k</span></span><span class="main">≥</span><span class="free">n</span><span class="main">.</span> <span class="bound">k</span> <span class="main">&lt;</span> <span class="free">n'</span> <span class="main">∧</span> enat <span class="bound">k</span> <span class="main">&lt;</span> llength <span class="free">t</span> <span class="main">∧</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub>lnth <span class="free">t</span> <span class="bound">k</span></sub><span class="hidden">⇙</span><span class="main">)</span>›</span></span>
      <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> proj_not_active_same<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="free">n</span></span> <span class="quoted"><span class="free">n'</span></span> <span class="quoted"><span class="free">t</span></span> <span class="quoted"><span class="free">c</span></span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">next</span></span>
    <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> lfinite <span class="free">t</span>"</span></span>
    <span class="keyword1"><span class="command">with</span></span> assms <span class="quoted"><span class="quoted">‹<span class="main">¬</span> <span class="main">(</span><span class="main">∃</span><span class="bound"><span class="bound">k</span></span><span class="main">≥</span><span class="free">n</span><span class="main">.</span> <span class="bound">k</span> <span class="main">&lt;</span> <span class="free">n'</span> <span class="main">∧</span> enat <span class="bound">k</span> <span class="main">&lt;</span> llength <span class="free">t</span> <span class="main">∧</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub>lnth <span class="free">t</span> <span class="bound">k</span></sub><span class="hidden">⇙</span><span class="main">)</span>›</span></span>
      <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> proj_not_active_same<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="free">n</span></span> <span class="quoted"><span class="free">n'</span></span> <span class="quoted"><span class="free">t</span></span> <span class="quoted"><span class="free">c</span></span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">with</span></span> assms <span class="keyword3"><span class="command">show</span></span> <span class="quoted">False</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">subsection</span></span> <span class="quoted"><span class="plain_text">"Activations"</span></span>
<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹
  We also introduce an operator to obtain the number of activations of a certain component within a given configuration trace.
›</span></span>

<span class="keyword1"><span class="command">definition</span></span> <span class="entity">nAct</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'id</span> <span class="main">⇒</span> enat <span class="main">⇒</span> <span class="main">(</span>cnf llist<span class="main">)</span> <span class="main">⇒</span> enat"</span></span> <span class="main">(</span><span class="quoted">"<span class="keyword1">⟨</span>_ <span class="keyword1">#⇘</span>_<span class="keyword1">⇙</span>_<span class="keyword1">⟩</span>"</span><span class="main">)</span> <span class="keyword2"><span class="keyword">where</span></span>
<span class="quoted"><span class="quoted">"<span class="main"><span class="free">⟨</span></span><span class="free"><span class="bound"><span class="entity">c</span></span></span> #<span class="hidden">⇘</span><sub><span class="free"><span class="bound"><span class="entity">n</span></span></span></sub><span class="hidden">⇙</span> <span class="free"><span class="bound"><span class="entity">t</span></span></span><span class="main"><span class="free">⟩</span></span> <span class="main">≡</span> llength <span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free"><span class="bound"><span class="entity">c</span></span></span></sub><span class="hidden">⇙</span><span class="main">(</span>ltake <span class="free"><span class="bound"><span class="entity">n</span></span></span> <span class="free"><span class="bound"><span class="entity">t</span></span></span><span class="main">)</span><span class="main">)</span>"</span></span>

<span class="keyword1" id="Configuration_Traces-nAct_0"><span class="command">lemma</span></span> nAct_0<span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span>
  <span class="quoted"><span class="quoted">"<span class="main">⟨</span><span class="free">c</span> #<span class="hidden">⇘</span><sub><span class="main">0</span></sub><span class="hidden">⇙</span> <span class="free">t</span><span class="main">⟩</span> <span class="main">=</span> <span class="main">0</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> nAct_def<span class="main">)</span>

<span class="keyword1" id="Configuration_Traces-nAct_NIL"><span class="command">lemma</span></span> nAct_NIL<span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span>
  <span class="quoted"><span class="quoted">"<span class="main">⟨</span><span class="free">c</span> #<span class="hidden">⇘</span><sub><span class="free">n</span></sub><span class="hidden">⇙</span> <span class="keyword1">[]<span class="hidden">⇩</span><sub>l</sub></span><span class="main">⟩</span> <span class="main">=</span> <span class="main">0</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> nAct_def<span class="main">)</span>    

<span class="keyword1" id="Configuration_Traces-nAct_Null"><span class="command">lemma</span></span> nAct_Null<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"llength <span class="free">t</span> <span class="main">≥</span> <span class="free">n</span>"</span></span>
      <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">⟨</span><span class="free">c</span> #<span class="hidden">⇘</span><sub><span class="free">n</span></sub><span class="hidden">⇙</span> <span class="free">t</span><span class="main">⟩</span> <span class="main">=</span> <span class="main">0</span>"</span></span>
    <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound"><span class="bound">i</span></span><span class="main">&lt;</span><span class="free">n</span><span class="main">.</span> <span class="main">¬</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub>lnth <span class="free">t</span> <span class="bound">i</span></sub><span class="hidden">⇙</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">from</span></span> assms <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"lnull <span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>ltake <span class="free">n</span> <span class="free">t</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> nAct_def lnull_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>ltake <span class="free">n</span> <span class="free">t</span><span class="main">)</span> <span class="main">=</span> <span class="keyword1">[]<span class="hidden">⇩</span><sub>l</sub></span>"</span></span> <span class="keyword1"><span class="command">using</span></span> lnull_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">∀</span><span class="bound">k</span><span class="main">∈</span>lset <span class="main">(</span>ltake <span class="free">n</span> <span class="free">t</span><span class="main">)</span><span class="main">.</span> <span class="main">¬</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="bound">k</span></sub><span class="hidden">⇙</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">rule</span> ccontr<span class="main">)</span>
    <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> <span class="main">(</span><span class="main">∀</span><span class="bound"><span class="bound">i</span></span><span class="main">&lt;</span><span class="free">n</span><span class="main">.</span> <span class="main">¬</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub>lnth <span class="free">t</span> <span class="bound">i</span></sub><span class="hidden">⇙</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">i</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">i</span><span class="main">&lt;</span><span class="free">n</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub>lnth <span class="free">t</span> <span class="skolem">i</span></sub><span class="hidden">⇙</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
    <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"enat <span class="skolem">i</span> <span class="main">&lt;</span> llength <span class="main">(</span>ltake <span class="free">n</span> <span class="free">t</span><span class="main">)</span>  <span class="main">∧</span> lnth <span class="main">(</span>ltake <span class="free">n</span> <span class="free">t</span><span class="main">)</span> <span class="skolem">i</span> <span class="main">=</span> <span class="main">(</span>lnth <span class="free">t</span> <span class="skolem">i</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">proof</span></span>
      <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹llength <span class="free">t</span> <span class="main">≥</span> <span class="free">n</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">n</span> <span class="main">=</span> min <span class="free">n</span> <span class="main">(</span>llength <span class="free">t</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> min.orderE <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"llength <span class="main">(</span>ltake <span class="free">n</span> <span class="free">t</span><span class="main">)</span> <span class="main">=</span> <span class="free">n</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
      <span class="keyword1"><span class="command">with</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">i</span><span class="main">&lt;</span><span class="free">n</span>›</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"enat <span class="skolem">i</span> <span class="main">&lt;</span> llength <span class="main">(</span>ltake <span class="free">n</span> <span class="free">t</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">i</span><span class="main">&lt;</span><span class="free">n</span>›</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"lnth <span class="main">(</span>ltake <span class="free">n</span> <span class="free">t</span><span class="main">)</span> <span class="skolem">i</span> <span class="main">=</span> <span class="main">(</span>lnth <span class="free">t</span> <span class="skolem">i</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> lnth_ltake <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">qed</span></span>
    <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span>lnth <span class="free">t</span> <span class="skolem">i</span> <span class="main">∈</span> lset <span class="main">(</span>ltake <span class="free">n</span> <span class="free">t</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> in_lset_conv_lnth<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="quoted">"lnth <span class="free">t</span> <span class="skolem">i</span>"</span></span> <span class="quoted"><span class="quoted">"ltake <span class="free">n</span> <span class="free">t</span>"</span></span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
    <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted">False</span> <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="main">(</span><span class="main">∀</span><span class="bound">k</span><span class="main">∈</span>lset <span class="main">(</span>ltake <span class="free">n</span> <span class="free">t</span><span class="main">)</span><span class="main">.</span> <span class="main">¬</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="bound">k</span></sub><span class="hidden">⇙</span><span class="main">)</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">qed</span></span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="Configuration_Traces-nAct_ge_one"><span class="command">lemma</span></span> nAct_ge_one<span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"llength <span class="free">t</span> <span class="main">≥</span> <span class="free">n</span>"</span></span>
      <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">i</span> <span class="main">&lt;</span> <span class="free">n</span>"</span></span>
      <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub>lnth <span class="free">t</span> <span class="free">i</span></sub><span class="hidden">⇙</span>"</span></span>
    <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">⟨</span><span class="free">c</span> #<span class="hidden">⇘</span><sub><span class="free">n</span></sub><span class="hidden">⇙</span> <span class="free">t</span><span class="main">⟩</span> <span class="main">≥</span> enat <span class="main">1</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">rule</span> ccontr<span class="main">)</span>
  <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> <span class="main">(</span><span class="main">⟨</span><span class="free">c</span> #<span class="hidden">⇘</span><sub><span class="free">n</span></sub><span class="hidden">⇙</span> <span class="free">t</span><span class="main">⟩</span> <span class="main">≥</span> enat <span class="main">1</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="main">⟨</span><span class="free">c</span> #<span class="hidden">⇘</span><sub><span class="free">n</span></sub><span class="hidden">⇙</span> <span class="free">t</span><span class="main">⟩</span> <span class="main">&lt;</span> enat <span class="main">1</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="main">⟨</span><span class="free">c</span> #<span class="hidden">⇘</span><sub><span class="free">n</span></sub><span class="hidden">⇙</span> <span class="free">t</span><span class="main">⟩</span> <span class="main">&lt;</span> <span class="main">1</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> enat_1 <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="main">⟨</span><span class="free">c</span> #<span class="hidden">⇘</span><sub><span class="free">n</span></sub><span class="hidden">⇙</span> <span class="free">t</span><span class="main">⟩</span> <span class="main">=</span> <span class="main">0</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> Suc_ile_eq <span class="quoted"><span class="quoted">‹<span class="main">¬</span> enat <span class="main">1</span> <span class="main">≤</span> <span class="main">⟨</span><span class="free">c</span> #<span class="hidden">⇘</span><sub><span class="free">n</span></sub><span class="hidden">⇙</span> <span class="free">t</span><span class="main">⟩</span>›</span></span> zero_enat_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">with</span></span> <span class="quoted"><span class="quoted">‹llength <span class="free">t</span> <span class="main">≥</span> <span class="free">n</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound"><span class="bound">i</span></span><span class="main">&lt;</span><span class="free">n</span><span class="main">.</span> <span class="main">¬</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub>lnth <span class="free">t</span> <span class="bound">i</span></sub><span class="hidden">⇙</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> nAct_Null <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">with</span></span> assms <span class="keyword3"><span class="command">show</span></span> <span class="quoted">False</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>
    
<span class="keyword1" id="Configuration_Traces-nAct_finite"><span class="command">lemma</span></span> nAct_finite<span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">n</span> <span class="main">≠</span> <span class="main">∞</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound">n'</span><span class="main">.</span> <span class="main">⟨</span><span class="free">c</span> #<span class="hidden">⇘</span><sub><span class="free">n</span></sub><span class="hidden">⇙</span> <span class="free">t</span><span class="main">⟩</span> <span class="main">=</span> enat <span class="bound">n'</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">from</span></span> assms <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"lfinite <span class="main">(</span>ltake <span class="free">n</span> <span class="free">t</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"lfinite <span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>ltake <span class="free">n</span> <span class="free">t</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound">n'</span><span class="main">.</span> llength <span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>ltake <span class="free">n</span> <span class="free">t</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> enat <span class="bound">n'</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> lfinite_llength_enat<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="quoted">"π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>ltake <span class="free">n</span> <span class="free">t</span><span class="main">)</span>"</span></span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> nAct_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="Configuration_Traces-nAct_enat_the_nat"><span class="command">lemma</span></span> nAct_enat_the_nat<span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">n</span> <span class="main">≠</span> <span class="main">∞</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"enat <span class="main">(</span>the_enat <span class="main">(</span><span class="main">⟨</span><span class="free">c</span> #<span class="hidden">⇘</span><sub><span class="free">n</span></sub><span class="hidden">⇙</span> <span class="free">t</span><span class="main">⟩</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> <span class="main">⟨</span><span class="free">c</span> #<span class="hidden">⇘</span><sub><span class="free">n</span></sub><span class="hidden">⇙</span> <span class="free">t</span><span class="main">⟩</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">from</span></span> assms <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">⟨</span><span class="free">c</span> #<span class="hidden">⇘</span><sub><span class="free">n</span></sub><span class="hidden">⇙</span> <span class="free">t</span><span class="main">⟩</span> <span class="main">≠</span> <span class="main">∞</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> enat_the_enat <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>
  
<span class="keyword1"><span class="command">subsubsection</span></span> <span class="quoted"><span class="plain_text">"Monotonicity and Continuity"</span></span>
  
<span class="keyword1" id="Configuration_Traces-nAct_mcont"><span class="command">lemma</span></span> nAct_mcont<span class="main">:</span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"mcont lSup lprefix Sup <span class="main">(≤)</span> <span class="main">(</span>nAct <span class="free">c</span> <span class="free">n</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"mcont lSup lprefix lSup lprefix <span class="main">(</span>ltake <span class="free">n</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"mcont lSup lprefix lSup lprefix <span class="main">(</span><span class="main">λ</span><span class="bound">t</span><span class="main">.</span> π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>ltake <span class="free">n</span> <span class="bound">t</span><span class="main">)</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> proj_mcont2mcont<span class="main">[</span><span class="operator">of</span> <span class="quoted">lSup</span> <span class="quoted">lprefix</span> <span class="quoted"><span class="quoted">"<span class="main">(</span>ltake <span class="free">n</span><span class="main">)</span>"</span></span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"mcont lSup lprefix Sup <span class="main">(≤)</span> <span class="main">(</span><span class="main">λ</span><span class="bound">t</span><span class="main">.</span> llength <span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>ltake <span class="free">n</span> <span class="bound">t</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"nAct <span class="free">c</span> <span class="free">n</span> <span class="main">=</span> <span class="main">(</span><span class="main">λ</span><span class="bound">t</span><span class="main">.</span> llength <span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>ltake <span class="free">n</span> <span class="bound">t</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> nAct_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>
  
<span class="keyword1" id="Configuration_Traces-nAct_mono"><span class="command">lemma</span></span> nAct_mono<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">n</span> <span class="main">≤</span> <span class="free">n'</span>"</span></span>
    <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">⟨</span><span class="free">c</span> #<span class="hidden">⇘</span><sub><span class="free">n</span></sub><span class="hidden">⇙</span> <span class="free">t</span><span class="main">⟩</span> <span class="main">≤</span> <span class="main">⟨</span><span class="free">c</span> #<span class="hidden">⇘</span><sub><span class="free">n'</span></sub><span class="hidden">⇙</span> <span class="free">t</span><span class="main">⟩</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">from</span></span> assms <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"lprefix <span class="main">(</span>ltake <span class="free">n</span> <span class="free">t</span><span class="main">)</span> <span class="main">(</span>ltake <span class="free">n'</span> <span class="free">t</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"lprefix <span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>ltake <span class="free">n</span> <span class="free">t</span><span class="main">)</span><span class="main">)</span> <span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>ltake <span class="free">n'</span> <span class="free">t</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"llength <span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>ltake <span class="free">n</span> <span class="free">t</span><span class="main">)</span><span class="main">)</span> <span class="main">≤</span> llength <span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>ltake <span class="free">n'</span> <span class="free">t</span><span class="main">)</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> lprefix_llength_le<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="quoted">"<span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>ltake <span class="free">n</span> <span class="free">t</span><span class="main">)</span><span class="main">)</span>"</span></span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> nAct_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>
  
<span class="keyword1" id="Configuration_Traces-nAct_strict_mono_back"><span class="command">lemma</span></span> nAct_strict_mono_back<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="main">⟨</span><span class="free">c</span> #<span class="hidden">⇘</span><sub><span class="free">n</span></sub><span class="hidden">⇙</span> <span class="free">t</span><span class="main">⟩</span> <span class="main">&lt;</span> <span class="main">⟨</span><span class="free">c</span> #<span class="hidden">⇘</span><sub><span class="free">n'</span></sub><span class="hidden">⇙</span> <span class="free">t</span><span class="main">⟩</span>"</span></span>
    <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">n</span> <span class="main">&lt;</span> <span class="free">n'</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">rule</span> ccontr<span class="main">)</span>
  <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> <span class="free">n</span><span class="main">&lt;</span><span class="free">n'</span>"</span></span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="free">n</span><span class="main">≥</span><span class="free">n'</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="main">⟨</span><span class="free">c</span> #<span class="hidden">⇘</span><sub><span class="free">n</span></sub><span class="hidden">⇙</span> <span class="free">t</span><span class="main">⟩</span> <span class="main">≥</span> <span class="main">⟨</span><span class="free">c</span> #<span class="hidden">⇘</span><sub><span class="free">n'</span></sub><span class="hidden">⇙</span> <span class="free">t</span><span class="main">⟩</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> nAct_mono <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="quoted">False</span> <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">subsubsection</span></span> <span class="quoted"><span class="plain_text">"Not Active"</span></span>

<span class="keyword1" id="Configuration_Traces-nAct_not_active"><span class="command">lemma</span></span> nAct_not_active<span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span>
  <span class="keyword2"><span class="keyword">fixes</span></span> <span class="free">n</span><span class="main">::</span><span class="quoted">nat</span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="free">n'</span><span class="main">::</span><span class="quoted">nat</span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="free">t</span><span class="main">::</span><span class="quoted"><span class="quoted">"<span class="main">(</span>cnf llist<span class="main">)</span>"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="free">c</span><span class="main">::</span><span class="tfree"><span class="quoted"><span class="tfree">'id</span></span></span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"enat <span class="free">i</span> <span class="main">&lt;</span> llength <span class="free">t</span>"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub>lnth <span class="free">t</span> <span class="free">i</span></sub><span class="hidden">⇙</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">⟨</span><span class="free">c</span> #<span class="hidden">⇘</span><sub>Suc <span class="free">i</span></sub><span class="hidden">⇙</span> <span class="free">t</span><span class="main">⟩</span> <span class="main">=</span> <span class="main">⟨</span><span class="free">c</span> #<span class="hidden">⇘</span><sub><span class="free">i</span></sub><span class="hidden">⇙</span> <span class="free">t</span><span class="main">⟩</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">from</span></span> assms <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>ltake <span class="main">(</span>Suc <span class="free">i</span><span class="main">)</span> <span class="free">t</span><span class="main">)</span> <span class="main">=</span> π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>ltake <span class="free">i</span> <span class="free">t</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"llength <span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>ltake <span class="main">(</span>enat <span class="main">(</span>Suc <span class="free">i</span><span class="main">)</span><span class="main">)</span> <span class="free">t</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> llength <span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>ltake <span class="free">i</span> <span class="free">t</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"llength <span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>ltake <span class="free">i</span> <span class="free">t</span><span class="main">)</span><span class="main">)</span> <span class="main">≠</span> <span class="main">∞</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> llength_eq_infty_conv_lfinite<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="quoted">"π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>ltake <span class="main">(</span>enat <span class="free">i</span><span class="main">)</span> <span class="free">t</span><span class="main">)</span>"</span></span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"llength <span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>ltake <span class="main">(</span>Suc <span class="free">i</span><span class="main">)</span> <span class="free">t</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> llength <span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>ltake <span class="free">i</span> <span class="free">t</span><span class="main">)</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> the_enat_eSuc <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">with</span></span> nAct_def <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>
  
<span class="keyword1" id="Configuration_Traces-nAct_not_active_same"><span class="command">lemma</span></span> nAct_not_active_same<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"enat <span class="free">n</span> <span class="main">≤</span> <span class="main">(</span><span class="free">n'</span><span class="main">::</span>enat<span class="main">)</span>"</span></span>
      <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">n'</span><span class="main">-</span><span class="main">1</span> <span class="main">&lt;</span> llength <span class="free">t</span>"</span></span>
      <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">∄</span><span class="bound">k</span><span class="main">.</span> enat <span class="bound">k</span><span class="main">≥</span><span class="free">n</span> <span class="main">∧</span> <span class="bound">k</span><span class="main">&lt;</span><span class="free">n'</span> <span class="main">∧</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub>lnth <span class="free">t</span> <span class="bound">k</span></sub><span class="hidden">⇙</span>"</span></span>
    <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">⟨</span><span class="free">c</span> #<span class="hidden">⇘</span><sub><span class="free">n'</span></sub><span class="hidden">⇙</span> <span class="free">t</span><span class="main">⟩</span> <span class="main">=</span> <span class="main">⟨</span><span class="free">c</span> #<span class="hidden">⇘</span><sub><span class="free">n</span></sub><span class="hidden">⇙</span> <span class="free">t</span><span class="main">⟩</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> assms proj_not_active_same nAct_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    
<span class="keyword1"><span class="command">subsubsection</span></span> <span class="quoted"><span class="plain_text">"Active"</span></span>
  
<span class="keyword1" id="Configuration_Traces-nAct_active"><span class="command">lemma</span></span> nAct_active<span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span>
  <span class="keyword2"><span class="keyword">fixes</span></span> <span class="free">n</span><span class="main">::</span><span class="quoted">nat</span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="free">n'</span><span class="main">::</span><span class="quoted">nat</span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="free">t</span><span class="main">::</span><span class="quoted"><span class="quoted">"<span class="main">(</span>cnf llist<span class="main">)</span>"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="free">c</span><span class="main">::</span><span class="tfree"><span class="quoted"><span class="tfree">'id</span></span></span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"enat <span class="free">i</span> <span class="main">&lt;</span> llength <span class="free">t</span>"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub>lnth <span class="free">t</span> <span class="free">i</span></sub><span class="hidden">⇙</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">⟨</span><span class="free">c</span> #<span class="hidden">⇘</span><sub>Suc <span class="free">i</span></sub><span class="hidden">⇙</span> <span class="free">t</span><span class="main">⟩</span> <span class="main">=</span> eSuc <span class="main">(</span><span class="main">⟨</span><span class="free">c</span> #<span class="hidden">⇘</span><sub><span class="free">i</span></sub><span class="hidden">⇙</span> <span class="free">t</span><span class="main">⟩</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">from</span></span> assms <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>ltake <span class="main">(</span>Suc <span class="free">i</span><span class="main">)</span> <span class="free">t</span><span class="main">)</span> <span class="main">=</span>
    <span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>ltake <span class="free">i</span> <span class="free">t</span><span class="main">)</span><span class="main">)</span> <span class="keyword1">@<span class="hidden">⇩</span><sub>l</sub></span> <span class="main">(</span><span class="main">(</span>σ<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>lnth <span class="free">t</span> <span class="free">i</span><span class="main">)</span><span class="main">)</span> <span class="keyword1">#<span class="hidden">⇩</span><sub>l</sub></span> <span class="keyword1">[]<span class="hidden">⇩</span><sub>l</sub></span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"llength <span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>ltake <span class="main">(</span>enat <span class="main">(</span>Suc <span class="free">i</span><span class="main">)</span><span class="main">)</span> <span class="free">t</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> eSuc <span class="main">(</span>llength <span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>ltake <span class="free">i</span> <span class="free">t</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> plus_1_eSuc one_eSuc <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"llength <span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>ltake <span class="free">i</span> <span class="free">t</span><span class="main">)</span><span class="main">)</span> <span class="main">≠</span> <span class="main">∞</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> llength_eq_infty_conv_lfinite<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="quoted">"π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>ltake <span class="main">(</span>enat <span class="free">i</span><span class="main">)</span> <span class="free">t</span><span class="main">)</span>"</span></span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"llength <span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>ltake <span class="main">(</span>Suc <span class="free">i</span><span class="main">)</span> <span class="free">t</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> eSuc <span class="main">(</span>llength <span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>ltake <span class="free">i</span> <span class="free">t</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> the_enat_eSuc <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">with</span></span> nAct_def <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="Configuration_Traces-nAct_active_suc"><span class="command">lemma</span></span> nAct_active_suc<span class="main">:</span>
  <span class="keyword2"><span class="keyword">fixes</span></span> <span class="free">n</span><span class="main">::</span><span class="quoted">nat</span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="free">n'</span><span class="main">::</span><span class="quoted">enat</span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="free">t</span><span class="main">::</span><span class="quoted"><span class="quoted">"<span class="main">(</span>cnf llist<span class="main">)</span>"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="free">c</span><span class="main">::</span><span class="tfree"><span class="quoted"><span class="tfree">'id</span></span></span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> lfinite <span class="free">t</span> <span class="main">∨</span> <span class="free">n'</span><span class="main">-</span><span class="main">1</span> <span class="main">&lt;</span> llength <span class="free">t</span>"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">n</span> <span class="main">≤</span> <span class="free">i</span>"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"enat <span class="free">i</span> <span class="main">&lt;</span> <span class="free">n'</span>"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub>lnth <span class="free">t</span> <span class="free">i</span></sub><span class="hidden">⇙</span>"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">i'</span><span class="main">.</span> <span class="main">(</span><span class="free">n</span> <span class="main">≤</span> <span class="bound">i'</span> <span class="main">∧</span> enat <span class="bound">i'</span><span class="main">&lt;</span><span class="free">n'</span> <span class="main">∧</span> <span class="bound">i'</span> <span class="main">&lt;</span> llength <span class="free">t</span> <span class="main">∧</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub>lnth <span class="free">t</span> <span class="bound">i'</span></sub><span class="hidden">⇙</span><span class="main">)</span> <span class="main">⟶</span> <span class="main">(</span><span class="bound">i'</span> <span class="main">=</span> <span class="free">i</span><span class="main">)</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">⟨</span><span class="free">c</span> #<span class="hidden">⇘</span><sub><span class="free">n'</span></sub><span class="hidden">⇙</span> <span class="free">t</span><span class="main">⟩</span> <span class="main">=</span> eSuc <span class="main">(</span><span class="main">⟨</span><span class="free">c</span> #<span class="hidden">⇘</span><sub><span class="free">n</span></sub><span class="hidden">⇙</span> <span class="free">t</span><span class="main">⟩</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">from</span></span> assms <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>ltake <span class="free">n'</span> <span class="free">t</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>ltake <span class="main">(</span>enat <span class="free">n</span><span class="main">)</span> <span class="free">t</span><span class="main">)</span><span class="main">)</span> <span class="keyword1">@<span class="hidden">⇩</span><sub>l</sub></span> <span class="main">(</span><span class="main">(</span>σ<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>lnth <span class="free">t</span> <span class="free">i</span><span class="main">)</span><span class="main">)</span> <span class="keyword1">#<span class="hidden">⇩</span><sub>l</sub></span> <span class="keyword1">[]<span class="hidden">⇩</span><sub>l</sub></span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> proj_active_append<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="free">n</span></span> <span class="quoted"><span class="free">i</span></span> <span class="quoted"><span class="free">n'</span></span> <span class="quoted"><span class="free">t</span></span> <span class="quoted"><span class="free">c</span></span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"llength <span class="main">(</span><span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>ltake <span class="main">(</span>enat <span class="free">n</span><span class="main">)</span> <span class="free">t</span><span class="main">)</span><span class="main">)</span> <span class="keyword1">@<span class="hidden">⇩</span><sub>l</sub></span> <span class="main">(</span><span class="main">(</span>σ<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>lnth <span class="free">t</span> <span class="free">i</span><span class="main">)</span><span class="main">)</span> <span class="keyword1">#<span class="hidden">⇩</span><sub>l</sub></span> <span class="keyword1">[]<span class="hidden">⇩</span><sub>l</sub></span><span class="main">)</span><span class="main">)</span> <span class="main">=</span>
    eSuc <span class="main">(</span>llength <span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>ltake <span class="main">(</span>enat <span class="free">n</span><span class="main">)</span> <span class="free">t</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> one_eSuc eSuc_plus_1 <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> nAct_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>
  
<span class="keyword1" id="Configuration_Traces-nAct_less"><span class="command">lemma</span></span> nAct_less<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"enat <span class="free">k</span> <span class="main">&lt;</span> llength <span class="free">t</span>"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">n</span> <span class="main">≤</span> <span class="free">k</span>"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">k</span> <span class="main">&lt;</span> <span class="main">(</span><span class="free">n'</span><span class="main">::</span>enat<span class="main">)</span>"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub>lnth <span class="free">t</span> <span class="free">k</span></sub><span class="hidden">⇙</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">⟨</span><span class="free">c</span> #<span class="hidden">⇘</span><sub><span class="free">n</span></sub><span class="hidden">⇙</span> <span class="free">t</span><span class="main">⟩</span> <span class="main">&lt;</span> <span class="main">⟨</span><span class="free">c</span> #<span class="hidden">⇘</span><sub><span class="free">n'</span></sub><span class="hidden">⇙</span> <span class="free">t</span><span class="main">⟩</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">⟨</span><span class="free">c</span> #<span class="hidden">⇘</span><sub><span class="free">k</span></sub><span class="hidden">⇙</span> <span class="free">t</span><span class="main">⟩</span> <span class="main">≠</span> <span class="main">∞</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">en</span></span> <span class="keyword2"><span class="keyword">where</span></span> en_def<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">⟨</span><span class="free">c</span> #<span class="hidden">⇘</span><sub><span class="free">k</span></sub><span class="hidden">⇙</span> <span class="free">t</span><span class="main">⟩</span> <span class="main">=</span> enat <span class="skolem">en</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>  
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"eSuc <span class="main">(</span>enat <span class="skolem">en</span><span class="main">)</span> <span class="main">≤</span> <span class="main">⟨</span><span class="free">c</span> #<span class="hidden">⇘</span><sub><span class="free">n'</span></sub><span class="hidden">⇙</span> <span class="free">t</span><span class="main">⟩</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
    <span class="keyword1"><span class="command">from</span></span> assms <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"Suc <span class="free">k</span> <span class="main">≤</span> <span class="free">n'</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> Suc_ile_eq <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="main">⟨</span><span class="free">c</span> #<span class="hidden">⇘</span><sub>Suc <span class="free">k</span></sub><span class="hidden">⇙</span> <span class="free">t</span><span class="main">⟩</span> <span class="main">≤</span> <span class="main">⟨</span><span class="free">c</span> #<span class="hidden">⇘</span><sub><span class="free">n'</span></sub><span class="hidden">⇙</span> <span class="free">t</span><span class="main">⟩</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> nAct_mono <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> assms <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">⟨</span><span class="free">c</span> #<span class="hidden">⇘</span><sub>Suc <span class="free">k</span></sub><span class="hidden">⇙</span> <span class="free">t</span><span class="main">⟩</span> <span class="main">=</span> eSuc <span class="main">(</span><span class="main">⟨</span><span class="free">c</span> #<span class="hidden">⇘</span><sub><span class="free">k</span></sub><span class="hidden">⇙</span> <span class="free">t</span><span class="main">⟩</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"eSuc <span class="main">(</span><span class="main">⟨</span><span class="free">c</span> #<span class="hidden">⇘</span><sub><span class="free">k</span></sub><span class="hidden">⇙</span> <span class="free">t</span><span class="main">⟩</span><span class="main">)</span> <span class="main">≤</span> <span class="main">⟨</span><span class="free">c</span> #<span class="hidden">⇘</span><sub><span class="free">n'</span></sub><span class="hidden">⇙</span> <span class="free">t</span><span class="main">⟩</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> en_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"enat <span class="skolem">en</span> <span class="main">&lt;</span> eSuc <span class="main">(</span>enat <span class="skolem">en</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"enat <span class="skolem">en</span> <span class="main">&lt;</span> <span class="main">⟨</span><span class="free">c</span> #<span class="hidden">⇘</span><sub><span class="free">n'</span></sub><span class="hidden">⇙</span> <span class="free">t</span><span class="main">⟩</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> less_le_trans<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="quoted">"enat <span class="skolem">en</span>"</span></span> <span class="quoted"><span class="quoted">"eSuc <span class="main">(</span>enat <span class="skolem">en</span><span class="main">)</span>"</span></span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">⟨</span><span class="free">c</span> #<span class="hidden">⇘</span><sub><span class="free">n</span></sub><span class="hidden">⇙</span> <span class="free">t</span><span class="main">⟩</span> <span class="main">≤</span> enat <span class="skolem">en</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
    <span class="keyword1"><span class="command">from</span></span> assms <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">⟨</span><span class="free">c</span> #<span class="hidden">⇘</span><sub><span class="free">n</span></sub><span class="hidden">⇙</span> <span class="free">t</span><span class="main">⟩</span> <span class="main">≤</span> <span class="main">⟨</span><span class="free">c</span> #<span class="hidden">⇘</span><sub><span class="free">k</span></sub><span class="hidden">⇙</span> <span class="free">t</span><span class="main">⟩</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> nAct_mono <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> en_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> le_less_trans<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="quoted">"<span class="main">⟨</span><span class="free">c</span> #<span class="hidden">⇘</span><sub><span class="free">n</span></sub><span class="hidden">⇙</span> <span class="free">t</span><span class="main">⟩</span>"</span></span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>
  
<span class="keyword1" id="Configuration_Traces-nAct_less_active"><span class="command">lemma</span></span> nAct_less_active<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">n'</span> <span class="main">-</span> <span class="main">1</span> <span class="main">&lt;</span> llength <span class="free">t</span>"</span></span>
      <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">⟨</span><span class="free">c</span> #<span class="hidden">⇘</span><sub>enat <span class="free">n</span></sub><span class="hidden">⇙</span> <span class="free">t</span><span class="main">⟩</span> <span class="main">&lt;</span> <span class="main">⟨</span><span class="free">c</span> #<span class="hidden">⇘</span><sub><span class="free">n'</span></sub><span class="hidden">⇙</span> <span class="free">t</span><span class="main">⟩</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound"><span class="bound">i</span></span><span class="main">≥</span><span class="free">n</span><span class="main">.</span> <span class="bound">i</span><span class="main">&lt;</span><span class="free">n'</span> <span class="main">∧</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub>lnth <span class="free">t</span> <span class="bound">i</span></sub><span class="hidden">⇙</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">rule</span> ccontr<span class="main">)</span>
  <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> <span class="main">(</span><span class="main">∃</span><span class="bound"><span class="bound">i</span></span><span class="main">≥</span><span class="free">n</span><span class="main">.</span> <span class="bound">i</span><span class="main">&lt;</span><span class="free">n'</span> <span class="main">∧</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub>lnth <span class="free">t</span> <span class="bound">i</span></sub><span class="hidden">⇙</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"enat <span class="free">n</span> <span class="main">≤</span> <span class="free">n'</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>2<span class="main">)</span> less_imp_le nAct_strict_mono_back <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">⟨</span><span class="free">c</span> #<span class="hidden">⇘</span><sub><span class="free">n</span></sub><span class="hidden">⇙</span> <span class="free">t</span><span class="main">⟩</span> <span class="main">=</span> <span class="main">⟨</span><span class="free">c</span> #<span class="hidden">⇘</span><sub><span class="free">n'</span></sub><span class="hidden">⇙</span> <span class="free">t</span><span class="main">⟩</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="free">n'</span> <span class="main">-</span> <span class="main">1</span> <span class="main">&lt;</span> llength <span class="free">t</span>›</span></span> nAct_not_active_same <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="quoted">False</span> <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">subsubsection</span></span> <span class="quoted"><span class="plain_text">"Same and Not Same"</span></span>
  
<span class="keyword1" id="Configuration_Traces-nAct_same_not_active"><span class="command">lemma</span></span> nAct_same_not_active<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="main">⟨</span><span class="free">c</span> #<span class="hidden">⇘</span><sub><span class="free">n'</span></sub><span class="hidden">⇙</span> inf_llist <span class="free">t</span><span class="main">⟩</span> <span class="main">=</span> <span class="main">⟨</span><span class="free">c</span> #<span class="hidden">⇘</span><sub><span class="free">n</span></sub><span class="hidden">⇙</span> inf_llist <span class="free">t</span><span class="main">⟩</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound"><span class="bound">k</span></span><span class="main">≥</span><span class="free">n</span><span class="main">.</span> <span class="bound">k</span><span class="main">&lt;</span><span class="free">n'</span> <span class="main">⟶</span> <span class="main">¬</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">k</span></sub><span class="hidden">⇙</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">rule</span> ccontr<span class="main">)</span>
  <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span><span class="main">(</span><span class="main">∀</span><span class="bound"><span class="bound">k</span></span><span class="main">≥</span><span class="free">n</span><span class="main">.</span> <span class="bound">k</span><span class="main">&lt;</span><span class="free">n'</span> <span class="main">⟶</span> <span class="main">¬</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">k</span></sub><span class="hidden">⇙</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">k</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">k</span><span class="main">≥</span><span class="free">n</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">k</span><span class="main">&lt;</span><span class="free">n'</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="skolem">k</span></sub><span class="hidden">⇙</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="main">⟨</span><span class="free">c</span> #<span class="hidden">⇘</span><sub>Suc <span class="skolem">k</span></sub><span class="hidden">⇙</span> inf_llist <span class="free">t</span><span class="main">⟩</span> <span class="main">=</span> eSuc <span class="main">(</span><span class="main">⟨</span><span class="free">c</span> #<span class="hidden">⇘</span><sub><span class="skolem">k</span></sub><span class="hidden">⇙</span> inf_llist <span class="free">t</span><span class="main">⟩</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">⟨</span><span class="free">c</span> #<span class="hidden">⇘</span><sub><span class="skolem">k</span></sub><span class="hidden">⇙</span> inf_llist <span class="free">t</span><span class="main">⟩</span><span class="main">≠</span><span class="main">∞</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">⟨</span><span class="free">c</span> #<span class="hidden">⇘</span><sub><span class="skolem">k</span></sub><span class="hidden">⇙</span> inf_llist <span class="free">t</span><span class="main">⟩</span> <span class="main">&lt;</span> <span class="main">⟨</span><span class="free">c</span> #<span class="hidden">⇘</span><sub>Suc <span class="skolem">k</span></sub><span class="hidden">⇙</span> inf_llist <span class="free">t</span><span class="main">⟩</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">fastforce</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="free">n</span><span class="main">≤</span><span class="skolem">k</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">⟨</span><span class="free">c</span> #<span class="hidden">⇘</span><sub><span class="free">n</span></sub><span class="hidden">⇙</span> inf_llist <span class="free">t</span><span class="main">⟩</span> <span class="main">≤</span> <span class="main">⟨</span><span class="free">c</span> #<span class="hidden">⇘</span><sub><span class="skolem">k</span></sub><span class="hidden">⇙</span> inf_llist <span class="free">t</span><span class="main">⟩</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> nAct_mono <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">k</span><span class="main">&lt;</span><span class="free">n'</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"Suc <span class="skolem">k</span> <span class="main">≤</span> <span class="free">n'</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> Suc_ile_eq<span class="main">)</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="main">⟨</span><span class="free">c</span> #<span class="hidden">⇘</span><sub>Suc <span class="skolem">k</span></sub><span class="hidden">⇙</span> inf_llist <span class="free">t</span><span class="main">⟩</span> <span class="main">≤</span> <span class="main">⟨</span><span class="free">c</span> #<span class="hidden">⇘</span><sub><span class="free">n'</span></sub><span class="hidden">⇙</span> inf_llist <span class="free">t</span><span class="main">⟩</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> nAct_mono <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted">False</span> <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>
  
<span class="keyword1" id="Configuration_Traces-nAct_not_same_active"><span class="command">lemma</span></span> nAct_not_same_active<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="main">⟨</span><span class="free">c</span> #<span class="hidden">⇘</span><sub>enat <span class="free">n</span></sub><span class="hidden">⇙</span> <span class="free">t</span><span class="main">⟩</span> <span class="main">&lt;</span> <span class="main">⟨</span><span class="free">c</span> #<span class="hidden">⇘</span><sub><span class="free">n'</span></sub><span class="hidden">⇙</span> <span class="free">t</span><span class="main">⟩</span>"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> lfinite <span class="free">t</span> <span class="main">∨</span> <span class="free">n'</span> <span class="main">-</span> <span class="main">1</span> <span class="main">&lt;</span> llength <span class="free">t</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="main">(</span><span class="bound"><span class="bound">i</span></span><span class="main">::</span>nat<span class="main">)</span><span class="main">≥</span><span class="free">n</span><span class="main">.</span> enat <span class="bound">i</span><span class="main">&lt;</span> <span class="free">n'</span> <span class="main">∧</span> <span class="bound">i</span><span class="main">&lt;</span>llength <span class="free">t</span> <span class="main">∧</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub>lnth <span class="free">t</span> <span class="bound">i</span></sub><span class="hidden">⇙</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">from</span></span> assms <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"llength<span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>ltake <span class="free">n</span> <span class="free">t</span><span class="main">)</span><span class="main">)</span> <span class="main">&lt;</span> llength <span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>ltake <span class="free">n'</span> <span class="free">t</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> nAct_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>ltake <span class="free">n'</span> <span class="free">t</span><span class="main">)</span> <span class="main">≠</span> π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>ltake <span class="free">n</span> <span class="free">t</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> assms <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"enat <span class="free">n</span> <span class="main">&lt;</span> <span class="free">n'</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> nAct_strict_mono_back<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="free">c</span></span> <span class="quoted"><span class="quoted">"enat <span class="free">n</span>"</span></span> <span class="quoted"><span class="free">t</span></span> <span class="quoted"><span class="free">n'</span></span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> proj_not_same_active<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="free">n</span></span> <span class="quoted"><span class="free">n'</span></span> <span class="quoted"><span class="free">t</span></span> <span class="quoted"><span class="free">c</span></span><span class="main">]</span> assms <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>
  
<span class="keyword1" id="Configuration_Traces-nAct_less_llength_active"><span class="command">lemma</span></span> nAct_less_llength_active<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main">&lt;</span> llength <span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span><span class="free">t</span><span class="main">)</span><span class="main">)</span>"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"enat <span class="free">x</span> <span class="main">=</span> <span class="main">⟨</span><span class="free">c</span> #<span class="hidden">⇘</span><sub>enat <span class="free">n'</span></sub><span class="hidden">⇙</span> <span class="free">t</span><span class="main">⟩</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="main">(</span><span class="bound"><span class="bound">i</span></span><span class="main">::</span>nat<span class="main">)</span><span class="main">≥</span><span class="free">n'</span><span class="main">.</span> <span class="bound">i</span><span class="main">&lt;</span>llength <span class="free">t</span> <span class="main">∧</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub>lnth <span class="free">t</span> <span class="bound">i</span></sub><span class="hidden">⇙</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"llength<span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>ltake <span class="free">n'</span> <span class="free">t</span><span class="main">)</span><span class="main">)</span> <span class="main">&lt;</span> llength <span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span><span class="free">t</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>1<span class="main">)</span> assms<span class="main">(</span>2<span class="main">)</span> nAct_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"llength<span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>ltake <span class="free">n'</span> <span class="free">t</span><span class="main">)</span><span class="main">)</span> <span class="main">&lt;</span> llength <span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>ltake <span class="main">(</span>llength <span class="free">t</span><span class="main">)</span> <span class="free">t</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> ltake_all<span class="main">)</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="main">⟨</span><span class="free">c</span> #<span class="hidden">⇘</span><sub>enat <span class="free">n'</span></sub><span class="hidden">⇙</span> <span class="free">t</span><span class="main">⟩</span> <span class="main">&lt;</span> <span class="main">⟨</span><span class="free">c</span> #<span class="hidden">⇘</span><sub>llength <span class="free">t</span></sub><span class="hidden">⇙</span> <span class="free">t</span><span class="main">⟩</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> nAct_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> lfinite <span class="free">t</span> <span class="main">∨</span> llength <span class="free">t</span> <span class="main">-</span> <span class="main">1</span> <span class="main">&lt;</span> llength <span class="free">t</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">rule</span> Meson.imp_to_disjD<span class="main"><span class="main">[</span></span><span class="operator">OF</span> HOL.impI<span class="main"><span class="main">]</span></span><span class="main">)</span>
    <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"lfinite <span class="free">t</span>"</span></span>
    <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"llength <span class="free">t</span> <span class="main">≠</span> <span class="main">∞</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> llength_eq_infty_conv_lfinite<span class="main">)</span>
    <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"llength <span class="free">t</span><span class="main">&gt;</span><span class="main">0</span>"</span></span>
    <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
      <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="free">x</span> <span class="main">&lt;</span> llength <span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span><span class="free">t</span><span class="main">)</span><span class="main">)</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"llength <span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span><span class="free">t</span><span class="main">)</span><span class="main">)</span><span class="main">&gt;</span><span class="main">0</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> proj_llength order.strict_trans2 <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
    <span class="keyword1"><span class="command">qed</span></span>
    <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"llength <span class="free">t</span> <span class="main">-</span> <span class="main">1</span> <span class="main">&lt;</span> llength <span class="free">t</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> One_nat_def <span class="quoted"><span class="quoted">‹lfinite <span class="free">t</span>›</span></span> diff_Suc_less
      enat_ord_simps<span class="main"><span class="main">(</span></span>2<span class="main"><span class="main">)</span></span> idiff_enat_enat lfinite_conv_llength_enat one_enat_def zero_enat_def<span class="main">)</span>
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> nAct_not_same_active<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="free">c</span></span> <span class="quoted"><span class="free">n'</span></span> <span class="quoted"><span class="free">t</span></span> <span class="quoted"><span class="quoted">"llength <span class="free">t</span>"</span></span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="Configuration_Traces-nAct_exists"><span class="command">lemma</span></span> nAct_exists<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main">&lt;</span> llength <span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span><span class="free">t</span><span class="main">)</span><span class="main">)</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="main">(</span><span class="bound">n'</span><span class="main">::</span>nat<span class="main">)</span><span class="main">.</span> enat <span class="free">x</span> <span class="main">=</span> <span class="main">⟨</span><span class="free">c</span> #<span class="hidden">⇘</span><sub><span class="bound">n'</span></sub><span class="hidden">⇙</span> <span class="free">t</span><span class="main">⟩</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main">&lt;</span> llength <span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span><span class="free">t</span><span class="main">)</span><span class="main">)</span> <span class="main">⟶</span> <span class="main">(</span><span class="main">∃</span><span class="main">(</span><span class="bound">n'</span><span class="main">::</span>nat<span class="main">)</span><span class="main">.</span> enat <span class="free">x</span> <span class="main">=</span> <span class="main">⟨</span><span class="free">c</span> #<span class="hidden">⇘</span><sub><span class="bound">n'</span></sub><span class="hidden">⇙</span> <span class="free">t</span><span class="main">⟩</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">induction</span> <span class="quoted"><span class="free">x</span></span><span class="main">)</span>
    <span class="keyword3"><span class="command">case</span></span> 0
    <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?case</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> nAct_0 zero_enat_def<span class="main">)</span>
  <span class="keyword1"><span class="command">next</span></span>
    <span class="keyword3"><span class="command">case</span></span> <span class="main">(</span>Suc <span class="skolem">x</span><span class="main">)</span>
    <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?case</span></span></span>
    <span class="keyword1"><span class="command">proof</span></span>
      <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"Suc <span class="skolem">x</span> <span class="main">&lt;</span> llength <span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span><span class="free">t</span><span class="main">)</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">&lt;</span> llength <span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span><span class="free">t</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> Suc_ile_eq less_imp_le <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">with</span></span> Suc.IH <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">n'</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"enat <span class="skolem">x</span> <span class="main">=</span> <span class="main">⟨</span><span class="free">c</span> #<span class="hidden">⇘</span><sub>enat <span class="skolem">n'</span></sub><span class="hidden">⇙</span> <span class="free">t</span><span class="main">⟩</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
      <span class="keyword1"><span class="command">with</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">x</span> <span class="main">&lt;</span> llength <span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span><span class="free">t</span><span class="main">)</span><span class="main">)</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound"><span class="bound">i</span></span><span class="main">≥</span><span class="skolem">n'</span><span class="main">.</span> <span class="bound">i</span> <span class="main">&lt;</span> llength <span class="free">t</span> <span class="main">∧</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub>lnth <span class="free">t</span> <span class="bound">i</span></sub><span class="hidden">⇙</span>"</span></span>
        <span class="keyword1"><span class="command">using</span></span> nAct_less_llength_active<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="skolem">x</span></span> <span class="quoted"><span class="free">c</span></span> <span class="quoted"><span class="free">t</span></span> <span class="quoted"><span class="skolem">n'</span></span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
      <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">i</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">i</span><span class="main">≥</span><span class="skolem">n'</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">i</span><span class="main">&lt;</span>llength <span class="free">t</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub>lnth <span class="free">t</span> <span class="skolem">i</span></sub><span class="hidden">⇙</span>"</span></span>
        <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">∄</span><span class="bound">k</span><span class="main">.</span> <span class="skolem">n'</span><span class="main">≤</span><span class="bound">k</span> <span class="main">∧</span> <span class="bound">k</span><span class="main">&lt;</span><span class="skolem">i</span> <span class="main">∧</span> <span class="bound">k</span><span class="main">&lt;</span>llength <span class="free">t</span> <span class="main">∧</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub>lnth <span class="free">t</span> <span class="bound">k</span></sub><span class="hidden">⇙</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> lActive_least<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="skolem">n'</span></span> <span class="quoted"><span class="free">t</span></span> <span class="quoted"><span class="free">c</span></span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">i</span><span class="main">&lt;</span>llength <span class="free">t</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> lfinite <span class="free">t</span> <span class="main">∨</span> enat <span class="main">(</span>Suc <span class="skolem">i</span><span class="main">)</span> <span class="main">-</span> <span class="main">1</span> <span class="main">&lt;</span> llength <span class="free">t</span>"</span></span>
        <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> one_enat_def<span class="main">)</span>
      <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"enat <span class="skolem">i</span> <span class="main">&lt;</span> enat <span class="main">(</span>Suc <span class="skolem">i</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
      <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">i'</span><span class="main">.</span> <span class="main">(</span><span class="skolem">n'</span> <span class="main">≤</span> <span class="bound">i'</span> <span class="main">∧</span> enat <span class="bound">i'</span><span class="main">&lt;</span>enat <span class="main">(</span>Suc <span class="skolem">i</span><span class="main">)</span> <span class="main">∧</span> <span class="bound">i'</span><span class="main">&lt;</span>llength <span class="free">t</span> <span class="main">∧</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub>lnth <span class="free">t</span> <span class="bound">i'</span></sub><span class="hidden">⇙</span><span class="main">)</span> <span class="main">⟶</span> <span class="main">(</span><span class="bound">i'</span> <span class="main">=</span> <span class="skolem">i</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">rule</span> HOL.impI<span class="main"><span class="main">[</span></span><span class="operator">THEN</span> HOL.allI<span class="main"><span class="main">]</span></span><span class="main">)</span>
        <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">i'</span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">n'</span> <span class="main">≤</span> <span class="skolem">i'</span> <span class="main">∧</span> enat <span class="skolem">i'</span><span class="main">&lt;</span>enat <span class="main">(</span>Suc <span class="skolem">i</span><span class="main">)</span> <span class="main">∧</span> <span class="skolem">i'</span><span class="main">&lt;</span>llength <span class="free">t</span> <span class="main">∧</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub>lnth <span class="free">t</span> <span class="skolem">i'</span></sub><span class="hidden">⇙</span>"</span></span>
        <span class="keyword1"><span class="command">with</span></span> <span class="quoted"><span class="quoted">‹<span class="main">∄</span><span class="bound">k</span><span class="main">.</span> <span class="skolem">n'</span><span class="main">≤</span><span class="bound">k</span> <span class="main">∧</span> <span class="bound">k</span><span class="main">&lt;</span><span class="skolem">i</span> <span class="main">∧</span> <span class="bound">k</span><span class="main">&lt;</span>llength <span class="free">t</span> <span class="main">∧</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub>lnth <span class="free">t</span> <span class="bound">k</span></sub><span class="hidden">⇙</span>›</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">i'</span><span class="main">=</span><span class="skolem">i</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">fastforce</span>
      <span class="keyword1"><span class="command">qed</span></span>
      <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">⟨</span><span class="free">c</span> #<span class="hidden">⇘</span><sub>Suc <span class="skolem">i</span></sub><span class="hidden">⇙</span> <span class="free">t</span><span class="main">⟩</span> <span class="main">=</span> eSuc <span class="main">(</span><span class="main">⟨</span><span class="free">c</span> #<span class="hidden">⇘</span><sub><span class="skolem">n'</span></sub><span class="hidden">⇙</span> <span class="free">t</span><span class="main">⟩</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> nAct_active_suc<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="free">t</span></span> <span class="quoted"><span class="quoted">"Suc <span class="skolem">i</span>"</span></span> <span class="quoted"><span class="skolem">n'</span></span> <span class="quoted"><span class="skolem">i</span></span> <span class="quoted"><span class="free">c</span></span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
      <span class="keyword1"><span class="command">with</span></span> <span class="quoted"><span class="quoted">‹enat <span class="skolem">x</span> <span class="main">=</span> <span class="main">⟨</span><span class="free">c</span> #<span class="hidden">⇘</span><sub>enat <span class="skolem">n'</span></sub><span class="hidden">⇙</span> <span class="free">t</span><span class="main">⟩</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">⟨</span><span class="free">c</span> #<span class="hidden">⇘</span><sub>Suc <span class="skolem">i</span></sub><span class="hidden">⇙</span> <span class="free">t</span><span class="main">⟩</span> <span class="main">=</span> eSuc <span class="main">(</span>enat <span class="skolem">x</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
      <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound">n'</span><span class="main">.</span> enat <span class="main">(</span>Suc <span class="skolem">x</span><span class="main">)</span> <span class="main">=</span> <span class="main">⟨</span><span class="free">c</span> #<span class="hidden">⇘</span><sub>enat <span class="bound">n'</span></sub><span class="hidden">⇙</span> <span class="free">t</span><span class="main">⟩</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> eSuc_enat<span class="main">)</span>
    <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">with</span></span> assms <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>
  
<span class="keyword1"><span class="command">subsection</span></span> <span class="quoted"><span class="plain_text">"Projection and Activation"</span></span>
<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹
  In the following we provide some properties about the relationship between the projection and activations operator.
›</span></span>
  
<span class="keyword1" id="Configuration_Traces-nAct_le_proj"><span class="command">lemma</span></span> nAct_le_proj<span class="main">:</span>
  <span class="quoted"><span class="quoted">"<span class="main">⟨</span><span class="free">c</span> #<span class="hidden">⇘</span><sub><span class="free">n</span></sub><span class="hidden">⇙</span> <span class="free">t</span><span class="main">⟩</span> <span class="main">≤</span> llength <span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span><span class="free">t</span><span class="main">)</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">from</span></span> nAct_def <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">⟨</span><span class="free">c</span> #<span class="hidden">⇘</span><sub><span class="free">n</span></sub><span class="hidden">⇙</span> <span class="free">t</span><span class="main">⟩</span> <span class="main">=</span> llength <span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>ltake <span class="free">n</span> <span class="free">t</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"llength <span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>ltake <span class="free">n</span> <span class="free">t</span><span class="main">)</span><span class="main">)</span> <span class="main">≤</span> llength <span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span><span class="free">t</span><span class="main">)</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"lprefix <span class="main">(</span>ltake <span class="free">n</span> <span class="free">t</span><span class="main">)</span> <span class="free">t</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"lprefix <span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>ltake <span class="free">n</span> <span class="free">t</span><span class="main">)</span><span class="main">)</span> <span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span><span class="free">t</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"llength <span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>ltake <span class="free">n</span> <span class="free">t</span><span class="main">)</span><span class="main">)</span> <span class="main">≤</span> llength <span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span><span class="free">t</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> lprefix_llength_le <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
    <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> nAct_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>
  
<span class="keyword1" id="Configuration_Traces-proj_nAct"><span class="command">lemma</span></span> proj_nAct<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span>enat <span class="free">n</span> <span class="main">&lt;</span> llength <span class="free">t</span><span class="main">)</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>ltake <span class="free">n</span> <span class="free">t</span><span class="main">)</span> <span class="main">=</span> ltake <span class="main">(</span><span class="main">⟨</span><span class="free">c</span> #<span class="hidden">⇘</span><sub><span class="free">n</span></sub><span class="hidden">⇙</span> <span class="free">t</span><span class="main">⟩</span><span class="main">)</span> <span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span><span class="free">t</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">is</span></span> <span class="quoted"><span class="quoted">"<span class="var">?lhs</span> <span class="main">=</span> <span class="var">?rhs</span>"</span></span><span class="main">)</span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="var">?lhs</span> <span class="main">=</span> ltake <span class="main">(</span>llength <span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>ltake <span class="free">n</span> <span class="free">t</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>ltake <span class="free">n</span> <span class="free">t</span><span class="main">)</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> ltake_all<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="quoted">"π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>ltake <span class="free">n</span> <span class="free">t</span><span class="main">)</span>"</span></span> <span class="quoted"><span class="quoted">"llength <span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>ltake <span class="free">n</span> <span class="free">t</span><span class="main">)</span><span class="main">)</span>"</span></span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">…</span> <span class="main">=</span> ltake <span class="main">(</span>llength <span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>ltake <span class="free">n</span> <span class="free">t</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">(</span><span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>ltake <span class="free">n</span> <span class="free">t</span><span class="main">)</span><span class="main">)</span> <span class="keyword1">@<span class="hidden">⇩</span><sub>l</sub></span> <span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>ldrop <span class="free">n</span> <span class="free">t</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> ltake_lappend1<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="quoted">"llength <span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>ltake <span class="main">(</span>enat <span class="free">n</span><span class="main">)</span> <span class="free">t</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="quoted"><span class="quoted">"π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>ltake <span class="free">n</span> <span class="free">t</span><span class="main">)</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>ldrop <span class="free">n</span> <span class="free">t</span><span class="main">)</span><span class="main">)</span>"</span></span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">…</span> <span class="main">=</span> ltake <span class="main">(</span><span class="main">⟨</span><span class="free">c</span> #<span class="hidden">⇘</span><sub><span class="free">n</span></sub><span class="hidden">⇙</span> <span class="free">t</span><span class="main">⟩</span><span class="main">)</span> <span class="main">(</span><span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>ltake <span class="free">n</span> <span class="free">t</span><span class="main">)</span><span class="main">)</span> <span class="keyword1">@<span class="hidden">⇩</span><sub>l</sub></span> <span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>ldrop <span class="free">n</span> <span class="free">t</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> nAct_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>      
  <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">…</span> <span class="main">=</span> ltake <span class="main">(</span><span class="main">⟨</span><span class="free">c</span> #<span class="hidden">⇘</span><sub><span class="free">n</span></sub><span class="hidden">⇙</span> <span class="free">t</span><span class="main">⟩</span><span class="main">)</span> <span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span><span class="main">(</span>ltake <span class="main">(</span>enat <span class="free">n</span><span class="main">)</span> <span class="free">t</span><span class="main">)</span> <span class="keyword1">@<span class="hidden">⇩</span><sub>l</sub></span> <span class="main">(</span>ldrop <span class="free">n</span> <span class="free">t</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">…</span> <span class="main">=</span> ltake <span class="main">(</span><span class="main">⟨</span><span class="free">c</span> #<span class="hidden">⇘</span><sub><span class="free">n</span></sub><span class="hidden">⇙</span> <span class="free">t</span><span class="main">⟩</span><span class="main">)</span> <span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span><span class="free">t</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> lappend_ltake_ldrop<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="free">n</span></span> <span class="quoted"><span class="free">t</span></span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">finally</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="Configuration_Traces-proj_active_nth"><span class="command">lemma</span></span> proj_active_nth<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"enat <span class="main">(</span>Suc <span class="free">i</span><span class="main">)</span> <span class="main">&lt;</span> llength <span class="free">t</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub>lnth <span class="free">t</span> <span class="free">i</span></sub><span class="hidden">⇙</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"lnth <span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span><span class="free">t</span><span class="main">)</span><span class="main">)</span> <span class="main">(</span>the_enat <span class="main">(</span><span class="main">⟨</span><span class="free">c</span> #<span class="hidden">⇘</span><sub><span class="free">i</span></sub><span class="hidden">⇙</span> <span class="free">t</span><span class="main">⟩</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> σ<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>lnth <span class="free">t</span> <span class="free">i</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">from</span></span> assms <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"enat <span class="free">i</span> <span class="main">&lt;</span> llength <span class="free">t</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> Suc_ile_eq<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="free">i</span></span> <span class="quoted"><span class="quoted">"llength <span class="free">t</span>"</span></span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">with</span></span> assms <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>ltake <span class="main">(</span>Suc <span class="free">i</span><span class="main">)</span> <span class="free">t</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>ltake <span class="free">i</span> <span class="free">t</span><span class="main">)</span><span class="main">)</span> <span class="keyword1">@<span class="hidden">⇩</span><sub>l</sub></span> <span class="main">(</span><span class="main">(</span>σ<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>lnth <span class="free">t</span> <span class="free">i</span><span class="main">)</span><span class="main">)</span> <span class="keyword1">#<span class="hidden">⇩</span><sub>l</sub></span> <span class="keyword1">[]<span class="hidden">⇩</span><sub>l</sub></span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"lnth <span class="main">(</span><span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>ltake <span class="free">i</span> <span class="free">t</span><span class="main">)</span><span class="main">)</span> <span class="keyword1">@<span class="hidden">⇩</span><sub>l</sub></span> <span class="main">(</span><span class="main">(</span>σ<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>lnth <span class="free">t</span> <span class="free">i</span><span class="main">)</span><span class="main">)</span> <span class="keyword1">#<span class="hidden">⇩</span><sub>l</sub></span> <span class="keyword1">[]<span class="hidden">⇩</span><sub>l</sub></span><span class="main">)</span><span class="main">)</span>
    <span class="main">(</span>the_enat <span class="main">(</span>llength <span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>ltake <span class="free">i</span> <span class="free">t</span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> σ<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>lnth <span class="free">t</span> <span class="free">i</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> lnull <span class="main">(</span><span class="main">(</span>σ<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>lnth <span class="free">t</span> <span class="free">i</span><span class="main">)</span><span class="main">)</span> <span class="keyword1">#<span class="hidden">⇩</span><sub>l</sub></span> <span class="keyword1">[]<span class="hidden">⇩</span><sub>l</sub></span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"lfinite <span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>ltake <span class="free">i</span> <span class="free">t</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"lnth <span class="main">(</span><span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>ltake <span class="free">i</span> <span class="free">t</span><span class="main">)</span><span class="main">)</span> <span class="keyword1">@<span class="hidden">⇩</span><sub>l</sub></span> <span class="main">(</span><span class="main">(</span>σ<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>lnth <span class="free">t</span> <span class="free">i</span><span class="main">)</span><span class="main">)</span> <span class="keyword1">#<span class="hidden">⇩</span><sub>l</sub></span> <span class="keyword1">[]<span class="hidden">⇩</span><sub>l</sub></span><span class="main">)</span><span class="main">)</span>
      <span class="main">(</span>the_enat <span class="main">(</span>llength <span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>ltake <span class="free">i</span> <span class="free">t</span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> lhd <span class="main">(</span><span class="main">(</span>σ<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>lnth <span class="free">t</span> <span class="free">i</span><span class="main">)</span><span class="main">)</span> <span class="keyword1">#<span class="hidden">⇩</span><sub>l</sub></span> <span class="keyword1">[]<span class="hidden">⇩</span><sub>l</sub></span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">…</span> <span class="main">=</span> σ<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>lnth <span class="free">t</span> <span class="free">i</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">finally</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"lnth <span class="main">(</span><span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>ltake <span class="free">i</span> <span class="free">t</span><span class="main">)</span><span class="main">)</span> <span class="keyword1">@<span class="hidden">⇩</span><sub>l</sub></span> <span class="main">(</span><span class="main">(</span>σ<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>lnth <span class="free">t</span> <span class="free">i</span><span class="main">)</span><span class="main">)</span> <span class="keyword1">#<span class="hidden">⇩</span><sub>l</sub></span> <span class="keyword1">[]<span class="hidden">⇩</span><sub>l</sub></span><span class="main">)</span><span class="main">)</span>
      <span class="main">(</span>the_enat <span class="main">(</span>llength <span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>ltake <span class="free">i</span> <span class="free">t</span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> σ<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>lnth <span class="free">t</span> <span class="free">i</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"σ<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>lnth <span class="free">t</span> <span class="free">i</span><span class="main">)</span> <span class="main">=</span> lnth <span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>ltake <span class="main">(</span>Suc <span class="free">i</span><span class="main">)</span> <span class="free">t</span><span class="main">)</span><span class="main">)</span>
    <span class="main">(</span>the_enat <span class="main">(</span>llength <span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>ltake <span class="free">i</span> <span class="free">t</span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">…</span> <span class="main">=</span> lnth <span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>ltake <span class="main">(</span>Suc <span class="free">i</span><span class="main">)</span> <span class="free">t</span><span class="main">)</span><span class="main">)</span> <span class="main">(</span>the_enat <span class="main">(</span><span class="main">⟨</span><span class="free">c</span> #<span class="hidden">⇘</span><sub><span class="free">i</span></sub><span class="hidden">⇙</span> <span class="free">t</span><span class="main">⟩</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> nAct_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">…</span> <span class="main">=</span> lnth <span class="main">(</span>ltake <span class="main">(</span><span class="main">⟨</span><span class="free">c</span> #<span class="hidden">⇘</span><sub>Suc <span class="free">i</span></sub><span class="hidden">⇙</span> <span class="free">t</span><span class="main">⟩</span><span class="main">)</span> <span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span><span class="free">t</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">(</span>the_enat <span class="main">(</span><span class="main">⟨</span><span class="free">c</span> #<span class="hidden">⇘</span><sub><span class="free">i</span></sub><span class="hidden">⇙</span> <span class="free">t</span><span class="main">⟩</span><span class="main">)</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> proj_nAct<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="quoted">"Suc <span class="free">i</span>"</span></span> <span class="quoted"><span class="free">t</span></span> <span class="quoted"><span class="free">c</span></span><span class="main">]</span> assms <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">…</span> <span class="main">=</span> lnth <span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span><span class="free">t</span><span class="main">)</span><span class="main">)</span> <span class="main">(</span>the_enat <span class="main">(</span><span class="main">⟨</span><span class="free">c</span> #<span class="hidden">⇘</span><sub><span class="free">i</span></sub><span class="hidden">⇙</span> <span class="free">t</span><span class="main">⟩</span><span class="main">)</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
    <span class="keyword1"><span class="command">from</span></span> assms <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">⟨</span><span class="free">c</span> #<span class="hidden">⇘</span><sub>Suc <span class="free">i</span></sub><span class="hidden">⇙</span> <span class="free">t</span><span class="main">⟩</span> <span class="main">=</span> eSuc <span class="main">(</span><span class="main">⟨</span><span class="free">c</span> #<span class="hidden">⇘</span><sub><span class="free">i</span></sub><span class="hidden">⇙</span> <span class="free">t</span><span class="main">⟩</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹enat <span class="free">i</span> <span class="main">&lt;</span> llength <span class="free">t</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">⟨</span><span class="free">c</span> #<span class="hidden">⇘</span><sub><span class="free">i</span></sub><span class="hidden">⇙</span> <span class="free">t</span><span class="main">⟩</span> <span class="main">&lt;</span> eSuc <span class="main">(</span><span class="main">⟨</span><span class="free">c</span> #<span class="hidden">⇘</span><sub><span class="free">i</span></sub><span class="hidden">⇙</span> <span class="free">t</span><span class="main">⟩</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> iless_Suc_eq<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="quoted">"the_enat <span class="main">(</span><span class="main">⟨</span><span class="free">c</span> #<span class="hidden">⇘</span><sub>enat <span class="free">i</span></sub><span class="hidden">⇙</span> <span class="free">t</span><span class="main">⟩</span><span class="main">)</span>"</span></span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">⟨</span><span class="free">c</span> #<span class="hidden">⇘</span><sub><span class="free">i</span></sub><span class="hidden">⇙</span> <span class="free">t</span><span class="main">⟩</span> <span class="main">&lt;</span> <span class="main">(</span><span class="main">⟨</span><span class="free">c</span> #<span class="hidden">⇘</span><sub>Suc <span class="free">i</span></sub><span class="hidden">⇙</span> <span class="free">t</span><span class="main">⟩</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"enat <span class="main">(</span>the_enat <span class="main">(</span><span class="main">⟨</span><span class="free">c</span> #<span class="hidden">⇘</span><sub>Suc <span class="free">i</span></sub><span class="hidden">⇙</span> <span class="free">t</span><span class="main">⟩</span><span class="main">)</span><span class="main">)</span> <span class="main">&gt;</span> enat <span class="main">(</span>the_enat <span class="main">(</span><span class="main">⟨</span><span class="free">c</span> #<span class="hidden">⇘</span><sub><span class="free">i</span></sub><span class="hidden">⇙</span> <span class="free">t</span><span class="main">⟩</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> lnth_ltake<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="quoted">"the_enat <span class="main">(</span><span class="main">⟨</span><span class="free">c</span> #<span class="hidden">⇘</span><sub><span class="free">i</span></sub><span class="hidden">⇙</span> <span class="free">t</span><span class="main">⟩</span><span class="main">)</span>"</span></span> <span class="quoted"><span class="quoted">"the_enat <span class="main">(</span><span class="main">⟨</span><span class="free">c</span> #<span class="hidden">⇘</span><sub>enat <span class="main">(</span>Suc <span class="free">i</span><span class="main">)</span></sub><span class="hidden">⇙</span> <span class="free">t</span><span class="main">⟩</span><span class="main">)</span>"</span></span> <span class="quoted"><span class="quoted">"π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span><span class="free">t</span><span class="main">)</span>"</span></span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">finally</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">..</span></span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="Configuration_Traces-nAct_eq_proj"><span class="command">lemma</span></span> nAct_eq_proj<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span><span class="main">(</span><span class="main">∃</span><span class="bound"><span class="bound">i</span></span><span class="main">≥</span><span class="free">n</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub>lnth <span class="free">t</span> <span class="bound">i</span></sub><span class="hidden">⇙</span><span class="main">)</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">⟨</span><span class="free">c</span> #<span class="hidden">⇘</span><sub><span class="free">n</span></sub><span class="hidden">⇙</span> <span class="free">t</span><span class="main">⟩</span> <span class="main">=</span> llength <span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span><span class="free">t</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">is</span></span> <span class="quoted"><span class="quoted">"<span class="var">?lhs</span> <span class="main">=</span> <span class="var">?rhs</span>"</span></span><span class="main">)</span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">from</span></span> nAct_def <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="var">?lhs</span> <span class="main">=</span> llength <span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>ltake <span class="free">n</span> <span class="free">t</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> assms <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="main">(</span><span class="bound"><span class="bound">n'</span></span><span class="main">::</span>nat<span class="main">)</span><span class="main">≤</span>llength <span class="free">t</span><span class="main">.</span> <span class="bound">n'</span><span class="main">≥</span><span class="free">n</span> <span class="main">⟶</span> <span class="main">(</span><span class="main">¬</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub>lnth <span class="free">t</span> <span class="bound">n'</span></sub><span class="hidden">⇙</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span><span class="free">t</span><span class="main">)</span> <span class="main">=</span> π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>ltake <span class="free">n</span> <span class="free">t</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> proj_ltake <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="Configuration_Traces-nAct_llength_proj"><span class="command">lemma</span></span> nAct_llength_proj<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound"><span class="bound">i</span></span><span class="main">≥</span><span class="free">n</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i</span></sub><span class="hidden">⇙</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"llength <span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>inf_llist <span class="free">t</span><span class="main">)</span><span class="main">)</span> <span class="main">≥</span> eSuc <span class="main">(</span><span class="main">⟨</span><span class="free">c</span> #<span class="hidden">⇘</span><sub><span class="free">n</span></sub><span class="hidden">⇙</span> inf_llist <span class="free">t</span><span class="main">⟩</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="main">∃</span><span class="bound"><span class="bound">i</span></span><span class="main">≥</span><span class="free">n</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i</span></sub><span class="hidden">⇙</span>›</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">i</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">i</span><span class="main">≥</span><span class="free">n</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="skolem">i</span></sub><span class="hidden">⇙</span>"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> <span class="main">(</span><span class="main">∃</span><span class="bound"><span class="bound">k</span></span><span class="main">≥</span><span class="free">n</span><span class="main">.</span> <span class="bound">k</span> <span class="main">&lt;</span> <span class="skolem">i</span> <span class="main">∧</span> <span class="bound">k</span> <span class="main">&lt;</span> llength <span class="main">(</span>inf_llist <span class="free">t</span><span class="main">)</span> <span class="main">∧</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">k</span></sub><span class="hidden">⇙</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> lActive_least<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="free">n</span></span> <span class="quoted"><span class="quoted">"inf_llist <span class="free">t</span>"</span></span> <span class="quoted"><span class="free">c</span></span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"llength <span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>inf_llist <span class="free">t</span><span class="main">)</span><span class="main">)</span> <span class="main">≥</span> <span class="main">⟨</span><span class="free">c</span> #<span class="hidden">⇘</span><sub>Suc <span class="skolem">i</span></sub><span class="hidden">⇙</span> inf_llist <span class="free">t</span><span class="main">⟩</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> nAct_le_proj <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"eSuc <span class="main">(</span><span class="main">⟨</span><span class="free">c</span> #<span class="hidden">⇘</span><sub><span class="free">n</span></sub><span class="hidden">⇙</span> inf_llist <span class="free">t</span><span class="main">⟩</span><span class="main">)</span> <span class="main">=</span> <span class="main">⟨</span><span class="free">c</span> #<span class="hidden">⇘</span><sub>Suc <span class="skolem">i</span></sub><span class="hidden">⇙</span> inf_llist <span class="free">t</span><span class="main">⟩</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"enat <span class="main">(</span>Suc <span class="skolem">i</span><span class="main">)</span> <span class="main">&lt;</span> llength <span class="main">(</span>inf_llist <span class="free">t</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">i</span> <span class="main">&lt;</span> Suc <span class="skolem">i</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="main">¬</span> <span class="main">(</span><span class="main">∃</span><span class="bound"><span class="bound">k</span></span><span class="main">≥</span><span class="free">n</span><span class="main">.</span> <span class="bound">k</span> <span class="main">&lt;</span> <span class="skolem">i</span> <span class="main">∧</span> <span class="bound">k</span> <span class="main">&lt;</span> llength <span class="main">(</span>inf_llist <span class="free">t</span><span class="main">)</span> <span class="main">∧</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">k</span></sub><span class="hidden">⇙</span><span class="main">)</span>›</span></span>
      <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">i'</span><span class="main">.</span> <span class="free">n</span> <span class="main">≤</span> <span class="bound">i'</span> <span class="main">∧</span> <span class="bound">i'</span> <span class="main">&lt;</span> Suc <span class="skolem">i</span> <span class="main">∧</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub>lnth <span class="main">(</span>inf_llist <span class="free">t</span><span class="main">)</span> <span class="bound">i'</span></sub><span class="hidden">⇙</span> <span class="main">⟶</span> <span class="bound">i'</span> <span class="main">=</span> <span class="skolem">i</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">fastforce</span>
    <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> nAct_active_suc <span class="quoted"><span class="quoted">‹<span class="skolem">i</span><span class="main">≥</span><span class="free">n</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="skolem">i</span></sub><span class="hidden">⇙</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>
  
<span class="keyword1"><span class="command">subsection</span></span> <span class="quoted"><span class="plain_text">"Least not Active"</span></span>
<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹
  In the following, we introduce an operator to obtain the least point in time before a certain point in time where a component was deactivated.
›</span></span>

<span class="keyword1"><span class="command">definition</span></span> <span class="entity">lNAct</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'id</span> <span class="main">⇒</span> <span class="main">(</span>nat <span class="main">⇒</span> cnf<span class="main">)</span> <span class="main">⇒</span> nat <span class="main">⇒</span> nat"</span></span> <span class="main">(</span><span class="quoted">"<span class="keyword1">⟨</span>_ <span class="keyword1">⇐</span> _<span class="keyword1">⟩⇘</span>_<span class="keyword1">⇙</span>"</span><span class="main">)</span>
  <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="main"><span class="free">⟨</span></span><span class="free"><span class="bound"><span class="entity">c</span></span></span> <span class="main"><span class="free">⇐</span></span> <span class="free"><span class="bound"><span class="entity">t</span></span></span>⟩<span class="hidden">⇘</span><sub><span class="free"><span class="bound"><span class="entity">n</span></span></span></sub><span class="hidden">⇙</span> <span class="main">≡</span> <span class="main">(</span><span class="keyword1">LEAST</span> <span class="bound">n'</span><span class="main">.</span> <span class="free"><span class="bound"><span class="entity">n</span></span></span><span class="main">=</span><span class="bound">n'</span> <span class="main">∨</span> <span class="main">(</span><span class="bound">n'</span><span class="main">&lt;</span><span class="free"><span class="bound"><span class="entity">n</span></span></span> <span class="main">∧</span> <span class="main">(</span><span class="main">∄</span><span class="bound">k</span><span class="main">.</span> <span class="bound">k</span><span class="main">≥</span><span class="bound">n'</span> <span class="main">∧</span> <span class="bound">k</span><span class="main">&lt;</span><span class="free"><span class="bound"><span class="entity">n</span></span></span> <span class="main">∧</span> <span class="main"><span class="free">∥</span></span><span class="free"><span class="bound"><span class="entity">c</span></span></span>∥<span class="hidden">⇘</span><sub><span class="free"><span class="bound"><span class="entity">t</span></span></span> <span class="bound">k</span></sub><span class="hidden">⇙</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span>

<span class="keyword1" id="Configuration_Traces-lNact0"><span class="command">lemma</span></span> lNact0<span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span>
  <span class="quoted"><span class="quoted">"<span class="main">⟨</span><span class="free">c</span> <span class="main">⇐</span> <span class="free">t</span>⟩<span class="hidden">⇘</span><sub><span class="main">0</span></sub><span class="hidden">⇙</span> <span class="main">=</span> <span class="main">0</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> lNAct_def<span class="main">)</span>
    
<span class="keyword1" id="Configuration_Traces-lNact_least"><span class="command">lemma</span></span> lNact_least<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">n</span><span class="main">=</span><span class="free">n'</span> <span class="main">∨</span> <span class="free">n'</span><span class="main">&lt;</span><span class="free">n</span> <span class="main">∧</span> <span class="main">(</span><span class="main">∄</span><span class="bound">k</span><span class="main">.</span> <span class="bound">k</span><span class="main">≥</span><span class="free">n'</span> <span class="main">∧</span> <span class="bound">k</span><span class="main">&lt;</span><span class="free">n</span> <span class="main">∧</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">k</span></sub><span class="hidden">⇙</span><span class="main">)</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">⟨</span><span class="free">c</span> <span class="main">⇐</span> <span class="free">t</span>⟩<span class="hidden">⇘</span><sub><span class="free">n</span></sub><span class="hidden">⇙</span> <span class="main">≤</span> <span class="free">n'</span>"</span></span>
<span class="keyword1"><span class="command">using</span></span> Least_le<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="quoted">"<span class="main">λ</span><span class="bound">n'</span><span class="main">.</span> <span class="free">n</span><span class="main">=</span><span class="bound">n'</span> <span class="main">∨</span> <span class="main">(</span><span class="bound">n'</span><span class="main">&lt;</span><span class="free">n</span> <span class="main">∧</span> <span class="main">(</span><span class="main">∄</span><span class="bound">k</span><span class="main">.</span> <span class="bound">k</span><span class="main">≥</span><span class="bound">n'</span> <span class="main">∧</span> <span class="bound">k</span><span class="main">&lt;</span><span class="free">n</span> <span class="main">∧</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">k</span></sub><span class="hidden">⇙</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="quoted"><span class="free">n'</span></span><span class="main">]</span> lNAct_def <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    
<span class="keyword1" id="Configuration_Traces-lNAct_ex"><span class="command">lemma</span></span> lNAct_ex<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">⟨</span><span class="free">c</span> <span class="main">⇐</span> <span class="free">t</span>⟩<span class="hidden">⇘</span><sub><span class="free">n</span></sub><span class="hidden">⇙</span><span class="main">=</span><span class="free">n</span> <span class="main">∨</span> <span class="main">⟨</span><span class="free">c</span> <span class="main">⇐</span> <span class="free">t</span>⟩<span class="hidden">⇘</span><sub><span class="free">n</span></sub><span class="hidden">⇙</span><span class="main">&lt;</span><span class="free">n</span> <span class="main">∧</span> <span class="main">(</span><span class="main">∄</span><span class="bound">k</span><span class="main">.</span> <span class="bound">k</span><span class="main">≥</span><span class="main">⟨</span><span class="free">c</span> <span class="main">⇐</span> <span class="free">t</span>⟩<span class="hidden">⇘</span><sub><span class="free">n</span></sub><span class="hidden">⇙</span> <span class="main">∧</span> <span class="bound">k</span><span class="main">&lt;</span><span class="free">n</span> <span class="main">∧</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">k</span></sub><span class="hidden">⇙</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?P</span></span></span><span class="main">=</span><span class="quoted"><span class="quoted">"<span class="main">λ</span><span class="bound">n'</span><span class="main">.</span> <span class="free">n</span><span class="main">=</span><span class="bound">n'</span> <span class="main">∨</span> <span class="bound">n'</span><span class="main">&lt;</span><span class="free">n</span> <span class="main">∧</span> <span class="main">(</span><span class="main">∄</span><span class="bound">k</span><span class="main">.</span> <span class="bound">k</span><span class="main">≥</span><span class="bound">n'</span> <span class="main">∧</span> <span class="bound">k</span><span class="main">&lt;</span><span class="free">n</span> <span class="main">∧</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">k</span></sub><span class="hidden">⇙</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">from</span></span> lNAct_def <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">⟨</span><span class="free">c</span> <span class="main">⇐</span> <span class="free">t</span>⟩<span class="hidden">⇘</span><sub><span class="free">n</span></sub><span class="hidden">⇙</span> <span class="main">=</span> <span class="main">(</span><span class="keyword1">LEAST</span> <span class="bound">n'</span><span class="main">.</span> <span class="var">?P</span> <span class="bound">n'</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="var">?P</span> <span class="free">n</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">with</span></span> LeastI <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="var">?P</span> <span class="main">(</span><span class="keyword1">LEAST</span> <span class="bound">n'</span><span class="main">.</span> <span class="var">?P</span> <span class="bound">n'</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">.</span></span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>
    
<span class="keyword1" id="Configuration_Traces-lNact_notActive"><span class="command">lemma</span></span> lNact_notActive<span class="main">:</span>
  <span class="keyword2"><span class="keyword">fixes</span></span> <span class="free">c</span> <span class="free">t</span> <span class="free">n</span> <span class="free">k</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">k</span><span class="main">≥</span><span class="main">⟨</span><span class="free">c</span> <span class="main">⇐</span> <span class="free">t</span>⟩<span class="hidden">⇘</span><sub><span class="free">n</span></sub><span class="hidden">⇙</span>"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">k</span><span class="main">&lt;</span><span class="free">n</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span><span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="free">k</span></sub><span class="hidden">⇙</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> assms lNAct_ex leD<span class="main">)</span>
    
<span class="keyword1" id="Configuration_Traces-lNactGe"><span class="command">lemma</span></span> lNactGe<span class="main">:</span>
  <span class="keyword2"><span class="keyword">fixes</span></span> <span class="free">c</span> <span class="free">t</span> <span class="free">n</span> <span class="free">n'</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">n'</span> <span class="main">≥</span> <span class="main">⟨</span><span class="free">c</span> <span class="main">⇐</span> <span class="free">t</span>⟩<span class="hidden">⇘</span><sub><span class="free">n</span></sub><span class="hidden">⇙</span>"</span></span> 
    <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="free">n'</span></sub><span class="hidden">⇙</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">n'</span> <span class="main">≥</span> <span class="free">n</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> assms lNact_notActive leI <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>

<span class="keyword1" id="Configuration_Traces-lNactLe"><span class="command">lemma</span></span> lNactLe<span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span>
  <span class="keyword2"><span class="keyword">fixes</span></span> <span class="free">n</span> <span class="free">n'</span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">⟨</span><span class="free">c</span> <span class="main">⇐</span> <span class="free">t</span>⟩<span class="hidden">⇘</span><sub><span class="free">n</span></sub><span class="hidden">⇙</span> <span class="main">≤</span> <span class="free">n</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> lNAct_ex less_or_eq_imp_le <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
    
<span class="keyword1" id="Configuration_Traces-lNactLe_nact"><span class="command">lemma</span></span> lNactLe_nact<span class="main">:</span>
  <span class="keyword2"><span class="keyword">fixes</span></span> <span class="free">n</span> <span class="free">n'</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">n'</span><span class="main">=</span><span class="free">n</span> <span class="main">∨</span> <span class="main">(</span><span class="free">n'</span><span class="main">&lt;</span><span class="free">n</span> <span class="main">∧</span> <span class="main">(</span><span class="main">∄</span><span class="bound">k</span><span class="main">.</span> <span class="bound">k</span><span class="main">≥</span><span class="free">n'</span> <span class="main">∧</span> <span class="bound">k</span><span class="main">&lt;</span><span class="free">n</span> <span class="main">∧</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">k</span></sub><span class="hidden">⇙</span><span class="main">)</span><span class="main">)</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">⟨</span><span class="free">c</span> <span class="main">⇐</span> <span class="free">t</span>⟩<span class="hidden">⇘</span><sub><span class="free">n</span></sub><span class="hidden">⇙</span> <span class="main">≤</span> <span class="free">n'</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> assms lNAct_def Least_le<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="quoted">"<span class="main">λ</span><span class="bound">n'</span><span class="main">.</span> <span class="free">n</span><span class="main">=</span><span class="bound">n'</span> <span class="main">∨</span> <span class="main">(</span><span class="bound">n'</span><span class="main">&lt;</span><span class="free">n</span> <span class="main">∧</span> <span class="main">(</span><span class="main">∄</span><span class="bound">k</span><span class="main">.</span> <span class="bound">k</span><span class="main">≥</span><span class="bound">n'</span> <span class="main">∧</span> <span class="bound">k</span><span class="main">&lt;</span><span class="free">n</span> <span class="main">∧</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">k</span></sub><span class="hidden">⇙</span><span class="main">)</span><span class="main">)</span>"</span></span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    
<span class="keyword1" id="Configuration_Traces-lNact_active"><span class="command">lemma</span></span> lNact_active<span class="main">:</span>
  <span class="keyword2"><span class="keyword">fixes</span></span> <span class="free">cid</span> <span class="free">t</span> <span class="free">n</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound"><span class="bound">k</span></span><span class="main">&lt;</span><span class="free">n</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">cid</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">k</span></sub><span class="hidden">⇙</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">⟨</span><span class="free">cid</span> <span class="main">⇐</span> <span class="free">t</span>⟩<span class="hidden">⇘</span><sub><span class="free">n</span></sub><span class="hidden">⇙</span> <span class="main">=</span> <span class="free">n</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> assms lNAct_ex <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
    
<span class="keyword1" id="Configuration_Traces-nAct_mono_back"><span class="command">lemma</span></span> nAct_mono_back<span class="main">:</span>
  <span class="keyword2"><span class="keyword">fixes</span></span> <span class="free">c</span> <span class="free">t</span> <span class="keyword2"><span class="keyword">and</span></span> <span class="free">n</span> <span class="keyword2"><span class="keyword">and</span></span> <span class="free">n'</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="main">⟨</span><span class="free">c</span> #<span class="hidden">⇘</span><sub><span class="free">n'</span></sub><span class="hidden">⇙</span> inf_llist <span class="free">t</span><span class="main">⟩</span> <span class="main">≥</span> <span class="main">⟨</span><span class="free">c</span> #<span class="hidden">⇘</span><sub><span class="free">n</span></sub><span class="hidden">⇙</span> inf_llist <span class="free">t</span><span class="main">⟩</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">n'</span><span class="main">≥</span><span class="main">⟨</span><span class="free">c</span> <span class="main">⇐</span> <span class="free">t</span>⟩<span class="hidden">⇘</span><sub><span class="free">n</span></sub><span class="hidden">⇙</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">cases</span>
  <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">⟨</span><span class="free">c</span> #<span class="hidden">⇘</span><sub><span class="free">n'</span></sub><span class="hidden">⇙</span> inf_llist <span class="free">t</span><span class="main">⟩</span> <span class="main">=</span> <span class="main">⟨</span><span class="free">c</span> #<span class="hidden">⇘</span><sub><span class="free">n</span></sub><span class="hidden">⇙</span> inf_llist <span class="free">t</span><span class="main">⟩</span>"</span></span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="operator">cases</span>
    <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="free">n'</span><span class="main">≥</span><span class="free">n</span>"</span></span>
    <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> lNactLe <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> <span class="dynamic"><span class="dynamic">HOL.no_atp</span></span><span class="main"><span class="main">(</span></span>11<span class="main"><span class="main">)</span></span><span class="main">)</span>
  <span class="keyword1"><span class="command">next</span></span>
    <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> <span class="free">n'</span><span class="main">≥</span><span class="free">n</span>"</span></span>
    <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="free">n'</span><span class="main">&lt;</span><span class="free">n</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">with</span></span> <span class="quoted"><span class="quoted">‹<span class="main">⟨</span><span class="free">c</span> #<span class="hidden">⇘</span><sub><span class="free">n'</span></sub><span class="hidden">⇙</span> inf_llist <span class="free">t</span><span class="main">⟩</span> <span class="main">=</span> <span class="main">⟨</span><span class="free">c</span> #<span class="hidden">⇘</span><sub><span class="free">n</span></sub><span class="hidden">⇙</span> inf_llist <span class="free">t</span><span class="main">⟩</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">∄</span><span class="bound">k</span><span class="main">.</span> <span class="bound">k</span><span class="main">≥</span><span class="free">n'</span> <span class="main">∧</span> <span class="bound">k</span><span class="main">&lt;</span><span class="free">n</span> <span class="main">∧</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">k</span></sub><span class="hidden">⇙</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> enat_ord_simps<span class="main"><span class="main">(</span></span>1<span class="main"><span class="main">)</span></span> enat_ord_simps<span class="main"><span class="main">(</span></span>2<span class="main"><span class="main">)</span></span> nAct_same_not_active<span class="main">)</span>
    <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> lNactLe_nact <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> <span class="quoted"><span class="quoted">‹<span class="free">n'</span> <span class="main">&lt;</span> <span class="free">n</span>›</span></span><span class="main">)</span>
  <span class="keyword1"><span class="command">qed</span></span>
<span class="keyword1"><span class="command">next</span></span>
  <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span><span class="main">⟨</span><span class="free">c</span> #<span class="hidden">⇘</span><sub><span class="free">n'</span></sub><span class="hidden">⇙</span> inf_llist <span class="free">t</span><span class="main">⟩</span> <span class="main">=</span> <span class="main">⟨</span><span class="free">c</span> #<span class="hidden">⇘</span><sub><span class="free">n</span></sub><span class="hidden">⇙</span> inf_llist <span class="free">t</span><span class="main">⟩</span>"</span></span>
  <span class="keyword1"><span class="command">with</span></span> assms <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">⟨</span><span class="free">c</span> #<span class="hidden">⇘</span><sub>enat <span class="free">n'</span></sub><span class="hidden">⇙</span> inf_llist <span class="free">t</span><span class="main">⟩</span> <span class="main">&gt;</span> <span class="main">⟨</span><span class="free">c</span> #<span class="hidden">⇘</span><sub>enat <span class="free">n</span></sub><span class="hidden">⇙</span> inf_llist <span class="free">t</span><span class="main">⟩</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="free">n'</span> <span class="main">&gt;</span> <span class="free">n</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> nAct_strict_mono_back<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="free">c</span></span> <span class="quoted"><span class="quoted">"enat <span class="free">n</span>"</span></span> <span class="quoted"><span class="quoted">"inf_llist <span class="free">t</span>"</span></span> <span class="quoted"><span class="quoted">"enat <span class="free">n'</span>"</span></span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">meson</span> dual_order.strict_implies_order lNactLe le_trans<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>
  
<span class="keyword1" id="Configuration_Traces-nAct_mono_lNact"><span class="command">lemma</span></span> nAct_mono_lNact<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="main">⟨</span><span class="free">c</span> <span class="main">⇐</span> <span class="free">t</span>⟩<span class="hidden">⇘</span><sub><span class="free">n</span></sub><span class="hidden">⇙</span> <span class="main">≤</span> <span class="free">n'</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">⟨</span><span class="free">c</span> #<span class="hidden">⇘</span><sub><span class="free">n</span></sub><span class="hidden">⇙</span> inf_llist <span class="free">t</span><span class="main">⟩</span> <span class="main">≤</span> <span class="main">⟨</span><span class="free">c</span> #<span class="hidden">⇘</span><sub><span class="free">n'</span></sub><span class="hidden">⇙</span> inf_llist <span class="free">t</span><span class="main">⟩</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">∄</span><span class="bound">k</span><span class="main">.</span> <span class="bound">k</span><span class="main">≥</span><span class="main">⟨</span><span class="free">c</span> <span class="main">⇐</span> <span class="free">t</span>⟩<span class="hidden">⇘</span><sub><span class="free">n</span></sub><span class="hidden">⇙</span> <span class="main">∧</span> <span class="bound">k</span><span class="main">&lt;</span><span class="free">n</span> <span class="main">∧</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">k</span></sub><span class="hidden">⇙</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> lNact_notActive <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"enat <span class="free">n</span> <span class="main">-</span> <span class="main">1</span> <span class="main">&lt;</span> llength <span class="main">(</span>inf_llist <span class="free">t</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> one_enat_def<span class="main">)</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="main">⟨</span><span class="free">c</span> <span class="main">⇐</span> <span class="free">t</span>⟩<span class="hidden">⇘</span><sub><span class="free">n</span></sub><span class="hidden">⇙</span> <span class="main">≤</span> <span class="free">n'</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"enat <span class="main">⟨</span><span class="free">c</span> <span class="main">⇐</span> <span class="free">t</span>⟩<span class="hidden">⇘</span><sub><span class="free">n</span></sub><span class="hidden">⇙</span> <span class="main">≤</span> enat <span class="free">n</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">⟨</span><span class="free">c</span> #<span class="hidden">⇘</span><sub><span class="free">n</span></sub><span class="hidden">⇙</span> inf_llist <span class="free">t</span><span class="main">⟩</span><span class="main">=</span><span class="main">⟨</span><span class="free">c</span> #<span class="hidden">⇘</span><sub><span class="main">⟨</span><span class="free">c</span> <span class="main">⇐</span> <span class="free">t</span>⟩<span class="hidden">⇘</span><sub><span class="free">n</span></sub><span class="hidden">⇙</span></sub><span class="hidden">⇙</span> inf_llist <span class="free">t</span><span class="main">⟩</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> nAct_not_active_same <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> nAct_mono assms <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>
 
<span class="keyword1"><span class="command">subsection</span></span> <span class="quoted"><span class="plain_text">"Next Active"</span></span>
<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹
  In the following, we introduce an operator to obtain the next point in time when a component is activated.
›</span></span>
  
<span class="keyword1"><span class="command">definition</span></span> <span class="entity">nxtAct</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'id</span> <span class="main">⇒</span> <span class="main">(</span>nat <span class="main">⇒</span> cnf<span class="main">)</span> <span class="main">⇒</span> nat <span class="main">⇒</span> nat"</span></span> <span class="main">(</span><span class="quoted">"<span class="keyword1">⟨</span>_ <span class="keyword1">→</span> _<span class="keyword1">⟩⇘</span>_<span class="keyword1">⇙</span>"</span><span class="main">)</span>
  <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="main"><span class="free">⟨</span></span><span class="free"><span class="bound"><span class="entity">c</span></span></span> <span class="main"><span class="free">→</span></span> <span class="free"><span class="bound"><span class="entity">t</span></span></span>⟩<span class="hidden">⇘</span><sub><span class="free"><span class="bound"><span class="entity">n</span></span></span></sub><span class="hidden">⇙</span> <span class="main">≡</span> <span class="main">(</span><span class="keyword1">THE</span> <span class="bound">n'</span><span class="main">.</span> <span class="bound">n'</span><span class="main">≥</span><span class="free"><span class="bound"><span class="entity">n</span></span></span> <span class="main">∧</span> <span class="main"><span class="free">∥</span></span><span class="free"><span class="bound"><span class="entity">c</span></span></span>∥<span class="hidden">⇘</span><sub><span class="free"><span class="bound"><span class="entity">t</span></span></span> <span class="bound">n'</span></sub><span class="hidden">⇙</span> <span class="main">∧</span> <span class="main">(</span><span class="main">∄</span><span class="bound">k</span><span class="main">.</span> <span class="bound">k</span><span class="main">≥</span><span class="free"><span class="bound"><span class="entity">n</span></span></span> <span class="main">∧</span> <span class="bound">k</span><span class="main">&lt;</span><span class="bound">n'</span> <span class="main">∧</span> <span class="main"><span class="free">∥</span></span><span class="free"><span class="bound"><span class="entity">c</span></span></span>∥<span class="hidden">⇘</span><sub><span class="free"><span class="bound"><span class="entity">t</span></span></span> <span class="bound">k</span></sub><span class="hidden">⇙</span><span class="main">)</span><span class="main">)</span>"</span></span>

<span class="keyword1" id="Configuration_Traces-nxtActI"><span class="command">lemma</span></span> nxtActI<span class="main">:</span>
  <span class="keyword2"><span class="keyword">fixes</span></span> <span class="free">n</span><span class="main">::</span><span class="quoted">nat</span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="free">t</span><span class="main">::</span><span class="quoted"><span class="quoted">"nat <span class="main">⇒</span> cnf"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="free">c</span><span class="main">::</span><span class="tfree"><span class="quoted"><span class="tfree">'id</span></span></span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound"><span class="bound">i</span></span><span class="main">≥</span><span class="free">n</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i</span></sub><span class="hidden">⇙</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">⟨</span><span class="free">c</span> <span class="main">→</span> <span class="free">t</span>⟩<span class="hidden">⇘</span><sub><span class="free">n</span></sub><span class="hidden">⇙</span> <span class="main">≥</span> <span class="free">n</span> <span class="main">∧</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="main">⟨</span><span class="free">c</span> <span class="main">→</span> <span class="free">t</span>⟩<span class="hidden">⇘</span><sub><span class="free">n</span></sub><span class="hidden">⇙</span></sub><span class="hidden">⇙</span> <span class="main">∧</span> <span class="main">(</span><span class="main">∄</span><span class="bound">k</span><span class="main">.</span> <span class="bound">k</span><span class="main">≥</span><span class="free">n</span> <span class="main">∧</span> <span class="bound">k</span><span class="main">&lt;</span><span class="main">⟨</span><span class="free">c</span> <span class="main">→</span> <span class="free">t</span>⟩<span class="hidden">⇘</span><sub><span class="free">n</span></sub><span class="hidden">⇙</span> <span class="main">∧</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">k</span></sub><span class="hidden">⇙</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?P</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"<span class="keyword1">THE</span> <span class="bound">n'</span><span class="main">.</span> <span class="bound">n'</span><span class="main">≥</span><span class="free">n</span> <span class="main">∧</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">n'</span></sub><span class="hidden">⇙</span> <span class="main">∧</span> <span class="main">(</span><span class="main">∄</span><span class="bound">k</span><span class="main">.</span> <span class="bound">k</span><span class="main">≥</span><span class="free">n</span> <span class="main">∧</span> <span class="bound">k</span><span class="main">&lt;</span><span class="bound">n'</span> <span class="main">∧</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">k</span></sub><span class="hidden">⇙</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">from</span></span> assms <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">i</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">i</span><span class="main">≥</span><span class="free">n</span> <span class="main">∧</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="skolem">i</span></sub><span class="hidden">⇙</span> <span class="main">∧</span> <span class="main">(</span><span class="main">∄</span><span class="bound">k</span><span class="main">.</span> <span class="bound">k</span><span class="main">≥</span><span class="free">n</span> <span class="main">∧</span> <span class="bound">k</span><span class="main">&lt;</span><span class="skolem">i</span> <span class="main">∧</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">k</span></sub><span class="hidden">⇙</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> lActive_least<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="free">n</span></span> <span class="quoted"><span class="quoted">"inf_llist <span class="free">t</span>"</span></span> <span class="quoted"><span class="free">c</span></span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">⋀</span><span class="bound">x</span><span class="main">.</span> <span class="free">n</span> <span class="main">≤</span> <span class="bound">x</span> <span class="main">∧</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">x</span></sub><span class="hidden">⇙</span> <span class="main">∧</span> <span class="main">¬</span> <span class="main">(</span><span class="main">∃</span><span class="bound"><span class="bound">k</span></span><span class="main">≥</span><span class="free">n</span><span class="main">.</span> <span class="bound">k</span> <span class="main">&lt;</span> <span class="bound">x</span> <span class="main">∧</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">k</span></sub><span class="hidden">⇙</span><span class="main">)</span> <span class="main">⟹</span> <span class="bound">x</span> <span class="main">=</span> <span class="skolem">i</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
    <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">x</span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="free">n</span> <span class="main">≤</span> <span class="skolem">x</span> <span class="main">∧</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="skolem">x</span></sub><span class="hidden">⇙</span> <span class="main">∧</span> <span class="main">¬</span> <span class="main">(</span><span class="main">∃</span><span class="bound"><span class="bound">k</span></span><span class="main">≥</span><span class="free">n</span><span class="main">.</span> <span class="bound">k</span> <span class="main">&lt;</span> <span class="skolem">x</span> <span class="main">∧</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">k</span></sub><span class="hidden">⇙</span><span class="main">)</span>"</span></span>
    <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">=</span> <span class="skolem">i</span>"</span></span>
    <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">rule</span> ccontr<span class="main">)</span>
      <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> <span class="main">(</span><span class="skolem">x</span> <span class="main">=</span> <span class="skolem">i</span><span class="main">)</span>"</span></span>
      <span class="keyword3"><span class="command">thus</span></span> <span class="quoted">False</span> <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">i</span><span class="main">≥</span><span class="free">n</span> <span class="main">∧</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="skolem">i</span></sub><span class="hidden">⇙</span> <span class="main">∧</span> <span class="main">(</span><span class="main">∄</span><span class="bound">k</span><span class="main">.</span> <span class="bound">k</span><span class="main">≥</span><span class="free">n</span> <span class="main">∧</span> <span class="bound">k</span><span class="main">&lt;</span><span class="skolem">i</span> <span class="main">∧</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">k</span></sub><span class="hidden">⇙</span><span class="main">)</span>›</span></span>
        <span class="quoted"><span class="quoted">‹<span class="free">n</span> <span class="main">≤</span> <span class="skolem">x</span> <span class="main">∧</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="skolem">x</span></sub><span class="hidden">⇙</span> <span class="main">∧</span> <span class="main">¬</span> <span class="main">(</span><span class="main">∃</span><span class="bound"><span class="bound">k</span></span><span class="main">≥</span><span class="free">n</span><span class="main">.</span> <span class="bound">k</span> <span class="main">&lt;</span> <span class="skolem">x</span> <span class="main">∧</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">k</span></sub><span class="hidden">⇙</span><span class="main">)</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">fastforce</span>
    <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="var">?P</span><span class="main">)</span> <span class="main">≥</span> <span class="free">n</span> <span class="main">∧</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="main">(</span><span class="var">?P</span><span class="main">)</span></sub><span class="hidden">⇙</span> <span class="main">∧</span> <span class="main">(</span><span class="main">∄</span><span class="bound">k</span><span class="main">.</span> <span class="bound">k</span><span class="main">≥</span><span class="free">n</span> <span class="main">∧</span> <span class="bound">k</span><span class="main">&lt;</span><span class="var">?P</span> <span class="main">∧</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">k</span></sub><span class="hidden">⇙</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> theI<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="quoted">"<span class="main">λ</span><span class="bound">n'</span><span class="main">.</span> <span class="bound">n'</span><span class="main">≥</span><span class="free">n</span> <span class="main">∧</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">n'</span></sub><span class="hidden">⇙</span> <span class="main">∧</span> <span class="main">(</span><span class="main">∄</span><span class="bound">k</span><span class="main">.</span> <span class="bound">k</span><span class="main">≥</span><span class="free">n</span> <span class="main">∧</span> <span class="bound">k</span><span class="main">&lt;</span><span class="bound">n'</span> <span class="main">∧</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">k</span></sub><span class="hidden">⇙</span><span class="main">)</span>"</span></span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> nxtAct_def<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="free">c</span></span> <span class="quoted"><span class="free">t</span></span> <span class="quoted"><span class="free">n</span></span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">metis</span>
<span class="keyword1"><span class="command">qed</span></span>
  
<span class="keyword1" id="Configuration_Traces-nxtActLe"><span class="command">lemma</span></span> nxtActLe<span class="main">:</span>
  <span class="keyword2"><span class="keyword">fixes</span></span> <span class="free">n</span> <span class="free">n'</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound"><span class="bound">i</span></span><span class="main">≥</span><span class="free">n</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i</span></sub><span class="hidden">⇙</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">n</span> <span class="main">≤</span> <span class="main">⟨</span><span class="free">c</span> <span class="main">→</span> <span class="free">t</span>⟩<span class="hidden">⇘</span><sub><span class="free">n</span></sub><span class="hidden">⇙</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> assms nxtActI<span class="main">)</span>

<span class="keyword1" id="Configuration_Traces-nxtAct_eq"><span class="command">lemma</span></span> nxtAct_eq<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">n'</span><span class="main">≥</span><span class="free">n</span>"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="free">n'</span></sub><span class="hidden">⇙</span>"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound"><span class="bound">n''</span></span><span class="main">≥</span><span class="free">n</span><span class="main">.</span> <span class="bound">n''</span><span class="main">&lt;</span><span class="free">n'</span> <span class="main">⟶</span> <span class="main">¬</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">n''</span></sub><span class="hidden">⇙</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">n'</span> <span class="main">=</span> <span class="main">⟨</span><span class="free">c</span> <span class="main">→</span> <span class="free">t</span>⟩<span class="hidden">⇘</span><sub><span class="free">n</span></sub><span class="hidden">⇙</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> assms<span class="main"><span class="main">(</span></span>1<span class="main"><span class="main">)</span></span> assms<span class="main"><span class="main">(</span></span>2<span class="main"><span class="main">)</span></span> assms<span class="main"><span class="main">(</span></span>3<span class="main"><span class="main">)</span></span> nxtActI linorder_neqE_nat nxtActLe<span class="main">)</span>

<span class="keyword1" id="Configuration_Traces-nxtAct_active"><span class="command">lemma</span></span> nxtAct_active<span class="main">:</span>
  <span class="keyword2"><span class="keyword">fixes</span></span> <span class="free">i</span><span class="main">::</span><span class="quoted">nat</span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="free">t</span><span class="main">::</span><span class="quoted"><span class="quoted">"nat <span class="main">⇒</span> cnf"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="free">c</span><span class="main">::</span><span class="tfree"><span class="quoted"><span class="tfree">'id</span></span></span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="free">i</span></sub><span class="hidden">⇙</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">⟨</span><span class="free">c</span> <span class="main">→</span> <span class="free">t</span>⟩<span class="hidden">⇘</span><sub><span class="free">i</span></sub><span class="hidden">⇙</span> <span class="main">=</span> <span class="free">i</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> assms le_eq_less_or_eq nxtActI<span class="main">)</span>
    
<span class="keyword1" id="Configuration_Traces-nxtActive_no_active"><span class="command">lemma</span></span> nxtActive_no_active<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃!</span><span class="bound">i</span><span class="main">.</span> <span class="bound">i</span><span class="main">≥</span><span class="free">n</span> <span class="main">∧</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i</span></sub><span class="hidden">⇙</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> <span class="main">(</span><span class="main">∃</span><span class="bound"><span class="bound">i'</span></span><span class="main">≥</span>Suc <span class="main">⟨</span><span class="free">c</span> <span class="main">→</span> <span class="free">t</span>⟩<span class="hidden">⇘</span><sub><span class="free">n</span></sub><span class="hidden">⇙</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i'</span></sub><span class="hidden">⇙</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span>
  <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound"><span class="bound">i'</span></span><span class="main">≥</span>Suc <span class="main">⟨</span><span class="free">c</span> <span class="main">→</span> <span class="free">t</span>⟩<span class="hidden">⇘</span><sub><span class="free">n</span></sub><span class="hidden">⇙</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i'</span></sub><span class="hidden">⇙</span>"</span></span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">i'</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">i'</span><span class="main">≥</span>Suc <span class="main">⟨</span><span class="free">c</span> <span class="main">→</span> <span class="free">t</span>⟩<span class="hidden">⇘</span><sub><span class="free">n</span></sub><span class="hidden">⇙</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="skolem">i'</span></sub><span class="hidden">⇙</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> assms<span class="main">(</span>1<span class="main">)</span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">⟨</span><span class="free">c</span> <span class="main">→</span> <span class="free">t</span>⟩<span class="hidden">⇘</span><sub><span class="free">n</span></sub><span class="hidden">⇙</span><span class="main">≥</span><span class="free">n</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> nxtActI <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">i'</span><span class="main">≥</span><span class="free">n</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="skolem">i'</span></sub><span class="hidden">⇙</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">i'</span><span class="main">≠</span><span class="main">⟨</span><span class="free">c</span> <span class="main">→</span> <span class="free">t</span>⟩<span class="hidden">⇘</span><sub><span class="free">n</span></sub><span class="hidden">⇙</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> assms<span class="main">(</span>1<span class="main">)</span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="main">⟨</span><span class="free">c</span> <span class="main">→</span> <span class="free">t</span>⟩<span class="hidden">⇘</span><sub><span class="free">n</span></sub><span class="hidden">⇙</span></sub><span class="hidden">⇙</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">⟨</span><span class="free">c</span> <span class="main">→</span> <span class="free">t</span>⟩<span class="hidden">⇘</span><sub><span class="free">n</span></sub><span class="hidden">⇙</span><span class="main">≥</span><span class="free">n</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> nxtActI <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted">False</span> <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>1<span class="main">)</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>
  
<span class="keyword1" id="Configuration_Traces-nxt_geq_lNact"><span class="command">lemma</span></span> nxt_geq_lNact<span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound"><span class="bound">i</span></span><span class="main">≥</span><span class="free">n</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i</span></sub><span class="hidden">⇙</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">⟨</span><span class="free">c</span> <span class="main">→</span> <span class="free">t</span>⟩<span class="hidden">⇘</span><sub><span class="free">n</span></sub><span class="hidden">⇙</span><span class="main">≥</span><span class="main">⟨</span><span class="free">c</span> <span class="main">⇐</span> <span class="free">t</span>⟩<span class="hidden">⇘</span><sub><span class="free">n</span></sub><span class="hidden">⇙</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">from</span></span> assms <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">n</span> <span class="main">≤</span> <span class="main">⟨</span><span class="free">c</span> <span class="main">→</span> <span class="free">t</span>⟩<span class="hidden">⇘</span><sub><span class="free">n</span></sub><span class="hidden">⇙</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> nxtActLe <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">⟨</span><span class="free">c</span> <span class="main">⇐</span> <span class="free">t</span>⟩<span class="hidden">⇘</span><sub><span class="free">n</span></sub><span class="hidden">⇙</span><span class="main">≤</span><span class="free">n</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">arith</span>
<span class="keyword1"><span class="command">qed</span></span>
  
<span class="keyword1" id="Configuration_Traces-active_geq_nxtAct"><span class="command">lemma</span></span> active_geq_nxtAct<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="free">i</span></sub><span class="hidden">⇙</span>"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"the_enat <span class="main">(</span><span class="main">⟨</span><span class="free">c</span> #<span class="hidden">⇘</span><sub><span class="free">i</span></sub><span class="hidden">⇙</span> inf_llist <span class="free">t</span><span class="main">⟩</span><span class="main">)</span><span class="main">≥</span>the_enat <span class="main">(</span><span class="main">⟨</span><span class="free">c</span> #<span class="hidden">⇘</span><sub><span class="free">n</span></sub><span class="hidden">⇙</span> inf_llist <span class="free">t</span><span class="main">⟩</span><span class="main">)</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">i</span><span class="main">≥</span><span class="main">⟨</span><span class="free">c</span> <span class="main">→</span> <span class="free">t</span>⟩<span class="hidden">⇘</span><sub><span class="free">n</span></sub><span class="hidden">⇙</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">cases</span>
  <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">⟨</span><span class="free">c</span> #<span class="hidden">⇘</span><sub><span class="free">i</span></sub><span class="hidden">⇙</span> inf_llist <span class="free">t</span><span class="main">⟩</span><span class="main">=</span><span class="main">⟨</span><span class="free">c</span> #<span class="hidden">⇘</span><sub><span class="free">n</span></sub><span class="hidden">⇙</span> inf_llist <span class="free">t</span><span class="main">⟩</span>"</span></span>
  <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">rule</span> ccontr<span class="main">)</span>
    <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> <span class="free">i</span><span class="main">≥</span><span class="main">⟨</span><span class="free">c</span> <span class="main">→</span> <span class="free">t</span>⟩<span class="hidden">⇘</span><sub><span class="free">n</span></sub><span class="hidden">⇙</span>"</span></span>
    <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="free">i</span><span class="main">&lt;</span><span class="main">⟨</span><span class="free">c</span> <span class="main">→</span> <span class="free">t</span>⟩<span class="hidden">⇘</span><sub><span class="free">n</span></sub><span class="hidden">⇙</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">with</span></span> <span class="quoted"><span class="quoted">‹<span class="main">⟨</span><span class="free">c</span> #<span class="hidden">⇘</span><sub><span class="free">i</span></sub><span class="hidden">⇙</span> inf_llist <span class="free">t</span><span class="main">⟩</span><span class="main">=</span><span class="main">⟨</span><span class="free">c</span> #<span class="hidden">⇘</span><sub><span class="free">n</span></sub><span class="hidden">⇙</span> inf_llist <span class="free">t</span><span class="main">⟩</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> <span class="main">(</span><span class="main">∃</span><span class="bound"><span class="bound">k</span></span><span class="main">≥</span><span class="free">i</span><span class="main">.</span> <span class="bound">k</span> <span class="main">&lt;</span> <span class="free">n</span> <span class="main">∧</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">k</span></sub><span class="hidden">⇙</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> enat_ord_simps<span class="main"><span class="main">(</span></span>1<span class="main"><span class="main">)</span></span> leD leI nAct_same_not_active<span class="main">)</span>
    <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> <span class="main">(</span><span class="main">∃</span><span class="bound"><span class="bound">k</span></span><span class="main">≥</span><span class="free">n</span><span class="main">.</span> <span class="bound">k</span> <span class="main">&lt;</span><span class="main">⟨</span><span class="free">c</span> <span class="main">→</span> <span class="free">t</span>⟩<span class="hidden">⇘</span><sub><span class="free">n</span></sub><span class="hidden">⇙</span> <span class="main">∧</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">k</span></sub><span class="hidden">⇙</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> nxtActI <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
    <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> <span class="main">(</span><span class="main">∃</span><span class="bound"><span class="bound">k</span></span><span class="main">≥</span><span class="free">i</span><span class="main">.</span> <span class="bound">k</span> <span class="main">&lt;</span><span class="main">⟨</span><span class="free">c</span> <span class="main">→</span> <span class="free">t</span>⟩<span class="hidden">⇘</span><sub><span class="free">n</span></sub><span class="hidden">⇙</span> <span class="main">∧</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">k</span></sub><span class="hidden">⇙</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">with</span></span> <span class="quoted"><span class="quoted">‹<span class="free">i</span><span class="main">&lt;</span><span class="main">⟨</span><span class="free">c</span> <span class="main">→</span> <span class="free">t</span>⟩<span class="hidden">⇘</span><sub><span class="free">n</span></sub><span class="hidden">⇙</span>›</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted">False</span> <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="free">i</span></sub><span class="hidden">⇙</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">qed</span></span>
<span class="keyword1"><span class="command">next</span></span>
  <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span><span class="main">⟨</span><span class="free">c</span> #<span class="hidden">⇘</span><sub><span class="free">i</span></sub><span class="hidden">⇙</span> inf_llist <span class="free">t</span><span class="main">⟩</span><span class="main">=</span><span class="main">⟨</span><span class="free">c</span> #<span class="hidden">⇘</span><sub><span class="free">n</span></sub><span class="hidden">⇙</span> inf_llist <span class="free">t</span><span class="main">⟩</span>"</span></span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹the_enat <span class="main">(</span><span class="main">⟨</span><span class="free">c</span> #<span class="hidden">⇘</span><sub><span class="free">i</span></sub><span class="hidden">⇙</span> inf_llist <span class="free">t</span><span class="main">⟩</span><span class="main">)</span><span class="main">≥</span>the_enat <span class="main">(</span><span class="main">⟨</span><span class="free">c</span> #<span class="hidden">⇘</span><sub><span class="free">n</span></sub><span class="hidden">⇙</span> inf_llist <span class="free">t</span><span class="main">⟩</span><span class="main">)</span>›</span></span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">⟨</span><span class="free">c</span> #<span class="hidden">⇘</span><sub><span class="free">i</span></sub><span class="hidden">⇙</span> inf_llist <span class="free">t</span><span class="main">⟩</span><span class="main">≥</span><span class="main">⟨</span><span class="free">c</span> #<span class="hidden">⇘</span><sub><span class="free">n</span></sub><span class="hidden">⇙</span> inf_llist <span class="free">t</span><span class="main">⟩</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> enat.distinct<span class="main"><span class="main">(</span></span>2<span class="main"><span class="main">)</span></span> enat_ord_simps<span class="main"><span class="main">(</span></span>1<span class="main"><span class="main">)</span></span> nAct_enat_the_nat<span class="main">)</span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">⟨</span><span class="free">c</span> #<span class="hidden">⇘</span><sub><span class="free">i</span></sub><span class="hidden">⇙</span> inf_llist <span class="free">t</span><span class="main">⟩</span><span class="main">&gt;</span><span class="main">⟨</span><span class="free">c</span> #<span class="hidden">⇘</span><sub><span class="free">n</span></sub><span class="hidden">⇙</span> inf_llist <span class="free">t</span><span class="main">⟩</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="free">i</span><span class="main">&gt;</span><span class="free">n</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> nAct_strict_mono_back<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="free">c</span></span> <span class="quoted"><span class="free">n</span></span> <span class="quoted"><span class="quoted">"inf_llist <span class="free">t</span>"</span></span> <span class="quoted"><span class="free">i</span></span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">with</span></span> <span class="quoted"><span class="quoted">‹<span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="free">i</span></sub><span class="hidden">⇙</span>›</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">meson</span> dual_order.strict_implies_order leI nxtActI<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="Configuration_Traces-nAct_same"><span class="command">lemma</span></span> nAct_same<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="main">⟨</span><span class="free">c</span> <span class="main">⇐</span> <span class="free">t</span>⟩<span class="hidden">⇘</span><sub><span class="free">n</span></sub><span class="hidden">⇙</span> <span class="main">≤</span> <span class="free">n'</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">n'</span> <span class="main">≤</span> <span class="main">⟨</span><span class="free">c</span> <span class="main">→</span> <span class="free">t</span>⟩<span class="hidden">⇘</span><sub><span class="free">n</span></sub><span class="hidden">⇙</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"the_enat <span class="main">(</span><span class="main">⟨</span><span class="free">c</span> #<span class="hidden">⇘</span><sub>enat <span class="free">n'</span></sub><span class="hidden">⇙</span> inf_llist <span class="free">t</span><span class="main">⟩</span><span class="main">)</span> <span class="main">=</span> the_enat <span class="main">(</span><span class="main">⟨</span><span class="free">c</span> #<span class="hidden">⇘</span><sub>enat <span class="free">n</span></sub><span class="hidden">⇙</span> inf_llist <span class="free">t</span><span class="main">⟩</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">cases</span>
  <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="free">n</span> <span class="main">≤</span> <span class="free">n'</span>"</span></span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">n'</span> <span class="main">-</span> <span class="main">1</span> <span class="main">&lt;</span> llength <span class="main">(</span>inf_llist <span class="free">t</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> <span class="main">(</span><span class="main">∃</span><span class="bound"><span class="bound">i</span></span><span class="main">≥</span><span class="free">n</span><span class="main">.</span> <span class="bound">i</span> <span class="main">&lt;</span><span class="free">n'</span> <span class="main">∧</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i</span></sub><span class="hidden">⇙</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">meson</span> assms<span class="main"><span class="main">(</span></span>2<span class="main"><span class="main">)</span></span> less_le_trans nxtActI<span class="main">)</span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> nAct_not_active_same <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> one_enat_def<span class="main">)</span>
<span class="keyword1"><span class="command">next</span></span>
  <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> <span class="free">n</span> <span class="main">≤</span> <span class="free">n'</span>"</span></span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="free">n'</span> <span class="main">&lt;</span> <span class="free">n</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">n</span> <span class="main">-</span> <span class="main">1</span> <span class="main">&lt;</span> llength <span class="main">(</span>inf_llist <span class="free">t</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> <span class="main">(</span><span class="main">∃</span><span class="bound"><span class="bound">i</span></span><span class="main">≥</span><span class="free">n'</span><span class="main">.</span> <span class="bound">i</span> <span class="main">&lt;</span> <span class="free">n</span> <span class="main">∧</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i</span></sub><span class="hidden">⇙</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> <span class="quoted"><span class="quoted">‹<span class="main">¬</span> <span class="free">n</span> <span class="main">≤</span> <span class="free">n'</span>›</span></span> assms<span class="main"><span class="main">(</span></span>1<span class="main"><span class="main">)</span></span> dual_order.trans lNAct_ex<span class="main">)</span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> nAct_not_active_same<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="free">n'</span></span> <span class="quoted"><span class="free">n</span></span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> one_enat_def<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>
  
<span class="keyword1" id="Configuration_Traces-nAct_mono_nxtAct"><span class="command">lemma</span></span> nAct_mono_nxtAct<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound"><span class="bound">i</span></span><span class="main">≥</span><span class="free">n</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i</span></sub><span class="hidden">⇙</span>"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">⟨</span><span class="free">c</span> <span class="main">→</span> <span class="free">t</span>⟩<span class="hidden">⇘</span><sub><span class="free">n</span></sub><span class="hidden">⇙</span> <span class="main">≤</span> <span class="free">n'</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">⟨</span><span class="free">c</span> #<span class="hidden">⇘</span><sub><span class="free">n</span></sub><span class="hidden">⇙</span> inf_llist <span class="free">t</span><span class="main">⟩</span> <span class="main">≤</span> <span class="main">⟨</span><span class="free">c</span> #<span class="hidden">⇘</span><sub><span class="free">n'</span></sub><span class="hidden">⇙</span> inf_llist <span class="free">t</span><span class="main">⟩</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">from</span></span> assms <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">⟨</span><span class="free">c</span> #<span class="hidden">⇘</span><sub><span class="main">⟨</span><span class="free">c</span> <span class="main">→</span> <span class="free">t</span>⟩<span class="hidden">⇘</span><sub><span class="free">n</span></sub><span class="hidden">⇙</span></sub><span class="hidden">⇙</span> inf_llist <span class="free">t</span><span class="main">⟩</span> <span class="main">≤</span> <span class="main">⟨</span><span class="free">c</span> #<span class="hidden">⇘</span><sub><span class="free">n'</span></sub><span class="hidden">⇙</span> inf_llist <span class="free">t</span><span class="main">⟩</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> nAct_mono assms <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">⟨</span><span class="free">c</span> #<span class="hidden">⇘</span><sub><span class="main">⟨</span><span class="free">c</span> <span class="main">→</span> <span class="free">t</span>⟩<span class="hidden">⇘</span><sub><span class="free">n</span></sub><span class="hidden">⇙</span></sub><span class="hidden">⇙</span> inf_llist <span class="free">t</span><span class="main">⟩</span><span class="main">=</span><span class="main">⟨</span><span class="free">c</span> #<span class="hidden">⇘</span><sub><span class="free">n</span></sub><span class="hidden">⇙</span> inf_llist <span class="free">t</span><span class="main">⟩</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
    <span class="keyword1"><span class="command">from</span></span> assms <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">∄</span><span class="bound">k</span><span class="main">.</span> <span class="bound">k</span><span class="main">≥</span><span class="free">n</span> <span class="main">∧</span> <span class="bound">k</span><span class="main">&lt;</span><span class="main">⟨</span><span class="free">c</span> <span class="main">→</span> <span class="free">t</span>⟩<span class="hidden">⇘</span><sub><span class="free">n</span></sub><span class="hidden">⇙</span> <span class="main">∧</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">k</span></sub><span class="hidden">⇙</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">n</span> <span class="main">≤</span> <span class="main">⟨</span><span class="free">c</span> <span class="main">→</span> <span class="free">t</span>⟩<span class="hidden">⇘</span><sub><span class="free">n</span></sub><span class="hidden">⇙</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> nxtActI <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"enat <span class="main">⟨</span><span class="free">c</span> <span class="main">→</span> <span class="free">t</span>⟩<span class="hidden">⇘</span><sub><span class="free">n</span></sub><span class="hidden">⇙</span> <span class="main">-</span> <span class="main">1</span> <span class="main">&lt;</span> llength <span class="main">(</span>inf_llist <span class="free">t</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> one_enat_def<span class="main">)</span>
    <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> nAct_not_active_same<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="free">n</span></span> <span class="quoted"><span class="quoted">"<span class="main">⟨</span><span class="free">c</span> <span class="main">→</span> <span class="free">t</span>⟩<span class="hidden">⇘</span><sub><span class="free">n</span></sub><span class="hidden">⇙</span>"</span></span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">subsection</span></span> <span class="quoted"><span class="plain_text">"Latest Activation"</span></span>
<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹
  In the following, we introduce an operator to obtain the latest point in time when a component is activated.
›</span></span>

<span class="keyword1"><span class="command">abbreviation</span></span> <span class="entity">latestAct_cond</span><span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'id</span> <span class="main">⇒</span> trace <span class="main">⇒</span> nat <span class="main">⇒</span> nat <span class="main">⇒</span> bool"</span></span>
  <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="free">latestAct_cond</span> <span class="free"><span class="bound"><span class="entity">c</span></span></span> <span class="free"><span class="bound"><span class="entity">t</span></span></span> <span class="free"><span class="bound"><span class="entity">n</span></span></span> <span class="free"><span class="bound"><span class="entity">n'</span></span></span> <span class="main">≡</span> <span class="free"><span class="bound"><span class="entity">n'</span></span></span><span class="main">&lt;</span><span class="free"><span class="bound"><span class="entity">n</span></span></span> <span class="main">∧</span> <span class="main"><span class="free">∥</span></span><span class="free"><span class="bound"><span class="entity">c</span></span></span>∥<span class="hidden">⇘</span><sub><span class="free"><span class="bound"><span class="entity">t</span></span></span> <span class="free"><span class="bound"><span class="entity">n'</span></span></span></sub><span class="hidden">⇙</span>"</span></span>

<span class="keyword1"><span class="command">definition</span></span> <span class="entity">latestAct</span><span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'id</span> <span class="main">⇒</span> trace <span class="main">⇒</span> nat <span class="main">⇒</span> nat"</span></span> <span class="main">(</span><span class="quoted">"<span class="keyword1">⟨</span>_ <span class="keyword1">←</span> _<span class="keyword1">⟩⇘</span>_<span class="keyword1">⇙</span>"</span><span class="main">)</span>
  <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="free">latestAct</span> <span class="free"><span class="bound"><span class="entity">c</span></span></span> <span class="free"><span class="bound"><span class="entity">t</span></span></span> <span class="free"><span class="bound"><span class="entity">n</span></span></span> <span class="main">=</span> <span class="main">(</span><span class="keyword1">GREATEST</span> <span class="bound">n'</span><span class="main">.</span> latestAct_cond <span class="free"><span class="bound"><span class="entity">c</span></span></span> <span class="free"><span class="bound"><span class="entity">t</span></span></span> <span class="free"><span class="bound"><span class="entity">n</span></span></span> <span class="bound">n'</span><span class="main">)</span>"</span></span>

<span class="keyword1" id="Configuration_Traces-latestActEx"><span class="command">lemma</span></span> latestActEx<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound"><span class="bound">n'</span></span><span class="main">&lt;</span><span class="free">n</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">nid</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">n'</span></sub><span class="hidden">⇙</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound">n'</span><span class="main">.</span> latestAct_cond <span class="free">nid</span> <span class="free">t</span> <span class="free">n</span> <span class="bound">n'</span> <span class="main">∧</span> <span class="main">(</span><span class="main">∀</span><span class="bound">n''</span><span class="main">.</span> latestAct_cond <span class="free">nid</span> <span class="free">t</span> <span class="free">n</span> <span class="bound">n''</span> <span class="main">⟶</span> <span class="bound">n''</span> <span class="main">≤</span> <span class="bound">n'</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">from</span></span> assms <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">n'</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"latestAct_cond <span class="free">nid</span> <span class="free">t</span> <span class="free">n</span> <span class="skolem">n'</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound"><span class="bound">n''</span></span><span class="main">&gt;</span><span class="free">n</span><span class="main">.</span> <span class="main">¬</span> latestAct_cond <span class="free">nid</span> <span class="free">t</span> <span class="free">n</span> <span class="bound">n''</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">n'</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"latestAct_cond <span class="free">nid</span> <span class="free">t</span> <span class="free">n</span> <span class="skolem">n'</span> <span class="main">∧</span> <span class="main">(</span><span class="main">∀</span><span class="bound">n''</span><span class="main">.</span> latestAct_cond <span class="free">nid</span> <span class="free">t</span> <span class="free">n</span> <span class="bound">n''</span> <span class="main">⟶</span> <span class="bound">n''</span> <span class="main">≤</span> <span class="skolem">n'</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> boundedGreatest<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="quoted">"latestAct_cond <span class="free">nid</span> <span class="free">t</span> <span class="free">n</span>"</span></span> <span class="quoted"><span class="skolem">n'</span></span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">..</span></span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="Configuration_Traces-latestAct_prop"><span class="command">lemma</span></span> latestAct_prop<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound"><span class="bound">n'</span></span><span class="main">&lt;</span><span class="free">n</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">nid</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">n'</span></sub><span class="hidden">⇙</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main"><span class="free">∥</span></span><span class="free">nid</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="main">(</span>latestAct <span class="free">nid</span> <span class="free">t</span> <span class="free">n</span><span class="main">)</span></sub><span class="hidden">⇙</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"latestAct <span class="free">nid</span> <span class="free">t</span> <span class="free">n</span><span class="main">&lt;</span><span class="free">n</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">from</span></span> assms latestActEx <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"latestAct_cond <span class="free">nid</span> <span class="free">t</span> <span class="free">n</span> <span class="main">(</span><span class="keyword1">GREATEST</span> <span class="bound">x</span><span class="main">.</span> latestAct_cond <span class="free">nid</span> <span class="free">t</span> <span class="free">n</span> <span class="bound">x</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> GreatestI_ex_nat<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="quoted">"latestAct_cond <span class="free">nid</span> <span class="free">t</span> <span class="free">n</span>"</span></span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"<span class="main"><span class="free">∥</span></span><span class="free">nid</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="main">⟨</span><span class="free">nid</span> <span class="main">←</span> <span class="free">t</span>⟩<span class="hidden">⇘</span><sub><span class="free">n</span></sub><span class="hidden">⇙</span></sub><span class="hidden">⇙</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"latestAct <span class="free">nid</span> <span class="free">t</span> <span class="free">n</span><span class="main">&lt;</span><span class="free">n</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> latestAct_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="Configuration_Traces-latestAct_less"><span class="command">lemma</span></span> latestAct_less<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"latestAct_cond <span class="free">nid</span> <span class="free">t</span> <span class="free">n</span> <span class="free">n'</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">n'</span> <span class="main">≤</span> <span class="main">⟨</span><span class="free">nid</span> <span class="main">←</span> <span class="free">t</span>⟩<span class="hidden">⇘</span><sub><span class="free">n</span></sub><span class="hidden">⇙</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">from</span></span> assms latestActEx <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">n'</span> <span class="main">≤</span> <span class="main">(</span><span class="keyword1">GREATEST</span> <span class="bound">x</span><span class="main">.</span> latestAct_cond <span class="free">nid</span> <span class="free">t</span> <span class="free">n</span> <span class="bound">x</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> Greatest_le_nat<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="quoted">"latestAct_cond <span class="free">nid</span> <span class="free">t</span> <span class="free">n</span>"</span></span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> latestAct_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="Configuration_Traces-latestActNxt"><span class="command">lemma</span></span> latestActNxt<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound"><span class="bound">n'</span></span><span class="main">&lt;</span><span class="free">n</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">nid</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">n'</span></sub><span class="hidden">⇙</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">⟨</span><span class="free">nid</span> <span class="main">→</span> <span class="free">t</span>⟩<span class="hidden">⇘</span><sub><span class="main">⟨</span><span class="free">nid</span> <span class="main">←</span> <span class="free">t</span>⟩<span class="hidden">⇘</span><sub><span class="free">n</span></sub><span class="hidden">⇙</span></sub><span class="hidden">⇙</span><span class="main">=</span><span class="main">⟨</span><span class="free">nid</span> <span class="main">←</span> <span class="free">t</span>⟩<span class="hidden">⇘</span><sub><span class="free">n</span></sub><span class="hidden">⇙</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> assms latestAct_prop<span class="main">(</span>1<span class="main">)</span> nxtAct_active <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1" id="Configuration_Traces-latestActNxtAct"><span class="command">lemma</span></span> latestActNxtAct<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound"><span class="bound">n'</span></span><span class="main">≥</span><span class="free">n</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">tid</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">n'</span></sub><span class="hidden">⇙</span>"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound"><span class="bound">n'</span></span><span class="main">&lt;</span><span class="free">n</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">tid</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">n'</span></sub><span class="hidden">⇙</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">⟨</span><span class="free">tid</span> <span class="main">→</span> <span class="free">t</span>⟩<span class="hidden">⇘</span><sub><span class="free">n</span></sub><span class="hidden">⇙</span> <span class="main">&gt;</span> <span class="main">⟨</span><span class="free">tid</span> <span class="main">←</span> <span class="free">t</span>⟩<span class="hidden">⇘</span><sub><span class="free">n</span></sub><span class="hidden">⇙</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">meson</span> assms latestAct_prop<span class="main"><span class="main">(</span></span>2<span class="main"><span class="main">)</span></span> less_le_trans nxtActI zero_le<span class="main">)</span>

<span class="keyword1" id="Configuration_Traces-latestActless"><span class="command">lemma</span></span> latestActless<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound"><span class="bound">n'</span></span><span class="main">≥</span><span class="free">n<span class="hidden">⇩</span><sub>s</sub></span><span class="main">.</span> <span class="bound">n'</span><span class="main">&lt;</span><span class="free">n</span> <span class="main">∧</span> <span class="main"><span class="free">∥</span></span><span class="free">nid</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">n'</span></sub><span class="hidden">⇙</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">⟨</span><span class="free">nid</span> <span class="main">←</span> <span class="free">t</span>⟩<span class="hidden">⇘</span><sub><span class="free">n</span></sub><span class="hidden">⇙</span><span class="main">≥</span><span class="free">n<span class="hidden">⇩</span><sub>s</sub></span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">meson</span> assms dual_order.trans latestAct_less<span class="main">)</span>

<span class="keyword1" id="Configuration_Traces-latestActEq"><span class="command">lemma</span></span> latestActEq<span class="main">:</span>
  <span class="keyword2"><span class="keyword">fixes</span></span> <span class="free">nid</span><span class="main">::</span><span class="tfree"><span class="quoted"><span class="tfree">'id</span></span></span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="main"><span class="free">∥</span></span><span class="free">nid</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="free">n'</span></sub><span class="hidden">⇙</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span><span class="main">(</span><span class="main">∃</span><span class="bound"><span class="bound">n''</span></span><span class="main">&gt;</span><span class="free">n'</span><span class="main">.</span> <span class="bound">n''</span><span class="main">&lt;</span><span class="free">n</span> <span class="main">∧</span> <span class="main"><span class="free">∥</span></span><span class="free">nid</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="free">n'</span></sub><span class="hidden">⇙</span><span class="main">)</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">n'</span><span class="main">&lt;</span><span class="free">n</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">⟨</span><span class="free">nid</span> <span class="main">←</span> <span class="free">t</span>⟩<span class="hidden">⇘</span><sub><span class="free">n</span></sub><span class="hidden">⇙</span> <span class="main">=</span> <span class="free">n'</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> latestAct_def
<span class="keyword1"><span class="command">proof</span></span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="keyword1">GREATEST</span> <span class="bound">n'</span><span class="main">.</span> latestAct_cond <span class="free">nid</span> <span class="free">t</span> <span class="free">n</span> <span class="bound">n'</span><span class="main">)</span> <span class="main">=</span> <span class="free">n'</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">rule</span> Greatest_equality<span class="main"><span class="main">[</span></span><span class="operator">of</span> <span class="quoted"><span class="quoted"><span class="quoted">"latestAct_cond <span class="free"><span class="free">nid</span></span> <span class="free"><span class="free">t</span></span> <span class="free"><span class="free">n</span></span>"</span></span></span> <span class="quoted"><span class="free"><span class="quoted"><span class="free">n'</span></span></span></span><span class="main"><span class="main">]</span></span><span class="main">)</span>
    <span class="keyword1"><span class="command">from</span></span> assms<span class="main">(</span>1<span class="main">)</span> assms <span class="main">(</span>3<span class="main">)</span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"latestAct_cond <span class="free">nid</span> <span class="free">t</span> <span class="free">n</span> <span class="free">n'</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">next</span></span>
    <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">y</span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"latestAct_cond <span class="free">nid</span> <span class="free">t</span> <span class="free">n</span> <span class="skolem">y</span>"</span></span>
    <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="main"><span class="free">∥</span></span><span class="free">nid</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="skolem">y</span></sub><span class="hidden">⇙</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">y</span><span class="main">&lt;</span><span class="free">n</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">y</span> <span class="main">≤</span> <span class="free">n'</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>1<span class="main">)</span> assms <span class="main">(</span>2<span class="main">)</span> leI <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"<span class="free">n'</span> <span class="main">=</span> <span class="main">(</span><span class="keyword1">GREATEST</span> <span class="bound">n'</span><span class="main">.</span> latestAct_cond <span class="free">nid</span> <span class="free">t</span> <span class="free">n</span> <span class="bound">n'</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>
  
<span class="keyword1"><span class="command">subsection</span></span> <span class="quoted"><span class="plain_text">"Last Activation"</span></span>
<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹
  In the following we introduce an operator to obtain the latest point in time where a certain component was activated within a certain configuration trace.
›</span></span>

<span class="keyword1"><span class="command">definition</span></span> <span class="entity">lActive</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'id</span> <span class="main">⇒</span> <span class="main">(</span>nat <span class="main">⇒</span> cnf<span class="main">)</span> <span class="main">⇒</span> nat"</span></span> <span class="main">(</span><span class="quoted">"<span class="keyword1">⟨</span>_ <span class="keyword1">∧</span> _<span class="keyword1">⟩</span>"</span><span class="main">)</span>
  <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="main"><span class="free">⟨</span></span><span class="free"><span class="bound"><span class="entity">c</span></span></span> <span class="main"><span class="free">∧</span></span> <span class="free"><span class="bound"><span class="entity">t</span></span></span><span class="main"><span class="free">⟩</span></span> <span class="main">≡</span> <span class="main">(</span><span class="keyword1">GREATEST</span> <span class="bound">i</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free"><span class="bound"><span class="entity">c</span></span></span>∥<span class="hidden">⇘</span><sub><span class="free"><span class="bound"><span class="entity">t</span></span></span> <span class="bound">i</span></sub><span class="hidden">⇙</span><span class="main">)</span>"</span></span>

<span class="keyword1" id="Configuration_Traces-lActive_active"><span class="command">lemma</span></span> lActive_active<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="free">i</span></sub><span class="hidden">⇙</span>"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound"><span class="bound">n'</span></span> <span class="main">&gt;</span> <span class="free">n</span><span class="main">.</span> <span class="main">¬</span> <span class="main">(</span><span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">n'</span></sub><span class="hidden">⇙</span><span class="main">)</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="main">(</span><span class="main">⟨</span><span class="free">c</span> <span class="main">∧</span> <span class="free">t</span><span class="main">⟩</span><span class="main">)</span></sub><span class="hidden">⇙</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">from</span></span> assms <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">i'</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="skolem">i'</span></sub><span class="hidden">⇙</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">⋀</span><span class="bound">y</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">y</span></sub><span class="hidden">⇙</span> <span class="main">⟹</span> <span class="bound">y</span> <span class="main">≤</span> <span class="skolem">i'</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> boundedGreatest<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="quoted">"<span class="main">λ</span><span class="bound">i'</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i'</span></sub><span class="hidden">⇙</span>"</span></span> <span class="quoted"><span class="free">i</span></span> <span class="quoted"><span class="free">n</span></span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> lActive_def Nat.GreatestI_nat<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="quoted">"<span class="main">λ</span><span class="bound">i'</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i'</span></sub><span class="hidden">⇙</span>"</span></span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">metis</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="Configuration_Traces-lActive_less"><span class="command">lemma</span></span> lActive_less<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="free">i</span></sub><span class="hidden">⇙</span>"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound"><span class="bound">n'</span></span> <span class="main">&gt;</span> <span class="free">n</span><span class="main">.</span> <span class="main">¬</span> <span class="main">(</span><span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">n'</span></sub><span class="hidden">⇙</span><span class="main">)</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">⟨</span><span class="free">c</span> <span class="main">∧</span> <span class="free">t</span><span class="main">⟩</span> <span class="main">≤</span> <span class="free">n</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">rule</span> ccontr<span class="main">)</span>
  <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> <span class="main">⟨</span><span class="free">c</span> <span class="main">∧</span> <span class="free">t</span><span class="main">⟩</span> <span class="main">≤</span> <span class="free">n</span>"</span></span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="main">⟨</span><span class="free">c</span> <span class="main">∧</span> <span class="free">t</span><span class="main">⟩</span> <span class="main">&gt;</span> <span class="free">n</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> assms <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="main">(</span><span class="main">⟨</span><span class="free">c</span> <span class="main">∧</span> <span class="free">t</span><span class="main">⟩</span><span class="main">)</span></sub><span class="hidden">⇙</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> lActive_active <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted">False</span> <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="Configuration_Traces-lActive_greatest"><span class="command">lemma</span></span> lActive_greatest<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="free">i</span></sub><span class="hidden">⇙</span>"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound"><span class="bound">n'</span></span> <span class="main">&gt;</span> <span class="free">n</span><span class="main">.</span> <span class="main">¬</span> <span class="main">(</span><span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">n'</span></sub><span class="hidden">⇙</span><span class="main">)</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">i</span> <span class="main">≤</span> <span class="main">⟨</span><span class="free">c</span> <span class="main">∧</span> <span class="free">t</span><span class="main">⟩</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">from</span></span> assms <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">i'</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="skolem">i'</span></sub><span class="hidden">⇙</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">⋀</span><span class="bound">y</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">y</span></sub><span class="hidden">⇙</span> <span class="main">⟹</span> <span class="bound">y</span> <span class="main">≤</span> <span class="skolem">i'</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> boundedGreatest<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="quoted">"<span class="main">λ</span><span class="bound">i'</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i'</span></sub><span class="hidden">⇙</span>"</span></span> <span class="quoted"><span class="free">i</span></span> <span class="quoted"><span class="free">n</span></span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">with</span></span> assms <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> lActive_def Nat.Greatest_le_nat<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="quoted">"<span class="main">λ</span><span class="bound">i'</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i'</span></sub><span class="hidden">⇙</span>"</span></span> <span class="quoted"><span class="free">i</span></span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">metis</span>
<span class="keyword1"><span class="command">qed</span></span>
  
<span class="keyword1" id="Configuration_Traces-lActive_greater_active"><span class="command">lemma</span></span> lActive_greater_active<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">n</span> <span class="main">&gt;</span> <span class="main">⟨</span><span class="free">c</span> <span class="main">∧</span> <span class="free">t</span><span class="main">⟩</span>"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound"><span class="bound">n''</span></span> <span class="main">&gt;</span> <span class="free">n'</span><span class="main">.</span> <span class="main">¬</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">n''</span></sub><span class="hidden">⇙</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="free">n</span></sub><span class="hidden">⇙</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">rule</span> ccontr<span class="main">)</span>
  <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> <span class="main">¬</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="free">n</span></sub><span class="hidden">⇙</span>"</span></span>
  <span class="keyword1"><span class="command">with</span></span> <span class="quoted"><span class="quoted">‹<span class="main">∀</span><span class="bound"><span class="bound">n''</span></span> <span class="main">&gt;</span> <span class="free">n'</span><span class="main">.</span> <span class="main">¬</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">n''</span></sub><span class="hidden">⇙</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">n</span> <span class="main">≤</span> <span class="main">⟨</span><span class="free">c</span> <span class="main">∧</span> <span class="free">t</span><span class="main">⟩</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> lActive_greatest <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="quoted">False</span> <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>
  
<span class="keyword1" id="Configuration_Traces-lActive_greater_active_all"><span class="command">lemma</span></span> lActive_greater_active_all<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound"><span class="bound">n''</span></span> <span class="main">&gt;</span> <span class="free">n'</span><span class="main">.</span> <span class="main">¬</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">n''</span></sub><span class="hidden">⇙</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span><span class="main">(</span><span class="main">∃</span><span class="bound"><span class="bound">n</span></span> <span class="main">&gt;</span> <span class="main">⟨</span><span class="free">c</span> <span class="main">∧</span> <span class="free">t</span><span class="main">⟩</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">n</span></sub><span class="hidden">⇙</span><span class="main">)</span>"</span></span> 
<span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">rule</span> ccontr<span class="main">)</span>
  <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span><span class="main">¬</span><span class="main">(</span><span class="main">∃</span><span class="bound"><span class="bound">n</span></span> <span class="main">&gt;</span> <span class="main">⟨</span><span class="free">c</span> <span class="main">∧</span> <span class="free">t</span><span class="main">⟩</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">n</span></sub><span class="hidden">⇙</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="quoted">"<span class="skolem"><span class="skolem">n</span></span>"</span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">n</span><span class="main">&gt;</span><span class="main">⟨</span><span class="free">c</span> <span class="main">∧</span> <span class="free">t</span><span class="main">⟩</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="skolem">n</span></sub><span class="hidden">⇙</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">with</span></span> <span class="quoted"><span class="quoted">‹<span class="main">∀</span><span class="bound"><span class="bound">n''</span></span> <span class="main">&gt;</span> <span class="free">n'</span><span class="main">.</span> <span class="main">¬</span> <span class="main">(</span><span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">n''</span></sub><span class="hidden">⇙</span><span class="main">)</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="skolem">n</span></sub><span class="hidden">⇙</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> lActive_greater_active <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">with</span></span> <span class="quoted"><span class="quoted">‹<span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="skolem">n</span></sub><span class="hidden">⇙</span>›</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted">False</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="Configuration_Traces-lActive_equality"><span class="command">lemma</span></span> lActive_equality<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="free">i</span></sub><span class="hidden">⇙</span>"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">⋀</span><span class="bound">x</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">x</span></sub><span class="hidden">⇙</span> <span class="main">⟹</span> <span class="bound">x</span> <span class="main">≤</span> <span class="free">i</span><span class="main">)</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">⟨</span><span class="free">c</span> <span class="main">∧</span> <span class="free">t</span><span class="main">⟩</span> <span class="main">=</span> <span class="free">i</span>"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> lActive_def <span class="keyword1"><span class="command">using</span></span> assms Greatest_equality<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="quoted">"<span class="main">λ</span><span class="bound">i'</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i'</span></sub><span class="hidden">⇙</span>"</span></span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    
<span class="keyword1" id="Configuration_Traces-nxtActive_lactive"><span class="command">lemma</span></span> nxtActive_lactive<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound"><span class="bound">i</span></span><span class="main">≥</span><span class="free">n</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i</span></sub><span class="hidden">⇙</span>"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> <span class="main">(</span><span class="main">∃</span><span class="bound"><span class="bound">i</span></span><span class="main">&gt;</span><span class="main">⟨</span><span class="free">c</span> <span class="main">→</span> <span class="free">t</span>⟩<span class="hidden">⇘</span><sub><span class="free">n</span></sub><span class="hidden">⇙</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i</span></sub><span class="hidden">⇙</span><span class="main">)</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">⟨</span><span class="free">c</span> <span class="main">→</span> <span class="free">t</span>⟩<span class="hidden">⇘</span><sub><span class="free">n</span></sub><span class="hidden">⇙</span><span class="main">=</span><span class="main">⟨</span><span class="free">c</span> <span class="main">∧</span> <span class="free">t</span><span class="main">⟩</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">from</span></span> assms<span class="main">(</span>1<span class="main">)</span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="main">⟨</span><span class="free">c</span> <span class="main">→</span> <span class="free">t</span>⟩<span class="hidden">⇘</span><sub><span class="free">n</span></sub><span class="hidden">⇙</span></sub><span class="hidden">⇙</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> nxtActI <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> assms <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> <span class="main">(</span><span class="main">∃</span><span class="bound"><span class="bound">i'</span></span><span class="main">≥</span>Suc <span class="main">⟨</span><span class="free">c</span> <span class="main">→</span> <span class="free">t</span>⟩<span class="hidden">⇘</span><sub><span class="free">n</span></sub><span class="hidden">⇙</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i'</span></sub><span class="hidden">⇙</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> nxtActive_no_active <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">⋀</span><span class="bound">x</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">x</span></sub><span class="hidden">⇙</span> <span class="main">⟹</span> <span class="bound">x</span> <span class="main">≤</span> <span class="main">⟨</span><span class="free">c</span> <span class="main">→</span> <span class="free">t</span>⟩<span class="hidden">⇘</span><sub><span class="free">n</span></sub><span class="hidden">⇙</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> not_less_eq_eq <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="main">¬</span> <span class="main">(</span><span class="main">∃</span><span class="bound"><span class="bound">i'</span></span><span class="main">≥</span>Suc <span class="main">⟨</span><span class="free">c</span> <span class="main">→</span> <span class="free">t</span>⟩<span class="hidden">⇘</span><sub><span class="free">n</span></sub><span class="hidden">⇙</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i'</span></sub><span class="hidden">⇙</span><span class="main">)</span>›</span></span> lActive_equality <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>
    
<span class="keyword1"><span class="command">subsection</span></span> <span class="quoted"><span class="plain_text">"Mapping Time Points"</span></span>
<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹
  In the following we introduce two operators to map time-points between configuration traces and behavior traces.
›</span></span>

<span class="keyword1"><span class="command">subsubsection</span></span> <span class="quoted"><span class="plain_text">"Configuration Trace to Behavior Trace"</span></span>
<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹
  First we provide an operator which maps a point in time of a configuration trace to the corresponding point in time of a behavior trace.
›</span></span>
  
<span class="keyword1"><span class="command">definition</span></span> <span class="entity">cnf2bhv</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'id</span> <span class="main">⇒</span> <span class="main">(</span>nat <span class="main">⇒</span> cnf<span class="main">)</span> <span class="main">⇒</span> nat <span class="main">⇒</span> nat"</span></span> <span class="main">(</span><span class="quoted">"<span class="keyword1">⇘</span>_<span class="keyword1">⇙↓⇘</span>_<span class="keyword1">⇙</span><span class="keyword3">(</span>_<span class="keyword3">)</span>"</span> <span class="main">[</span>150<span class="main">,</span>150<span class="main">,</span>150<span class="main">]</span> 110<span class="main">)</span>
  <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="hidden">⇘</span><sub><span class="free"><span class="bound"><span class="entity">c</span></span></span></sub><span class="hidden">⇙</span>↓<span class="hidden">⇘</span><sub><span class="free"><span class="bound"><span class="entity">t</span></span></span></sub><span class="hidden">⇙</span><span class="main">(</span><span class="free"><span class="bound"><span class="entity">n</span></span></span><span class="main">)</span> <span class="main">≡</span> the_enat<span class="main">(</span>llength <span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free"><span class="bound"><span class="entity">c</span></span></span></sub><span class="hidden">⇙</span><span class="main">(</span>inf_llist <span class="free"><span class="bound"><span class="entity">t</span></span></span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">-</span> <span class="main">1</span> <span class="main">+</span> <span class="main">(</span><span class="free"><span class="bound"><span class="entity">n</span></span></span> <span class="main">-</span> <span class="main">⟨</span><span class="free"><span class="bound"><span class="entity">c</span></span></span> <span class="main">∧</span> <span class="free"><span class="bound"><span class="entity">t</span></span></span><span class="main">⟩</span><span class="main">)</span>"</span></span>

<span class="keyword1" id="Configuration_Traces-cnf2bhv_mono"><span class="command">lemma</span></span> cnf2bhv_mono<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">n'</span><span class="main">≥</span><span class="free">n</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span>↓<span class="hidden">⇘</span><sub><span class="free">t</span></sub><span class="hidden">⇙</span><span class="main">(</span><span class="free">n'</span><span class="main">)</span> <span class="main">≥</span> <span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span>↓<span class="hidden">⇘</span><sub><span class="free">t</span></sub><span class="hidden">⇙</span><span class="main">(</span><span class="free">n</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> assms cnf2bhv_def diff_le_mono<span class="main">)</span>

<span class="keyword1" id="Configuration_Traces-cnf2bhv_mono_strict"><span class="command">lemma</span></span> cnf2bhv_mono_strict<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">n</span><span class="main">≥</span><span class="main">⟨</span><span class="free">c</span> <span class="main">∧</span> <span class="free">t</span><span class="main">⟩</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">n'</span><span class="main">&gt;</span><span class="free">n</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span>↓<span class="hidden">⇘</span><sub><span class="free">t</span></sub><span class="hidden">⇙</span><span class="main">(</span><span class="free">n'</span><span class="main">)</span> <span class="main">&gt;</span> <span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span>↓<span class="hidden">⇘</span><sub><span class="free">t</span></sub><span class="hidden">⇙</span><span class="main">(</span><span class="free">n</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> assms cnf2bhv_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">"Note that the functions are nat, that means that also in the case the difference is negative they will return a 0!"</span></span>
<span class="keyword1" id="Configuration_Traces-cnf2bhv_ge_llength"><span class="command">lemma</span></span> cnf2bhv_ge_llength<span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">n</span><span class="main">≥</span><span class="main">⟨</span><span class="free">c</span> <span class="main">∧</span> <span class="free">t</span><span class="main">⟩</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span>↓<span class="hidden">⇘</span><sub><span class="free">t</span></sub><span class="hidden">⇙</span><span class="main">(</span><span class="free">n</span><span class="main">)</span> <span class="main">≥</span> the_enat<span class="main">(</span>llength <span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>inf_llist <span class="free">t</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">-</span> <span class="main">1</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> assms cnf2bhv_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>

<span class="keyword1" id="Configuration_Traces-cnf2bhv_greater_llength"><span class="command">lemma</span></span> cnf2bhv_greater_llength<span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">n</span><span class="main">&gt;</span><span class="main">⟨</span><span class="free">c</span> <span class="main">∧</span> <span class="free">t</span><span class="main">⟩</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span>↓<span class="hidden">⇘</span><sub><span class="free">t</span></sub><span class="hidden">⇙</span><span class="main">(</span><span class="free">n</span><span class="main">)</span> <span class="main">&gt;</span> the_enat<span class="main">(</span>llength <span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>inf_llist <span class="free">t</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">-</span> <span class="main">1</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> assms cnf2bhv_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>

<span class="keyword1" id="Configuration_Traces-cnf2bhv_suc"><span class="command">lemma</span></span> cnf2bhv_suc<span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">n</span><span class="main">≥</span><span class="main">⟨</span><span class="free">c</span> <span class="main">∧</span> <span class="free">t</span><span class="main">⟩</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span>↓<span class="hidden">⇘</span><sub><span class="free">t</span></sub><span class="hidden">⇙</span><span class="main">(</span>Suc <span class="free">n</span><span class="main">)</span> <span class="main">=</span> Suc <span class="main">(</span><span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span>↓<span class="hidden">⇘</span><sub><span class="free">t</span></sub><span class="hidden">⇙</span><span class="main">(</span><span class="free">n</span><span class="main">)</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> assms cnf2bhv_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>

<span class="keyword1" id="Configuration_Traces-cnf2bhv_lActive"><span class="command">lemma</span></span> cnf2bhv_lActive<span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span>↓<span class="hidden">⇘</span><sub><span class="free">t</span></sub><span class="hidden">⇙</span><span class="main">(</span><span class="main">⟨</span><span class="free">c</span> <span class="main">∧</span> <span class="free">t</span><span class="main">⟩</span><span class="main">)</span> <span class="main">=</span> the_enat<span class="main">(</span>llength <span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>inf_llist <span class="free">t</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">-</span> <span class="main">1</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> cnf2bhv_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    
<span class="keyword1" id="Configuration_Traces-cnf2bhv_lnth_lappend"><span class="command">lemma</span></span> cnf2bhv_lnth_lappend<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> act<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound">i</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i</span></sub><span class="hidden">⇙</span>"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> nAct<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">∄</span><span class="bound">i</span><span class="main">.</span> <span class="bound">i</span><span class="main">≥</span><span class="free">n</span> <span class="main">∧</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i</span></sub><span class="hidden">⇙</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"lnth <span class="main">(</span><span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>inf_llist <span class="free">t</span><span class="main">)</span><span class="main">)</span> <span class="keyword1">@<span class="hidden">⇩</span><sub>l</sub></span> <span class="main">(</span>inf_llist <span class="free">t'</span><span class="main">)</span><span class="main">)</span> <span class="main">(</span><span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span>↓<span class="hidden">⇘</span><sub><span class="free">t</span></sub><span class="hidden">⇙</span><span class="main">(</span><span class="free">n</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> lnth <span class="main">(</span>inf_llist <span class="free">t'</span><span class="main">)</span> <span class="main">(</span><span class="free">n</span> <span class="main">-</span> <span class="main">⟨</span><span class="free">c</span> <span class="main">∧</span> <span class="free">t</span><span class="main">⟩</span> <span class="main">-</span> <span class="main">1</span><span class="main">)</span>"</span></span>
    <span class="main">(</span><span class="keyword2"><span class="keyword">is</span></span> <span class="quoted"><span class="quoted">"<span class="var">?lhs</span> <span class="main">=</span> <span class="var">?rhs</span>"</span></span><span class="main">)</span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">from</span></span> nAct <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"lfinite <span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>inf_llist <span class="free">t</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> proj_finite2 <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">k</span></span> <span class="keyword2"><span class="keyword">where</span></span> k_def<span class="main">:</span> <span class="quoted"><span class="quoted">"llength <span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>inf_llist <span class="free">t</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> enat <span class="skolem">k</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> lfinite_llength_enat <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">k</span> <span class="main">≤</span> <span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span>↓<span class="hidden">⇘</span><sub><span class="free">t</span></sub><span class="hidden">⇙</span><span class="main">(</span><span class="free">n</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
    <span class="keyword1"><span class="command">from</span></span> nAct <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">∄</span><span class="bound">i</span><span class="main">.</span> <span class="bound">i</span><span class="main">&gt;</span><span class="free">n</span><span class="main">-</span><span class="main">1</span> <span class="main">∧</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i</span></sub><span class="hidden">⇙</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">with</span></span> act <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">⟨</span><span class="free">c</span> <span class="main">∧</span> <span class="free">t</span><span class="main">⟩</span> <span class="main">≤</span> <span class="free">n</span><span class="main">-</span><span class="main">1</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> lActive_less <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">n</span><span class="main">&gt;</span><span class="main">0</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> act nAct <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">⟨</span><span class="free">c</span> <span class="main">∧</span> <span class="free">t</span><span class="main">⟩</span> <span class="main">&lt;</span> <span class="free">n</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"the_enat <span class="main">(</span>llength <span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span>inf_llist <span class="free">t</span><span class="main">)</span><span class="main">)</span> <span class="main">-</span> <span class="main">1</span> <span class="main">&lt;</span> <span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span>↓<span class="hidden">⇘</span><sub><span class="free">t</span></sub><span class="hidden">⇙</span><span class="main">(</span><span class="free">n</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> cnf2bhv_greater_llength <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">with</span></span> k_def <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="var">?lhs</span> <span class="main">=</span> lnth <span class="main">(</span>inf_llist <span class="free">t'</span><span class="main">)</span> <span class="main">(</span><span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span>↓<span class="hidden">⇘</span><sub><span class="free">t</span></sub><span class="hidden">⇙</span><span class="main">(</span><span class="free">n</span><span class="main">)</span> <span class="main">-</span> <span class="skolem">k</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> lnth_lappend2 <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span>↓<span class="hidden">⇘</span><sub><span class="free">t</span></sub><span class="hidden">⇙</span><span class="main">(</span><span class="free">n</span><span class="main">)</span> <span class="main">-</span> <span class="skolem">k</span> <span class="main">=</span> <span class="free">n</span> <span class="main">-</span> <span class="main">⟨</span><span class="free">c</span> <span class="main">∧</span> <span class="free">t</span><span class="main">⟩</span> <span class="main">-</span> <span class="main">1</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
    <span class="keyword1"><span class="command">from</span></span> cnf2bhv_def <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span>↓<span class="hidden">⇘</span><sub><span class="free">t</span></sub><span class="hidden">⇙</span><span class="main">(</span><span class="free">n</span><span class="main">)</span> <span class="main">-</span> <span class="skolem">k</span> <span class="main">=</span> the_enat <span class="main">(</span>llength <span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span>inf_llist <span class="free">t</span><span class="main">)</span><span class="main">)</span> <span class="main">-</span> <span class="main">1</span> <span class="main">+</span> <span class="main">(</span><span class="free">n</span> <span class="main">-</span> <span class="main">⟨</span><span class="free">c</span> <span class="main">∧</span> <span class="free">t</span><span class="main">⟩</span><span class="main">)</span> <span class="main">-</span> <span class="skolem">k</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">…</span> <span class="main">=</span> the_enat <span class="main">(</span>llength <span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span>inf_llist <span class="free">t</span><span class="main">)</span><span class="main">)</span> <span class="main">-</span> <span class="main">1</span> <span class="main">+</span> <span class="main">(</span><span class="free">n</span> <span class="main">-</span> <span class="main">⟨</span><span class="free">c</span> <span class="main">∧</span> <span class="free">t</span><span class="main">⟩</span><span class="main">)</span> <span class="main">-</span>
      the_enat <span class="main">(</span>llength <span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>inf_llist <span class="free">t</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> k_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">…</span> <span class="main">=</span> the_enat <span class="main">(</span>llength <span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span>inf_llist <span class="free">t</span><span class="main">)</span><span class="main">)</span> <span class="main">+</span> <span class="main">(</span><span class="free">n</span> <span class="main">-</span> <span class="main">⟨</span><span class="free">c</span> <span class="main">∧</span> <span class="free">t</span><span class="main">⟩</span><span class="main">)</span> <span class="main">-</span> <span class="main">1</span> <span class="main">-</span>
      the_enat <span class="main">(</span>llength <span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>inf_llist <span class="free">t</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
      <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound">i</span><span class="main">.</span> enat <span class="bound">i</span> <span class="main">&lt;</span> llength <span class="main">(</span>inf_llist <span class="free">t</span><span class="main">)</span> <span class="main">∧</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub>lnth <span class="main">(</span>inf_llist <span class="free">t</span><span class="main">)</span> <span class="bound">i</span></sub><span class="hidden">⇙</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> act<span class="main">)</span>
      <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"llength <span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span>inf_llist <span class="free">t</span><span class="main">)</span> <span class="main">≥</span> <span class="main">1</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> proj_one <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
      <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> k_def <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"llength <span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span>inf_llist <span class="free">t</span><span class="main">)</span> <span class="main">≠</span> <span class="main">∞</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
      <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"the_enat <span class="main">(</span>llength <span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span>inf_llist <span class="free">t</span><span class="main">)</span><span class="main">)</span> <span class="main">≥</span> <span class="main">1</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> k_def one_enat_def<span class="main">)</span>
      <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">qed</span></span>
    <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">…</span> <span class="main">=</span> the_enat <span class="main">(</span>llength <span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span>inf_llist <span class="free">t</span><span class="main">)</span><span class="main">)</span> <span class="main">+</span> <span class="main">(</span><span class="free">n</span> <span class="main">-</span> <span class="main">⟨</span><span class="free">c</span> <span class="main">∧</span> <span class="free">t</span><span class="main">⟩</span><span class="main">)</span> <span class="main">-</span>
      the_enat <span class="main">(</span>llength <span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>inf_llist <span class="free">t</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">-</span> <span class="main">1</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">…</span> <span class="main">=</span> <span class="free">n</span> <span class="main">-</span> <span class="main">⟨</span><span class="free">c</span> <span class="main">∧</span> <span class="free">t</span><span class="main">⟩</span> <span class="main">-</span> <span class="main">1</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">finally</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">.</span></span>
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="Configuration_Traces-nAct_cnf2proj_Suc_dist"><span class="command">lemma</span></span> nAct_cnf2proj_Suc_dist<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound"><span class="bound">i</span></span><span class="main">≥</span><span class="free">n</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i</span></sub><span class="hidden">⇙</span>"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span><span class="main">(</span><span class="main">∃</span><span class="bound"><span class="bound">i</span></span><span class="main">&gt;</span><span class="main">⟨</span><span class="free">c</span> <span class="main">→</span> <span class="free">t</span>⟩<span class="hidden">⇘</span><sub><span class="free">n</span></sub><span class="hidden">⇙</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i</span></sub><span class="hidden">⇙</span><span class="main">)</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"Suc <span class="main">(</span>the_enat <span class="main">⟨</span><span class="free">c</span> #<span class="hidden">⇘</span><sub>enat <span class="free">n</span></sub><span class="hidden">⇙</span>inf_llist <span class="free">t</span><span class="main">⟩</span><span class="main">)</span><span class="main">=</span><span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span>↓<span class="hidden">⇘</span><sub><span class="free">t</span></sub><span class="hidden">⇙</span><span class="main">(</span>Suc <span class="main">⟨</span><span class="free">c</span> <span class="main">→</span> <span class="free">t</span>⟩<span class="hidden">⇘</span><sub><span class="free">n</span></sub><span class="hidden">⇙</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"the_enat <span class="main">⟨</span><span class="free">c</span> #<span class="hidden">⇘</span><sub>enat <span class="free">n</span></sub><span class="hidden">⇙</span>inf_llist <span class="free">t</span><span class="main">⟩</span> <span class="main">=</span> <span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span>↓<span class="hidden">⇘</span><sub><span class="free">t</span></sub><span class="hidden">⇙</span><span class="main">(</span><span class="main">⟨</span><span class="free">c</span> <span class="main">→</span> <span class="free">t</span>⟩<span class="hidden">⇘</span><sub><span class="free">n</span></sub><span class="hidden">⇙</span><span class="main">)</span>"</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">is</span></span> <span class="quoted"><span class="quoted">"<span class="var">?LHS</span> <span class="main">=</span> <span class="var">?RHS</span>"</span></span><span class="main">)</span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
    <span class="keyword1"><span class="command">from</span></span> assms <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="var">?RHS</span> <span class="main">=</span> the_enat<span class="main">(</span>llength <span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>inf_llist <span class="free">t</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">-</span> <span class="main">1</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> nxtActive_lactive<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="free">n</span></span> <span class="quoted"><span class="free">c</span></span> <span class="quoted"><span class="free">t</span></span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"llength <span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>inf_llist <span class="free">t</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> eSuc <span class="main">(</span><span class="main">⟨</span><span class="free">c</span> #<span class="hidden">⇘</span><sub><span class="main">⟨</span><span class="free">c</span> <span class="main">→</span> <span class="free">t</span>⟩<span class="hidden">⇘</span><sub><span class="free">n</span></sub><span class="hidden">⇙</span></sub><span class="hidden">⇙</span> inf_llist <span class="free">t</span><span class="main">⟩</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
      <span class="keyword1"><span class="command">from</span></span> assms <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> <span class="main">(</span><span class="main">∃</span><span class="bound"><span class="bound">i'</span></span><span class="main">≥</span> Suc <span class="main">(</span><span class="main">⟨</span><span class="free">c</span> <span class="main">→</span> <span class="free">t</span>⟩<span class="hidden">⇘</span><sub><span class="free">n</span></sub><span class="hidden">⇙</span><span class="main">)</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i'</span></sub><span class="hidden">⇙</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> nxtActive_no_active <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
      <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="main">⟨</span><span class="free">c</span> #<span class="hidden">⇘</span><sub>Suc <span class="main">(</span><span class="main">⟨</span><span class="free">c</span> <span class="main">→</span> <span class="free">t</span>⟩<span class="hidden">⇘</span><sub><span class="free">n</span></sub><span class="hidden">⇙</span><span class="main">)</span></sub><span class="hidden">⇙</span> inf_llist <span class="free">t</span><span class="main">⟩</span> <span class="main">=</span> llength <span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>inf_llist <span class="free">t</span><span class="main">)</span><span class="main">)</span>"</span></span>
        <span class="keyword1"><span class="command">using</span></span> nAct_eq_proj<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="quoted">"Suc <span class="main">(</span><span class="main">⟨</span><span class="free">c</span> <span class="main">→</span> <span class="free">t</span>⟩<span class="hidden">⇘</span><sub><span class="free">n</span></sub><span class="hidden">⇙</span><span class="main">)</span>"</span></span> <span class="quoted"><span class="free">c</span></span> <span class="quoted"><span class="quoted">"inf_llist <span class="free">t</span>"</span></span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
      <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> assms<span class="main">(</span>1<span class="main">)</span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="main">(</span><span class="main">⟨</span><span class="free">c</span> <span class="main">→</span> <span class="free">t</span>⟩<span class="hidden">⇘</span><sub><span class="free">n</span></sub><span class="hidden">⇙</span><span class="main">)</span></sub><span class="hidden">⇙</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> nxtActI <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
      <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="main">⟨</span><span class="free">c</span> #<span class="hidden">⇘</span><sub>Suc <span class="main">(</span><span class="main">⟨</span><span class="free">c</span> <span class="main">→</span> <span class="free">t</span>⟩<span class="hidden">⇘</span><sub><span class="free">n</span></sub><span class="hidden">⇙</span><span class="main">)</span></sub><span class="hidden">⇙</span> inf_llist <span class="free">t</span><span class="main">⟩</span> <span class="main">=</span> eSuc <span class="main">(</span><span class="main">⟨</span><span class="free">c</span> #<span class="hidden">⇘</span><sub><span class="main">⟨</span><span class="free">c</span> <span class="main">→</span> <span class="free">t</span>⟩<span class="hidden">⇘</span><sub><span class="free">n</span></sub><span class="hidden">⇙</span></sub><span class="hidden">⇙</span> inf_llist <span class="free">t</span><span class="main">⟩</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
      <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">qed</span></span>
    <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"the_enat<span class="main">(</span>eSuc <span class="main">(</span><span class="main">⟨</span><span class="free">c</span> #<span class="hidden">⇘</span><sub><span class="main">⟨</span><span class="free">c</span> <span class="main">→</span> <span class="free">t</span>⟩<span class="hidden">⇘</span><sub><span class="free">n</span></sub><span class="hidden">⇙</span></sub><span class="hidden">⇙</span> inf_llist <span class="free">t</span><span class="main">⟩</span><span class="main">)</span><span class="main">)</span> <span class="main">-</span> <span class="main">1</span> <span class="main">=</span> <span class="main">(</span><span class="main">⟨</span><span class="free">c</span> #<span class="hidden">⇘</span><sub><span class="main">⟨</span><span class="free">c</span> <span class="main">→</span> <span class="free">t</span>⟩<span class="hidden">⇘</span><sub><span class="free">n</span></sub><span class="hidden">⇙</span></sub><span class="hidden">⇙</span> inf_llist <span class="free">t</span><span class="main">⟩</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
      <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">⟨</span><span class="free">c</span> #<span class="hidden">⇘</span><sub><span class="main">⟨</span><span class="free">c</span> <span class="main">→</span> <span class="free">t</span>⟩<span class="hidden">⇘</span><sub><span class="free">n</span></sub><span class="hidden">⇙</span></sub><span class="hidden">⇙</span> inf_llist <span class="free">t</span><span class="main">⟩</span> <span class="main">≠</span> <span class="main">∞</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
      <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"the_enat<span class="main">(</span>eSuc <span class="main">(</span><span class="main">⟨</span><span class="free">c</span> #<span class="hidden">⇘</span><sub><span class="main">⟨</span><span class="free">c</span> <span class="main">→</span> <span class="free">t</span>⟩<span class="hidden">⇘</span><sub><span class="free">n</span></sub><span class="hidden">⇙</span></sub><span class="hidden">⇙</span> inf_llist <span class="free">t</span><span class="main">⟩</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> Suc<span class="main">(</span>the_enat<span class="main">(</span><span class="main">⟨</span><span class="free">c</span> #<span class="hidden">⇘</span><sub><span class="main">⟨</span><span class="free">c</span> <span class="main">→</span> <span class="free">t</span>⟩<span class="hidden">⇘</span><sub><span class="free">n</span></sub><span class="hidden">⇙</span></sub><span class="hidden">⇙</span> inf_llist <span class="free">t</span><span class="main">⟩</span><span class="main">)</span><span class="main">)</span>"</span></span>
        <span class="keyword1"><span class="command">using</span></span> the_enat_eSuc <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
      <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">qed</span></span>
    <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">…</span> <span class="main">=</span> <span class="var">?LHS</span>"</span></span>
    <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
      <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"enat <span class="main">⟨</span><span class="free">c</span> <span class="main">→</span> <span class="free">t</span>⟩<span class="hidden">⇘</span><sub><span class="free">n</span></sub><span class="hidden">⇙</span> <span class="main">-</span> <span class="main">1</span> <span class="main">&lt;</span> llength <span class="main">(</span>inf_llist <span class="free">t</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> one_enat_def<span class="main">)</span>
      <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> assms<span class="main">(</span>1<span class="main">)</span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">⟨</span><span class="free">c</span> <span class="main">→</span> <span class="free">t</span>⟩<span class="hidden">⇘</span><sub><span class="free">n</span></sub><span class="hidden">⇙</span><span class="main">≥</span><span class="free">n</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span>
        <span class="quoted"><span class="quoted">"<span class="main">∄</span><span class="bound">k</span><span class="main">.</span> enat <span class="free">n</span> <span class="main">≤</span> enat <span class="bound">k</span> <span class="main">∧</span> enat <span class="bound">k</span> <span class="main">&lt;</span> enat <span class="main">⟨</span><span class="free">c</span> <span class="main">→</span> <span class="free">t</span>⟩<span class="hidden">⇘</span><sub><span class="free">n</span></sub><span class="hidden">⇙</span> <span class="main">∧</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub>lnth <span class="main">(</span>inf_llist <span class="free">t</span><span class="main">)</span> <span class="bound">k</span></sub><span class="hidden">⇙</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> nxtActI <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">⟨</span><span class="free">c</span> #<span class="hidden">⇘</span><sub>enat <span class="main">⟨</span><span class="free">c</span> <span class="main">→</span> <span class="free">t</span>⟩<span class="hidden">⇘</span><sub><span class="free">n</span></sub><span class="hidden">⇙</span></sub><span class="hidden">⇙</span>inf_llist <span class="free">t</span><span class="main">⟩</span> <span class="main">=</span> <span class="main">⟨</span><span class="free">c</span> #<span class="hidden">⇘</span><sub>enat <span class="free">n</span></sub><span class="hidden">⇙</span>inf_llist <span class="free">t</span><span class="main">⟩</span>"</span></span>
        <span class="keyword1"><span class="command">using</span></span> nAct_not_active_same<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="free">n</span></span> <span class="quoted"><span class="quoted">"<span class="main">⟨</span><span class="free">c</span> <span class="main">→</span> <span class="free">t</span>⟩<span class="hidden">⇘</span><sub><span class="free">n</span></sub><span class="hidden">⇙</span>"</span></span> <span class="quoted"><span class="quoted">"inf_llist <span class="free">t</span>"</span></span> <span class="quoted"><span class="free">c</span></span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
      <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">⟨</span><span class="free">c</span> #<span class="hidden">⇘</span><sub>enat <span class="free">n</span></sub><span class="hidden">⇙</span>inf_llist <span class="free">t</span><span class="main">⟩</span><span class="main">≠</span><span class="main">∞</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
      <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">qed</span></span>
    <span class="keyword1"><span class="command">finally</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">fastforce</span>
  <span class="keyword1"><span class="command">qed</span></span>      
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> assms <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">⟨</span><span class="free">c</span> <span class="main">→</span> <span class="free">t</span>⟩<span class="hidden">⇘</span><sub><span class="free">n</span></sub><span class="hidden">⇙</span><span class="main">=</span><span class="main">⟨</span><span class="free">c</span> <span class="main">∧</span> <span class="free">t</span><span class="main">⟩</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> nxtActive_lactive <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"Suc <span class="main">(</span><span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span>↓<span class="hidden">⇘</span><sub><span class="free">t</span></sub><span class="hidden">⇙</span><span class="main">(</span><span class="main">⟨</span><span class="free">c</span> <span class="main">→</span> <span class="free">t</span>⟩<span class="hidden">⇘</span><sub><span class="free">n</span></sub><span class="hidden">⇙</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> <span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span>↓<span class="hidden">⇘</span><sub><span class="free">t</span></sub><span class="hidden">⇙</span><span class="main">(</span>Suc <span class="main">⟨</span><span class="free">c</span> <span class="main">→</span> <span class="free">t</span>⟩<span class="hidden">⇘</span><sub><span class="free">n</span></sub><span class="hidden">⇙</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> cnf2bhv_suc<span class="main">[</span><span class="keyword2"><span class="keyword"><span class="operator">where</span></span></span> n<span class="main"><span class="main">=</span></span><span class="quoted"><span class="quoted">"<span class="main">⟨</span><span class="free">c</span> <span class="main">→</span> <span class="free">t</span>⟩<span class="hidden">⇘</span><sub><span class="free">n</span></sub><span class="hidden">⇙</span>"</span></span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">subsubsection</span></span> <span class="quoted"><span class="plain_text">"Behavior Trace to Configuration Trace"</span></span>
<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹
  Next we define an operator to map a point in time of a behavior trace back to a corresponding point in time for a configuration trace.
›</span></span>

<span class="keyword1"><span class="command">definition</span></span> <span class="entity">bhv2cnf</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'id</span> <span class="main">⇒</span> <span class="main">(</span>nat <span class="main">⇒</span> cnf<span class="main">)</span> <span class="main">⇒</span> nat <span class="main">⇒</span> nat"</span></span> <span class="main">(</span><span class="quoted">"<span class="keyword1">⇘</span>_<span class="keyword1">⇙↑⇘</span>_<span class="keyword1">⇙</span><span class="keyword3">(</span>_<span class="keyword3">)</span>"</span> <span class="main">[</span>150<span class="main">,</span>150<span class="main">,</span>150<span class="main">]</span> 110<span class="main">)</span>
  <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="hidden">⇘</span><sub><span class="free"><span class="bound"><span class="entity">c</span></span></span></sub><span class="hidden">⇙</span>↑<span class="hidden">⇘</span><sub><span class="free"><span class="bound"><span class="entity">t</span></span></span></sub><span class="hidden">⇙</span><span class="main">(</span><span class="free"><span class="bound"><span class="entity">n</span></span></span><span class="main">)</span> <span class="main">≡</span> <span class="main">⟨</span><span class="free"><span class="bound"><span class="entity">c</span></span></span> <span class="main">∧</span> <span class="free"><span class="bound"><span class="entity">t</span></span></span><span class="main">⟩</span> <span class="main">+</span> <span class="main">(</span><span class="free"><span class="bound"><span class="entity">n</span></span></span> <span class="main">-</span> <span class="main">(</span>the_enat<span class="main">(</span>llength <span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free"><span class="bound"><span class="entity">c</span></span></span></sub><span class="hidden">⇙</span><span class="main">(</span>inf_llist <span class="free"><span class="bound"><span class="entity">t</span></span></span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">-</span> <span class="main">1</span><span class="main">)</span><span class="main">)</span>"</span></span>

<span class="keyword1" id="Configuration_Traces-bhv2cnf_mono"><span class="command">lemma</span></span> bhv2cnf_mono<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">n'</span><span class="main">≥</span><span class="free">n</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span>↑<span class="hidden">⇘</span><sub><span class="free">t</span></sub><span class="hidden">⇙</span><span class="main">(</span><span class="free">n'</span><span class="main">)</span> <span class="main">≥</span> <span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span>↑<span class="hidden">⇘</span><sub><span class="free">t</span></sub><span class="hidden">⇙</span><span class="main">(</span><span class="free">n</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> assms bhv2cnf_def diff_le_mono<span class="main">)</span>    

<span class="keyword1" id="Configuration_Traces-bhv2cnf_mono_strict"><span class="command">lemma</span></span> bhv2cnf_mono_strict<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">n'</span><span class="main">&gt;</span><span class="free">n</span>"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">n</span> <span class="main">≥</span> the_enat <span class="main">(</span>llength <span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>inf_llist <span class="free">t</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">-</span> <span class="main">1</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span>↑<span class="hidden">⇘</span><sub><span class="free">t</span></sub><span class="hidden">⇙</span><span class="main">(</span><span class="free">n'</span><span class="main">)</span> <span class="main">&gt;</span> <span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span>↑<span class="hidden">⇘</span><sub><span class="free">t</span></sub><span class="hidden">⇙</span><span class="main">(</span><span class="free">n</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> assms bhv2cnf_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">"Note that the functions are nat, that means that also in the case the difference is negative they will return a 0!"</span></span>
<span class="keyword1" id="Configuration_Traces-bhv2cnf_ge_lActive"><span class="command">lemma</span></span> bhv2cnf_ge_lActive<span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span>↑<span class="hidden">⇘</span><sub><span class="free">t</span></sub><span class="hidden">⇙</span><span class="main">(</span><span class="free">n</span><span class="main">)</span> <span class="main">≥</span> <span class="main">⟨</span><span class="free">c</span> <span class="main">∧</span> <span class="free">t</span><span class="main">⟩</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> bhv2cnf_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>

<span class="keyword1" id="Configuration_Traces-bhv2cnf_greater_lActive"><span class="command">lemma</span></span> bhv2cnf_greater_lActive<span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">n</span><span class="main">&gt;</span>the_enat<span class="main">(</span>llength <span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>inf_llist <span class="free">t</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">-</span> <span class="main">1</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span>↑<span class="hidden">⇘</span><sub><span class="free">t</span></sub><span class="hidden">⇙</span><span class="main">(</span><span class="free">n</span><span class="main">)</span> <span class="main">&gt;</span> <span class="main">⟨</span><span class="free">c</span> <span class="main">∧</span> <span class="free">t</span><span class="main">⟩</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> assms bhv2cnf_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    
<span class="keyword1" id="Configuration_Traces-bhv2cnf_lActive"><span class="command">lemma</span></span> bhv2cnf_lActive<span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound">i</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i</span></sub><span class="hidden">⇙</span>"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"lfinite <span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>inf_llist <span class="free">t</span><span class="main">)</span><span class="main">)</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span>↑<span class="hidden">⇘</span><sub><span class="free">t</span></sub><span class="hidden">⇙</span><span class="main">(</span>the_enat<span class="main">(</span>llength <span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>inf_llist <span class="free">t</span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> Suc <span class="main">(</span><span class="main">⟨</span><span class="free">c</span> <span class="main">∧</span> <span class="free">t</span><span class="main">⟩</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">from</span></span> assms <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>inf_llist <span class="free">t</span><span class="main">)</span><span class="main">≠</span> <span class="keyword1">[]<span class="hidden">⇩</span><sub>l</sub></span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"llength <span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>inf_llist <span class="free">t</span><span class="main">)</span><span class="main">)</span> <span class="main">&gt;</span> <span class="main">0</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> lnull_def<span class="main">)</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹lfinite <span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>inf_llist <span class="free">t</span><span class="main">)</span><span class="main">)</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"llength <span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>inf_llist <span class="free">t</span><span class="main">)</span><span class="main">)</span> <span class="main">≠</span> <span class="main">∞</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> llength_eq_infty_conv_lfinite <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"the_enat<span class="main">(</span>llength <span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>inf_llist <span class="free">t</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">&gt;</span> <span class="main">0</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> enat_0_iff<span class="main">(</span>1<span class="main">)</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">fastforce</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"the_enat<span class="main">(</span>llength <span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>inf_llist <span class="free">t</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">-</span> <span class="main">(</span>the_enat<span class="main">(</span>llength <span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>inf_llist <span class="free">t</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">-</span> <span class="main">1</span><span class="main">)</span> <span class="main">=</span> <span class="main">1</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> bhv2cnf_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>
  
<span class="keyword1"><span class="command">subsubsection</span></span> <span class="quoted"><span class="plain_text">"Relating the Mappings"</span></span>
<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹
  In the following we provide some properties about the relationship between the two mapping operators.
›</span></span>
  
<span class="keyword1" id="Configuration_Traces-bhv2cnf_cnf2bhv"><span class="command">lemma</span></span> bhv2cnf_cnf2bhv<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">n</span> <span class="main">≥</span> <span class="main">⟨</span><span class="free">c</span> <span class="main">∧</span> <span class="free">t</span><span class="main">⟩</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span>↑<span class="hidden">⇘</span><sub><span class="free">t</span></sub><span class="hidden">⇙</span><span class="main">(</span><span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span>↓<span class="hidden">⇘</span><sub><span class="free">t</span></sub><span class="hidden">⇙</span><span class="main">(</span><span class="free">n</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> <span class="free">n</span>"</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">is</span></span> <span class="quoted"><span class="quoted">"<span class="var">?lhs</span> <span class="main">=</span> <span class="var">?rhs</span>"</span></span><span class="main">)</span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="var">?lhs</span> <span class="main">=</span> <span class="main">⟨</span><span class="free">c</span> <span class="main">∧</span> <span class="free">t</span><span class="main">⟩</span> <span class="main">+</span> <span class="main">(</span><span class="main">(</span><span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span>↓<span class="hidden">⇘</span><sub><span class="free">t</span></sub><span class="hidden">⇙</span><span class="main">(</span><span class="free">n</span><span class="main">)</span><span class="main">)</span> <span class="main">-</span> <span class="main">(</span>the_enat<span class="main">(</span>llength <span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>inf_llist <span class="free">t</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">-</span> <span class="main">1</span><span class="main">)</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> bhv2cnf_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">…</span> <span class="main">=</span> <span class="main">⟨</span><span class="free">c</span> <span class="main">∧</span> <span class="free">t</span><span class="main">⟩</span> <span class="main">+</span> <span class="main">(</span><span class="main">(</span><span class="main">(</span>the_enat <span class="main">(</span>llength <span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>inf_llist <span class="free">t</span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">-</span> <span class="main">1</span> <span class="main">+</span> <span class="main">(</span><span class="free">n</span> <span class="main">-</span> <span class="main">⟨</span><span class="free">c</span> <span class="main">∧</span> <span class="free">t</span><span class="main">⟩</span><span class="main">)</span><span class="main">)</span> <span class="main">-</span>
    <span class="main">(</span>the_enat <span class="main">(</span>llength <span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>inf_llist <span class="free">t</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">-</span> <span class="main">1</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> cnf2bhv_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span>the_enat<span class="main">(</span>llength <span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>inf_llist <span class="free">t</span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">-</span> <span class="main">1</span> <span class="main">+</span> <span class="main">(</span><span class="free">n</span> <span class="main">-</span> <span class="main">(</span><span class="main">⟨</span><span class="free">c</span> <span class="main">∧</span> <span class="free">t</span><span class="main">⟩</span><span class="main">)</span><span class="main">)</span> <span class="main">-</span>
    <span class="main">(</span>the_enat <span class="main">(</span>llength <span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>inf_llist <span class="free">t</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">-</span> <span class="main">1</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span>the_enat<span class="main">(</span>llength <span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>inf_llist <span class="free">t</span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">-</span> <span class="main">1</span> <span class="main">-</span>
    <span class="main">(</span><span class="main">(</span>the_enat <span class="main">(</span>llength <span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>inf_llist <span class="free">t</span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">-</span> <span class="main">1</span><span class="main">)</span> <span class="main">+</span> <span class="main">(</span><span class="free">n</span> <span class="main">-</span> <span class="main">(</span><span class="main">⟨</span><span class="free">c</span> <span class="main">∧</span> <span class="free">t</span><span class="main">⟩</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">…</span> <span class="main">=</span> <span class="free">n</span> <span class="main">-</span> <span class="main">(</span><span class="main">⟨</span><span class="free">c</span> <span class="main">∧</span> <span class="free">t</span><span class="main">⟩</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">⟨</span><span class="free">c</span> <span class="main">∧</span> <span class="free">t</span><span class="main">⟩</span><span class="main">)</span> <span class="main">+</span> <span class="main">(</span><span class="free">n</span> <span class="main">-</span> <span class="main">(</span><span class="main">⟨</span><span class="free">c</span> <span class="main">∧</span> <span class="free">t</span><span class="main">⟩</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="main">⟨</span><span class="free">c</span> <span class="main">∧</span> <span class="free">t</span><span class="main">⟩</span><span class="main">)</span> <span class="main">+</span> <span class="free">n</span> <span class="main">-</span> <span class="main">⟨</span><span class="free">c</span> <span class="main">∧</span> <span class="free">t</span><span class="main">⟩</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">…</span> <span class="main">=</span> <span class="var">?rhs</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">finally</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">.</span></span>
<span class="keyword1"><span class="command">qed</span></span>
    
<span class="keyword1" id="Configuration_Traces-cnf2bhv_bhv2cnf"><span class="command">lemma</span></span> cnf2bhv_bhv2cnf<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">n</span> <span class="main">≥</span> the_enat <span class="main">(</span>llength <span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>inf_llist <span class="free">t</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">-</span> <span class="main">1</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span>↓<span class="hidden">⇘</span><sub><span class="free">t</span></sub><span class="hidden">⇙</span><span class="main">(</span><span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span>↑<span class="hidden">⇘</span><sub><span class="free">t</span></sub><span class="hidden">⇙</span><span class="main">(</span><span class="free">n</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> <span class="free">n</span>"</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">is</span></span> <span class="quoted"><span class="quoted">"<span class="var">?lhs</span> <span class="main">=</span> <span class="var">?rhs</span>"</span></span><span class="main">)</span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="var">?lhs</span> <span class="main">=</span> the_enat<span class="main">(</span>llength <span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>inf_llist <span class="free">t</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">-</span> <span class="main">1</span> <span class="main">+</span> <span class="main">(</span><span class="main">(</span><span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span>↑<span class="hidden">⇘</span><sub><span class="free">t</span></sub><span class="hidden">⇙</span><span class="main">(</span><span class="free">n</span><span class="main">)</span><span class="main">)</span> <span class="main">-</span> <span class="main">(</span><span class="main">⟨</span><span class="free">c</span> <span class="main">∧</span> <span class="free">t</span><span class="main">⟩</span><span class="main">)</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> cnf2bhv_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">…</span> <span class="main">=</span> the_enat<span class="main">(</span>llength <span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>inf_llist <span class="free">t</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">-</span> <span class="main">1</span> <span class="main">+</span> <span class="main">(</span><span class="main">⟨</span><span class="free">c</span> <span class="main">∧</span> <span class="free">t</span><span class="main">⟩</span> <span class="main">+</span>
    <span class="main">(</span><span class="free">n</span> <span class="main">-</span> <span class="main">(</span>the_enat<span class="main">(</span>llength <span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>inf_llist <span class="free">t</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">-</span> <span class="main">1</span><span class="main">)</span><span class="main">)</span> <span class="main">-</span> <span class="main">(</span><span class="main">⟨</span><span class="free">c</span> <span class="main">∧</span> <span class="free">t</span><span class="main">⟩</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> bhv2cnf_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">⟨</span><span class="free">c</span> <span class="main">∧</span> <span class="free">t</span><span class="main">⟩</span> <span class="main">+</span> <span class="main">(</span><span class="free">n</span> <span class="main">-</span> <span class="main">(</span>the_enat<span class="main">(</span>llength <span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>inf_llist <span class="free">t</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">-</span> <span class="main">1</span><span class="main">)</span><span class="main">)</span> <span class="main">-</span> <span class="main">(</span><span class="main">⟨</span><span class="free">c</span> <span class="main">∧</span> <span class="free">t</span><span class="main">⟩</span><span class="main">)</span> <span class="main">=</span>
    <span class="main">⟨</span><span class="free">c</span> <span class="main">∧</span> <span class="free">t</span><span class="main">⟩</span> <span class="main">-</span> <span class="main">(</span><span class="main">⟨</span><span class="free">c</span> <span class="main">∧</span> <span class="free">t</span><span class="main">⟩</span><span class="main">)</span> <span class="main">+</span> <span class="main">(</span><span class="free">n</span> <span class="main">-</span> <span class="main">(</span>the_enat<span class="main">(</span>llength <span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>inf_llist <span class="free">t</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">-</span> <span class="main">1</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">…</span> <span class="main">=</span> <span class="free">n</span> <span class="main">-</span> <span class="main">(</span>the_enat<span class="main">(</span>llength <span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>inf_llist <span class="free">t</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">-</span> <span class="main">1</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>      
  <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"the_enat <span class="main">(</span>llength <span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>inf_llist <span class="free">t</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">-</span> <span class="main">1</span> <span class="main">+</span> <span class="main">(</span><span class="free">n</span> <span class="main">-</span> <span class="main">(</span>the_enat <span class="main">(</span>llength <span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>inf_llist <span class="free">t</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">-</span> <span class="main">1</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span>
    <span class="free">n</span> <span class="main">-</span> <span class="main">(</span>the_enat <span class="main">(</span>llength <span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>inf_llist <span class="free">t</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">-</span> <span class="main">1</span><span class="main">)</span> <span class="main">+</span> <span class="main">(</span>the_enat <span class="main">(</span>llength <span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>inf_llist <span class="free">t</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">-</span> <span class="main">1</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">…</span> <span class="main">=</span> <span class="free">n</span> <span class="main">+</span> <span class="main">(</span><span class="main">(</span>the_enat <span class="main">(</span>llength <span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>inf_llist <span class="free">t</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">-</span> <span class="main">1</span><span class="main">)</span> <span class="main">-</span>
    <span class="main">(</span>the_enat <span class="main">(</span>llength <span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>inf_llist <span class="free">t</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">-</span> <span class="main">1</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">…</span> <span class="main">=</span> <span class="var">?rhs</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">finally</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">.</span></span>
<span class="keyword1"><span class="command">qed</span></span>
  
<span class="keyword1" id="Configuration_Traces-p2c_mono_c2p"><span class="command">lemma</span></span> p2c_mono_c2p<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">n</span> <span class="main">≥</span> <span class="main">⟨</span><span class="free">c</span> <span class="main">∧</span> <span class="free">t</span><span class="main">⟩</span>"</span></span>
      <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">n'</span> <span class="main">≥</span> <span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span>↓<span class="hidden">⇘</span><sub><span class="free">t</span></sub><span class="hidden">⇙</span><span class="main">(</span><span class="free">n</span><span class="main">)</span>"</span></span>
    <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span>↑<span class="hidden">⇘</span><sub><span class="free">t</span></sub><span class="hidden">⇙</span><span class="main">(</span><span class="free">n'</span><span class="main">)</span> <span class="main">≥</span> <span class="free">n</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="free">n'</span> <span class="main">≥</span> <span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span>↓<span class="hidden">⇘</span><sub><span class="free">t</span></sub><span class="hidden">⇙</span><span class="main">(</span><span class="free">n</span><span class="main">)</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span>↑<span class="hidden">⇘</span><sub><span class="free">t</span></sub><span class="hidden">⇙</span><span class="main">(</span><span class="free">n'</span><span class="main">)</span> <span class="main">≥</span> <span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span>↑<span class="hidden">⇘</span><sub><span class="free">t</span></sub><span class="hidden">⇙</span><span class="main">(</span><span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span>↓<span class="hidden">⇘</span><sub><span class="free">t</span></sub><span class="hidden">⇙</span><span class="main">(</span><span class="free">n</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> bhv2cnf_mono <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> bhv2cnf_cnf2bhv <span class="quoted"><span class="quoted">‹<span class="free">n</span> <span class="main">≥</span> <span class="main">⟨</span><span class="free">c</span> <span class="main">∧</span> <span class="free">t</span><span class="main">⟩</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>
  
<span class="keyword1" id="Configuration_Traces-p2c_mono_c2p_strict"><span class="command">lemma</span></span> p2c_mono_c2p_strict<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">n</span> <span class="main">≥</span> <span class="main">⟨</span><span class="free">c</span> <span class="main">∧</span> <span class="free">t</span><span class="main">⟩</span>"</span></span>
      <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">n</span><span class="main">&lt;</span><span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span>↑<span class="hidden">⇘</span><sub><span class="free">t</span></sub><span class="hidden">⇙</span><span class="main">(</span><span class="free">n'</span><span class="main">)</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span>↓<span class="hidden">⇘</span><sub><span class="free">t</span></sub><span class="hidden">⇙</span><span class="main">(</span><span class="free">n</span><span class="main">)</span> <span class="main">&lt;</span> <span class="free">n'</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">rule</span> ccontr<span class="main">)</span>
  <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> <span class="main">(</span><span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span>↓<span class="hidden">⇘</span><sub><span class="free">t</span></sub><span class="hidden">⇙</span><span class="main">(</span><span class="free">n</span><span class="main">)</span> <span class="main">&lt;</span> <span class="free">n'</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span>↓<span class="hidden">⇘</span><sub><span class="free">t</span></sub><span class="hidden">⇙</span><span class="main">(</span><span class="free">n</span><span class="main">)</span> <span class="main">≥</span> <span class="free">n'</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">with</span></span> <span class="quoted"><span class="quoted">‹<span class="free">n</span> <span class="main">≥</span> <span class="main">⟨</span><span class="free">c</span> <span class="main">∧</span> <span class="free">t</span><span class="main">⟩</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span>↑<span class="hidden">⇘</span><sub><span class="free">t</span></sub><span class="hidden">⇙</span><span class="main">(</span>nat <span class="main">(</span><span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span>↓<span class="hidden">⇘</span><sub><span class="free">t</span></sub><span class="hidden">⇙</span><span class="main">(</span><span class="free">n</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">≥</span> <span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span>↑<span class="hidden">⇘</span><sub><span class="free">t</span></sub><span class="hidden">⇙</span><span class="main">(</span><span class="free">n'</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> bhv2cnf_mono <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span><span class="main">(</span><span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span>↑<span class="hidden">⇘</span><sub><span class="free">t</span></sub><span class="hidden">⇙</span><span class="main">(</span>nat <span class="main">(</span><span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span>↓<span class="hidden">⇘</span><sub><span class="free">t</span></sub><span class="hidden">⇙</span><span class="main">(</span><span class="free">n</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">&lt;</span> <span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span>↑<span class="hidden">⇘</span><sub><span class="free">t</span></sub><span class="hidden">⇙</span><span class="main">(</span><span class="free">n'</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">with</span></span> <span class="quoted"><span class="quoted">‹<span class="free">n</span> <span class="main">≥</span> <span class="main">⟨</span><span class="free">c</span> <span class="main">∧</span> <span class="free">t</span><span class="main">⟩</span>›</span></span> <span class="keyword1"><span class="command">have</span></span>  <span class="quoted"><span class="quoted">"<span class="main">¬</span><span class="main">(</span><span class="free">n</span> <span class="main">&lt;</span> <span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span>↑<span class="hidden">⇘</span><sub><span class="free">t</span></sub><span class="hidden">⇙</span><span class="main">(</span><span class="free">n'</span><span class="main">)</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> <span class="quoted">"bhv2cnf_cnf2bhv"</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">with</span></span> assms <span class="keyword3"><span class="command">show</span></span> <span class="quoted">False</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>
  
<span class="keyword1" id="Configuration_Traces-c2p_mono_p2c"><span class="command">lemma</span></span> c2p_mono_p2c<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">n</span> <span class="main">≥</span> the_enat <span class="main">(</span>llength <span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>inf_llist <span class="free">t</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">-</span> <span class="main">1</span>"</span></span>
      <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">n'</span> <span class="main">≥</span> <span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span>↑<span class="hidden">⇘</span><sub><span class="free">t</span></sub><span class="hidden">⇙</span><span class="main">(</span><span class="free">n</span><span class="main">)</span>"</span></span>
    <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span>↓<span class="hidden">⇘</span><sub><span class="free">t</span></sub><span class="hidden">⇙</span><span class="main">(</span><span class="free">n'</span><span class="main">)</span> <span class="main">≥</span> <span class="free">n</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="free">n'</span> <span class="main">≥</span> <span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span>↑<span class="hidden">⇘</span><sub><span class="free">t</span></sub><span class="hidden">⇙</span><span class="main">(</span><span class="free">n</span><span class="main">)</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span>↓<span class="hidden">⇘</span><sub><span class="free">t</span></sub><span class="hidden">⇙</span><span class="main">(</span><span class="free">n'</span><span class="main">)</span> <span class="main">≥</span> <span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span>↓<span class="hidden">⇘</span><sub><span class="free">t</span></sub><span class="hidden">⇙</span><span class="main">(</span><span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span>↑<span class="hidden">⇘</span><sub><span class="free">t</span></sub><span class="hidden">⇙</span><span class="main">(</span><span class="free">n</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> cnf2bhv_mono <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> cnf2bhv_bhv2cnf <span class="quoted"><span class="quoted">‹<span class="free">n</span> <span class="main">≥</span> the_enat <span class="main">(</span>llength <span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>inf_llist <span class="free">t</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">-</span> <span class="main">1</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="Configuration_Traces-c2p_mono_p2c_strict"><span class="command">lemma</span></span> c2p_mono_p2c_strict<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">n</span> <span class="main">≥</span> the_enat <span class="main">(</span>llength <span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>inf_llist <span class="free">t</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">-</span> <span class="main">1</span>"</span></span>
      <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">n</span><span class="main">&lt;</span><span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span>↓<span class="hidden">⇘</span><sub><span class="free">t</span></sub><span class="hidden">⇙</span><span class="main">(</span><span class="free">n'</span><span class="main">)</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span>↑<span class="hidden">⇘</span><sub><span class="free">t</span></sub><span class="hidden">⇙</span><span class="main">(</span><span class="free">n</span><span class="main">)</span> <span class="main">&lt;</span> <span class="free">n'</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">rule</span> ccontr<span class="main">)</span>
  <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> <span class="main">(</span><span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span>↑<span class="hidden">⇘</span><sub><span class="free">t</span></sub><span class="hidden">⇙</span><span class="main">(</span><span class="free">n</span><span class="main">)</span> <span class="main">&lt;</span> <span class="free">n'</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span>↑<span class="hidden">⇘</span><sub><span class="free">t</span></sub><span class="hidden">⇙</span><span class="main">(</span><span class="free">n</span><span class="main">)</span> <span class="main">≥</span> <span class="free">n'</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">with</span></span> <span class="quoted"><span class="quoted">‹<span class="free">n</span> <span class="main">≥</span> the_enat <span class="main">(</span>llength <span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>inf_llist <span class="free">t</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">-</span> <span class="main">1</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span>↓<span class="hidden">⇘</span><sub><span class="free">t</span></sub><span class="hidden">⇙</span><span class="main">(</span>nat <span class="main">(</span><span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span>↑<span class="hidden">⇘</span><sub><span class="free">t</span></sub><span class="hidden">⇙</span><span class="main">(</span><span class="free">n</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">≥</span> <span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span>↓<span class="hidden">⇘</span><sub><span class="free">t</span></sub><span class="hidden">⇙</span><span class="main">(</span><span class="free">n'</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> cnf2bhv_mono <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span><span class="main">(</span><span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span>↓<span class="hidden">⇘</span><sub><span class="free">t</span></sub><span class="hidden">⇙</span><span class="main">(</span>nat <span class="main">(</span><span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span>↑<span class="hidden">⇘</span><sub><span class="free">t</span></sub><span class="hidden">⇙</span><span class="main">(</span><span class="free">n</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">&lt;</span> <span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span>↓<span class="hidden">⇘</span><sub><span class="free">t</span></sub><span class="hidden">⇙</span><span class="main">(</span><span class="free">n'</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">with</span></span> <span class="quoted"><span class="quoted">‹<span class="free">n</span> <span class="main">≥</span> the_enat <span class="main">(</span>llength <span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>inf_llist <span class="free">t</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">-</span> <span class="main">1</span>›</span></span> <span class="keyword1"><span class="command">have</span></span>  <span class="quoted"><span class="quoted">"<span class="main">¬</span><span class="main">(</span><span class="free">n</span> <span class="main">&lt;</span> <span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span>↓<span class="hidden">⇘</span><sub><span class="free">t</span></sub><span class="hidden">⇙</span><span class="main">(</span><span class="free">n'</span><span class="main">)</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> <span class="quoted">"cnf2bhv_bhv2cnf"</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">with</span></span> assms <span class="keyword3"><span class="command">show</span></span> <span class="quoted">False</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword2"><span class="keyword">end</span></span>

<span class="keyword2"><span class="keyword">end</span></span>
</pre>
</div><div id="Dynamic_Architecture_Calculus">
<div class="head">
<h1>Theory Dynamic_Architecture_Calculus</h1>
</div>
<pre class="source"><span class="comment1">(*
  Title:      Dynamic_Architecture_Calculus
  Author:     Diego Marmsoler
*)</span>
<span class="keyword1"><span class="command">section</span></span> <span class="quoted"><span class="plain_text">"A Calculus for Dynamic Architectures"</span></span>
<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹
  The following theory formalizes our calculus for dynamic architectures~\cite{Marmsoler2017b,Marmsoler2017c} and verifies its soundness.
  The calculus allows to reason about temporal-logic specifications of component behavior in a dynamic setting.
  The theory is based on our theory of configuration traces and introduces the notion of behavior trace assertion to specify component behavior in a dynamic setting.
›</span></span>
<span class="keyword1"><span class="command">theory</span></span> Dynamic_Architecture_Calculus
  <span class="keyword2"><span class="keyword">imports</span></span> <a href="Configuration_Traces.html">Configuration_Traces</a>
<span class="keyword2"><span class="keyword">begin</span></span>

<span class="keyword1"><span class="command">subsection</span></span> <span class="quoted"><span class="plain_text">"Extended Natural Numbers"</span></span>
<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹
  We first provide one additional property for extended natural numbers.
›</span></span>

<span class="keyword1" id="Dynamic_Architecture_Calculus-the_enat_mono"><span class="command">lemma</span></span> the_enat_mono<span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">m</span> <span class="main">≠</span> <span class="main">∞</span>"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">n</span> <span class="main">≤</span> <span class="free">m</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"the_enat <span class="free">n</span> <span class="main">≤</span> the_enat <span class="free">m</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>1<span class="main">)</span> assms<span class="main">(</span>2<span class="main">)</span> enat_ile <span class="keyword1"><span class="command">by</span></span> <span class="operator">fastforce</span>
    
<span class="keyword1"><span class="command">subsection</span></span> <span class="quoted"><span class="plain_text">"Lazy Lists"</span></span>
<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹
  Finally, we provide an additional property for lazy lists.
›</span></span>
  
<span class="keyword1" id="Dynamic_Architecture_Calculus-llength_geq_enat_lfiniteD"><span class="command">lemma</span></span> llength_geq_enat_lfiniteD<span class="main">:</span> <span class="quoted"><span class="quoted">"llength <span class="free">xs</span> <span class="main">≤</span> enat <span class="free">n</span> <span class="main">⟹</span> lfinite <span class="free">xs</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> not_lfinite_llength <span class="keyword1"><span class="command">by</span></span> <span class="operator">force</span>

<span class="keyword1"><span class="command">context</span></span> dynamic_component
<span class="keyword2"><span class="keyword">begin</span></span>

<span class="keyword1"><span class="command">subsection</span></span> <span class="quoted"><span class="plain_text">"Dynamic Evaluation of Temporal Operators"</span></span>
<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹
  In the following we introduce a function to evaluate a behavior trace assertion over a given configuration trace.
›</span></span>
<span class="keyword1"><span class="command">type_synonym</span></span> <span class="tfree">'c</span> bta <span class="main">=</span> <span class="quoted"><span class="quoted">"<span class="main">(</span>nat <span class="main">⇒</span> <span class="tfree">'c</span><span class="main">)</span> <span class="main">⇒</span> nat <span class="main">⇒</span> bool"</span></span>

<span class="keyword1"><span class="command">definition</span></span> <span class="entity">eval</span><span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'id</span> <span class="main">⇒</span> <span class="main">(</span>nat <span class="main">⇒</span> cnf<span class="main">)</span> <span class="main">⇒</span> <span class="main">(</span>nat <span class="main">⇒</span> <span class="tfree">'cmp</span><span class="main">)</span> <span class="main">⇒</span> nat
  <span class="main">⇒</span> <span class="tfree">'cmp</span> bta <span class="main">⇒</span> bool"</span></span>
  <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="free">eval</span> <span class="free"><span class="bound"><span class="entity">cid</span></span></span> <span class="free"><span class="bound"><span class="entity">t</span></span></span> <span class="free"><span class="bound"><span class="entity">t'</span></span></span> <span class="free"><span class="bound"><span class="entity">n</span></span></span> <span class="free"><span class="bound"><span class="entity">γ</span></span></span> <span class="main">≡</span>
    <span class="main">(</span><span class="main">∃</span><span class="bound"><span class="bound">i</span></span><span class="main">≥</span><span class="free"><span class="bound"><span class="entity">n</span></span></span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free"><span class="bound"><span class="entity">cid</span></span></span>∥<span class="hidden">⇘</span><sub><span class="free"><span class="bound"><span class="entity">t</span></span></span> <span class="bound">i</span></sub><span class="hidden">⇙</span><span class="main">)</span> <span class="main">∧</span> <span class="free"><span class="bound"><span class="entity">γ</span></span></span> <span class="main">(</span>lnth <span class="main">(</span><span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free"><span class="bound"><span class="entity">cid</span></span></span></sub><span class="hidden">⇙</span><span class="main">(</span>inf_llist <span class="free"><span class="bound"><span class="entity">t</span></span></span><span class="main">)</span><span class="main">)</span> <span class="keyword1">@<span class="hidden">⇩</span><sub>l</sub></span> <span class="main">(</span>inf_llist <span class="free"><span class="bound"><span class="entity">t'</span></span></span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">(</span>the_enat<span class="main">(</span><span class="main">⟨</span><span class="free"><span class="bound"><span class="entity">cid</span></span></span> #<span class="hidden">⇘</span><sub><span class="free"><span class="bound"><span class="entity">n</span></span></span></sub><span class="hidden">⇙</span> inf_llist <span class="free"><span class="bound"><span class="entity">t</span></span></span><span class="main">⟩</span><span class="main">)</span><span class="main">)</span> <span class="main">∨</span>
    <span class="main">(</span><span class="main">∃</span><span class="bound">i</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free"><span class="bound"><span class="entity">cid</span></span></span>∥<span class="hidden">⇘</span><sub><span class="free"><span class="bound"><span class="entity">t</span></span></span> <span class="bound">i</span></sub><span class="hidden">⇙</span><span class="main">)</span> <span class="main">∧</span> <span class="main">(</span><span class="main">∄</span><span class="bound">i'</span><span class="main">.</span> <span class="bound">i'</span><span class="main">≥</span><span class="free"><span class="bound"><span class="entity">n</span></span></span> <span class="main">∧</span> <span class="main"><span class="free">∥</span></span><span class="free"><span class="bound"><span class="entity">cid</span></span></span>∥<span class="hidden">⇘</span><sub><span class="free"><span class="bound"><span class="entity">t</span></span></span> <span class="bound">i'</span></sub><span class="hidden">⇙</span><span class="main">)</span> <span class="main">∧</span> <span class="free"><span class="bound"><span class="entity">γ</span></span></span> <span class="main">(</span>lnth <span class="main">(</span><span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free"><span class="bound"><span class="entity">cid</span></span></span></sub><span class="hidden">⇙</span><span class="main">(</span>inf_llist <span class="free"><span class="bound"><span class="entity">t</span></span></span><span class="main">)</span><span class="main">)</span> <span class="keyword1">@<span class="hidden">⇩</span><sub>l</sub></span> <span class="main">(</span>inf_llist <span class="free"><span class="bound"><span class="entity">t'</span></span></span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">(</span><span class="hidden">⇘</span><sub><span class="free"><span class="bound"><span class="entity">cid</span></span></span></sub><span class="hidden">⇙</span>↓<span class="hidden">⇘</span><sub><span class="free"><span class="bound"><span class="entity">t</span></span></span></sub><span class="hidden">⇙</span><span class="main">(</span><span class="free"><span class="bound"><span class="entity">n</span></span></span><span class="main">)</span><span class="main">)</span> <span class="main">∨</span>
    <span class="main">(</span><span class="main">∄</span><span class="bound">i</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free"><span class="bound"><span class="entity">cid</span></span></span>∥<span class="hidden">⇘</span><sub><span class="free"><span class="bound"><span class="entity">t</span></span></span> <span class="bound">i</span></sub><span class="hidden">⇙</span><span class="main">)</span> <span class="main">∧</span> <span class="free"><span class="bound"><span class="entity">γ</span></span></span> <span class="main">(</span>lnth <span class="main">(</span><span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free"><span class="bound"><span class="entity">cid</span></span></span></sub><span class="hidden">⇙</span><span class="main">(</span>inf_llist <span class="free"><span class="bound"><span class="entity">t</span></span></span><span class="main">)</span><span class="main">)</span> <span class="keyword1">@<span class="hidden">⇩</span><sub>l</sub></span> <span class="main">(</span>inf_llist <span class="free"><span class="bound"><span class="entity">t'</span></span></span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="free"><span class="bound"><span class="entity">n</span></span></span>"</span></span>
<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹
  <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">const</span></span> eval<span class="antiquote"><span class="antiquote">}</span></span></span></span> takes a component identifier <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">term</span></span> <span class="quoted"><span class="free"><span class="quoted"><span class="free">cid</span></span></span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span>, a configuration trace <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">term</span></span> <span class="quoted"><span class="free"><span class="quoted"><span class="free">t</span></span></span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span>, a behavior trace <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">term</span></span> <span class="quoted"><span class="free"><span class="quoted"><span class="free">t'</span></span></span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span>, and point in time <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">term</span></span> <span class="quoted"><span class="free"><span class="quoted"><span class="free">n</span></span></span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span> and evaluates behavior trace assertion <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">term</span></span> <span class="quoted"><span class="free"><span class="quoted"><span class="free">γ</span></span></span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span> as follows:
  \begin{itemize}
    \item If component <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">term</span></span> <span class="quoted"><span class="free"><span class="quoted"><span class="free">cid</span></span></span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span> is again activated in the future, <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">term</span></span> <span class="quoted"><span class="free"><span class="quoted"><span class="free">γ</span></span></span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span> is evaluated at the next point in time where <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">term</span></span> <span class="quoted"><span class="free"><span class="quoted"><span class="free">cid</span></span></span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span> is active in <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">term</span></span> <span class="quoted"><span class="free"><span class="quoted"><span class="free">t</span></span></span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span>.
    \item If component <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">term</span></span> <span class="quoted"><span class="free"><span class="quoted"><span class="free">cid</span></span></span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span> is not again activated in the future but it is activated at least once in <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">term</span></span> <span class="quoted"><span class="free"><span class="quoted"><span class="free">t</span></span></span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span>, then <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">term</span></span> <span class="quoted"><span class="free"><span class="quoted"><span class="free">γ</span></span></span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span> is evaluated at the point in time given by <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">term</span></span> <span class="quoted"><span class="quoted">"<span class="main"><span class="main">(</span></span><span class="hidden">⇘</span><sub><span class="free"><span class="free">cid</span></span></sub><span class="hidden">⇙</span>↓<span class="hidden">⇘</span><sub><span class="free"><span class="free">t</span></span></sub><span class="hidden">⇙</span><span class="main"><span class="main">(</span></span><span class="free"><span class="free">n</span></span><span class="main"><span class="main">)</span></span><span class="main"><span class="main">)</span></span>"</span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span>.
    \item If component <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">term</span></span> <span class="quoted"><span class="free"><span class="quoted"><span class="free">cid</span></span></span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span> is never active in <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">term</span></span> <span class="quoted"><span class="free"><span class="quoted"><span class="free">t</span></span></span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span>, then <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">term</span></span> <span class="quoted"><span class="free"><span class="quoted"><span class="free">γ</span></span></span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span> is evaluated at time point <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">term</span></span> <span class="quoted"><span class="free"><span class="quoted"><span class="free">n</span></span></span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span>.
  \end{itemize}
›</span></span>
  
<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹
  The following proposition evaluates definition <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">const</span></span> eval<span class="antiquote"><span class="antiquote">}</span></span></span></span> by showing that a behavior trace assertion <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">term</span></span> <span class="quoted"><span class="free"><span class="quoted"><span class="free">γ</span></span></span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span> holds over configuration trace <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">term</span></span> <span class="quoted"><span class="free"><span class="quoted"><span class="free">t</span></span></span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span> and continuation <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">term</span></span> <span class="quoted"><span class="free"><span class="quoted"><span class="free">t'</span></span></span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span> whenever it holds for the concatenation of the corresponding projection with <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">term</span></span> <span class="quoted"><span class="free"><span class="quoted"><span class="free">t'</span></span></span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span>.
›</span></span>
<span class="keyword1"><span class="command">proposition</span></span> eval_corr<span class="main">:</span>
  <span class="quoted"><span class="quoted">"eval <span class="free">cid</span> <span class="free">t</span> <span class="free">t'</span> <span class="main">0</span> <span class="free">γ</span> <span class="main">⟷</span> <span class="free">γ</span> <span class="main">(</span>lnth <span class="main">(</span><span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">cid</span></sub><span class="hidden">⇙</span><span class="main">(</span>inf_llist <span class="free">t</span><span class="main">)</span><span class="main">)</span> <span class="keyword1">@<span class="hidden">⇩</span><sub>l</sub></span> <span class="main">(</span>inf_llist <span class="free">t'</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">0</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span>
  <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"eval <span class="free">cid</span> <span class="free">t</span> <span class="free">t'</span> <span class="main">0</span> <span class="free">γ</span>"</span></span>
  <span class="keyword1"><span class="command">with</span></span> eval_def <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">∃</span><span class="bound"><span class="bound">i</span></span><span class="main">≥</span><span class="main">0</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">cid</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i</span></sub><span class="hidden">⇙</span><span class="main">)</span> <span class="main">∧</span>
  <span class="free">γ</span> <span class="main">(</span>lnth <span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">cid</span></sub><span class="hidden">⇙</span>inf_llist <span class="free">t</span> <span class="keyword1">@<span class="hidden">⇩</span><sub>l</sub></span> inf_llist <span class="free">t'</span><span class="main">)</span><span class="main">)</span> <span class="main">(</span>the_enat <span class="main">⟨</span><span class="free">cid</span> #<span class="hidden">⇘</span><sub>enat <span class="main">0</span></sub><span class="hidden">⇙</span>inf_llist <span class="free">t</span><span class="main">⟩</span><span class="main">)</span> <span class="main">∨</span>
  <span class="main">(</span><span class="main">∃</span><span class="bound">i</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">cid</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i</span></sub><span class="hidden">⇙</span><span class="main">)</span> <span class="main">∧</span> <span class="main">¬</span> <span class="main">(</span><span class="main">∃</span><span class="bound"><span class="bound">i'</span></span><span class="main">≥</span><span class="main">0</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">cid</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i'</span></sub><span class="hidden">⇙</span><span class="main">)</span> <span class="main">∧</span> <span class="free">γ</span> <span class="main">(</span>lnth <span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">cid</span></sub><span class="hidden">⇙</span>inf_llist <span class="free">t</span> <span class="keyword1">@<span class="hidden">⇩</span><sub>l</sub></span> inf_llist <span class="free">t'</span><span class="main">)</span><span class="main">)</span> <span class="main">(</span><span class="hidden">⇘</span><sub><span class="free">cid</span></sub><span class="hidden">⇙</span>↓<span class="hidden">⇘</span><sub><span class="free">t</span></sub><span class="hidden">⇙</span><span class="main">0</span><span class="main">)</span> <span class="main">∨</span>
  <span class="main">(</span><span class="main">∄</span><span class="bound">i</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">cid</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i</span></sub><span class="hidden">⇙</span><span class="main">)</span> <span class="main">∧</span> <span class="free">γ</span> <span class="main">(</span>lnth <span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">cid</span></sub><span class="hidden">⇙</span>inf_llist <span class="free">t</span> <span class="keyword1">@<span class="hidden">⇩</span><sub>l</sub></span> inf_llist <span class="free">t'</span><span class="main">)</span><span class="main">)</span> <span class="main">0</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"<span class="free">γ</span> <span class="main">(</span>lnth <span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">cid</span></sub><span class="hidden">⇙</span>inf_llist <span class="free">t</span> <span class="keyword1">@<span class="hidden">⇩</span><sub>l</sub></span> inf_llist <span class="free">t'</span><span class="main">)</span><span class="main">)</span> <span class="main">0</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span>
    <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">∃</span><span class="bound"><span class="bound">i</span></span><span class="main">≥</span><span class="main">0</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">cid</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i</span></sub><span class="hidden">⇙</span><span class="main">)</span> <span class="main">∧</span> <span class="free">γ</span> <span class="main">(</span>lnth <span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">cid</span></sub><span class="hidden">⇙</span>inf_llist <span class="free">t</span> <span class="keyword1">@<span class="hidden">⇩</span><sub>l</sub></span> inf_llist <span class="free">t'</span><span class="main">)</span><span class="main">)</span> <span class="main">(</span>the_enat <span class="main">⟨</span><span class="free">cid</span> #<span class="hidden">⇘</span><sub>enat <span class="main">0</span></sub><span class="hidden">⇙</span>inf_llist <span class="free">t</span><span class="main">⟩</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"the_enat <span class="main">⟨</span><span class="free">cid</span> #<span class="hidden">⇘</span><sub>enat <span class="main">0</span></sub><span class="hidden">⇙</span>inf_llist <span class="free">t</span><span class="main">⟩</span> <span class="main">=</span> <span class="main">0</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> zero_enat_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">next</span></span>
    <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">∃</span><span class="bound">i</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">cid</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i</span></sub><span class="hidden">⇙</span><span class="main">)</span> <span class="main">∧</span> <span class="main">¬</span> <span class="main">(</span><span class="main">∃</span><span class="bound"><span class="bound">i'</span></span><span class="main">≥</span><span class="main">0</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">cid</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i'</span></sub><span class="hidden">⇙</span><span class="main">)</span> <span class="main">∧</span> <span class="free">γ</span> <span class="main">(</span>lnth <span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">cid</span></sub><span class="hidden">⇙</span>inf_llist <span class="free">t</span> <span class="keyword1">@<span class="hidden">⇩</span><sub>l</sub></span> inf_llist <span class="free">t'</span><span class="main">)</span><span class="main">)</span> <span class="main">(</span><span class="hidden">⇘</span><sub><span class="free">cid</span></sub><span class="hidden">⇙</span>↓<span class="hidden">⇘</span><sub><span class="free">t</span></sub><span class="hidden">⇙</span><span class="main">0</span><span class="main">)</span> <span class="main">∨</span>
    <span class="main">(</span><span class="main">∄</span><span class="bound">i</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">cid</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i</span></sub><span class="hidden">⇙</span><span class="main">)</span> <span class="main">∧</span> <span class="free">γ</span> <span class="main">(</span>lnth <span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">cid</span></sub><span class="hidden">⇙</span>inf_llist <span class="free">t</span> <span class="keyword1">@<span class="hidden">⇩</span><sub>l</sub></span> inf_llist <span class="free">t'</span><span class="main">)</span><span class="main">)</span> <span class="main">0</span>"</span></span>
    <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">qed</span></span>
<span class="keyword1"><span class="command">next</span></span>
  <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="free">γ</span> <span class="main">(</span>lnth <span class="main">(</span><span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">cid</span></sub><span class="hidden">⇙</span><span class="main">(</span>inf_llist <span class="free">t</span><span class="main">)</span><span class="main">)</span> <span class="keyword1">@<span class="hidden">⇩</span><sub>l</sub></span> <span class="main">(</span>inf_llist <span class="free">t'</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">0</span>"</span></span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"eval <span class="free">cid</span> <span class="free">t</span> <span class="free">t'</span> <span class="main">0</span> <span class="free">γ</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="operator">cases</span>
    <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound">i</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">cid</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i</span></sub><span class="hidden">⇙</span>"</span></span>
    <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound"><span class="bound">i</span></span><span class="main">≥</span><span class="main">0</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">cid</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i</span></sub><span class="hidden">⇙</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="free">γ</span> <span class="main">(</span>lnth <span class="main">(</span><span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">cid</span></sub><span class="hidden">⇙</span><span class="main">(</span>inf_llist <span class="free">t</span><span class="main">)</span><span class="main">)</span> <span class="keyword1">@<span class="hidden">⇩</span><sub>l</sub></span> <span class="main">(</span>inf_llist <span class="free">t'</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">0</span>›</span></span> <span class="keyword1"><span class="command">have</span></span>
      <span class="quoted"><span class="quoted">"<span class="free">γ</span> <span class="main">(</span>lnth <span class="main">(</span><span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">cid</span></sub><span class="hidden">⇙</span><span class="main">(</span>inf_llist <span class="free">t</span><span class="main">)</span><span class="main">)</span> <span class="keyword1">@<span class="hidden">⇩</span><sub>l</sub></span> <span class="main">(</span>inf_llist <span class="free">t'</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">(</span>the_enat<span class="main">(</span><span class="main">⟨</span><span class="free">cid</span> #<span class="hidden">⇘</span><sub>enat <span class="main">0</span></sub><span class="hidden">⇙</span> inf_llist <span class="free">t</span><span class="main">⟩</span><span class="main">)</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> zero_enat_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> eval_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">next</span></span>
    <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">∄</span><span class="bound">i</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">cid</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i</span></sub><span class="hidden">⇙</span>"</span></span>
    <span class="keyword1"><span class="command">with</span></span> <span class="quoted"><span class="quoted">‹<span class="free">γ</span> <span class="main">(</span>lnth <span class="main">(</span><span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">cid</span></sub><span class="hidden">⇙</span><span class="main">(</span>inf_llist <span class="free">t</span><span class="main">)</span><span class="main">)</span> <span class="keyword1">@<span class="hidden">⇩</span><sub>l</sub></span> <span class="main">(</span>inf_llist <span class="free">t'</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">0</span>›</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> eval_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">qed</span></span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">subsubsection</span></span> <span class="quoted"><span class="plain_text">"Simplification Rules"</span></span>

<span class="keyword1" id="Dynamic_Architecture_Calculus-validCI_act"><span class="command">lemma</span></span> validCI_act<span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound"><span class="bound">i</span></span><span class="main">≥</span><span class="free">n</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">cid</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i</span></sub><span class="hidden">⇙</span>"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">γ</span> <span class="main">(</span>lnth <span class="main">(</span><span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">cid</span></sub><span class="hidden">⇙</span><span class="main">(</span>inf_llist <span class="free">t</span><span class="main">)</span><span class="main">)</span> <span class="keyword1">@<span class="hidden">⇩</span><sub>l</sub></span> <span class="main">(</span>inf_llist <span class="free">t'</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">(</span>the_enat<span class="main">(</span><span class="main">⟨</span><span class="free">cid</span> #<span class="hidden">⇘</span><sub><span class="free">n</span></sub><span class="hidden">⇙</span> inf_llist <span class="free">t</span><span class="main">⟩</span><span class="main">)</span><span class="main">)</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"eval <span class="free">cid</span> <span class="free">t</span> <span class="free">t'</span> <span class="free">n</span> <span class="free">γ</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> assms eval_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>

<span class="keyword1" id="Dynamic_Architecture_Calculus-validCI_cont"><span class="command">lemma</span></span> validCI_cont<span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound">i</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">cid</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i</span></sub><span class="hidden">⇙</span>"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">∄</span><span class="bound">i'</span><span class="main">.</span> <span class="bound">i'</span><span class="main">≥</span><span class="free">n</span> <span class="main">∧</span> <span class="main"><span class="free">∥</span></span><span class="free">cid</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i'</span></sub><span class="hidden">⇙</span>"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">γ</span> <span class="main">(</span>lnth <span class="main">(</span><span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">cid</span></sub><span class="hidden">⇙</span><span class="main">(</span>inf_llist <span class="free">t</span><span class="main">)</span><span class="main">)</span> <span class="keyword1">@<span class="hidden">⇩</span><sub>l</sub></span> <span class="main">(</span>inf_llist <span class="free">t'</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">(</span><span class="hidden">⇘</span><sub><span class="free">cid</span></sub><span class="hidden">⇙</span>↓<span class="hidden">⇘</span><sub><span class="free">t</span></sub><span class="hidden">⇙</span><span class="main">(</span><span class="free">n</span><span class="main">)</span><span class="main">)</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"eval <span class="free">cid</span> <span class="free">t</span> <span class="free">t'</span> <span class="free">n</span> <span class="free">γ</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> assms eval_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>

<span class="keyword1" id="Dynamic_Architecture_Calculus-validCI_not_act"><span class="command">lemma</span></span> validCI_not_act<span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="main">∄</span><span class="bound">i</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">cid</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i</span></sub><span class="hidden">⇙</span>"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">γ</span> <span class="main">(</span>lnth <span class="main">(</span><span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">cid</span></sub><span class="hidden">⇙</span><span class="main">(</span>inf_llist <span class="free">t</span><span class="main">)</span><span class="main">)</span> <span class="keyword1">@<span class="hidden">⇩</span><sub>l</sub></span> <span class="main">(</span>inf_llist <span class="free">t'</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="free">n</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"eval <span class="free">cid</span> <span class="free">t</span> <span class="free">t'</span> <span class="free">n</span> <span class="free">γ</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> assms eval_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>

<span class="keyword1" id="Dynamic_Architecture_Calculus-validCE_act"><span class="command">lemma</span></span> validCE_act<span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound"><span class="bound">i</span></span><span class="main">≥</span><span class="free">n</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">cid</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i</span></sub><span class="hidden">⇙</span>"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"eval <span class="free">cid</span> <span class="free">t</span> <span class="free">t'</span> <span class="free">n</span> <span class="free">γ</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">γ</span> <span class="main">(</span>lnth <span class="main">(</span><span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">cid</span></sub><span class="hidden">⇙</span><span class="main">(</span>inf_llist <span class="free">t</span><span class="main">)</span><span class="main">)</span> <span class="keyword1">@<span class="hidden">⇩</span><sub>l</sub></span> <span class="main">(</span>inf_llist <span class="free">t'</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">(</span>the_enat<span class="main">(</span><span class="main">⟨</span><span class="free">cid</span> #<span class="hidden">⇘</span><sub><span class="free">n</span></sub><span class="hidden">⇙</span> inf_llist <span class="free">t</span><span class="main">⟩</span><span class="main">)</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> assms eval_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    
<span class="keyword1" id="Dynamic_Architecture_Calculus-validCE_cont"><span class="command">lemma</span></span> validCE_cont<span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound">i</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">cid</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i</span></sub><span class="hidden">⇙</span>"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">∄</span><span class="bound">i'</span><span class="main">.</span> <span class="bound">i'</span><span class="main">≥</span><span class="free">n</span> <span class="main">∧</span> <span class="main"><span class="free">∥</span></span><span class="free">cid</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i'</span></sub><span class="hidden">⇙</span>"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"eval <span class="free">cid</span> <span class="free">t</span> <span class="free">t'</span> <span class="free">n</span> <span class="free">γ</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">γ</span> <span class="main">(</span>lnth <span class="main">(</span><span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">cid</span></sub><span class="hidden">⇙</span><span class="main">(</span>inf_llist <span class="free">t</span><span class="main">)</span><span class="main">)</span> <span class="keyword1">@<span class="hidden">⇩</span><sub>l</sub></span> <span class="main">(</span>inf_llist <span class="free">t'</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">(</span><span class="hidden">⇘</span><sub><span class="free">cid</span></sub><span class="hidden">⇙</span>↓<span class="hidden">⇘</span><sub><span class="free">t</span></sub><span class="hidden">⇙</span><span class="main">(</span><span class="free">n</span><span class="main">)</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> assms eval_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1" id="Dynamic_Architecture_Calculus-validCE_not_act"><span class="command">lemma</span></span> validCE_not_act<span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="main">∄</span><span class="bound">i</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">cid</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i</span></sub><span class="hidden">⇙</span>"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"eval <span class="free">cid</span> <span class="free">t</span> <span class="free">t'</span> <span class="free">n</span> <span class="free">γ</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">γ</span> <span class="main">(</span>lnth <span class="main">(</span><span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">cid</span></sub><span class="hidden">⇙</span><span class="main">(</span>inf_llist <span class="free">t</span><span class="main">)</span><span class="main">)</span> <span class="keyword1">@<span class="hidden">⇩</span><sub>l</sub></span> <span class="main">(</span>inf_llist <span class="free">t'</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="free">n</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> assms eval_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    
<span class="keyword1"><span class="command">subsubsection</span></span> <span class="quoted"><span class="plain_text">"No Activations"</span></span>

<span class="keyword1"><span class="command">proposition</span></span> validity1<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">n</span><span class="main">≤</span><span class="free">n'</span>"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound"><span class="bound">i</span></span><span class="main">≥</span><span class="free">n'</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i</span></sub><span class="hidden">⇙</span>"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound"><span class="bound">k</span></span><span class="main">≥</span><span class="free">n</span><span class="main">.</span> <span class="bound">k</span><span class="main">&lt;</span><span class="free">n'</span> <span class="main">⟶</span> <span class="main">¬</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">k</span></sub><span class="hidden">⇙</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"eval <span class="free">c</span> <span class="free">t</span> <span class="free">t'</span> <span class="free">n</span> <span class="free">γ</span> <span class="main">⟹</span> eval <span class="free">c</span> <span class="free">t</span> <span class="free">t'</span> <span class="free">n'</span> <span class="free">γ</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"eval <span class="free">c</span> <span class="free">t</span> <span class="free">t'</span> <span class="free">n</span> <span class="free">γ</span>"</span></span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> assms <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound"><span class="bound">i</span></span><span class="main">≥</span><span class="free">n</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i</span></sub><span class="hidden">⇙</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">meson</span> order.trans<span class="main">)</span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">γ</span> <span class="main">(</span>lnth <span class="main">(</span><span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>inf_llist <span class="free">t</span><span class="main">)</span><span class="main">)</span> <span class="keyword1">@<span class="hidden">⇩</span><sub>l</sub></span> <span class="main">(</span>inf_llist <span class="free">t'</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">(</span>the_enat <span class="main">(</span><span class="main">⟨</span><span class="free">c</span> #<span class="hidden">⇘</span><sub>enat <span class="free">n</span></sub><span class="hidden">⇙</span> inf_llist <span class="free">t</span><span class="main">⟩</span><span class="main">)</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> validCE_act <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"enat <span class="free">n'</span> <span class="main">-</span> <span class="main">1</span> <span class="main">&lt;</span> llength <span class="main">(</span>inf_llist <span class="free">t</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> one_enat_def<span class="main">)</span>
  <span class="keyword1"><span class="command">with</span></span> assms <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"the_enat <span class="main">(</span><span class="main">⟨</span><span class="free">c</span> #<span class="hidden">⇘</span><sub>enat <span class="free">n</span></sub><span class="hidden">⇙</span> inf_llist <span class="free">t</span><span class="main">⟩</span><span class="main">)</span> <span class="main">=</span> the_enat <span class="main">(</span><span class="main">⟨</span><span class="free">c</span> #<span class="hidden">⇘</span><sub>enat <span class="free">n'</span></sub><span class="hidden">⇙</span> inf_llist <span class="free">t</span><span class="main">⟩</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> nAct_not_active_same<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="free">n</span></span> <span class="quoted"><span class="free">n'</span></span> <span class="quoted"><span class="quoted">"inf_llist <span class="free">t</span>"</span></span> <span class="quoted"><span class="free">c</span></span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">γ</span> <span class="main">(</span>lnth <span class="main">(</span><span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>inf_llist <span class="free">t</span><span class="main">)</span><span class="main">)</span> <span class="keyword1">@<span class="hidden">⇩</span><sub>l</sub></span> <span class="main">(</span>inf_llist <span class="free">t'</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">(</span>the_enat <span class="main">(</span><span class="main">⟨</span><span class="free">c</span> #<span class="hidden">⇘</span><sub>enat <span class="free">n'</span></sub><span class="hidden">⇙</span> inf_llist <span class="free">t</span><span class="main">⟩</span><span class="main">)</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>     
  <span class="keyword1"><span class="command">with</span></span> assms <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> validCI_act <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
<span class="keyword1"><span class="command">qed</span></span>
  
<span class="keyword1"><span class="command">proposition</span></span> validity2<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">n</span><span class="main">≤</span><span class="free">n'</span>"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound"><span class="bound">i</span></span><span class="main">≥</span><span class="free">n'</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i</span></sub><span class="hidden">⇙</span>"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound"><span class="bound">k</span></span><span class="main">≥</span><span class="free">n</span><span class="main">.</span> <span class="bound">k</span><span class="main">&lt;</span><span class="free">n'</span> <span class="main">⟶</span> <span class="main">¬</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">k</span></sub><span class="hidden">⇙</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"eval <span class="free">c</span> <span class="free">t</span> <span class="free">t'</span> <span class="free">n'</span> <span class="free">γ</span> <span class="main">⟹</span> eval <span class="free">c</span> <span class="free">t</span> <span class="free">t'</span> <span class="free">n</span> <span class="free">γ</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"eval <span class="free">c</span> <span class="free">t</span> <span class="free">t'</span> <span class="free">n'</span> <span class="free">γ</span>"</span></span>
  <span class="keyword1"><span class="command">with</span></span> <span class="quoted"><span class="quoted">‹<span class="main">∃</span><span class="bound"><span class="bound">i</span></span><span class="main">≥</span><span class="free">n'</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i</span></sub><span class="hidden">⇙</span>›</span></span>
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">γ</span> <span class="main">(</span>lnth <span class="main">(</span><span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>inf_llist <span class="free">t</span><span class="main">)</span><span class="main">)</span> <span class="keyword1">@<span class="hidden">⇩</span><sub>l</sub></span> <span class="main">(</span>inf_llist <span class="free">t'</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">(</span>the_enat <span class="main">(</span><span class="main">⟨</span><span class="free">c</span> #<span class="hidden">⇘</span><sub>enat <span class="free">n'</span></sub><span class="hidden">⇙</span> inf_llist <span class="free">t</span><span class="main">⟩</span><span class="main">)</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> validCE_act <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"enat <span class="free">n'</span> <span class="main">-</span> <span class="main">1</span> <span class="main">&lt;</span> llength <span class="main">(</span>inf_llist <span class="free">t</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> one_enat_def<span class="main">)</span>
  <span class="keyword1"><span class="command">with</span></span> assms <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"the_enat <span class="main">(</span><span class="main">⟨</span><span class="free">c</span> #<span class="hidden">⇘</span><sub>enat <span class="free">n</span></sub><span class="hidden">⇙</span> inf_llist <span class="free">t</span><span class="main">⟩</span><span class="main">)</span> <span class="main">=</span> the_enat <span class="main">(</span><span class="main">⟨</span><span class="free">c</span> #<span class="hidden">⇘</span><sub>enat <span class="free">n'</span></sub><span class="hidden">⇙</span> inf_llist <span class="free">t</span><span class="main">⟩</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> nAct_not_active_same <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">γ</span> <span class="main">(</span>lnth <span class="main">(</span><span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>inf_llist <span class="free">t</span><span class="main">)</span><span class="main">)</span> <span class="keyword1">@<span class="hidden">⇩</span><sub>l</sub></span> <span class="main">(</span>inf_llist <span class="free">t'</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">(</span>the_enat <span class="main">(</span><span class="main">⟨</span><span class="free">c</span> #<span class="hidden">⇘</span><sub>enat <span class="free">n</span></sub><span class="hidden">⇙</span> inf_llist <span class="free">t</span><span class="main">⟩</span><span class="main">)</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>     
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> assms <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound"><span class="bound">i</span></span><span class="main">≥</span><span class="free">n</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i</span></sub><span class="hidden">⇙</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">meson</span> order.trans<span class="main">)</span>      
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> validCI_act <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
<span class="keyword1"><span class="command">qed</span></span>
  
<span class="keyword1"><span class="command">subsection</span></span> <span class="quoted"><span class="plain_text">"Specification Operators"</span></span>
<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹
  In the following we introduce some basic operators for behavior trace assertions.
›</span></span>

<span class="keyword1"><span class="command">subsubsection</span></span> <span class="quoted"><span class="plain_text">"Predicates"</span></span>
<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹
  Every predicate can be transformed to a behavior trace assertion.
›</span></span>

<span class="keyword1"><span class="command">definition</span></span> <span class="entity">pred</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"bool <span class="main">⇒</span> <span class="main">(</span><span class="tfree">'cmp</span> bta<span class="main">)</span>"</span></span>
  <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="free">pred</span> <span class="free"><span class="bound"><span class="entity">P</span></span></span> <span class="main">≡</span> <span class="main">λ</span> <span class="bound">t</span> <span class="bound">n</span><span class="main">.</span> <span class="free"><span class="bound"><span class="entity">P</span></span></span>"</span></span>

<span class="keyword1" id="Dynamic_Architecture_Calculus-predI"><span class="command">lemma</span></span> predI<span class="main">[</span><span class="operator">intro</span><span class="main">]</span><span class="main">:</span>
  <span class="keyword2"><span class="keyword">fixes</span></span> <span class="free">cid</span> <span class="free">t</span> <span class="free">t'</span> <span class="free">n</span> <span class="free">P</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">P</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"eval <span class="free">cid</span> <span class="free">t</span> <span class="free">t'</span> <span class="free">n</span> <span class="main">(</span>pred <span class="free">P</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">cases</span>
  <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">∃</span><span class="bound">i</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">cid</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i</span></sub><span class="hidden">⇙</span><span class="main">)</span>"</span></span>
  <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="operator">cases</span>
    <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound"><span class="bound">i</span></span><span class="main">≥</span><span class="free">n</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">cid</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i</span></sub><span class="hidden">⇙</span>"</span></span>
    <span class="keyword1"><span class="command">with</span></span> assms <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> eval_def pred_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">next</span></span>
    <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> <span class="main">(</span><span class="main">∃</span><span class="bound"><span class="bound">i</span></span><span class="main">≥</span><span class="free">n</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">cid</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i</span></sub><span class="hidden">⇙</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">with</span></span> assms <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> eval_def pred_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">qed</span></span>
<span class="keyword1"><span class="command">next</span></span>
  <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span><span class="main">(</span><span class="main">∃</span><span class="bound">i</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">cid</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i</span></sub><span class="hidden">⇙</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">with</span></span> assms <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> eval_def pred_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>    
    
<span class="keyword1" id="Dynamic_Architecture_Calculus-predE"><span class="command">lemma</span></span> predE<span class="main">[</span><span class="operator">elim</span><span class="main">]</span><span class="main">:</span>
  <span class="keyword2"><span class="keyword">fixes</span></span> <span class="free">cid</span> <span class="free">t</span> <span class="free">t'</span> <span class="free">n</span> <span class="free">P</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"eval <span class="free">cid</span> <span class="free">t</span> <span class="free">t'</span> <span class="free">n</span> <span class="main">(</span>pred <span class="free">P</span><span class="main">)</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">P</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">cases</span>
  <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">∃</span><span class="bound">i</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">cid</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i</span></sub><span class="hidden">⇙</span><span class="main">)</span>"</span></span>
  <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="operator">cases</span>
    <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound"><span class="bound">i</span></span><span class="main">≥</span><span class="free">n</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">cid</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i</span></sub><span class="hidden">⇙</span>"</span></span>
    <span class="keyword1"><span class="command">with</span></span> assms <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> eval_def pred_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">next</span></span>
    <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> <span class="main">(</span><span class="main">∃</span><span class="bound"><span class="bound">i</span></span><span class="main">≥</span><span class="free">n</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">cid</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i</span></sub><span class="hidden">⇙</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">with</span></span> assms <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> eval_def pred_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">qed</span></span>
<span class="keyword1"><span class="command">next</span></span>
  <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span><span class="main">(</span><span class="main">∃</span><span class="bound">i</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">cid</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i</span></sub><span class="hidden">⇙</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">with</span></span> assms <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> eval_def pred_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">subsubsection</span></span> <span class="quoted"><span class="plain_text">"True and False"</span></span>

<span class="keyword1"><span class="command">abbreviation</span></span> <span class="entity">true</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'cmp</span> bta"</span></span>
  <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="free">true</span> <span class="main">≡</span> <span class="main">λ</span><span class="bound">t</span> <span class="bound">n</span><span class="main">.</span> HOL.True"</span></span>
    
<span class="keyword1"><span class="command">abbreviation</span></span> <span class="entity">false</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'cmp</span> bta"</span></span>
  <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="free">false</span> <span class="main">≡</span> <span class="main">λ</span><span class="bound">t</span> <span class="bound">n</span><span class="main">.</span> HOL.False"</span></span>

<span class="keyword1"><span class="command">subsubsection</span></span> <span class="quoted"><span class="plain_text">"Implication"</span></span>  
  
<span class="keyword1"><span class="command">definition</span></span> <span class="entity">imp</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="tfree">'cmp</span> bta<span class="main">)</span> <span class="main">⇒</span> <span class="main">(</span><span class="tfree">'cmp</span> bta<span class="main">)</span> <span class="main">⇒</span> <span class="main">(</span><span class="tfree">'cmp</span> bta<span class="main">)</span>"</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">infixl</span></span> <span class="quoted">"<span class="keyword1">⟶<span class="hidden">⇧</span><sup>b</sup></span>"</span> 10<span class="main">)</span>
  <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="free"><span class="bound"><span class="entity">γ</span></span></span> <span class="keyword1"><span class="free">⟶<span class="hidden">⇧</span><sup>b</sup></span></span> <span class="free"><span class="bound"><span class="entity">γ'</span></span></span> <span class="main">≡</span> <span class="main">λ</span> <span class="bound">t</span> <span class="bound">n</span><span class="main">.</span> <span class="free"><span class="bound"><span class="entity">γ</span></span></span> <span class="bound">t</span> <span class="bound">n</span> <span class="main">⟶</span> <span class="free"><span class="bound"><span class="entity">γ'</span></span></span> <span class="bound">t</span> <span class="bound">n</span>"</span></span>

<span class="keyword1" id="Dynamic_Architecture_Calculus-impI"><span class="command">lemma</span></span> impI<span class="main">[</span><span class="operator">intro</span><span class="main"><span class="main"><span class="main">!</span></span></span><span class="main">]</span><span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"eval <span class="free">cid</span> <span class="free">t</span> <span class="free">t'</span> <span class="free">n</span> <span class="free">γ</span> <span class="main">⟶</span> eval <span class="free">cid</span> <span class="free">t</span> <span class="free">t'</span> <span class="free">n</span> <span class="free">γ'</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"eval <span class="free">cid</span> <span class="free">t</span> <span class="free">t'</span> <span class="free">n</span> <span class="main">(</span><span class="free">γ</span> <span class="keyword1">⟶<span class="hidden">⇧</span><sup>b</sup></span> <span class="free">γ'</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">cases</span>
  <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound">i</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">cid</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i</span></sub><span class="hidden">⇙</span>"</span></span>
  <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="operator">cases</span>
    <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound"><span class="bound">i</span></span><span class="main">≥</span><span class="free">n</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">cid</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i</span></sub><span class="hidden">⇙</span>"</span></span>
    <span class="keyword1"><span class="command">with</span></span> <span class="quoted"><span class="quoted">‹eval <span class="free">cid</span> <span class="free">t</span> <span class="free">t'</span> <span class="free">n</span> <span class="free">γ</span> <span class="main">⟶</span> eval <span class="free">cid</span> <span class="free">t</span> <span class="free">t'</span> <span class="free">n</span> <span class="free">γ'</span>›</span></span>
      <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">γ</span> <span class="main">(</span>lnth <span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">cid</span></sub><span class="hidden">⇙</span>inf_llist <span class="free">t</span> <span class="keyword1">@<span class="hidden">⇩</span><sub>l</sub></span> inf_llist <span class="free">t'</span><span class="main">)</span><span class="main">)</span> <span class="main">(</span>the_enat <span class="main">⟨</span><span class="free">cid</span> #<span class="hidden">⇘</span><sub>enat <span class="free">n</span></sub><span class="hidden">⇙</span>inf_llist <span class="free">t</span><span class="main">⟩</span><span class="main">)</span>
      <span class="main">⟶</span> <span class="free">γ'</span> <span class="main">(</span>lnth <span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">cid</span></sub><span class="hidden">⇙</span>inf_llist <span class="free">t</span> <span class="keyword1">@<span class="hidden">⇩</span><sub>l</sub></span> inf_llist <span class="free">t'</span><span class="main">)</span><span class="main">)</span> <span class="main">(</span>the_enat <span class="main">⟨</span><span class="free">cid</span> #<span class="hidden">⇘</span><sub>enat <span class="free">n</span></sub><span class="hidden">⇙</span>inf_llist <span class="free">t</span><span class="main">⟩</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> eval_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
    <span class="keyword1"><span class="command">with</span></span> <span class="quoted"><span class="quoted">‹<span class="main">∃</span><span class="bound"><span class="bound">i</span></span><span class="main">≥</span><span class="free">n</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">cid</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i</span></sub><span class="hidden">⇙</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"eval <span class="free">cid</span> <span class="free">t</span> <span class="free">t'</span> <span class="free">n</span> <span class="main">(</span><span class="main">λ</span><span class="bound">t</span> <span class="bound">n</span><span class="main">.</span> <span class="free">γ</span> <span class="bound">t</span> <span class="bound">n</span> <span class="main">⟶</span> <span class="free">γ'</span> <span class="bound">t</span> <span class="bound">n</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> validCI_act<span class="main">[</span><span class="keyword2"><span class="keyword"><span class="operator">where</span></span></span> γ<span class="main"><span class="main">=</span></span><span class="quoted"><span class="quoted">"<span class="main">λ</span> <span class="bound">t</span> <span class="bound">n</span><span class="main">.</span> <span class="free">γ</span> <span class="bound">t</span> <span class="bound">n</span> <span class="main">⟶</span> <span class="free">γ'</span> <span class="bound">t</span> <span class="bound">n</span>"</span></span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
    <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> imp_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">next</span></span>
    <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> <span class="main">(</span><span class="main">∃</span><span class="bound"><span class="bound">i</span></span><span class="main">≥</span><span class="free">n</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">cid</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i</span></sub><span class="hidden">⇙</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">with</span></span> <span class="quoted"><span class="quoted">‹<span class="main">∃</span><span class="bound">i</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">cid</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i</span></sub><span class="hidden">⇙</span>›</span></span> <span class="quoted"><span class="quoted">‹eval <span class="free">cid</span> <span class="free">t</span> <span class="free">t'</span> <span class="free">n</span> <span class="free">γ</span> <span class="main">⟶</span> eval <span class="free">cid</span> <span class="free">t</span> <span class="free">t'</span> <span class="free">n</span> <span class="free">γ'</span>›</span></span>
      <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">γ</span> <span class="main">(</span>lnth <span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">cid</span></sub><span class="hidden">⇙</span>inf_llist <span class="free">t</span> <span class="keyword1">@<span class="hidden">⇩</span><sub>l</sub></span> inf_llist <span class="free">t'</span><span class="main">)</span><span class="main">)</span> <span class="main">(</span><span class="hidden">⇘</span><sub><span class="free">cid</span></sub><span class="hidden">⇙</span>↓<span class="hidden">⇘</span><sub><span class="free">t</span></sub><span class="hidden">⇙</span><span class="free">n</span><span class="main">)</span>
      <span class="main">⟶</span> <span class="free">γ'</span> <span class="main">(</span>lnth <span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">cid</span></sub><span class="hidden">⇙</span>inf_llist <span class="free">t</span> <span class="keyword1">@<span class="hidden">⇩</span><sub>l</sub></span> inf_llist <span class="free">t'</span><span class="main">)</span><span class="main">)</span> <span class="main">(</span><span class="hidden">⇘</span><sub><span class="free">cid</span></sub><span class="hidden">⇙</span>↓<span class="hidden">⇘</span><sub><span class="free">t</span></sub><span class="hidden">⇙</span><span class="free">n</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> eval_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
    <span class="keyword1"><span class="command">with</span></span> <span class="quoted"><span class="quoted">‹<span class="main">∃</span><span class="bound">i</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">cid</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i</span></sub><span class="hidden">⇙</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="main">¬</span> <span class="main">(</span><span class="main">∃</span><span class="bound"><span class="bound">i</span></span><span class="main">≥</span><span class="free">n</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">cid</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i</span></sub><span class="hidden">⇙</span><span class="main">)</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"eval <span class="free">cid</span> <span class="free">t</span> <span class="free">t'</span> <span class="free">n</span> <span class="main">(</span><span class="main">λ</span><span class="bound">t</span> <span class="bound">n</span><span class="main">.</span> <span class="free">γ</span> <span class="bound">t</span> <span class="bound">n</span> <span class="main">⟶</span> <span class="free">γ'</span> <span class="bound">t</span> <span class="bound">n</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> validCI_cont<span class="main">[</span><span class="keyword2"><span class="keyword"><span class="operator">where</span></span></span> γ<span class="main"><span class="main">=</span></span><span class="quoted"><span class="quoted">"<span class="main">λ</span> <span class="bound">t</span> <span class="bound">n</span><span class="main">.</span> <span class="free">γ</span> <span class="bound">t</span> <span class="bound">n</span> <span class="main">⟶</span> <span class="free">γ'</span> <span class="bound">t</span> <span class="bound">n</span>"</span></span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
    <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> imp_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">qed</span></span>
<span class="keyword1"><span class="command">next</span></span>
  <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span><span class="main">(</span><span class="main">∃</span><span class="bound">i</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">cid</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i</span></sub><span class="hidden">⇙</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">with</span></span> <span class="quoted"><span class="quoted">‹eval <span class="free">cid</span> <span class="free">t</span> <span class="free">t'</span> <span class="free">n</span> <span class="free">γ</span> <span class="main">⟶</span> eval <span class="free">cid</span> <span class="free">t</span> <span class="free">t'</span> <span class="free">n</span> <span class="free">γ'</span>›</span></span>
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">γ</span> <span class="main">(</span>lnth <span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">cid</span></sub><span class="hidden">⇙</span>inf_llist <span class="free">t</span> <span class="keyword1">@<span class="hidden">⇩</span><sub>l</sub></span> inf_llist <span class="free">t'</span><span class="main">)</span><span class="main">)</span> <span class="free">n</span> <span class="main">⟶</span> <span class="free">γ'</span> <span class="main">(</span>lnth <span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">cid</span></sub><span class="hidden">⇙</span>inf_llist <span class="free">t</span> <span class="keyword1">@<span class="hidden">⇩</span><sub>l</sub></span> inf_llist <span class="free">t'</span><span class="main">)</span><span class="main">)</span> <span class="free">n</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> eval_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">with</span></span> <span class="quoted"><span class="quoted">‹<span class="main">¬</span><span class="main">(</span><span class="main">∃</span><span class="bound">i</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">cid</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i</span></sub><span class="hidden">⇙</span><span class="main">)</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"eval <span class="free">cid</span> <span class="free">t</span> <span class="free">t'</span> <span class="free">n</span> <span class="main">(</span><span class="main">λ</span><span class="bound">t</span> <span class="bound">n</span><span class="main">.</span> <span class="free">γ</span> <span class="bound">t</span> <span class="bound">n</span> <span class="main">⟶</span> <span class="free">γ'</span> <span class="bound">t</span> <span class="bound">n</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> validCI_not_act<span class="main">[</span><span class="keyword2"><span class="keyword"><span class="operator">where</span></span></span> γ<span class="main"><span class="main">=</span></span><span class="quoted"><span class="quoted">"<span class="main">λ</span> <span class="bound">t</span> <span class="bound">n</span><span class="main">.</span> <span class="free">γ</span> <span class="bound">t</span> <span class="bound">n</span> <span class="main">⟶</span> <span class="free">γ'</span> <span class="bound">t</span> <span class="bound">n</span>"</span></span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> imp_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>    
<span class="keyword1"><span class="command">qed</span></span>
    
<span class="keyword1" id="Dynamic_Architecture_Calculus-impE"><span class="command">lemma</span></span> impE<span class="main">[</span><span class="operator">elim</span><span class="main"><span class="main"><span class="main">!</span></span></span><span class="main">]</span><span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"eval <span class="free">cid</span> <span class="free">t</span> <span class="free">t'</span> <span class="free">n</span> <span class="main">(</span><span class="free">γ</span> <span class="keyword1">⟶<span class="hidden">⇧</span><sup>b</sup></span> <span class="free">γ'</span><span class="main">)</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"eval <span class="free">cid</span> <span class="free">t</span> <span class="free">t'</span> <span class="free">n</span> <span class="free">γ</span> <span class="main">⟶</span> eval <span class="free">cid</span> <span class="free">t</span> <span class="free">t'</span> <span class="free">n</span> <span class="free">γ'</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">cases</span>
  <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">∃</span><span class="bound">i</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">cid</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i</span></sub><span class="hidden">⇙</span><span class="main">)</span>"</span></span>
  <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="operator">cases</span>
    <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound"><span class="bound">i</span></span><span class="main">≥</span><span class="free">n</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">cid</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i</span></sub><span class="hidden">⇙</span>"</span></span>
    <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹eval <span class="free">cid</span> <span class="free">t</span> <span class="free">t'</span> <span class="free">n</span> <span class="main">(</span><span class="free">γ</span> <span class="keyword1">⟶<span class="hidden">⇧</span><sup>b</sup></span> <span class="free">γ'</span><span class="main">)</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"eval <span class="free">cid</span> <span class="free">t</span> <span class="free">t'</span> <span class="free">n</span> <span class="main">(</span><span class="main">λ</span><span class="bound">t</span> <span class="bound">n</span><span class="main">.</span> <span class="free">γ</span> <span class="bound">t</span> <span class="bound">n</span> <span class="main">⟶</span> <span class="free">γ'</span> <span class="bound">t</span> <span class="bound">n</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> imp_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">γ</span> <span class="main">(</span>lnth <span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">cid</span></sub><span class="hidden">⇙</span>inf_llist <span class="free">t</span> <span class="keyword1">@<span class="hidden">⇩</span><sub>l</sub></span> inf_llist <span class="free">t'</span><span class="main">)</span><span class="main">)</span> <span class="main">(</span>the_enat <span class="main">⟨</span><span class="free">cid</span> #<span class="hidden">⇘</span><sub>enat <span class="free">n</span></sub><span class="hidden">⇙</span>inf_llist <span class="free">t</span><span class="main">⟩</span><span class="main">)</span>
      <span class="main">⟶</span> <span class="free">γ'</span> <span class="main">(</span>lnth <span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">cid</span></sub><span class="hidden">⇙</span>inf_llist <span class="free">t</span> <span class="keyword1">@<span class="hidden">⇩</span><sub>l</sub></span> inf_llist <span class="free">t'</span><span class="main">)</span><span class="main">)</span> <span class="main">(</span>the_enat <span class="main">⟨</span><span class="free">cid</span> #<span class="hidden">⇘</span><sub>enat <span class="free">n</span></sub><span class="hidden">⇙</span>inf_llist <span class="free">t</span><span class="main">⟩</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> validCE_act<span class="main">[</span><span class="keyword2"><span class="keyword"><span class="operator">where</span></span></span> γ<span class="main"><span class="main">=</span></span><span class="quoted"><span class="quoted">"<span class="main">λ</span> <span class="bound">t</span> <span class="bound">n</span><span class="main">.</span> <span class="free">γ</span> <span class="bound">t</span> <span class="bound">n</span> <span class="main">⟶</span> <span class="free">γ'</span> <span class="bound">t</span> <span class="bound">n</span>"</span></span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
    <span class="keyword1"><span class="command">with</span></span> <span class="quoted"><span class="quoted">‹<span class="main">∃</span><span class="bound"><span class="bound">i</span></span><span class="main">≥</span><span class="free">n</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">cid</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i</span></sub><span class="hidden">⇙</span>›</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> eval_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">next</span></span>
    <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> <span class="main">(</span><span class="main">∃</span><span class="bound"><span class="bound">i</span></span><span class="main">≥</span><span class="free">n</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">cid</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i</span></sub><span class="hidden">⇙</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹eval <span class="free">cid</span> <span class="free">t</span> <span class="free">t'</span> <span class="free">n</span> <span class="main">(</span><span class="free">γ</span> <span class="keyword1">⟶<span class="hidden">⇧</span><sup>b</sup></span> <span class="free">γ'</span><span class="main">)</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"eval <span class="free">cid</span> <span class="free">t</span> <span class="free">t'</span> <span class="free">n</span> <span class="main">(</span><span class="main">λ</span><span class="bound">t</span> <span class="bound">n</span><span class="main">.</span> <span class="free">γ</span> <span class="bound">t</span> <span class="bound">n</span> <span class="main">⟶</span> <span class="free">γ'</span> <span class="bound">t</span> <span class="bound">n</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> imp_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">γ</span> <span class="main">(</span>lnth <span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">cid</span></sub><span class="hidden">⇙</span>inf_llist <span class="free">t</span> <span class="keyword1">@<span class="hidden">⇩</span><sub>l</sub></span> inf_llist <span class="free">t'</span><span class="main">)</span><span class="main">)</span> <span class="main">(</span><span class="hidden">⇘</span><sub><span class="free">cid</span></sub><span class="hidden">⇙</span>↓<span class="hidden">⇘</span><sub><span class="free">t</span></sub><span class="hidden">⇙</span><span class="free">n</span><span class="main">)</span>
      <span class="main">⟶</span> <span class="free">γ'</span> <span class="main">(</span>lnth <span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">cid</span></sub><span class="hidden">⇙</span>inf_llist <span class="free">t</span> <span class="keyword1">@<span class="hidden">⇩</span><sub>l</sub></span> inf_llist <span class="free">t'</span><span class="main">)</span><span class="main">)</span> <span class="main">(</span><span class="hidden">⇘</span><sub><span class="free">cid</span></sub><span class="hidden">⇙</span>↓<span class="hidden">⇘</span><sub><span class="free">t</span></sub><span class="hidden">⇙</span><span class="free">n</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> validCE_cont<span class="main">[</span><span class="keyword2"><span class="keyword"><span class="operator">where</span></span></span> γ<span class="main"><span class="main">=</span></span><span class="quoted"><span class="quoted">"<span class="main">λ</span> <span class="bound">t</span> <span class="bound">n</span><span class="main">.</span> <span class="free">γ</span> <span class="bound">t</span> <span class="bound">n</span> <span class="main">⟶</span> <span class="free">γ'</span> <span class="bound">t</span> <span class="bound">n</span>"</span></span><span class="main">]</span> <span class="quoted"><span class="quoted">‹<span class="main">∃</span><span class="bound">i</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">cid</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i</span></sub><span class="hidden">⇙</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
    <span class="keyword1"><span class="command">with</span></span> <span class="quoted"><span class="quoted">‹<span class="main">¬</span> <span class="main">(</span><span class="main">∃</span><span class="bound"><span class="bound">i</span></span><span class="main">≥</span><span class="free">n</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">cid</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i</span></sub><span class="hidden">⇙</span><span class="main">)</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="main">∃</span><span class="bound">i</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">cid</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i</span></sub><span class="hidden">⇙</span>›</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> eval_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">qed</span></span>
<span class="keyword1"><span class="command">next</span></span>
  <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span><span class="main">(</span><span class="main">∃</span><span class="bound">i</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">cid</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i</span></sub><span class="hidden">⇙</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹eval <span class="free">cid</span> <span class="free">t</span> <span class="free">t'</span> <span class="free">n</span> <span class="main">(</span><span class="free">γ</span> <span class="keyword1">⟶<span class="hidden">⇧</span><sup>b</sup></span> <span class="free">γ'</span><span class="main">)</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"eval <span class="free">cid</span> <span class="free">t</span> <span class="free">t'</span> <span class="free">n</span> <span class="main">(</span><span class="main">λ</span><span class="bound">t</span> <span class="bound">n</span><span class="main">.</span> <span class="free">γ</span> <span class="bound">t</span> <span class="bound">n</span> <span class="main">⟶</span> <span class="free">γ'</span> <span class="bound">t</span> <span class="bound">n</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> imp_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">γ</span> <span class="main">(</span>lnth <span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">cid</span></sub><span class="hidden">⇙</span>inf_llist <span class="free">t</span> <span class="keyword1">@<span class="hidden">⇩</span><sub>l</sub></span> inf_llist <span class="free">t'</span><span class="main">)</span><span class="main">)</span> <span class="free">n</span>
    <span class="main">⟶</span> <span class="free">γ'</span> <span class="main">(</span>lnth <span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">cid</span></sub><span class="hidden">⇙</span>inf_llist <span class="free">t</span> <span class="keyword1">@<span class="hidden">⇩</span><sub>l</sub></span> inf_llist <span class="free">t'</span><span class="main">)</span><span class="main">)</span> <span class="free">n</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> validCE_not_act<span class="main">[</span><span class="keyword2"><span class="keyword"><span class="operator">where</span></span></span> γ<span class="main"><span class="main">=</span></span><span class="quoted"><span class="quoted">"<span class="main">λ</span> <span class="bound">t</span> <span class="bound">n</span><span class="main">.</span> <span class="free">γ</span> <span class="bound">t</span> <span class="bound">n</span> <span class="main">⟶</span> <span class="free">γ'</span> <span class="bound">t</span> <span class="bound">n</span>"</span></span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">with</span></span> <span class="quoted"><span class="quoted">‹<span class="main">¬</span><span class="main">(</span><span class="main">∃</span><span class="bound">i</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">cid</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i</span></sub><span class="hidden">⇙</span><span class="main">)</span>›</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> eval_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">subsubsection</span></span> <span class="quoted"><span class="plain_text">"Disjunction"</span></span>  
    
<span class="keyword1"><span class="command">definition</span></span> <span class="entity">disj</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="tfree">'cmp</span> bta<span class="main">)</span> <span class="main">⇒</span> <span class="main">(</span><span class="tfree">'cmp</span> bta<span class="main">)</span> <span class="main">⇒</span> <span class="main">(</span><span class="tfree">'cmp</span> bta<span class="main">)</span>"</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">infixl</span></span> <span class="quoted">"<span class="keyword1">∨<span class="hidden">⇧</span><sup>b</sup></span>"</span> 15<span class="main">)</span>
  <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="free"><span class="bound"><span class="entity">γ</span></span></span> <span class="keyword1"><span class="free">∨<span class="hidden">⇧</span><sup>b</sup></span></span> <span class="free"><span class="bound"><span class="entity">γ'</span></span></span> <span class="main">≡</span> <span class="main">λ</span> <span class="bound">t</span> <span class="bound">n</span><span class="main">.</span> <span class="free"><span class="bound"><span class="entity">γ</span></span></span> <span class="bound">t</span> <span class="bound">n</span> <span class="main">∨</span> <span class="free"><span class="bound"><span class="entity">γ'</span></span></span> <span class="bound">t</span> <span class="bound">n</span>"</span></span>

<span class="keyword1" id="Dynamic_Architecture_Calculus-disjI"><span class="command">lemma</span></span> disjI<span class="main">[</span><span class="operator">intro</span><span class="main"><span class="main"><span class="main">!</span></span></span><span class="main">]</span><span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"eval <span class="free">cid</span> <span class="free">t</span> <span class="free">t'</span> <span class="free">n</span> <span class="free">γ</span> <span class="main">∨</span> eval <span class="free">cid</span> <span class="free">t</span> <span class="free">t'</span> <span class="free">n</span> <span class="free">γ'</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"eval <span class="free">cid</span> <span class="free">t</span> <span class="free">t'</span> <span class="free">n</span> <span class="main">(</span><span class="free">γ</span> <span class="keyword1">∨<span class="hidden">⇧</span><sup>b</sup></span> <span class="free">γ'</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> assms disj_def eval_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    
<span class="keyword1" id="Dynamic_Architecture_Calculus-disjE"><span class="command">lemma</span></span> disjE<span class="main">[</span><span class="operator">elim</span><span class="main"><span class="main"><span class="main">!</span></span></span><span class="main">]</span><span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"eval <span class="free">cid</span> <span class="free">t</span> <span class="free">t'</span> <span class="free">n</span> <span class="main">(</span><span class="free">γ</span> <span class="keyword1">∨<span class="hidden">⇧</span><sup>b</sup></span> <span class="free">γ'</span><span class="main">)</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"eval <span class="free">cid</span> <span class="free">t</span> <span class="free">t'</span> <span class="free">n</span> <span class="free">γ</span> <span class="main">∨</span> eval <span class="free">cid</span> <span class="free">t</span> <span class="free">t'</span> <span class="free">n</span> <span class="free">γ'</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">cases</span>
  <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">∃</span><span class="bound">i</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">cid</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i</span></sub><span class="hidden">⇙</span><span class="main">)</span>"</span></span>
  <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="operator">cases</span>
    <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound"><span class="bound">i</span></span><span class="main">≥</span><span class="free">n</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">cid</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i</span></sub><span class="hidden">⇙</span>"</span></span>
    <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹eval <span class="free">cid</span> <span class="free">t</span> <span class="free">t'</span> <span class="free">n</span> <span class="main">(</span><span class="free">γ</span> <span class="keyword1">∨<span class="hidden">⇧</span><sup>b</sup></span> <span class="free">γ'</span><span class="main">)</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"eval <span class="free">cid</span> <span class="free">t</span> <span class="free">t'</span> <span class="free">n</span> <span class="main">(</span><span class="main">λ</span><span class="bound">t</span> <span class="bound">n</span><span class="main">.</span> <span class="free">γ</span> <span class="bound">t</span> <span class="bound">n</span> <span class="main">∨</span> <span class="free">γ'</span> <span class="bound">t</span> <span class="bound">n</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> disj_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">γ</span> <span class="main">(</span>lnth <span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">cid</span></sub><span class="hidden">⇙</span>inf_llist <span class="free">t</span> <span class="keyword1">@<span class="hidden">⇩</span><sub>l</sub></span> inf_llist <span class="free">t'</span><span class="main">)</span><span class="main">)</span> <span class="main">(</span>the_enat <span class="main">⟨</span><span class="free">cid</span> #<span class="hidden">⇘</span><sub>enat <span class="free">n</span></sub><span class="hidden">⇙</span>inf_llist <span class="free">t</span><span class="main">⟩</span><span class="main">)</span>
      <span class="main">∨</span> <span class="free">γ'</span> <span class="main">(</span>lnth <span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">cid</span></sub><span class="hidden">⇙</span>inf_llist <span class="free">t</span> <span class="keyword1">@<span class="hidden">⇩</span><sub>l</sub></span> inf_llist <span class="free">t'</span><span class="main">)</span><span class="main">)</span> <span class="main">(</span>the_enat <span class="main">⟨</span><span class="free">cid</span> #<span class="hidden">⇘</span><sub>enat <span class="free">n</span></sub><span class="hidden">⇙</span>inf_llist <span class="free">t</span><span class="main">⟩</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> validCE_act<span class="main">[</span><span class="keyword2"><span class="keyword"><span class="operator">where</span></span></span> γ<span class="main"><span class="main">=</span></span><span class="quoted"><span class="quoted">"<span class="main">λ</span> <span class="bound">t</span> <span class="bound">n</span><span class="main">.</span> <span class="free">γ</span> <span class="bound">t</span> <span class="bound">n</span> <span class="main">∨</span> <span class="free">γ'</span> <span class="bound">t</span> <span class="bound">n</span>"</span></span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
    <span class="keyword1"><span class="command">with</span></span> <span class="quoted"><span class="quoted">‹<span class="main">∃</span><span class="bound"><span class="bound">i</span></span><span class="main">≥</span><span class="free">n</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">cid</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i</span></sub><span class="hidden">⇙</span>›</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
      <span class="keyword1"><span class="command">using</span></span> validCI_act<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="free">n</span></span> <span class="quoted"><span class="free">cid</span></span> <span class="quoted"><span class="free">t</span></span> <span class="quoted"><span class="free">γ</span></span> <span class="quoted"><span class="free">t'</span></span><span class="main">]</span> validCI_act<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="free">n</span></span> <span class="quoted"><span class="free">cid</span></span> <span class="quoted"><span class="free">t</span></span> <span class="quoted"><span class="free">γ'</span></span> <span class="quoted"><span class="free">t'</span></span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">next</span></span>
    <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> <span class="main">(</span><span class="main">∃</span><span class="bound"><span class="bound">i</span></span><span class="main">≥</span><span class="free">n</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">cid</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i</span></sub><span class="hidden">⇙</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹eval <span class="free">cid</span> <span class="free">t</span> <span class="free">t'</span> <span class="free">n</span> <span class="main">(</span><span class="free">γ</span> <span class="keyword1">∨<span class="hidden">⇧</span><sup>b</sup></span> <span class="free">γ'</span><span class="main">)</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"eval <span class="free">cid</span> <span class="free">t</span> <span class="free">t'</span> <span class="free">n</span> <span class="main">(</span><span class="main">λ</span><span class="bound">t</span> <span class="bound">n</span><span class="main">.</span> <span class="free">γ</span> <span class="bound">t</span> <span class="bound">n</span> <span class="main">∨</span> <span class="free">γ'</span> <span class="bound">t</span> <span class="bound">n</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> disj_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">γ</span> <span class="main">(</span>lnth <span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">cid</span></sub><span class="hidden">⇙</span>inf_llist <span class="free">t</span> <span class="keyword1">@<span class="hidden">⇩</span><sub>l</sub></span> inf_llist <span class="free">t'</span><span class="main">)</span><span class="main">)</span> <span class="main">(</span><span class="hidden">⇘</span><sub><span class="free">cid</span></sub><span class="hidden">⇙</span>↓<span class="hidden">⇘</span><sub><span class="free">t</span></sub><span class="hidden">⇙</span><span class="free">n</span><span class="main">)</span>
      <span class="main">∨</span> <span class="free">γ'</span> <span class="main">(</span>lnth <span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">cid</span></sub><span class="hidden">⇙</span>inf_llist <span class="free">t</span> <span class="keyword1">@<span class="hidden">⇩</span><sub>l</sub></span> inf_llist <span class="free">t'</span><span class="main">)</span><span class="main">)</span> <span class="main">(</span><span class="hidden">⇘</span><sub><span class="free">cid</span></sub><span class="hidden">⇙</span>↓<span class="hidden">⇘</span><sub><span class="free">t</span></sub><span class="hidden">⇙</span><span class="free">n</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> validCE_cont<span class="main">[</span><span class="keyword2"><span class="keyword"><span class="operator">where</span></span></span> γ<span class="main"><span class="main">=</span></span><span class="quoted"><span class="quoted">"<span class="main">λ</span> <span class="bound">t</span> <span class="bound">n</span><span class="main">.</span> <span class="free">γ</span> <span class="bound">t</span> <span class="bound">n</span> <span class="main">∨</span> <span class="free">γ'</span> <span class="bound">t</span> <span class="bound">n</span>"</span></span><span class="main">]</span> <span class="quoted"><span class="quoted">‹<span class="main">∃</span><span class="bound">i</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">cid</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i</span></sub><span class="hidden">⇙</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
    <span class="keyword1"><span class="command">with</span></span> <span class="quoted"><span class="quoted">‹<span class="main">¬</span> <span class="main">(</span><span class="main">∃</span><span class="bound"><span class="bound">i</span></span><span class="main">≥</span><span class="free">n</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">cid</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i</span></sub><span class="hidden">⇙</span><span class="main">)</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="main">∃</span><span class="bound">i</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">cid</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i</span></sub><span class="hidden">⇙</span>›</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
      <span class="keyword1"><span class="command">using</span></span> validCI_cont<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="free">cid</span></span> <span class="quoted"><span class="free">t</span></span> <span class="quoted"><span class="free">n</span></span> <span class="quoted"><span class="free">γ</span></span> <span class="quoted"><span class="free">t'</span></span><span class="main">]</span> validCI_cont<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="free">cid</span></span> <span class="quoted"><span class="free">t</span></span> <span class="quoted"><span class="free">n</span></span> <span class="quoted"><span class="free">γ'</span></span> <span class="quoted"><span class="free">t'</span></span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">qed</span></span>
<span class="keyword1"><span class="command">next</span></span>
  <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span><span class="main">(</span><span class="main">∃</span><span class="bound">i</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">cid</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i</span></sub><span class="hidden">⇙</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹eval <span class="free">cid</span> <span class="free">t</span> <span class="free">t'</span> <span class="free">n</span> <span class="main">(</span><span class="free">γ</span> <span class="keyword1">∨<span class="hidden">⇧</span><sup>b</sup></span> <span class="free">γ'</span><span class="main">)</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"eval <span class="free">cid</span> <span class="free">t</span> <span class="free">t'</span> <span class="free">n</span> <span class="main">(</span><span class="main">λ</span><span class="bound">t</span> <span class="bound">n</span><span class="main">.</span> <span class="free">γ</span> <span class="bound">t</span> <span class="bound">n</span> <span class="main">∨</span> <span class="free">γ'</span> <span class="bound">t</span> <span class="bound">n</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> disj_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">γ</span> <span class="main">(</span>lnth <span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">cid</span></sub><span class="hidden">⇙</span>inf_llist <span class="free">t</span> <span class="keyword1">@<span class="hidden">⇩</span><sub>l</sub></span> inf_llist <span class="free">t'</span><span class="main">)</span><span class="main">)</span> <span class="free">n</span>
    <span class="main">∨</span> <span class="free">γ'</span> <span class="main">(</span>lnth <span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">cid</span></sub><span class="hidden">⇙</span>inf_llist <span class="free">t</span> <span class="keyword1">@<span class="hidden">⇩</span><sub>l</sub></span> inf_llist <span class="free">t'</span><span class="main">)</span><span class="main">)</span> <span class="free">n</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> validCE_not_act<span class="main">[</span><span class="keyword2"><span class="keyword"><span class="operator">where</span></span></span> γ<span class="main"><span class="main">=</span></span><span class="quoted"><span class="quoted">"<span class="main">λ</span> <span class="bound">t</span> <span class="bound">n</span><span class="main">.</span> <span class="free">γ</span> <span class="bound">t</span> <span class="bound">n</span> <span class="main">∨</span> <span class="free">γ'</span> <span class="bound">t</span> <span class="bound">n</span>"</span></span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">with</span></span> <span class="quoted"><span class="quoted">‹<span class="main">¬</span><span class="main">(</span><span class="main">∃</span><span class="bound">i</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">cid</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i</span></sub><span class="hidden">⇙</span><span class="main">)</span>›</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
    <span class="keyword1"><span class="command">using</span></span> validCI_not_act<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="free">cid</span></span> <span class="quoted"><span class="free">t</span></span> <span class="quoted"><span class="free">γ</span></span> <span class="quoted"><span class="free">t'</span></span> <span class="quoted"><span class="free">n</span></span><span class="main">]</span> validCI_not_act<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="free">cid</span></span> <span class="quoted"><span class="free">t</span></span> <span class="quoted"><span class="free">γ'</span></span> <span class="quoted"><span class="free">t'</span></span> <span class="quoted"><span class="free">n</span></span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">subsubsection</span></span> <span class="quoted"><span class="plain_text">"Conjunction"</span></span>
  
<span class="keyword1"><span class="command">definition</span></span> <span class="entity">conj</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="tfree">'cmp</span> bta<span class="main">)</span> <span class="main">⇒</span> <span class="main">(</span><span class="tfree">'cmp</span> bta<span class="main">)</span> <span class="main">⇒</span> <span class="main">(</span><span class="tfree">'cmp</span> bta<span class="main">)</span>"</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">infixl</span></span> <span class="quoted">"<span class="keyword1">∧<span class="hidden">⇧</span><sup>b</sup></span>"</span> 20<span class="main">)</span>
  <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="free"><span class="bound"><span class="entity">γ</span></span></span> <span class="keyword1"><span class="free">∧<span class="hidden">⇧</span><sup>b</sup></span></span> <span class="free"><span class="bound"><span class="entity">γ'</span></span></span> <span class="main">≡</span> <span class="main">λ</span> <span class="bound">t</span> <span class="bound">n</span><span class="main">.</span> <span class="free"><span class="bound"><span class="entity">γ</span></span></span> <span class="bound">t</span> <span class="bound">n</span> <span class="main">∧</span> <span class="free"><span class="bound"><span class="entity">γ'</span></span></span> <span class="bound">t</span> <span class="bound">n</span>"</span></span>

<span class="keyword1" id="Dynamic_Architecture_Calculus-conjI"><span class="command">lemma</span></span> conjI<span class="main">[</span><span class="operator">intro</span><span class="main"><span class="main"><span class="main">!</span></span></span><span class="main">]</span><span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"eval <span class="free">cid</span> <span class="free">t</span> <span class="free">t'</span> <span class="free">n</span> <span class="free">γ</span> <span class="main">∧</span> eval <span class="free">cid</span> <span class="free">t</span> <span class="free">t'</span> <span class="free">n</span> <span class="free">γ'</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"eval <span class="free">cid</span> <span class="free">t</span> <span class="free">t'</span> <span class="free">n</span> <span class="main">(</span><span class="free">γ</span> <span class="keyword1">∧<span class="hidden">⇧</span><sup>b</sup></span> <span class="free">γ'</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">cases</span>
  <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound">i</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">cid</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i</span></sub><span class="hidden">⇙</span>"</span></span>
  <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="operator">cases</span>
    <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound"><span class="bound">i</span></span><span class="main">≥</span><span class="free">n</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">cid</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i</span></sub><span class="hidden">⇙</span>"</span></span>
    <span class="keyword1"><span class="command">with</span></span> <span class="quoted"><span class="quoted">‹eval <span class="free">cid</span> <span class="free">t</span> <span class="free">t'</span> <span class="free">n</span> <span class="free">γ</span> <span class="main">∧</span> eval <span class="free">cid</span> <span class="free">t</span> <span class="free">t'</span> <span class="free">n</span> <span class="free">γ'</span>›</span></span>
      <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">γ</span> <span class="main">(</span>lnth <span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">cid</span></sub><span class="hidden">⇙</span>inf_llist <span class="free">t</span> <span class="keyword1">@<span class="hidden">⇩</span><sub>l</sub></span> inf_llist <span class="free">t'</span><span class="main">)</span><span class="main">)</span> <span class="main">(</span>the_enat <span class="main">⟨</span><span class="free">cid</span> #<span class="hidden">⇘</span><sub>enat <span class="free">n</span></sub><span class="hidden">⇙</span>inf_llist <span class="free">t</span><span class="main">⟩</span><span class="main">)</span>
      <span class="main">∧</span> <span class="free">γ'</span> <span class="main">(</span>lnth <span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">cid</span></sub><span class="hidden">⇙</span>inf_llist <span class="free">t</span> <span class="keyword1">@<span class="hidden">⇩</span><sub>l</sub></span> inf_llist <span class="free">t'</span><span class="main">)</span><span class="main">)</span> <span class="main">(</span>the_enat <span class="main">⟨</span><span class="free">cid</span> #<span class="hidden">⇘</span><sub>enat <span class="free">n</span></sub><span class="hidden">⇙</span>inf_llist <span class="free">t</span><span class="main">⟩</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> eval_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
    <span class="keyword1"><span class="command">with</span></span> <span class="quoted"><span class="quoted">‹<span class="main">∃</span><span class="bound"><span class="bound">i</span></span><span class="main">≥</span><span class="free">n</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">cid</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i</span></sub><span class="hidden">⇙</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"eval <span class="free">cid</span> <span class="free">t</span> <span class="free">t'</span> <span class="free">n</span> <span class="main">(</span><span class="main">λ</span><span class="bound">t</span> <span class="bound">n</span><span class="main">.</span> <span class="free">γ</span> <span class="bound">t</span> <span class="bound">n</span> <span class="main">∧</span> <span class="free">γ'</span> <span class="bound">t</span> <span class="bound">n</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> validCI_act<span class="main">[</span><span class="keyword2"><span class="keyword"><span class="operator">where</span></span></span> γ<span class="main"><span class="main">=</span></span><span class="quoted"><span class="quoted">"<span class="main">λ</span> <span class="bound">t</span> <span class="bound">n</span><span class="main">.</span> <span class="free">γ</span> <span class="bound">t</span> <span class="bound">n</span> <span class="main">∧</span> <span class="free">γ'</span> <span class="bound">t</span> <span class="bound">n</span>"</span></span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
    <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> conj_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">next</span></span>
    <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> <span class="main">(</span><span class="main">∃</span><span class="bound"><span class="bound">i</span></span><span class="main">≥</span><span class="free">n</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">cid</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i</span></sub><span class="hidden">⇙</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">with</span></span> <span class="quoted"><span class="quoted">‹<span class="main">∃</span><span class="bound">i</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">cid</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i</span></sub><span class="hidden">⇙</span>›</span></span> <span class="quoted"><span class="quoted">‹eval <span class="free">cid</span> <span class="free">t</span> <span class="free">t'</span> <span class="free">n</span> <span class="free">γ</span> <span class="main">∧</span> eval <span class="free">cid</span> <span class="free">t</span> <span class="free">t'</span> <span class="free">n</span> <span class="free">γ'</span>›</span></span>
      <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">γ</span> <span class="main">(</span>lnth <span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">cid</span></sub><span class="hidden">⇙</span>inf_llist <span class="free">t</span> <span class="keyword1">@<span class="hidden">⇩</span><sub>l</sub></span> inf_llist <span class="free">t'</span><span class="main">)</span><span class="main">)</span> <span class="main">(</span><span class="hidden">⇘</span><sub><span class="free">cid</span></sub><span class="hidden">⇙</span>↓<span class="hidden">⇘</span><sub><span class="free">t</span></sub><span class="hidden">⇙</span><span class="free">n</span><span class="main">)</span>
      <span class="main">∧</span> <span class="free">γ'</span> <span class="main">(</span>lnth <span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">cid</span></sub><span class="hidden">⇙</span>inf_llist <span class="free">t</span> <span class="keyword1">@<span class="hidden">⇩</span><sub>l</sub></span> inf_llist <span class="free">t'</span><span class="main">)</span><span class="main">)</span> <span class="main">(</span><span class="hidden">⇘</span><sub><span class="free">cid</span></sub><span class="hidden">⇙</span>↓<span class="hidden">⇘</span><sub><span class="free">t</span></sub><span class="hidden">⇙</span><span class="free">n</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> eval_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
    <span class="keyword1"><span class="command">with</span></span> <span class="quoted"><span class="quoted">‹<span class="main">∃</span><span class="bound">i</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">cid</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i</span></sub><span class="hidden">⇙</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="main">¬</span> <span class="main">(</span><span class="main">∃</span><span class="bound"><span class="bound">i</span></span><span class="main">≥</span><span class="free">n</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">cid</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i</span></sub><span class="hidden">⇙</span><span class="main">)</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"eval <span class="free">cid</span> <span class="free">t</span> <span class="free">t'</span> <span class="free">n</span> <span class="main">(</span><span class="main">λ</span><span class="bound">t</span> <span class="bound">n</span><span class="main">.</span> <span class="free">γ</span> <span class="bound">t</span> <span class="bound">n</span> <span class="main">∧</span> <span class="free">γ'</span> <span class="bound">t</span> <span class="bound">n</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> validCI_cont<span class="main">[</span><span class="keyword2"><span class="keyword"><span class="operator">where</span></span></span> γ<span class="main"><span class="main">=</span></span><span class="quoted"><span class="quoted">"<span class="main">λ</span> <span class="bound">t</span> <span class="bound">n</span><span class="main">.</span> <span class="free">γ</span> <span class="bound">t</span> <span class="bound">n</span> <span class="main">∧</span> <span class="free">γ'</span> <span class="bound">t</span> <span class="bound">n</span>"</span></span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
    <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> conj_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">qed</span></span>
<span class="keyword1"><span class="command">next</span></span>
  <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span><span class="main">(</span><span class="main">∃</span><span class="bound">i</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">cid</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i</span></sub><span class="hidden">⇙</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">with</span></span> <span class="quoted"><span class="quoted">‹eval <span class="free">cid</span> <span class="free">t</span> <span class="free">t'</span> <span class="free">n</span> <span class="free">γ</span> <span class="main">∧</span> eval <span class="free">cid</span> <span class="free">t</span> <span class="free">t'</span> <span class="free">n</span> <span class="free">γ'</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">γ</span> <span class="main">(</span>lnth <span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">cid</span></sub><span class="hidden">⇙</span>inf_llist <span class="free">t</span> <span class="keyword1">@<span class="hidden">⇩</span><sub>l</sub></span> inf_llist <span class="free">t'</span><span class="main">)</span><span class="main">)</span> <span class="free">n</span>
    <span class="main">∧</span> <span class="free">γ'</span> <span class="main">(</span>lnth <span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">cid</span></sub><span class="hidden">⇙</span>inf_llist <span class="free">t</span> <span class="keyword1">@<span class="hidden">⇩</span><sub>l</sub></span> inf_llist <span class="free">t'</span><span class="main">)</span><span class="main">)</span> <span class="free">n</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> eval_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">with</span></span> <span class="quoted"><span class="quoted">‹<span class="main">¬</span><span class="main">(</span><span class="main">∃</span><span class="bound">i</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">cid</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i</span></sub><span class="hidden">⇙</span><span class="main">)</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"eval <span class="free">cid</span> <span class="free">t</span> <span class="free">t'</span> <span class="free">n</span> <span class="main">(</span><span class="main">λ</span><span class="bound">t</span> <span class="bound">n</span><span class="main">.</span> <span class="free">γ</span> <span class="bound">t</span> <span class="bound">n</span> <span class="main">∧</span> <span class="free">γ'</span> <span class="bound">t</span> <span class="bound">n</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> validCI_not_act<span class="main">[</span><span class="keyword2"><span class="keyword"><span class="operator">where</span></span></span> γ<span class="main"><span class="main">=</span></span><span class="quoted"><span class="quoted">"<span class="main">λ</span> <span class="bound">t</span> <span class="bound">n</span><span class="main">.</span> <span class="free">γ</span> <span class="bound">t</span> <span class="bound">n</span> <span class="main">∧</span> <span class="free">γ'</span> <span class="bound">t</span> <span class="bound">n</span>"</span></span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> conj_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>    
<span class="keyword1"><span class="command">qed</span></span>
    
<span class="keyword1" id="Dynamic_Architecture_Calculus-conjE"><span class="command">lemma</span></span> conjE<span class="main">[</span><span class="operator">elim</span><span class="main"><span class="main"><span class="main">!</span></span></span><span class="main">]</span><span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"eval <span class="free">cid</span> <span class="free">t</span> <span class="free">t'</span> <span class="free">n</span> <span class="main">(</span><span class="free">γ</span> <span class="keyword1">∧<span class="hidden">⇧</span><sup>b</sup></span> <span class="free">γ'</span><span class="main">)</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"eval <span class="free">cid</span> <span class="free">t</span> <span class="free">t'</span> <span class="free">n</span> <span class="free">γ</span> <span class="main">∧</span> eval <span class="free">cid</span> <span class="free">t</span> <span class="free">t'</span> <span class="free">n</span> <span class="free">γ'</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">cases</span>
  <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">∃</span><span class="bound">i</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">cid</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i</span></sub><span class="hidden">⇙</span><span class="main">)</span>"</span></span>
  <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="operator">cases</span>
    <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound"><span class="bound">i</span></span><span class="main">≥</span><span class="free">n</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">cid</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i</span></sub><span class="hidden">⇙</span>"</span></span>
    <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹eval <span class="free">cid</span> <span class="free">t</span> <span class="free">t'</span> <span class="free">n</span> <span class="main">(</span><span class="free">γ</span> <span class="keyword1">∧<span class="hidden">⇧</span><sup>b</sup></span> <span class="free">γ'</span><span class="main">)</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"eval <span class="free">cid</span> <span class="free">t</span> <span class="free">t'</span> <span class="free">n</span> <span class="main">(</span><span class="main">λ</span><span class="bound">t</span> <span class="bound">n</span><span class="main">.</span> <span class="free">γ</span> <span class="bound">t</span> <span class="bound">n</span> <span class="main">∧</span> <span class="free">γ'</span> <span class="bound">t</span> <span class="bound">n</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> conj_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">γ</span> <span class="main">(</span>lnth <span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">cid</span></sub><span class="hidden">⇙</span>inf_llist <span class="free">t</span> <span class="keyword1">@<span class="hidden">⇩</span><sub>l</sub></span> inf_llist <span class="free">t'</span><span class="main">)</span><span class="main">)</span> <span class="main">(</span>the_enat <span class="main">⟨</span><span class="free">cid</span> #<span class="hidden">⇘</span><sub>enat <span class="free">n</span></sub><span class="hidden">⇙</span>inf_llist <span class="free">t</span><span class="main">⟩</span><span class="main">)</span>
      <span class="main">∧</span> <span class="free">γ'</span> <span class="main">(</span>lnth <span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">cid</span></sub><span class="hidden">⇙</span>inf_llist <span class="free">t</span> <span class="keyword1">@<span class="hidden">⇩</span><sub>l</sub></span> inf_llist <span class="free">t'</span><span class="main">)</span><span class="main">)</span> <span class="main">(</span>the_enat <span class="main">⟨</span><span class="free">cid</span> #<span class="hidden">⇘</span><sub>enat <span class="free">n</span></sub><span class="hidden">⇙</span>inf_llist <span class="free">t</span><span class="main">⟩</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> validCE_act<span class="main">[</span><span class="keyword2"><span class="keyword"><span class="operator">where</span></span></span> γ<span class="main"><span class="main">=</span></span><span class="quoted"><span class="quoted">"<span class="main">λ</span> <span class="bound">t</span> <span class="bound">n</span><span class="main">.</span> <span class="free">γ</span> <span class="bound">t</span> <span class="bound">n</span> <span class="main">∧</span> <span class="free">γ'</span> <span class="bound">t</span> <span class="bound">n</span>"</span></span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
    <span class="keyword1"><span class="command">with</span></span> <span class="quoted"><span class="quoted">‹<span class="main">∃</span><span class="bound"><span class="bound">i</span></span><span class="main">≥</span><span class="free">n</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">cid</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i</span></sub><span class="hidden">⇙</span>›</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> eval_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">next</span></span>
    <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> <span class="main">(</span><span class="main">∃</span><span class="bound"><span class="bound">i</span></span><span class="main">≥</span><span class="free">n</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">cid</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i</span></sub><span class="hidden">⇙</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹eval <span class="free">cid</span> <span class="free">t</span> <span class="free">t'</span> <span class="free">n</span> <span class="main">(</span><span class="free">γ</span> <span class="keyword1">∧<span class="hidden">⇧</span><sup>b</sup></span> <span class="free">γ'</span><span class="main">)</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"eval <span class="free">cid</span> <span class="free">t</span> <span class="free">t'</span> <span class="free">n</span> <span class="main">(</span><span class="main">λ</span><span class="bound">t</span> <span class="bound">n</span><span class="main">.</span> <span class="free">γ</span> <span class="bound">t</span> <span class="bound">n</span> <span class="main">∧</span> <span class="free">γ'</span> <span class="bound">t</span> <span class="bound">n</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> conj_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">γ</span> <span class="main">(</span>lnth <span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">cid</span></sub><span class="hidden">⇙</span>inf_llist <span class="free">t</span> <span class="keyword1">@<span class="hidden">⇩</span><sub>l</sub></span> inf_llist <span class="free">t'</span><span class="main">)</span><span class="main">)</span> <span class="main">(</span><span class="hidden">⇘</span><sub><span class="free">cid</span></sub><span class="hidden">⇙</span>↓<span class="hidden">⇘</span><sub><span class="free">t</span></sub><span class="hidden">⇙</span><span class="free">n</span><span class="main">)</span>
      <span class="main">∧</span> <span class="free">γ'</span> <span class="main">(</span>lnth <span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">cid</span></sub><span class="hidden">⇙</span>inf_llist <span class="free">t</span> <span class="keyword1">@<span class="hidden">⇩</span><sub>l</sub></span> inf_llist <span class="free">t'</span><span class="main">)</span><span class="main">)</span> <span class="main">(</span><span class="hidden">⇘</span><sub><span class="free">cid</span></sub><span class="hidden">⇙</span>↓<span class="hidden">⇘</span><sub><span class="free">t</span></sub><span class="hidden">⇙</span><span class="free">n</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> validCE_cont<span class="main">[</span><span class="keyword2"><span class="keyword"><span class="operator">where</span></span></span> γ<span class="main"><span class="main">=</span></span><span class="quoted"><span class="quoted">"<span class="main">λ</span> <span class="bound">t</span> <span class="bound">n</span><span class="main">.</span> <span class="free">γ</span> <span class="bound">t</span> <span class="bound">n</span> <span class="main">∧</span> <span class="free">γ'</span> <span class="bound">t</span> <span class="bound">n</span>"</span></span><span class="main">]</span> <span class="quoted"><span class="quoted">‹<span class="main">∃</span><span class="bound">i</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">cid</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i</span></sub><span class="hidden">⇙</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
    <span class="keyword1"><span class="command">with</span></span> <span class="quoted"><span class="quoted">‹<span class="main">¬</span> <span class="main">(</span><span class="main">∃</span><span class="bound"><span class="bound">i</span></span><span class="main">≥</span><span class="free">n</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">cid</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i</span></sub><span class="hidden">⇙</span><span class="main">)</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="main">∃</span><span class="bound">i</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">cid</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i</span></sub><span class="hidden">⇙</span>›</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> eval_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">qed</span></span>
<span class="keyword1"><span class="command">next</span></span>
  <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span><span class="main">(</span><span class="main">∃</span><span class="bound">i</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">cid</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i</span></sub><span class="hidden">⇙</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹eval <span class="free">cid</span> <span class="free">t</span> <span class="free">t'</span> <span class="free">n</span> <span class="main">(</span><span class="free">γ</span> <span class="keyword1">∧<span class="hidden">⇧</span><sup>b</sup></span> <span class="free">γ'</span><span class="main">)</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"eval <span class="free">cid</span> <span class="free">t</span> <span class="free">t'</span> <span class="free">n</span> <span class="main">(</span><span class="main">λ</span><span class="bound">t</span> <span class="bound">n</span><span class="main">.</span> <span class="free">γ</span> <span class="bound">t</span> <span class="bound">n</span> <span class="main">∧</span> <span class="free">γ'</span> <span class="bound">t</span> <span class="bound">n</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> conj_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">γ</span> <span class="main">(</span>lnth <span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">cid</span></sub><span class="hidden">⇙</span>inf_llist <span class="free">t</span> <span class="keyword1">@<span class="hidden">⇩</span><sub>l</sub></span> inf_llist <span class="free">t'</span><span class="main">)</span><span class="main">)</span> <span class="free">n</span> <span class="main">∧</span> <span class="free">γ'</span> <span class="main">(</span>lnth <span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">cid</span></sub><span class="hidden">⇙</span>inf_llist <span class="free">t</span> <span class="keyword1">@<span class="hidden">⇩</span><sub>l</sub></span> inf_llist <span class="free">t'</span><span class="main">)</span><span class="main">)</span> <span class="free">n</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> validCE_not_act<span class="main">[</span><span class="keyword2"><span class="keyword"><span class="operator">where</span></span></span> γ<span class="main"><span class="main">=</span></span><span class="quoted"><span class="quoted">"<span class="main">λ</span> <span class="bound">t</span> <span class="bound">n</span><span class="main">.</span> <span class="free">γ</span> <span class="bound">t</span> <span class="bound">n</span> <span class="main">∧</span> <span class="free">γ'</span> <span class="bound">t</span> <span class="bound">n</span>"</span></span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">with</span></span> <span class="quoted"><span class="quoted">‹<span class="main">¬</span><span class="main">(</span><span class="main">∃</span><span class="bound">i</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">cid</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i</span></sub><span class="hidden">⇙</span><span class="main">)</span>›</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> eval_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">subsubsection</span></span> <span class="quoted"><span class="plain_text">"Negation"</span></span>
  
<span class="keyword1"><span class="command">definition</span></span> <span class="entity">neg</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="tfree">'cmp</span> bta<span class="main">)</span> <span class="main">⇒</span> <span class="main">(</span><span class="tfree">'cmp</span> bta<span class="main">)</span>"</span></span> <span class="main">(</span><span class="quoted">"<span class="keyword1">¬<span class="hidden">⇧</span><sup>b</sup></span> _"</span> <span class="main">[</span>19<span class="main">]</span> 19<span class="main">)</span>
  <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1"><span class="free">¬<span class="hidden">⇧</span><sup>b</sup></span></span> <span class="free"><span class="bound"><span class="entity">γ</span></span></span> <span class="main">≡</span> <span class="main">λ</span> <span class="bound">t</span> <span class="bound">n</span><span class="main">.</span> <span class="main">¬</span> <span class="free"><span class="bound"><span class="entity">γ</span></span></span> <span class="bound">t</span> <span class="bound">n</span>"</span></span>
    
<span class="keyword1" id="Dynamic_Architecture_Calculus-negI"><span class="command">lemma</span></span> negI<span class="main">[</span><span class="operator">intro</span><span class="main"><span class="main"><span class="main">!</span></span></span><span class="main">]</span><span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> eval <span class="free">cid</span> <span class="free">t</span> <span class="free">t'</span> <span class="free">n</span> <span class="free">γ</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"eval <span class="free">cid</span> <span class="free">t</span> <span class="free">t'</span> <span class="free">n</span> <span class="main">(</span><span class="keyword1">¬<span class="hidden">⇧</span><sup>b</sup></span> <span class="free">γ</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">cases</span>
  <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound">i</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">cid</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i</span></sub><span class="hidden">⇙</span>"</span></span>
  <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="operator">cases</span>
    <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound"><span class="bound">i</span></span><span class="main">≥</span><span class="free">n</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">cid</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i</span></sub><span class="hidden">⇙</span>"</span></span>
    <span class="keyword1"><span class="command">with</span></span> <span class="quoted"><span class="quoted">‹<span class="main">¬</span> eval <span class="free">cid</span> <span class="free">t</span> <span class="free">t'</span> <span class="free">n</span> <span class="free">γ</span>›</span></span>
      <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> <span class="free">γ</span> <span class="main">(</span>lnth <span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">cid</span></sub><span class="hidden">⇙</span>inf_llist <span class="free">t</span> <span class="keyword1">@<span class="hidden">⇩</span><sub>l</sub></span> inf_llist <span class="free">t'</span><span class="main">)</span><span class="main">)</span> <span class="main">(</span>the_enat <span class="main">⟨</span><span class="free">cid</span> #<span class="hidden">⇘</span><sub>enat <span class="free">n</span></sub><span class="hidden">⇙</span>inf_llist <span class="free">t</span><span class="main">⟩</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> eval_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
    <span class="keyword1"><span class="command">with</span></span> <span class="quoted"><span class="quoted">‹<span class="main">∃</span><span class="bound"><span class="bound">i</span></span><span class="main">≥</span><span class="free">n</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">cid</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i</span></sub><span class="hidden">⇙</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"eval <span class="free">cid</span> <span class="free">t</span> <span class="free">t'</span> <span class="free">n</span> <span class="main">(</span><span class="main">λ</span><span class="bound">t</span> <span class="bound">n</span><span class="main">.</span> <span class="main">¬</span> <span class="free">γ</span> <span class="bound">t</span> <span class="bound">n</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> validCI_act<span class="main">[</span><span class="keyword2"><span class="keyword"><span class="operator">where</span></span></span> γ<span class="main"><span class="main">=</span></span><span class="quoted"><span class="quoted">"<span class="main">λ</span> <span class="bound">t</span> <span class="bound">n</span><span class="main">.</span> <span class="main">¬</span> <span class="free">γ</span> <span class="bound">t</span> <span class="bound">n</span>"</span></span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
    <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> neg_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">next</span></span>
    <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> <span class="main">(</span><span class="main">∃</span><span class="bound"><span class="bound">i</span></span><span class="main">≥</span><span class="free">n</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">cid</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i</span></sub><span class="hidden">⇙</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">with</span></span> <span class="quoted"><span class="quoted">‹<span class="main">∃</span><span class="bound">i</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">cid</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i</span></sub><span class="hidden">⇙</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="main">¬</span> eval <span class="free">cid</span> <span class="free">t</span> <span class="free">t'</span> <span class="free">n</span> <span class="free">γ</span>›</span></span>
      <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> <span class="free">γ</span> <span class="main">(</span>lnth <span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">cid</span></sub><span class="hidden">⇙</span>inf_llist <span class="free">t</span> <span class="keyword1">@<span class="hidden">⇩</span><sub>l</sub></span> inf_llist <span class="free">t'</span><span class="main">)</span><span class="main">)</span> <span class="main">(</span><span class="hidden">⇘</span><sub><span class="free">cid</span></sub><span class="hidden">⇙</span>↓<span class="hidden">⇘</span><sub><span class="free">t</span></sub><span class="hidden">⇙</span><span class="free">n</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> eval_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
    <span class="keyword1"><span class="command">with</span></span> <span class="quoted"><span class="quoted">‹<span class="main">∃</span><span class="bound">i</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">cid</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i</span></sub><span class="hidden">⇙</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="main">¬</span> <span class="main">(</span><span class="main">∃</span><span class="bound"><span class="bound">i</span></span><span class="main">≥</span><span class="free">n</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">cid</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i</span></sub><span class="hidden">⇙</span><span class="main">)</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"eval <span class="free">cid</span> <span class="free">t</span> <span class="free">t'</span> <span class="free">n</span> <span class="main">(</span><span class="main">λ</span><span class="bound">t</span> <span class="bound">n</span><span class="main">.</span> <span class="main">¬</span> <span class="free">γ</span> <span class="bound">t</span> <span class="bound">n</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> validCI_cont<span class="main">[</span><span class="keyword2"><span class="keyword"><span class="operator">where</span></span></span> γ<span class="main"><span class="main">=</span></span><span class="quoted"><span class="quoted">"<span class="main">λ</span> <span class="bound">t</span> <span class="bound">n</span><span class="main">.</span> <span class="main">¬</span> <span class="free">γ</span> <span class="bound">t</span> <span class="bound">n</span>"</span></span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
    <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> neg_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">qed</span></span>
<span class="keyword1"><span class="command">next</span></span>
  <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span><span class="main">(</span><span class="main">∃</span><span class="bound">i</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">cid</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i</span></sub><span class="hidden">⇙</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">with</span></span> <span class="quoted"><span class="quoted">‹<span class="main">¬</span> eval <span class="free">cid</span> <span class="free">t</span> <span class="free">t'</span> <span class="free">n</span> <span class="free">γ</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> <span class="free">γ</span> <span class="main">(</span>lnth <span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">cid</span></sub><span class="hidden">⇙</span>inf_llist <span class="free">t</span> <span class="keyword1">@<span class="hidden">⇩</span><sub>l</sub></span> inf_llist <span class="free">t'</span><span class="main">)</span><span class="main">)</span> <span class="free">n</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> eval_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">with</span></span> <span class="quoted"><span class="quoted">‹<span class="main">¬</span><span class="main">(</span><span class="main">∃</span><span class="bound">i</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">cid</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i</span></sub><span class="hidden">⇙</span><span class="main">)</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"eval <span class="free">cid</span> <span class="free">t</span> <span class="free">t'</span> <span class="free">n</span> <span class="main">(</span><span class="main">λ</span><span class="bound">t</span> <span class="bound">n</span><span class="main">.</span> <span class="main">¬</span> <span class="free">γ</span> <span class="bound">t</span> <span class="bound">n</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> validCI_not_act<span class="main">[</span><span class="keyword2"><span class="keyword"><span class="operator">where</span></span></span> γ<span class="main"><span class="main">=</span></span><span class="quoted"><span class="quoted">"<span class="main">λ</span> <span class="bound">t</span> <span class="bound">n</span><span class="main">.</span> <span class="main">¬</span> <span class="free">γ</span> <span class="bound">t</span> <span class="bound">n</span>"</span></span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> neg_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>    
<span class="keyword1"><span class="command">qed</span></span>   

<span class="keyword1" id="Dynamic_Architecture_Calculus-negE"><span class="command">lemma</span></span> negE<span class="main">[</span><span class="operator">elim</span><span class="main"><span class="main"><span class="main">!</span></span></span><span class="main">]</span><span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"eval <span class="free">cid</span> <span class="free">t</span> <span class="free">t'</span> <span class="free">n</span> <span class="main">(</span><span class="keyword1">¬<span class="hidden">⇧</span><sup>b</sup></span> <span class="free">γ</span><span class="main">)</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> eval <span class="free">cid</span> <span class="free">t</span> <span class="free">t'</span> <span class="free">n</span> <span class="free">γ</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">cases</span>
  <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">∃</span><span class="bound">i</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">cid</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i</span></sub><span class="hidden">⇙</span><span class="main">)</span>"</span></span>
  <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="operator">cases</span>
    <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound"><span class="bound">i</span></span><span class="main">≥</span><span class="free">n</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">cid</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i</span></sub><span class="hidden">⇙</span>"</span></span>
    <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹eval <span class="free">cid</span> <span class="free">t</span> <span class="free">t'</span> <span class="free">n</span> <span class="main">(</span><span class="keyword1">¬<span class="hidden">⇧</span><sup>b</sup></span> <span class="free">γ</span><span class="main">)</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"eval <span class="free">cid</span> <span class="free">t</span> <span class="free">t'</span> <span class="free">n</span> <span class="main">(</span><span class="main">λ</span><span class="bound">t</span> <span class="bound">n</span><span class="main">.</span> <span class="main">¬</span> <span class="free">γ</span> <span class="bound">t</span> <span class="bound">n</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> neg_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> <span class="free">γ</span> <span class="main">(</span>lnth <span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">cid</span></sub><span class="hidden">⇙</span>inf_llist <span class="free">t</span> <span class="keyword1">@<span class="hidden">⇩</span><sub>l</sub></span> inf_llist <span class="free">t'</span><span class="main">)</span><span class="main">)</span> <span class="main">(</span>the_enat <span class="main">⟨</span><span class="free">cid</span> #<span class="hidden">⇘</span><sub>enat <span class="free">n</span></sub><span class="hidden">⇙</span>inf_llist <span class="free">t</span><span class="main">⟩</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> validCE_act<span class="main">[</span><span class="keyword2"><span class="keyword"><span class="operator">where</span></span></span> γ<span class="main"><span class="main">=</span></span><span class="quoted"><span class="quoted">"<span class="main">λ</span> <span class="bound">t</span> <span class="bound">n</span><span class="main">.</span> <span class="main">¬</span> <span class="free">γ</span> <span class="bound">t</span> <span class="bound">n</span>"</span></span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
    <span class="keyword1"><span class="command">with</span></span> <span class="quoted"><span class="quoted">‹<span class="main">∃</span><span class="bound"><span class="bound">i</span></span><span class="main">≥</span><span class="free">n</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">cid</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i</span></sub><span class="hidden">⇙</span>›</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> eval_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">next</span></span>
    <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> <span class="main">(</span><span class="main">∃</span><span class="bound"><span class="bound">i</span></span><span class="main">≥</span><span class="free">n</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">cid</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i</span></sub><span class="hidden">⇙</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹eval <span class="free">cid</span> <span class="free">t</span> <span class="free">t'</span> <span class="free">n</span> <span class="main">(</span><span class="keyword1">¬<span class="hidden">⇧</span><sup>b</sup></span> <span class="free">γ</span><span class="main">)</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"eval <span class="free">cid</span> <span class="free">t</span> <span class="free">t'</span> <span class="free">n</span> <span class="main">(</span><span class="main">λ</span><span class="bound">t</span> <span class="bound">n</span><span class="main">.</span> <span class="main">¬</span> <span class="free">γ</span> <span class="bound">t</span> <span class="bound">n</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> neg_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> <span class="free">γ</span> <span class="main">(</span>lnth <span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">cid</span></sub><span class="hidden">⇙</span>inf_llist <span class="free">t</span> <span class="keyword1">@<span class="hidden">⇩</span><sub>l</sub></span> inf_llist <span class="free">t'</span><span class="main">)</span><span class="main">)</span> <span class="main">(</span><span class="hidden">⇘</span><sub><span class="free">cid</span></sub><span class="hidden">⇙</span>↓<span class="hidden">⇘</span><sub><span class="free">t</span></sub><span class="hidden">⇙</span><span class="free">n</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> validCE_cont<span class="main">[</span><span class="keyword2"><span class="keyword"><span class="operator">where</span></span></span> γ<span class="main"><span class="main">=</span></span><span class="quoted"><span class="quoted">"<span class="main">λ</span> <span class="bound">t</span> <span class="bound">n</span><span class="main">.</span> <span class="main">¬</span> <span class="free">γ</span> <span class="bound">t</span> <span class="bound">n</span>"</span></span><span class="main">]</span> <span class="quoted"><span class="quoted">‹<span class="main">∃</span><span class="bound">i</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">cid</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i</span></sub><span class="hidden">⇙</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
    <span class="keyword1"><span class="command">with</span></span> <span class="quoted"><span class="quoted">‹<span class="main">¬</span> <span class="main">(</span><span class="main">∃</span><span class="bound"><span class="bound">i</span></span><span class="main">≥</span><span class="free">n</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">cid</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i</span></sub><span class="hidden">⇙</span><span class="main">)</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="main">∃</span><span class="bound">i</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">cid</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i</span></sub><span class="hidden">⇙</span>›</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> eval_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">qed</span></span>
<span class="keyword1"><span class="command">next</span></span>
  <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span><span class="main">(</span><span class="main">∃</span><span class="bound">i</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">cid</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i</span></sub><span class="hidden">⇙</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹eval <span class="free">cid</span> <span class="free">t</span> <span class="free">t'</span> <span class="free">n</span> <span class="main">(</span><span class="keyword1">¬<span class="hidden">⇧</span><sup>b</sup></span> <span class="free">γ</span><span class="main">)</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"eval <span class="free">cid</span> <span class="free">t</span> <span class="free">t'</span> <span class="free">n</span> <span class="main">(</span><span class="main">λ</span><span class="bound">t</span> <span class="bound">n</span><span class="main">.</span> <span class="main">¬</span> <span class="free">γ</span> <span class="bound">t</span> <span class="bound">n</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> neg_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> <span class="free">γ</span> <span class="main">(</span>lnth <span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">cid</span></sub><span class="hidden">⇙</span>inf_llist <span class="free">t</span> <span class="keyword1">@<span class="hidden">⇩</span><sub>l</sub></span> inf_llist <span class="free">t'</span><span class="main">)</span><span class="main">)</span> <span class="free">n</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> validCE_not_act<span class="main">[</span><span class="keyword2"><span class="keyword"><span class="operator">where</span></span></span> γ<span class="main"><span class="main">=</span></span><span class="quoted"><span class="quoted">"<span class="main">λ</span> <span class="bound">t</span> <span class="bound">n</span><span class="main">.</span> <span class="main">¬</span> <span class="free">γ</span> <span class="bound">t</span> <span class="bound">n</span>"</span></span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">with</span></span> <span class="quoted"><span class="quoted">‹<span class="main">¬</span><span class="main">(</span><span class="main">∃</span><span class="bound">i</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">cid</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i</span></sub><span class="hidden">⇙</span><span class="main">)</span>›</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> eval_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">subsubsection</span></span> <span class="quoted"><span class="plain_text">"Quantifiers"</span></span>

<span class="keyword1"><span class="command">definition</span></span> <span class="entity">all</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="tfree">'a</span> <span class="main">⇒</span> <span class="main">(</span><span class="tfree">'cmp</span> bta<span class="main">)</span><span class="main">)</span>
  <span class="main">⇒</span> <span class="main">(</span><span class="tfree">'cmp</span> bta<span class="main">)</span>"</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">binder</span></span> <span class="quoted">"<span class="keyword1">∀<span class="hidden">⇩</span><sub>b</sub></span>"</span> 10<span class="main">)</span>
  <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="free">all</span> <span class="free"><span class="bound"><span class="entity">P</span></span></span> <span class="main">≡</span> <span class="main">λ</span><span class="bound">t</span> <span class="bound">n</span><span class="main">.</span> <span class="main">(</span><span class="main">∀</span><span class="bound">y</span><span class="main">.</span> <span class="main">(</span><span class="free"><span class="bound"><span class="entity">P</span></span></span> <span class="bound">y</span> <span class="bound">t</span> <span class="bound">n</span><span class="main">)</span><span class="main">)</span>"</span></span>

<span class="keyword1" id="Dynamic_Architecture_Calculus-allI"><span class="command">lemma</span></span> allI<span class="main">[</span><span class="operator">intro</span><span class="main"><span class="main"><span class="main">!</span></span></span><span class="main">]</span><span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">p</span><span class="main">.</span> eval <span class="free">cid</span> <span class="free">t</span> <span class="free">t'</span> <span class="free">n</span> <span class="main">(</span><span class="free">γ</span> <span class="bound">p</span><span class="main">)</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"eval <span class="free">cid</span> <span class="free">t</span> <span class="free">t'</span> <span class="free">n</span> <span class="main">(</span>all <span class="main">(</span><span class="main">λ</span><span class="bound">p</span><span class="main">.</span> <span class="free">γ</span> <span class="bound">p</span><span class="main">)</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">cases</span>
  <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound">i</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">cid</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i</span></sub><span class="hidden">⇙</span>"</span></span>
  <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="operator">cases</span>
    <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound"><span class="bound">i</span></span><span class="main">≥</span><span class="free">n</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">cid</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i</span></sub><span class="hidden">⇙</span>"</span></span>
    <span class="keyword1"><span class="command">with</span></span> <span class="quoted"><span class="quoted">‹<span class="main">∀</span><span class="bound">p</span><span class="main">.</span> eval <span class="free">cid</span> <span class="free">t</span> <span class="free">t'</span> <span class="free">n</span> <span class="main">(</span><span class="free">γ</span> <span class="bound">p</span><span class="main">)</span>›</span></span>
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">p</span><span class="main">.</span> <span class="main">(</span><span class="free">γ</span> <span class="bound">p</span><span class="main">)</span> <span class="main">(</span>lnth <span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">cid</span></sub><span class="hidden">⇙</span>inf_llist <span class="free">t</span> <span class="keyword1">@<span class="hidden">⇩</span><sub>l</sub></span> inf_llist <span class="free">t'</span><span class="main">)</span><span class="main">)</span> <span class="main">(</span>the_enat <span class="main">⟨</span><span class="free">cid</span> #<span class="hidden">⇘</span><sub>enat <span class="free">n</span></sub><span class="hidden">⇙</span>inf_llist <span class="free">t</span><span class="main">⟩</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> eval_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
    <span class="keyword1"><span class="command">with</span></span> <span class="quoted"><span class="quoted">‹<span class="main">∃</span><span class="bound"><span class="bound">i</span></span><span class="main">≥</span><span class="free">n</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">cid</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i</span></sub><span class="hidden">⇙</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"eval <span class="free">cid</span> <span class="free">t</span> <span class="free">t'</span> <span class="free">n</span> <span class="main">(</span><span class="main">λ</span><span class="bound">t</span> <span class="bound">n</span><span class="main">.</span> <span class="main">(</span><span class="main">∀</span><span class="bound">y</span><span class="main">.</span> <span class="main">(</span><span class="free">γ</span> <span class="bound">y</span> <span class="bound">t</span> <span class="bound">n</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> validCI_act<span class="main">[</span><span class="keyword2"><span class="keyword"><span class="operator">where</span></span></span> γ<span class="main"><span class="main">=</span></span><span class="quoted"><span class="quoted">"<span class="main">λ</span><span class="bound">t</span> <span class="bound">n</span><span class="main">.</span> <span class="main">(</span><span class="main">∀</span><span class="bound">y</span><span class="main">.</span> <span class="main">(</span><span class="free">γ</span> <span class="bound">y</span> <span class="bound">t</span> <span class="bound">n</span><span class="main">)</span><span class="main">)</span>"</span></span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
    <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> all_def<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="free">γ</span></span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">next</span></span>
    <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> <span class="main">(</span><span class="main">∃</span><span class="bound"><span class="bound">i</span></span><span class="main">≥</span><span class="free">n</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">cid</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i</span></sub><span class="hidden">⇙</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">with</span></span> <span class="quoted"><span class="quoted">‹<span class="main">∃</span><span class="bound">i</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">cid</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i</span></sub><span class="hidden">⇙</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="main">∀</span><span class="bound">p</span><span class="main">.</span> eval <span class="free">cid</span> <span class="free">t</span> <span class="free">t'</span> <span class="free">n</span> <span class="main">(</span><span class="free">γ</span> <span class="bound">p</span><span class="main">)</span>›</span></span>
      <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">p</span><span class="main">.</span> <span class="main">(</span><span class="free">γ</span> <span class="bound">p</span><span class="main">)</span> <span class="main">(</span>lnth <span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">cid</span></sub><span class="hidden">⇙</span>inf_llist <span class="free">t</span> <span class="keyword1">@<span class="hidden">⇩</span><sub>l</sub></span> inf_llist <span class="free">t'</span><span class="main">)</span><span class="main">)</span> <span class="main">(</span><span class="hidden">⇘</span><sub><span class="free">cid</span></sub><span class="hidden">⇙</span>↓<span class="hidden">⇘</span><sub><span class="free">t</span></sub><span class="hidden">⇙</span><span class="free">n</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> eval_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
    <span class="keyword1"><span class="command">with</span></span> <span class="quoted"><span class="quoted">‹<span class="main">∃</span><span class="bound">i</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">cid</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i</span></sub><span class="hidden">⇙</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="main">¬</span> <span class="main">(</span><span class="main">∃</span><span class="bound"><span class="bound">i</span></span><span class="main">≥</span><span class="free">n</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">cid</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i</span></sub><span class="hidden">⇙</span><span class="main">)</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"eval <span class="free">cid</span> <span class="free">t</span> <span class="free">t'</span> <span class="free">n</span> <span class="main">(</span><span class="main">λ</span><span class="bound">t</span> <span class="bound">n</span><span class="main">.</span> <span class="main">(</span><span class="main">∀</span><span class="bound">y</span><span class="main">.</span> <span class="main">(</span><span class="free">γ</span> <span class="bound">y</span> <span class="bound">t</span> <span class="bound">n</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> validCI_cont<span class="main">[</span><span class="keyword2"><span class="keyword"><span class="operator">where</span></span></span> γ<span class="main"><span class="main">=</span></span><span class="quoted"><span class="quoted">"<span class="main">λ</span><span class="bound">t</span> <span class="bound">n</span><span class="main">.</span> <span class="main">(</span><span class="main">∀</span><span class="bound">y</span><span class="main">.</span> <span class="main">(</span><span class="free">γ</span> <span class="bound">y</span> <span class="bound">t</span> <span class="bound">n</span><span class="main">)</span><span class="main">)</span>"</span></span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
    <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> all_def<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="free">γ</span></span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">qed</span></span>
<span class="keyword1"><span class="command">next</span></span>
  <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span><span class="main">(</span><span class="main">∃</span><span class="bound">i</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">cid</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i</span></sub><span class="hidden">⇙</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">with</span></span> <span class="quoted"><span class="quoted">‹<span class="main">∀</span><span class="bound">p</span><span class="main">.</span> eval <span class="free">cid</span> <span class="free">t</span> <span class="free">t'</span> <span class="free">n</span> <span class="main">(</span><span class="free">γ</span> <span class="bound">p</span><span class="main">)</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">p</span><span class="main">.</span> <span class="main">(</span><span class="free">γ</span> <span class="bound">p</span><span class="main">)</span> <span class="main">(</span>lnth <span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">cid</span></sub><span class="hidden">⇙</span>inf_llist <span class="free">t</span> <span class="keyword1">@<span class="hidden">⇩</span><sub>l</sub></span> inf_llist <span class="free">t'</span><span class="main">)</span><span class="main">)</span> <span class="free">n</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> eval_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">with</span></span> <span class="quoted"><span class="quoted">‹<span class="main">¬</span><span class="main">(</span><span class="main">∃</span><span class="bound">i</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">cid</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i</span></sub><span class="hidden">⇙</span><span class="main">)</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"eval <span class="free">cid</span> <span class="free">t</span> <span class="free">t'</span> <span class="free">n</span> <span class="main">(</span><span class="main">λ</span><span class="bound">t</span> <span class="bound">n</span><span class="main">.</span> <span class="main">(</span><span class="main">∀</span><span class="bound">y</span><span class="main">.</span> <span class="main">(</span><span class="free">γ</span> <span class="bound">y</span> <span class="bound">t</span> <span class="bound">n</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> validCI_not_act<span class="main">[</span><span class="keyword2"><span class="keyword"><span class="operator">where</span></span></span> γ<span class="main"><span class="main">=</span></span><span class="quoted"><span class="quoted">"<span class="main">λ</span><span class="bound">t</span> <span class="bound">n</span><span class="main">.</span> <span class="main">(</span><span class="main">∀</span><span class="bound">y</span><span class="main">.</span> <span class="main">(</span><span class="free">γ</span> <span class="bound">y</span> <span class="bound">t</span> <span class="bound">n</span><span class="main">)</span><span class="main">)</span>"</span></span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> all_def<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="free">γ</span></span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>
  
<span class="keyword1" id="Dynamic_Architecture_Calculus-allE"><span class="command">lemma</span></span> allE<span class="main">[</span><span class="operator">elim</span><span class="main"><span class="main"><span class="main">!</span></span></span><span class="main">]</span><span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"eval <span class="free">cid</span> <span class="free">t</span> <span class="free">t'</span> <span class="free">n</span> <span class="main">(</span>all <span class="main">(</span><span class="main">λ</span><span class="bound">p</span><span class="main">.</span> <span class="free">γ</span> <span class="bound">p</span><span class="main">)</span><span class="main">)</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">p</span><span class="main">.</span> eval <span class="free">cid</span> <span class="free">t</span> <span class="free">t'</span> <span class="free">n</span> <span class="main">(</span><span class="free">γ</span> <span class="bound">p</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">cases</span>
  <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">∃</span><span class="bound">i</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">cid</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i</span></sub><span class="hidden">⇙</span><span class="main">)</span>"</span></span>
  <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="operator">cases</span>
    <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound"><span class="bound">i</span></span><span class="main">≥</span><span class="free">n</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">cid</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i</span></sub><span class="hidden">⇙</span>"</span></span>
    <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹eval <span class="free">cid</span> <span class="free">t</span> <span class="free">t'</span> <span class="free">n</span> <span class="main">(</span>all <span class="main">(</span><span class="main">λ</span><span class="bound">p</span><span class="main">.</span> <span class="free">γ</span> <span class="bound">p</span><span class="main">)</span><span class="main">)</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"eval <span class="free">cid</span> <span class="free">t</span> <span class="free">t'</span> <span class="free">n</span> <span class="main">(</span><span class="main">λ</span><span class="bound">t</span> <span class="bound">n</span><span class="main">.</span> <span class="main">(</span><span class="main">∀</span><span class="bound">y</span><span class="main">.</span> <span class="main">(</span><span class="free">γ</span> <span class="bound">y</span> <span class="bound">t</span> <span class="bound">n</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> all_def<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="free">γ</span></span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">p</span><span class="main">.</span> <span class="main">(</span><span class="free">γ</span> <span class="bound">p</span><span class="main">)</span> <span class="main">(</span>lnth <span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">cid</span></sub><span class="hidden">⇙</span>inf_llist <span class="free">t</span> <span class="keyword1">@<span class="hidden">⇩</span><sub>l</sub></span> inf_llist <span class="free">t'</span><span class="main">)</span><span class="main">)</span> <span class="main">(</span>the_enat <span class="main">⟨</span><span class="free">cid</span> #<span class="hidden">⇘</span><sub>enat <span class="free">n</span></sub><span class="hidden">⇙</span>inf_llist <span class="free">t</span><span class="main">⟩</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> validCE_act<span class="main">[</span><span class="keyword2"><span class="keyword"><span class="operator">where</span></span></span> γ<span class="main"><span class="main">=</span></span><span class="quoted"><span class="quoted">"<span class="main">λ</span><span class="bound">t</span> <span class="bound">n</span><span class="main">.</span> <span class="main">(</span><span class="main">∀</span><span class="bound">y</span><span class="main">.</span> <span class="main">(</span><span class="free">γ</span> <span class="bound">y</span> <span class="bound">t</span> <span class="bound">n</span><span class="main">)</span><span class="main">)</span>"</span></span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
    <span class="keyword1"><span class="command">with</span></span> <span class="quoted"><span class="quoted">‹<span class="main">∃</span><span class="bound"><span class="bound">i</span></span><span class="main">≥</span><span class="free">n</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">cid</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i</span></sub><span class="hidden">⇙</span>›</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> eval_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">next</span></span>
    <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> <span class="main">(</span><span class="main">∃</span><span class="bound"><span class="bound">i</span></span><span class="main">≥</span><span class="free">n</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">cid</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i</span></sub><span class="hidden">⇙</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹eval <span class="free">cid</span> <span class="free">t</span> <span class="free">t'</span> <span class="free">n</span> <span class="main">(</span>all <span class="main">(</span><span class="main">λ</span><span class="bound">p</span><span class="main">.</span> <span class="free">γ</span> <span class="bound">p</span><span class="main">)</span><span class="main">)</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"eval <span class="free">cid</span> <span class="free">t</span> <span class="free">t'</span> <span class="free">n</span> <span class="main">(</span><span class="main">λ</span><span class="bound">t</span> <span class="bound">n</span><span class="main">.</span> <span class="main">(</span><span class="main">∀</span><span class="bound">y</span><span class="main">.</span> <span class="main">(</span><span class="free">γ</span> <span class="bound">y</span> <span class="bound">t</span> <span class="bound">n</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> all_def<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="free">γ</span></span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">p</span><span class="main">.</span> <span class="main">(</span><span class="free">γ</span> <span class="bound">p</span><span class="main">)</span> <span class="main">(</span>lnth <span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">cid</span></sub><span class="hidden">⇙</span>inf_llist <span class="free">t</span> <span class="keyword1">@<span class="hidden">⇩</span><sub>l</sub></span> inf_llist <span class="free">t'</span><span class="main">)</span><span class="main">)</span> <span class="main">(</span><span class="hidden">⇘</span><sub><span class="free">cid</span></sub><span class="hidden">⇙</span>↓<span class="hidden">⇘</span><sub><span class="free">t</span></sub><span class="hidden">⇙</span><span class="free">n</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> validCE_cont<span class="main">[</span><span class="keyword2"><span class="keyword"><span class="operator">where</span></span></span> γ<span class="main"><span class="main">=</span></span><span class="quoted"><span class="quoted">"<span class="main">λ</span><span class="bound">t</span> <span class="bound">n</span><span class="main">.</span> <span class="main">(</span><span class="main">∀</span><span class="bound">y</span><span class="main">.</span> <span class="main">(</span><span class="free">γ</span> <span class="bound">y</span> <span class="bound">t</span> <span class="bound">n</span><span class="main">)</span><span class="main">)</span>"</span></span><span class="main">]</span> <span class="quoted"><span class="quoted">‹<span class="main">∃</span><span class="bound">i</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">cid</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i</span></sub><span class="hidden">⇙</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
    <span class="keyword1"><span class="command">with</span></span> <span class="quoted"><span class="quoted">‹<span class="main">¬</span> <span class="main">(</span><span class="main">∃</span><span class="bound"><span class="bound">i</span></span><span class="main">≥</span><span class="free">n</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">cid</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i</span></sub><span class="hidden">⇙</span><span class="main">)</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="main">∃</span><span class="bound">i</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">cid</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i</span></sub><span class="hidden">⇙</span>›</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> eval_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">qed</span></span>
<span class="keyword1"><span class="command">next</span></span>
  <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span><span class="main">(</span><span class="main">∃</span><span class="bound">i</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">cid</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i</span></sub><span class="hidden">⇙</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹eval <span class="free">cid</span> <span class="free">t</span> <span class="free">t'</span> <span class="free">n</span> <span class="main">(</span>all <span class="main">(</span><span class="main">λ</span><span class="bound">p</span><span class="main">.</span> <span class="free">γ</span> <span class="bound">p</span><span class="main">)</span><span class="main">)</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"eval <span class="free">cid</span> <span class="free">t</span> <span class="free">t'</span> <span class="free">n</span> <span class="main">(</span><span class="main">λ</span><span class="bound">t</span> <span class="bound">n</span><span class="main">.</span> <span class="main">(</span><span class="main">∀</span><span class="bound">y</span><span class="main">.</span> <span class="main">(</span><span class="free">γ</span> <span class="bound">y</span> <span class="bound">t</span> <span class="bound">n</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> all_def<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="free">γ</span></span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">p</span><span class="main">.</span> <span class="main">(</span><span class="free">γ</span> <span class="bound">p</span><span class="main">)</span> <span class="main">(</span>lnth <span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">cid</span></sub><span class="hidden">⇙</span>inf_llist <span class="free">t</span> <span class="keyword1">@<span class="hidden">⇩</span><sub>l</sub></span> inf_llist <span class="free">t'</span><span class="main">)</span><span class="main">)</span> <span class="free">n</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> validCE_not_act<span class="main">[</span><span class="keyword2"><span class="keyword"><span class="operator">where</span></span></span> γ<span class="main"><span class="main">=</span></span><span class="quoted"><span class="quoted">"<span class="main">λ</span><span class="bound">t</span> <span class="bound">n</span><span class="main">.</span> <span class="main">(</span><span class="main">∀</span><span class="bound">y</span><span class="main">.</span> <span class="main">(</span><span class="free">γ</span> <span class="bound">y</span> <span class="bound">t</span> <span class="bound">n</span><span class="main">)</span><span class="main">)</span>"</span></span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">with</span></span> <span class="quoted"><span class="quoted">‹<span class="main">¬</span><span class="main">(</span><span class="main">∃</span><span class="bound">i</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">cid</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i</span></sub><span class="hidden">⇙</span><span class="main">)</span>›</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> eval_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
<span class="keyword1"><span class="command">qed</span></span>
  
<span class="keyword1"><span class="command">definition</span></span> <span class="entity">ex</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="tfree">'a</span> <span class="main">⇒</span> <span class="main">(</span><span class="tfree">'cmp</span> bta<span class="main">)</span><span class="main">)</span>
  <span class="main">⇒</span> <span class="main">(</span><span class="tfree">'cmp</span> bta<span class="main">)</span>"</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">binder</span></span> <span class="quoted">"<span class="keyword1">∃<span class="hidden">⇩</span><sub>b</sub></span>"</span> 10<span class="main">)</span>
  <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="free">ex</span> <span class="free"><span class="bound"><span class="entity">P</span></span></span> <span class="main">≡</span> <span class="main">λ</span><span class="bound">t</span> <span class="bound">n</span><span class="main">.</span> <span class="main">(</span><span class="main">∃</span><span class="bound">y</span><span class="main">.</span> <span class="main">(</span><span class="free"><span class="bound"><span class="entity">P</span></span></span> <span class="bound">y</span> <span class="bound">t</span> <span class="bound">n</span><span class="main">)</span><span class="main">)</span>"</span></span>
    
<span class="keyword1" id="Dynamic_Architecture_Calculus-exI"><span class="command">lemma</span></span> exI<span class="main">[</span><span class="operator">intro</span><span class="main"><span class="main"><span class="main">!</span></span></span><span class="main">]</span><span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound">p</span><span class="main">.</span> eval <span class="free">cid</span> <span class="free">t</span> <span class="free">t'</span> <span class="free">n</span> <span class="main">(</span><span class="free">γ</span> <span class="bound">p</span><span class="main">)</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"eval <span class="free">cid</span> <span class="free">t</span> <span class="free">t'</span> <span class="free">n</span> <span class="main">(</span><span class="keyword1">∃<span class="hidden">⇩</span><sub>b</sub></span><span class="bound">p</span><span class="main">.</span> <span class="free">γ</span> <span class="bound">p</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">cases</span>
  <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound">i</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">cid</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i</span></sub><span class="hidden">⇙</span>"</span></span>
  <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="operator">cases</span>
    <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound"><span class="bound">i</span></span><span class="main">≥</span><span class="free">n</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">cid</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i</span></sub><span class="hidden">⇙</span>"</span></span>
    <span class="keyword1"><span class="command">with</span></span> <span class="quoted"><span class="quoted">‹<span class="main">∃</span><span class="bound">p</span><span class="main">.</span> eval <span class="free">cid</span> <span class="free">t</span> <span class="free">t'</span> <span class="free">n</span> <span class="main">(</span><span class="free">γ</span> <span class="bound">p</span><span class="main">)</span>›</span></span>
      <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound">p</span><span class="main">.</span> <span class="main">(</span><span class="free">γ</span> <span class="bound">p</span><span class="main">)</span> <span class="main">(</span>lnth <span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">cid</span></sub><span class="hidden">⇙</span>inf_llist <span class="free">t</span> <span class="keyword1">@<span class="hidden">⇩</span><sub>l</sub></span> inf_llist <span class="free">t'</span><span class="main">)</span><span class="main">)</span> <span class="main">(</span>the_enat <span class="main">⟨</span><span class="free">cid</span> #<span class="hidden">⇘</span><sub>enat <span class="free">n</span></sub><span class="hidden">⇙</span>inf_llist <span class="free">t</span><span class="main">⟩</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> eval_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
    <span class="keyword1"><span class="command">with</span></span> <span class="quoted"><span class="quoted">‹<span class="main">∃</span><span class="bound"><span class="bound">i</span></span><span class="main">≥</span><span class="free">n</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">cid</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i</span></sub><span class="hidden">⇙</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"eval <span class="free">cid</span> <span class="free">t</span> <span class="free">t'</span> <span class="free">n</span> <span class="main">(</span><span class="main">λ</span><span class="bound">t</span> <span class="bound">n</span><span class="main">.</span> <span class="main">(</span><span class="main">∃</span><span class="bound">y</span><span class="main">.</span> <span class="main">(</span><span class="free">γ</span> <span class="bound">y</span> <span class="bound">t</span> <span class="bound">n</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> validCI_act<span class="main">[</span><span class="keyword2"><span class="keyword"><span class="operator">where</span></span></span> γ<span class="main"><span class="main">=</span></span><span class="quoted"><span class="quoted">"<span class="main">λ</span><span class="bound">t</span> <span class="bound">n</span><span class="main">.</span> <span class="main">(</span><span class="main">∃</span><span class="bound">y</span><span class="main">.</span> <span class="main">(</span><span class="free">γ</span> <span class="bound">y</span> <span class="bound">t</span> <span class="bound">n</span><span class="main">)</span><span class="main">)</span>"</span></span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
    <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> ex_def<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="free">γ</span></span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">next</span></span>
    <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> <span class="main">(</span><span class="main">∃</span><span class="bound"><span class="bound">i</span></span><span class="main">≥</span><span class="free">n</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">cid</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i</span></sub><span class="hidden">⇙</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">with</span></span> <span class="quoted"><span class="quoted">‹<span class="main">∃</span><span class="bound">i</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">cid</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i</span></sub><span class="hidden">⇙</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="main">∃</span><span class="bound">p</span><span class="main">.</span> eval <span class="free">cid</span> <span class="free">t</span> <span class="free">t'</span> <span class="free">n</span> <span class="main">(</span><span class="free">γ</span> <span class="bound">p</span><span class="main">)</span>›</span></span>
      <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound">p</span><span class="main">.</span> <span class="main">(</span><span class="free">γ</span> <span class="bound">p</span><span class="main">)</span> <span class="main">(</span>lnth <span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">cid</span></sub><span class="hidden">⇙</span>inf_llist <span class="free">t</span> <span class="keyword1">@<span class="hidden">⇩</span><sub>l</sub></span> inf_llist <span class="free">t'</span><span class="main">)</span><span class="main">)</span> <span class="main">(</span><span class="hidden">⇘</span><sub><span class="free">cid</span></sub><span class="hidden">⇙</span>↓<span class="hidden">⇘</span><sub><span class="free">t</span></sub><span class="hidden">⇙</span><span class="free">n</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> eval_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
    <span class="keyword1"><span class="command">with</span></span> <span class="quoted"><span class="quoted">‹<span class="main">∃</span><span class="bound">i</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">cid</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i</span></sub><span class="hidden">⇙</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="main">¬</span> <span class="main">(</span><span class="main">∃</span><span class="bound"><span class="bound">i</span></span><span class="main">≥</span><span class="free">n</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">cid</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i</span></sub><span class="hidden">⇙</span><span class="main">)</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"eval <span class="free">cid</span> <span class="free">t</span> <span class="free">t'</span> <span class="free">n</span> <span class="main">(</span><span class="main">λ</span><span class="bound">t</span> <span class="bound">n</span><span class="main">.</span> <span class="main">(</span><span class="main">∃</span><span class="bound">y</span><span class="main">.</span> <span class="main">(</span><span class="free">γ</span> <span class="bound">y</span> <span class="bound">t</span> <span class="bound">n</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> validCI_cont<span class="main">[</span><span class="keyword2"><span class="keyword"><span class="operator">where</span></span></span> γ<span class="main"><span class="main">=</span></span><span class="quoted"><span class="quoted">"<span class="main">λ</span><span class="bound">t</span> <span class="bound">n</span><span class="main">.</span> <span class="main">(</span><span class="main">∃</span><span class="bound">y</span><span class="main">.</span> <span class="main">(</span><span class="free">γ</span> <span class="bound">y</span> <span class="bound">t</span> <span class="bound">n</span><span class="main">)</span><span class="main">)</span>"</span></span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
    <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> ex_def<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="free">γ</span></span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">qed</span></span>
<span class="keyword1"><span class="command">next</span></span>
  <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span><span class="main">(</span><span class="main">∃</span><span class="bound">i</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">cid</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i</span></sub><span class="hidden">⇙</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">with</span></span> <span class="quoted"><span class="quoted">‹<span class="main">∃</span><span class="bound">p</span><span class="main">.</span> eval <span class="free">cid</span> <span class="free">t</span> <span class="free">t'</span> <span class="free">n</span> <span class="main">(</span><span class="free">γ</span> <span class="bound">p</span><span class="main">)</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound">p</span><span class="main">.</span> <span class="main">(</span><span class="free">γ</span> <span class="bound">p</span><span class="main">)</span> <span class="main">(</span>lnth <span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">cid</span></sub><span class="hidden">⇙</span>inf_llist <span class="free">t</span> <span class="keyword1">@<span class="hidden">⇩</span><sub>l</sub></span> inf_llist <span class="free">t'</span><span class="main">)</span><span class="main">)</span> <span class="free">n</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> eval_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">with</span></span> <span class="quoted"><span class="quoted">‹<span class="main">¬</span><span class="main">(</span><span class="main">∃</span><span class="bound">i</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">cid</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i</span></sub><span class="hidden">⇙</span><span class="main">)</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"eval <span class="free">cid</span> <span class="free">t</span> <span class="free">t'</span> <span class="free">n</span> <span class="main">(</span><span class="main">λ</span><span class="bound">t</span> <span class="bound">n</span><span class="main">.</span> <span class="main">(</span><span class="main">∃</span><span class="bound">y</span><span class="main">.</span> <span class="main">(</span><span class="free">γ</span> <span class="bound">y</span> <span class="bound">t</span> <span class="bound">n</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> validCI_not_act<span class="main">[</span><span class="keyword2"><span class="keyword"><span class="operator">where</span></span></span> γ<span class="main"><span class="main">=</span></span><span class="quoted"><span class="quoted">"<span class="main">λ</span><span class="bound">t</span> <span class="bound">n</span><span class="main">.</span> <span class="main">(</span><span class="main">∃</span><span class="bound">y</span><span class="main">.</span> <span class="main">(</span><span class="free">γ</span> <span class="bound">y</span> <span class="bound">t</span> <span class="bound">n</span><span class="main">)</span><span class="main">)</span>"</span></span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> ex_def<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="free">γ</span></span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>
  
<span class="keyword1" id="Dynamic_Architecture_Calculus-exE"><span class="command">lemma</span></span> exE<span class="main">[</span><span class="operator">elim</span><span class="main"><span class="main"><span class="main">!</span></span></span><span class="main">]</span><span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"eval <span class="free">cid</span> <span class="free">t</span> <span class="free">t'</span> <span class="free">n</span> <span class="main">(</span><span class="keyword1">∃<span class="hidden">⇩</span><sub>b</sub></span><span class="bound">p</span><span class="main">.</span> <span class="free">γ</span> <span class="bound">p</span><span class="main">)</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound">p</span><span class="main">.</span> eval <span class="free">cid</span> <span class="free">t</span> <span class="free">t'</span> <span class="free">n</span> <span class="main">(</span><span class="free">γ</span> <span class="bound">p</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">cases</span>
  <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">∃</span><span class="bound">i</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">cid</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i</span></sub><span class="hidden">⇙</span><span class="main">)</span>"</span></span>
  <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="operator">cases</span>
    <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound"><span class="bound">i</span></span><span class="main">≥</span><span class="free">n</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">cid</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i</span></sub><span class="hidden">⇙</span>"</span></span>
    <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹eval <span class="free">cid</span> <span class="free">t</span> <span class="free">t'</span> <span class="free">n</span> <span class="main">(</span>ex <span class="main">(</span><span class="main">λ</span><span class="bound">p</span><span class="main">.</span> <span class="free">γ</span> <span class="bound">p</span><span class="main">)</span><span class="main">)</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"eval <span class="free">cid</span> <span class="free">t</span> <span class="free">t'</span> <span class="free">n</span> <span class="main">(</span><span class="main">λ</span><span class="bound">t</span> <span class="bound">n</span><span class="main">.</span> <span class="main">(</span><span class="main">∃</span><span class="bound">y</span><span class="main">.</span> <span class="main">(</span><span class="free">γ</span> <span class="bound">y</span> <span class="bound">t</span> <span class="bound">n</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> ex_def<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="free">γ</span></span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound">p</span><span class="main">.</span> <span class="main">(</span><span class="free">γ</span> <span class="bound">p</span><span class="main">)</span> <span class="main">(</span>lnth <span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">cid</span></sub><span class="hidden">⇙</span>inf_llist <span class="free">t</span> <span class="keyword1">@<span class="hidden">⇩</span><sub>l</sub></span> inf_llist <span class="free">t'</span><span class="main">)</span><span class="main">)</span> <span class="main">(</span>the_enat <span class="main">⟨</span><span class="free">cid</span> #<span class="hidden">⇘</span><sub>enat <span class="free">n</span></sub><span class="hidden">⇙</span>inf_llist <span class="free">t</span><span class="main">⟩</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> validCE_act<span class="main">[</span><span class="keyword2"><span class="keyword"><span class="operator">where</span></span></span> γ<span class="main"><span class="main">=</span></span><span class="quoted"><span class="quoted">"<span class="main">λ</span><span class="bound">t</span> <span class="bound">n</span><span class="main">.</span> <span class="main">(</span><span class="main">∃</span><span class="bound">y</span><span class="main">.</span> <span class="main">(</span><span class="free">γ</span> <span class="bound">y</span> <span class="bound">t</span> <span class="bound">n</span><span class="main">)</span><span class="main">)</span>"</span></span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
    <span class="keyword1"><span class="command">with</span></span> <span class="quoted"><span class="quoted">‹<span class="main">∃</span><span class="bound"><span class="bound">i</span></span><span class="main">≥</span><span class="free">n</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">cid</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i</span></sub><span class="hidden">⇙</span>›</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> eval_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">next</span></span>
    <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> <span class="main">(</span><span class="main">∃</span><span class="bound"><span class="bound">i</span></span><span class="main">≥</span><span class="free">n</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">cid</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i</span></sub><span class="hidden">⇙</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹eval <span class="free">cid</span> <span class="free">t</span> <span class="free">t'</span> <span class="free">n</span> <span class="main">(</span><span class="keyword1">∃<span class="hidden">⇩</span><sub>b</sub></span><span class="bound">p</span><span class="main">.</span> <span class="free">γ</span> <span class="bound">p</span><span class="main">)</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"eval <span class="free">cid</span> <span class="free">t</span> <span class="free">t'</span> <span class="free">n</span> <span class="main">(</span><span class="main">λ</span><span class="bound">t</span> <span class="bound">n</span><span class="main">.</span> <span class="main">(</span><span class="main">∃</span><span class="bound">y</span><span class="main">.</span> <span class="main">(</span><span class="free">γ</span> <span class="bound">y</span> <span class="bound">t</span> <span class="bound">n</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> ex_def<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="free">γ</span></span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound">p</span><span class="main">.</span> <span class="main">(</span><span class="free">γ</span> <span class="bound">p</span><span class="main">)</span> <span class="main">(</span>lnth <span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">cid</span></sub><span class="hidden">⇙</span>inf_llist <span class="free">t</span> <span class="keyword1">@<span class="hidden">⇩</span><sub>l</sub></span> inf_llist <span class="free">t'</span><span class="main">)</span><span class="main">)</span> <span class="main">(</span><span class="hidden">⇘</span><sub><span class="free">cid</span></sub><span class="hidden">⇙</span>↓<span class="hidden">⇘</span><sub><span class="free">t</span></sub><span class="hidden">⇙</span><span class="free">n</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> validCE_cont<span class="main">[</span><span class="keyword2"><span class="keyword"><span class="operator">where</span></span></span> γ<span class="main"><span class="main">=</span></span><span class="quoted"><span class="quoted">"<span class="main">λ</span><span class="bound">t</span> <span class="bound">n</span><span class="main">.</span> <span class="main">(</span><span class="main">∃</span><span class="bound">y</span><span class="main">.</span> <span class="main">(</span><span class="free">γ</span> <span class="bound">y</span> <span class="bound">t</span> <span class="bound">n</span><span class="main">)</span><span class="main">)</span>"</span></span><span class="main">]</span> <span class="quoted"><span class="quoted">‹<span class="main">∃</span><span class="bound">i</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">cid</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i</span></sub><span class="hidden">⇙</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
    <span class="keyword1"><span class="command">with</span></span> <span class="quoted"><span class="quoted">‹<span class="main">¬</span> <span class="main">(</span><span class="main">∃</span><span class="bound"><span class="bound">i</span></span><span class="main">≥</span><span class="free">n</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">cid</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i</span></sub><span class="hidden">⇙</span><span class="main">)</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="main">∃</span><span class="bound">i</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">cid</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i</span></sub><span class="hidden">⇙</span>›</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> eval_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">qed</span></span>
<span class="keyword1"><span class="command">next</span></span>
  <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span><span class="main">(</span><span class="main">∃</span><span class="bound">i</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">cid</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i</span></sub><span class="hidden">⇙</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹eval <span class="free">cid</span> <span class="free">t</span> <span class="free">t'</span> <span class="free">n</span> <span class="main">(</span><span class="keyword1">∃<span class="hidden">⇩</span><sub>b</sub></span><span class="bound">p</span><span class="main">.</span> <span class="free">γ</span> <span class="bound">p</span><span class="main">)</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"eval <span class="free">cid</span> <span class="free">t</span> <span class="free">t'</span> <span class="free">n</span> <span class="main">(</span><span class="main">λ</span><span class="bound">t</span> <span class="bound">n</span><span class="main">.</span> <span class="main">(</span><span class="main">∃</span><span class="bound">y</span><span class="main">.</span> <span class="main">(</span><span class="free">γ</span> <span class="bound">y</span> <span class="bound">t</span> <span class="bound">n</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> ex_def<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="free">γ</span></span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound">p</span><span class="main">.</span> <span class="main">(</span><span class="free">γ</span> <span class="bound">p</span><span class="main">)</span> <span class="main">(</span>lnth <span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">cid</span></sub><span class="hidden">⇙</span>inf_llist <span class="free">t</span> <span class="keyword1">@<span class="hidden">⇩</span><sub>l</sub></span> inf_llist <span class="free">t'</span><span class="main">)</span><span class="main">)</span> <span class="free">n</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> validCE_not_act<span class="main">[</span><span class="keyword2"><span class="keyword"><span class="operator">where</span></span></span> γ<span class="main"><span class="main">=</span></span><span class="quoted"><span class="quoted">"<span class="main">λ</span><span class="bound">t</span> <span class="bound">n</span><span class="main">.</span> <span class="main">(</span><span class="main">∃</span><span class="bound">y</span><span class="main">.</span> <span class="main">(</span><span class="free">γ</span> <span class="bound">y</span> <span class="bound">t</span> <span class="bound">n</span><span class="main">)</span><span class="main">)</span>"</span></span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">with</span></span> <span class="quoted"><span class="quoted">‹<span class="main">¬</span><span class="main">(</span><span class="main">∃</span><span class="bound">i</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">cid</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i</span></sub><span class="hidden">⇙</span><span class="main">)</span>›</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> eval_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
<span class="keyword1"><span class="command">qed</span></span>    
    
<span class="keyword1"><span class="command">subsubsection</span></span> <span class="quoted"><span class="plain_text">"Behavior Assertions"</span></span>
<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹
  First we provide rules for basic behavior assertions.
›</span></span>

<span class="keyword1"><span class="command">definition</span></span> <span class="entity">ba</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="tfree">'cmp</span> <span class="main">⇒</span> bool<span class="main">)</span> <span class="main">⇒</span> <span class="main">(</span><span class="tfree">'cmp</span> bta<span class="main">)</span>"</span></span> <span class="main">(</span><span class="quoted">"<span class="keyword1">[</span>_<span class="keyword1">]<span class="hidden">⇩</span><sub>b</sub></span>"</span><span class="main">)</span>
  <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="free">ba</span> <span class="free"><span class="bound"><span class="entity">φ</span></span></span> <span class="main">≡</span> <span class="main">λ</span> <span class="bound">t</span> <span class="bound">n</span><span class="main">.</span> <span class="free"><span class="bound"><span class="entity">φ</span></span></span> <span class="main">(</span><span class="bound">t</span> <span class="bound">n</span><span class="main">)</span>"</span></span>
  
<span class="keyword1" id="Dynamic_Architecture_Calculus-baIA"><span class="command">lemma</span></span> baIA<span class="main">[</span><span class="operator">intro</span><span class="main">]</span><span class="main">:</span>
  <span class="keyword2"><span class="keyword">fixes</span></span> <span class="free">c</span><span class="main">::</span><span class="tfree"><span class="quoted"><span class="tfree">'id</span></span></span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="free">t</span><span class="main">::</span><span class="quoted"><span class="quoted">"nat <span class="main">⇒</span> cnf"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="free">t'</span><span class="main">::</span><span class="quoted"><span class="quoted">"nat <span class="main">⇒</span> <span class="tfree">'cmp</span>"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="free">n</span><span class="main">::</span><span class="quoted">nat</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound"><span class="bound">i</span></span><span class="main">≥</span><span class="free">n</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i</span></sub><span class="hidden">⇙</span>"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">φ</span> <span class="main">(</span>σ<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span><span class="free">t</span> <span class="main">⟨</span><span class="free">c</span> <span class="main">→</span> <span class="free">t</span>⟩<span class="hidden">⇘</span><sub><span class="free">n</span></sub><span class="hidden">⇙</span><span class="main">)</span><span class="main">)</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"eval <span class="free">c</span> <span class="free">t</span> <span class="free">t'</span> <span class="free">n</span> <span class="main">(</span>ba <span class="free">φ</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">from</span></span> assms <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">φ</span> <span class="main">(</span>σ<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span><span class="free">t</span> <span class="main">⟨</span><span class="free">c</span> <span class="main">→</span> <span class="free">t</span>⟩<span class="hidden">⇘</span><sub><span class="free">n</span></sub><span class="hidden">⇙</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"σ<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span><span class="free">t</span> <span class="main">⟨</span><span class="free">c</span> <span class="main">→</span> <span class="free">t</span>⟩<span class="hidden">⇘</span><sub><span class="free">n</span></sub><span class="hidden">⇙</span><span class="main">)</span> <span class="main">=</span> lnth <span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>inf_llist <span class="free">t</span><span class="main">)</span><span class="main">)</span> <span class="main">(</span>the_enat <span class="main">(</span><span class="main">⟨</span><span class="free">c</span> #<span class="hidden">⇘</span><sub><span class="main">⟨</span><span class="free">c</span> <span class="main">→</span> <span class="free">t</span>⟩<span class="hidden">⇘</span><sub><span class="free">n</span></sub><span class="hidden">⇙</span></sub><span class="hidden">⇙</span> inf_llist <span class="free">t</span><span class="main">⟩</span><span class="main">)</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"enat <span class="main">(</span>Suc <span class="main">⟨</span><span class="free">c</span> <span class="main">→</span> <span class="free">t</span>⟩<span class="hidden">⇘</span><sub><span class="free">n</span></sub><span class="hidden">⇙</span><span class="main">)</span> <span class="main">&lt;</span> llength <span class="main">(</span>inf_llist <span class="free">t</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> enat_ord_code <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> assms <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="main">(</span><span class="main">⟨</span><span class="free">c</span> <span class="main">→</span> <span class="free">t</span>⟩<span class="hidden">⇘</span><sub><span class="free">n</span></sub><span class="hidden">⇙</span><span class="main">)</span></sub><span class="hidden">⇙</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> nxtActI <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub>lnth <span class="main">(</span>inf_llist <span class="free">t</span><span class="main">)</span> <span class="main">⟨</span><span class="free">c</span> <span class="main">→</span> <span class="free">t</span>⟩<span class="hidden">⇘</span><sub><span class="free">n</span></sub><span class="hidden">⇙</span></sub><span class="hidden">⇙</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> proj_active_nth <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">φ</span> <span class="main">(</span>lnth <span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>inf_llist <span class="free">t</span><span class="main">)</span><span class="main">)</span> <span class="main">(</span>the_enat<span class="main">(</span><span class="main">⟨</span><span class="free">c</span> #<span class="hidden">⇘</span><sub><span class="main">⟨</span><span class="free">c</span> <span class="main">→</span> <span class="free">t</span>⟩<span class="hidden">⇘</span><sub><span class="free">n</span></sub><span class="hidden">⇙</span></sub><span class="hidden">⇙</span> inf_llist <span class="free">t</span><span class="main">⟩</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">⟨</span><span class="free">c</span> #<span class="hidden">⇘</span><sub><span class="free">n</span></sub><span class="hidden">⇙</span> inf_llist <span class="free">t</span><span class="main">⟩</span> <span class="main">=</span> <span class="main">⟨</span><span class="free">c</span> #<span class="hidden">⇘</span><sub><span class="main">⟨</span><span class="free">c</span> <span class="main">→</span> <span class="free">t</span>⟩<span class="hidden">⇘</span><sub><span class="free">n</span></sub><span class="hidden">⇙</span></sub><span class="hidden">⇙</span> inf_llist <span class="free">t</span><span class="main">⟩</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
    <span class="keyword1"><span class="command">from</span></span> assms <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">∄</span><span class="bound">k</span><span class="main">.</span> <span class="free">n</span><span class="main">≤</span><span class="bound">k</span> <span class="main">∧</span> <span class="bound">k</span><span class="main">&lt;</span><span class="main">⟨</span><span class="free">c</span> <span class="main">→</span> <span class="free">t</span>⟩<span class="hidden">⇘</span><sub><span class="free">n</span></sub><span class="hidden">⇙</span> <span class="main">∧</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">k</span></sub><span class="hidden">⇙</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> nxtActI <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> <span class="main">(</span><span class="main">∃</span><span class="bound"><span class="bound">k</span></span><span class="main">≥</span><span class="free">n</span><span class="main">.</span> <span class="bound">k</span> <span class="main">&lt;</span> <span class="main">⟨</span><span class="free">c</span> <span class="main">→</span> <span class="free">t</span>⟩<span class="hidden">⇘</span><sub><span class="free">n</span></sub><span class="hidden">⇙</span> <span class="main">∧</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub>lnth <span class="main">(</span>inf_llist <span class="free">t</span><span class="main">)</span> <span class="bound">k</span></sub><span class="hidden">⇙</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"enat <span class="main">⟨</span><span class="free">c</span> <span class="main">→</span> <span class="free">t</span>⟩<span class="hidden">⇘</span><sub><span class="free">n</span></sub><span class="hidden">⇙</span> <span class="main">-</span> <span class="main">1</span> <span class="main">&lt;</span> llength <span class="main">(</span>inf_llist <span class="free">t</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> one_enat_def<span class="main">)</span>
    <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> assms <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">⟨</span><span class="free">c</span> <span class="main">→</span> <span class="free">t</span>⟩<span class="hidden">⇘</span><sub><span class="free">n</span></sub><span class="hidden">⇙</span><span class="main">≥</span><span class="free">n</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> nxtActI <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> nAct_not_active_same<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="free">n</span></span> <span class="quoted"><span class="quoted">"<span class="main">⟨</span><span class="free">c</span> <span class="main">→</span> <span class="free">t</span>⟩<span class="hidden">⇘</span><sub><span class="free">n</span></sub><span class="hidden">⇙</span>"</span></span> <span class="quoted"><span class="quoted">"inf_llist <span class="free">t</span>"</span></span> <span class="quoted"><span class="free">c</span></span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">φ</span> <span class="main">(</span>lnth <span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>inf_llist <span class="free">t</span><span class="main">)</span><span class="main">)</span> <span class="main">(</span>the_enat<span class="main">(</span><span class="main">⟨</span><span class="free">c</span> #<span class="hidden">⇘</span><sub><span class="free">n</span></sub><span class="hidden">⇙</span> inf_llist <span class="free">t</span><span class="main">⟩</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"enat <span class="main">(</span>the_enat <span class="main">(</span><span class="main">⟨</span><span class="free">c</span> #<span class="hidden">⇘</span><sub>enat <span class="free">n</span></sub><span class="hidden">⇙</span> inf_llist <span class="free">t</span><span class="main">⟩</span><span class="main">)</span><span class="main">)</span> <span class="main">&lt;</span> llength <span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>inf_llist <span class="free">t</span><span class="main">)</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"ltake <span class="main">∞</span> <span class="main">(</span>inf_llist <span class="free">t</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span>inf_llist <span class="free">t</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> ltake_all<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="quoted">"inf_llist <span class="free">t</span>"</span></span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"llength <span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>inf_llist <span class="free">t</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> <span class="main">⟨</span><span class="free">c</span> #<span class="hidden">⇘</span><sub><span class="main">∞</span></sub><span class="hidden">⇙</span> inf_llist <span class="free">t</span><span class="main">⟩</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> nAct_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">⟨</span><span class="free">c</span> #<span class="hidden">⇘</span><sub>enat <span class="free">n</span></sub><span class="hidden">⇙</span> inf_llist <span class="free">t</span><span class="main">⟩</span> <span class="main">&lt;</span> <span class="main">⟨</span><span class="free">c</span> #<span class="hidden">⇘</span><sub><span class="main">∞</span></sub><span class="hidden">⇙</span> inf_llist <span class="free">t</span><span class="main">⟩</span>"</span></span>
    <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
      <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"enat <span class="main">⟨</span><span class="free">c</span> <span class="main">→</span> <span class="free">t</span>⟩<span class="hidden">⇘</span><sub><span class="free">n</span></sub><span class="hidden">⇙</span> <span class="main">&lt;</span> llength <span class="main">(</span>inf_llist <span class="free">t</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
      <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> assms <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">⟨</span><span class="free">c</span> <span class="main">→</span> <span class="free">t</span>⟩<span class="hidden">⇘</span><sub><span class="free">n</span></sub><span class="hidden">⇙</span><span class="main">≥</span><span class="free">n</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="main">(</span><span class="main">⟨</span><span class="free">c</span> <span class="main">→</span> <span class="free">t</span>⟩<span class="hidden">⇘</span><sub><span class="free">n</span></sub><span class="hidden">⇙</span><span class="main">)</span></sub><span class="hidden">⇙</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> nxtActI <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> nAct_less<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="quoted">"<span class="main">⟨</span><span class="free">c</span> <span class="main">→</span> <span class="free">t</span>⟩<span class="hidden">⇘</span><sub><span class="free">n</span></sub><span class="hidden">⇙</span>"</span></span> <span class="quoted"><span class="quoted">"inf_llist <span class="free">t</span>"</span></span> <span class="quoted"><span class="free">n</span></span> <span class="quoted"><span class="main">∞</span></span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">qed</span></span>
    <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"lnth <span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>inf_llist <span class="free">t</span><span class="main">)</span><span class="main">)</span> <span class="main">(</span>the_enat <span class="main">(</span><span class="main">⟨</span><span class="free">c</span> #<span class="hidden">⇘</span><sub><span class="free">n</span></sub><span class="hidden">⇙</span> inf_llist <span class="free">t</span><span class="main">⟩</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span>
    lnth <span class="main">(</span><span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>inf_llist <span class="free">t</span><span class="main">)</span><span class="main">)</span> <span class="keyword1">@<span class="hidden">⇩</span><sub>l</sub></span> <span class="main">(</span>inf_llist <span class="free">t'</span><span class="main">)</span><span class="main">)</span> <span class="main">(</span>the_enat <span class="main">(</span><span class="main">⟨</span><span class="free">c</span> #<span class="hidden">⇘</span><sub><span class="free">n</span></sub><span class="hidden">⇙</span> inf_llist <span class="free">t</span><span class="main">⟩</span><span class="main">)</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> lnth_lappend1<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="quoted">"the_enat <span class="main">(</span><span class="main">⟨</span><span class="free">c</span> #<span class="hidden">⇘</span><sub>enat <span class="free">n</span></sub><span class="hidden">⇙</span> inf_llist <span class="free">t</span><span class="main">⟩</span><span class="main">)</span>"</span></span> <span class="quoted"><span class="quoted">"π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>inf_llist <span class="free">t</span><span class="main">)</span>"</span></span> <span class="quoted"><span class="quoted">"inf_llist <span class="free">t'</span>"</span></span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">φ</span> <span class="main">(</span>lnth <span class="main">(</span><span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>inf_llist <span class="free">t</span><span class="main">)</span><span class="main">)</span> <span class="keyword1">@<span class="hidden">⇩</span><sub>l</sub></span> <span class="main">(</span>inf_llist <span class="free">t'</span><span class="main">)</span><span class="main">)</span> <span class="main">(</span>the_enat<span class="main">(</span><span class="main">⟨</span><span class="free">c</span> #<span class="hidden">⇘</span><sub><span class="free">n</span></sub><span class="hidden">⇙</span> inf_llist <span class="free">t</span><span class="main">⟩</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="free">φ</span> <span class="main">(</span>lnth <span class="main">(</span><span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>inf_llist <span class="free">t</span><span class="main">)</span><span class="main">)</span> <span class="keyword1">@<span class="hidden">⇩</span><sub>l</sub></span> <span class="main">(</span>inf_llist <span class="free">t'</span><span class="main">)</span><span class="main">)</span> <span class="main">(</span>the_enat <span class="main">(</span><span class="main">⟨</span><span class="free">c</span> #<span class="hidden">⇘</span><sub><span class="free">n</span></sub><span class="hidden">⇙</span> inf_llist <span class="free">t</span><span class="main">⟩</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> assms <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">⟨</span><span class="free">c</span> <span class="main">→</span> <span class="free">t</span>⟩<span class="hidden">⇘</span><sub><span class="free">n</span></sub><span class="hidden">⇙</span><span class="main">≥</span><span class="free">n</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="main">(</span><span class="main">⟨</span><span class="free">c</span> <span class="main">→</span> <span class="free">t</span>⟩<span class="hidden">⇘</span><sub><span class="free">n</span></sub><span class="hidden">⇙</span><span class="main">)</span></sub><span class="hidden">⇙</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> nxtActI <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">∃</span><span class="bound"><span class="bound">i</span></span><span class="main">≥</span>snd <span class="main">(</span><span class="free">t</span><span class="main">,</span> <span class="free">n</span><span class="main">)</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub>fst <span class="main">(</span><span class="free">t</span><span class="main">,</span> <span class="free">n</span><span class="main">)</span> <span class="bound">i</span></sub><span class="hidden">⇙</span><span class="main">)</span> <span class="main">∧</span>
    <span class="free">φ</span> <span class="main">(</span>lnth <span class="main">(</span><span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>inf_llist <span class="main">(</span>fst <span class="main">(</span><span class="free">t</span><span class="main">,</span> <span class="free">n</span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="keyword1">@<span class="hidden">⇩</span><sub>l</sub></span> <span class="main">(</span>inf_llist <span class="free">t'</span><span class="main">)</span><span class="main">)</span>
    <span class="main">(</span>the_enat <span class="main">(</span><span class="main">⟨</span><span class="free">c</span> #<span class="hidden">⇘</span><sub>the_enat <span class="main">(</span>snd <span class="main">(</span><span class="free">t</span><span class="main">,</span><span class="free">n</span><span class="main">)</span><span class="main">)</span></sub><span class="hidden">⇙</span> inf_llist <span class="main">(</span>fst <span class="main">(</span><span class="free">t</span><span class="main">,</span> <span class="free">n</span><span class="main">)</span><span class="main">)</span><span class="main">⟩</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> ba_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="Dynamic_Architecture_Calculus-baIN1"><span class="command">lemma</span></span> baIN1<span class="main">[</span><span class="operator">intro</span><span class="main">]</span><span class="main">:</span>
  <span class="keyword2"><span class="keyword">fixes</span></span> <span class="free">c</span><span class="main">::</span><span class="tfree"><span class="quoted"><span class="tfree">'id</span></span></span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="free">t</span><span class="main">::</span><span class="quoted"><span class="quoted">"nat <span class="main">⇒</span> cnf"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="free">t'</span><span class="main">::</span><span class="quoted"><span class="quoted">"nat <span class="main">⇒</span> <span class="tfree">'cmp</span>"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="free">n</span><span class="main">::</span><span class="quoted">nat</span>  
  <span class="keyword2"><span class="keyword">assumes</span></span> act<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound">i</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i</span></sub><span class="hidden">⇙</span>"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> nAct<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">∄</span><span class="bound">i</span><span class="main">.</span> <span class="bound">i</span><span class="main">≥</span><span class="free">n</span> <span class="main">∧</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i</span></sub><span class="hidden">⇙</span>"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> al<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">φ</span> <span class="main">(</span><span class="free">t'</span> <span class="main">(</span><span class="free">n</span> <span class="main">-</span> <span class="main">⟨</span><span class="free">c</span> <span class="main">∧</span> <span class="free">t</span><span class="main">⟩</span> <span class="main">-</span> <span class="main">1</span><span class="main">)</span><span class="main">)</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"eval <span class="free">c</span> <span class="free">t</span> <span class="free">t'</span> <span class="free">n</span> <span class="main">(</span>ba <span class="free">φ</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">t'</span> <span class="main">(</span><span class="free">n</span> <span class="main">-</span> <span class="main">⟨</span><span class="free">c</span> <span class="main">∧</span> <span class="free">t</span><span class="main">⟩</span> <span class="main">-</span> <span class="main">1</span><span class="main">)</span> <span class="main">=</span> lnth <span class="main">(</span>inf_llist <span class="free">t'</span><span class="main">)</span> <span class="main">(</span><span class="free">n</span> <span class="main">-</span> <span class="main">⟨</span><span class="free">c</span> <span class="main">∧</span> <span class="free">t</span><span class="main">⟩</span> <span class="main">-</span> <span class="main">1</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">…</span> <span class="main">=</span> lnth <span class="main">(</span><span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>inf_llist <span class="free">t</span><span class="main">)</span><span class="main">)</span> <span class="keyword1">@<span class="hidden">⇩</span><sub>l</sub></span> <span class="main">(</span>inf_llist <span class="free">t'</span><span class="main">)</span><span class="main">)</span> <span class="main">(</span><span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span>↓<span class="hidden">⇘</span><sub><span class="free">t</span></sub><span class="hidden">⇙</span><span class="main">(</span><span class="free">n</span><span class="main">)</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> act nAct cnf2bhv_lnth_lappend <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">φ</span> <span class="main">(</span>lnth <span class="main">(</span><span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>inf_llist <span class="free">t</span><span class="main">)</span><span class="main">)</span> <span class="keyword1">@<span class="hidden">⇩</span><sub>l</sub></span> <span class="main">(</span>inf_llist <span class="free">t'</span><span class="main">)</span><span class="main">)</span> <span class="main">(</span><span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span>↓<span class="hidden">⇘</span><sub><span class="free">t</span></sub><span class="hidden">⇙</span><span class="main">(</span><span class="free">n</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> al <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">with</span></span> act nAct <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> ba_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>    
    
<span class="keyword1" id="Dynamic_Architecture_Calculus-baIN2"><span class="command">lemma</span></span> baIN2<span class="main">[</span><span class="operator">intro</span><span class="main">]</span><span class="main">:</span>
  <span class="keyword2"><span class="keyword">fixes</span></span> <span class="free">c</span><span class="main">::</span><span class="tfree"><span class="quoted"><span class="tfree">'id</span></span></span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="free">t</span><span class="main">::</span><span class="quoted"><span class="quoted">"nat <span class="main">⇒</span> cnf"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="free">t'</span><span class="main">::</span><span class="quoted"><span class="quoted">"nat <span class="main">⇒</span> <span class="tfree">'cmp</span>"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="free">n</span><span class="main">::</span><span class="quoted">nat</span>  
  <span class="keyword2"><span class="keyword">assumes</span></span> nAct<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">∄</span><span class="bound">i</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i</span></sub><span class="hidden">⇙</span>"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> al<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">φ</span> <span class="main">(</span><span class="free">t'</span> <span class="free">n</span><span class="main">)</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"eval <span class="free">c</span> <span class="free">t</span> <span class="free">t'</span> <span class="free">n</span> <span class="main">(</span>ba <span class="free">φ</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">t'</span> <span class="free">n</span> <span class="main">=</span> lnth <span class="main">(</span>inf_llist <span class="free">t'</span><span class="main">)</span> <span class="free">n</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">…</span> <span class="main">=</span> lnth <span class="main">(</span><span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>inf_llist <span class="free">t</span><span class="main">)</span><span class="main">)</span> <span class="keyword1">@<span class="hidden">⇩</span><sub>l</sub></span> <span class="main">(</span>inf_llist <span class="free">t'</span><span class="main">)</span><span class="main">)</span> <span class="free">n</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
    <span class="keyword1"><span class="command">from</span></span> nAct <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>inf_llist <span class="free">t</span><span class="main">)</span> <span class="main">=</span> <span class="keyword1">[]<span class="hidden">⇩</span><sub>l</sub></span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>inf_llist <span class="free">t</span><span class="main">)</span><span class="main">)</span> <span class="keyword1">@<span class="hidden">⇩</span><sub>l</sub></span> <span class="main">(</span>inf_llist <span class="free">t'</span><span class="main">)</span> <span class="main">=</span> inf_llist <span class="free">t'</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> <span class="quoted"><span class="quoted">‹π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span>inf_llist <span class="free">t</span> <span class="main">=</span> <span class="keyword1">[]<span class="hidden">⇩</span><sub>l</sub></span>›</span></span><span class="main">)</span>
    <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">φ</span> <span class="main">(</span>lnth <span class="main">(</span><span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>inf_llist <span class="free">t</span><span class="main">)</span><span class="main">)</span> <span class="keyword1">@<span class="hidden">⇩</span><sub>l</sub></span> <span class="main">(</span>inf_llist <span class="free">t'</span><span class="main">)</span><span class="main">)</span> <span class="free">n</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> al <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="free">φ</span> <span class="main">(</span>lnth <span class="main">(</span><span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>inf_llist <span class="free">t</span><span class="main">)</span><span class="main">)</span> <span class="keyword1">@<span class="hidden">⇩</span><sub>l</sub></span> <span class="main">(</span>inf_llist <span class="free">t'</span><span class="main">)</span><span class="main">)</span> <span class="free">n</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">with</span></span> nAct <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> ba_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>
  
<span class="keyword1" id="Dynamic_Architecture_Calculus-baIANow"><span class="command">lemma</span></span> baIANow<span class="main">[</span><span class="operator">intro</span><span class="main">]</span><span class="main">:</span>
  <span class="keyword2"><span class="keyword">fixes</span></span> <span class="free">t</span> <span class="free">n</span> <span class="free">c</span> <span class="free">φ</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">φ</span> <span class="main">(</span>σ<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span><span class="free">t</span> <span class="free">n</span><span class="main">)</span><span class="main">)</span>"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="free">n</span></sub><span class="hidden">⇙</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"eval <span class="free">c</span> <span class="free">t</span> <span class="free">t'</span> <span class="free">n</span> <span class="main">(</span>ba <span class="free">φ</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">from</span></span> assms <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">φ</span><span class="main">(</span>σ<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span><span class="free">t</span> <span class="main">⟨</span><span class="free">c</span> <span class="main">→</span> <span class="free">t</span>⟩<span class="hidden">⇘</span><sub><span class="free">n</span></sub><span class="hidden">⇙</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> nxtAct_active <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">with</span></span> assms <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> baIA <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
<span class="keyword1"><span class="command">qed</span></span>
  
<span class="keyword1" id="Dynamic_Architecture_Calculus-baEA"><span class="command">lemma</span></span> baEA<span class="main">[</span><span class="operator">elim</span><span class="main">]</span><span class="main">:</span>
  <span class="keyword2"><span class="keyword">fixes</span></span> <span class="free">c</span><span class="main">::</span><span class="tfree"><span class="quoted"><span class="tfree">'id</span></span></span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="free">t</span><span class="main">::</span><span class="quoted"><span class="quoted">"nat <span class="main">⇒</span> cnf"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="free">t'</span><span class="main">::</span><span class="quoted"><span class="quoted">"nat <span class="main">⇒</span> <span class="tfree">'cmp</span>"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="free">n</span><span class="main">::</span><span class="quoted">nat</span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="free">i</span><span class="main">::</span><span class="quoted">nat</span>    
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound"><span class="bound">i</span></span><span class="main">≥</span><span class="free">n</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i</span></sub><span class="hidden">⇙</span>"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"eval <span class="free">c</span> <span class="free">t</span> <span class="free">t'</span> <span class="free">n</span> <span class="main">(</span>ba <span class="free">φ</span><span class="main">)</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">φ</span> <span class="main">(</span>σ<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span><span class="free">t</span> <span class="main">⟨</span><span class="free">c</span> <span class="main">→</span> <span class="free">t</span>⟩<span class="hidden">⇘</span><sub><span class="free">n</span></sub><span class="hidden">⇙</span><span class="main">)</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹eval <span class="free">c</span> <span class="free">t</span> <span class="free">t'</span> <span class="free">n</span> <span class="main">(</span>ba <span class="free">φ</span><span class="main">)</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"eval <span class="free">c</span> <span class="free">t</span> <span class="free">t'</span> <span class="free">n</span> <span class="main">(</span><span class="main">λ</span> <span class="bound">t</span> <span class="bound">n</span><span class="main">.</span> <span class="free">φ</span> <span class="main">(</span><span class="bound">t</span> <span class="bound">n</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> ba_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> assms <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">⟨</span><span class="free">c</span> <span class="main">→</span> <span class="free">t</span>⟩<span class="hidden">⇘</span><sub><span class="free">n</span></sub><span class="hidden">⇙</span><span class="main">≥</span><span class="free">n</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="main">(</span><span class="main">⟨</span><span class="free">c</span> <span class="main">→</span> <span class="free">t</span>⟩<span class="hidden">⇘</span><sub><span class="free">n</span></sub><span class="hidden">⇙</span><span class="main">)</span></sub><span class="hidden">⇙</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> nxtActI<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="free">n</span></span> <span class="quoted"><span class="free">c</span></span> <span class="quoted"><span class="free">t</span></span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">φ</span> <span class="main">(</span>lnth <span class="main">(</span><span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>inf_llist <span class="free">t</span><span class="main">)</span><span class="main">)</span> <span class="keyword1">@<span class="hidden">⇩</span><sub>l</sub></span> <span class="main">(</span>inf_llist <span class="free">t'</span><span class="main">)</span><span class="main">)</span> <span class="main">(</span>the_enat <span class="main">(</span><span class="main">⟨</span><span class="free">c</span> #<span class="hidden">⇘</span><sub><span class="free">n</span></sub><span class="hidden">⇙</span> inf_llist <span class="free">t</span><span class="main">⟩</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> validCE_act <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="free">φ</span> <span class="main">(</span>lnth <span class="main">(</span><span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>inf_llist <span class="free">t</span><span class="main">)</span><span class="main">)</span> <span class="keyword1">@<span class="hidden">⇩</span><sub>l</sub></span> <span class="main">(</span>inf_llist <span class="free">t'</span><span class="main">)</span><span class="main">)</span> <span class="main">(</span>the_enat <span class="main">(</span><span class="main">⟨</span><span class="free">c</span> #<span class="hidden">⇘</span><sub><span class="free">n</span></sub><span class="hidden">⇙</span> inf_llist <span class="free">t</span><span class="main">⟩</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"enat <span class="main">(</span>the_enat <span class="main">(</span><span class="main">⟨</span><span class="free">c</span> #<span class="hidden">⇘</span><sub>enat <span class="free">n</span></sub><span class="hidden">⇙</span> inf_llist <span class="free">t</span><span class="main">⟩</span><span class="main">)</span><span class="main">)</span> <span class="main">&lt;</span> llength <span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>inf_llist <span class="free">t</span><span class="main">)</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"ltake <span class="main">∞</span> <span class="main">(</span>inf_llist <span class="free">t</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span>inf_llist <span class="free">t</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> ltake_all<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="quoted">"inf_llist <span class="free">t</span>"</span></span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"llength <span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>inf_llist <span class="free">t</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> <span class="main">⟨</span><span class="free">c</span> #<span class="hidden">⇘</span><sub><span class="main">∞</span></sub><span class="hidden">⇙</span> inf_llist <span class="free">t</span><span class="main">⟩</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> nAct_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">⟨</span><span class="free">c</span> #<span class="hidden">⇘</span><sub>enat <span class="free">n</span></sub><span class="hidden">⇙</span> inf_llist <span class="free">t</span><span class="main">⟩</span> <span class="main">&lt;</span> <span class="main">⟨</span><span class="free">c</span> #<span class="hidden">⇘</span><sub><span class="main">∞</span></sub><span class="hidden">⇙</span> inf_llist <span class="free">t</span><span class="main">⟩</span>"</span></span>
    <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
      <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"enat <span class="main">⟨</span><span class="free">c</span> <span class="main">→</span> <span class="free">t</span>⟩<span class="hidden">⇘</span><sub><span class="free">n</span></sub><span class="hidden">⇙</span> <span class="main">&lt;</span> llength <span class="main">(</span>inf_llist <span class="free">t</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
      <span class="keyword1"><span class="command">with</span></span> <span class="quoted"><span class="quoted">‹<span class="main">⟨</span><span class="free">c</span> <span class="main">→</span> <span class="free">t</span>⟩<span class="hidden">⇘</span><sub><span class="free">n</span></sub><span class="hidden">⇙</span><span class="main">≥</span><span class="free">n</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="main">⟨</span><span class="free">c</span> <span class="main">→</span> <span class="free">t</span>⟩<span class="hidden">⇘</span><sub><span class="free">n</span></sub><span class="hidden">⇙</span></sub><span class="hidden">⇙</span>›</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> nAct_less <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">qed</span></span>
    <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"lnth <span class="main">(</span><span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>inf_llist <span class="free">t</span><span class="main">)</span><span class="main">)</span> <span class="keyword1">@<span class="hidden">⇩</span><sub>l</sub></span> <span class="main">(</span>inf_llist <span class="free">t'</span><span class="main">)</span><span class="main">)</span> <span class="main">(</span>the_enat <span class="main">(</span><span class="main">⟨</span><span class="free">c</span> #<span class="hidden">⇘</span><sub><span class="free">n</span></sub><span class="hidden">⇙</span> inf_llist <span class="free">t</span><span class="main">⟩</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span>
    lnth <span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>inf_llist <span class="free">t</span><span class="main">)</span><span class="main">)</span> <span class="main">(</span>the_enat <span class="main">(</span><span class="main">⟨</span><span class="free">c</span> #<span class="hidden">⇘</span><sub><span class="free">n</span></sub><span class="hidden">⇙</span> inf_llist <span class="free">t</span><span class="main">⟩</span><span class="main">)</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> lnth_lappend1<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="quoted">"the_enat <span class="main">(</span><span class="main">⟨</span><span class="free">c</span> #<span class="hidden">⇘</span><sub>enat <span class="free">n</span></sub><span class="hidden">⇙</span> inf_llist <span class="free">t</span><span class="main">⟩</span><span class="main">)</span>"</span></span> <span class="quoted"><span class="quoted">"π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>inf_llist <span class="free">t</span><span class="main">)</span>"</span></span> <span class="quoted"><span class="quoted">"inf_llist <span class="free">t'</span>"</span></span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">φ</span> <span class="main">(</span>lnth <span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>inf_llist <span class="free">t</span><span class="main">)</span><span class="main">)</span> <span class="main">(</span>the_enat <span class="main">(</span><span class="main">⟨</span><span class="free">c</span> #<span class="hidden">⇘</span><sub><span class="free">n</span></sub><span class="hidden">⇙</span> inf_llist <span class="free">t</span><span class="main">⟩</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">⟨</span><span class="free">c</span> #<span class="hidden">⇘</span><sub><span class="free">n</span></sub><span class="hidden">⇙</span> inf_llist <span class="free">t</span><span class="main">⟩</span> <span class="main">=</span> <span class="main">⟨</span><span class="free">c</span> #<span class="hidden">⇘</span><sub><span class="main">⟨</span><span class="free">c</span> <span class="main">→</span> <span class="free">t</span>⟩<span class="hidden">⇘</span><sub><span class="free">n</span></sub><span class="hidden">⇙</span></sub><span class="hidden">⇙</span> inf_llist <span class="free">t</span><span class="main">⟩</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
    <span class="keyword1"><span class="command">from</span></span> assms <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">∄</span><span class="bound">k</span><span class="main">.</span> <span class="free">n</span><span class="main">≤</span><span class="bound">k</span> <span class="main">∧</span> <span class="bound">k</span><span class="main">&lt;</span><span class="main">⟨</span><span class="free">c</span> <span class="main">→</span> <span class="free">t</span>⟩<span class="hidden">⇘</span><sub><span class="free">n</span></sub><span class="hidden">⇙</span> <span class="main">∧</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">k</span></sub><span class="hidden">⇙</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> nxtActI<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="free">n</span></span> <span class="quoted"><span class="free">c</span></span> <span class="quoted"><span class="free">t</span></span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> <span class="main">(</span><span class="main">∃</span><span class="bound"><span class="bound">k</span></span><span class="main">≥</span><span class="free">n</span><span class="main">.</span> <span class="bound">k</span> <span class="main">&lt;</span> <span class="main">⟨</span><span class="free">c</span> <span class="main">→</span> <span class="free">t</span>⟩<span class="hidden">⇘</span><sub><span class="free">n</span></sub><span class="hidden">⇙</span> <span class="main">∧</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub>lnth <span class="main">(</span>inf_llist <span class="free">t</span><span class="main">)</span> <span class="bound">k</span></sub><span class="hidden">⇙</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"enat <span class="main">⟨</span><span class="free">c</span> <span class="main">→</span> <span class="free">t</span>⟩<span class="hidden">⇘</span><sub><span class="free">n</span></sub><span class="hidden">⇙</span> <span class="main">-</span> <span class="main">1</span> <span class="main">&lt;</span> llength <span class="main">(</span>inf_llist <span class="free">t</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> one_enat_def<span class="main">)</span>
    <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="main">⟨</span><span class="free">c</span> <span class="main">→</span> <span class="free">t</span>⟩<span class="hidden">⇘</span><sub><span class="free">n</span></sub><span class="hidden">⇙</span><span class="main">≥</span><span class="free">n</span>›</span></span> nAct_not_active_same <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">qed</span></span>      
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"σ<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span><span class="free">t</span> <span class="main">⟨</span><span class="free">c</span> <span class="main">→</span> <span class="free">t</span>⟩<span class="hidden">⇘</span><sub><span class="free">n</span></sub><span class="hidden">⇙</span><span class="main">)</span> <span class="main">=</span> lnth <span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>inf_llist <span class="free">t</span><span class="main">)</span><span class="main">)</span> <span class="main">(</span>the_enat <span class="main">(</span><span class="main">⟨</span><span class="free">c</span> #<span class="hidden">⇘</span><sub><span class="main">⟨</span><span class="free">c</span> <span class="main">→</span> <span class="free">t</span>⟩<span class="hidden">⇘</span><sub><span class="free">n</span></sub><span class="hidden">⇙</span></sub><span class="hidden">⇙</span> inf_llist <span class="free">t</span><span class="main">⟩</span><span class="main">)</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"enat <span class="main">(</span>Suc <span class="free">i</span><span class="main">)</span> <span class="main">&lt;</span> llength <span class="main">(</span>inf_llist <span class="free">t</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> enat_ord_code <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="main">⟨</span><span class="free">c</span> <span class="main">→</span> <span class="free">t</span>⟩<span class="hidden">⇘</span><sub><span class="free">n</span></sub><span class="hidden">⇙</span></sub><span class="hidden">⇙</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub>lnth <span class="main">(</span>inf_llist <span class="free">t</span><span class="main">)</span> <span class="main">⟨</span><span class="free">c</span> <span class="main">→</span> <span class="free">t</span>⟩<span class="hidden">⇘</span><sub><span class="free">n</span></sub><span class="hidden">⇙</span></sub><span class="hidden">⇙</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> proj_active_nth <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="Dynamic_Architecture_Calculus-baEN1"><span class="command">lemma</span></span> baEN1<span class="main">[</span><span class="operator">elim</span><span class="main">]</span><span class="main">:</span>
  <span class="keyword2"><span class="keyword">fixes</span></span> <span class="free">c</span><span class="main">::</span><span class="tfree"><span class="quoted"><span class="tfree">'id</span></span></span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="free">t</span><span class="main">::</span><span class="quoted"><span class="quoted">"nat <span class="main">⇒</span> cnf"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="free">t'</span><span class="main">::</span><span class="quoted"><span class="quoted">"nat <span class="main">⇒</span> <span class="tfree">'cmp</span>"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="free">n</span><span class="main">::</span><span class="quoted">nat</span>  
  <span class="keyword2"><span class="keyword">assumes</span></span> act<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound">i</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i</span></sub><span class="hidden">⇙</span>"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> nAct<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">∄</span><span class="bound">i</span><span class="main">.</span> <span class="bound">i</span><span class="main">≥</span><span class="free">n</span> <span class="main">∧</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i</span></sub><span class="hidden">⇙</span>"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> al<span class="main">:</span> <span class="quoted"><span class="quoted">"eval <span class="free">c</span> <span class="free">t</span> <span class="free">t'</span> <span class="free">n</span> <span class="main">(</span>ba <span class="free">φ</span><span class="main">)</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">φ</span> <span class="main">(</span><span class="free">t'</span> <span class="main">(</span><span class="free">n</span> <span class="main">-</span> <span class="main">⟨</span><span class="free">c</span> <span class="main">∧</span> <span class="free">t</span><span class="main">⟩</span> <span class="main">-</span> <span class="main">1</span><span class="main">)</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">from</span></span> al <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">φ</span> <span class="main">(</span>lnth <span class="main">(</span><span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>inf_llist <span class="free">t</span><span class="main">)</span><span class="main">)</span> <span class="keyword1">@<span class="hidden">⇩</span><sub>l</sub></span> <span class="main">(</span>inf_llist <span class="free">t'</span><span class="main">)</span><span class="main">)</span> <span class="main">(</span><span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span>↓<span class="hidden">⇘</span><sub><span class="free">t</span></sub><span class="hidden">⇙</span><span class="main">(</span><span class="free">n</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> act nAct validCE_cont ba_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">metis</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="free">φ</span> <span class="main">(</span>lnth <span class="main">(</span><span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>inf_llist <span class="free">t</span><span class="main">)</span><span class="main">)</span> <span class="keyword1">@<span class="hidden">⇩</span><sub>l</sub></span> <span class="main">(</span>inf_llist <span class="free">t'</span><span class="main">)</span><span class="main">)</span> <span class="main">(</span><span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span>↓<span class="hidden">⇘</span><sub><span class="free">t</span></sub><span class="hidden">⇙</span><span class="main">(</span><span class="free">n</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"lnth <span class="main">(</span><span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>inf_llist <span class="free">t</span><span class="main">)</span><span class="main">)</span> <span class="keyword1">@<span class="hidden">⇩</span><sub>l</sub></span> <span class="main">(</span>inf_llist <span class="free">t'</span><span class="main">)</span><span class="main">)</span> <span class="main">(</span><span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span>↓<span class="hidden">⇘</span><sub><span class="free">t</span></sub><span class="hidden">⇙</span><span class="main">(</span><span class="free">n</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> lnth <span class="main">(</span>inf_llist <span class="free">t'</span><span class="main">)</span> <span class="main">(</span><span class="free">n</span> <span class="main">-</span> <span class="main">⟨</span><span class="free">c</span> <span class="main">∧</span> <span class="free">t</span><span class="main">⟩</span> <span class="main">-</span> <span class="main">1</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> act nAct cnf2bhv_lnth_lappend <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">…</span> <span class="main">=</span> <span class="free">t'</span> <span class="main">(</span><span class="free">n</span> <span class="main">-</span> <span class="main">⟨</span><span class="free">c</span> <span class="main">∧</span> <span class="free">t</span><span class="main">⟩</span> <span class="main">-</span> <span class="main">1</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="Dynamic_Architecture_Calculus-baEN2"><span class="command">lemma</span></span> baEN2<span class="main">[</span><span class="operator">elim</span><span class="main">]</span><span class="main">:</span>
  <span class="keyword2"><span class="keyword">fixes</span></span> <span class="free">c</span><span class="main">::</span><span class="tfree"><span class="quoted"><span class="tfree">'id</span></span></span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="free">t</span><span class="main">::</span><span class="quoted"><span class="quoted">"nat <span class="main">⇒</span> cnf"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="free">t'</span><span class="main">::</span><span class="quoted"><span class="quoted">"nat <span class="main">⇒</span> <span class="tfree">'cmp</span>"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="free">n</span><span class="main">::</span><span class="quoted">nat</span>  
  <span class="keyword2"><span class="keyword">assumes</span></span> nAct<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">∄</span><span class="bound">i</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i</span></sub><span class="hidden">⇙</span>"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> al<span class="main">:</span> <span class="quoted"><span class="quoted">"eval <span class="free">c</span> <span class="free">t</span> <span class="free">t'</span> <span class="free">n</span> <span class="main">(</span>ba <span class="free">φ</span><span class="main">)</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">φ</span> <span class="main">(</span><span class="free">t'</span> <span class="free">n</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">from</span></span> al <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">φ</span> <span class="main">(</span>lnth <span class="main">(</span><span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>inf_llist <span class="free">t</span><span class="main">)</span><span class="main">)</span> <span class="keyword1">@<span class="hidden">⇩</span><sub>l</sub></span> <span class="main">(</span>inf_llist <span class="free">t'</span><span class="main">)</span><span class="main">)</span> <span class="free">n</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> nAct validCE_not_act ba_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">metis</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="free">φ</span> <span class="main">(</span>lnth <span class="main">(</span><span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>inf_llist <span class="free">t</span><span class="main">)</span><span class="main">)</span> <span class="keyword1">@<span class="hidden">⇩</span><sub>l</sub></span> <span class="main">(</span>inf_llist <span class="free">t'</span><span class="main">)</span><span class="main">)</span> <span class="free">n</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"lnth <span class="main">(</span><span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>inf_llist <span class="free">t</span><span class="main">)</span><span class="main">)</span> <span class="keyword1">@<span class="hidden">⇩</span><sub>l</sub></span> <span class="main">(</span>inf_llist <span class="free">t'</span><span class="main">)</span><span class="main">)</span> <span class="free">n</span> <span class="main">=</span> lnth <span class="main">(</span>inf_llist <span class="free">t'</span><span class="main">)</span> <span class="free">n</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
    <span class="keyword1"><span class="command">from</span></span> nAct <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>inf_llist <span class="free">t</span><span class="main">)</span> <span class="main">=</span> <span class="keyword1">[]<span class="hidden">⇩</span><sub>l</sub></span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>inf_llist <span class="free">t</span><span class="main">)</span><span class="main">)</span> <span class="keyword1">@<span class="hidden">⇩</span><sub>l</sub></span> <span class="main">(</span>inf_llist <span class="free">t'</span><span class="main">)</span> <span class="main">=</span> inf_llist <span class="free">t'</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> <span class="quoted"><span class="quoted">‹π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span>inf_llist <span class="free">t</span> <span class="main">=</span> <span class="keyword1">[]<span class="hidden">⇩</span><sub>l</sub></span>›</span></span><span class="main">)</span>
    <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">…</span> <span class="main">=</span> <span class="free">t'</span> <span class="free">n</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="Dynamic_Architecture_Calculus-baEANow"><span class="command">lemma</span></span> baEANow<span class="main">[</span><span class="operator">elim</span><span class="main">]</span><span class="main">:</span>
  <span class="keyword2"><span class="keyword">fixes</span></span> <span class="free">t</span> <span class="free">n</span> <span class="free">c</span> <span class="free">φ</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"eval <span class="free">c</span> <span class="free">t</span> <span class="free">t'</span> <span class="free">n</span> <span class="main">(</span>ba <span class="free">φ</span><span class="main">)</span>"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="free">n</span></sub><span class="hidden">⇙</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">φ</span> <span class="main">(</span>σ<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span><span class="free">t</span> <span class="free">n</span><span class="main">)</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">from</span></span> assms <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">φ</span><span class="main">(</span>σ<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span><span class="free">t</span> <span class="main">⟨</span><span class="free">c</span> <span class="main">→</span> <span class="free">t</span>⟩<span class="hidden">⇘</span><sub><span class="free">n</span></sub><span class="hidden">⇙</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> baEA <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">with</span></span> assms <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> nxtAct_active <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>
    
<span class="keyword1"><span class="command">subsubsection</span></span> <span class="quoted"><span class="plain_text">"Next Operator"</span></span>

<span class="keyword1"><span class="command">definition</span></span> <span class="entity">nxt</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="tfree">'cmp</span> bta<span class="main">)</span> <span class="main">⇒</span> <span class="main">(</span><span class="tfree">'cmp</span> bta<span class="main">)</span>"</span></span> <span class="main">(</span><span class="quoted">"<span class="keyword1">○<span class="hidden">⇩</span><sub>b</sub></span><span class="keyword3">(</span>_<span class="keyword3">)</span>"</span> 24<span class="main">)</span>
  <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1"><span class="free">○<span class="hidden">⇩</span><sub>b</sub></span></span><span class="main">(</span><span class="free"><span class="bound"><span class="entity">γ</span></span></span><span class="main">)</span> <span class="main">≡</span> <span class="main">λ</span> <span class="bound">t</span> <span class="bound">n</span><span class="main">.</span> <span class="free"><span class="bound"><span class="entity">γ</span></span></span> <span class="bound">t</span> <span class="main">(</span>Suc <span class="bound">n</span><span class="main">)</span>"</span></span>

<span class="keyword1" id="Dynamic_Architecture_Calculus-nxtIA"><span class="command">lemma</span></span> nxtIA<span class="main">[</span><span class="operator">intro</span><span class="main">]</span><span class="main">:</span>
  <span class="keyword2"><span class="keyword">fixes</span></span> <span class="free">c</span><span class="main">::</span><span class="tfree"><span class="quoted"><span class="tfree">'id</span></span></span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="free">t</span><span class="main">::</span><span class="quoted"><span class="quoted">"nat <span class="main">⇒</span> cnf"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="free">t'</span><span class="main">::</span><span class="quoted"><span class="quoted">"nat <span class="main">⇒</span> <span class="tfree">'cmp</span>"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="free">n</span><span class="main">::</span><span class="quoted">nat</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound"><span class="bound">i</span></span><span class="main">≥</span><span class="free">n</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i</span></sub><span class="hidden">⇙</span>"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">⟦</span><span class="main">∃</span><span class="bound"><span class="bound">i</span></span><span class="main">&gt;</span><span class="main">⟨</span><span class="free">c</span> <span class="main">→</span> <span class="free">t</span>⟩<span class="hidden">⇘</span><sub><span class="free">n</span></sub><span class="hidden">⇙</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i</span></sub><span class="hidden">⇙</span><span class="main">⟧</span> <span class="main">⟹</span> <span class="main">∃</span><span class="bound"><span class="bound">n'</span></span> <span class="main">≥</span> <span class="free">n</span><span class="main">.</span> <span class="main">(</span><span class="main">∃!</span><span class="bound">i</span><span class="main">.</span> <span class="free">n</span><span class="main">≤</span><span class="bound">i</span> <span class="main">∧</span> <span class="bound">i</span><span class="main">&lt;</span><span class="bound">n'</span> <span class="main">∧</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i</span></sub><span class="hidden">⇙</span><span class="main">)</span> <span class="main">∧</span> eval <span class="free">c</span> <span class="free">t</span> <span class="free">t'</span> <span class="bound">n'</span> <span class="free">γ</span>"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">⟦</span><span class="main">¬</span><span class="main">(</span><span class="main">∃</span><span class="bound"><span class="bound">i</span></span><span class="main">&gt;</span><span class="main">⟨</span><span class="free">c</span> <span class="main">→</span> <span class="free">t</span>⟩<span class="hidden">⇘</span><sub><span class="free">n</span></sub><span class="hidden">⇙</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i</span></sub><span class="hidden">⇙</span><span class="main">)</span><span class="main">⟧</span> <span class="main">⟹</span> eval <span class="free">c</span> <span class="free">t</span> <span class="free">t'</span> <span class="main">(</span>Suc <span class="main">⟨</span><span class="free">c</span> <span class="main">→</span> <span class="free">t</span>⟩<span class="hidden">⇘</span><sub><span class="free">n</span></sub><span class="hidden">⇙</span><span class="main">)</span> <span class="free">γ</span>"</span></span>    
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"eval <span class="free">c</span> <span class="free">t</span> <span class="free">t'</span> <span class="free">n</span> <span class="main">(</span><span class="keyword1">○<span class="hidden">⇩</span><sub>b</sub></span><span class="main">(</span><span class="free">γ</span><span class="main">)</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">cases</span><span class="main">)</span>
  <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound"><span class="bound">i</span></span><span class="main">&gt;</span><span class="main">⟨</span><span class="free">c</span> <span class="main">→</span> <span class="free">t</span>⟩<span class="hidden">⇘</span><sub><span class="free">n</span></sub><span class="hidden">⇙</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i</span></sub><span class="hidden">⇙</span>"</span></span>
  <span class="keyword1"><span class="command">with</span></span> assms<span class="main">(</span>2<span class="main">)</span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">n'</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">n'</span><span class="main">≥</span><span class="free">n</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃!</span><span class="bound">i</span><span class="main">.</span> <span class="free">n</span><span class="main">≤</span><span class="bound">i</span> <span class="main">∧</span> <span class="bound">i</span><span class="main">&lt;</span><span class="skolem">n'</span> <span class="main">∧</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i</span></sub><span class="hidden">⇙</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"eval <span class="free">c</span> <span class="free">t</span> <span class="free">t'</span> <span class="skolem">n'</span> <span class="free">γ</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> assms<span class="main">(</span>1<span class="main">)</span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="main">⟨</span><span class="free">c</span> <span class="main">→</span> <span class="free">t</span>⟩<span class="hidden">⇘</span><sub><span class="free">n</span></sub><span class="hidden">⇙</span></sub><span class="hidden">⇙</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">⟨</span><span class="free">c</span> <span class="main">→</span> <span class="free">t</span>⟩<span class="hidden">⇘</span><sub><span class="free">n</span></sub><span class="hidden">⇙</span><span class="main">≥</span><span class="free">n</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> nxtActI <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound"><span class="bound">i'</span></span><span class="main">≥</span><span class="skolem">n'</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i'</span></sub><span class="hidden">⇙</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> <span class="quoted"><span class="quoted">‹<span class="main">∃</span><span class="bound"><span class="bound">i</span></span><span class="main">&gt;</span><span class="main">⟨</span><span class="free">c</span> <span class="main">→</span> <span class="free">t</span>⟩<span class="hidden">⇘</span><sub><span class="free">n</span></sub><span class="hidden">⇙</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i</span></sub><span class="hidden">⇙</span>›</span></span> dual_order.strict_trans2 leI nat_less_le<span class="main">)</span>
  <span class="keyword1"><span class="command">with</span></span> <span class="quoted"><span class="quoted">‹eval <span class="free">c</span> <span class="free">t</span> <span class="free">t'</span> <span class="skolem">n'</span> <span class="free">γ</span>›</span></span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">γ</span> <span class="main">(</span>lnth <span class="main">(</span><span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>inf_llist <span class="free">t</span><span class="main">)</span><span class="main">)</span> <span class="keyword1">@<span class="hidden">⇩</span><sub>l</sub></span> <span class="main">(</span>inf_llist <span class="free">t'</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">(</span>the_enat <span class="main">(</span><span class="main">⟨</span><span class="free">c</span> #<span class="hidden">⇘</span><sub>enat <span class="skolem">n'</span></sub><span class="hidden">⇙</span> inf_llist <span class="free">t</span><span class="main">⟩</span><span class="main">)</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> validCE_act <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"the_enat<span class="main">(</span><span class="main">⟨</span><span class="free">c</span> #<span class="hidden">⇘</span><sub><span class="skolem">n'</span></sub><span class="hidden">⇙</span> inf_llist <span class="free">t</span><span class="main">⟩</span><span class="main">)</span> <span class="main">=</span> Suc <span class="main">(</span>the_enat <span class="main">(</span><span class="main">⟨</span><span class="free">c</span> #<span class="hidden">⇘</span><sub><span class="free">n</span></sub><span class="hidden">⇙</span> inf_llist <span class="free">t</span><span class="main">⟩</span><span class="main">)</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
    <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="main">∃!</span><span class="bound">i</span><span class="main">.</span> <span class="free">n</span><span class="main">≤</span><span class="bound">i</span> <span class="main">∧</span> <span class="bound">i</span><span class="main">&lt;</span><span class="skolem">n'</span> <span class="main">∧</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i</span></sub><span class="hidden">⇙</span>›</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">i</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="free">n</span><span class="main">≤</span><span class="skolem">i</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">i</span><span class="main">&lt;</span><span class="skolem">n'</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="skolem">i</span></sub><span class="hidden">⇙</span>"</span></span>
      <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">i'</span><span class="main">.</span> <span class="free">n</span><span class="main">≤</span><span class="bound">i'</span> <span class="main">∧</span> <span class="bound">i'</span><span class="main">&lt;</span><span class="skolem">n'</span> <span class="main">∧</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i'</span></sub><span class="hidden">⇙</span> <span class="main">⟶</span> <span class="bound">i'</span><span class="main">=</span><span class="skolem">i</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
    <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">n'</span> <span class="main">-</span> <span class="main">1</span> <span class="main">&lt;</span> llength <span class="main">(</span>inf_llist <span class="free">t</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>            
    <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"the_enat<span class="main">(</span><span class="main">⟨</span><span class="free">c</span> #<span class="hidden">⇘</span><sub><span class="skolem">n'</span></sub><span class="hidden">⇙</span> inf_llist <span class="free">t</span><span class="main">⟩</span><span class="main">)</span> <span class="main">=</span> the_enat<span class="main">(</span>eSuc <span class="main">(</span><span class="main">⟨</span><span class="free">c</span> #<span class="hidden">⇘</span><sub><span class="free">n</span></sub><span class="hidden">⇙</span> inf_llist <span class="free">t</span><span class="main">⟩</span><span class="main">)</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> nAct_active_suc<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="quoted">"inf_llist <span class="free">t</span>"</span></span> <span class="quoted"><span class="skolem">n'</span></span> <span class="quoted"><span class="free">n</span></span> <span class="quoted"><span class="skolem">i</span></span> <span class="quoted"><span class="free">c</span></span><span class="main">]</span>  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> <span class="quoted"><span class="quoted">‹<span class="free">n</span> <span class="main">≤</span> <span class="skolem">i</span>›</span></span><span class="main">)</span>
    <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">⟨</span><span class="free">c</span> #<span class="hidden">⇘</span><sub><span class="skolem">i</span></sub><span class="hidden">⇙</span> inf_llist <span class="free">t</span><span class="main">⟩</span> <span class="main">≠</span> <span class="main">∞</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> the_enat_eSuc <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">qed</span></span>    
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">γ</span> <span class="main">(</span>lnth <span class="main">(</span><span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>inf_llist <span class="free">t</span><span class="main">)</span><span class="main">)</span> <span class="keyword1">@<span class="hidden">⇩</span><sub>l</sub></span> <span class="main">(</span>inf_llist <span class="free">t'</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">(</span>Suc <span class="main">(</span>the_enat <span class="main">(</span><span class="main">⟨</span><span class="free">c</span> #<span class="hidden">⇘</span><sub><span class="free">n</span></sub><span class="hidden">⇙</span> inf_llist <span class="free">t</span><span class="main">⟩</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">with</span></span> assms <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"eval <span class="free">c</span> <span class="free">t</span> <span class="free">t'</span> <span class="free">n</span> <span class="main">(</span><span class="main">λ</span><span class="bound">t</span> <span class="bound">n</span><span class="main">.</span> <span class="free">γ</span> <span class="bound">t</span> <span class="main">(</span>Suc <span class="bound">n</span><span class="main">)</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> validCI_act<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="free">n</span></span> <span class="quoted"><span class="free">c</span></span> <span class="quoted"><span class="free">t</span></span> <span class="quoted"><span class="quoted">"<span class="main">λ</span><span class="bound">t</span> <span class="bound">n</span><span class="main">.</span> <span class="free">γ</span> <span class="bound">t</span> <span class="main">(</span>Suc <span class="bound">n</span><span class="main">)</span>"</span></span> <span class="quoted"><span class="free">t'</span></span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> nxt_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">next</span></span>
  <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> <span class="main">(</span><span class="main">∃</span><span class="bound"><span class="bound">i</span></span><span class="main">&gt;</span><span class="main">⟨</span><span class="free">c</span> <span class="main">→</span> <span class="free">t</span>⟩<span class="hidden">⇘</span><sub><span class="free">n</span></sub><span class="hidden">⇙</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i</span></sub><span class="hidden">⇙</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">with</span></span> assms<span class="main">(</span>3<span class="main">)</span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"eval <span class="free">c</span> <span class="free">t</span> <span class="free">t'</span> <span class="main">(</span>Suc <span class="main">⟨</span><span class="free">c</span> <span class="main">→</span> <span class="free">t</span>⟩<span class="hidden">⇘</span><sub><span class="free">n</span></sub><span class="hidden">⇙</span><span class="main">)</span> <span class="free">γ</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="main">¬</span> <span class="main">(</span><span class="main">∃</span><span class="bound"><span class="bound">i</span></span><span class="main">&gt;</span><span class="main">⟨</span><span class="free">c</span> <span class="main">→</span> <span class="free">t</span>⟩<span class="hidden">⇘</span><sub><span class="free">n</span></sub><span class="hidden">⇙</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i</span></sub><span class="hidden">⇙</span><span class="main">)</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> <span class="main">(</span><span class="main">∃</span><span class="bound"><span class="bound">i</span></span><span class="main">≥</span>Suc <span class="main">⟨</span><span class="free">c</span> <span class="main">→</span> <span class="free">t</span>⟩<span class="hidden">⇘</span><sub><span class="free">n</span></sub><span class="hidden">⇙</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i</span></sub><span class="hidden">⇙</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">γ</span> <span class="main">(</span>lnth <span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span>inf_llist <span class="free">t</span> <span class="keyword1">@<span class="hidden">⇩</span><sub>l</sub></span> inf_llist <span class="free">t'</span><span class="main">)</span><span class="main">)</span> <span class="main">(</span><span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span>↓<span class="hidden">⇘</span><sub><span class="free">t</span></sub><span class="hidden">⇙</span><span class="main">(</span>Suc <span class="main">⟨</span><span class="free">c</span> <span class="main">→</span> <span class="free">t</span>⟩<span class="hidden">⇘</span><sub><span class="free">n</span></sub><span class="hidden">⇙</span><span class="main">)</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>1<span class="main">)</span> validCE_cont<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="free">c</span></span> <span class="quoted"><span class="free">t</span></span> <span class="quoted"><span class="quoted">"Suc <span class="main">⟨</span><span class="free">c</span> <span class="main">→</span> <span class="free">t</span>⟩<span class="hidden">⇘</span><sub><span class="free">n</span></sub><span class="hidden">⇙</span>"</span></span> <span class="quoted"><span class="free">t'</span></span> <span class="quoted"><span class="free">γ</span></span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> assms<span class="main">(</span>1<span class="main">)</span> <span class="quoted"><span class="quoted">‹<span class="main">¬</span> <span class="main">(</span><span class="main">∃</span><span class="bound"><span class="bound">i</span></span><span class="main">&gt;</span><span class="main">⟨</span><span class="free">c</span> <span class="main">→</span> <span class="free">t</span>⟩<span class="hidden">⇘</span><sub><span class="free">n</span></sub><span class="hidden">⇙</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i</span></sub><span class="hidden">⇙</span><span class="main">)</span>›</span></span>
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"Suc <span class="main">(</span>the_enat <span class="main">⟨</span><span class="free">c</span> #<span class="hidden">⇘</span><sub>enat <span class="free">n</span></sub><span class="hidden">⇙</span>inf_llist <span class="free">t</span><span class="main">⟩</span><span class="main">)</span> <span class="main">=</span> <span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span>↓<span class="hidden">⇘</span><sub><span class="free">t</span></sub><span class="hidden">⇙</span><span class="main">(</span>Suc <span class="main">⟨</span><span class="free">c</span> <span class="main">→</span> <span class="free">t</span>⟩<span class="hidden">⇘</span><sub><span class="free">n</span></sub><span class="hidden">⇙</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> nAct_cnf2proj_Suc_dist <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">γ</span> <span class="main">(</span>lnth <span class="main">(</span><span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>inf_llist <span class="free">t</span><span class="main">)</span><span class="main">)</span> <span class="keyword1">@<span class="hidden">⇩</span><sub>l</sub></span> <span class="main">(</span>inf_llist <span class="free">t'</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">(</span>Suc <span class="main">(</span>the_enat <span class="main">(</span><span class="main">⟨</span><span class="free">c</span> #<span class="hidden">⇘</span><sub><span class="free">n</span></sub><span class="hidden">⇙</span> inf_llist <span class="free">t</span><span class="main">⟩</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> assms<span class="main">(</span>1<span class="main">)</span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="main">⟨</span><span class="free">c</span> <span class="main">→</span> <span class="free">t</span>⟩<span class="hidden">⇘</span><sub><span class="free">n</span></sub><span class="hidden">⇙</span></sub><span class="hidden">⇙</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">⟨</span><span class="free">c</span> <span class="main">→</span> <span class="free">t</span>⟩<span class="hidden">⇘</span><sub><span class="free">n</span></sub><span class="hidden">⇙</span> <span class="main">≥</span> <span class="free">n</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> nxtActI <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"eval <span class="free">c</span> <span class="free">t</span> <span class="free">t'</span> <span class="free">n</span> <span class="main">(</span><span class="main">λ</span><span class="bound">t</span> <span class="bound">n</span><span class="main">.</span> <span class="free">γ</span> <span class="bound">t</span> <span class="main">(</span>Suc <span class="bound">n</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> validCI_act<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="free">n</span></span> <span class="quoted"><span class="free">c</span></span> <span class="quoted"><span class="free">t</span></span> <span class="quoted"><span class="quoted">"<span class="main">λ</span><span class="bound">t</span> <span class="bound">n</span><span class="main">.</span> <span class="free">γ</span> <span class="bound">t</span> <span class="main">(</span>Suc <span class="bound">n</span><span class="main">)</span>"</span></span> <span class="quoted"><span class="free">t'</span></span><span class="main">]</span>
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">with</span></span> <span class="quoted"><span class="quoted">‹<span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="main">⟨</span><span class="free">c</span> <span class="main">→</span> <span class="free">t</span>⟩<span class="hidden">⇘</span><sub><span class="free">n</span></sub><span class="hidden">⇙</span></sub><span class="hidden">⇙</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="main">¬</span> <span class="main">(</span><span class="main">∃</span><span class="bound"><span class="bound">i'</span></span><span class="main">≥</span>Suc <span class="main">⟨</span><span class="free">c</span> <span class="main">→</span> <span class="free">t</span>⟩<span class="hidden">⇘</span><sub><span class="free">n</span></sub><span class="hidden">⇙</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i'</span></sub><span class="hidden">⇙</span><span class="main">)</span>›</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> nxt_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>
  
<span class="keyword1" id="Dynamic_Architecture_Calculus-nxtIN"><span class="command">lemma</span></span> nxtIN<span class="main">[</span><span class="operator">intro</span><span class="main">]</span><span class="main">:</span>
  <span class="keyword2"><span class="keyword">fixes</span></span> <span class="free">c</span><span class="main">::</span><span class="tfree"><span class="quoted"><span class="tfree">'id</span></span></span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="free">t</span><span class="main">::</span><span class="quoted"><span class="quoted">"nat <span class="main">⇒</span> cnf"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="free">t'</span><span class="main">::</span><span class="quoted"><span class="quoted">"nat <span class="main">⇒</span> <span class="tfree">'cmp</span>"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="free">n</span><span class="main">::</span><span class="quoted">nat</span>  
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span><span class="main">(</span><span class="main">∃</span><span class="bound"><span class="bound">i</span></span><span class="main">≥</span><span class="free">n</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i</span></sub><span class="hidden">⇙</span><span class="main">)</span>"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"eval <span class="free">c</span> <span class="free">t</span> <span class="free">t'</span> <span class="main">(</span>Suc <span class="free">n</span><span class="main">)</span> <span class="free">γ</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"eval <span class="free">c</span> <span class="free">t</span> <span class="free">t'</span> <span class="free">n</span> <span class="main">(</span><span class="keyword1">○<span class="hidden">⇩</span><sub>b</sub></span><span class="main">(</span><span class="free">γ</span><span class="main">)</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">cases</span>
  <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound">i</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i</span></sub><span class="hidden">⇙</span>"</span></span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="main">¬</span> <span class="main">(</span><span class="main">∃</span><span class="bound"><span class="bound">i</span></span><span class="main">≥</span><span class="free">n</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i</span></sub><span class="hidden">⇙</span><span class="main">)</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> <span class="main">(</span><span class="main">∃</span><span class="bound"><span class="bound">i</span></span><span class="main">≥</span>Suc <span class="free">n</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i</span></sub><span class="hidden">⇙</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">γ</span> <span class="main">(</span>lnth <span class="main">(</span><span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>inf_llist <span class="free">t</span><span class="main">)</span><span class="main">)</span> <span class="keyword1">@<span class="hidden">⇩</span><sub>l</sub></span> <span class="main">(</span>inf_llist <span class="free">t'</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">(</span><span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span>↓<span class="hidden">⇘</span><sub><span class="free">t</span></sub><span class="hidden">⇙</span><span class="main">(</span>Suc <span class="free">n</span><span class="main">)</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> validCE_cont <span class="quoted"><span class="quoted">‹eval <span class="free">c</span> <span class="free">t</span> <span class="free">t'</span> <span class="main">(</span>Suc <span class="free">n</span><span class="main">)</span> <span class="free">γ</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">with</span></span> <span class="quoted"><span class="quoted">‹<span class="main">∃</span><span class="bound">i</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i</span></sub><span class="hidden">⇙</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">γ</span> <span class="main">(</span>lnth <span class="main">(</span><span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>inf_llist <span class="free">t</span><span class="main">)</span><span class="main">)</span> <span class="keyword1">@<span class="hidden">⇩</span><sub>l</sub></span> <span class="main">(</span>inf_llist <span class="free">t'</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">(</span>Suc <span class="main">(</span><span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span>↓<span class="hidden">⇘</span><sub><span class="free">t</span></sub><span class="hidden">⇙</span><span class="main">(</span><span class="free">n</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="main">¬</span><span class="main">(</span><span class="main">∃</span><span class="bound"><span class="bound">i</span></span><span class="main">≥</span><span class="free">n</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i</span></sub><span class="hidden">⇙</span><span class="main">)</span>›</span></span> lActive_less <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">with</span></span> <span class="quoted"><span class="quoted">‹<span class="main">¬</span><span class="main">(</span><span class="main">∃</span><span class="bound"><span class="bound">i</span></span><span class="main">≥</span><span class="free">n</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i</span></sub><span class="hidden">⇙</span><span class="main">)</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="main">∃</span><span class="bound">i</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i</span></sub><span class="hidden">⇙</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"eval <span class="free">c</span> <span class="free">t</span> <span class="free">t'</span> <span class="free">n</span> <span class="main">(</span><span class="main">λ</span><span class="bound">t</span> <span class="bound">n</span><span class="main">.</span> <span class="free">γ</span> <span class="bound">t</span> <span class="main">(</span>Suc <span class="bound">n</span><span class="main">)</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> validCI_cont<span class="main">[</span><span class="keyword2"><span class="keyword"><span class="operator">where</span></span></span> γ<span class="main"><span class="main">=</span></span><span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">λ</span><span class="bound">t</span> <span class="bound">n</span><span class="main">.</span> <span class="free">γ</span> <span class="bound">t</span> <span class="main">(</span>Suc <span class="bound">n</span><span class="main">)</span><span class="main">)</span>"</span></span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> nxt_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">next</span></span>
  <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span><span class="main">(</span><span class="main">∃</span><span class="bound">i</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i</span></sub><span class="hidden">⇙</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">with</span></span> assms <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">γ</span> <span class="main">(</span>lnth <span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span>inf_llist <span class="free">t</span> <span class="keyword1">@<span class="hidden">⇩</span><sub>l</sub></span> inf_llist <span class="free">t'</span><span class="main">)</span><span class="main">)</span> <span class="main">(</span>Suc <span class="free">n</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> validCE_not_act <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">with</span></span> <span class="quoted"><span class="quoted">‹<span class="main">¬</span><span class="main">(</span><span class="main">∃</span><span class="bound">i</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i</span></sub><span class="hidden">⇙</span><span class="main">)</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"eval <span class="free">c</span> <span class="free">t</span> <span class="free">t'</span> <span class="free">n</span> <span class="main">(</span><span class="main">λ</span><span class="bound">t</span> <span class="bound">n</span><span class="main">.</span> <span class="free">γ</span> <span class="bound">t</span> <span class="main">(</span>Suc <span class="bound">n</span><span class="main">)</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> validCI_not_act<span class="main">[</span><span class="keyword2"><span class="keyword"><span class="operator">where</span></span></span> γ<span class="main"><span class="main">=</span></span><span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">λ</span><span class="bound">t</span> <span class="bound">n</span><span class="main">.</span> <span class="free">γ</span> <span class="bound">t</span> <span class="main">(</span>Suc <span class="bound">n</span><span class="main">)</span><span class="main">)</span>"</span></span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> nxt_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>
  
<span class="keyword1" id="Dynamic_Architecture_Calculus-nxtEA1"><span class="command">lemma</span></span> nxtEA1<span class="main">[</span><span class="operator">elim</span><span class="main">]</span><span class="main">:</span>
  <span class="keyword2"><span class="keyword">fixes</span></span> <span class="free">c</span><span class="main">::</span><span class="tfree"><span class="quoted"><span class="tfree">'id</span></span></span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="free">t</span><span class="main">::</span><span class="quoted"><span class="quoted">"nat <span class="main">⇒</span> cnf"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="free">t'</span><span class="main">::</span><span class="quoted"><span class="quoted">"nat <span class="main">⇒</span> <span class="tfree">'cmp</span>"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="free">n</span><span class="main">::</span><span class="quoted">nat</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound"><span class="bound">i</span></span><span class="main">&gt;</span><span class="main">⟨</span><span class="free">c</span> <span class="main">→</span> <span class="free">t</span>⟩<span class="hidden">⇘</span><sub><span class="free">n</span></sub><span class="hidden">⇙</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i</span></sub><span class="hidden">⇙</span>"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"eval <span class="free">c</span> <span class="free">t</span> <span class="free">t'</span> <span class="free">n</span> <span class="main">(</span><span class="keyword1">○<span class="hidden">⇩</span><sub>b</sub></span><span class="main">(</span><span class="free">γ</span><span class="main">)</span><span class="main">)</span>"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">n'</span><span class="main">≥</span><span class="free">n</span>"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃!</span><span class="bound">i</span><span class="main">.</span> <span class="bound">i</span><span class="main">≥</span><span class="free">n</span> <span class="main">∧</span> <span class="bound">i</span><span class="main">&lt;</span><span class="free">n'</span> <span class="main">∧</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i</span></sub><span class="hidden">⇙</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"eval <span class="free">c</span> <span class="free">t</span> <span class="free">t'</span> <span class="free">n'</span> <span class="free">γ</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹eval <span class="free">c</span> <span class="free">t</span> <span class="free">t'</span> <span class="free">n</span> <span class="main">(</span><span class="keyword1">○<span class="hidden">⇩</span><sub>b</sub></span><span class="main">(</span><span class="free">γ</span><span class="main">)</span><span class="main">)</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"eval <span class="free">c</span> <span class="free">t</span> <span class="free">t'</span> <span class="free">n</span> <span class="main">(</span><span class="main">λ</span><span class="bound">t</span> <span class="bound">n</span><span class="main">.</span> <span class="free">γ</span> <span class="bound">t</span> <span class="main">(</span>Suc <span class="bound">n</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> nxt_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> assms<span class="main">(</span>4<span class="main">)</span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">i</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">i</span><span class="main">≥</span><span class="free">n</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">i</span><span class="main">&lt;</span><span class="free">n'</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="skolem">i</span></sub><span class="hidden">⇙</span>"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">i'</span><span class="main">.</span> <span class="free">n</span><span class="main">≤</span><span class="bound">i'</span> <span class="main">∧</span> <span class="bound">i'</span><span class="main">&lt;</span><span class="free">n'</span> <span class="main">∧</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i'</span></sub><span class="hidden">⇙</span> <span class="main">⟶</span> <span class="bound">i'</span><span class="main">=</span><span class="skolem">i</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">γ</span> <span class="main">(</span>lnth <span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span>inf_llist <span class="free">t</span> <span class="keyword1">@<span class="hidden">⇩</span><sub>l</sub></span> inf_llist <span class="free">t'</span><span class="main">)</span><span class="main">)</span> <span class="main">(</span>Suc <span class="main">(</span>the_enat <span class="main">⟨</span><span class="free">c</span> #<span class="hidden">⇘</span><sub>enat <span class="free">n</span></sub><span class="hidden">⇙</span>inf_llist <span class="free">t</span><span class="main">⟩</span><span class="main">)</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> validCE_act<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="free">n</span></span> <span class="quoted"><span class="free">c</span></span> <span class="quoted"><span class="free">t</span></span> <span class="quoted"><span class="free">t'</span></span> <span class="quoted"><span class="quoted">"<span class="main">λ</span><span class="bound">t</span> <span class="bound">n</span><span class="main">.</span> <span class="free">γ</span> <span class="bound">t</span> <span class="main">(</span>Suc <span class="bound">n</span><span class="main">)</span>"</span></span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"the_enat<span class="main">(</span><span class="main">⟨</span><span class="free">c</span> #<span class="hidden">⇘</span><sub><span class="free">n'</span></sub><span class="hidden">⇙</span> inf_llist <span class="free">t</span><span class="main">⟩</span><span class="main">)</span> <span class="main">=</span> Suc <span class="main">(</span>the_enat <span class="main">(</span><span class="main">⟨</span><span class="free">c</span> #<span class="hidden">⇘</span><sub><span class="free">n</span></sub><span class="hidden">⇙</span> inf_llist <span class="free">t</span><span class="main">⟩</span><span class="main">)</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">n'</span> <span class="main">-</span> <span class="main">1</span> <span class="main">&lt;</span> llength <span class="main">(</span>inf_llist <span class="free">t</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>            
    <span class="keyword1"><span class="command">with</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">i</span><span class="main">&lt;</span><span class="free">n'</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹<span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="skolem">i</span></sub><span class="hidden">⇙</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹<span class="main">∀</span><span class="bound">i'</span><span class="main">.</span> <span class="free">n</span><span class="main">≤</span><span class="bound">i'</span> <span class="main">∧</span> <span class="bound">i'</span><span class="main">&lt;</span><span class="free">n'</span> <span class="main">∧</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i'</span></sub><span class="hidden">⇙</span> <span class="main">⟶</span> <span class="bound">i'</span><span class="main">=</span><span class="skolem">i</span>›</span></span>
      <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"the_enat<span class="main">(</span><span class="main">⟨</span><span class="free">c</span> #<span class="hidden">⇘</span><sub><span class="free">n'</span></sub><span class="hidden">⇙</span> inf_llist <span class="free">t</span><span class="main">⟩</span><span class="main">)</span> <span class="main">=</span> the_enat<span class="main">(</span>eSuc <span class="main">(</span><span class="main">⟨</span><span class="free">c</span> #<span class="hidden">⇘</span><sub><span class="free">n</span></sub><span class="hidden">⇙</span> inf_llist <span class="free">t</span><span class="main">⟩</span><span class="main">)</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> nAct_active_suc<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="quoted">"inf_llist <span class="free">t</span>"</span></span> <span class="quoted"><span class="free">n'</span></span> <span class="quoted"><span class="free">n</span></span> <span class="quoted"><span class="skolem">i</span></span> <span class="quoted"><span class="free">c</span></span><span class="main">]</span>  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> <span class="quoted"><span class="quoted">‹<span class="free">n</span> <span class="main">≤</span> <span class="skolem">i</span>›</span></span><span class="main">)</span>
    <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">⟨</span><span class="free">c</span> #<span class="hidden">⇘</span><sub><span class="skolem">i</span></sub><span class="hidden">⇙</span> inf_llist <span class="free">t</span><span class="main">⟩</span> <span class="main">≠</span> <span class="main">∞</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> the_enat_eSuc <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">qed</span></span>    
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">γ</span> <span class="main">(</span>lnth <span class="main">(</span><span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span>inf_llist <span class="free">t</span><span class="main">)</span> <span class="keyword1">@<span class="hidden">⇩</span><sub>l</sub></span> inf_llist <span class="free">t'</span><span class="main">)</span><span class="main">)</span> <span class="main">(</span>the_enat <span class="main">(</span><span class="main">⟨</span><span class="free">c</span> #<span class="hidden">⇘</span><sub><span class="free">n'</span></sub><span class="hidden">⇙</span> inf_llist <span class="free">t</span><span class="main">⟩</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound"><span class="bound">i'</span></span><span class="main">≥</span><span class="free">n'</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i'</span></sub><span class="hidden">⇙</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
    <span class="keyword1"><span class="command">from</span></span> assms<span class="main">(</span>4<span class="main">)</span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">⟨</span><span class="free">c</span> <span class="main">→</span> <span class="free">t</span>⟩<span class="hidden">⇘</span><sub><span class="free">n</span></sub><span class="hidden">⇙</span><span class="main">≥</span><span class="free">n</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="main">⟨</span><span class="free">c</span> <span class="main">→</span> <span class="free">t</span>⟩<span class="hidden">⇘</span><sub><span class="free">n</span></sub><span class="hidden">⇙</span></sub><span class="hidden">⇙</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> nxtActI <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">with</span></span> <span class="quoted"><span class="quoted">‹<span class="main">∀</span><span class="bound">i'</span><span class="main">.</span> <span class="free">n</span><span class="main">≤</span><span class="bound">i'</span> <span class="main">∧</span> <span class="bound">i'</span><span class="main">&lt;</span><span class="free">n'</span> <span class="main">∧</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i'</span></sub><span class="hidden">⇙</span> <span class="main">⟶</span> <span class="bound">i'</span><span class="main">=</span><span class="skolem">i</span>›</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
      <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>1<span class="main">)</span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> leI le_trans less_le<span class="main">)</span>
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> validCI_act <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
<span class="keyword1"><span class="command">qed</span></span>
  
<span class="keyword1" id="Dynamic_Architecture_Calculus-nxtEA2"><span class="command">lemma</span></span> nxtEA2<span class="main">[</span><span class="operator">elim</span><span class="main">]</span><span class="main">:</span>
  <span class="keyword2"><span class="keyword">fixes</span></span> <span class="free">c</span><span class="main">::</span><span class="tfree"><span class="quoted"><span class="tfree">'id</span></span></span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="free">t</span><span class="main">::</span><span class="quoted"><span class="quoted">"nat <span class="main">⇒</span> cnf"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="free">t'</span><span class="main">::</span><span class="quoted"><span class="quoted">"nat <span class="main">⇒</span> <span class="tfree">'cmp</span>"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="free">n</span><span class="main">::</span><span class="quoted">nat</span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted">"<span class="free">i</span>"</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound"><span class="bound">i</span></span><span class="main">≥</span><span class="free">n</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i</span></sub><span class="hidden">⇙</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span><span class="main">(</span><span class="main">∃</span><span class="bound"><span class="bound">i</span></span><span class="main">&gt;</span><span class="main">⟨</span><span class="free">c</span> <span class="main">→</span> <span class="free">t</span>⟩<span class="hidden">⇘</span><sub><span class="free">n</span></sub><span class="hidden">⇙</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i</span></sub><span class="hidden">⇙</span><span class="main">)</span>"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"eval <span class="free">c</span> <span class="free">t</span> <span class="free">t'</span> <span class="free">n</span> <span class="main">(</span><span class="keyword1">○<span class="hidden">⇩</span><sub>b</sub></span><span class="main">(</span><span class="free">γ</span><span class="main">)</span><span class="main">)</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"eval <span class="free">c</span> <span class="free">t</span> <span class="free">t'</span> <span class="main">(</span>Suc <span class="main">⟨</span><span class="free">c</span> <span class="main">→</span> <span class="free">t</span>⟩<span class="hidden">⇘</span><sub><span class="free">n</span></sub><span class="hidden">⇙</span><span class="main">)</span> <span class="free">γ</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹eval <span class="free">c</span> <span class="free">t</span> <span class="free">t'</span> <span class="free">n</span> <span class="main">(</span><span class="keyword1">○<span class="hidden">⇩</span><sub>b</sub></span><span class="main">(</span><span class="free">γ</span><span class="main">)</span><span class="main">)</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"eval <span class="free">c</span> <span class="free">t</span> <span class="free">t'</span> <span class="free">n</span> <span class="main">(</span><span class="main">λ</span><span class="bound">t</span> <span class="bound">n</span><span class="main">.</span> <span class="free">γ</span> <span class="bound">t</span> <span class="main">(</span>Suc <span class="bound">n</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> nxt_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">with</span></span> assms<span class="main">(</span>1<span class="main">)</span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">γ</span> <span class="main">(</span>lnth <span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span>inf_llist <span class="free">t</span> <span class="keyword1">@<span class="hidden">⇩</span><sub>l</sub></span> inf_llist <span class="free">t'</span><span class="main">)</span><span class="main">)</span> <span class="main">(</span>Suc <span class="main">(</span>the_enat <span class="main">⟨</span><span class="free">c</span> #<span class="hidden">⇘</span><sub>enat <span class="free">n</span></sub><span class="hidden">⇙</span>inf_llist <span class="free">t</span><span class="main">⟩</span><span class="main">)</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> validCE_act<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="free">n</span></span> <span class="quoted"><span class="free">c</span></span> <span class="quoted"><span class="free">t</span></span> <span class="quoted"><span class="free">t'</span></span> <span class="quoted"><span class="quoted">"<span class="main">λ</span><span class="bound">t</span> <span class="bound">n</span><span class="main">.</span> <span class="free">γ</span> <span class="bound">t</span> <span class="main">(</span>Suc <span class="bound">n</span><span class="main">)</span>"</span></span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> assms<span class="main">(</span>1<span class="main">)</span> assms<span class="main">(</span>2<span class="main">)</span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"Suc <span class="main">(</span>the_enat <span class="main">⟨</span><span class="free">c</span> #<span class="hidden">⇘</span><sub>enat <span class="free">n</span></sub><span class="hidden">⇙</span>inf_llist <span class="free">t</span><span class="main">⟩</span><span class="main">)</span><span class="main">=</span><span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span>↓<span class="hidden">⇘</span><sub><span class="free">t</span></sub><span class="hidden">⇙</span><span class="main">(</span>Suc <span class="main">⟨</span><span class="free">c</span> <span class="main">→</span> <span class="free">t</span>⟩<span class="hidden">⇘</span><sub><span class="free">n</span></sub><span class="hidden">⇙</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> nAct_cnf2proj_Suc_dist <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">γ</span> <span class="main">(</span>lnth <span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span>inf_llist <span class="free">t</span> <span class="keyword1">@<span class="hidden">⇩</span><sub>l</sub></span> inf_llist <span class="free">t'</span><span class="main">)</span><span class="main">)</span> <span class="main">(</span><span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span>↓<span class="hidden">⇘</span><sub><span class="free">t</span></sub><span class="hidden">⇙</span><span class="main">(</span>Suc <span class="main">⟨</span><span class="free">c</span> <span class="main">→</span> <span class="free">t</span>⟩<span class="hidden">⇘</span><sub><span class="free">n</span></sub><span class="hidden">⇙</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> assms<span class="main">(</span>1<span class="main">)</span> assms<span class="main">(</span>2<span class="main">)</span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span><span class="main">(</span><span class="main">∃</span><span class="bound"><span class="bound">i'</span></span><span class="main">≥</span>Suc <span class="main">⟨</span><span class="free">c</span> <span class="main">→</span> <span class="free">t</span>⟩<span class="hidden">⇘</span><sub><span class="free">n</span></sub><span class="hidden">⇙</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i'</span></sub><span class="hidden">⇙</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> nxtActive_no_active <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> validCI_cont<span class="main">[</span><span class="keyword2"><span class="keyword"><span class="operator">where</span></span></span> n<span class="main"><span class="main">=</span></span><span class="quoted"><span class="quoted">"Suc <span class="main">⟨</span><span class="free">c</span> <span class="main">→</span> <span class="free">t</span>⟩<span class="hidden">⇘</span><sub><span class="free">n</span></sub><span class="hidden">⇙</span>"</span></span><span class="main">]</span> assms<span class="main">(</span>1<span class="main">)</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="Dynamic_Architecture_Calculus-nxtEN"><span class="command">lemma</span></span> nxtEN<span class="main">[</span><span class="operator">elim</span><span class="main">]</span><span class="main">:</span>
  <span class="keyword2"><span class="keyword">fixes</span></span> <span class="free">c</span><span class="main">::</span><span class="tfree"><span class="quoted"><span class="tfree">'id</span></span></span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="free">t</span><span class="main">::</span><span class="quoted"><span class="quoted">"nat <span class="main">⇒</span> cnf"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="free">t'</span><span class="main">::</span><span class="quoted"><span class="quoted">"nat <span class="main">⇒</span> <span class="tfree">'cmp</span>"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="free">n</span><span class="main">::</span><span class="quoted">nat</span> 
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span><span class="main">(</span><span class="main">∃</span><span class="bound"><span class="bound">i</span></span><span class="main">≥</span><span class="free">n</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i</span></sub><span class="hidden">⇙</span><span class="main">)</span>"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"eval <span class="free">c</span> <span class="free">t</span> <span class="free">t'</span> <span class="free">n</span> <span class="main">(</span><span class="keyword1">○<span class="hidden">⇩</span><sub>b</sub></span><span class="main">(</span><span class="free">γ</span><span class="main">)</span><span class="main">)</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"eval <span class="free">c</span> <span class="free">t</span> <span class="free">t'</span> <span class="main">(</span>Suc <span class="free">n</span><span class="main">)</span> <span class="free">γ</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">cases</span>
  <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound">i</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i</span></sub><span class="hidden">⇙</span>"</span></span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹eval <span class="free">c</span> <span class="free">t</span> <span class="free">t'</span> <span class="free">n</span> <span class="main">(</span><span class="keyword1">○<span class="hidden">⇩</span><sub>b</sub></span><span class="main">(</span><span class="free">γ</span><span class="main">)</span><span class="main">)</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"eval <span class="free">c</span> <span class="free">t</span> <span class="free">t'</span> <span class="free">n</span> <span class="main">(</span><span class="main">λ</span><span class="bound">t</span> <span class="bound">n</span><span class="main">.</span> <span class="free">γ</span> <span class="bound">t</span> <span class="main">(</span>Suc <span class="bound">n</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> nxt_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">γ</span> <span class="main">(</span>lnth <span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span>inf_llist <span class="free">t</span> <span class="keyword1">@<span class="hidden">⇩</span><sub>l</sub></span> inf_llist <span class="free">t'</span><span class="main">)</span><span class="main">)</span> <span class="main">(</span>Suc <span class="main">(</span><span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span>↓<span class="hidden">⇘</span><sub><span class="free">t</span></sub><span class="hidden">⇙</span><span class="free">n</span><span class="main">)</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="main">¬</span><span class="main">(</span><span class="main">∃</span><span class="bound"><span class="bound">i</span></span><span class="main">≥</span><span class="free">n</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i</span></sub><span class="hidden">⇙</span><span class="main">)</span>›</span></span> validCE_cont<span class="main">[</span><span class="keyword2"><span class="keyword"><span class="operator">where</span></span></span> γ<span class="main"><span class="main">=</span></span><span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">λ</span><span class="bound">t</span> <span class="bound">n</span><span class="main">.</span> <span class="free">γ</span> <span class="bound">t</span> <span class="main">(</span>Suc <span class="bound">n</span><span class="main">)</span><span class="main">)</span>"</span></span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="free">γ</span> <span class="main">(</span>lnth <span class="main">(</span><span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>inf_llist <span class="free">t</span><span class="main">)</span><span class="main">)</span> <span class="keyword1">@<span class="hidden">⇩</span><sub>l</sub></span> <span class="main">(</span>inf_llist <span class="free">t'</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">(</span><span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span>↓<span class="hidden">⇘</span><sub><span class="free">t</span></sub><span class="hidden">⇙</span><span class="main">(</span>Suc <span class="free">n</span><span class="main">)</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="main">∃</span><span class="bound">i</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i</span></sub><span class="hidden">⇙</span>›</span></span> assms<span class="main">(</span>1<span class="main">)</span> lActive_less <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="main">¬</span> <span class="main">(</span><span class="main">∃</span><span class="bound"><span class="bound">i</span></span><span class="main">≥</span><span class="free">n</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i</span></sub><span class="hidden">⇙</span><span class="main">)</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> <span class="main">(</span><span class="main">∃</span><span class="bound"><span class="bound">i</span></span><span class="main">≥</span>Suc <span class="free">n</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i</span></sub><span class="hidden">⇙</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>      
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> validCI_cont<span class="main">[</span><span class="keyword2"><span class="keyword"><span class="operator">where</span></span></span> n<span class="main"><span class="main">=</span></span><span class="quoted"><span class="quoted">"Suc <span class="free">n</span>"</span></span><span class="main">]</span> <span class="quoted"><span class="quoted">‹<span class="main">∃</span><span class="bound">i</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i</span></sub><span class="hidden">⇙</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
<span class="keyword1"><span class="command">next</span></span>
  <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span><span class="main">(</span><span class="main">∃</span><span class="bound">i</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i</span></sub><span class="hidden">⇙</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹eval <span class="free">c</span> <span class="free">t</span> <span class="free">t'</span> <span class="free">n</span> <span class="main">(</span><span class="keyword1">○<span class="hidden">⇩</span><sub>b</sub></span><span class="main">(</span><span class="free">γ</span><span class="main">)</span><span class="main">)</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"eval <span class="free">c</span> <span class="free">t</span> <span class="free">t'</span> <span class="free">n</span> <span class="main">(</span><span class="main">λ</span><span class="bound">t</span> <span class="bound">n</span><span class="main">.</span> <span class="free">γ</span> <span class="bound">t</span> <span class="main">(</span>Suc <span class="bound">n</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> nxt_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">γ</span> <span class="main">(</span>lnth <span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span>inf_llist <span class="free">t</span> <span class="keyword1">@<span class="hidden">⇩</span><sub>l</sub></span> inf_llist <span class="free">t'</span><span class="main">)</span><span class="main">)</span> <span class="main">(</span>Suc <span class="free">n</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="main">¬</span><span class="main">(</span><span class="main">∃</span><span class="bound">i</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i</span></sub><span class="hidden">⇙</span><span class="main">)</span>›</span></span> validCE_not_act<span class="main">[</span><span class="keyword2"><span class="keyword"><span class="operator">where</span></span></span> γ<span class="main"><span class="main">=</span></span><span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">λ</span><span class="bound">t</span> <span class="bound">n</span><span class="main">.</span> <span class="free">γ</span> <span class="bound">t</span> <span class="main">(</span>Suc <span class="bound">n</span><span class="main">)</span><span class="main">)</span>"</span></span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">with</span></span> <span class="quoted"><span class="quoted">‹<span class="main">¬</span><span class="main">(</span><span class="main">∃</span><span class="bound">i</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i</span></sub><span class="hidden">⇙</span><span class="main">)</span>›</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> validCI_not_act<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="free">c</span></span> <span class="quoted"><span class="free">t</span></span> <span class="quoted"><span class="free">γ</span></span> <span class="quoted"><span class="free">t'</span></span> <span class="quoted"><span class="quoted">"Suc <span class="free">n</span>"</span></span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">subsubsection</span></span> <span class="quoted"><span class="plain_text">"Eventually Operator"</span></span>  

<span class="keyword1"><span class="command">definition</span></span> <span class="entity">evt</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="tfree">'cmp</span> bta<span class="main">)</span> <span class="main">⇒</span> <span class="main">(</span><span class="tfree">'cmp</span> bta<span class="main">)</span>"</span></span> <span class="main">(</span><span class="quoted">"<span class="keyword1">◇<span class="hidden">⇩</span><sub>b</sub></span><span class="keyword3">(</span>_<span class="keyword3">)</span>"</span> 23<span class="main">)</span>
  <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1"><span class="free">◇<span class="hidden">⇩</span><sub>b</sub></span></span><span class="main">(</span><span class="free"><span class="bound"><span class="entity">γ</span></span></span><span class="main">)</span> <span class="main">≡</span> <span class="main">λ</span> <span class="bound">t</span> <span class="bound">n</span><span class="main">.</span> <span class="main">∃</span><span class="bound"><span class="bound">n'</span></span><span class="main">≥</span><span class="bound">n</span><span class="main">.</span> <span class="free"><span class="bound"><span class="entity">γ</span></span></span> <span class="bound">t</span> <span class="bound">n'</span>"</span></span>

<span class="keyword1" id="Dynamic_Architecture_Calculus-evtIA"><span class="command">lemma</span></span> evtIA<span class="main">[</span><span class="operator">intro</span><span class="main">]</span><span class="main">:</span>
  <span class="keyword2"><span class="keyword">fixes</span></span> <span class="free">c</span><span class="main">::</span><span class="tfree"><span class="quoted"><span class="tfree">'id</span></span></span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="free">t</span><span class="main">::</span><span class="quoted"><span class="quoted">"nat <span class="main">⇒</span> cnf"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="free">t'</span><span class="main">::</span><span class="quoted"><span class="quoted">"nat <span class="main">⇒</span> <span class="tfree">'cmp</span>"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="free">n</span><span class="main">::</span><span class="quoted">nat</span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="free">n'</span><span class="main">::</span><span class="quoted">nat</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound"><span class="bound">i</span></span><span class="main">≥</span><span class="free">n</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i</span></sub><span class="hidden">⇙</span>"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">n'</span><span class="main">≥</span><span class="main">⟨</span><span class="free">c</span> <span class="main">⇐</span> <span class="free">t</span>⟩<span class="hidden">⇘</span><sub><span class="free">n</span></sub><span class="hidden">⇙</span>"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">⟦</span><span class="main">∃</span><span class="bound"><span class="bound">i</span></span><span class="main">≥</span><span class="free">n'</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i</span></sub><span class="hidden">⇙</span><span class="main">⟧</span> <span class="main">⟹</span> <span class="main">∃</span><span class="bound"><span class="bound">n''</span></span><span class="main">≥</span><span class="main">⟨</span><span class="free">c</span> <span class="main">⇐</span> <span class="free">t</span>⟩<span class="hidden">⇘</span><sub><span class="free">n'</span></sub><span class="hidden">⇙</span><span class="main">.</span> <span class="bound">n''</span><span class="main">≤</span> <span class="main">⟨</span><span class="free">c</span> <span class="main">→</span> <span class="free">t</span>⟩<span class="hidden">⇘</span><sub><span class="free">n'</span></sub><span class="hidden">⇙</span> <span class="main">∧</span> eval <span class="free">c</span> <span class="free">t</span> <span class="free">t'</span> <span class="bound">n''</span> <span class="free">γ</span>"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">⟦</span><span class="main">¬</span><span class="main">(</span><span class="main">∃</span><span class="bound"><span class="bound">i</span></span><span class="main">≥</span><span class="free">n'</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i</span></sub><span class="hidden">⇙</span><span class="main">)</span><span class="main">⟧</span> <span class="main">⟹</span> eval <span class="free">c</span> <span class="free">t</span> <span class="free">t'</span> <span class="free">n'</span> <span class="free">γ</span>"</span></span>    
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"eval <span class="free">c</span> <span class="free">t</span> <span class="free">t'</span> <span class="free">n</span> <span class="main">(</span><span class="keyword1">◇<span class="hidden">⇩</span><sub>b</sub></span><span class="main">(</span><span class="free">γ</span><span class="main">)</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">cases</span>  <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound"><span class="bound">i'</span></span><span class="main">≥</span><span class="free">n'</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i'</span></sub><span class="hidden">⇙</span>"</span></span>
  <span class="keyword1"><span class="command">with</span></span> assms<span class="main">(</span>3<span class="main">)</span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">n''</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">n''</span> <span class="main">≥</span><span class="main">⟨</span><span class="free">c</span> <span class="main">⇐</span> <span class="free">t</span>⟩<span class="hidden">⇘</span><sub><span class="free">n'</span></sub><span class="hidden">⇙</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">n''</span><span class="main">≤</span> <span class="main">⟨</span><span class="free">c</span> <span class="main">→</span> <span class="free">t</span>⟩<span class="hidden">⇘</span><sub><span class="free">n'</span></sub><span class="hidden">⇙</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"eval <span class="free">c</span> <span class="free">t</span> <span class="free">t'</span> <span class="skolem">n''</span> <span class="free">γ</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound"><span class="bound">i'</span></span><span class="main">≥</span><span class="skolem">n''</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i'</span></sub><span class="hidden">⇙</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="main">∃</span><span class="bound"><span class="bound">i'</span></span><span class="main">≥</span><span class="free">n'</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i'</span></sub><span class="hidden">⇙</span>›</span></span> nxtActI <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">with</span></span> <span class="quoted"><span class="quoted">‹eval <span class="free">c</span> <span class="free">t</span> <span class="free">t'</span> <span class="skolem">n''</span> <span class="free">γ</span>›</span></span> <span class="keyword1"><span class="command">have</span></span>
    <span class="quoted"><span class="quoted">"<span class="free">γ</span> <span class="main">(</span>lnth <span class="main">(</span><span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>inf_llist <span class="free">t</span><span class="main">)</span><span class="main">)</span> <span class="keyword1">@<span class="hidden">⇩</span><sub>l</sub></span> <span class="main">(</span>inf_llist <span class="free">t'</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">(</span>the_enat <span class="main">(</span><span class="main">⟨</span><span class="free">c</span> #<span class="hidden">⇘</span><sub><span class="skolem">n''</span></sub><span class="hidden">⇙</span> inf_llist <span class="free">t</span><span class="main">⟩</span><span class="main">)</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> validCE_act <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"the_enat <span class="main">(</span><span class="main">⟨</span><span class="free">c</span> #<span class="hidden">⇘</span><sub><span class="free">n</span></sub><span class="hidden">⇙</span> inf_llist <span class="free">t</span><span class="main">⟩</span><span class="main">)</span> <span class="main">≤</span> the_enat <span class="main">(</span><span class="main">⟨</span><span class="free">c</span> #<span class="hidden">⇘</span><sub><span class="skolem">n''</span></sub><span class="hidden">⇙</span> inf_llist <span class="free">t</span><span class="main">⟩</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
    <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="main">⟨</span><span class="free">c</span> <span class="main">⇐</span> <span class="free">t</span>⟩<span class="hidden">⇘</span><sub><span class="free">n'</span></sub><span class="hidden">⇙</span><span class="main">≤</span><span class="skolem">n''</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">⟨</span><span class="free">c</span> #<span class="hidden">⇘</span><sub><span class="free">n'</span></sub><span class="hidden">⇙</span> inf_llist <span class="free">t</span><span class="main">⟩</span> <span class="main">≤</span> <span class="main">⟨</span><span class="free">c</span> #<span class="hidden">⇘</span><sub><span class="skolem">n''</span></sub><span class="hidden">⇙</span> inf_llist <span class="free">t</span><span class="main">⟩</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> nAct_mono_lNact <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="free">n'</span><span class="main">≥</span><span class="main">⟨</span><span class="free">c</span> <span class="main">⇐</span> <span class="free">t</span>⟩<span class="hidden">⇘</span><sub><span class="free">n</span></sub><span class="hidden">⇙</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">⟨</span><span class="free">c</span> #<span class="hidden">⇘</span><sub><span class="free">n</span></sub><span class="hidden">⇙</span> inf_llist <span class="free">t</span><span class="main">⟩</span> <span class="main">≤</span> <span class="main">⟨</span><span class="free">c</span> #<span class="hidden">⇘</span><sub><span class="free">n'</span></sub><span class="hidden">⇙</span> inf_llist <span class="free">t</span><span class="main">⟩</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> nAct_mono_lNact <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">⟨</span><span class="free">c</span> #<span class="hidden">⇘</span><sub><span class="free">n'</span></sub><span class="hidden">⇙</span> inf_llist <span class="free">t</span><span class="main">⟩</span> <span class="main">≠</span> <span class="main">∞</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound"><span class="bound">i'</span></span><span class="main">≥</span><span class="free">n</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i'</span></sub><span class="hidden">⇙</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
    <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="main">∃</span><span class="bound"><span class="bound">i'</span></span><span class="main">≥</span><span class="free">n'</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i'</span></sub><span class="hidden">⇙</span>›</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">i'</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">i'</span><span class="main">≥</span><span class="free">n'</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="skolem">i'</span></sub><span class="hidden">⇙</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
    <span class="keyword1"><span class="command">with</span></span> <span class="quoted"><span class="quoted">‹<span class="free">n'</span><span class="main">≥</span><span class="main">⟨</span><span class="free">c</span> <span class="main">⇐</span> <span class="free">t</span>⟩<span class="hidden">⇘</span><sub><span class="free">n</span></sub><span class="hidden">⇙</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">i'</span><span class="main">≥</span> <span class="free">n</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> lNactGe le_trans <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
    <span class="keyword1"><span class="command">with</span></span> <span class="quoted"><span class="quoted">‹<span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="skolem">i'</span></sub><span class="hidden">⇙</span>›</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"eval <span class="free">c</span> <span class="free">t</span> <span class="free">t'</span> <span class="free">n</span> <span class="main">(</span><span class="main">λ</span><span class="bound">t</span> <span class="bound">n</span><span class="main">.</span> <span class="main">∃</span><span class="bound"><span class="bound">n'</span></span><span class="main">≥</span><span class="bound">n</span><span class="main">.</span> <span class="free">γ</span> <span class="bound">t</span> <span class="bound">n'</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> validCI_act<span class="main">[</span><span class="keyword2"><span class="keyword"><span class="operator">where</span></span></span> γ<span class="main"><span class="main">=</span></span><span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">λ</span><span class="bound">t</span> <span class="bound">n</span><span class="main">.</span> <span class="main">∃</span><span class="bound"><span class="bound">n'</span></span><span class="main">≥</span><span class="bound">n</span><span class="main">.</span> <span class="free">γ</span> <span class="bound">t</span> <span class="bound">n'</span><span class="main">)</span>"</span></span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> evt_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">next</span></span>
  <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span><span class="main">(</span><span class="main">∃</span><span class="bound"><span class="bound">i'</span></span><span class="main">≥</span><span class="free">n'</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i'</span></sub><span class="hidden">⇙</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">with</span></span> <span class="quoted"><span class="quoted">‹<span class="main">(</span><span class="main">∃</span><span class="bound"><span class="bound">i</span></span><span class="main">≥</span><span class="free">n</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i</span></sub><span class="hidden">⇙</span><span class="main">)</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">n'</span> <span class="main">≥</span> <span class="main">⟨</span><span class="free">c</span> <span class="main">∧</span> <span class="free">t</span><span class="main">⟩</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> lActive_less <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span>↓<span class="hidden">⇘</span><sub><span class="free">t</span></sub><span class="hidden">⇙</span><span class="main">(</span><span class="free">n'</span><span class="main">)</span> <span class="main">≥</span> the_enat <span class="main">(</span>llength <span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>inf_llist <span class="free">t</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">-</span> <span class="main">1</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> cnf2bhv_ge_llength <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"the_enat<span class="main">(</span>llength <span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>inf_llist <span class="free">t</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">-</span> <span class="main">1</span> <span class="main">≥</span> the_enat<span class="main">(</span><span class="main">⟨</span><span class="free">c</span> #<span class="hidden">⇘</span><sub><span class="free">n</span></sub><span class="hidden">⇙</span> inf_llist <span class="free">t</span><span class="main">⟩</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
    <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="main">∃</span><span class="bound"><span class="bound">i</span></span><span class="main">≥</span><span class="free">n</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i</span></sub><span class="hidden">⇙</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"llength <span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>inf_llist <span class="free">t</span><span class="main">)</span><span class="main">)</span> <span class="main">≥</span> eSuc <span class="main">(</span><span class="main">⟨</span><span class="free">c</span> #<span class="hidden">⇘</span><sub><span class="free">n</span></sub><span class="hidden">⇙</span> inf_llist <span class="free">t</span><span class="main">⟩</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> nAct_llength_proj <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="main">¬</span><span class="main">(</span><span class="main">∃</span><span class="bound"><span class="bound">i'</span></span><span class="main">≥</span><span class="free">n'</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i'</span></sub><span class="hidden">⇙</span><span class="main">)</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"lfinite <span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>inf_llist <span class="free">t</span><span class="main">)</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> proj_finite2<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="quoted">"inf_llist <span class="free">t</span>"</span></span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"llength <span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>inf_llist <span class="free">t</span><span class="main">)</span><span class="main">)</span><span class="main">≠</span><span class="main">∞</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> llength_eq_infty_conv_lfinite <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"the_enat <span class="main">(</span>llength <span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>inf_llist <span class="free">t</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">≥</span> the_enat<span class="main">(</span>eSuc <span class="main">(</span><span class="main">⟨</span><span class="free">c</span> #<span class="hidden">⇘</span><sub><span class="free">n</span></sub><span class="hidden">⇙</span> inf_llist <span class="free">t</span><span class="main">⟩</span><span class="main">)</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">⟨</span><span class="free">c</span> #<span class="hidden">⇘</span><sub><span class="free">n</span></sub><span class="hidden">⇙</span> inf_llist <span class="free">t</span><span class="main">⟩</span><span class="main">≠</span><span class="main">∞</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"the_enat <span class="main">(</span>llength <span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>inf_llist <span class="free">t</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">≥</span> Suc <span class="main">(</span>the_enat <span class="main">(</span><span class="main">⟨</span><span class="free">c</span> #<span class="hidden">⇘</span><sub><span class="free">n</span></sub><span class="hidden">⇙</span> inf_llist <span class="free">t</span><span class="main">⟩</span><span class="main">)</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> the_enat_eSuc <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span>↓<span class="hidden">⇘</span><sub><span class="free">t</span></sub><span class="hidden">⇙</span><span class="main">(</span><span class="free">n'</span><span class="main">)</span> <span class="main">≥</span> the_enat <span class="main">(</span><span class="main">⟨</span><span class="free">c</span> #<span class="hidden">⇘</span><sub><span class="free">n</span></sub><span class="hidden">⇙</span> inf_llist <span class="free">t</span><span class="main">⟩</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>   
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="main">¬</span><span class="main">(</span><span class="main">∃</span><span class="bound"><span class="bound">i'</span></span><span class="main">≥</span><span class="free">n'</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i'</span></sub><span class="hidden">⇙</span><span class="main">)</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"eval <span class="free">c</span> <span class="free">t</span> <span class="free">t'</span> <span class="free">n'</span> <span class="free">γ</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>4<span class="main">)</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">with</span></span> <span class="quoted"><span class="quoted">‹<span class="main">∃</span><span class="bound"><span class="bound">i</span></span><span class="main">≥</span><span class="free">n</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i</span></sub><span class="hidden">⇙</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="main">¬</span><span class="main">(</span><span class="main">∃</span><span class="bound"><span class="bound">i'</span></span><span class="main">≥</span><span class="free">n'</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i'</span></sub><span class="hidden">⇙</span><span class="main">)</span>›</span></span>
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">γ</span> <span class="main">(</span>lnth <span class="main">(</span><span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>inf_llist <span class="free">t</span><span class="main">)</span><span class="main">)</span> <span class="keyword1">@<span class="hidden">⇩</span><sub>l</sub></span> <span class="main">(</span>inf_llist <span class="free">t'</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">(</span><span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span>↓<span class="hidden">⇘</span><sub><span class="free">t</span></sub><span class="hidden">⇙</span><span class="main">(</span><span class="free">n'</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> validCE_cont <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"eval <span class="free">c</span> <span class="free">t</span> <span class="free">t'</span> <span class="free">n</span> <span class="main">(</span><span class="main">λ</span><span class="bound">t</span> <span class="bound">n</span><span class="main">.</span> <span class="main">∃</span><span class="bound"><span class="bound">n'</span></span><span class="main">≥</span><span class="bound">n</span><span class="main">.</span> <span class="free">γ</span> <span class="bound">t</span> <span class="bound">n'</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="main">∃</span><span class="bound"><span class="bound">i</span></span><span class="main">≥</span><span class="free">n</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i</span></sub><span class="hidden">⇙</span>›</span></span> validCI_act<span class="main">[</span><span class="keyword2"><span class="keyword"><span class="operator">where</span></span></span> γ<span class="main"><span class="main">=</span></span><span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">λ</span><span class="bound">t</span> <span class="bound">n</span><span class="main">.</span> <span class="main">∃</span><span class="bound"><span class="bound">n'</span></span><span class="main">≥</span><span class="bound">n</span><span class="main">.</span> <span class="free">γ</span> <span class="bound">t</span> <span class="bound">n'</span><span class="main">)</span>"</span></span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> evt_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>
    
<span class="keyword1" id="Dynamic_Architecture_Calculus-evtIN"><span class="command">lemma</span></span> evtIN<span class="main">[</span><span class="operator">intro</span><span class="main">]</span><span class="main">:</span>
  <span class="keyword2"><span class="keyword">fixes</span></span> <span class="free">c</span><span class="main">::</span><span class="tfree"><span class="quoted"><span class="tfree">'id</span></span></span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="free">t</span><span class="main">::</span><span class="quoted"><span class="quoted">"nat <span class="main">⇒</span> cnf"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="free">t'</span><span class="main">::</span><span class="quoted"><span class="quoted">"nat <span class="main">⇒</span> <span class="tfree">'cmp</span>"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="free">n</span><span class="main">::</span><span class="quoted">nat</span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="free">n'</span><span class="main">::</span><span class="quoted">nat</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span><span class="main">(</span><span class="main">∃</span><span class="bound"><span class="bound">i</span></span><span class="main">≥</span><span class="free">n</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i</span></sub><span class="hidden">⇙</span><span class="main">)</span>"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">n'</span><span class="main">≥</span><span class="free">n</span>"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"eval <span class="free">c</span> <span class="free">t</span> <span class="free">t'</span> <span class="free">n'</span> <span class="free">γ</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"eval <span class="free">c</span> <span class="free">t</span> <span class="free">t'</span> <span class="free">n</span> <span class="main">(</span><span class="keyword1">◇<span class="hidden">⇩</span><sub>b</sub></span><span class="main">(</span><span class="free">γ</span><span class="main">)</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">cases</span>
  <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound">i</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i</span></sub><span class="hidden">⇙</span>"</span></span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> assms<span class="main">(</span>1<span class="main">)</span> assms<span class="main">(</span>2<span class="main">)</span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span><span class="main">(</span><span class="main">∃</span><span class="bound"><span class="bound">i'</span></span><span class="main">≥</span><span class="free">n'</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i'</span></sub><span class="hidden">⇙</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">γ</span> <span class="main">(</span>lnth <span class="main">(</span><span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>inf_llist <span class="free">t</span><span class="main">)</span><span class="main">)</span> <span class="keyword1">@<span class="hidden">⇩</span><sub>l</sub></span> <span class="main">(</span>inf_llist <span class="free">t'</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">(</span><span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span>↓<span class="hidden">⇘</span><sub><span class="free">t</span></sub><span class="hidden">⇙</span><span class="main">(</span><span class="free">n'</span><span class="main">)</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> validCE_cont<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="free">c</span></span> <span class="quoted"><span class="free">t</span></span> <span class="quoted"><span class="free">n'</span></span> <span class="quoted"><span class="free">t'</span></span> <span class="quoted"><span class="free">γ</span></span><span class="main">]</span> <span class="quoted"><span class="quoted">‹eval <span class="free">c</span> <span class="free">t</span> <span class="free">t'</span> <span class="free">n'</span> <span class="free">γ</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="free">n'</span><span class="main">≥</span><span class="free">n</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span>↓<span class="hidden">⇘</span><sub><span class="free">t</span></sub><span class="hidden">⇙</span><span class="main">(</span><span class="free">n'</span><span class="main">)</span> <span class="main">≥</span> <span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span>↓<span class="hidden">⇘</span><sub><span class="free">t</span></sub><span class="hidden">⇙</span><span class="main">(</span><span class="free">n</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> cnf2bhv_mono <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"eval <span class="free">c</span> <span class="free">t</span> <span class="free">t'</span> <span class="free">n</span> <span class="main">(</span><span class="main">λ</span><span class="bound">t</span> <span class="bound">n</span><span class="main">.</span> <span class="main">∃</span><span class="bound"><span class="bound">n'</span></span><span class="main">≥</span><span class="bound">n</span><span class="main">.</span> <span class="free">γ</span> <span class="bound">t</span> <span class="bound">n'</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> validCI_cont<span class="main">[</span><span class="keyword2"><span class="keyword"><span class="operator">where</span></span></span> γ<span class="main"><span class="main">=</span></span><span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">λ</span><span class="bound">t</span> <span class="bound">n</span><span class="main">.</span> <span class="main">∃</span><span class="bound"><span class="bound">n'</span></span><span class="main">≥</span><span class="bound">n</span><span class="main">.</span> <span class="free">γ</span> <span class="bound">t</span> <span class="bound">n'</span><span class="main">)</span>"</span></span><span class="main">]</span> <span class="quoted"><span class="quoted">‹<span class="main">∃</span><span class="bound">i</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i</span></sub><span class="hidden">⇙</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="main">¬</span><span class="main">(</span><span class="main">∃</span><span class="bound"><span class="bound">i</span></span><span class="main">≥</span><span class="free">n</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i</span></sub><span class="hidden">⇙</span><span class="main">)</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> evt_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">next</span></span>
  <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span><span class="main">(</span><span class="main">∃</span><span class="bound">i</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i</span></sub><span class="hidden">⇙</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">with</span></span> assms <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">γ</span> <span class="main">(</span>lnth <span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span>inf_llist <span class="free">t</span> <span class="keyword1">@<span class="hidden">⇩</span><sub>l</sub></span> inf_llist <span class="free">t'</span><span class="main">)</span><span class="main">)</span> <span class="free">n'</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> validCE_not_act <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">with</span></span> <span class="quoted"><span class="quoted">‹<span class="main">¬</span><span class="main">(</span><span class="main">∃</span><span class="bound">i</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i</span></sub><span class="hidden">⇙</span><span class="main">)</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"eval <span class="free">c</span> <span class="free">t</span> <span class="free">t'</span> <span class="free">n</span> <span class="main">(</span><span class="main">λ</span><span class="bound">t</span> <span class="bound">n</span><span class="main">.</span> <span class="main">∃</span><span class="bound"><span class="bound">n'</span></span><span class="main">≥</span><span class="bound">n</span><span class="main">.</span> <span class="free">γ</span> <span class="bound">t</span> <span class="bound">n'</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> validCI_not_act<span class="main">[</span><span class="keyword2"><span class="keyword"><span class="operator">where</span></span></span> γ<span class="main"><span class="main">=</span></span><span class="quoted"><span class="quoted">"<span class="main">λ</span><span class="bound">t</span> <span class="bound">n</span><span class="main">.</span> <span class="main">∃</span><span class="bound"><span class="bound">n'</span></span><span class="main">≥</span><span class="bound">n</span><span class="main">.</span> <span class="free">γ</span> <span class="bound">t</span> <span class="bound">n'</span>"</span></span><span class="main">]</span> <span class="quoted"><span class="quoted">‹<span class="free">n'</span><span class="main">≥</span><span class="free">n</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> evt_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>
  
<span class="keyword1" id="Dynamic_Architecture_Calculus-evtEA"><span class="command">lemma</span></span> evtEA<span class="main">[</span><span class="operator">elim</span><span class="main">]</span><span class="main">:</span>
  <span class="keyword2"><span class="keyword">fixes</span></span> <span class="free">c</span><span class="main">::</span><span class="tfree"><span class="quoted"><span class="tfree">'id</span></span></span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="free">t</span><span class="main">::</span><span class="quoted"><span class="quoted">"nat <span class="main">⇒</span> cnf"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="free">t'</span><span class="main">::</span><span class="quoted"><span class="quoted">"nat <span class="main">⇒</span> <span class="tfree">'cmp</span>"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="free">n</span><span class="main">::</span><span class="quoted">nat</span>  
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound"><span class="bound">i</span></span><span class="main">≥</span><span class="free">n</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i</span></sub><span class="hidden">⇙</span>"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"eval <span class="free">c</span> <span class="free">t</span> <span class="free">t'</span> <span class="free">n</span> <span class="main">(</span><span class="keyword1">◇<span class="hidden">⇩</span><sub>b</sub></span><span class="main">(</span><span class="free">γ</span><span class="main">)</span><span class="main">)</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound"><span class="bound">n'</span></span><span class="main">≥</span><span class="main">⟨</span><span class="free">c</span> <span class="main">→</span> <span class="free">t</span>⟩<span class="hidden">⇘</span><sub><span class="free">n</span></sub><span class="hidden">⇙</span><span class="main">.</span>
          <span class="main">(</span><span class="main">∃</span><span class="bound"><span class="bound">i</span></span><span class="main">≥</span><span class="bound">n'</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i</span></sub><span class="hidden">⇙</span> <span class="main">∧</span> <span class="main">(</span><span class="main">∀</span><span class="bound"><span class="bound">n''</span></span><span class="main">≥</span> <span class="main">⟨</span><span class="free">c</span> <span class="main">⇐</span> <span class="free">t</span>⟩<span class="hidden">⇘</span><sub><span class="bound">n'</span></sub><span class="hidden">⇙</span><span class="main">.</span> <span class="bound">n''</span><span class="main">≤</span><span class="main">⟨</span><span class="free">c</span> <span class="main">→</span> <span class="free">t</span>⟩<span class="hidden">⇘</span><sub><span class="bound">n'</span></sub><span class="hidden">⇙</span> <span class="main">⟶</span> eval <span class="free">c</span> <span class="free">t</span> <span class="free">t'</span> <span class="bound">n''</span> <span class="free">γ</span><span class="main">)</span><span class="main">)</span> <span class="main">∨</span>
          <span class="main">(</span><span class="main">¬</span><span class="main">(</span><span class="main">∃</span><span class="bound"><span class="bound">i</span></span><span class="main">≥</span><span class="bound">n'</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i</span></sub><span class="hidden">⇙</span><span class="main">)</span> <span class="main">∧</span> eval <span class="free">c</span> <span class="free">t</span> <span class="free">t'</span> <span class="bound">n'</span> <span class="free">γ</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹eval <span class="free">c</span> <span class="free">t</span> <span class="free">t'</span> <span class="free">n</span> <span class="main">(</span><span class="keyword1">◇<span class="hidden">⇩</span><sub>b</sub></span><span class="main">(</span><span class="free">γ</span><span class="main">)</span><span class="main">)</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"eval <span class="free">c</span> <span class="free">t</span> <span class="free">t'</span> <span class="free">n</span> <span class="main">(</span><span class="main">λ</span><span class="bound">t</span> <span class="bound">n</span><span class="main">.</span> <span class="main">∃</span><span class="bound"><span class="bound">n'</span></span><span class="main">≥</span><span class="bound">n</span><span class="main">.</span> <span class="free">γ</span> <span class="bound">t</span> <span class="bound">n'</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> evt_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">with</span></span> <span class="quoted"><span class="quoted">‹<span class="main">∃</span><span class="bound"><span class="bound">i</span></span><span class="main">≥</span><span class="free">n</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i</span></sub><span class="hidden">⇙</span>›</span></span>
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound"><span class="bound">n'</span></span><span class="main">≥</span>the_enat <span class="main">⟨</span><span class="free">c</span> #<span class="hidden">⇘</span><sub>enat <span class="free">n</span></sub><span class="hidden">⇙</span>inf_llist <span class="free">t</span><span class="main">⟩</span><span class="main">.</span> <span class="free">γ</span> <span class="main">(</span>lnth <span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span>inf_llist <span class="free">t</span> <span class="keyword1">@<span class="hidden">⇩</span><sub>l</sub></span> inf_llist <span class="free">t'</span><span class="main">)</span><span class="main">)</span> <span class="bound">n'</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> validCE_act<span class="main">[</span><span class="keyword2"><span class="keyword"><span class="operator">where</span></span></span> γ<span class="main"><span class="main">=</span></span><span class="quoted"><span class="quoted">"<span class="main">λ</span><span class="bound">t</span> <span class="bound">n</span><span class="main">.</span> <span class="main">∃</span><span class="bound"><span class="bound">n'</span></span><span class="main">≥</span><span class="bound">n</span><span class="main">.</span> <span class="free">γ</span> <span class="bound">t</span> <span class="bound">n'</span>"</span></span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">x</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span><span class="main">≥</span>the_enat <span class="main">(</span><span class="main">⟨</span><span class="free">c</span> #<span class="hidden">⇘</span><sub><span class="free">n</span></sub><span class="hidden">⇙</span> inf_llist <span class="free">t</span><span class="main">⟩</span><span class="main">)</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span>
    <span class="quoted"><span class="quoted">"<span class="free">γ</span> <span class="main">(</span>lnth <span class="main">(</span><span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>inf_llist <span class="free">t</span><span class="main">)</span><span class="main">)</span> <span class="keyword1">@<span class="hidden">⇩</span><sub>l</sub></span> <span class="main">(</span>inf_llist <span class="free">t'</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="skolem">x</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">cases</span><span class="main">)</span>
    <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">≥</span> llength <span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>inf_llist <span class="free">t</span><span class="main">)</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="main">(</span><span class="skolem">x</span> <span class="main">≥</span> llength <span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>inf_llist <span class="free">t</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"llength <span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>inf_llist <span class="free">t</span><span class="main">)</span><span class="main">)</span><span class="main">≠</span><span class="main">∞</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> infinity_ileE<span class="main">)</span>
    <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="main">∃</span><span class="bound"><span class="bound">i</span></span><span class="main">≥</span><span class="free">n</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i</span></sub><span class="hidden">⇙</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"llength <span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>inf_llist <span class="free">t</span><span class="main">)</span><span class="main">)</span><span class="main">≥</span><span class="main">1</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> proj_one<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="quoted">"inf_llist <span class="free">t</span>"</span></span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"the_enat <span class="main">(</span>llength <span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>inf_llist <span class="free">t</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">-</span> <span class="main">1</span> <span class="main">&lt;</span> <span class="skolem">x</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> One_nat_def Suc_ile_eq antisym_conv2 diff_Suc_less enat_ord_simps<span class="main"><span class="main">(</span></span>2<span class="main"><span class="main">)</span></span>
          enat_the_enat less_imp_diff_less one_enat_def<span class="main">)</span>
    <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">=</span> <span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span>↓<span class="hidden">⇘</span><sub><span class="free">t</span></sub><span class="hidden">⇙</span><span class="main">(</span><span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span>↑<span class="hidden">⇘</span><sub><span class="free">t</span></sub><span class="hidden">⇙</span><span class="main">(</span><span class="skolem">x</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> cnf2bhv_bhv2cnf <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">with</span></span> <span class="quoted"><span class="quoted">‹<span class="free">γ</span> <span class="main">(</span>lnth <span class="main">(</span><span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>inf_llist <span class="free">t</span><span class="main">)</span><span class="main">)</span> <span class="keyword1">@<span class="hidden">⇩</span><sub>l</sub></span> <span class="main">(</span>inf_llist <span class="free">t'</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="skolem">x</span>›</span></span>
      <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">γ</span> <span class="main">(</span>lnth <span class="main">(</span><span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>inf_llist <span class="free">t</span><span class="main">)</span><span class="main">)</span> <span class="keyword1">@<span class="hidden">⇩</span><sub>l</sub></span> <span class="main">(</span>inf_llist <span class="free">t'</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">(</span><span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span>↓<span class="hidden">⇘</span><sub><span class="free">t</span></sub><span class="hidden">⇙</span><span class="main">(</span><span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span>↑<span class="hidden">⇘</span><sub><span class="free">t</span></sub><span class="hidden">⇙</span><span class="main">(</span><span class="skolem">x</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span><span class="main">(</span><span class="main">∃</span><span class="bound"><span class="bound">i</span></span><span class="main">≥</span><span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span>↑<span class="hidden">⇘</span><sub><span class="free">t</span></sub><span class="hidden">⇙</span><span class="main">(</span><span class="skolem">x</span><span class="main">)</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i</span></sub><span class="hidden">⇙</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
      <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">x</span> <span class="main">≥</span> llength <span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>inf_llist <span class="free">t</span><span class="main">)</span><span class="main">)</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"lfinite <span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>inf_llist <span class="free">t</span><span class="main">)</span><span class="main">)</span>"</span></span>
        <span class="keyword1"><span class="command">using</span></span> llength_geq_enat_lfiniteD<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="quoted">"π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>inf_llist <span class="free">t</span><span class="main">)</span>"</span></span> <span class="quoted"><span class="skolem">x</span></span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
      <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">z</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound"><span class="bound">n''</span></span><span class="main">&gt;</span><span class="skolem">z</span><span class="main">.</span> <span class="main">¬</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">n''</span></sub><span class="hidden">⇙</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> proj_finite_bound <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
      <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹the_enat <span class="main">(</span>llength <span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>inf_llist <span class="free">t</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">-</span> <span class="main">1</span> <span class="main">&lt;</span> <span class="skolem">x</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">⟨</span><span class="free">c</span> <span class="main">∧</span> <span class="free">t</span><span class="main">⟩</span> <span class="main">&lt;</span> <span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span>↑<span class="hidden">⇘</span><sub><span class="free">t</span></sub><span class="hidden">⇙</span><span class="main">(</span><span class="skolem">x</span><span class="main">)</span>"</span></span>
        <span class="keyword1"><span class="command">using</span></span> bhv2cnf_greater_lActive <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
      <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> lActive_greater_active_all <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">qed</span></span>
    <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"eval <span class="free">c</span> <span class="free">t</span> <span class="free">t'</span> <span class="main">(</span><span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span>↑<span class="hidden">⇘</span><sub><span class="free">t</span></sub><span class="hidden">⇙</span><span class="skolem">x</span><span class="main">)</span> <span class="free">γ</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="main">∃</span><span class="bound"><span class="bound">i</span></span><span class="main">≥</span><span class="free">n</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i</span></sub><span class="hidden">⇙</span>›</span></span> validCI_cont<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="free">c</span></span> <span class="quoted"><span class="free">t</span></span> <span class="quoted"><span class="quoted">"<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span>↑<span class="hidden">⇘</span><sub><span class="free">t</span></sub><span class="hidden">⇙</span><span class="main">(</span><span class="skolem">x</span><span class="main">)</span>"</span></span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
    <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span>↑<span class="hidden">⇘</span><sub><span class="free">t</span></sub><span class="hidden">⇙</span><span class="main">(</span><span class="skolem">x</span><span class="main">)</span> <span class="main">≥</span> <span class="main">⟨</span><span class="free">c</span> <span class="main">→</span> <span class="free">t</span>⟩<span class="hidden">⇘</span><sub><span class="free">n</span></sub><span class="hidden">⇙</span>"</span></span>
    <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
      <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">x</span> <span class="main">≥</span> llength <span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>inf_llist <span class="free">t</span><span class="main">)</span><span class="main">)</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"lfinite <span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>inf_llist <span class="free">t</span><span class="main">)</span><span class="main">)</span>"</span></span>
        <span class="keyword1"><span class="command">using</span></span> llength_geq_enat_lfiniteD<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="quoted">"π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>inf_llist <span class="free">t</span><span class="main">)</span>"</span></span> <span class="quoted"><span class="skolem">x</span></span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
      <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">z</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound"><span class="bound">n''</span></span><span class="main">&gt;</span><span class="skolem">z</span><span class="main">.</span> <span class="main">¬</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">n''</span></sub><span class="hidden">⇙</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> proj_finite_bound <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
      <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="main">∃</span><span class="bound"><span class="bound">i</span></span><span class="main">≥</span><span class="free">n</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i</span></sub><span class="hidden">⇙</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="main">⟨</span><span class="free">c</span> <span class="main">→</span> <span class="free">t</span>⟩<span class="hidden">⇘</span><sub><span class="free">n</span></sub><span class="hidden">⇙</span></sub><span class="hidden">⇙</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> nxtActI <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
      <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">⟨</span><span class="free">c</span> <span class="main">∧</span> <span class="free">t</span><span class="main">⟩</span><span class="main">≥</span><span class="main">⟨</span><span class="free">c</span> <span class="main">→</span> <span class="free">t</span>⟩<span class="hidden">⇘</span><sub><span class="free">n</span></sub><span class="hidden">⇙</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> lActive_greatest <span class="keyword1"><span class="command">by</span></span> <span class="operator">fastforce</span>
      <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span>↑<span class="hidden">⇘</span><sub><span class="free">t</span></sub><span class="hidden">⇙</span><span class="main">(</span><span class="skolem">x</span><span class="main">)</span> <span class="main">≥</span> <span class="main">⟨</span><span class="free">c</span> <span class="main">∧</span> <span class="free">t</span><span class="main">⟩</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
      <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span>↑<span class="hidden">⇘</span><sub><span class="free">t</span></sub><span class="hidden">⇙</span><span class="main">(</span><span class="skolem">x</span><span class="main">)</span> <span class="main">≥</span> <span class="main">⟨</span><span class="free">c</span> <span class="main">→</span> <span class="free">t</span>⟩<span class="hidden">⇘</span><sub><span class="free">n</span></sub><span class="hidden">⇙</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">arith</span>
    <span class="keyword1"><span class="command">qed</span></span>
    <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="main">¬</span><span class="main">(</span><span class="main">∃</span><span class="bound"><span class="bound">i</span></span><span class="main">≥</span><span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span>↑<span class="hidden">⇘</span><sub><span class="free">t</span></sub><span class="hidden">⇙</span><span class="main">(</span><span class="skolem">x</span><span class="main">)</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i</span></sub><span class="hidden">⇙</span><span class="main">)</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">next</span></span>
    <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span><span class="main">(</span><span class="skolem">x</span> <span class="main">≥</span> llength <span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>inf_llist <span class="free">t</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span><span class="main">&lt;</span>llength <span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>inf_llist <span class="free">t</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">n'</span></span><span class="main">::</span><span class="quoted">nat</span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span><span class="main">=</span><span class="main">⟨</span><span class="free">c</span> #<span class="hidden">⇘</span><sub><span class="skolem">n'</span></sub><span class="hidden">⇙</span> inf_llist <span class="free">t</span><span class="main">⟩</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> nAct_exists <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
    <span class="keyword1"><span class="command">with</span></span> <span class="quoted"><span class="quoted">‹enat <span class="skolem">x</span> <span class="main">&lt;</span> llength <span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>inf_llist <span class="free">t</span><span class="main">)</span><span class="main">)</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound"><span class="bound">i</span></span><span class="main">≥</span><span class="skolem">n'</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i</span></sub><span class="hidden">⇙</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> nAct_less_llength_active <span class="keyword1"><span class="command">by</span></span> <span class="operator">force</span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">i</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">i</span><span class="main">≥</span><span class="skolem">n'</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="skolem">i</span></sub><span class="hidden">⇙</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> <span class="main">(</span><span class="main">∃</span><span class="bound"><span class="bound">k</span></span><span class="main">≥</span><span class="skolem">n'</span><span class="main">.</span> <span class="bound">k</span> <span class="main">&lt;</span> <span class="skolem">i</span> <span class="main">∧</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">k</span></sub><span class="hidden">⇙</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> nact_exists <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
    <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">∀</span><span class="bound"><span class="bound">n''</span></span><span class="main">≥</span> <span class="main">⟨</span><span class="free">c</span> <span class="main">⇐</span> <span class="free">t</span>⟩<span class="hidden">⇘</span><sub><span class="skolem">i</span></sub><span class="hidden">⇙</span><span class="main">.</span> <span class="bound">n''</span><span class="main">≤</span><span class="main">⟨</span><span class="free">c</span> <span class="main">→</span> <span class="free">t</span>⟩<span class="hidden">⇘</span><sub><span class="skolem">i</span></sub><span class="hidden">⇙</span> <span class="main">⟶</span> eval <span class="free">c</span> <span class="free">t</span> <span class="free">t'</span> <span class="bound">n''</span> <span class="free">γ</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">proof</span></span>
      <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">n''</span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">⟨</span><span class="free">c</span> <span class="main">⇐</span> <span class="free">t</span>⟩<span class="hidden">⇘</span><sub><span class="skolem">i</span></sub><span class="hidden">⇙</span> <span class="main">≤</span> <span class="skolem">n''</span> <span class="main">⟶</span> <span class="skolem">n''</span> <span class="main">≤</span> <span class="main">⟨</span><span class="free">c</span> <span class="main">→</span> <span class="free">t</span>⟩<span class="hidden">⇘</span><sub><span class="skolem">i</span></sub><span class="hidden">⇙</span> <span class="main">⟶</span> eval <span class="free">c</span> <span class="free">t</span> <span class="free">t'</span> <span class="skolem">n''</span> <span class="free">γ</span>"</span></span>
      <span class="keyword1"><span class="command">proof</span></span><span class="main">(</span><span class="operator">rule</span> HOL.impI<span class="main"><span class="main">[</span></span><span class="operator">OF</span> HOL.impI<span class="main"><span class="main">]</span></span><span class="main">)</span>
        <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">⟨</span><span class="free">c</span> <span class="main">⇐</span> <span class="free">t</span>⟩<span class="hidden">⇘</span><sub><span class="skolem">i</span></sub><span class="hidden">⇙</span> <span class="main">≤</span> <span class="skolem">n''</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">n''</span> <span class="main">≤</span> <span class="main">⟨</span><span class="free">c</span> <span class="main">→</span> <span class="free">t</span>⟩<span class="hidden">⇘</span><sub><span class="skolem">i</span></sub><span class="hidden">⇙</span>"</span></span>
        <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"the_enat <span class="main">(</span><span class="main">⟨</span><span class="free">c</span> #<span class="hidden">⇘</span><sub>enat <span class="skolem">i</span></sub><span class="hidden">⇙</span> inf_llist <span class="free">t</span><span class="main">⟩</span><span class="main">)</span> <span class="main">=</span> the_enat <span class="main">(</span><span class="main">⟨</span><span class="free">c</span> #<span class="hidden">⇘</span><sub>enat <span class="skolem">n''</span></sub><span class="hidden">⇙</span> inf_llist <span class="free">t</span><span class="main">⟩</span><span class="main">)</span>"</span></span>
          <span class="keyword1"><span class="command">using</span></span> nAct_same <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
        <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="skolem">i</span></sub><span class="hidden">⇙</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="main">⟨</span><span class="free">c</span> <span class="main">→</span> <span class="free">t</span>⟩<span class="hidden">⇘</span><sub><span class="skolem">i</span></sub><span class="hidden">⇙</span></sub><span class="hidden">⇙</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> nxtActI <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword1"><span class="command">with</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">n''</span> <span class="main">≤</span> <span class="main">⟨</span><span class="free">c</span> <span class="main">→</span> <span class="free">t</span>⟩<span class="hidden">⇘</span><sub><span class="skolem">i</span></sub><span class="hidden">⇙</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound"><span class="bound">i</span></span><span class="main">≥</span><span class="skolem">n''</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i</span></sub><span class="hidden">⇙</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> dual_order.strict_implies_order <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">γ</span> <span class="main">(</span>lnth <span class="main">(</span><span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>inf_llist <span class="free">t</span><span class="main">)</span><span class="main">)</span> <span class="keyword1">@<span class="hidden">⇩</span><sub>l</sub></span> <span class="main">(</span>inf_llist <span class="free">t'</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">(</span>the_enat <span class="main">(</span><span class="main">⟨</span><span class="free">c</span> #<span class="hidden">⇘</span><sub>enat <span class="skolem">i</span></sub><span class="hidden">⇙</span> inf_llist <span class="free">t</span><span class="main">⟩</span><span class="main">)</span><span class="main">)</span>"</span></span>
        <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
          <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"enat <span class="skolem">i</span> <span class="main">-</span> <span class="main">1</span> <span class="main">&lt;</span> llength <span class="main">(</span>inf_llist <span class="free">t</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> one_enat_def<span class="main">)</span>
          <span class="keyword1"><span class="command">with</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">x</span><span class="main">=</span><span class="main">⟨</span><span class="free">c</span> #<span class="hidden">⇘</span><sub><span class="skolem">n'</span></sub><span class="hidden">⇙</span> inf_llist <span class="free">t</span><span class="main">⟩</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">i</span><span class="main">≥</span><span class="skolem">n'</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="main">¬</span> <span class="main">(</span><span class="main">∃</span><span class="bound"><span class="bound">k</span></span><span class="main">≥</span><span class="skolem">n'</span><span class="main">.</span> <span class="bound">k</span> <span class="main">&lt;</span> <span class="skolem">i</span> <span class="main">∧</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">k</span></sub><span class="hidden">⇙</span><span class="main">)</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span><span class="main">=</span><span class="main">⟨</span><span class="free">c</span> #<span class="hidden">⇘</span><sub><span class="skolem">i</span></sub><span class="hidden">⇙</span> inf_llist <span class="free">t</span><span class="main">⟩</span>"</span></span>
            <span class="keyword1"><span class="command">using</span></span> one_enat_def nAct_not_active_same <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
          <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">⟨</span><span class="free">c</span> #<span class="hidden">⇘</span><sub><span class="skolem">i</span></sub><span class="hidden">⇙</span> inf_llist <span class="free">t</span><span class="main">⟩</span><span class="main">≠</span><span class="main">∞</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
          <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span><span class="main">=</span>the_enat<span class="main">(</span><span class="main">⟨</span><span class="free">c</span> #<span class="hidden">⇘</span><sub><span class="skolem">i</span></sub><span class="hidden">⇙</span> inf_llist <span class="free">t</span><span class="main">⟩</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">fastforce</span>        
          <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="free">γ</span> <span class="main">(</span>lnth <span class="main">(</span><span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>inf_llist <span class="free">t</span><span class="main">)</span><span class="main">)</span> <span class="keyword1">@<span class="hidden">⇩</span><sub>l</sub></span> <span class="main">(</span>inf_llist <span class="free">t'</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="skolem">x</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
        <span class="keyword1"><span class="command">qed</span></span>
        <span class="keyword1"><span class="command">with</span></span> <span class="quoted"><span class="quoted">‹the_enat <span class="main">(</span><span class="main">⟨</span><span class="free">c</span> #<span class="hidden">⇘</span><sub>enat <span class="skolem">i</span></sub><span class="hidden">⇙</span> inf_llist <span class="free">t</span><span class="main">⟩</span><span class="main">)</span> <span class="main">=</span> the_enat <span class="main">(</span><span class="main">⟨</span><span class="free">c</span> #<span class="hidden">⇘</span><sub>enat <span class="skolem">n''</span></sub><span class="hidden">⇙</span> inf_llist <span class="free">t</span><span class="main">⟩</span><span class="main">)</span>›</span></span> <span class="keyword1"><span class="command">have</span></span>
          <span class="quoted"><span class="quoted">"<span class="free">γ</span> <span class="main">(</span>lnth <span class="main">(</span><span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>inf_llist <span class="free">t</span><span class="main">)</span><span class="main">)</span> <span class="keyword1">@<span class="hidden">⇩</span><sub>l</sub></span> <span class="main">(</span>inf_llist <span class="free">t'</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">(</span>the_enat <span class="main">(</span><span class="main">⟨</span><span class="free">c</span> #<span class="hidden">⇘</span><sub>enat <span class="skolem">n''</span></sub><span class="hidden">⇙</span> inf_llist <span class="free">t</span><span class="main">⟩</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
        <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"eval <span class="free">c</span> <span class="free">t</span> <span class="free">t'</span> <span class="skolem">n''</span> <span class="free">γ</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> validCI_act <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
      <span class="keyword1"><span class="command">qed</span></span>
    <span class="keyword1"><span class="command">qed</span></span>
    <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">i</span><span class="main">≥</span><span class="main">⟨</span><span class="free">c</span> <span class="main">→</span> <span class="free">t</span>⟩<span class="hidden">⇘</span><sub><span class="free">n</span></sub><span class="hidden">⇙</span>"</span></span>
    <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
      <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"enat <span class="skolem">i</span> <span class="main">-</span> <span class="main">1</span> <span class="main">&lt;</span> llength <span class="main">(</span>inf_llist <span class="free">t</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> one_enat_def<span class="main">)</span>
      <span class="keyword1"><span class="command">with</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">x</span><span class="main">=</span><span class="main">⟨</span><span class="free">c</span> #<span class="hidden">⇘</span><sub><span class="skolem">n'</span></sub><span class="hidden">⇙</span> inf_llist <span class="free">t</span><span class="main">⟩</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">i</span><span class="main">≥</span><span class="skolem">n'</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="main">¬</span> <span class="main">(</span><span class="main">∃</span><span class="bound"><span class="bound">k</span></span><span class="main">≥</span><span class="skolem">n'</span><span class="main">.</span> <span class="bound">k</span> <span class="main">&lt;</span> <span class="skolem">i</span> <span class="main">∧</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">k</span></sub><span class="hidden">⇙</span><span class="main">)</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span><span class="main">=</span><span class="main">⟨</span><span class="free">c</span> #<span class="hidden">⇘</span><sub><span class="skolem">i</span></sub><span class="hidden">⇙</span> inf_llist <span class="free">t</span><span class="main">⟩</span>"</span></span>
        <span class="keyword1"><span class="command">using</span></span> one_enat_def nAct_not_active_same <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
      <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">⟨</span><span class="free">c</span> #<span class="hidden">⇘</span><sub><span class="skolem">i</span></sub><span class="hidden">⇙</span> inf_llist <span class="free">t</span><span class="main">⟩</span><span class="main">≠</span><span class="main">∞</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
      <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span><span class="main">=</span>the_enat<span class="main">(</span><span class="main">⟨</span><span class="free">c</span> #<span class="hidden">⇘</span><sub><span class="skolem">i</span></sub><span class="hidden">⇙</span> inf_llist <span class="free">t</span><span class="main">⟩</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">fastforce</span>        
      <span class="keyword1"><span class="command">with</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">x</span><span class="main">≥</span>the_enat <span class="main">(</span><span class="main">⟨</span><span class="free">c</span> #<span class="hidden">⇘</span><sub><span class="free">n</span></sub><span class="hidden">⇙</span> inf_llist <span class="free">t</span><span class="main">⟩</span><span class="main">)</span>›</span></span>
        <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"the_enat <span class="main">(</span><span class="main">⟨</span><span class="free">c</span> #<span class="hidden">⇘</span><sub><span class="skolem">i</span></sub><span class="hidden">⇙</span> inf_llist <span class="free">t</span><span class="main">⟩</span><span class="main">)</span><span class="main">≥</span>the_enat <span class="main">(</span><span class="main">⟨</span><span class="free">c</span> #<span class="hidden">⇘</span><sub><span class="free">n</span></sub><span class="hidden">⇙</span> inf_llist <span class="free">t</span><span class="main">⟩</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
      <span class="keyword1"><span class="command">with</span></span> <span class="quoted"><span class="quoted">‹<span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="skolem">i</span></sub><span class="hidden">⇙</span>›</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> active_geq_nxtAct <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">qed</span></span>
    <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="skolem">i</span></sub><span class="hidden">⇙</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">qed</span></span>    
<span class="keyword1"><span class="command">qed</span></span>
    
<span class="keyword1" id="Dynamic_Architecture_Calculus-evtEN"><span class="command">lemma</span></span> evtEN<span class="main">[</span><span class="operator">elim</span><span class="main">]</span><span class="main">:</span>
  <span class="keyword2"><span class="keyword">fixes</span></span> <span class="free">c</span><span class="main">::</span><span class="tfree"><span class="quoted"><span class="tfree">'id</span></span></span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="free">t</span><span class="main">::</span><span class="quoted"><span class="quoted">"nat <span class="main">⇒</span> cnf"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="free">t'</span><span class="main">::</span><span class="quoted"><span class="quoted">"nat <span class="main">⇒</span> <span class="tfree">'cmp</span>"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="free">n</span><span class="main">::</span><span class="quoted">nat</span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="free">n'</span><span class="main">::</span><span class="quoted">nat</span>  
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span><span class="main">(</span><span class="main">∃</span><span class="bound"><span class="bound">i</span></span><span class="main">≥</span><span class="free">n</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i</span></sub><span class="hidden">⇙</span><span class="main">)</span>"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"eval <span class="free">c</span> <span class="free">t</span> <span class="free">t'</span> <span class="free">n</span> <span class="main">(</span><span class="keyword1">◇<span class="hidden">⇩</span><sub>b</sub></span><span class="main">(</span><span class="free">γ</span><span class="main">)</span><span class="main">)</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound"><span class="bound">n'</span></span><span class="main">≥</span><span class="free">n</span><span class="main">.</span> eval <span class="free">c</span> <span class="free">t</span> <span class="free">t'</span> <span class="bound">n'</span> <span class="free">γ</span>"</span></span> 
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">cases</span>
  <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound">i</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i</span></sub><span class="hidden">⇙</span>"</span></span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹eval <span class="free">c</span> <span class="free">t</span> <span class="free">t'</span> <span class="free">n</span> <span class="main">(</span><span class="keyword1">◇<span class="hidden">⇩</span><sub>b</sub></span><span class="main">(</span><span class="free">γ</span><span class="main">)</span><span class="main">)</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"eval <span class="free">c</span> <span class="free">t</span> <span class="free">t'</span> <span class="free">n</span> <span class="main">(</span><span class="main">λ</span><span class="bound">t</span> <span class="bound">n</span><span class="main">.</span> <span class="main">∃</span><span class="bound"><span class="bound">n'</span></span><span class="main">≥</span><span class="bound">n</span><span class="main">.</span> <span class="free">γ</span> <span class="bound">t</span> <span class="bound">n'</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> evt_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound"><span class="bound">n'</span></span><span class="main">≥</span><span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span>↓<span class="hidden">⇘</span><sub><span class="free">t</span></sub><span class="hidden">⇙</span><span class="free">n</span><span class="main">.</span> <span class="free">γ</span> <span class="main">(</span>lnth <span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span>inf_llist <span class="free">t</span> <span class="keyword1">@<span class="hidden">⇩</span><sub>l</sub></span> inf_llist <span class="free">t'</span><span class="main">)</span><span class="main">)</span> <span class="bound">n'</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> validCE_cont<span class="main">[</span><span class="keyword2"><span class="keyword"><span class="operator">where</span></span></span> γ<span class="main"><span class="main">=</span></span><span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">λ</span><span class="bound">t</span> <span class="bound">n</span><span class="main">.</span> <span class="main">∃</span><span class="bound"><span class="bound">n'</span></span><span class="main">≥</span><span class="bound">n</span><span class="main">.</span> <span class="free">γ</span> <span class="bound">t</span> <span class="bound">n'</span><span class="main">)</span>"</span></span><span class="main">]</span> <span class="quoted"><span class="quoted">‹<span class="main">¬</span><span class="main">(</span><span class="main">∃</span><span class="bound"><span class="bound">i</span></span><span class="main">≥</span><span class="free">n</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i</span></sub><span class="hidden">⇙</span><span class="main">)</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">x</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span><span class="main">≥</span><span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span>↓<span class="hidden">⇘</span><sub><span class="free">t</span></sub><span class="hidden">⇙</span><span class="main">(</span><span class="free">n</span><span class="main">)</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">" <span class="free">γ</span> <span class="main">(</span>lnth <span class="main">(</span><span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>inf_llist <span class="free">t</span><span class="main">)</span><span class="main">)</span> <span class="keyword1">@<span class="hidden">⇩</span><sub>l</sub></span> <span class="main">(</span>inf_llist <span class="free">t'</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="skolem">x</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"the_enat <span class="main">(</span>llength <span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>inf_llist <span class="free">t</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">-</span> <span class="main">1</span> <span class="main">&lt;</span> <span class="skolem">x</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">⟨</span><span class="free">c</span> <span class="main">∧</span> <span class="free">t</span><span class="main">⟩</span> <span class="main">&lt;</span> <span class="free">n</span>"</span></span>
    <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">rule</span> ccontr<span class="main">)</span>
      <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span><span class="main">⟨</span><span class="free">c</span> <span class="main">∧</span> <span class="free">t</span><span class="main">⟩</span> <span class="main">&lt;</span> <span class="free">n</span>"</span></span>
      <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="main">⟨</span><span class="free">c</span> <span class="main">∧</span> <span class="free">t</span><span class="main">⟩</span> <span class="main">≥</span> <span class="free">n</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
      <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="main">∃</span><span class="bound">i</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i</span></sub><span class="hidden">⇙</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="main">¬</span> <span class="main">(</span><span class="main">∃</span><span class="bound"><span class="bound">i</span></span><span class="main">≥</span><span class="free">n</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i</span></sub><span class="hidden">⇙</span><span class="main">)</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="main">⟨</span><span class="free">c</span> <span class="main">∧</span> <span class="free">t</span><span class="main">⟩</span></sub><span class="hidden">⇙</span>"</span></span>
        <span class="keyword1"><span class="command">using</span></span> lActive_active less_or_eq_imp_le <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
      <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted">False</span> <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="main">¬</span> <span class="main">(</span><span class="main">∃</span><span class="bound"><span class="bound">i</span></span><span class="main">≥</span><span class="free">n</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i</span></sub><span class="hidden">⇙</span><span class="main">)</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">qed</span></span>
    <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"the_enat <span class="main">(</span>llength <span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>inf_llist <span class="free">t</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">-</span> <span class="main">1</span> <span class="main">&lt;</span> <span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span>↓<span class="hidden">⇘</span><sub><span class="free">t</span></sub><span class="hidden">⇙</span><span class="main">(</span><span class="free">n</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> cnf2bhv_greater_llength <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">with</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">x</span><span class="main">≥</span><span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span>↓<span class="hidden">⇘</span><sub><span class="free">t</span></sub><span class="hidden">⇙</span><span class="main">(</span><span class="free">n</span><span class="main">)</span>›</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">=</span> <span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span>↓<span class="hidden">⇘</span><sub><span class="free">t</span></sub><span class="hidden">⇙</span><span class="main">(</span><span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span>↑<span class="hidden">⇘</span><sub><span class="free">t</span></sub><span class="hidden">⇙</span><span class="main">(</span><span class="skolem">x</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> cnf2bhv_bhv2cnf <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">γ</span> <span class="main">(</span>lnth <span class="main">(</span><span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>inf_llist <span class="free">t</span><span class="main">)</span><span class="main">)</span> <span class="keyword1">@<span class="hidden">⇩</span><sub>l</sub></span> <span class="main">(</span>inf_llist <span class="free">t'</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">(</span><span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span>↓<span class="hidden">⇘</span><sub><span class="free">t</span></sub><span class="hidden">⇙</span><span class="main">(</span><span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span>↑<span class="hidden">⇘</span><sub><span class="free">t</span></sub><span class="hidden">⇙</span><span class="main">(</span><span class="skolem">x</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="main">¬</span><span class="main">(</span><span class="main">∃</span><span class="bound"><span class="bound">i</span></span><span class="main">≥</span><span class="free">n</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i</span></sub><span class="hidden">⇙</span><span class="main">)</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span><span class="main">(</span><span class="main">∃</span><span class="bound"><span class="bound">i</span></span><span class="main">≥</span><span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span>↑<span class="hidden">⇘</span><sub><span class="free">t</span></sub><span class="hidden">⇙</span><span class="main">(</span><span class="skolem">x</span><span class="main">)</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i</span></sub><span class="hidden">⇙</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
    <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="main">¬</span><span class="main">(</span><span class="main">∃</span><span class="bound"><span class="bound">i</span></span><span class="main">≥</span><span class="free">n</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i</span></sub><span class="hidden">⇙</span><span class="main">)</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"lfinite <span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>inf_llist <span class="free">t</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> proj_finite2 <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">z</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound"><span class="bound">n''</span></span><span class="main">&gt;</span><span class="skolem">z</span><span class="main">.</span> <span class="main">¬</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">n''</span></sub><span class="hidden">⇙</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> proj_finite_bound <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
    <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹the_enat <span class="main">(</span>llength <span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>inf_llist <span class="free">t</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">-</span> <span class="main">1</span> <span class="main">&lt;</span> <span class="skolem">x</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">⟨</span><span class="free">c</span> <span class="main">∧</span> <span class="free">t</span><span class="main">⟩</span> <span class="main">&lt;</span> <span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span>↑<span class="hidden">⇘</span><sub><span class="free">t</span></sub><span class="hidden">⇙</span><span class="main">(</span><span class="skolem">x</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> bhv2cnf_greater_lActive <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> lActive_greater_active_all <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">qed</span></span>      
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"eval <span class="free">c</span> <span class="free">t</span> <span class="free">t'</span> <span class="main">(</span><span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span>↑<span class="hidden">⇘</span><sub><span class="free">t</span></sub><span class="hidden">⇙</span><span class="skolem">x</span><span class="main">)</span> <span class="free">γ</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> validCI_cont<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="free">c</span></span> <span class="quoted"><span class="free">t</span></span> <span class="quoted"><span class="quoted">"<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span>↑<span class="hidden">⇘</span><sub><span class="free">t</span></sub><span class="hidden">⇙</span><span class="main">(</span><span class="skolem">x</span><span class="main">)</span>"</span></span> <span class="quoted"><span class="free">γ</span></span><span class="main">]</span> <span class="quoted"><span class="quoted">‹<span class="main">∃</span><span class="bound">i</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i</span></sub><span class="hidden">⇙</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="main">∃</span><span class="bound">i</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i</span></sub><span class="hidden">⇙</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="main">¬</span><span class="main">(</span><span class="main">∃</span><span class="bound"><span class="bound">i</span></span><span class="main">≥</span><span class="free">n</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i</span></sub><span class="hidden">⇙</span><span class="main">)</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">⟨</span><span class="free">c</span> <span class="main">∧</span> <span class="free">t</span><span class="main">⟩</span> <span class="main">≤</span> <span class="free">n</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> lActive_less<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="free">c</span></span> <span class="quoted"><span class="free">t</span></span> <span class="main">_</span> <span class="quoted"><span class="free">n</span></span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">with</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">x</span><span class="main">≥</span><span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span>↓<span class="hidden">⇘</span><sub><span class="free">t</span></sub><span class="hidden">⇙</span><span class="main">(</span><span class="free">n</span><span class="main">)</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">n</span> <span class="main">≤</span> <span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span>↑<span class="hidden">⇘</span><sub><span class="free">t</span></sub><span class="hidden">⇙</span><span class="main">(</span><span class="skolem">x</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> p2c_mono_c2p <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>  
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">next</span></span>
  <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span><span class="main">(</span><span class="main">∃</span><span class="bound">i</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i</span></sub><span class="hidden">⇙</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹eval <span class="free">c</span> <span class="free">t</span> <span class="free">t'</span> <span class="free">n</span> <span class="main">(</span><span class="keyword1">◇<span class="hidden">⇩</span><sub>b</sub></span><span class="main">(</span><span class="free">γ</span><span class="main">)</span><span class="main">)</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"eval <span class="free">c</span> <span class="free">t</span> <span class="free">t'</span> <span class="free">n</span> <span class="main">(</span><span class="main">λ</span><span class="bound">t</span> <span class="bound">n</span><span class="main">.</span> <span class="main">∃</span><span class="bound"><span class="bound">n'</span></span><span class="main">≥</span><span class="bound">n</span><span class="main">.</span> <span class="free">γ</span> <span class="bound">t</span> <span class="bound">n'</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> evt_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">n'</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">n'</span><span class="main">≥</span><span class="free">n</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">γ</span> <span class="main">(</span>lnth <span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span>inf_llist <span class="free">t</span> <span class="keyword1">@<span class="hidden">⇩</span><sub>l</sub></span> inf_llist <span class="free">t'</span><span class="main">)</span><span class="main">)</span> <span class="skolem">n'</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="main">¬</span><span class="main">(</span><span class="main">∃</span><span class="bound">i</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i</span></sub><span class="hidden">⇙</span><span class="main">)</span>›</span></span> validCE_not_act<span class="main">[</span><span class="keyword2"><span class="keyword"><span class="operator">where</span></span></span> γ<span class="main"><span class="main">=</span></span><span class="quoted"><span class="quoted">"<span class="main">λ</span><span class="bound">t</span> <span class="bound">n</span><span class="main">.</span> <span class="main">∃</span><span class="bound"><span class="bound">n'</span></span><span class="main">≥</span><span class="bound">n</span><span class="main">.</span> <span class="free">γ</span> <span class="bound">t</span> <span class="bound">n'</span>"</span></span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">with</span></span> <span class="quoted"><span class="quoted">‹<span class="main">¬</span><span class="main">(</span><span class="main">∃</span><span class="bound">i</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i</span></sub><span class="hidden">⇙</span><span class="main">)</span>›</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> validCI_not_act<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="free">c</span></span> <span class="quoted"><span class="free">t</span></span> <span class="quoted"><span class="free">γ</span></span> <span class="quoted"><span class="free">t'</span></span> <span class="quoted"><span class="skolem">n'</span></span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
<span class="keyword1"><span class="command">qed</span></span>    

<span class="keyword1"><span class="command">subsubsection</span></span> <span class="quoted"><span class="plain_text">"Globally Operator"</span></span>

<span class="keyword1"><span class="command">definition</span></span> <span class="entity">glob</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="tfree">'cmp</span> bta<span class="main">)</span> <span class="main">⇒</span> <span class="main">(</span><span class="tfree">'cmp</span> bta<span class="main">)</span>"</span></span> <span class="main">(</span><span class="quoted">"<span class="keyword1">□<span class="hidden">⇩</span><sub>b</sub></span><span class="keyword3">(</span>_<span class="keyword3">)</span>"</span> 22<span class="main">)</span>
  <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1"><span class="free">□<span class="hidden">⇩</span><sub>b</sub></span></span><span class="main">(</span><span class="free"><span class="bound"><span class="entity">γ</span></span></span><span class="main">)</span> <span class="main">≡</span> <span class="main">λ</span> <span class="bound">t</span> <span class="bound">n</span><span class="main">.</span> <span class="main">∀</span><span class="bound"><span class="bound">n'</span></span><span class="main">≥</span><span class="bound">n</span><span class="main">.</span> <span class="free"><span class="bound"><span class="entity">γ</span></span></span> <span class="bound">t</span> <span class="bound">n'</span>"</span></span>
    
<span class="keyword1" id="Dynamic_Architecture_Calculus-globIA"><span class="command">lemma</span></span> globIA<span class="main">[</span><span class="operator">intro</span><span class="main">]</span><span class="main">:</span>
  <span class="keyword2"><span class="keyword">fixes</span></span> <span class="free">c</span><span class="main">::</span><span class="tfree"><span class="quoted"><span class="tfree">'id</span></span></span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="free">t</span><span class="main">::</span><span class="quoted"><span class="quoted">"nat <span class="main">⇒</span> cnf"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="free">t'</span><span class="main">::</span><span class="quoted"><span class="quoted">"nat <span class="main">⇒</span> <span class="tfree">'cmp</span>"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="free">n</span><span class="main">::</span><span class="quoted">nat</span>  
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound"><span class="bound">i</span></span><span class="main">≥</span><span class="free">n</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i</span></sub><span class="hidden">⇙</span>"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">⋀</span><span class="bound">n'</span><span class="main">.</span> <span class="main">⟦</span><span class="main">∃</span><span class="bound"><span class="bound">i</span></span><span class="main">≥</span><span class="bound">n'</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i</span></sub><span class="hidden">⇙</span><span class="main">;</span> <span class="bound">n'</span><span class="main">≥</span><span class="main">⟨</span><span class="free">c</span> <span class="main">→</span> <span class="free">t</span>⟩<span class="hidden">⇘</span><sub><span class="free">n</span></sub><span class="hidden">⇙</span><span class="main">⟧</span> <span class="main">⟹</span> <span class="main">∃</span><span class="bound"><span class="bound">n''</span></span><span class="main">≥</span><span class="main">⟨</span><span class="free">c</span> <span class="main">⇐</span> <span class="free">t</span>⟩<span class="hidden">⇘</span><sub><span class="bound">n'</span></sub><span class="hidden">⇙</span><span class="main">.</span> <span class="bound">n''</span><span class="main">≤</span><span class="main">⟨</span><span class="free">c</span> <span class="main">→</span> <span class="free">t</span>⟩<span class="hidden">⇘</span><sub><span class="bound">n'</span></sub><span class="hidden">⇙</span> <span class="main">∧</span> eval <span class="free">c</span> <span class="free">t</span> <span class="free">t'</span> <span class="bound">n''</span> <span class="free">γ</span>"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">⋀</span><span class="bound">n'</span><span class="main">.</span> <span class="main">⟦</span><span class="main">¬</span><span class="main">(</span><span class="main">∃</span><span class="bound"><span class="bound">i</span></span><span class="main">≥</span><span class="bound">n'</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i</span></sub><span class="hidden">⇙</span><span class="main">)</span><span class="main">;</span> <span class="bound">n'</span><span class="main">≥</span><span class="main">⟨</span><span class="free">c</span> <span class="main">→</span> <span class="free">t</span>⟩<span class="hidden">⇘</span><sub><span class="free">n</span></sub><span class="hidden">⇙</span><span class="main">⟧</span> <span class="main">⟹</span> eval <span class="free">c</span> <span class="free">t</span> <span class="free">t'</span> <span class="bound">n'</span> <span class="free">γ</span>"</span></span> 
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"eval <span class="free">c</span> <span class="free">t</span> <span class="free">t'</span> <span class="free">n</span> <span class="main">(</span><span class="keyword1">□<span class="hidden">⇩</span><sub>b</sub></span><span class="main">(</span><span class="free">γ</span><span class="main">)</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound"><span class="bound">n'</span></span><span class="main">≥</span>the_enat <span class="main">⟨</span><span class="free">c</span> #<span class="hidden">⇘</span><sub>enat <span class="free">n</span></sub><span class="hidden">⇙</span>inf_llist <span class="free">t</span><span class="main">⟩</span><span class="main">.</span> <span class="free">γ</span> <span class="main">(</span>lnth <span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span>inf_llist <span class="free">t</span> <span class="keyword1">@<span class="hidden">⇩</span><sub>l</sub></span> inf_llist <span class="free">t'</span><span class="main">)</span><span class="main">)</span> <span class="bound">n'</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span>
    <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">x</span><span class="main">::</span><span class="quoted">nat</span> <span class="keyword3"><span class="command">show</span></span>
      <span class="quoted"><span class="quoted">"<span class="skolem">x</span><span class="main">≥</span>the_enat <span class="main">(</span><span class="main">⟨</span><span class="free">c</span> #<span class="hidden">⇘</span><sub><span class="free">n</span></sub><span class="hidden">⇙</span> inf_llist <span class="free">t</span><span class="main">⟩</span><span class="main">)</span> <span class="main">⟶</span> <span class="free">γ</span> <span class="main">(</span>lnth <span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span>inf_llist <span class="free">t</span> <span class="keyword1">@<span class="hidden">⇩</span><sub>l</sub></span> inf_llist <span class="free">t'</span><span class="main">)</span><span class="main">)</span> <span class="skolem">x</span>"</span></span>
    <span class="keyword1"><span class="command">proof</span></span>
      <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span><span class="main">≥</span>the_enat <span class="main">(</span><span class="main">⟨</span><span class="free">c</span> #<span class="hidden">⇘</span><sub><span class="free">n</span></sub><span class="hidden">⇙</span> inf_llist <span class="free">t</span><span class="main">⟩</span><span class="main">)</span>"</span></span>
      <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="free">γ</span> <span class="main">(</span>lnth <span class="main">(</span><span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>inf_llist <span class="free">t</span><span class="main">)</span><span class="main">)</span> <span class="keyword1">@<span class="hidden">⇩</span><sub>l</sub></span> <span class="main">(</span>inf_llist <span class="free">t'</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="skolem">x</span>"</span></span>
      <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">cases</span><span class="main">)</span>
        <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">x</span> <span class="main">≥</span> llength <span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>inf_llist <span class="free">t</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span>
        <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"lfinite <span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>inf_llist <span class="free">t</span><span class="main">)</span><span class="main">)</span>"</span></span>
          <span class="keyword1"><span class="command">using</span></span> llength_geq_enat_lfiniteD<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="quoted">"π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>inf_llist <span class="free">t</span><span class="main">)</span>"</span></span> <span class="quoted"><span class="skolem">x</span></span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
        <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">z</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound"><span class="bound">n''</span></span><span class="main">&gt;</span><span class="skolem">z</span><span class="main">.</span> <span class="main">¬</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">n''</span></sub><span class="hidden">⇙</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> proj_finite_bound <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
        <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="main">⟨</span><span class="free">c</span> <span class="main">→</span> <span class="free">t</span>⟩<span class="hidden">⇘</span><sub><span class="free">n</span></sub><span class="hidden">⇙</span></sub><span class="hidden">⇙</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> <span class="quoted"><span class="quoted">‹<span class="main">∃</span><span class="bound"><span class="bound">i</span></span><span class="main">≥</span><span class="free">n</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i</span></sub><span class="hidden">⇙</span>›</span></span> nxtActI<span class="main">)</span>
        <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">⟨</span><span class="free">c</span> <span class="main">∧</span> <span class="free">t</span><span class="main">⟩</span><span class="main">≥</span><span class="main">⟨</span><span class="free">c</span> <span class="main">→</span> <span class="free">t</span>⟩<span class="hidden">⇘</span><sub><span class="free">n</span></sub><span class="hidden">⇙</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> lActive_greatest<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="free">c</span></span> <span class="quoted"><span class="free">t</span></span> <span class="quoted"><span class="quoted">"<span class="main">⟨</span><span class="free">c</span> <span class="main">→</span> <span class="free">t</span>⟩<span class="hidden">⇘</span><sub><span class="free">n</span></sub><span class="hidden">⇙</span>"</span></span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
        <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span>↑<span class="hidden">⇘</span><sub><span class="free">t</span></sub><span class="hidden">⇙</span><span class="main">(</span><span class="skolem">x</span><span class="main">)</span> <span class="main">≥</span> <span class="main">⟨</span><span class="free">c</span> <span class="main">∧</span> <span class="free">t</span><span class="main">⟩</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
        <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span>↑<span class="hidden">⇘</span><sub><span class="free">t</span></sub><span class="hidden">⇙</span><span class="main">(</span><span class="skolem">x</span><span class="main">)</span> <span class="main">≥</span> <span class="main">⟨</span><span class="free">c</span> <span class="main">→</span> <span class="free">t</span>⟩<span class="hidden">⇘</span><sub><span class="free">n</span></sub><span class="hidden">⇙</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">arith</span>
        <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> <span class="main">(</span><span class="main">∃</span><span class="bound"><span class="bound">i'</span></span><span class="main">≥</span><span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span>↑<span class="hidden">⇘</span><sub><span class="free">t</span></sub><span class="hidden">⇙</span><span class="main">(</span><span class="skolem">x</span><span class="main">)</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i'</span></sub><span class="hidden">⇙</span><span class="main">)</span>"</span></span>
        <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
          <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹lfinite <span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>inf_llist <span class="free">t</span><span class="main">)</span><span class="main">)</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="main">∃</span><span class="bound"><span class="bound">i</span></span><span class="main">≥</span><span class="free">n</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i</span></sub><span class="hidden">⇙</span>›</span></span>
            <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span>↑<span class="hidden">⇘</span><sub><span class="free">t</span></sub><span class="hidden">⇙</span><span class="main">(</span>the_enat <span class="main">(</span>llength <span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>inf_llist <span class="free">t</span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> Suc <span class="main">(</span><span class="main">⟨</span><span class="free">c</span> <span class="main">∧</span> <span class="free">t</span><span class="main">⟩</span><span class="main">)</span>"</span></span>
            <span class="keyword1"><span class="command">using</span></span> bhv2cnf_lActive <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
          <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="main">(</span><span class="skolem">x</span> <span class="main">≥</span> llength <span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>inf_llist <span class="free">t</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">≥</span> the_enat<span class="main">(</span>llength <span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>inf_llist <span class="free">t</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span>
            <span class="keyword1"><span class="command">using</span></span> the_enat_mono <span class="keyword1"><span class="command">by</span></span> <span class="operator">fastforce</span>
          <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span>↑<span class="hidden">⇘</span><sub><span class="free">t</span></sub><span class="hidden">⇙</span><span class="main">(</span><span class="skolem">x</span><span class="main">)</span> <span class="main">≥</span> <span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span>↑<span class="hidden">⇘</span><sub><span class="free">t</span></sub><span class="hidden">⇙</span><span class="main">(</span>the_enat <span class="main">(</span>llength <span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>inf_llist <span class="free">t</span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span>
            <span class="keyword1"><span class="command">using</span></span> bhv2cnf_mono<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="quoted">"the_enat <span class="main">(</span>llength <span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>inf_llist <span class="free">t</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="quoted"><span class="skolem">x</span></span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
          <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span>↑<span class="hidden">⇘</span><sub><span class="free">t</span></sub><span class="hidden">⇙</span><span class="main">(</span><span class="skolem">x</span><span class="main">)</span> <span class="main">≥</span> Suc <span class="main">(</span><span class="main">⟨</span><span class="free">c</span> <span class="main">∧</span> <span class="free">t</span><span class="main">⟩</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
          <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span>↑<span class="hidden">⇘</span><sub><span class="free">t</span></sub><span class="hidden">⇙</span><span class="main">(</span><span class="skolem">x</span><span class="main">)</span> <span class="main">&gt;</span> <span class="main">⟨</span><span class="free">c</span> <span class="main">∧</span> <span class="free">t</span><span class="main">⟩</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
          <span class="keyword1"><span class="command">with</span></span> <span class="quoted"><span class="quoted">‹<span class="main">∀</span><span class="bound"><span class="bound">n''</span></span><span class="main">&gt;</span><span class="skolem">z</span><span class="main">.</span> <span class="main">¬</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">n''</span></sub><span class="hidden">⇙</span>›</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> lActive_greater_active_all <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
        <span class="keyword1"><span class="command">qed</span></span>
        <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"eval <span class="free">c</span> <span class="free">t</span> <span class="free">t'</span> <span class="main">(</span><span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span>↑<span class="hidden">⇘</span><sub><span class="free">t</span></sub><span class="hidden">⇙</span><span class="main">(</span><span class="skolem">x</span><span class="main">)</span><span class="main">)</span> <span class="free">γ</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>3<span class="main">)</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
        <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="free">γ</span> <span class="main">(</span>lnth <span class="main">(</span><span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>inf_llist <span class="free">t</span><span class="main">)</span><span class="main">)</span> <span class="keyword1">@<span class="hidden">⇩</span><sub>l</sub></span> <span class="main">(</span>inf_llist <span class="free">t'</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">(</span><span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span>↓<span class="hidden">⇘</span><sub><span class="free">t</span></sub><span class="hidden">⇙</span><span class="main">(</span><span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span>↑<span class="hidden">⇘</span><sub><span class="free">t</span></sub><span class="hidden">⇙</span><span class="main">(</span><span class="skolem">x</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span>
          <span class="keyword1"><span class="command">using</span></span> validCE_cont<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="free">c</span></span> <span class="quoted"><span class="free">t</span></span> <span class="quoted"><span class="quoted">"<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span>↑<span class="hidden">⇘</span><sub><span class="free">t</span></sub><span class="hidden">⇙</span><span class="main">(</span><span class="skolem">x</span><span class="main">)</span>"</span></span> <span class="quoted"><span class="free">t'</span></span> <span class="quoted"><span class="free">γ</span></span><span class="main">]</span> <span class="quoted"><span class="quoted">‹<span class="main">∃</span><span class="bound"><span class="bound">i</span></span><span class="main">≥</span><span class="free">n</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i</span></sub><span class="hidden">⇙</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="main">¬</span> <span class="main">(</span><span class="main">∃</span><span class="bound"><span class="bound">i'</span></span><span class="main">≥</span><span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span>↑<span class="hidden">⇘</span><sub><span class="free">t</span></sub><span class="hidden">⇙</span><span class="main">(</span><span class="skolem">x</span><span class="main">)</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i'</span></sub><span class="hidden">⇙</span><span class="main">)</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
        <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="main">(</span><span class="skolem">x</span> <span class="main">≥</span> llength <span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>inf_llist <span class="free">t</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>›</span></span>
          <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span>enat <span class="skolem">x</span> <span class="main">≥</span> llength <span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>inf_llist <span class="free">t</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword1"><span class="command">with</span></span> <span class="quoted"><span class="quoted">‹lfinite <span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>inf_llist <span class="free">t</span><span class="main">)</span><span class="main">)</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"llength <span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>inf_llist <span class="free">t</span><span class="main">)</span><span class="main">)</span><span class="main">≠</span><span class="main">∞</span>"</span></span>
          <span class="keyword1"><span class="command">using</span></span> llength_eq_infty_conv_lfinite <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword1"><span class="command">with</span></span> <span class="quoted"><span class="quoted">‹<span class="main">(</span><span class="skolem">x</span> <span class="main">≥</span> llength <span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>inf_llist <span class="free">t</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>›</span></span>
          <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"the_enat<span class="main">(</span>llength <span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>inf_llist <span class="free">t</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">-</span> <span class="main">1</span> <span class="main">≤</span> <span class="skolem">x</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> cnf2bhv_bhv2cnf<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="free">c</span></span> <span class="quoted"><span class="free">t</span></span> <span class="quoted"><span class="skolem">x</span></span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
      <span class="keyword1"><span class="command">next</span></span>
        <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span><span class="main">(</span><span class="skolem">x</span> <span class="main">≥</span> llength <span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>inf_llist <span class="free">t</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span>
        <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span><span class="main">&lt;</span>llength <span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>inf_llist <span class="free">t</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
        <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">n'</span></span><span class="main">::</span><span class="quoted">nat</span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span><span class="main">=</span><span class="main">⟨</span><span class="free">c</span> #<span class="hidden">⇘</span><sub><span class="skolem">n'</span></sub><span class="hidden">⇙</span> inf_llist <span class="free">t</span><span class="main">⟩</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> nAct_exists <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
        <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹enat <span class="skolem">x</span> <span class="main">&lt;</span> llength <span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>inf_llist <span class="free">t</span><span class="main">)</span><span class="main">)</span>›</span></span> <span class="quoted"><span class="quoted">‹enat <span class="skolem">x</span> <span class="main">=</span> <span class="main">⟨</span><span class="free">c</span> #<span class="hidden">⇘</span><sub>enat <span class="skolem">n'</span></sub><span class="hidden">⇙</span> inf_llist <span class="free">t</span><span class="main">⟩</span>›</span></span>
          <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound"><span class="bound">i</span></span><span class="main">≥</span><span class="skolem">n'</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i</span></sub><span class="hidden">⇙</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> nAct_less_llength_active <span class="keyword1"><span class="command">by</span></span> <span class="operator">force</span>
        <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">i</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">i</span><span class="main">≥</span><span class="skolem">n'</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="skolem">i</span></sub><span class="hidden">⇙</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> <span class="main">(</span><span class="main">∃</span><span class="bound"><span class="bound">k</span></span><span class="main">≥</span><span class="skolem">n'</span><span class="main">.</span> <span class="bound">k</span> <span class="main">&lt;</span> <span class="skolem">i</span> <span class="main">∧</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">k</span></sub><span class="hidden">⇙</span><span class="main">)</span>"</span></span>
          <span class="keyword1"><span class="command">using</span></span> nact_exists <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
        <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"enat <span class="skolem">i</span> <span class="main">-</span> <span class="main">1</span> <span class="main">&lt;</span> llength <span class="main">(</span>inf_llist <span class="free">t</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> one_enat_def<span class="main">)</span>
        <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span><span class="main">=</span><span class="main">⟨</span><span class="free">c</span> #<span class="hidden">⇘</span><sub><span class="skolem">i</span></sub><span class="hidden">⇙</span> inf_llist <span class="free">t</span><span class="main">⟩</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> one_enat_def nAct_not_active_same <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
        <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">⟨</span><span class="free">c</span> #<span class="hidden">⇘</span><sub><span class="skolem">i</span></sub><span class="hidden">⇙</span> inf_llist <span class="free">t</span><span class="main">⟩</span><span class="main">≠</span><span class="main">∞</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
        <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span><span class="main">=</span>the_enat<span class="main">(</span><span class="main">⟨</span><span class="free">c</span> #<span class="hidden">⇘</span><sub><span class="skolem">i</span></sub><span class="hidden">⇙</span> inf_llist <span class="free">t</span><span class="main">⟩</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">fastforce</span>
        <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">x</span><span class="main">≥</span>the_enat <span class="main">(</span><span class="main">⟨</span><span class="free">c</span> #<span class="hidden">⇘</span><sub><span class="free">n</span></sub><span class="hidden">⇙</span> inf_llist <span class="free">t</span><span class="main">⟩</span><span class="main">)</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">x</span><span class="main">=</span>the_enat<span class="main">(</span><span class="main">⟨</span><span class="free">c</span> #<span class="hidden">⇘</span><sub><span class="skolem">i</span></sub><span class="hidden">⇙</span> inf_llist <span class="free">t</span><span class="main">⟩</span><span class="main">)</span>›</span></span>
        <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"the_enat <span class="main">(</span><span class="main">⟨</span><span class="free">c</span> #<span class="hidden">⇘</span><sub><span class="skolem">i</span></sub><span class="hidden">⇙</span> inf_llist <span class="free">t</span><span class="main">⟩</span><span class="main">)</span><span class="main">≥</span>the_enat <span class="main">(</span><span class="main">⟨</span><span class="free">c</span> #<span class="hidden">⇘</span><sub><span class="free">n</span></sub><span class="hidden">⇙</span> inf_llist <span class="free">t</span><span class="main">⟩</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
        <span class="keyword1"><span class="command">with</span></span> <span class="quoted"><span class="quoted">‹<span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="skolem">i</span></sub><span class="hidden">⇙</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">i</span><span class="main">≥</span><span class="main">⟨</span><span class="free">c</span> <span class="main">→</span> <span class="free">t</span>⟩<span class="hidden">⇘</span><sub><span class="free">n</span></sub><span class="hidden">⇙</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> active_geq_nxtAct <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
        <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">x</span><span class="main">=</span><span class="main">⟨</span><span class="free">c</span> #<span class="hidden">⇘</span><sub><span class="skolem">i</span></sub><span class="hidden">⇙</span> inf_llist <span class="free">t</span><span class="main">⟩</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">x</span> <span class="main">&lt;</span> llength <span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>inf_llist <span class="free">t</span><span class="main">)</span><span class="main">)</span>›</span></span>
          <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound">i'</span><span class="main">.</span> <span class="skolem">i</span> <span class="main">≤</span> enat <span class="bound">i'</span> <span class="main">∧</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i'</span></sub><span class="hidden">⇙</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> nAct_less_llength_active<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="skolem">x</span></span> <span class="quoted"><span class="free">c</span></span> <span class="quoted"><span class="quoted">"inf_llist <span class="free">t</span>"</span></span> <span class="quoted"><span class="skolem">i</span></span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
        <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound"><span class="bound">i'</span></span><span class="main">≥</span><span class="skolem">i</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i'</span></sub><span class="hidden">⇙</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
        <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">n''</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"eval <span class="free">c</span> <span class="free">t</span> <span class="free">t'</span> <span class="skolem">n''</span> <span class="free">γ</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">n''</span><span class="main">≥</span><span class="main">⟨</span><span class="free">c</span> <span class="main">⇐</span> <span class="free">t</span>⟩<span class="hidden">⇘</span><sub><span class="skolem">i</span></sub><span class="hidden">⇙</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">n''</span><span class="main">≤</span><span class="main">⟨</span><span class="free">c</span> <span class="main">→</span> <span class="free">t</span>⟩<span class="hidden">⇘</span><sub><span class="skolem">i</span></sub><span class="hidden">⇙</span>"</span></span>
          <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>2<span class="main">)</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
        <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound"><span class="bound">i'</span></span><span class="main">≥</span><span class="skolem">n''</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i'</span></sub><span class="hidden">⇙</span>"</span></span>
          <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="skolem">i</span></sub><span class="hidden">⇙</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">n''</span><span class="main">≤</span><span class="main">⟨</span><span class="free">c</span> <span class="main">→</span> <span class="free">t</span>⟩<span class="hidden">⇘</span><sub><span class="skolem">i</span></sub><span class="hidden">⇙</span>›</span></span> less_or_eq_imp_le nxtAct_active <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">γ</span> <span class="main">(</span>lnth <span class="main">(</span><span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>inf_llist <span class="free">t</span><span class="main">)</span><span class="main">)</span> <span class="keyword1">@<span class="hidden">⇩</span><sub>l</sub></span> <span class="main">(</span>inf_llist <span class="free">t'</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">(</span>the_enat <span class="main">(</span><span class="main">⟨</span><span class="free">c</span> #<span class="hidden">⇘</span><sub><span class="skolem">n''</span></sub><span class="hidden">⇙</span> inf_llist <span class="free">t</span><span class="main">⟩</span><span class="main">)</span><span class="main">)</span>"</span></span>
          <span class="keyword1"><span class="command">using</span></span> validCE_act<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="skolem">n''</span></span> <span class="quoted"><span class="free">c</span></span> <span class="quoted"><span class="free">t</span></span> <span class="quoted"><span class="free">t'</span></span> <span class="quoted"><span class="free">γ</span></span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
        <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">n''</span><span class="main">≥</span><span class="main">⟨</span><span class="free">c</span> <span class="main">⇐</span> <span class="free">t</span>⟩<span class="hidden">⇘</span><sub><span class="skolem">i</span></sub><span class="hidden">⇙</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">n''</span><span class="main">≤</span><span class="main">⟨</span><span class="free">c</span> <span class="main">→</span> <span class="free">t</span>⟩<span class="hidden">⇘</span><sub><span class="skolem">i</span></sub><span class="hidden">⇙</span>›</span></span>
          <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"the_enat <span class="main">(</span><span class="main">⟨</span><span class="free">c</span> #<span class="hidden">⇘</span><sub><span class="skolem">n''</span></sub><span class="hidden">⇙</span> inf_llist <span class="free">t</span><span class="main">⟩</span><span class="main">)</span><span class="main">=</span>the_enat <span class="main">(</span><span class="main">⟨</span><span class="free">c</span> #<span class="hidden">⇘</span><sub><span class="skolem">i</span></sub><span class="hidden">⇙</span> inf_llist <span class="free">t</span><span class="main">⟩</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> nAct_same <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
        <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"the_enat <span class="main">(</span><span class="main">⟨</span><span class="free">c</span> #<span class="hidden">⇘</span><sub><span class="skolem">n''</span></sub><span class="hidden">⇙</span> inf_llist <span class="free">t</span><span class="main">⟩</span><span class="main">)</span> <span class="main">=</span> <span class="skolem">x</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">x</span> <span class="main">=</span> the_enat <span class="main">⟨</span><span class="free">c</span> #<span class="hidden">⇘</span><sub>enat <span class="skolem">i</span></sub><span class="hidden">⇙</span>inf_llist <span class="free">t</span><span class="main">⟩</span>›</span></span><span class="main">)</span>
        <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">γ</span> <span class="main">(</span>lnth <span class="main">(</span><span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>inf_llist <span class="free">t</span><span class="main">)</span><span class="main">)</span> <span class="keyword1">@<span class="hidden">⇩</span><sub>l</sub></span> <span class="main">(</span>inf_llist <span class="free">t'</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">(</span>the_enat <span class="skolem">x</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
        <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
      <span class="keyword1"><span class="command">qed</span></span>
    <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">with</span></span> <span class="quoted"><span class="quoted">‹<span class="main">∃</span><span class="bound"><span class="bound">i</span></span><span class="main">≥</span><span class="free">n</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i</span></sub><span class="hidden">⇙</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"eval <span class="free">c</span> <span class="free">t</span> <span class="free">t'</span> <span class="free">n</span> <span class="main">(</span><span class="main">λ</span><span class="bound">t</span> <span class="bound">n</span><span class="main">.</span> <span class="main">∀</span><span class="bound"><span class="bound">n'</span></span><span class="main">≥</span><span class="bound">n</span><span class="main">.</span> <span class="free">γ</span> <span class="bound">t</span> <span class="bound">n'</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> validCI_act<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="free">n</span></span> <span class="quoted"><span class="free">c</span></span> <span class="quoted"><span class="free">t</span></span> <span class="quoted"><span class="quoted">"<span class="main">λ</span> <span class="bound">t</span> <span class="bound">n</span><span class="main">.</span> <span class="main">∀</span><span class="bound"><span class="bound">n'</span></span><span class="main">≥</span><span class="bound">n</span><span class="main">.</span> <span class="free">γ</span> <span class="bound">t</span> <span class="bound">n'</span>"</span></span> <span class="quoted"><span class="free">t'</span></span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> glob_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>
  
<span class="keyword1" id="Dynamic_Architecture_Calculus-globIN"><span class="command">lemma</span></span> globIN<span class="main">[</span><span class="operator">intro</span><span class="main">]</span><span class="main">:</span>
  <span class="keyword2"><span class="keyword">fixes</span></span> <span class="free">c</span><span class="main">::</span><span class="tfree"><span class="quoted"><span class="tfree">'id</span></span></span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="free">t</span><span class="main">::</span><span class="quoted"><span class="quoted">"nat <span class="main">⇒</span> cnf"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="free">t'</span><span class="main">::</span><span class="quoted"><span class="quoted">"nat <span class="main">⇒</span> <span class="tfree">'cmp</span>"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="free">n</span><span class="main">::</span><span class="quoted">nat</span>  
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span><span class="main">(</span><span class="main">∃</span><span class="bound"><span class="bound">i</span></span><span class="main">≥</span><span class="free">n</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i</span></sub><span class="hidden">⇙</span><span class="main">)</span>"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">⋀</span><span class="bound">n'</span><span class="main">.</span> <span class="bound">n'</span><span class="main">≥</span><span class="free">n</span> <span class="main">⟹</span> eval <span class="free">c</span> <span class="free">t</span> <span class="free">t'</span> <span class="bound">n'</span> <span class="free">γ</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"eval <span class="free">c</span> <span class="free">t</span> <span class="free">t'</span> <span class="free">n</span> <span class="main">(</span><span class="keyword1">□<span class="hidden">⇩</span><sub>b</sub></span><span class="main">(</span><span class="free">γ</span><span class="main">)</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">cases</span>
  <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound">i</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i</span></sub><span class="hidden">⇙</span>"</span></span>    
  <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="main">¬</span><span class="main">(</span><span class="main">∃</span><span class="bound"><span class="bound">i</span></span><span class="main">≥</span><span class="free">n</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i</span></sub><span class="hidden">⇙</span><span class="main">)</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"lfinite <span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>inf_llist <span class="free">t</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> proj_finite2 <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">z</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound"><span class="bound">n''</span></span><span class="main">&gt;</span><span class="skolem">z</span><span class="main">.</span> <span class="main">¬</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">n''</span></sub><span class="hidden">⇙</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> proj_finite_bound <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
    
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound"><span class="bound">x</span></span><span class="main">::</span>nat<span class="main">≥</span> <span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span>↓<span class="hidden">⇘</span><sub><span class="free">t</span></sub><span class="hidden">⇙</span><span class="main">(</span><span class="free">n</span><span class="main">)</span><span class="main">.</span> <span class="free">γ</span> <span class="main">(</span>lnth <span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span>inf_llist <span class="free">t</span> <span class="keyword1">@<span class="hidden">⇩</span><sub>l</sub></span> inf_llist <span class="free">t'</span><span class="main">)</span><span class="main">)</span> <span class="bound">x</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span>
    <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">x</span><span class="main">::</span><span class="quoted">nat</span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">x</span><span class="main">≥</span><span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span>↓<span class="hidden">⇘</span><sub><span class="free">t</span></sub><span class="hidden">⇙</span><span class="main">(</span><span class="free">n</span><span class="main">)</span><span class="main">)</span> <span class="main">⟶</span> <span class="free">γ</span> <span class="main">(</span>lnth <span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span>inf_llist <span class="free">t</span> <span class="keyword1">@<span class="hidden">⇩</span><sub>l</sub></span> inf_llist <span class="free">t'</span><span class="main">)</span><span class="main">)</span> <span class="skolem">x</span>"</span></span>
    <span class="keyword1"><span class="command">proof</span></span>
      <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span><span class="main">≥</span><span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span>↓<span class="hidden">⇘</span><sub><span class="free">t</span></sub><span class="hidden">⇙</span><span class="main">(</span><span class="free">n</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="main">¬</span><span class="main">(</span><span class="main">∃</span><span class="bound"><span class="bound">i</span></span><span class="main">≥</span><span class="free">n</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i</span></sub><span class="hidden">⇙</span><span class="main">)</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">⟨</span><span class="free">c</span> <span class="main">∧</span> <span class="free">t</span><span class="main">⟩</span> <span class="main">≤</span> <span class="free">n</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="main">∃</span><span class="bound">i</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i</span></sub><span class="hidden">⇙</span>›</span></span> lActive_less <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span>↑<span class="hidden">⇘</span><sub><span class="free">t</span></sub><span class="hidden">⇙</span><span class="main">(</span><span class="skolem">x</span><span class="main">)</span> <span class="main">≥</span> <span class="free">n</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> p2c_mono_c2p <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
      <span class="keyword1"><span class="command">with</span></span> assms <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"eval <span class="free">c</span> <span class="free">t</span> <span class="free">t'</span> <span class="main">(</span><span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span>↑<span class="hidden">⇘</span><sub><span class="free">t</span></sub><span class="hidden">⇙</span><span class="main">(</span><span class="skolem">x</span><span class="main">)</span><span class="main">)</span> <span class="free">γ</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>    
      <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> <span class="main">(</span><span class="main">∃</span><span class="bound"><span class="bound">i'</span></span><span class="main">≥</span><span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span>↑<span class="hidden">⇘</span><sub><span class="free">t</span></sub><span class="hidden">⇙</span><span class="main">(</span><span class="skolem">x</span><span class="main">)</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i'</span></sub><span class="hidden">⇙</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
        <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹lfinite <span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>inf_llist <span class="free">t</span><span class="main">)</span><span class="main">)</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="main">∃</span><span class="bound">i</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i</span></sub><span class="hidden">⇙</span>›</span></span>
          <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span>↑<span class="hidden">⇘</span><sub><span class="free">t</span></sub><span class="hidden">⇙</span><span class="main">(</span>the_enat <span class="main">(</span>llength <span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>inf_llist <span class="free">t</span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> Suc <span class="main">(</span><span class="main">⟨</span><span class="free">c</span> <span class="main">∧</span> <span class="free">t</span><span class="main">⟩</span><span class="main">)</span>"</span></span>
          <span class="keyword1"><span class="command">using</span></span> bhv2cnf_lActive <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
        <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="main">¬</span><span class="main">(</span><span class="main">∃</span><span class="bound"><span class="bound">i</span></span><span class="main">≥</span><span class="free">n</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i</span></sub><span class="hidden">⇙</span><span class="main">)</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">n</span><span class="main">&gt;</span><span class="main">⟨</span><span class="free">c</span> <span class="main">∧</span> <span class="free">t</span><span class="main">⟩</span>"</span></span>
          <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">meson</span> <span class="quoted"><span class="quoted">‹<span class="main">∃</span><span class="bound">i</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i</span></sub><span class="hidden">⇙</span>›</span></span> lActive_active leI le_eq_less_or_eq<span class="main">)</span>
        <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="free">n</span><span class="main">≥</span>Suc <span class="main">(</span><span class="main">⟨</span><span class="free">c</span> <span class="main">∧</span> <span class="free">t</span><span class="main">⟩</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
        <span class="keyword1"><span class="command">with</span></span> <span class="quoted"><span class="quoted">‹<span class="free">n</span><span class="main">≥</span>Suc<span class="main">(</span><span class="main">⟨</span><span class="free">c</span> <span class="main">∧</span> <span class="free">t</span><span class="main">⟩</span><span class="main">)</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span>↑<span class="hidden">⇘</span><sub><span class="free">t</span></sub><span class="hidden">⇙</span><span class="main">(</span><span class="skolem">x</span><span class="main">)</span> <span class="main">≥</span> <span class="free">n</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span>↑<span class="hidden">⇘</span><sub><span class="free">t</span></sub><span class="hidden">⇙</span><span class="main">(</span><span class="skolem">x</span><span class="main">)</span> <span class="main">≥</span> Suc <span class="main">(</span><span class="main">⟨</span><span class="free">c</span> <span class="main">∧</span> <span class="free">t</span><span class="main">⟩</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
        <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span>↑<span class="hidden">⇘</span><sub><span class="free">t</span></sub><span class="hidden">⇙</span><span class="main">(</span><span class="skolem">x</span><span class="main">)</span> <span class="main">&gt;</span> <span class="main">⟨</span><span class="free">c</span> <span class="main">∧</span> <span class="free">t</span><span class="main">⟩</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
        <span class="keyword1"><span class="command">with</span></span> <span class="quoted"><span class="quoted">‹<span class="main">∀</span><span class="bound"><span class="bound">n''</span></span><span class="main">&gt;</span><span class="skolem">z</span><span class="main">.</span> <span class="main">¬</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">n''</span></sub><span class="hidden">⇙</span>›</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> lActive_greater_active_all <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
      <span class="keyword1"><span class="command">qed</span></span>
      <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">γ</span> <span class="main">(</span>lnth <span class="main">(</span><span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>inf_llist <span class="free">t</span><span class="main">)</span><span class="main">)</span> <span class="keyword1">@<span class="hidden">⇩</span><sub>l</sub></span> <span class="main">(</span>inf_llist <span class="free">t'</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">(</span><span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span>↓<span class="hidden">⇘</span><sub><span class="free">t</span></sub><span class="hidden">⇙</span><span class="main">(</span><span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span>↑<span class="hidden">⇘</span><sub><span class="free">t</span></sub><span class="hidden">⇙</span><span class="main">(</span><span class="skolem">x</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span>
        <span class="keyword1"><span class="command">using</span></span> validCE_cont<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="free">c</span></span> <span class="quoted"><span class="free">t</span></span> <span class="quoted"><span class="quoted">"<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span>↑<span class="hidden">⇘</span><sub><span class="free">t</span></sub><span class="hidden">⇙</span><span class="main">(</span><span class="skolem">x</span><span class="main">)</span>"</span></span> <span class="quoted"><span class="free">t'</span></span> <span class="quoted"><span class="free">γ</span></span><span class="main">]</span> <span class="quoted"><span class="quoted">‹<span class="main">∃</span><span class="bound">i</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i</span></sub><span class="hidden">⇙</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
      <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">≥</span> the_enat <span class="main">(</span>llength <span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>inf_llist <span class="free">t</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">-</span> <span class="main">1</span>"</span></span>
        <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span>↓<span class="hidden">⇘</span><sub><span class="free">t</span></sub><span class="hidden">⇙</span><span class="main">(</span><span class="free">n</span><span class="main">)</span> <span class="main">≤</span> <span class="skolem">x</span>›</span></span> cnf2bhv_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="free">γ</span> <span class="main">(</span>lnth <span class="main">(</span><span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>inf_llist <span class="free">t</span><span class="main">)</span><span class="main">)</span> <span class="keyword1">@<span class="hidden">⇩</span><sub>l</sub></span> <span class="main">(</span>inf_llist <span class="free">t'</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="skolem">x</span>"</span></span>
        <span class="keyword1"><span class="command">using</span></span> cnf2bhv_bhv2cnf <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">with</span></span> <span class="quoted"><span class="quoted">‹<span class="main">∃</span><span class="bound">i</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i</span></sub><span class="hidden">⇙</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="main">¬</span><span class="main">(</span><span class="main">∃</span><span class="bound"><span class="bound">i</span></span><span class="main">≥</span><span class="free">n</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i</span></sub><span class="hidden">⇙</span><span class="main">)</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"eval <span class="free">c</span> <span class="free">t</span> <span class="free">t'</span> <span class="free">n</span> <span class="main">(</span><span class="main">λ</span><span class="bound">t</span> <span class="bound">n</span><span class="main">.</span> <span class="main">∀</span><span class="bound"><span class="bound">n'</span></span><span class="main">≥</span><span class="bound">n</span><span class="main">.</span> <span class="free">γ</span> <span class="bound">t</span> <span class="bound">n'</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> validCI_cont<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="free">c</span></span> <span class="quoted"><span class="free">t</span></span> <span class="quoted"><span class="free">n</span></span> <span class="quoted"><span class="quoted">"<span class="main">λ</span> <span class="bound">t</span> <span class="bound">n</span><span class="main">.</span> <span class="main">∀</span><span class="bound"><span class="bound">n'</span></span><span class="main">≥</span><span class="bound">n</span><span class="main">.</span> <span class="free">γ</span> <span class="bound">t</span> <span class="bound">n'</span>"</span></span> <span class="quoted"><span class="free">t'</span></span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> glob_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">next</span></span>
  <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span><span class="main">(</span><span class="main">∃</span><span class="bound">i</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i</span></sub><span class="hidden">⇙</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">with</span></span> assms <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound"><span class="bound">n'</span></span><span class="main">≥</span><span class="free">n</span><span class="main">.</span> <span class="free">γ</span> <span class="main">(</span>lnth <span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span>inf_llist <span class="free">t</span> <span class="keyword1">@<span class="hidden">⇩</span><sub>l</sub></span> inf_llist <span class="free">t'</span><span class="main">)</span><span class="main">)</span> <span class="bound">n'</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> validCE_not_act <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">with</span></span> <span class="quoted"><span class="quoted">‹<span class="main">¬</span><span class="main">(</span><span class="main">∃</span><span class="bound">i</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i</span></sub><span class="hidden">⇙</span><span class="main">)</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"eval <span class="free">c</span> <span class="free">t</span> <span class="free">t'</span> <span class="free">n</span> <span class="main">(</span><span class="main">λ</span><span class="bound">t</span> <span class="bound">n</span><span class="main">.</span> <span class="main">∀</span><span class="bound"><span class="bound">n'</span></span><span class="main">≥</span><span class="bound">n</span><span class="main">.</span> <span class="free">γ</span> <span class="bound">t</span> <span class="bound">n'</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> validCI_not_act<span class="main">[</span><span class="keyword2"><span class="keyword"><span class="operator">where</span></span></span> γ<span class="main"><span class="main">=</span></span><span class="quoted"><span class="quoted">"<span class="main">λ</span> <span class="bound">t</span> <span class="bound">n</span><span class="main">.</span> <span class="main">∀</span><span class="bound"><span class="bound">n'</span></span><span class="main">≥</span><span class="bound">n</span><span class="main">.</span> <span class="free">γ</span> <span class="bound">t</span> <span class="bound">n'</span>"</span></span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> glob_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>
      
<span class="keyword1" id="Dynamic_Architecture_Calculus-globEA"><span class="command">lemma</span></span> globEA<span class="main">[</span><span class="operator">elim</span><span class="main">]</span><span class="main">:</span>
  <span class="keyword2"><span class="keyword">fixes</span></span> <span class="free">c</span><span class="main">::</span><span class="tfree"><span class="quoted"><span class="tfree">'id</span></span></span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="free">t</span><span class="main">::</span><span class="quoted"><span class="quoted">"nat <span class="main">⇒</span> cnf"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="free">t'</span><span class="main">::</span><span class="quoted"><span class="quoted">"nat <span class="main">⇒</span> <span class="tfree">'cmp</span>"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="free">n</span><span class="main">::</span><span class="quoted">nat</span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="free">n'</span><span class="main">::</span><span class="quoted">nat</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound"><span class="bound">i</span></span><span class="main">≥</span><span class="free">n</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i</span></sub><span class="hidden">⇙</span>"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"eval <span class="free">c</span> <span class="free">t</span> <span class="free">t'</span> <span class="free">n</span> <span class="main">(</span><span class="keyword1">□<span class="hidden">⇩</span><sub>b</sub></span><span class="main">(</span><span class="free">γ</span><span class="main">)</span><span class="main">)</span>"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">n'</span><span class="main">≥</span><span class="main">⟨</span><span class="free">c</span> <span class="main">⇐</span> <span class="free">t</span>⟩<span class="hidden">⇘</span><sub><span class="free">n</span></sub><span class="hidden">⇙</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"eval <span class="free">c</span> <span class="free">t</span> <span class="free">t'</span> <span class="free">n'</span> <span class="free">γ</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">cases</span><span class="main">)</span>
  <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound"><span class="bound">i</span></span><span class="main">≥</span><span class="free">n'</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i</span></sub><span class="hidden">⇙</span>"</span></span>
  <span class="keyword1"><span class="command">with</span></span> <span class="quoted"><span class="quoted">‹<span class="free">n'</span><span class="main">≥</span><span class="main">⟨</span><span class="free">c</span> <span class="main">⇐</span> <span class="free">t</span>⟩<span class="hidden">⇘</span><sub><span class="free">n</span></sub><span class="hidden">⇙</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"the_enat <span class="main">(</span><span class="main">⟨</span><span class="free">c</span> #<span class="hidden">⇘</span><sub><span class="free">n'</span></sub><span class="hidden">⇙</span> inf_llist <span class="free">t</span><span class="main">⟩</span><span class="main">)</span> <span class="main">≥</span> the_enat <span class="main">(</span><span class="main">⟨</span><span class="free">c</span> #<span class="hidden">⇘</span><sub><span class="free">n</span></sub><span class="hidden">⇙</span> inf_llist <span class="free">t</span><span class="main">⟩</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> nAct_mono_lNact <span class="quoted"><span class="quoted">‹<span class="main">∃</span><span class="bound"><span class="bound">i</span></span><span class="main">≥</span><span class="free">n</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i</span></sub><span class="hidden">⇙</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹eval <span class="free">c</span> <span class="free">t</span> <span class="free">t'</span> <span class="free">n</span> <span class="main">(</span><span class="keyword1">□<span class="hidden">⇩</span><sub>b</sub></span><span class="main">(</span><span class="free">γ</span><span class="main">)</span><span class="main">)</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"eval <span class="free">c</span> <span class="free">t</span> <span class="free">t'</span> <span class="free">n</span> <span class="main">(</span><span class="main">λ</span><span class="bound">t</span> <span class="bound">n</span><span class="main">.</span> <span class="main">∀</span><span class="bound"><span class="bound">n'</span></span><span class="main">≥</span><span class="bound">n</span><span class="main">.</span> <span class="free">γ</span> <span class="bound">t</span> <span class="bound">n'</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> glob_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound"><span class="bound">x</span></span><span class="main">≥</span>the_enat <span class="main">⟨</span><span class="free">c</span> #<span class="hidden">⇘</span><sub>enat <span class="free">n</span></sub><span class="hidden">⇙</span>inf_llist <span class="free">t</span><span class="main">⟩</span><span class="main">.</span> <span class="free">γ</span> <span class="main">(</span>lnth <span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span>inf_llist <span class="free">t</span> <span class="keyword1">@<span class="hidden">⇩</span><sub>l</sub></span> inf_llist <span class="free">t'</span><span class="main">)</span><span class="main">)</span> <span class="bound">x</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> validCE_act <span class="quoted"><span class="quoted">‹<span class="main">∃</span><span class="bound"><span class="bound">i</span></span><span class="main">≥</span><span class="free">n</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i</span></sub><span class="hidden">⇙</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">γ</span> <span class="main">(</span>lnth <span class="main">(</span><span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>inf_llist <span class="free">t</span><span class="main">)</span><span class="main">)</span> <span class="keyword1">@<span class="hidden">⇩</span><sub>l</sub></span> <span class="main">(</span>inf_llist <span class="free">t'</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">(</span>the_enat <span class="main">(</span><span class="main">⟨</span><span class="free">c</span> #<span class="hidden">⇘</span><sub><span class="free">n'</span></sub><span class="hidden">⇙</span> inf_llist <span class="free">t</span><span class="main">⟩</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">with</span></span> <span class="quoted"><span class="quoted">‹<span class="main">∃</span><span class="bound"><span class="bound">i</span></span><span class="main">≥</span><span class="free">n'</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i</span></sub><span class="hidden">⇙</span>›</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> validCI_act <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>    
<span class="keyword1"><span class="command">next</span></span>
  <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span><span class="main">(</span><span class="main">∃</span><span class="bound"><span class="bound">i</span></span><span class="main">≥</span><span class="free">n'</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i</span></sub><span class="hidden">⇙</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹eval <span class="free">c</span> <span class="free">t</span> <span class="free">t'</span> <span class="free">n</span> <span class="main">(</span><span class="keyword1">□<span class="hidden">⇩</span><sub>b</sub></span><span class="main">(</span><span class="free">γ</span><span class="main">)</span><span class="main">)</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"eval <span class="free">c</span> <span class="free">t</span> <span class="free">t'</span> <span class="free">n</span> <span class="main">(</span><span class="main">λ</span><span class="bound">t</span> <span class="bound">n</span><span class="main">.</span> <span class="main">∀</span><span class="bound"><span class="bound">n'</span></span><span class="main">≥</span><span class="bound">n</span><span class="main">.</span> <span class="free">γ</span> <span class="bound">t</span> <span class="bound">n'</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> glob_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound"><span class="bound">x</span></span><span class="main">≥</span>the_enat <span class="main">⟨</span><span class="free">c</span> #<span class="hidden">⇘</span><sub>enat <span class="free">n</span></sub><span class="hidden">⇙</span>inf_llist <span class="free">t</span><span class="main">⟩</span><span class="main">.</span> <span class="free">γ</span> <span class="main">(</span>lnth <span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span>inf_llist <span class="free">t</span> <span class="keyword1">@<span class="hidden">⇩</span><sub>l</sub></span> inf_llist <span class="free">t'</span><span class="main">)</span><span class="main">)</span> <span class="bound">x</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> validCE_act <span class="quoted"><span class="quoted">‹<span class="main">∃</span><span class="bound"><span class="bound">i</span></span><span class="main">≥</span><span class="free">n</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i</span></sub><span class="hidden">⇙</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span>↓<span class="hidden">⇘</span><sub><span class="free">t</span></sub><span class="hidden">⇙</span><span class="main">(</span><span class="free">n'</span><span class="main">)</span> <span class="main">≥</span> the_enat <span class="main">(</span><span class="main">⟨</span><span class="free">c</span> #<span class="hidden">⇘</span><sub><span class="free">n</span></sub><span class="hidden">⇙</span> inf_llist <span class="free">t</span><span class="main">⟩</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">⟨</span><span class="free">c</span> #<span class="hidden">⇘</span><sub><span class="free">n</span></sub><span class="hidden">⇙</span> inf_llist <span class="free">t</span><span class="main">⟩</span><span class="main">≤</span>llength <span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>inf_llist <span class="free">t</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> nAct_le_proj <span class="keyword1"><span class="command">by</span></span> <span class="operator">metis</span>
    <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="main">¬</span> <span class="main">(</span><span class="main">∃</span><span class="bound"><span class="bound">i</span></span><span class="main">≥</span><span class="free">n'</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i</span></sub><span class="hidden">⇙</span><span class="main">)</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"llength <span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>inf_llist <span class="free">t</span><span class="main">)</span><span class="main">)</span><span class="main">≠</span><span class="main">∞</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> llength_eq_infty_conv_lfinite lnth_inf_llist proj_finite2<span class="main">)</span>
    <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"the_enat<span class="main">(</span><span class="main">⟨</span><span class="free">c</span> #<span class="hidden">⇘</span><sub><span class="free">n</span></sub><span class="hidden">⇙</span> inf_llist <span class="free">t</span><span class="main">⟩</span><span class="main">)</span><span class="main">≤</span>the_enat<span class="main">(</span>llength <span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>inf_llist <span class="free">t</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="main">∃</span><span class="bound"><span class="bound">i</span></span><span class="main">≥</span><span class="free">n</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i</span></sub><span class="hidden">⇙</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="main">¬</span> <span class="main">(</span><span class="main">∃</span><span class="bound"><span class="bound">i</span></span><span class="main">≥</span><span class="free">n'</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i</span></sub><span class="hidden">⇙</span><span class="main">)</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">n'</span><span class="main">&gt;</span><span class="main">⟨</span><span class="free">c</span> <span class="main">∧</span> <span class="free">t</span><span class="main">⟩</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> lActive_active <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">meson</span> leI le_eq_less_or_eq<span class="main">)</span>
    <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span>↓<span class="hidden">⇘</span><sub><span class="free">t</span></sub><span class="hidden">⇙</span><span class="main">(</span><span class="free">n'</span><span class="main">)</span> <span class="main">&gt;</span> the_enat <span class="main">(</span>llength <span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>inf_llist <span class="free">t</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">-</span> <span class="main">1</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> cnf2bhv_greater_llength <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">γ</span> <span class="main">(</span>lnth <span class="main">(</span><span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>inf_llist <span class="free">t</span><span class="main">)</span><span class="main">)</span> <span class="keyword1">@<span class="hidden">⇩</span><sub>l</sub></span> <span class="main">(</span>inf_llist <span class="free">t'</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">(</span><span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span>↓<span class="hidden">⇘</span><sub><span class="free">t</span></sub><span class="hidden">⇙</span><span class="main">(</span><span class="free">n'</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">with</span></span> <span class="quoted"><span class="quoted">‹<span class="main">∃</span><span class="bound"><span class="bound">i</span></span><span class="main">≥</span><span class="free">n</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i</span></sub><span class="hidden">⇙</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="main">¬</span><span class="main">(</span><span class="main">∃</span><span class="bound"><span class="bound">i</span></span><span class="main">≥</span><span class="free">n'</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i</span></sub><span class="hidden">⇙</span><span class="main">)</span>›</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> validCI_cont <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="Dynamic_Architecture_Calculus-globEANow"><span class="command">lemma</span></span> globEANow<span class="main">:</span>
  <span class="keyword2"><span class="keyword">fixes</span></span> <span class="free">c</span> <span class="free">t</span> <span class="free">t'</span> <span class="free">n</span> <span class="free">i</span> <span class="free">γ</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">n</span> <span class="main">≤</span> <span class="free">i</span>"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="free">i</span></sub><span class="hidden">⇙</span>"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"eval <span class="free">c</span> <span class="free">t</span> <span class="free">t'</span> <span class="free">n</span> <span class="main">(</span><span class="keyword1">□<span class="hidden">⇩</span><sub>b</sub></span><span class="free">γ</span><span class="main">)</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"eval <span class="free">c</span> <span class="free">t</span> <span class="free">t'</span> <span class="free">i</span> <span class="free">γ</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="free">i</span></sub><span class="hidden">⇙</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="free">n</span> <span class="main">≤</span> <span class="free">i</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound"><span class="bound">i</span></span><span class="main">≥</span><span class="free">n</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i</span></sub><span class="hidden">⇙</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="free">n</span> <span class="main">≤</span> <span class="free">i</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">⟨</span><span class="free">c</span> <span class="main">⇐</span> <span class="free">t</span>⟩<span class="hidden">⇘</span><sub><span class="free">n</span></sub><span class="hidden">⇙</span> <span class="main">≤</span> <span class="free">i</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> dual_order.trans lNactLe <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> globEA<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="free">n</span></span> <span class="quoted"><span class="free">c</span></span> <span class="quoted"><span class="free">t</span></span> <span class="quoted"><span class="free">t'</span></span> <span class="quoted"><span class="free">γ</span></span> <span class="quoted"><span class="free">i</span></span><span class="main">]</span> <span class="quoted"><span class="quoted">‹eval <span class="free">c</span> <span class="free">t</span> <span class="free">t'</span> <span class="free">n</span> <span class="main">(</span><span class="keyword1">□<span class="hidden">⇩</span><sub>b</sub></span><span class="free">γ</span><span class="main">)</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="Dynamic_Architecture_Calculus-globEN"><span class="command">lemma</span></span> globEN<span class="main">[</span><span class="operator">elim</span><span class="main">]</span><span class="main">:</span>
  <span class="keyword2"><span class="keyword">fixes</span></span> <span class="free">c</span><span class="main">::</span><span class="tfree"><span class="quoted"><span class="tfree">'id</span></span></span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="free">t</span><span class="main">::</span><span class="quoted"><span class="quoted">"nat <span class="main">⇒</span> cnf"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="free">t'</span><span class="main">::</span><span class="quoted"><span class="quoted">"nat <span class="main">⇒</span> <span class="tfree">'cmp</span>"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="free">n</span><span class="main">::</span><span class="quoted">nat</span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="free">n'</span><span class="main">::</span><span class="quoted">nat</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span><span class="main">(</span><span class="main">∃</span><span class="bound"><span class="bound">i</span></span><span class="main">≥</span><span class="free">n</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i</span></sub><span class="hidden">⇙</span><span class="main">)</span>"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"eval <span class="free">c</span> <span class="free">t</span> <span class="free">t'</span> <span class="free">n</span> <span class="main">(</span><span class="keyword1">□<span class="hidden">⇩</span><sub>b</sub></span><span class="main">(</span><span class="free">γ</span><span class="main">)</span><span class="main">)</span>"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">n'</span><span class="main">≥</span><span class="free">n</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"eval <span class="free">c</span> <span class="free">t</span> <span class="free">t'</span> <span class="free">n'</span> <span class="free">γ</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">cases</span>
  <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound">i</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i</span></sub><span class="hidden">⇙</span>"</span></span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹eval <span class="free">c</span> <span class="free">t</span> <span class="free">t'</span> <span class="free">n</span> <span class="main">(</span><span class="keyword1">□<span class="hidden">⇩</span><sub>b</sub></span><span class="main">(</span><span class="free">γ</span><span class="main">)</span><span class="main">)</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"eval <span class="free">c</span> <span class="free">t</span> <span class="free">t'</span> <span class="free">n</span> <span class="main">(</span><span class="main">λ</span><span class="bound">t</span> <span class="bound">n</span><span class="main">.</span> <span class="main">∀</span><span class="bound"><span class="bound">n'</span></span><span class="main">≥</span><span class="bound">n</span><span class="main">.</span> <span class="free">γ</span> <span class="bound">t</span> <span class="bound">n'</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> glob_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound"><span class="bound">x</span></span><span class="main">≥</span><span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span>↓<span class="hidden">⇘</span><sub><span class="free">t</span></sub><span class="hidden">⇙</span><span class="free">n</span><span class="main">.</span> <span class="free">γ</span> <span class="main">(</span>lnth <span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span>inf_llist <span class="free">t</span> <span class="keyword1">@<span class="hidden">⇩</span><sub>l</sub></span> inf_llist <span class="free">t'</span><span class="main">)</span><span class="main">)</span> <span class="bound">x</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> validCE_cont<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="free">c</span></span> <span class="quoted"><span class="free">t</span></span> <span class="quoted"><span class="free">n</span></span> <span class="quoted"><span class="free">t'</span></span> <span class="quoted"><span class="quoted">"<span class="main">λ</span><span class="bound">t</span> <span class="bound">n</span><span class="main">.</span> <span class="main">∀</span><span class="bound"><span class="bound">n'</span></span><span class="main">≥</span><span class="bound">n</span><span class="main">.</span> <span class="free">γ</span> <span class="bound">t</span> <span class="bound">n'</span>"</span></span><span class="main">]</span> <span class="quoted"><span class="quoted">‹<span class="main">¬</span><span class="main">(</span><span class="main">∃</span><span class="bound"><span class="bound">i</span></span><span class="main">≥</span><span class="free">n</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i</span></sub><span class="hidden">⇙</span><span class="main">)</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="free">n'</span><span class="main">≥</span><span class="free">n</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span>↓<span class="hidden">⇘</span><sub><span class="free">t</span></sub><span class="hidden">⇙</span><span class="main">(</span><span class="free">n'</span><span class="main">)</span> <span class="main">≥</span> <span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span>↓<span class="hidden">⇘</span><sub><span class="free">t</span></sub><span class="hidden">⇙</span><span class="main">(</span><span class="free">n</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> cnf2bhv_mono <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">γ</span> <span class="main">(</span>lnth <span class="main">(</span><span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>inf_llist <span class="free">t</span><span class="main">)</span><span class="main">)</span> <span class="keyword1">@<span class="hidden">⇩</span><sub>l</sub></span> <span class="main">(</span>inf_llist <span class="free">t'</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">(</span><span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span>↓<span class="hidden">⇘</span><sub><span class="free">t</span></sub><span class="hidden">⇙</span><span class="main">(</span><span class="free">n'</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="main">¬</span><span class="main">(</span><span class="main">∃</span><span class="bound"><span class="bound">i</span></span><span class="main">≥</span><span class="free">n</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i</span></sub><span class="hidden">⇙</span><span class="main">)</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="free">n'</span><span class="main">≥</span><span class="free">n</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span><span class="main">(</span><span class="main">∃</span><span class="bound"><span class="bound">i</span></span><span class="main">≥</span><span class="free">n'</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i</span></sub><span class="hidden">⇙</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> validCI_cont <span class="quoted"><span class="quoted">‹<span class="main">∃</span><span class="bound">i</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i</span></sub><span class="hidden">⇙</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
<span class="keyword1"><span class="command">next</span></span>
  <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span><span class="main">(</span><span class="main">∃</span><span class="bound">i</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i</span></sub><span class="hidden">⇙</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹eval <span class="free">c</span> <span class="free">t</span> <span class="free">t'</span> <span class="free">n</span> <span class="main">(</span><span class="keyword1">□<span class="hidden">⇩</span><sub>b</sub></span><span class="main">(</span><span class="free">γ</span><span class="main">)</span><span class="main">)</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"eval <span class="free">c</span> <span class="free">t</span> <span class="free">t'</span> <span class="free">n</span> <span class="main">(</span><span class="main">λ</span><span class="bound">t</span> <span class="bound">n</span><span class="main">.</span> <span class="main">∀</span><span class="bound"><span class="bound">n'</span></span><span class="main">≥</span><span class="bound">n</span><span class="main">.</span> <span class="free">γ</span> <span class="bound">t</span> <span class="bound">n'</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> glob_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound"><span class="bound">n'</span></span><span class="main">≥</span><span class="free">n</span><span class="main">.</span> <span class="free">γ</span> <span class="main">(</span>lnth <span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span>inf_llist <span class="free">t</span> <span class="keyword1">@<span class="hidden">⇩</span><sub>l</sub></span> inf_llist <span class="free">t'</span><span class="main">)</span><span class="main">)</span> <span class="bound">n'</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="main">¬</span><span class="main">(</span><span class="main">∃</span><span class="bound">i</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i</span></sub><span class="hidden">⇙</span><span class="main">)</span>›</span></span> validCE_not_act<span class="main">[</span><span class="keyword2"><span class="keyword"><span class="operator">where</span></span></span> γ<span class="main"><span class="main">=</span></span><span class="quoted"><span class="quoted">"<span class="main">λ</span><span class="bound">t</span> <span class="bound">n</span><span class="main">.</span> <span class="main">∀</span><span class="bound"><span class="bound">n'</span></span><span class="main">≥</span><span class="bound">n</span><span class="main">.</span> <span class="free">γ</span> <span class="bound">t</span> <span class="bound">n'</span>"</span></span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">with</span></span> <span class="quoted"><span class="quoted">‹<span class="main">¬</span><span class="main">(</span><span class="main">∃</span><span class="bound">i</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i</span></sub><span class="hidden">⇙</span><span class="main">)</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="free">n'</span><span class="main">≥</span><span class="free">n</span>›</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> validCI_not_act <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">subsubsection</span></span> <span class="quoted"><span class="plain_text">"Until Operator"</span></span>

<span class="keyword1"><span class="command">definition</span></span> <span class="entity">until</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="tfree">'cmp</span> bta<span class="main">)</span> <span class="main">⇒</span> <span class="main">(</span><span class="tfree">'cmp</span> bta<span class="main">)</span> <span class="main">⇒</span> <span class="main">(</span><span class="tfree">'cmp</span> bta<span class="main">)</span>"</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">infixl</span></span> <span class="quoted">"<span class="keyword1">𝔘<span class="hidden">⇩</span><sub>b</sub></span>"</span> 21<span class="main">)</span>
  <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="free"><span class="bound"><span class="entity">γ'</span></span></span> <span class="keyword1"><span class="free">𝔘<span class="hidden">⇩</span><sub>b</sub></span></span> <span class="free"><span class="bound"><span class="entity">γ</span></span></span> <span class="main">≡</span> <span class="main">λ</span> <span class="bound">t</span> <span class="bound">n</span><span class="main">.</span> <span class="main">∃</span><span class="bound"><span class="bound">n''</span></span><span class="main">≥</span><span class="bound">n</span><span class="main">.</span> <span class="free"><span class="bound"><span class="entity">γ</span></span></span> <span class="bound">t</span> <span class="bound">n''</span> <span class="main">∧</span> <span class="main">(</span><span class="main">∀</span><span class="bound"><span class="bound">n'</span></span><span class="main">≥</span><span class="bound">n</span><span class="main">.</span> <span class="bound">n'</span> <span class="main">&lt;</span> <span class="bound">n''</span> <span class="main">⟶</span> <span class="free"><span class="bound"><span class="entity">γ'</span></span></span> <span class="bound">t</span> <span class="bound">n'</span><span class="main">)</span>"</span></span>
    
<span class="keyword1" id="Dynamic_Architecture_Calculus-untilIA"><span class="command">lemma</span></span> untilIA<span class="main">[</span><span class="operator">intro</span><span class="main">]</span><span class="main">:</span>
  <span class="keyword2"><span class="keyword">fixes</span></span> <span class="free">c</span><span class="main">::</span><span class="tfree"><span class="quoted"><span class="tfree">'id</span></span></span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="free">t</span><span class="main">::</span><span class="quoted"><span class="quoted">"nat <span class="main">⇒</span> cnf"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="free">t'</span><span class="main">::</span><span class="quoted"><span class="quoted">"nat <span class="main">⇒</span> <span class="tfree">'cmp</span>"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="free">n</span><span class="main">::</span><span class="quoted">nat</span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="free">n'</span><span class="main">::</span><span class="quoted">nat</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound"><span class="bound">i</span></span><span class="main">≥</span><span class="free">n</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i</span></sub><span class="hidden">⇙</span>"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">n'</span><span class="main">≥</span><span class="main">⟨</span><span class="free">c</span> <span class="main">⇐</span> <span class="free">t</span>⟩<span class="hidden">⇘</span><sub><span class="free">n</span></sub><span class="hidden">⇙</span>"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">⟦</span><span class="main">∃</span><span class="bound"><span class="bound">i</span></span><span class="main">≥</span><span class="free">n'</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i</span></sub><span class="hidden">⇙</span><span class="main">⟧</span> <span class="main">⟹</span> <span class="main">∃</span><span class="bound"><span class="bound">n''</span></span><span class="main">≥</span><span class="main">⟨</span><span class="free">c</span> <span class="main">⇐</span> <span class="free">t</span>⟩<span class="hidden">⇘</span><sub><span class="free">n'</span></sub><span class="hidden">⇙</span><span class="main">.</span> <span class="bound">n''</span><span class="main">≤</span> <span class="main">⟨</span><span class="free">c</span> <span class="main">→</span> <span class="free">t</span>⟩<span class="hidden">⇘</span><sub><span class="free">n'</span></sub><span class="hidden">⇙</span> <span class="main">∧</span> eval <span class="free">c</span> <span class="free">t</span> <span class="free">t'</span> <span class="bound">n''</span> <span class="free">γ</span> <span class="main">∧</span>
      <span class="main">(</span><span class="main">∀</span><span class="bound"><span class="bound">n'''</span></span><span class="main">≥</span><span class="main">⟨</span><span class="free">c</span> <span class="main">→</span> <span class="free">t</span>⟩<span class="hidden">⇘</span><sub><span class="free">n</span></sub><span class="hidden">⇙</span><span class="main">.</span> <span class="bound">n'''</span><span class="main">&lt;</span> <span class="main">⟨</span><span class="free">c</span> <span class="main">⇐</span> <span class="free">t</span>⟩<span class="hidden">⇘</span><sub><span class="bound">n''</span></sub><span class="hidden">⇙</span>
      <span class="main">⟶</span> <span class="main">(</span><span class="main">∃</span><span class="bound"><span class="bound">n''''</span></span><span class="main">≥</span><span class="main">⟨</span><span class="free">c</span> <span class="main">⇐</span> <span class="free">t</span>⟩<span class="hidden">⇘</span><sub><span class="bound">n'''</span></sub><span class="hidden">⇙</span><span class="main">.</span> <span class="bound">n''''</span><span class="main">≤</span> <span class="main">⟨</span><span class="free">c</span> <span class="main">→</span> <span class="free">t</span>⟩<span class="hidden">⇘</span><sub><span class="bound">n'''</span></sub><span class="hidden">⇙</span> <span class="main">∧</span> eval <span class="free">c</span> <span class="free">t</span> <span class="free">t'</span> <span class="bound">n''''</span> <span class="free">γ'</span><span class="main">)</span><span class="main">)</span>"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">⟦</span><span class="main">¬</span><span class="main">(</span><span class="main">∃</span><span class="bound"><span class="bound">i</span></span><span class="main">≥</span><span class="free">n'</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i</span></sub><span class="hidden">⇙</span><span class="main">)</span><span class="main">⟧</span> <span class="main">⟹</span> eval <span class="free">c</span> <span class="free">t</span> <span class="free">t'</span> <span class="free">n'</span> <span class="free">γ</span> <span class="main">∧</span>
      <span class="main">(</span><span class="main">∀</span><span class="bound"><span class="bound">n''</span></span><span class="main">≥</span><span class="main">⟨</span><span class="free">c</span> <span class="main">→</span> <span class="free">t</span>⟩<span class="hidden">⇘</span><sub><span class="free">n</span></sub><span class="hidden">⇙</span><span class="main">.</span> <span class="bound">n''</span><span class="main">&lt;</span> <span class="free">n'</span>
      <span class="main">⟶</span> <span class="main">(</span><span class="main">(</span><span class="main">∃</span><span class="bound"><span class="bound">i</span></span><span class="main">≥</span><span class="bound">n''</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i</span></sub><span class="hidden">⇙</span><span class="main">)</span> <span class="main">∧</span> <span class="main">(</span><span class="main">∃</span><span class="bound"><span class="bound">n'''</span></span><span class="main">≥</span><span class="main">⟨</span><span class="free">c</span> <span class="main">⇐</span> <span class="free">t</span>⟩<span class="hidden">⇘</span><sub><span class="bound">n''</span></sub><span class="hidden">⇙</span><span class="main">.</span> <span class="bound">n'''</span><span class="main">≤</span> <span class="main">⟨</span><span class="free">c</span> <span class="main">→</span> <span class="free">t</span>⟩<span class="hidden">⇘</span><sub><span class="bound">n''</span></sub><span class="hidden">⇙</span> <span class="main">∧</span> eval <span class="free">c</span> <span class="free">t</span> <span class="free">t'</span> <span class="bound">n'''</span> <span class="free">γ'</span><span class="main">)</span><span class="main">)</span> <span class="main">∨</span>
      <span class="main">(</span><span class="main">¬</span><span class="main">(</span><span class="main">∃</span><span class="bound"><span class="bound">i</span></span><span class="main">≥</span><span class="bound">n''</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i</span></sub><span class="hidden">⇙</span><span class="main">)</span> <span class="main">∧</span> eval <span class="free">c</span> <span class="free">t</span> <span class="free">t'</span> <span class="bound">n''</span> <span class="free">γ'</span><span class="main">)</span><span class="main">)</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"eval <span class="free">c</span> <span class="free">t</span> <span class="free">t'</span> <span class="free">n</span> <span class="main">(</span><span class="free">γ'</span> <span class="keyword1">𝔘<span class="hidden">⇩</span><sub>b</sub></span> <span class="free">γ</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">cases</span>
  <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound"><span class="bound">i'</span></span><span class="main">≥</span><span class="free">n'</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i'</span></sub><span class="hidden">⇙</span>"</span></span>
  <span class="keyword1"><span class="command">with</span></span> assms<span class="main">(</span>3<span class="main">)</span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">n''</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">n''</span><span class="main">≥</span><span class="main">⟨</span><span class="free">c</span> <span class="main">⇐</span> <span class="free">t</span>⟩<span class="hidden">⇘</span><sub><span class="free">n'</span></sub><span class="hidden">⇙</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">n''</span><span class="main">≤</span> <span class="main">⟨</span><span class="free">c</span> <span class="main">→</span> <span class="free">t</span>⟩<span class="hidden">⇘</span><sub><span class="free">n'</span></sub><span class="hidden">⇙</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"eval <span class="free">c</span> <span class="free">t</span> <span class="free">t'</span> <span class="skolem">n''</span> <span class="free">γ</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span>
    a1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound"><span class="bound">n'''</span></span><span class="main">≥</span><span class="main">⟨</span><span class="free">c</span> <span class="main">→</span> <span class="free">t</span>⟩<span class="hidden">⇘</span><sub><span class="free">n</span></sub><span class="hidden">⇙</span><span class="main">.</span> <span class="bound">n'''</span><span class="main">&lt;</span> <span class="main">⟨</span><span class="free">c</span> <span class="main">⇐</span> <span class="free">t</span>⟩<span class="hidden">⇘</span><sub><span class="skolem">n''</span></sub><span class="hidden">⇙</span>
    <span class="main">⟶</span> <span class="main">(</span><span class="main">∃</span><span class="bound"><span class="bound">n''''</span></span><span class="main">≥</span><span class="main">⟨</span><span class="free">c</span> <span class="main">⇐</span> <span class="free">t</span>⟩<span class="hidden">⇘</span><sub><span class="bound">n'''</span></sub><span class="hidden">⇙</span><span class="main">.</span> <span class="bound">n''''</span><span class="main">≤</span> <span class="main">⟨</span><span class="free">c</span> <span class="main">→</span> <span class="free">t</span>⟩<span class="hidden">⇘</span><sub><span class="bound">n'''</span></sub><span class="hidden">⇙</span> <span class="main">∧</span> eval <span class="free">c</span> <span class="free">t</span> <span class="free">t'</span> <span class="bound">n''''</span> <span class="free">γ'</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound"><span class="bound">i'</span></span><span class="main">≥</span><span class="skolem">n''</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i'</span></sub><span class="hidden">⇙</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="main">∃</span><span class="bound"><span class="bound">i'</span></span><span class="main">≥</span><span class="free">n'</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i'</span></sub><span class="hidden">⇙</span>›</span></span> nxtActI <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">with</span></span> <span class="quoted"><span class="quoted">‹eval <span class="free">c</span> <span class="free">t</span> <span class="free">t'</span> <span class="skolem">n''</span> <span class="free">γ</span>›</span></span> <span class="keyword1"><span class="command">have</span></span>
    <span class="quoted"><span class="quoted">"<span class="free">γ</span> <span class="main">(</span>lnth <span class="main">(</span><span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>inf_llist <span class="free">t</span><span class="main">)</span><span class="main">)</span> <span class="keyword1">@<span class="hidden">⇩</span><sub>l</sub></span> <span class="main">(</span>inf_llist <span class="free">t'</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">(</span>the_enat <span class="main">(</span><span class="main">⟨</span><span class="free">c</span> #<span class="hidden">⇘</span><sub><span class="skolem">n''</span></sub><span class="hidden">⇙</span> inf_llist <span class="free">t</span><span class="main">⟩</span><span class="main">)</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> validCE_act <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"the_enat <span class="main">(</span><span class="main">⟨</span><span class="free">c</span> #<span class="hidden">⇘</span><sub><span class="free">n</span></sub><span class="hidden">⇙</span> inf_llist <span class="free">t</span><span class="main">⟩</span><span class="main">)</span> <span class="main">≤</span> the_enat <span class="main">(</span><span class="main">⟨</span><span class="free">c</span> #<span class="hidden">⇘</span><sub><span class="skolem">n''</span></sub><span class="hidden">⇙</span> inf_llist <span class="free">t</span><span class="main">⟩</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
    <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="main">⟨</span><span class="free">c</span> <span class="main">⇐</span> <span class="free">t</span>⟩<span class="hidden">⇘</span><sub><span class="free">n</span></sub><span class="hidden">⇙</span><span class="main">≤</span><span class="free">n'</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">⟨</span><span class="free">c</span> #<span class="hidden">⇘</span><sub><span class="free">n</span></sub><span class="hidden">⇙</span> inf_llist <span class="free">t</span><span class="main">⟩</span> <span class="main">≤</span> <span class="main">⟨</span><span class="free">c</span> #<span class="hidden">⇘</span><sub><span class="free">n'</span></sub><span class="hidden">⇙</span> inf_llist <span class="free">t</span><span class="main">⟩</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> nAct_mono_lNact <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="main">⟨</span><span class="free">c</span> <span class="main">⇐</span> <span class="free">t</span>⟩<span class="hidden">⇘</span><sub><span class="free">n'</span></sub><span class="hidden">⇙</span><span class="main">≤</span><span class="skolem">n''</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">⟨</span><span class="free">c</span> #<span class="hidden">⇘</span><sub><span class="free">n'</span></sub><span class="hidden">⇙</span> inf_llist <span class="free">t</span><span class="main">⟩</span> <span class="main">≤</span> <span class="main">⟨</span><span class="free">c</span> #<span class="hidden">⇘</span><sub><span class="skolem">n''</span></sub><span class="hidden">⇙</span> inf_llist <span class="free">t</span><span class="main">⟩</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> nAct_mono_lNact <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>        
    <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">⟨</span><span class="free">c</span> #<span class="hidden">⇘</span><sub><span class="free">n</span></sub><span class="hidden">⇙</span> inf_llist <span class="free">t</span><span class="main">⟩</span> <span class="main">≤</span> <span class="main">⟨</span><span class="free">c</span> #<span class="hidden">⇘</span><sub><span class="skolem">n''</span></sub><span class="hidden">⇙</span> inf_llist <span class="free">t</span><span class="main">⟩</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">⟨</span><span class="free">c</span> #<span class="hidden">⇘</span><sub><span class="free">n'</span></sub><span class="hidden">⇙</span> inf_llist <span class="free">t</span><span class="main">⟩</span> <span class="main">≠</span> <span class="main">∞</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound"><span class="bound">i'</span></span><span class="main">≥</span><span class="free">n</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i'</span></sub><span class="hidden">⇙</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
    <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="main">∃</span><span class="bound"><span class="bound">i'</span></span><span class="main">≥</span><span class="free">n'</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i'</span></sub><span class="hidden">⇙</span>›</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">i'</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">i'</span><span class="main">≥</span><span class="free">n'</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="skolem">i'</span></sub><span class="hidden">⇙</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
    <span class="keyword1"><span class="command">with</span></span> <span class="quoted"><span class="quoted">‹<span class="free">n'</span><span class="main">≥</span><span class="main">⟨</span><span class="free">c</span> <span class="main">⇐</span> <span class="free">t</span>⟩<span class="hidden">⇘</span><sub><span class="free">n</span></sub><span class="hidden">⇙</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">i'</span><span class="main">≥</span> <span class="free">n</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> lNactGe le_trans <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
    <span class="keyword1"><span class="command">with</span></span> <span class="quoted"><span class="quoted">‹<span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="skolem">i'</span></sub><span class="hidden">⇙</span>›</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound"><span class="bound">n'</span></span><span class="main">≥</span>the_enat <span class="main">⟨</span><span class="free">c</span> #<span class="hidden">⇘</span><sub><span class="free">n</span></sub><span class="hidden">⇙</span>inf_llist <span class="free">t</span><span class="main">⟩</span><span class="main">.</span> <span class="bound">n'</span> <span class="main">&lt;</span> <span class="main">(</span>the_enat <span class="main">⟨</span><span class="free">c</span> #<span class="hidden">⇘</span><sub>enat <span class="skolem">n''</span></sub><span class="hidden">⇙</span>inf_llist <span class="free">t</span><span class="main">⟩</span><span class="main">)</span>
    <span class="main">⟶</span> <span class="free">γ'</span> <span class="main">(</span>lnth <span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span>inf_llist <span class="free">t</span> <span class="keyword1">@<span class="hidden">⇩</span><sub>l</sub></span> inf_llist <span class="free">t'</span><span class="main">)</span><span class="main">)</span> <span class="bound">n'</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span>
    <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">x</span><span class="main">::</span><span class="quoted">nat</span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span><span class="main">≥</span>the_enat <span class="main">(</span><span class="main">⟨</span><span class="free">c</span> #<span class="hidden">⇘</span><sub><span class="free">n</span></sub><span class="hidden">⇙</span> inf_llist <span class="free">t</span><span class="main">⟩</span><span class="main">)</span>
      <span class="main">⟶</span> <span class="skolem">x</span> <span class="main">&lt;</span> <span class="main">(</span>the_enat <span class="main">⟨</span><span class="free">c</span> #<span class="hidden">⇘</span><sub>enat <span class="skolem">n''</span></sub><span class="hidden">⇙</span>inf_llist <span class="free">t</span><span class="main">⟩</span><span class="main">)</span> <span class="main">⟶</span> <span class="free">γ'</span> <span class="main">(</span>lnth <span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span>inf_llist <span class="free">t</span> <span class="keyword1">@<span class="hidden">⇩</span><sub>l</sub></span> inf_llist <span class="free">t'</span><span class="main">)</span><span class="main">)</span> <span class="skolem">x</span>"</span></span>
    <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">rule</span> HOL.impI<span class="main"><span class="main">[</span></span><span class="operator">OF</span> HOL.impI<span class="main"><span class="main">]</span></span><span class="main">)</span>
      <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span><span class="main">≥</span>the_enat <span class="main">(</span><span class="main">⟨</span><span class="free">c</span> #<span class="hidden">⇘</span><sub><span class="free">n</span></sub><span class="hidden">⇙</span> inf_llist <span class="free">t</span><span class="main">⟩</span><span class="main">)</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">&lt;</span> <span class="main">(</span>the_enat <span class="main">⟨</span><span class="free">c</span> #<span class="hidden">⇘</span><sub>enat <span class="skolem">n''</span></sub><span class="hidden">⇙</span>inf_llist <span class="free">t</span><span class="main">⟩</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"the_enat <span class="main">(</span><span class="main">⟨</span><span class="free">c</span> #<span class="hidden">⇘</span><sub>enat <span class="skolem">n''</span></sub><span class="hidden">⇙</span> inf_llist <span class="free">t</span><span class="main">⟩</span><span class="main">)</span> <span class="main">=</span> <span class="main">⟨</span><span class="free">c</span> #<span class="hidden">⇘</span><sub>enat <span class="skolem">n''</span></sub><span class="hidden">⇙</span> inf_llist <span class="free">t</span><span class="main">⟩</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
      <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span><span class="main">&lt;</span>llength <span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>inf_llist <span class="free">t</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> nAct_le_proj<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="free">c</span></span> <span class="quoted"><span class="skolem">n''</span></span> <span class="quoted"><span class="quoted">"inf_llist <span class="free">t</span>"</span></span><span class="main">]</span>
        <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> enat_ord_simps<span class="main"><span class="main">(</span></span>2<span class="main"><span class="main">)</span></span> less_le_trans<span class="main">)</span>
      <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span><span class="main">&lt;</span>llength <span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>inf_llist <span class="free">t</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
      <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">n'</span></span><span class="main">::</span><span class="quoted">nat</span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span><span class="main">=</span><span class="main">⟨</span><span class="free">c</span> #<span class="hidden">⇘</span><sub><span class="skolem">n'</span></sub><span class="hidden">⇙</span> inf_llist <span class="free">t</span><span class="main">⟩</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> nAct_exists <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
      <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹enat <span class="skolem">x</span> <span class="main">&lt;</span> llength <span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>inf_llist <span class="free">t</span><span class="main">)</span><span class="main">)</span>›</span></span> <span class="quoted"><span class="quoted">‹enat <span class="skolem">x</span> <span class="main">=</span> <span class="main">⟨</span><span class="free">c</span> #<span class="hidden">⇘</span><sub>enat <span class="skolem">n'</span></sub><span class="hidden">⇙</span> inf_llist <span class="free">t</span><span class="main">⟩</span>›</span></span>
        <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound"><span class="bound">i</span></span><span class="main">≥</span><span class="skolem">n'</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i</span></sub><span class="hidden">⇙</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> nAct_less_llength_active <span class="keyword1"><span class="command">by</span></span> <span class="operator">force</span>
      <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">i</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">i</span><span class="main">≥</span><span class="skolem">n'</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="skolem">i</span></sub><span class="hidden">⇙</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> <span class="main">(</span><span class="main">∃</span><span class="bound"><span class="bound">k</span></span><span class="main">≥</span><span class="skolem">n'</span><span class="main">.</span> <span class="bound">k</span> <span class="main">&lt;</span> <span class="skolem">i</span> <span class="main">∧</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">k</span></sub><span class="hidden">⇙</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> nact_exists <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
      <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"enat <span class="skolem">i</span> <span class="main">-</span> <span class="main">1</span> <span class="main">&lt;</span> llength <span class="main">(</span>inf_llist <span class="free">t</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> one_enat_def<span class="main">)</span>
      <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span><span class="main">=</span><span class="main">⟨</span><span class="free">c</span> #<span class="hidden">⇘</span><sub><span class="skolem">i</span></sub><span class="hidden">⇙</span> inf_llist <span class="free">t</span><span class="main">⟩</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> one_enat_def nAct_not_active_same <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
      <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">⟨</span><span class="free">c</span> #<span class="hidden">⇘</span><sub><span class="skolem">i</span></sub><span class="hidden">⇙</span> inf_llist <span class="free">t</span><span class="main">⟩</span><span class="main">≠</span><span class="main">∞</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
      <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span><span class="main">=</span>the_enat<span class="main">(</span><span class="main">⟨</span><span class="free">c</span> #<span class="hidden">⇘</span><sub><span class="skolem">i</span></sub><span class="hidden">⇙</span> inf_llist <span class="free">t</span><span class="main">⟩</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">fastforce</span>
      <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">x</span><span class="main">≥</span>the_enat <span class="main">(</span><span class="main">⟨</span><span class="free">c</span> #<span class="hidden">⇘</span><sub><span class="free">n</span></sub><span class="hidden">⇙</span> inf_llist <span class="free">t</span><span class="main">⟩</span><span class="main">)</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">x</span><span class="main">=</span>the_enat<span class="main">(</span><span class="main">⟨</span><span class="free">c</span> #<span class="hidden">⇘</span><sub><span class="skolem">i</span></sub><span class="hidden">⇙</span> inf_llist <span class="free">t</span><span class="main">⟩</span><span class="main">)</span>›</span></span>
      <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"the_enat <span class="main">(</span><span class="main">⟨</span><span class="free">c</span> #<span class="hidden">⇘</span><sub><span class="skolem">i</span></sub><span class="hidden">⇙</span> inf_llist <span class="free">t</span><span class="main">⟩</span><span class="main">)</span><span class="main">≥</span>the_enat <span class="main">(</span><span class="main">⟨</span><span class="free">c</span> #<span class="hidden">⇘</span><sub><span class="free">n</span></sub><span class="hidden">⇙</span> inf_llist <span class="free">t</span><span class="main">⟩</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
      <span class="keyword1"><span class="command">with</span></span> <span class="quoted"><span class="quoted">‹<span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="skolem">i</span></sub><span class="hidden">⇙</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">i</span><span class="main">≥</span><span class="main">⟨</span><span class="free">c</span> <span class="main">→</span> <span class="free">t</span>⟩<span class="hidden">⇘</span><sub><span class="free">n</span></sub><span class="hidden">⇙</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> active_geq_nxtAct <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
      <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">i</span> <span class="main">&lt;</span> <span class="main">⟨</span><span class="free">c</span> <span class="main">⇐</span> <span class="free">t</span>⟩<span class="hidden">⇘</span><sub><span class="skolem">n''</span></sub><span class="hidden">⇙</span>"</span></span>
      <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
        <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"the_enat <span class="main">⟨</span><span class="free">c</span> #<span class="hidden">⇘</span><sub>enat <span class="skolem">n''</span></sub><span class="hidden">⇙</span>inf_llist <span class="free">t</span><span class="main">⟩</span> <span class="main">=</span> <span class="main">⟨</span><span class="free">c</span> #<span class="hidden">⇘</span><sub>enat <span class="skolem">n''</span></sub><span class="hidden">⇙</span>inf_llist <span class="free">t</span><span class="main">⟩</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
        <span class="keyword1"><span class="command">with</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">x</span> <span class="main">&lt;</span> <span class="main">(</span>the_enat <span class="main">⟨</span><span class="free">c</span> #<span class="hidden">⇘</span><sub>enat <span class="skolem">n''</span></sub><span class="hidden">⇙</span>inf_llist <span class="free">t</span><span class="main">⟩</span><span class="main">)</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">x</span><span class="main">=</span><span class="main">⟨</span><span class="free">c</span> #<span class="hidden">⇘</span><sub><span class="skolem">i</span></sub><span class="hidden">⇙</span> inf_llist <span class="free">t</span><span class="main">⟩</span>›</span></span> <span class="keyword1"><span class="command">have</span></span>
          <span class="quoted"><span class="quoted">"<span class="main">⟨</span><span class="free">c</span> #<span class="hidden">⇘</span><sub><span class="skolem">i</span></sub><span class="hidden">⇙</span> inf_llist <span class="free">t</span><span class="main">⟩</span><span class="main">&lt;</span><span class="main">⟨</span><span class="free">c</span> #<span class="hidden">⇘</span><sub><span class="skolem">n''</span></sub><span class="hidden">⇙</span> inf_llist <span class="free">t</span><span class="main">⟩</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> enat_ord_simps<span class="main"><span class="main">(</span></span>2<span class="main"><span class="main">)</span></span><span class="main">)</span>
        <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">i</span><span class="main">&lt;</span><span class="skolem">n''</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> nAct_strict_mono_back<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="free">c</span></span> <span class="quoted"><span class="skolem">i</span></span> <span class="quoted"><span class="quoted">"inf_llist <span class="free">t</span>"</span></span> <span class="quoted"><span class="skolem">n''</span></span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword1"><span class="command">with</span></span> <span class="quoted"><span class="quoted">‹<span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="skolem">i</span></sub><span class="hidden">⇙</span>›</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> lNact_notActive leI <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
      <span class="keyword1"><span class="command">qed</span></span>
      <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">n''</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"eval <span class="free">c</span> <span class="free">t</span> <span class="free">t'</span> <span class="skolem">n''</span> <span class="free">γ'</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">n''</span><span class="main">≥</span><span class="main">⟨</span><span class="free">c</span> <span class="main">⇐</span> <span class="free">t</span>⟩<span class="hidden">⇘</span><sub><span class="skolem">i</span></sub><span class="hidden">⇙</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">n''</span><span class="main">≤</span><span class="main">⟨</span><span class="free">c</span> <span class="main">→</span> <span class="free">t</span>⟩<span class="hidden">⇘</span><sub><span class="skolem">i</span></sub><span class="hidden">⇙</span>"</span></span>
        <span class="keyword1"><span class="command">using</span></span> a1 <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound"><span class="bound">i'</span></span><span class="main">≥</span><span class="skolem">n''</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i'</span></sub><span class="hidden">⇙</span>"</span></span>
        <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="skolem">i</span></sub><span class="hidden">⇙</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">n''</span><span class="main">≤</span><span class="main">⟨</span><span class="free">c</span> <span class="main">→</span> <span class="free">t</span>⟩<span class="hidden">⇘</span><sub><span class="skolem">i</span></sub><span class="hidden">⇙</span>›</span></span> less_or_eq_imp_le nxtAct_active <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">γ'</span> <span class="main">(</span>lnth <span class="main">(</span><span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>inf_llist <span class="free">t</span><span class="main">)</span><span class="main">)</span> <span class="keyword1">@<span class="hidden">⇩</span><sub>l</sub></span> <span class="main">(</span>inf_llist <span class="free">t'</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">(</span>the_enat <span class="main">(</span><span class="main">⟨</span><span class="free">c</span> #<span class="hidden">⇘</span><sub><span class="skolem">n''</span></sub><span class="hidden">⇙</span> inf_llist <span class="free">t</span><span class="main">⟩</span><span class="main">)</span><span class="main">)</span>"</span></span>
        <span class="keyword1"><span class="command">using</span></span> validCE_act<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="skolem">n''</span></span> <span class="quoted"><span class="free">c</span></span> <span class="quoted"><span class="free">t</span></span> <span class="quoted"><span class="free">t'</span></span> <span class="quoted"><span class="free">γ'</span></span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
      <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">n''</span><span class="main">≥</span><span class="main">⟨</span><span class="free">c</span> <span class="main">⇐</span> <span class="free">t</span>⟩<span class="hidden">⇘</span><sub><span class="skolem">i</span></sub><span class="hidden">⇙</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">n''</span><span class="main">≤</span><span class="main">⟨</span><span class="free">c</span> <span class="main">→</span> <span class="free">t</span>⟩<span class="hidden">⇘</span><sub><span class="skolem">i</span></sub><span class="hidden">⇙</span>›</span></span>
        <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"the_enat <span class="main">(</span><span class="main">⟨</span><span class="free">c</span> #<span class="hidden">⇘</span><sub><span class="skolem">n''</span></sub><span class="hidden">⇙</span> inf_llist <span class="free">t</span><span class="main">⟩</span><span class="main">)</span><span class="main">=</span>the_enat <span class="main">(</span><span class="main">⟨</span><span class="free">c</span> #<span class="hidden">⇘</span><sub><span class="skolem">i</span></sub><span class="hidden">⇙</span> inf_llist <span class="free">t</span><span class="main">⟩</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> nAct_same <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
      <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"the_enat <span class="main">(</span><span class="main">⟨</span><span class="free">c</span> #<span class="hidden">⇘</span><sub><span class="skolem">n''</span></sub><span class="hidden">⇙</span> inf_llist <span class="free">t</span><span class="main">⟩</span><span class="main">)</span> <span class="main">=</span> <span class="skolem">x</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">x</span> <span class="main">=</span> the_enat <span class="main">⟨</span><span class="free">c</span> #<span class="hidden">⇘</span><sub>enat <span class="skolem">i</span></sub><span class="hidden">⇙</span>inf_llist <span class="free">t</span><span class="main">⟩</span>›</span></span><span class="main">)</span>
      <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="free">γ'</span> <span class="main">(</span>lnth <span class="main">(</span><span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>inf_llist <span class="free">t</span><span class="main">)</span><span class="main">)</span> <span class="keyword1">@<span class="hidden">⇩</span><sub>l</sub></span> <span class="main">(</span>inf_llist <span class="free">t'</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="skolem">x</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">qed</span></span> 
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"eval <span class="free">c</span> <span class="free">t</span> <span class="free">t'</span> <span class="free">n</span> <span class="main">(</span><span class="main">λ</span> <span class="bound">t</span> <span class="bound">n</span><span class="main">.</span> <span class="main">∃</span><span class="bound"><span class="bound">n''</span></span><span class="main">≥</span><span class="bound">n</span><span class="main">.</span> <span class="free">γ</span> <span class="bound">t</span> <span class="bound">n''</span> <span class="main">∧</span> <span class="main">(</span><span class="main">∀</span><span class="bound"><span class="bound">n'</span></span><span class="main">≥</span><span class="bound">n</span><span class="main">.</span> <span class="bound">n'</span> <span class="main">&lt;</span> <span class="bound">n''</span> <span class="main">⟶</span> <span class="free">γ'</span> <span class="bound">t</span> <span class="bound">n'</span><span class="main">)</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> validCI_act<span class="main">[</span><span class="keyword2"><span class="keyword"><span class="operator">where</span></span></span> γ<span class="main"><span class="main">=</span></span><span class="quoted"><span class="quoted">"<span class="main">λ</span> <span class="bound">t</span> <span class="bound">n</span><span class="main">.</span> <span class="main">∃</span><span class="bound"><span class="bound">n''</span></span><span class="main">≥</span><span class="bound">n</span><span class="main">.</span> <span class="free">γ</span> <span class="bound">t</span> <span class="bound">n''</span> <span class="main">∧</span> <span class="main">(</span><span class="main">∀</span><span class="bound"><span class="bound">n'</span></span><span class="main">≥</span><span class="bound">n</span><span class="main">.</span> <span class="bound">n'</span> <span class="main">&lt;</span> <span class="bound">n''</span> <span class="main">⟶</span> <span class="free">γ'</span> <span class="bound">t</span> <span class="bound">n'</span><span class="main">)</span>"</span></span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> until_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">next</span></span>
  <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span><span class="main">(</span><span class="main">∃</span><span class="bound"><span class="bound">i'</span></span><span class="main">≥</span><span class="free">n'</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i'</span></sub><span class="hidden">⇙</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">with</span></span> assms<span class="main">(</span>4<span class="main">)</span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"eval <span class="free">c</span> <span class="free">t</span> <span class="free">t'</span> <span class="free">n'</span> <span class="free">γ</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> a2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound"><span class="bound">n''</span></span><span class="main">≥</span><span class="main">⟨</span><span class="free">c</span> <span class="main">→</span> <span class="free">t</span>⟩<span class="hidden">⇘</span><sub><span class="free">n</span></sub><span class="hidden">⇙</span><span class="main">.</span> <span class="bound">n''</span><span class="main">&lt;</span> <span class="free">n'</span>
    <span class="main">⟶</span> <span class="main">(</span><span class="main">(</span><span class="main">∃</span><span class="bound"><span class="bound">i</span></span><span class="main">≥</span><span class="bound">n''</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i</span></sub><span class="hidden">⇙</span><span class="main">)</span> <span class="main">∧</span> <span class="main">(</span><span class="main">∃</span><span class="bound"><span class="bound">n'''</span></span><span class="main">≥</span><span class="main">⟨</span><span class="free">c</span> <span class="main">⇐</span> <span class="free">t</span>⟩<span class="hidden">⇘</span><sub><span class="bound">n''</span></sub><span class="hidden">⇙</span><span class="main">.</span> <span class="bound">n'''</span><span class="main">≤</span> <span class="main">⟨</span><span class="free">c</span> <span class="main">→</span> <span class="free">t</span>⟩<span class="hidden">⇘</span><sub><span class="bound">n''</span></sub><span class="hidden">⇙</span> <span class="main">∧</span> eval <span class="free">c</span> <span class="free">t</span> <span class="free">t'</span> <span class="bound">n'''</span> <span class="free">γ'</span><span class="main">)</span><span class="main">)</span> <span class="main">∨</span>
    <span class="main">(</span><span class="main">¬</span><span class="main">(</span><span class="main">∃</span><span class="bound"><span class="bound">i</span></span><span class="main">≥</span><span class="bound">n''</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i</span></sub><span class="hidden">⇙</span><span class="main">)</span> <span class="main">∧</span> eval <span class="free">c</span> <span class="free">t</span> <span class="free">t'</span> <span class="bound">n''</span> <span class="free">γ'</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">with</span></span> <span class="quoted"><span class="quoted">‹<span class="main">¬</span><span class="main">(</span><span class="main">∃</span><span class="bound"><span class="bound">i'</span></span><span class="main">≥</span><span class="free">n'</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i'</span></sub><span class="hidden">⇙</span><span class="main">)</span>›</span></span> <span class="quoted"><span class="quoted">‹eval <span class="free">c</span> <span class="free">t</span> <span class="free">t'</span> <span class="free">n'</span> <span class="free">γ</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="main">∃</span><span class="bound"><span class="bound">i</span></span><span class="main">≥</span><span class="free">n</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i</span></sub><span class="hidden">⇙</span>›</span></span> <span class="keyword1"><span class="command">have</span></span>
    <span class="quoted"><span class="quoted">"<span class="free">γ</span> <span class="main">(</span>lnth <span class="main">(</span><span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>inf_llist <span class="free">t</span><span class="main">)</span><span class="main">)</span> <span class="keyword1">@<span class="hidden">⇩</span><sub>l</sub></span> <span class="main">(</span>inf_llist <span class="free">t'</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">(</span><span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span>↓<span class="hidden">⇘</span><sub><span class="free">t</span></sub><span class="hidden">⇙</span><span class="main">(</span><span class="free">n'</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> validCE_cont <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span>↓<span class="hidden">⇘</span><sub><span class="free">t</span></sub><span class="hidden">⇙</span><span class="main">(</span><span class="free">n'</span><span class="main">)</span> <span class="main">≥</span> the_enat <span class="main">(</span><span class="main">⟨</span><span class="free">c</span> #<span class="hidden">⇘</span><sub><span class="free">n</span></sub><span class="hidden">⇙</span> inf_llist <span class="free">t</span><span class="main">⟩</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
    <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="main">(</span><span class="main">∃</span><span class="bound"><span class="bound">i</span></span><span class="main">≥</span><span class="free">n</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i</span></sub><span class="hidden">⇙</span><span class="main">)</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="main">¬</span><span class="main">(</span><span class="main">∃</span><span class="bound"><span class="bound">i'</span></span><span class="main">≥</span><span class="free">n'</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i'</span></sub><span class="hidden">⇙</span><span class="main">)</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">n'</span> <span class="main">≥</span> <span class="main">⟨</span><span class="free">c</span> <span class="main">∧</span> <span class="free">t</span><span class="main">⟩</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> lActive_less <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span>↓<span class="hidden">⇘</span><sub><span class="free">t</span></sub><span class="hidden">⇙</span><span class="main">(</span><span class="free">n'</span><span class="main">)</span> <span class="main">≥</span> the_enat <span class="main">(</span>llength <span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>inf_llist <span class="free">t</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">-</span> <span class="main">1</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> cnf2bhv_ge_llength <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"the_enat<span class="main">(</span>llength <span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>inf_llist <span class="free">t</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">-</span> <span class="main">1</span> <span class="main">≥</span> the_enat<span class="main">(</span><span class="main">⟨</span><span class="free">c</span> #<span class="hidden">⇘</span><sub><span class="free">n</span></sub><span class="hidden">⇙</span> inf_llist <span class="free">t</span><span class="main">⟩</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
      <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="main">∃</span><span class="bound"><span class="bound">i</span></span><span class="main">≥</span><span class="free">n</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i</span></sub><span class="hidden">⇙</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"llength <span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>inf_llist <span class="free">t</span><span class="main">)</span><span class="main">)</span> <span class="main">≥</span> eSuc <span class="main">(</span><span class="main">⟨</span><span class="free">c</span> #<span class="hidden">⇘</span><sub><span class="free">n</span></sub><span class="hidden">⇙</span> inf_llist <span class="free">t</span><span class="main">⟩</span><span class="main">)</span>"</span></span>
        <span class="keyword1"><span class="command">using</span></span> nAct_llength_proj <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
      <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="main">¬</span><span class="main">(</span><span class="main">∃</span><span class="bound"><span class="bound">i'</span></span><span class="main">≥</span><span class="free">n'</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i'</span></sub><span class="hidden">⇙</span><span class="main">)</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"lfinite <span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>inf_llist <span class="free">t</span><span class="main">)</span><span class="main">)</span>"</span></span>
        <span class="keyword1"><span class="command">using</span></span> proj_finite2<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="quoted">"inf_llist <span class="free">t</span>"</span></span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
      <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"llength <span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>inf_llist <span class="free">t</span><span class="main">)</span><span class="main">)</span><span class="main">≠</span><span class="main">∞</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> llength_eq_infty_conv_lfinite <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"the_enat <span class="main">(</span>llength <span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>inf_llist <span class="free">t</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">≥</span> the_enat<span class="main">(</span>eSuc <span class="main">(</span><span class="main">⟨</span><span class="free">c</span> #<span class="hidden">⇘</span><sub><span class="free">n</span></sub><span class="hidden">⇙</span> inf_llist <span class="free">t</span><span class="main">⟩</span><span class="main">)</span><span class="main">)</span>"</span></span>
        <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
      <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">⟨</span><span class="free">c</span> #<span class="hidden">⇘</span><sub><span class="free">n</span></sub><span class="hidden">⇙</span> inf_llist <span class="free">t</span><span class="main">⟩</span><span class="main">≠</span><span class="main">∞</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
      <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"the_enat <span class="main">(</span>llength <span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>inf_llist <span class="free">t</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">≥</span> Suc <span class="main">(</span>the_enat <span class="main">(</span><span class="main">⟨</span><span class="free">c</span> #<span class="hidden">⇘</span><sub><span class="free">n</span></sub><span class="hidden">⇙</span> inf_llist <span class="free">t</span><span class="main">⟩</span><span class="main">)</span><span class="main">)</span>"</span></span>
        <span class="keyword1"><span class="command">using</span></span> the_enat_eSuc <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
      <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">qed</span></span>
    <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound"><span class="bound">x</span></span><span class="main">≥</span>the_enat <span class="main">⟨</span><span class="free">c</span> #<span class="hidden">⇘</span><sub><span class="free">n</span></sub><span class="hidden">⇙</span>inf_llist <span class="free">t</span><span class="main">⟩</span><span class="main">.</span> <span class="bound">x</span> <span class="main">&lt;</span> <span class="main">(</span><span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span>↓<span class="hidden">⇘</span><sub><span class="free">t</span></sub><span class="hidden">⇙</span><span class="main">(</span><span class="free">n'</span><span class="main">)</span><span class="main">)</span>
    <span class="main">⟶</span> <span class="free">γ'</span> <span class="main">(</span>lnth <span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span>inf_llist <span class="free">t</span> <span class="keyword1">@<span class="hidden">⇩</span><sub>l</sub></span> inf_llist <span class="free">t'</span><span class="main">)</span><span class="main">)</span> <span class="bound">x</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span>
    <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">x</span><span class="main">::</span><span class="quoted">nat</span> <span class="keyword3"><span class="command">show</span></span>
      <span class="quoted"><span class="quoted">"<span class="skolem">x</span><span class="main">≥</span>the_enat <span class="main">⟨</span><span class="free">c</span> #<span class="hidden">⇘</span><sub><span class="free">n</span></sub><span class="hidden">⇙</span>inf_llist <span class="free">t</span><span class="main">⟩</span> <span class="main">⟶</span> <span class="skolem">x</span> <span class="main">&lt;</span> <span class="main">(</span><span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span>↓<span class="hidden">⇘</span><sub><span class="free">t</span></sub><span class="hidden">⇙</span><span class="main">(</span><span class="free">n'</span><span class="main">)</span><span class="main">)</span> <span class="main">⟶</span> <span class="free">γ'</span> <span class="main">(</span>lnth <span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span>inf_llist <span class="free">t</span> <span class="keyword1">@<span class="hidden">⇩</span><sub>l</sub></span> inf_llist <span class="free">t'</span><span class="main">)</span><span class="main">)</span> <span class="skolem">x</span>"</span></span>
    <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">rule</span> HOL.impI<span class="main"><span class="main">[</span></span><span class="operator">OF</span> HOL.impI<span class="main"><span class="main">]</span></span><span class="main">)</span>
      <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span><span class="main">≥</span>the_enat <span class="main">⟨</span><span class="free">c</span> #<span class="hidden">⇘</span><sub><span class="free">n</span></sub><span class="hidden">⇙</span>inf_llist <span class="free">t</span><span class="main">⟩</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">&lt;</span> <span class="main">(</span><span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span>↓<span class="hidden">⇘</span><sub><span class="free">t</span></sub><span class="hidden">⇙</span><span class="main">(</span><span class="free">n'</span><span class="main">)</span><span class="main">)</span>"</span></span>
      <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="free">γ'</span> <span class="main">(</span>lnth <span class="main">(</span><span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>inf_llist <span class="free">t</span><span class="main">)</span><span class="main">)</span> <span class="keyword1">@<span class="hidden">⇩</span><sub>l</sub></span> <span class="main">(</span>inf_llist <span class="free">t'</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="skolem">x</span>"</span></span>
      <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">cases</span><span class="main">)</span>
        <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">x</span> <span class="main">≥</span> llength <span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>inf_llist <span class="free">t</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span>
        <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"lfinite <span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>inf_llist <span class="free">t</span><span class="main">)</span><span class="main">)</span>"</span></span>
          <span class="keyword1"><span class="command">using</span></span> llength_geq_enat_lfiniteD<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="quoted">"π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>inf_llist <span class="free">t</span><span class="main">)</span>"</span></span> <span class="quoted"><span class="skolem">x</span></span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
        <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">z</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound"><span class="bound">n''</span></span><span class="main">&gt;</span><span class="skolem">z</span><span class="main">.</span> <span class="main">¬</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">n''</span></sub><span class="hidden">⇙</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> proj_finite_bound <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
        <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="main">⟨</span><span class="free">c</span> <span class="main">→</span> <span class="free">t</span>⟩<span class="hidden">⇘</span><sub><span class="free">n</span></sub><span class="hidden">⇙</span></sub><span class="hidden">⇙</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> <span class="quoted"><span class="quoted">‹<span class="main">∃</span><span class="bound"><span class="bound">i</span></span><span class="main">≥</span><span class="free">n</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i</span></sub><span class="hidden">⇙</span>›</span></span> nxtActI<span class="main">)</span>
        <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">⟨</span><span class="free">c</span> <span class="main">∧</span> <span class="free">t</span><span class="main">⟩</span><span class="main">≥</span><span class="main">⟨</span><span class="free">c</span> <span class="main">→</span> <span class="free">t</span>⟩<span class="hidden">⇘</span><sub><span class="free">n</span></sub><span class="hidden">⇙</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> lActive_greatest<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="free">c</span></span> <span class="quoted"><span class="free">t</span></span> <span class="quoted"><span class="quoted">"<span class="main">⟨</span><span class="free">c</span> <span class="main">→</span> <span class="free">t</span>⟩<span class="hidden">⇘</span><sub><span class="free">n</span></sub><span class="hidden">⇙</span>"</span></span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
        <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span>↑<span class="hidden">⇘</span><sub><span class="free">t</span></sub><span class="hidden">⇙</span><span class="main">(</span><span class="skolem">x</span><span class="main">)</span> <span class="main">≥</span> <span class="main">⟨</span><span class="free">c</span> <span class="main">∧</span> <span class="free">t</span><span class="main">⟩</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
        <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span>↑<span class="hidden">⇘</span><sub><span class="free">t</span></sub><span class="hidden">⇙</span><span class="main">(</span><span class="skolem">x</span><span class="main">)</span> <span class="main">≥</span> <span class="main">⟨</span><span class="free">c</span> <span class="main">→</span> <span class="free">t</span>⟩<span class="hidden">⇘</span><sub><span class="free">n</span></sub><span class="hidden">⇙</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">arith</span>
        <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> <span class="main">(</span><span class="main">∃</span><span class="bound"><span class="bound">i'</span></span><span class="main">≥</span><span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span>↑<span class="hidden">⇘</span><sub><span class="free">t</span></sub><span class="hidden">⇙</span><span class="main">(</span><span class="skolem">x</span><span class="main">)</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i'</span></sub><span class="hidden">⇙</span><span class="main">)</span>"</span></span>
        <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
          <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹lfinite <span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>inf_llist <span class="free">t</span><span class="main">)</span><span class="main">)</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="main">∃</span><span class="bound"><span class="bound">i</span></span><span class="main">≥</span><span class="free">n</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i</span></sub><span class="hidden">⇙</span>›</span></span>
            <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span>↑<span class="hidden">⇘</span><sub><span class="free">t</span></sub><span class="hidden">⇙</span><span class="main">(</span>the_enat <span class="main">(</span>llength <span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>inf_llist <span class="free">t</span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> Suc <span class="main">(</span><span class="main">⟨</span><span class="free">c</span> <span class="main">∧</span> <span class="free">t</span><span class="main">⟩</span><span class="main">)</span>"</span></span>
            <span class="keyword1"><span class="command">using</span></span> bhv2cnf_lActive <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
          <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="main">(</span><span class="skolem">x</span> <span class="main">≥</span> llength <span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>inf_llist <span class="free">t</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">≥</span> the_enat<span class="main">(</span>llength <span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>inf_llist <span class="free">t</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span>
            <span class="keyword1"><span class="command">using</span></span> the_enat_mono <span class="keyword1"><span class="command">by</span></span> <span class="operator">fastforce</span>
          <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span>↑<span class="hidden">⇘</span><sub><span class="free">t</span></sub><span class="hidden">⇙</span><span class="main">(</span><span class="skolem">x</span><span class="main">)</span> <span class="main">≥</span> <span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span>↑<span class="hidden">⇘</span><sub><span class="free">t</span></sub><span class="hidden">⇙</span><span class="main">(</span>the_enat <span class="main">(</span>llength <span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>inf_llist <span class="free">t</span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span>
            <span class="keyword1"><span class="command">using</span></span> bhv2cnf_mono<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="quoted">"the_enat <span class="main">(</span>llength <span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>inf_llist <span class="free">t</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="quoted"><span class="skolem">x</span></span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
          <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span>↑<span class="hidden">⇘</span><sub><span class="free">t</span></sub><span class="hidden">⇙</span><span class="main">(</span><span class="skolem">x</span><span class="main">)</span> <span class="main">≥</span> Suc <span class="main">(</span><span class="main">⟨</span><span class="free">c</span> <span class="main">∧</span> <span class="free">t</span><span class="main">⟩</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
          <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span>↑<span class="hidden">⇘</span><sub><span class="free">t</span></sub><span class="hidden">⇙</span><span class="main">(</span><span class="skolem">x</span><span class="main">)</span> <span class="main">&gt;</span> <span class="main">⟨</span><span class="free">c</span> <span class="main">∧</span> <span class="free">t</span><span class="main">⟩</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
          <span class="keyword1"><span class="command">with</span></span> <span class="quoted"><span class="quoted">‹<span class="main">∀</span><span class="bound"><span class="bound">n''</span></span><span class="main">&gt;</span><span class="skolem">z</span><span class="main">.</span> <span class="main">¬</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">n''</span></sub><span class="hidden">⇙</span>›</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> lActive_greater_active_all <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
        <span class="keyword1"><span class="command">qed</span></span>
        <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span>↑<span class="hidden">⇘</span><sub><span class="free">t</span></sub><span class="hidden">⇙</span><span class="skolem">x</span> <span class="main">&lt;</span> <span class="free">n'</span>"</span></span>
        <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
          <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹lfinite <span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>inf_llist <span class="free">t</span><span class="main">)</span><span class="main">)</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"llength <span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span>inf_llist <span class="free">t</span><span class="main">)</span> <span class="main">=</span> the_enat <span class="main">(</span>llength <span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span>inf_llist <span class="free">t</span><span class="main">)</span><span class="main">)</span>"</span></span>
            <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> enat_the_enat llength_eq_infty_conv_lfinite<span class="main">)</span>
          <span class="keyword1"><span class="command">with</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">x</span> <span class="main">≥</span> llength <span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>inf_llist <span class="free">t</span><span class="main">)</span><span class="main">)</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span><span class="main">≥</span>the_enat <span class="main">(</span>llength <span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span>inf_llist <span class="free">t</span><span class="main">)</span><span class="main">)</span>"</span></span>
            <span class="keyword1"><span class="command">using</span></span> enat_ord_simps<span class="main">(</span>1<span class="main">)</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">fastforce</span>
          <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="main">∃</span><span class="bound"><span class="bound">i</span></span><span class="main">≥</span><span class="free">n</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i</span></sub><span class="hidden">⇙</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"llength <span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span>inf_llist <span class="free">t</span><span class="main">)</span><span class="main">≥</span><span class="main">1</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> proj_one <span class="keyword1"><span class="command">by</span></span> <span class="operator">force</span>
          <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"the_enat <span class="main">(</span>llength <span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span>inf_llist <span class="free">t</span><span class="main">)</span><span class="main">)</span> <span class="main">-</span> <span class="main">1</span> <span class="main">≤</span> <span class="skolem">x</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
          <span class="keyword1"><span class="command">with</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">x</span> <span class="main">&lt;</span> <span class="main">(</span><span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span>↓<span class="hidden">⇘</span><sub><span class="free">t</span></sub><span class="hidden">⇙</span><span class="main">(</span><span class="free">n'</span><span class="main">)</span><span class="main">)</span>›</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> c2p_mono_p2c_strict <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
        <span class="keyword1"><span class="command">qed</span></span>
        <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"eval <span class="free">c</span> <span class="free">t</span> <span class="free">t'</span> <span class="main">(</span><span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span>↑<span class="hidden">⇘</span><sub><span class="free">t</span></sub><span class="hidden">⇙</span><span class="main">(</span><span class="skolem">x</span><span class="main">)</span><span class="main">)</span> <span class="free">γ'</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> a2 <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
        <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="free">γ'</span> <span class="main">(</span>lnth <span class="main">(</span><span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>inf_llist <span class="free">t</span><span class="main">)</span><span class="main">)</span> <span class="keyword1">@<span class="hidden">⇩</span><sub>l</sub></span> <span class="main">(</span>inf_llist <span class="free">t'</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">(</span><span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span>↓<span class="hidden">⇘</span><sub><span class="free">t</span></sub><span class="hidden">⇙</span><span class="main">(</span><span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span>↑<span class="hidden">⇘</span><sub><span class="free">t</span></sub><span class="hidden">⇙</span><span class="main">(</span><span class="skolem">x</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span>
          <span class="keyword1"><span class="command">using</span></span> validCE_cont<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="free">c</span></span> <span class="quoted"><span class="free">t</span></span> <span class="quoted"><span class="quoted">"<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span>↑<span class="hidden">⇘</span><sub><span class="free">t</span></sub><span class="hidden">⇙</span><span class="main">(</span><span class="skolem">x</span><span class="main">)</span>"</span></span> <span class="quoted"><span class="free">t'</span></span> <span class="quoted"><span class="free">γ'</span></span><span class="main">]</span> <span class="quoted"><span class="quoted">‹<span class="main">∃</span><span class="bound"><span class="bound">i</span></span><span class="main">≥</span><span class="free">n</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i</span></sub><span class="hidden">⇙</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="main">¬</span> <span class="main">(</span><span class="main">∃</span><span class="bound"><span class="bound">i'</span></span><span class="main">≥</span><span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span>↑<span class="hidden">⇘</span><sub><span class="free">t</span></sub><span class="hidden">⇙</span><span class="main">(</span><span class="skolem">x</span><span class="main">)</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i'</span></sub><span class="hidden">⇙</span><span class="main">)</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
        <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="main">(</span><span class="skolem">x</span> <span class="main">≥</span> llength <span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>inf_llist <span class="free">t</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>›</span></span>
          <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span>enat <span class="skolem">x</span> <span class="main">≥</span> llength <span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>inf_llist <span class="free">t</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword1"><span class="command">with</span></span> <span class="quoted"><span class="quoted">‹lfinite <span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>inf_llist <span class="free">t</span><span class="main">)</span><span class="main">)</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"llength <span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>inf_llist <span class="free">t</span><span class="main">)</span><span class="main">)</span><span class="main">≠</span><span class="main">∞</span>"</span></span>
          <span class="keyword1"><span class="command">using</span></span> llength_eq_infty_conv_lfinite <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword1"><span class="command">with</span></span> <span class="quoted"><span class="quoted">‹<span class="main">(</span><span class="skolem">x</span> <span class="main">≥</span> llength <span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>inf_llist <span class="free">t</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>›</span></span>
          <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"the_enat<span class="main">(</span>llength <span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>inf_llist <span class="free">t</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">-</span> <span class="main">1</span> <span class="main">≤</span> <span class="skolem">x</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> cnf2bhv_bhv2cnf<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="free">c</span></span> <span class="quoted"><span class="free">t</span></span> <span class="quoted"><span class="skolem">x</span></span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
      <span class="keyword1"><span class="command">next</span></span>
        <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span><span class="main">(</span><span class="skolem">x</span> <span class="main">≥</span> llength <span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>inf_llist <span class="free">t</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span>
        <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span><span class="main">&lt;</span>llength <span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>inf_llist <span class="free">t</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
        <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">n''</span></span><span class="main">::</span><span class="quoted">nat</span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span><span class="main">=</span><span class="main">⟨</span><span class="free">c</span> #<span class="hidden">⇘</span><sub><span class="skolem">n''</span></sub><span class="hidden">⇙</span> inf_llist <span class="free">t</span><span class="main">⟩</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> nAct_exists <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
        <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹enat <span class="skolem">x</span> <span class="main">&lt;</span> llength <span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>inf_llist <span class="free">t</span><span class="main">)</span><span class="main">)</span>›</span></span> <span class="quoted"><span class="quoted">‹enat <span class="skolem">x</span> <span class="main">=</span> <span class="main">⟨</span><span class="free">c</span> #<span class="hidden">⇘</span><sub>enat <span class="skolem">n''</span></sub><span class="hidden">⇙</span> inf_llist <span class="free">t</span><span class="main">⟩</span>›</span></span>
          <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound"><span class="bound">i</span></span><span class="main">≥</span><span class="skolem">n''</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i</span></sub><span class="hidden">⇙</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> nAct_less_llength_active <span class="keyword1"><span class="command">by</span></span> <span class="operator">force</span>
        <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">i</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">i</span><span class="main">≥</span><span class="skolem">n''</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="skolem">i</span></sub><span class="hidden">⇙</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> <span class="main">(</span><span class="main">∃</span><span class="bound"><span class="bound">k</span></span><span class="main">≥</span><span class="skolem">n''</span><span class="main">.</span> <span class="bound">k</span> <span class="main">&lt;</span> <span class="skolem">i</span> <span class="main">∧</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">k</span></sub><span class="hidden">⇙</span><span class="main">)</span>"</span></span> 
          <span class="keyword1"><span class="command">using</span></span> nact_exists <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
        <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"enat <span class="skolem">i</span> <span class="main">-</span> <span class="main">1</span> <span class="main">&lt;</span> llength <span class="main">(</span>inf_llist <span class="free">t</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> one_enat_def<span class="main">)</span>
        <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span><span class="main">=</span><span class="main">⟨</span><span class="free">c</span> #<span class="hidden">⇘</span><sub><span class="skolem">i</span></sub><span class="hidden">⇙</span> inf_llist <span class="free">t</span><span class="main">⟩</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> one_enat_def nAct_not_active_same <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
        <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">⟨</span><span class="free">c</span> #<span class="hidden">⇘</span><sub><span class="skolem">i</span></sub><span class="hidden">⇙</span> inf_llist <span class="free">t</span><span class="main">⟩</span><span class="main">≠</span><span class="main">∞</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
        <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span><span class="main">=</span>the_enat<span class="main">(</span><span class="main">⟨</span><span class="free">c</span> #<span class="hidden">⇘</span><sub><span class="skolem">i</span></sub><span class="hidden">⇙</span> inf_llist <span class="free">t</span><span class="main">⟩</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">fastforce</span>
        <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">x</span><span class="main">≥</span>the_enat <span class="main">(</span><span class="main">⟨</span><span class="free">c</span> #<span class="hidden">⇘</span><sub><span class="free">n</span></sub><span class="hidden">⇙</span> inf_llist <span class="free">t</span><span class="main">⟩</span><span class="main">)</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">x</span><span class="main">=</span>the_enat<span class="main">(</span><span class="main">⟨</span><span class="free">c</span> #<span class="hidden">⇘</span><sub><span class="skolem">i</span></sub><span class="hidden">⇙</span> inf_llist <span class="free">t</span><span class="main">⟩</span><span class="main">)</span>›</span></span>
        <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"the_enat <span class="main">(</span><span class="main">⟨</span><span class="free">c</span> #<span class="hidden">⇘</span><sub><span class="skolem">i</span></sub><span class="hidden">⇙</span> inf_llist <span class="free">t</span><span class="main">⟩</span><span class="main">)</span><span class="main">≥</span>the_enat <span class="main">(</span><span class="main">⟨</span><span class="free">c</span> #<span class="hidden">⇘</span><sub><span class="free">n</span></sub><span class="hidden">⇙</span> inf_llist <span class="free">t</span><span class="main">⟩</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
        <span class="keyword1"><span class="command">with</span></span> <span class="quoted"><span class="quoted">‹<span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="skolem">i</span></sub><span class="hidden">⇙</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">i</span><span class="main">≥</span><span class="main">⟨</span><span class="free">c</span> <span class="main">→</span> <span class="free">t</span>⟩<span class="hidden">⇘</span><sub><span class="free">n</span></sub><span class="hidden">⇙</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> active_geq_nxtAct <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
        <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">x</span><span class="main">=</span><span class="main">⟨</span><span class="free">c</span> #<span class="hidden">⇘</span><sub><span class="skolem">i</span></sub><span class="hidden">⇙</span> inf_llist <span class="free">t</span><span class="main">⟩</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">x</span> <span class="main">&lt;</span> llength <span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>inf_llist <span class="free">t</span><span class="main">)</span><span class="main">)</span>›</span></span>
          <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound">i'</span><span class="main">.</span> <span class="skolem">i</span> <span class="main">≤</span> enat <span class="bound">i'</span> <span class="main">∧</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i'</span></sub><span class="hidden">⇙</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> nAct_less_llength_active<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="skolem">x</span></span> <span class="quoted"><span class="free">c</span></span> <span class="quoted"><span class="quoted">"inf_llist <span class="free">t</span>"</span></span> <span class="quoted"><span class="skolem">i</span></span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
        <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound"><span class="bound">i'</span></span><span class="main">≥</span><span class="skolem">i</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i'</span></sub><span class="hidden">⇙</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
        <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">i</span><span class="main">&lt;</span><span class="free">n'</span>"</span></span>
        <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
          <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="main">∃</span><span class="bound"><span class="bound">i</span></span><span class="main">≥</span><span class="free">n</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i</span></sub><span class="hidden">⇙</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="main">¬</span><span class="main">(</span><span class="main">∃</span><span class="bound"><span class="bound">i'</span></span><span class="main">≥</span><span class="free">n'</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i'</span></sub><span class="hidden">⇙</span><span class="main">)</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">n'</span><span class="main">≥</span><span class="main">⟨</span><span class="free">c</span> <span class="main">∧</span> <span class="free">t</span><span class="main">⟩</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> lActive_less <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
          <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span>↓<span class="hidden">⇘</span><sub><span class="free">t</span></sub><span class="hidden">⇙</span><span class="main">(</span><span class="free">n'</span><span class="main">)</span><span class="main">≥</span>the_enat<span class="main">(</span>llength <span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>inf_llist <span class="free">t</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">-</span> <span class="main">1</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> cnf2bhv_ge_llength <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
          <span class="keyword1"><span class="command">with</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">x</span><span class="main">&lt;</span>llength <span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>inf_llist <span class="free">t</span><span class="main">)</span><span class="main">)</span>›</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
            <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="main">¬</span> <span class="main">(</span><span class="main">∃</span><span class="bound"><span class="bound">i'</span></span><span class="main">≥</span><span class="free">n'</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i'</span></sub><span class="hidden">⇙</span><span class="main">)</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="skolem">i</span></sub><span class="hidden">⇙</span>›</span></span> le_neq_implies_less nat_le_linear <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
        <span class="keyword1"><span class="command">qed</span></span>
        <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">n'''</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"eval <span class="free">c</span> <span class="free">t</span> <span class="free">t'</span> <span class="skolem">n'''</span> <span class="free">γ'</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">n'''</span><span class="main">≥</span><span class="main">⟨</span><span class="free">c</span> <span class="main">⇐</span> <span class="free">t</span>⟩<span class="hidden">⇘</span><sub><span class="skolem">i</span></sub><span class="hidden">⇙</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">n'''</span><span class="main">≤</span><span class="main">⟨</span><span class="free">c</span> <span class="main">→</span> <span class="free">t</span>⟩<span class="hidden">⇘</span><sub><span class="skolem">i</span></sub><span class="hidden">⇙</span>"</span></span>
          <span class="keyword1"><span class="command">using</span></span> a2 <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
        <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="skolem">i</span></sub><span class="hidden">⇙</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="main">⟨</span><span class="free">c</span> <span class="main">→</span> <span class="free">t</span>⟩<span class="hidden">⇘</span><sub><span class="skolem">i</span></sub><span class="hidden">⇙</span></sub><span class="hidden">⇙</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> nxtActI <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword1"><span class="command">with</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">n'''</span><span class="main">≤</span><span class="main">⟨</span><span class="free">c</span> <span class="main">→</span> <span class="free">t</span>⟩<span class="hidden">⇘</span><sub><span class="skolem">i</span></sub><span class="hidden">⇙</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound"><span class="bound">i'</span></span><span class="main">≥</span><span class="skolem">n'''</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i'</span></sub><span class="hidden">⇙</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> less_or_eq_imp_le <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
        <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">γ'</span> <span class="main">(</span>lnth <span class="main">(</span><span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>inf_llist <span class="free">t</span><span class="main">)</span><span class="main">)</span> <span class="keyword1">@<span class="hidden">⇩</span><sub>l</sub></span> <span class="main">(</span>inf_llist <span class="free">t'</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">(</span>the_enat <span class="main">(</span><span class="main">⟨</span><span class="free">c</span> #<span class="hidden">⇘</span><sub><span class="skolem">n'''</span></sub><span class="hidden">⇙</span> inf_llist <span class="free">t</span><span class="main">⟩</span><span class="main">)</span><span class="main">)</span>"</span></span>
          <span class="keyword1"><span class="command">using</span></span> validCE_act<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="skolem">n'''</span></span> <span class="quoted"><span class="free">c</span></span> <span class="quoted"><span class="free">t</span></span> <span class="quoted"><span class="free">t'</span></span> <span class="quoted"><span class="free">γ'</span></span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
        <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">n'''</span><span class="main">≥</span><span class="main">⟨</span><span class="free">c</span> <span class="main">⇐</span> <span class="free">t</span>⟩<span class="hidden">⇘</span><sub><span class="skolem">i</span></sub><span class="hidden">⇙</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">n'''</span><span class="main">≤</span><span class="main">⟨</span><span class="free">c</span> <span class="main">→</span> <span class="free">t</span>⟩<span class="hidden">⇘</span><sub><span class="skolem">i</span></sub><span class="hidden">⇙</span>›</span></span>
          <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"the_enat <span class="main">(</span><span class="main">⟨</span><span class="free">c</span> #<span class="hidden">⇘</span><sub><span class="skolem">n'''</span></sub><span class="hidden">⇙</span> inf_llist <span class="free">t</span><span class="main">⟩</span><span class="main">)</span><span class="main">=</span>the_enat <span class="main">(</span><span class="main">⟨</span><span class="free">c</span> #<span class="hidden">⇘</span><sub><span class="skolem">i</span></sub><span class="hidden">⇙</span> inf_llist <span class="free">t</span><span class="main">⟩</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> nAct_same <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
        <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"the_enat <span class="main">(</span><span class="main">⟨</span><span class="free">c</span> #<span class="hidden">⇘</span><sub><span class="skolem">n'''</span></sub><span class="hidden">⇙</span> inf_llist <span class="free">t</span><span class="main">⟩</span><span class="main">)</span> <span class="main">=</span> <span class="skolem">x</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">x</span> <span class="main">=</span> the_enat <span class="main">⟨</span><span class="free">c</span> #<span class="hidden">⇘</span><sub>enat <span class="skolem">i</span></sub><span class="hidden">⇙</span>inf_llist <span class="free">t</span><span class="main">⟩</span>›</span></span><span class="main">)</span>
        <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">γ'</span> <span class="main">(</span>lnth <span class="main">(</span><span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>inf_llist <span class="free">t</span><span class="main">)</span><span class="main">)</span> <span class="keyword1">@<span class="hidden">⇩</span><sub>l</sub></span> <span class="main">(</span>inf_llist <span class="free">t'</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">(</span>the_enat <span class="skolem">x</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
        <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
      <span class="keyword1"><span class="command">qed</span></span>
    <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"eval <span class="free">c</span> <span class="free">t</span> <span class="free">t'</span> <span class="free">n</span> <span class="main">(</span><span class="main">λ</span> <span class="bound">t</span> <span class="bound">n</span><span class="main">.</span> <span class="main">∃</span><span class="bound"><span class="bound">n''</span></span><span class="main">≥</span><span class="bound">n</span><span class="main">.</span> <span class="free">γ</span> <span class="bound">t</span> <span class="bound">n''</span> <span class="main">∧</span> <span class="main">(</span><span class="main">∀</span><span class="bound"><span class="bound">n'</span></span><span class="main">≥</span><span class="bound">n</span><span class="main">.</span> <span class="bound">n'</span> <span class="main">&lt;</span> <span class="bound">n''</span> <span class="main">⟶</span> <span class="free">γ'</span> <span class="bound">t</span> <span class="bound">n'</span><span class="main">)</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="main">∃</span><span class="bound"><span class="bound">i</span></span><span class="main">≥</span><span class="free">n</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i</span></sub><span class="hidden">⇙</span>›</span></span> validCI_act<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="free">n</span></span> <span class="quoted"><span class="free">c</span></span> <span class="quoted"><span class="free">t</span></span> <span class="quoted"><span class="quoted">"<span class="main">λ</span> <span class="bound">t</span> <span class="bound">n</span><span class="main">.</span> <span class="main">∃</span><span class="bound"><span class="bound">n''</span></span><span class="main">≥</span><span class="bound">n</span><span class="main">.</span> <span class="free">γ</span> <span class="bound">t</span> <span class="bound">n''</span> <span class="main">∧</span> <span class="main">(</span><span class="main">∀</span><span class="bound"><span class="bound">n'</span></span><span class="main">≥</span><span class="bound">n</span><span class="main">.</span> <span class="bound">n'</span> <span class="main">&lt;</span> <span class="bound">n''</span> <span class="main">⟶</span> <span class="free">γ'</span> <span class="bound">t</span> <span class="bound">n'</span><span class="main">)</span>"</span></span> <span class="quoted"><span class="free">t'</span></span><span class="main">]</span>
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> until_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>
  
<span class="keyword1" id="Dynamic_Architecture_Calculus-untilIN"><span class="command">lemma</span></span> untilIN<span class="main">[</span><span class="operator">intro</span><span class="main">]</span><span class="main">:</span>
  <span class="keyword2"><span class="keyword">fixes</span></span> <span class="free">c</span><span class="main">::</span><span class="tfree"><span class="quoted"><span class="tfree">'id</span></span></span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="free">t</span><span class="main">::</span><span class="quoted"><span class="quoted">"nat <span class="main">⇒</span> cnf"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="free">t'</span><span class="main">::</span><span class="quoted"><span class="quoted">"nat <span class="main">⇒</span> <span class="tfree">'cmp</span>"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="free">n</span><span class="main">::</span><span class="quoted">nat</span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="free">n'</span><span class="main">::</span><span class="quoted">nat</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span><span class="main">(</span><span class="main">∃</span><span class="bound"><span class="bound">i</span></span><span class="main">≥</span><span class="free">n</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i</span></sub><span class="hidden">⇙</span><span class="main">)</span>"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">n'</span><span class="main">≥</span><span class="free">n</span>"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"eval <span class="free">c</span> <span class="free">t</span> <span class="free">t'</span> <span class="free">n'</span> <span class="free">γ</span>"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> a1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">⋀</span><span class="bound">n''</span><span class="main">.</span> <span class="main">⟦</span><span class="free">n</span><span class="main">≤</span><span class="bound">n''</span><span class="main">;</span> <span class="bound">n''</span><span class="main">&lt;</span><span class="free">n'</span><span class="main">⟧</span> <span class="main">⟹</span> eval <span class="free">c</span> <span class="free">t</span> <span class="free">t'</span> <span class="bound">n''</span> <span class="free">γ'</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"eval <span class="free">c</span> <span class="free">t</span> <span class="free">t'</span> <span class="free">n</span> <span class="main">(</span><span class="free">γ'</span> <span class="keyword1">𝔘<span class="hidden">⇩</span><sub>b</sub></span> <span class="free">γ</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">cases</span>
  <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound">i</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i</span></sub><span class="hidden">⇙</span>"</span></span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> assms<span class="main">(</span>1<span class="main">)</span> assms<span class="main">(</span>2<span class="main">)</span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span><span class="main">(</span><span class="main">∃</span><span class="bound"><span class="bound">i'</span></span><span class="main">≥</span><span class="free">n'</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i'</span></sub><span class="hidden">⇙</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">γ</span> <span class="main">(</span>lnth <span class="main">(</span><span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>inf_llist <span class="free">t</span><span class="main">)</span><span class="main">)</span> <span class="keyword1">@<span class="hidden">⇩</span><sub>l</sub></span> <span class="main">(</span>inf_llist <span class="free">t'</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">(</span><span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span>↓<span class="hidden">⇘</span><sub><span class="free">t</span></sub><span class="hidden">⇙</span><span class="main">(</span><span class="free">n'</span><span class="main">)</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> validCE_cont<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="free">c</span></span> <span class="quoted"><span class="free">t</span></span> <span class="quoted"><span class="free">n'</span></span> <span class="quoted"><span class="free">t'</span></span> <span class="quoted"><span class="free">γ</span></span><span class="main">]</span> <span class="quoted"><span class="quoted">‹eval <span class="free">c</span> <span class="free">t</span> <span class="free">t'</span> <span class="free">n'</span> <span class="free">γ</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="free">n'</span><span class="main">≥</span><span class="free">n</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span>↓<span class="hidden">⇘</span><sub><span class="free">t</span></sub><span class="hidden">⇙</span><span class="main">(</span><span class="free">n'</span><span class="main">)</span> <span class="main">≥</span> <span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span>↓<span class="hidden">⇘</span><sub><span class="free">t</span></sub><span class="hidden">⇙</span><span class="main">(</span><span class="free">n</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> cnf2bhv_mono <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound"><span class="bound">x</span></span><span class="main">::</span>nat<span class="main">≥</span> <span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span>↓<span class="hidden">⇘</span><sub><span class="free">t</span></sub><span class="hidden">⇙</span><span class="main">(</span><span class="free">n</span><span class="main">)</span><span class="main">.</span> <span class="bound">x</span><span class="main">&lt;</span><span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span>↓<span class="hidden">⇘</span><sub><span class="free">t</span></sub><span class="hidden">⇙</span><span class="main">(</span><span class="free">n'</span><span class="main">)</span> <span class="main">⟶</span> <span class="free">γ'</span> <span class="main">(</span>lnth <span class="main">(</span><span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>inf_llist <span class="free">t</span><span class="main">)</span><span class="main">)</span> <span class="keyword1">@<span class="hidden">⇩</span><sub>l</sub></span> <span class="main">(</span>inf_llist <span class="free">t'</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="bound">x</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">rule</span> HOL.allI<span class="main"><span class="main">[</span></span><span class="operator">OF</span> HOL.impI<span class="main"><span class="main">[</span></span><span class="operator">OF</span> HOL.impI<span class="main"><span class="main">]</span></span><span class="main"><span class="main">]</span></span><span class="main">)</span>
    <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">x</span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span><span class="main">≥</span><span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span>↓<span class="hidden">⇘</span><sub><span class="free">t</span></sub><span class="hidden">⇙</span><span class="main">(</span><span class="free">n</span><span class="main">)</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span><span class="main">&lt;</span><span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span>↓<span class="hidden">⇘</span><sub><span class="free">t</span></sub><span class="hidden">⇙</span><span class="main">(</span><span class="free">n'</span><span class="main">)</span>"</span></span>
  
    <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="main">¬</span><span class="main">(</span><span class="main">∃</span><span class="bound"><span class="bound">i</span></span><span class="main">≥</span><span class="free">n</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i</span></sub><span class="hidden">⇙</span><span class="main">)</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">⟨</span><span class="free">c</span> <span class="main">∧</span> <span class="free">t</span><span class="main">⟩</span> <span class="main">≤</span> <span class="free">n</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="main">∃</span><span class="bound">i</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i</span></sub><span class="hidden">⇙</span>›</span></span> lActive_less <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">with</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">x</span><span class="main">≥</span><span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span>↓<span class="hidden">⇘</span><sub><span class="free">t</span></sub><span class="hidden">⇙</span><span class="main">(</span><span class="free">n</span><span class="main">)</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span>↑<span class="hidden">⇘</span><sub><span class="free">t</span></sub><span class="hidden">⇙</span><span class="main">(</span><span class="skolem">x</span><span class="main">)</span> <span class="main">≥</span> <span class="free">n</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> p2c_mono_c2p <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="main">⟨</span><span class="free">c</span> <span class="main">∧</span> <span class="free">t</span><span class="main">⟩</span> <span class="main">≤</span> <span class="free">n</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span>↓<span class="hidden">⇘</span><sub><span class="free">t</span></sub><span class="hidden">⇙</span><span class="main">(</span><span class="free">n</span><span class="main">)</span> <span class="main">≤</span> <span class="skolem">x</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">≥</span> the_enat <span class="main">(</span>llength <span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>inf_llist <span class="free">t</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">-</span> <span class="main">1</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> cnf2bhv_ge_llength dual_order.trans <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
    <span class="keyword1"><span class="command">with</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">x</span><span class="main">&lt;</span><span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span>↓<span class="hidden">⇘</span><sub><span class="free">t</span></sub><span class="hidden">⇙</span><span class="main">(</span><span class="free">n'</span><span class="main">)</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span>↑<span class="hidden">⇘</span><sub><span class="free">t</span></sub><span class="hidden">⇙</span><span class="main">(</span><span class="skolem">x</span><span class="main">)</span> <span class="main">&lt;</span> <span class="free">n'</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> c2p_mono_p2c_strict<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="free">c</span></span> <span class="quoted"><span class="free">t</span></span> <span class="quoted"><span class="skolem">x</span></span> <span class="quoted"><span class="free">n'</span></span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="main">¬</span> <span class="main">(</span><span class="main">∃</span><span class="bound"><span class="bound">i</span></span><span class="main">≥</span><span class="free">n</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i</span></sub><span class="hidden">⇙</span><span class="main">)</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span>↑<span class="hidden">⇘</span><sub><span class="free">t</span></sub><span class="hidden">⇙</span><span class="main">(</span><span class="skolem">x</span><span class="main">)</span> <span class="main">≥</span> <span class="free">n</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> <span class="main">(</span><span class="main">∃</span><span class="bound"><span class="bound">i''</span></span><span class="main">≥</span><span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span>↑<span class="hidden">⇘</span><sub><span class="free">t</span></sub><span class="hidden">⇙</span><span class="main">(</span><span class="skolem">x</span><span class="main">)</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i''</span></sub><span class="hidden">⇙</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"eval <span class="free">c</span> <span class="free">t</span> <span class="free">t'</span> <span class="main">(</span><span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span>↑<span class="hidden">⇘</span><sub><span class="free">t</span></sub><span class="hidden">⇙</span><span class="main">(</span><span class="skolem">x</span><span class="main">)</span><span class="main">)</span> <span class="free">γ'</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> a1<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="quoted">"<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span>↑<span class="hidden">⇘</span><sub><span class="free">t</span></sub><span class="hidden">⇙</span><span class="main">(</span><span class="skolem">x</span><span class="main">)</span>"</span></span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">with</span></span> <span class="quoted"><span class="quoted">‹<span class="main">¬</span> <span class="main">(</span><span class="main">∃</span><span class="bound"><span class="bound">i''</span></span><span class="main">≥</span><span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span>↑<span class="hidden">⇘</span><sub><span class="free">t</span></sub><span class="hidden">⇙</span><span class="skolem">x</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i''</span></sub><span class="hidden">⇙</span><span class="main">)</span>›</span></span>
      <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">γ'</span> <span class="main">(</span>lnth <span class="main">(</span><span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>inf_llist <span class="free">t</span><span class="main">)</span><span class="main">)</span> <span class="keyword1">@<span class="hidden">⇩</span><sub>l</sub></span> <span class="main">(</span>inf_llist <span class="free">t'</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">(</span><span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span>↓<span class="hidden">⇘</span><sub><span class="free">t</span></sub><span class="hidden">⇙</span><span class="main">(</span><span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span>↑<span class="hidden">⇘</span><sub><span class="free">t</span></sub><span class="hidden">⇙</span><span class="main">(</span><span class="skolem">x</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> validCE_cont<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="free">c</span></span> <span class="quoted"><span class="free">t</span></span> <span class="quoted"><span class="quoted">"<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span>↑<span class="hidden">⇘</span><sub><span class="free">t</span></sub><span class="hidden">⇙</span><span class="main">(</span><span class="skolem">x</span><span class="main">)</span>"</span></span> <span class="quoted"><span class="free">t'</span></span> <span class="quoted"><span class="free">γ'</span></span><span class="main">]</span> <span class="quoted"><span class="quoted">‹<span class="main">∃</span><span class="bound">i</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i</span></sub><span class="hidden">⇙</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
    <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">≥</span> the_enat <span class="main">(</span>llength <span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>inf_llist <span class="free">t</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">-</span> <span class="main">1</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span>↓<span class="hidden">⇘</span><sub><span class="free">t</span></sub><span class="hidden">⇙</span><span class="main">(</span><span class="free">n</span><span class="main">)</span> <span class="main">≤</span> <span class="skolem">x</span>›</span></span> cnf2bhv_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="free">γ'</span> <span class="main">(</span>lnth <span class="main">(</span><span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>inf_llist <span class="free">t</span><span class="main">)</span><span class="main">)</span> <span class="keyword1">@<span class="hidden">⇩</span><sub>l</sub></span> <span class="main">(</span>inf_llist <span class="free">t'</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">(</span><span class="skolem">x</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> cnf2bhv_bhv2cnf <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">qed</span></span>   
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"eval <span class="free">c</span> <span class="free">t</span> <span class="free">t'</span> <span class="free">n</span> <span class="main">(</span><span class="main">λ</span> <span class="bound">t</span> <span class="bound">n</span><span class="main">.</span> <span class="main">∃</span><span class="bound"><span class="bound">n''</span></span><span class="main">≥</span><span class="bound">n</span><span class="main">.</span> <span class="free">γ</span> <span class="bound">t</span> <span class="bound">n''</span> <span class="main">∧</span> <span class="main">(</span><span class="main">∀</span><span class="bound"><span class="bound">n'</span></span><span class="main">≥</span><span class="bound">n</span><span class="main">.</span> <span class="bound">n'</span> <span class="main">&lt;</span> <span class="bound">n''</span> <span class="main">⟶</span> <span class="free">γ'</span> <span class="bound">t</span> <span class="bound">n'</span><span class="main">)</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> validCI_cont<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="free">c</span></span> <span class="quoted"><span class="free">t</span></span> <span class="quoted"><span class="free">n</span></span> <span class="quoted"><span class="quoted">"<span class="main">λ</span> <span class="bound">t</span> <span class="bound">n</span><span class="main">.</span> <span class="main">∃</span><span class="bound"><span class="bound">n''</span></span><span class="main">≥</span><span class="bound">n</span><span class="main">.</span> <span class="free">γ</span> <span class="bound">t</span> <span class="bound">n''</span> <span class="main">∧</span> <span class="main">(</span><span class="main">∀</span><span class="bound"><span class="bound">n'</span></span><span class="main">≥</span><span class="bound">n</span><span class="main">.</span> <span class="bound">n'</span> <span class="main">&lt;</span> <span class="bound">n''</span> <span class="main">⟶</span> <span class="free">γ'</span> <span class="bound">t</span> <span class="bound">n'</span><span class="main">)</span>"</span></span> <span class="quoted"><span class="free">t'</span></span><span class="main">]</span>
    <span class="quoted"><span class="quoted">‹<span class="main">∃</span><span class="bound">i</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i</span></sub><span class="hidden">⇙</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="main">¬</span><span class="main">(</span><span class="main">∃</span><span class="bound"><span class="bound">i'</span></span><span class="main">≥</span><span class="free">n</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i'</span></sub><span class="hidden">⇙</span><span class="main">)</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> until_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">next</span></span>
  <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span><span class="main">(</span><span class="main">∃</span><span class="bound">i</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i</span></sub><span class="hidden">⇙</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">with</span></span> assms <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound"><span class="bound">n''</span></span><span class="main">≥</span><span class="free">n</span><span class="main">.</span> <span class="free">γ</span> <span class="main">(</span>lnth <span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span>inf_llist <span class="free">t</span> <span class="keyword1">@<span class="hidden">⇩</span><sub>l</sub></span> inf_llist <span class="free">t'</span><span class="main">)</span><span class="main">)</span> <span class="bound">n''</span> <span class="main">∧</span>
    <span class="main">(</span><span class="main">∀</span><span class="bound"><span class="bound">n'</span></span><span class="main">≥</span><span class="free">n</span><span class="main">.</span> <span class="bound">n'</span> <span class="main">&lt;</span> <span class="bound">n''</span> <span class="main">⟶</span> <span class="free">γ'</span> <span class="main">(</span>lnth <span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span>inf_llist <span class="free">t</span> <span class="keyword1">@<span class="hidden">⇩</span><sub>l</sub></span> inf_llist <span class="free">t'</span><span class="main">)</span><span class="main">)</span> <span class="bound">n'</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> validCE_not_act <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">with</span></span> <span class="quoted"><span class="quoted">‹<span class="main">¬</span><span class="main">(</span><span class="main">∃</span><span class="bound">i</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i</span></sub><span class="hidden">⇙</span><span class="main">)</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"eval <span class="free">c</span> <span class="free">t</span> <span class="free">t'</span> <span class="free">n</span> <span class="main">(</span><span class="main">λ</span> <span class="bound">t</span> <span class="bound">n</span><span class="main">.</span> <span class="main">∃</span><span class="bound"><span class="bound">n''</span></span><span class="main">≥</span><span class="bound">n</span><span class="main">.</span> <span class="free">γ</span> <span class="bound">t</span> <span class="bound">n''</span> <span class="main">∧</span> <span class="main">(</span><span class="main">∀</span><span class="bound"><span class="bound">n'</span></span><span class="main">≥</span><span class="bound">n</span><span class="main">.</span> <span class="bound">n'</span> <span class="main">&lt;</span> <span class="bound">n''</span> <span class="main">⟶</span> <span class="free">γ'</span> <span class="bound">t</span> <span class="bound">n'</span><span class="main">)</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> validCI_not_act<span class="main">[</span><span class="keyword2"><span class="keyword"><span class="operator">where</span></span></span> γ<span class="main"><span class="main">=</span></span><span class="quoted"><span class="quoted">"<span class="main">λ</span> <span class="bound">t</span> <span class="bound">n</span><span class="main">.</span> <span class="main">∃</span><span class="bound"><span class="bound">n''</span></span><span class="main">≥</span><span class="bound">n</span><span class="main">.</span> <span class="free">γ</span> <span class="bound">t</span> <span class="bound">n''</span> <span class="main">∧</span> <span class="main">(</span><span class="main">∀</span><span class="bound"><span class="bound">n'</span></span><span class="main">≥</span><span class="bound">n</span><span class="main">.</span> <span class="bound">n'</span> <span class="main">&lt;</span> <span class="bound">n''</span> <span class="main">⟶</span> <span class="free">γ'</span> <span class="bound">t</span> <span class="bound">n'</span><span class="main">)</span>"</span></span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> until_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>
  
<span class="keyword1" id="Dynamic_Architecture_Calculus-untilEA"><span class="command">lemma</span></span> untilEA<span class="main">[</span><span class="operator">elim</span><span class="main">]</span><span class="main">:</span>
  <span class="keyword2"><span class="keyword">fixes</span></span> <span class="free">n</span><span class="main">::</span><span class="quoted">nat</span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="free">n'</span><span class="main">::</span><span class="quoted">nat</span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="free">t</span><span class="main">::</span><span class="quoted"><span class="quoted">"nat <span class="main">⇒</span> cnf"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="free">t'</span><span class="main">::</span><span class="quoted"><span class="quoted">"nat <span class="main">⇒</span> <span class="tfree">'cmp</span>"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="free">c</span><span class="main">::</span><span class="tfree"><span class="quoted"><span class="tfree">'id</span></span></span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound"><span class="bound">i</span></span><span class="main">≥</span><span class="free">n</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i</span></sub><span class="hidden">⇙</span>"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"eval <span class="free">c</span> <span class="free">t</span> <span class="free">t'</span> <span class="free">n</span> <span class="main">(</span><span class="free">γ'</span> <span class="keyword1">𝔘<span class="hidden">⇩</span><sub>b</sub></span> <span class="free">γ</span><span class="main">)</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound"><span class="bound">n'</span></span><span class="main">≥</span><span class="main">⟨</span><span class="free">c</span> <span class="main">→</span> <span class="free">t</span>⟩<span class="hidden">⇘</span><sub><span class="free">n</span></sub><span class="hidden">⇙</span><span class="main">.</span>
    <span class="main">(</span><span class="main">(</span><span class="main">∃</span><span class="bound"><span class="bound">i</span></span><span class="main">≥</span><span class="bound">n'</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i</span></sub><span class="hidden">⇙</span><span class="main">)</span> <span class="main">∧</span> <span class="main">(</span><span class="main">∀</span><span class="bound"><span class="bound">n''</span></span><span class="main">≥</span> <span class="main">⟨</span><span class="free">c</span> <span class="main">⇐</span> <span class="free">t</span>⟩<span class="hidden">⇘</span><sub><span class="bound">n'</span></sub><span class="hidden">⇙</span><span class="main">.</span> <span class="bound">n''</span><span class="main">≤</span><span class="main">⟨</span><span class="free">c</span> <span class="main">→</span> <span class="free">t</span>⟩<span class="hidden">⇘</span><sub><span class="bound">n'</span></sub><span class="hidden">⇙</span> <span class="main">⟶</span> eval <span class="free">c</span> <span class="free">t</span> <span class="free">t'</span> <span class="bound">n''</span> <span class="free">γ</span><span class="main">)</span>
      <span class="main">∧</span> <span class="main">(</span><span class="main">∀</span><span class="bound"><span class="bound">n''</span></span><span class="main">≥</span><span class="main">⟨</span><span class="free">c</span> <span class="main">⇐</span> <span class="free">t</span>⟩<span class="hidden">⇘</span><sub><span class="free">n</span></sub><span class="hidden">⇙</span><span class="main">.</span> <span class="bound">n''</span> <span class="main">&lt;</span> <span class="main">⟨</span><span class="free">c</span> <span class="main">⇐</span> <span class="free">t</span>⟩<span class="hidden">⇘</span><sub><span class="bound">n'</span></sub><span class="hidden">⇙</span> <span class="main">⟶</span> eval <span class="free">c</span> <span class="free">t</span> <span class="free">t'</span> <span class="bound">n''</span> <span class="free">γ'</span><span class="main">)</span> <span class="main">∨</span>
    <span class="main">(</span><span class="main">¬</span><span class="main">(</span><span class="main">∃</span><span class="bound"><span class="bound">i</span></span><span class="main">≥</span><span class="bound">n'</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i</span></sub><span class="hidden">⇙</span><span class="main">)</span><span class="main">)</span> <span class="main">∧</span> eval <span class="free">c</span> <span class="free">t</span> <span class="free">t'</span> <span class="bound">n'</span> <span class="free">γ</span> <span class="main">∧</span> <span class="main">(</span><span class="main">∀</span><span class="bound"><span class="bound">n''</span></span><span class="main">≥</span><span class="main">⟨</span><span class="free">c</span> <span class="main">⇐</span> <span class="free">t</span>⟩<span class="hidden">⇘</span><sub><span class="free">n</span></sub><span class="hidden">⇙</span><span class="main">.</span> <span class="bound">n''</span> <span class="main">&lt;</span> <span class="bound">n'</span> <span class="main">⟶</span> eval <span class="free">c</span> <span class="free">t</span> <span class="free">t'</span> <span class="bound">n''</span> <span class="free">γ'</span><span class="main">)</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹eval <span class="free">c</span> <span class="free">t</span> <span class="free">t'</span> <span class="free">n</span> <span class="main">(</span><span class="free">γ'</span> <span class="keyword1">𝔘<span class="hidden">⇩</span><sub>b</sub></span> <span class="free">γ</span><span class="main">)</span>›</span></span>
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"eval <span class="free">c</span> <span class="free">t</span> <span class="free">t'</span> <span class="free">n</span> <span class="main">(</span><span class="main">λ</span> <span class="bound">t</span> <span class="bound">n</span><span class="main">.</span> <span class="main">∃</span><span class="bound"><span class="bound">n''</span></span><span class="main">≥</span><span class="bound">n</span><span class="main">.</span> <span class="free">γ</span> <span class="bound">t</span> <span class="bound">n''</span> <span class="main">∧</span> <span class="main">(</span><span class="main">∀</span><span class="bound"><span class="bound">n'</span></span><span class="main">≥</span><span class="bound">n</span><span class="main">.</span> <span class="bound">n'</span> <span class="main">&lt;</span> <span class="bound">n''</span> <span class="main">⟶</span> <span class="free">γ'</span> <span class="bound">t</span> <span class="bound">n'</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> until_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">with</span></span> <span class="quoted"><span class="quoted">‹<span class="main">∃</span><span class="bound"><span class="bound">i</span></span><span class="main">≥</span><span class="free">n</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i</span></sub><span class="hidden">⇙</span>›</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">x</span></span>
    <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span><span class="main">≥</span>the_enat <span class="main">⟨</span><span class="free">c</span> #<span class="hidden">⇘</span><sub>enat <span class="free">n</span></sub><span class="hidden">⇙</span>inf_llist <span class="free">t</span><span class="main">⟩</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">γ</span> <span class="main">(</span>lnth <span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span>inf_llist <span class="free">t</span> <span class="keyword1">@<span class="hidden">⇩</span><sub>l</sub></span> inf_llist <span class="free">t'</span><span class="main">)</span><span class="main">)</span> <span class="skolem">x</span>"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> a1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound"><span class="bound">x'</span></span><span class="main">≥</span>the_enat <span class="main">⟨</span><span class="free">c</span> #<span class="hidden">⇘</span><sub>enat <span class="free">n</span></sub><span class="hidden">⇙</span>inf_llist <span class="free">t</span><span class="main">⟩</span><span class="main">.</span> <span class="bound">x'</span> <span class="main">&lt;</span> <span class="skolem">x</span> <span class="main">⟶</span> <span class="free">γ'</span> <span class="main">(</span>lnth <span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span>inf_llist <span class="free">t</span> <span class="keyword1">@<span class="hidden">⇩</span><sub>l</sub></span> inf_llist <span class="free">t'</span><span class="main">)</span><span class="main">)</span> <span class="bound">x'</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> validCE_act<span class="main">[</span><span class="keyword2"><span class="keyword"><span class="operator">where</span></span></span> γ<span class="main"><span class="main">=</span></span><span class="quoted"><span class="quoted">"<span class="main">λ</span> <span class="bound">t</span> <span class="bound">n</span><span class="main">.</span> <span class="main">∃</span><span class="bound"><span class="bound">n''</span></span><span class="main">≥</span><span class="bound">n</span><span class="main">.</span> <span class="free">γ</span> <span class="bound">t</span> <span class="bound">n''</span> <span class="main">∧</span> <span class="main">(</span><span class="main">∀</span><span class="bound"><span class="bound">n'</span></span><span class="main">≥</span><span class="bound">n</span><span class="main">.</span> <span class="bound">n'</span> <span class="main">&lt;</span> <span class="bound">n''</span> <span class="main">⟶</span> <span class="free">γ'</span> <span class="bound">t</span> <span class="bound">n'</span><span class="main">)</span>"</span></span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">cases</span><span class="main">)</span>
    <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">≥</span> llength <span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>inf_llist <span class="free">t</span><span class="main">)</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="main">(</span><span class="skolem">x</span> <span class="main">≥</span> llength <span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>inf_llist <span class="free">t</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"llength <span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>inf_llist <span class="free">t</span><span class="main">)</span><span class="main">)</span><span class="main">≠</span><span class="main">∞</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> infinity_ileE<span class="main">)</span>
    <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="main">∃</span><span class="bound"><span class="bound">i</span></span><span class="main">≥</span><span class="free">n</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i</span></sub><span class="hidden">⇙</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"llength <span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>inf_llist <span class="free">t</span><span class="main">)</span><span class="main">)</span><span class="main">≥</span><span class="main">1</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> proj_one<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="quoted">"inf_llist <span class="free">t</span>"</span></span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"the_enat <span class="main">(</span>llength <span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>inf_llist <span class="free">t</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">-</span> <span class="main">1</span> <span class="main">&lt;</span> <span class="skolem">x</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> One_nat_def Suc_ile_eq antisym_conv2 diff_Suc_less enat_ord_simps<span class="main"><span class="main">(</span></span>2<span class="main"><span class="main">)</span></span>
          enat_the_enat less_imp_diff_less one_enat_def<span class="main">)</span>
    <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">=</span> <span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span>↓<span class="hidden">⇘</span><sub><span class="free">t</span></sub><span class="hidden">⇙</span><span class="main">(</span><span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span>↑<span class="hidden">⇘</span><sub><span class="free">t</span></sub><span class="hidden">⇙</span><span class="main">(</span><span class="skolem">x</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> cnf2bhv_bhv2cnf <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">with</span></span> <span class="quoted"><span class="quoted">‹<span class="free">γ</span> <span class="main">(</span>lnth <span class="main">(</span><span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>inf_llist <span class="free">t</span><span class="main">)</span><span class="main">)</span> <span class="keyword1">@<span class="hidden">⇩</span><sub>l</sub></span> <span class="main">(</span>inf_llist <span class="free">t'</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="skolem">x</span>›</span></span>
      <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">γ</span> <span class="main">(</span>lnth <span class="main">(</span><span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>inf_llist <span class="free">t</span><span class="main">)</span><span class="main">)</span> <span class="keyword1">@<span class="hidden">⇩</span><sub>l</sub></span> <span class="main">(</span>inf_llist <span class="free">t'</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">(</span><span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span>↓<span class="hidden">⇘</span><sub><span class="free">t</span></sub><span class="hidden">⇙</span><span class="main">(</span><span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span>↑<span class="hidden">⇘</span><sub><span class="free">t</span></sub><span class="hidden">⇙</span><span class="main">(</span><span class="skolem">x</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span><span class="main">(</span><span class="main">∃</span><span class="bound"><span class="bound">i</span></span><span class="main">≥</span><span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span>↑<span class="hidden">⇘</span><sub><span class="free">t</span></sub><span class="hidden">⇙</span><span class="main">(</span><span class="skolem">x</span><span class="main">)</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i</span></sub><span class="hidden">⇙</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
      <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">x</span> <span class="main">≥</span> llength <span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>inf_llist <span class="free">t</span><span class="main">)</span><span class="main">)</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"lfinite <span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>inf_llist <span class="free">t</span><span class="main">)</span><span class="main">)</span>"</span></span>
        <span class="keyword1"><span class="command">using</span></span> llength_geq_enat_lfiniteD<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="quoted">"π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>inf_llist <span class="free">t</span><span class="main">)</span>"</span></span> <span class="quoted"><span class="skolem">x</span></span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
      <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">z</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound"><span class="bound">n''</span></span><span class="main">&gt;</span><span class="skolem">z</span><span class="main">.</span> <span class="main">¬</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">n''</span></sub><span class="hidden">⇙</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> proj_finite_bound <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
      <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹the_enat <span class="main">(</span>llength <span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>inf_llist <span class="free">t</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">-</span> <span class="main">1</span> <span class="main">&lt;</span> <span class="skolem">x</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">⟨</span><span class="free">c</span> <span class="main">∧</span> <span class="free">t</span><span class="main">⟩</span> <span class="main">&lt;</span> <span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span>↑<span class="hidden">⇘</span><sub><span class="free">t</span></sub><span class="hidden">⇙</span><span class="main">(</span><span class="skolem">x</span><span class="main">)</span>"</span></span>
        <span class="keyword1"><span class="command">using</span></span> bhv2cnf_greater_lActive <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
      <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> lActive_greater_active_all <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">qed</span></span>
    <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"eval <span class="free">c</span> <span class="free">t</span> <span class="free">t'</span> <span class="main">(</span><span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span>↑<span class="hidden">⇘</span><sub><span class="free">t</span></sub><span class="hidden">⇙</span><span class="skolem">x</span><span class="main">)</span> <span class="free">γ</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="main">∃</span><span class="bound"><span class="bound">i</span></span><span class="main">≥</span><span class="free">n</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i</span></sub><span class="hidden">⇙</span>›</span></span> validCI_cont<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="free">c</span></span> <span class="quoted"><span class="free">t</span></span> <span class="quoted"><span class="quoted">"<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span>↑<span class="hidden">⇘</span><sub><span class="free">t</span></sub><span class="hidden">⇙</span><span class="main">(</span><span class="skolem">x</span><span class="main">)</span>"</span></span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
    <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span>↑<span class="hidden">⇘</span><sub><span class="free">t</span></sub><span class="hidden">⇙</span><span class="main">(</span><span class="skolem">x</span><span class="main">)</span> <span class="main">≥</span> <span class="main">⟨</span><span class="free">c</span> <span class="main">→</span> <span class="free">t</span>⟩<span class="hidden">⇘</span><sub><span class="free">n</span></sub><span class="hidden">⇙</span>"</span></span>
    <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
      <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">x</span> <span class="main">≥</span> llength <span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>inf_llist <span class="free">t</span><span class="main">)</span><span class="main">)</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"lfinite <span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>inf_llist <span class="free">t</span><span class="main">)</span><span class="main">)</span>"</span></span>
        <span class="keyword1"><span class="command">using</span></span> llength_geq_enat_lfiniteD<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="quoted">"π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>inf_llist <span class="free">t</span><span class="main">)</span>"</span></span> <span class="quoted"><span class="skolem">x</span></span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
      <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">z</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound"><span class="bound">n''</span></span><span class="main">&gt;</span><span class="skolem">z</span><span class="main">.</span> <span class="main">¬</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">n''</span></sub><span class="hidden">⇙</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> proj_finite_bound <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
      <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="main">∃</span><span class="bound"><span class="bound">i</span></span><span class="main">≥</span><span class="free">n</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i</span></sub><span class="hidden">⇙</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="main">⟨</span><span class="free">c</span> <span class="main">→</span> <span class="free">t</span>⟩<span class="hidden">⇘</span><sub><span class="free">n</span></sub><span class="hidden">⇙</span></sub><span class="hidden">⇙</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> nxtActI <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
      <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">⟨</span><span class="free">c</span> <span class="main">∧</span> <span class="free">t</span><span class="main">⟩</span><span class="main">≥</span><span class="main">⟨</span><span class="free">c</span> <span class="main">→</span> <span class="free">t</span>⟩<span class="hidden">⇘</span><sub><span class="free">n</span></sub><span class="hidden">⇙</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> lActive_greatest <span class="keyword1"><span class="command">by</span></span> <span class="operator">fastforce</span>
      <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span>↑<span class="hidden">⇘</span><sub><span class="free">t</span></sub><span class="hidden">⇙</span><span class="main">(</span><span class="skolem">x</span><span class="main">)</span> <span class="main">≥</span> <span class="main">⟨</span><span class="free">c</span> <span class="main">∧</span> <span class="free">t</span><span class="main">⟩</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
      <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span>↑<span class="hidden">⇘</span><sub><span class="free">t</span></sub><span class="hidden">⇙</span><span class="main">(</span><span class="skolem">x</span><span class="main">)</span> <span class="main">≥</span> <span class="main">⟨</span><span class="free">c</span> <span class="main">→</span> <span class="free">t</span>⟩<span class="hidden">⇘</span><sub><span class="free">n</span></sub><span class="hidden">⇙</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">arith</span>
    <span class="keyword1"><span class="command">qed</span></span>
    <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound"><span class="bound">n''</span></span><span class="main">≥</span><span class="main">⟨</span><span class="free">c</span> <span class="main">⇐</span> <span class="free">t</span>⟩<span class="hidden">⇘</span><sub><span class="free">n</span></sub><span class="hidden">⇙</span><span class="main">.</span> <span class="bound">n''</span> <span class="main">&lt;</span> <span class="main">(</span><span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span>↑<span class="hidden">⇘</span><sub><span class="free">t</span></sub><span class="hidden">⇙</span><span class="skolem">x</span><span class="main">)</span> <span class="main">⟶</span> eval <span class="free">c</span> <span class="free">t</span> <span class="free">t'</span> <span class="bound">n''</span> <span class="free">γ'</span>"</span></span>
    <span class="keyword1"><span class="command">proof</span></span>
      <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">n''</span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">⟨</span><span class="free">c</span> <span class="main">⇐</span> <span class="free">t</span>⟩<span class="hidden">⇘</span><sub><span class="free">n</span></sub><span class="hidden">⇙</span> <span class="main">≤</span> <span class="skolem">n''</span> <span class="main">⟶</span> <span class="skolem">n''</span> <span class="main">&lt;</span> <span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span>↑<span class="hidden">⇘</span><sub><span class="free">t</span></sub><span class="hidden">⇙</span><span class="skolem">x</span> <span class="main">⟶</span> eval <span class="free">c</span> <span class="free">t</span> <span class="free">t'</span> <span class="skolem">n''</span> <span class="free">γ'</span>"</span></span>
      <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">rule</span> HOL.impI<span class="main"><span class="main">[</span></span><span class="operator">OF</span> HOL.impI<span class="main"><span class="main">]</span></span><span class="main">)</span>
        <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">⟨</span><span class="free">c</span> <span class="main">⇐</span> <span class="free">t</span>⟩<span class="hidden">⇘</span><sub><span class="free">n</span></sub><span class="hidden">⇙</span> <span class="main">≤</span> <span class="skolem">n''</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">n''</span> <span class="main">&lt;</span> <span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span>↑<span class="hidden">⇘</span><sub><span class="free">t</span></sub><span class="hidden">⇙</span><span class="skolem">x</span>"</span></span>
        <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"eval <span class="free">c</span> <span class="free">t</span> <span class="free">t'</span> <span class="skolem">n''</span> <span class="free">γ'</span>"</span></span>
        <span class="keyword1"><span class="command">proof</span></span> <span class="operator">cases</span>
          <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound"><span class="bound">i</span></span><span class="main">≥</span><span class="skolem">n''</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i</span></sub><span class="hidden">⇙</span>"</span></span>
          <span class="keyword1"><span class="command">with</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">n''</span><span class="main">≥</span><span class="main">⟨</span><span class="free">c</span> <span class="main">⇐</span> <span class="free">t</span>⟩<span class="hidden">⇘</span><sub><span class="free">n</span></sub><span class="hidden">⇙</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"the_enat <span class="main">(</span><span class="main">⟨</span><span class="free">c</span> #<span class="hidden">⇘</span><sub><span class="skolem">n''</span></sub><span class="hidden">⇙</span> inf_llist <span class="free">t</span><span class="main">⟩</span><span class="main">)</span> <span class="main">≥</span> the_enat <span class="main">(</span><span class="main">⟨</span><span class="free">c</span> #<span class="hidden">⇘</span><sub><span class="free">n</span></sub><span class="hidden">⇙</span> inf_llist <span class="free">t</span><span class="main">⟩</span><span class="main">)</span>"</span></span>
            <span class="keyword1"><span class="command">using</span></span> nAct_mono_lNact <span class="quoted"><span class="quoted">‹<span class="main">∃</span><span class="bound"><span class="bound">i</span></span><span class="main">≥</span><span class="free">n</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i</span></sub><span class="hidden">⇙</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
          <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"the_enat <span class="main">(</span><span class="main">⟨</span><span class="free">c</span> #<span class="hidden">⇘</span><sub><span class="skolem">n''</span></sub><span class="hidden">⇙</span> inf_llist <span class="free">t</span><span class="main">⟩</span><span class="main">)</span><span class="main">&lt;</span><span class="skolem">x</span>"</span></span>
          <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
            <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="main">∃</span><span class="bound"><span class="bound">i</span></span><span class="main">≥</span><span class="skolem">n''</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i</span></sub><span class="hidden">⇙</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"eSuc <span class="main">⟨</span><span class="free">c</span> #<span class="hidden">⇘</span><sub>enat <span class="skolem">n''</span></sub><span class="hidden">⇙</span>inf_llist <span class="free">t</span><span class="main">⟩</span> <span class="main">≤</span> llength <span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span>inf_llist <span class="free">t</span><span class="main">)</span>"</span></span>
              <span class="keyword1"><span class="command">using</span></span> nAct_llength_proj <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
            <span class="keyword1"><span class="command">with</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">x</span> <span class="main">≥</span> llength <span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>inf_llist <span class="free">t</span><span class="main">)</span><span class="main">)</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"eSuc <span class="main">⟨</span><span class="free">c</span> #<span class="hidden">⇘</span><sub>enat <span class="skolem">n''</span></sub><span class="hidden">⇙</span>inf_llist <span class="free">t</span><span class="main">⟩</span> <span class="main">≤</span> <span class="skolem">x</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
            <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">⟨</span><span class="free">c</span> #<span class="hidden">⇘</span><sub>enat <span class="skolem">n''</span></sub><span class="hidden">⇙</span>inf_llist <span class="free">t</span><span class="main">⟩</span><span class="main">≠</span><span class="main">∞</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
            <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"Suc <span class="main">(</span>the_enat<span class="main">(</span><span class="main">⟨</span><span class="free">c</span> #<span class="hidden">⇘</span><sub>enat <span class="skolem">n''</span></sub><span class="hidden">⇙</span>inf_llist <span class="free">t</span><span class="main">⟩</span><span class="main">)</span><span class="main">)</span> <span class="main">≤</span> <span class="skolem">x</span>"</span></span>
              <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> enat.distinct<span class="main"><span class="main">(</span></span>2<span class="main"><span class="main">)</span></span> the_enat.simps the_enat_eSuc the_enat_mono<span class="main">)</span>
            <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
          <span class="keyword1"><span class="command">qed</span></span>
          <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">γ'</span> <span class="main">(</span>lnth <span class="main">(</span><span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>inf_llist <span class="free">t</span><span class="main">)</span><span class="main">)</span> <span class="keyword1">@<span class="hidden">⇩</span><sub>l</sub></span> <span class="main">(</span>inf_llist <span class="free">t'</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">(</span>the_enat <span class="main">(</span><span class="main">⟨</span><span class="free">c</span> #<span class="hidden">⇘</span><sub><span class="skolem">n''</span></sub><span class="hidden">⇙</span> inf_llist <span class="free">t</span><span class="main">⟩</span><span class="main">)</span><span class="main">)</span>"</span></span>
            <span class="keyword1"><span class="command">using</span></span> a1 <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
          <span class="keyword1"><span class="command">with</span></span> <span class="quoted"><span class="quoted">‹<span class="main">∃</span><span class="bound"><span class="bound">i</span></span><span class="main">≥</span><span class="skolem">n''</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i</span></sub><span class="hidden">⇙</span>›</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> validCI_act <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>      
        <span class="keyword1"><span class="command">next</span></span>
          <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span><span class="main">(</span><span class="main">∃</span><span class="bound"><span class="bound">i</span></span><span class="main">≥</span><span class="skolem">n''</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i</span></sub><span class="hidden">⇙</span><span class="main">)</span>"</span></span>
          <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span>↓<span class="hidden">⇘</span><sub><span class="free">t</span></sub><span class="hidden">⇙</span><span class="main">(</span><span class="skolem">n''</span><span class="main">)</span> <span class="main">≥</span> the_enat <span class="main">(</span><span class="main">⟨</span><span class="free">c</span> #<span class="hidden">⇘</span><sub><span class="free">n</span></sub><span class="hidden">⇙</span> inf_llist <span class="free">t</span><span class="main">⟩</span><span class="main">)</span>"</span></span>
          <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
            <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">⟨</span><span class="free">c</span> #<span class="hidden">⇘</span><sub><span class="free">n</span></sub><span class="hidden">⇙</span> inf_llist <span class="free">t</span><span class="main">⟩</span><span class="main">≤</span>llength <span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>inf_llist <span class="free">t</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> nAct_le_proj <span class="keyword1"><span class="command">by</span></span> <span class="operator">metis</span>
            <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="main">¬</span> <span class="main">(</span><span class="main">∃</span><span class="bound"><span class="bound">i</span></span><span class="main">≥</span><span class="skolem">n''</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i</span></sub><span class="hidden">⇙</span><span class="main">)</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"llength <span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>inf_llist <span class="free">t</span><span class="main">)</span><span class="main">)</span><span class="main">≠</span><span class="main">∞</span>"</span></span>
              <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> llength_eq_infty_conv_lfinite lnth_inf_llist proj_finite2<span class="main">)</span>
            <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"the_enat<span class="main">(</span><span class="main">⟨</span><span class="free">c</span> #<span class="hidden">⇘</span><sub><span class="free">n</span></sub><span class="hidden">⇙</span> inf_llist <span class="free">t</span><span class="main">⟩</span><span class="main">)</span><span class="main">≤</span>the_enat<span class="main">(</span>llength <span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>inf_llist <span class="free">t</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
            <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="main">∃</span><span class="bound"><span class="bound">i</span></span><span class="main">≥</span><span class="free">n</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i</span></sub><span class="hidden">⇙</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="main">¬</span> <span class="main">(</span><span class="main">∃</span><span class="bound"><span class="bound">i</span></span><span class="main">≥</span><span class="skolem">n''</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i</span></sub><span class="hidden">⇙</span><span class="main">)</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">n''</span><span class="main">&gt;</span><span class="main">⟨</span><span class="free">c</span> <span class="main">∧</span> <span class="free">t</span><span class="main">⟩</span>"</span></span>
              <span class="keyword1"><span class="command">using</span></span> lActive_active <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">meson</span> leI le_eq_less_or_eq<span class="main">)</span>
            <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span>↓<span class="hidden">⇘</span><sub><span class="free">t</span></sub><span class="hidden">⇙</span><span class="main">(</span><span class="skolem">n''</span><span class="main">)</span> <span class="main">&gt;</span> the_enat <span class="main">(</span>llength <span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>inf_llist <span class="free">t</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">-</span> <span class="main">1</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> cnf2bhv_greater_llength <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
            <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
          <span class="keyword1"><span class="command">qed</span></span>
          <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="main">¬</span><span class="main">(</span><span class="main">∃</span><span class="bound"><span class="bound">i</span></span><span class="main">≥</span><span class="skolem">n''</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i</span></sub><span class="hidden">⇙</span><span class="main">)</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">⟨</span><span class="free">c</span> <span class="main">∧</span> <span class="free">t</span><span class="main">⟩</span> <span class="main">≤</span> <span class="skolem">n''</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>1<span class="main">)</span> lActive_less <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
            <span class="keyword1"><span class="command">with</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">n''</span> <span class="main">&lt;</span> <span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span>↑<span class="hidden">⇘</span><sub><span class="free">t</span></sub><span class="hidden">⇙</span><span class="skolem">x</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span>↓<span class="hidden">⇘</span><sub><span class="free">t</span></sub><span class="hidden">⇙</span><span class="main">(</span><span class="skolem">n''</span><span class="main">)</span><span class="main">&lt;</span><span class="skolem">x</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> p2c_mono_c2p_strict <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
          <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">γ'</span> <span class="main">(</span>lnth <span class="main">(</span><span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>inf_llist <span class="free">t</span><span class="main">)</span><span class="main">)</span> <span class="keyword1">@<span class="hidden">⇩</span><sub>l</sub></span> <span class="main">(</span>inf_llist <span class="free">t'</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">(</span><span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span>↓<span class="hidden">⇘</span><sub><span class="free">t</span></sub><span class="hidden">⇙</span><span class="main">(</span><span class="skolem">n''</span><span class="main">)</span><span class="main">)</span>"</span></span>
            <span class="keyword1"><span class="command">using</span></span> a1 <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
          <span class="keyword1"><span class="command">with</span></span> <span class="quoted"><span class="quoted">‹<span class="main">∃</span><span class="bound"><span class="bound">i</span></span><span class="main">≥</span><span class="free">n</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i</span></sub><span class="hidden">⇙</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="main">¬</span><span class="main">(</span><span class="main">∃</span><span class="bound"><span class="bound">i</span></span><span class="main">≥</span><span class="skolem">n''</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i</span></sub><span class="hidden">⇙</span><span class="main">)</span>›</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> validCI_cont <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>              
        <span class="keyword1"><span class="command">qed</span></span>
      <span class="keyword1"><span class="command">qed</span></span>
    <span class="keyword1"><span class="command">qed</span></span>
    <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="main">¬</span><span class="main">(</span><span class="main">∃</span><span class="bound"><span class="bound">i</span></span><span class="main">≥</span><span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span>↑<span class="hidden">⇘</span><sub><span class="free">t</span></sub><span class="hidden">⇙</span><span class="main">(</span><span class="skolem">x</span><span class="main">)</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i</span></sub><span class="hidden">⇙</span><span class="main">)</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">next</span></span>
    <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span><span class="main">(</span><span class="skolem">x</span> <span class="main">≥</span> llength <span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>inf_llist <span class="free">t</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span><span class="main">&lt;</span>llength <span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>inf_llist <span class="free">t</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">n'</span></span><span class="main">::</span><span class="quoted">nat</span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span><span class="main">=</span><span class="main">⟨</span><span class="free">c</span> #<span class="hidden">⇘</span><sub><span class="skolem">n'</span></sub><span class="hidden">⇙</span> inf_llist <span class="free">t</span><span class="main">⟩</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> nAct_exists <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
    <span class="keyword1"><span class="command">with</span></span> <span class="quoted"><span class="quoted">‹enat <span class="skolem">x</span> <span class="main">&lt;</span> llength <span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>inf_llist <span class="free">t</span><span class="main">)</span><span class="main">)</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound"><span class="bound">i</span></span><span class="main">≥</span><span class="skolem">n'</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i</span></sub><span class="hidden">⇙</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> nAct_less_llength_active <span class="keyword1"><span class="command">by</span></span> <span class="operator">force</span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">i</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">i</span><span class="main">≥</span><span class="skolem">n'</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="skolem">i</span></sub><span class="hidden">⇙</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> <span class="main">(</span><span class="main">∃</span><span class="bound"><span class="bound">k</span></span><span class="main">≥</span><span class="skolem">n'</span><span class="main">.</span> <span class="bound">k</span> <span class="main">&lt;</span> <span class="skolem">i</span> <span class="main">∧</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">k</span></sub><span class="hidden">⇙</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> nact_exists <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
    <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">∀</span><span class="bound"><span class="bound">n''</span></span><span class="main">≥</span> <span class="main">⟨</span><span class="free">c</span> <span class="main">⇐</span> <span class="free">t</span>⟩<span class="hidden">⇘</span><sub><span class="skolem">i</span></sub><span class="hidden">⇙</span><span class="main">.</span> <span class="bound">n''</span><span class="main">≤</span><span class="main">⟨</span><span class="free">c</span> <span class="main">→</span> <span class="free">t</span>⟩<span class="hidden">⇘</span><sub><span class="skolem">i</span></sub><span class="hidden">⇙</span> <span class="main">⟶</span> eval <span class="free">c</span> <span class="free">t</span> <span class="free">t'</span> <span class="bound">n''</span> <span class="free">γ</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">proof</span></span>
      <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">n''</span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">⟨</span><span class="free">c</span> <span class="main">⇐</span> <span class="free">t</span>⟩<span class="hidden">⇘</span><sub><span class="skolem">i</span></sub><span class="hidden">⇙</span> <span class="main">≤</span> <span class="skolem">n''</span> <span class="main">⟶</span> <span class="skolem">n''</span> <span class="main">≤</span> <span class="main">⟨</span><span class="free">c</span> <span class="main">→</span> <span class="free">t</span>⟩<span class="hidden">⇘</span><sub><span class="skolem">i</span></sub><span class="hidden">⇙</span> <span class="main">⟶</span> eval <span class="free">c</span> <span class="free">t</span> <span class="free">t'</span> <span class="skolem">n''</span> <span class="free">γ</span>"</span></span>
      <span class="keyword1"><span class="command">proof</span></span><span class="main">(</span><span class="operator">rule</span> HOL.impI<span class="main"><span class="main">[</span></span><span class="operator">OF</span> HOL.impI<span class="main"><span class="main">]</span></span><span class="main">)</span>
        <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">⟨</span><span class="free">c</span> <span class="main">⇐</span> <span class="free">t</span>⟩<span class="hidden">⇘</span><sub><span class="skolem">i</span></sub><span class="hidden">⇙</span> <span class="main">≤</span> <span class="skolem">n''</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">n''</span> <span class="main">≤</span> <span class="main">⟨</span><span class="free">c</span> <span class="main">→</span> <span class="free">t</span>⟩<span class="hidden">⇘</span><sub><span class="skolem">i</span></sub><span class="hidden">⇙</span>"</span></span>
        <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"the_enat <span class="main">(</span><span class="main">⟨</span><span class="free">c</span> #<span class="hidden">⇘</span><sub>enat <span class="skolem">i</span></sub><span class="hidden">⇙</span> inf_llist <span class="free">t</span><span class="main">⟩</span><span class="main">)</span> <span class="main">=</span> the_enat <span class="main">(</span><span class="main">⟨</span><span class="free">c</span> #<span class="hidden">⇘</span><sub>enat <span class="skolem">n''</span></sub><span class="hidden">⇙</span> inf_llist <span class="free">t</span><span class="main">⟩</span><span class="main">)</span>"</span></span>
          <span class="keyword1"><span class="command">using</span></span> nAct_same <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
        <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="skolem">i</span></sub><span class="hidden">⇙</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="main">⟨</span><span class="free">c</span> <span class="main">→</span> <span class="free">t</span>⟩<span class="hidden">⇘</span><sub><span class="skolem">i</span></sub><span class="hidden">⇙</span></sub><span class="hidden">⇙</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> nxtActI <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword1"><span class="command">with</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">n''</span> <span class="main">≤</span> <span class="main">⟨</span><span class="free">c</span> <span class="main">→</span> <span class="free">t</span>⟩<span class="hidden">⇘</span><sub><span class="skolem">i</span></sub><span class="hidden">⇙</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound"><span class="bound">i</span></span><span class="main">≥</span><span class="skolem">n''</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i</span></sub><span class="hidden">⇙</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> dual_order.strict_implies_order <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">γ</span> <span class="main">(</span>lnth <span class="main">(</span><span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>inf_llist <span class="free">t</span><span class="main">)</span><span class="main">)</span> <span class="keyword1">@<span class="hidden">⇩</span><sub>l</sub></span> <span class="main">(</span>inf_llist <span class="free">t'</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">(</span>the_enat <span class="main">(</span><span class="main">⟨</span><span class="free">c</span> #<span class="hidden">⇘</span><sub>enat <span class="skolem">i</span></sub><span class="hidden">⇙</span> inf_llist <span class="free">t</span><span class="main">⟩</span><span class="main">)</span><span class="main">)</span>"</span></span>
        <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
          <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"enat <span class="skolem">i</span> <span class="main">-</span> <span class="main">1</span> <span class="main">&lt;</span> llength <span class="main">(</span>inf_llist <span class="free">t</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> one_enat_def<span class="main">)</span>
          <span class="keyword1"><span class="command">with</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">x</span><span class="main">=</span><span class="main">⟨</span><span class="free">c</span> #<span class="hidden">⇘</span><sub><span class="skolem">n'</span></sub><span class="hidden">⇙</span> inf_llist <span class="free">t</span><span class="main">⟩</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">i</span><span class="main">≥</span><span class="skolem">n'</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="main">¬</span> <span class="main">(</span><span class="main">∃</span><span class="bound"><span class="bound">k</span></span><span class="main">≥</span><span class="skolem">n'</span><span class="main">.</span> <span class="bound">k</span> <span class="main">&lt;</span> <span class="skolem">i</span> <span class="main">∧</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">k</span></sub><span class="hidden">⇙</span><span class="main">)</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span><span class="main">=</span><span class="main">⟨</span><span class="free">c</span> #<span class="hidden">⇘</span><sub><span class="skolem">i</span></sub><span class="hidden">⇙</span> inf_llist <span class="free">t</span><span class="main">⟩</span>"</span></span>
            <span class="keyword1"><span class="command">using</span></span> one_enat_def nAct_not_active_same <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
          <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">⟨</span><span class="free">c</span> #<span class="hidden">⇘</span><sub><span class="skolem">i</span></sub><span class="hidden">⇙</span> inf_llist <span class="free">t</span><span class="main">⟩</span><span class="main">≠</span><span class="main">∞</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
          <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span><span class="main">=</span>the_enat<span class="main">(</span><span class="main">⟨</span><span class="free">c</span> #<span class="hidden">⇘</span><sub><span class="skolem">i</span></sub><span class="hidden">⇙</span> inf_llist <span class="free">t</span><span class="main">⟩</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">fastforce</span>        
          <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="free">γ</span> <span class="main">(</span>lnth <span class="main">(</span><span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>inf_llist <span class="free">t</span><span class="main">)</span><span class="main">)</span> <span class="keyword1">@<span class="hidden">⇩</span><sub>l</sub></span> <span class="main">(</span>inf_llist <span class="free">t'</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="skolem">x</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
        <span class="keyword1"><span class="command">qed</span></span>
        <span class="keyword1"><span class="command">with</span></span> <span class="quoted"><span class="quoted">‹the_enat <span class="main">(</span><span class="main">⟨</span><span class="free">c</span> #<span class="hidden">⇘</span><sub>enat <span class="skolem">i</span></sub><span class="hidden">⇙</span> inf_llist <span class="free">t</span><span class="main">⟩</span><span class="main">)</span> <span class="main">=</span> the_enat <span class="main">(</span><span class="main">⟨</span><span class="free">c</span> #<span class="hidden">⇘</span><sub>enat <span class="skolem">n''</span></sub><span class="hidden">⇙</span> inf_llist <span class="free">t</span><span class="main">⟩</span><span class="main">)</span>›</span></span> <span class="keyword1"><span class="command">have</span></span>
          <span class="quoted"><span class="quoted">"<span class="free">γ</span> <span class="main">(</span>lnth <span class="main">(</span><span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>inf_llist <span class="free">t</span><span class="main">)</span><span class="main">)</span> <span class="keyword1">@<span class="hidden">⇩</span><sub>l</sub></span> <span class="main">(</span>inf_llist <span class="free">t'</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">(</span>the_enat <span class="main">(</span><span class="main">⟨</span><span class="free">c</span> #<span class="hidden">⇘</span><sub>enat <span class="skolem">n''</span></sub><span class="hidden">⇙</span> inf_llist <span class="free">t</span><span class="main">⟩</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
        <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"eval <span class="free">c</span> <span class="free">t</span> <span class="free">t'</span> <span class="skolem">n''</span> <span class="free">γ</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> validCI_act <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
      <span class="keyword1"><span class="command">qed</span></span>
    <span class="keyword1"><span class="command">qed</span></span>
    <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">i</span><span class="main">≥</span><span class="main">⟨</span><span class="free">c</span> <span class="main">→</span> <span class="free">t</span>⟩<span class="hidden">⇘</span><sub><span class="free">n</span></sub><span class="hidden">⇙</span>"</span></span>
    <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
      <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"enat <span class="skolem">i</span> <span class="main">-</span> <span class="main">1</span> <span class="main">&lt;</span> llength <span class="main">(</span>inf_llist <span class="free">t</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> one_enat_def<span class="main">)</span>
      <span class="keyword1"><span class="command">with</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">x</span><span class="main">=</span><span class="main">⟨</span><span class="free">c</span> #<span class="hidden">⇘</span><sub><span class="skolem">n'</span></sub><span class="hidden">⇙</span> inf_llist <span class="free">t</span><span class="main">⟩</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">i</span><span class="main">≥</span><span class="skolem">n'</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="main">¬</span> <span class="main">(</span><span class="main">∃</span><span class="bound"><span class="bound">k</span></span><span class="main">≥</span><span class="skolem">n'</span><span class="main">.</span> <span class="bound">k</span> <span class="main">&lt;</span> <span class="skolem">i</span> <span class="main">∧</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">k</span></sub><span class="hidden">⇙</span><span class="main">)</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span><span class="main">=</span><span class="main">⟨</span><span class="free">c</span> #<span class="hidden">⇘</span><sub><span class="skolem">i</span></sub><span class="hidden">⇙</span> inf_llist <span class="free">t</span><span class="main">⟩</span>"</span></span>
        <span class="keyword1"><span class="command">using</span></span> one_enat_def nAct_not_active_same <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
      <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">⟨</span><span class="free">c</span> #<span class="hidden">⇘</span><sub><span class="skolem">i</span></sub><span class="hidden">⇙</span> inf_llist <span class="free">t</span><span class="main">⟩</span><span class="main">≠</span><span class="main">∞</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
      <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span><span class="main">=</span>the_enat<span class="main">(</span><span class="main">⟨</span><span class="free">c</span> #<span class="hidden">⇘</span><sub><span class="skolem">i</span></sub><span class="hidden">⇙</span> inf_llist <span class="free">t</span><span class="main">⟩</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">fastforce</span>        
      <span class="keyword1"><span class="command">with</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">x</span><span class="main">≥</span>the_enat <span class="main">(</span><span class="main">⟨</span><span class="free">c</span> #<span class="hidden">⇘</span><sub><span class="free">n</span></sub><span class="hidden">⇙</span> inf_llist <span class="free">t</span><span class="main">⟩</span><span class="main">)</span>›</span></span>
        <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"the_enat <span class="main">(</span><span class="main">⟨</span><span class="free">c</span> #<span class="hidden">⇘</span><sub><span class="skolem">i</span></sub><span class="hidden">⇙</span> inf_llist <span class="free">t</span><span class="main">⟩</span><span class="main">)</span><span class="main">≥</span>the_enat <span class="main">(</span><span class="main">⟨</span><span class="free">c</span> #<span class="hidden">⇘</span><sub><span class="free">n</span></sub><span class="hidden">⇙</span> inf_llist <span class="free">t</span><span class="main">⟩</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
      <span class="keyword1"><span class="command">with</span></span> <span class="quoted"><span class="quoted">‹<span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="skolem">i</span></sub><span class="hidden">⇙</span>›</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> active_geq_nxtAct <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">qed</span></span>
    <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound"><span class="bound">n''</span></span><span class="main">≥</span><span class="main">⟨</span><span class="free">c</span> <span class="main">⇐</span> <span class="free">t</span>⟩<span class="hidden">⇘</span><sub><span class="free">n</span></sub><span class="hidden">⇙</span><span class="main">.</span> <span class="bound">n''</span> <span class="main">&lt;</span> <span class="main">⟨</span><span class="free">c</span> <span class="main">⇐</span> <span class="free">t</span>⟩<span class="hidden">⇘</span><sub><span class="skolem">i</span></sub><span class="hidden">⇙</span> <span class="main">⟶</span> eval <span class="free">c</span> <span class="free">t</span> <span class="free">t'</span> <span class="bound">n''</span> <span class="free">γ'</span>"</span></span>
    <span class="keyword1"><span class="command">proof</span></span>
      <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">n''</span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">⟨</span><span class="free">c</span> <span class="main">⇐</span> <span class="free">t</span>⟩<span class="hidden">⇘</span><sub><span class="free">n</span></sub><span class="hidden">⇙</span> <span class="main">≤</span> <span class="skolem">n''</span> <span class="main">⟶</span> <span class="skolem">n''</span> <span class="main">&lt;</span> <span class="main">⟨</span><span class="free">c</span> <span class="main">⇐</span> <span class="free">t</span>⟩<span class="hidden">⇘</span><sub><span class="skolem">i</span></sub><span class="hidden">⇙</span> <span class="main">⟶</span> eval <span class="free">c</span> <span class="free">t</span> <span class="free">t'</span> <span class="skolem">n''</span> <span class="free">γ'</span>"</span></span>
      <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">rule</span> HOL.impI<span class="main"><span class="main">[</span></span><span class="operator">OF</span> HOL.impI<span class="main"><span class="main">]</span></span><span class="main">)</span>
        <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">⟨</span><span class="free">c</span> <span class="main">⇐</span> <span class="free">t</span>⟩<span class="hidden">⇘</span><sub><span class="free">n</span></sub><span class="hidden">⇙</span> <span class="main">≤</span> <span class="skolem">n''</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">n''</span> <span class="main">&lt;</span> <span class="main">⟨</span><span class="free">c</span> <span class="main">⇐</span> <span class="free">t</span>⟩<span class="hidden">⇘</span><sub><span class="skolem">i</span></sub><span class="hidden">⇙</span>"</span></span>
        <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">⟨</span><span class="free">c</span> <span class="main">⇐</span> <span class="free">t</span>⟩<span class="hidden">⇘</span><sub><span class="skolem">i</span></sub><span class="hidden">⇙</span><span class="main">≤</span><span class="skolem">i</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
        <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound"><span class="bound">i</span></span><span class="main">≥</span><span class="skolem">n''</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i</span></sub><span class="hidden">⇙</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="skolem">i</span></sub><span class="hidden">⇙</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">meson</span> less_le less_le_trans<span class="main">)</span>
        <span class="keyword1"><span class="command">with</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">n''</span><span class="main">≥</span><span class="main">⟨</span><span class="free">c</span> <span class="main">⇐</span> <span class="free">t</span>⟩<span class="hidden">⇘</span><sub><span class="free">n</span></sub><span class="hidden">⇙</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"the_enat <span class="main">(</span><span class="main">⟨</span><span class="free">c</span> #<span class="hidden">⇘</span><sub><span class="skolem">n''</span></sub><span class="hidden">⇙</span> inf_llist <span class="free">t</span><span class="main">⟩</span><span class="main">)</span> <span class="main">≥</span> the_enat <span class="main">(</span><span class="main">⟨</span><span class="free">c</span> #<span class="hidden">⇘</span><sub><span class="free">n</span></sub><span class="hidden">⇙</span> inf_llist <span class="free">t</span><span class="main">⟩</span><span class="main">)</span>"</span></span>
          <span class="keyword1"><span class="command">using</span></span> nAct_mono_lNact <span class="quoted"><span class="quoted">‹<span class="main">∃</span><span class="bound"><span class="bound">i</span></span><span class="main">≥</span><span class="free">n</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i</span></sub><span class="hidden">⇙</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
        <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"the_enat <span class="main">(</span><span class="main">⟨</span><span class="free">c</span> #<span class="hidden">⇘</span><sub><span class="skolem">n''</span></sub><span class="hidden">⇙</span> inf_llist <span class="free">t</span><span class="main">⟩</span><span class="main">)</span> <span class="main">&lt;</span> <span class="skolem">x</span>"</span></span>
        <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
          <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">n''</span> <span class="main">&lt;</span> <span class="main">⟨</span><span class="free">c</span> <span class="main">⇐</span> <span class="free">t</span>⟩<span class="hidden">⇘</span><sub><span class="skolem">i</span></sub><span class="hidden">⇙</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="main">⟨</span><span class="free">c</span> <span class="main">⇐</span> <span class="free">t</span>⟩<span class="hidden">⇘</span><sub><span class="skolem">i</span></sub><span class="hidden">⇙</span> <span class="main">≤</span> <span class="skolem">i</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">n''</span> <span class="main">&lt;</span> <span class="skolem">i</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> dual_order.strict_trans1 <span class="keyword1"><span class="command">by</span></span> <span class="operator">arith</span>
          <span class="keyword1"><span class="command">with</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">n''</span> <span class="main">&lt;</span> <span class="main">⟨</span><span class="free">c</span> <span class="main">⇐</span> <span class="free">t</span>⟩<span class="hidden">⇘</span><sub><span class="skolem">i</span></sub><span class="hidden">⇙</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound"><span class="bound">i'</span></span><span class="main">≥</span><span class="skolem">n''</span><span class="main">.</span> <span class="bound">i'</span> <span class="main">&lt;</span> <span class="skolem">i</span> <span class="main">∧</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i'</span></sub><span class="hidden">⇙</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> lNact_least<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="skolem">i</span></span> <span class="quoted"><span class="skolem">n''</span></span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">fastforce</span>
          <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="main">⟨</span><span class="free">c</span> #<span class="hidden">⇘</span><sub><span class="skolem">n''</span></sub><span class="hidden">⇙</span> inf_llist <span class="free">t</span><span class="main">⟩</span> <span class="main">&lt;</span> <span class="main">⟨</span><span class="free">c</span> #<span class="hidden">⇘</span><sub><span class="skolem">i</span></sub><span class="hidden">⇙</span> inf_llist <span class="free">t</span><span class="main">⟩</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> nAct_less <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
          <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"enat <span class="skolem">i</span> <span class="main">-</span> <span class="main">1</span> <span class="main">&lt;</span> llength <span class="main">(</span>inf_llist <span class="free">t</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> one_enat_def<span class="main">)</span>
          <span class="keyword1"><span class="command">with</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">x</span><span class="main">=</span><span class="main">⟨</span><span class="free">c</span> #<span class="hidden">⇘</span><sub><span class="skolem">n'</span></sub><span class="hidden">⇙</span> inf_llist <span class="free">t</span><span class="main">⟩</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">i</span><span class="main">≥</span><span class="skolem">n'</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="main">¬</span> <span class="main">(</span><span class="main">∃</span><span class="bound"><span class="bound">k</span></span><span class="main">≥</span><span class="skolem">n'</span><span class="main">.</span> <span class="bound">k</span> <span class="main">&lt;</span> <span class="skolem">i</span> <span class="main">∧</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">k</span></sub><span class="hidden">⇙</span><span class="main">)</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span><span class="main">=</span><span class="main">⟨</span><span class="free">c</span> #<span class="hidden">⇘</span><sub><span class="skolem">i</span></sub><span class="hidden">⇙</span> inf_llist <span class="free">t</span><span class="main">⟩</span>"</span></span>
            <span class="keyword1"><span class="command">using</span></span> one_enat_def nAct_not_active_same <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>    
          <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">⟨</span><span class="free">c</span> #<span class="hidden">⇘</span><sub><span class="skolem">n''</span></sub><span class="hidden">⇙</span> inf_llist <span class="free">t</span><span class="main">⟩</span><span class="main">≠</span><span class="main">∞</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
          <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> enat_ord_simps<span class="main"><span class="main">(</span></span>2<span class="main"><span class="main">)</span></span> enat_the_enat<span class="main">)</span>
        <span class="keyword1"><span class="command">qed</span></span>
        <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">γ'</span> <span class="main">(</span>lnth <span class="main">(</span><span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>inf_llist <span class="free">t</span><span class="main">)</span><span class="main">)</span> <span class="keyword1">@<span class="hidden">⇩</span><sub>l</sub></span> <span class="main">(</span>inf_llist <span class="free">t'</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">(</span>the_enat <span class="main">(</span><span class="main">⟨</span><span class="free">c</span> #<span class="hidden">⇘</span><sub><span class="skolem">n''</span></sub><span class="hidden">⇙</span> inf_llist <span class="free">t</span><span class="main">⟩</span><span class="main">)</span><span class="main">)</span>"</span></span>
          <span class="keyword1"><span class="command">using</span></span> a1 <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword1"><span class="command">with</span></span> <span class="quoted"><span class="quoted">‹<span class="main">∃</span><span class="bound"><span class="bound">i</span></span><span class="main">≥</span><span class="skolem">n''</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i</span></sub><span class="hidden">⇙</span>›</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"eval <span class="free">c</span> <span class="free">t</span> <span class="free">t'</span> <span class="skolem">n''</span> <span class="free">γ'</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> validCI_act <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
      <span class="keyword1"><span class="command">qed</span></span>
    <span class="keyword1"><span class="command">qed</span></span>
    <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="skolem">i</span></sub><span class="hidden">⇙</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">qed</span></span>    
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="Dynamic_Architecture_Calculus-untilEN"><span class="command">lemma</span></span> untilEN<span class="main">[</span><span class="operator">elim</span><span class="main">]</span><span class="main">:</span>
  <span class="keyword2"><span class="keyword">fixes</span></span> <span class="free">n</span><span class="main">::</span><span class="quoted">nat</span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="free">n'</span><span class="main">::</span><span class="quoted">nat</span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="free">t</span><span class="main">::</span><span class="quoted"><span class="quoted">"nat <span class="main">⇒</span> cnf"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="free">t'</span><span class="main">::</span><span class="quoted"><span class="quoted">"nat <span class="main">⇒</span> <span class="tfree">'cmp</span>"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="free">c</span><span class="main">::</span><span class="tfree"><span class="quoted"><span class="tfree">'id</span></span></span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="main">∄</span><span class="bound">i</span><span class="main">.</span> <span class="bound">i</span><span class="main">≥</span><span class="free">n</span> <span class="main">∧</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i</span></sub><span class="hidden">⇙</span>"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"eval <span class="free">c</span> <span class="free">t</span> <span class="free">t'</span> <span class="free">n</span> <span class="main">(</span><span class="free">γ'</span> <span class="keyword1">𝔘<span class="hidden">⇩</span><sub>b</sub></span> <span class="free">γ</span><span class="main">)</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound"><span class="bound">n'</span></span><span class="main">≥</span><span class="free">n</span><span class="main">.</span> eval <span class="free">c</span> <span class="free">t</span> <span class="free">t'</span> <span class="bound">n'</span> <span class="free">γ</span> <span class="main">∧</span>
    <span class="main">(</span><span class="main">∀</span><span class="bound"><span class="bound">n''</span></span><span class="main">≥</span><span class="free">n</span><span class="main">.</span> <span class="bound">n''</span> <span class="main">&lt;</span> <span class="bound">n'</span> <span class="main">⟶</span> eval <span class="free">c</span> <span class="free">t</span> <span class="free">t'</span> <span class="bound">n''</span> <span class="free">γ'</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">cases</span>
  <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound">i</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i</span></sub><span class="hidden">⇙</span>"</span></span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹eval <span class="free">c</span> <span class="free">t</span> <span class="free">t'</span> <span class="free">n</span> <span class="main">(</span><span class="free">γ'</span> <span class="keyword1">𝔘<span class="hidden">⇩</span><sub>b</sub></span> <span class="free">γ</span><span class="main">)</span>›</span></span>
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"eval <span class="free">c</span> <span class="free">t</span> <span class="free">t'</span> <span class="free">n</span> <span class="main">(</span><span class="main">λ</span> <span class="bound">t</span> <span class="bound">n</span><span class="main">.</span> <span class="main">∃</span><span class="bound"><span class="bound">n''</span></span><span class="main">≥</span><span class="bound">n</span><span class="main">.</span> <span class="free">γ</span> <span class="bound">t</span> <span class="bound">n''</span> <span class="main">∧</span> <span class="main">(</span><span class="main">∀</span><span class="bound"><span class="bound">n'</span></span><span class="main">≥</span><span class="bound">n</span><span class="main">.</span> <span class="bound">n'</span> <span class="main">&lt;</span> <span class="bound">n''</span> <span class="main">⟶</span> <span class="free">γ'</span> <span class="bound">t</span> <span class="bound">n'</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> until_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound"><span class="bound">n''</span></span><span class="main">≥</span><span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span>↓<span class="hidden">⇘</span><sub><span class="free">t</span></sub><span class="hidden">⇙</span><span class="main">(</span><span class="free">n</span><span class="main">)</span><span class="main">.</span> <span class="free">γ</span> <span class="main">(</span>lnth <span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span>inf_llist <span class="free">t</span> <span class="keyword1">@<span class="hidden">⇩</span><sub>l</sub></span> inf_llist <span class="free">t'</span><span class="main">)</span><span class="main">)</span> <span class="bound">n''</span> <span class="main">∧</span>
    <span class="main">(</span><span class="main">∀</span><span class="bound"><span class="bound">n'</span></span><span class="main">≥</span><span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span>↓<span class="hidden">⇘</span><sub><span class="free">t</span></sub><span class="hidden">⇙</span><span class="main">(</span><span class="free">n</span><span class="main">)</span><span class="main">.</span> <span class="bound">n'</span> <span class="main">&lt;</span> <span class="bound">n''</span> <span class="main">⟶</span> <span class="free">γ'</span> <span class="main">(</span>lnth <span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span>inf_llist <span class="free">t</span> <span class="keyword1">@<span class="hidden">⇩</span><sub>l</sub></span> inf_llist <span class="free">t'</span><span class="main">)</span><span class="main">)</span> <span class="bound">n'</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> validCE_cont<span class="main">[</span><span class="keyword2"><span class="keyword"><span class="operator">where</span></span></span> γ<span class="main"><span class="main">=</span></span><span class="quoted"><span class="quoted">"<span class="main">λ</span> <span class="bound">t</span> <span class="bound">n</span><span class="main">.</span> <span class="main">∃</span><span class="bound"><span class="bound">n''</span></span><span class="main">≥</span><span class="bound">n</span><span class="main">.</span> <span class="free">γ</span> <span class="bound">t</span> <span class="bound">n''</span> <span class="main">∧</span> <span class="main">(</span><span class="main">∀</span><span class="bound"><span class="bound">n'</span></span><span class="main">≥</span><span class="bound">n</span><span class="main">.</span> <span class="bound">n'</span> <span class="main">&lt;</span> <span class="bound">n''</span> <span class="main">⟶</span> <span class="free">γ'</span> <span class="bound">t</span> <span class="bound">n'</span><span class="main">)</span>"</span></span><span class="main">]</span>
    <span class="quoted"><span class="quoted">‹<span class="main">∄</span><span class="bound">i</span><span class="main">.</span> <span class="bound">i</span><span class="main">≥</span><span class="free">n</span> <span class="main">∧</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i</span></sub><span class="hidden">⇙</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">x</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span><span class="main">≥</span><span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span>↓<span class="hidden">⇘</span><sub><span class="free">t</span></sub><span class="hidden">⇙</span><span class="main">(</span><span class="free">n</span><span class="main">)</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">γ</span> <span class="main">(</span>lnth <span class="main">(</span><span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>inf_llist <span class="free">t</span><span class="main">)</span><span class="main">)</span> <span class="keyword1">@<span class="hidden">⇩</span><sub>l</sub></span> <span class="main">(</span>inf_llist <span class="free">t'</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="skolem">x</span>"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound"><span class="bound">x'</span></span><span class="main">≥</span><span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span>↓<span class="hidden">⇘</span><sub><span class="free">t</span></sub><span class="hidden">⇙</span><span class="main">(</span><span class="free">n</span><span class="main">)</span><span class="main">.</span> <span class="bound">x'</span><span class="main">&lt;</span><span class="skolem">x</span> <span class="main">⟶</span> <span class="free">γ'</span> <span class="main">(</span>lnth <span class="main">(</span><span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>inf_llist <span class="free">t</span><span class="main">)</span><span class="main">)</span> <span class="keyword1">@<span class="hidden">⇩</span><sub>l</sub></span> <span class="main">(</span>inf_llist <span class="free">t'</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="bound">x'</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="main">¬</span><span class="main">(</span><span class="main">∃</span><span class="bound"><span class="bound">i</span></span><span class="main">≥</span><span class="free">n</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i</span></sub><span class="hidden">⇙</span><span class="main">)</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"the_enat <span class="main">(</span>llength <span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>inf_llist <span class="free">t</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">-</span> <span class="main">1</span> <span class="main">&lt;</span> <span class="skolem">x</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">⟨</span><span class="free">c</span> <span class="main">∧</span> <span class="free">t</span><span class="main">⟩</span> <span class="main">&lt;</span> <span class="free">n</span>"</span></span>
    <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">rule</span> ccontr<span class="main">)</span>
      <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span><span class="main">⟨</span><span class="free">c</span> <span class="main">∧</span> <span class="free">t</span><span class="main">⟩</span> <span class="main">&lt;</span> <span class="free">n</span>"</span></span>
      <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="main">⟨</span><span class="free">c</span> <span class="main">∧</span> <span class="free">t</span><span class="main">⟩</span> <span class="main">≥</span> <span class="free">n</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
      <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="main">∃</span><span class="bound">i</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i</span></sub><span class="hidden">⇙</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="main">¬</span> <span class="main">(</span><span class="main">∃</span><span class="bound"><span class="bound">i</span></span><span class="main">≥</span><span class="free">n</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i</span></sub><span class="hidden">⇙</span><span class="main">)</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="main">⟨</span><span class="free">c</span> <span class="main">∧</span> <span class="free">t</span><span class="main">⟩</span></sub><span class="hidden">⇙</span>"</span></span>
        <span class="keyword1"><span class="command">using</span></span> lActive_active less_or_eq_imp_le <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
      <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted">False</span> <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="main">¬</span> <span class="main">(</span><span class="main">∃</span><span class="bound"><span class="bound">i</span></span><span class="main">≥</span><span class="free">n</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i</span></sub><span class="hidden">⇙</span><span class="main">)</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">qed</span></span>
    <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"the_enat <span class="main">(</span>llength <span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>inf_llist <span class="free">t</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">-</span> <span class="main">1</span> <span class="main">&lt;</span> <span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span>↓<span class="hidden">⇘</span><sub><span class="free">t</span></sub><span class="hidden">⇙</span><span class="main">(</span><span class="free">n</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> cnf2bhv_greater_llength <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">with</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">x</span><span class="main">≥</span><span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span>↓<span class="hidden">⇘</span><sub><span class="free">t</span></sub><span class="hidden">⇙</span><span class="main">(</span><span class="free">n</span><span class="main">)</span>›</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">=</span> <span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span>↓<span class="hidden">⇘</span><sub><span class="free">t</span></sub><span class="hidden">⇙</span><span class="main">(</span><span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span>↑<span class="hidden">⇘</span><sub><span class="free">t</span></sub><span class="hidden">⇙</span><span class="main">(</span><span class="skolem">x</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> cnf2bhv_bhv2cnf <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">γ</span> <span class="main">(</span>lnth <span class="main">(</span><span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>inf_llist <span class="free">t</span><span class="main">)</span><span class="main">)</span> <span class="keyword1">@<span class="hidden">⇩</span><sub>l</sub></span> <span class="main">(</span>inf_llist <span class="free">t'</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">(</span><span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span>↓<span class="hidden">⇘</span><sub><span class="free">t</span></sub><span class="hidden">⇙</span><span class="main">(</span><span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span>↑<span class="hidden">⇘</span><sub><span class="free">t</span></sub><span class="hidden">⇙</span><span class="main">(</span><span class="skolem">x</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="main">¬</span><span class="main">(</span><span class="main">∃</span><span class="bound"><span class="bound">i</span></span><span class="main">≥</span><span class="free">n</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i</span></sub><span class="hidden">⇙</span><span class="main">)</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span><span class="main">(</span><span class="main">∃</span><span class="bound"><span class="bound">i</span></span><span class="main">≥</span><span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span>↑<span class="hidden">⇘</span><sub><span class="free">t</span></sub><span class="hidden">⇙</span><span class="main">(</span><span class="skolem">x</span><span class="main">)</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i</span></sub><span class="hidden">⇙</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
    <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="main">¬</span><span class="main">(</span><span class="main">∃</span><span class="bound"><span class="bound">i</span></span><span class="main">≥</span><span class="free">n</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i</span></sub><span class="hidden">⇙</span><span class="main">)</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"lfinite <span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>inf_llist <span class="free">t</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> proj_finite2 <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">z</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound"><span class="bound">n''</span></span><span class="main">&gt;</span><span class="skolem">z</span><span class="main">.</span> <span class="main">¬</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">n''</span></sub><span class="hidden">⇙</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> proj_finite_bound <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
    <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹the_enat <span class="main">(</span>llength <span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>inf_llist <span class="free">t</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">-</span> <span class="main">1</span> <span class="main">&lt;</span> <span class="skolem">x</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">⟨</span><span class="free">c</span> <span class="main">∧</span> <span class="free">t</span><span class="main">⟩</span> <span class="main">&lt;</span> <span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span>↑<span class="hidden">⇘</span><sub><span class="free">t</span></sub><span class="hidden">⇙</span><span class="main">(</span><span class="skolem">x</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> bhv2cnf_greater_lActive <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> lActive_greater_active_all <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">qed</span></span>      
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"eval <span class="free">c</span> <span class="free">t</span> <span class="free">t'</span> <span class="main">(</span><span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span>↑<span class="hidden">⇘</span><sub><span class="free">t</span></sub><span class="hidden">⇙</span><span class="main">(</span><span class="skolem">x</span><span class="main">)</span><span class="main">)</span> <span class="free">γ</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> validCI_cont <span class="quoted"><span class="quoted">‹<span class="main">∃</span><span class="bound">i</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i</span></sub><span class="hidden">⇙</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="main">∃</span><span class="bound">i</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i</span></sub><span class="hidden">⇙</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="main">¬</span><span class="main">(</span><span class="main">∃</span><span class="bound"><span class="bound">i</span></span><span class="main">≥</span><span class="free">n</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i</span></sub><span class="hidden">⇙</span><span class="main">)</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">⟨</span><span class="free">c</span> <span class="main">∧</span> <span class="free">t</span><span class="main">⟩</span> <span class="main">≤</span> <span class="free">n</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> lActive_less<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="free">c</span></span> <span class="quoted"><span class="free">t</span></span> <span class="main">_</span> <span class="quoted"><span class="free">n</span></span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">with</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">x</span><span class="main">≥</span><span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span>↓<span class="hidden">⇘</span><sub><span class="free">t</span></sub><span class="hidden">⇙</span><span class="main">(</span><span class="free">n</span><span class="main">)</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">n</span> <span class="main">≤</span> <span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span>↑<span class="hidden">⇘</span><sub><span class="free">t</span></sub><span class="hidden">⇙</span><span class="main">(</span><span class="skolem">x</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> p2c_mono_c2p <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound"><span class="bound">n''</span></span><span class="main">≥</span><span class="free">n</span><span class="main">.</span> <span class="bound">n''</span> <span class="main">&lt;</span> <span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span>↑<span class="hidden">⇘</span><sub><span class="free">t</span></sub><span class="hidden">⇙</span><span class="main">(</span><span class="skolem">x</span><span class="main">)</span> <span class="main">⟶</span> eval <span class="free">c</span> <span class="free">t</span> <span class="free">t'</span> <span class="bound">n''</span> <span class="free">γ'</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">rule</span> HOL.allI<span class="main"><span class="main">[</span></span><span class="operator">OF</span> HOL.impI<span class="main"><span class="main">[</span></span><span class="operator">OF</span> HOL.impI<span class="main"><span class="main">]</span></span><span class="main"><span class="main">]</span></span><span class="main">)</span>
    <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">n''</span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="free">n</span> <span class="main">≤</span> <span class="skolem">n''</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">n''</span> <span class="main">&lt;</span> <span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span>↑<span class="hidden">⇘</span><sub><span class="free">t</span></sub><span class="hidden">⇙</span><span class="main">(</span><span class="skolem">x</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span>↓<span class="hidden">⇘</span><sub><span class="free">t</span></sub><span class="hidden">⇙</span><span class="main">(</span><span class="skolem">n''</span><span class="main">)</span><span class="main">≥</span><span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span>↓<span class="hidden">⇘</span><sub><span class="free">t</span></sub><span class="hidden">⇙</span><span class="main">(</span><span class="free">n</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> cnf2bhv_mono <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">n''</span><span class="main">&lt;</span><span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span>↑<span class="hidden">⇘</span><sub><span class="free">t</span></sub><span class="hidden">⇙</span><span class="main">(</span><span class="skolem">x</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">n''</span> <span class="main">&lt;</span> <span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span>↑<span class="hidden">⇘</span><sub><span class="free">t</span></sub><span class="hidden">⇙</span><span class="skolem">x</span>›</span></span><span class="main">)</span>
    <span class="keyword1"><span class="command">with</span></span> <span class="quoted"><span class="quoted">‹<span class="main">⟨</span><span class="free">c</span> <span class="main">∧</span> <span class="free">t</span><span class="main">⟩</span> <span class="main">≤</span> <span class="free">n</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="free">n</span> <span class="main">≤</span> <span class="skolem">n''</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span>↓<span class="hidden">⇘</span><sub><span class="free">t</span></sub><span class="hidden">⇙</span><span class="main">(</span><span class="skolem">n''</span><span class="main">)</span><span class="main">&lt;</span><span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span>↓<span class="hidden">⇘</span><sub><span class="free">t</span></sub><span class="hidden">⇙</span><span class="main">(</span><span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span>↑<span class="hidden">⇘</span><sub><span class="free">t</span></sub><span class="hidden">⇙</span><span class="main">(</span><span class="skolem">x</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> cnf2bhv_mono_strict <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">with</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">x</span> <span class="main">=</span> <span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span>↓<span class="hidden">⇘</span><sub><span class="free">t</span></sub><span class="hidden">⇙</span><span class="main">(</span><span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span>↑<span class="hidden">⇘</span><sub><span class="free">t</span></sub><span class="hidden">⇙</span><span class="main">(</span><span class="skolem">x</span><span class="main">)</span><span class="main">)</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span>↓<span class="hidden">⇘</span><sub><span class="free">t</span></sub><span class="hidden">⇙</span><span class="main">(</span><span class="skolem">n''</span><span class="main">)</span><span class="main">&lt;</span> <span class="skolem">x</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">γ'</span> <span class="main">(</span>lnth <span class="main">(</span><span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>inf_llist <span class="free">t</span><span class="main">)</span><span class="main">)</span> <span class="keyword1">@<span class="hidden">⇩</span><sub>l</sub></span> <span class="main">(</span>inf_llist <span class="free">t'</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">(</span><span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span>↓<span class="hidden">⇘</span><sub><span class="free">t</span></sub><span class="hidden">⇙</span><span class="main">(</span><span class="skolem">n''</span><span class="main">)</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="main">∀</span><span class="bound"><span class="bound">x'</span></span><span class="main">≥</span><span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span>↓<span class="hidden">⇘</span><sub><span class="free">t</span></sub><span class="hidden">⇙</span><span class="main">(</span><span class="free">n</span><span class="main">)</span><span class="main">.</span> <span class="bound">x'</span><span class="main">&lt;</span><span class="skolem">x</span> <span class="main">⟶</span> <span class="free">γ'</span> <span class="main">(</span>lnth <span class="main">(</span><span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span><span class="main">(</span>inf_llist <span class="free">t</span><span class="main">)</span><span class="main">)</span> <span class="keyword1">@<span class="hidden">⇩</span><sub>l</sub></span> <span class="main">(</span>inf_llist <span class="free">t'</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="bound">x'</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="free">n</span> <span class="main">≤</span> <span class="skolem">n''</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">∄</span><span class="bound">i</span><span class="main">.</span> <span class="bound">i</span><span class="main">≥</span><span class="skolem">n''</span> <span class="main">∧</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i</span></sub><span class="hidden">⇙</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="main">∄</span><span class="bound">i</span><span class="main">.</span> <span class="bound">i</span><span class="main">≥</span><span class="free">n</span> <span class="main">∧</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i</span></sub><span class="hidden">⇙</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"eval <span class="free">c</span> <span class="free">t</span> <span class="free">t'</span> <span class="skolem">n''</span> <span class="free">γ'</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> validCI_cont <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="main">∃</span><span class="bound">i</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i</span></sub><span class="hidden">⇙</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">next</span></span>
  <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span><span class="main">(</span><span class="main">∃</span><span class="bound">i</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i</span></sub><span class="hidden">⇙</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹eval <span class="free">c</span> <span class="free">t</span> <span class="free">t'</span> <span class="free">n</span> <span class="main">(</span><span class="free">γ'</span> <span class="keyword1">𝔘<span class="hidden">⇩</span><sub>b</sub></span> <span class="free">γ</span><span class="main">)</span>›</span></span>
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"eval <span class="free">c</span> <span class="free">t</span> <span class="free">t'</span> <span class="free">n</span> <span class="main">(</span><span class="main">λ</span> <span class="bound">t</span> <span class="bound">n</span><span class="main">.</span> <span class="main">∃</span><span class="bound"><span class="bound">n''</span></span><span class="main">≥</span><span class="bound">n</span><span class="main">.</span> <span class="free">γ</span> <span class="bound">t</span> <span class="bound">n''</span> <span class="main">∧</span> <span class="main">(</span><span class="main">∀</span><span class="bound"><span class="bound">n'</span></span><span class="main">≥</span><span class="bound">n</span><span class="main">.</span> <span class="bound">n'</span> <span class="main">&lt;</span> <span class="bound">n''</span> <span class="main">⟶</span> <span class="free">γ'</span> <span class="bound">t</span> <span class="bound">n'</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> until_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound"><span class="bound">n''</span></span><span class="main">≥</span><span class="free">n</span><span class="main">.</span> <span class="free">γ</span> <span class="main">(</span>lnth <span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span>inf_llist <span class="free">t</span> <span class="keyword1">@<span class="hidden">⇩</span><sub>l</sub></span> inf_llist <span class="free">t'</span><span class="main">)</span><span class="main">)</span> <span class="bound">n''</span>
    <span class="main">∧</span> <span class="main">(</span><span class="main">∀</span><span class="bound"><span class="bound">n'</span></span><span class="main">≥</span><span class="free">n</span><span class="main">.</span> <span class="bound">n'</span> <span class="main">&lt;</span> <span class="bound">n''</span> <span class="main">⟶</span> <span class="free">γ'</span> <span class="main">(</span>lnth <span class="main">(</span>π<span class="hidden">⇘</span><sub><span class="free">c</span></sub><span class="hidden">⇙</span>inf_llist <span class="free">t</span> <span class="keyword1">@<span class="hidden">⇩</span><sub>l</sub></span> inf_llist <span class="free">t'</span><span class="main">)</span><span class="main">)</span> <span class="bound">n'</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="main">¬</span><span class="main">(</span><span class="main">∃</span><span class="bound">i</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i</span></sub><span class="hidden">⇙</span><span class="main">)</span>›</span></span>
    validCE_not_act<span class="main">[</span><span class="keyword2"><span class="keyword"><span class="operator">where</span></span></span> γ<span class="main"><span class="main">=</span></span><span class="quoted"><span class="quoted">"<span class="main">λ</span> <span class="bound">t</span> <span class="bound">n</span><span class="main">.</span> <span class="main">∃</span><span class="bound"><span class="bound">n''</span></span><span class="main">≥</span><span class="bound">n</span><span class="main">.</span> <span class="free">γ</span> <span class="bound">t</span> <span class="bound">n''</span> <span class="main">∧</span> <span class="main">(</span><span class="main">∀</span><span class="bound"><span class="bound">n'</span></span><span class="main">≥</span><span class="bound">n</span><span class="main">.</span> <span class="bound">n'</span> <span class="main">&lt;</span> <span class="bound">n''</span> <span class="main">⟶</span> <span class="free">γ'</span> <span class="bound">t</span> <span class="bound">n'</span><span class="main">)</span>"</span></span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">with</span></span> <span class="quoted"><span class="quoted">‹<span class="main">¬</span><span class="main">(</span><span class="main">∃</span><span class="bound">i</span><span class="main">.</span> <span class="main"><span class="free">∥</span></span><span class="free">c</span>∥<span class="hidden">⇘</span><sub><span class="free">t</span> <span class="bound">i</span></sub><span class="hidden">⇙</span><span class="main">)</span>›</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> validCI_not_act <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
<span class="keyword1"><span class="command">qed</span></span>
  
<span class="keyword1"><span class="command">subsubsection</span></span> <span class="quoted"><span class="plain_text">"Weak Until"</span></span>

<span class="keyword1"><span class="command">definition</span></span> <span class="entity">wuntil</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="tfree">'cmp</span> bta<span class="main">)</span> <span class="main">⇒</span> <span class="main">(</span><span class="tfree">'cmp</span> bta<span class="main">)</span> <span class="main">⇒</span> <span class="main">(</span><span class="tfree">'cmp</span> bta<span class="main">)</span>"</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">infixl</span></span> <span class="quoted">"<span class="keyword1">𝔚<span class="hidden">⇩</span><sub>b</sub></span>"</span> 20<span class="main">)</span>
  <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="free"><span class="bound"><span class="entity">γ'</span></span></span> <span class="keyword1"><span class="free">𝔚<span class="hidden">⇩</span><sub>b</sub></span></span> <span class="free"><span class="bound"><span class="entity">γ</span></span></span> <span class="main">≡</span> <span class="free"><span class="bound"><span class="entity">γ'</span></span></span> <span class="keyword1">𝔘<span class="hidden">⇩</span><sub>b</sub></span> <span class="free"><span class="bound"><span class="entity">γ</span></span></span> <span class="keyword1">∨<span class="hidden">⇧</span><sup>b</sup></span> <span class="keyword1">□<span class="hidden">⇩</span><sub>b</sub></span><span class="main">(</span><span class="free"><span class="bound"><span class="entity">γ'</span></span></span><span class="main">)</span>"</span></span>

<span class="keyword2"><span class="keyword">end</span></span>
  
<span class="keyword2"><span class="keyword">end</span></span>
</pre>
</div>
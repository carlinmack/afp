<div id="MTX_Preliminaries">
<div class="head">
<h1>Theory MTX_Preliminaries</h1>
</div>
<pre class="source"><span class="comment1">(*  Title:       Mathematical Preliminaries
    Author:      Jonathan Juli√°n Huerta y Munive, 2020
    Maintainer:  Jonathan Juli√°n Huerta y Munive &lt;jonjulian23@gmail.com&gt;
*)</span>

<span class="keyword1"><span class="command">section</span></span> <span class="quoted"><span class="plain_text">‚Äπ Mathematical Preliminaries ‚Ä∫</span></span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‚ÄπThis section adds useful syntax, abbreviations and theorems to the Isabelle distribution. ‚Ä∫</span></span>

<span class="keyword1"><span class="command">theory</span></span> MTX_Preliminaries
  <span class="keyword2"><span class="keyword">imports</span></span> <a href="../Hybrid_Systems_VCs/HS_Preliminaries.html">Hybrid_Systems_VCs.HS_Preliminaries</a>

<span class="keyword2"><span class="keyword">begin</span></span>


<span class="keyword1"><span class="command">subsection</span></span> <span class="quoted"><span class="plain_text">‚Äπ Syntax ‚Ä∫</span></span>

<span class="keyword1"><span class="command">abbreviation</span></span> <span class="quoted"><span class="quoted">"<span class="free">ùñæ</span> <span class="free"><span class="bound"><span class="entity">k</span></span></span> <span class="main">‚â°</span> axis <span class="free"><span class="bound"><span class="entity">k</span></span></span> <span class="main">1</span>"</span></span>

<span class="keyword1"><span class="command">syntax</span></span>
  <span class="quoted">"_ivl_integral"</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"real <span class="main">‚áí</span> real <span class="main">‚áí</span> <span class="tfree">'a</span> <span class="main">‚áí</span> pttrn <span class="main">‚áí</span> bool"</span></span> <span class="main">(</span><span class="quoted">"<span class="keyword3">(3</span><span class="keyword1">‚à´‚á©</span>_<span class="keyword1">‚áß</span>_ <span class="keyword3">(</span>_<span class="keyword3">)</span><span class="keyword1">‚àÇ</span><span class="keyword3">/</span>_<span class="keyword3">)</span>"</span> <span class="main">[</span>0<span class="main">,</span> 0<span class="main">,</span> 10<span class="main">]</span> 10<span class="main">)</span>

<span class="keyword1"><span class="command">translations</span></span>
  <span class="quoted">"<span class="main">‚à´‚á©</span><span class="free">a</span><span class="main">‚áß</span><span class="free">b</span> <span class="free">f</span> <span class="main">‚àÇ</span><span class="free">x</span>"</span> <span class="main">‚áå</span> <span class="quoted">"<span class="keyword1">CONST</span> ivl_integral <span class="free">a</span> <span class="free">b</span> <span class="main">(</span><span class="main">Œª</span><span class="free">x</span><span class="main">.</span> <span class="free">f</span><span class="main">)</span>"</span>

<span class="keyword1"><span class="command">notation</span></span> matrix_inv <span class="main">(</span><span class="quoted">"_<span class="keyword1"><span class="hidden">‚áß</span><sup>-</sup><span class="hidden">‚áß</span><sup>1</sup></span>"</span> <span class="main">[</span>90<span class="main">]</span><span class="main">)</span>

<span class="keyword1"><span class="command">abbreviation</span></span> <span class="quoted"><span class="quoted">"<span class="free">entries</span> <span class="main">(</span><span class="free"><span class="bound"><span class="entity">A</span></span></span><span class="main">::</span><span class="tfree">'a</span><span class="main">^</span><span class="tfree">'n</span><span class="main">^</span><span class="tfree">'m</span><span class="main">)</span> <span class="main">‚â°</span> <span class="main">{</span><span class="free"><span class="bound"><span class="entity">A</span></span></span> <span class="main">$</span> <span class="bound">i</span> <span class="main">$</span> <span class="bound">j</span> <span class="main">|</span> <span class="bound">i</span> <span class="bound">j</span><span class="main">.</span> <span class="bound">i</span> <span class="main">‚àà</span> UNIV <span class="main">‚àß</span> <span class="bound">j</span> <span class="main">‚àà</span> UNIV<span class="main">}</span>"</span></span>


<span class="keyword1"><span class="command">subsection</span></span> <span class="quoted"><span class="plain_text">‚Äπ Topology and sets ‚Ä∫</span></span>

<span class="keyword1"><span class="command">lemmas</span></span> compact_imp_bdd_above <span class="main">=</span> compact_imp_bounded<span class="main">[</span><span class="operator">THEN</span> bounded_imp_bdd_above<span class="main">]</span>

<span class="keyword1"><span class="command">lemma</span></span> comp_cont_image_spec<span class="main">:</span> <span class="quoted"><span class="quoted">"continuous_on <span class="free">T</span> <span class="free">f</span> <span class="main">‚üπ</span> compact <span class="free">T</span> <span class="main">‚üπ</span> compact <span class="main">{</span><span class="free">f</span> <span class="bound">t</span> <span class="main">|</span><span class="bound">t</span><span class="main">.</span> <span class="bound">t</span> <span class="main">‚àà</span> <span class="free">T</span><span class="main">}</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> compact_continuous_image <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> Setcompr_eq_image<span class="main">)</span>

<span class="keyword1"><span class="command">lemmas</span></span> bdd_above_cont_comp_spec <span class="main">=</span> compact_imp_bdd_above<span class="main">[</span><span class="operator">OF</span> comp_cont_image_spec<span class="main">]</span>

<span class="keyword1"><span class="command">lemmas</span></span> bdd_above_norm_cont_comp <span class="main">=</span> continuous_on_norm<span class="main">[</span><span class="operator">THEN</span> bdd_above_cont_comp_spec<span class="main">]</span>

<span class="keyword1"><span class="command">lemma</span></span> open_cballE<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">t<span class="hidden">‚á©</span><sub>0</sub></span> <span class="main">‚àà</span> <span class="free">T</span> <span class="main">‚üπ</span> open <span class="free">T</span> <span class="main">‚üπ</span> <span class="main">‚àÉ</span><span class="bound"><span class="bound">e</span></span><span class="main">&gt;</span><span class="main">0</span><span class="main">.</span> cball <span class="free">t<span class="hidden">‚á©</span><sub>0</sub></span> <span class="bound">e</span> <span class="main">‚äÜ</span> <span class="free">T</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> open_contains_cball <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>

<span class="keyword1"><span class="command">lemma</span></span> open_ballE<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">t<span class="hidden">‚á©</span><sub>0</sub></span> <span class="main">‚àà</span> <span class="free">T</span> <span class="main">‚üπ</span> open <span class="free">T</span> <span class="main">‚üπ</span> <span class="main">‚àÉ</span><span class="bound"><span class="bound">e</span></span><span class="main">&gt;</span><span class="main">0</span><span class="main">.</span> ball <span class="free">t<span class="hidden">‚á©</span><sub>0</sub></span> <span class="bound">e</span> <span class="main">‚äÜ</span> <span class="free">T</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> open_contains_ball <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>

<span class="keyword1"><span class="command">lemma</span></span> funcset_UNIV<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">f</span> <span class="main">‚àà</span> <span class="free">A</span> <span class="main">‚Üí</span> UNIV"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">lemma</span></span> finite_image_of_finite<span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span>
  <span class="keyword2"><span class="keyword">fixes</span></span> <span class="free">f</span><span class="main">::</span><span class="quoted"><span class="quoted">"<span class="tfree">'a</span><span class="main">::</span>finite <span class="main">‚áí</span> <span class="tfree">'b</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"finite <span class="main">{</span><span class="bound">x</span><span class="main">.</span> <span class="main">‚àÉ</span><span class="bound">i</span><span class="main">.</span> <span class="bound">x</span> <span class="main">=</span> <span class="free">f</span> <span class="bound">i</span><span class="main">}</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> finite_Atleast_Atmost_nat <span class="keyword1"><span class="command">by</span></span> <span class="operator">force</span>

<span class="keyword1"><span class="command">lemma</span></span> finite_image_of_finite2<span class="main">:</span>
  <span class="keyword2"><span class="keyword">fixes</span></span> <span class="free">f</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'a</span><span class="main">::</span>finite <span class="main">‚áí</span> <span class="tfree">'b</span><span class="main">::</span>finite <span class="main">‚áí</span> <span class="tfree">'c</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"finite <span class="main">{</span><span class="free">f</span> <span class="bound">x</span> <span class="bound">y</span> <span class="main">|</span><span class="bound">x</span> <span class="bound">y</span><span class="main">.</span> <span class="free">P</span> <span class="bound">x</span> <span class="bound">y</span><span class="main">}</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"finite <span class="main">(</span><span class="main">‚ãÉ</span><span class="bound">x</span><span class="main">.</span> <span class="main">{</span><span class="free">f</span> <span class="bound">x</span> <span class="bound">y</span><span class="main">|</span><span class="bound">y</span><span class="main">.</span> <span class="free">P</span> <span class="bound">x</span> <span class="bound">y</span><span class="main">}</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">{</span><span class="free">f</span> <span class="bound">x</span> <span class="bound">y</span><span class="main">|</span><span class="bound">x</span> <span class="bound">y</span><span class="main">.</span> <span class="free">P</span> <span class="bound">x</span> <span class="bound">y</span><span class="main">}</span> <span class="main">=</span> <span class="main">(</span><span class="main">‚ãÉ</span><span class="bound">x</span><span class="main">.</span> <span class="main">{</span><span class="free">f</span> <span class="bound">x</span> <span class="bound">y</span><span class="main">|</span><span class="bound">y</span><span class="main">.</span> <span class="free">P</span> <span class="bound">x</span> <span class="bound">y</span><span class="main">}</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> 
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>


<span class="keyword1"><span class="command">subsection</span></span> <span class="quoted"><span class="plain_text">‚Äπ Functions ‚Ä∫</span></span>

<span class="keyword1"><span class="command">lemma</span></span> finite_sum_univ_singleton<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span>sum <span class="free">g</span> UNIV<span class="main">)</span> <span class="main">=</span> sum <span class="free">g</span> <span class="main">{</span><span class="free">i</span><span class="main">::</span><span class="tfree">'a</span><span class="main">::</span>finite<span class="main">}</span> <span class="main">+</span> sum <span class="free">g</span> <span class="main">(</span>UNIV <span class="main">-</span> <span class="main">{</span><span class="free">i</span><span class="main">}</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> add.commute finite_class.finite_UNIV sum.subset_diff top_greatest<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> suminfI<span class="main">:</span>
  <span class="keyword2"><span class="keyword">fixes</span></span> <span class="free">f</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"nat <span class="main">‚áí</span> <span class="tfree">'a</span><span class="main">::</span><span class="main">{</span>t2_space<span class="main">,</span>comm_monoid_add<span class="main">}</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">f</span> <span class="keyword1">sums</span> <span class="free">k</span> <span class="main">‚üπ</span> suminf <span class="free">f</span> <span class="main">=</span> <span class="free">k</span>"</span></span>
  <span class="keyword1"><span class="command">unfolding</span></span> sums_iff <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>

<span class="keyword1"><span class="command">lemma</span></span> suminf_eq_sum<span class="main">:</span>
  <span class="keyword2"><span class="keyword">fixes</span></span> <span class="free">f</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"nat <span class="main">‚áí</span> <span class="main">(</span><span class="tfree">'a</span><span class="main">::</span>real_normed_vector<span class="main">)</span>"</span></span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="main">‚ãÄ</span><span class="bound">n</span><span class="main">.</span> <span class="bound">n</span> <span class="main">&gt;</span> <span class="free">m</span> <span class="main">‚üπ</span> <span class="free">f</span> <span class="bound">n</span> <span class="main">=</span> <span class="main">0</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">‚àë</span><span class="bound">n</span><span class="main">.</span> <span class="free">f</span> <span class="bound">n</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="main">‚àë</span><span class="bound">n</span> <span class="main">‚â§</span> <span class="free">m</span><span class="main">.</span> <span class="free">f</span> <span class="bound">n</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">meson</span> atMost_iff finite_atMost not_le suminf_finite<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> suminf_multr<span class="main">:</span> <span class="quoted"><span class="quoted">"summable <span class="free">f</span> <span class="main">‚üπ</span> <span class="main">(</span><span class="main">‚àë</span><span class="bound">n</span><span class="main">.</span> <span class="free">f</span> <span class="bound">n</span> <span class="main">*</span> <span class="free">c</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="main">‚àë</span><span class="bound">n</span><span class="main">.</span> <span class="free">f</span> <span class="bound">n</span><span class="main">)</span> <span class="main">*</span> <span class="free">c</span>"</span></span> <span class="keyword2"><span class="keyword">for</span></span> <span class="free">c</span><span class="main">::</span><span class="quoted"><span class="quoted">"<span class="tfree">'a</span><span class="main">::</span>real_normed_algebra"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> bounded_linear.suminf <span class="main"><span class="main">[</span></span><span class="operator">OF</span> bounded_linear_mult_left<span class="main"><span class="main">,</span></span> <span class="operator">symmetric</span><span class="main"><span class="main">]</span></span><span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> sum_if_then_else_simps<span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span>
  <span class="keyword2"><span class="keyword">fixes</span></span> <span class="free">q</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="tfree">'a</span><span class="main">::</span>semiring_0<span class="main">)</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="free">i</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'n</span><span class="main">::</span>finite"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">‚àë</span><span class="bound">j</span><span class="main">‚àà</span>UNIV<span class="main">.</span> <span class="free">f</span> <span class="bound">j</span> <span class="main">*</span> <span class="main">(</span><span class="keyword1">if</span> <span class="bound">j</span> <span class="main">=</span> <span class="free">i</span> <span class="keyword1">then</span> <span class="free">q</span> <span class="keyword1">else</span> <span class="main">0</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> <span class="free">f</span> <span class="free">i</span> <span class="main">*</span> <span class="free">q</span>"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">‚àë</span><span class="bound">j</span><span class="main">‚àà</span>UNIV<span class="main">.</span> <span class="free">f</span> <span class="bound">j</span> <span class="main">*</span> <span class="main">(</span><span class="keyword1">if</span> <span class="free">i</span> <span class="main">=</span> <span class="bound">j</span> <span class="keyword1">then</span> <span class="free">q</span> <span class="keyword1">else</span> <span class="main">0</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> <span class="free">f</span> <span class="free">i</span> <span class="main">*</span> <span class="free">q</span>"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">‚àë</span><span class="bound">j</span><span class="main">‚àà</span>UNIV<span class="main">.</span> <span class="main">(</span><span class="keyword1">if</span> <span class="free">i</span> <span class="main">=</span> <span class="bound">j</span> <span class="keyword1">then</span> <span class="free">q</span> <span class="keyword1">else</span> <span class="main">0</span><span class="main">)</span> <span class="main">*</span> <span class="free">f</span> <span class="bound">j</span><span class="main">)</span> <span class="main">=</span> <span class="free">q</span> <span class="main">*</span> <span class="free">f</span> <span class="free">i</span>"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">‚àë</span><span class="bound">j</span><span class="main">‚àà</span>UNIV<span class="main">.</span> <span class="main">(</span><span class="keyword1">if</span> <span class="bound">j</span> <span class="main">=</span> <span class="free">i</span> <span class="keyword1">then</span> <span class="free">q</span> <span class="keyword1">else</span> <span class="main">0</span><span class="main">)</span> <span class="main">*</span> <span class="free">f</span> <span class="bound">j</span><span class="main">)</span> <span class="main">=</span> <span class="free">q</span> <span class="main">*</span> <span class="free">f</span> <span class="free">i</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> finite_sum_univ_singleton<span class="main"><span class="main">[</span></span><span class="operator">of</span> <span class="main"><span class="main">_</span></span> <span class="quoted"><span class="free">i</span></span><span class="main"><span class="main">]</span></span><span class="main">)</span>


<span class="keyword1"><span class="command">subsection</span></span> <span class="quoted"><span class="plain_text">‚Äπ Suprema ‚Ä∫</span></span>

<span class="keyword1"><span class="command">lemma</span></span> le_max_image_of_finite<span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span>
  <span class="keyword2"><span class="keyword">fixes</span></span> <span class="free">f</span><span class="main">::</span><span class="quoted"><span class="quoted">"<span class="tfree">'a</span><span class="main">::</span>finite <span class="main">‚áí</span> <span class="tfree">'b</span><span class="main">::</span>linorder"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">f</span> <span class="free">i</span><span class="main">)</span> <span class="main">‚â§</span> Max <span class="main">{</span><span class="bound">x</span><span class="main">.</span> <span class="main">‚àÉ</span><span class="bound">i</span><span class="main">.</span> <span class="bound">x</span> <span class="main">=</span> <span class="free">f</span> <span class="bound">i</span><span class="main">}</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> Max.coboundedI<span class="main"><span class="keyword3">,</span></span> <span class="operator">simp_all</span><span class="main">)</span> <span class="main">(</span><span class="operator">rule_tac</span> x<span class="main"><span class="main">=</span></span><span class="quoted"><span class="free">i</span></span> <span class="keyword2"><span class="keyword"><span class="quasi_keyword">in</span></span></span> exI<span class="main"><span class="keyword3">,</span></span> <span class="operator">simp</span><span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> cSup_eq<span class="main">:</span>
  <span class="keyword2"><span class="keyword">fixes</span></span> <span class="free">c</span><span class="main">::</span><span class="quoted"><span class="quoted">"<span class="tfree">'a</span><span class="main">::</span>conditionally_complete_lattice"</span></span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="main">‚àÄ</span><span class="bound">x</span> <span class="main">‚àà</span> <span class="free">X</span><span class="main">.</span> <span class="bound">x</span> <span class="main">‚â§</span> <span class="free">c</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">‚àÉ</span><span class="bound">x</span> <span class="main">‚àà</span> <span class="free">X</span><span class="main">.</span> <span class="free">c</span> <span class="main">‚â§</span> <span class="bound">x</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"Sup <span class="free">X</span> <span class="main">=</span> <span class="free">c</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> assms cSup_eq_maximum order_class.order.antisym<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> cSup_mem_eq<span class="main">:</span> 
  <span class="quoted"><span class="quoted">"<span class="free">c</span> <span class="main">‚àà</span> <span class="free">X</span> <span class="main">‚üπ</span> <span class="main">‚àÄ</span><span class="bound">x</span> <span class="main">‚àà</span> <span class="free">X</span><span class="main">.</span> <span class="bound">x</span> <span class="main">‚â§</span> <span class="free">c</span> <span class="main">‚üπ</span> Sup <span class="free">X</span> <span class="main">=</span> <span class="free">c</span>"</span></span> <span class="keyword2"><span class="keyword">for</span></span> <span class="free">c</span><span class="main">::</span><span class="quoted"><span class="quoted">"<span class="tfree">'a</span><span class="main">::</span>conditionally_complete_lattice"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> cSup_eq<span class="main"><span class="keyword3">,</span></span> <span class="operator">auto</span><span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> cSup_finite_ex<span class="main">:</span>
  <span class="quoted"><span class="quoted">"finite <span class="free">X</span> <span class="main">‚üπ</span> <span class="free">X</span> <span class="main">‚â†</span> <span class="main">{}</span> <span class="main">‚üπ</span> <span class="main">‚àÉ</span><span class="bound">x</span><span class="main">‚àà</span><span class="free">X</span><span class="main">.</span> Sup <span class="free">X</span> <span class="main">=</span> <span class="bound">x</span>"</span></span> <span class="keyword2"><span class="keyword">for</span></span> <span class="free">X</span><span class="main">::</span><span class="quoted"><span class="quoted">"<span class="tfree">'a</span><span class="main">::</span>conditionally_complete_linorder set"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> <span class="main"><span class="main">(</span></span>full_types<span class="main"><span class="main">)</span></span> bdd_finite<span class="main"><span class="main">(</span></span>1<span class="main"><span class="main">)</span></span> cSup_upper finite_Sup_less_iff order_less_le<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> cMax_finite_ex<span class="main">:</span>
  <span class="quoted"><span class="quoted">"finite <span class="free">X</span> <span class="main">‚üπ</span> <span class="free">X</span> <span class="main">‚â†</span> <span class="main">{}</span> <span class="main">‚üπ</span> <span class="main">‚àÉ</span><span class="bound">x</span><span class="main">‚àà</span><span class="free">X</span><span class="main">.</span> Max <span class="free">X</span> <span class="main">=</span> <span class="bound">x</span>"</span></span> <span class="keyword2"><span class="keyword">for</span></span> <span class="free">X</span><span class="main">::</span><span class="quoted"><span class="quoted">"<span class="tfree">'a</span><span class="main">::</span>conditionally_complete_linorder set"</span></span>
  <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="main">(</span><span class="operator">subst</span> cSup_eq_Max<span class="main"><span class="main">[</span></span><span class="operator">symmetric</span><span class="main"><span class="main">]</span></span><span class="main">)</span>
  <span class="keyword1"><span class="command">using</span></span> cSup_finite_ex <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">lemma</span></span> finite_nat_minimal_witness<span class="main">:</span>
  <span class="keyword2"><span class="keyword">fixes</span></span> <span class="free">P</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="tfree">'a</span><span class="main">::</span>finite<span class="main">)</span> <span class="main">‚áí</span> nat <span class="main">‚áí</span> bool"</span></span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="main">‚àÄ</span><span class="bound">i</span><span class="main">.</span> <span class="main">‚àÉ</span><span class="bound">N</span><span class="main">::</span>nat<span class="main">.</span> <span class="main">‚àÄ</span><span class="bound"><span class="bound">n</span></span> <span class="main">‚â•</span> <span class="bound">N</span><span class="main">.</span> <span class="free">P</span> <span class="bound">i</span> <span class="bound">n</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">‚àÉ</span><span class="bound">N</span><span class="main">.</span> <span class="main">‚àÄ</span><span class="bound">i</span><span class="main">.</span> <span class="main">‚àÄ</span><span class="bound"><span class="bound">n</span></span> <span class="main">‚â•</span> <span class="bound">N</span><span class="main">.</span> <span class="free">P</span> <span class="bound">i</span> <span class="bound">n</span>"</span></span> 
<span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
  <span class="keyword1"><span class="command">let</span></span> <span class="quoted"><span class="quoted">"<span class="var">?bound</span> <span class="free">i</span>"</span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="keyword1">LEAST</span> <span class="bound">N</span><span class="main">.</span> <span class="main">‚àÄ</span><span class="bound"><span class="bound">n</span></span> <span class="main">‚â•</span> <span class="bound">N</span><span class="main">.</span> <span class="free">P</span> <span class="free">i</span> <span class="bound">n</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?N</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"Max <span class="main">{</span><span class="var">?bound</span> <span class="bound">i</span> <span class="main">|</span><span class="bound">i</span><span class="main">.</span> <span class="bound">i</span> <span class="main">‚àà</span> UNIV<span class="main">}</span>"</span></span>
  <span class="keyword1"><span class="command">{</span></span><span class="keyword3"><span class="command">fix</span></span> <span class="skolem">n</span><span class="main">::</span><span class="quoted">nat</span> <span class="keyword2"><span class="keyword">and</span></span> <span class="skolem">i</span><span class="main">::</span><span class="tfree"><span class="quoted"><span class="tfree">'a</span></span></span> 
    <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">n</span> <span class="main">‚â•</span> <span class="var">?N</span>"</span></span> 
    <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">M</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="main">‚àÄ</span><span class="bound"><span class="bound">n</span></span> <span class="main">‚â•</span> <span class="skolem">M</span><span class="main">.</span> <span class="free">P</span> <span class="skolem">i</span> <span class="bound">n</span>"</span></span> 
      <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
    <span class="keyword1"><span class="command">hence</span></span> obs<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">‚àÄ</span> <span class="bound"><span class="bound">m</span></span> <span class="main">‚â•</span> <span class="var">?bound</span> <span class="skolem">i</span><span class="main">.</span> <span class="free">P</span> <span class="skolem">i</span> <span class="bound">m</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> LeastI<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="quoted">"<span class="main">Œª</span><span class="bound">N</span><span class="main">.</span> <span class="main">‚àÄ</span><span class="bound"><span class="bound">n</span></span> <span class="main">‚â•</span> <span class="bound">N</span><span class="main">.</span> <span class="free">P</span> <span class="skolem">i</span> <span class="bound">n</span>"</span></span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"finite <span class="main">{</span><span class="var">?bound</span> <span class="bound">i</span> <span class="main">|</span><span class="bound">i</span><span class="main">.</span> <span class="bound">i</span> <span class="main">‚àà</span> UNIV<span class="main">}</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="var">?N</span> <span class="main">‚â•</span> <span class="var">?bound</span> <span class="skolem">i</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> Max_ge <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
    <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">n</span> <span class="main">‚â•</span> <span class="var">?bound</span> <span class="skolem">i</span>"</span></span> 
      <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‚Äπ<span class="skolem">n</span> <span class="main">‚â•</span> <span class="var">?N</span>‚Ä∫</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">linarith</span>
    <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="free">P</span> <span class="skolem">i</span> <span class="skolem">n</span>"</span></span> 
      <span class="keyword1"><span class="command">using</span></span> obs <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span><span class="keyword1"><span class="command">}</span></span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"<span class="main">‚àÉ</span><span class="bound">N</span><span class="main">.</span> <span class="main">‚àÄ</span><span class="bound">i</span> <span class="bound">n</span><span class="main">.</span> <span class="bound">N</span> <span class="main">‚â§</span> <span class="bound">n</span> <span class="main">‚ü∂</span> <span class="free">P</span> <span class="bound">i</span> <span class="bound">n</span>"</span></span> 
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
<span class="keyword1"><span class="command">qed</span></span>


<span class="keyword1"><span class="command">subsection</span></span> <span class="quoted"><span class="plain_text">‚Äπ Real numbers ‚Ä∫</span></span>

<span class="keyword1"><span class="command">named_theorems</span></span> field_power_simps <span class="quoted">"simplification rules for powers to the nth"</span>

<span class="keyword1"><span class="command">declare</span></span> semiring_normalization_rules<span class="main">(</span>18<span class="main">)</span> <span class="main">[</span><span class="operator">field_power_simps</span><span class="main">]</span>
    <span class="keyword2"><span class="keyword">and</span></span> semiring_normalization_rules<span class="main">(</span>26<span class="main">)</span> <span class="main">[</span><span class="operator">field_power_simps</span><span class="main">]</span>
    <span class="keyword2"><span class="keyword">and</span></span> semiring_normalization_rules<span class="main">(</span>27<span class="main">)</span> <span class="main">[</span><span class="operator">field_power_simps</span><span class="main">]</span>
    <span class="keyword2"><span class="keyword">and</span></span> semiring_normalization_rules<span class="main">(</span>28<span class="main">)</span> <span class="main">[</span><span class="operator">field_power_simps</span><span class="main">]</span>
    <span class="keyword2"><span class="keyword">and</span></span> semiring_normalization_rules<span class="main">(</span>29<span class="main">)</span> <span class="main">[</span><span class="operator">field_power_simps</span><span class="main">]</span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‚ÄπWARNING: Adding <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">thm</span></span> semiring_normalization_rules<span class="main"><span class="main">(</span></span>27<span class="main"><span class="main">)</span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span> to our tactic makes 
its combination with simp to loop infinitely in some proofs.‚Ä∫</span></span>

<span class="keyword1"><span class="command">lemma</span></span> sq_le_cancel<span class="main">:</span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">a</span><span class="main">::</span>real<span class="main">)</span> <span class="main">‚â•</span> <span class="main">0</span> <span class="main">‚üπ</span> <span class="free">b</span> <span class="main">‚â•</span> <span class="main">0</span> <span class="main">‚üπ</span> <span class="free">a</span><span class="main">^</span><span class="numeral">2</span> <span class="main">‚â§</span> <span class="free">b</span> <span class="main">*</span> <span class="free">a</span> <span class="main">‚üπ</span> <span class="free">a</span> <span class="main">‚â§</span> <span class="free">b</span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">a</span><span class="main">::</span>real<span class="main">)</span> <span class="main">‚â•</span> <span class="main">0</span> <span class="main">‚üπ</span> <span class="free">b</span> <span class="main">‚â•</span> <span class="main">0</span> <span class="main">‚üπ</span> <span class="free">a</span><span class="main">^</span><span class="numeral">2</span> <span class="main">‚â§</span> <span class="free">a</span> <span class="main">*</span> <span class="free">b</span> <span class="main">‚üπ</span> <span class="free">a</span> <span class="main">‚â§</span> <span class="free">b</span>"</span></span>
   <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">metis</span> less_eq_real_def mult.commute mult_le_cancel_left semiring_normalization_rules<span class="main"><span class="main">(</span></span>29<span class="main"><span class="main">)</span></span><span class="main">)</span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> less_eq_real_def mult_le_cancel_left semiring_normalization_rules<span class="main"><span class="main">(</span></span>29<span class="main"><span class="main">)</span></span><span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> frac_diff_eq1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">a</span> <span class="main">‚â†</span> <span class="free">b</span> <span class="main">‚üπ</span> <span class="free">a</span> <span class="main">/</span> <span class="main">(</span><span class="free">a</span> <span class="main">-</span> <span class="free">b</span><span class="main">)</span> <span class="main">-</span> <span class="free">b</span> <span class="main">/</span> <span class="main">(</span><span class="free">a</span> <span class="main">-</span> <span class="free">b</span><span class="main">)</span> <span class="main">=</span> <span class="main">1</span>"</span></span> <span class="keyword2"><span class="keyword">for</span></span> <span class="free">a</span><span class="main">::</span><span class="quoted">real</span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> <span class="main"><span class="main">(</span></span>no_types<span class="main"><span class="main">,</span></span> hide_lams<span class="main"><span class="main">)</span></span> ab_left_minus add.commute add_left_cancel 
      diff_divide_distrib diff_minus_eq_add div_self<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> exp_add<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main">*</span> <span class="free">y</span> <span class="main">-</span> <span class="free">y</span> <span class="main">*</span> <span class="free">x</span> <span class="main">=</span> <span class="main">0</span> <span class="main">‚üπ</span> exp <span class="main">(</span><span class="free">x</span> <span class="main">+</span> <span class="free">y</span><span class="main">)</span> <span class="main">=</span> exp <span class="free">x</span> <span class="main">*</span> exp <span class="free">y</span>"</span></span> 
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> exp_add_commuting<span class="main">)</span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> <span class="dynamic"><span class="dynamic">ac_simps</span></span><span class="main">)</span>

<span class="keyword1"><span class="command">lemmas</span></span> mult_exp_exp <span class="main">=</span> exp_add<span class="main">[</span><span class="operator">symmetric</span><span class="main">]</span>


<span class="keyword1"><span class="command">subsection</span></span> <span class="quoted"><span class="plain_text">‚Äπ Vectors and matrices ‚Ä∫</span></span>

<span class="keyword1"><span class="command">lemma</span></span> sum_axis<span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span>
  <span class="keyword2"><span class="keyword">fixes</span></span> <span class="free">q</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="tfree">'a</span><span class="main">::</span>semiring_0<span class="main">)</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">‚àë</span><span class="bound">j</span><span class="main">‚àà</span>UNIV<span class="main">.</span> <span class="free">f</span> <span class="bound">j</span> <span class="main">*</span> axis <span class="free">i</span> <span class="free">q</span> <span class="main">$</span> <span class="bound">j</span><span class="main">)</span> <span class="main">=</span> <span class="free">f</span> <span class="free">i</span> <span class="main">*</span> <span class="free">q</span>"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">‚àë</span><span class="bound">j</span><span class="main">‚àà</span>UNIV<span class="main">.</span> axis <span class="free">i</span> <span class="free">q</span> <span class="main">$</span> <span class="bound">j</span> <span class="main">*</span> <span class="free">f</span> <span class="bound">j</span><span class="main">)</span> <span class="main">=</span> <span class="free">q</span> <span class="main">*</span> <span class="free">f</span> <span class="free">i</span>"</span></span>
  <span class="keyword1"><span class="command">unfolding</span></span> axis_def <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> vec_eq_iff<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> sum_scalar_nth_axis<span class="main">:</span> <span class="quoted"><span class="quoted">"sum <span class="main">(</span><span class="main">Œª</span><span class="bound">i</span><span class="main">.</span> <span class="main">(</span><span class="free">x</span> <span class="main">$</span> <span class="bound">i</span><span class="main">)</span> <span class="keyword1">*s</span> ùñæ <span class="bound">i</span><span class="main">)</span> UNIV <span class="main">=</span> <span class="free">x</span>"</span></span> <span class="keyword2"><span class="keyword">for</span></span> <span class="free">x</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="tfree">'a</span><span class="main">::</span>semiring_1<span class="main">)</span><span class="main">^</span><span class="tfree">'n</span>"</span></span>
  <span class="keyword1"><span class="command">unfolding</span></span> vec_eq_iff axis_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>

<span class="keyword1"><span class="command">lemma</span></span> scalar_eq_scaleR<span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">c</span> <span class="keyword1">*s</span> <span class="free">x</span> <span class="main">=</span> <span class="free">c</span> <span class="keyword1">*<span class="hidden">‚á©</span><sub>R</sub></span> <span class="free">x</span>"</span></span>
  <span class="keyword1"><span class="command">unfolding</span></span> vec_eq_iff <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>

<span class="keyword1"><span class="command">lemma</span></span> matrix_add_rdistrib<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">(</span><span class="free">B</span> <span class="main">+</span> <span class="free">C</span><span class="main">)</span> <span class="main">**</span> <span class="free">A</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="free">B</span> <span class="main">**</span> <span class="free">A</span><span class="main">)</span> <span class="main">+</span> <span class="main">(</span><span class="free">C</span> <span class="main">**</span> <span class="free">A</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">vector</span> matrix_matrix_mult_def sum.distrib<span class="main"><span class="main">[</span></span><span class="operator">symmetric</span><span class="main"><span class="main">]</span></span> <span class="dynamic"><span class="dynamic">field_simps</span></span><span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> vec_mult_inner<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">A</span> <span class="keyword1">*v</span> <span class="free">v</span><span class="main">)</span> <span class="main">‚àô</span> <span class="free">w</span> <span class="main">=</span> <span class="free">v</span> <span class="main">‚àô</span> <span class="main">(</span>transpose <span class="free">A</span> <span class="keyword1">*v</span> <span class="free">w</span><span class="main">)</span>"</span></span> <span class="keyword2"><span class="keyword">for</span></span> <span class="free">A</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"real <span class="main">^</span><span class="tfree">'n</span><span class="main">^</span><span class="tfree">'n</span>"</span></span>
  <span class="keyword1"><span class="command">unfolding</span></span> matrix_vector_mult_def transpose_def inner_vec_def
  <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> sum_distrib_right sum_distrib_left<span class="main">)</span>
  <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="main">(</span><span class="operator">subst</span> sum.swap<span class="main">)</span>
  <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="main">(</span><span class="operator">subgoal_tac</span> <span class="quoted"><span class="quoted">"<span class="main">‚àÄ</span><span class="bound">i</span> <span class="bound">j</span><span class="main">.</span> <span class="free">A</span> <span class="main">$</span> <span class="bound">i</span> <span class="main">$</span> <span class="bound">j</span> <span class="main">*</span> <span class="free">v</span> <span class="main">$</span> <span class="bound">j</span> <span class="main">*</span> <span class="free">w</span> <span class="main">$</span> <span class="bound">i</span> <span class="main">=</span> <span class="free">v</span> <span class="main">$</span> <span class="bound">j</span> <span class="main">*</span> <span class="main">(</span><span class="free">A</span> <span class="main">$</span> <span class="bound">i</span> <span class="main">$</span> <span class="bound">j</span> <span class="main">*</span> <span class="free">w</span> <span class="main">$</span> <span class="bound">i</span><span class="main">)</span>"</span></span><span class="main">)</span>
  <span class="keyword1"><span class="command">by</span></span> <span class="operator">presburger</span> <span class="operator">simp</span>

<span class="keyword1"><span class="command">lemma</span></span> uminus_axis_eq<span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">-</span> axis <span class="free">i</span> <span class="free">k</span> <span class="main">=</span> axis <span class="free">i</span> <span class="main">(</span><span class="main">-</span><span class="free">k</span><span class="main">)</span>"</span></span> <span class="keyword2"><span class="keyword">for</span></span> <span class="free">k</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'a</span><span class="main">::</span>ring"</span></span>
  <span class="keyword1"><span class="command">unfolding</span></span> axis_def <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> vec_eq_iff<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> norm_axis_eq<span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">‚à•</span>axis <span class="free">i</span> <span class="free">k</span><span class="main">‚à•</span> <span class="main">=</span> <span class="main">‚à•</span><span class="free">k</span><span class="main">‚à•</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span><span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> axis_def norm_vec_def L2_set_def<span class="main">)</span>
  <span class="keyword1"><span class="command">let</span></span> <span class="quoted"><span class="quoted">"<span class="var">?Œ¥<span class="hidden">‚á©</span><sub>K</sub></span>"</span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"<span class="main">Œª</span><span class="bound">i</span> <span class="bound">j</span> <span class="bound">k</span><span class="main">.</span> <span class="keyword1">if</span> <span class="bound">i</span> <span class="main">=</span> <span class="bound">j</span> <span class="keyword1">then</span> <span class="bound">k</span> <span class="keyword1">else</span> <span class="main">0</span>"</span></span> 
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">‚àë</span><span class="bound">j</span><span class="main">‚àà</span>UNIV<span class="main">.</span> <span class="main">(</span><span class="main">‚à•</span><span class="main">(</span><span class="var">?Œ¥<span class="hidden">‚á©</span><sub>K</sub></span> <span class="bound">j</span> <span class="free">i</span> <span class="free">k</span><span class="main">)</span><span class="main">‚à•</span><span class="main">)</span><span class="main"><span class="hidden">‚áß</span><sup>2</sup></span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="main">‚àë</span><span class="bound">j</span><span class="main">‚àà</span><span class="main">{</span><span class="free">i</span><span class="main">}</span><span class="main">.</span> <span class="main">(</span><span class="main">‚à•</span><span class="main">(</span><span class="var">?Œ¥<span class="hidden">‚á©</span><sub>K</sub></span> <span class="bound">j</span> <span class="free">i</span> <span class="free">k</span><span class="main">)</span><span class="main">‚à•</span><span class="main">)</span><span class="main"><span class="hidden">‚áß</span><sup>2</sup></span><span class="main">)</span> <span class="main">+</span> <span class="main">(</span><span class="main">‚àë</span><span class="bound">j</span><span class="main">‚àà</span><span class="main">(</span>UNIV<span class="main">-</span><span class="main">{</span><span class="free">i</span><span class="main">}</span><span class="main">)</span><span class="main">.</span> <span class="main">(</span><span class="main">‚à•</span><span class="main">(</span><span class="var">?Œ¥<span class="hidden">‚á©</span><sub>K</sub></span> <span class="bound">j</span> <span class="free">i</span> <span class="free">k</span><span class="main">)</span><span class="main">‚à•</span><span class="main">)</span><span class="main"><span class="hidden">‚áß</span><sup>2</sup></span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> finite_sum_univ_singleton <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span> 
  <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> <span class="main">(</span><span class="main">‚à•</span><span class="free">k</span><span class="main">‚à•</span><span class="main">)</span><span class="main"><span class="hidden">‚áß</span><sup>2</sup></span>"</span></span> 
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">finally</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"sqrt <span class="main">(</span><span class="main">‚àë</span><span class="bound">j</span><span class="main">‚àà</span>UNIV<span class="main">.</span> <span class="main">(</span>norm <span class="main">(</span><span class="keyword1">if</span> <span class="bound">j</span> <span class="main">=</span> <span class="free">i</span> <span class="keyword1">then</span> <span class="free">k</span> <span class="keyword1">else</span> <span class="main">0</span><span class="main">)</span><span class="main">)</span><span class="main"><span class="hidden">‚áß</span><sup>2</sup></span><span class="main">)</span> <span class="main">=</span> norm <span class="free">k</span>"</span></span> 
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">lemma</span></span> matrix_axis_0<span class="main">:</span> 
  <span class="keyword2"><span class="keyword">fixes</span></span> <span class="free">A</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="tfree">'a</span><span class="main">::</span>idom<span class="main">)</span><span class="main">^</span><span class="tfree">'n</span><span class="main">^</span><span class="tfree">'m</span>"</span></span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">k</span> <span class="main">‚â†</span> <span class="main">0</span> "</span></span> <span class="keyword2"><span class="keyword">and</span></span> h<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="main">‚àÄ</span><span class="bound">i</span><span class="main">.</span> <span class="main">(</span><span class="free">A</span> <span class="keyword1">*v</span> <span class="main">(</span>axis <span class="bound">i</span> <span class="free">k</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> <span class="main">0</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">A</span> <span class="main">=</span> <span class="main">0</span>"</span></span>  
<span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
  <span class="keyword1"><span class="command">{</span></span><span class="keyword3"><span class="command">fix</span></span> <span class="skolem">i</span><span class="main">::</span><span class="tfree"><span class="quoted"><span class="tfree">'n</span></span></span>
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">0</span> <span class="main">=</span> <span class="main">(</span><span class="main">‚àë</span><span class="bound">j</span><span class="main">‚àà</span>UNIV<span class="main">.</span> <span class="main">(</span>axis <span class="skolem">i</span> <span class="free">k</span><span class="main">)</span> <span class="main">$</span> <span class="bound">j</span> <span class="keyword1">*s</span> column <span class="bound">j</span> <span class="free">A</span><span class="main">)</span>"</span></span> 
      <span class="keyword1"><span class="command">using</span></span> h matrix_mult_sum<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="free">A</span></span> <span class="quoted"><span class="quoted">"axis <span class="skolem">i</span> <span class="free">k</span>"</span></span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> <span class="free">k</span> <span class="keyword1">*s</span> column <span class="skolem">i</span> <span class="free">A</span>"</span></span> 
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> axis_def vector_scalar_mult_def column_def vec_eq_iff mult.commute<span class="main">)</span>
    <span class="keyword1"><span class="command">finally</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">k</span> <span class="keyword1">*s</span> column <span class="skolem">i</span> <span class="free">A</span> <span class="main">=</span> <span class="main">0</span>"</span></span>
      <span class="keyword1"><span class="command">unfolding</span></span> axis_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"column <span class="skolem">i</span> <span class="free">A</span> <span class="main">=</span> <span class="main">0</span>"</span></span> 
      <span class="keyword1"><span class="command">using</span></span> vector_mul_eq_0 <span class="quoted"><span class="quoted">‚Äπ<span class="free">k</span> <span class="main">‚â†</span> <span class="main">0</span>‚Ä∫</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span><span class="keyword1"><span class="command">}</span></span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"<span class="free">A</span> <span class="main">=</span> <span class="main">0</span>"</span></span> 
    <span class="keyword1"><span class="command">unfolding</span></span> column_def vec_eq_iff <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">lemma</span></span> scaleR_norm_sgn_eq<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">‚à•</span><span class="free">x</span><span class="main">‚à•</span><span class="main">)</span> <span class="keyword1">*<span class="hidden">‚á©</span><sub>R</sub></span> sgn <span class="free">x</span> <span class="main">=</span> <span class="free">x</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> divideR_right norm_eq_zero scale_eq_0_iff sgn_div_norm<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> vector_scaleR_commute<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">A</span> <span class="keyword1">*v</span> <span class="free">c</span> <span class="keyword1">*<span class="hidden">‚á©</span><sub>R</sub></span> <span class="free">x</span> <span class="main">=</span> <span class="free">c</span> <span class="keyword1">*<span class="hidden">‚á©</span><sub>R</sub></span> <span class="main">(</span><span class="free">A</span> <span class="keyword1">*v</span> <span class="free">x</span><span class="main">)</span>"</span></span> <span class="keyword2"><span class="keyword">for</span></span> <span class="free">x</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="tfree">'a</span><span class="main">::</span>real_normed_algebra_1<span class="main">)</span><span class="main">^</span><span class="tfree">'n</span>"</span></span>
  <span class="keyword1"><span class="command">unfolding</span></span> scaleR_vec_def matrix_vector_mult_def <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> vec_eq_iff scaleR_right.sum<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> scaleR_vector_assoc<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">c</span> <span class="keyword1">*<span class="hidden">‚á©</span><sub>R</sub></span> <span class="main">(</span><span class="free">A</span> <span class="keyword1">*v</span> <span class="free">x</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="free">c</span> <span class="keyword1">*<span class="hidden">‚á©</span><sub>R</sub></span> <span class="free">A</span><span class="main">)</span> <span class="keyword1">*v</span> <span class="free">x</span>"</span></span> <span class="keyword2"><span class="keyword">for</span></span> <span class="free">x</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="tfree">'a</span><span class="main">::</span>real_normed_algebra_1<span class="main">)</span><span class="main">^</span><span class="tfree">'n</span>"</span></span>
  <span class="keyword1"><span class="command">unfolding</span></span> matrix_vector_mult_def <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> vec_eq_iff scaleR_right.sum<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> mult_norm_matrix_sgn_eq<span class="main">:</span>
  <span class="keyword2"><span class="keyword">fixes</span></span> <span class="free">x</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="tfree">'a</span><span class="main">::</span>real_normed_algebra_1<span class="main">)</span><span class="main">^</span><span class="tfree">'n</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">‚à•</span><span class="free">A</span> <span class="keyword1">*v</span> sgn <span class="free">x</span><span class="main">‚à•</span><span class="main">)</span> <span class="main">*</span> <span class="main">(</span><span class="main">‚à•</span><span class="free">x</span><span class="main">‚à•</span><span class="main">)</span> <span class="main">=</span> <span class="main">‚à•</span><span class="free">A</span> <span class="keyword1">*v</span> <span class="free">x</span><span class="main">‚à•</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">‚à•</span><span class="free">A</span> <span class="keyword1">*v</span> <span class="free">x</span><span class="main">‚à•</span> <span class="main">=</span> <span class="main">‚à•</span><span class="free">A</span> <span class="keyword1">*v</span> <span class="main">(</span><span class="main">(</span><span class="main">‚à•</span><span class="free">x</span><span class="main">‚à•</span><span class="main">)</span> <span class="keyword1">*<span class="hidden">‚á©</span><sub>R</sub></span> sgn <span class="free">x</span><span class="main">)</span><span class="main">‚à•</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> scaleR_norm_sgn_eq<span class="main">)</span>
  <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> <span class="main">(</span><span class="main">‚à•</span><span class="free">A</span> <span class="keyword1">*v</span> sgn <span class="free">x</span><span class="main">‚à•</span><span class="main">)</span> <span class="main">*</span> <span class="main">(</span><span class="main">‚à•</span><span class="free">x</span><span class="main">‚à•</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> vector_scaleR_commute<span class="main">)</span>
  <span class="keyword1"><span class="command">finally</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">..</span></span>
<span class="keyword1"><span class="command">qed</span></span>


<span class="keyword1"><span class="command">subsection</span></span><span class="quoted"><span class="plain_text">‚Äπ Diagonalization ‚Ä∫</span></span>

<span class="keyword1"><span class="command">lemma</span></span> invertibleI<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">A</span> <span class="main">**</span> <span class="free">B</span> <span class="main">=</span> mat <span class="main">1</span> <span class="main">‚üπ</span> <span class="free">B</span> <span class="main">**</span> <span class="free">A</span> <span class="main">=</span> mat <span class="main">1</span> <span class="main">‚üπ</span> invertible <span class="free">A</span>"</span></span>
  <span class="keyword1"><span class="command">unfolding</span></span> invertible_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">lemma</span></span> invertibleD<span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"invertible <span class="free">A</span>"</span></span> 
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">A</span><span class="main"><span class="hidden">‚áß</span><sup>-</sup><span class="hidden">‚áß</span><sup>1</sup></span> <span class="main">**</span> <span class="free">A</span> <span class="main">=</span> mat <span class="main">1</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">A</span> <span class="main">**</span> <span class="free">A</span><span class="main"><span class="hidden">‚áß</span><sup>-</sup><span class="hidden">‚áß</span><sup>1</sup></span> <span class="main">=</span> mat <span class="main">1</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">unfolding</span></span> matrix_inv_def invertible_def
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp_all</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> verit_sko_ex'<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> matrix_inv_unique<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">A</span> <span class="main">**</span> <span class="free">B</span> <span class="main">=</span> mat <span class="main">1</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">B</span> <span class="main">**</span> <span class="free">A</span> <span class="main">=</span> mat <span class="main">1</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">A</span><span class="main"><span class="hidden">‚áß</span><sup>-</sup><span class="hidden">‚áß</span><sup>1</sup></span> <span class="main">=</span> <span class="free">B</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> assms invertibleD<span class="main"><span class="main">(</span></span>2<span class="main"><span class="main">)</span></span> invertibleI matrix_mul_assoc matrix_mul_lid<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> invertible_matrix_inv<span class="main">:</span> <span class="quoted"><span class="quoted">"invertible <span class="free">A</span> <span class="main">‚üπ</span> invertible <span class="main">(</span><span class="free">A</span><span class="main"><span class="hidden">‚áß</span><sup>-</sup><span class="hidden">‚áß</span><sup>1</sup></span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> invertibleD invertibleI <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>

<span class="keyword1"><span class="command">lemma</span></span> matrix_inv_idempotent<span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"invertible <span class="free">A</span> <span class="main">‚üπ</span> <span class="free">A</span><span class="main"><span class="hidden">‚áß</span><sup>-</sup><span class="hidden">‚áß</span><sup>1</sup></span><span class="main"><span class="hidden">‚áß</span><sup>-</sup><span class="hidden">‚áß</span><sup>1</sup></span> <span class="main">=</span> <span class="free">A</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> invertibleD matrix_inv_unique <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  
<span class="keyword1"><span class="command">lemma</span></span> matrix_inv_matrix_mul<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"invertible <span class="free">A</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"invertible <span class="free">B</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">A</span> <span class="main">**</span> <span class="free">B</span><span class="main">)</span><span class="main"><span class="hidden">‚áß</span><sup>-</sup><span class="hidden">‚áß</span><sup>1</sup></span> <span class="main">=</span> <span class="free">B</span><span class="main"><span class="hidden">‚áß</span><sup>-</sup><span class="hidden">‚áß</span><sup>1</sup></span> <span class="main">**</span> <span class="free">A</span><span class="main"><span class="hidden">‚áß</span><sup>-</sup><span class="hidden">‚áß</span><sup>1</sup></span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span><span class="main">(</span><span class="operator">rule</span> matrix_inv_unique<span class="main">)</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">A</span> <span class="main">**</span> <span class="free">B</span> <span class="main">**</span> <span class="main">(</span><span class="free">B</span><span class="main"><span class="hidden">‚áß</span><sup>-</sup><span class="hidden">‚áß</span><sup>1</sup></span> <span class="main">**</span> <span class="free">A</span><span class="main"><span class="hidden">‚áß</span><sup>-</sup><span class="hidden">‚áß</span><sup>1</sup></span><span class="main">)</span> <span class="main">=</span> <span class="free">A</span> <span class="main">**</span> <span class="main">(</span><span class="free">B</span> <span class="main">**</span> <span class="free">B</span><span class="main"><span class="hidden">‚áß</span><sup>-</sup><span class="hidden">‚áß</span><sup>1</sup></span><span class="main">)</span> <span class="main">**</span> <span class="free">A</span><span class="main"><span class="hidden">‚áß</span><sup>-</sup><span class="hidden">‚áß</span><sup>1</sup></span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> matrix_mul_assoc<span class="main">)</span>
  <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> mat <span class="main">1</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">finally</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="free">A</span> <span class="main">**</span> <span class="free">B</span> <span class="main">**</span> <span class="main">(</span><span class="free">B</span><span class="main"><span class="hidden">‚áß</span><sup>-</sup><span class="hidden">‚áß</span><sup>1</sup></span> <span class="main">**</span> <span class="free">A</span><span class="main"><span class="hidden">‚áß</span><sup>-</sup><span class="hidden">‚áß</span><sup>1</sup></span><span class="main">)</span> <span class="main">=</span> mat <span class="main">1</span>"</span></span> <span class="keyword1"><span class="command">.</span></span>
<span class="keyword1"><span class="command">next</span></span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">B</span><span class="main"><span class="hidden">‚áß</span><sup>-</sup><span class="hidden">‚áß</span><sup>1</sup></span> <span class="main">**</span> <span class="free">A</span><span class="main"><span class="hidden">‚áß</span><sup>-</sup><span class="hidden">‚áß</span><sup>1</sup></span> <span class="main">**</span> <span class="main">(</span><span class="free">A</span> <span class="main">**</span> <span class="free">B</span><span class="main">)</span> <span class="main">=</span> <span class="free">B</span><span class="main"><span class="hidden">‚áß</span><sup>-</sup><span class="hidden">‚áß</span><sup>1</sup></span> <span class="main">**</span> <span class="main">(</span><span class="free">A</span><span class="main"><span class="hidden">‚áß</span><sup>-</sup><span class="hidden">‚áß</span><sup>1</sup></span> <span class="main">**</span> <span class="free">A</span><span class="main">)</span> <span class="main">**</span> <span class="free">B</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> matrix_mul_assoc<span class="main">)</span>
  <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> mat <span class="main">1</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">finally</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="free">B</span><span class="main"><span class="hidden">‚áß</span><sup>-</sup><span class="hidden">‚áß</span><sup>1</sup></span> <span class="main">**</span> <span class="free">A</span><span class="main"><span class="hidden">‚áß</span><sup>-</sup><span class="hidden">‚áß</span><sup>1</sup></span> <span class="main">**</span> <span class="main">(</span><span class="free">A</span> <span class="main">**</span> <span class="free">B</span><span class="main">)</span> <span class="main">=</span> mat <span class="main">1</span>"</span></span> <span class="keyword1"><span class="command">.</span></span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">lemma</span></span> mat_inverse_simps<span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span>
  <span class="keyword2"><span class="keyword">fixes</span></span> <span class="free">c</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'a</span><span class="main">::</span>division_ring"</span></span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">c</span> <span class="main">‚â†</span> <span class="main">0</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"mat <span class="main">(</span>inverse <span class="free">c</span><span class="main">)</span> <span class="main">**</span> mat <span class="free">c</span> <span class="main">=</span> mat <span class="main">1</span>"</span></span> 
    <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"mat <span class="free">c</span> <span class="main">**</span> mat <span class="main">(</span>inverse <span class="free">c</span><span class="main">)</span> <span class="main">=</span> mat <span class="main">1</span>"</span></span>
  <span class="keyword1"><span class="command">unfolding</span></span> matrix_matrix_mult_def mat_def <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> vec_eq_iff assms<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> matrix_inv_mat<span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">c</span> <span class="main">‚â†</span> <span class="main">0</span> <span class="main">‚üπ</span> <span class="main">(</span>mat <span class="free">c</span><span class="main">)</span><span class="main"><span class="hidden">‚áß</span><sup>-</sup><span class="hidden">‚áß</span><sup>1</sup></span> <span class="main">=</span> mat <span class="main">(</span>inverse <span class="free">c</span><span class="main">)</span>"</span></span> <span class="keyword2"><span class="keyword">for</span></span> <span class="free">c</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'a</span><span class="main">::</span>division_ring"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> matrix_inv_unique<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> invertible_mat<span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">c</span> <span class="main">‚â†</span> <span class="main">0</span> <span class="main">‚üπ</span> invertible <span class="main">(</span>mat <span class="free">c</span><span class="main">)</span>"</span></span> <span class="keyword2"><span class="keyword">for</span></span> <span class="free">c</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'a</span><span class="main">::</span>division_ring"</span></span>
  <span class="keyword1"><span class="command">using</span></span> invertibleI mat_inverse_simps<span class="main">(</span>1<span class="main">)</span> mat_inverse_simps<span class="main">(</span>2<span class="main">)</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>

<span class="keyword1"><span class="command">lemma</span></span> matrix_inv_mat_1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span>mat <span class="main">(</span><span class="main">1</span><span class="main">::</span><span class="tfree">'a</span><span class="main">::</span>division_ring<span class="main">)</span><span class="main">)</span><span class="main"><span class="hidden">‚áß</span><sup>-</sup><span class="hidden">‚áß</span><sup>1</sup></span> <span class="main">=</span> mat <span class="main">1</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>

<span class="keyword1"><span class="command">lemma</span></span> invertible_mat_1<span class="main">:</span> <span class="quoted"><span class="quoted">"invertible <span class="main">(</span>mat <span class="main">(</span><span class="main">1</span><span class="main">::</span><span class="tfree">'a</span><span class="main">::</span>division_ring<span class="main">)</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>

<span class="keyword1"><span class="command">definition</span></span> <span class="entity">similar_matrix</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="tfree">'a</span><span class="main">::</span>semiring_1<span class="main">)</span><span class="main">^</span><span class="tfree">'m</span><span class="main">^</span><span class="tfree">'m</span> <span class="main">‚áí</span> <span class="main">(</span><span class="tfree">'a</span><span class="main">::</span>semiring_1<span class="main">)</span><span class="main">^</span><span class="tfree">'n</span><span class="main">^</span><span class="tfree">'n</span> <span class="main">‚áí</span> bool"</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">infixr</span></span> <span class="quoted">"<span class="keyword1">‚àº</span>"</span> 25<span class="main">)</span>
  <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="free">similar_matrix</span> <span class="free"><span class="bound"><span class="entity">A</span></span></span> <span class="free"><span class="bound"><span class="entity">B</span></span></span> <span class="main">‚ü∑</span> <span class="main">(</span><span class="main">‚àÉ</span> <span class="bound">P</span><span class="main">.</span> invertible <span class="bound">P</span> <span class="main">‚àß</span> <span class="free"><span class="bound"><span class="entity">A</span></span></span> <span class="main">=</span> <span class="bound">P</span><span class="main"><span class="hidden">‚áß</span><sup>-</sup><span class="hidden">‚áß</span><sup>1</sup></span> <span class="main">**</span> <span class="free"><span class="bound"><span class="entity">B</span></span></span> <span class="main">**</span> <span class="bound">P</span><span class="main">)</span>"</span></span>

<span class="keyword1"><span class="command">lemma</span></span> similar_matrix_refl<span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">A</span> <span class="main">‚àº</span> <span class="free">A</span>"</span></span> <span class="keyword2"><span class="keyword">for</span></span> <span class="free">A</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'a</span><span class="main">::</span>division_ring<span class="main">^</span><span class="tfree">'n</span><span class="main">^</span><span class="tfree">'n</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">unfold</span> similar_matrix_def<span class="main"><span class="keyword3">,</span></span> <span class="operator">rule_tac</span> x<span class="main"><span class="main">=</span></span><span class="quoted"><span class="quoted">"mat <span class="main">1</span>"</span></span> <span class="keyword2"><span class="keyword"><span class="quasi_keyword">in</span></span></span> exI<span class="main"><span class="keyword3">,</span></span> <span class="operator">simp</span><span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> similar_matrix_simm<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">A</span> <span class="main">‚àº</span> <span class="free">B</span> <span class="main">‚üπ</span> <span class="free">B</span> <span class="main">‚àº</span> <span class="free">A</span>"</span></span> <span class="keyword2"><span class="keyword">for</span></span> <span class="free">A</span> <span class="free">B</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="tfree">'a</span><span class="main">::</span>semiring_1<span class="main">)</span><span class="main">^</span><span class="tfree">'n</span><span class="main">^</span><span class="tfree">'n</span>"</span></span>
  <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="main">(</span><span class="operator">unfold</span> similar_matrix_def<span class="main"><span class="keyword3">,</span></span> <span class="operator">clarsimp</span><span class="main">)</span>
  <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="main">(</span><span class="operator">rule_tac</span> x<span class="main"><span class="main">=</span></span><span class="quoted"><span class="quoted">"<span class="improper">P</span><span class="main"><span class="hidden">‚áß</span><sup>-</sup><span class="hidden">‚áß</span><sup>1</sup></span>"</span></span> <span class="keyword2"><span class="keyword"><span class="quasi_keyword">in</span></span></span> exI<span class="main"><span class="keyword3">,</span></span> <span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> invertible_matrix_inv<span class="main">)</span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> invertible_def matrix_inv_unique matrix_mul_assoc matrix_mul_lid matrix_mul_rid<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> similar_matrix_trans<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">A</span> <span class="main">‚àº</span> <span class="free">B</span> <span class="main">‚üπ</span> <span class="free">B</span> <span class="main">‚àº</span> <span class="free">C</span> <span class="main">‚üπ</span> <span class="free">A</span> <span class="main">‚àº</span> <span class="free">C</span>"</span></span> <span class="keyword2"><span class="keyword">for</span></span> <span class="free">A</span> <span class="free">B</span> <span class="free">C</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="tfree">'a</span><span class="main">::</span>semiring_1<span class="main">)</span><span class="main">^</span><span class="tfree">'n</span><span class="main">^</span><span class="tfree">'n</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span><span class="main">(</span><span class="operator">unfold</span> similar_matrix_def<span class="main"><span class="keyword3">,</span></span> <span class="operator">clarsimp</span><span class="main">)</span>
  <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">P</span> <span class="skolem">Q</span>
  <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="free">A</span> <span class="main">=</span> <span class="skolem">P</span><span class="main"><span class="hidden">‚áß</span><sup>-</sup><span class="hidden">‚áß</span><sup>1</sup></span> <span class="main">**</span> <span class="main">(</span><span class="skolem">Q</span><span class="main"><span class="hidden">‚áß</span><sup>-</sup><span class="hidden">‚áß</span><sup>1</sup></span> <span class="main">**</span> <span class="free">C</span> <span class="main">**</span> <span class="skolem">Q</span><span class="main">)</span> <span class="main">**</span> <span class="skolem">P</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">B</span> <span class="main">=</span> <span class="skolem">Q</span><span class="main"><span class="hidden">‚áß</span><sup>-</sup><span class="hidden">‚áß</span><sup>1</sup></span> <span class="main">**</span> <span class="free">C</span> <span class="main">**</span> <span class="skolem">Q</span>"</span></span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?R</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"<span class="skolem">Q</span> <span class="main">**</span> <span class="skolem">P</span>"</span></span>
  <span class="keyword3"><span class="command">assume</span></span> inverts<span class="main">:</span> <span class="quoted"><span class="quoted">"invertible <span class="skolem">Q</span>"</span></span> <span class="quoted"><span class="quoted">"invertible <span class="skolem">P</span>"</span></span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="var">?R</span><span class="main"><span class="hidden">‚áß</span><sup>-</sup><span class="hidden">‚áß</span><sup>1</sup></span> <span class="main">=</span> <span class="skolem">P</span><span class="main"><span class="hidden">‚áß</span><sup>-</sup><span class="hidden">‚áß</span><sup>1</sup></span> <span class="main">**</span> <span class="skolem">Q</span><span class="main"><span class="hidden">‚áß</span><sup>-</sup><span class="hidden">‚áß</span><sup>1</sup></span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> matrix_inv_matrix_mul<span class="main">)</span>
  <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"invertible <span class="var">?R</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> inverts invertible_mult <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span> 
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">‚àÉ</span><span class="bound">R</span><span class="main">.</span> invertible <span class="bound">R</span> <span class="main">‚àß</span> <span class="skolem">P</span><span class="main"><span class="hidden">‚áß</span><sup>-</sup><span class="hidden">‚áß</span><sup>1</sup></span> <span class="main">**</span> <span class="main">(</span><span class="skolem">Q</span><span class="main"><span class="hidden">‚áß</span><sup>-</sup><span class="hidden">‚áß</span><sup>1</sup></span> <span class="main">**</span> <span class="free">C</span> <span class="main">**</span> <span class="skolem">Q</span><span class="main">)</span> <span class="main">**</span> <span class="skolem">P</span> <span class="main">=</span> <span class="bound">R</span><span class="main"><span class="hidden">‚áß</span><sup>-</sup><span class="hidden">‚áß</span><sup>1</sup></span> <span class="main">**</span> <span class="free">C</span> <span class="main">**</span> <span class="bound">R</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> matrix_mul_assoc<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">lemma</span></span> mat_vec_nth_simps<span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span>
  <span class="quoted"><span class="quoted">"<span class="free">i</span> <span class="main">=</span> <span class="free">j</span> <span class="main">‚üπ</span> mat <span class="free">c</span> <span class="main">$</span> <span class="free">i</span> <span class="main">$</span> <span class="free">j</span> <span class="main">=</span> <span class="free">c</span>"</span></span> 
  <span class="quoted"><span class="quoted">"<span class="free">i</span> <span class="main">‚â†</span> <span class="free">j</span> <span class="main">‚üπ</span> mat <span class="free">c</span> <span class="main">$</span> <span class="free">i</span> <span class="main">$</span> <span class="free">j</span> <span class="main">=</span> <span class="main">0</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp_all</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> mat_def<span class="main">)</span>

<span class="keyword1"><span class="command">definition</span></span> <span class="quoted"><span class="quoted">"<span class="free">diag_mat</span> <span class="free"><span class="bound"><span class="entity">f</span></span></span> <span class="main">=</span> <span class="main">(</span><span class="keyword1">œá</span> <span class="bound">i</span> <span class="bound">j</span><span class="main">.</span> <span class="keyword1">if</span> <span class="bound">i</span> <span class="main">=</span> <span class="bound">j</span> <span class="keyword1">then</span> <span class="free"><span class="bound"><span class="entity">f</span></span></span> <span class="bound">i</span> <span class="keyword1">else</span> <span class="main">0</span><span class="main">)</span>"</span></span>

<span class="keyword1"><span class="command">lemma</span></span> diag_mat_vec_nth_simps<span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span>
  <span class="quoted"><span class="quoted">"<span class="free">i</span> <span class="main">=</span> <span class="free">j</span> <span class="main">‚üπ</span> diag_mat <span class="free">f</span> <span class="main">$</span> <span class="free">i</span> <span class="main">$</span> <span class="free">j</span> <span class="main">=</span> <span class="free">f</span> <span class="free">i</span>"</span></span>
  <span class="quoted"><span class="quoted">"<span class="free">i</span> <span class="main">‚â†</span> <span class="free">j</span> <span class="main">‚üπ</span> diag_mat <span class="free">f</span> <span class="main">$</span> <span class="free">i</span> <span class="main">$</span> <span class="free">j</span> <span class="main">=</span> <span class="main">0</span>"</span></span>
  <span class="keyword1"><span class="command">unfolding</span></span> diag_mat_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp_all</span>

<span class="keyword1"><span class="command">lemma</span></span> diag_mat_const_eq<span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"diag_mat <span class="main">(</span><span class="main">Œª</span><span class="bound">i</span><span class="main">.</span> <span class="free">c</span><span class="main">)</span> <span class="main">=</span> mat <span class="free">c</span>"</span></span>
  <span class="keyword1"><span class="command">unfolding</span></span> mat_def diag_mat_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>

<span class="keyword1"><span class="command">lemma</span></span> matrix_vector_mul_diag_mat<span class="main">:</span> <span class="quoted"><span class="quoted">"diag_mat <span class="free">f</span> <span class="keyword1">*v</span> <span class="free">s</span> <span class="main">=</span> <span class="main">(</span><span class="keyword1">œá</span> <span class="bound">i</span><span class="main">.</span> <span class="free">f</span> <span class="bound">i</span> <span class="main">*</span> <span class="free">s</span><span class="main">$</span><span class="bound">i</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">unfolding</span></span> diag_mat_def matrix_vector_mult_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>

<span class="keyword1"><span class="command">lemma</span></span> matrix_vector_mul_diag_axis<span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"diag_mat <span class="free">f</span> <span class="keyword1">*v</span> <span class="main">(</span>axis <span class="free">i</span> <span class="free">k</span><span class="main">)</span> <span class="main">=</span> axis <span class="free">i</span> <span class="main">(</span><span class="free">f</span> <span class="free">i</span> <span class="main">*</span> <span class="free">k</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> matrix_vector_mul_diag_mat axis_def fun_eq_iff<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> matrix_mul_diag_matl<span class="main">:</span> <span class="quoted"><span class="quoted">"diag_mat <span class="free">f</span> <span class="main">**</span> <span class="free">A</span> <span class="main">=</span> <span class="main">(</span><span class="keyword1">œá</span> <span class="bound">i</span> <span class="bound">j</span><span class="main">.</span> <span class="free">f</span> <span class="bound">i</span> <span class="main">*</span> <span class="free">A</span><span class="main">$</span><span class="bound">i</span><span class="main">$</span><span class="bound">j</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">unfolding</span></span> diag_mat_def matrix_matrix_mult_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>

<span class="keyword1"><span class="command">lemma</span></span> matrix_matrix_mul_diag_matr<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">A</span> <span class="main">**</span> diag_mat <span class="free">f</span> <span class="main">=</span> <span class="main">(</span><span class="keyword1">œá</span> <span class="bound">i</span> <span class="bound">j</span><span class="main">.</span> <span class="free">A</span><span class="main">$</span><span class="bound">i</span><span class="main">$</span><span class="bound">j</span> <span class="main">*</span> <span class="free">f</span> <span class="bound">j</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">unfolding</span></span> diag_mat_def matrix_matrix_mult_def <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="main">(</span><span class="operator">clarsimp</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> fun_eq_iff<span class="main">)</span>
  <span class="keyword1"><span class="command"><span class="improper"><span class="command">subgoal</span></span></span></span> <span class="keyword2"><span class="keyword">for</span></span> i j 
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> finite_sum_univ_singleton<span class="main"><span class="main">[</span></span><span class="operator">of</span> <span class="main"><span class="main">_</span></span> <span class="quoted"><span class="skolem">j</span></span><span class="main"><span class="main">]</span></span><span class="main">)</span>
  <span class="keyword1"><span class="command"><span class="improper"><span class="command">done</span></span></span></span>

<span class="keyword1"><span class="command">lemma</span></span> matrix_mul_diag_diag<span class="main">:</span> <span class="quoted"><span class="quoted">"diag_mat <span class="free">f</span> <span class="main">**</span> diag_mat <span class="free">g</span> <span class="main">=</span> diag_mat <span class="main">(</span><span class="main">Œª</span><span class="bound">i</span><span class="main">.</span> <span class="free">f</span> <span class="bound">i</span> <span class="main">*</span> <span class="free">g</span> <span class="bound">i</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">unfolding</span></span> diag_mat_def matrix_matrix_mult_def vec_eq_iff <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>

<span class="keyword1"><span class="command">lemma</span></span> compow_matrix_mul_diag_mat_eq<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">(**)</span> <span class="main">(</span>diag_mat <span class="free">f</span><span class="main">)</span> <span class="main">^^</span> <span class="free">n</span><span class="main">)</span> <span class="main">(</span>mat <span class="main">1</span><span class="main">)</span> <span class="main">=</span> diag_mat <span class="main">(</span><span class="main">Œª</span><span class="bound">i</span><span class="main">.</span> <span class="free">f</span> <span class="bound">i</span><span class="main">^</span><span class="free">n</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="main">(</span><span class="operator">induct</span> <span class="quoted"><span class="free">n</span></span><span class="main"><span class="keyword3">,</span></span> <span class="operator">simp_all</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> matrix_mul_diag_matl<span class="main">)</span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> vec_eq_iff diag_mat_def<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> compow_similar_diag_mat_eq<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"invertible <span class="free">P</span>"</span></span> 
      <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">A</span> <span class="main">=</span> <span class="free">P</span><span class="main"><span class="hidden">‚áß</span><sup>-</sup><span class="hidden">‚áß</span><sup>1</sup></span> <span class="main">**</span> <span class="main">(</span>diag_mat <span class="free">f</span><span class="main">)</span> <span class="main">**</span> <span class="free">P</span>"</span></span>
    <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">(**)</span> <span class="free">A</span> <span class="main">^^</span> <span class="free">n</span><span class="main">)</span> <span class="main">(</span>mat <span class="main">1</span><span class="main">)</span> <span class="main">=</span> <span class="free">P</span><span class="main"><span class="hidden">‚áß</span><sup>-</sup><span class="hidden">‚áß</span><sup>1</sup></span> <span class="main">**</span> <span class="main">(</span>diag_mat <span class="main">(</span><span class="main">Œª</span><span class="bound">i</span><span class="main">.</span> <span class="free">f</span> <span class="bound">i</span><span class="main">^</span><span class="free">n</span><span class="main">)</span><span class="main">)</span> <span class="main">**</span> <span class="free">P</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span><span class="main">(</span><span class="operator">induct</span> <span class="quoted"><span class="free">n</span></span><span class="main"><span class="keyword3">,</span></span> <span class="operator">simp_all</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> assms<span class="main">)</span>
  <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">n</span><span class="main">::</span><span class="quoted">nat</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">P</span><span class="main"><span class="hidden">‚áß</span><sup>-</sup><span class="hidden">‚áß</span><sup>1</sup></span> <span class="main">**</span> diag_mat <span class="free">f</span> <span class="main">**</span> <span class="free">P</span> <span class="main">**</span> <span class="main">(</span><span class="free">P</span><span class="main"><span class="hidden">‚áß</span><sup>-</sup><span class="hidden">‚áß</span><sup>1</sup></span> <span class="main">**</span> diag_mat <span class="main">(</span><span class="main">Œª</span><span class="bound">i</span><span class="main">.</span> <span class="free">f</span> <span class="bound">i</span> <span class="main">^</span> <span class="skolem">n</span><span class="main">)</span> <span class="main">**</span> <span class="free">P</span><span class="main">)</span> <span class="main">=</span> 
  <span class="free">P</span><span class="main"><span class="hidden">‚áß</span><sup>-</sup><span class="hidden">‚áß</span><sup>1</sup></span> <span class="main">**</span> diag_mat <span class="free">f</span> <span class="main">**</span> diag_mat <span class="main">(</span><span class="main">Œª</span><span class="bound">i</span><span class="main">.</span> <span class="free">f</span> <span class="bound">i</span> <span class="main">^</span> <span class="skolem">n</span><span class="main">)</span> <span class="main">**</span> <span class="free">P</span>"</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">is</span></span> <span class="quoted"><span class="quoted">"<span class="var">?lhs</span> <span class="main">=</span> <span class="main">_</span>"</span></span><span class="main">)</span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> <span class="main"><span class="main">(</span></span>no_types<span class="main"><span class="main">,</span></span> lifting<span class="main"><span class="main">)</span></span> assms<span class="main"><span class="main">(</span></span>1<span class="main"><span class="main">)</span></span> invertibleD<span class="main"><span class="main">(</span></span>2<span class="main"><span class="main">)</span></span> matrix_mul_rid matrix_mul_assoc<span class="main">)</span> 
  <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> <span class="free">P</span><span class="main"><span class="hidden">‚áß</span><sup>-</sup><span class="hidden">‚áß</span><sup>1</sup></span> <span class="main">**</span> diag_mat <span class="main">(</span><span class="main">Œª</span><span class="bound">i</span><span class="main">.</span> <span class="free">f</span> <span class="bound">i</span> <span class="main">*</span> <span class="free">f</span> <span class="bound">i</span> <span class="main">^</span> <span class="skolem">n</span><span class="main">)</span> <span class="main">**</span> <span class="free">P</span>"</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">is</span></span> <span class="quoted"><span class="quoted">"<span class="main">_</span> <span class="main">=</span> <span class="var">?rhs</span>"</span></span><span class="main">)</span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> <span class="main"><span class="main">(</span></span>full_types<span class="main"><span class="main">)</span></span> matrix_mul_assoc matrix_mul_diag_diag<span class="main">)</span>
  <span class="keyword1"><span class="command">finally</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="var">?lhs</span> <span class="main">=</span> <span class="var">?rhs</span>"</span></span> <span class="keyword1"><span class="command">.</span></span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">lemma</span></span> compow_similar_diag_mat<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">A</span> <span class="main">‚àº</span> <span class="main">(</span>diag_mat <span class="free">f</span><span class="main">)</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">(**)</span> <span class="free">A</span> <span class="main">^^</span> <span class="free">n</span><span class="main">)</span> <span class="main">(</span>mat <span class="main">1</span><span class="main">)</span> <span class="main">‚àº</span> diag_mat <span class="main">(</span><span class="main">Œª</span><span class="bound">i</span><span class="main">.</span> <span class="free">f</span> <span class="bound">i</span><span class="main">^</span><span class="free">n</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span><span class="main">(</span><span class="operator">unfold</span> similar_matrix_def<span class="main">)</span>
  <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">P</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"invertible <span class="skolem">P</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">A</span> <span class="main">=</span> <span class="skolem">P</span><span class="main"><span class="hidden">‚áß</span><sup>-</sup><span class="hidden">‚áß</span><sup>1</sup></span> <span class="main">**</span> <span class="main">(</span>diag_mat <span class="free">f</span><span class="main">)</span> <span class="main">**</span> <span class="skolem">P</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">unfolding</span></span> similar_matrix_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"<span class="main">‚àÉ</span><span class="bound">P</span><span class="main">.</span> invertible <span class="bound">P</span> <span class="main">‚àß</span> <span class="main">(</span><span class="main">(**)</span> <span class="free">A</span> <span class="main">^^</span> <span class="free">n</span><span class="main">)</span> <span class="main">(</span>mat <span class="main">1</span><span class="main">)</span> <span class="main">=</span> <span class="bound">P</span><span class="main"><span class="hidden">‚áß</span><sup>-</sup><span class="hidden">‚áß</span><sup>1</sup></span> <span class="main">**</span> diag_mat <span class="main">(</span><span class="main">Œª</span><span class="bound">i</span><span class="main">.</span> <span class="free">f</span> <span class="bound">i</span> <span class="main">^</span> <span class="free">n</span><span class="main">)</span> <span class="main">**</span> <span class="bound">P</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> compow_similar_diag_mat_eq <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">no_notation</span></span> matrix_inv <span class="main">(</span><span class="quoted">"_<span class="keyword1"><span class="hidden">‚áß</span><sup>-</sup><span class="hidden">‚áß</span><sup>1</sup></span>"</span> <span class="main">[</span>90<span class="main">]</span><span class="main">)</span>
        <span class="keyword2"><span class="keyword">and</span></span> similar_matrix <span class="main">(</span><span class="keyword2"><span class="keyword">infixr</span></span> <span class="quoted">"<span class="keyword1">‚àº</span>"</span> 25<span class="main">)</span>


<span class="keyword2"><span class="keyword">end</span></span></pre>
</div><div id="MTX_Norms">
<div class="head">
<h1>Theory MTX_Norms</h1>
</div>
<pre class="source"><span class="comment1">(*  Title:       Matrix norms
    Author:      Jonathan Juli√°n Huerta y Munive, 2020
    Maintainer:  Jonathan Juli√°n Huerta y Munive &lt;jonjulian23@gmail.com&gt;
*)</span>

<span class="keyword1"><span class="command">section</span></span> <span class="quoted"><span class="plain_text">‚Äπ Matrix norms ‚Ä∫</span></span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‚Äπ Here, we explore some properties about the operator and the maximum norms for matrices. ‚Ä∫</span></span>

<span class="keyword1"><span class="command">theory</span></span> MTX_Norms
  <span class="keyword2"><span class="keyword">imports</span></span> <a href="MTX_Preliminaries.html">MTX_Preliminaries</a>

<span class="keyword2"><span class="keyword">begin</span></span>


<span class="keyword1"><span class="command">subsection</span></span><span class="quoted"><span class="plain_text">‚Äπ Matrix operator norm ‚Ä∫</span></span>

<span class="keyword1"><span class="command">abbreviation</span></span> <span class="entity">op_norm</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="tfree">'a</span><span class="main">::</span>real_normed_algebra_1<span class="main">)</span><span class="main">^</span><span class="tfree">'n</span><span class="main">^</span><span class="tfree">'m</span> <span class="main">‚áí</span> real"</span></span> <span class="main">(</span><span class="quoted">"<span class="keyword3">(1</span><span class="keyword1">‚à•</span>_<span class="keyword1">‚à•<span class="hidden">‚á©</span><sub>o</sub><span class="hidden">‚á©</span><sub>p</sub></span><span class="keyword3">)</span>"</span> <span class="main">[</span>65<span class="main">]</span> 61<span class="main">)</span>
  <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="main"><span class="free">‚à•</span></span><span class="free"><span class="bound"><span class="entity">A</span></span></span><span class="keyword1"><span class="free">‚à•<span class="hidden">‚á©</span><sub>o</sub><span class="hidden">‚á©</span><sub>p</sub></span></span> <span class="main">‚â°</span> onorm <span class="main">(</span><span class="main">Œª</span><span class="bound">x</span><span class="main">.</span> <span class="free"><span class="bound"><span class="entity">A</span></span></span> <span class="keyword1">*v</span> <span class="bound">x</span><span class="main">)</span>"</span></span>

<span class="keyword1"><span class="command">lemma</span></span> norm_matrix_bound<span class="main">:</span>
  <span class="keyword2"><span class="keyword">fixes</span></span> <span class="free">A</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="tfree">'a</span><span class="main">::</span>real_normed_algebra_1<span class="main">)</span><span class="main">^</span><span class="tfree">'n</span><span class="main">^</span><span class="tfree">'m</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">‚à•</span><span class="free">x</span><span class="main">‚à•</span> <span class="main">=</span> <span class="main">1</span> <span class="main">‚üπ</span> <span class="main">‚à•</span><span class="free">A</span> <span class="keyword1">*v</span> <span class="free">x</span><span class="main">‚à•</span> <span class="main">‚â§</span> <span class="main">‚à•</span><span class="main">(</span><span class="keyword1">œá</span> <span class="bound">i</span> <span class="bound">j</span><span class="main">.</span> <span class="main">‚à•</span><span class="free">A</span> <span class="main">$</span> <span class="bound">i</span> <span class="main">$</span> <span class="bound">j</span><span class="main">‚à•</span><span class="main">)</span> <span class="keyword1">*v</span> <span class="main">1</span><span class="main">‚à•</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
  <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">x</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="tfree">'a</span><span class="main">,</span> <span class="tfree">'n</span><span class="main">)</span> vec"</span></span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">‚à•</span><span class="skolem">x</span><span class="main">‚à•</span> <span class="main">=</span> <span class="main">1</span>"</span></span>
  <span class="keyword1"><span class="command">hence</span></span> xi_le1<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="main">‚ãÄ</span><span class="bound">i</span><span class="main">.</span> <span class="main">‚à•</span><span class="skolem">x</span> <span class="main">$</span> <span class="bound">i</span><span class="main">‚à•</span> <span class="main">‚â§</span> <span class="main">1</span>"</span></span> 
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> Finite_Cartesian_Product.norm_nth_le<span class="main">)</span> 
  <span class="keyword1"><span class="command">{</span></span><span class="keyword3"><span class="command">fix</span></span> <span class="skolem">j</span><span class="main">::</span><span class="tfree"><span class="quoted"><span class="tfree">'m</span></span></span> 
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">‚à•</span><span class="main">(</span><span class="main">‚àë</span><span class="bound">i</span><span class="main">‚àà</span>UNIV<span class="main">.</span> <span class="free">A</span> <span class="main">$</span> <span class="skolem">j</span> <span class="main">$</span> <span class="bound">i</span> <span class="main">*</span> <span class="skolem">x</span> <span class="main">$</span> <span class="bound">i</span><span class="main">)</span><span class="main">‚à•</span> <span class="main">‚â§</span> <span class="main">(</span><span class="main">‚àë</span><span class="bound">i</span><span class="main">‚àà</span>UNIV<span class="main">.</span> <span class="main">‚à•</span><span class="free">A</span> <span class="main">$</span> <span class="skolem">j</span> <span class="main">$</span> <span class="bound">i</span> <span class="main">*</span> <span class="skolem">x</span> <span class="main">$</span> <span class="bound">i</span><span class="main">‚à•</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> norm_sum <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
    <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">‚â§</span> <span class="main">(</span><span class="main">‚àë</span><span class="bound">i</span><span class="main">‚àà</span>UNIV<span class="main">.</span> <span class="main">(</span><span class="main">‚à•</span><span class="free">A</span> <span class="main">$</span> <span class="skolem">j</span> <span class="main">$</span> <span class="bound">i</span><span class="main">‚à•</span><span class="main">)</span> <span class="main">*</span> <span class="main">(</span><span class="main">‚à•</span><span class="skolem">x</span> <span class="main">$</span> <span class="bound">i</span><span class="main">‚à•</span><span class="main">)</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> norm_mult_ineq sum_mono<span class="main">)</span>
    <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">‚â§</span> <span class="main">(</span><span class="main">‚àë</span><span class="bound">i</span><span class="main">‚àà</span>UNIV<span class="main">.</span> <span class="main">(</span><span class="main">‚à•</span><span class="free">A</span> <span class="main">$</span> <span class="skolem">j</span> <span class="main">$</span> <span class="bound">i</span><span class="main">‚à•</span><span class="main">)</span> <span class="main">*</span> <span class="main">1</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> xi_le1 <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> sum_mono mult_left_le<span class="main">)</span>
    <span class="keyword1"><span class="command">finally</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">‚à•</span><span class="main">(</span><span class="main">‚àë</span><span class="bound">i</span><span class="main">‚àà</span>UNIV<span class="main">.</span> <span class="free">A</span> <span class="main">$</span> <span class="skolem">j</span> <span class="main">$</span> <span class="bound">i</span> <span class="main">*</span> <span class="skolem">x</span> <span class="main">$</span> <span class="bound">i</span><span class="main">)</span><span class="main">‚à•</span> <span class="main">‚â§</span> <span class="main">(</span><span class="main">‚àë</span><span class="bound">i</span><span class="main">‚àà</span>UNIV<span class="main">.</span> <span class="main">(</span><span class="main">‚à•</span><span class="free">A</span> <span class="main">$</span> <span class="skolem">j</span> <span class="main">$</span> <span class="bound">i</span><span class="main">‚à•</span><span class="main">)</span> <span class="main">*</span> <span class="main">1</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span><span class="keyword1"><span class="command">}</span></span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="main">‚ãÄ</span><span class="bound">j</span><span class="main">.</span> <span class="main">‚à•</span><span class="main">(</span><span class="free">A</span> <span class="keyword1">*v</span> <span class="skolem">x</span><span class="main">)</span> <span class="main">$</span> <span class="bound">j</span><span class="main">‚à•</span> <span class="main">‚â§</span> <span class="main">(</span><span class="main">(</span><span class="keyword1">œá</span> <span class="bound">i1</span> <span class="bound">i2</span><span class="main">.</span> <span class="main">‚à•</span><span class="free">A</span> <span class="main">$</span> <span class="bound">i1</span> <span class="main">$</span> <span class="bound">i2</span><span class="main">‚à•</span><span class="main">)</span> <span class="keyword1">*v</span> <span class="main">1</span><span class="main">)</span> <span class="main">$</span> <span class="bound">j</span>"</span></span>
    <span class="keyword1"><span class="command">unfolding</span></span> matrix_vector_mult_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">‚àë</span><span class="bound">j</span><span class="main">‚àà</span>UNIV<span class="main">.</span> <span class="main">(</span><span class="main">‚à•</span><span class="main">(</span><span class="free">A</span> <span class="keyword1">*v</span> <span class="skolem">x</span><span class="main">)</span> <span class="main">$</span> <span class="bound">j</span><span class="main">‚à•</span><span class="main">)</span><span class="main"><span class="hidden">‚áß</span><sup>2</sup></span><span class="main">)</span> <span class="main">‚â§</span> <span class="main">(</span><span class="main">‚àë</span><span class="bound">j</span><span class="main">‚àà</span>UNIV<span class="main">.</span> <span class="main">(</span><span class="main">‚à•</span><span class="main">(</span><span class="main">(</span><span class="keyword1">œá</span> <span class="bound">i1</span> <span class="bound">i2</span><span class="main">.</span> <span class="main">‚à•</span><span class="free">A</span> <span class="main">$</span> <span class="bound">i1</span> <span class="main">$</span> <span class="bound">i2</span><span class="main">‚à•</span><span class="main">)</span> <span class="keyword1">*v</span> <span class="main">1</span><span class="main">)</span> <span class="main">$</span> <span class="bound">j</span><span class="main">‚à•</span><span class="main">)</span><span class="main"><span class="hidden">‚áß</span><sup>2</sup></span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> <span class="main"><span class="main">(</span></span>mono_tags<span class="main"><span class="main">,</span></span> lifting<span class="main"><span class="main">)</span></span> norm_ge_zero power2_abs power_mono real_norm_def sum_mono<span class="main">)</span> 
  <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"<span class="main">‚à•</span><span class="free">A</span> <span class="keyword1">*v</span> <span class="skolem">x</span><span class="main">‚à•</span> <span class="main">‚â§</span> <span class="main">‚à•</span><span class="main">(</span><span class="keyword1">œá</span> <span class="bound">i</span> <span class="bound">j</span><span class="main">.</span> <span class="main">‚à•</span><span class="free">A</span> <span class="main">$</span> <span class="bound">i</span> <span class="main">$</span> <span class="bound">j</span><span class="main">‚à•</span><span class="main">)</span> <span class="keyword1">*v</span> <span class="main">1</span><span class="main">‚à•</span>"</span></span>
    <span class="keyword1"><span class="command">unfolding</span></span> norm_vec_def L2_set_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">lemma</span></span> onorm_set_proptys<span class="main">:</span>
  <span class="keyword2"><span class="keyword">fixes</span></span> <span class="free">A</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="tfree">'a</span><span class="main">::</span>real_normed_algebra_1<span class="main">)</span><span class="main">^</span><span class="tfree">'n</span><span class="main">^</span><span class="tfree">'m</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"bounded <span class="main">(</span>range <span class="main">(</span><span class="main">Œª</span><span class="bound">x</span><span class="main">.</span> <span class="main">(</span><span class="main">‚à•</span><span class="free">A</span> <span class="keyword1">*v</span> <span class="bound">x</span><span class="main">‚à•</span><span class="main">)</span> <span class="main">/</span> <span class="main">(</span><span class="main">‚à•</span><span class="bound">x</span><span class="main">‚à•</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"bdd_above <span class="main">(</span>range <span class="main">(</span><span class="main">Œª</span><span class="bound">x</span><span class="main">.</span> <span class="main">(</span><span class="main">‚à•</span><span class="free">A</span> <span class="keyword1">*v</span> <span class="bound">x</span><span class="main">‚à•</span><span class="main">)</span> <span class="main">/</span> <span class="main">(</span><span class="main">‚à•</span><span class="bound">x</span><span class="main">‚à•</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span>range <span class="main">(</span><span class="main">Œª</span><span class="bound">x</span><span class="main">.</span> <span class="main">(</span><span class="main">‚à•</span><span class="free">A</span> <span class="keyword1">*v</span> <span class="bound">x</span><span class="main">‚à•</span><span class="main">)</span> <span class="main">/</span> <span class="main">(</span><span class="main">‚à•</span><span class="bound">x</span><span class="main">‚à•</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">‚â†</span> <span class="main">{}</span>"</span></span>
  <span class="keyword1"><span class="command">unfolding</span></span> bounded_def bdd_above_def image_def dist_real_def 
    <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="main">(</span><span class="operator">rule_tac</span> x<span class="main"><span class="main">=</span></span><span class="quoted"><span class="main">0</span></span> <span class="keyword2"><span class="keyword"><span class="quasi_keyword">in</span></span></span> exI<span class="main">)</span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule_tac</span> x<span class="main"><span class="main">=</span></span><span class="quoted"><span class="quoted"><span class="quoted"><span class="quoted">"<span class="main"><span class="main"><span class="main">‚à•</span></span></span><span class="main"><span class="main"><span class="main">(</span></span></span><span class="keyword1"><span class="keyword1"><span class="keyword1">œá</span></span></span> <span class="bound"><span class="bound"><span class="bound">i</span></span></span> <span class="bound"><span class="bound"><span class="bound">j</span></span></span><span class="main"><span class="main"><span class="main">.</span></span></span> <span class="main"><span class="main"><span class="main">‚à•</span></span></span><span class="free"><span class="free"><span class="free">A</span></span></span> <span class="main"><span class="main"><span class="main">$</span></span></span> <span class="bound"><span class="bound"><span class="bound">i</span></span></span> <span class="main"><span class="main"><span class="main">$</span></span></span> <span class="bound"><span class="bound"><span class="bound">j</span></span></span><span class="main"><span class="main"><span class="main">‚à•</span></span></span><span class="main"><span class="main"><span class="main">)</span></span></span> <span class="keyword1"><span class="keyword1"><span class="keyword1">*v</span></span></span> <span class="main"><span class="main"><span class="main">1</span></span></span><span class="main"><span class="main"><span class="main">‚à•</span></span></span>"</span></span></span></span> <span class="keyword2"><span class="keyword"><span class="quasi_keyword">in</span></span></span> exI<span class="main"><span class="keyword3">,</span></span> <span class="operator">clarsimp</span><span class="main"><span class="keyword3">,</span></span>
      <span class="operator">subst</span> mult_norm_matrix_sgn_eq<span class="main"><span class="main">[</span></span><span class="operator">symmetric</span><span class="main"><span class="main">]</span></span><span class="main"><span class="keyword3">,</span></span> <span class="operator">clarsimp</span><span class="main"><span class="keyword3">,</span></span>
      <span class="operator">rule_tac</span> x<span class="main"><span class="main">=</span></span><span class="quoted"><span class="quoted"><span class="quoted">"sgn <span class="main"><span class="main">_</span></span>"</span></span></span> <span class="keyword2"><span class="keyword"><span class="quasi_keyword">in</span></span></span> norm_matrix_bound<span class="main"><span class="keyword3">,</span></span> <span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> norm_sgn<span class="main">)</span><span class="main"><span class="keyword3">+</span></span> <span class="operator">force</span>

<span class="keyword1"><span class="command">lemma</span></span> op_norm_set_proptys<span class="main">:</span>
  <span class="keyword2"><span class="keyword">fixes</span></span> <span class="free">A</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="tfree">'a</span><span class="main">::</span>real_normed_algebra_1<span class="main">)</span><span class="main">^</span><span class="tfree">'n</span><span class="main">^</span><span class="tfree">'m</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"bounded <span class="main">{</span><span class="main">‚à•</span><span class="free">A</span> <span class="keyword1">*v</span> <span class="bound">x</span><span class="main">‚à•</span> <span class="main">|</span> <span class="bound">x</span><span class="main">.</span> <span class="main">‚à•</span><span class="bound">x</span><span class="main">‚à•</span> <span class="main">=</span> <span class="main">1</span><span class="main">}</span>"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"bdd_above <span class="main">{</span><span class="main">‚à•</span><span class="free">A</span> <span class="keyword1">*v</span> <span class="bound">x</span><span class="main">‚à•</span> <span class="main">|</span> <span class="bound">x</span><span class="main">.</span> <span class="main">‚à•</span><span class="bound">x</span><span class="main">‚à•</span> <span class="main">=</span> <span class="main">1</span><span class="main">}</span>"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">{</span><span class="main">‚à•</span><span class="free">A</span> <span class="keyword1">*v</span> <span class="bound">x</span><span class="main">‚à•</span> <span class="main">|</span> <span class="bound">x</span><span class="main">.</span> <span class="main">‚à•</span><span class="bound">x</span><span class="main">‚à•</span> <span class="main">=</span> <span class="main">1</span><span class="main">}</span> <span class="main">‚â†</span> <span class="main">{}</span>"</span></span>
  <span class="keyword1"><span class="command">unfolding</span></span> bounded_def bdd_above_def <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="operator">safe</span>
    <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="main">(</span><span class="operator">rule_tac</span> x<span class="main"><span class="main">=</span></span><span class="quoted"><span class="main">0</span></span> <span class="keyword2"><span class="keyword"><span class="quasi_keyword">in</span></span></span> exI<span class="main"><span class="keyword3">,</span></span> <span class="operator">rule_tac</span> x<span class="main"><span class="main">=</span></span><span class="quoted"><span class="quoted">"<span class="main">‚à•</span><span class="main">(</span><span class="keyword1">œá</span> <span class="bound">i</span> <span class="bound">j</span><span class="main">.</span> <span class="main">‚à•</span><span class="free">A</span> <span class="main">$</span> <span class="bound">i</span> <span class="main">$</span> <span class="bound">j</span><span class="main">‚à•</span><span class="main">)</span> <span class="keyword1">*v</span> <span class="main">1</span><span class="main">‚à•</span>"</span></span> <span class="keyword2"><span class="keyword"><span class="quasi_keyword">in</span></span></span> exI<span class="main">)</span>
    <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="main">(</span><span class="operator">force</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> norm_matrix_bound dist_real_def<span class="main">)</span>
   <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="main">(</span><span class="operator">rule_tac</span> x<span class="main"><span class="main">=</span></span><span class="quoted"><span class="quoted">"<span class="main">‚à•</span><span class="main">(</span><span class="keyword1">œá</span> <span class="bound">i</span> <span class="bound">j</span><span class="main">.</span> <span class="main">‚à•</span><span class="free">A</span> <span class="main">$</span> <span class="bound">i</span> <span class="main">$</span> <span class="bound">j</span><span class="main">‚à•</span><span class="main">)</span> <span class="keyword1">*v</span> <span class="main">1</span><span class="main">‚à•</span>"</span></span> <span class="keyword2"><span class="keyword"><span class="quasi_keyword">in</span></span></span> exI<span class="main"><span class="keyword3">,</span></span> <span class="operator">force</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> norm_matrix_bound<span class="main">)</span>
  <span class="keyword1"><span class="command">using</span></span> ex_norm_eq_1 <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>

<span class="keyword1"><span class="command">lemma</span></span> op_norm_def<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">‚à•</span><span class="free">A</span><span class="keyword1">‚à•<span class="hidden">‚á©</span><sub>o</sub><span class="hidden">‚á©</span><sub>p</sub></span> <span class="main">=</span> Sup <span class="main">{</span><span class="main">‚à•</span><span class="free">A</span> <span class="keyword1">*v</span> <span class="bound">x</span><span class="main">‚à•</span> <span class="main">|</span> <span class="bound">x</span><span class="main">.</span> <span class="main">‚à•</span><span class="bound">x</span><span class="main">‚à•</span> <span class="main">=</span> <span class="main">1</span><span class="main">}</span>"</span></span>
  <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="main">(</span><span class="operator">rule</span> antisym<span class="main"><span class="main">[</span></span><span class="operator">OF</span> onorm_le cSup_least<span class="main"><span class="main">[</span></span><span class="operator">OF</span> op_norm_set_proptys<span class="main"><span class="main">(</span></span>3<span class="main"><span class="main">)</span></span><span class="main"><span class="main">]</span></span><span class="main"><span class="main">]</span></span><span class="main">)</span>
   <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="main">(</span><span class="operator">case_tac</span> <span class="quoted"><span class="quoted">"<span class="improper">x</span> <span class="main">=</span> <span class="main">0</span>"</span></span><span class="main"><span class="keyword3">,</span></span> <span class="operator">simp</span><span class="main">)</span>
   <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="main">(</span><span class="operator">subst</span> mult_norm_matrix_sgn_eq<span class="main"><span class="main">[</span></span><span class="operator">symmetric</span><span class="main"><span class="main">]</span></span><span class="main"><span class="keyword3">,</span></span> <span class="operator">simp</span><span class="main">)</span>
   <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="main">(</span><span class="operator">rule</span> cSup_upper<span class="main"><span class="main">[</span></span><span class="operator">OF</span> _ op_norm_set_proptys<span class="main"><span class="main">(</span></span>2<span class="main"><span class="main">)</span></span><span class="main"><span class="main">]</span></span><span class="main">)</span>
   <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="main">(</span><span class="operator">force</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> norm_sgn<span class="main">)</span>
  <span class="keyword1"><span class="command">unfolding</span></span> onorm_def 
  <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="main">(</span><span class="operator">rule</span> cSup_upper<span class="main"><span class="main">[</span></span><span class="operator">OF</span> _ onorm_set_proptys<span class="main"><span class="main">(</span></span>2<span class="main"><span class="main">)</span></span><span class="main"><span class="main">]</span></span><span class="main">)</span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> image_def<span class="main"><span class="keyword3">,</span></span> <span class="operator">clarsimp</span><span class="main">)</span> <span class="main">(</span><span class="operator">metis</span> div_by_1<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> norm_matrix_le_op_norm<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">‚à•</span><span class="free">x</span><span class="main">‚à•</span> <span class="main">=</span> <span class="main">1</span> <span class="main">‚üπ</span> <span class="main">‚à•</span><span class="free">A</span> <span class="keyword1">*v</span> <span class="free">x</span><span class="main">‚à•</span> <span class="main">‚â§</span> <span class="main">‚à•</span><span class="free">A</span><span class="keyword1">‚à•<span class="hidden">‚á©</span><sub>o</sub><span class="hidden">‚á©</span><sub>p</sub></span>"</span></span>
  <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="main">(</span><span class="operator">unfold</span> onorm_def<span class="main"><span class="keyword3">,</span></span> <span class="operator">rule</span> cSup_upper<span class="main"><span class="main">[</span></span><span class="operator">OF</span> _ onorm_set_proptys<span class="main"><span class="main">(</span></span>2<span class="main"><span class="main">)</span></span><span class="main"><span class="main">]</span></span><span class="main">)</span>
  <span class="keyword1"><span class="command">unfolding</span></span> image_def <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">clarsimp</span><span class="main"><span class="keyword3">,</span></span> <span class="operator">rule_tac</span> x<span class="main"><span class="main">=</span></span><span class="quoted"><span class="free">x</span></span> <span class="keyword2"><span class="keyword"><span class="quasi_keyword">in</span></span></span> exI<span class="main">)</span> <span class="operator">simp</span>

<span class="keyword1"><span class="command">lemma</span></span> op_norm_ge_0<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">0</span> <span class="main">‚â§</span> <span class="main">‚à•</span><span class="free">A</span><span class="keyword1">‚à•<span class="hidden">‚á©</span><sub>o</sub><span class="hidden">‚á©</span><sub>p</sub></span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> ex_norm_eq_1 norm_ge_zero norm_matrix_le_op_norm basic_trans_rules<span class="main">(</span>23<span class="main">)</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>

<span class="keyword1"><span class="command">lemma</span></span> norm_sgn_le_op_norm<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">‚à•</span><span class="free">A</span> <span class="keyword1">*v</span> sgn <span class="free">x</span><span class="main">‚à•</span> <span class="main">‚â§</span> <span class="main">‚à•</span><span class="free">A</span><span class="keyword1">‚à•<span class="hidden">‚á©</span><sub>o</sub><span class="hidden">‚á©</span><sub>p</sub></span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">cases</span> <span class="quoted"><span class="quoted">"<span class="free">x</span><span class="main">=</span><span class="main">0</span>"</span></span><span class="main"><span class="keyword3">,</span></span> <span class="operator">simp_all</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> norm_sgn norm_matrix_le_op_norm op_norm_ge_0<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> norm_matrix_le_mult_op_norm<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">‚à•</span><span class="free">A</span> <span class="keyword1">*v</span> <span class="free">x</span><span class="main">‚à•</span> <span class="main">‚â§</span> <span class="main">(</span><span class="main">‚à•</span><span class="free">A</span><span class="keyword1">‚à•<span class="hidden">‚á©</span><sub>o</sub><span class="hidden">‚á©</span><sub>p</sub></span><span class="main">)</span> <span class="main">*</span> <span class="main">(</span><span class="main">‚à•</span><span class="free">x</span><span class="main">‚à•</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">‚à•</span><span class="free">A</span> <span class="keyword1">*v</span> <span class="free">x</span><span class="main">‚à•</span> <span class="main">=</span> <span class="main">(</span><span class="main">‚à•</span><span class="free">A</span> <span class="keyword1">*v</span> sgn <span class="free">x</span><span class="main">‚à•</span><span class="main">)</span> <span class="main">*</span> <span class="main">(</span><span class="main">‚à•</span><span class="free">x</span><span class="main">‚à•</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> mult_norm_matrix_sgn_eq<span class="main">)</span>
  <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">‚â§</span> <span class="main">(</span><span class="main">‚à•</span><span class="free">A</span><span class="keyword1">‚à•<span class="hidden">‚á©</span><sub>o</sub><span class="hidden">‚á©</span><sub>p</sub></span><span class="main">)</span> <span class="main">*</span> <span class="main">(</span><span class="main">‚à•</span><span class="free">x</span><span class="main">‚à•</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> norm_sgn_le_op_norm<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="free">A</span></span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> mult_mono'<span class="main">)</span>
  <span class="keyword1"><span class="command">finally</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">lemma</span></span> blin_matrix_vector_mult<span class="main">:</span> <span class="quoted"><span class="quoted">"bounded_linear <span class="main">(</span><span class="keyword1">(*v)</span> <span class="free">A</span><span class="main">)</span>"</span></span> <span class="keyword2"><span class="keyword">for</span></span> <span class="free">A</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="tfree">'a</span><span class="main">::</span>real_normed_algebra_1<span class="main">)</span><span class="main">^</span><span class="tfree">'n</span><span class="main">^</span><span class="tfree">'m</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">unfold_locales</span><span class="main">)</span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">intro</span><span class="main"><span class="main">:</span></span> norm_matrix_le_mult_op_norm <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> 
      mult.commute matrix_vector_right_distrib vector_scaleR_commute<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> op_norm_eq_0<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">‚à•</span><span class="free">A</span><span class="keyword1">‚à•<span class="hidden">‚á©</span><sub>o</sub><span class="hidden">‚á©</span><sub>p</sub></span> <span class="main">=</span> <span class="main">0</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="free">A</span> <span class="main">=</span> <span class="main">0</span><span class="main">)</span>"</span></span> <span class="keyword2"><span class="keyword">for</span></span> <span class="free">A</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="tfree">'a</span><span class="main">::</span>real_normed_field<span class="main">)</span><span class="main">^</span><span class="tfree">'n</span><span class="main">^</span><span class="tfree">'m</span>"</span></span>
  <span class="keyword1"><span class="command">unfolding</span></span> onorm_eq_0<span class="main">[</span><span class="operator">OF</span> blin_matrix_vector_mult<span class="main">]</span> <span class="keyword1"><span class="command">using</span></span> matrix_axis_0<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="main">1</span></span> <span class="quoted"><span class="free">A</span></span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">fastforce</span>

<span class="keyword1"><span class="command">lemma</span></span> op_norm0<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">‚à•</span><span class="main">(</span><span class="main">0</span><span class="main">::</span><span class="main">(</span><span class="tfree">'a</span><span class="main">::</span>real_normed_field<span class="main">)</span><span class="main">^</span><span class="tfree">'n</span><span class="main">^</span><span class="tfree">'m</span><span class="main">)</span><span class="keyword1">‚à•<span class="hidden">‚á©</span><sub>o</sub><span class="hidden">‚á©</span><sub>p</sub></span> <span class="main">=</span> <span class="main">0</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> op_norm_eq_0<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="main">0</span></span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
                  
<span class="keyword1"><span class="command">lemma</span></span> op_norm_triangle<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">‚à•</span><span class="free">A</span> <span class="main">+</span> <span class="free">B</span><span class="keyword1">‚à•<span class="hidden">‚á©</span><sub>o</sub><span class="hidden">‚á©</span><sub>p</sub></span> <span class="main">‚â§</span> <span class="main">(</span><span class="main">‚à•</span><span class="free">A</span><span class="keyword1">‚à•<span class="hidden">‚á©</span><sub>o</sub><span class="hidden">‚á©</span><sub>p</sub></span><span class="main">)</span> <span class="main">+</span> <span class="main">(</span><span class="main">‚à•</span><span class="free">B</span><span class="keyword1">‚à•<span class="hidden">‚á©</span><sub>o</sub><span class="hidden">‚á©</span><sub>p</sub></span><span class="main">)</span>"</span></span> 
  <span class="keyword1"><span class="command">using</span></span> onorm_triangle<span class="main">[</span><span class="operator">OF</span> blin_matrix_vector_mult<span class="main"><span class="main">[</span></span><span class="operator">of</span> <span class="quoted"><span class="free">A</span></span><span class="main"><span class="main">]</span></span> blin_matrix_vector_mult<span class="main"><span class="main">[</span></span><span class="operator">of</span> <span class="quoted"><span class="free">B</span></span><span class="main"><span class="main">]</span></span><span class="main">]</span>
    matrix_vector_mult_add_rdistrib<span class="main">[</span><span class="operator">symmetric</span><span class="main">,</span> <span class="operator">of</span> <span class="quoted"><span class="free">A</span></span> <span class="main">_</span> <span class="quoted"><span class="free">B</span></span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>

<span class="keyword1"><span class="command">lemma</span></span> op_norm_scaleR<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">‚à•</span><span class="free">c</span> <span class="keyword1">*<span class="hidden">‚á©</span><sub>R</sub></span> <span class="free">A</span><span class="keyword1">‚à•<span class="hidden">‚á©</span><sub>o</sub><span class="hidden">‚á©</span><sub>p</sub></span> <span class="main">=</span> <span class="main">¬¶</span><span class="free">c</span><span class="main">¬¶</span> <span class="main">*</span> <span class="main">(</span><span class="main">‚à•</span><span class="free">A</span><span class="keyword1">‚à•<span class="hidden">‚á©</span><sub>o</sub><span class="hidden">‚á©</span><sub>p</sub></span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">unfolding</span></span> onorm_scaleR<span class="main">[</span><span class="operator">OF</span> blin_matrix_vector_mult<span class="main">,</span> <span class="operator">symmetric</span><span class="main">]</span> scaleR_vector_assoc <span class="keyword1"><span class="command">..</span></span>

<span class="keyword1"><span class="command">lemma</span></span> op_norm_matrix_matrix_mult_le<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">‚à•</span><span class="free">A</span> <span class="main">**</span> <span class="free">B</span><span class="keyword1">‚à•<span class="hidden">‚á©</span><sub>o</sub><span class="hidden">‚á©</span><sub>p</sub></span> <span class="main">‚â§</span> <span class="main">(</span><span class="main">‚à•</span><span class="free">A</span><span class="keyword1">‚à•<span class="hidden">‚á©</span><sub>o</sub><span class="hidden">‚á©</span><sub>p</sub></span><span class="main">)</span> <span class="main">*</span> <span class="main">(</span><span class="main">‚à•</span><span class="free">B</span><span class="keyword1">‚à•<span class="hidden">‚á©</span><sub>o</sub><span class="hidden">‚á©</span><sub>p</sub></span><span class="main">)</span>"</span></span> 
<span class="keyword1"><span class="command">proof</span></span><span class="main">(</span><span class="operator">rule</span> onorm_le<span class="main">)</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">0</span> <span class="main">‚â§</span> <span class="main">(</span><span class="main">‚à•</span><span class="free">A</span><span class="keyword1">‚à•<span class="hidden">‚á©</span><sub>o</sub><span class="hidden">‚á©</span><sub>p</sub></span><span class="main">)</span>"</span></span> 
    <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">rule</span> onorm_pos_le<span class="main"><span class="main">[</span></span><span class="operator">OF</span> blin_matrix_vector_mult<span class="main"><span class="main">]</span></span><span class="main">)</span>
  <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">x</span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">‚à•</span><span class="free">A</span> <span class="main">**</span> <span class="free">B</span> <span class="keyword1">*v</span> <span class="skolem">x</span><span class="main">‚à•</span> <span class="main">=</span> <span class="main">‚à•</span><span class="free">A</span> <span class="keyword1">*v</span> <span class="main">(</span><span class="free">B</span> <span class="keyword1">*v</span> <span class="skolem">x</span><span class="main">)</span><span class="main">‚à•</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> matrix_vector_mul_assoc<span class="main">)</span>
  <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">‚â§</span> <span class="main">(</span><span class="main">‚à•</span><span class="free">A</span><span class="keyword1">‚à•<span class="hidden">‚á©</span><sub>o</sub><span class="hidden">‚á©</span><sub>p</sub></span><span class="main">)</span> <span class="main">*</span> <span class="main">(</span><span class="main">‚à•</span><span class="free">B</span> <span class="keyword1">*v</span> <span class="skolem">x</span><span class="main">‚à•</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> norm_matrix_le_mult_op_norm<span class="main"><span class="main">[</span></span><span class="operator">of</span> <span class="main"><span class="main">_</span></span> <span class="quoted"><span class="quoted">"<span class="free">B</span> <span class="keyword1">*v</span> <span class="skolem">x</span>"</span></span><span class="main"><span class="main">]</span></span><span class="main">)</span>
  <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">‚â§</span> <span class="main">(</span><span class="main">‚à•</span><span class="free">A</span><span class="keyword1">‚à•<span class="hidden">‚á©</span><sub>o</sub><span class="hidden">‚á©</span><sub>p</sub></span><span class="main">)</span> <span class="main">*</span> <span class="main">(</span><span class="main">(</span><span class="main">‚à•</span><span class="free">B</span><span class="keyword1">‚à•<span class="hidden">‚á©</span><sub>o</sub><span class="hidden">‚á©</span><sub>p</sub></span><span class="main">)</span> <span class="main">*</span> <span class="main">(</span><span class="main">‚à•</span><span class="skolem">x</span><span class="main">‚à•</span><span class="main">)</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> norm_matrix_le_mult_op_norm<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="free">B</span></span> <span class="quoted"><span class="skolem">x</span></span><span class="main">]</span> <span class="quoted"><span class="quoted">‚Äπ<span class="main">0</span> <span class="main">‚â§</span> <span class="main">(</span><span class="main">‚à•</span><span class="free">A</span><span class="keyword1">‚à•<span class="hidden">‚á©</span><sub>o</sub><span class="hidden">‚á©</span><sub>p</sub></span><span class="main">)</span>‚Ä∫</span></span> mult_left_mono <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">finally</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">‚à•</span><span class="free">A</span> <span class="main">**</span> <span class="free">B</span> <span class="keyword1">*v</span> <span class="skolem">x</span><span class="main">‚à•</span> <span class="main">‚â§</span> <span class="main">(</span><span class="main">‚à•</span><span class="free">A</span><span class="keyword1">‚à•<span class="hidden">‚á©</span><sub>o</sub><span class="hidden">‚á©</span><sub>p</sub></span><span class="main">)</span> <span class="main">*</span> <span class="main">(</span><span class="main">‚à•</span><span class="free">B</span><span class="keyword1">‚à•<span class="hidden">‚á©</span><sub>o</sub><span class="hidden">‚á©</span><sub>p</sub></span><span class="main">)</span> <span class="main">*</span> <span class="main">(</span><span class="main">‚à•</span><span class="skolem">x</span><span class="main">‚à•</span><span class="main">)</span>"</span></span> 
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">lemma</span></span> norm_matrix_vec_mult_le_transpose<span class="main">:</span>
  <span class="quoted"><span class="quoted">"<span class="main">‚à•</span><span class="free">x</span><span class="main">‚à•</span> <span class="main">=</span> <span class="main">1</span> <span class="main">‚üπ</span> <span class="main">(</span><span class="main">‚à•</span><span class="free">A</span> <span class="keyword1">*v</span> <span class="free">x</span><span class="main">‚à•</span><span class="main">)</span> <span class="main">‚â§</span> sqrt <span class="main">(</span><span class="main">‚à•</span>transpose <span class="free">A</span> <span class="main">**</span> <span class="free">A</span><span class="keyword1">‚à•<span class="hidden">‚á©</span><sub>o</sub><span class="hidden">‚á©</span><sub>p</sub></span><span class="main">)</span> <span class="main">*</span> <span class="main">(</span><span class="main">‚à•</span><span class="free">x</span><span class="main">‚à•</span><span class="main">)</span>"</span></span> <span class="keyword2"><span class="keyword">for</span></span> <span class="free">A</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"real<span class="main">^</span><span class="tfree">'n</span><span class="main">^</span><span class="tfree">'n</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
  <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">‚à•</span><span class="free">x</span><span class="main">‚à•</span> <span class="main">=</span> <span class="main">1</span>"</span></span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">‚à•</span><span class="free">A</span> <span class="keyword1">*v</span> <span class="free">x</span><span class="main">‚à•</span><span class="main">)</span><span class="main"><span class="hidden">‚áß</span><sup>2</sup></span> <span class="main">=</span> <span class="main">(</span><span class="free">A</span> <span class="keyword1">*v</span> <span class="free">x</span><span class="main">)</span> <span class="main">‚àô</span> <span class="main">(</span><span class="free">A</span> <span class="keyword1">*v</span> <span class="free">x</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> dot_square_norm<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">A</span> <span class="keyword1">*v</span> <span class="free">x</span><span class="main">)</span>"</span></span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> <span class="free">x</span> <span class="main">‚àô</span> <span class="main">(</span>transpose <span class="free">A</span> <span class="keyword1">*v</span> <span class="main">(</span><span class="free">A</span> <span class="keyword1">*v</span> <span class="free">x</span><span class="main">)</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> vec_mult_inner <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">‚â§</span> <span class="main">(</span><span class="main">‚à•</span><span class="free">x</span><span class="main">‚à•</span><span class="main">)</span> <span class="main">*</span> <span class="main">(</span><span class="main">‚à•</span>transpose <span class="free">A</span> <span class="keyword1">*v</span> <span class="main">(</span><span class="free">A</span> <span class="keyword1">*v</span> <span class="free">x</span><span class="main">)</span><span class="main">‚à•</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> norm_cauchy_schwarz <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">‚â§</span> <span class="main">(</span><span class="main">‚à•</span>transpose <span class="free">A</span> <span class="main">**</span> <span class="free">A</span><span class="keyword1">‚à•<span class="hidden">‚á©</span><sub>o</sub><span class="hidden">‚á©</span><sub>p</sub></span><span class="main">)</span> <span class="main">*</span> <span class="main">(</span><span class="main">‚à•</span><span class="free">x</span><span class="main">‚à•</span><span class="main">)</span><span class="main">^</span><span class="numeral">2</span>"</span></span>
    <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="main">(</span><span class="operator">subst</span> matrix_vector_mul_assoc<span class="main">)</span> 
    <span class="keyword1"><span class="command">using</span></span> norm_matrix_le_mult_op_norm<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="quoted">"transpose <span class="free">A</span> <span class="main">**</span> <span class="free">A</span>"</span></span> <span class="quoted"><span class="free">x</span></span><span class="main">]</span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> <span class="quoted"><span class="quoted">‚Äπ<span class="main">‚à•</span><span class="free">x</span><span class="main">‚à•</span> <span class="main">=</span> <span class="main">1</span>‚Ä∫</span></span><span class="main">)</span> 
  <span class="keyword1"><span class="command">finally</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">(</span><span class="main">‚à•</span><span class="free">A</span> <span class="keyword1">*v</span> <span class="free">x</span><span class="main">‚à•</span><span class="main">)</span><span class="main">)</span><span class="main">^</span><span class="numeral">2</span> <span class="main">‚â§</span> <span class="main">(</span><span class="main">‚à•</span>transpose <span class="free">A</span> <span class="main">**</span> <span class="free">A</span><span class="keyword1">‚à•<span class="hidden">‚á©</span><sub>o</sub><span class="hidden">‚á©</span><sub>p</sub></span><span class="main">)</span> <span class="main">*</span> <span class="main">(</span><span class="main">‚à•</span><span class="free">x</span><span class="main">‚à•</span><span class="main">)</span><span class="main">^</span><span class="numeral">2</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">linarith</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">‚à•</span><span class="free">A</span> <span class="keyword1">*v</span> <span class="free">x</span><span class="main">‚à•</span><span class="main">)</span> <span class="main">‚â§</span> sqrt <span class="main">(</span><span class="main">(</span><span class="main">‚à•</span>transpose <span class="free">A</span> <span class="main">**</span> <span class="free">A</span><span class="keyword1">‚à•<span class="hidden">‚á©</span><sub>o</sub><span class="hidden">‚á©</span><sub>p</sub></span><span class="main">)</span><span class="main">)</span> <span class="main">*</span> <span class="main">(</span><span class="main">‚à•</span><span class="free">x</span><span class="main">‚à•</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> <span class="quoted"><span class="quoted">‚Äπ<span class="main">‚à•</span><span class="free">x</span><span class="main">‚à•</span> <span class="main">=</span> <span class="main">1</span>‚Ä∫</span></span> real_le_rsqrt<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">lemma</span></span> op_norm_le_sum_column<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">‚à•</span><span class="free">A</span><span class="keyword1">‚à•<span class="hidden">‚á©</span><sub>o</sub><span class="hidden">‚á©</span><sub>p</sub></span> <span class="main">‚â§</span> <span class="main">(</span><span class="main">‚àë</span><span class="bound">i</span><span class="main">‚àà</span>UNIV<span class="main">.</span> <span class="main">‚à•</span>column <span class="bound">i</span> <span class="free">A</span><span class="main">‚à•</span><span class="main">)</span>"</span></span> <span class="keyword2"><span class="keyword">for</span></span> <span class="free">A</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"real<span class="main">^</span><span class="tfree">'n</span><span class="main">^</span><span class="tfree">'m</span>"</span></span>  
<span class="keyword1"><span class="command">proof</span></span><span class="main">(</span><span class="operator">unfold</span> op_norm_def<span class="main"><span class="keyword3">,</span></span> <span class="operator">rule</span> cSup_least<span class="main"><span class="main">[</span></span><span class="operator">OF</span> op_norm_set_proptys<span class="main"><span class="main">(</span></span>3<span class="main"><span class="main">)</span></span><span class="main"><span class="main">]</span></span><span class="main"><span class="keyword3">,</span></span> <span class="operator">clarsimp</span><span class="main">)</span>
  <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">x</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"real<span class="main">^</span><span class="tfree">'n</span>"</span></span> <span class="keyword3"><span class="command">assume</span></span> x_def<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="main">‚à•</span><span class="skolem">x</span><span class="main">‚à•</span> <span class="main">=</span> <span class="main">1</span>"</span></span> 
  <span class="keyword1"><span class="command">hence</span></span> x_hyp<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="main">‚ãÄ</span><span class="bound">i</span><span class="main">.</span> <span class="main">‚à•</span><span class="skolem">x</span> <span class="main">$</span> <span class="bound">i</span><span class="main">‚à•</span> <span class="main">‚â§</span> <span class="main">1</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> norm_bound_component_le_cart<span class="main">)</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">‚à•</span><span class="free">A</span> <span class="keyword1">*v</span> <span class="skolem">x</span><span class="main">‚à•</span><span class="main">)</span> <span class="main">=</span> <span class="main">‚à•</span><span class="main">(</span><span class="main">‚àë</span><span class="bound">i</span><span class="main">‚àà</span>UNIV<span class="main">.</span> <span class="skolem">x</span> <span class="main">$</span> <span class="bound">i</span> <span class="keyword1">*s</span> column <span class="bound">i</span> <span class="free">A</span><span class="main">)</span><span class="main">‚à•</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">subst</span> matrix_mult_sum<span class="main"><span class="main">[</span></span><span class="operator">of</span> <span class="quoted"><span class="free"><span class="quoted"><span class="free"><span class="quoted"><span class="free">A</span></span></span></span></span></span><span class="main"><span class="main">]</span></span><span class="main"><span class="keyword3">,</span></span> <span class="operator">simp</span><span class="main">)</span>
  <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">‚â§</span> <span class="main">(</span><span class="main">‚àë</span><span class="bound">i</span><span class="main">‚àà</span>UNIV<span class="main">.</span> <span class="main">‚à•</span><span class="skolem">x</span> <span class="main">$</span> <span class="bound">i</span> <span class="keyword1">*s</span> column <span class="bound">i</span> <span class="free">A</span><span class="main">‚à•</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> sum_norm_le<span class="main">)</span>
  <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> <span class="main">(</span><span class="main">‚àë</span><span class="bound">i</span><span class="main">‚àà</span>UNIV<span class="main">.</span> <span class="main">(</span><span class="main">‚à•</span><span class="skolem">x</span> <span class="main">$</span> <span class="bound">i</span><span class="main">‚à•</span><span class="main">)</span> <span class="main">*</span> <span class="main">(</span><span class="main">‚à•</span>column <span class="bound">i</span> <span class="free">A</span><span class="main">‚à•</span><span class="main">)</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> mult_norm_matrix_sgn_eq<span class="main">)</span>
  <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">‚â§</span> <span class="main">(</span><span class="main">‚àë</span><span class="bound">i</span><span class="main">‚àà</span>UNIV<span class="main">.</span> <span class="main">‚à•</span>column <span class="bound">i</span> <span class="free">A</span><span class="main">‚à•</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> x_hyp <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> mult_left_le_one_le sum_mono<span class="main">)</span> 
  <span class="keyword1"><span class="command">finally</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">‚à•</span><span class="free">A</span> <span class="keyword1">*v</span> <span class="skolem">x</span><span class="main">‚à•</span> <span class="main">‚â§</span> <span class="main">(</span><span class="main">‚àë</span><span class="bound">i</span><span class="main">‚àà</span>UNIV<span class="main">.</span> <span class="main">‚à•</span>column <span class="bound">i</span> <span class="free">A</span><span class="main">‚à•</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">.</span></span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">lemma</span></span> op_norm_le_transpose<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">‚à•</span><span class="free">A</span><span class="keyword1">‚à•<span class="hidden">‚á©</span><sub>o</sub><span class="hidden">‚á©</span><sub>p</sub></span> <span class="main">‚â§</span> <span class="main">‚à•</span>transpose <span class="free">A</span><span class="keyword1">‚à•<span class="hidden">‚á©</span><sub>o</sub><span class="hidden">‚á©</span><sub>p</sub></span>"</span></span> <span class="keyword2"><span class="keyword">for</span></span> <span class="free">A</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"real<span class="main">^</span><span class="tfree">'n</span><span class="main">^</span><span class="tfree">'n</span>"</span></span>  
<span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> obs<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="main">‚àÄ</span><span class="bound">x</span><span class="main">.</span> <span class="main">‚à•</span><span class="bound">x</span><span class="main">‚à•</span> <span class="main">=</span> <span class="main">1</span> <span class="main">‚ü∂</span> <span class="main">(</span><span class="main">‚à•</span><span class="free">A</span> <span class="keyword1">*v</span> <span class="bound">x</span><span class="main">‚à•</span><span class="main">)</span> <span class="main">‚â§</span> sqrt <span class="main">(</span><span class="main">(</span><span class="main">‚à•</span>transpose <span class="free">A</span> <span class="main">**</span> <span class="free">A</span><span class="keyword1">‚à•<span class="hidden">‚á©</span><sub>o</sub><span class="hidden">‚á©</span><sub>p</sub></span><span class="main">)</span><span class="main">)</span> <span class="main">*</span> <span class="main">(</span><span class="main">‚à•</span><span class="bound">x</span><span class="main">‚à•</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> norm_matrix_vec_mult_le_transpose <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">‚à•</span><span class="free">A</span><span class="keyword1">‚à•<span class="hidden">‚á©</span><sub>o</sub><span class="hidden">‚á©</span><sub>p</sub></span><span class="main">)</span> <span class="main">‚â§</span> sqrt <span class="main">(</span><span class="main">(</span><span class="main">‚à•</span>transpose <span class="free">A</span> <span class="main">**</span> <span class="free">A</span><span class="keyword1">‚à•<span class="hidden">‚á©</span><sub>o</sub><span class="hidden">‚á©</span><sub>p</sub></span><span class="main">)</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> obs <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="main">(</span><span class="operator">unfold</span> op_norm_def<span class="main">)</span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> cSup_least<span class="main"><span class="main">[</span></span><span class="operator">OF</span> op_norm_set_proptys<span class="main"><span class="main">(</span></span>3<span class="main"><span class="main">)</span></span><span class="main"><span class="main">]</span></span><span class="main">)</span> <span class="operator">clarsimp</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">(</span><span class="main">‚à•</span><span class="free">A</span><span class="keyword1">‚à•<span class="hidden">‚á©</span><sub>o</sub><span class="hidden">‚á©</span><sub>p</sub></span><span class="main">)</span><span class="main">)</span><span class="main"><span class="hidden">‚áß</span><sup>2</sup></span> <span class="main">‚â§</span> <span class="main">(</span><span class="main">‚à•</span>transpose <span class="free">A</span> <span class="main">**</span> <span class="free">A</span><span class="keyword1">‚à•<span class="hidden">‚á©</span><sub>o</sub><span class="hidden">‚á©</span><sub>p</sub></span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> power_mono<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">‚à•</span><span class="free">A</span><span class="keyword1">‚à•<span class="hidden">‚á©</span><sub>o</sub><span class="hidden">‚á©</span><sub>p</sub></span><span class="main">)</span>"</span></span> <span class="main">_</span> <span class="quoted"><span class="numeral">2</span></span><span class="main">]</span> op_norm_ge_0
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> not_le real_less_lsqrt<span class="main">)</span>
  <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">‚â§</span> <span class="main">(</span><span class="main">‚à•</span>transpose <span class="free">A</span><span class="keyword1">‚à•<span class="hidden">‚á©</span><sub>o</sub><span class="hidden">‚á©</span><sub>p</sub></span><span class="main">)</span> <span class="main">*</span> <span class="main">(</span><span class="main">‚à•</span><span class="free">A</span><span class="keyword1">‚à•<span class="hidden">‚á©</span><sub>o</sub><span class="hidden">‚á©</span><sub>p</sub></span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> op_norm_matrix_matrix_mult_le <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">finally</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">(</span><span class="main">‚à•</span><span class="free">A</span><span class="keyword1">‚à•<span class="hidden">‚á©</span><sub>o</sub><span class="hidden">‚á©</span><sub>p</sub></span><span class="main">)</span><span class="main">)</span><span class="main"><span class="hidden">‚áß</span><sup>2</sup></span> <span class="main">‚â§</span> <span class="main">(</span><span class="main">‚à•</span>transpose <span class="free">A</span><span class="keyword1">‚à•<span class="hidden">‚á©</span><sub>o</sub><span class="hidden">‚á©</span><sub>p</sub></span><span class="main">)</span> <span class="main">*</span> <span class="main">(</span><span class="main">‚à•</span><span class="free">A</span><span class="keyword1">‚à•<span class="hidden">‚á©</span><sub>o</sub><span class="hidden">‚á©</span><sub>p</sub></span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">linarith</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">‚à•</span><span class="free">A</span><span class="keyword1">‚à•<span class="hidden">‚á©</span><sub>o</sub><span class="hidden">‚á©</span><sub>p</sub></span><span class="main">)</span> <span class="main">‚â§</span> <span class="main">(</span><span class="main">‚à•</span>transpose <span class="free">A</span><span class="keyword1">‚à•<span class="hidden">‚á©</span><sub>o</sub><span class="hidden">‚á©</span><sub>p</sub></span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> sq_le_cancel<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="quoted"><span class="quoted">"<span class="main"><span class="main">(</span></span><span class="main"><span class="main">‚à•</span></span><span class="free"><span class="free">A</span></span><span class="keyword1"><span class="keyword1">‚à•<span class="hidden">‚á©</span><sub>o</sub><span class="hidden">‚á©</span><sub>p</sub></span></span><span class="main"><span class="main">)</span></span>"</span></span></span><span class="main">]</span> op_norm_ge_0 <span class="keyword1"><span class="command">by</span></span> <span class="operator">metis</span>
<span class="keyword1"><span class="command">qed</span></span>


<span class="keyword1"><span class="command">subsection</span></span><span class="quoted"><span class="plain_text">‚Äπ Matrix maximum norm ‚Ä∫</span></span>

<span class="keyword1"><span class="command">abbreviation</span></span> <span class="entity">max_norm</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"real<span class="main">^</span><span class="tfree">'n</span><span class="main">^</span><span class="tfree">'m</span> <span class="main">‚áí</span> real"</span></span> <span class="main">(</span><span class="quoted">"<span class="keyword3">(1</span><span class="keyword1">‚à•</span>_<span class="keyword1">‚à•<span class="hidden">‚á©</span><sub>m</sub><span class="hidden">‚á©</span><sub>a</sub><span class="hidden">‚á©</span><sub>x</sub></span><span class="keyword3">)</span>"</span> <span class="main">[</span>65<span class="main">]</span> 61<span class="main">)</span>
  <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="main"><span class="free">‚à•</span></span><span class="free"><span class="bound"><span class="entity">A</span></span></span><span class="keyword1"><span class="free">‚à•<span class="hidden">‚á©</span><sub>m</sub><span class="hidden">‚á©</span><sub>a</sub><span class="hidden">‚á©</span><sub>x</sub></span></span> <span class="main">‚â°</span> Max <span class="main">(</span>abs <span class="main">`</span> <span class="main">(</span>entries <span class="free"><span class="bound"><span class="entity">A</span></span></span><span class="main">)</span><span class="main">)</span>"</span></span>

<span class="keyword1"><span class="command">lemma</span></span> max_norm_def<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">‚à•</span><span class="free">A</span><span class="keyword1">‚à•<span class="hidden">‚á©</span><sub>m</sub><span class="hidden">‚á©</span><sub>a</sub><span class="hidden">‚á©</span><sub>x</sub></span> <span class="main">=</span> Max <span class="main">{</span><span class="main">¬¶</span><span class="free">A</span> <span class="main">$</span> <span class="bound">i</span> <span class="main">$</span> <span class="bound">j</span><span class="main">¬¶</span><span class="main">|</span><span class="bound">i</span> <span class="bound">j</span><span class="main">.</span> <span class="bound">i</span><span class="main">‚àà</span>UNIV <span class="main">‚àß</span> <span class="bound">j</span><span class="main">‚àà</span>UNIV<span class="main">}</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> image_def<span class="main"><span class="keyword3">,</span></span> <span class="operator">rule</span> arg_cong<span class="main"><span class="main">[</span></span><span class="operator">of</span> <span class="main"><span class="main">_</span></span> <span class="main"><span class="main">_</span></span> <span class="quoted"><span class="quoted"><span class="quoted">Max</span></span></span><span class="main"><span class="main">]</span></span><span class="main"><span class="keyword3">,</span></span> <span class="operator">blast</span><span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> max_norm_set_proptys<span class="main">:</span> <span class="quoted"><span class="quoted">"finite <span class="main">{</span><span class="main">¬¶</span><span class="free">A</span> <span class="main">$</span> <span class="bound">i</span> <span class="main">$</span> <span class="bound">j</span><span class="main">¬¶</span> <span class="main">|</span><span class="bound">i</span> <span class="bound">j</span><span class="main">.</span> <span class="bound">i</span> <span class="main">‚àà</span> UNIV <span class="main">‚àß</span> <span class="bound">j</span> <span class="main">‚àà</span> UNIV<span class="main">}</span>"</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">is</span></span> <span class="quoted"><span class="quoted">"finite <span class="var">?X</span>"</span></span><span class="main">)</span>
<span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">‚ãÄ</span><span class="bound">i</span><span class="main">.</span> finite <span class="main">{</span><span class="main">¬¶</span><span class="free">A</span> <span class="main">$</span> <span class="bound">i</span> <span class="main">$</span> <span class="bound">j</span><span class="main">¬¶</span> <span class="main">|</span> <span class="bound">j</span><span class="main">.</span> <span class="bound">j</span> <span class="main">‚àà</span> UNIV<span class="main">}</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> finite_Atleast_Atmost_nat <span class="keyword1"><span class="command">by</span></span> <span class="operator">fastforce</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"finite <span class="main">(</span><span class="main">‚ãÉ</span><span class="bound">i</span><span class="main">‚àà</span>UNIV<span class="main">.</span> <span class="main">{</span><span class="main">¬¶</span><span class="free">A</span> <span class="main">$</span> <span class="bound">i</span> <span class="main">$</span> <span class="bound">j</span><span class="main">¬¶</span> <span class="main">|</span> <span class="bound">j</span><span class="main">.</span> <span class="bound">j</span> <span class="main">‚àà</span> UNIV<span class="main">}</span><span class="main">)</span>"</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">is</span></span> <span class="quoted"><span class="quoted">"finite <span class="var">?Y</span>"</span></span><span class="main">)</span>
    <span class="keyword1"><span class="command">using</span></span> finite_class.finite_UNIV <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="var">?X</span> <span class="main">‚äÜ</span> <span class="var">?Y</span>"</span></span> 
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> 
    <span class="keyword1"><span class="command">using</span></span> finite_subset <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">lemma</span></span> max_norm_ge_0<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">0</span> <span class="main">‚â§</span> <span class="main">‚à•</span><span class="free">A</span><span class="keyword1">‚à•<span class="hidden">‚á©</span><sub>m</sub><span class="hidden">‚á©</span><sub>a</sub><span class="hidden">‚á©</span><sub>x</sub></span>"</span></span>
  <span class="keyword1"><span class="command">unfolding</span></span> max_norm_def 
  <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="main">(</span><span class="operator">rule</span> order.trans<span class="main"><span class="main">[</span></span><span class="operator">OF</span> abs_ge_zero<span class="main"><span class="main">[</span></span><span class="operator">of</span> <span class="quoted"><span class="quoted"><span class="quoted">"<span class="free"><span class="free">A</span></span> <span class="main"><span class="main">$</span></span> <span class="main"><span class="main">_</span></span> <span class="main"><span class="main">$</span></span> <span class="main"><span class="main">_</span></span>"</span></span></span><span class="main"><span class="main">]</span></span> Max_ge<span class="main"><span class="main">]</span></span><span class="main">)</span>
  <span class="keyword1"><span class="command">using</span></span> max_norm_set_proptys <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">lemma</span></span> op_norm_le_max_norm<span class="main">:</span>
  <span class="keyword2"><span class="keyword">fixes</span></span> <span class="free">A</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"real<span class="main">^</span><span class="main">(</span><span class="tfree">'n</span><span class="main">::</span>finite<span class="main">)</span><span class="main">^</span><span class="main">(</span><span class="tfree">'m</span><span class="main">::</span>finite<span class="main">)</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">‚à•</span><span class="free">A</span><span class="keyword1">‚à•<span class="hidden">‚á©</span><sub>o</sub><span class="hidden">‚á©</span><sub>p</sub></span> <span class="main">‚â§</span> real <span class="keyword1">CARD</span><span class="main">(</span><span class="tfree">'m</span><span class="main">)</span> <span class="main">*</span> real <span class="keyword1">CARD</span><span class="main">(</span><span class="tfree">'n</span><span class="main">)</span> <span class="main">*</span> <span class="main">(</span><span class="main">‚à•</span><span class="free">A</span><span class="keyword1">‚à•<span class="hidden">‚á©</span><sub>m</sub><span class="hidden">‚á©</span><sub>a</sub><span class="hidden">‚á©</span><sub>x</sub></span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="main">(</span><span class="operator">rule</span> onorm_le_matrix_component<span class="main">)</span>
  <span class="keyword1"><span class="command">unfolding</span></span> max_norm_def <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">rule</span> Max_ge<span class="main"><span class="main">[</span></span><span class="operator">OF</span> max_norm_set_proptys<span class="main"><span class="main">]</span></span><span class="main">)</span> <span class="operator">force</span>

<span class="keyword1"><span class="command">lemma</span></span> sqrt_Sup_power2_eq_Sup_abs<span class="main">:</span>
  <span class="quoted"><span class="quoted">"finite <span class="free">A</span> <span class="main">‚üπ</span> <span class="free">A</span> <span class="main">‚â†</span> <span class="main">{}</span> <span class="main">‚üπ</span> sqrt <span class="main">(</span>Sup <span class="main">{</span><span class="main">(</span><span class="free">f</span> <span class="bound">i</span><span class="main">)</span><span class="main"><span class="hidden">‚áß</span><sup>2</sup></span> <span class="main">|</span><span class="bound">i</span><span class="main">.</span> <span class="bound">i</span> <span class="main">‚àà</span> <span class="free">A</span><span class="main">}</span><span class="main">)</span> <span class="main">=</span> Sup <span class="main">{</span><span class="main">¬¶</span><span class="free">f</span> <span class="bound">i</span><span class="main">¬¶</span> <span class="main">|</span><span class="bound">i</span><span class="main">.</span> <span class="bound">i</span> <span class="main">‚àà</span> <span class="free">A</span><span class="main">}</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span><span class="main">(</span><span class="operator">rule</span> sym<span class="main">)</span>
  <span class="keyword3"><span class="command">assume</span></span> assms<span class="main">:</span> <span class="quoted"><span class="quoted">"finite <span class="free">A</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="free">A</span> <span class="main">‚â†</span> <span class="main">{}</span>"</span></span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">i</span></span> <span class="keyword2"><span class="keyword">where</span></span> i_def<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">i</span> <span class="main">‚àà</span> <span class="free">A</span> <span class="main">‚àß</span> Sup <span class="main">{</span><span class="main">(</span><span class="free">f</span> <span class="bound">i</span><span class="main">)</span><span class="main"><span class="hidden">‚áß</span><sup>2</sup></span><span class="main">|</span><span class="bound">i</span><span class="main">.</span> <span class="bound">i</span> <span class="main">‚àà</span> <span class="free">A</span><span class="main">}</span> <span class="main">=</span> <span class="main">(</span><span class="free">f</span> <span class="skolem">i</span><span class="main">)</span><span class="main">^</span><span class="numeral">2</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> cSup_finite_ex<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="quoted">"<span class="main">{</span><span class="main">(</span><span class="free">f</span> <span class="bound">i</span><span class="main">)</span><span class="main"><span class="hidden">‚áß</span><sup>2</sup></span><span class="main">|</span><span class="bound">i</span><span class="main">.</span> <span class="bound">i</span> <span class="main">‚àà</span> <span class="free">A</span><span class="main">}</span>"</span></span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">hence</span></span> lhs<span class="main">:</span> <span class="quoted"><span class="quoted">"sqrt <span class="main">(</span>Sup <span class="main">{</span><span class="main">(</span><span class="free">f</span> <span class="bound">i</span><span class="main">)</span><span class="main"><span class="hidden">‚áß</span><sup>2</sup></span> <span class="main">|</span><span class="bound">i</span><span class="main">.</span> <span class="bound">i</span> <span class="main">‚àà</span> <span class="free">A</span><span class="main">}</span><span class="main">)</span> <span class="main">=</span> <span class="main">¬¶</span><span class="free">f</span> <span class="skolem">i</span><span class="main">¬¶</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"finite <span class="main">{</span><span class="main">(</span><span class="free">f</span> <span class="bound">i</span><span class="main">)</span><span class="main"><span class="hidden">‚áß</span><sup>2</sup></span><span class="main">|</span><span class="bound">i</span><span class="main">.</span> <span class="bound">i</span> <span class="main">‚àà</span> <span class="free">A</span><span class="main">}</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="main">‚àÄ</span><span class="bound">j</span><span class="main">‚àà</span><span class="free">A</span><span class="main">.</span> <span class="main">(</span><span class="free">f</span> <span class="bound">j</span><span class="main">)</span><span class="main"><span class="hidden">‚áß</span><sup>2</sup></span> <span class="main">‚â§</span> <span class="main">(</span><span class="free">f</span> <span class="skolem">i</span><span class="main">)</span><span class="main"><span class="hidden">‚áß</span><sup>2</sup></span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> i_def cSup_upper<span class="main">[</span><span class="operator">of</span> <span class="main">_</span> <span class="quoted"><span class="quoted">"<span class="main">{</span><span class="main">(</span><span class="free">f</span> <span class="bound">i</span><span class="main">)</span><span class="main"><span class="hidden">‚áß</span><sup>2</sup></span> <span class="main">|</span><span class="bound">i</span><span class="main">.</span> <span class="bound">i</span> <span class="main">‚àà</span> <span class="free">A</span><span class="main">}</span>"</span></span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">force</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="main">‚àÄ</span><span class="bound">j</span><span class="main">‚àà</span><span class="free">A</span><span class="main">.</span> <span class="main">¬¶</span><span class="free">f</span> <span class="bound">j</span><span class="main">¬¶</span> <span class="main">‚â§</span> <span class="main">¬¶</span><span class="free">f</span> <span class="skolem">i</span><span class="main">¬¶</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> abs_le_square_iff <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬¶</span><span class="free">f</span> <span class="skolem">i</span><span class="main">¬¶</span> <span class="main">‚àà</span> <span class="main">{</span><span class="main">¬¶</span><span class="free">f</span> <span class="bound">i</span><span class="main">¬¶</span> <span class="main">|</span><span class="bound">i</span><span class="main">.</span> <span class="bound">i</span> <span class="main">‚àà</span> <span class="free">A</span><span class="main">}</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> i_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"Sup <span class="main">{</span><span class="main">¬¶</span><span class="free">f</span> <span class="bound">i</span><span class="main">¬¶</span> <span class="main">|</span><span class="bound">i</span><span class="main">.</span> <span class="bound">i</span> <span class="main">‚àà</span> <span class="free">A</span><span class="main">}</span> <span class="main">=</span> sqrt <span class="main">(</span>Sup <span class="main">{</span><span class="main">(</span><span class="free">f</span> <span class="bound">i</span><span class="main">)</span><span class="main"><span class="hidden">‚áß</span><sup>2</sup></span> <span class="main">|</span><span class="bound">i</span><span class="main">.</span> <span class="bound">i</span> <span class="main">‚àà</span> <span class="free">A</span><span class="main">}</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> cSup_mem_eq<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="quoted">"<span class="main">¬¶</span><span class="free">f</span> <span class="skolem">i</span><span class="main">¬¶</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="main">{</span><span class="main">¬¶</span><span class="free">f</span> <span class="bound">i</span><span class="main">¬¶</span> <span class="main">|</span><span class="bound">i</span><span class="main">.</span> <span class="bound">i</span> <span class="main">‚àà</span> <span class="free">A</span><span class="main">}</span>"</span></span><span class="main">]</span> lhs <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">lemma</span></span> sqrt_Max_power2_eq_max_abs<span class="main">:</span>
  <span class="quoted"><span class="quoted">"finite <span class="free">A</span> <span class="main">‚üπ</span> <span class="free">A</span> <span class="main">‚â†</span> <span class="main">{}</span> <span class="main">‚üπ</span> sqrt <span class="main">(</span>Max <span class="main">{</span><span class="main">(</span><span class="free">f</span> <span class="bound">i</span><span class="main">)</span><span class="main"><span class="hidden">‚áß</span><sup>2</sup></span><span class="main">|</span><span class="bound">i</span><span class="main">.</span> <span class="bound">i</span> <span class="main">‚àà</span> <span class="free">A</span><span class="main">}</span><span class="main">)</span> <span class="main">=</span> Max <span class="main">{</span><span class="main">¬¶</span><span class="free">f</span> <span class="bound">i</span><span class="main">¬¶</span> <span class="main">|</span><span class="bound">i</span><span class="main">.</span> <span class="bound">i</span> <span class="main">‚àà</span> <span class="free">A</span><span class="main">}</span>"</span></span>
  <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="main">(</span><span class="operator">subst</span> cSup_eq_Max<span class="main"><span class="main">[</span></span><span class="operator">symmetric</span><span class="main"><span class="main">]</span></span><span class="main"><span class="keyword3">,</span></span> <span class="operator">simp_all</span><span class="main">)</span><span class="main"><span class="keyword3">+</span></span>
  <span class="keyword1"><span class="command">using</span></span> sqrt_Sup_power2_eq_Sup_abs <span class="keyword1"><span class="command">.</span></span>

<span class="keyword1"><span class="command">lemma</span></span> op_norm_diag_mat_eq<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">‚à•</span>diag_mat <span class="free">f</span><span class="keyword1">‚à•<span class="hidden">‚á©</span><sub>o</sub><span class="hidden">‚á©</span><sub>p</sub></span> <span class="main">=</span> Max <span class="main">{</span><span class="main">¬¶</span><span class="free">f</span> <span class="bound">i</span><span class="main">¬¶</span> <span class="main">|</span><span class="bound">i</span><span class="main">.</span> <span class="bound">i</span> <span class="main">‚àà</span> UNIV<span class="main">}</span>"</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">is</span></span> <span class="quoted"><span class="quoted">"<span class="main">_</span> <span class="main">=</span> Max <span class="var">?A</span>"</span></span><span class="main">)</span>
<span class="keyword1"><span class="command">proof</span></span><span class="main">(</span><span class="operator">unfold</span> op_norm_def<span class="main">)</span>
  <span class="keyword1"><span class="command">have</span></span> obs<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">‚ãÄ</span><span class="bound">x</span> <span class="bound">i</span><span class="main">.</span> <span class="main">(</span><span class="free">f</span> <span class="bound">i</span><span class="main">)</span><span class="main"><span class="hidden">‚áß</span><sup>2</sup></span> <span class="main">*</span> <span class="main">(</span><span class="bound">x</span> <span class="main">$</span> <span class="bound">i</span><span class="main">)</span><span class="main"><span class="hidden">‚áß</span><sup>2</sup></span> <span class="main">‚â§</span> Max <span class="main">{</span><span class="main">(</span><span class="free">f</span> <span class="bound">i</span><span class="main">)</span><span class="main"><span class="hidden">‚áß</span><sup>2</sup></span><span class="main">|</span><span class="bound">i</span><span class="main">.</span> <span class="bound">i</span> <span class="main">‚àà</span> UNIV<span class="main">}</span> <span class="main">*</span> <span class="main">(</span><span class="bound">x</span> <span class="main">$</span> <span class="bound">i</span><span class="main">)</span><span class="main"><span class="hidden">‚áß</span><sup>2</sup></span>"</span></span>
    <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="main">(</span><span class="operator">rule</span> mult_right_mono<span class="main"><span class="main">[</span></span><span class="operator">OF</span> _ zero_le_power2<span class="main"><span class="main">]</span></span><span class="main">)</span>
    <span class="keyword1"><span class="command">using</span></span> le_max_image_of_finite<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="quoted">"<span class="main">Œª</span><span class="bound">i</span><span class="main">.</span> <span class="main">(</span><span class="free">f</span> <span class="bound">i</span><span class="main">)</span><span class="main">^</span><span class="numeral">2</span>"</span></span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">{</span></span><span class="keyword3"><span class="command">fix</span></span> <span class="skolem">r</span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">r</span> <span class="main">‚àà</span> <span class="main">{</span><span class="main">‚à•</span>diag_mat <span class="free">f</span> <span class="keyword1">*v</span> <span class="bound">x</span><span class="main">‚à•</span> <span class="main">|</span><span class="bound">x</span><span class="main">.</span> <span class="main">‚à•</span><span class="bound">x</span><span class="main">‚à•</span> <span class="main">=</span> <span class="main">1</span><span class="main">}</span>"</span></span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">x</span></span> <span class="keyword2"><span class="keyword">where</span></span> x_def<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">‚à•</span>diag_mat <span class="free">f</span> <span class="keyword1">*v</span> <span class="skolem">x</span><span class="main">‚à•</span> <span class="main">=</span> <span class="skolem">r</span> <span class="main">‚àß</span> <span class="main">‚à•</span><span class="skolem">x</span><span class="main">‚à•</span> <span class="main">=</span> <span class="main">1</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
    <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">r</span><span class="main"><span class="hidden">‚áß</span><sup>2</sup></span> <span class="main">=</span> <span class="main">(</span><span class="main">‚àë</span><span class="bound">i</span><span class="main">‚àà</span>UNIV<span class="main">.</span> <span class="main">(</span><span class="free">f</span> <span class="bound">i</span><span class="main">)</span><span class="main"><span class="hidden">‚áß</span><sup>2</sup></span> <span class="main">*</span> <span class="main">(</span><span class="skolem">x</span> <span class="main">$</span> <span class="bound">i</span><span class="main">)</span><span class="main"><span class="hidden">‚áß</span><sup>2</sup></span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">unfolding</span></span> norm_vec_def L2_set_def matrix_vector_mul_diag_mat 
      <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> power_mult_distrib<span class="main">)</span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> <span class="main"><span class="main">(</span></span>no_types<span class="main"><span class="main">,</span></span> lifting<span class="main"><span class="main">)</span></span> x_def norm_ge_zero real_sqrt_ge_0_iff real_sqrt_pow2<span class="main">)</span>
    <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">‚â§</span> <span class="main">(</span>Max <span class="main">{</span><span class="main">(</span><span class="free">f</span> <span class="bound">i</span><span class="main">)</span><span class="main"><span class="hidden">‚áß</span><sup>2</sup></span><span class="main">|</span><span class="bound">i</span><span class="main">.</span> <span class="bound">i</span> <span class="main">‚àà</span> UNIV<span class="main">}</span><span class="main">)</span> <span class="main">*</span> <span class="main">(</span><span class="main">‚àë</span><span class="bound">i</span><span class="main">‚àà</span>UNIV<span class="main">.</span> <span class="main">(</span><span class="skolem">x</span> <span class="main">$</span> <span class="bound">i</span><span class="main">)</span><span class="main"><span class="hidden">‚áß</span><sup>2</sup></span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> obs<span class="main">[</span><span class="operator">of</span> <span class="main">_</span> <span class="quoted"><span class="skolem">x</span></span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> sum_mono sum_distrib_left<span class="main">)</span>
    <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> Max <span class="main">{</span><span class="main">(</span><span class="free">f</span> <span class="bound">i</span><span class="main">)</span><span class="main"><span class="hidden">‚áß</span><sup>2</sup></span><span class="main">|</span><span class="bound">i</span><span class="main">.</span> <span class="bound">i</span> <span class="main">‚àà</span> UNIV<span class="main">}</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> x_def <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> norm_vec_def L2_set_def<span class="main">)</span>
    <span class="keyword1"><span class="command">finally</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">r</span> <span class="main">‚â§</span> sqrt <span class="main">(</span>Max <span class="main">{</span><span class="main">(</span><span class="free">f</span> <span class="bound">i</span><span class="main">)</span><span class="main"><span class="hidden">‚áß</span><sup>2</sup></span><span class="main">|</span><span class="bound">i</span><span class="main">.</span> <span class="bound">i</span> <span class="main">‚àà</span> UNIV<span class="main">}</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> x_def real_le_rsqrt <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span> 
    <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">r</span> <span class="main">‚â§</span> Max <span class="var">?A</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">subst</span> <span class="main"><span class="main">(</span></span><span class="quasi_keyword">asm</span><span class="main"><span class="main">)</span></span> sqrt_Max_power2_eq_max_abs<span class="main"><span class="main">[</span></span><span class="operator">of</span> <span class="quoted"><span class="quoted"><span class="quoted">UNIV</span></span></span> <span class="quoted"><span class="free"><span class="quoted"><span class="free"><span class="quoted"><span class="free">f</span></span></span></span></span></span><span class="main"><span class="main">]</span></span><span class="main"><span class="keyword3">,</span></span> <span class="operator">simp_all</span><span class="main">)</span><span class="keyword1"><span class="command">}</span></span>
  <span class="keyword1"><span class="command">hence</span></span> 1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">‚àÄ</span><span class="bound">x</span><span class="main">‚àà</span><span class="main">{</span><span class="main">‚à•</span>diag_mat <span class="free">f</span> <span class="keyword1">*v</span> <span class="bound">x</span><span class="main">‚à•</span> <span class="main">|</span><span class="bound">x</span><span class="main">.</span> <span class="main">‚à•</span><span class="bound">x</span><span class="main">‚à•</span> <span class="main">=</span> <span class="main">1</span><span class="main">}</span><span class="main">.</span> <span class="bound">x</span> <span class="main">‚â§</span> Max <span class="var">?A</span>"</span></span>
    <span class="keyword1"><span class="command">unfolding</span></span> diag_mat_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">i</span></span> <span class="keyword2"><span class="keyword">where</span></span> i_def<span class="main">:</span> <span class="quoted"><span class="quoted">"Max <span class="var">?A</span> <span class="main">=</span> <span class="main">‚à•</span>diag_mat <span class="free">f</span> <span class="keyword1">*v</span> ùñæ <span class="skolem">i</span><span class="main">‚à•</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> cMax_finite_ex<span class="main">[</span><span class="operator">of</span> <span class="var"><span class="quoted"><span class="var">?A</span></span></span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">force</span>
  <span class="keyword1"><span class="command">hence</span></span> 2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">‚àÉ</span><span class="bound">x</span><span class="main">‚àà</span><span class="main">{</span><span class="main">‚à•</span>diag_mat <span class="free">f</span> <span class="keyword1">*v</span> <span class="bound">x</span><span class="main">‚à•</span> <span class="main">|</span><span class="bound">x</span><span class="main">.</span> <span class="main">‚à•</span><span class="bound">x</span><span class="main">‚à•</span> <span class="main">=</span> <span class="main">1</span><span class="main">}</span><span class="main">.</span> Max <span class="var">?A</span> <span class="main">‚â§</span> <span class="bound">x</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> <span class="main"><span class="main">(</span></span>mono_tags<span class="main"><span class="main">,</span></span> lifting<span class="main"><span class="main">)</span></span> abs_1 mem_Collect_eq norm_axis_eq order_refl real_norm_def<span class="main">)</span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"Sup <span class="main">{</span><span class="main">‚à•</span>diag_mat <span class="free">f</span> <span class="keyword1">*v</span> <span class="bound">x</span><span class="main">‚à•</span> <span class="main">|</span><span class="bound">x</span><span class="main">.</span> <span class="main">‚à•</span><span class="bound">x</span><span class="main">‚à•</span> <span class="main">=</span> <span class="main">1</span><span class="main">}</span> <span class="main">=</span> Max <span class="var">?A</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> cSup_eq<span class="main"><span class="main">[</span></span><span class="operator">OF</span> 1 2<span class="main"><span class="main">]</span></span><span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">lemma</span></span> op_max_norms_eq_at_diag<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">‚à•</span>diag_mat <span class="free">f</span><span class="keyword1">‚à•<span class="hidden">‚á©</span><sub>o</sub><span class="hidden">‚á©</span><sub>p</sub></span> <span class="main">=</span> <span class="main">‚à•</span>diag_mat <span class="free">f</span><span class="keyword1">‚à•<span class="hidden">‚á©</span><sub>m</sub><span class="hidden">‚á©</span><sub>a</sub><span class="hidden">‚á©</span><sub>x</sub></span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span><span class="main">(</span><span class="operator">rule</span> antisym<span class="main">)</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">{</span><span class="main">¬¶</span><span class="free">f</span> <span class="bound">i</span><span class="main">¬¶</span> <span class="main">|</span><span class="bound">i</span><span class="main">.</span> <span class="bound">i</span> <span class="main">‚àà</span> UNIV<span class="main">}</span> <span class="main">‚äÜ</span> <span class="main">{</span><span class="main">¬¶</span>diag_mat <span class="free">f</span> <span class="main">$</span> <span class="bound">i</span> <span class="main">$</span> <span class="bound">j</span><span class="main">¬¶</span> <span class="main">|</span><span class="bound">i</span> <span class="bound">j</span><span class="main">.</span> <span class="bound">i</span> <span class="main">‚àà</span> UNIV <span class="main">‚àß</span> <span class="bound">j</span> <span class="main">‚àà</span> UNIV<span class="main">}</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">smt</span> Collect_mono diag_mat_vec_nth_simps<span class="main"><span class="main">(</span></span>1<span class="main"><span class="main">)</span></span><span class="main">)</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"<span class="main">‚à•</span>diag_mat <span class="free">f</span><span class="keyword1">‚à•<span class="hidden">‚á©</span><sub>o</sub><span class="hidden">‚á©</span><sub>p</sub></span> <span class="main">‚â§</span> <span class="main">‚à•</span>diag_mat <span class="free">f</span><span class="keyword1">‚à•<span class="hidden">‚á©</span><sub>m</sub><span class="hidden">‚á©</span><sub>a</sub><span class="hidden">‚á©</span><sub>x</sub></span>"</span></span>
    <span class="keyword1"><span class="command">unfolding</span></span> op_norm_diag_mat_eq max_norm_def
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> Max.subset_imp<span class="main">)</span> <span class="main">(</span><span class="operator">blast</span><span class="main"><span class="keyword3">,</span></span> <span class="operator">simp</span> <span class="quasi_keyword">only</span><span class="main"><span class="main">:</span></span> finite_image_of_finite2<span class="main">)</span>
<span class="keyword1"><span class="command">next</span></span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"Sup <span class="main">{</span><span class="main">¬¶</span>diag_mat <span class="free">f</span> <span class="main">$</span> <span class="bound">i</span> <span class="main">$</span> <span class="bound">j</span><span class="main">¬¶</span> <span class="main">|</span><span class="bound">i</span> <span class="bound">j</span><span class="main">.</span> <span class="bound">i</span> <span class="main">‚àà</span> UNIV <span class="main">‚àß</span> <span class="bound">j</span> <span class="main">‚àà</span> UNIV<span class="main">}</span> <span class="main">‚â§</span> Sup <span class="main">{</span><span class="main">¬¶</span><span class="free">f</span> <span class="bound">i</span><span class="main">¬¶</span> <span class="main">|</span><span class="bound">i</span><span class="main">.</span> <span class="bound">i</span> <span class="main">‚àà</span> UNIV<span class="main">}</span>"</span></span>
    <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="main">(</span><span class="operator">rule</span> cSup_least<span class="main"><span class="keyword3">,</span></span> <span class="operator">blast</span><span class="main"><span class="keyword3">,</span></span> <span class="operator">clarify</span><span class="main"><span class="keyword3">,</span></span> <span class="operator">case_tac</span> <span class="quoted"><span class="quoted">"<span class="improper">i</span> <span class="main">=</span> <span class="improper">j</span>"</span></span><span class="main"><span class="keyword3">,</span></span> <span class="operator">simp</span><span class="main">)</span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> cSup_upper<span class="main"><span class="keyword3">,</span></span> <span class="operator">blast</span><span class="main"><span class="keyword3">,</span></span> <span class="operator">simp_all</span><span class="main">)</span> <span class="main">(</span><span class="operator">rule</span> cSup_upper2<span class="main"><span class="keyword3">,</span></span> <span class="operator">auto</span><span class="main">)</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"<span class="main">‚à•</span>diag_mat <span class="free">f</span><span class="keyword1">‚à•<span class="hidden">‚á©</span><sub>m</sub><span class="hidden">‚á©</span><sub>a</sub><span class="hidden">‚á©</span><sub>x</sub></span> <span class="main">‚â§</span> <span class="main">‚à•</span>diag_mat <span class="free">f</span><span class="keyword1">‚à•<span class="hidden">‚á©</span><sub>o</sub><span class="hidden">‚á©</span><sub>p</sub></span>"</span></span>
    <span class="keyword1"><span class="command">unfolding</span></span> op_norm_diag_mat_eq max_norm_def
    <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">subst</span> cSup_eq_Max<span class="main"><span class="main">[</span></span><span class="operator">symmetric</span><span class="main"><span class="main">]</span></span><span class="main"><span class="keyword3">,</span></span> <span class="operator">simp</span> <span class="quasi_keyword">only</span><span class="main"><span class="main">:</span></span> finite_image_of_finite2<span class="main"><span class="keyword3">,</span></span> <span class="operator">blast</span><span class="main">)</span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">subst</span> cSup_eq_Max<span class="main"><span class="main">[</span></span><span class="operator">symmetric</span><span class="main"><span class="main">]</span></span><span class="main"><span class="keyword3">,</span></span> <span class="operator">simp</span><span class="main"><span class="keyword3">,</span></span> <span class="operator">blast</span><span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>


<span class="keyword2"><span class="keyword">end</span></span></pre>
</div><div id="SQ_MTX">
<div class="head">
<h1>Theory SQ_MTX</h1>
</div>
<pre class="source"><span class="comment1">(*  Title:       Square Matrices
    Author:      Jonathan Juli√°n Huerta y Munive, 2020
    Maintainer:  Jonathan Juli√°n Huerta y Munive &lt;jonjulian23@gmail.com&gt;
*)</span>

<span class="keyword1"><span class="command">section</span></span> <span class="quoted"><span class="plain_text">‚Äπ Square Matrices ‚Ä∫</span></span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‚Äπ The general solution for affine systems of ODEs involves the exponential function. 
Unfortunately, this operation is only available in Isabelle for the type class ``banach''. 
Hence, we define a type of square matrices and prove that it is an instance of this class. ‚Ä∫</span></span>

<span class="keyword1"><span class="command">theory</span></span> SQ_MTX
  <span class="keyword2"><span class="keyword">imports</span></span> <a href="MTX_Norms.html">MTX_Norms</a>

<span class="keyword2"><span class="keyword">begin</span></span>

<span class="keyword1"><span class="command">subsection</span></span> <span class="quoted"><span class="plain_text">‚Äπ Definition ‚Ä∫</span></span>

<span class="keyword1"><span class="command">typedef</span></span> <span class="tfree">'m</span> sq_mtx <span class="main">=</span> <span class="quoted"><span class="quoted">"UNIV<span class="main">::</span><span class="main">(</span>real<span class="main">^</span><span class="tfree">'m</span><span class="main">^</span><span class="tfree">'m</span><span class="main">)</span> set"</span></span>
  <span class="keyword2"><span class="keyword">morphisms</span></span> to_vec to_mtx <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>

<span class="keyword1"><span class="command">declare</span></span> to_mtx_inverse <span class="main">[</span><span class="operator">simp</span><span class="main">]</span>
    <span class="keyword2"><span class="keyword">and</span></span> to_vec_inverse <span class="main">[</span><span class="operator">simp</span><span class="main">]</span>

<span class="keyword1"><span class="command">setup_lifting</span></span> type_definition_sq_mtx

<span class="keyword1"><span class="command">lift_definition</span></span> sq_mtx_ith <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'m</span> sq_mtx <span class="main">‚áí</span> <span class="tfree">'m</span> <span class="main">‚áí</span> <span class="main">(</span>real<span class="main">^</span><span class="tfree">'m</span><span class="main">)</span>"</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">infixl</span></span> <span class="quoted">"<span class="keyword1">$$</span>"</span> 90<span class="main">)</span> <span class="keyword2"><span class="keyword">is</span></span> <span class="quoted"><span class="quoted">"<span class="main">($)</span>"</span></span> <span class="keyword1"><span class="command">.</span></span>

<span class="keyword1"><span class="command">lift_definition</span></span> sq_mtx_vec_mult <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'m</span> sq_mtx <span class="main">‚áí</span> <span class="main">(</span>real<span class="main">^</span><span class="tfree">'m</span><span class="main">)</span> <span class="main">‚áí</span> <span class="main">(</span>real<span class="main">^</span><span class="tfree">'m</span><span class="main">)</span>"</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">infixl</span></span> <span class="quoted">"<span class="keyword1">*<span class="hidden">‚á©</span><sub>V</sub></span>"</span> 90<span class="main">)</span> <span class="keyword2"><span class="keyword">is</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">(*v)</span>"</span></span> <span class="keyword1"><span class="command">.</span></span>

<span class="keyword1"><span class="command">lift_definition</span></span> vec_sq_mtx_prod <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="main">(</span>real<span class="main">^</span><span class="tfree">'m</span><span class="main">)</span> <span class="main">‚áí</span> <span class="tfree">'m</span> sq_mtx <span class="main">‚áí</span> <span class="main">(</span>real<span class="main">^</span><span class="tfree">'m</span><span class="main">)</span>"</span></span> <span class="keyword2"><span class="keyword">is</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">(v*)</span>"</span></span> <span class="keyword1"><span class="command">.</span></span>

<span class="keyword1"><span class="command">lift_definition</span></span> sq_mtx_diag <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">(</span><span class="tfree">'m</span><span class="main">::</span>finite<span class="main">)</span> <span class="main">‚áí</span> real<span class="main">)</span> <span class="main">‚áí</span> <span class="main">(</span><span class="tfree">'m</span><span class="main">::</span>finite<span class="main">)</span> sq_mtx"</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">binder</span></span> <span class="quoted">"<span class="keyword1">ùñΩùóÇùñ∫ùóÄ</span> "</span> 10<span class="main">)</span> 
  <span class="keyword2"><span class="keyword">is</span></span> <span class="quoted">diag_mat</span> <span class="keyword1"><span class="command">.</span></span>

<span class="keyword1"><span class="command">lift_definition</span></span> sq_mtx_transpose <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="tfree">'m</span><span class="main">::</span>finite<span class="main">)</span> sq_mtx <span class="main">‚áí</span> <span class="tfree">'m</span> sq_mtx"</span></span> <span class="main">(</span><span class="quoted">"_<span class="keyword1"><span class="hidden">‚áß</span><sup>‚Ä†</sup></span>"</span><span class="main">)</span> <span class="keyword2"><span class="keyword">is</span></span> <span class="quoted">transpose</span> <span class="keyword1"><span class="command">.</span></span>

<span class="keyword1"><span class="command">lift_definition</span></span> sq_mtx_inv <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="tfree">'m</span><span class="main">::</span>finite<span class="main">)</span> sq_mtx <span class="main">‚áí</span> <span class="tfree">'m</span> sq_mtx"</span></span> <span class="main">(</span><span class="quoted">"_<span class="keyword1"><span class="hidden">‚áß</span><sup>-</sup><span class="hidden">‚áß</span><sup>1</sup></span>"</span> <span class="main">[</span>90<span class="main">]</span><span class="main">)</span> <span class="keyword2"><span class="keyword">is</span></span> <span class="quoted">matrix_inv</span> <span class="keyword1"><span class="command">.</span></span>

<span class="keyword1"><span class="command">lift_definition</span></span> sq_mtx_row <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'m</span> <span class="main">‚áí</span> <span class="main">(</span><span class="tfree">'m</span><span class="main">::</span>finite<span class="main">)</span> sq_mtx <span class="main">‚áí</span> real<span class="main">^</span><span class="tfree">'m</span>"</span></span> <span class="main">(</span><span class="quoted">"<span class="keyword1">ùóãùóàùóê</span>"</span><span class="main">)</span> <span class="keyword2"><span class="keyword">is</span></span> <span class="quoted">row</span> <span class="keyword1"><span class="command">.</span></span>

<span class="keyword1"><span class="command">lift_definition</span></span> sq_mtx_col <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'m</span> <span class="main">‚áí</span> <span class="main">(</span><span class="tfree">'m</span><span class="main">::</span>finite<span class="main">)</span> sq_mtx <span class="main">‚áí</span> real<span class="main">^</span><span class="tfree">'m</span>"</span></span> <span class="main">(</span><span class="quoted">"<span class="keyword1">ùñºùóàùóÖ</span>"</span><span class="main">)</span>  <span class="keyword2"><span class="keyword">is</span></span> <span class="quoted">column</span> <span class="keyword1"><span class="command">.</span></span>

<span class="keyword1"><span class="command">lemma</span></span> to_vec_eq_ith<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span>to_vec <span class="free">A</span><span class="main">)</span> <span class="main">$</span> <span class="free">i</span> <span class="main">=</span> <span class="free">A</span> <span class="main">$$</span> <span class="free">i</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="operator">transfer</span> <span class="operator">simp</span>

<span class="keyword1"><span class="command">lemma</span></span> to_mtx_ith<span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> 
  <span class="quoted"><span class="quoted">"<span class="main">(</span>to_mtx <span class="free">A</span><span class="main">)</span> <span class="main">$$</span> <span class="free">i1</span> <span class="main">=</span> <span class="free">A</span> <span class="main">$</span> <span class="free">i1</span>"</span></span>
  <span class="quoted"><span class="quoted">"<span class="main">(</span>to_mtx <span class="free">A</span><span class="main">)</span> <span class="main">$$</span> <span class="free">i1</span> <span class="main">$</span> <span class="free">i2</span> <span class="main">=</span> <span class="free">A</span> <span class="main">$</span> <span class="free">i1</span> <span class="main">$</span> <span class="free">i2</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">transfer</span><span class="main"><span class="keyword3">,</span></span> <span class="operator">simp</span><span class="main">)</span><span class="main"><span class="keyword3">+</span></span>

<span class="keyword1"><span class="command">lemma</span></span> to_mtx_vec_lambda_ith<span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"to_mtx <span class="main">(</span><span class="keyword1">œá</span> <span class="bound">i</span> <span class="bound">j</span><span class="main">.</span> <span class="free">x</span> <span class="bound">i</span> <span class="bound">j</span><span class="main">)</span> <span class="main">$$</span> <span class="free">i1</span> <span class="main">$</span> <span class="free">i2</span> <span class="main">=</span> <span class="free">x</span> <span class="free">i1</span> <span class="free">i2</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> sq_mtx_ith_def<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> sq_mtx_eq_iff<span class="main">:</span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">A</span> <span class="main">=</span> <span class="free">B</span> <span class="main">=</span> <span class="main">(</span><span class="main">‚àÄ</span><span class="bound">i</span> <span class="bound">j</span><span class="main">.</span> <span class="free">A</span> <span class="main">$$</span> <span class="bound">i</span> <span class="main">$</span> <span class="bound">j</span> <span class="main">=</span> <span class="free">B</span> <span class="main">$$</span> <span class="bound">i</span> <span class="main">$</span> <span class="bound">j</span><span class="main">)</span>"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">A</span> <span class="main">=</span> <span class="free">B</span> <span class="main">=</span> <span class="main">(</span><span class="main">‚àÄ</span><span class="bound">i</span><span class="main">.</span> <span class="free">A</span> <span class="main">$$</span> <span class="bound">i</span> <span class="main">=</span> <span class="free">B</span> <span class="main">$$</span> <span class="bound">i</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">transfer</span><span class="main"><span class="keyword3">,</span></span> <span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> vec_eq_iff<span class="main">)</span><span class="main"><span class="keyword3">+</span></span>

<span class="keyword1"><span class="command">lemma</span></span> sq_mtx_diag_simps<span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span>
  <span class="quoted"><span class="quoted">"<span class="free">i</span> <span class="main">=</span> <span class="free">j</span> <span class="main">‚üπ</span> sq_mtx_diag <span class="free">f</span> <span class="main">$$</span> <span class="free">i</span> <span class="main">$</span> <span class="free">j</span> <span class="main">=</span> <span class="free">f</span> <span class="free">i</span>"</span></span>
  <span class="quoted"><span class="quoted">"<span class="free">i</span> <span class="main">‚â†</span> <span class="free">j</span> <span class="main">‚üπ</span> sq_mtx_diag <span class="free">f</span> <span class="main">$$</span> <span class="free">i</span> <span class="main">$</span> <span class="free">j</span> <span class="main">=</span> <span class="main">0</span>"</span></span>
  <span class="quoted"><span class="quoted">"sq_mtx_diag <span class="free">f</span> <span class="main">$$</span> <span class="free">i</span> <span class="main">=</span> axis <span class="free">i</span> <span class="main">(</span><span class="free">f</span> <span class="free">i</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">unfolding</span></span> sq_mtx_diag_def <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp_all</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> axis_def vec_eq_iff<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> sq_mtx_diag_vec_mult<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="keyword1">ùñΩùóÇùñ∫ùóÄ</span> <span class="bound">i</span><span class="main">.</span> <span class="free">f</span> <span class="bound">i</span><span class="main">)</span> <span class="keyword1">*<span class="hidden">‚á©</span><sub>V</sub></span> <span class="free">s</span> <span class="main">=</span> <span class="main">(</span><span class="keyword1">œá</span> <span class="bound">i</span><span class="main">.</span> <span class="free">f</span> <span class="bound">i</span> <span class="main">*</span> <span class="free">s</span><span class="main">$</span><span class="bound">i</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> matrix_vector_mul_diag_mat sq_mtx_diag.abs_eq sq_mtx_vec_mult.abs_eq<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> sq_mtx_vec_mult_diag_axis<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="keyword1">ùñΩùóÇùñ∫ùóÄ</span> <span class="bound">i</span><span class="main">.</span> <span class="free">f</span> <span class="bound">i</span><span class="main">)</span> <span class="keyword1">*<span class="hidden">‚á©</span><sub>V</sub></span> <span class="main">(</span>axis <span class="free">i</span> <span class="free">k</span><span class="main">)</span> <span class="main">=</span> axis <span class="free">i</span> <span class="main">(</span><span class="free">f</span> <span class="free">i</span> <span class="main">*</span> <span class="free">k</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">unfolding</span></span> sq_mtx_diag_vec_mult axis_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">lemma</span></span> sq_mtx_vec_mult_eq<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">m</span> <span class="keyword1">*<span class="hidden">‚á©</span><sub>V</sub></span> <span class="free">x</span> <span class="main">=</span> <span class="main">(</span><span class="keyword1">œá</span> <span class="bound">i</span><span class="main">.</span> sum <span class="main">(</span><span class="main">Œª</span><span class="bound">j</span><span class="main">.</span> <span class="main">(</span><span class="free">m</span> <span class="main">$$</span> <span class="bound">i</span> <span class="main">$</span> <span class="bound">j</span><span class="main">)</span> <span class="main">*</span> <span class="main">(</span><span class="free">x</span> <span class="main">$</span> <span class="bound">j</span><span class="main">)</span><span class="main">)</span> UNIV<span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">transfer</span><span class="main"><span class="keyword3">,</span></span> <span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> matrix_vector_mult_def<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> sq_mtx_transpose_transpose<span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">A</span><span class="main"><span class="hidden">‚áß</span><sup>‚Ä†</sup></span><span class="main">)</span><span class="main"><span class="hidden">‚áß</span><sup>‚Ä†</sup></span> <span class="main">=</span> <span class="free">A</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">transfer</span><span class="main"><span class="keyword3">,</span></span> <span class="operator">simp</span><span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> transpose_mult_vec_canon_row<span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">A</span><span class="main"><span class="hidden">‚áß</span><sup>‚Ä†</sup></span><span class="main">)</span> <span class="keyword1">*<span class="hidden">‚á©</span><sub>V</sub></span> <span class="main">(</span>ùñæ <span class="free">i</span><span class="main">)</span> <span class="main">=</span> <span class="keyword1">ùóãùóàùóê</span> <span class="free">i</span> <span class="free">A</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="operator">transfer</span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> row_def transpose_def axis_def matrix_vector_mult_def<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> row_ith<span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="keyword1">ùóãùóàùóê</span> <span class="free">i</span> <span class="free">A</span> <span class="main">=</span> <span class="free">A</span> <span class="main">$$</span> <span class="free">i</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="operator">transfer</span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> row_def<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> mtx_vec_mult_canon<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">A</span> <span class="keyword1">*<span class="hidden">‚á©</span><sub>V</sub></span> <span class="main">(</span>ùñæ <span class="free">i</span><span class="main">)</span> <span class="main">=</span> <span class="keyword1">ùñºùóàùóÖ</span> <span class="free">i</span> <span class="free">A</span>"</span></span> 
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">transfer</span><span class="main"><span class="keyword3">,</span></span> <span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> matrix_vector_mult_basis<span class="main">)</span>


<span class="keyword1"><span class="command">subsection</span></span> <span class="quoted"><span class="plain_text">‚Äπ Ring of square matrices ‚Ä∫</span></span>

<span class="keyword1"><span class="command">instantiation</span></span> sq_mtx <span class="main">::</span> <span class="main">(</span><span class="quoted">finite</span><span class="main">)</span> <span class="quoted">ring</span> 
<span class="keyword2"><span class="keyword">begin</span></span>

<span class="keyword1"><span class="command">lift_definition</span></span> <span class="class_parameter">plus_sq_mtx</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'a</span> sq_mtx <span class="main">‚áí</span> <span class="tfree">'a</span> sq_mtx <span class="main">‚áí</span> <span class="tfree">'a</span> sq_mtx"</span></span> <span class="keyword2"><span class="keyword">is</span></span> <span class="quoted"><span class="quoted">"<span class="main">(+)</span>"</span></span> <span class="keyword1"><span class="command">.</span></span>

<span class="keyword1"><span class="command">lift_definition</span></span> <span class="class_parameter">zero_sq_mtx</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'a</span> sq_mtx"</span></span> <span class="keyword2"><span class="keyword">is</span></span> <span class="quoted"><span class="quoted">"<span class="main">0</span>"</span></span> <span class="keyword1"><span class="command">.</span></span>

<span class="keyword1"><span class="command">lift_definition</span></span> <span class="class_parameter">uminus_sq_mtx</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'a</span> sq_mtx <span class="main">‚áí</span> <span class="tfree">'a</span> sq_mtx"</span></span> <span class="keyword2"><span class="keyword">is</span></span> <span class="quoted"><span class="quoted">"uminus"</span></span> <span class="keyword1"><span class="command">.</span></span>

<span class="keyword1"><span class="command">lift_definition</span></span> <span class="class_parameter">minus_sq_mtx</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'a</span> sq_mtx <span class="main">‚áí</span> <span class="tfree">'a</span> sq_mtx <span class="main">‚áí</span> <span class="tfree">'a</span> sq_mtx"</span></span> <span class="keyword2"><span class="keyword">is</span></span> <span class="quoted"><span class="quoted">"<span class="main">(-)</span>"</span></span> <span class="keyword1"><span class="command">.</span></span>

<span class="keyword1"><span class="command">lift_definition</span></span> <span class="class_parameter">times_sq_mtx</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'a</span> sq_mtx <span class="main">‚áí</span> <span class="tfree">'a</span> sq_mtx <span class="main">‚áí</span> <span class="tfree">'a</span> sq_mtx"</span></span> <span class="keyword2"><span class="keyword">is</span></span> <span class="quoted"><span class="quoted">"<span class="main">(**)</span>"</span></span> <span class="keyword1"><span class="command">.</span></span>

<span class="keyword1"><span class="command">declare</span></span> plus_sq_mtx.rep_eq <span class="main">[</span><span class="operator">simp</span><span class="main">]</span>
    <span class="keyword2"><span class="keyword">and</span></span> minus_sq_mtx.rep_eq <span class="main">[</span><span class="operator">simp</span><span class="main">]</span>

<span class="keyword1"><span class="command">instance</span></span> <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="operator">intro_classes</span>
  <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">transfer</span><span class="main"><span class="keyword3">,</span></span> <span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> <span class="dynamic"><span class="dynamic">algebra_simps</span></span> matrix_mul_assoc matrix_add_rdistrib matrix_add_ldistrib<span class="main">)</span><span class="main"><span class="keyword3">+</span></span>

<span class="keyword2"><span class="keyword">end</span></span>

<span class="keyword1"><span class="command">lemma</span></span> sq_mtx_zero_ith<span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">0</span> <span class="main">$$</span> <span class="free">i</span> <span class="main">=</span> <span class="main">0</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">transfer</span><span class="main"><span class="keyword3">,</span></span> <span class="operator">simp</span><span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> sq_mtx_zero_nth<span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">0</span> <span class="main">$$</span> <span class="free">i</span> <span class="main">$</span> <span class="free">j</span> <span class="main">=</span> <span class="main">0</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="operator">transfer</span> <span class="operator">simp</span>

<span class="keyword1"><span class="command">lemma</span></span> sq_mtx_plus_eq<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">A</span> <span class="main">+</span> <span class="free">B</span> <span class="main">=</span> to_mtx <span class="main">(</span><span class="keyword1">œá</span> <span class="bound">i</span> <span class="bound">j</span><span class="main">.</span> <span class="free">A</span><span class="main">$$</span><span class="bound">i</span><span class="main">$</span><span class="bound">j</span> <span class="main">+</span> <span class="free">B</span><span class="main">$$</span><span class="bound">i</span><span class="main">$</span><span class="bound">j</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="operator">transfer</span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> vec_eq_iff<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> sq_mtx_plus_ith<span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span><span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">A</span> <span class="main">+</span> <span class="free">B</span><span class="main">)</span> <span class="main">$$</span> <span class="free">i</span> <span class="main">=</span> <span class="free">A</span> <span class="main">$$</span> <span class="free">i</span> <span class="main">+</span> <span class="free">B</span> <span class="main">$$</span> <span class="free">i</span>"</span></span>
  <span class="keyword1"><span class="command">unfolding</span></span> sq_mtx_plus_eq <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> vec_eq_iff<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> sq_mtx_uminus_eq<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">-</span> <span class="free">A</span> <span class="main">=</span> to_mtx <span class="main">(</span><span class="keyword1">œá</span> <span class="bound">i</span> <span class="bound">j</span><span class="main">.</span> <span class="main">-</span> <span class="free">A</span><span class="main">$$</span><span class="bound">i</span><span class="main">$</span><span class="bound">j</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="operator">transfer</span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> vec_eq_iff<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> sq_mtx_minus_eq<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">A</span> <span class="main">-</span> <span class="free">B</span> <span class="main">=</span> to_mtx <span class="main">(</span><span class="keyword1">œá</span> <span class="bound">i</span> <span class="bound">j</span><span class="main">.</span> <span class="free">A</span><span class="main">$$</span><span class="bound">i</span><span class="main">$</span><span class="bound">j</span> <span class="main">-</span> <span class="free">B</span><span class="main">$$</span><span class="bound">i</span><span class="main">$</span><span class="bound">j</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="operator">transfer</span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> vec_eq_iff<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> sq_mtx_minus_ith<span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span><span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">A</span> <span class="main">-</span> <span class="free">B</span><span class="main">)</span> <span class="main">$$</span> <span class="free">i</span> <span class="main">=</span> <span class="free">A</span> <span class="main">$$</span> <span class="free">i</span> <span class="main">-</span> <span class="free">B</span> <span class="main">$$</span> <span class="free">i</span>"</span></span>
  <span class="keyword1"><span class="command">unfolding</span></span> sq_mtx_minus_eq <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> vec_eq_iff<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> sq_mtx_times_eq<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">A</span> <span class="main">*</span> <span class="free">B</span> <span class="main">=</span> to_mtx <span class="main">(</span><span class="keyword1">œá</span> <span class="bound">i</span> <span class="bound">j</span><span class="main">.</span> sum <span class="main">(</span><span class="main">Œª</span><span class="bound">k</span><span class="main">.</span> <span class="free">A</span><span class="main">$$</span><span class="bound">i</span><span class="main">$</span><span class="bound">k</span> <span class="main">*</span> <span class="free">B</span><span class="main">$$</span><span class="bound">k</span><span class="main">$</span><span class="bound">j</span><span class="main">)</span> UNIV<span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="operator">transfer</span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> matrix_matrix_mult_def<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> sq_mtx_plus_diag_diag<span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"sq_mtx_diag <span class="free">f</span> <span class="main">+</span> sq_mtx_diag <span class="free">g</span> <span class="main">=</span> <span class="main">(</span><span class="keyword1">ùñΩùóÇùñ∫ùóÄ</span> <span class="bound">i</span><span class="main">.</span> <span class="free">f</span> <span class="bound">i</span> <span class="main">+</span> <span class="free">g</span> <span class="bound">i</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">subst</span> sq_mtx_eq_iff<span class="main">)</span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> axis_def<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> sq_mtx_minus_diag_diag<span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"sq_mtx_diag <span class="free">f</span> <span class="main">-</span> sq_mtx_diag <span class="free">g</span> <span class="main">=</span> <span class="main">(</span><span class="keyword1">ùñΩùóÇùñ∫ùóÄ</span> <span class="bound">i</span><span class="main">.</span> <span class="free">f</span> <span class="bound">i</span> <span class="main">-</span> <span class="free">g</span> <span class="bound">i</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">subst</span> sq_mtx_eq_iff<span class="main">)</span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> axis_def<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> sum_sq_mtx_diag<span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">‚àë</span><span class="bound">n</span><span class="main">&lt;</span><span class="free">m</span><span class="main">.</span> sq_mtx_diag <span class="main">(</span><span class="free">g</span> <span class="bound">n</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="keyword1">ùñΩùóÇùñ∫ùóÄ</span> <span class="bound">i</span><span class="main">.</span> <span class="main">‚àë</span><span class="bound">n</span><span class="main">&lt;</span><span class="free">m</span><span class="main">.</span> <span class="main">(</span><span class="free">g</span> <span class="bound">n</span> <span class="bound">i</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword2"><span class="keyword">for</span></span> <span class="free">m</span><span class="main">::</span><span class="quoted">nat</span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">induct</span> <span class="quoted"><span class="free">m</span></span><span class="main"><span class="keyword3">,</span></span> <span class="operator">simp</span><span class="main"><span class="keyword3">,</span></span> <span class="operator">subst</span> sq_mtx_eq_iff<span class="main"><span class="keyword3">,</span></span> <span class="operator">simp_all</span><span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> sq_mtx_mult_diag_diag<span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"sq_mtx_diag <span class="free">f</span> <span class="main">*</span> sq_mtx_diag <span class="free">g</span> <span class="main">=</span> <span class="main">(</span><span class="keyword1">ùñΩùóÇùñ∫ùóÄ</span> <span class="bound">i</span><span class="main">.</span> <span class="free">f</span> <span class="bound">i</span> <span class="main">*</span> <span class="free">g</span> <span class="bound">i</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> matrix_mul_diag_diag sq_mtx_diag.abs_eq times_sq_mtx.abs_eq<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> sq_mtx_mult_diagl<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="keyword1">ùñΩùóÇùñ∫ùóÄ</span> <span class="bound">i</span><span class="main">.</span> <span class="free">f</span> <span class="bound">i</span><span class="main">)</span> <span class="main">*</span> <span class="free">A</span> <span class="main">=</span> to_mtx <span class="main">(</span><span class="keyword1">œá</span> <span class="bound">i</span> <span class="bound">j</span><span class="main">.</span> <span class="free">f</span> <span class="bound">i</span> <span class="main">*</span> <span class="free">A</span> <span class="main">$$</span> <span class="bound">i</span> <span class="main">$</span> <span class="bound">j</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="operator">transfer</span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> matrix_mul_diag_matl<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> sq_mtx_mult_diagr<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">A</span> <span class="main">*</span> <span class="main">(</span><span class="keyword1">ùñΩùóÇùñ∫ùóÄ</span> <span class="bound">i</span><span class="main">.</span> <span class="free">f</span> <span class="bound">i</span><span class="main">)</span> <span class="main">=</span> to_mtx <span class="main">(</span><span class="keyword1">œá</span> <span class="bound">i</span> <span class="bound">j</span><span class="main">.</span> <span class="free">A</span> <span class="main">$$</span> <span class="bound">i</span> <span class="main">$</span> <span class="bound">j</span> <span class="main">*</span> <span class="free">f</span> <span class="bound">j</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="operator">transfer</span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> matrix_matrix_mul_diag_matr<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> mtx_vec_mult_0l<span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">0</span> <span class="keyword1">*<span class="hidden">‚á©</span><sub>V</sub></span> <span class="free">x</span> <span class="main">=</span> <span class="main">0</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> sq_mtx_vec_mult.abs_eq zero_sq_mtx_def<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> mtx_vec_mult_0r<span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">A</span> <span class="keyword1">*<span class="hidden">‚á©</span><sub>V</sub></span> <span class="main">0</span> <span class="main">=</span> <span class="main">0</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">transfer</span><span class="main"><span class="keyword3">,</span></span> <span class="operator">simp</span><span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> mtx_vec_mult_add_rdistr<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">A</span> <span class="main">+</span> <span class="free">B</span><span class="main">)</span> <span class="keyword1">*<span class="hidden">‚á©</span><sub>V</sub></span> <span class="free">x</span> <span class="main">=</span> <span class="free">A</span> <span class="keyword1">*<span class="hidden">‚á©</span><sub>V</sub></span> <span class="free">x</span> <span class="main">+</span> <span class="free">B</span> <span class="keyword1">*<span class="hidden">‚á©</span><sub>V</sub></span> <span class="free">x</span>"</span></span>
  <span class="keyword1"><span class="command">unfolding</span></span> plus_sq_mtx_def 
  <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="main">(</span><span class="operator">transfer</span><span class="main">)</span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> matrix_vector_mult_add_rdistrib<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> mtx_vec_mult_add_rdistl<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">A</span> <span class="keyword1">*<span class="hidden">‚á©</span><sub>V</sub></span> <span class="main">(</span><span class="free">x</span> <span class="main">+</span> <span class="free">y</span><span class="main">)</span> <span class="main">=</span> <span class="free">A</span> <span class="keyword1">*<span class="hidden">‚á©</span><sub>V</sub></span> <span class="free">x</span> <span class="main">+</span> <span class="free">A</span> <span class="keyword1">*<span class="hidden">‚á©</span><sub>V</sub></span> <span class="free">y</span>"</span></span>
  <span class="keyword1"><span class="command">unfolding</span></span> plus_sq_mtx_def 
  <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="operator">transfer</span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> matrix_vector_right_distrib<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> mtx_vec_mult_minus_rdistrib<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">A</span> <span class="main">-</span> <span class="free">B</span><span class="main">)</span> <span class="keyword1">*<span class="hidden">‚á©</span><sub>V</sub></span> <span class="free">x</span> <span class="main">=</span> <span class="free">A</span> <span class="keyword1">*<span class="hidden">‚á©</span><sub>V</sub></span> <span class="free">x</span> <span class="main">-</span> <span class="free">B</span> <span class="keyword1">*<span class="hidden">‚á©</span><sub>V</sub></span> <span class="free">x</span>"</span></span>
  <span class="keyword1"><span class="command">unfolding</span></span> minus_sq_mtx_def <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">transfer</span><span class="main"><span class="keyword3">,</span></span> <span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> matrix_vector_mult_diff_rdistrib<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> mtx_vec_mult_minus_ldistrib<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">A</span> <span class="keyword1">*<span class="hidden">‚á©</span><sub>V</sub></span> <span class="main">(</span><span class="free">x</span> <span class="main">-</span> <span class="free">y</span><span class="main">)</span> <span class="main">=</span>  <span class="free">A</span> <span class="keyword1">*<span class="hidden">‚á©</span><sub>V</sub></span> <span class="free">x</span> <span class="main">-</span>  <span class="free">A</span> <span class="keyword1">*<span class="hidden">‚á©</span><sub>V</sub></span> <span class="free">y</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> <span class="main"><span class="main">(</span></span>no_types<span class="main"><span class="main">,</span></span> lifting<span class="main"><span class="main">)</span></span> add_diff_cancel diff_add_cancel 
      matrix_vector_right_distrib sq_mtx_vec_mult.rep_eq<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> sq_mtx_times_vec_assoc<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">A</span> <span class="main">*</span> <span class="free">B</span><span class="main">)</span> <span class="keyword1">*<span class="hidden">‚á©</span><sub>V</sub></span> <span class="free">x</span> <span class="main">=</span> <span class="free">A</span> <span class="keyword1">*<span class="hidden">‚á©</span><sub>V</sub></span> <span class="main">(</span><span class="free">B</span> <span class="keyword1">*<span class="hidden">‚á©</span><sub>V</sub></span> <span class="free">x</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">transfer</span><span class="main"><span class="keyword3">,</span></span> <span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> matrix_vector_mul_assoc<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> sq_mtx_vec_mult_sum_cols<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">A</span> <span class="keyword1">*<span class="hidden">‚á©</span><sub>V</sub></span> <span class="free">x</span> <span class="main">=</span> sum <span class="main">(</span><span class="main">Œª</span><span class="bound">i</span><span class="main">.</span> <span class="free">x</span> <span class="main">$</span> <span class="bound">i</span> <span class="keyword1">*<span class="hidden">‚á©</span><sub>R</sub></span> <span class="keyword1">ùñºùóàùóÖ</span> <span class="bound">i</span> <span class="free">A</span><span class="main">)</span> UNIV"</span></span>
  <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">transfer</span><span class="main">)</span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> matrix_mult_sum scalar_mult_eq_scaleR<span class="main">)</span>


<span class="keyword1"><span class="command">subsection</span></span> <span class="quoted"><span class="plain_text">‚Äπ Real normed vector space of square matrices ‚Ä∫</span></span>

<span class="keyword1"><span class="command">instantiation</span></span> sq_mtx <span class="main">::</span> <span class="main">(</span><span class="quoted">finite</span><span class="main">)</span> <span class="quoted">real_normed_vector</span> 
<span class="keyword2"><span class="keyword">begin</span></span>

<span class="keyword1"><span class="command">definition</span></span> <span class="entity"><span class="class_parameter">norm_sq_mtx</span></span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'a</span> sq_mtx <span class="main">‚áí</span> real"</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="main">‚à•</span><span class="free"><span class="bound"><span class="entity">A</span></span></span><span class="main">‚à•</span> <span class="main">=</span> <span class="main">‚à•</span>to_vec <span class="free"><span class="bound"><span class="entity">A</span></span></span><span class="keyword1">‚à•<span class="hidden">‚á©</span><sub>o</sub><span class="hidden">‚á©</span><sub>p</sub></span>"</span></span>

<span class="keyword1"><span class="command">lift_definition</span></span> <span class="class_parameter">scaleR_sq_mtx</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"real <span class="main">‚áí</span> <span class="tfree">'a</span> sq_mtx <span class="main">‚áí</span> <span class="tfree">'a</span> sq_mtx"</span></span> <span class="keyword2"><span class="keyword">is</span></span> <span class="quoted">scaleR</span> <span class="keyword1"><span class="command">.</span></span>

<span class="keyword1"><span class="command">definition</span></span> <span class="entity"><span class="class_parameter">sgn_sq_mtx</span></span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'a</span> sq_mtx <span class="main">‚áí</span> <span class="tfree">'a</span> sq_mtx"</span></span> 
  <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="free">sgn_sq_mtx</span> <span class="free"><span class="bound"><span class="entity">A</span></span></span> <span class="main">=</span> <span class="main">(</span>inverse <span class="main">(</span><span class="main">‚à•</span><span class="free"><span class="bound"><span class="entity">A</span></span></span><span class="main">‚à•</span><span class="main">)</span><span class="main">)</span> <span class="keyword1">*<span class="hidden">‚á©</span><sub>R</sub></span> <span class="free"><span class="bound"><span class="entity">A</span></span></span>"</span></span>

<span class="keyword1"><span class="command">definition</span></span> <span class="entity"><span class="class_parameter">dist_sq_mtx</span></span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'a</span> sq_mtx <span class="main">‚áí</span> <span class="tfree">'a</span> sq_mtx <span class="main">‚áí</span> real"</span></span> 
  <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="free">dist_sq_mtx</span> <span class="free"><span class="bound"><span class="entity">A</span></span></span> <span class="free"><span class="bound"><span class="entity">B</span></span></span> <span class="main">=</span> <span class="main">‚à•</span><span class="free"><span class="bound"><span class="entity">A</span></span></span> <span class="main">-</span> <span class="free"><span class="bound"><span class="entity">B</span></span></span><span class="main">‚à•</span>"</span></span> 

<span class="keyword1"><span class="command">definition</span></span> <span class="entity"><span class="class_parameter">uniformity_sq_mtx</span></span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="tfree">'a</span> sq_mtx <span class="main">√ó</span> <span class="tfree">'a</span> sq_mtx<span class="main">)</span> filter"</span></span> 
  <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="free">uniformity_sq_mtx</span> <span class="main">=</span> <span class="main">(</span><span class="keyword1">INF</span> <span class="bound">e</span><span class="main">‚àà</span><span class="main">{</span><span class="main">0</span><span class="main">&lt;..}</span><span class="main">.</span> principal <span class="main">{</span><span class="main">(</span><span class="bound">x</span><span class="main">,</span> <span class="bound">y</span><span class="main">)</span><span class="main">.</span> dist <span class="bound">x</span> <span class="bound">y</span> <span class="main">&lt;</span> <span class="bound">e</span><span class="main">}</span><span class="main">)</span>"</span></span>

<span class="keyword1"><span class="command">definition</span></span> <span class="entity"><span class="class_parameter">open_sq_mtx</span></span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'a</span> sq_mtx set <span class="main">‚áí</span> bool"</span></span> 
  <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="free">open_sq_mtx</span> <span class="free"><span class="bound"><span class="entity">U</span></span></span> <span class="main">=</span> <span class="main">(</span><span class="main">‚àÄ</span><span class="bound">x</span><span class="main">‚àà</span><span class="free"><span class="bound"><span class="entity">U</span></span></span><span class="main">.</span> <span class="keyword1">‚àÄ<span class="hidden">‚á©</span><sub>F</sub></span> <span class="main">(</span><span class="bound">x'</span><span class="main">,</span> <span class="bound">y</span><span class="main">)</span> <span class="keyword1">in</span> uniformity<span class="main">.</span> <span class="bound">x'</span> <span class="main">=</span> <span class="bound">x</span> <span class="main">‚ü∂</span> <span class="bound">y</span> <span class="main">‚àà</span> <span class="free"><span class="bound"><span class="entity">U</span></span></span><span class="main">)</span>"</span></span>

<span class="keyword1"><span class="command">instance</span></span> <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="operator">intro_classes</span> 
  <span class="keyword1"><span class="command">unfolding</span></span> sgn_sq_mtx_def open_sq_mtx_def dist_sq_mtx_def uniformity_sq_mtx_def
            <span class="keyword1"><span class="command"><span class="improper"><span class="command">prefer</span></span></span></span> 10 
            <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="main">(</span><span class="operator">transfer</span><span class="main"><span class="keyword3">,</span></span> <span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> norm_sq_mtx_def op_norm_triangle<span class="main">)</span>
           <span class="keyword1"><span class="command"><span class="improper"><span class="command">prefer</span></span></span></span> 9 
           <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="main">(</span><span class="operator">simp_all</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> norm_sq_mtx_def zero_sq_mtx_def op_norm_eq_0<span class="main">)</span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">transfer</span><span class="main"><span class="keyword3">,</span></span> <span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> norm_sq_mtx_def op_norm_scaleR <span class="dynamic"><span class="dynamic">algebra_simps</span></span><span class="main">)</span><span class="main"><span class="keyword3">+</span></span>

<span class="keyword2"><span class="keyword">end</span></span>

<span class="keyword1"><span class="command">lemma</span></span> sq_mtx_scaleR_eq<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">c</span> <span class="keyword1">*<span class="hidden">‚á©</span><sub>R</sub></span> <span class="free">A</span> <span class="main">=</span> to_mtx <span class="main">(</span><span class="keyword1">œá</span> <span class="bound">i</span> <span class="bound">j</span><span class="main">.</span> <span class="free">c</span> <span class="keyword1">*<span class="hidden">‚á©</span><sub>R</sub></span> <span class="free">A</span> <span class="main">$$</span> <span class="bound">i</span> <span class="main">$</span> <span class="bound">j</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="operator">transfer</span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> vec_eq_iff<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> scaleR_to_mtx_ith<span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">c</span> <span class="keyword1">*<span class="hidden">‚á©</span><sub>R</sub></span> <span class="main">(</span>to_mtx <span class="free">A</span><span class="main">)</span> <span class="main">$$</span> <span class="free">i1</span> <span class="main">$</span> <span class="free">i2</span> <span class="main">=</span> <span class="free">c</span> <span class="main">*</span> <span class="free">A</span> <span class="main">$</span> <span class="free">i1</span> <span class="main">$</span> <span class="free">i2</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="operator">transfer</span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> scaleR_vec_def<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> sq_mtx_scaleR_ith<span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">c</span> <span class="keyword1">*<span class="hidden">‚á©</span><sub>R</sub></span> <span class="free">A</span><span class="main">)</span> <span class="main">$$</span> <span class="free">i</span> <span class="main">=</span> <span class="main">(</span><span class="free">c</span>  <span class="keyword1">*<span class="hidden">‚á©</span><sub>R</sub></span> <span class="main">(</span><span class="free">A</span> <span class="main">$$</span> <span class="free">i</span><span class="main">)</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">unfold</span> scaleR_sq_mtx_def<span class="main"><span class="keyword3">,</span></span> <span class="operator">transfer</span><span class="main"><span class="keyword3">,</span></span> <span class="operator">simp</span><span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> scaleR_sq_mtx_diag<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">c</span> <span class="keyword1">*<span class="hidden">‚á©</span><sub>R</sub></span> sq_mtx_diag <span class="free">f</span> <span class="main">=</span> <span class="main">(</span><span class="keyword1">ùñΩùóÇùñ∫ùóÄ</span> <span class="bound">i</span><span class="main">.</span> <span class="free">c</span> <span class="main">*</span> <span class="free">f</span> <span class="bound">i</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">subst</span> sq_mtx_eq_iff<span class="main"><span class="keyword3">,</span></span> <span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> axis_def<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> scaleR_mtx_vec_assoc<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">c</span> <span class="keyword1">*<span class="hidden">‚á©</span><sub>R</sub></span> <span class="free">A</span><span class="main">)</span> <span class="keyword1">*<span class="hidden">‚á©</span><sub>V</sub></span> <span class="free">x</span> <span class="main">=</span> <span class="free">c</span> <span class="keyword1">*<span class="hidden">‚á©</span><sub>R</sub></span> <span class="main">(</span><span class="free">A</span> <span class="keyword1">*<span class="hidden">‚á©</span><sub>V</sub></span> <span class="free">x</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">unfolding</span></span> scaleR_sq_mtx_def sq_mtx_vec_mult_def <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> scaleR_matrix_vector_assoc<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> mtx_vec_scaleR_commute<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">A</span> <span class="keyword1">*<span class="hidden">‚á©</span><sub>V</sub></span> <span class="main">(</span><span class="free">c</span> <span class="keyword1">*<span class="hidden">‚á©</span><sub>R</sub></span> <span class="free">x</span><span class="main">)</span> <span class="main">=</span> <span class="free">c</span> <span class="keyword1">*<span class="hidden">‚á©</span><sub>R</sub></span> <span class="main">(</span><span class="free">A</span> <span class="keyword1">*<span class="hidden">‚á©</span><sub>V</sub></span> <span class="free">x</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">unfolding</span></span> scaleR_sq_mtx_def sq_mtx_vec_mult_def <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="main">(</span><span class="operator">simp</span><span class="main"><span class="keyword3">,</span></span> <span class="operator">transfer</span><span class="main">)</span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> vector_scaleR_commute<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> mtx_times_scaleR_commute<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">A</span> <span class="main">*</span> <span class="main">(</span><span class="free">c</span> <span class="keyword1">*<span class="hidden">‚á©</span><sub>R</sub></span> <span class="free">B</span><span class="main">)</span> <span class="main">=</span> <span class="free">c</span> <span class="keyword1">*<span class="hidden">‚á©</span><sub>R</sub></span> <span class="main">(</span><span class="free">A</span> <span class="main">*</span> <span class="free">B</span><span class="main">)</span>"</span></span> <span class="keyword2"><span class="keyword">for</span></span> <span class="free">A</span><span class="main">::</span><span class="quoted"><span class="quoted">"<span class="main">(</span><span class="tfree">'n</span><span class="main">::</span>finite<span class="main">)</span> sq_mtx"</span></span>
  <span class="keyword1"><span class="command">unfolding</span></span> sq_mtx_scaleR_eq sq_mtx_times_eq 
  <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> to_mtx_inject<span class="main">)</span>
  <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> vec_eq_iff fun_eq_iff<span class="main">)</span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> semiring_normalization_rules<span class="main"><span class="main">(</span></span>19<span class="main"><span class="main">)</span></span> vector_space_over_itself.scale_sum_right<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> le_mtx_norm<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">m</span> <span class="main">‚àà</span> <span class="main">{</span><span class="main">‚à•</span><span class="free">A</span> <span class="keyword1">*<span class="hidden">‚á©</span><sub>V</sub></span> <span class="bound">x</span><span class="main">‚à•</span> <span class="main">|</span><span class="bound">x</span><span class="main">.</span> <span class="main">‚à•</span><span class="bound">x</span><span class="main">‚à•</span> <span class="main">=</span> <span class="main">1</span><span class="main">}</span> <span class="main">‚üπ</span> <span class="free">m</span> <span class="main">‚â§</span> <span class="main">‚à•</span><span class="free">A</span><span class="main">‚à•</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> cSup_upper<span class="main">[</span><span class="operator">of</span> <span class="main">_</span> <span class="quoted"><span class="quoted">"<span class="main">{</span><span class="main">‚à•</span><span class="main">(</span>to_vec <span class="free">A</span><span class="main">)</span> <span class="keyword1">*v</span> <span class="bound">x</span><span class="main">‚à•</span> <span class="main">|</span> <span class="bound">x</span><span class="main">.</span> <span class="main">‚à•</span><span class="bound">x</span><span class="main">‚à•</span> <span class="main">=</span> <span class="main">1</span><span class="main">}</span>"</span></span><span class="main">]</span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> op_norm_set_proptys<span class="main"><span class="main">(</span></span>2<span class="main"><span class="main">)</span></span> op_norm_def norm_sq_mtx_def sq_mtx_vec_mult.rep_eq<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> norm_vec_mult_le<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">‚à•</span><span class="free">A</span> <span class="keyword1">*<span class="hidden">‚á©</span><sub>V</sub></span> <span class="free">x</span><span class="main">‚à•</span> <span class="main">‚â§</span> <span class="main">(</span><span class="main">‚à•</span><span class="free">A</span><span class="main">‚à•</span><span class="main">)</span> <span class="main">*</span> <span class="main">(</span><span class="main">‚à•</span><span class="free">x</span><span class="main">‚à•</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> norm_matrix_le_mult_op_norm norm_sq_mtx_def sq_mtx_vec_mult.rep_eq<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> bounded_bilinear_sq_mtx_vec_mult<span class="main">:</span> <span class="quoted"><span class="quoted">"bounded_bilinear <span class="main">(</span><span class="main">Œª</span><span class="bound">A</span> <span class="bound">s</span><span class="main">.</span> <span class="bound">A</span> <span class="keyword1">*<span class="hidden">‚á©</span><sub>V</sub></span> <span class="bound">s</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">rule</span> bounded_bilinear.intro<span class="main"><span class="keyword3">,</span></span> <span class="operator">simp_all</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> mtx_vec_mult_add_rdistr 
      mtx_vec_mult_add_rdistl scaleR_mtx_vec_assoc mtx_vec_scaleR_commute<span class="main">)</span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule_tac</span> x<span class="main"><span class="main">=</span></span><span class="quoted"><span class="main">1</span></span> <span class="keyword2"><span class="keyword"><span class="quasi_keyword">in</span></span></span> exI<span class="main"><span class="keyword3">,</span></span> <span class="operator">auto</span> <span class="quasi_keyword">intro</span><span class="main"><span class="main">!</span></span><span class="main"><span class="main">:</span></span> norm_vec_mult_le<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> norm_sq_mtx_def2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">‚à•</span><span class="free">A</span><span class="main">‚à•</span> <span class="main">=</span> Sup <span class="main">{</span><span class="main">‚à•</span><span class="free">A</span> <span class="keyword1">*<span class="hidden">‚á©</span><sub>V</sub></span> <span class="bound">x</span><span class="main">‚à•</span> <span class="main">|</span><span class="bound">x</span><span class="main">.</span> <span class="main">‚à•</span><span class="bound">x</span><span class="main">‚à•</span> <span class="main">=</span> <span class="main">1</span><span class="main">}</span>"</span></span>
  <span class="keyword1"><span class="command">unfolding</span></span> norm_sq_mtx_def op_norm_def sq_mtx_vec_mult_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>

<span class="keyword1"><span class="command">lemma</span></span> norm_sq_mtx_def3<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">‚à•</span><span class="free">A</span><span class="main">‚à•</span> <span class="main">=</span> <span class="main">(</span><span class="keyword1">SUP</span> <span class="bound">x</span><span class="main">.</span> <span class="main">(</span><span class="main">‚à•</span><span class="free">A</span> <span class="keyword1">*<span class="hidden">‚á©</span><sub>V</sub></span> <span class="bound">x</span><span class="main">‚à•</span><span class="main">)</span> <span class="main">/</span> <span class="main">(</span><span class="main">‚à•</span><span class="bound">x</span><span class="main">‚à•</span><span class="main">)</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">unfolding</span></span> norm_sq_mtx_def onorm_def sq_mtx_vec_mult_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>

<span class="keyword1"><span class="command">lemma</span></span> norm_sq_mtx_diag<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">‚à•</span>sq_mtx_diag <span class="free">f</span><span class="main">‚à•</span> <span class="main">=</span> Max <span class="main">{</span><span class="main">¬¶</span><span class="free">f</span> <span class="bound">i</span><span class="main">¬¶</span> <span class="main">|</span><span class="bound">i</span><span class="main">.</span> <span class="bound">i</span> <span class="main">‚àà</span> UNIV<span class="main">}</span>"</span></span>
  <span class="keyword1"><span class="command">unfolding</span></span> norm_sq_mtx_def <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="operator">transfer</span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> op_norm_diag_mat_eq<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> sq_mtx_norm_le_sum_col<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">‚à•</span><span class="free">A</span><span class="main">‚à•</span> <span class="main">‚â§</span> <span class="main">(</span><span class="main">‚àë</span><span class="bound">i</span><span class="main">‚àà</span>UNIV<span class="main">.</span> <span class="main">‚à•</span><span class="keyword1">ùñºùóàùóÖ</span> <span class="bound">i</span> <span class="free">A</span><span class="main">‚à•</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> op_norm_le_sum_column<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="quoted">"to_vec <span class="free">A</span>"</span></span><span class="main">]</span> 
  <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> norm_sq_mtx_def<span class="main">)</span>
  <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">transfer</span><span class="main"><span class="keyword3">,</span></span> <span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> op_norm_le_sum_column<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> norm_le_transpose<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">‚à•</span><span class="free">A</span><span class="main">‚à•</span> <span class="main">‚â§</span> <span class="main">‚à•</span><span class="free">A</span><span class="main"><span class="hidden">‚áß</span><sup>‚Ä†</sup></span><span class="main">‚à•</span>"</span></span>
  <span class="keyword1"><span class="command">unfolding</span></span> norm_sq_mtx_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">transfer</span> <span class="main">(</span><span class="operator">rule</span> op_norm_le_transpose<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> norm_eq_norm_transpose<span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">‚à•</span><span class="free">A</span><span class="main"><span class="hidden">‚áß</span><sup>‚Ä†</sup></span><span class="main">‚à•</span> <span class="main">=</span> <span class="main">‚à•</span><span class="free">A</span><span class="main">‚à•</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> norm_le_transpose<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="free">A</span></span><span class="main">]</span> <span class="keyword2"><span class="keyword">and</span></span> norm_le_transpose<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="quoted">"<span class="free">A</span><span class="main"><span class="hidden">‚áß</span><sup>‚Ä†</sup></span>"</span></span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>

<span class="keyword1"><span class="command">lemma</span></span> norm_column_le_norm<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">‚à•</span><span class="free">A</span> <span class="main">$$</span> <span class="free">i</span><span class="main">‚à•</span> <span class="main">‚â§</span> <span class="main">‚à•</span><span class="free">A</span><span class="main">‚à•</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> norm_vec_mult_le<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="quoted">"<span class="free">A</span><span class="main"><span class="hidden">‚áß</span><sup>‚Ä†</sup></span>"</span></span> <span class="quoted"><span class="quoted">"ùñæ <span class="free">i</span>"</span></span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>


<span class="keyword1"><span class="command">subsection</span></span> <span class="quoted"><span class="plain_text">‚Äπ Real normed algebra of square matrices ‚Ä∫</span></span>

<span class="keyword1"><span class="command">instantiation</span></span> sq_mtx <span class="main">::</span> <span class="main">(</span><span class="quoted">finite</span><span class="main">)</span> <span class="quoted">real_normed_algebra_1</span>
<span class="keyword2"><span class="keyword">begin</span></span>

<span class="keyword1"><span class="command">lift_definition</span></span> <span class="class_parameter">one_sq_mtx</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'a</span> sq_mtx"</span></span> <span class="keyword2"><span class="keyword">is</span></span> <span class="quoted"><span class="quoted">"to_mtx <span class="main">(</span>mat <span class="main">1</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">.</span></span>

<span class="keyword1"><span class="command">lemma</span></span> sq_mtx_one_idty<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">1</span> <span class="main">*</span> <span class="free">A</span> <span class="main">=</span> <span class="free">A</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="free">A</span> <span class="main">*</span> <span class="main">1</span> <span class="main">=</span> <span class="free">A</span>"</span></span> <span class="keyword2"><span class="keyword">for</span></span> <span class="free">A</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'a</span> sq_mtx"</span></span>
  <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">transfer</span><span class="main"><span class="keyword3">,</span></span> <span class="operator">transfer</span><span class="main"><span class="keyword3">,</span></span> <span class="operator">unfold</span> mat_def matrix_matrix_mult_def<span class="main"><span class="keyword3">,</span></span> <span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> vec_eq_iff<span class="main">)</span><span class="main"><span class="keyword3">+</span></span>

<span class="keyword1"><span class="command">lemma</span></span> sq_mtx_norm_1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">‚à•</span><span class="main">(</span><span class="main">1</span><span class="main">::</span><span class="tfree">'a</span> sq_mtx<span class="main">)</span><span class="main">‚à•</span> <span class="main">=</span> <span class="main">1</span>"</span></span>
  <span class="keyword1"><span class="command">unfolding</span></span> one_sq_mtx_def norm_sq_mtx_def 
  <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> op_norm_def<span class="main">)</span>
  <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="main">(</span><span class="operator">subst</span> cSup_eq<span class="main"><span class="main">[</span></span><span class="operator">of</span> <span class="main"><span class="main">_</span></span> <span class="quoted"><span class="main"><span class="quoted"><span class="main">1</span></span></span></span><span class="main"><span class="main">]</span></span><span class="main">)</span>
  <span class="keyword1"><span class="command">using</span></span> ex_norm_eq_1 <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">lemma</span></span> sq_mtx_norm_times<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">‚à•</span><span class="free">A</span> <span class="main">*</span> <span class="free">B</span><span class="main">‚à•</span> <span class="main">‚â§</span> <span class="main">(</span><span class="main">‚à•</span><span class="free">A</span><span class="main">‚à•</span><span class="main">)</span> <span class="main">*</span> <span class="main">(</span><span class="main">‚à•</span><span class="free">B</span><span class="main">‚à•</span><span class="main">)</span>"</span></span> <span class="keyword2"><span class="keyword">for</span></span> <span class="free">A</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'a</span> sq_mtx"</span></span>
  <span class="keyword1"><span class="command">unfolding</span></span> norm_sq_mtx_def times_sq_mtx_def <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> op_norm_matrix_matrix_mult_le<span class="main">)</span>

<span class="keyword1"><span class="command">instance</span></span> 
  <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="operator">intro_classes</span> 
  <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="main">(</span><span class="operator">simp_all</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> sq_mtx_one_idty sq_mtx_norm_1 sq_mtx_norm_times<span class="main">)</span>
  <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="main">(</span><span class="operator">simp_all</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> to_mtx_inject vec_eq_iff one_sq_mtx_def zero_sq_mtx_def mat_def<span class="main">)</span>
  <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">transfer</span><span class="main"><span class="keyword3">,</span></span> <span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> scalar_matrix_assoc matrix_scalar_ac<span class="main">)</span><span class="main"><span class="keyword3">+</span></span>

<span class="keyword2"><span class="keyword">end</span></span>

<span class="keyword1"><span class="command">lemma</span></span> sq_mtx_one_ith_simps<span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">1</span> <span class="main">$$</span> <span class="free">i</span> <span class="main">$</span> <span class="free">i</span> <span class="main">=</span> <span class="main">1</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="free">i</span> <span class="main">‚â†</span> <span class="free">j</span> <span class="main">‚üπ</span> <span class="main">1</span> <span class="main">$$</span> <span class="free">i</span> <span class="main">$</span> <span class="free">j</span> <span class="main">=</span> <span class="main">0</span>"</span></span>
  <span class="keyword1"><span class="command">unfolding</span></span> one_sq_mtx_def mat_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp_all</span>

<span class="keyword1"><span class="command">lemma</span></span> of_nat_eq_sq_mtx_diag<span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"of_nat <span class="free">m</span> <span class="main">=</span> <span class="main">(</span><span class="keyword1">ùñΩùóÇùñ∫ùóÄ</span> <span class="bound">i</span><span class="main">.</span> <span class="free">m</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">induct</span> <span class="quoted"><span class="free">m</span></span><span class="main">)</span> <span class="main">(</span><span class="operator">simp</span><span class="main"><span class="keyword3">,</span></span> <span class="operator">subst</span> sq_mtx_eq_iff<span class="main"><span class="keyword3">,</span></span> <span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> axis_def<span class="main">)</span><span class="main"><span class="keyword3">+</span></span>

<span class="keyword1"><span class="command">lemma</span></span> mtx_vec_mult_1<span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">1</span> <span class="keyword1">*<span class="hidden">‚á©</span><sub>V</sub></span> <span class="free">s</span> <span class="main">=</span> <span class="free">s</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> sq_mtx_vec_mult_def one_sq_mtx_def 
      mat_def vec_eq_iff matrix_vector_mult_def<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> sq_mtx_diag_one<span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="keyword1">ùñΩùóÇùñ∫ùóÄ</span> <span class="bound">i</span><span class="main">.</span> <span class="main">1</span><span class="main">)</span> <span class="main">=</span> <span class="main">1</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">subst</span> sq_mtx_eq_iff<span class="main"><span class="keyword3">,</span></span> <span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> one_sq_mtx_def mat_def axis_def<span class="main">)</span>

<span class="keyword1"><span class="command">abbreviation</span></span> <span class="quoted"><span class="quoted">"<span class="free">mtx_invertible</span> <span class="free"><span class="bound"><span class="entity">A</span></span></span> <span class="main">‚â°</span> invertible <span class="main">(</span>to_vec <span class="free"><span class="bound"><span class="entity">A</span></span></span><span class="main">)</span>"</span></span>

<span class="keyword1"><span class="command">lemma</span></span> mtx_invertible_def<span class="main">:</span> <span class="quoted"><span class="quoted">"mtx_invertible <span class="free">A</span> <span class="main">‚ü∑</span> <span class="main">(</span><span class="main">‚àÉ</span><span class="bound">A'</span><span class="main">.</span> <span class="bound">A'</span> <span class="main">*</span> <span class="free">A</span> <span class="main">=</span> <span class="main">1</span> <span class="main">‚àß</span> <span class="free">A</span> <span class="main">*</span> <span class="bound">A'</span> <span class="main">=</span> <span class="main">1</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">unfold</span> sq_mtx_inv_def times_sq_mtx_def one_sq_mtx_def invertible_def<span class="main"><span class="keyword3">,</span></span> <span class="operator">clarsimp</span><span class="main"><span class="keyword3">,</span></span> <span class="operator">safe</span><span class="main">)</span>
   <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="main">(</span><span class="operator">rule_tac</span> x<span class="main"><span class="main">=</span></span><span class="quoted"><span class="quoted">"to_mtx <span class="improper">A'</span>"</span></span> <span class="keyword2"><span class="keyword"><span class="quasi_keyword">in</span></span></span> exI<span class="main"><span class="keyword3">,</span></span> <span class="operator">simp</span><span class="main">)</span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule_tac</span> x<span class="main"><span class="main">=</span></span><span class="quoted"><span class="quoted">"to_vec <span class="improper">A'</span>"</span></span> <span class="keyword2"><span class="keyword"><span class="quasi_keyword">in</span></span></span> exI<span class="main"><span class="keyword3">,</span></span> <span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> to_mtx_inject<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> mtx_invertibleI<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">A</span> <span class="main">*</span> <span class="free">B</span> <span class="main">=</span> <span class="main">1</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">B</span> <span class="main">*</span> <span class="free">A</span> <span class="main">=</span> <span class="main">1</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"mtx_invertible <span class="free">A</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">unfolding</span></span> mtx_invertible_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">lemma</span></span> mtx_invertibleD<span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"mtx_invertible <span class="free">A</span>"</span></span> 
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">A</span><span class="main"><span class="hidden">‚áß</span><sup>-</sup><span class="hidden">‚áß</span><sup>1</sup></span> <span class="main">*</span> <span class="free">A</span> <span class="main">=</span> <span class="main">1</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">A</span> <span class="main">*</span> <span class="free">A</span><span class="main"><span class="hidden">‚áß</span><sup>-</sup><span class="hidden">‚áß</span><sup>1</sup></span> <span class="main">=</span> <span class="main">1</span>"</span></span>
  <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">unfold</span> sq_mtx_inv_def times_sq_mtx_def one_sq_mtx_def<span class="main">)</span>
  <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp_all</span>

<span class="keyword1"><span class="command">lemma</span></span> mtx_invertible_inv<span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"mtx_invertible <span class="free">A</span> <span class="main">‚üπ</span> mtx_invertible <span class="main">(</span><span class="free">A</span><span class="main"><span class="hidden">‚áß</span><sup>-</sup><span class="hidden">‚áß</span><sup>1</sup></span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> mtx_invertibleD mtx_invertibleI <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>

<span class="keyword1"><span class="command">lemma</span></span> mtx_invertible_one<span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"mtx_invertible <span class="main">1</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> one_sq_mtx.rep_eq<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> sq_mtx_inv_unique<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">A</span> <span class="main">*</span> <span class="free">B</span> <span class="main">=</span> <span class="main">1</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">B</span> <span class="main">*</span> <span class="free">A</span> <span class="main">=</span> <span class="main">1</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">A</span><span class="main"><span class="hidden">‚áß</span><sup>-</sup><span class="hidden">‚áß</span><sup>1</sup></span> <span class="main">=</span> <span class="free">B</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> <span class="main"><span class="main">(</span></span>no_types<span class="main"><span class="main">,</span></span> lifting<span class="main"><span class="main">)</span></span> assms mtx_invertibleD<span class="main"><span class="main">(</span></span>2<span class="main"><span class="main">)</span></span> 
      mtx_invertibleI mult.assoc sq_mtx_one_idty<span class="main"><span class="main">(</span></span>1<span class="main"><span class="main">)</span></span><span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> sq_mtx_inv_idempotent<span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"mtx_invertible <span class="free">A</span> <span class="main">‚üπ</span> <span class="free">A</span><span class="main"><span class="hidden">‚áß</span><sup>-</sup><span class="hidden">‚áß</span><sup>1</sup></span><span class="main"><span class="hidden">‚áß</span><sup>-</sup><span class="hidden">‚áß</span><sup>1</sup></span> <span class="main">=</span> <span class="free">A</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> mtx_invertibleD sq_mtx_inv_unique <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>

<span class="keyword1"><span class="command">lemma</span></span> sq_mtx_inv_mult<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"mtx_invertible <span class="free">A</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"mtx_invertible <span class="free">B</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">A</span> <span class="main">*</span> <span class="free">B</span><span class="main">)</span><span class="main"><span class="hidden">‚áß</span><sup>-</sup><span class="hidden">‚áß</span><sup>1</sup></span> <span class="main">=</span> <span class="free">B</span><span class="main"><span class="hidden">‚áß</span><sup>-</sup><span class="hidden">‚áß</span><sup>1</sup></span> <span class="main">*</span> <span class="free">A</span><span class="main"><span class="hidden">‚áß</span><sup>-</sup><span class="hidden">‚áß</span><sup>1</sup></span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> assms matrix_inv_matrix_mul sq_mtx_inv_def times_sq_mtx_def<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> sq_mtx_inv_one<span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">1</span><span class="main"><span class="hidden">‚áß</span><sup>-</sup><span class="hidden">‚áß</span><sup>1</sup></span> <span class="main">=</span> <span class="main">1</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> sq_mtx_inv_unique<span class="main">)</span>

<span class="keyword1"><span class="command">definition</span></span> <span class="entity">similar_sq_mtx</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="tfree">'n</span><span class="main">::</span>finite<span class="main">)</span> sq_mtx <span class="main">‚áí</span> <span class="tfree">'n</span> sq_mtx <span class="main">‚áí</span> bool"</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">infixr</span></span> <span class="quoted">"<span class="keyword1">‚àº</span>"</span> 25<span class="main">)</span>
  <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free"><span class="bound"><span class="entity">A</span></span></span> <span class="main"><span class="free">‚àº</span></span> <span class="free"><span class="bound"><span class="entity">B</span></span></span><span class="main">)</span> <span class="main">‚ü∑</span> <span class="main">(</span><span class="main">‚àÉ</span> <span class="bound">P</span><span class="main">.</span> mtx_invertible <span class="bound">P</span> <span class="main">‚àß</span> <span class="free"><span class="bound"><span class="entity">A</span></span></span> <span class="main">=</span> <span class="bound">P</span><span class="main"><span class="hidden">‚áß</span><sup>-</sup><span class="hidden">‚áß</span><sup>1</sup></span> <span class="main">*</span> <span class="free"><span class="bound"><span class="entity">B</span></span></span> <span class="main">*</span> <span class="bound">P</span><span class="main">)</span>"</span></span>

<span class="keyword1"><span class="command">lemma</span></span> similar_sq_mtx_matrix<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">A</span> <span class="main">‚àº</span> <span class="free">B</span><span class="main">)</span> <span class="main">=</span> similar_matrix <span class="main">(</span>to_vec <span class="free">A</span><span class="main">)</span> <span class="main">(</span>to_vec <span class="free">B</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="main">(</span><span class="operator">unfold</span> similar_matrix_def similar_sq_mtx_def<span class="main"><span class="keyword3">,</span></span> <span class="operator">safe</span><span class="main">)</span>
   <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">metis</span> sq_mtx_inv.rep_eq times_sq_mtx.rep_eq<span class="main">)</span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> UNIV_I sq_mtx_inv.abs_eq times_sq_mtx.abs_eq to_mtx_inverse to_vec_inverse<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> similar_sq_mtx_refl<span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">A</span> <span class="main">‚àº</span> <span class="free">A</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">unfold</span> similar_sq_mtx_def<span class="main"><span class="keyword3">,</span></span> <span class="operator">rule_tac</span> x<span class="main"><span class="main">=</span></span><span class="quoted"><span class="quoted">"<span class="main">1</span>"</span></span> <span class="keyword2"><span class="keyword"><span class="quasi_keyword">in</span></span></span> exI<span class="main"><span class="keyword3">,</span></span> <span class="operator">simp</span><span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> similar_sq_mtx_simm<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">A</span> <span class="main">‚àº</span> <span class="free">B</span> <span class="main">‚üπ</span> <span class="free">B</span> <span class="main">‚àº</span> <span class="free">A</span>"</span></span>
  <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="main">(</span><span class="operator">unfold</span> similar_sq_mtx_def<span class="main"><span class="keyword3">,</span></span> <span class="operator">clarsimp</span><span class="main">)</span>
  <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="main">(</span><span class="operator">rule_tac</span> x<span class="main"><span class="main">=</span></span><span class="quoted"><span class="quoted">"<span class="improper">P</span><span class="main"><span class="hidden">‚áß</span><sup>-</sup><span class="hidden">‚áß</span><sup>1</sup></span>"</span></span> <span class="keyword2"><span class="keyword"><span class="quasi_keyword">in</span></span></span> exI<span class="main"><span class="keyword3">,</span></span> <span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> mult.assoc<span class="main">)</span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> mtx_invertibleD<span class="main"><span class="main">(</span></span>2<span class="main"><span class="main">)</span></span> mult.assoc mult.left_neutral<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> similar_sq_mtx_trans<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">A</span> <span class="main">‚àº</span> <span class="free">B</span> <span class="main">‚üπ</span> <span class="free">B</span> <span class="main">‚àº</span> <span class="free">C</span> <span class="main">‚üπ</span> <span class="free">A</span> <span class="main">‚àº</span> <span class="free">C</span>"</span></span>
  <span class="keyword1"><span class="command">unfolding</span></span> similar_sq_mtx_matrix <span class="keyword1"><span class="command">using</span></span> similar_matrix_trans <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>

<span class="keyword1"><span class="command">lemma</span></span> power_sq_mtx_diag<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span>sq_mtx_diag <span class="free">f</span><span class="main">)</span><span class="main">^</span><span class="free">n</span> <span class="main">=</span> <span class="main">(</span><span class="keyword1">ùñΩùóÇùñ∫ùóÄ</span> <span class="bound">i</span><span class="main">.</span> <span class="free">f</span> <span class="bound">i</span><span class="main">^</span><span class="free">n</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">induct</span> <span class="quoted"><span class="free">n</span></span><span class="main"><span class="keyword3">,</span></span> <span class="operator">simp_all</span><span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> power_similiar_sq_mtx_diag_eq<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"mtx_invertible <span class="free">P</span>"</span></span>
      <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">A</span> <span class="main">=</span> <span class="free">P</span><span class="main"><span class="hidden">‚áß</span><sup>-</sup><span class="hidden">‚áß</span><sup>1</sup></span> <span class="main">*</span> <span class="main">(</span>sq_mtx_diag <span class="free">f</span><span class="main">)</span> <span class="main">*</span> <span class="free">P</span>"</span></span>
    <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">A</span><span class="main">^</span><span class="free">n</span> <span class="main">=</span> <span class="free">P</span><span class="main"><span class="hidden">‚áß</span><sup>-</sup><span class="hidden">‚áß</span><sup>1</sup></span> <span class="main">*</span> <span class="main">(</span><span class="keyword1">ùñΩùóÇùñ∫ùóÄ</span> <span class="bound">i</span><span class="main">.</span> <span class="free">f</span> <span class="bound">i</span><span class="main">^</span><span class="free">n</span><span class="main">)</span> <span class="main">*</span> <span class="free">P</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span><span class="main">(</span><span class="operator">induct</span> <span class="quoted"><span class="free">n</span></span><span class="main"><span class="keyword3">,</span></span> <span class="operator">simp_all</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> assms<span class="main">)</span>
  <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">n</span><span class="main">::</span><span class="quoted">nat</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">P</span><span class="main"><span class="hidden">‚áß</span><sup>-</sup><span class="hidden">‚áß</span><sup>1</sup></span> <span class="main">*</span> sq_mtx_diag <span class="free">f</span> <span class="main">*</span> <span class="free">P</span> <span class="main">*</span> <span class="main">(</span><span class="free">P</span><span class="main"><span class="hidden">‚áß</span><sup>-</sup><span class="hidden">‚áß</span><sup>1</sup></span> <span class="main">*</span> <span class="main">(</span><span class="keyword1">ùñΩùóÇùñ∫ùóÄ</span> <span class="bound">i</span><span class="main">.</span> <span class="free">f</span> <span class="bound">i</span> <span class="main">^</span> <span class="skolem">n</span><span class="main">)</span> <span class="main">*</span> <span class="free">P</span><span class="main">)</span> <span class="main">=</span> 
  <span class="free">P</span><span class="main"><span class="hidden">‚áß</span><sup>-</sup><span class="hidden">‚áß</span><sup>1</sup></span> <span class="main">*</span> sq_mtx_diag <span class="free">f</span> <span class="main">*</span> <span class="main">(</span><span class="keyword1">ùñΩùóÇùñ∫ùóÄ</span> <span class="bound">i</span><span class="main">.</span> <span class="free">f</span> <span class="bound">i</span> <span class="main">^</span> <span class="skolem">n</span><span class="main">)</span> <span class="main">*</span> <span class="free">P</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> <span class="main"><span class="main">(</span></span>no_types<span class="main"><span class="main">,</span></span> lifting<span class="main"><span class="main">)</span></span> assms<span class="main"><span class="main">(</span></span>1<span class="main"><span class="main">)</span></span> mtx_invertibleD<span class="main"><span class="main">(</span></span>2<span class="main"><span class="main">)</span></span> mult.assoc mult.right_neutral<span class="main">)</span>
  <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> <span class="free">P</span><span class="main"><span class="hidden">‚áß</span><sup>-</sup><span class="hidden">‚áß</span><sup>1</sup></span> <span class="main">*</span> <span class="main">(</span><span class="keyword1">ùñΩùóÇùñ∫ùóÄ</span> <span class="bound">i</span><span class="main">.</span> <span class="free">f</span> <span class="bound">i</span> <span class="main">*</span> <span class="free">f</span> <span class="bound">i</span> <span class="main">^</span> <span class="skolem">n</span><span class="main">)</span> <span class="main">*</span> <span class="free">P</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> mult.assoc<span class="main">)</span> 
  <span class="keyword1"><span class="command">finally</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="free">P</span><span class="main"><span class="hidden">‚áß</span><sup>-</sup><span class="hidden">‚áß</span><sup>1</sup></span> <span class="main">*</span> sq_mtx_diag <span class="free">f</span> <span class="main">*</span> <span class="free">P</span> <span class="main">*</span> <span class="main">(</span><span class="free">P</span><span class="main"><span class="hidden">‚áß</span><sup>-</sup><span class="hidden">‚áß</span><sup>1</sup></span> <span class="main">*</span> <span class="main">(</span><span class="keyword1">ùñΩùóÇùñ∫ùóÄ</span> <span class="bound">i</span><span class="main">.</span> <span class="free">f</span> <span class="bound">i</span> <span class="main">^</span> <span class="skolem">n</span><span class="main">)</span> <span class="main">*</span> <span class="free">P</span><span class="main">)</span> <span class="main">=</span> 
  <span class="free">P</span><span class="main"><span class="hidden">‚áß</span><sup>-</sup><span class="hidden">‚áß</span><sup>1</sup></span> <span class="main">*</span> <span class="main">(</span><span class="keyword1">ùñΩùóÇùñ∫ùóÄ</span> <span class="bound">i</span><span class="main">.</span> <span class="free">f</span> <span class="bound">i</span> <span class="main">*</span> <span class="free">f</span> <span class="bound">i</span> <span class="main">^</span> <span class="skolem">n</span><span class="main">)</span> <span class="main">*</span> <span class="free">P</span>"</span></span> <span class="keyword1"><span class="command">.</span></span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">lemma</span></span> power_similar_sq_mtx_diag<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">A</span> <span class="main">‚àº</span> <span class="main">(</span>sq_mtx_diag <span class="free">f</span><span class="main">)</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">A</span><span class="main">^</span><span class="free">n</span> <span class="main">‚àº</span> <span class="main">(</span><span class="keyword1">ùñΩùóÇùñ∫ùóÄ</span> <span class="bound">i</span><span class="main">.</span> <span class="free">f</span> <span class="bound">i</span><span class="main">^</span><span class="free">n</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> assms power_similiar_sq_mtx_diag_eq 
  <span class="keyword1"><span class="command">unfolding</span></span> similar_sq_mtx_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>


<span class="keyword1"><span class="command">subsection</span></span> <span class="quoted"><span class="plain_text">‚Äπ Banach space of square matrices ‚Ä∫</span></span>

<span class="keyword1"><span class="command">lemma</span></span> Cauchy_cols<span class="main">:</span>
  <span class="keyword2"><span class="keyword">fixes</span></span> <span class="free">X</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"nat <span class="main">‚áí</span> <span class="main">(</span><span class="tfree">'a</span><span class="main">::</span>finite<span class="main">)</span> sq_mtx"</span></span> 
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"Cauchy <span class="free">X</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"Cauchy <span class="main">(</span><span class="main">Œª</span><span class="bound">n</span><span class="main">.</span> <span class="keyword1">ùñºùóàùóÖ</span> <span class="free">i</span> <span class="main">(</span><span class="free">X</span> <span class="bound">n</span><span class="main">)</span><span class="main">)</span>"</span></span> 
<span class="keyword1"><span class="command">proof</span></span><span class="main">(</span><span class="operator">unfold</span> Cauchy_def dist_norm<span class="main"><span class="keyword3">,</span></span> <span class="operator">clarsimp</span><span class="main">)</span>
  <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">Œµ</span><span class="main">::</span><span class="quoted">real</span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">Œµ</span> <span class="main">&gt;</span> <span class="main">0</span>"</span></span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">M</span></span> <span class="keyword2"><span class="keyword">where</span></span> M_def<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="main">‚àÄ</span><span class="bound"><span class="bound">m</span></span><span class="main">‚â•</span><span class="skolem">M</span><span class="main">.</span> <span class="main">‚àÄ</span><span class="bound"><span class="bound">n</span></span><span class="main">‚â•</span><span class="skolem">M</span><span class="main">.</span> <span class="main">‚à•</span><span class="free">X</span> <span class="bound">m</span> <span class="main">-</span> <span class="free">X</span> <span class="bound">n</span><span class="main">‚à•</span> <span class="main">&lt;</span> <span class="skolem">Œµ</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‚ÄπCauchy <span class="free">X</span>‚Ä∫</span></span> <span class="keyword1"><span class="command">unfolding</span></span> Cauchy_def <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> dist_sq_mtx_def<span class="main">)</span> <span class="operator">metis</span>
  <span class="keyword1"><span class="command">{</span></span><span class="keyword3"><span class="command">fix</span></span> <span class="skolem">m</span> <span class="skolem">n</span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">m</span> <span class="main">‚â•</span> <span class="skolem">M</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">n</span> <span class="main">‚â•</span> <span class="skolem">M</span>"</span></span>
    <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">Œµ</span> <span class="main">&gt;</span> <span class="main">‚à•</span><span class="free">X</span> <span class="skolem">m</span> <span class="main">-</span> <span class="free">X</span> <span class="skolem">n</span><span class="main">‚à•</span>"</span></span> 
      <span class="keyword1"><span class="command">using</span></span> M_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
    <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">‚à•</span><span class="free">X</span> <span class="skolem">m</span> <span class="main">-</span> <span class="free">X</span> <span class="skolem">n</span><span class="main">‚à•</span> <span class="main">‚â•</span> <span class="main">‚à•</span><span class="main">(</span><span class="free">X</span> <span class="skolem">m</span> <span class="main">-</span> <span class="free">X</span> <span class="skolem">n</span><span class="main">)</span> <span class="keyword1">*<span class="hidden">‚á©</span><sub>V</sub></span> ùñæ <span class="free">i</span><span class="main">‚à•</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">rule</span> le_mtx_norm<span class="main"><span class="main">[</span></span><span class="operator">of</span> <span class="main"><span class="main">_</span></span> <span class="quoted"><span class="quoted"><span class="quoted"><span class="quoted">"<span class="free"><span class="free"><span class="free">X</span></span></span> <span class="skolem"><span class="skolem"><span class="skolem">m</span></span></span> <span class="main"><span class="main"><span class="main">-</span></span></span> <span class="free"><span class="free"><span class="free">X</span></span></span> <span class="skolem"><span class="skolem"><span class="skolem">n</span></span></span>"</span></span></span></span><span class="main"><span class="main">]</span></span><span class="main"><span class="keyword3">,</span></span> <span class="operator">force</span><span class="main">)</span>
    <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">‚à•</span><span class="main">(</span><span class="free">X</span> <span class="skolem">m</span> <span class="main">-</span> <span class="free">X</span> <span class="skolem">n</span><span class="main">)</span> <span class="keyword1">*<span class="hidden">‚á©</span><sub>V</sub></span> ùñæ <span class="free">i</span><span class="main">‚à•</span> <span class="main">=</span> <span class="main">‚à•</span><span class="free">X</span> <span class="skolem">m</span> <span class="keyword1">*<span class="hidden">‚á©</span><sub>V</sub></span> ùñæ <span class="free">i</span> <span class="main">-</span> <span class="free">X</span> <span class="skolem">n</span> <span class="keyword1">*<span class="hidden">‚á©</span><sub>V</sub></span> ùñæ <span class="free">i</span><span class="main">‚à•</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> mtx_vec_mult_minus_rdistrib<span class="main">)</span>
    <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> <span class="main">‚à•</span><span class="keyword1">ùñºùóàùóÖ</span> <span class="free">i</span> <span class="main">(</span><span class="free">X</span> <span class="skolem">m</span><span class="main">)</span> <span class="main">-</span> <span class="keyword1">ùñºùóàùóÖ</span> <span class="free">i</span> <span class="main">(</span><span class="free">X</span> <span class="skolem">n</span><span class="main">)</span><span class="main">‚à•</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> mtx_vec_mult_minus_rdistrib mtx_vec_mult_canon<span class="main">)</span>
    <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">‚à•</span><span class="keyword1">ùñºùóàùóÖ</span> <span class="free">i</span> <span class="main">(</span><span class="free">X</span> <span class="skolem">m</span><span class="main">)</span> <span class="main">-</span> <span class="keyword1">ùñºùóàùóÖ</span> <span class="free">i</span> <span class="main">(</span><span class="free">X</span> <span class="skolem">n</span><span class="main">)</span><span class="main">‚à•</span> <span class="main">&lt;</span> <span class="skolem">Œµ</span>"</span></span> 
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">linarith</span><span class="keyword1"><span class="command">}</span></span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"<span class="main">‚àÉ</span><span class="bound">M</span><span class="main">.</span> <span class="main">‚àÄ</span><span class="bound"><span class="bound">m</span></span><span class="main">‚â•</span><span class="bound">M</span><span class="main">.</span> <span class="main">‚àÄ</span><span class="bound"><span class="bound">n</span></span><span class="main">‚â•</span><span class="bound">M</span><span class="main">.</span> <span class="main">‚à•</span><span class="keyword1">ùñºùóàùóÖ</span> <span class="free">i</span> <span class="main">(</span><span class="free">X</span> <span class="bound">m</span><span class="main">)</span> <span class="main">-</span> <span class="keyword1">ùñºùóàùóÖ</span> <span class="free">i</span> <span class="main">(</span><span class="free">X</span> <span class="bound">n</span><span class="main">)</span><span class="main">‚à•</span> <span class="main">&lt;</span> <span class="skolem">Œµ</span>"</span></span> 
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">lemma</span></span> col_convergence<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="main">‚àÄ</span><span class="bound">i</span><span class="main">.</span> <span class="main">(</span><span class="main">Œª</span><span class="bound">n</span><span class="main">.</span> <span class="keyword1">ùñºùóàùóÖ</span> <span class="bound">i</span> <span class="main">(</span><span class="free">X</span> <span class="bound">n</span><span class="main">)</span><span class="main">)</span> <span class="main">‚á¢</span> <span class="free">L</span> <span class="main">$</span> <span class="bound">i</span>"</span></span> 
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">X</span> <span class="main">‚á¢</span> to_mtx <span class="main">(</span>transpose <span class="free">L</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span><span class="main">(</span><span class="operator">unfold</span> LIMSEQ_def dist_norm<span class="main"><span class="keyword3">,</span></span> <span class="operator">clarsimp</span><span class="main">)</span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?L</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"to_mtx <span class="main">(</span>transpose <span class="free">L</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?a</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"<span class="keyword1">CARD</span><span class="main">(</span><span class="tfree">'a</span><span class="main">)</span>"</span></span> <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">Œµ</span><span class="main">::</span><span class="quoted">real</span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">Œµ</span> <span class="main">&gt;</span> <span class="main">0</span>"</span></span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">Œµ</span> <span class="main">/</span> <span class="var">?a</span> <span class="main">&gt;</span> <span class="main">0</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="main">‚àÄ</span><span class="bound">i</span><span class="main">.</span> <span class="main">‚àÉ</span> <span class="bound">N</span><span class="main">.</span> <span class="main">‚àÄ</span><span class="bound"><span class="bound">n</span></span><span class="main">‚â•</span><span class="bound">N</span><span class="main">.</span> <span class="main">‚à•</span><span class="keyword1">ùñºùóàùóÖ</span> <span class="bound">i</span> <span class="main">(</span><span class="free">X</span> <span class="bound">n</span><span class="main">)</span> <span class="main">-</span> <span class="free">L</span> <span class="main">$</span> <span class="bound">i</span><span class="main">‚à•</span> <span class="main">&lt;</span> <span class="skolem">Œµ</span><span class="main">/</span><span class="var">?a</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">unfolding</span></span> LIMSEQ_def dist_norm convergent_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">N</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="main">‚àÄ</span><span class="bound">i</span><span class="main">.</span> <span class="main">‚àÄ</span><span class="bound"><span class="bound">n</span></span><span class="main">‚â•</span><span class="skolem">N</span><span class="main">.</span> <span class="main">‚à•</span><span class="keyword1">ùñºùóàùóÖ</span> <span class="bound">i</span> <span class="main">(</span><span class="free">X</span> <span class="bound">n</span><span class="main">)</span> <span class="main">-</span> <span class="free">L</span> <span class="main">$</span> <span class="bound">i</span><span class="main">‚à•</span> <span class="main">&lt;</span> <span class="skolem">Œµ</span><span class="main">/</span><span class="var">?a</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> finite_nat_minimal_witness<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="quoted">"<span class="main">Œª</span> <span class="bound">i</span> <span class="bound">n</span><span class="main">.</span> <span class="main">‚à•</span><span class="keyword1">ùñºùóàùóÖ</span> <span class="bound">i</span> <span class="main">(</span><span class="free">X</span> <span class="bound">n</span><span class="main">)</span> <span class="main">-</span> <span class="free">L</span> <span class="main">$</span> <span class="bound">i</span><span class="main">‚à•</span> <span class="main">&lt;</span> <span class="skolem">Œµ</span><span class="main">/</span><span class="var">?a</span>"</span></span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">‚ãÄ</span><span class="bound">i</span> <span class="bound">n</span><span class="main">.</span> <span class="main">(</span><span class="keyword1">ùñºùóàùóÖ</span> <span class="bound">i</span> <span class="main">(</span><span class="free">X</span> <span class="bound">n</span><span class="main">)</span> <span class="main">-</span> <span class="free">L</span> <span class="main">$</span> <span class="bound">i</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="keyword1">ùñºùóàùóÖ</span> <span class="bound">i</span> <span class="main">(</span><span class="free">X</span> <span class="bound">n</span> <span class="main">-</span> <span class="var">?L</span><span class="main">)</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">unfolding</span></span> minus_sq_mtx_def <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">transfer</span><span class="main"><span class="keyword3">,</span></span> <span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> transpose_def vec_eq_iff column_def<span class="main">)</span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> N_def<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="main">‚àÄ</span><span class="bound">i</span><span class="main">.</span> <span class="main">‚àÄ</span><span class="bound"><span class="bound">n</span></span><span class="main">‚â•</span><span class="skolem">N</span><span class="main">.</span> <span class="main">‚à•</span><span class="keyword1">ùñºùóàùóÖ</span> <span class="bound">i</span> <span class="main">(</span><span class="free">X</span> <span class="bound">n</span> <span class="main">-</span> <span class="var">?L</span><span class="main">)</span><span class="main">‚à•</span> <span class="main">&lt;</span> <span class="skolem">Œµ</span><span class="main">/</span><span class="var">?a</span>"</span></span> 
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">‚àÄ</span><span class="bound"><span class="bound">n</span></span><span class="main">‚â•</span><span class="skolem">N</span><span class="main">.</span> <span class="main">‚à•</span><span class="free">X</span> <span class="bound">n</span> <span class="main">-</span> <span class="var">?L</span><span class="main">‚à•</span> <span class="main">&lt;</span> <span class="skolem">Œµ</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span><span class="main">(</span><span class="operator">rule</span> allI<span class="main"><span class="keyword3">,</span></span> <span class="operator">rule</span> impI<span class="main">)</span>
    <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">n</span><span class="main">::</span><span class="quoted">nat</span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">N</span> <span class="main">‚â§</span> <span class="skolem">n</span>"</span></span>
    <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="main">‚àÄ</span> <span class="bound">i</span><span class="main">.</span> <span class="main">‚à•</span><span class="keyword1">ùñºùóàùóÖ</span> <span class="bound">i</span> <span class="main">(</span><span class="free">X</span> <span class="skolem">n</span> <span class="main">-</span> <span class="var">?L</span><span class="main">)</span><span class="main">‚à•</span> <span class="main">&lt;</span> <span class="skolem">Œµ</span><span class="main">/</span><span class="var">?a</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> N_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
    <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">‚àë</span><span class="bound">i</span><span class="main">‚àà</span>UNIV<span class="main">.</span> <span class="main">‚à•</span><span class="keyword1">ùñºùóàùóÖ</span> <span class="bound">i</span> <span class="main">(</span><span class="free">X</span> <span class="skolem">n</span> <span class="main">-</span> <span class="var">?L</span><span class="main">)</span><span class="main">‚à•</span><span class="main">)</span> <span class="main">&lt;</span> <span class="main">(</span><span class="main">‚àë</span><span class="main">(</span><span class="bound">i</span><span class="main">::</span><span class="tfree">'a</span><span class="main">)</span><span class="main">‚àà</span>UNIV<span class="main">.</span> <span class="skolem">Œµ</span><span class="main">/</span><span class="var">?a</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> sum_strict_mono<span class="main">[</span><span class="operator">of</span> <span class="main">_</span> <span class="quoted"><span class="quoted">"<span class="main">Œª</span><span class="bound">i</span><span class="main">.</span> <span class="main">‚à•</span><span class="keyword1">ùñºùóàùóÖ</span> <span class="bound">i</span> <span class="main">(</span><span class="free">X</span> <span class="skolem">n</span> <span class="main">-</span> <span class="var">?L</span><span class="main">)</span><span class="main">‚à•</span>"</span></span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">force</span>
    <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">‚à•</span><span class="free">X</span> <span class="skolem">n</span> <span class="main">-</span> <span class="var">?L</span><span class="main">‚à•</span> <span class="main">‚â§</span> <span class="main">(</span><span class="main">‚àë</span><span class="bound">i</span><span class="main">‚àà</span>UNIV<span class="main">.</span> <span class="main">‚à•</span><span class="keyword1">ùñºùóàùóÖ</span> <span class="bound">i</span> <span class="main">(</span><span class="free">X</span> <span class="skolem">n</span> <span class="main">-</span> <span class="var">?L</span><span class="main">)</span><span class="main">‚à•</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> sq_mtx_norm_le_sum_col <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
    <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">‚àë</span><span class="main">(</span><span class="bound">i</span><span class="main">::</span><span class="tfree">'a</span><span class="main">)</span><span class="main">‚àà</span>UNIV<span class="main">.</span> <span class="skolem">Œµ</span><span class="main">/</span><span class="var">?a</span><span class="main">)</span> <span class="main">=</span> <span class="skolem">Œµ</span>"</span></span> 
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">force</span>
    <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">‚à•</span><span class="free">X</span> <span class="skolem">n</span> <span class="main">-</span> <span class="var">?L</span><span class="main">‚à•</span> <span class="main">&lt;</span> <span class="skolem">Œµ</span>"</span></span> 
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">linarith</span>
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"<span class="main">‚àÉ</span><span class="bound">no</span><span class="main">.</span> <span class="main">‚àÄ</span><span class="bound"><span class="bound">n</span></span><span class="main">‚â•</span><span class="bound">no</span><span class="main">.</span> <span class="main">‚à•</span><span class="free">X</span> <span class="bound">n</span> <span class="main">-</span> <span class="var">?L</span><span class="main">‚à•</span> <span class="main">&lt;</span> <span class="skolem">Œµ</span>"</span></span> 
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">instance</span></span> sq_mtx <span class="main">::</span> <span class="main">(</span><span class="quoted">finite</span><span class="main">)</span> <span class="quoted">banach</span>
<span class="keyword1"><span class="command">proof</span></span><span class="main">(</span><span class="operator">standard</span><span class="main">)</span>
  <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">X</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"nat <span class="main">‚áí</span> <span class="tfree">'a</span> sq_mtx"</span></span>
  <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"Cauchy <span class="skolem">X</span>"</span></span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="main">‚ãÄ</span><span class="bound">i</span><span class="main">.</span> Cauchy <span class="main">(</span><span class="main">Œª</span><span class="bound">n</span><span class="main">.</span> <span class="keyword1">ùñºùóàùóÖ</span> <span class="bound">i</span> <span class="main">(</span><span class="skolem">X</span> <span class="bound">n</span><span class="main">)</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> Cauchy_cols <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">hence</span></span> obs<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">‚àÄ</span><span class="bound">i</span><span class="main">.</span> <span class="main">‚àÉ!</span> <span class="bound">L</span><span class="main">.</span> <span class="main">(</span><span class="main">Œª</span><span class="bound">n</span><span class="main">.</span> <span class="keyword1">ùñºùóàùóÖ</span> <span class="bound">i</span> <span class="main">(</span><span class="skolem">X</span> <span class="bound">n</span><span class="main">)</span><span class="main">)</span> <span class="main">‚á¢</span> <span class="bound">L</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> Cauchy_convergent convergent_def LIMSEQ_unique <span class="keyword1"><span class="command">by</span></span> <span class="operator">fastforce</span>
  <span class="keyword3"><span class="command">define</span></span> <span class="skolem"><span class="skolem">L</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">L</span> <span class="main">=</span> <span class="main">(</span><span class="keyword1">œá</span> <span class="bound">i</span><span class="main">.</span> lim <span class="main">(</span><span class="main">Œª</span><span class="bound">n</span><span class="main">.</span> <span class="keyword1">ùñºùóàùóÖ</span> <span class="bound">i</span> <span class="main">(</span><span class="skolem">X</span> <span class="bound">n</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="main">‚àÄ</span><span class="bound">i</span><span class="main">.</span> <span class="main">(</span><span class="main">Œª</span><span class="bound">n</span><span class="main">.</span> <span class="keyword1">ùñºùóàùóÖ</span> <span class="bound">i</span> <span class="main">(</span><span class="skolem">X</span> <span class="bound">n</span><span class="main">)</span><span class="main">)</span> <span class="main">‚á¢</span> <span class="skolem">L</span> <span class="main">$</span> <span class="bound">i</span>"</span></span> 
    <span class="keyword1"><span class="command">using</span></span> obs theI_unique<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="quoted">"<span class="main">Œª</span><span class="bound">L</span><span class="main">.</span> <span class="main">(</span><span class="main">Œª</span><span class="bound">n</span><span class="main">.</span> <span class="keyword1">ùñºùóàùóÖ</span> <span class="main">_</span> <span class="main">(</span><span class="skolem">X</span> <span class="bound">n</span><span class="main">)</span><span class="main">)</span> <span class="main">‚á¢</span> <span class="bound">L</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">L</span> <span class="main">$</span> <span class="main">_</span>"</span></span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> lim_def<span class="main">)</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"convergent <span class="skolem">X</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> col_convergence <span class="keyword1"><span class="command">unfolding</span></span> convergent_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">lemma</span></span> exp_similiar_sq_mtx_diag_eq<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"mtx_invertible <span class="free">P</span>"</span></span>
      <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">A</span> <span class="main">=</span> <span class="free">P</span><span class="main"><span class="hidden">‚áß</span><sup>-</sup><span class="hidden">‚áß</span><sup>1</sup></span> <span class="main">*</span> <span class="main">(</span><span class="keyword1">ùñΩùóÇùñ∫ùóÄ</span> <span class="bound">i</span><span class="main">.</span> <span class="free">f</span> <span class="bound">i</span><span class="main">)</span> <span class="main">*</span> <span class="free">P</span>"</span></span>
    <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"exp <span class="free">A</span> <span class="main">=</span> <span class="free">P</span><span class="main"><span class="hidden">‚áß</span><sup>-</sup><span class="hidden">‚áß</span><sup>1</sup></span> <span class="main">*</span> exp <span class="main">(</span><span class="keyword1">ùñΩùóÇùñ∫ùóÄ</span> <span class="bound">i</span><span class="main">.</span> <span class="free">f</span> <span class="bound">i</span><span class="main">)</span> <span class="main">*</span> <span class="free">P</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span><span class="main">(</span><span class="operator">unfold</span> exp_def power_similiar_sq_mtx_diag_eq<span class="main"><span class="main">[</span></span><span class="operator">OF</span> assms<span class="main"><span class="main">]</span></span><span class="main">)</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">‚àë</span><span class="bound">n</span><span class="main">.</span> <span class="free">P</span><span class="main"><span class="hidden">‚áß</span><sup>-</sup><span class="hidden">‚áß</span><sup>1</sup></span> <span class="main">*</span> <span class="main">(</span><span class="keyword1">ùñΩùóÇùñ∫ùóÄ</span> <span class="bound">i</span><span class="main">.</span> <span class="free">f</span> <span class="bound">i</span> <span class="main">^</span> <span class="bound">n</span><span class="main">)</span> <span class="main">*</span> <span class="free">P</span> <span class="keyword1">/<span class="hidden">‚á©</span><sub>R</sub></span> fact <span class="bound">n</span><span class="main">)</span> <span class="main">=</span> 
  <span class="main">(</span><span class="main">‚àë</span><span class="bound">n</span><span class="main">.</span> <span class="free">P</span><span class="main"><span class="hidden">‚áß</span><sup>-</sup><span class="hidden">‚áß</span><sup>1</sup></span> <span class="main">*</span> <span class="main">(</span><span class="main">(</span><span class="keyword1">ùñΩùóÇùñ∫ùóÄ</span> <span class="bound">i</span><span class="main">.</span> <span class="free">f</span> <span class="bound">i</span> <span class="main">^</span> <span class="bound">n</span><span class="main">)</span> <span class="keyword1">/<span class="hidden">‚á©</span><sub>R</sub></span> fact <span class="bound">n</span><span class="main">)</span> <span class="main">*</span> <span class="free">P</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> <span class="main">(</span><span class="main">‚àë</span><span class="bound">n</span><span class="main">.</span> <span class="free">P</span><span class="main"><span class="hidden">‚áß</span><sup>-</sup><span class="hidden">‚áß</span><sup>1</sup></span> <span class="main">*</span> <span class="main">(</span><span class="main">(</span><span class="keyword1">ùñΩùóÇùñ∫ùóÄ</span> <span class="bound">i</span><span class="main">.</span> <span class="free">f</span> <span class="bound">i</span> <span class="main">^</span> <span class="bound">n</span><span class="main">)</span> <span class="keyword1">/<span class="hidden">‚á©</span><sub>R</sub></span> fact <span class="bound">n</span><span class="main">)</span><span class="main">)</span> <span class="main">*</span> <span class="free">P</span>"</span></span>
    <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="main">(</span><span class="operator">subst</span> suminf_multr<span class="main"><span class="main">[</span></span><span class="operator">OF</span> bounded_linear.summable<span class="main"><span class="main">[</span></span><span class="operator">OF</span> bounded_linear_mult_right<span class="main"><span class="main">]</span></span><span class="main"><span class="main">]</span></span><span class="main">)</span>
    <span class="keyword1"><span class="command">unfolding</span></span> power_sq_mtx_diag<span class="main">[</span><span class="operator">symmetric</span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp_all</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> summable_exp_generic<span class="main">)</span>
  <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> <span class="free">P</span><span class="main"><span class="hidden">‚áß</span><sup>-</sup><span class="hidden">‚áß</span><sup>1</sup></span> <span class="main">*</span> <span class="main">(</span><span class="main">‚àë</span><span class="bound">n</span><span class="main">.</span> <span class="main">(</span><span class="keyword1">ùñΩùóÇùñ∫ùóÄ</span> <span class="bound">i</span><span class="main">.</span> <span class="free">f</span> <span class="bound">i</span> <span class="main">^</span> <span class="bound">n</span><span class="main">)</span> <span class="keyword1">/<span class="hidden">‚á©</span><sub>R</sub></span> fact <span class="bound">n</span><span class="main">)</span> <span class="main">*</span> <span class="free">P</span>"</span></span>
    <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="main">(</span><span class="operator">subst</span> suminf_mult<span class="main"><span class="main">[</span></span><span class="operator">of</span> <span class="main"><span class="main">_</span></span> <span class="quoted"><span class="quoted"><span class="quoted">"<span class="free"><span class="free">P</span></span><span class="main"><span class="main"><span class="hidden">‚áß</span><sup>-</sup><span class="hidden">‚áß</span><sup>1</sup></span></span>"</span></span></span><span class="main"><span class="main">]</span></span><span class="main">)</span>
    <span class="keyword1"><span class="command">unfolding</span></span> power_sq_mtx_diag<span class="main">[</span><span class="operator">symmetric</span><span class="main">]</span> 
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp_all</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> summable_exp_generic<span class="main">)</span>
  <span class="keyword1"><span class="command">finally</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">‚àë</span><span class="bound">n</span><span class="main">.</span> <span class="free">P</span><span class="main"><span class="hidden">‚áß</span><sup>-</sup><span class="hidden">‚áß</span><sup>1</sup></span> <span class="main">*</span> <span class="main">(</span><span class="keyword1">ùñΩùóÇùñ∫ùóÄ</span> <span class="bound">i</span><span class="main">.</span> <span class="free">f</span> <span class="bound">i</span> <span class="main">^</span> <span class="bound">n</span><span class="main">)</span> <span class="main">*</span> <span class="free">P</span> <span class="keyword1">/<span class="hidden">‚á©</span><sub>R</sub></span> fact <span class="bound">n</span><span class="main">)</span> <span class="main">=</span> 
  <span class="free">P</span><span class="main"><span class="hidden">‚áß</span><sup>-</sup><span class="hidden">‚áß</span><sup>1</sup></span> <span class="main">*</span> <span class="main">(</span><span class="main">‚àë</span><span class="bound">n</span><span class="main">.</span> sq_mtx_diag <span class="free">f</span> <span class="main">^</span> <span class="bound">n</span> <span class="keyword1">/<span class="hidden">‚á©</span><sub>R</sub></span> fact <span class="bound">n</span><span class="main">)</span> <span class="main">*</span> <span class="free">P</span>"</span></span>
    <span class="keyword1"><span class="command">unfolding</span></span> power_sq_mtx_diag <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">lemma</span></span> exp_similiar_sq_mtx_diag<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">A</span> <span class="main">‚àº</span> sq_mtx_diag <span class="free">f</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"exp <span class="free">A</span> <span class="main">‚àº</span> exp <span class="main">(</span>sq_mtx_diag <span class="free">f</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> assms exp_similiar_sq_mtx_diag_eq 
  <span class="keyword1"><span class="command">unfolding</span></span> similar_sq_mtx_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>

<span class="keyword1"><span class="command">lemma</span></span> suminf_sq_mtx_diag<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="main">‚àÄ</span><span class="bound">i</span><span class="main">.</span> <span class="main">(</span><span class="main">Œª</span><span class="bound">n</span><span class="main">.</span> <span class="free">f</span> <span class="bound">n</span> <span class="bound">i</span><span class="main">)</span> <span class="keyword1">sums</span> <span class="main">(</span>suminf <span class="main">(</span><span class="main">Œª</span><span class="bound">n</span><span class="main">.</span> <span class="free">f</span> <span class="bound">n</span> <span class="bound">i</span><span class="main">)</span><span class="main">)</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">‚àë</span><span class="bound">n</span><span class="main">.</span> <span class="main">(</span><span class="keyword1">ùñΩùóÇùñ∫ùóÄ</span> <span class="bound">i</span><span class="main">.</span> <span class="free">f</span> <span class="bound">n</span> <span class="bound">i</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="keyword1">ùñΩùóÇùñ∫ùóÄ</span> <span class="bound">i</span><span class="main">.</span> <span class="main">‚àë</span><span class="bound">n</span><span class="main">.</span> <span class="free">f</span> <span class="bound">n</span> <span class="bound">i</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span><span class="main">(</span><span class="operator">rule</span> suminfI<span class="main"><span class="keyword3">,</span></span> <span class="operator">unfold</span> sums_def LIMSEQ_iff<span class="main"><span class="keyword3">,</span></span> <span class="operator">clarsimp</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> norm_sq_mtx_diag<span class="main">)</span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?g</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"<span class="main">Œª</span><span class="bound">n</span> <span class="bound">i</span><span class="main">.</span> <span class="main">¬¶</span><span class="main">(</span><span class="main">‚àë</span><span class="bound">n</span><span class="main">&lt;</span><span class="bound">n</span><span class="main">.</span> <span class="free">f</span> <span class="bound">n</span> <span class="bound">i</span><span class="main">)</span> <span class="main">-</span> <span class="main">(</span><span class="main">‚àë</span><span class="bound">n</span><span class="main">.</span> <span class="free">f</span> <span class="bound">n</span> <span class="bound">i</span><span class="main">)</span><span class="main">¬¶</span>"</span></span>
  <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">r</span><span class="main">::</span><span class="quoted">real</span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">r</span> <span class="main">&gt;</span> <span class="main">0</span>"</span></span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">‚àÄ</span><span class="bound">i</span><span class="main">.</span> <span class="main">‚àÉ</span><span class="bound">no</span><span class="main">.</span> <span class="main">‚àÄ</span><span class="bound"><span class="bound">n</span></span><span class="main">‚â•</span><span class="bound">no</span><span class="main">.</span> <span class="var">?g</span> <span class="bound">n</span> <span class="bound">i</span> <span class="main">&lt;</span> <span class="skolem">r</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> assms <span class="quoted"><span class="quoted">‚Äπ<span class="skolem">r</span> <span class="main">&gt;</span> <span class="main">0</span>‚Ä∫</span></span> <span class="keyword1"><span class="command">unfolding</span></span> sums_def LIMSEQ_iff <span class="keyword1"><span class="command">by</span></span> <span class="operator">clarsimp</span> 
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">N</span></span> <span class="keyword2"><span class="keyword">where</span></span> key<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">‚àÄ</span><span class="bound">i</span><span class="main">.</span> <span class="main">‚àÄ</span><span class="bound"><span class="bound">n</span></span><span class="main">‚â•</span><span class="skolem">N</span><span class="main">.</span> <span class="var">?g</span> <span class="bound">n</span> <span class="bound">i</span> <span class="main">&lt;</span> <span class="skolem">r</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> finite_nat_minimal_witness<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="quoted">"<span class="main">Œª</span><span class="bound">i</span> <span class="bound">n</span><span class="main">.</span> <span class="var">?g</span> <span class="bound">n</span> <span class="bound">i</span> <span class="main">&lt;</span> <span class="skolem">r</span>"</span></span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">{</span></span><span class="keyword3"><span class="command">fix</span></span> <span class="skolem">n</span><span class="main">::</span><span class="quoted">nat</span>
    <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">n</span> <span class="main">‚â•</span> <span class="skolem">N</span>"</span></span>
    <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">i</span></span> <span class="keyword2"><span class="keyword">where</span></span> i_def<span class="main">:</span> <span class="quoted"><span class="quoted">"Max <span class="main">{</span><span class="bound">x</span><span class="main">.</span> <span class="main">‚àÉ</span><span class="bound">i</span><span class="main">.</span> <span class="bound">x</span> <span class="main">=</span> <span class="var">?g</span> <span class="skolem">n</span> <span class="bound">i</span><span class="main">}</span> <span class="main">=</span> <span class="var">?g</span> <span class="skolem">n</span> <span class="skolem">i</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> cMax_finite_ex<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="quoted">"<span class="main">{</span><span class="bound">x</span><span class="main">.</span> <span class="main">‚àÉ</span><span class="bound">i</span><span class="main">.</span> <span class="bound">x</span> <span class="main">=</span> <span class="var">?g</span> <span class="skolem">n</span> <span class="bound">i</span><span class="main">}</span>"</span></span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="var">?g</span> <span class="skolem">n</span> <span class="skolem">i</span> <span class="main">&lt;</span> <span class="skolem">r</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> key <span class="quoted"><span class="quoted">‚Äπ<span class="skolem">n</span> <span class="main">‚â•</span> <span class="skolem">N</span>‚Ä∫</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
    <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"Max <span class="main">{</span><span class="bound">x</span><span class="main">.</span> <span class="main">‚àÉ</span><span class="bound">i</span><span class="main">.</span> <span class="bound">x</span> <span class="main">=</span> <span class="var">?g</span> <span class="skolem">n</span> <span class="bound">i</span><span class="main">}</span> <span class="main">&lt;</span> <span class="skolem">r</span>"</span></span>
      <span class="keyword1"><span class="command">unfolding</span></span> i_def<span class="main">[</span><span class="operator">symmetric</span><span class="main">]</span> <span class="keyword1"><span class="command">.</span></span><span class="keyword1"><span class="command">}</span></span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"<span class="main">‚àÉ</span><span class="bound">N</span><span class="main">.</span> <span class="main">‚àÄ</span><span class="bound"><span class="bound">n</span></span><span class="main">‚â•</span><span class="bound">N</span><span class="main">.</span> Max <span class="main">{</span><span class="bound">x</span><span class="main">.</span> <span class="main">‚àÉ</span><span class="bound">i</span><span class="main">.</span> <span class="bound">x</span> <span class="main">=</span> <span class="var">?g</span> <span class="bound">n</span> <span class="bound">i</span><span class="main">}</span> <span class="main">&lt;</span> <span class="skolem">r</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">lemma</span></span> exp_sq_mtx_diag<span class="main">:</span> <span class="quoted"><span class="quoted">"exp <span class="main">(</span>sq_mtx_diag <span class="free">f</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="keyword1">ùñΩùóÇùñ∫ùóÄ</span> <span class="bound">i</span><span class="main">.</span> exp <span class="main">(</span><span class="free">f</span> <span class="bound">i</span><span class="main">)</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="main">(</span><span class="operator">unfold</span> exp_def<span class="main"><span class="keyword3">,</span></span> <span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> power_sq_mtx_diag scaleR_sq_mtx_diag<span class="main">)</span>
  <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="main">(</span><span class="operator">rule</span> suminf_sq_mtx_diag<span class="main">)</span>
  <span class="keyword1"><span class="command">using</span></span> exp_converges<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="quoted">"<span class="free">f</span> <span class="main">_</span>"</span></span><span class="main">]</span> 
  <span class="keyword1"><span class="command">unfolding</span></span> sums_def LIMSEQ_iff exp_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">force</span>

<span class="keyword1"><span class="command">lemma</span></span> exp_scaleR_diagonal1<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"mtx_invertible <span class="free">P</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">A</span> <span class="main">=</span> <span class="free">P</span><span class="main"><span class="hidden">‚áß</span><sup>-</sup><span class="hidden">‚áß</span><sup>1</sup></span> <span class="main">*</span> <span class="main">(</span><span class="keyword1">ùñΩùóÇùñ∫ùóÄ</span> <span class="bound">i</span><span class="main">.</span> <span class="free">f</span> <span class="bound">i</span><span class="main">)</span> <span class="main">*</span> <span class="free">P</span>"</span></span>
    <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"exp <span class="main">(</span><span class="free">t</span> <span class="keyword1">*<span class="hidden">‚á©</span><sub>R</sub></span> <span class="free">A</span><span class="main">)</span> <span class="main">=</span> <span class="free">P</span><span class="main"><span class="hidden">‚áß</span><sup>-</sup><span class="hidden">‚áß</span><sup>1</sup></span> <span class="main">*</span> <span class="main">(</span><span class="keyword1">ùñΩùóÇùñ∫ùóÄ</span> <span class="bound">i</span><span class="main">.</span> exp <span class="main">(</span><span class="free">t</span> <span class="main">*</span> <span class="free">f</span> <span class="bound">i</span><span class="main">)</span><span class="main">)</span> <span class="main">*</span> <span class="free">P</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"exp <span class="main">(</span><span class="free">t</span> <span class="keyword1">*<span class="hidden">‚á©</span><sub>R</sub></span> <span class="free">A</span><span class="main">)</span> <span class="main">=</span> exp <span class="main">(</span><span class="free">P</span><span class="main"><span class="hidden">‚áß</span><sup>-</sup><span class="hidden">‚áß</span><sup>1</sup></span> <span class="main">*</span> <span class="main">(</span><span class="free">t</span> <span class="keyword1">*<span class="hidden">‚á©</span><sub>R</sub></span> sq_mtx_diag <span class="free">f</span><span class="main">)</span> <span class="main">*</span> <span class="free">P</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> <span class="free">P</span><span class="main"><span class="hidden">‚áß</span><sup>-</sup><span class="hidden">‚áß</span><sup>1</sup></span> <span class="main">*</span> <span class="main">(</span><span class="keyword1">ùñΩùóÇùñ∫ùóÄ</span> <span class="bound">i</span><span class="main">.</span> exp <span class="main">(</span><span class="free">t</span> <span class="main">*</span> <span class="free">f</span> <span class="bound">i</span><span class="main">)</span><span class="main">)</span> <span class="main">*</span> <span class="free">P</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> assms<span class="main"><span class="main">(</span></span>1<span class="main"><span class="main">)</span></span> exp_similiar_sq_mtx_diag_eq exp_sq_mtx_diag scaleR_sq_mtx_diag<span class="main">)</span>
  <span class="keyword1"><span class="command">finally</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"exp <span class="main">(</span><span class="free">t</span> <span class="keyword1">*<span class="hidden">‚á©</span><sub>R</sub></span> <span class="free">A</span><span class="main">)</span> <span class="main">=</span> <span class="free">P</span><span class="main"><span class="hidden">‚áß</span><sup>-</sup><span class="hidden">‚áß</span><sup>1</sup></span> <span class="main">*</span> <span class="main">(</span><span class="keyword1">ùñΩùóÇùñ∫ùóÄ</span> <span class="bound">i</span><span class="main">.</span> exp <span class="main">(</span><span class="free">t</span> <span class="main">*</span> <span class="free">f</span> <span class="bound">i</span><span class="main">)</span><span class="main">)</span> <span class="main">*</span> <span class="free">P</span>"</span></span> <span class="keyword1"><span class="command">.</span></span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">lemma</span></span> exp_scaleR_diagonal2<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"mtx_invertible <span class="free">P</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">A</span> <span class="main">=</span> <span class="free">P</span> <span class="main">*</span> <span class="main">(</span><span class="keyword1">ùñΩùóÇùñ∫ùóÄ</span> <span class="bound">i</span><span class="main">.</span> <span class="free">f</span> <span class="bound">i</span><span class="main">)</span> <span class="main">*</span> <span class="free">P</span><span class="main"><span class="hidden">‚áß</span><sup>-</sup><span class="hidden">‚áß</span><sup>1</sup></span>"</span></span>
    <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"exp <span class="main">(</span><span class="free">t</span> <span class="keyword1">*<span class="hidden">‚á©</span><sub>R</sub></span> <span class="free">A</span><span class="main">)</span> <span class="main">=</span> <span class="free">P</span> <span class="main">*</span> <span class="main">(</span><span class="keyword1">ùñΩùóÇùñ∫ùóÄ</span> <span class="bound">i</span><span class="main">.</span> exp <span class="main">(</span><span class="free">t</span> <span class="main">*</span> <span class="free">f</span> <span class="bound">i</span><span class="main">)</span><span class="main">)</span> <span class="main">*</span> <span class="free">P</span><span class="main"><span class="hidden">‚áß</span><sup>-</sup><span class="hidden">‚áß</span><sup>1</sup></span>"</span></span>
  <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="main">(</span><span class="operator">subst</span> sq_mtx_inv_idempotent<span class="main"><span class="main">[</span></span><span class="operator">OF</span> assms<span class="main"><span class="main">(</span></span>1<span class="main"><span class="main">)</span></span><span class="main"><span class="main">,</span></span> <span class="operator">symmetric</span><span class="main"><span class="main">]</span></span><span class="main">)</span>
  <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="main">(</span><span class="operator">rule</span> exp_scaleR_diagonal1<span class="main">)</span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp_all</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> assms<span class="main">)</span>


<span class="keyword1"><span class="command">subsection</span></span> <span class="quoted"><span class="plain_text">‚Äπ Examples ‚Ä∫</span></span>

<span class="keyword1"><span class="command">definition</span></span> <span class="quoted"><span class="quoted">"<span class="free">mtx</span> <span class="free"><span class="bound"><span class="entity">A</span></span></span> <span class="main">=</span> to_mtx <span class="main">(</span>vector <span class="main">(</span>map vector <span class="free"><span class="bound"><span class="entity">A</span></span></span><span class="main">)</span><span class="main">)</span>"</span></span>

<span class="keyword1"><span class="command">lemma</span></span> vector_nth_eq<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span>vector <span class="free">A</span><span class="main">)</span> <span class="main">$</span> <span class="free">i</span> <span class="main">=</span> foldr <span class="main">(</span><span class="main">Œª</span><span class="bound">x</span> <span class="bound">f</span> <span class="bound">n</span><span class="main">.</span> <span class="main">(</span><span class="bound">f</span> <span class="main">(</span><span class="bound">n</span> <span class="main">+</span> <span class="main">1</span><span class="main">)</span><span class="main">)</span><span class="main">(</span><span class="bound">n</span> <span class="main">:=</span> <span class="bound">x</span><span class="main">)</span><span class="main">)</span> <span class="free">A</span> <span class="main">(</span><span class="main">Œª</span><span class="bound">n</span> <span class="bound">x</span><span class="main">.</span> <span class="main">0</span><span class="main">)</span> <span class="main">1</span> <span class="free">i</span>"</span></span>
  <span class="keyword1"><span class="command">unfolding</span></span> vector_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>

<span class="keyword1"><span class="command">lemma</span></span> mtx_ith_eq<span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"mtx <span class="free">A</span> <span class="main">$$</span> <span class="free">i</span> <span class="main">$</span> <span class="free">j</span> <span class="main">=</span> foldr <span class="main">(</span><span class="main">Œª</span><span class="bound">x</span> <span class="bound">f</span> <span class="bound">n</span><span class="main">.</span> <span class="main">(</span><span class="bound">f</span> <span class="main">(</span><span class="bound">n</span> <span class="main">+</span> <span class="main">1</span><span class="main">)</span><span class="main">)</span><span class="main">(</span><span class="bound">n</span> <span class="main">:=</span> <span class="bound">x</span><span class="main">)</span><span class="main">)</span>
  <span class="main">(</span>map <span class="main">(</span><span class="main">Œª</span><span class="bound">l</span><span class="main">.</span> vec_lambda <span class="main">(</span>foldr <span class="main">(</span><span class="main">Œª</span><span class="bound">x</span> <span class="bound">f</span> <span class="bound">n</span><span class="main">.</span> <span class="main">(</span><span class="bound">f</span> <span class="main">(</span><span class="bound">n</span> <span class="main">+</span> <span class="main">1</span><span class="main">)</span><span class="main">)</span><span class="main">(</span><span class="bound">n</span> <span class="main">:=</span> <span class="bound">x</span><span class="main">)</span><span class="main">)</span> <span class="bound">l</span> <span class="main">(</span><span class="main">Œª</span><span class="bound">n</span> <span class="bound">x</span><span class="main">.</span> <span class="main">0</span><span class="main">)</span> <span class="main">1</span><span class="main">)</span><span class="main">)</span> <span class="free">A</span><span class="main">)</span> <span class="main">(</span><span class="main">Œª</span><span class="bound">n</span> <span class="bound">x</span><span class="main">.</span> <span class="main">0</span><span class="main">)</span> <span class="main">1</span> <span class="free">i</span> <span class="main">$</span> <span class="free">j</span>"</span></span>
  <span class="keyword1"><span class="command">unfolding</span></span> mtx_def vector_def <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> vector_nth_eq<span class="main">)</span>

<span class="keyword1"><span class="command">subsubsection</span></span> <span class="quoted"><span class="plain_text">‚Äπ 2x2 matrices ‚Ä∫</span></span>

<span class="keyword1"><span class="command">lemma</span></span> mtx2_eq_iff<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span>mtx 
  <span class="main">(</span><span class="main">[</span><span class="free">a1</span><span class="main">,</span> <span class="free">b1</span><span class="main">]</span> <span class="main">#</span> 
   <span class="main">[</span><span class="free">c1</span><span class="main">,</span> <span class="free">d1</span><span class="main">]</span> <span class="main">#</span> <span class="main">[]</span><span class="main">)</span> <span class="main">::</span> <span class="numeral">2</span> sq_mtx<span class="main">)</span> <span class="main">=</span> mtx 
  <span class="main">(</span><span class="main">[</span><span class="free">a2</span><span class="main">,</span> <span class="free">b2</span><span class="main">]</span> <span class="main">#</span> 
   <span class="main">[</span><span class="free">c2</span><span class="main">,</span> <span class="free">d2</span><span class="main">]</span> <span class="main">#</span> <span class="main">[]</span><span class="main">)</span> <span class="main">‚ü∑</span> <span class="free">a1</span> <span class="main">=</span> <span class="free">a2</span> <span class="main">‚àß</span> <span class="free">b1</span> <span class="main">=</span> <span class="free">b2</span> <span class="main">‚àß</span> <span class="free">c1</span> <span class="main">=</span> <span class="free">c2</span> <span class="main">‚àß</span> <span class="free">d1</span> <span class="main">=</span> <span class="free">d2</span>"</span></span>
  <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> sq_mtx_eq_iff<span class="main"><span class="keyword3">,</span></span> <span class="operator">safe</span><span class="main">)</span>
  <span class="keyword1"><span class="command">using</span></span> exhaust_2 <span class="keyword1"><span class="command">by</span></span> <span class="operator">force</span><span class="main"><span class="keyword3">+</span></span>

<span class="keyword1"><span class="command">lemma</span></span> mtx2_to_mtx<span class="main">:</span> <span class="quoted"><span class="quoted">"mtx 
  <span class="main">(</span><span class="main">[</span><span class="free">a</span><span class="main">,</span> <span class="free">b</span><span class="main">]</span> <span class="main">#</span> 
   <span class="main">[</span><span class="free">c</span><span class="main">,</span> <span class="free">d</span><span class="main">]</span> <span class="main">#</span> <span class="main">[]</span><span class="main">)</span> <span class="main">=</span> 
  to_mtx <span class="main">(</span><span class="keyword1">œá</span> <span class="bound">i</span> <span class="bound">j</span><span class="main">::</span><span class="numeral">2</span><span class="main">.</span> <span class="keyword1">if</span> <span class="bound">i</span><span class="main">=</span><span class="main">1</span> <span class="main">‚àß</span> <span class="bound">j</span><span class="main">=</span><span class="main">1</span> <span class="keyword1">then</span> <span class="free">a</span> 
  <span class="keyword1">else</span> <span class="main">(</span><span class="keyword1">if</span> <span class="bound">i</span><span class="main">=</span><span class="main">1</span> <span class="main">‚àß</span> <span class="bound">j</span><span class="main">=</span><span class="numeral">2</span> <span class="keyword1">then</span> <span class="free">b</span> 
  <span class="keyword1">else</span> <span class="main">(</span><span class="keyword1">if</span> <span class="bound">i</span><span class="main">=</span><span class="numeral">2</span> <span class="main">‚àß</span> <span class="bound">j</span><span class="main">=</span><span class="main">1</span> <span class="keyword1">then</span> <span class="free">c</span> 
  <span class="keyword1">else</span> <span class="free">d</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="main">(</span><span class="operator">subst</span> sq_mtx_eq_iff<span class="main">)</span>
  <span class="keyword1"><span class="command">using</span></span> exhaust_2 <span class="keyword1"><span class="command">by</span></span> <span class="operator">force</span>

<span class="keyword1"><span class="command">abbreviation</span></span> <span class="entity">diag2</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"real <span class="main">‚áí</span> real <span class="main">‚áí</span> <span class="numeral">2</span> sq_mtx"</span></span> 
  <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="free">diag2</span> <span class="free"><span class="bound"><span class="entity">Œπ<span class="hidden">‚á©</span><sub>1</sub></span></span></span> <span class="free"><span class="bound"><span class="entity">Œπ<span class="hidden">‚á©</span><sub>2</sub></span></span></span> <span class="main">‚â°</span> mtx 
   <span class="main">(</span><span class="main">[</span><span class="free"><span class="bound"><span class="entity">Œπ<span class="hidden">‚á©</span><sub>1</sub></span></span></span><span class="main">,</span> <span class="main">0</span><span class="main">]</span> <span class="main">#</span> 
    <span class="main">[</span><span class="main">0</span><span class="main">,</span> <span class="free"><span class="bound"><span class="entity">Œπ<span class="hidden">‚á©</span><sub>2</sub></span></span></span><span class="main">]</span> <span class="main">#</span> <span class="main">[]</span><span class="main">)</span>"</span></span>

<span class="keyword1"><span class="command">lemma</span></span> diag2_eq<span class="main">:</span> <span class="quoted"><span class="quoted">"diag2 <span class="main">(</span><span class="free">Œπ</span> <span class="main">1</span><span class="main">)</span> <span class="main">(</span><span class="free">Œπ</span> <span class="numeral">2</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="keyword1">ùñΩùóÇùñ∫ùóÄ</span> <span class="bound">i</span><span class="main">.</span> <span class="free">Œπ</span> <span class="bound">i</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> sq_mtx_eq_iff<span class="main">)</span>
  <span class="keyword1"><span class="command">using</span></span> exhaust_2 <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">force</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> axis_def<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> one_mtx2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">1</span><span class="main">::</span><span class="numeral">2</span> sq_mtx<span class="main">)</span> <span class="main">=</span> diag2 <span class="main">1</span> <span class="main">1</span>"</span></span>
  <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="main">(</span><span class="operator">subst</span> sq_mtx_eq_iff<span class="main">)</span>
  <span class="keyword1"><span class="command">using</span></span> exhaust_2 <span class="keyword1"><span class="command">by</span></span> <span class="operator">force</span>

<span class="keyword1"><span class="command">lemma</span></span> zero_mtx2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">0</span><span class="main">::</span><span class="numeral">2</span> sq_mtx<span class="main">)</span> <span class="main">=</span> diag2 <span class="main">0</span> <span class="main">0</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> sq_mtx_eq_iff<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> scaleR_mtx2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">k</span> <span class="keyword1">*<span class="hidden">‚á©</span><sub>R</sub></span> mtx 
  <span class="main">(</span><span class="main">[</span><span class="free">a</span><span class="main">,</span> <span class="free">b</span><span class="main">]</span> <span class="main">#</span> 
   <span class="main">[</span><span class="free">c</span><span class="main">,</span> <span class="free">d</span><span class="main">]</span> <span class="main">#</span> <span class="main">[]</span><span class="main">)</span> <span class="main">=</span> mtx 
  <span class="main">(</span><span class="main">[</span><span class="free">k</span><span class="main">*</span><span class="free">a</span><span class="main">,</span> <span class="free">k</span><span class="main">*</span><span class="free">b</span><span class="main">]</span> <span class="main">#</span> 
   <span class="main">[</span><span class="free">k</span><span class="main">*</span><span class="free">c</span><span class="main">,</span> <span class="free">k</span><span class="main">*</span><span class="free">d</span><span class="main">]</span> <span class="main">#</span> <span class="main">[]</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> sq_mtx_eq_iff<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> uminus_mtx2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">-</span>mtx 
  <span class="main">(</span><span class="main">[</span><span class="free">a</span><span class="main">,</span> <span class="free">b</span><span class="main">]</span> <span class="main">#</span> 
   <span class="main">[</span><span class="free">c</span><span class="main">,</span> <span class="free">d</span><span class="main">]</span> <span class="main">#</span> <span class="main">[]</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span>mtx 
  <span class="main">(</span><span class="main">[</span><span class="main">-</span><span class="free">a</span><span class="main">,</span> <span class="main">-</span><span class="free">b</span><span class="main">]</span> <span class="main">#</span> 
   <span class="main">[</span><span class="main">-</span><span class="free">c</span><span class="main">,</span> <span class="main">-</span><span class="free">d</span><span class="main">]</span> <span class="main">#</span> <span class="main">[]</span><span class="main">)</span><span class="main">::</span><span class="numeral">2</span> sq_mtx<span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> sq_mtx_uminus_eq sq_mtx_eq_iff<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> plus_mtx2<span class="main">:</span> <span class="quoted"><span class="quoted">"mtx 
  <span class="main">(</span><span class="main">[</span><span class="free">a1</span><span class="main">,</span> <span class="free">b1</span><span class="main">]</span> <span class="main">#</span> 
   <span class="main">[</span><span class="free">c1</span><span class="main">,</span> <span class="free">d1</span><span class="main">]</span> <span class="main">#</span> <span class="main">[]</span><span class="main">)</span> <span class="main">+</span> mtx 
  <span class="main">(</span><span class="main">[</span><span class="free">a2</span><span class="main">,</span> <span class="free">b2</span><span class="main">]</span> <span class="main">#</span> 
   <span class="main">[</span><span class="free">c2</span><span class="main">,</span> <span class="free">d2</span><span class="main">]</span> <span class="main">#</span> <span class="main">[]</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="main">(</span>mtx 
  <span class="main">(</span><span class="main">[</span><span class="free">a1</span><span class="main">+</span><span class="free">a2</span><span class="main">,</span> <span class="free">b1</span><span class="main">+</span><span class="free">b2</span><span class="main">]</span> <span class="main">#</span> 
   <span class="main">[</span><span class="free">c1</span><span class="main">+</span><span class="free">c2</span><span class="main">,</span> <span class="free">d1</span><span class="main">+</span><span class="free">d2</span><span class="main">]</span> <span class="main">#</span> <span class="main">[]</span><span class="main">)</span><span class="main">)</span><span class="main">::</span><span class="numeral">2</span> sq_mtx<span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> sq_mtx_eq_iff<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> minus_mtx2<span class="main">:</span> <span class="quoted"><span class="quoted">"mtx 
  <span class="main">(</span><span class="main">[</span><span class="free">a1</span><span class="main">,</span> <span class="free">b1</span><span class="main">]</span> <span class="main">#</span> 
   <span class="main">[</span><span class="free">c1</span><span class="main">,</span> <span class="free">d1</span><span class="main">]</span> <span class="main">#</span> <span class="main">[]</span><span class="main">)</span> <span class="main">-</span> mtx 
  <span class="main">(</span><span class="main">[</span><span class="free">a2</span><span class="main">,</span> <span class="free">b2</span><span class="main">]</span> <span class="main">#</span> 
   <span class="main">[</span><span class="free">c2</span><span class="main">,</span> <span class="free">d2</span><span class="main">]</span> <span class="main">#</span> <span class="main">[]</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="main">(</span>mtx 
  <span class="main">(</span><span class="main">[</span><span class="free">a1</span><span class="main">-</span><span class="free">a2</span><span class="main">,</span> <span class="free">b1</span><span class="main">-</span><span class="free">b2</span><span class="main">]</span> <span class="main">#</span> 
   <span class="main">[</span><span class="free">c1</span><span class="main">-</span><span class="free">c2</span><span class="main">,</span> <span class="free">d1</span><span class="main">-</span><span class="free">d2</span><span class="main">]</span> <span class="main">#</span> <span class="main">[]</span><span class="main">)</span><span class="main">)</span><span class="main">::</span><span class="numeral">2</span> sq_mtx<span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> sq_mtx_eq_iff<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> times_mtx2<span class="main">:</span> <span class="quoted"><span class="quoted">"mtx 
  <span class="main">(</span><span class="main">[</span><span class="free">a1</span><span class="main">,</span> <span class="free">b1</span><span class="main">]</span> <span class="main">#</span> 
   <span class="main">[</span><span class="free">c1</span><span class="main">,</span> <span class="free">d1</span><span class="main">]</span> <span class="main">#</span> <span class="main">[]</span><span class="main">)</span> <span class="main">*</span> mtx 
  <span class="main">(</span><span class="main">[</span><span class="free">a2</span><span class="main">,</span> <span class="free">b2</span><span class="main">]</span> <span class="main">#</span> 
   <span class="main">[</span><span class="free">c2</span><span class="main">,</span> <span class="free">d2</span><span class="main">]</span> <span class="main">#</span> <span class="main">[]</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="main">(</span>mtx 
  <span class="main">(</span><span class="main">[</span><span class="free">a1</span><span class="main">*</span><span class="free">a2</span><span class="main">+</span><span class="free">b1</span><span class="main">*</span><span class="free">c2</span><span class="main">,</span> <span class="free">a1</span><span class="main">*</span><span class="free">b2</span><span class="main">+</span><span class="free">b1</span><span class="main">*</span><span class="free">d2</span><span class="main">]</span> <span class="main">#</span> 
   <span class="main">[</span><span class="free">c1</span><span class="main">*</span><span class="free">a2</span><span class="main">+</span><span class="free">d1</span><span class="main">*</span><span class="free">c2</span><span class="main">,</span> <span class="free">c1</span><span class="main">*</span><span class="free">b2</span><span class="main">+</span><span class="free">d1</span><span class="main">*</span><span class="free">d2</span><span class="main">]</span> <span class="main">#</span> <span class="main">[]</span><span class="main">)</span><span class="main">)</span><span class="main">::</span><span class="numeral">2</span> sq_mtx<span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">unfolding</span></span> sq_mtx_times_eq UNIV_2
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> sq_mtx_eq_iff<span class="main">)</span>

<span class="keyword1"><span class="command">subsubsection</span></span> <span class="quoted"><span class="plain_text">‚Äπ 3x3 matrices ‚Ä∫</span></span>

<span class="keyword1"><span class="command">lemma</span></span> mtx3_to_mtx<span class="main">:</span> <span class="quoted"><span class="quoted">"mtx 
  <span class="main">(</span><span class="main">[</span><span class="free">a<span class="hidden">‚á©</span><sub>1</sub><span class="hidden">‚á©</span><sub>1</sub></span><span class="main">,</span> <span class="free">a<span class="hidden">‚á©</span><sub>1</sub><span class="hidden">‚á©</span><sub>2</sub></span><span class="main">,</span> <span class="free">a<span class="hidden">‚á©</span><sub>1</sub><span class="hidden">‚á©</span><sub>3</sub></span><span class="main">]</span> <span class="main">#</span> 
   <span class="main">[</span><span class="free">a<span class="hidden">‚á©</span><sub>2</sub><span class="hidden">‚á©</span><sub>1</sub></span><span class="main">,</span> <span class="free">a<span class="hidden">‚á©</span><sub>2</sub><span class="hidden">‚á©</span><sub>2</sub></span><span class="main">,</span> <span class="free">a<span class="hidden">‚á©</span><sub>2</sub><span class="hidden">‚á©</span><sub>3</sub></span><span class="main">]</span> <span class="main">#</span> 
   <span class="main">[</span><span class="free">a<span class="hidden">‚á©</span><sub>3</sub><span class="hidden">‚á©</span><sub>1</sub></span><span class="main">,</span> <span class="free">a<span class="hidden">‚á©</span><sub>3</sub><span class="hidden">‚á©</span><sub>2</sub></span><span class="main">,</span> <span class="free">a<span class="hidden">‚á©</span><sub>3</sub><span class="hidden">‚á©</span><sub>3</sub></span><span class="main">]</span> <span class="main">#</span> <span class="main">[]</span><span class="main">)</span> <span class="main">=</span> 
  to_mtx <span class="main">(</span><span class="keyword1">œá</span> <span class="bound">i</span> <span class="bound">j</span><span class="main">::</span><span class="numeral">3</span><span class="main">.</span> <span class="keyword1">if</span> <span class="bound">i</span><span class="main">=</span><span class="main">1</span> <span class="main">‚àß</span> <span class="bound">j</span><span class="main">=</span><span class="main">1</span> <span class="keyword1">then</span> <span class="free">a<span class="hidden">‚á©</span><sub>1</sub><span class="hidden">‚á©</span><sub>1</sub></span>
  <span class="keyword1">else</span> <span class="main">(</span><span class="keyword1">if</span> <span class="bound">i</span><span class="main">=</span><span class="main">1</span> <span class="main">‚àß</span> <span class="bound">j</span><span class="main">=</span><span class="numeral">2</span> <span class="keyword1">then</span> <span class="free">a<span class="hidden">‚á©</span><sub>1</sub><span class="hidden">‚á©</span><sub>2</sub></span> 
  <span class="keyword1">else</span> <span class="main">(</span><span class="keyword1">if</span> <span class="bound">i</span><span class="main">=</span><span class="main">1</span> <span class="main">‚àß</span> <span class="bound">j</span><span class="main">=</span><span class="numeral">3</span> <span class="keyword1">then</span> <span class="free">a<span class="hidden">‚á©</span><sub>1</sub><span class="hidden">‚á©</span><sub>3</sub></span> 
  <span class="keyword1">else</span> <span class="main">(</span><span class="keyword1">if</span> <span class="bound">i</span><span class="main">=</span><span class="numeral">2</span> <span class="main">‚àß</span> <span class="bound">j</span><span class="main">=</span><span class="main">1</span> <span class="keyword1">then</span> <span class="free">a<span class="hidden">‚á©</span><sub>2</sub><span class="hidden">‚á©</span><sub>1</sub></span>
  <span class="keyword1">else</span> <span class="main">(</span><span class="keyword1">if</span> <span class="bound">i</span><span class="main">=</span><span class="numeral">2</span> <span class="main">‚àß</span> <span class="bound">j</span><span class="main">=</span><span class="numeral">2</span> <span class="keyword1">then</span> <span class="free">a<span class="hidden">‚á©</span><sub>2</sub><span class="hidden">‚á©</span><sub>2</sub></span> 
  <span class="keyword1">else</span> <span class="main">(</span><span class="keyword1">if</span> <span class="bound">i</span><span class="main">=</span><span class="numeral">2</span> <span class="main">‚àß</span> <span class="bound">j</span><span class="main">=</span><span class="numeral">3</span> <span class="keyword1">then</span> <span class="free">a<span class="hidden">‚á©</span><sub>2</sub><span class="hidden">‚á©</span><sub>3</sub></span> 
  <span class="keyword1">else</span> <span class="main">(</span><span class="keyword1">if</span> <span class="bound">i</span><span class="main">=</span><span class="numeral">3</span> <span class="main">‚àß</span> <span class="bound">j</span><span class="main">=</span><span class="main">1</span> <span class="keyword1">then</span> <span class="free">a<span class="hidden">‚á©</span><sub>3</sub><span class="hidden">‚á©</span><sub>1</sub></span> 
  <span class="keyword1">else</span> <span class="main">(</span><span class="keyword1">if</span> <span class="bound">i</span><span class="main">=</span><span class="numeral">3</span> <span class="main">‚àß</span> <span class="bound">j</span><span class="main">=</span><span class="numeral">2</span> <span class="keyword1">then</span> <span class="free">a<span class="hidden">‚á©</span><sub>3</sub><span class="hidden">‚á©</span><sub>2</sub></span> 
  <span class="keyword1">else</span> <span class="free">a<span class="hidden">‚á©</span><sub>3</sub><span class="hidden">‚á©</span><sub>3</sub></span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> sq_mtx_eq_iff<span class="main">)</span>
  <span class="keyword1"><span class="command">using</span></span> exhaust_3 <span class="keyword1"><span class="command">by</span></span> <span class="operator">force</span>

<span class="keyword1"><span class="command">abbreviation</span></span> <span class="entity">diag3</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"real <span class="main">‚áí</span> real <span class="main">‚áí</span> real <span class="main">‚áí</span> <span class="numeral">3</span> sq_mtx"</span></span> 
  <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="free">diag3</span> <span class="free"><span class="bound"><span class="entity">Œπ<span class="hidden">‚á©</span><sub>1</sub></span></span></span> <span class="free"><span class="bound"><span class="entity">Œπ<span class="hidden">‚á©</span><sub>2</sub></span></span></span> <span class="free"><span class="bound"><span class="entity">Œπ<span class="hidden">‚á©</span><sub>3</sub></span></span></span> <span class="main">‚â°</span> mtx 
  <span class="main">(</span><span class="main">[</span><span class="free"><span class="bound"><span class="entity">Œπ<span class="hidden">‚á©</span><sub>1</sub></span></span></span><span class="main">,</span> <span class="main">0</span><span class="main">,</span> <span class="main">0</span><span class="main">]</span> <span class="main">#</span> 
   <span class="main">[</span><span class="main">0</span><span class="main">,</span> <span class="free"><span class="bound"><span class="entity">Œπ<span class="hidden">‚á©</span><sub>2</sub></span></span></span><span class="main">,</span> <span class="main">0</span><span class="main">]</span> <span class="main">#</span> 
   <span class="main">[</span><span class="main">0</span><span class="main">,</span> <span class="main">0</span><span class="main">,</span> <span class="free"><span class="bound"><span class="entity">Œπ<span class="hidden">‚á©</span><sub>3</sub></span></span></span><span class="main">]</span> <span class="main">#</span> <span class="main">[]</span><span class="main">)</span>"</span></span>

<span class="keyword1"><span class="command">lemma</span></span> diag3_eq<span class="main">:</span> <span class="quoted"><span class="quoted">"diag3 <span class="main">(</span><span class="free">Œπ</span> <span class="main">1</span><span class="main">)</span> <span class="main">(</span><span class="free">Œπ</span> <span class="numeral">2</span><span class="main">)</span> <span class="main">(</span><span class="free">Œπ</span> <span class="numeral">3</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="keyword1">ùñΩùóÇùñ∫ùóÄ</span> <span class="bound">i</span><span class="main">.</span> <span class="free">Œπ</span> <span class="bound">i</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> sq_mtx_eq_iff<span class="main">)</span>
  <span class="keyword1"><span class="command">using</span></span> exhaust_3 <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">force</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> axis_def<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> one_mtx3<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">1</span><span class="main">::</span><span class="numeral">3</span> sq_mtx<span class="main">)</span> <span class="main">=</span> diag3 <span class="main">1</span> <span class="main">1</span> <span class="main">1</span>"</span></span>
  <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="main">(</span><span class="operator">subst</span> sq_mtx_eq_iff<span class="main">)</span>
  <span class="keyword1"><span class="command">using</span></span> exhaust_3 <span class="keyword1"><span class="command">by</span></span> <span class="operator">force</span>

<span class="keyword1"><span class="command">lemma</span></span> zero_mtx3<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">0</span><span class="main">::</span><span class="numeral">3</span> sq_mtx<span class="main">)</span> <span class="main">=</span> diag3 <span class="main">0</span> <span class="main">0</span> <span class="main">0</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> sq_mtx_eq_iff<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> scaleR_mtx3<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">k</span> <span class="keyword1">*<span class="hidden">‚á©</span><sub>R</sub></span> mtx 
  <span class="main">(</span><span class="main">[</span><span class="free">a<span class="hidden">‚á©</span><sub>1</sub><span class="hidden">‚á©</span><sub>1</sub></span><span class="main">,</span> <span class="free">a<span class="hidden">‚á©</span><sub>1</sub><span class="hidden">‚á©</span><sub>2</sub></span><span class="main">,</span> <span class="free">a<span class="hidden">‚á©</span><sub>1</sub><span class="hidden">‚á©</span><sub>3</sub></span><span class="main">]</span> <span class="main">#</span> 
   <span class="main">[</span><span class="free">a<span class="hidden">‚á©</span><sub>2</sub><span class="hidden">‚á©</span><sub>1</sub></span><span class="main">,</span> <span class="free">a<span class="hidden">‚á©</span><sub>2</sub><span class="hidden">‚á©</span><sub>2</sub></span><span class="main">,</span> <span class="free">a<span class="hidden">‚á©</span><sub>2</sub><span class="hidden">‚á©</span><sub>3</sub></span><span class="main">]</span> <span class="main">#</span> 
   <span class="main">[</span><span class="free">a<span class="hidden">‚á©</span><sub>3</sub><span class="hidden">‚á©</span><sub>1</sub></span><span class="main">,</span> <span class="free">a<span class="hidden">‚á©</span><sub>3</sub><span class="hidden">‚á©</span><sub>2</sub></span><span class="main">,</span> <span class="free">a<span class="hidden">‚á©</span><sub>3</sub><span class="hidden">‚á©</span><sub>3</sub></span><span class="main">]</span> <span class="main">#</span> <span class="main">[]</span><span class="main">)</span> <span class="main">=</span> mtx 
  <span class="main">(</span><span class="main">[</span><span class="free">k</span><span class="main">*</span><span class="free">a<span class="hidden">‚á©</span><sub>1</sub><span class="hidden">‚á©</span><sub>1</sub></span><span class="main">,</span> <span class="free">k</span><span class="main">*</span><span class="free">a<span class="hidden">‚á©</span><sub>1</sub><span class="hidden">‚á©</span><sub>2</sub></span><span class="main">,</span> <span class="free">k</span><span class="main">*</span><span class="free">a<span class="hidden">‚á©</span><sub>1</sub><span class="hidden">‚á©</span><sub>3</sub></span><span class="main">]</span> <span class="main">#</span> 
   <span class="main">[</span><span class="free">k</span><span class="main">*</span><span class="free">a<span class="hidden">‚á©</span><sub>2</sub><span class="hidden">‚á©</span><sub>1</sub></span><span class="main">,</span> <span class="free">k</span><span class="main">*</span><span class="free">a<span class="hidden">‚á©</span><sub>2</sub><span class="hidden">‚á©</span><sub>2</sub></span><span class="main">,</span> <span class="free">k</span><span class="main">*</span><span class="free">a<span class="hidden">‚á©</span><sub>2</sub><span class="hidden">‚á©</span><sub>3</sub></span><span class="main">]</span> <span class="main">#</span> 
   <span class="main">[</span><span class="free">k</span><span class="main">*</span><span class="free">a<span class="hidden">‚á©</span><sub>3</sub><span class="hidden">‚á©</span><sub>1</sub></span><span class="main">,</span> <span class="free">k</span><span class="main">*</span><span class="free">a<span class="hidden">‚á©</span><sub>3</sub><span class="hidden">‚á©</span><sub>2</sub></span><span class="main">,</span> <span class="free">k</span><span class="main">*</span><span class="free">a<span class="hidden">‚á©</span><sub>3</sub><span class="hidden">‚á©</span><sub>3</sub></span><span class="main">]</span> <span class="main">#</span> <span class="main">[]</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> sq_mtx_eq_iff<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> plus_mtx3<span class="main">:</span> <span class="quoted"><span class="quoted">"mtx 
  <span class="main">(</span><span class="main">[</span><span class="free">a<span class="hidden">‚á©</span><sub>1</sub><span class="hidden">‚á©</span><sub>1</sub></span><span class="main">,</span> <span class="free">a<span class="hidden">‚á©</span><sub>1</sub><span class="hidden">‚á©</span><sub>2</sub></span><span class="main">,</span> <span class="free">a<span class="hidden">‚á©</span><sub>1</sub><span class="hidden">‚á©</span><sub>3</sub></span><span class="main">]</span> <span class="main">#</span> 
   <span class="main">[</span><span class="free">a<span class="hidden">‚á©</span><sub>2</sub><span class="hidden">‚á©</span><sub>1</sub></span><span class="main">,</span> <span class="free">a<span class="hidden">‚á©</span><sub>2</sub><span class="hidden">‚á©</span><sub>2</sub></span><span class="main">,</span> <span class="free">a<span class="hidden">‚á©</span><sub>2</sub><span class="hidden">‚á©</span><sub>3</sub></span><span class="main">]</span> <span class="main">#</span> 
   <span class="main">[</span><span class="free">a<span class="hidden">‚á©</span><sub>3</sub><span class="hidden">‚á©</span><sub>1</sub></span><span class="main">,</span> <span class="free">a<span class="hidden">‚á©</span><sub>3</sub><span class="hidden">‚á©</span><sub>2</sub></span><span class="main">,</span> <span class="free">a<span class="hidden">‚á©</span><sub>3</sub><span class="hidden">‚á©</span><sub>3</sub></span><span class="main">]</span> <span class="main">#</span> <span class="main">[]</span><span class="main">)</span> <span class="main">+</span> mtx 
  <span class="main">(</span><span class="main">[</span><span class="free">b<span class="hidden">‚á©</span><sub>1</sub><span class="hidden">‚á©</span><sub>1</sub></span><span class="main">,</span> <span class="free">b<span class="hidden">‚á©</span><sub>1</sub><span class="hidden">‚á©</span><sub>2</sub></span><span class="main">,</span> <span class="free">b<span class="hidden">‚á©</span><sub>1</sub><span class="hidden">‚á©</span><sub>3</sub></span><span class="main">]</span> <span class="main">#</span> 
   <span class="main">[</span><span class="free">b<span class="hidden">‚á©</span><sub>2</sub><span class="hidden">‚á©</span><sub>1</sub></span><span class="main">,</span> <span class="free">b<span class="hidden">‚á©</span><sub>2</sub><span class="hidden">‚á©</span><sub>2</sub></span><span class="main">,</span> <span class="free">b<span class="hidden">‚á©</span><sub>2</sub><span class="hidden">‚á©</span><sub>3</sub></span><span class="main">]</span> <span class="main">#</span> 
   <span class="main">[</span><span class="free">b<span class="hidden">‚á©</span><sub>3</sub><span class="hidden">‚á©</span><sub>1</sub></span><span class="main">,</span> <span class="free">b<span class="hidden">‚á©</span><sub>3</sub><span class="hidden">‚á©</span><sub>2</sub></span><span class="main">,</span> <span class="free">b<span class="hidden">‚á©</span><sub>3</sub><span class="hidden">‚á©</span><sub>3</sub></span><span class="main">]</span> <span class="main">#</span> <span class="main">[]</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span>mtx 
  <span class="main">(</span><span class="main">[</span><span class="free">a<span class="hidden">‚á©</span><sub>1</sub><span class="hidden">‚á©</span><sub>1</sub></span><span class="main">+</span><span class="free">b<span class="hidden">‚á©</span><sub>1</sub><span class="hidden">‚á©</span><sub>1</sub></span><span class="main">,</span> <span class="free">a<span class="hidden">‚á©</span><sub>1</sub><span class="hidden">‚á©</span><sub>2</sub></span><span class="main">+</span><span class="free">b<span class="hidden">‚á©</span><sub>1</sub><span class="hidden">‚á©</span><sub>2</sub></span><span class="main">,</span> <span class="free">a<span class="hidden">‚á©</span><sub>1</sub><span class="hidden">‚á©</span><sub>3</sub></span><span class="main">+</span><span class="free">b<span class="hidden">‚á©</span><sub>1</sub><span class="hidden">‚á©</span><sub>3</sub></span><span class="main">]</span> <span class="main">#</span> 
   <span class="main">[</span><span class="free">a<span class="hidden">‚á©</span><sub>2</sub><span class="hidden">‚á©</span><sub>1</sub></span><span class="main">+</span><span class="free">b<span class="hidden">‚á©</span><sub>2</sub><span class="hidden">‚á©</span><sub>1</sub></span><span class="main">,</span> <span class="free">a<span class="hidden">‚á©</span><sub>2</sub><span class="hidden">‚á©</span><sub>2</sub></span><span class="main">+</span><span class="free">b<span class="hidden">‚á©</span><sub>2</sub><span class="hidden">‚á©</span><sub>2</sub></span><span class="main">,</span> <span class="free">a<span class="hidden">‚á©</span><sub>2</sub><span class="hidden">‚á©</span><sub>3</sub></span><span class="main">+</span><span class="free">b<span class="hidden">‚á©</span><sub>2</sub><span class="hidden">‚á©</span><sub>3</sub></span><span class="main">]</span> <span class="main">#</span> 
   <span class="main">[</span><span class="free">a<span class="hidden">‚á©</span><sub>3</sub><span class="hidden">‚á©</span><sub>1</sub></span><span class="main">+</span><span class="free">b<span class="hidden">‚á©</span><sub>3</sub><span class="hidden">‚á©</span><sub>1</sub></span><span class="main">,</span> <span class="free">a<span class="hidden">‚á©</span><sub>3</sub><span class="hidden">‚á©</span><sub>2</sub></span><span class="main">+</span><span class="free">b<span class="hidden">‚á©</span><sub>3</sub><span class="hidden">‚á©</span><sub>2</sub></span><span class="main">,</span> <span class="free">a<span class="hidden">‚á©</span><sub>3</sub><span class="hidden">‚á©</span><sub>3</sub></span><span class="main">+</span><span class="free">b<span class="hidden">‚á©</span><sub>3</sub><span class="hidden">‚á©</span><sub>3</sub></span><span class="main">]</span> <span class="main">#</span> <span class="main">[]</span><span class="main">)</span><span class="main">::</span><span class="numeral">3</span> sq_mtx<span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">subst</span> sq_mtx_eq_iff<span class="main">)</span> <span class="operator">simp</span>

<span class="keyword1"><span class="command">lemma</span></span> minus_mtx3<span class="main">:</span> <span class="quoted"><span class="quoted">"mtx 
  <span class="main">(</span><span class="main">[</span><span class="free">a<span class="hidden">‚á©</span><sub>1</sub><span class="hidden">‚á©</span><sub>1</sub></span><span class="main">,</span> <span class="free">a<span class="hidden">‚á©</span><sub>1</sub><span class="hidden">‚á©</span><sub>2</sub></span><span class="main">,</span> <span class="free">a<span class="hidden">‚á©</span><sub>1</sub><span class="hidden">‚á©</span><sub>3</sub></span><span class="main">]</span> <span class="main">#</span> 
   <span class="main">[</span><span class="free">a<span class="hidden">‚á©</span><sub>2</sub><span class="hidden">‚á©</span><sub>1</sub></span><span class="main">,</span> <span class="free">a<span class="hidden">‚á©</span><sub>2</sub><span class="hidden">‚á©</span><sub>2</sub></span><span class="main">,</span> <span class="free">a<span class="hidden">‚á©</span><sub>2</sub><span class="hidden">‚á©</span><sub>3</sub></span><span class="main">]</span> <span class="main">#</span> 
   <span class="main">[</span><span class="free">a<span class="hidden">‚á©</span><sub>3</sub><span class="hidden">‚á©</span><sub>1</sub></span><span class="main">,</span> <span class="free">a<span class="hidden">‚á©</span><sub>3</sub><span class="hidden">‚á©</span><sub>2</sub></span><span class="main">,</span> <span class="free">a<span class="hidden">‚á©</span><sub>3</sub><span class="hidden">‚á©</span><sub>3</sub></span><span class="main">]</span> <span class="main">#</span> <span class="main">[]</span><span class="main">)</span> <span class="main">-</span> mtx 
  <span class="main">(</span><span class="main">[</span><span class="free">b<span class="hidden">‚á©</span><sub>1</sub><span class="hidden">‚á©</span><sub>1</sub></span><span class="main">,</span> <span class="free">b<span class="hidden">‚á©</span><sub>1</sub><span class="hidden">‚á©</span><sub>2</sub></span><span class="main">,</span> <span class="free">b<span class="hidden">‚á©</span><sub>1</sub><span class="hidden">‚á©</span><sub>3</sub></span><span class="main">]</span> <span class="main">#</span> 
   <span class="main">[</span><span class="free">b<span class="hidden">‚á©</span><sub>2</sub><span class="hidden">‚á©</span><sub>1</sub></span><span class="main">,</span> <span class="free">b<span class="hidden">‚á©</span><sub>2</sub><span class="hidden">‚á©</span><sub>2</sub></span><span class="main">,</span> <span class="free">b<span class="hidden">‚á©</span><sub>2</sub><span class="hidden">‚á©</span><sub>3</sub></span><span class="main">]</span> <span class="main">#</span> 
   <span class="main">[</span><span class="free">b<span class="hidden">‚á©</span><sub>3</sub><span class="hidden">‚á©</span><sub>1</sub></span><span class="main">,</span> <span class="free">b<span class="hidden">‚á©</span><sub>3</sub><span class="hidden">‚á©</span><sub>2</sub></span><span class="main">,</span> <span class="free">b<span class="hidden">‚á©</span><sub>3</sub><span class="hidden">‚á©</span><sub>3</sub></span><span class="main">]</span> <span class="main">#</span> <span class="main">[]</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span>mtx 
  <span class="main">(</span><span class="main">[</span><span class="free">a<span class="hidden">‚á©</span><sub>1</sub><span class="hidden">‚á©</span><sub>1</sub></span><span class="main">-</span><span class="free">b<span class="hidden">‚á©</span><sub>1</sub><span class="hidden">‚á©</span><sub>1</sub></span><span class="main">,</span> <span class="free">a<span class="hidden">‚á©</span><sub>1</sub><span class="hidden">‚á©</span><sub>2</sub></span><span class="main">-</span><span class="free">b<span class="hidden">‚á©</span><sub>1</sub><span class="hidden">‚á©</span><sub>2</sub></span><span class="main">,</span> <span class="free">a<span class="hidden">‚á©</span><sub>1</sub><span class="hidden">‚á©</span><sub>3</sub></span><span class="main">-</span><span class="free">b<span class="hidden">‚á©</span><sub>1</sub><span class="hidden">‚á©</span><sub>3</sub></span><span class="main">]</span> <span class="main">#</span> 
   <span class="main">[</span><span class="free">a<span class="hidden">‚á©</span><sub>2</sub><span class="hidden">‚á©</span><sub>1</sub></span><span class="main">-</span><span class="free">b<span class="hidden">‚á©</span><sub>2</sub><span class="hidden">‚á©</span><sub>1</sub></span><span class="main">,</span> <span class="free">a<span class="hidden">‚á©</span><sub>2</sub><span class="hidden">‚á©</span><sub>2</sub></span><span class="main">-</span><span class="free">b<span class="hidden">‚á©</span><sub>2</sub><span class="hidden">‚á©</span><sub>2</sub></span><span class="main">,</span> <span class="free">a<span class="hidden">‚á©</span><sub>2</sub><span class="hidden">‚á©</span><sub>3</sub></span><span class="main">-</span><span class="free">b<span class="hidden">‚á©</span><sub>2</sub><span class="hidden">‚á©</span><sub>3</sub></span><span class="main">]</span> <span class="main">#</span> 
   <span class="main">[</span><span class="free">a<span class="hidden">‚á©</span><sub>3</sub><span class="hidden">‚á©</span><sub>1</sub></span><span class="main">-</span><span class="free">b<span class="hidden">‚á©</span><sub>3</sub><span class="hidden">‚á©</span><sub>1</sub></span><span class="main">,</span> <span class="free">a<span class="hidden">‚á©</span><sub>3</sub><span class="hidden">‚á©</span><sub>2</sub></span><span class="main">-</span><span class="free">b<span class="hidden">‚á©</span><sub>3</sub><span class="hidden">‚á©</span><sub>2</sub></span><span class="main">,</span> <span class="free">a<span class="hidden">‚á©</span><sub>3</sub><span class="hidden">‚á©</span><sub>3</sub></span><span class="main">-</span><span class="free">b<span class="hidden">‚á©</span><sub>3</sub><span class="hidden">‚á©</span><sub>3</sub></span><span class="main">]</span> <span class="main">#</span> <span class="main">[]</span><span class="main">)</span><span class="main">::</span><span class="numeral">3</span> sq_mtx<span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> sq_mtx_eq_iff<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> times_mtx3<span class="main">:</span> <span class="quoted"><span class="quoted">"mtx 
  <span class="main">(</span><span class="main">[</span><span class="free">a<span class="hidden">‚á©</span><sub>1</sub><span class="hidden">‚á©</span><sub>1</sub></span><span class="main">,</span> <span class="free">a<span class="hidden">‚á©</span><sub>1</sub><span class="hidden">‚á©</span><sub>2</sub></span><span class="main">,</span> <span class="free">a<span class="hidden">‚á©</span><sub>1</sub><span class="hidden">‚á©</span><sub>3</sub></span><span class="main">]</span> <span class="main">#</span> 
   <span class="main">[</span><span class="free">a<span class="hidden">‚á©</span><sub>2</sub><span class="hidden">‚á©</span><sub>1</sub></span><span class="main">,</span> <span class="free">a<span class="hidden">‚á©</span><sub>2</sub><span class="hidden">‚á©</span><sub>2</sub></span><span class="main">,</span> <span class="free">a<span class="hidden">‚á©</span><sub>2</sub><span class="hidden">‚á©</span><sub>3</sub></span><span class="main">]</span> <span class="main">#</span> 
   <span class="main">[</span><span class="free">a<span class="hidden">‚á©</span><sub>3</sub><span class="hidden">‚á©</span><sub>1</sub></span><span class="main">,</span> <span class="free">a<span class="hidden">‚á©</span><sub>3</sub><span class="hidden">‚á©</span><sub>2</sub></span><span class="main">,</span> <span class="free">a<span class="hidden">‚á©</span><sub>3</sub><span class="hidden">‚á©</span><sub>3</sub></span><span class="main">]</span> <span class="main">#</span> <span class="main">[]</span><span class="main">)</span> <span class="main">*</span> mtx 
  <span class="main">(</span><span class="main">[</span><span class="free">b<span class="hidden">‚á©</span><sub>1</sub><span class="hidden">‚á©</span><sub>1</sub></span><span class="main">,</span> <span class="free">b<span class="hidden">‚á©</span><sub>1</sub><span class="hidden">‚á©</span><sub>2</sub></span><span class="main">,</span> <span class="free">b<span class="hidden">‚á©</span><sub>1</sub><span class="hidden">‚á©</span><sub>3</sub></span><span class="main">]</span> <span class="main">#</span> 
   <span class="main">[</span><span class="free">b<span class="hidden">‚á©</span><sub>2</sub><span class="hidden">‚á©</span><sub>1</sub></span><span class="main">,</span> <span class="free">b<span class="hidden">‚á©</span><sub>2</sub><span class="hidden">‚á©</span><sub>2</sub></span><span class="main">,</span> <span class="free">b<span class="hidden">‚á©</span><sub>2</sub><span class="hidden">‚á©</span><sub>3</sub></span><span class="main">]</span> <span class="main">#</span> 
   <span class="main">[</span><span class="free">b<span class="hidden">‚á©</span><sub>3</sub><span class="hidden">‚á©</span><sub>1</sub></span><span class="main">,</span> <span class="free">b<span class="hidden">‚á©</span><sub>3</sub><span class="hidden">‚á©</span><sub>2</sub></span><span class="main">,</span> <span class="free">b<span class="hidden">‚á©</span><sub>3</sub><span class="hidden">‚á©</span><sub>3</sub></span><span class="main">]</span> <span class="main">#</span> <span class="main">[]</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span>mtx 
  <span class="main">(</span><span class="main">[</span><span class="free">a<span class="hidden">‚á©</span><sub>1</sub><span class="hidden">‚á©</span><sub>1</sub></span><span class="main">*</span><span class="free">b<span class="hidden">‚á©</span><sub>1</sub><span class="hidden">‚á©</span><sub>1</sub></span><span class="main">+</span><span class="free">a<span class="hidden">‚á©</span><sub>1</sub><span class="hidden">‚á©</span><sub>2</sub></span><span class="main">*</span><span class="free">b<span class="hidden">‚á©</span><sub>2</sub><span class="hidden">‚á©</span><sub>1</sub></span><span class="main">+</span><span class="free">a<span class="hidden">‚á©</span><sub>1</sub><span class="hidden">‚á©</span><sub>3</sub></span><span class="main">*</span><span class="free">b<span class="hidden">‚á©</span><sub>3</sub><span class="hidden">‚á©</span><sub>1</sub></span><span class="main">,</span> <span class="free">a<span class="hidden">‚á©</span><sub>1</sub><span class="hidden">‚á©</span><sub>1</sub></span><span class="main">*</span><span class="free">b<span class="hidden">‚á©</span><sub>1</sub><span class="hidden">‚á©</span><sub>2</sub></span><span class="main">+</span><span class="free">a<span class="hidden">‚á©</span><sub>1</sub><span class="hidden">‚á©</span><sub>2</sub></span><span class="main">*</span><span class="free">b<span class="hidden">‚á©</span><sub>2</sub><span class="hidden">‚á©</span><sub>2</sub></span><span class="main">+</span><span class="free">a<span class="hidden">‚á©</span><sub>1</sub><span class="hidden">‚á©</span><sub>3</sub></span><span class="main">*</span><span class="free">b<span class="hidden">‚á©</span><sub>3</sub><span class="hidden">‚á©</span><sub>2</sub></span><span class="main">,</span> <span class="free">a<span class="hidden">‚á©</span><sub>1</sub><span class="hidden">‚á©</span><sub>1</sub></span><span class="main">*</span><span class="free">b<span class="hidden">‚á©</span><sub>1</sub><span class="hidden">‚á©</span><sub>3</sub></span><span class="main">+</span><span class="free">a<span class="hidden">‚á©</span><sub>1</sub><span class="hidden">‚á©</span><sub>2</sub></span><span class="main">*</span><span class="free">b<span class="hidden">‚á©</span><sub>2</sub><span class="hidden">‚á©</span><sub>3</sub></span><span class="main">+</span><span class="free">a<span class="hidden">‚á©</span><sub>1</sub><span class="hidden">‚á©</span><sub>3</sub></span><span class="main">*</span><span class="free">b<span class="hidden">‚á©</span><sub>3</sub><span class="hidden">‚á©</span><sub>3</sub></span><span class="main">]</span> <span class="main">#</span> 
   <span class="main">[</span><span class="free">a<span class="hidden">‚á©</span><sub>2</sub><span class="hidden">‚á©</span><sub>1</sub></span><span class="main">*</span><span class="free">b<span class="hidden">‚á©</span><sub>1</sub><span class="hidden">‚á©</span><sub>1</sub></span><span class="main">+</span><span class="free">a<span class="hidden">‚á©</span><sub>2</sub><span class="hidden">‚á©</span><sub>2</sub></span><span class="main">*</span><span class="free">b<span class="hidden">‚á©</span><sub>2</sub><span class="hidden">‚á©</span><sub>1</sub></span><span class="main">+</span><span class="free">a<span class="hidden">‚á©</span><sub>2</sub><span class="hidden">‚á©</span><sub>3</sub></span><span class="main">*</span><span class="free">b<span class="hidden">‚á©</span><sub>3</sub><span class="hidden">‚á©</span><sub>1</sub></span><span class="main">,</span> <span class="free">a<span class="hidden">‚á©</span><sub>2</sub><span class="hidden">‚á©</span><sub>1</sub></span><span class="main">*</span><span class="free">b<span class="hidden">‚á©</span><sub>1</sub><span class="hidden">‚á©</span><sub>2</sub></span><span class="main">+</span><span class="free">a<span class="hidden">‚á©</span><sub>2</sub><span class="hidden">‚á©</span><sub>2</sub></span><span class="main">*</span><span class="free">b<span class="hidden">‚á©</span><sub>2</sub><span class="hidden">‚á©</span><sub>2</sub></span><span class="main">+</span><span class="free">a<span class="hidden">‚á©</span><sub>2</sub><span class="hidden">‚á©</span><sub>3</sub></span><span class="main">*</span><span class="free">b<span class="hidden">‚á©</span><sub>3</sub><span class="hidden">‚á©</span><sub>2</sub></span><span class="main">,</span> <span class="free">a<span class="hidden">‚á©</span><sub>2</sub><span class="hidden">‚á©</span><sub>1</sub></span><span class="main">*</span><span class="free">b<span class="hidden">‚á©</span><sub>1</sub><span class="hidden">‚á©</span><sub>3</sub></span><span class="main">+</span><span class="free">a<span class="hidden">‚á©</span><sub>2</sub><span class="hidden">‚á©</span><sub>2</sub></span><span class="main">*</span><span class="free">b<span class="hidden">‚á©</span><sub>2</sub><span class="hidden">‚á©</span><sub>3</sub></span><span class="main">+</span><span class="free">a<span class="hidden">‚á©</span><sub>2</sub><span class="hidden">‚á©</span><sub>3</sub></span><span class="main">*</span><span class="free">b<span class="hidden">‚á©</span><sub>3</sub><span class="hidden">‚á©</span><sub>3</sub></span><span class="main">]</span> <span class="main">#</span> 
   <span class="main">[</span><span class="free">a<span class="hidden">‚á©</span><sub>3</sub><span class="hidden">‚á©</span><sub>1</sub></span><span class="main">*</span><span class="free">b<span class="hidden">‚á©</span><sub>1</sub><span class="hidden">‚á©</span><sub>1</sub></span><span class="main">+</span><span class="free">a<span class="hidden">‚á©</span><sub>3</sub><span class="hidden">‚á©</span><sub>2</sub></span><span class="main">*</span><span class="free">b<span class="hidden">‚á©</span><sub>2</sub><span class="hidden">‚á©</span><sub>1</sub></span><span class="main">+</span><span class="free">a<span class="hidden">‚á©</span><sub>3</sub><span class="hidden">‚á©</span><sub>3</sub></span><span class="main">*</span><span class="free">b<span class="hidden">‚á©</span><sub>3</sub><span class="hidden">‚á©</span><sub>1</sub></span><span class="main">,</span> <span class="free">a<span class="hidden">‚á©</span><sub>3</sub><span class="hidden">‚á©</span><sub>1</sub></span><span class="main">*</span><span class="free">b<span class="hidden">‚á©</span><sub>1</sub><span class="hidden">‚á©</span><sub>2</sub></span><span class="main">+</span><span class="free">a<span class="hidden">‚á©</span><sub>3</sub><span class="hidden">‚á©</span><sub>2</sub></span><span class="main">*</span><span class="free">b<span class="hidden">‚á©</span><sub>2</sub><span class="hidden">‚á©</span><sub>2</sub></span><span class="main">+</span><span class="free">a<span class="hidden">‚á©</span><sub>3</sub><span class="hidden">‚á©</span><sub>3</sub></span><span class="main">*</span><span class="free">b<span class="hidden">‚á©</span><sub>3</sub><span class="hidden">‚á©</span><sub>2</sub></span><span class="main">,</span> <span class="free">a<span class="hidden">‚á©</span><sub>3</sub><span class="hidden">‚á©</span><sub>1</sub></span><span class="main">*</span><span class="free">b<span class="hidden">‚á©</span><sub>1</sub><span class="hidden">‚á©</span><sub>3</sub></span><span class="main">+</span><span class="free">a<span class="hidden">‚á©</span><sub>3</sub><span class="hidden">‚á©</span><sub>2</sub></span><span class="main">*</span><span class="free">b<span class="hidden">‚á©</span><sub>2</sub><span class="hidden">‚á©</span><sub>3</sub></span><span class="main">+</span><span class="free">a<span class="hidden">‚á©</span><sub>3</sub><span class="hidden">‚á©</span><sub>3</sub></span><span class="main">*</span><span class="free">b<span class="hidden">‚á©</span><sub>3</sub><span class="hidden">‚á©</span><sub>3</sub></span><span class="main">]</span> <span class="main">#</span> <span class="main">[]</span><span class="main">)</span><span class="main">::</span><span class="numeral">3</span> sq_mtx<span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">unfolding</span></span> sq_mtx_times_eq
  <span class="keyword1"><span class="command">unfolding</span></span> UNIV_3 <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> sq_mtx_eq_iff<span class="main">)</span>

<span class="keyword2"><span class="keyword">end</span></span></pre>
</div><div id="MTX_Flows">
<div class="head">
<h1>Theory MTX_Flows</h1>
</div>
<pre class="source"><span class="comment1">(*  Title:       Affine systems of ODEs
    Author:      Jonathan Juli√°n Huerta y Munive, 2020
    Maintainer:  Jonathan Juli√°n Huerta y Munive &lt;jonjulian23@gmail.com&gt;
*)</span>

<span class="keyword1"><span class="command">section</span></span> <span class="quoted"><span class="plain_text">‚Äπ Affine systems of ODEs ‚Ä∫</span></span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‚ÄπAffine systems of ordinary differential equations (ODEs) are those whose vector 
fields are linear operators. Broadly speaking, if there are functions $A$ and $B$ such that the 
system of ODEs $X'\, t = f\, (X\, t)$ turns into $X'\, t = (A\, t)\cdot (X\, t)+(B\, t)$, then it
is affine. The end goal of this section is to prove that every affine system of ODEs has a unique 
solution, and to obtain a characterization of said solution. ‚Ä∫</span></span>

<span class="keyword1"><span class="command">theory</span></span> MTX_Flows
  <span class="keyword2"><span class="keyword">imports</span></span> 
    <a href="SQ_MTX.html">SQ_MTX</a> 
    <a href="../Hybrid_Systems_VCs/HS_ODEs.html">Hybrid_Systems_VCs.HS_ODEs</a>

<span class="keyword2"><span class="keyword">begin</span></span>


<span class="keyword1"><span class="command">subsection</span></span> <span class="quoted"><span class="plain_text">‚Äπ Existence and uniqueness for affine systems ‚Ä∫</span></span>

<span class="keyword1"><span class="command">definition</span></span> <span class="entity">matrix_continuous_on</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"real set <span class="main">‚áí</span> <span class="main">(</span>real <span class="main">‚áí</span> <span class="main">(</span><span class="tfree">'a</span><span class="main">::</span>real_normed_algebra_1<span class="main">)</span><span class="main">^</span><span class="tfree">'n</span><span class="main">^</span><span class="tfree">'m</span><span class="main">)</span> <span class="main">‚áí</span> bool"</span></span> 
  <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="free">matrix_continuous_on</span> <span class="free"><span class="bound"><span class="entity">T</span></span></span> <span class="free"><span class="bound"><span class="entity">A</span></span></span> <span class="main">=</span> <span class="main">(</span><span class="main">‚àÄ</span><span class="bound">t</span> <span class="main">‚àà</span> <span class="free"><span class="bound"><span class="entity">T</span></span></span><span class="main">.</span> <span class="main">‚àÄ</span><span class="bound"><span class="bound">Œµ</span></span> <span class="main">&gt;</span> <span class="main">0</span><span class="main">.</span> <span class="main">‚àÉ</span> <span class="bound"><span class="bound">Œ¥</span></span> <span class="main">&gt;</span> <span class="main">0</span><span class="main">.</span> <span class="main">‚àÄ</span><span class="bound">œÑ</span><span class="main">‚àà</span><span class="free"><span class="bound"><span class="entity">T</span></span></span><span class="main">.</span> <span class="main">¬¶</span><span class="bound">œÑ</span> <span class="main">-</span> <span class="bound">t</span><span class="main">¬¶</span> <span class="main">&lt;</span> <span class="bound">Œ¥</span> <span class="main">‚ü∂</span> <span class="main">‚à•</span><span class="free"><span class="bound"><span class="entity">A</span></span></span> <span class="bound">œÑ</span> <span class="main">-</span> <span class="free"><span class="bound"><span class="entity">A</span></span></span> <span class="bound">t</span><span class="keyword1">‚à•<span class="hidden">‚á©</span><sub>o</sub><span class="hidden">‚á©</span><sub>p</sub></span> <span class="main">‚â§</span> <span class="bound">Œµ</span><span class="main">)</span>"</span></span>

<span class="keyword1"><span class="command">lemma</span></span> continuous_on_matrix_vector_multl<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"matrix_continuous_on <span class="free">T</span> <span class="free">A</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"continuous_on <span class="free">T</span> <span class="main">(</span><span class="main">Œª</span><span class="bound">t</span><span class="main">.</span> <span class="free">A</span> <span class="bound">t</span> <span class="keyword1">*v</span> <span class="free">s</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span><span class="main">(</span><span class="operator">rule</span> continuous_onI<span class="main"><span class="keyword3">,</span></span> <span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> dist_norm<span class="main">)</span>
  <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">e</span> <span class="skolem">t</span><span class="main">::</span><span class="quoted">real</span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">0</span> <span class="main">&lt;</span> <span class="skolem">e</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">t</span> <span class="main">‚àà</span> <span class="free">T</span>"</span></span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?Œµ</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"<span class="skolem">e</span><span class="main">/</span><span class="main">(</span><span class="main">‚à•</span><span class="main">(</span><span class="keyword1">if</span> <span class="free">s</span> <span class="main">=</span> <span class="main">0</span> <span class="keyword1">then</span> <span class="main">1</span> <span class="keyword1">else</span> <span class="free">s</span><span class="main">)</span><span class="main">‚à•</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="var">?Œµ</span> <span class="main">&gt;</span> <span class="main">0</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‚Äπ<span class="main">0</span> <span class="main">&lt;</span> <span class="skolem">e</span>‚Ä∫</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span> 
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">Œ¥</span></span> <span class="keyword2"><span class="keyword">where</span></span> dHyp<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">Œ¥</span> <span class="main">&gt;</span> <span class="main">0</span> <span class="main">‚àß</span> <span class="main">(</span><span class="main">‚àÄ</span><span class="bound">œÑ</span><span class="main">‚àà</span><span class="free">T</span><span class="main">.</span> <span class="main">¬¶</span><span class="bound">œÑ</span> <span class="main">-</span> <span class="skolem">t</span><span class="main">¬¶</span> <span class="main">&lt;</span> <span class="skolem">Œ¥</span> <span class="main">‚ü∂</span> <span class="main">‚à•</span><span class="free">A</span> <span class="bound">œÑ</span> <span class="main">-</span> <span class="free">A</span> <span class="skolem">t</span><span class="keyword1">‚à•<span class="hidden">‚á©</span><sub>o</sub><span class="hidden">‚á©</span><sub>p</sub></span> <span class="main">‚â§</span> <span class="var">?Œµ</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> assms <span class="quoted"><span class="quoted">‚Äπ<span class="skolem">t</span> <span class="main">‚àà</span> <span class="free">T</span>‚Ä∫</span></span> <span class="keyword1"><span class="command">unfolding</span></span> dist_norm matrix_continuous_on_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">fastforce</span>
  <span class="keyword1"><span class="command">{</span></span><span class="keyword3"><span class="command">fix</span></span> <span class="skolem">œÑ</span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">œÑ</span> <span class="main">‚àà</span> <span class="free">T</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬¶</span><span class="skolem">œÑ</span> <span class="main">-</span> <span class="skolem">t</span><span class="main">¬¶</span> <span class="main">&lt;</span> <span class="skolem">Œ¥</span>"</span></span>
    <span class="keyword1"><span class="command">have</span></span> obs<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="var">?Œµ</span> <span class="main">*</span> <span class="main">(</span><span class="main">‚à•</span><span class="free">s</span><span class="main">‚à•</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="keyword1">if</span> <span class="free">s</span> <span class="main">=</span> <span class="main">0</span> <span class="keyword1">then</span> <span class="main">0</span> <span class="keyword1">else</span> <span class="skolem">e</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">‚à•</span><span class="free">A</span> <span class="skolem">œÑ</span> <span class="keyword1">*v</span> <span class="free">s</span> <span class="main">-</span> <span class="free">A</span> <span class="skolem">t</span> <span class="keyword1">*v</span> <span class="free">s</span><span class="main">‚à•</span> <span class="main">=</span> <span class="main">‚à•</span><span class="main">(</span><span class="free">A</span> <span class="skolem">œÑ</span> <span class="main">-</span> <span class="free">A</span> <span class="skolem">t</span><span class="main">)</span> <span class="keyword1">*v</span> <span class="free">s</span><span class="main">‚à•</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> matrix_vector_mult_diff_rdistrib<span class="main">)</span>      
    <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">‚â§</span> <span class="main">(</span><span class="main">‚à•</span><span class="free">A</span> <span class="skolem">œÑ</span> <span class="main">-</span> <span class="free">A</span> <span class="skolem">t</span><span class="keyword1">‚à•<span class="hidden">‚á©</span><sub>o</sub><span class="hidden">‚á©</span><sub>p</sub></span><span class="main">)</span> <span class="main">*</span> <span class="main">(</span><span class="main">‚à•</span><span class="free">s</span><span class="main">‚à•</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> norm_matrix_le_mult_op_norm <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
    <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">‚â§</span> <span class="var">?Œµ</span> <span class="main">*</span> <span class="main">(</span><span class="main">‚à•</span><span class="free">s</span><span class="main">‚à•</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> dHyp <span class="quoted"><span class="quoted">‚Äπ<span class="skolem">œÑ</span> <span class="main">‚àà</span> <span class="free">T</span>‚Ä∫</span></span> <span class="quoted"><span class="quoted">‚Äπ<span class="main">¬¶</span><span class="skolem">œÑ</span> <span class="main">-</span> <span class="skolem">t</span><span class="main">¬¶</span> <span class="main">&lt;</span> <span class="skolem">Œ¥</span>‚Ä∫</span></span> mult_right_mono norm_ge_zero <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span> 
    <span class="keyword1"><span class="command">finally</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">‚à•</span><span class="free">A</span> <span class="skolem">œÑ</span> <span class="keyword1">*v</span> <span class="free">s</span> <span class="main">-</span> <span class="free">A</span> <span class="skolem">t</span> <span class="keyword1">*v</span> <span class="free">s</span><span class="main">‚à•</span> <span class="main">‚â§</span> <span class="skolem">e</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">subst</span> <span class="main"><span class="main">(</span></span><span class="quasi_keyword">asm</span><span class="main"><span class="main">)</span></span> obs<span class="main">)</span> <span class="main">(</span><span class="operator">metis</span> <span class="main"><span class="main">(</span></span>mono_tags<span class="main"><span class="main">,</span></span> hide_lams<span class="main"><span class="main">)</span></span> <span class="quoted"><span class="quoted">‚Äπ<span class="main">0</span> <span class="main">&lt;</span> <span class="skolem">e</span>‚Ä∫</span></span> less_eq_real_def order_trans<span class="main">)</span><span class="keyword1"><span class="command">}</span></span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"<span class="main">‚àÉ</span><span class="bound"><span class="bound">d</span></span><span class="main">&gt;</span><span class="main">0</span><span class="main">.</span> <span class="main">‚àÄ</span><span class="bound">œÑ</span><span class="main">‚àà</span><span class="free">T</span><span class="main">.</span> <span class="main">¬¶</span><span class="bound">œÑ</span> <span class="main">-</span> <span class="skolem">t</span><span class="main">¬¶</span> <span class="main">&lt;</span> <span class="bound">d</span> <span class="main">‚ü∂</span> <span class="main">‚à•</span><span class="free">A</span> <span class="bound">œÑ</span> <span class="keyword1">*v</span> <span class="free">s</span> <span class="main">-</span> <span class="free">A</span> <span class="skolem">t</span> <span class="keyword1">*v</span> <span class="free">s</span><span class="main">‚à•</span> <span class="main">‚â§</span> <span class="skolem">e</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> dHyp <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">lemma</span></span> lipschitz_cond_affine<span class="main">:</span>
  <span class="keyword2"><span class="keyword">fixes</span></span> <span class="free">A</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"real <span class="main">‚áí</span> <span class="tfree">'a</span><span class="main">::</span>real_normed_algebra_1<span class="main">^</span><span class="tfree">'n</span><span class="main">^</span><span class="tfree">'m</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="free">T</span><span class="main">::</span><span class="quoted"><span class="quoted">"real set"</span></span>
  <span class="keyword2"><span class="keyword">defines</span></span> <span class="quoted"><span class="quoted">"<span class="free">L</span> <span class="main">‚â°</span> Sup <span class="main">{</span><span class="main">‚à•</span><span class="free">A</span> <span class="bound">t</span><span class="keyword1">‚à•<span class="hidden">‚á©</span><sub>o</sub><span class="hidden">‚á©</span><sub>p</sub></span> <span class="main">|</span><span class="bound">t</span><span class="main">.</span> <span class="bound">t</span> <span class="main">‚àà</span> <span class="free">T</span><span class="main">}</span>"</span></span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">t</span> <span class="main">‚àà</span> <span class="free">T</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"bdd_above <span class="main">{</span><span class="main">‚à•</span><span class="free">A</span> <span class="bound">t</span><span class="keyword1">‚à•<span class="hidden">‚á©</span><sub>o</sub><span class="hidden">‚á©</span><sub>p</sub></span> <span class="main">|</span><span class="bound">t</span><span class="main">.</span> <span class="bound">t</span> <span class="main">‚àà</span> <span class="free">T</span><span class="main">}</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">‚à•</span><span class="free">A</span> <span class="free">t</span> <span class="keyword1">*v</span> <span class="free">x</span> <span class="main">-</span> <span class="free">A</span> <span class="free">t</span> <span class="keyword1">*v</span> <span class="free">y</span><span class="main">‚à•</span> <span class="main">‚â§</span> <span class="free">L</span> <span class="main">*</span> <span class="main">(</span><span class="main">‚à•</span><span class="free">x</span> <span class="main">-</span> <span class="free">y</span><span class="main">‚à•</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> obs<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">‚à•</span><span class="free">A</span> <span class="free">t</span><span class="keyword1">‚à•<span class="hidden">‚á©</span><sub>o</sub><span class="hidden">‚á©</span><sub>p</sub></span> <span class="main">‚â§</span> Sup <span class="main">{</span><span class="main">‚à•</span><span class="free">A</span> <span class="bound">t</span><span class="keyword1">‚à•<span class="hidden">‚á©</span><sub>o</sub><span class="hidden">‚á©</span><sub>p</sub></span> <span class="main">|</span><span class="bound">t</span><span class="main">.</span> <span class="bound">t</span> <span class="main">‚àà</span> <span class="free">T</span><span class="main">}</span>"</span></span>
    <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="main">(</span><span class="operator">rule</span> cSup_upper<span class="main">)</span>
    <span class="keyword1"><span class="command">using</span></span> continuous_on_subset assms <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> dist_norm<span class="main">)</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">‚à•</span><span class="free">A</span> <span class="free">t</span> <span class="keyword1">*v</span> <span class="free">x</span> <span class="main">-</span> <span class="free">A</span> <span class="free">t</span> <span class="keyword1">*v</span> <span class="free">y</span><span class="main">‚à•</span> <span class="main">=</span> <span class="main">‚à•</span><span class="free">A</span> <span class="free">t</span> <span class="keyword1">*v</span> <span class="main">(</span><span class="free">x</span> <span class="main">-</span> <span class="free">y</span><span class="main">)</span><span class="main">‚à•</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> matrix_vector_mult_diff_distrib<span class="main">)</span>
  <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">‚â§</span> <span class="main">(</span><span class="main">‚à•</span><span class="free">A</span> <span class="free">t</span><span class="keyword1">‚à•<span class="hidden">‚á©</span><sub>o</sub><span class="hidden">‚á©</span><sub>p</sub></span><span class="main">)</span> <span class="main">*</span> <span class="main">(</span><span class="main">‚à•</span><span class="free">x</span> <span class="main">-</span> <span class="free">y</span><span class="main">‚à•</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> norm_matrix_le_mult_op_norm <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">‚â§</span> Sup <span class="main">{</span><span class="main">‚à•</span><span class="free">A</span> <span class="bound">t</span><span class="keyword1">‚à•<span class="hidden">‚á©</span><sub>o</sub><span class="hidden">‚á©</span><sub>p</sub></span> <span class="main">|</span><span class="bound">t</span><span class="main">.</span> <span class="bound">t</span> <span class="main">‚àà</span> <span class="free">T</span><span class="main">}</span> <span class="main">*</span> <span class="main">(</span><span class="main">‚à•</span><span class="free">x</span> <span class="main">-</span> <span class="free">y</span><span class="main">‚à•</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> obs mult_right_mono norm_ge_zero <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span> 
  <span class="keyword1"><span class="command">finally</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">‚à•</span><span class="free">A</span> <span class="free">t</span> <span class="keyword1">*v</span> <span class="free">x</span> <span class="main">-</span> <span class="free">A</span> <span class="free">t</span> <span class="keyword1">*v</span> <span class="free">y</span><span class="main">‚à•</span> <span class="main">‚â§</span> <span class="free">L</span> <span class="main">*</span> <span class="main">(</span><span class="main">‚à•</span><span class="free">x</span> <span class="main">-</span> <span class="free">y</span><span class="main">‚à•</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">unfolding</span></span> assms <span class="keyword1"><span class="command">.</span></span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">lemma</span></span> local_lipschitz_affine<span class="main">:</span>
  <span class="keyword2"><span class="keyword">fixes</span></span> <span class="free">A</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"real <span class="main">‚áí</span> <span class="tfree">'a</span><span class="main">::</span>real_normed_algebra_1<span class="main">^</span><span class="tfree">'n</span><span class="main">^</span><span class="tfree">'m</span>"</span></span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"open <span class="free">T</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"open <span class="free">S</span>"</span></span> 
    <span class="keyword2"><span class="keyword">and</span></span> Ahyp<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">‚ãÄ</span><span class="bound">œÑ</span> <span class="bound">Œµ</span><span class="main">.</span> <span class="bound">Œµ</span> <span class="main">&gt;</span> <span class="main">0</span> <span class="main">‚üπ</span> <span class="bound">œÑ</span> <span class="main">‚àà</span> <span class="free">T</span> <span class="main">‚üπ</span> cball <span class="bound">œÑ</span> <span class="bound">Œµ</span> <span class="main">‚äÜ</span> <span class="free">T</span> <span class="main">‚üπ</span> bdd_above <span class="main">{</span><span class="main">‚à•</span><span class="free">A</span> <span class="bound">t</span><span class="keyword1">‚à•<span class="hidden">‚á©</span><sub>o</sub><span class="hidden">‚á©</span><sub>p</sub></span> <span class="main">|</span><span class="bound">t</span><span class="main">.</span> <span class="bound">t</span> <span class="main">‚àà</span> cball <span class="bound">œÑ</span> <span class="bound">Œµ</span><span class="main">}</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"local_lipschitz <span class="free">T</span> <span class="free">S</span> <span class="main">(</span><span class="main">Œª</span><span class="bound">t</span> <span class="bound">s</span><span class="main">.</span> <span class="free">A</span> <span class="bound">t</span> <span class="keyword1">*v</span> <span class="bound">s</span> <span class="main">+</span> <span class="free">B</span> <span class="bound">t</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span><span class="main">(</span><span class="operator">unfold</span> local_lipschitz_def lipschitz_on_def<span class="main"><span class="keyword3">,</span></span> <span class="operator">clarsimp</span><span class="main">)</span>
  <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">s</span> <span class="skolem">t</span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">s</span> <span class="main">‚àà</span> <span class="free">S</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">t</span> <span class="main">‚àà</span> <span class="free">T</span>"</span></span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">e1</span></span> <span class="skolem"><span class="skolem">e2</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"cball <span class="skolem">t</span> <span class="skolem">e1</span> <span class="main">‚äÜ</span> <span class="free">T</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"cball <span class="skolem">s</span> <span class="skolem">e2</span> <span class="main">‚äÜ</span> <span class="free">S</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"min <span class="skolem">e1</span> <span class="skolem">e2</span> <span class="main">&gt;</span> <span class="main">0</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> open_cballE<span class="main">[</span><span class="operator">OF</span> _ <span class="quoted"><span class="quoted">‚Äπopen <span class="free">T</span>‚Ä∫</span></span><span class="main">]</span> open_cballE<span class="main">[</span><span class="operator">OF</span> _ <span class="quoted"><span class="quoted">‚Äπopen <span class="free">S</span>‚Ä∫</span></span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">force</span>
  <span class="keyword1"><span class="command">hence</span></span> obs<span class="main">:</span> <span class="quoted"><span class="quoted">"cball <span class="skolem">t</span> <span class="main">(</span>min <span class="skolem">e1</span> <span class="skolem">e2</span><span class="main">)</span> <span class="main">‚äÜ</span> <span class="free">T</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?L</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"Sup <span class="main">{</span><span class="main">‚à•</span><span class="free">A</span> <span class="bound">œÑ</span><span class="keyword1">‚à•<span class="hidden">‚á©</span><sub>o</sub><span class="hidden">‚á©</span><sub>p</sub></span> <span class="main">|</span><span class="bound">œÑ</span><span class="main">.</span> <span class="bound">œÑ</span> <span class="main">‚àà</span> cball <span class="skolem">t</span> <span class="main">(</span>min <span class="skolem">e1</span> <span class="skolem">e2</span><span class="main">)</span><span class="main">}</span>"</span></span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">‚à•</span><span class="free">A</span> <span class="skolem">t</span><span class="keyword1">‚à•<span class="hidden">‚á©</span><sub>o</sub><span class="hidden">‚á©</span><sub>p</sub></span> <span class="main">‚àà</span> <span class="main">{</span><span class="main">‚à•</span><span class="free">A</span> <span class="bound">œÑ</span><span class="keyword1">‚à•<span class="hidden">‚á©</span><sub>o</sub><span class="hidden">‚á©</span><sub>p</sub></span> <span class="main">|</span><span class="bound">œÑ</span><span class="main">.</span> <span class="bound">œÑ</span> <span class="main">‚àà</span> cball <span class="skolem">t</span> <span class="main">(</span>min <span class="skolem">e1</span> <span class="skolem">e2</span><span class="main">)</span><span class="main">}</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‚Äπmin <span class="skolem">e1</span> <span class="skolem">e2</span> <span class="main">&gt;</span> <span class="main">0</span>‚Ä∫</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> bdd<span class="main">:</span> <span class="quoted"><span class="quoted">"bdd_above <span class="main">{</span><span class="main">‚à•</span><span class="free">A</span> <span class="bound">œÑ</span><span class="keyword1">‚à•<span class="hidden">‚á©</span><sub>o</sub><span class="hidden">‚á©</span><sub>p</sub></span> <span class="main">|</span><span class="bound">œÑ</span><span class="main">.</span> <span class="bound">œÑ</span> <span class="main">‚àà</span> cball <span class="skolem">t</span> <span class="main">(</span>min <span class="skolem">e1</span> <span class="skolem">e2</span><span class="main">)</span><span class="main">}</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> Ahyp<span class="main"><span class="keyword3">,</span></span> <span class="operator">simp</span> <span class="quasi_keyword">only</span><span class="main"><span class="main">:</span></span> <span class="quoted"><span class="quoted">‚Äπmin <span class="skolem">e1</span> <span class="skolem">e2</span> <span class="main">&gt;</span> <span class="main">0</span>‚Ä∫</span></span><span class="main"><span class="keyword3">,</span></span> <span class="operator">simp_all</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> <span class="quoted"><span class="quoted">‚Äπ<span class="skolem">t</span> <span class="main">‚àà</span> <span class="free">T</span>‚Ä∫</span></span> obs<span class="main">)</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"Sup <span class="main">{</span><span class="main">‚à•</span><span class="free">A</span> <span class="bound">œÑ</span><span class="keyword1">‚à•<span class="hidden">‚á©</span><sub>o</sub><span class="hidden">‚á©</span><sub>p</sub></span> <span class="main">|</span><span class="bound">œÑ</span><span class="main">.</span> <span class="bound">œÑ</span> <span class="main">‚àà</span> cball <span class="skolem">t</span> <span class="main">(</span>min <span class="skolem">e1</span> <span class="skolem">e2</span><span class="main">)</span><span class="main">}</span> <span class="main">‚â•</span> <span class="main">0</span>"</span></span>
    <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="main">(</span><span class="operator">rule</span> order.trans<span class="main"><span class="main">[</span></span><span class="operator">OF</span> op_norm_ge_0<span class="main"><span class="main">[</span></span><span class="operator">of</span> <span class="quoted"><span class="quoted"><span class="quoted">"<span class="free"><span class="free">A</span></span> <span class="skolem"><span class="skolem">t</span></span>"</span></span></span><span class="main"><span class="main">]</span></span><span class="main"><span class="main">]</span></span><span class="main">)</span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> cSup_upper<span class="main"><span class="main">[</span></span><span class="operator">OF</span> calculation<span class="main"><span class="main">]</span></span><span class="main">)</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">‚àÄ</span><span class="bound">x</span><span class="main">‚àà</span>cball <span class="skolem">s</span> <span class="main">(</span>min <span class="skolem">e1</span> <span class="skolem">e2</span><span class="main">)</span> <span class="main">‚à©</span> <span class="free">S</span><span class="main">.</span> <span class="main">‚àÄ</span><span class="bound">y</span><span class="main">‚àà</span>cball <span class="skolem">s</span> <span class="main">(</span>min <span class="skolem">e1</span> <span class="skolem">e2</span><span class="main">)</span> <span class="main">‚à©</span> <span class="free">S</span><span class="main">.</span> 
    <span class="main">‚àÄ</span><span class="bound">œÑ</span><span class="main">‚àà</span>cball <span class="skolem">t</span> <span class="main">(</span>min <span class="skolem">e1</span> <span class="skolem">e2</span><span class="main">)</span> <span class="main">‚à©</span> <span class="free">T</span><span class="main">.</span> dist <span class="main">(</span><span class="free">A</span> <span class="bound">œÑ</span> <span class="keyword1">*v</span> <span class="bound">x</span><span class="main">)</span> <span class="main">(</span><span class="free">A</span> <span class="bound">œÑ</span> <span class="keyword1">*v</span> <span class="bound">y</span><span class="main">)</span> <span class="main">‚â§</span> <span class="var">?L</span> <span class="main">*</span> dist <span class="bound">x</span> <span class="bound">y</span>"</span></span>
    <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="main">(</span><span class="operator">clarify</span><span class="main"><span class="keyword3">,</span></span> <span class="operator">simp</span> <span class="quasi_keyword">only</span><span class="main"><span class="main">:</span></span> dist_norm<span class="main"><span class="keyword3">,</span></span> <span class="operator">rule</span> lipschitz_cond_affine<span class="main">)</span>
    <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‚Äπmin <span class="skolem">e1</span> <span class="skolem">e2</span> <span class="main">&gt;</span> <span class="main">0</span>‚Ä∫</span></span> bdd <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">‚àÉ</span><span class="bound"><span class="bound">e</span></span><span class="main">&gt;</span><span class="main">0</span><span class="main">.</span> <span class="main">‚àÉ</span><span class="bound">L</span><span class="main">.</span> <span class="main">‚àÄ</span><span class="bound">t</span><span class="main">‚àà</span>cball <span class="skolem">t</span> <span class="bound">e</span> <span class="main">‚à©</span> <span class="free">T</span><span class="main">.</span> <span class="main">0</span> <span class="main">‚â§</span> <span class="bound">L</span> <span class="main">‚àß</span> 
    <span class="main">(</span><span class="main">‚àÄ</span><span class="bound">x</span><span class="main">‚àà</span>cball <span class="skolem">s</span> <span class="bound">e</span> <span class="main">‚à©</span> <span class="free">S</span><span class="main">.</span> <span class="main">‚àÄ</span><span class="bound">y</span><span class="main">‚àà</span>cball <span class="skolem">s</span> <span class="bound">e</span> <span class="main">‚à©</span> <span class="free">S</span><span class="main">.</span> dist <span class="main">(</span><span class="free">A</span> <span class="bound">t</span> <span class="keyword1">*v</span> <span class="bound">x</span><span class="main">)</span> <span class="main">(</span><span class="free">A</span> <span class="bound">t</span> <span class="keyword1">*v</span> <span class="bound">y</span><span class="main">)</span> <span class="main">‚â§</span> <span class="bound">L</span> <span class="main">*</span> dist <span class="bound">x</span> <span class="bound">y</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‚Äπmin <span class="skolem">e1</span> <span class="skolem">e2</span> <span class="main">&gt;</span> <span class="main">0</span>‚Ä∫</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">lemma</span></span> picard_lindeloef_affine<span class="main">:</span>
  <span class="keyword2"><span class="keyword">fixes</span></span> <span class="free">A</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"real <span class="main">‚áí</span> <span class="tfree">'a</span><span class="main">::</span><span class="main">{</span>banach<span class="main">,</span>real_normed_algebra_1<span class="main">,</span>heine_borel<span class="main">}</span><span class="main">^</span><span class="tfree">'n</span><span class="main">^</span><span class="tfree">'n</span>"</span></span>
  <span class="keyword2"><span class="keyword">assumes</span></span> Ahyp<span class="main">:</span> <span class="quoted"><span class="quoted">"matrix_continuous_on <span class="free">T</span> <span class="free">A</span>"</span></span>
      <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">‚ãÄ</span><span class="bound">œÑ</span> <span class="bound">Œµ</span><span class="main">.</span> <span class="bound">œÑ</span> <span class="main">‚àà</span> <span class="free">T</span> <span class="main">‚üπ</span> <span class="bound">Œµ</span> <span class="main">&gt;</span> <span class="main">0</span> <span class="main">‚üπ</span> bdd_above <span class="main">{</span><span class="main">‚à•</span><span class="free">A</span> <span class="bound">t</span><span class="keyword1">‚à•<span class="hidden">‚á©</span><sub>o</sub><span class="hidden">‚á©</span><sub>p</sub></span> <span class="main">|</span><span class="bound">t</span><span class="main">.</span> dist <span class="bound">œÑ</span> <span class="bound">t</span> <span class="main">‚â§</span> <span class="bound">Œµ</span><span class="main">}</span>"</span></span>
      <span class="keyword2"><span class="keyword">and</span></span> Bhyp<span class="main">:</span> <span class="quoted"><span class="quoted">"continuous_on <span class="free">T</span> <span class="free">B</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"open <span class="free">S</span>"</span></span> 
      <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">t<span class="hidden">‚á©</span><sub>0</sub></span> <span class="main">‚àà</span> <span class="free">T</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> Thyp<span class="main">:</span> <span class="quoted"><span class="quoted">"open <span class="free">T</span>"</span></span> <span class="quoted"><span class="quoted">"is_interval <span class="free">T</span>"</span></span> 
    <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"picard_lindeloef <span class="main">(</span><span class="main">Œª</span> <span class="bound">t</span> <span class="bound">s</span><span class="main">.</span> <span class="free">A</span> <span class="bound">t</span> <span class="keyword1">*v</span> <span class="bound">s</span> <span class="main">+</span> <span class="free">B</span> <span class="bound">t</span><span class="main">)</span> <span class="free">T</span> <span class="free">S</span> <span class="free">t<span class="hidden">‚á©</span><sub>0</sub></span>"</span></span>
  <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">unfold_locales</span><span class="main"><span class="keyword3">,</span></span> <span class="operator">simp_all</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> assms<span class="main"><span class="keyword3">,</span></span> <span class="operator">clarsimp</span><span class="main">)</span>
   <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">rule</span> continuous_on_add<span class="main"><span class="main">[</span></span><span class="operator">OF</span> continuous_on_matrix_vector_multl<span class="main"><span class="main">[</span></span><span class="operator">OF</span> Ahyp<span class="main"><span class="main">]</span></span> Bhyp<span class="main"><span class="main">]</span></span><span class="main">)</span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> local_lipschitz_affine<span class="main">)</span> <span class="main">(</span><span class="operator">simp_all</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> assms<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> picard_lindeloef_autonomous_affine<span class="main">:</span> 
  <span class="keyword2"><span class="keyword">fixes</span></span> <span class="free">A</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'a</span><span class="main">::</span><span class="main">{</span>banach<span class="main">,</span>real_normed_field<span class="main">,</span>heine_borel<span class="main">}</span><span class="main">^</span><span class="tfree">'n</span><span class="main">^</span><span class="tfree">'n</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"picard_lindeloef <span class="main">(</span><span class="main">Œª</span> <span class="bound">t</span> <span class="bound">s</span><span class="main">.</span> <span class="free">A</span> <span class="keyword1">*v</span> <span class="bound">s</span> <span class="main">+</span> <span class="free">B</span><span class="main">)</span> UNIV UNIV <span class="free">t<span class="hidden">‚á©</span><sub>0</sub></span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> picard_lindeloef_affine<span class="main">[</span><span class="operator">of</span> <span class="main">_</span> <span class="quoted"><span class="quoted">"<span class="main">Œª</span><span class="bound">t</span><span class="main">.</span> <span class="free">A</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="main">Œª</span><span class="bound">t</span><span class="main">.</span> <span class="free">B</span>"</span></span><span class="main">]</span> 
  <span class="keyword1"><span class="command">unfolding</span></span> matrix_continuous_on_def <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">only</span><span class="main"><span class="main">:</span></span> diff_self op_norm0<span class="main"><span class="keyword3">,</span></span> <span class="operator">auto</span><span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> picard_lindeloef_autonomous_linear<span class="main">:</span>
  <span class="keyword2"><span class="keyword">fixes</span></span> <span class="free">A</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'a</span><span class="main">::</span><span class="main">{</span>banach<span class="main">,</span>real_normed_field<span class="main">,</span>heine_borel<span class="main">}</span><span class="main">^</span><span class="tfree">'n</span><span class="main">^</span><span class="tfree">'n</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"picard_lindeloef <span class="main">(</span><span class="main">Œª</span> <span class="bound">t</span><span class="main">.</span> <span class="keyword1">(*v)</span> <span class="free">A</span><span class="main">)</span> UNIV UNIV <span class="free">t<span class="hidden">‚á©</span><sub>0</sub></span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> picard_lindeloef_autonomous_affine<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="free">A</span></span> <span class="quoted"><span class="main">0</span></span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">force</span>

<span class="keyword1"><span class="command">lemmas</span></span> unique_sol_autonomous_affine <span class="main">=</span> picard_lindeloef.ivp_unique_solution<span class="main">[</span><span class="operator">OF</span> 
    picard_lindeloef_autonomous_affine UNIV_I _ subset_UNIV<span class="main">]</span>

<span class="keyword1"><span class="command">lemmas</span></span> unique_sol_autonomous_linear <span class="main">=</span> picard_lindeloef.ivp_unique_solution<span class="main">[</span><span class="operator">OF</span> 
    picard_lindeloef_autonomous_linear UNIV_I _ subset_UNIV<span class="main">]</span>


<span class="keyword1"><span class="command">subsection</span></span> <span class="quoted"><span class="plain_text">‚Äπ Flow for affine systems ‚Ä∫</span></span>


<span class="keyword1"><span class="command">subsubsection</span></span> <span class="quoted"><span class="plain_text">‚Äπ Derivative rules for square matrices ‚Ä∫</span></span>

<span class="keyword1"><span class="command">lemma</span></span> has_derivative_exp_scaleRl<span class="main">[</span><span class="operator">derivative_intros</span><span class="main">]</span><span class="main">:</span>
  <span class="keyword2"><span class="keyword">fixes</span></span> <span class="free">f</span><span class="main">::</span><span class="quoted"><span class="quoted">"real <span class="main">‚áí</span> real"</span></span> <span class="comment1">(* by Fabian Immler and Johannes H√∂lzl *)</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">D</span> <span class="free">f</span> <span class="main">‚Ü¶</span> <span class="free">f'</span> <span class="keyword1">at</span> <span class="free">t</span> <span class="keyword1">within</span> <span class="free">T</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">D</span> <span class="main">(</span><span class="main">Œª</span><span class="bound">t</span><span class="main">.</span> exp <span class="main">(</span><span class="free">f</span> <span class="bound">t</span> <span class="keyword1">*<span class="hidden">‚á©</span><sub>R</sub></span> <span class="free">A</span><span class="main">)</span><span class="main">)</span> <span class="main">‚Ü¶</span> <span class="main">(</span><span class="main">Œª</span><span class="bound">h</span><span class="main">.</span> <span class="free">f'</span> <span class="bound">h</span> <span class="keyword1">*<span class="hidden">‚á©</span><sub>R</sub></span> <span class="main">(</span>exp <span class="main">(</span><span class="free">f</span> <span class="free">t</span> <span class="keyword1">*<span class="hidden">‚á©</span><sub>R</sub></span> <span class="free">A</span><span class="main">)</span> <span class="main">*</span> <span class="free">A</span><span class="main">)</span><span class="main">)</span> <span class="keyword1">at</span> <span class="free">t</span> <span class="keyword1">within</span> <span class="free">T</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"bounded_linear <span class="free">f'</span>"</span></span> 
    <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">m</span></span> <span class="keyword2"><span class="keyword">where</span></span> obs<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">f'</span> <span class="main">=</span> <span class="main">(</span><span class="main">Œª</span><span class="bound">h</span><span class="main">.</span> <span class="bound">h</span> <span class="main">*</span> <span class="skolem">m</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> real_bounded_linear <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
    <span class="keyword1"><span class="command">using</span></span> vector_diff_chain_within<span class="main">[</span><span class="operator">OF</span> _ exp_scaleR_has_vector_derivative_right<span class="main">]</span> 
      assms obs <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> has_vector_derivative_def comp_def<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">lemma</span></span> vderiv_on_exp_scaleRlI<span class="main">[</span><span class="operator">poly_derivatives</span><span class="main">]</span><span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">D</span> <span class="free">f</span> <span class="main">=</span> <span class="free">f'</span> <span class="keyword1">on</span> <span class="free">T</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">g'</span> <span class="main">=</span> <span class="main">(</span><span class="main">Œª</span><span class="bound">x</span><span class="main">.</span> <span class="free">f'</span> <span class="bound">x</span> <span class="keyword1">*<span class="hidden">‚á©</span><sub>R</sub></span> exp <span class="main">(</span><span class="free">f</span> <span class="bound">x</span> <span class="keyword1">*<span class="hidden">‚á©</span><sub>R</sub></span> <span class="free">A</span><span class="main">)</span> <span class="main">*</span> <span class="free">A</span><span class="main">)</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">D</span> <span class="main">(</span><span class="main">Œª</span><span class="bound">x</span><span class="main">.</span> exp <span class="main">(</span><span class="free">f</span> <span class="bound">x</span> <span class="keyword1">*<span class="hidden">‚á©</span><sub>R</sub></span> <span class="free">A</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> <span class="free">g'</span> <span class="keyword1">on</span> <span class="free">T</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">unfolding</span></span> has_vderiv_on_def has_vector_derivative_def <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="operator">clarsimp</span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> has_derivative_exp_scaleRl<span class="main"><span class="keyword3">,</span></span> <span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> fun_eq_iff<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> has_derivative_mtx_ith<span class="main">[</span><span class="operator">derivative_intros</span><span class="main">]</span><span class="main">:</span>
  <span class="keyword2"><span class="keyword">fixes</span></span> <span class="free">t</span><span class="main">::</span><span class="quoted">real</span> <span class="keyword2"><span class="keyword">and</span></span> <span class="free">T</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"real set"</span></span>
  <span class="keyword2"><span class="keyword">defines</span></span> <span class="quoted"><span class="quoted">"<span class="free">t<span class="hidden">‚á©</span><sub>0</sub></span> <span class="main">‚â°</span> netlimit <span class="main">(</span><span class="keyword1">at</span> <span class="free">t</span> <span class="keyword1">within</span> <span class="free">T</span><span class="main">)</span>"</span></span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">D</span> <span class="free">A</span> <span class="main">‚Ü¶</span> <span class="main">(</span><span class="main">Œª</span><span class="bound">h</span><span class="main">.</span> <span class="bound">h</span> <span class="keyword1">*<span class="hidden">‚á©</span><sub>R</sub></span> <span class="free">A'</span> <span class="free">t</span><span class="main">)</span> <span class="keyword1">at</span> <span class="free">t</span> <span class="keyword1">within</span> <span class="free">T</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">D</span> <span class="main">(</span><span class="main">Œª</span><span class="bound">t</span><span class="main">.</span> <span class="free">A</span> <span class="bound">t</span> <span class="main">$$</span> <span class="free">i</span><span class="main">)</span> <span class="main">‚Ü¶</span> <span class="main">(</span><span class="main">Œª</span><span class="bound">h</span><span class="main">.</span> <span class="bound">h</span> <span class="keyword1">*<span class="hidden">‚á©</span><sub>R</sub></span> <span class="free">A'</span> <span class="free">t</span> <span class="main">$$</span> <span class="free">i</span><span class="main">)</span> <span class="keyword1">at</span> <span class="free">t</span> <span class="keyword1">within</span> <span class="free">T</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">unfolding</span></span> has_derivative_def <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="operator">safe</span>
   <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="main">(</span><span class="operator">force</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> bounded_linear_def bounded_linear_axioms_def<span class="main">)</span>
  <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="main">(</span><span class="operator">rule_tac</span> F<span class="main"><span class="main">=</span></span><span class="quoted"><span class="quoted">"<span class="main">Œª</span><span class="bound">œÑ</span><span class="main">.</span> <span class="main">(</span><span class="free">A</span> <span class="bound">œÑ</span> <span class="main">-</span> <span class="free">A</span> <span class="free">t<span class="hidden">‚á©</span><sub>0</sub></span> <span class="main">-</span> <span class="main">(</span><span class="bound">œÑ</span> <span class="main">-</span> <span class="free">t<span class="hidden">‚á©</span><sub>0</sub></span><span class="main">)</span> <span class="keyword1">*<span class="hidden">‚á©</span><sub>R</sub></span> <span class="free">A'</span> <span class="free">t</span><span class="main">)</span> <span class="keyword1">/<span class="hidden">‚á©</span><sub>R</sub></span> <span class="main">(</span><span class="main">‚à•</span><span class="bound">œÑ</span> <span class="main">-</span> <span class="free">t<span class="hidden">‚á©</span><sub>0</sub></span><span class="main">‚à•</span><span class="main">)</span>"</span></span> <span class="keyword2"><span class="keyword"><span class="quasi_keyword">in</span></span></span> tendsto_zero_norm_bound<span class="main">)</span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">clarsimp</span><span class="main"><span class="keyword3">,</span></span> <span class="operator">rule</span> mult_left_mono<span class="main"><span class="keyword3">,</span></span> <span class="operator">metis</span> <span class="main"><span class="main">(</span></span>no_types<span class="main"><span class="main">,</span></span> lifting<span class="main"><span class="main">)</span></span> norm_column_le_norm 
      sq_mtx_minus_ith sq_mtx_scaleR_ith<span class="main">)</span> <span class="operator">simp_all</span>

<span class="keyword1"><span class="command">lemmas</span></span> has_derivative_mtx_vec_mult<span class="main">[</span><span class="operator">derivative_intros</span><span class="main">]</span> <span class="main">=</span> 
  bounded_bilinear.FDERIV<span class="main">[</span><span class="operator">OF</span> bounded_bilinear_sq_mtx_vec_mult<span class="main">]</span>

<span class="keyword1"><span class="command">lemma</span></span> vderiv_on_mtx_vec_multI<span class="main">[</span><span class="operator">poly_derivatives</span><span class="main">]</span><span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">D</span> <span class="free">u</span> <span class="main">=</span> <span class="free">u'</span> <span class="keyword1">on</span> <span class="free">T</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">D</span> <span class="free">A</span> <span class="main">=</span> <span class="free">A'</span> <span class="keyword1">on</span> <span class="free">T</span>"</span></span>
      <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">g</span> <span class="main">=</span> <span class="main">(</span><span class="main">Œª</span><span class="bound">t</span><span class="main">.</span> <span class="free">A</span> <span class="bound">t</span> <span class="keyword1">*<span class="hidden">‚á©</span><sub>V</sub></span> <span class="free">u'</span> <span class="bound">t</span> <span class="main">+</span> <span class="free">A'</span> <span class="bound">t</span> <span class="keyword1">*<span class="hidden">‚á©</span><sub>V</sub></span> <span class="free">u</span> <span class="bound">t</span> <span class="main">)</span>"</span></span>
    <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">D</span> <span class="main">(</span><span class="main">Œª</span><span class="bound">t</span><span class="main">.</span> <span class="free">A</span> <span class="bound">t</span> <span class="keyword1">*<span class="hidden">‚á©</span><sub>V</sub></span> <span class="free">u</span> <span class="bound">t</span><span class="main">)</span> <span class="main">=</span> <span class="free">g</span> <span class="keyword1">on</span> <span class="free">T</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">unfolding</span></span> has_vderiv_on_def has_vector_derivative_def <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="operator">clarsimp</span>
  <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="main">(</span><span class="operator">erule_tac</span> x<span class="main"><span class="main">=</span></span><span class="quoted"><span class="improper"><span class="quoted"><span class="improper"><span class="quoted"><span class="improper">x</span></span></span></span></span></span> <span class="keyword2"><span class="keyword"><span class="quasi_keyword">in</span></span></span> ballE<span class="main"><span class="keyword3">,</span></span> <span class="operator">simp_all</span><span class="main">)</span><span class="main"><span class="keyword3">+</span></span>
  <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="main">(</span><span class="operator">rule</span> <span class="dynamic"><span class="dynamic">derivative_eq_intros</span></span><span class="main">)</span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> fun_eq_iff mtx_vec_scaleR_commute pth_6 scaleR_mtx_vec_assoc<span class="main">)</span>

<span class="keyword1"><span class="command">lemmas</span></span> has_vderiv_on_ivl_integral <span class="main">=</span> ivl_integral_has_vderiv_on<span class="main">[</span><span class="operator">OF</span> vderiv_on_continuous_on<span class="main">]</span>

<span class="keyword1"><span class="command">declare</span></span> has_vderiv_on_ivl_integral <span class="main">[</span><span class="operator">poly_derivatives</span><span class="main">]</span>

<span class="keyword1"><span class="command">lemma</span></span> has_derivative_mtx_vec_multl<span class="main">[</span><span class="operator">derivative_intros</span><span class="main">]</span><span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="main">‚ãÄ</span> <span class="bound">i</span> <span class="bound">j</span><span class="main">.</span> <span class="keyword1">D</span> <span class="main">(</span><span class="main">Œª</span><span class="bound">t</span><span class="main">.</span> <span class="main">(</span><span class="free">A</span> <span class="bound">t</span><span class="main">)</span> <span class="main">$$</span> <span class="bound">i</span> <span class="main">$</span> <span class="bound">j</span><span class="main">)</span> <span class="main">‚Ü¶</span> <span class="main">(</span><span class="main">Œª</span><span class="bound">œÑ</span><span class="main">.</span> <span class="bound">œÑ</span> <span class="keyword1">*<span class="hidden">‚á©</span><sub>R</sub></span> <span class="main">(</span><span class="free">A'</span> <span class="free">t</span><span class="main">)</span> <span class="main">$$</span> <span class="bound">i</span> <span class="main">$</span> <span class="bound">j</span><span class="main">)</span> <span class="main">(</span><span class="keyword1">at</span> <span class="free">t</span> <span class="keyword1">within</span> <span class="free">T</span><span class="main">)</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">D</span> <span class="main">(</span><span class="main">Œª</span><span class="bound">t</span><span class="main">.</span> <span class="free">A</span> <span class="bound">t</span> <span class="keyword1">*<span class="hidden">‚á©</span><sub>V</sub></span> <span class="free">x</span><span class="main">)</span> <span class="main">‚Ü¶</span> <span class="main">(</span><span class="main">Œª</span><span class="bound">œÑ</span><span class="main">.</span> <span class="bound">œÑ</span> <span class="keyword1">*<span class="hidden">‚á©</span><sub>R</sub></span> <span class="main">(</span><span class="free">A'</span> <span class="free">t</span><span class="main">)</span> <span class="keyword1">*<span class="hidden">‚á©</span><sub>V</sub></span> <span class="free">x</span><span class="main">)</span> <span class="keyword1">at</span> <span class="free">t</span> <span class="keyword1">within</span> <span class="free">T</span>"</span></span>
  <span class="keyword1"><span class="command">unfolding</span></span> sq_mtx_vec_mult_sum_cols
  <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="main">(</span><span class="operator">rule_tac</span> f'1<span class="main"><span class="main">=</span></span><span class="quoted"><span class="quoted">"<span class="main">Œª</span><span class="bound">i</span> <span class="bound">œÑ</span><span class="main">.</span> <span class="bound">œÑ</span> <span class="keyword1">*<span class="hidden">‚á©</span><sub>R</sub></span>  <span class="main">(</span><span class="free">x</span> <span class="main">$</span> <span class="bound">i</span> <span class="keyword1">*<span class="hidden">‚á©</span><sub>R</sub></span> <span class="keyword1">ùñºùóàùóÖ</span> <span class="bound">i</span> <span class="main">(</span><span class="free">A'</span> <span class="free">t</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword2"><span class="keyword"><span class="quasi_keyword">in</span></span></span> <span class="dynamic"><span class="dynamic">derivative_eq_intros</span></span><span class="main"><span class="main">(</span></span>10<span class="main"><span class="main">)</span></span><span class="main">)</span>
   <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="main">(</span><span class="operator">simp_all</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> scaleR_right.sum<span class="main">)</span>
  <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="main">(</span><span class="operator">rule_tac</span> g'1<span class="main"><span class="main">=</span></span><span class="quoted"><span class="quoted">"<span class="main">Œª</span><span class="bound">œÑ</span><span class="main">.</span> <span class="bound">œÑ</span> <span class="keyword1">*<span class="hidden">‚á©</span><sub>R</sub></span> <span class="keyword1">ùñºùóàùóÖ</span> <span class="improper">i</span> <span class="main">(</span><span class="free">A'</span> <span class="free">t</span><span class="main">)</span>"</span></span> <span class="keyword2"><span class="keyword"><span class="quasi_keyword">in</span></span></span> <span class="dynamic"><span class="dynamic">derivative_eq_intros</span></span><span class="main"><span class="main">(</span></span>4<span class="main"><span class="main">)</span></span><span class="main"><span class="keyword3">,</span></span> <span class="operator">simp_all</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> mult.commute<span class="main">)</span>
  <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">unfolding</span></span> sq_mtx_col_def column_def <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="main">(</span><span class="operator">transfer</span><span class="main"><span class="keyword3">,</span></span> <span class="operator">simp</span><span class="main">)</span>
  <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="main">(</span><span class="operator">rule</span> has_derivative_vec_lambda<span class="main">)</span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> scaleR_vec_def<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> continuous_on_mtx_vec_multr<span class="main">:</span> <span class="quoted"><span class="quoted">"continuous_on <span class="free">S</span> <span class="main">(</span><span class="keyword1">(*<span class="hidden">‚á©</span><sub>V</sub>)</span> <span class="free">A</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="operator">transfer</span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> matrix_vector_mult_linear_continuous_on<span class="main">)</span>

<span class="comment1">‚Äï ‚ÄπAutomatically generated derivative rules from this subsubsection ‚Ä∫</span>

<span class="keyword1"><span class="command">thm</span></span> <span class="dynamic"><span class="dynamic">derivative_eq_intros</span></span><span class="main">(</span>140<span class="main">,</span>141<span class="main">,</span>142<span class="main">,</span>143<span class="main">)</span>


<span class="keyword1"><span class="command">subsubsection</span></span> <span class="quoted"><span class="plain_text">‚Äπ Existence and uniqueness with square matrices ‚Ä∫</span></span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‚ÄπFinally, we can use the <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">term</span></span> <span class="quoted"><span class="quoted">exp</span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span> operation to characterize the general solutions for affine 
systems of ODEs. We show that they satisfy the <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">term</span></span> <span class="quoted"><span class="quoted">"local_flow"</span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span> locale.‚Ä∫</span></span>

<span class="keyword1"><span class="command">lemma</span></span> continuous_on_sq_mtx_vec_multl<span class="main">:</span>
  <span class="keyword2"><span class="keyword">fixes</span></span> <span class="free">A</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"real <span class="main">‚áí</span> <span class="main">(</span><span class="tfree">'n</span><span class="main">::</span>finite<span class="main">)</span> sq_mtx"</span></span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"continuous_on <span class="free">T</span> <span class="free">A</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"continuous_on <span class="free">T</span> <span class="main">(</span><span class="main">Œª</span><span class="bound">t</span><span class="main">.</span> <span class="free">A</span> <span class="bound">t</span> <span class="keyword1">*<span class="hidden">‚á©</span><sub>V</sub></span> <span class="free">s</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"matrix_continuous_on <span class="free">T</span> <span class="main">(</span><span class="main">Œª</span><span class="bound">t</span><span class="main">.</span> to_vec <span class="main">(</span><span class="free">A</span> <span class="bound">t</span><span class="main">)</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">force</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> continuous_on_iff dist_norm norm_sq_mtx_def matrix_continuous_on_def<span class="main">)</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"continuous_on <span class="free">T</span> <span class="main">(</span><span class="main">Œª</span><span class="bound">t</span><span class="main">.</span> to_vec <span class="main">(</span><span class="free">A</span> <span class="bound">t</span><span class="main">)</span> <span class="keyword1">*v</span> <span class="free">s</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> continuous_on_matrix_vector_multl<span class="main">)</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">transfer</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">lemmas</span></span> continuous_on_affine <span class="main">=</span> continuous_on_add<span class="main">[</span><span class="operator">OF</span> continuous_on_sq_mtx_vec_multl<span class="main">]</span>

<span class="keyword1"><span class="command">lemma</span></span> local_lipschitz_sq_mtx_affine<span class="main">:</span>
  <span class="keyword2"><span class="keyword">fixes</span></span> <span class="free">A</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"real <span class="main">‚áí</span> <span class="main">(</span><span class="tfree">'n</span><span class="main">::</span>finite<span class="main">)</span> sq_mtx"</span></span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"continuous_on <span class="free">T</span> <span class="free">A</span>"</span></span> <span class="quoted"><span class="quoted">"open <span class="free">T</span>"</span></span> <span class="quoted"><span class="quoted">"open <span class="free">S</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"local_lipschitz <span class="free">T</span> <span class="free">S</span> <span class="main">(</span><span class="main">Œª</span><span class="bound">t</span> <span class="bound">s</span><span class="main">.</span> <span class="free">A</span> <span class="bound">t</span> <span class="keyword1">*<span class="hidden">‚á©</span><sub>V</sub></span> <span class="bound">s</span> <span class="main">+</span> <span class="free">B</span> <span class="bound">t</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> obs<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">‚ãÄ</span><span class="bound">œÑ</span> <span class="bound">Œµ</span><span class="main">.</span> <span class="main">0</span> <span class="main">&lt;</span> <span class="bound">Œµ</span> <span class="main">‚üπ</span>  <span class="bound">œÑ</span> <span class="main">‚àà</span> <span class="free">T</span> <span class="main">‚üπ</span> cball <span class="bound">œÑ</span> <span class="bound">Œµ</span> <span class="main">‚äÜ</span> <span class="free">T</span> <span class="main">‚üπ</span> bdd_above <span class="main">{</span><span class="main">‚à•</span><span class="free">A</span> <span class="bound">t</span><span class="main">‚à•</span> <span class="main">|</span><span class="bound">t</span><span class="main">.</span> <span class="bound">t</span> <span class="main">‚àà</span> cball <span class="bound">œÑ</span> <span class="bound">Œµ</span><span class="main">}</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> bdd_above_norm_cont_comp<span class="main"><span class="keyword3">,</span></span> <span class="operator">rule</span> continuous_on_subset<span class="main"><span class="main">[</span></span><span class="operator">OF</span> assms<span class="main"><span class="main">(</span></span>1<span class="main"><span class="main">)</span></span><span class="main"><span class="main">]</span></span><span class="main"><span class="keyword3">,</span></span> <span class="operator">simp_all</span><span class="main">)</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="main">‚ãÄ</span><span class="bound">œÑ</span> <span class="bound">Œµ</span><span class="main">.</span> <span class="main">0</span> <span class="main">&lt;</span> <span class="bound">Œµ</span> <span class="main">‚üπ</span> <span class="bound">œÑ</span> <span class="main">‚àà</span> <span class="free">T</span> <span class="main">‚üπ</span> cball <span class="bound">œÑ</span> <span class="bound">Œµ</span> <span class="main">‚äÜ</span> <span class="free">T</span> <span class="main">‚üπ</span> bdd_above <span class="main">{</span><span class="main">‚à•</span>to_vec <span class="main">(</span><span class="free">A</span> <span class="bound">t</span><span class="main">)</span><span class="keyword1">‚à•<span class="hidden">‚á©</span><sub>o</sub><span class="hidden">‚á©</span><sub>p</sub></span> <span class="main">|</span><span class="bound">t</span><span class="main">.</span> <span class="bound">t</span> <span class="main">‚àà</span> cball <span class="bound">œÑ</span> <span class="bound">Œµ</span><span class="main">}</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> norm_sq_mtx_def<span class="main">)</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"local_lipschitz <span class="free">T</span> <span class="free">S</span> <span class="main">(</span><span class="main">Œª</span><span class="bound">t</span> <span class="bound">s</span><span class="main">.</span> to_vec <span class="main">(</span><span class="free">A</span> <span class="bound">t</span><span class="main">)</span> <span class="keyword1">*v</span> <span class="bound">s</span> <span class="main">+</span> <span class="free">B</span> <span class="bound">t</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> local_lipschitz_affine<span class="main">[</span><span class="operator">OF</span> assms<span class="main"><span class="main">(</span></span>2<span class="main"><span class="main">,</span></span>3<span class="main"><span class="main">)</span></span><span class="main">,</span> <span class="operator">of</span> <span class="quoted"><span class="quoted">"<span class="main">Œª</span><span class="bound">t</span><span class="main">.</span> to_vec <span class="main">(</span><span class="free">A</span> <span class="bound">t</span><span class="main">)</span>"</span></span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">force</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">transfer</span> 
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">lemma</span></span> picard_lindeloef_sq_mtx_affine<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"continuous_on <span class="free">T</span> <span class="free">A</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"continuous_on <span class="free">T</span> <span class="free">B</span>"</span></span> 
    <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">t<span class="hidden">‚á©</span><sub>0</sub></span> <span class="main">‚àà</span> <span class="free">T</span>"</span></span> <span class="quoted"><span class="quoted">"is_interval <span class="free">T</span>"</span></span> <span class="quoted"><span class="quoted">"open <span class="free">T</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"open <span class="free">S</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"picard_lindeloef <span class="main">(</span><span class="main">Œª</span><span class="bound">t</span> <span class="bound">s</span><span class="main">.</span> <span class="free">A</span> <span class="bound">t</span> <span class="keyword1">*<span class="hidden">‚á©</span><sub>V</sub></span> <span class="bound">s</span> <span class="main">+</span> <span class="free">B</span> <span class="bound">t</span><span class="main">)</span> <span class="free">T</span> <span class="free">S</span> <span class="free">t<span class="hidden">‚á©</span><sub>0</sub></span>"</span></span>
  <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="main">(</span><span class="operator">unfold_locales</span><span class="main"><span class="keyword3">,</span></span> <span class="operator">simp_all</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> assms<span class="main"><span class="keyword3">,</span></span> <span class="operator">clarsimp</span><span class="main">)</span>
  <span class="keyword1"><span class="command">using</span></span> continuous_on_affine assms <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> local_lipschitz_sq_mtx_affine<span class="main"><span class="keyword3">,</span></span> <span class="operator">simp_all</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> assms<span class="main">)</span>

<span class="keyword1"><span class="command">lemmas</span></span> sq_mtx_unique_sol_autonomous_affine <span class="main">=</span> picard_lindeloef.ivp_unique_solution<span class="main">[</span><span class="operator">OF</span> 
    picard_lindeloef_sq_mtx_affine<span class="main"><span class="main">[</span></span><span class="operator">OF</span>
      continuous_on_const 
      continuous_on_const 
      UNIV_I is_interval_univ 
      open_UNIV open_UNIV<span class="main"><span class="main">]</span></span> 
    UNIV_I _ subset_UNIV<span class="main">]</span>

<span class="keyword1"><span class="command">lemma</span></span> has_vderiv_on_sq_mtx_linear<span class="main">:</span>
  <span class="quoted"><span class="quoted">"<span class="keyword1">D</span> <span class="main">(</span><span class="main">Œª</span><span class="bound">t</span><span class="main">.</span> exp <span class="main">(</span><span class="main">(</span><span class="bound">t</span> <span class="main">-</span> <span class="free">t<span class="hidden">‚á©</span><sub>0</sub></span><span class="main">)</span> <span class="keyword1">*<span class="hidden">‚á©</span><sub>R</sub></span> <span class="free">A</span><span class="main">)</span> <span class="keyword1">*<span class="hidden">‚á©</span><sub>V</sub></span> <span class="free">s</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="main">Œª</span><span class="bound">t</span><span class="main">.</span> <span class="free">A</span> <span class="keyword1">*<span class="hidden">‚á©</span><sub>V</sub></span> <span class="main">(</span>exp <span class="main">(</span><span class="main">(</span><span class="bound">t</span> <span class="main">-</span> <span class="free">t<span class="hidden">‚á©</span><sub>0</sub></span><span class="main">)</span> <span class="keyword1">*<span class="hidden">‚á©</span><sub>R</sub></span> <span class="free">A</span><span class="main">)</span> <span class="keyword1">*<span class="hidden">‚á©</span><sub>V</sub></span> <span class="free">s</span><span class="main">)</span><span class="main">)</span> <span class="keyword1">on</span> <span class="main">{</span><span class="free">t<span class="hidden">‚á©</span><sub>0</sub></span><span class="main">--</span><span class="free">t</span><span class="main">}</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> <span class="dynamic"><span class="dynamic">poly_derivatives</span></span><span class="main">)</span><span class="main"><span class="keyword3">+</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> exp_times_scaleR_commute sq_mtx_times_vec_assoc<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> has_vderiv_on_sq_mtx_affine<span class="main">:</span>
  <span class="keyword2"><span class="keyword">fixes</span></span> <span class="free">t<span class="hidden">‚á©</span><sub>0</sub></span><span class="main">::</span><span class="quoted">real</span> <span class="keyword2"><span class="keyword">and</span></span> <span class="free">A</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="tfree">'a</span><span class="main">::</span>finite<span class="main">)</span> sq_mtx"</span></span>
  <span class="keyword2"><span class="keyword">defines</span></span> <span class="quoted"><span class="quoted">"<span class="free">lSol</span> <span class="free">c</span> <span class="free">t</span> <span class="main">‚â°</span> exp <span class="main">(</span><span class="main">(</span><span class="free">c</span> <span class="main">*</span> <span class="main">(</span><span class="free">t</span> <span class="main">-</span> <span class="free">t<span class="hidden">‚á©</span><sub>0</sub></span><span class="main">)</span><span class="main">)</span> <span class="keyword1">*<span class="hidden">‚á©</span><sub>R</sub></span> <span class="free">A</span><span class="main">)</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">D</span> <span class="main">(</span><span class="main">Œª</span><span class="bound">t</span><span class="main">.</span> <span class="free">lSol</span> <span class="main">1</span> <span class="bound">t</span> <span class="keyword1">*<span class="hidden">‚á©</span><sub>V</sub></span> <span class="free">s</span> <span class="main">+</span> <span class="free">lSol</span> <span class="main">1</span> <span class="bound">t</span> <span class="keyword1">*<span class="hidden">‚á©</span><sub>V</sub></span> <span class="main">(</span><span class="main">‚à´‚á©</span><span class="free">t<span class="hidden">‚á©</span><sub>0</sub></span><span class="main">‚áß</span><span class="bound">t</span> <span class="main">(</span><span class="free">lSol</span> <span class="main">(</span><span class="main">-</span><span class="main">1</span><span class="main">)</span> <span class="bound">œÑ</span> <span class="keyword1">*<span class="hidden">‚á©</span><sub>V</sub></span> <span class="free">B</span><span class="main">)</span> <span class="main">‚àÇ</span><span class="bound">œÑ</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> 
  <span class="main">(</span><span class="main">Œª</span><span class="bound">t</span><span class="main">.</span> <span class="free">A</span> <span class="keyword1">*<span class="hidden">‚á©</span><sub>V</sub></span> <span class="main">(</span><span class="free">lSol</span> <span class="main">1</span> <span class="bound">t</span> <span class="keyword1">*<span class="hidden">‚á©</span><sub>V</sub></span> <span class="free">s</span> <span class="main">+</span> <span class="free">lSol</span> <span class="main">1</span> <span class="bound">t</span> <span class="keyword1">*<span class="hidden">‚á©</span><sub>V</sub></span> <span class="main">(</span><span class="main">‚à´‚á©</span><span class="free">t<span class="hidden">‚á©</span><sub>0</sub></span><span class="main">‚áß</span><span class="bound">t</span> <span class="main">(</span><span class="free">lSol</span> <span class="main">(</span><span class="main">-</span><span class="main">1</span><span class="main">)</span> <span class="bound">œÑ</span> <span class="keyword1">*<span class="hidden">‚á©</span><sub>V</sub></span> <span class="free">B</span><span class="main">)</span> <span class="main">‚àÇ</span><span class="bound">œÑ</span><span class="main">)</span><span class="main">)</span> <span class="main">+</span> <span class="free">B</span><span class="main">)</span> <span class="keyword1">on</span> <span class="main">{</span><span class="free">t<span class="hidden">‚á©</span><sub>0</sub></span><span class="main">--</span><span class="free">t</span><span class="main">}</span>"</span></span>
  <span class="keyword1"><span class="command">unfolding</span></span> assms <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">only</span><span class="main"><span class="main">:</span></span> mult.left_neutral mult_minus1<span class="main">)</span>
  <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="main">(</span><span class="operator">rule</span> <span class="dynamic"><span class="dynamic">poly_derivatives</span></span><span class="main"><span class="keyword3">,</span></span> <span class="main">(</span><span class="operator">force</span><span class="main">)</span><span class="main"><span class="keyword3">?</span></span><span class="main"><span class="keyword3">,</span></span> <span class="main">(</span><span class="operator">force</span><span class="main">)</span><span class="main"><span class="keyword3">?</span></span><span class="main"><span class="keyword3">,</span></span> <span class="main">(</span><span class="operator">force</span><span class="main">)</span><span class="main"><span class="keyword3">?</span></span><span class="main"><span class="keyword3">,</span></span> <span class="main">(</span><span class="operator">force</span><span class="main">)</span><span class="main"><span class="keyword3">?</span></span><span class="main">)</span><span class="main"><span class="keyword3">+</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> mtx_vec_mult_add_rdistl sq_mtx_times_vec_assoc<span class="main"><span class="main">[</span></span><span class="operator">symmetric</span><span class="main"><span class="main">]</span></span> 
      exp_minus_inverse exp_times_scaleR_commute mult_exp_exp  scale_left_distrib<span class="main"><span class="main">[</span></span><span class="operator">symmetric</span><span class="main"><span class="main">]</span></span><span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> autonomous_linear_sol_is_exp<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">D</span> <span class="free">X</span> <span class="main">=</span> <span class="main">(</span><span class="main">Œª</span><span class="bound">t</span><span class="main">.</span> <span class="free">A</span> <span class="keyword1">*<span class="hidden">‚á©</span><sub>V</sub></span> <span class="free">X</span> <span class="bound">t</span><span class="main">)</span> <span class="keyword1">on</span> <span class="main">{</span><span class="free">t<span class="hidden">‚á©</span><sub>0</sub></span><span class="main">--</span><span class="free">t</span><span class="main">}</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">X</span> <span class="free">t<span class="hidden">‚á©</span><sub>0</sub></span> <span class="main">=</span> <span class="free">s</span>"</span></span> 
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">X</span> <span class="free">t</span> <span class="main">=</span> exp <span class="main">(</span><span class="main">(</span><span class="free">t</span> <span class="main">-</span> <span class="free">t<span class="hidden">‚á©</span><sub>0</sub></span><span class="main">)</span> <span class="keyword1">*<span class="hidden">‚á©</span><sub>R</sub></span> <span class="free">A</span><span class="main">)</span> <span class="keyword1">*<span class="hidden">‚á©</span><sub>V</sub></span> <span class="free">s</span>"</span></span>
  <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="main">(</span><span class="operator">rule</span> sq_mtx_unique_sol_autonomous_affine<span class="main"><span class="main">[</span></span><span class="operator">of</span> <span class="quoted"><span class="quoted"><span class="quoted">"<span class="main"><span class="main">Œª</span></span><span class="bound"><span class="bound">s</span></span><span class="main"><span class="main">.</span></span> <span class="main"><span class="main">{</span></span><span class="free"><span class="free">t<span class="hidden">‚á©</span><sub>0</sub></span></span><span class="main"><span class="main">--</span></span><span class="free"><span class="free">t</span></span><span class="main"><span class="main">}</span></span>"</span></span></span> <span class="main"><span class="main">_</span></span> <span class="quoted"><span class="free"><span class="quoted"><span class="free">t</span></span></span></span> <span class="quoted"><span class="free"><span class="quoted"><span class="free">X</span></span></span></span> <span class="quoted"><span class="free"><span class="quoted"><span class="free">A</span></span></span></span> <span class="quoted"><span class="main"><span class="quoted"><span class="main">0</span></span></span></span><span class="main"><span class="main">]</span></span><span class="main">)</span>
  <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="main">(</span><span class="operator">simp_all</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> ivp_sols_def<span class="main">)</span>
  <span class="keyword1"><span class="command">using</span></span> has_vderiv_on_sq_mtx_linear <span class="keyword1"><span class="command">by</span></span> <span class="operator">force</span><span class="main"><span class="keyword3">+</span></span>

<span class="keyword1"><span class="command">lemma</span></span> autonomous_affine_sol_is_exp_plus_int<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">D</span> <span class="free">X</span> <span class="main">=</span> <span class="main">(</span><span class="main">Œª</span><span class="bound">t</span><span class="main">.</span> <span class="free">A</span> <span class="keyword1">*<span class="hidden">‚á©</span><sub>V</sub></span> <span class="free">X</span> <span class="bound">t</span> <span class="main">+</span> <span class="free">B</span><span class="main">)</span> <span class="keyword1">on</span> <span class="main">{</span><span class="free">t<span class="hidden">‚á©</span><sub>0</sub></span><span class="main">--</span><span class="free">t</span><span class="main">}</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">X</span> <span class="free">t<span class="hidden">‚á©</span><sub>0</sub></span> <span class="main">=</span> <span class="free">s</span>"</span></span> 
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">X</span> <span class="free">t</span> <span class="main">=</span> exp <span class="main">(</span><span class="main">(</span><span class="free">t</span> <span class="main">-</span> <span class="free">t<span class="hidden">‚á©</span><sub>0</sub></span><span class="main">)</span> <span class="keyword1">*<span class="hidden">‚á©</span><sub>R</sub></span> <span class="free">A</span><span class="main">)</span> <span class="keyword1">*<span class="hidden">‚á©</span><sub>V</sub></span> <span class="free">s</span> <span class="main">+</span> exp <span class="main">(</span><span class="main">(</span><span class="free">t</span> <span class="main">-</span> <span class="free">t<span class="hidden">‚á©</span><sub>0</sub></span><span class="main">)</span> <span class="keyword1">*<span class="hidden">‚á©</span><sub>R</sub></span> <span class="free">A</span><span class="main">)</span> <span class="keyword1">*<span class="hidden">‚á©</span><sub>V</sub></span> <span class="main">(</span><span class="main">‚à´‚á©</span><span class="free">t<span class="hidden">‚á©</span><sub>0</sub></span><span class="main">‚áß</span><span class="free">t</span><span class="main">(</span>exp <span class="main">(</span><span class="main">-</span> <span class="main">(</span><span class="bound">œÑ</span> <span class="main">-</span> <span class="free">t<span class="hidden">‚á©</span><sub>0</sub></span><span class="main">)</span> <span class="keyword1">*<span class="hidden">‚á©</span><sub>R</sub></span> <span class="free">A</span><span class="main">)</span> <span class="keyword1">*<span class="hidden">‚á©</span><sub>V</sub></span> <span class="free">B</span><span class="main">)</span><span class="main">‚àÇ</span><span class="bound">œÑ</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="main">(</span><span class="operator">rule</span> sq_mtx_unique_sol_autonomous_affine<span class="main"><span class="main">[</span></span><span class="operator">of</span> <span class="quoted"><span class="quoted"><span class="quoted">"<span class="main"><span class="main">Œª</span></span><span class="bound"><span class="bound">s</span></span><span class="main"><span class="main">.</span></span> <span class="main"><span class="main">{</span></span><span class="free"><span class="free">t<span class="hidden">‚á©</span><sub>0</sub></span></span><span class="main"><span class="main">--</span></span><span class="free"><span class="free">t</span></span><span class="main"><span class="main">}</span></span>"</span></span></span> <span class="main"><span class="main">_</span></span> <span class="quoted"><span class="free"><span class="quoted"><span class="free">t</span></span></span></span> <span class="quoted"><span class="free"><span class="quoted"><span class="free">X</span></span></span></span> <span class="quoted"><span class="free"><span class="quoted"><span class="free">A</span></span></span></span> <span class="quoted"><span class="free"><span class="quoted"><span class="free">B</span></span></span></span><span class="main"><span class="main">]</span></span><span class="main">)</span>
  <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="main">(</span><span class="operator">simp_all</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> ivp_sols_def<span class="main">)</span>
  <span class="keyword1"><span class="command">using</span></span> has_vderiv_on_sq_mtx_affine <span class="keyword1"><span class="command">by</span></span> <span class="operator">force</span><span class="main"><span class="keyword3">+</span></span>

<span class="keyword1"><span class="command">lemma</span></span> local_flow_sq_mtx_linear<span class="main">:</span> <span class="quoted"><span class="quoted">"local_flow <span class="main">(</span><span class="keyword1">(*<span class="hidden">‚á©</span><sub>V</sub>)</span> <span class="free">A</span><span class="main">)</span> UNIV UNIV <span class="main">(</span><span class="main">Œª</span><span class="bound">t</span> <span class="bound">s</span><span class="main">.</span> exp <span class="main">(</span><span class="bound">t</span> <span class="keyword1">*<span class="hidden">‚á©</span><sub>R</sub></span> <span class="free">A</span><span class="main">)</span> <span class="keyword1">*<span class="hidden">‚á©</span><sub>V</sub></span> <span class="bound">s</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">unfolding</span></span> local_flow_def local_flow_axioms_def <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="operator">safe</span>
  <span class="keyword1"><span class="command">using</span></span> picard_lindeloef_sq_mtx_affine<span class="main">[</span><span class="operator">of</span> <span class="main">_</span> <span class="quoted"><span class="quoted">"<span class="main">Œª</span><span class="bound">t</span><span class="main">.</span> <span class="free">A</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="main">Œª</span><span class="bound">t</span><span class="main">.</span> <span class="main">0</span>"</span></span><span class="main">]</span> <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="operator">force</span>
  <span class="keyword1"><span class="command">using</span></span> has_vderiv_on_sq_mtx_linear<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="main">0</span></span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">lemma</span></span> local_flow_sq_mtx_affine<span class="main">:</span> <span class="quoted"><span class="quoted">"local_flow <span class="main">(</span><span class="main">Œª</span><span class="bound">s</span><span class="main">.</span> <span class="free">A</span> <span class="keyword1">*<span class="hidden">‚á©</span><sub>V</sub></span> <span class="bound">s</span> <span class="main">+</span> <span class="free">B</span><span class="main">)</span> UNIV UNIV 
  <span class="main">(</span><span class="main">Œª</span><span class="bound">t</span> <span class="bound">s</span><span class="main">.</span> exp <span class="main">(</span><span class="bound">t</span> <span class="keyword1">*<span class="hidden">‚á©</span><sub>R</sub></span> <span class="free">A</span><span class="main">)</span> <span class="keyword1">*<span class="hidden">‚á©</span><sub>V</sub></span> <span class="bound">s</span> <span class="main">+</span> exp <span class="main">(</span><span class="bound">t</span> <span class="keyword1">*<span class="hidden">‚á©</span><sub>R</sub></span> <span class="free">A</span><span class="main">)</span> <span class="keyword1">*<span class="hidden">‚á©</span><sub>V</sub></span> <span class="main">(</span><span class="main">‚à´‚á©</span><span class="main">0</span><span class="main">‚áß</span><span class="bound">t</span><span class="main">(</span>exp <span class="main">(</span><span class="main">-</span> <span class="bound">œÑ</span> <span class="keyword1">*<span class="hidden">‚á©</span><sub>R</sub></span> <span class="free">A</span><span class="main">)</span> <span class="keyword1">*<span class="hidden">‚á©</span><sub>V</sub></span> <span class="free">B</span><span class="main">)</span><span class="main">‚àÇ</span><span class="bound">œÑ</span><span class="main">)</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">unfolding</span></span> local_flow_def local_flow_axioms_def <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="operator">safe</span>
  <span class="keyword1"><span class="command">using</span></span> picard_lindeloef_sq_mtx_affine<span class="main">[</span><span class="operator">of</span> <span class="main">_</span> <span class="quoted"><span class="quoted">"<span class="main">Œª</span><span class="bound">t</span><span class="main">.</span> <span class="free">A</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="main">Œª</span><span class="bound">t</span><span class="main">.</span> <span class="free">B</span>"</span></span><span class="main">]</span> <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="operator">force</span>
  <span class="keyword1"><span class="command">using</span></span> has_vderiv_on_sq_mtx_affine<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="main">0</span></span> <span class="quoted"><span class="free">A</span></span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>


<span class="keyword2"><span class="keyword">end</span></span></pre>
</div><div id="MTX_Examples">
<div class="head">
<h1>Theory MTX_Examples</h1>
</div>
<pre class="source"><span class="comment1">(*  Title:       Verification Examples
    Author:      Jonathan Juli√°n Huerta y Munive, 2020
    Maintainer:  Jonathan Juli√°n Huerta y Munive &lt;jonjulian23@gmail.com&gt;
*)</span>

<span class="keyword1"><span class="command">section</span></span> <span class="quoted"><span class="plain_text">‚Äπ Verification examples ‚Ä∫</span></span>


<span class="keyword1"><span class="command">theory</span></span> MTX_Examples
  <span class="keyword2"><span class="keyword">imports</span></span> 
    <a href="MTX_Flows.html">MTX_Flows</a> 
    <a href="../Hybrid_Systems_VCs/HS_VC_Spartan.html">Hybrid_Systems_VCs.HS_VC_Spartan</a>

<span class="keyword2"><span class="keyword">begin</span></span>


<span class="keyword1"><span class="command">subsection</span></span> <span class="quoted"><span class="plain_text">‚Äπ Examples ‚Ä∫</span></span>

<span class="keyword1"><span class="command">abbreviation</span></span> <span class="entity">hoareT</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="tfree">'a</span> <span class="main">‚áí</span> bool<span class="main">)</span> <span class="main">‚áí</span> <span class="main">(</span><span class="tfree">'a</span> <span class="main">‚áí</span> <span class="tfree">'a</span> set<span class="main">)</span> <span class="main">‚áí</span> <span class="main">(</span><span class="tfree">'a</span> <span class="main">‚áí</span> bool<span class="main">)</span> <span class="main">‚áí</span> bool"</span></span> 
  <span class="main">(</span><span class="quoted">"<span class="keyword1">PRE</span>_ <span class="keyword1">HP</span> _ <span class="keyword1">POST</span> _"</span> <span class="main">[</span>85<span class="main">,</span>85<span class="main">]</span>85<span class="main">)</span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1"><span class="free">PRE</span></span> <span class="free"><span class="bound"><span class="entity">P</span></span></span> <span class="keyword1"><span class="free">HP</span></span> <span class="free"><span class="bound"><span class="entity">X</span></span></span> <span class="keyword1"><span class="free">POST</span></span> <span class="free"><span class="bound"><span class="entity">Q</span></span></span> <span class="main">‚â°</span> <span class="main">(</span><span class="free"><span class="bound"><span class="entity">P</span></span></span> <span class="main">‚â§</span> <span class="main">|</span><span class="free"><span class="bound"><span class="entity">X</span></span></span><span class="main">]</span><span class="free"><span class="bound"><span class="entity">Q</span></span></span><span class="main">)</span>"</span></span>


<span class="keyword1"><span class="command">subsubsection</span></span> <span class="quoted"><span class="plain_text">‚Äπ Verification by uniqueness. ‚Ä∫</span></span>

<span class="keyword1"><span class="command">abbreviation</span></span> <span class="entity">mtx_circ</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="numeral">2</span> sq_mtx"</span></span> <span class="main">(</span><span class="quoted">"<span class="keyword1">A</span>"</span><span class="main">)</span>
  <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1"><span class="free">A</span></span> <span class="main">‚â°</span> mtx  
   <span class="main">(</span><span class="main">[</span><span class="main">0</span><span class="main">,</span>  <span class="main">1</span><span class="main">]</span> <span class="main">#</span> 
    <span class="main">[</span><span class="main">-</span><span class="main">1</span><span class="main">,</span> <span class="main">0</span><span class="main">]</span> <span class="main">#</span> <span class="main">[]</span><span class="main">)</span>"</span></span>

<span class="keyword1"><span class="command">abbreviation</span></span> <span class="entity">mtx_circ_flow</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"real <span class="main">‚áí</span> real<span class="main">^</span><span class="numeral">2</span> <span class="main">‚áí</span> real<span class="main">^</span><span class="numeral">2</span>"</span></span> <span class="main">(</span><span class="quoted">"<span class="keyword1">œÜ</span>"</span><span class="main">)</span>
  <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1"><span class="free">œÜ</span></span> <span class="free"><span class="bound"><span class="entity">t</span></span></span> <span class="free"><span class="bound"><span class="entity">s</span></span></span> <span class="main">‚â°</span> <span class="main">(</span><span class="keyword1">œá</span> <span class="bound">i</span><span class="main">.</span> <span class="keyword1">if</span> <span class="bound">i</span> <span class="main">=</span> <span class="main">1</span> <span class="keyword1">then</span> <span class="free"><span class="bound"><span class="entity">s</span></span></span><span class="main">$</span><span class="main">1</span> <span class="main">*</span> cos <span class="free"><span class="bound"><span class="entity">t</span></span></span> <span class="main">+</span> <span class="free"><span class="bound"><span class="entity">s</span></span></span><span class="main">$</span><span class="numeral">2</span> <span class="main">*</span> sin <span class="free"><span class="bound"><span class="entity">t</span></span></span> <span class="keyword1">else</span> <span class="main">-</span> <span class="free"><span class="bound"><span class="entity">s</span></span></span><span class="main">$</span><span class="main">1</span> <span class="main">*</span> sin <span class="free"><span class="bound"><span class="entity">t</span></span></span> <span class="main">+</span> <span class="free"><span class="bound"><span class="entity">s</span></span></span><span class="main">$</span><span class="numeral">2</span> <span class="main">*</span> cos <span class="free"><span class="bound"><span class="entity">t</span></span></span><span class="main">)</span>"</span></span>

<span class="keyword1"><span class="command">lemma</span></span> mtx_circ_flow_eq<span class="main">:</span> <span class="quoted"><span class="quoted">"exp <span class="main">(</span><span class="free">t</span> <span class="keyword1">*<span class="hidden">‚á©</span><sub>R</sub></span> <span class="keyword1">A</span><span class="main">)</span> <span class="keyword1">*<span class="hidden">‚á©</span><sub>V</sub></span> <span class="free">s</span> <span class="main">=</span> <span class="keyword1">œÜ</span> <span class="free">t</span> <span class="free">s</span>"</span></span>
  <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="main">(</span><span class="operator">rule</span> local_flow.eq_solution<span class="main"><span class="main">[</span></span><span class="operator">OF</span> local_flow_sq_mtx_linear<span class="main"><span class="main">,</span></span> <span class="operator">symmetric</span><span class="main"><span class="main">,</span></span> <span class="operator">of</span> <span class="main"><span class="main">_</span></span> <span class="quoted"><span class="quoted"><span class="quoted">"<span class="main"><span class="main">Œª</span></span><span class="bound"><span class="bound">s</span></span><span class="main"><span class="main">.</span></span> UNIV"</span></span></span><span class="main"><span class="main">]</span></span><span class="main"><span class="keyword3">,</span></span> <span class="operator">simp_all</span><span class="main">)</span>
    <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="main">(</span><span class="operator">rule</span> ivp_solsI<span class="main"><span class="keyword3">,</span></span> <span class="operator">simp_all</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> sq_mtx_vec_mult_eq vec_eq_iff<span class="main">)</span>
  <span class="keyword1"><span class="command">unfolding</span></span> UNIV_2 <span class="keyword1"><span class="command">using</span></span> exhaust_2
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">force</span> <span class="quasi_keyword">intro</span><span class="main"><span class="main">!</span></span><span class="main"><span class="main">:</span></span> <span class="dynamic"><span class="dynamic">poly_derivatives</span></span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> matrix_vector_mult_def<span class="main">)</span><span class="main"><span class="keyword3">+</span></span>

<span class="keyword1"><span class="command">lemma</span></span> mtx_circ<span class="main">:</span> 
  <span class="quoted"><span class="quoted">"<span class="keyword1">PRE</span><span class="main">(</span><span class="main">Œª</span><span class="bound">s</span><span class="main">.</span> <span class="free">r</span><span class="main"><span class="hidden">‚áß</span><sup>2</sup></span> <span class="main">=</span> <span class="main">(</span><span class="bound">s</span> <span class="main">$</span> <span class="main">1</span><span class="main">)</span><span class="main"><span class="hidden">‚áß</span><sup>2</sup></span> <span class="main">+</span> <span class="main">(</span><span class="bound">s</span> <span class="main">$</span> <span class="numeral">2</span><span class="main">)</span><span class="main"><span class="hidden">‚áß</span><sup>2</sup></span><span class="main">)</span> 
  <span class="keyword1">HP</span> <span class="keyword1">x¬¥=</span><span class="keyword1">(*<span class="hidden">‚á©</span><sub>V</sub>)</span> <span class="keyword1">A</span> <span class="main">&amp;</span> <span class="free">G</span> 
  <span class="keyword1">POST</span> <span class="main">(</span><span class="main">Œª</span><span class="bound">s</span><span class="main">.</span> <span class="free">r</span><span class="main"><span class="hidden">‚áß</span><sup>2</sup></span> <span class="main">=</span> <span class="main">(</span><span class="bound">s</span> <span class="main">$</span> <span class="main">1</span><span class="main">)</span><span class="main"><span class="hidden">‚áß</span><sup>2</sup></span> <span class="main">+</span> <span class="main">(</span><span class="bound">s</span> <span class="main">$</span> <span class="numeral">2</span><span class="main">)</span><span class="main"><span class="hidden">‚áß</span><sup>2</sup></span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="main">(</span><span class="operator">subst</span> local_flow.fbox_g_ode_subset<span class="main"><span class="main">[</span></span><span class="operator">OF</span> local_flow_sq_mtx_linear<span class="main"><span class="main">]</span></span><span class="main">)</span>
  <span class="keyword1"><span class="command">unfolding</span></span> mtx_circ_flow_eq <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">no_notation</span></span> mtx_circ <span class="main">(</span><span class="quoted">"<span class="keyword1">A</span>"</span><span class="main">)</span>
        <span class="keyword2"><span class="keyword">and</span></span> mtx_circ_flow <span class="main">(</span><span class="quoted">"<span class="keyword1">œÜ</span>"</span><span class="main">)</span>


<span class="keyword1"><span class="command">subsubsection</span></span> <span class="quoted"><span class="plain_text">‚Äπ Flow of diagonalisable matrix. ‚Ä∫</span></span>

<span class="keyword1"><span class="command">abbreviation</span></span> <span class="entity">mtx_hOsc</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"real <span class="main">‚áí</span> real <span class="main">‚áí</span> <span class="numeral">2</span> sq_mtx"</span></span> <span class="main">(</span><span class="quoted">"<span class="keyword1">A</span>"</span><span class="main">)</span>
  <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1"><span class="free">A</span></span> <span class="free"><span class="bound"><span class="entity">a</span></span></span> <span class="free"><span class="bound"><span class="entity">b</span></span></span> <span class="main">‚â°</span> mtx  
   <span class="main">(</span><span class="main">[</span><span class="main">0</span><span class="main">,</span> <span class="main">1</span><span class="main">]</span> <span class="main">#</span> 
    <span class="main">[</span><span class="free"><span class="bound"><span class="entity">a</span></span></span><span class="main">,</span> <span class="free"><span class="bound"><span class="entity">b</span></span></span><span class="main">]</span> <span class="main">#</span> <span class="main">[]</span><span class="main">)</span>"</span></span>

<span class="keyword1"><span class="command">abbreviation</span></span> <span class="entity">mtx_chB_hOsc</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"real <span class="main">‚áí</span> real <span class="main">‚áí</span> <span class="numeral">2</span> sq_mtx"</span></span> <span class="main">(</span><span class="quoted">"<span class="keyword1">P</span>"</span><span class="main">)</span>
  <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1"><span class="free">P</span></span> <span class="free"><span class="bound"><span class="entity">a</span></span></span> <span class="free"><span class="bound"><span class="entity">b</span></span></span> <span class="main">‚â°</span> mtx
   <span class="main">(</span><span class="main">[</span><span class="free"><span class="bound"><span class="entity">a</span></span></span><span class="main">,</span> <span class="free"><span class="bound"><span class="entity">b</span></span></span><span class="main">]</span> <span class="main">#</span> 
    <span class="main">[</span><span class="main">1</span><span class="main">,</span> <span class="main">1</span><span class="main">]</span> <span class="main">#</span> <span class="main">[]</span><span class="main">)</span>"</span></span>

<span class="keyword1"><span class="command">lemma</span></span> inv_mtx_chB_hOsc<span class="main">:</span> 
  <span class="quoted"><span class="quoted">"<span class="free">a</span> <span class="main">‚â†</span> <span class="free">b</span> <span class="main">‚üπ</span> <span class="main">(</span><span class="keyword1">P</span> <span class="free">a</span> <span class="free">b</span><span class="main">)</span><span class="main"><span class="hidden">‚áß</span><sup>-</sup><span class="hidden">‚áß</span><sup>1</sup></span> <span class="main">=</span> <span class="main">(</span><span class="main">1</span><span class="main">/</span><span class="main">(</span><span class="free">a</span> <span class="main">-</span> <span class="free">b</span><span class="main">)</span><span class="main">)</span> <span class="keyword1">*<span class="hidden">‚á©</span><sub>R</sub></span> mtx 
   <span class="main">(</span><span class="main">[</span> <span class="main">1</span><span class="main">,</span> <span class="main">-</span><span class="free">b</span><span class="main">]</span> <span class="main">#</span> 
    <span class="main">[</span><span class="main">-</span><span class="main">1</span><span class="main">,</span>  <span class="free">a</span><span class="main">]</span> <span class="main">#</span> <span class="main">[]</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="main">(</span><span class="operator">rule</span> sq_mtx_inv_unique<span class="main"><span class="keyword3">,</span></span> <span class="operator">unfold</span> scaleR_mtx2 times_mtx2<span class="main">)</span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> diff_divide_distrib<span class="main"><span class="main">[</span></span><span class="operator">symmetric</span><span class="main"><span class="main">]</span></span> one_mtx2<span class="main">)</span><span class="main"><span class="keyword3">+</span></span>

<span class="keyword1"><span class="command">lemma</span></span> invertible_mtx_chB_hOsc<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">a</span> <span class="main">‚â†</span> <span class="free">b</span> <span class="main">‚üπ</span> mtx_invertible <span class="main">(</span><span class="keyword1">P</span> <span class="free">a</span> <span class="free">b</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="main">(</span><span class="operator">rule</span> mtx_invertibleI<span class="main"><span class="main">[</span></span><span class="operator">of</span> <span class="main"><span class="main">_</span></span> <span class="quoted"><span class="quoted"><span class="quoted">"<span class="main"><span class="main">(</span></span><span class="keyword1"><span class="keyword1">P</span></span> <span class="free"><span class="free">a</span></span> <span class="free"><span class="free">b</span></span><span class="main"><span class="main">)</span></span><span class="main"><span class="main"><span class="hidden">‚áß</span><sup>-</sup><span class="hidden">‚áß</span><sup>1</sup></span></span>"</span></span></span><span class="main"><span class="main">]</span></span><span class="main">)</span>
   <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="main">(</span><span class="operator">unfold</span> inv_mtx_chB_hOsc scaleR_mtx2 times_mtx2 one_mtx2<span class="main">)</span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">subst</span> sq_mtx_eq_iff<span class="main"><span class="keyword3">,</span></span> <span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> vector_def frac_diff_eq1<span class="main">)</span><span class="main"><span class="keyword3">+</span></span>

<span class="keyword1"><span class="command">lemma</span></span> mtx_hOsc_diagonalizable<span class="main">:</span>
  <span class="keyword2"><span class="keyword">fixes</span></span> <span class="free">a</span> <span class="free">b</span> <span class="main">::</span> <span class="quoted">real</span>
  <span class="keyword2"><span class="keyword">defines</span></span> <span class="quoted"><span class="quoted">"<span class="free">Œπ<span class="hidden">‚á©</span><sub>1</sub></span> <span class="main">‚â°</span> <span class="main">(</span><span class="free">b</span> <span class="main">-</span> sqrt <span class="main">(</span><span class="free">b</span><span class="main">^</span><span class="numeral">2</span><span class="main">+</span><span class="numeral">4</span><span class="main">*</span><span class="free">a</span><span class="main">)</span><span class="main">)</span><span class="main">/</span><span class="numeral">2</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">Œπ<span class="hidden">‚á©</span><sub>2</sub></span> <span class="main">‚â°</span> <span class="main">(</span><span class="free">b</span> <span class="main">+</span> sqrt <span class="main">(</span><span class="free">b</span><span class="main">^</span><span class="numeral">2</span><span class="main">+</span><span class="numeral">4</span><span class="main">*</span><span class="free">a</span><span class="main">)</span><span class="main">)</span><span class="main">/</span><span class="numeral">2</span>"</span></span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">b</span><span class="main"><span class="hidden">‚áß</span><sup>2</sup></span> <span class="main">+</span> <span class="free">a</span> <span class="main">*</span> <span class="numeral">4</span> <span class="main">&gt;</span> <span class="main">0</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span> <span class="main">‚â†</span> <span class="main">0</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">A</span> <span class="free">a</span> <span class="free">b</span> <span class="main">=</span> <span class="keyword1">P</span> <span class="main">(</span><span class="main">-</span><span class="free">Œπ<span class="hidden">‚á©</span><sub>2</sub></span><span class="main">/</span><span class="free">a</span><span class="main">)</span> <span class="main">(</span><span class="main">-</span><span class="free">Œπ<span class="hidden">‚á©</span><sub>1</sub></span><span class="main">/</span><span class="free">a</span><span class="main">)</span> <span class="main">*</span> <span class="main">(</span><span class="keyword1">ùñΩùóÇùñ∫ùóÄ</span> <span class="bound">i</span><span class="main">.</span> <span class="keyword1">if</span> <span class="bound">i</span> <span class="main">=</span> <span class="main">1</span> <span class="keyword1">then</span> <span class="free">Œπ<span class="hidden">‚á©</span><sub>1</sub></span> <span class="keyword1">else</span> <span class="free">Œπ<span class="hidden">‚á©</span><sub>2</sub></span><span class="main">)</span> <span class="main">*</span> <span class="main">(</span><span class="keyword1">P</span> <span class="main">(</span><span class="main">-</span><span class="free">Œπ<span class="hidden">‚á©</span><sub>2</sub></span><span class="main">/</span><span class="free">a</span><span class="main">)</span> <span class="main">(</span><span class="main">-</span><span class="free">Œπ<span class="hidden">‚á©</span><sub>1</sub></span><span class="main">/</span><span class="free">a</span><span class="main">)</span><span class="main">)</span><span class="main"><span class="hidden">‚áß</span><sup>-</sup><span class="hidden">‚áß</span><sup>1</sup></span>"</span></span>
  <span class="keyword1"><span class="command">unfolding</span></span> assms <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="main">(</span><span class="operator">subst</span> inv_mtx_chB_hOsc<span class="main">)</span>
  <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>3<span class="main">,</span>4<span class="main">)</span> <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="main">(</span><span class="operator">simp_all</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> diag2_eq<span class="main"><span class="main">[</span></span><span class="operator">symmetric</span><span class="main"><span class="main">]</span></span><span class="main">)</span>
  <span class="keyword1"><span class="command">unfolding</span></span> sq_mtx_times_eq sq_mtx_scaleR_eq UNIV_2 <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="main">(</span><span class="operator">subst</span> sq_mtx_eq_iff<span class="main">)</span>
  <span class="keyword1"><span class="command">using</span></span> exhaust_2 assms <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> <span class="dynamic"><span class="dynamic">field_simps</span></span><span class="main"><span class="keyword3">,</span></span> <span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> <span class="dynamic"><span class="dynamic">field_power_simps</span></span><span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> mtx_hOsc_solution_eq<span class="main">:</span>
  <span class="keyword2"><span class="keyword">fixes</span></span> <span class="free">a</span> <span class="free">b</span> <span class="main">::</span> <span class="quoted">real</span>
  <span class="keyword2"><span class="keyword">defines</span></span> <span class="quoted"><span class="quoted">"<span class="free">Œπ<span class="hidden">‚á©</span><sub>1</sub></span> <span class="main">‚â°</span> <span class="main">(</span><span class="free">b</span> <span class="main">-</span> sqrt <span class="main">(</span><span class="free">b</span><span class="main"><span class="hidden">‚áß</span><sup>2</sup></span><span class="main">+</span><span class="numeral">4</span><span class="main">*</span><span class="free">a</span><span class="main">)</span><span class="main">)</span><span class="main">/</span><span class="numeral">2</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">Œπ<span class="hidden">‚á©</span><sub>2</sub></span> <span class="main">‚â°</span> <span class="main">(</span><span class="free">b</span> <span class="main">+</span> sqrt <span class="main">(</span><span class="free">b</span><span class="main"><span class="hidden">‚áß</span><sup>2</sup></span><span class="main">+</span><span class="numeral">4</span><span class="main">*</span><span class="free">a</span><span class="main">)</span><span class="main">)</span><span class="main">/</span><span class="numeral">2</span>"</span></span>
  <span class="keyword2"><span class="keyword">defines</span></span> <span class="quoted"><span class="quoted">"<span class="free">Œ¶</span> <span class="free">t</span> <span class="main">‚â°</span> mtx <span class="main">(</span>
   <span class="main">[</span><span class="free">Œπ<span class="hidden">‚á©</span><sub>2</sub></span><span class="main">*</span>exp<span class="main">(</span><span class="free">t</span><span class="main">*</span><span class="free">Œπ<span class="hidden">‚á©</span><sub>1</sub></span><span class="main">)</span> <span class="main">-</span> <span class="free">Œπ<span class="hidden">‚á©</span><sub>1</sub></span><span class="main">*</span>exp<span class="main">(</span><span class="free">t</span><span class="main">*</span><span class="free">Œπ<span class="hidden">‚á©</span><sub>2</sub></span><span class="main">)</span><span class="main">,</span>     exp<span class="main">(</span><span class="free">t</span><span class="main">*</span><span class="free">Œπ<span class="hidden">‚á©</span><sub>2</sub></span><span class="main">)</span><span class="main">-</span>exp<span class="main">(</span><span class="free">t</span><span class="main">*</span><span class="free">Œπ<span class="hidden">‚á©</span><sub>1</sub></span><span class="main">)</span><span class="main">]</span><span class="main">#</span>
   <span class="main">[</span><span class="free">a</span><span class="main">*</span>exp<span class="main">(</span><span class="free">t</span><span class="main">*</span><span class="free">Œπ<span class="hidden">‚á©</span><sub>2</sub></span><span class="main">)</span> <span class="main">-</span> <span class="free">a</span><span class="main">*</span>exp<span class="main">(</span><span class="free">t</span><span class="main">*</span><span class="free">Œπ<span class="hidden">‚á©</span><sub>1</sub></span><span class="main">)</span><span class="main">,</span> <span class="free">Œπ<span class="hidden">‚á©</span><sub>2</sub></span><span class="main">*</span>exp<span class="main">(</span><span class="free">t</span><span class="main">*</span><span class="free">Œπ<span class="hidden">‚á©</span><sub>2</sub></span><span class="main">)</span><span class="main">-</span><span class="free">Œπ<span class="hidden">‚á©</span><sub>1</sub></span><span class="main">*</span>exp<span class="main">(</span><span class="free">t</span><span class="main">*</span><span class="free">Œπ<span class="hidden">‚á©</span><sub>1</sub></span><span class="main">)</span><span class="main">]</span><span class="main">#</span><span class="main">[]</span><span class="main">)</span>"</span></span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">b</span><span class="main"><span class="hidden">‚áß</span><sup>2</sup></span> <span class="main">+</span> <span class="free">a</span> <span class="main">*</span> <span class="numeral">4</span> <span class="main">&gt;</span> <span class="main">0</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span> <span class="main">‚â†</span> <span class="main">0</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">P</span> <span class="main">(</span><span class="main">-</span><span class="free">Œπ<span class="hidden">‚á©</span><sub>2</sub></span><span class="main">/</span><span class="free">a</span><span class="main">)</span> <span class="main">(</span><span class="main">-</span><span class="free">Œπ<span class="hidden">‚á©</span><sub>1</sub></span><span class="main">/</span><span class="free">a</span><span class="main">)</span> <span class="main">*</span> <span class="main">(</span><span class="keyword1">ùñΩùóÇùñ∫ùóÄ</span> <span class="bound">i</span><span class="main">.</span> exp <span class="main">(</span><span class="free">t</span> <span class="main">*</span> <span class="main">(</span><span class="keyword1">if</span> <span class="bound">i</span><span class="main">=</span><span class="main">1</span> <span class="keyword1">then</span> <span class="free">Œπ<span class="hidden">‚á©</span><sub>1</sub></span> <span class="keyword1">else</span> <span class="free">Œπ<span class="hidden">‚á©</span><sub>2</sub></span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">*</span> <span class="main">(</span><span class="keyword1">P</span> <span class="main">(</span><span class="main">-</span><span class="free">Œπ<span class="hidden">‚á©</span><sub>2</sub></span><span class="main">/</span><span class="free">a</span><span class="main">)</span> <span class="main">(</span><span class="main">-</span><span class="free">Œπ<span class="hidden">‚á©</span><sub>1</sub></span><span class="main">/</span><span class="free">a</span><span class="main">)</span><span class="main">)</span><span class="main"><span class="hidden">‚áß</span><sup>-</sup><span class="hidden">‚áß</span><sup>1</sup></span> 
  <span class="main">=</span> <span class="main">(</span><span class="main">1</span><span class="main">/</span>sqrt <span class="main">(</span><span class="free">b</span><span class="main"><span class="hidden">‚áß</span><sup>2</sup></span> <span class="main">+</span> <span class="free">a</span> <span class="main">*</span> <span class="numeral">4</span><span class="main">)</span><span class="main">)</span> <span class="keyword1">*<span class="hidden">‚á©</span><sub>R</sub></span> <span class="main">(</span><span class="free">Œ¶</span> <span class="free">t</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">unfolding</span></span> assms <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="main">(</span><span class="operator">subst</span> inv_mtx_chB_hOsc<span class="main">)</span>
  <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="main">(</span><span class="operator">simp_all</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> mtx_times_scaleR_commute<span class="main"><span class="keyword3">,</span></span> <span class="operator">subst</span> sq_mtx_eq_iff<span class="main">)</span>
  <span class="keyword1"><span class="command">unfolding</span></span> UNIV_2 sq_mtx_times_eq sq_mtx_scaleR_eq sq_mtx_uminus_eq <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="main">(</span><span class="operator">simp_all</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> axis_def<span class="main">)</span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> <span class="dynamic"><span class="dynamic">field_simps</span></span><span class="main"><span class="keyword3">,</span></span> <span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> <span class="dynamic"><span class="dynamic">field_power_simps</span></span><span class="main">)</span><span class="main"><span class="keyword3">+</span></span>
 
<span class="keyword1"><span class="command">lemma</span></span> local_flow_mtx_hOsc<span class="main">:</span>
  <span class="keyword2"><span class="keyword">fixes</span></span> <span class="free">a</span> <span class="free">b</span>
  <span class="keyword2"><span class="keyword">defines</span></span> <span class="quoted"><span class="quoted">"<span class="free">Œπ<span class="hidden">‚á©</span><sub>1</sub></span> <span class="main">‚â°</span> <span class="main">(</span><span class="free">b</span> <span class="main">-</span> sqrt <span class="main">(</span><span class="free">b</span><span class="main">^</span><span class="numeral">2</span><span class="main">+</span><span class="numeral">4</span><span class="main">*</span><span class="free">a</span><span class="main">)</span><span class="main">)</span><span class="main">/</span><span class="numeral">2</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">Œπ<span class="hidden">‚á©</span><sub>2</sub></span> <span class="main">‚â°</span> <span class="main">(</span><span class="free">b</span> <span class="main">+</span> sqrt <span class="main">(</span><span class="free">b</span><span class="main">^</span><span class="numeral">2</span><span class="main">+</span><span class="numeral">4</span><span class="main">*</span><span class="free">a</span><span class="main">)</span><span class="main">)</span><span class="main">/</span><span class="numeral">2</span>"</span></span>
  <span class="keyword2"><span class="keyword">defines</span></span> <span class="quoted"><span class="quoted">"<span class="free">Œ¶</span> <span class="free">t</span> <span class="main">‚â°</span> mtx <span class="main">(</span>
   <span class="main">[</span><span class="free">Œπ<span class="hidden">‚á©</span><sub>2</sub></span><span class="main">*</span>exp<span class="main">(</span><span class="free">t</span><span class="main">*</span><span class="free">Œπ<span class="hidden">‚á©</span><sub>1</sub></span><span class="main">)</span> <span class="main">-</span> <span class="free">Œπ<span class="hidden">‚á©</span><sub>1</sub></span><span class="main">*</span>exp<span class="main">(</span><span class="free">t</span><span class="main">*</span><span class="free">Œπ<span class="hidden">‚á©</span><sub>2</sub></span><span class="main">)</span><span class="main">,</span>     exp<span class="main">(</span><span class="free">t</span><span class="main">*</span><span class="free">Œπ<span class="hidden">‚á©</span><sub>2</sub></span><span class="main">)</span><span class="main">-</span>exp<span class="main">(</span><span class="free">t</span><span class="main">*</span><span class="free">Œπ<span class="hidden">‚á©</span><sub>1</sub></span><span class="main">)</span><span class="main">]</span><span class="main">#</span>
   <span class="main">[</span><span class="free">a</span><span class="main">*</span>exp<span class="main">(</span><span class="free">t</span><span class="main">*</span><span class="free">Œπ<span class="hidden">‚á©</span><sub>2</sub></span><span class="main">)</span> <span class="main">-</span> <span class="free">a</span><span class="main">*</span>exp<span class="main">(</span><span class="free">t</span><span class="main">*</span><span class="free">Œπ<span class="hidden">‚á©</span><sub>1</sub></span><span class="main">)</span><span class="main">,</span> <span class="free">Œπ<span class="hidden">‚á©</span><sub>2</sub></span><span class="main">*</span>exp<span class="main">(</span><span class="free">t</span><span class="main">*</span><span class="free">Œπ<span class="hidden">‚á©</span><sub>2</sub></span><span class="main">)</span><span class="main">-</span><span class="free">Œπ<span class="hidden">‚á©</span><sub>1</sub></span><span class="main">*</span>exp<span class="main">(</span><span class="free">t</span><span class="main">*</span><span class="free">Œπ<span class="hidden">‚á©</span><sub>1</sub></span><span class="main">)</span><span class="main">]</span><span class="main">#</span><span class="main">[]</span><span class="main">)</span>"</span></span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">b</span><span class="main"><span class="hidden">‚áß</span><sup>2</sup></span> <span class="main">+</span> <span class="free">a</span> <span class="main">*</span> <span class="numeral">4</span> <span class="main">&gt;</span> <span class="main">0</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span> <span class="main">‚â†</span> <span class="main">0</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"local_flow <span class="main">(</span><span class="keyword1">(*<span class="hidden">‚á©</span><sub>V</sub>)</span> <span class="main">(</span><span class="keyword1">A</span> <span class="free">a</span> <span class="free">b</span><span class="main">)</span><span class="main">)</span> UNIV UNIV <span class="main">(</span><span class="main">Œª</span><span class="bound">t</span><span class="main">.</span> <span class="keyword1">(*<span class="hidden">‚á©</span><sub>V</sub>)</span> <span class="main">(</span><span class="main">(</span><span class="main">1</span><span class="main">/</span>sqrt <span class="main">(</span><span class="free">b</span><span class="main"><span class="hidden">‚áß</span><sup>2</sup></span> <span class="main">+</span> <span class="free">a</span> <span class="main">*</span> <span class="numeral">4</span><span class="main">)</span><span class="main">)</span> <span class="keyword1">*<span class="hidden">‚á©</span><sub>R</sub></span> <span class="free">Œ¶</span> <span class="bound">t</span><span class="main">)</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">unfolding</span></span> assms <span class="keyword1"><span class="command">using</span></span> local_flow_sq_mtx_linear<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="quoted">"<span class="keyword1">A</span> <span class="free">a</span> <span class="free">b</span>"</span></span><span class="main">]</span> assms
  <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="main">(</span><span class="operator">subst</span> <span class="main"><span class="main">(</span></span><span class="quasi_keyword">asm</span><span class="main"><span class="main">)</span></span> exp_scaleR_diagonal2<span class="main"><span class="main">[</span></span><span class="operator">OF</span> invertible_mtx_chB_hOsc mtx_hOsc_diagonalizable<span class="main"><span class="main">]</span></span><span class="main">)</span>
     <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="main">(</span><span class="operator">simp</span><span class="main"><span class="keyword3">,</span></span> <span class="operator">simp</span><span class="main"><span class="keyword3">,</span></span> <span class="operator">simp</span><span class="main">)</span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">subst</span> <span class="main"><span class="main">(</span></span><span class="quasi_keyword">asm</span><span class="main"><span class="main">)</span></span> mtx_hOsc_solution_eq<span class="main">)</span> <span class="operator">simp_all</span>

<span class="keyword1"><span class="command">lemma</span></span> overdamped_door_arith<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">b</span><span class="main"><span class="hidden">‚áß</span><sup>2</sup></span> <span class="main">+</span> <span class="free">a</span> <span class="main">*</span> <span class="numeral">4</span> <span class="main">&gt;</span> <span class="main">0</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span> <span class="main">&lt;</span> <span class="main">0</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">b</span> <span class="main">‚â§</span> <span class="main">0</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">t</span> <span class="main">‚â•</span> <span class="main">0</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">s1</span> <span class="main">&gt;</span> <span class="main">0</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">0</span> <span class="main">‚â§</span> <span class="main">(</span><span class="main">(</span><span class="free">b</span> <span class="main">+</span> sqrt <span class="main">(</span><span class="free">b</span><span class="main"><span class="hidden">‚áß</span><sup>2</sup></span> <span class="main">+</span> <span class="numeral">4</span> <span class="main">*</span> <span class="free">a</span><span class="main">)</span><span class="main">)</span> <span class="main">*</span> exp <span class="main">(</span><span class="free">t</span> <span class="main">*</span> <span class="main">(</span><span class="free">b</span> <span class="main">-</span> sqrt <span class="main">(</span><span class="free">b</span><span class="main"><span class="hidden">‚áß</span><sup>2</sup></span> <span class="main">+</span> <span class="numeral">4</span> <span class="main">*</span> <span class="free">a</span><span class="main">)</span><span class="main">)</span> <span class="main">/</span> <span class="numeral">2</span><span class="main">)</span> <span class="main">/</span> <span class="numeral">2</span> <span class="main">-</span> 
<span class="main">(</span><span class="free">b</span> <span class="main">-</span> sqrt <span class="main">(</span><span class="free">b</span><span class="main"><span class="hidden">‚áß</span><sup>2</sup></span> <span class="main">+</span> <span class="numeral">4</span> <span class="main">*</span> <span class="free">a</span><span class="main">)</span><span class="main">)</span> <span class="main">*</span> exp <span class="main">(</span><span class="free">t</span> <span class="main">*</span> <span class="main">(</span><span class="free">b</span> <span class="main">+</span> sqrt <span class="main">(</span><span class="free">b</span><span class="main"><span class="hidden">‚áß</span><sup>2</sup></span> <span class="main">+</span> <span class="numeral">4</span> <span class="main">*</span> <span class="free">a</span><span class="main">)</span><span class="main">)</span> <span class="main">/</span> <span class="numeral">2</span><span class="main">)</span> <span class="main">/</span> <span class="numeral">2</span><span class="main">)</span> <span class="main">*</span> <span class="free">s1</span> <span class="main">/</span> sqrt <span class="main">(</span><span class="free">b</span><span class="main"><span class="hidden">‚áß</span><sup>2</sup></span> <span class="main">+</span> <span class="free">a</span> <span class="main">*</span> <span class="numeral">4</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span><span class="main">(</span><span class="operator">subst</span> diff_divide_distrib<span class="main"><span class="main">[</span></span><span class="operator">symmetric</span><span class="main"><span class="main">]</span></span><span class="main"><span class="keyword3">,</span></span> <span class="operator">simp</span><span class="main">)</span>
  <span class="keyword1"><span class="command">have</span></span> f0<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">s1</span> <span class="main">/</span> <span class="main">(</span><span class="numeral">2</span> <span class="main">*</span> sqrt <span class="main">(</span><span class="free">b</span><span class="main"><span class="hidden">‚áß</span><sup>2</sup></span> <span class="main">+</span> <span class="free">a</span> <span class="main">*</span> <span class="numeral">4</span><span class="main">)</span><span class="main">)</span> <span class="main">&gt;</span> <span class="main">0</span>"</span></span>  <span class="main">(</span><span class="keyword2"><span class="keyword">is</span></span> <span class="quoted"><span class="quoted">"<span class="free">s1</span><span class="main">/</span><span class="var">?c3</span> <span class="main">&gt;</span> <span class="main">0</span>"</span></span><span class="main">)</span>
    <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>1<span class="main">,</span>5<span class="main">)</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">have</span></span> f1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">b</span> <span class="main">-</span> sqrt <span class="main">(</span><span class="free">b</span><span class="main"><span class="hidden">‚áß</span><sup>2</sup></span> <span class="main">+</span> <span class="numeral">4</span> <span class="main">*</span> <span class="free">a</span><span class="main">)</span><span class="main">)</span> <span class="main">&lt;</span> <span class="main">(</span><span class="free">b</span> <span class="main">+</span> sqrt <span class="main">(</span><span class="free">b</span><span class="main"><span class="hidden">‚áß</span><sup>2</sup></span> <span class="main">+</span> <span class="numeral">4</span> <span class="main">*</span> <span class="free">a</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">is</span></span> <span class="quoted"><span class="quoted">"<span class="var">?c2</span> <span class="main">&lt;</span> <span class="var">?c1</span>"</span></span><span class="main">)</span> 
    <span class="keyword2"><span class="keyword">and</span></span> f2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">b</span> <span class="main">+</span> sqrt <span class="main">(</span><span class="free">b</span><span class="main"><span class="hidden">‚áß</span><sup>2</sup></span> <span class="main">+</span> <span class="numeral">4</span> <span class="main">*</span> <span class="free">a</span><span class="main">)</span><span class="main">)</span> <span class="main">&lt;</span> <span class="main">0</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> sqrt_ge_absD<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="free">b</span></span> <span class="quoted"><span class="quoted">"<span class="free">b</span><span class="main"><span class="hidden">‚áß</span><sup>2</sup></span> <span class="main">+</span> <span class="numeral">4</span> <span class="main">*</span> <span class="free">a</span>"</span></span><span class="main">]</span> assms <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">force</span><span class="main"><span class="keyword3">,</span></span> <span class="operator">linarith</span><span class="main">)</span>
  <span class="keyword1"><span class="command">hence</span></span> f3<span class="main">:</span> <span class="quoted"><span class="quoted">"exp <span class="main">(</span><span class="free">t</span> <span class="main">*</span> <span class="var">?c2</span> <span class="main">/</span> <span class="numeral">2</span><span class="main">)</span> <span class="main">‚â§</span> exp <span class="main">(</span><span class="free">t</span> <span class="main">*</span> <span class="var">?c1</span> <span class="main">/</span> <span class="numeral">2</span><span class="main">)</span>"</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">is</span></span> <span class="quoted"><span class="quoted">"exp <span class="var">?t1</span> <span class="main">‚â§</span> exp <span class="var">?t2</span>"</span></span><span class="main">)</span>
    <span class="keyword1"><span class="command">unfolding</span></span> exp_le_cancel_iff 
    <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>4<span class="main">)</span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">case_tac</span> <span class="quoted"><span class="quoted">"<span class="free">t</span><span class="main">=</span><span class="main">0</span>"</span></span><span class="main"><span class="keyword3">,</span></span> <span class="operator">simp_all</span><span class="main">)</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="var">?c2</span> <span class="main">*</span> exp <span class="var">?t2</span> <span class="main">‚â§</span> <span class="var">?c2</span> <span class="main">*</span> exp <span class="var">?t1</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> f1 f2 mult_le_cancel_left_pos<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="quoted">"<span class="main">-</span><span class="var">?c2</span>"</span></span> <span class="quoted"><span class="quoted">"exp <span class="var">?t1</span>"</span></span> <span class="quoted"><span class="quoted">"exp <span class="var">?t2</span>"</span></span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">linarith</span> 
  <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">&lt;</span> <span class="var">?c1</span> <span class="main">*</span> exp <span class="var">?t1</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> f1 <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span><span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">‚â§</span> <span class="var">?c1</span> <span class="main">*</span> exp <span class="var">?t1</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> f1 f2 <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">0</span> <span class="main">‚â§</span> <span class="main">(</span><span class="var">?c1</span> <span class="main">*</span> exp <span class="var">?t1</span> <span class="main">-</span> <span class="var">?c2</span> <span class="main">*</span> exp <span class="var">?t2</span><span class="main">)</span> <span class="main">*</span> <span class="free">s1</span> <span class="main">/</span> <span class="var">?c3</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> f0 f1 assms<span class="main">(</span>5<span class="main">)</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">abbreviation</span></span> <span class="quoted"><span class="quoted">"<span class="free">open_door</span> <span class="free"><span class="bound"><span class="entity">s</span></span></span> <span class="main">‚â°</span> <span class="main">{</span><span class="bound">s</span><span class="main">.</span> <span class="bound">s</span><span class="main">$</span><span class="main">1</span> <span class="main">&gt;</span> <span class="main">0</span> <span class="main">‚àß</span> <span class="bound">s</span><span class="main">$</span><span class="numeral">2</span> <span class="main">=</span> <span class="main">0</span><span class="main">}</span>"</span></span>

<span class="keyword1"><span class="command">lemma</span></span> overdamped_door<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">b</span><span class="main"><span class="hidden">‚áß</span><sup>2</sup></span> <span class="main">+</span> <span class="free">a</span> <span class="main">*</span> <span class="numeral">4</span> <span class="main">&gt;</span> <span class="main">0</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span> <span class="main">&lt;</span> <span class="main">0</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">b</span> <span class="main">‚â§</span> <span class="main">0</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">PRE</span> <span class="main">(</span><span class="main">Œª</span><span class="bound">s</span><span class="main">.</span> <span class="bound">s</span><span class="main">$</span><span class="main">1</span> <span class="main">=</span> <span class="main">0</span><span class="main">)</span>
  <span class="keyword1">HP</span> <span class="main">(</span><span class="keyword1">LOOP</span> open_door<span class="main">;</span> <span class="main">(</span><span class="keyword1">x¬¥=</span><span class="main">(</span><span class="keyword1">(*<span class="hidden">‚á©</span><sub>V</sub>)</span> <span class="main">(</span><span class="keyword1">A</span> <span class="free">a</span> <span class="free">b</span><span class="main">)</span><span class="main">)</span> <span class="main">&amp;</span> <span class="free">G</span><span class="main">)</span> <span class="keyword1">INV</span> <span class="main">(</span><span class="main">Œª</span><span class="bound">s</span><span class="main">.</span> <span class="main">0</span> <span class="main">‚â§</span> <span class="bound">s</span><span class="main">$</span><span class="main">1</span><span class="main">)</span><span class="main">)</span>
  <span class="keyword1">POST</span> <span class="main">(</span><span class="main">Œª</span><span class="bound">s</span><span class="main">.</span> <span class="main">0</span> <span class="main">‚â§</span> <span class="bound">s</span> <span class="main">$</span> <span class="main">1</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="main">(</span><span class="operator">rule</span> fbox_loopI<span class="main"><span class="keyword3">,</span></span> <span class="operator">simp_all</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> le_fun_def<span class="main">)</span>
  <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="main">(</span><span class="operator">subst</span> local_flow.fbox_g_ode_subset<span class="main"><span class="main">[</span></span><span class="operator">OF</span> local_flow_mtx_hOsc<span class="main"><span class="main">[</span></span><span class="operator">OF</span> assms<span class="main"><span class="main">(</span></span>1<span class="main"><span class="main">)</span></span><span class="main"><span class="main">]</span></span><span class="main"><span class="main">]</span></span><span class="main">)</span>
  <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="main">(</span><span class="operator">simp_all</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> le_fun_def fbox_def<span class="main">)</span>
  <span class="keyword1"><span class="command">unfolding</span></span> sq_mtx_scaleR_eq UNIV_2 sq_mtx_vec_mult_eq
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">clarsimp</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> overdamped_door_arith<span class="main">)</span>


<span class="keyword1"><span class="command">no_notation</span></span> mtx_hOsc <span class="main">(</span><span class="quoted">"<span class="keyword1">A</span>"</span><span class="main">)</span>
        <span class="keyword2"><span class="keyword">and</span></span> mtx_chB_hOsc <span class="main">(</span><span class="quoted">"<span class="keyword1">P</span>"</span><span class="main">)</span>


<span class="keyword1"><span class="command">subsubsection</span></span> <span class="quoted"><span class="plain_text">‚Äπ Flow of non-diagonalisable matrix. ‚Ä∫</span></span>

<span class="keyword1"><span class="command">abbreviation</span></span> <span class="entity">mtx_cnst_acc</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="numeral">3</span> sq_mtx"</span></span> <span class="main">(</span><span class="quoted">"<span class="keyword1">K</span>"</span><span class="main">)</span>
  <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1"><span class="free">K</span></span> <span class="main">‚â°</span> mtx <span class="main">(</span>
  <span class="main">[</span><span class="main">0</span><span class="main">,</span><span class="main">1</span><span class="main">,</span><span class="main">0</span><span class="main">]</span> <span class="main">#</span>
  <span class="main">[</span><span class="main">0</span><span class="main">,</span><span class="main">0</span><span class="main">,</span><span class="main">1</span><span class="main">]</span> <span class="main">#</span> 
  <span class="main">[</span><span class="main">0</span><span class="main">,</span><span class="main">0</span><span class="main">,</span><span class="main">0</span><span class="main">]</span> <span class="main">#</span> <span class="main">[]</span><span class="main">)</span>"</span></span>

<span class="keyword1"><span class="command">lemma</span></span> pow2_scaleR_mtx_cnst_acc<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">t</span> <span class="keyword1">*<span class="hidden">‚á©</span><sub>R</sub></span> <span class="keyword1">K</span><span class="main">)</span><span class="main"><span class="hidden">‚áß</span><sup>2</sup></span> <span class="main">=</span> mtx <span class="main">(</span>
  <span class="main">[</span><span class="main">0</span><span class="main">,</span><span class="main">0</span><span class="main">,</span><span class="free">t</span><span class="main"><span class="hidden">‚áß</span><sup>2</sup></span><span class="main">]</span> <span class="main">#</span>
  <span class="main">[</span><span class="main">0</span><span class="main">,</span><span class="main">0</span><span class="main">,</span><span class="main">0</span><span class="main">]</span> <span class="main">#</span> 
  <span class="main">[</span><span class="main">0</span><span class="main">,</span><span class="main">0</span><span class="main">,</span><span class="main">0</span><span class="main">]</span> <span class="main">#</span> <span class="main">[]</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">unfolding</span></span> power2_eq_square <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="main">(</span><span class="operator">subst</span> sq_mtx_eq_iff<span class="main">)</span>
  <span class="keyword1"><span class="command">unfolding</span></span> sq_mtx_times_eq UNIV_3 <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">lemma</span></span> powN_scaleR_mtx_cnst_acc<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">n</span> <span class="main">&gt;</span> <span class="numeral">2</span> <span class="main">‚üπ</span> <span class="main">(</span><span class="free">t</span> <span class="keyword1">*<span class="hidden">‚á©</span><sub>R</sub></span> <span class="keyword1">K</span><span class="main">)</span><span class="main">^</span><span class="free">n</span> <span class="main">=</span> <span class="main">0</span>"</span></span>
  <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="main">(</span><span class="operator">induct</span> <span class="quoted"><span class="free">n</span></span><span class="main"><span class="keyword3">,</span></span> <span class="operator">simp</span><span class="main"><span class="keyword3">,</span></span> <span class="operator">case_tac</span> <span class="quoted"><span class="quoted">"<span class="improper">n</span> <span class="main">‚â§</span> <span class="numeral">2</span>"</span></span><span class="main">)</span>
   <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="main">(</span><span class="operator">subgoal_tac</span> <span class="quoted"><span class="quoted">"<span class="improper">n</span> <span class="main">=</span> <span class="numeral">2</span>"</span></span><span class="main"><span class="keyword3">,</span></span> <span class="operator">erule</span> ssubst<span class="main">)</span>
  <span class="keyword1"><span class="command">unfolding</span></span> power_Suc2 pow2_scaleR_mtx_cnst_acc sq_mtx_times_eq UNIV_3
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> sq_mtx_eq_iff<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> exp_mtx_cnst_acc<span class="main">:</span> <span class="quoted"><span class="quoted">"exp <span class="main">(</span><span class="free">t</span> <span class="keyword1">*<span class="hidden">‚á©</span><sub>R</sub></span> <span class="keyword1">K</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="main">(</span><span class="free">t</span> <span class="keyword1">*<span class="hidden">‚á©</span><sub>R</sub></span> <span class="keyword1">K</span><span class="main">)</span><span class="main"><span class="hidden">‚áß</span><sup>2</sup></span><span class="keyword1">/<span class="hidden">‚á©</span><sub>R</sub></span> <span class="numeral">2</span><span class="main">)</span> <span class="main">+</span> <span class="main">(</span><span class="free">t</span> <span class="keyword1">*<span class="hidden">‚á©</span><sub>R</sub></span> <span class="keyword1">K</span><span class="main">)</span> <span class="main">+</span> <span class="main">1</span>"</span></span>
  <span class="keyword1"><span class="command">unfolding</span></span> exp_def <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="main">(</span><span class="operator">subst</span> suminf_eq_sum<span class="main"><span class="main">[</span></span><span class="operator">of</span> <span class="quoted"><span class="numeral"><span class="quoted"><span class="numeral">2</span></span></span></span><span class="main"><span class="main">]</span></span><span class="main">)</span>
  <span class="keyword1"><span class="command">using</span></span> powN_scaleR_mtx_cnst_acc <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp_all</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> numeral_2_eq_2<span class="main">)</span>
 
<span class="keyword1"><span class="command">lemma</span></span> exp_mtx_cnst_acc_simps<span class="main">:</span>
  <span class="quoted"><span class="quoted">"exp <span class="main">(</span><span class="free">t</span> <span class="keyword1">*<span class="hidden">‚á©</span><sub>R</sub></span> <span class="keyword1">K</span><span class="main">)</span> <span class="main">$$</span> <span class="main">1</span> <span class="main">$</span> <span class="main">1</span> <span class="main">=</span> <span class="main">1</span>"</span></span> <span class="quoted"><span class="quoted">"exp <span class="main">(</span><span class="free">t</span> <span class="keyword1">*<span class="hidden">‚á©</span><sub>R</sub></span> <span class="keyword1">K</span><span class="main">)</span> <span class="main">$$</span> <span class="main">1</span> <span class="main">$</span> <span class="numeral">2</span> <span class="main">=</span> <span class="free">t</span>"</span></span> <span class="quoted"><span class="quoted">"exp <span class="main">(</span><span class="free">t</span> <span class="keyword1">*<span class="hidden">‚á©</span><sub>R</sub></span> <span class="keyword1">K</span><span class="main">)</span> <span class="main">$$</span> <span class="main">1</span> <span class="main">$</span> <span class="numeral">3</span> <span class="main">=</span> <span class="free">t</span><span class="main">^</span><span class="numeral">2</span><span class="main">/</span><span class="numeral">2</span>"</span></span>
  <span class="quoted"><span class="quoted">"exp <span class="main">(</span><span class="free">t</span> <span class="keyword1">*<span class="hidden">‚á©</span><sub>R</sub></span> <span class="keyword1">K</span><span class="main">)</span> <span class="main">$$</span> <span class="numeral">2</span> <span class="main">$</span> <span class="main">1</span> <span class="main">=</span> <span class="main">0</span>"</span></span> <span class="quoted"><span class="quoted">"exp <span class="main">(</span><span class="free">t</span> <span class="keyword1">*<span class="hidden">‚á©</span><sub>R</sub></span> <span class="keyword1">K</span><span class="main">)</span> <span class="main">$$</span> <span class="numeral">2</span> <span class="main">$</span> <span class="numeral">2</span> <span class="main">=</span> <span class="main">1</span>"</span></span> <span class="quoted"><span class="quoted">"exp <span class="main">(</span><span class="free">t</span> <span class="keyword1">*<span class="hidden">‚á©</span><sub>R</sub></span> <span class="keyword1">K</span><span class="main">)</span> <span class="main">$$</span> <span class="numeral">2</span> <span class="main">$</span> <span class="numeral">3</span> <span class="main">=</span> <span class="free">t</span>"</span></span>
  <span class="quoted"><span class="quoted">"exp <span class="main">(</span><span class="free">t</span> <span class="keyword1">*<span class="hidden">‚á©</span><sub>R</sub></span> <span class="keyword1">K</span><span class="main">)</span> <span class="main">$$</span> <span class="numeral">3</span> <span class="main">$</span> <span class="main">1</span> <span class="main">=</span> <span class="main">0</span>"</span></span> <span class="quoted"><span class="quoted">"exp <span class="main">(</span><span class="free">t</span> <span class="keyword1">*<span class="hidden">‚á©</span><sub>R</sub></span> <span class="keyword1">K</span><span class="main">)</span> <span class="main">$$</span> <span class="numeral">3</span> <span class="main">$</span> <span class="numeral">2</span> <span class="main">=</span> <span class="main">0</span>"</span></span> <span class="quoted"><span class="quoted">"exp <span class="main">(</span><span class="free">t</span> <span class="keyword1">*<span class="hidden">‚á©</span><sub>R</sub></span> <span class="keyword1">K</span><span class="main">)</span> <span class="main">$$</span> <span class="numeral">3</span> <span class="main">$</span> <span class="numeral">3</span> <span class="main">=</span> <span class="main">1</span>"</span></span>
  <span class="keyword1"><span class="command">unfolding</span></span> exp_mtx_cnst_acc one_mtx3 pow2_scaleR_mtx_cnst_acc <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp_all</span>

<span class="keyword1"><span class="command">lemma</span></span> exp_mtx_cnst_acc_vec_mult_eq<span class="main">:</span> <span class="quoted"><span class="quoted">"exp <span class="main">(</span><span class="free">t</span> <span class="keyword1">*<span class="hidden">‚á©</span><sub>R</sub></span> <span class="keyword1">K</span><span class="main">)</span> <span class="keyword1">*<span class="hidden">‚á©</span><sub>V</sub></span> <span class="free">s</span> <span class="main">=</span> 
  vector <span class="main">[</span><span class="free">s</span><span class="main">$</span><span class="numeral">3</span> <span class="main">*</span> <span class="free">t</span><span class="main">^</span><span class="numeral">2</span><span class="main">/</span><span class="numeral">2</span> <span class="main">+</span> <span class="free">s</span><span class="main">$</span><span class="numeral">2</span> <span class="main">*</span> <span class="free">t</span> <span class="main">+</span> <span class="free">s</span><span class="main">$</span><span class="main">1</span><span class="main">,</span> <span class="free">s</span><span class="main">$</span><span class="numeral">3</span> <span class="main">*</span> <span class="free">t</span> <span class="main">+</span> <span class="free">s</span><span class="main">$</span><span class="numeral">2</span><span class="main">,</span> <span class="free">s</span><span class="main">$</span><span class="numeral">3</span><span class="main">]</span>"</span></span>
  <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="main">(</span><span class="operator">subst</span> exp_mtx_cnst_acc<span class="main"><span class="keyword3">,</span></span> <span class="operator">subst</span> pow2_scaleR_mtx_cnst_acc<span class="main">)</span>
  <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> sq_mtx_vec_mult_eq vector_def<span class="main">)</span>
  <span class="keyword1"><span class="command">unfolding</span></span> UNIV_3 <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> fun_eq_iff<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> local_flow_mtx_cnst_acc<span class="main">:</span>
  <span class="quoted"><span class="quoted">"local_flow <span class="main">(</span><span class="keyword1">(*<span class="hidden">‚á©</span><sub>V</sub>)</span> <span class="keyword1">K</span><span class="main">)</span> UNIV UNIV <span class="main">(</span><span class="main">Œª</span><span class="bound">t</span> <span class="bound">s</span><span class="main">.</span> <span class="main">(</span><span class="main">(</span><span class="bound">t</span> <span class="keyword1">*<span class="hidden">‚á©</span><sub>R</sub></span> <span class="keyword1">K</span><span class="main">)</span><span class="main"><span class="hidden">‚áß</span><sup>2</sup></span><span class="keyword1">/<span class="hidden">‚á©</span><sub>R</sub></span> <span class="numeral">2</span> <span class="main">+</span> <span class="main">(</span><span class="bound">t</span> <span class="keyword1">*<span class="hidden">‚á©</span><sub>R</sub></span> <span class="keyword1">K</span><span class="main">)</span> <span class="main">+</span> <span class="main">1</span><span class="main">)</span> <span class="keyword1">*<span class="hidden">‚á©</span><sub>V</sub></span> <span class="bound">s</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> local_flow_sq_mtx_linear<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="keyword1">K</span></span><span class="main">]</span> <span class="keyword1"><span class="command">unfolding</span></span> exp_mtx_cnst_acc <span class="keyword1"><span class="command">.</span></span>  

<span class="keyword1"><span class="command">lemma</span></span> docking_station_arith<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">d</span><span class="main">::</span>real<span class="main">)</span> <span class="main">&gt;</span> <span class="free">x</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">v</span> <span class="main">&gt;</span> <span class="main">0</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">v</span> <span class="main">=</span> <span class="free">v</span><span class="main"><span class="hidden">‚áß</span><sup>2</sup></span> <span class="main">*</span> <span class="free">t</span> <span class="main">/</span> <span class="main">(</span><span class="numeral">2</span> <span class="main">*</span> <span class="free">d</span> <span class="main">-</span> <span class="numeral">2</span> <span class="main">*</span> <span class="free">x</span><span class="main">)</span><span class="main">)</span> <span class="main">‚ü∑</span> <span class="main">(</span><span class="free">v</span> <span class="main">*</span> <span class="free">t</span> <span class="main">-</span> <span class="free">v</span><span class="main"><span class="hidden">‚áß</span><sup>2</sup></span> <span class="main">*</span> <span class="free">t</span><span class="main"><span class="hidden">‚áß</span><sup>2</sup></span> <span class="main">/</span> <span class="main">(</span><span class="numeral">4</span> <span class="main">*</span> <span class="free">d</span> <span class="main">-</span> <span class="numeral">4</span> <span class="main">*</span> <span class="free">x</span><span class="main">)</span> <span class="main">+</span> <span class="free">x</span> <span class="main">=</span> <span class="free">d</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span>
  <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="free">v</span> <span class="main">=</span> <span class="free">v</span><span class="main"><span class="hidden">‚áß</span><sup>2</sup></span> <span class="main">*</span> <span class="free">t</span> <span class="main">/</span> <span class="main">(</span><span class="numeral">2</span> <span class="main">*</span> <span class="free">d</span> <span class="main">-</span> <span class="numeral">2</span> <span class="main">*</span> <span class="free">x</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="free">v</span> <span class="main">*</span> <span class="free">t</span> <span class="main">=</span> <span class="numeral">2</span> <span class="main">*</span> <span class="main">(</span><span class="free">d</span> <span class="main">-</span> <span class="free">x</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> eq_divide_eq power2_eq_square<span class="main">)</span> 
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="free">v</span> <span class="main">*</span> <span class="free">t</span> <span class="main">-</span> <span class="free">v</span><span class="main"><span class="hidden">‚áß</span><sup>2</sup></span> <span class="main">*</span> <span class="free">t</span><span class="main"><span class="hidden">‚áß</span><sup>2</sup></span> <span class="main">/</span> <span class="main">(</span><span class="numeral">4</span> <span class="main">*</span> <span class="free">d</span> <span class="main">-</span> <span class="numeral">4</span> <span class="main">*</span> <span class="free">x</span><span class="main">)</span> <span class="main">+</span> <span class="free">x</span> <span class="main">=</span> <span class="numeral">2</span> <span class="main">*</span> <span class="main">(</span><span class="free">d</span> <span class="main">-</span> <span class="free">x</span><span class="main">)</span> <span class="main">-</span> <span class="numeral">4</span> <span class="main">*</span> <span class="main">(</span><span class="free">d</span> <span class="main">-</span> <span class="free">x</span><span class="main">)</span><span class="main"><span class="hidden">‚áß</span><sup>2</sup></span> <span class="main">/</span> <span class="main">(</span><span class="numeral">4</span> <span class="main">*</span> <span class="main">(</span><span class="free">d</span> <span class="main">-</span> <span class="free">x</span><span class="main">)</span><span class="main">)</span> <span class="main">+</span> <span class="free">x</span>"</span></span>
    <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="main">(</span><span class="operator">subst</span> power_mult_distrib<span class="main"><span class="main">[</span></span><span class="operator">symmetric</span><span class="main"><span class="main">]</span></span><span class="main">)</span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">erule</span> ssubst<span class="main"><span class="keyword3">,</span></span> <span class="operator">subst</span> power_mult_distrib<span class="main"><span class="keyword3">,</span></span> <span class="operator">simp</span><span class="main">)</span>
  <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> <span class="free">d</span>"</span></span>
    <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">only</span><span class="main"><span class="main">:</span></span> mult_divide_mult_cancel_left_if<span class="main">)</span>
    <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> power2_eq_square<span class="main">)</span>
  <span class="keyword1"><span class="command">finally</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="free">v</span> <span class="main">*</span> <span class="free">t</span> <span class="main">-</span> <span class="free">v</span><span class="main"><span class="hidden">‚áß</span><sup>2</sup></span> <span class="main">*</span> <span class="free">t</span><span class="main"><span class="hidden">‚áß</span><sup>2</sup></span> <span class="main">/</span> <span class="main">(</span><span class="numeral">4</span> <span class="main">*</span> <span class="free">d</span> <span class="main">-</span> <span class="numeral">4</span> <span class="main">*</span> <span class="free">x</span><span class="main">)</span> <span class="main">+</span> <span class="free">x</span> <span class="main">=</span> <span class="free">d</span>"</span></span> <span class="keyword1"><span class="command">.</span></span>
<span class="keyword1"><span class="command">next</span></span>
  <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="free">v</span> <span class="main">*</span> <span class="free">t</span> <span class="main">-</span> <span class="free">v</span><span class="main"><span class="hidden">‚áß</span><sup>2</sup></span> <span class="main">*</span> <span class="free">t</span><span class="main"><span class="hidden">‚áß</span><sup>2</sup></span> <span class="main">/</span> <span class="main">(</span><span class="numeral">4</span> <span class="main">*</span> <span class="free">d</span> <span class="main">-</span> <span class="numeral">4</span> <span class="main">*</span> <span class="free">x</span><span class="main">)</span> <span class="main">+</span> <span class="free">x</span> <span class="main">=</span> <span class="free">d</span>"</span></span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="main">0</span> <span class="main">=</span> <span class="free">v</span><span class="main"><span class="hidden">‚áß</span><sup>2</sup></span> <span class="main">*</span> <span class="free">t</span><span class="main"><span class="hidden">‚áß</span><sup>2</sup></span> <span class="main">/</span> <span class="main">(</span><span class="numeral">4</span> <span class="main">*</span> <span class="main">(</span><span class="free">d</span> <span class="main">-</span> <span class="free">x</span><span class="main">)</span><span class="main">)</span> <span class="main">+</span> <span class="main">(</span><span class="free">d</span> <span class="main">-</span> <span class="free">x</span><span class="main">)</span> <span class="main">-</span> <span class="free">v</span> <span class="main">*</span> <span class="free">t</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="main">0</span> <span class="main">=</span> <span class="main">(</span><span class="numeral">4</span> <span class="main">*</span> <span class="main">(</span><span class="free">d</span> <span class="main">-</span> <span class="free">x</span><span class="main">)</span><span class="main">)</span> <span class="main">*</span> <span class="main">(</span><span class="free">v</span><span class="main"><span class="hidden">‚áß</span><sup>2</sup></span> <span class="main">*</span> <span class="free">t</span><span class="main"><span class="hidden">‚áß</span><sup>2</sup></span> <span class="main">/</span> <span class="main">(</span><span class="numeral">4</span> <span class="main">*</span> <span class="main">(</span><span class="free">d</span> <span class="main">-</span> <span class="free">x</span><span class="main">)</span><span class="main">)</span> <span class="main">+</span> <span class="main">(</span><span class="free">d</span> <span class="main">-</span> <span class="free">x</span><span class="main">)</span> <span class="main">-</span> <span class="free">v</span> <span class="main">*</span> <span class="free">t</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> <span class="free">v</span><span class="main"><span class="hidden">‚áß</span><sup>2</sup></span> <span class="main">*</span> <span class="free">t</span><span class="main"><span class="hidden">‚áß</span><sup>2</sup></span> <span class="main">+</span> <span class="numeral">4</span> <span class="main">*</span> <span class="main">(</span><span class="free">d</span> <span class="main">-</span> <span class="free">x</span><span class="main">)</span><span class="main"><span class="hidden">‚áß</span><sup>2</sup></span>  <span class="main">-</span> <span class="main">(</span><span class="numeral">4</span> <span class="main">*</span> <span class="main">(</span><span class="free">d</span> <span class="main">-</span> <span class="free">x</span><span class="main">)</span><span class="main">)</span> <span class="main">*</span> <span class="main">(</span><span class="free">v</span> <span class="main">*</span> <span class="free">t</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> distrib_left right_diff_distrib<span class="main">)</span>
    <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="main">(</span><span class="operator">subst</span> right_diff_distrib<span class="main"><span class="main">[</span></span><span class="operator">symmetric</span><span class="main"><span class="main">]</span></span><span class="main">)</span><span class="main"><span class="keyword3">+</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> power2_eq_square<span class="main">)</span>
  <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> <span class="main">(</span><span class="free">v</span> <span class="main">*</span> <span class="free">t</span> <span class="main">-</span> <span class="numeral">2</span> <span class="main">*</span> <span class="main">(</span><span class="free">d</span> <span class="main">-</span> <span class="free">x</span><span class="main">)</span><span class="main">)</span><span class="main"><span class="hidden">‚áß</span><sup>2</sup></span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">only</span><span class="main"><span class="main">:</span></span> power2_diff<span class="main"><span class="keyword3">,</span></span> <span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> <span class="dynamic"><span class="dynamic">field_simps</span></span> power2_diff<span class="main">)</span>
  <span class="keyword1"><span class="command">finally</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">0</span> <span class="main">=</span> <span class="main">(</span><span class="free">v</span> <span class="main">*</span> <span class="free">t</span> <span class="main">-</span> <span class="numeral">2</span> <span class="main">*</span> <span class="main">(</span><span class="free">d</span> <span class="main">-</span> <span class="free">x</span><span class="main">)</span><span class="main">)</span><span class="main"><span class="hidden">‚áß</span><sup>2</sup></span>"</span></span> <span class="keyword1"><span class="command">.</span></span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="free">v</span> <span class="main">*</span> <span class="free">t</span> <span class="main">=</span> <span class="numeral">2</span> <span class="main">*</span> <span class="main">(</span><span class="free">d</span> <span class="main">-</span> <span class="free">x</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"<span class="free">v</span> <span class="main">=</span> <span class="free">v</span><span class="main"><span class="hidden">‚áß</span><sup>2</sup></span> <span class="main">*</span> <span class="free">t</span> <span class="main">/</span> <span class="main">(</span><span class="numeral">2</span> <span class="main">*</span> <span class="free">d</span> <span class="main">-</span> <span class="numeral">2</span> <span class="main">*</span> <span class="free">x</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="main">(</span><span class="operator">subst</span> power2_eq_square<span class="main"><span class="keyword3">,</span></span> <span class="operator">subst</span> mult.assoc<span class="main">)</span>
    <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="main">(</span><span class="operator">erule</span> ssubst<span class="main"><span class="keyword3">,</span></span> <span class="operator">subst</span> right_diff_distrib<span class="main"><span class="main">[</span></span><span class="operator">symmetric</span><span class="main"><span class="main">]</span></span><span class="main">)</span>
    <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">lemma</span></span> docking_station<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">d</span> <span class="main">&gt;</span> <span class="free">x<span class="hidden">‚á©</span><sub>0</sub></span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">v<span class="hidden">‚á©</span><sub>0</sub></span> <span class="main">&gt;</span> <span class="main">0</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">PRE</span> <span class="main">(</span><span class="main">Œª</span><span class="bound">s</span><span class="main">.</span> <span class="bound">s</span><span class="main">$</span><span class="main">1</span> <span class="main">=</span> <span class="free">x<span class="hidden">‚á©</span><sub>0</sub></span> <span class="main">‚àß</span> <span class="bound">s</span><span class="main">$</span><span class="numeral">2</span> <span class="main">=</span> <span class="free">v<span class="hidden">‚á©</span><sub>0</sub></span><span class="main">)</span>
  <span class="keyword1">HP</span> <span class="main">(</span><span class="main">(</span><span class="numeral">3</span> <span class="main">::=</span> <span class="main">(</span><span class="main">Œª</span><span class="bound">s</span><span class="main">.</span> <span class="main">-</span><span class="main">(</span><span class="free">v<span class="hidden">‚á©</span><sub>0</sub></span><span class="main">^</span><span class="numeral">2</span><span class="main">/</span><span class="main">(</span><span class="numeral">2</span><span class="main">*</span><span class="main">(</span><span class="free">d</span><span class="main">-</span><span class="free">x<span class="hidden">‚á©</span><sub>0</sub></span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">;</span> <span class="keyword1">x¬¥=</span><span class="keyword1">(*<span class="hidden">‚á©</span><sub>V</sub>)</span> <span class="keyword1">K</span> <span class="main">&amp;</span> <span class="free">G</span><span class="main">)</span>
  <span class="keyword1">POST</span> <span class="main">(</span><span class="main">Œª</span><span class="bound">s</span><span class="main">.</span> <span class="bound">s</span><span class="main">$</span><span class="numeral">2</span> <span class="main">=</span> <span class="main">0</span> <span class="main">‚ü∑</span> <span class="bound">s</span><span class="main">$</span><span class="main">1</span> <span class="main">=</span> <span class="free">d</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="main">(</span><span class="operator">clarsimp</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> le_fun_def local_flow.fbox_g_ode_subset<span class="main"><span class="main">[</span></span><span class="operator">OF</span> local_flow_sq_mtx_linear<span class="main"><span class="main"><span class="main">[</span></span></span><span class="operator">of</span> <span class="quoted"><span class="keyword1">K</span></span><span class="main"><span class="main"><span class="main">]</span></span></span><span class="main"><span class="main">]</span></span><span class="main">)</span>
  <span class="keyword1"><span class="command">unfolding</span></span> exp_mtx_cnst_acc_vec_mult_eq <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> docking_station_arith<span class="main">)</span>

<span class="keyword1"><span class="command">no_notation</span></span> mtx_cnst_acc <span class="main">(</span><span class="quoted">"<span class="keyword1">K</span>"</span><span class="main">)</span>

<span class="keyword2"><span class="keyword">end</span></span></pre>
</div>
<div id="Set_Theory">
<div class="head"><h1>Theory Set_Theory</h1>
<span class="command">theory</span> <span class="name">Set_Theory</span><br/>
<span class="keyword">imports</span> <a href="FuncSet.html"><span class="name">FuncSet</span></a><br/>
</div>
<div class="source">
<pre class="source"><span class="comment"><span class="delete"><span class="delete"><span class="delete"><span class="delete">(*
  Copyright (c) 2014-2019 by Clemens Ballarin
  This file is licensed under the 3-clause BSD license.
*)</span></span></span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">theory</span></span><span> </span><span>Set_Theory</span><span> </span><span class="keyword2"><span class="keyword">imports</span></span><span> </span><span class="string"><span class="delete"><span class="delete">"HOL-Library.FuncSet"</span></span></span><span> </span><span class="keyword2"><span class="keyword">begin</span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">hide_const</span></span><span> </span><span>map</span><span>
</span><span class="keyword1"><span class="command">hide_const</span></span><span> </span><span>partition</span><span>
</span><span>
</span><span class="keyword1"><span class="command">no_notation</span></span><span> </span><span>divide</span><span> </span><span class="delimiter">(</span><span class="keyword2"><span class="keyword">infixl</span></span><span> </span><span class="string"><span class="delete"><span class="delete">"'/"</span></span></span><span> </span><span>70</span><span class="delimiter">)</span><span>
</span><span class="keyword1"><span class="command">no_notation</span></span><span> </span><span>inverse_divide</span><span> </span><span class="delimiter">(</span><span class="keyword2"><span class="keyword">infixl</span></span><span> </span><span class="string"><span class="delete"><span class="delete">"'/"</span></span></span><span> </span><span>70</span><span class="delimiter">)</span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹
  Each statement in the formal text is annotated with the location of the originating statement
  in Jacobson's text @{cite Jacobson1985}.  Each fact that Jacobson states explicitly is marked
  as @{command theorem} unless it is translated to a @{command sublocale} declaration.
  Literal quotations from Jacobson's text are reproduced in double quotes.

  Auxiliary results needed for the formalisation that cannot be found in Jacobson's text are marked
  as @{command lemma} or are @{command interpretation}s.  Such results are annotated with the
  location of a related statement.  For example, the introduction rule of a constant is annotated
  with the location of the definition of the corresponding operation.
›</span></span></span><span>
</span><span>
</span><span>
</span><span class="keyword1"><span class="command">section</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹Concepts from Set Theory.  The Integers›</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">subsection</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹The Cartesian Product Set.  Maps›</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹Maps as extensional HOL functions›</span></span></span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹p 5, ll 21--25›</span></span></span><span>
</span><span class="keyword1"><span class="command">locale</span></span><span> </span><span>map</span><span> </span><span class="delimiter">=</span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">fixes</span></span><span> </span><span>α</span><span> </span><span class="keyword2"><span class="keyword">and</span></span><span> </span><span>S</span><span> </span><span class="keyword2"><span class="keyword">and</span></span><span> </span><span>T</span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">assumes</span></span><span> </span><span>graph</span><span> </span><span class="delimiter">[</span><span>intro</span><span class="delimiter">,</span><span> </span><span>simp</span><span class="delimiter">]</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">"α ∈ S →<span class="hidden">⇩</span><sub>E</sub> T"</span></span></span><span>
</span><span class="keyword2"><span class="keyword">begin</span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹p 5, ll 21--25›</span></span></span><span>
</span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>map_closed</span><span> </span><span class="delimiter">[</span><span>intro</span><span class="delimiter">,</span><span> </span><span>simp</span><span class="delimiter">]</span><span class="delimiter">:</span><span>
</span><span>  </span><span class="string"><span class="delete"><span class="delete">"a ∈ S ⟹ α a ∈ T"</span></span></span><span>
</span><span class="keyword1"><span class="command">using</span></span><span> </span><span>graph</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>fast</span><span>
</span><span>  
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹p 5, ll 21--25›</span></span></span><span>
</span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>map_undefined</span><span> </span><span class="delimiter">[</span><span>intro</span><span class="delimiter">,</span><span> </span><span>simp</span><span class="delimiter">]</span><span class="delimiter">:</span><span>
</span><span>  </span><span class="string"><span class="delete"><span class="delete">"a ∉ S ⟹ α a = undefined"</span></span></span><span>
</span><span class="keyword1"><span class="command">using</span></span><span> </span><span>graph</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>fast</span><span>
</span><span>
</span><span class="keyword2"><span class="keyword">end</span></span><span> </span><span class="comment"><span class="delete"><span class="delete"><span class="delete"><span class="delete">(* map *)</span></span></span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹p 7, ll 7--8›</span></span></span><span>
</span><span class="keyword1"><span class="command">locale</span></span><span> </span><span>surjective_map</span><span> </span><span class="delimiter">=</span><span> </span><span>map</span><span> </span><span class="delimiter">+</span><span> </span><span class="keyword2"><span class="keyword">assumes</span></span><span> </span><span>surjective</span><span> </span><span class="delimiter">[</span><span>intro</span><span class="delimiter">]</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">"α ` S = T"</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹p 7, ll 8--9›</span></span></span><span>
</span><span class="keyword1"><span class="command">locale</span></span><span> </span><span>injective_map</span><span> </span><span class="delimiter">=</span><span> </span><span>map</span><span> </span><span class="delimiter">+</span><span> </span><span class="keyword2"><span class="keyword">assumes</span></span><span> </span><span>injective</span><span> </span><span class="delimiter">[</span><span>intro</span><span class="delimiter">,</span><span> </span><span>simp</span><span class="delimiter">]</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">"inj_on α S"</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹Enables locale reasoning about the inverse @{term "restrict (inv_into S α) T"} of @{term α}.›</span></span></span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹p 7, ll 9--10›</span></span></span><span>
</span><span class="keyword1"><span class="command">locale</span></span><span> </span><span>bijective</span><span> </span><span class="delimiter">=</span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">fixes</span></span><span> </span><span>α</span><span> </span><span class="keyword2"><span class="keyword">and</span></span><span> </span><span>S</span><span> </span><span class="keyword2"><span class="keyword">and</span></span><span> </span><span>T</span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">assumes</span></span><span> </span><span>bijective</span><span> </span><span class="delimiter">[</span><span>intro</span><span class="delimiter">,</span><span> </span><span>simp</span><span class="delimiter">]</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">"bij_betw α S T"</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹
  Exploit existing knowledge about @{term bij_betw} rather than extending @{locale surjective_map}
  and @{locale injective_map}.
›</span></span></span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹p 7, ll 9--10›</span></span></span><span>
</span><span class="keyword1"><span class="command">locale</span></span><span> </span><span>bijective_map</span><span> </span><span class="delimiter">=</span><span> </span><span>map</span><span> </span><span class="delimiter">+</span><span> </span><span>bijective</span><span> </span><span class="keyword2"><span class="keyword">begin</span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹p 7, ll 9--10›</span></span></span><span>
</span><span class="keyword1"><span class="command">sublocale</span></span><span> </span><span>surjective_map</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>unfold_locales</span><span> </span><span class="delimiter">(</span><span>simp</span><span> </span><span>add</span><span class="delimiter">:</span><span> </span><span>bij_betw_imp_surj_on</span><span class="delimiter">)</span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹p 7, ll 9--10›</span></span></span><span>
</span><span class="keyword1"><span class="command">sublocale</span></span><span> </span><span>injective_map</span><span> </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>bij_betw_def</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>unfold_locales</span><span> </span><span>fast</span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹p 9, ll 12--13›</span></span></span><span>
</span><span class="keyword1"><span class="command">sublocale</span></span><span> </span><span>inverse</span><span class="delimiter">:</span><span> </span><span>map</span><span> </span><span class="string"><span class="delete"><span class="delete">"restrict (inv_into S α) T"</span></span></span><span> </span><span>T</span><span> </span><span>S</span><span>
</span><span>  </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>unfold_locales</span><span> </span><span class="delimiter">(</span><span>simp</span><span> </span><span>add</span><span class="delimiter">:</span><span> </span><span>inv_into_into</span><span> </span><span>surjective</span><span class="delimiter">)</span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹p 9, ll 12--13›</span></span></span><span>
</span><span class="keyword1"><span class="command">sublocale</span></span><span> </span><span>inverse</span><span class="delimiter">:</span><span> </span><span>bijective</span><span> </span><span class="string"><span class="delete"><span class="delete">"restrict (inv_into S α) T"</span></span></span><span> </span><span>T</span><span> </span><span>S</span><span>
</span><span>  </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>unfold_locales</span><span> </span><span class="delimiter">(</span><span>simp</span><span> </span><span>add</span><span class="delimiter">:</span><span> </span><span>bij_betw_inv_into</span><span> </span><span>surjective</span><span class="delimiter">)</span><span>
</span><span>
</span><span class="keyword2"><span class="keyword">end</span></span><span> </span><span class="comment"><span class="delete"><span class="delete"><span class="delete"><span class="delete">(* bijective_map *)</span></span></span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹p 8, ll 14--15›</span></span></span><span>
</span><span class="keyword1"><span class="command">abbreviation</span></span><span> </span><span class="string"><span class="delete"><span class="delete">"identity S ≡ (λx ∈ S. x)"</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">context</span></span><span> </span><span>map</span><span> </span><span class="keyword2"><span class="keyword">begin</span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹p 8, ll 18--20; p 9, ll 1--8›</span></span></span><span>
</span><span class="keyword1"><span class="command">theorem</span></span><span> </span><span>bij_betw_iff_has_inverse</span><span class="delimiter">:</span><span>
</span><span>  </span><span class="string"><span class="delete"><span class="delete">"bij_betw α S T ⟷ (∃β ∈ T →<span class="hidden">⇩</span><sub>E</sub> S. compose S β α = identity S ∧ compose T α β = identity T)"</span></span></span><span>
</span><span>    </span><span class="delimiter">(</span><span class="keyword2"><span class="keyword">is</span></span><span> </span><span class="string"><span class="delete"><span class="delete">"_ ⟷ (∃β ∈ T →<span class="hidden">⇩</span><sub>E</sub> S. ?INV β)"</span></span></span><span class="delimiter">)</span><span>
</span><span class="keyword1"><span class="command">proof</span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">let</span></span><span> </span><span class="var">?inv</span><span> </span><span class="delimiter">=</span><span> </span><span class="string"><span class="delete"><span class="delete">"restrict (inv_into S α) T"</span></span></span><span>
</span><span>  </span><span class="keyword3"><span class="command">assume</span></span><span> </span><span class="string"><span class="delete"><span class="delete">"bij_betw α S T"</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">then</span></span><span> </span><span class="keyword1"><span class="command">have</span></span><span> </span><span class="string"><span class="delete"><span class="delete">"?INV ?inv"</span></span></span><span> </span><span class="keyword2"><span class="keyword">and</span></span><span> </span><span class="string"><span class="delete"><span class="delete">"?inv ∈ T →<span class="hidden">⇩</span><sub>E</sub> S"</span></span></span><span>
</span><span>    </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>simp_all</span><span> </span><span>add</span><span class="delimiter">:</span><span> </span><span>compose_inv_into_id</span><span> </span><span>bij_betw_imp_surj_on</span><span> </span><span>compose_id_inv_into</span><span> </span><span>bij_betw_imp_funcset</span><span> </span><span>bij_betw_inv_into</span><span class="delimiter">)</span><span>
</span><span>  </span><span class="keyword1"><span class="command">then</span></span><span> </span><span class="keyword3"><span class="command">show</span></span><span> </span><span class="string"><span class="delete"><span class="delete">"∃β ∈ T →<span class="hidden">⇩</span><sub>E</sub> S. ?INV β"</span></span></span><span> </span><span class="keyword1"><span class="command">..</span></span><span>
</span><span class="keyword1"><span class="command">next</span></span><span>
</span><span>  </span><span class="keyword3"><span class="command">assume</span></span><span> </span><span class="string"><span class="delete"><span class="delete">"∃β ∈ T →<span class="hidden">⇩</span><sub>E</sub> S. ?INV β"</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">then</span></span><span> </span><span class="keyword3"><span class="command">obtain</span></span><span> </span><span>β</span><span> </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">"α ∈ S → T"</span></span></span><span> </span><span class="string"><span class="delete"><span class="delete">"β ∈ T → S"</span></span></span><span> </span><span class="string"><span class="delete"><span class="delete">"⋀x. x ∈ S ⟹ β (α x) = x"</span></span></span><span> </span><span class="string"><span class="delete"><span class="delete">"⋀y. y ∈ T ⟹ α (β y) = y"</span></span></span><span>
</span><span>    </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>metis</span><span> </span><span>PiE_restrict</span><span> </span><span>compose_eq</span><span> </span><span>graph</span><span> </span><span>restrict_PiE</span><span> </span><span>restrict_apply</span><span class="delimiter">)</span><span>
</span><span>  </span><span class="keyword1"><span class="command">then</span></span><span> </span><span class="keyword3"><span class="command">show</span></span><span> </span><span class="string"><span class="delete"><span class="delete">"bij_betw α S T"</span></span></span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>rule</span><span> </span><span>bij_betwI</span><span class="delimiter">)</span><span> 
</span><span class="keyword1"><span class="command">qed</span></span><span>
</span><span>
</span><span class="keyword2"><span class="keyword">end</span></span><span> </span><span class="comment"><span class="delete"><span class="delete"><span class="delete"><span class="delete">(* map *)</span></span></span></span></span><span>
</span><span>
</span><span>
</span><span class="keyword1"><span class="command">subsection</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹Equivalence Relations.  Factoring a Map Through an Equivalence Relation›</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹p 11, ll 6--11›</span></span></span><span>
</span><span class="keyword1"><span class="command">locale</span></span><span> </span><span>equivalence</span><span> </span><span class="delimiter">=</span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">fixes</span></span><span> </span><span>S</span><span> </span><span class="keyword2"><span class="keyword">and</span></span><span> </span><span>E</span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">assumes</span></span><span> </span><span>closed</span><span> </span><span class="delimiter">[</span><span>intro</span><span class="delimiter">,</span><span> </span><span>simp</span><span class="delimiter">]</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">"E ⊆ S × S"</span></span></span><span>
</span><span>    </span><span class="keyword2"><span class="keyword">and</span></span><span> </span><span>reflexive</span><span> </span><span class="delimiter">[</span><span>intro</span><span class="delimiter">,</span><span> </span><span>simp</span><span class="delimiter">]</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">"a ∈ S ⟹ (a, a) ∈ E"</span></span></span><span>
</span><span>    </span><span class="keyword2"><span class="keyword">and</span></span><span> </span><span>symmetric</span><span> </span><span class="delimiter">[</span><span>sym</span><span class="delimiter">]</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">"(a, b) ∈ E ⟹ (b, a) ∈ E"</span></span></span><span>
</span><span>    </span><span class="keyword2"><span class="keyword">and</span></span><span> </span><span>transitive</span><span> </span><span class="delimiter">[</span><span>trans</span><span class="delimiter">]</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">"⟦ (a, b) ∈ E; (b, c) ∈ E ⟧ ⟹ (a, c) ∈ E"</span></span></span><span>
</span><span class="keyword2"><span class="keyword">begin</span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹p 11, ll 6--11›</span></span></span><span>
</span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>left_closed</span><span> </span><span class="delimiter">[</span><span>intro</span><span class="delimiter">]</span><span class="delimiter">:</span><span> </span><span class="comment"><span class="delete"><span class="delete"><span class="delete"><span class="delete">(* inefficient as a simp rule *)</span></span></span></span></span><span>
</span><span>  </span><span class="string"><span class="delete"><span class="delete">"(a, b) ∈ E ⟹ a ∈ S"</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>closed</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>blast</span><span>
</span><span>  
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹p 11, ll 6--11›</span></span></span><span>
</span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>right_closed</span><span> </span><span class="delimiter">[</span><span>intro</span><span class="delimiter">]</span><span class="delimiter">:</span><span> </span><span class="comment"><span class="delete"><span class="delete"><span class="delete"><span class="delete">(* inefficient as a simp rule *)</span></span></span></span></span><span>
</span><span>  </span><span class="string"><span class="delete"><span class="delete">"(a, b) ∈ E ⟹ b ∈ S"</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>closed</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>blast</span><span>
</span><span>
</span><span class="keyword2"><span class="keyword">end</span></span><span> </span><span class="comment"><span class="delete"><span class="delete"><span class="delete"><span class="delete">(* equivalence *)</span></span></span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹p 11, ll 16--20›</span></span></span><span>
</span><span class="keyword1"><span class="command">locale</span></span><span> </span><span>partition</span><span> </span><span class="delimiter">=</span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">fixes</span></span><span> </span><span>S</span><span> </span><span class="keyword2"><span class="keyword">and</span></span><span> </span><span>P</span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">assumes</span></span><span> </span><span>subset</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">"P ⊆ Pow S"</span></span></span><span>
</span><span>    </span><span class="keyword2"><span class="keyword">and</span></span><span> </span><span>non_vacuous</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">"{} ∉ P"</span></span></span><span>
</span><span>    </span><span class="keyword2"><span class="keyword">and</span></span><span> </span><span>complete</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">"⋃P = S"</span></span></span><span>
</span><span>    </span><span class="keyword2"><span class="keyword">and</span></span><span> </span><span>disjoint</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">"⟦ A ∈ P; B ∈ P; A ≠ B ⟧ ⟹ A ∩ B = {}"</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">context</span></span><span> </span><span>equivalence</span><span> </span><span class="keyword2"><span class="keyword">begin</span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹p 11, ll 24--26›</span></span></span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span class="string"><span class="delete"><span class="delete">"Class = (λa ∈ S. {b ∈ S. (b, a) ∈ E})"</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹p 11, ll 24--26›</span></span></span><span>
</span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>Class_closed</span><span> </span><span class="delimiter">[</span><span>dest</span><span class="delimiter">]</span><span class="delimiter">:</span><span>
</span><span>  </span><span class="string"><span class="delete"><span class="delete">"⟦ a ∈ Class b; b ∈ S ⟧ ⟹ a ∈ S"</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">unfolding</span></span><span> </span><span>Class_def</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>auto</span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹p 11, ll 24--26›</span></span></span><span>
</span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>Class_closed2</span><span> </span><span class="delimiter">[</span><span>intro</span><span class="delimiter">,</span><span> </span><span>simp</span><span class="delimiter">]</span><span class="delimiter">:</span><span>
</span><span>  </span><span class="string"><span class="delete"><span class="delete">"a ∈ S ⟹ Class a ⊆ S"</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">unfolding</span></span><span> </span><span>Class_def</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>auto</span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹p 11, ll 24--26›</span></span></span><span>
</span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>Class_undefined</span><span> </span><span class="delimiter">[</span><span>intro</span><span class="delimiter">,</span><span> </span><span>simp</span><span class="delimiter">]</span><span class="delimiter">:</span><span>
</span><span>  </span><span class="string"><span class="delete"><span class="delete">"a ∉ S ⟹ Class a = undefined"</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">unfolding</span></span><span> </span><span>Class_def</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>simp</span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹p 11, ll 24--26›</span></span></span><span>
</span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>ClassI</span><span> </span><span class="delimiter">[</span><span>intro</span><span class="delimiter">,</span><span> </span><span>simp</span><span class="delimiter">]</span><span class="delimiter">:</span><span>
</span><span>  </span><span class="string"><span class="delete"><span class="delete">"(a, b) ∈ E ⟹ a ∈ Class b"</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">unfolding</span></span><span> </span><span>Class_def</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>simp</span><span> </span><span>add</span><span class="delimiter">:</span><span> </span><span>left_closed</span><span> </span><span>right_closed</span><span class="delimiter">)</span><span>
</span><span>  
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹p 11, ll 24--26›</span></span></span><span>
</span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>Class_revI</span><span> </span><span class="delimiter">[</span><span>intro</span><span class="delimiter">,</span><span> </span><span>simp</span><span class="delimiter">]</span><span class="delimiter">:</span><span>
</span><span>  </span><span class="string"><span class="delete"><span class="delete">"(a, b) ∈ E ⟹ b ∈ Class a"</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>blast</span><span> </span><span>intro</span><span class="delimiter">:</span><span> </span><span>symmetric</span><span class="delimiter">)</span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹p 11, ll 24--26›</span></span></span><span>
</span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>ClassD</span><span> </span><span class="delimiter">[</span><span>dest</span><span class="delimiter">]</span><span class="delimiter">:</span><span>
</span><span>  </span><span class="string"><span class="delete"><span class="delete">"⟦ b ∈ Class a; a ∈ S ⟧ ⟹ (b, a) ∈ E"</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">unfolding</span></span><span> </span><span>Class_def</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>simp</span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹p 11, ll 30--31›</span></span></span><span>
</span><span class="keyword1"><span class="command">theorem</span></span><span> </span><span>Class_self</span><span> </span><span class="delimiter">[</span><span>intro</span><span class="delimiter">,</span><span> </span><span>simp</span><span class="delimiter">]</span><span class="delimiter">:</span><span>
</span><span>  </span><span class="string"><span class="delete"><span class="delete">"a ∈ S ⟹ a ∈ Class a"</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">unfolding</span></span><span> </span><span>Class_def</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>simp</span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹p 11, l 31; p 12, l 1›</span></span></span><span>
</span><span class="keyword1"><span class="command">theorem</span></span><span> </span><span>Class_Union</span><span> </span><span class="delimiter">[</span><span>simp</span><span class="delimiter">]</span><span class="delimiter">:</span><span>
</span><span>  </span><span class="string"><span class="delete"><span class="delete">"(⋃a∈S. Class a) = S"</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>blast</span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹p 11, ll 2--3›</span></span></span><span>
</span><span class="keyword1"><span class="command">theorem</span></span><span> </span><span>Class_subset</span><span class="delimiter">:</span><span>
</span><span>  </span><span class="string"><span class="delete"><span class="delete">"(a, b) ∈ E ⟹ Class a ⊆ Class b"</span></span></span><span>
</span><span class="keyword1"><span class="command">proof</span></span><span>
</span><span>  </span><span class="keyword3"><span class="command">fix</span></span><span> </span><span>a</span><span> </span><span class="keyword2"><span class="keyword">and</span></span><span> </span><span>b</span><span> </span><span class="keyword2"><span class="keyword">and</span></span><span> </span><span>c</span><span>
</span><span>  </span><span class="keyword3"><span class="command">assume</span></span><span> </span><span class="string"><span class="delete"><span class="delete">"(a, b) ∈ E"</span></span></span><span> </span><span class="keyword2"><span class="keyword">and</span></span><span> </span><span class="string"><span class="delete"><span class="delete">"c ∈ Class a"</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">then</span></span><span> </span><span class="keyword1"><span class="command">have</span></span><span> </span><span class="string"><span class="delete"><span class="delete">"(c, a) ∈ E"</span></span></span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>auto</span><span>
</span><span>  </span><span class="keyword1"><span class="command">also</span></span><span> </span><span class="keyword1"><span class="command">note</span></span><span> </span><span class="alt_string"><span class="delete"><span class="delete">`(a, b) ∈ E`</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">finally</span></span><span> </span><span class="keyword1"><span class="command">have</span></span><span> </span><span class="string"><span class="delete"><span class="delete">"(c, b) ∈ E"</span></span></span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>simp</span><span>
</span><span>  </span><span class="keyword1"><span class="command">then</span></span><span> </span><span class="keyword3"><span class="command">show</span></span><span> </span><span class="string"><span class="delete"><span class="delete">"c ∈ Class b"</span></span></span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>auto</span><span>
</span><span class="keyword1"><span class="command">qed</span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹p 11, ll 3--4›</span></span></span><span>
</span><span class="keyword1"><span class="command">theorem</span></span><span> </span><span>Class_eq</span><span class="delimiter">:</span><span>
</span><span>  </span><span class="string"><span class="delete"><span class="delete">"(a, b) ∈ E ⟹ Class a = Class b"</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>auto</span><span> </span><span>intro</span><span class="delimiter">!</span><span class="delimiter">:</span><span> </span><span>Class_subset</span><span> </span><span>intro</span><span class="delimiter">:</span><span> </span><span>symmetric</span><span class="delimiter">)</span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹p 12, ll 1--5›</span></span></span><span>
</span><span class="keyword1"><span class="command">theorem</span></span><span> </span><span>Class_equivalence</span><span class="delimiter">:</span><span>
</span><span>  </span><span class="string"><span class="delete"><span class="delete">"⟦ a ∈ S; b ∈ S ⟧ ⟹ Class a = Class b ⟷ (a, b) ∈ E"</span></span></span><span>
</span><span class="keyword1"><span class="command">proof</span></span><span>
</span><span>  </span><span class="keyword3"><span class="command">fix</span></span><span> </span><span>a</span><span> </span><span class="keyword2"><span class="keyword">and</span></span><span> </span><span>b</span><span>
</span><span>  </span><span class="keyword3"><span class="command">assume</span></span><span> </span><span class="string"><span class="delete"><span class="delete">"a ∈ S"</span></span></span><span> </span><span class="string"><span class="delete"><span class="delete">"b ∈ S"</span></span></span><span> </span><span class="string"><span class="delete"><span class="delete">"Class a = Class b"</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">then</span></span><span> </span><span class="keyword1"><span class="command">have</span></span><span> </span><span class="string"><span class="delete"><span class="delete">"a ∈ Class a"</span></span></span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>auto</span><span>
</span><span>  </span><span class="keyword1"><span class="command">also</span></span><span> </span><span class="keyword1"><span class="command">note</span></span><span> </span><span class="alt_string"><span class="delete"><span class="delete">`Class a = Class b`</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">finally</span></span><span> </span><span class="keyword3"><span class="command">show</span></span><span> </span><span class="string"><span class="delete"><span class="delete">"(a, b) ∈ E"</span></span></span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>fast</span><span> </span><span>intro</span><span class="delimiter">:</span><span> </span><span class="alt_string"><span class="delete"><span class="delete">`b ∈ S`</span></span></span><span class="delimiter">)</span><span>
</span><span class="keyword1"><span class="command">qed</span></span><span> </span><span class="delimiter">(</span><span>rule</span><span> </span><span>Class_eq</span><span class="delimiter">)</span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹p 12, ll 5--7›</span></span></span><span>
</span><span class="keyword1"><span class="command">theorem</span></span><span> </span><span>not_disjoint_implies_equal</span><span class="delimiter">:</span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">assumes</span></span><span> </span><span>not_disjoint</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">"Class a ∩ Class b ≠ {}"</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">assumes</span></span><span> </span><span>closed</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">"a ∈ S"</span></span></span><span> </span><span class="string"><span class="delete"><span class="delete">"b ∈ S"</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">shows</span></span><span> </span><span class="string"><span class="delete"><span class="delete">"Class a = Class b"</span></span></span><span>
</span><span class="keyword1"><span class="command">proof</span></span><span> </span><span>-</span><span>
</span><span>  </span><span class="keyword1"><span class="command">from</span></span><span> </span><span>not_disjoint</span><span> </span><span class="keyword2"><span class="keyword">and</span></span><span> </span><span>closed</span><span> </span><span class="keyword3"><span class="command">obtain</span></span><span> </span><span>c</span><span> </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span>witness</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">"c ∈ Class a ∩ Class b"</span></span></span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>fast</span><span>
</span><span>  </span><span class="keyword1"><span class="command">with</span></span><span> </span><span>closed</span><span> </span><span class="keyword1"><span class="command">have</span></span><span> </span><span class="string"><span class="delete"><span class="delete">"(a, c) ∈ E"</span></span></span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>blast</span><span> </span><span>intro</span><span class="delimiter">:</span><span> </span><span>symmetric</span><span class="delimiter">)</span><span>
</span><span>  </span><span class="keyword1"><span class="command">also</span></span><span> </span><span class="keyword1"><span class="command">from</span></span><span> </span><span>witness</span><span> </span><span class="keyword2"><span class="keyword">and</span></span><span> </span><span>closed</span><span> </span><span class="keyword1"><span class="command">have</span></span><span> </span><span class="string"><span class="delete"><span class="delete">"(c, b) ∈ E"</span></span></span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>fast</span><span>
</span><span>  </span><span class="keyword1"><span class="command">finally</span></span><span> </span><span class="keyword3"><span class="command">show</span></span><span> </span><span class="var">?thesis</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>rule</span><span> </span><span>Class_eq</span><span class="delimiter">)</span><span>
</span><span class="keyword1"><span class="command">qed</span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹p 12, ll 7--8›</span></span></span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span class="string"><span class="delete"><span class="delete">"Partition = {Class a | a. a ∈ S}"</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹p 12, ll 7--8›</span></span></span><span>
</span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>Class_in_Partition</span><span> </span><span class="delimiter">[</span><span>intro</span><span class="delimiter">,</span><span> </span><span>simp</span><span class="delimiter">]</span><span class="delimiter">:</span><span>
</span><span>  </span><span class="string"><span class="delete"><span class="delete">"a ∈ S ⟹ Class a ∈ Partition"</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">unfolding</span></span><span> </span><span>Partition_def</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>fast</span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹p 12, ll 7--8›</span></span></span><span>
</span><span class="keyword1"><span class="command">theorem</span></span><span> </span><span>partition</span><span class="delimiter">:</span><span>
</span><span>  </span><span class="string"><span class="delete"><span class="delete">"partition S Partition"</span></span></span><span>
</span><span class="keyword1"><span class="command">proof</span></span><span>
</span><span>  </span><span class="keyword3"><span class="command">fix</span></span><span> </span><span>A</span><span> </span><span class="keyword2"><span class="keyword">and</span></span><span> </span><span>B</span><span>
</span><span>  </span><span class="keyword3"><span class="command">assume</span></span><span> </span><span>closed</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">"A ∈ Partition"</span></span></span><span> </span><span class="string"><span class="delete"><span class="delete">"B ∈ Partition"</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">then</span></span><span> </span><span class="keyword3"><span class="command">obtain</span></span><span> </span><span>a</span><span> </span><span class="keyword2"><span class="keyword">and</span></span><span> </span><span>b</span><span> </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span>eq</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">"A = Class a"</span></span></span><span> </span><span class="string"><span class="delete"><span class="delete">"B = Class b"</span></span></span><span> </span><span class="keyword2"><span class="keyword">and</span></span><span> </span><span>ab</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">"a ∈ S"</span></span></span><span> </span><span class="string"><span class="delete"><span class="delete">"b ∈ S"</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">unfolding</span></span><span> </span><span>Partition_def</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>auto</span><span>
</span><span>  </span><span class="keyword3"><span class="command">assume</span></span><span> </span><span>distinct</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">"A ≠ B"</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">then</span></span><span> </span><span class="keyword3"><span class="command">show</span></span><span> </span><span class="string"><span class="delete"><span class="delete">"A ∩ B = {}"</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">proof</span></span><span> </span><span class="delimiter">(</span><span>rule</span><span> </span><span>contrapos_np</span><span class="delimiter">)</span><span>
</span><span>    </span><span class="keyword3"><span class="command">assume</span></span><span> </span><span>not_disjoint</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">"A ∩ B ≠ {}"</span></span></span><span>
</span><span>    </span><span class="keyword1"><span class="command">then</span></span><span> </span><span class="keyword3"><span class="command">show</span></span><span> </span><span class="string"><span class="delete"><span class="delete">"A = B"</span></span></span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>simp</span><span> </span><span>add</span><span class="delimiter">:</span><span> </span><span>eq</span><span class="delimiter">)</span><span> </span><span class="delimiter">(</span><span>metis</span><span> </span><span>not_disjoint_implies_equal</span><span> </span><span>ab</span><span class="delimiter">)</span><span>
</span><span>  </span><span class="keyword1"><span class="command">qed</span></span><span>
</span><span class="keyword1"><span class="command">qed</span></span><span> </span><span class="delimiter">(</span><span>auto</span><span> </span><span>simp</span><span class="delimiter">:</span><span> </span><span>Partition_def</span><span class="delimiter">)</span><span>
</span><span>
</span><span class="keyword2"><span class="keyword">end</span></span><span> </span><span class="comment"><span class="delete"><span class="delete"><span class="delete"><span class="delete">(* equivalence *)</span></span></span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">context</span></span><span> </span><span>partition</span><span> </span><span class="keyword2"><span class="keyword">begin</span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹p 12, ll 9--10›</span></span></span><span>
</span><span class="keyword1"><span class="command">theorem</span></span><span> </span><span>block_exists</span><span class="delimiter">:</span><span>
</span><span>  </span><span class="string"><span class="delete"><span class="delete">"a ∈ S ⟹ ∃A. a ∈ A ∧ A ∈ P"</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>complete</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>blast</span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹p 12, ll 9--10›</span></span></span><span>
</span><span class="keyword1"><span class="command">theorem</span></span><span> </span><span>block_unique</span><span class="delimiter">:</span><span>
</span><span>  </span><span class="string"><span class="delete"><span class="delete">"⟦ a ∈ A; A ∈ P; a ∈ B; B ∈ P ⟧ ⟹ A = B"</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>disjoint</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>blast</span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹p 12, ll 9--10›</span></span></span><span>
</span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>block_closed</span><span> </span><span class="delimiter">[</span><span>intro</span><span class="delimiter">]</span><span class="delimiter">:</span><span> </span><span class="comment"><span class="delete"><span class="delete"><span class="delete"><span class="delete">(* inefficient as a simp rule *)</span></span></span></span></span><span>
</span><span>  </span><span class="string"><span class="delete"><span class="delete">"⟦ a ∈ A; A ∈ P ⟧ ⟹ a ∈ S"</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>complete</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>blast</span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹p 12, ll 9--10›</span></span></span><span>
</span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>element_exists</span><span class="delimiter">:</span><span>
</span><span>  </span><span class="string"><span class="delete"><span class="delete">"A ∈ P ⟹ ∃a ∈ S. a ∈ A"</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>metis</span><span> </span><span>non_vacuous</span><span> </span><span>block_closed</span><span> </span><span>all_not_in_conv</span><span class="delimiter">)</span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹p 12, ll 9--10›</span></span></span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span class="string"><span class="delete"><span class="delete">"Block = (λa ∈ S. THE A. a ∈ A ∧ A ∈ P)"</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹p 12, ll 9--10›</span></span></span><span>
</span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>Block_closed</span><span> </span><span class="delimiter">[</span><span>intro</span><span class="delimiter">,</span><span> </span><span>simp</span><span class="delimiter">]</span><span class="delimiter">:</span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">assumes</span></span><span> </span><span class="delimiter">[</span><span>intro</span><span class="delimiter">]</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">"a ∈ S"</span></span></span><span> </span><span class="keyword2"><span class="keyword">shows</span></span><span> </span><span class="string"><span class="delete"><span class="delete">"Block a ∈ P"</span></span></span><span>
</span><span class="keyword1"><span class="command">proof</span></span><span> </span><span>-</span><span>
</span><span>  </span><span class="keyword3"><span class="command">obtain</span></span><span> </span><span>A</span><span> </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">"a ∈ A"</span></span></span><span> </span><span class="string"><span class="delete"><span class="delete">"A ∈ P"</span></span></span><span> </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>block_exists</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>blast</span><span>
</span><span>  </span><span class="keyword1"><span class="command">then</span></span><span> </span><span class="keyword3"><span class="command">show</span></span><span> </span><span class="var">?thesis</span><span>
</span><span>    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span> </span><span class="delimiter">(</span><span>auto</span><span> </span><span>simp</span><span class="delimiter">:</span><span> </span><span>Block_def</span><span class="delimiter">)</span><span>
</span><span>    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span> </span><span class="delimiter">(</span><span>rule</span><span> </span><span>theI2</span><span class="delimiter">)</span><span>
</span><span>      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span> </span><span class="delimiter">(</span><span>auto</span><span> </span><span>dest</span><span class="delimiter">:</span><span> </span><span>block_unique</span><span class="delimiter">)</span><span>
</span><span>    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">done</span></span></span></span><span>
</span><span class="keyword1"><span class="command">qed</span></span><span>
</span><span>  
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹p 12, ll 9--10›</span></span></span><span>
</span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>Block_undefined</span><span> </span><span class="delimiter">[</span><span>intro</span><span class="delimiter">,</span><span> </span><span>simp</span><span class="delimiter">]</span><span class="delimiter">:</span><span>
</span><span>  </span><span class="string"><span class="delete"><span class="delete">"a ∉ S ⟹ Block a = undefined"</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">unfolding</span></span><span> </span><span>Block_def</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>simp</span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹p 12, ll 9--10›</span></span></span><span>
</span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>Block_self</span><span class="delimiter">:</span><span>
</span><span>  </span><span class="string"><span class="delete"><span class="delete">"⟦ a ∈ A; A ∈ P ⟧ ⟹ Block a = A"</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span> </span><span class="delimiter">(</span><span>simp</span><span> </span><span>add</span><span class="delimiter">:</span><span> </span><span>Block_def</span><span> </span><span>block_closed</span><span class="delimiter">)</span><span>
</span><span>  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span> </span><span class="delimiter">(</span><span>rule</span><span> </span><span>the_equality</span><span class="delimiter">)</span><span>
</span><span>   </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span> </span><span class="delimiter">(</span><span>auto</span><span> </span><span>dest</span><span class="delimiter">:</span><span> </span><span>block_unique</span><span class="delimiter">)</span><span>
</span><span>  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">done</span></span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹p 12, ll 10--11›</span></span></span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span class="string"><span class="delete"><span class="delete">"Equivalence = {(a, b) . ∃A ∈ P. a ∈ A ∧ b ∈ A}"</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹p 12, ll 11--12›</span></span></span><span>
</span><span class="keyword1"><span class="command">theorem</span></span><span> </span><span>equivalence</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">"equivalence S Equivalence"</span></span></span><span>
</span><span class="keyword1"><span class="command">proof</span></span><span>
</span><span>  </span><span class="keyword3"><span class="command">show</span></span><span> </span><span class="string"><span class="delete"><span class="delete">"Equivalence ⊆ S × S"</span></span></span><span> </span><span class="keyword1"><span class="command">unfolding</span></span><span> </span><span>Equivalence_def</span><span> </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>subset</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>auto</span><span>
</span><span class="keyword1"><span class="command">next</span></span><span>
</span><span>  </span><span class="keyword3"><span class="command">fix</span></span><span> </span><span>a</span><span>
</span><span>  </span><span class="keyword3"><span class="command">assume</span></span><span> </span><span class="string"><span class="delete"><span class="delete">"a ∈ S"</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">then</span></span><span> </span><span class="keyword3"><span class="command">show</span></span><span> </span><span class="string"><span class="delete"><span class="delete">"(a, a) ∈ Equivalence"</span></span></span><span> </span><span class="keyword1"><span class="command">unfolding</span></span><span> </span><span>Equivalence_def</span><span> </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>complete</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>auto</span><span>
</span><span class="keyword1"><span class="command">next</span></span><span>
</span><span>  </span><span class="keyword3"><span class="command">fix</span></span><span> </span><span>a</span><span> </span><span class="keyword2"><span class="keyword">and</span></span><span> </span><span>b</span><span>
</span><span>  </span><span class="keyword3"><span class="command">assume</span></span><span> </span><span class="string"><span class="delete"><span class="delete">"(a, b) ∈ Equivalence"</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">then</span></span><span> </span><span class="keyword3"><span class="command">show</span></span><span> </span><span class="string"><span class="delete"><span class="delete">"(b, a) ∈ Equivalence"</span></span></span><span> </span><span class="keyword1"><span class="command">unfolding</span></span><span> </span><span>Equivalence_def</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>auto</span><span>
</span><span class="keyword1"><span class="command">next</span></span><span>
</span><span>  </span><span class="keyword3"><span class="command">fix</span></span><span> </span><span>a</span><span> </span><span class="keyword2"><span class="keyword">and</span></span><span> </span><span>b</span><span> </span><span class="keyword2"><span class="keyword">and</span></span><span> </span><span>c</span><span>
</span><span>  </span><span class="keyword3"><span class="command">assume</span></span><span> </span><span class="string"><span class="delete"><span class="delete">"(a, b) ∈ Equivalence"</span></span></span><span> </span><span class="string"><span class="delete"><span class="delete">"(b, c) ∈ Equivalence"</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">then</span></span><span> </span><span class="keyword3"><span class="command">show</span></span><span> </span><span class="string"><span class="delete"><span class="delete">"(a, c) ∈ Equivalence"</span></span></span><span> </span><span class="keyword1"><span class="command">unfolding</span></span><span> </span><span>Equivalence_def</span><span> </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>disjoint</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>auto</span><span>
</span><span class="keyword1"><span class="command">qed</span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹Temporarily introduce equivalence associated to partition.›</span></span></span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹p 12, ll 12--14›</span></span></span><span>
</span><span class="keyword1"><span class="command">interpretation</span></span><span> </span><span>equivalence</span><span> </span><span>S</span><span> </span><span>Equivalence</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>rule</span><span> </span><span>equivalence</span><span class="delimiter">)</span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹p 12, ll 12--14›</span></span></span><span>
</span><span class="keyword1"><span class="command">theorem</span></span><span> </span><span>Class_is_Block</span><span class="delimiter">:</span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">assumes</span></span><span> </span><span class="string"><span class="delete"><span class="delete">"a ∈ S"</span></span></span><span> </span><span class="keyword2"><span class="keyword">shows</span></span><span> </span><span class="string"><span class="delete"><span class="delete">"Class a = Block a"</span></span></span><span>
</span><span class="keyword1"><span class="command">proof</span></span><span> </span><span>-</span><span>
</span><span>  </span><span class="keyword1"><span class="command">from</span></span><span> </span><span class="alt_string"><span class="delete"><span class="delete">`a ∈ S`</span></span></span><span> </span><span class="keyword2"><span class="keyword">and</span></span><span> </span><span>block_exists</span><span> </span><span class="keyword3"><span class="command">obtain</span></span><span> </span><span>A</span><span> </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span>block</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">"a ∈ A ∧ A ∈ P"</span></span></span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>blast</span><span>
</span><span>  </span><span class="keyword3"><span class="command">show</span></span><span> </span><span class="var">?thesis</span><span>
</span><span>    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span> </span><span class="delimiter">(</span><span>simp</span><span> </span><span>add</span><span class="delimiter">:</span><span> </span><span>Block_def</span><span> </span><span>Class_def</span><span class="delimiter">)</span><span>
</span><span>    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span> </span><span class="delimiter">(</span><span>rule</span><span> </span><span>theI2</span><span class="delimiter">)</span><span>
</span><span>      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span> </span><span class="delimiter">(</span><span>rule</span><span> </span><span>block</span><span class="delimiter">)</span><span>
</span><span>     </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span> </span><span class="delimiter">(</span><span>metis</span><span> </span><span>block</span><span> </span><span>block_unique</span><span class="delimiter">)</span><span>
</span><span>    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span> </span><span class="delimiter">(</span><span>auto</span><span> </span><span>dest</span><span class="delimiter">:</span><span> </span><span>block_unique</span><span> </span><span>simp</span><span class="delimiter">:</span><span> </span><span>Equivalence_def</span><span class="delimiter">)</span><span>
</span><span>    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">done</span></span></span></span><span>
</span><span class="keyword1"><span class="command">qed</span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹p 12, l 14›</span></span></span><span>
</span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>Class_equals_Block</span><span class="delimiter">:</span><span>
</span><span>  </span><span class="string"><span class="delete"><span class="delete">"Class = Block"</span></span></span><span>
</span><span class="keyword1"><span class="command">proof</span></span><span>
</span><span>  </span><span class="keyword3"><span class="command">fix</span></span><span> </span><span>x</span><span> </span><span class="keyword3"><span class="command">show</span></span><span> </span><span class="string"><span class="delete"><span class="delete">"Class x = Block x"</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>cases</span><span> </span><span class="string"><span class="delete"><span class="delete">"x ∈ S"</span></span></span><span class="delimiter">)</span><span> </span><span class="delimiter">(</span><span>auto</span><span> </span><span>simp</span><span class="delimiter">:</span><span> </span><span>Class_is_Block</span><span class="delimiter">)</span><span>
</span><span class="keyword1"><span class="command">qed</span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹p 12, l 14›</span></span></span><span>
</span><span class="keyword1"><span class="command">theorem</span></span><span> </span><span>partition_of_equivalence</span><span class="delimiter">:</span><span>
</span><span>  </span><span class="string"><span class="delete"><span class="delete">"Partition = P"</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>auto</span><span> </span><span>simp</span><span> </span><span>add</span><span class="delimiter">:</span><span> </span><span>Partition_def</span><span> </span><span>Class_equals_Block</span><span class="delimiter">)</span><span> </span><span class="delimiter">(</span><span>metis</span><span> </span><span>Block_self</span><span> </span><span>element_exists</span><span class="delimiter">)</span><span>
</span><span>
</span><span class="keyword2"><span class="keyword">end</span></span><span> </span><span class="comment"><span class="delete"><span class="delete"><span class="delete"><span class="delete">(* partition *)</span></span></span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">context</span></span><span> </span><span>equivalence</span><span> </span><span class="keyword2"><span class="keyword">begin</span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹p 12, ll 14--17›</span></span></span><span>
</span><span class="keyword1"><span class="command">interpretation</span></span><span> </span><span>partition</span><span> </span><span>S</span><span> </span><span>Partition</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>rule</span><span> </span><span>partition</span><span class="delimiter">)</span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹p 12, ll 14--17›</span></span></span><span>
</span><span class="keyword1"><span class="command">theorem</span></span><span> </span><span>equivalence_of_partition</span><span class="delimiter">:</span><span>
</span><span>  </span><span class="string"><span class="delete"><span class="delete">"Equivalence = E"</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">unfolding</span></span><span> </span><span>Equivalence_def</span><span> </span><span class="keyword1"><span class="command">unfolding</span></span><span> </span><span>Partition_def</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>auto</span><span> </span><span class="delimiter">(</span><span>metis</span><span> </span><span>ClassD</span><span> </span><span>Class_closed</span><span> </span><span>Class_eq</span><span class="delimiter">)</span><span>
</span><span>
</span><span class="keyword2"><span class="keyword">end</span></span><span> </span><span class="comment"><span class="delete"><span class="delete"><span class="delete"><span class="delete">(* equivalence *)</span></span></span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹p 12, l 14›</span></span></span><span>
</span><span class="keyword1"><span class="command">sublocale</span></span><span> </span><span>partition</span><span> </span><span class="delimiter">⊆</span><span> </span><span>equivalence</span><span> </span><span>S</span><span> </span><span>Equivalence</span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">rewrites</span></span><span> </span><span class="string"><span class="delete"><span class="delete">"equivalence.Partition S Equivalence = P"</span></span></span><span> </span><span class="keyword2"><span class="keyword">and</span></span><span> </span><span class="string"><span class="delete"><span class="delete">"equivalence.Class S Equivalence = Block"</span></span></span><span>
</span><span>    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span> </span><span class="delimiter">(</span><span>rule</span><span> </span><span>equivalence</span><span class="delimiter">)</span><span>
</span><span>   </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span> </span><span class="delimiter">(</span><span>rule</span><span> </span><span>partition_of_equivalence</span><span class="delimiter">)</span><span>
</span><span>  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span> </span><span class="delimiter">(</span><span>rule</span><span> </span><span>Class_equals_Block</span><span class="delimiter">)</span><span>
</span><span>  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">done</span></span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹p 12, ll 14--17›</span></span></span><span>
</span><span class="keyword1"><span class="command">sublocale</span></span><span> </span><span>equivalence</span><span> </span><span class="delimiter">⊆</span><span> </span><span>partition</span><span> </span><span>S</span><span> </span><span>Partition</span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">rewrites</span></span><span> </span><span class="string"><span class="delete"><span class="delete">"partition.Equivalence Partition = E"</span></span></span><span> </span><span class="keyword2"><span class="keyword">and</span></span><span> </span><span class="string"><span class="delete"><span class="delete">"partition.Block S Partition = Class"</span></span></span><span>
</span><span>    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span> </span><span class="delimiter">(</span><span>rule</span><span> </span><span>partition</span><span class="delimiter">)</span><span>
</span><span>   </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span> </span><span class="delimiter">(</span><span>rule</span><span> </span><span>equivalence_of_partition</span><span class="delimiter">)</span><span>
</span><span>  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span> </span><span class="delimiter">(</span><span>metis</span><span> </span><span>equivalence_of_partition</span><span> </span><span>partition</span><span> </span><span>partition.Class_equals_Block</span><span class="delimiter">)</span><span>
</span><span>  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">done</span></span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹Unfortunately only effective on input›</span></span></span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹p 12, ll 18--20›</span></span></span><span>
</span><span class="keyword1"><span class="command">notation</span></span><span> </span><span>equivalence.Partition</span><span> </span><span class="delimiter">(</span><span class="keyword2"><span class="keyword">infixl</span></span><span> </span><span class="string"><span class="delete"><span class="delete">"'/"</span></span></span><span> </span><span>75</span><span class="delimiter">)</span><span>
</span><span>
</span><span class="keyword1"><span class="command">context</span></span><span> </span><span>equivalence</span><span> </span><span class="keyword2"><span class="keyword">begin</span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹p 12, ll 18--20›</span></span></span><span>
</span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>representant_exists</span><span> </span><span class="delimiter">[</span><span>dest</span><span class="delimiter">]</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">"A ∈ S / E ⟹ ∃a∈S. a ∈ A ∧ A = Class a"</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>metis</span><span> </span><span>Block_self</span><span> </span><span>element_exists</span><span class="delimiter">)</span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹p 12, ll 18--20›</span></span></span><span>
</span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>quotient_ClassE</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">"A ∈ S / E ⟹ (⋀a. a ∈ S ⟹ P (Class a)) ⟹ P A"</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>representant_exists</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>blast</span><span>
</span><span>
</span><span class="keyword2"><span class="keyword">end</span></span><span> </span><span class="comment"><span class="delete"><span class="delete"><span class="delete"><span class="delete">(* equivalence *)</span></span></span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹p 12, ll 21--23›</span></span></span><span>
</span><span class="keyword1"><span class="command">sublocale</span></span><span> </span><span>equivalence</span><span> </span><span class="delimiter">⊆</span><span> </span><span>natural</span><span class="delimiter">:</span><span> </span><span>surjective_map</span><span> </span><span>Class</span><span> </span><span>S</span><span> </span><span class="string"><span class="delete"><span class="delete">"S / E"</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>unfold_locales</span><span> </span><span>force</span><span class="delimiter">+</span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹Technical device to achieve Jacobson's syntax; context where @{text α} is not a parameter.›</span></span></span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹p 12, ll 25--26›</span></span></span><span>
</span><span class="keyword1"><span class="command">locale</span></span><span> </span><span>fiber_relation_notation</span><span> </span><span class="delimiter">=</span><span> </span><span class="keyword2"><span class="keyword">fixes</span></span><span> </span><span>S</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">"'a set"</span></span></span><span> </span><span class="keyword2"><span class="keyword">begin</span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹p 12, ll 25--26›</span></span></span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>Fiber_Relation</span><span> </span><span class="delimiter">(</span><span class="string"><span class="delete"><span class="delete">"E'(_')"</span></span></span><span class="delimiter">)</span><span> </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">"Fiber_Relation α = {(x, y). x ∈ S ∧ y ∈ S ∧ α x = α y}"</span></span></span><span>
</span><span>
</span><span class="keyword2"><span class="keyword">end</span></span><span> </span><span class="comment"><span class="delete"><span class="delete"><span class="delete"><span class="delete">(* fiber_relation_notation *)</span></span></span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹
  Context where classes and the induced map are defined through the fiber relation.
  This will be the case for monoid homomorphisms but not group homomorphisms.
›</span></span></span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹Avoids infinite interpretation chain.›</span></span></span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹p 12, ll 25--26›</span></span></span><span>
</span><span class="keyword1"><span class="command">locale</span></span><span> </span><span>fiber_relation</span><span> </span><span class="delimiter">=</span><span> </span><span>map</span><span> </span><span class="keyword2"><span class="keyword">begin</span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹Install syntax›</span></span></span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹p 12, ll 25--26›</span></span></span><span>
</span><span class="keyword1"><span class="command">sublocale</span></span><span> </span><span>fiber_relation_notation</span><span> </span><span class="keyword1"><span class="command">.</span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹p 12, ll 26--27›</span></span></span><span>
</span><span class="keyword1"><span class="command">sublocale</span></span><span> </span><span>equivalence</span><span> </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span>E</span><span> </span><span class="delimiter">=</span><span> </span><span class="string"><span class="delete"><span class="delete">"E(α)"</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">unfolding</span></span><span> </span><span>Fiber_Relation_def</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>unfold_locales</span><span> </span><span>auto</span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹``define $\bar{\alpha}$ by $\bar{\alpha}(\bar{a}) = \alpha(a)$''›</span></span></span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹p 13, ll 8--9›</span></span></span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span class="string"><span class="delete"><span class="delete">"induced = (λA ∈ S / E(α). THE b. ∃a ∈ A. b = α a)"</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹p 13, l 10›</span></span></span><span>
</span><span class="keyword1"><span class="command">theorem</span></span><span> </span><span>Fiber_equality</span><span class="delimiter">:</span><span>
</span><span>  </span><span class="string"><span class="delete"><span class="delete">"⟦ a ∈ S; b ∈ S ⟧ ⟹ Class a = Class b ⟷ α a = α b"</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">unfolding</span></span><span> </span><span>Class_equivalence</span><span> </span><span class="keyword1"><span class="command">unfolding</span></span><span> </span><span>Fiber_Relation_def</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>simp</span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹p 13, ll 8--9›</span></span></span><span>
</span><span class="keyword1"><span class="command">theorem</span></span><span> </span><span>induced_Fiber_simp</span><span> </span><span class="delimiter">[</span><span>simp</span><span class="delimiter">]</span><span class="delimiter">:</span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">assumes</span></span><span> </span><span class="delimiter">[</span><span>intro</span><span class="delimiter">,</span><span> </span><span>simp</span><span class="delimiter">]</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">"a ∈ S"</span></span></span><span> </span><span class="keyword2"><span class="keyword">shows</span></span><span> </span><span class="string"><span class="delete"><span class="delete">"induced (Class a) = α a"</span></span></span><span>
</span><span class="keyword1"><span class="command">proof</span></span><span> </span><span>-</span><span>
</span><span>  </span><span class="keyword1"><span class="command">have</span></span><span> </span><span class="string"><span class="delete"><span class="delete">"(THE b. ∃a∈Class a. b = α a) = α a"</span></span></span><span>
</span><span>    </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>rule</span><span> </span><span>the_equality</span><span class="delimiter">)</span><span> </span><span class="delimiter">(</span><span>auto</span><span> </span><span>simp</span><span class="delimiter">:</span><span> </span><span>Fiber_equality</span><span> </span><span class="delimiter">[</span><span>symmetric</span><span class="delimiter">]</span><span> </span><span>Block_self</span><span> </span><span>block_closed</span><span class="delimiter">)</span><span>
</span><span>  </span><span class="keyword1"><span class="command">then</span></span><span> </span><span class="keyword3"><span class="command">show</span></span><span> </span><span class="var">?thesis</span><span> </span><span class="keyword1"><span class="command">unfolding</span></span><span> </span><span>induced_def</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>simp</span><span>
</span><span class="keyword1"><span class="command">qed</span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹p 13, ll 10--11›</span></span></span><span>
</span><span class="keyword1"><span class="command">interpretation</span></span><span> </span><span>induced</span><span class="delimiter">:</span><span> </span><span>map</span><span> </span><span>induced</span><span> </span><span class="string"><span class="delete"><span class="delete">"S / E(α)"</span></span></span><span> </span><span>T</span><span>
</span><span class="keyword1"><span class="command">proof</span></span><span> </span><span class="delimiter">(</span><span>unfold_locales</span><span class="delimiter">,</span><span> </span><span>rule</span><span class="delimiter">)</span><span>
</span><span>  </span><span class="keyword3"><span class="command">fix</span></span><span> </span><span>A</span><span>
</span><span>  </span><span class="keyword3"><span class="command">assume</span></span><span> </span><span class="delimiter">[</span><span>intro</span><span class="delimiter">,</span><span> </span><span>simp</span><span class="delimiter">]</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">"A ∈ S / E(α)"</span></span></span><span>
</span><span>  </span><span class="keyword3"><span class="command">obtain</span></span><span> </span><span>a</span><span> </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span>a</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">"a ∈ S"</span></span></span><span> </span><span class="string"><span class="delete"><span class="delete">"a ∈ A"</span></span></span><span> </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>element_exists</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>auto</span><span>
</span><span>  </span><span class="keyword1"><span class="command">have</span></span><span> </span><span class="string"><span class="delete"><span class="delete">"(THE b. ∃a∈A. b = α a) ∈ T"</span></span></span><span>
</span><span>    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span> </span><span class="delimiter">(</span><span>rule</span><span> </span><span>theI2</span><span class="delimiter">)</span><span>
</span><span>    </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>a</span><span> </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span> </span><span class="delimiter">(</span><span>auto</span><span> </span><span>simp</span><span class="delimiter">:</span><span> </span><span>Fiber_equality</span><span> </span><span class="delimiter">[</span><span>symmetric</span><span class="delimiter">]</span><span> </span><span>Block_self</span><span> </span><span>block_closed</span><span class="delimiter">)</span><span>
</span><span>    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">done</span></span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">then</span></span><span> </span><span class="keyword3"><span class="command">show</span></span><span> </span><span class="string"><span class="delete"><span class="delete">"induced A ∈ T"</span></span></span><span> </span><span class="keyword1"><span class="command">unfolding</span></span><span> </span><span>induced_def</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>simp</span><span>
</span><span class="keyword1"><span class="command">qed</span></span><span> </span><span class="delimiter">(</span><span>simp</span><span> </span><span>add</span><span class="delimiter">:</span><span> </span><span>induced_def</span><span class="delimiter">)</span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹p 13, ll 12--13›</span></span></span><span>
</span><span class="keyword1"><span class="command">sublocale</span></span><span> </span><span>induced</span><span class="delimiter">:</span><span> </span><span>injective_map</span><span> </span><span>induced</span><span> </span><span class="string"><span class="delete"><span class="delete">"S / E(α)"</span></span></span><span> </span><span>T</span><span>
</span><span>  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span> </span><span>unfold_locales</span><span>
</span><span>  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span> </span><span class="delimiter">(</span><span>rule</span><span> </span><span>inj_onI</span><span class="delimiter">)</span><span>
</span><span>  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span> </span><span class="delimiter">(</span><span>metis</span><span> </span><span>Fiber_equality</span><span> </span><span>Block_self</span><span> </span><span>element_exists</span><span> </span><span>induced_Fiber_simp</span><span class="delimiter">)</span><span>
</span><span>  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">done</span></span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹p 13, ll 16--19›</span></span></span><span>
</span><span class="keyword1"><span class="command">theorem</span></span><span> </span><span>factorization_lemma</span><span class="delimiter">:</span><span>
</span><span>  </span><span class="string"><span class="delete"><span class="delete">"a ∈ S ⟹ compose S induced Class a = α a"</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>simp</span><span> </span><span>add</span><span class="delimiter">:</span><span> </span><span>compose_eq</span><span class="delimiter">)</span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹p 13, ll 16--19›</span></span></span><span>
</span><span class="keyword1"><span class="command">theorem</span></span><span> </span><span>factorization</span><span> </span><span class="delimiter">[</span><span>simp</span><span class="delimiter">]</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">"compose S induced Class = α"</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>rule</span><span> </span><span>ext</span><span class="delimiter">)</span><span> </span><span class="delimiter">(</span><span>simp</span><span> </span><span>add</span><span class="delimiter">:</span><span> </span><span>compose_def</span><span class="delimiter">)</span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹p 14, ll 2--4›</span></span></span><span>
</span><span class="keyword1"><span class="command">theorem</span></span><span> </span><span>uniqueness</span><span class="delimiter">:</span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">assumes</span></span><span> </span><span>map</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">"β ∈ S / E(α) →<span class="hidden">⇩</span><sub>E</sub> T"</span></span></span><span>
</span><span>    </span><span class="keyword2"><span class="keyword">and</span></span><span> </span><span>factorization</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">"compose S β Class = α"</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">shows</span></span><span> </span><span class="string"><span class="delete"><span class="delete">"β = induced"</span></span></span><span>
</span><span class="keyword1"><span class="command">proof</span></span><span>
</span><span>  </span><span class="keyword3"><span class="command">fix</span></span><span> </span><span>A</span><span>
</span><span>  </span><span class="keyword3"><span class="command">show</span></span><span> </span><span class="string"><span class="delete"><span class="delete">"β A = induced A"</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">proof</span></span><span> </span><span class="delimiter">(</span><span>cases</span><span> </span><span class="string"><span class="delete"><span class="delete">"A ∈ S / E(α)"</span></span></span><span class="delimiter">)</span><span>
</span><span>    </span><span class="keyword3"><span class="command">case</span></span><span> </span><span>True</span><span>
</span><span>    </span><span class="keyword1"><span class="command">then</span></span><span> </span><span class="keyword3"><span class="command">obtain</span></span><span> </span><span>a</span><span> </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="delimiter">[</span><span>simp</span><span class="delimiter">]</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">"A = Class a"</span></span></span><span> </span><span class="string"><span class="delete"><span class="delete">"a ∈ S"</span></span></span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>fast</span><span>
</span><span>    </span><span class="keyword1"><span class="command">then</span></span><span> </span><span class="keyword1"><span class="command">have</span></span><span> </span><span class="string"><span class="delete"><span class="delete">"β (Class a) = α a"</span></span></span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>metis</span><span> </span><span>compose_eq</span><span> </span><span>factorization</span><span class="delimiter">)</span><span>
</span><span>    </span><span class="keyword1"><span class="command">also</span></span><span> </span><span class="keyword1"><span class="command">have</span></span><span> </span><span class="string"><span class="delete"><span class="delete">"… = induced (Class a)"</span></span></span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>simp</span><span>
</span><span>    </span><span class="keyword1"><span class="command">finally</span></span><span> </span><span class="keyword3"><span class="command">show</span></span><span> </span><span class="var">?thesis</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>simp</span><span>
</span><span>  </span><span class="keyword1"><span class="command">qed</span></span><span> </span><span class="delimiter">(</span><span>simp</span><span> </span><span>add</span><span class="delimiter">:</span><span> </span><span>induced_def</span><span> </span><span>PiE_arb</span><span> </span><span class="delimiter">[</span><span>OF</span><span> </span><span>map</span><span class="delimiter">]</span><span class="delimiter">)</span><span>
</span><span class="keyword1"><span class="command">qed</span></span><span>
</span><span>
</span><span class="keyword2"><span class="keyword">end</span></span><span> </span><span class="comment"><span class="delete"><span class="delete"><span class="delete"><span class="delete">(* fiber_relation *)</span></span></span></span></span><span>
</span><span>
</span><span class="keyword2"><span class="keyword">end</span></span><span>
</span></pre>
</div>
</div><div id="Group_Theory">
<div class="head"><h1>Theory Group_Theory</h1>
<span class="command">theory</span> <span class="name">Group_Theory</span><br/>
<span class="keyword">imports</span> <a href="Set_Theory.html"><span class="name">Set_Theory</span></a><br/>
</div>
<div class="source">
<pre class="source"><span class="comment"><span class="delete"><span class="delete"><span class="delete"><span class="delete">(*
  Copyright (c) 2014-2019 by Clemens Ballarin
  This file is licensed under the 3-clause BSD license.
*)</span></span></span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">theory</span></span><span> </span><span>Group_Theory</span><span> </span><span class="keyword2"><span class="keyword">imports</span></span><span> </span><span>Set_Theory</span><span> </span><span class="keyword2"><span class="keyword">begin</span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">hide_const</span></span><span> </span><span>monoid</span><span>
</span><span class="keyword1"><span class="command">hide_const</span></span><span> </span><span>group</span><span>
</span><span class="keyword1"><span class="command">hide_const</span></span><span> </span><span>inverse</span><span>
</span><span>
</span><span class="keyword1"><span class="command">no_notation</span></span><span> </span><span>quotient</span><span> </span><span class="delimiter">(</span><span class="keyword2"><span class="keyword">infixl</span></span><span> </span><span class="string"><span class="delete"><span class="delete">"'/'/"</span></span></span><span> </span><span>90</span><span class="delimiter">)</span><span>
</span><span>
</span><span>
</span><span class="keyword1"><span class="command">section</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹Monoids and Groups›</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">subsection</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹Monoids of Transformations and Abstract Monoids›</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹Def 1.1›</span></span></span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹p 28, ll 28--30›</span></span></span><span>
</span><span class="keyword1"><span class="command">locale</span></span><span> </span><span>monoid</span><span> </span><span class="delimiter">=</span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">fixes</span></span><span> </span><span>M</span><span> </span><span class="keyword2"><span class="keyword">and</span></span><span> </span><span>composition</span><span> </span><span class="delimiter">(</span><span class="keyword2"><span class="keyword">infixl</span></span><span> </span><span class="string"><span class="delete"><span class="delete">"⋅"</span></span></span><span> </span><span>70</span><span class="delimiter">)</span><span> </span><span class="keyword2"><span class="keyword">and</span></span><span> </span><span>unit</span><span> </span><span class="delimiter">(</span><span class="string"><span class="delete"><span class="delete">"𝟭"</span></span></span><span class="delimiter">)</span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">assumes</span></span><span> </span><span>composition_closed</span><span> </span><span class="delimiter">[</span><span>intro</span><span class="delimiter">,</span><span> </span><span>simp</span><span class="delimiter">]</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">"⟦ a ∈ M; b ∈ M ⟧ ⟹ a ⋅ b ∈ M"</span></span></span><span>
</span><span>    </span><span class="keyword2"><span class="keyword">and</span></span><span> </span><span>unit_closed</span><span> </span><span class="delimiter">[</span><span>intro</span><span class="delimiter">,</span><span> </span><span>simp</span><span class="delimiter">]</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">"𝟭 ∈ M"</span></span></span><span>
</span><span>    </span><span class="keyword2"><span class="keyword">and</span></span><span> </span><span>associative</span><span> </span><span class="delimiter">[</span><span>intro</span><span class="delimiter">]</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">"⟦ a ∈ M; b ∈ M; c ∈ M ⟧ ⟹ (a ⋅ b) ⋅ c = a ⋅ (b ⋅ c)"</span></span></span><span>
</span><span>    </span><span class="keyword2"><span class="keyword">and</span></span><span> </span><span>left_unit</span><span> </span><span class="delimiter">[</span><span>intro</span><span class="delimiter">,</span><span> </span><span>simp</span><span class="delimiter">]</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">"a ∈ M ⟹ 𝟭 ⋅ a = a"</span></span></span><span>
</span><span>    </span><span class="keyword2"><span class="keyword">and</span></span><span> </span><span>right_unit</span><span> </span><span class="delimiter">[</span><span>intro</span><span class="delimiter">,</span><span> </span><span>simp</span><span class="delimiter">]</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">"a ∈ M ⟹ a ⋅ 𝟭 = a"</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹p 29, ll 27--28›</span></span></span><span>
</span><span class="keyword1"><span class="command">locale</span></span><span> </span><span>submonoid</span><span> </span><span class="delimiter">=</span><span> </span><span>monoid</span><span> </span><span>M</span><span> </span><span class="string"><span class="delete"><span class="delete">"(⋅)"</span></span></span><span> </span><span>𝟭</span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">for</span></span><span> </span><span>N</span><span> </span><span class="keyword2"><span class="keyword">and</span></span><span> </span><span>M</span><span> </span><span class="keyword2"><span class="keyword">and</span></span><span> </span><span>composition</span><span> </span><span class="delimiter">(</span><span class="keyword2"><span class="keyword">infixl</span></span><span> </span><span class="string"><span class="delete"><span class="delete">"⋅"</span></span></span><span> </span><span>70</span><span class="delimiter">)</span><span> </span><span class="keyword2"><span class="keyword">and</span></span><span> </span><span>unit</span><span> </span><span class="delimiter">(</span><span class="string"><span class="delete"><span class="delete">"𝟭"</span></span></span><span class="delimiter">)</span><span> </span><span class="delimiter">+</span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">assumes</span></span><span> </span><span>subset</span><span> </span><span class="delimiter">[</span><span>intro</span><span class="delimiter">,</span><span> </span><span>simp</span><span class="delimiter">]</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">"N ⊆ M"</span></span></span><span>
</span><span>    </span><span class="keyword2"><span class="keyword">and</span></span><span> </span><span>sub_composition_closed</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">"⟦ a ∈ N; b ∈ N ⟧ ⟹ a ⋅ b ∈ N"</span></span></span><span>
</span><span>    </span><span class="keyword2"><span class="keyword">and</span></span><span> </span><span>sub_unit_closed</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">"𝟭 ∈ N"</span></span></span><span>
</span><span class="keyword2"><span class="keyword">begin</span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹p 29, ll 27--28›</span></span></span><span>
</span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>sub</span><span> </span><span class="delimiter">[</span><span>intro</span><span class="delimiter">,</span><span> </span><span>simp</span><span class="delimiter">]</span><span class="delimiter">:</span><span>
</span><span>  </span><span class="string"><span class="delete"><span class="delete">"a ∈ N ⟹ a ∈ M"</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>subset</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>blast</span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹p 29, ll 32--33›</span></span></span><span>
</span><span class="keyword1"><span class="command">sublocale</span></span><span> </span><span>sub</span><span class="delimiter">:</span><span> </span><span>monoid</span><span> </span><span>N</span><span> </span><span class="string"><span class="delete"><span class="delete">"(⋅)"</span></span></span><span> </span><span>𝟭</span><span>
</span><span>  </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>unfold_locales</span><span> </span><span class="delimiter">(</span><span>auto</span><span> </span><span>simp</span><span class="delimiter">:</span><span> </span><span>sub_composition_closed</span><span> </span><span>sub_unit_closed</span><span class="delimiter">)</span><span>
</span><span>
</span><span class="keyword2"><span class="keyword">end</span></span><span> </span><span class="comment"><span class="delete"><span class="delete"><span class="delete"><span class="delete">(* submonoid *)</span></span></span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹p 29, ll 33--34›</span></span></span><span>
</span><span class="keyword1"><span class="command">theorem</span></span><span> </span><span>submonoid_transitive</span><span class="delimiter">:</span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">assumes</span></span><span> </span><span class="string"><span class="delete"><span class="delete">"submonoid K N composition unit"</span></span></span><span>
</span><span>    </span><span class="keyword2"><span class="keyword">and</span></span><span> </span><span class="string"><span class="delete"><span class="delete">"submonoid N M composition unit"</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">shows</span></span><span> </span><span class="string"><span class="delete"><span class="delete">"submonoid K M composition unit"</span></span></span><span>
</span><span class="keyword1"><span class="command">proof</span></span><span> </span><span>-</span><span>
</span><span>  </span><span class="keyword1"><span class="command">interpret</span></span><span> </span><span>K</span><span class="delimiter">:</span><span> </span><span>submonoid</span><span> </span><span>K</span><span> </span><span>N</span><span> </span><span>composition</span><span> </span><span>unit</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>fact</span><span>
</span><span>  </span><span class="keyword1"><span class="command">interpret</span></span><span> </span><span>M</span><span class="delimiter">:</span><span> </span><span>submonoid</span><span> </span><span>N</span><span> </span><span>M</span><span> </span><span>composition</span><span> </span><span>unit</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>fact</span><span>
</span><span>  </span><span class="keyword3"><span class="command">show</span></span><span> </span><span class="var">?thesis</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>unfold_locales</span><span> </span><span>auto</span><span>
</span><span class="keyword1"><span class="command">qed</span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹p 28, l 23›</span></span></span><span>
</span><span class="keyword1"><span class="command">locale</span></span><span> </span><span>transformations</span><span> </span><span class="delimiter">=</span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">fixes</span></span><span> </span><span>S</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">"'a set"</span></span></span><span>
</span><span>
</span><span class="comment"><span class="delete"><span class="delete"><span class="delete"><span class="delete">(*  assumes non_vacuous: "S ≠ {}" *)</span></span></span></span></span><span> </span><span class="comment"><span class="delete"><span class="delete"><span class="delete"><span class="delete">(* Jacobson requires this but we don't need it, strange. *)</span></span></span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹Monoid of all transformations›</span></span></span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹p 28, ll 23--24›</span></span></span><span>
</span><span class="keyword1"><span class="command">sublocale</span></span><span> </span><span>transformations</span><span> </span><span class="delimiter">⊆</span><span> </span><span>monoid</span><span> </span><span class="string"><span class="delete"><span class="delete">"S →<span class="hidden">⇩</span><sub>E</sub> S"</span></span></span><span> </span><span class="string"><span class="delete"><span class="delete">"compose S"</span></span></span><span> </span><span class="string"><span class="delete"><span class="delete">"identity S"</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>unfold_locales</span><span> </span><span class="delimiter">(</span><span>auto</span><span> </span><span>simp</span><span class="delimiter">:</span><span> </span><span>PiE_def</span><span> </span><span>compose_eq</span><span> </span><span>compose_assoc</span><span> </span><span>Id_compose</span><span> </span><span>compose_Id</span><span class="delimiter">)</span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹@{term N} is a monoid of transformations of the set @{term S}.›</span></span></span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹p 29, ll 34--36›</span></span></span><span>
</span><span class="keyword1"><span class="command">locale</span></span><span> </span><span>transformation_monoid</span><span> </span><span class="delimiter">=</span><span>
</span><span>  </span><span>transformations</span><span> </span><span>S</span><span> </span><span class="delimiter">+</span><span> </span><span>submonoid</span><span> </span><span>M</span><span> </span><span class="string"><span class="delete"><span class="delete">"S →<span class="hidden">⇩</span><sub>E</sub> S"</span></span></span><span> </span><span class="string"><span class="delete"><span class="delete">"compose S"</span></span></span><span> </span><span class="string"><span class="delete"><span class="delete">"identity S"</span></span></span><span> </span><span class="keyword2"><span class="keyword">for</span></span><span> </span><span>M</span><span> </span><span class="keyword2"><span class="keyword">and</span></span><span> </span><span>S</span><span>
</span><span class="keyword2"><span class="keyword">begin</span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹p 29, ll 34--36›</span></span></span><span>
</span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>transformation_closed</span><span> </span><span class="delimiter">[</span><span>intro</span><span class="delimiter">,</span><span> </span><span>simp</span><span class="delimiter">]</span><span class="delimiter">:</span><span>
</span><span>  </span><span class="string"><span class="delete"><span class="delete">"⟦ α ∈ M; x ∈ S ⟧ ⟹ α x ∈ S"</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>metis</span><span> </span><span>PiE_iff</span><span> </span><span>sub</span><span class="delimiter">)</span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹p 29, ll 34--36›</span></span></span><span>
</span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>transformation_undefined</span><span> </span><span class="delimiter">[</span><span>intro</span><span class="delimiter">,</span><span> </span><span>simp</span><span class="delimiter">]</span><span class="delimiter">:</span><span>
</span><span>  </span><span class="string"><span class="delete"><span class="delete">"⟦ α ∈ M; x ∉ S ⟧ ⟹ α x = undefined"</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>metis</span><span> </span><span>PiE_arb</span><span> </span><span>sub</span><span class="delimiter">)</span><span>
</span><span>
</span><span class="keyword2"><span class="keyword">end</span></span><span> </span><span class="comment"><span class="delete"><span class="delete"><span class="delete"><span class="delete">(* transformation_monoid *)</span></span></span></span></span><span>
</span><span>
</span><span>
</span><span class="keyword1"><span class="command">subsection</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹Groups of Transformations and Abstract Groups›</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">context</span></span><span> </span><span>monoid</span><span> </span><span class="keyword2"><span class="keyword">begin</span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹Invertible elements›</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹p 31, ll 3--5›</span></span></span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>invertible</span><span> </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">"u ∈ M ⟹ invertible u ⟷ (∃v ∈ M. u ⋅ v = 𝟭 ∧ v ⋅ u = 𝟭)"</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹p 31, ll 3--5›</span></span></span><span>
</span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>invertibleI</span><span> </span><span class="delimiter">[</span><span>intro</span><span class="delimiter">]</span><span class="delimiter">:</span><span>
</span><span>  </span><span class="string"><span class="delete"><span class="delete">"⟦ u ⋅ v = 𝟭; v ⋅ u = 𝟭; u ∈ M; v ∈ M ⟧ ⟹ invertible u"</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">unfolding</span></span><span> </span><span>invertible_def</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>fast</span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹p 31, ll 3--5›</span></span></span><span>
</span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>invertibleE</span><span> </span><span class="delimiter">[</span><span>elim</span><span class="delimiter">]</span><span class="delimiter">:</span><span>
</span><span>  </span><span class="string"><span class="delete"><span class="delete">"⟦ invertible u; ⋀v. ⟦ u ⋅ v = 𝟭 ∧ v ⋅ u = 𝟭; v ∈ M ⟧ ⟹ P; u ∈ M ⟧ ⟹ P"</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">unfolding</span></span><span> </span><span>invertible_def</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>fast</span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹p 31, ll 6--7›</span></span></span><span>
</span><span class="keyword1"><span class="command">theorem</span></span><span> </span><span>inverse_unique</span><span class="delimiter">:</span><span>
</span><span>  </span><span class="string"><span class="delete"><span class="delete">"⟦ u ⋅ v' = 𝟭; v ⋅ u = 𝟭; u ∈ M;  v ∈ M; v' ∈ M ⟧ ⟹ v = v'"</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>metis</span><span> </span><span>associative</span><span> </span><span>left_unit</span><span> </span><span>right_unit</span><span class="delimiter">)</span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹p 31, l 7›</span></span></span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>inverse</span><span> </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">"inverse = (λu ∈ M. THE v. v ∈ M ∧ u ⋅ v = 𝟭 ∧ v ⋅ u = 𝟭)"</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹p 31, l 7›</span></span></span><span>
</span><span class="keyword1"><span class="command">theorem</span></span><span> </span><span>inverse_equality</span><span class="delimiter">:</span><span>
</span><span>  </span><span class="string"><span class="delete"><span class="delete">"⟦ u ⋅ v = 𝟭; v ⋅ u = 𝟭; u ∈ M; v ∈ M ⟧ ⟹ inverse u = v"</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">unfolding</span></span><span> </span><span>inverse_def</span><span> </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>inverse_unique</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>simp</span><span> </span><span>blast</span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹p 31, l 7›</span></span></span><span>
</span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>invertible_inverse_closed</span><span> </span><span class="delimiter">[</span><span>intro</span><span class="delimiter">,</span><span> </span><span>simp</span><span class="delimiter">]</span><span class="delimiter">:</span><span>
</span><span>  </span><span class="string"><span class="delete"><span class="delete">"⟦ invertible u; u ∈ M ⟧ ⟹ inverse u ∈ M"</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>inverse_equality</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>auto</span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹p 31, l 7›</span></span></span><span>
</span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>inverse_undefined</span><span> </span><span class="delimiter">[</span><span>intro</span><span class="delimiter">,</span><span> </span><span>simp</span><span class="delimiter">]</span><span class="delimiter">:</span><span>
</span><span>  </span><span class="string"><span class="delete"><span class="delete">"u ∉ M ⟹ inverse u = undefined"</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>simp</span><span> </span><span>add</span><span class="delimiter">:</span><span> </span><span>inverse_def</span><span class="delimiter">)</span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹p 31, l 7›</span></span></span><span>
</span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>invertible_left_inverse</span><span> </span><span class="delimiter">[</span><span>simp</span><span class="delimiter">]</span><span class="delimiter">:</span><span>
</span><span>  </span><span class="string"><span class="delete"><span class="delete">"⟦ invertible u; u ∈ M ⟧ ⟹ inverse u ⋅ u = 𝟭"</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>inverse_equality</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>auto</span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹p 31, l 7›</span></span></span><span>
</span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>invertible_right_inverse</span><span> </span><span class="delimiter">[</span><span>simp</span><span class="delimiter">]</span><span class="delimiter">:</span><span>
</span><span>  </span><span class="string"><span class="delete"><span class="delete">"⟦ invertible u; u ∈ M ⟧ ⟹ u ⋅ inverse u = 𝟭"</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>inverse_equality</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>auto</span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹p 31, l 7›</span></span></span><span>
</span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>invertible_left_cancel</span><span> </span><span class="delimiter">[</span><span>simp</span><span class="delimiter">]</span><span class="delimiter">:</span><span>
</span><span>  </span><span class="string"><span class="delete"><span class="delete">"⟦ invertible x; x ∈ M; y ∈ M; z ∈ M ⟧ ⟹ x ⋅ y = x ⋅ z ⟷ y = z"</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>metis</span><span> </span><span>associative</span><span> </span><span>invertible_def</span><span> </span><span>left_unit</span><span class="delimiter">)</span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹p 31, l 7›</span></span></span><span>
</span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>invertible_right_cancel</span><span> </span><span class="delimiter">[</span><span>simp</span><span class="delimiter">]</span><span class="delimiter">:</span><span>
</span><span>  </span><span class="string"><span class="delete"><span class="delete">"⟦ invertible x; x ∈ M; y ∈ M; z ∈ M ⟧ ⟹ y ⋅ x = z ⋅ x ⟷ y = z"</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>metis</span><span> </span><span>associative</span><span> </span><span>invertible_def</span><span> </span><span>right_unit</span><span class="delimiter">)</span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹p 31, l 7›</span></span></span><span>
</span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>inverse_unit</span><span> </span><span class="delimiter">[</span><span>simp</span><span class="delimiter">]</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">"inverse 𝟭 = 𝟭"</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>inverse_equality</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>blast</span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹p 31, ll 7--8›</span></span></span><span>
</span><span class="keyword1"><span class="command">theorem</span></span><span> </span><span>invertible_inverse_invertible</span><span> </span><span class="delimiter">[</span><span>intro</span><span class="delimiter">,</span><span> </span><span>simp</span><span class="delimiter">]</span><span class="delimiter">:</span><span>
</span><span>  </span><span class="string"><span class="delete"><span class="delete">"⟦ invertible u; u ∈ M ⟧ ⟹ invertible (inverse u)"</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>invertible_left_inverse</span><span> </span><span>invertible_right_inverse</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>blast</span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹p 31, l 8›</span></span></span><span>
</span><span class="keyword1"><span class="command">theorem</span></span><span> </span><span>invertible_inverse_inverse</span><span> </span><span class="delimiter">[</span><span>simp</span><span class="delimiter">]</span><span class="delimiter">:</span><span>
</span><span>  </span><span class="string"><span class="delete"><span class="delete">"⟦ invertible u; u ∈ M ⟧ ⟹ inverse (inverse u) = u"</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>simp</span><span> </span><span>add</span><span class="delimiter">:</span><span> </span><span>inverse_equality</span><span class="delimiter">)</span><span>
</span><span>
</span><span class="keyword2"><span class="keyword">end</span></span><span> </span><span class="comment"><span class="delete"><span class="delete"><span class="delete"><span class="delete">(* monoid *)</span></span></span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">context</span></span><span> </span><span>submonoid</span><span> </span><span class="keyword2"><span class="keyword">begin</span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹Reasoning about @{term invertible} and @{term inverse} in submonoids.›</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹p 31, l 7›</span></span></span><span>
</span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>submonoid_invertible</span><span> </span><span class="delimiter">[</span><span>intro</span><span class="delimiter">,</span><span> </span><span>simp</span><span class="delimiter">]</span><span class="delimiter">:</span><span>
</span><span>  </span><span class="string"><span class="delete"><span class="delete">"⟦ sub.invertible u; u ∈ N ⟧ ⟹ invertible u"</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>invertibleI</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>blast</span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹p 31, l 7›</span></span></span><span>
</span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>submonoid_inverse_closed</span><span> </span><span class="delimiter">[</span><span>intro</span><span class="delimiter">,</span><span> </span><span>simp</span><span class="delimiter">]</span><span class="delimiter">:</span><span>
</span><span>  </span><span class="string"><span class="delete"><span class="delete">"⟦ sub.invertible u; u ∈ N ⟧ ⟹ inverse u ∈ N"</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>inverse_equality</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>auto</span><span>
</span><span>
</span><span class="keyword2"><span class="keyword">end</span></span><span> </span><span class="comment"><span class="delete"><span class="delete"><span class="delete"><span class="delete">(* submonoid *)</span></span></span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹Def 1.2›</span></span></span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹p 31, ll 9--10›</span></span></span><span>
</span><span class="keyword1"><span class="command">locale</span></span><span> </span><span>group</span><span> </span><span class="delimiter">=</span><span>
</span><span>  </span><span>monoid</span><span> </span><span>G</span><span> </span><span class="string"><span class="delete"><span class="delete">"(⋅)"</span></span></span><span> </span><span>𝟭</span><span> </span><span class="keyword2"><span class="keyword">for</span></span><span> </span><span>G</span><span> </span><span class="keyword2"><span class="keyword">and</span></span><span> </span><span>composition</span><span> </span><span class="delimiter">(</span><span class="keyword2"><span class="keyword">infixl</span></span><span> </span><span class="string"><span class="delete"><span class="delete">"⋅"</span></span></span><span> </span><span>70</span><span class="delimiter">)</span><span> </span><span class="keyword2"><span class="keyword">and</span></span><span> </span><span>unit</span><span> </span><span class="delimiter">(</span><span class="string"><span class="delete"><span class="delete">"𝟭"</span></span></span><span class="delimiter">)</span><span> </span><span class="delimiter">+</span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">assumes</span></span><span> </span><span>invertible</span><span> </span><span class="delimiter">[</span><span>simp</span><span class="delimiter">,</span><span> </span><span>intro</span><span class="delimiter">]</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">"u ∈ G ⟹ invertible u"</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹p 31, ll 11--12›</span></span></span><span>
</span><span class="keyword1"><span class="command">locale</span></span><span> </span><span>subgroup</span><span> </span><span class="delimiter">=</span><span> </span><span>submonoid</span><span> </span><span>G</span><span> </span><span>M</span><span> </span><span class="string"><span class="delete"><span class="delete">"(⋅)"</span></span></span><span> </span><span>𝟭</span><span> </span><span class="delimiter">+</span><span> </span><span>sub</span><span class="delimiter">:</span><span> </span><span>group</span><span> </span><span>G</span><span> </span><span class="string"><span class="delete"><span class="delete">"(⋅)"</span></span></span><span> </span><span>𝟭</span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">for</span></span><span> </span><span>G</span><span> </span><span class="keyword2"><span class="keyword">and</span></span><span> </span><span>M</span><span> </span><span class="keyword2"><span class="keyword">and</span></span><span> </span><span>composition</span><span> </span><span class="delimiter">(</span><span class="keyword2"><span class="keyword">infixl</span></span><span> </span><span class="string"><span class="delete"><span class="delete">"⋅"</span></span></span><span> </span><span>70</span><span class="delimiter">)</span><span> </span><span class="keyword2"><span class="keyword">and</span></span><span> </span><span>unit</span><span> </span><span class="delimiter">(</span><span class="string"><span class="delete"><span class="delete">"𝟭"</span></span></span><span class="delimiter">)</span><span>
</span><span class="keyword2"><span class="keyword">begin</span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹Reasoning about @{term invertible} and @{term inverse} in subgroups.›</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹p 31, ll 11--12›</span></span></span><span>
</span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>subgroup_inverse_equality</span><span> </span><span class="delimiter">[</span><span>simp</span><span class="delimiter">]</span><span class="delimiter">:</span><span>
</span><span>  </span><span class="string"><span class="delete"><span class="delete">"u ∈ G ⟹ inverse u = sub.inverse u"</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>simp</span><span> </span><span>add</span><span class="delimiter">:</span><span> </span><span>inverse_equality</span><span class="delimiter">)</span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹p 31, ll 11--12›</span></span></span><span>
</span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>subgroup_inverse_iff</span><span> </span><span class="delimiter">[</span><span>simp</span><span class="delimiter">]</span><span class="delimiter">:</span><span>
</span><span>  </span><span class="string"><span class="delete"><span class="delete">"⟦ invertible x; x ∈ M ⟧ ⟹ inverse x ∈ G ⟷ x ∈ G"</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>invertible_inverse_inverse</span><span> </span><span>sub.invertible_inverse_closed</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>fastforce</span><span>
</span><span>
</span><span class="keyword2"><span class="keyword">end</span></span><span> </span><span class="comment"><span class="delete"><span class="delete"><span class="delete"><span class="delete">(* subgroup *)</span></span></span></span></span><span>
</span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹p 31, ll 11--12›</span></span></span><span>
</span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>subgroup_transitive</span><span> </span><span class="delimiter">[</span><span>trans</span><span class="delimiter">]</span><span class="delimiter">:</span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">assumes</span></span><span> </span><span class="string"><span class="delete"><span class="delete">"subgroup K H composition unit"</span></span></span><span>
</span><span>    </span><span class="keyword2"><span class="keyword">and</span></span><span> </span><span class="string"><span class="delete"><span class="delete">"subgroup H G composition unit"</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">shows</span></span><span> </span><span class="string"><span class="delete"><span class="delete">"subgroup K G composition unit"</span></span></span><span>
</span><span class="keyword1"><span class="command">proof</span></span><span> </span><span>-</span><span>
</span><span>  </span><span class="keyword1"><span class="command">interpret</span></span><span> </span><span>K</span><span class="delimiter">:</span><span> </span><span>subgroup</span><span> </span><span>K</span><span> </span><span>H</span><span> </span><span>composition</span><span> </span><span>unit</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>fact</span><span>
</span><span>  </span><span class="keyword1"><span class="command">interpret</span></span><span> </span><span>H</span><span class="delimiter">:</span><span> </span><span>subgroup</span><span> </span><span>H</span><span> </span><span>G</span><span> </span><span>composition</span><span> </span><span>unit</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>fact</span><span>
</span><span>  </span><span class="keyword3"><span class="command">show</span></span><span> </span><span class="var">?thesis</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>unfold_locales</span><span> </span><span>auto</span><span>
</span><span class="keyword1"><span class="command">qed</span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">context</span></span><span> </span><span>monoid</span><span> </span><span class="keyword2"><span class="keyword">begin</span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹Jacobson states both directions, but the other one is trivial.›</span></span></span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹p 31, ll 12--15›</span></span></span><span>
</span><span class="keyword1"><span class="command">theorem</span></span><span> </span><span>subgroupI</span><span class="delimiter">:</span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">fixes</span></span><span> </span><span>G</span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">assumes</span></span><span> </span><span>subset</span><span> </span><span class="delimiter">[</span><span>THEN</span><span> </span><span>subsetD</span><span class="delimiter">,</span><span> </span><span>intro</span><span class="delimiter">]</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">"G ⊆ M"</span></span></span><span>
</span><span>    </span><span class="keyword2"><span class="keyword">and</span></span><span> </span><span class="delimiter">[</span><span>intro</span><span class="delimiter">]</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">"𝟭 ∈ G"</span></span></span><span>
</span><span>    </span><span class="keyword2"><span class="keyword">and</span></span><span> </span><span class="delimiter">[</span><span>intro</span><span class="delimiter">]</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">"⋀g h. ⟦ g ∈ G; h ∈ G ⟧ ⟹ g ⋅ h ∈ G"</span></span></span><span>
</span><span>    </span><span class="keyword2"><span class="keyword">and</span></span><span> </span><span class="delimiter">[</span><span>intro</span><span class="delimiter">]</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">"⋀g. g ∈ G ⟹ invertible g"</span></span></span><span>
</span><span>    </span><span class="keyword2"><span class="keyword">and</span></span><span> </span><span class="delimiter">[</span><span>intro</span><span class="delimiter">]</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">"⋀g. g ∈ G ⟹ inverse g ∈ G"</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">shows</span></span><span> </span><span class="string"><span class="delete"><span class="delete">"subgroup G M (⋅) 𝟭"</span></span></span><span>
</span><span class="keyword1"><span class="command">proof</span></span><span> </span><span>-</span><span>
</span><span>  </span><span class="keyword1"><span class="command">interpret</span></span><span> </span><span>sub</span><span class="delimiter">:</span><span> </span><span>monoid</span><span> </span><span>G</span><span> </span><span class="string"><span class="delete"><span class="delete">"(⋅)"</span></span></span><span> </span><span>𝟭</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>unfold_locales</span><span> </span><span>auto</span><span>
</span><span>  </span><span class="keyword3"><span class="command">show</span></span><span> </span><span class="var">?thesis</span><span>
</span><span>  </span><span class="keyword1"><span class="command">proof</span></span><span> </span><span>unfold_locales</span><span>
</span><span>    </span><span class="keyword3"><span class="command">fix</span></span><span> </span><span>u</span><span> </span><span class="keyword3"><span class="command">assume</span></span><span> </span><span class="delimiter">[</span><span>intro</span><span class="delimiter">]</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">"u ∈ G"</span></span></span><span> </span><span class="keyword3"><span class="command">show</span></span><span> </span><span class="string"><span class="delete"><span class="delete">"sub.invertible u"</span></span></span><span>
</span><span>    </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>invertible_left_inverse</span><span> </span><span>invertible_right_inverse</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>blast</span><span>
</span><span>  </span><span class="keyword1"><span class="command">qed</span></span><span> </span><span>auto</span><span>
</span><span class="keyword1"><span class="command">qed</span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹p 31, l 16›</span></span></span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span class="string"><span class="delete"><span class="delete">"Units = {u ∈ M. invertible u}"</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹p 31, l 16›</span></span></span><span>
</span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>mem_UnitsI</span><span class="delimiter">:</span><span>
</span><span>  </span><span class="string"><span class="delete"><span class="delete">"⟦ invertible u; u ∈ M ⟧ ⟹ u ∈ Units"</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">unfolding</span></span><span> </span><span>Units_def</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>clarify</span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹p 31, l 16›</span></span></span><span>
</span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>mem_UnitsD</span><span class="delimiter">:</span><span>
</span><span>  </span><span class="string"><span class="delete"><span class="delete">"⟦ u ∈ Units ⟧ ⟹ invertible u ∧ u ∈ M"</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">unfolding</span></span><span> </span><span>Units_def</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>clarify</span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹p 31, ll 16--21›</span></span></span><span>
</span><span class="keyword1"><span class="command">interpretation</span></span><span> </span><span>units</span><span class="delimiter">:</span><span> </span><span>subgroup</span><span> </span><span>Units</span><span> </span><span>M</span><span>
</span><span class="keyword1"><span class="command">proof</span></span><span> </span><span class="delimiter">(</span><span>rule</span><span> </span><span>subgroupI</span><span class="delimiter">)</span><span>
</span><span>  </span><span class="keyword3"><span class="command">fix</span></span><span> </span><span>u1</span><span> </span><span>u2</span><span>
</span><span>  </span><span class="keyword3"><span class="command">assume</span></span><span> </span><span>Units</span><span> </span><span class="delimiter">[</span><span>THEN</span><span> </span><span>mem_UnitsD</span><span class="delimiter">,</span><span> </span><span>simp</span><span class="delimiter">]</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">"u1 ∈ Units"</span></span></span><span> </span><span class="string"><span class="delete"><span class="delete">"u2 ∈ Units"</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">have</span></span><span> </span><span class="string"><span class="delete"><span class="delete">"(u1 ⋅ u2) ⋅ (inverse u2 ⋅ inverse u1) = (u1 ⋅ (u2 ⋅ inverse u2)) ⋅ inverse u1"</span></span></span><span>
</span><span>    </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>simp</span><span> </span><span>add</span><span class="delimiter">:</span><span> </span><span>associative</span><span> </span><span>del</span><span class="delimiter">:</span><span> </span><span>invertible_left_inverse</span><span> </span><span>invertible_right_inverse</span><span class="delimiter">)</span><span>
</span><span>  </span><span class="keyword1"><span class="command">also</span></span><span> </span><span class="keyword1"><span class="command">have</span></span><span> </span><span class="string"><span class="delete"><span class="delete">"… = 𝟭"</span></span></span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>simp</span><span>
</span><span>  </span><span class="keyword1"><span class="command">finally</span></span><span> </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>inv1</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">"(u1 ⋅ u2) ⋅ (inverse u2 ⋅ inverse u1) = 𝟭"</span></span></span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>simp</span><span>  </span><span class="comment">― ‹ll 16--18›</span><span>
</span><span>  </span><span class="keyword1"><span class="command">have</span></span><span> </span><span class="string"><span class="delete"><span class="delete">"(inverse u2 ⋅ inverse u1) ⋅ (u1 ⋅ u2) = (inverse u2 ⋅ (inverse u1 ⋅ u1)) ⋅ u2"</span></span></span><span>
</span><span>    </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>simp</span><span> </span><span>add</span><span class="delimiter">:</span><span> </span><span>associative</span><span> </span><span>del</span><span class="delimiter">:</span><span> </span><span>invertible_left_inverse</span><span> </span><span>invertible_right_inverse</span><span class="delimiter">)</span><span>
</span><span>  </span><span class="keyword1"><span class="command">also</span></span><span> </span><span class="keyword1"><span class="command">have</span></span><span> </span><span class="string"><span class="delete"><span class="delete">"… = 𝟭"</span></span></span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>simp</span><span>
</span><span>  </span><span class="keyword1"><span class="command">finally</span></span><span> </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>inv2</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">"(inverse u2 ⋅ inverse u1) ⋅ (u1 ⋅ u2) = 𝟭"</span></span></span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>simp</span><span>  </span><span class="comment">― ‹l 9, “and similarly”›</span><span>
</span><span>  </span><span class="keyword3"><span class="command">show</span></span><span> </span><span class="string"><span class="delete"><span class="delete">"u1 ⋅ u2 ∈ Units"</span></span></span><span> </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>inv1</span><span> </span><span>inv2</span><span> </span><span>invertibleI</span><span> </span><span>mem_UnitsI</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>auto</span><span>
</span><span class="keyword1"><span class="command">qed</span></span><span> </span><span class="delimiter">(</span><span>auto</span><span> </span><span>simp</span><span class="delimiter">:</span><span> </span><span>Units_def</span><span class="delimiter">)</span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹p 31, ll 21--22›</span></span></span><span>
</span><span class="keyword1"><span class="command">theorem</span></span><span> </span><span>group_of_Units</span><span> </span><span class="delimiter">[</span><span>intro</span><span class="delimiter">,</span><span> </span><span>simp</span><span class="delimiter">]</span><span class="delimiter">:</span><span>
</span><span>  </span><span class="string"><span class="delete"><span class="delete">"group Units (⋅) 𝟭"</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">..</span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹p 31, l 19›</span></span></span><span>
</span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>composition_invertible</span><span> </span><span class="delimiter">[</span><span>simp</span><span class="delimiter">,</span><span> </span><span>intro</span><span class="delimiter">]</span><span class="delimiter">:</span><span>
</span><span>  </span><span class="string"><span class="delete"><span class="delete">"⟦ invertible x; invertible y; x ∈ M; y ∈ M ⟧ ⟹ invertible (x ⋅ y)"</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>mem_UnitsD</span><span> </span><span>mem_UnitsI</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>blast</span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹p 31, l 20›</span></span></span><span>
</span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>unit_invertible</span><span class="delimiter">:</span><span>
</span><span>  </span><span class="string"><span class="delete"><span class="delete">"invertible 𝟭"</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>fast</span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹Useful simplification rules›</span></span></span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹p 31, l 22›</span></span></span><span>
</span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>invertible_right_inverse2</span><span class="delimiter">:</span><span>
</span><span>  </span><span class="string"><span class="delete"><span class="delete">"⟦ invertible u; u ∈ M; v ∈ M ⟧ ⟹ u ⋅ (inverse u ⋅ v) = v"</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>simp</span><span> </span><span>add</span><span class="delimiter">:</span><span> </span><span>associative</span><span> </span><span class="delimiter">[</span><span>THEN</span><span> </span><span>sym</span><span class="delimiter">]</span><span class="delimiter">)</span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹p 31, l 22›</span></span></span><span>
</span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>invertible_left_inverse2</span><span class="delimiter">:</span><span>
</span><span>  </span><span class="string"><span class="delete"><span class="delete">"⟦ invertible u; u ∈ M; v ∈ M ⟧ ⟹ inverse u ⋅ (u ⋅ v) = v"</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>simp</span><span> </span><span>add</span><span class="delimiter">:</span><span> </span><span>associative</span><span> </span><span class="delimiter">[</span><span>THEN</span><span> </span><span>sym</span><span class="delimiter">]</span><span class="delimiter">)</span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹p 31, l 22›</span></span></span><span>
</span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>inverse_composition_commute</span><span class="delimiter">:</span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">assumes</span></span><span> </span><span class="delimiter">[</span><span>simp</span><span class="delimiter">]</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">"invertible x"</span></span></span><span> </span><span class="string"><span class="delete"><span class="delete">"invertible y"</span></span></span><span> </span><span class="string"><span class="delete"><span class="delete">"x ∈ M"</span></span></span><span> </span><span class="string"><span class="delete"><span class="delete">"y ∈ M"</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">shows</span></span><span> </span><span class="string"><span class="delete"><span class="delete">"inverse (x ⋅ y) = inverse y ⋅ inverse x"</span></span></span><span>
</span><span class="keyword1"><span class="command">proof</span></span><span> </span><span>-</span><span>
</span><span>  </span><span class="keyword1"><span class="command">have</span></span><span> </span><span class="string"><span class="delete"><span class="delete">"inverse (x ⋅ y) ⋅ (x ⋅ y) = (inverse y ⋅ inverse x) ⋅ (x ⋅ y)"</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>simp</span><span> </span><span>add</span><span class="delimiter">:</span><span> </span><span>invertible_left_inverse2</span><span> </span><span>associative</span><span class="delimiter">)</span><span>
</span><span>  </span><span class="keyword1"><span class="command">then</span></span><span> </span><span class="keyword3"><span class="command">show</span></span><span> </span><span class="var">?thesis</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>simp</span><span> </span><span>del</span><span class="delimiter">:</span><span> </span><span>invertible_left_inverse</span><span class="delimiter">)</span><span>
</span><span class="keyword1"><span class="command">qed</span></span><span>
</span><span>
</span><span class="keyword2"><span class="keyword">end</span></span><span> </span><span class="comment"><span class="delete"><span class="delete"><span class="delete"><span class="delete">(* monoid *)</span></span></span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹p 31, l 24›</span></span></span><span>
</span><span class="keyword1"><span class="command">context</span></span><span> </span><span>transformations</span><span> </span><span class="keyword2"><span class="keyword">begin</span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹p 31, ll 25--26›</span></span></span><span>
</span><span class="keyword1"><span class="command">theorem</span></span><span> </span><span>invertible_is_bijective</span><span class="delimiter">:</span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">assumes</span></span><span> </span><span>dom</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">"α ∈ S →<span class="hidden">⇩</span><sub>E</sub> S"</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">shows</span></span><span> </span><span class="string"><span class="delete"><span class="delete">"invertible α ⟷ bij_betw α S S"</span></span></span><span>
</span><span class="keyword1"><span class="command">proof</span></span><span> </span><span>-</span><span>
</span><span>  </span><span class="keyword1"><span class="command">from</span></span><span> </span><span>dom</span><span> </span><span class="keyword1"><span class="command">interpret</span></span><span> </span><span>map</span><span> </span><span>α</span><span> </span><span>S</span><span> </span><span>S</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>unfold_locales</span><span>
</span><span>  </span><span class="keyword3"><span class="command">show</span></span><span> </span><span class="var">?thesis</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>auto</span><span> </span><span>simp</span><span> </span><span>add</span><span class="delimiter">:</span><span> </span><span>bij_betw_iff_has_inverse</span><span> </span><span>invertible_def</span><span class="delimiter">)</span><span>
</span><span class="keyword1"><span class="command">qed</span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹p 31, ll 26--27›</span></span></span><span>
</span><span class="keyword1"><span class="command">theorem</span></span><span> </span><span>Units_bijective</span><span class="delimiter">:</span><span>
</span><span>  </span><span class="string"><span class="delete"><span class="delete">"Units = {α ∈ S →<span class="hidden">⇩</span><sub>E</sub> S. bij_betw α S S}"</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">unfolding</span></span><span> </span><span>Units_def</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>auto</span><span> </span><span>simp</span><span> </span><span>add</span><span class="delimiter">:</span><span> </span><span>invertible_is_bijective</span><span class="delimiter">)</span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹p 31, ll 26--27›</span></span></span><span>
</span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>Units_bij_betwI</span><span> </span><span class="delimiter">[</span><span>intro</span><span class="delimiter">,</span><span> </span><span>simp</span><span class="delimiter">]</span><span class="delimiter">:</span><span>
</span><span>  </span><span class="string"><span class="delete"><span class="delete">"α ∈ Units ⟹ bij_betw α S S"</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>simp</span><span> </span><span>add</span><span class="delimiter">:</span><span> </span><span>Units_bijective</span><span class="delimiter">)</span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹p 31, ll 26--27›</span></span></span><span>
</span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>Units_bij_betwD</span><span> </span><span class="delimiter">[</span><span>dest</span><span class="delimiter">,</span><span> </span><span>simp</span><span class="delimiter">]</span><span class="delimiter">:</span><span>
</span><span>  </span><span class="string"><span class="delete"><span class="delete">"⟦ α ∈ S →<span class="hidden">⇩</span><sub>E</sub> S; bij_betw α S S ⟧ ⟹ α ∈ Units"</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">unfolding</span></span><span> </span><span>Units_bijective</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>simp</span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹p 31, ll 28--29›</span></span></span><span>
</span><span class="keyword1"><span class="command">abbreviation</span></span><span> </span><span class="string"><span class="delete"><span class="delete">"Sym ≡ Units"</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹p 31, ll 26--28›</span></span></span><span>
</span><span class="keyword1"><span class="command">sublocale</span></span><span> </span><span>symmetric</span><span class="delimiter">:</span><span> </span><span>group</span><span> </span><span class="string"><span class="delete"><span class="delete">"Sym"</span></span></span><span> </span><span class="string"><span class="delete"><span class="delete">"compose S"</span></span></span><span> </span><span class="string"><span class="delete"><span class="delete">"identity S"</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>fact</span><span> </span><span>group_of_Units</span><span class="delimiter">)</span><span>
</span><span>
</span><span class="keyword2"><span class="keyword">end</span></span><span> </span><span class="comment"><span class="delete"><span class="delete"><span class="delete"><span class="delete">(* transformations *)</span></span></span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹p 32, ll 18--19›</span></span></span><span>
</span><span class="keyword1"><span class="command">locale</span></span><span> </span><span>transformation_group</span><span> </span><span class="delimiter">=</span><span>
</span><span>  </span><span>transformations</span><span> </span><span>S</span><span> </span><span class="delimiter">+</span><span> </span><span>symmetric</span><span class="delimiter">:</span><span> </span><span>subgroup</span><span> </span><span>G</span><span> </span><span>Sym</span><span> </span><span class="string"><span class="delete"><span class="delete">"compose S"</span></span></span><span> </span><span class="string"><span class="delete"><span class="delete">"identity S"</span></span></span><span> </span><span class="keyword2"><span class="keyword">for</span></span><span> </span><span>G</span><span> </span><span class="keyword2"><span class="keyword">and</span></span><span> </span><span>S</span><span>
</span><span class="keyword2"><span class="keyword">begin</span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹p 32, ll 18--19›</span></span></span><span>
</span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>transformation_group_closed</span><span> </span><span class="delimiter">[</span><span>intro</span><span class="delimiter">,</span><span> </span><span>simp</span><span class="delimiter">]</span><span class="delimiter">:</span><span>
</span><span>  </span><span class="string"><span class="delete"><span class="delete">"⟦ α ∈ G; x ∈ S ⟧ ⟹ α x ∈ S"</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>bij_betwE</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>blast</span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹p 32, ll 18--19›</span></span></span><span>
</span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>transformation_group_undefined</span><span> </span><span class="delimiter">[</span><span>intro</span><span class="delimiter">,</span><span> </span><span>simp</span><span class="delimiter">]</span><span class="delimiter">:</span><span>
</span><span>  </span><span class="string"><span class="delete"><span class="delete">"⟦ α ∈ G; x ∉ S ⟧ ⟹ α x = undefined"</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>metis</span><span> </span><span>compose_def</span><span> </span><span>symmetric.sub.right_unit</span><span> </span><span>restrict_apply</span><span class="delimiter">)</span><span>
</span><span>
</span><span class="keyword2"><span class="keyword">end</span></span><span> </span><span class="comment"><span class="delete"><span class="delete"><span class="delete"><span class="delete">(* transformation_group *)</span></span></span></span></span><span>
</span><span>
</span><span>
</span><span class="keyword1"><span class="command">subsection</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹Isomorphisms.  Cayley's Theorem›</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹Def 1.3›</span></span></span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹p 37, ll 7--11›</span></span></span><span>
</span><span class="keyword1"><span class="command">locale</span></span><span> </span><span>monoid_isomorphism</span><span> </span><span class="delimiter">=</span><span>
</span><span>  </span><span>bijective_map</span><span> </span><span>η</span><span> </span><span>M</span><span> </span><span>M'</span><span> </span><span class="delimiter">+</span><span>  </span><span>source</span><span class="delimiter">:</span><span> </span><span>monoid</span><span> </span><span>M</span><span> </span><span class="string"><span class="delete"><span class="delete">"(⋅)"</span></span></span><span> </span><span>𝟭</span><span> </span><span class="delimiter">+</span><span> </span><span>target</span><span class="delimiter">:</span><span> </span><span>monoid</span><span> </span><span>M'</span><span> </span><span class="string"><span class="delete"><span class="delete">"(⋅')"</span></span></span><span> </span><span class="string"><span class="delete"><span class="delete">"𝟭'"</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">for</span></span><span> </span><span>η</span><span> </span><span class="keyword2"><span class="keyword">and</span></span><span> </span><span>M</span><span> </span><span class="keyword2"><span class="keyword">and</span></span><span> </span><span>composition</span><span> </span><span class="delimiter">(</span><span class="keyword2"><span class="keyword">infixl</span></span><span> </span><span class="string"><span class="delete"><span class="delete">"⋅"</span></span></span><span> </span><span>70</span><span class="delimiter">)</span><span> </span><span class="keyword2"><span class="keyword">and</span></span><span> </span><span>unit</span><span> </span><span class="delimiter">(</span><span class="string"><span class="delete"><span class="delete">"𝟭"</span></span></span><span class="delimiter">)</span><span>
</span><span>    </span><span class="keyword2"><span class="keyword">and</span></span><span> </span><span>M'</span><span> </span><span class="keyword2"><span class="keyword">and</span></span><span> </span><span>composition'</span><span> </span><span class="delimiter">(</span><span class="keyword2"><span class="keyword">infixl</span></span><span> </span><span class="string"><span class="delete"><span class="delete">"⋅''"</span></span></span><span> </span><span>70</span><span class="delimiter">)</span><span> </span><span class="keyword2"><span class="keyword">and</span></span><span> </span><span>unit'</span><span> </span><span class="delimiter">(</span><span class="string"><span class="delete"><span class="delete">"𝟭''"</span></span></span><span class="delimiter">)</span><span> </span><span class="delimiter">+</span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">assumes</span></span><span> </span><span>commutes_with_composition</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">"⟦ x ∈ M; y ∈ M ⟧ ⟹ η x ⋅' η y = η (x ⋅ y)"</span></span></span><span>
</span><span>    </span><span class="keyword2"><span class="keyword">and</span></span><span> </span><span>commutes_with_unit</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">"η 𝟭 = 𝟭'"</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹p 37, l 10›</span></span></span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>isomorphic_as_monoids</span><span> </span><span class="delimiter">(</span><span class="keyword2"><span class="keyword">infixl</span></span><span> </span><span class="string"><span class="delete"><span class="delete">"≅<span class="hidden">⇩</span><sub>M</sub>"</span></span></span><span> </span><span>50</span><span class="delimiter">)</span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">"ℳ ≅<span class="hidden">⇩</span><sub>M</sub> ℳ' ⟷ (let (M, composition, unit) = ℳ; (M', composition', unit') = ℳ' in
  (∃η. monoid_isomorphism η M composition unit M' composition' unit'))"</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹p 37, ll 11--12›</span></span></span><span>
</span><span class="keyword1"><span class="command">locale</span></span><span> </span><span>monoid_isomorphism'</span><span> </span><span class="delimiter">=</span><span>
</span><span>  </span><span>bijective_map</span><span> </span><span>η</span><span> </span><span>M</span><span> </span><span>M'</span><span> </span><span class="delimiter">+</span><span>  </span><span>source</span><span class="delimiter">:</span><span> </span><span>monoid</span><span> </span><span>M</span><span> </span><span class="string"><span class="delete"><span class="delete">"(⋅)"</span></span></span><span> </span><span>𝟭</span><span> </span><span class="delimiter">+</span><span> </span><span>target</span><span class="delimiter">:</span><span> </span><span>monoid</span><span> </span><span>M'</span><span> </span><span class="string"><span class="delete"><span class="delete">"(⋅')"</span></span></span><span> </span><span class="string"><span class="delete"><span class="delete">"𝟭'"</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">for</span></span><span> </span><span>η</span><span> </span><span class="keyword2"><span class="keyword">and</span></span><span> </span><span>M</span><span> </span><span class="keyword2"><span class="keyword">and</span></span><span> </span><span>composition</span><span> </span><span class="delimiter">(</span><span class="keyword2"><span class="keyword">infixl</span></span><span> </span><span class="string"><span class="delete"><span class="delete">"⋅"</span></span></span><span> </span><span>70</span><span class="delimiter">)</span><span> </span><span class="keyword2"><span class="keyword">and</span></span><span> </span><span>unit</span><span> </span><span class="delimiter">(</span><span class="string"><span class="delete"><span class="delete">"𝟭"</span></span></span><span class="delimiter">)</span><span>
</span><span>    </span><span class="keyword2"><span class="keyword">and</span></span><span> </span><span>M'</span><span> </span><span class="keyword2"><span class="keyword">and</span></span><span> </span><span>composition'</span><span> </span><span class="delimiter">(</span><span class="keyword2"><span class="keyword">infixl</span></span><span> </span><span class="string"><span class="delete"><span class="delete">"⋅''"</span></span></span><span> </span><span>70</span><span class="delimiter">)</span><span> </span><span class="keyword2"><span class="keyword">and</span></span><span> </span><span>unit'</span><span> </span><span class="delimiter">(</span><span class="string"><span class="delete"><span class="delete">"𝟭''"</span></span></span><span class="delimiter">)</span><span> </span><span class="delimiter">+</span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">assumes</span></span><span> </span><span>commutes_with_composition</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">"⟦ x ∈ M; y ∈ M ⟧ ⟹ η x ⋅' η y = η (x ⋅ y)"</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹p 37, ll 11--12›</span></span></span><span>
</span><span class="keyword1"><span class="command">sublocale</span></span><span> </span><span>monoid_isomorphism</span><span> </span><span class="delimiter">⊆</span><span> </span><span>monoid_isomorphism'</span><span>
</span><span>  </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>unfold_locales</span><span> </span><span class="delimiter">(</span><span>simp</span><span> </span><span>add</span><span class="delimiter">:</span><span> </span><span>commutes_with_composition</span><span class="delimiter">)</span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹Both definitions are equivalent.›</span></span></span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹p 37, ll 12--15›</span></span></span><span>
</span><span class="keyword1"><span class="command">sublocale</span></span><span> </span><span>monoid_isomorphism'</span><span> </span><span class="delimiter">⊆</span><span> </span><span>monoid_isomorphism</span><span>
</span><span class="keyword1"><span class="command">proof</span></span><span> </span><span>unfold_locales</span><span>
</span><span>  </span><span class="keyword1"><span class="command">{</span></span><span>
</span><span>    </span><span class="keyword3"><span class="command">fix</span></span><span> </span><span>y</span><span> </span><span class="keyword3"><span class="command">assume</span></span><span> </span><span class="string"><span class="delete"><span class="delete">"y ∈ M'"</span></span></span><span>
</span><span>    </span><span class="keyword1"><span class="command">then</span></span><span> </span><span class="keyword3"><span class="command">obtain</span></span><span> </span><span>x</span><span> </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">"η x = y"</span></span></span><span> </span><span class="string"><span class="delete"><span class="delete">"x ∈ M"</span></span></span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>metis</span><span> </span><span>image_iff</span><span> </span><span>surjective</span><span class="delimiter">)</span><span>
</span><span>    </span><span class="keyword1"><span class="command">then</span></span><span> </span><span class="keyword1"><span class="command">have</span></span><span> </span><span class="string"><span class="delete"><span class="delete">"y ⋅' η 𝟭 = y"</span></span></span><span> </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>commutes_with_composition</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>auto</span><span>
</span><span>  </span><span class="keyword1"><span class="command">}</span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">then</span></span><span> </span><span class="keyword3"><span class="command">show</span></span><span> </span><span class="string"><span class="delete"><span class="delete">"η 𝟭 = 𝟭'"</span></span></span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>fastforce</span><span>
</span><span class="keyword1"><span class="command">qed</span></span><span> </span><span class="delimiter">(</span><span>simp</span><span> </span><span>add</span><span class="delimiter">:</span><span> </span><span>commutes_with_composition</span><span class="delimiter">)</span><span>
</span><span>
</span><span class="keyword1"><span class="command">context</span></span><span> </span><span>monoid_isomorphism</span><span> </span><span class="keyword2"><span class="keyword">begin</span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹p 37, ll 30--33›</span></span></span><span>
</span><span class="keyword1"><span class="command">theorem</span></span><span> </span><span>inverse_monoid_isomorphism</span><span class="delimiter">:</span><span>
</span><span>  </span><span class="string"><span class="delete"><span class="delete">"monoid_isomorphism (restrict (inv_into M η) M') M' (⋅') 𝟭' M (⋅) 𝟭"</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>commutes_with_composition</span><span> </span><span>commutes_with_unit</span><span> </span><span>surjective</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>unfold_locales</span><span> </span><span>auto</span><span>
</span><span>
</span><span class="keyword2"><span class="keyword">end</span></span><span> </span><span class="comment"><span class="delete"><span class="delete"><span class="delete"><span class="delete">(* monoid_isomorphism *)</span></span></span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹We only need that @{term η} is symmetric.›</span></span></span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹p 37, ll 28--29›</span></span></span><span>
</span><span class="keyword1"><span class="command">theorem</span></span><span> </span><span>isomorphic_as_monoids_symmetric</span><span class="delimiter">:</span><span>
</span><span>  </span><span class="string"><span class="delete"><span class="delete">"(M, composition, unit) ≅<span class="hidden">⇩</span><sub>M</sub> (M', composition', unit') ⟹ (M', composition', unit') ≅<span class="hidden">⇩</span><sub>M</sub> (M, composition, unit)"</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>simp</span><span> </span><span>add</span><span class="delimiter">:</span><span> </span><span>isomorphic_as_monoids_def</span><span class="delimiter">)</span><span> </span><span class="delimiter">(</span><span>meson</span><span> </span><span>monoid_isomorphism.inverse_monoid_isomorphism</span><span class="delimiter">)</span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹p 38, l 4›</span></span></span><span>
</span><span class="keyword1"><span class="command">locale</span></span><span> </span><span>left_translations_of_monoid</span><span> </span><span class="delimiter">=</span><span> </span><span>monoid</span><span> </span><span class="keyword2"><span class="keyword">begin</span></span><span>
</span><span>
</span><span class="comment"><span class="delete"><span class="delete"><span class="delete"><span class="delete">(*
  We take the liberty of omitting "left_" from the name of the translation operation.  The derived
  transformation monoid and group won't be qualified with "left" either.  This avoids qualifications
  such as "left.left_...".  In contexts where left and right translations are used simultaneously,
  notably subgroup_of_group, qualifiers are needed.
*)</span></span></span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹p 38, ll 5--7›</span></span></span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>translation</span><span> </span><span class="delimiter">(</span><span class="string"><span class="delete"><span class="delete">"'(_')<span class="hidden">⇩</span><sub>L</sub>"</span></span></span><span class="delimiter">)</span><span> </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">"translation = (λa ∈ M. λx ∈ M. a ⋅ x)"</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹p 38, ll 5--7›</span></span></span><span>
</span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>translation_map</span><span> </span><span class="delimiter">[</span><span>intro</span><span class="delimiter">,</span><span> </span><span>simp</span><span class="delimiter">]</span><span class="delimiter">:</span><span>
</span><span>  </span><span class="string"><span class="delete"><span class="delete">"a ∈ M ⟹ (a)<span class="hidden">⇩</span><sub>L</sub> ∈ M →<span class="hidden">⇩</span><sub>E</sub> M"</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">unfolding</span></span><span> </span><span>translation_def</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>simp</span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹p 38, ll 5--7›</span></span></span><span>
</span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>Translations_maps</span><span> </span><span class="delimiter">[</span><span>intro</span><span class="delimiter">,</span><span> </span><span>simp</span><span class="delimiter">]</span><span class="delimiter">:</span><span>
</span><span>  </span><span class="string"><span class="delete"><span class="delete">"translation ` M ⊆ M →<span class="hidden">⇩</span><sub>E</sub> M"</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>simp</span><span> </span><span>add</span><span class="delimiter">:</span><span> </span><span>image_subsetI</span><span class="delimiter">)</span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹p 38, ll 5--7›</span></span></span><span>
</span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>translation_apply</span><span class="delimiter">:</span><span>
</span><span>  </span><span class="string"><span class="delete"><span class="delete">"⟦ a ∈ M; b ∈ M ⟧ ⟹ (a)<span class="hidden">⇩</span><sub>L</sub> b = a ⋅ b"</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">unfolding</span></span><span> </span><span>translation_def</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>auto</span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹p 38, ll 5--7›</span></span></span><span>
</span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>translation_exist</span><span class="delimiter">:</span><span>
</span><span>  </span><span class="string"><span class="delete"><span class="delete">"f ∈ translation ` M ⟹ ∃a ∈ M. f = (a)<span class="hidden">⇩</span><sub>L</sub>"</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>auto</span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹p 38, ll 5--7›</span></span></span><span>
</span><span class="keyword1"><span class="command">lemmas</span></span><span> </span><span>Translations_E</span><span> </span><span class="delimiter">[</span><span>elim</span><span class="delimiter">]</span><span> </span><span class="delimiter">=</span><span> </span><span>translation_exist</span><span> </span><span class="delimiter">[</span><span>THEN</span><span> </span><span>bexE</span><span class="delimiter">]</span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹p 38, l 10›</span></span></span><span>
</span><span class="keyword1"><span class="command">theorem</span></span><span> </span><span>translation_unit_eq</span><span> </span><span class="delimiter">[</span><span>simp</span><span class="delimiter">]</span><span class="delimiter">:</span><span>
</span><span>  </span><span class="string"><span class="delete"><span class="delete">"identity M = (𝟭)<span class="hidden">⇩</span><sub>L</sub>"</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">unfolding</span></span><span> </span><span>translation_def</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>auto</span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹p 38, ll 10--11›</span></span></span><span>
</span><span class="keyword1"><span class="command">theorem</span></span><span> </span><span>translation_composition_eq</span><span> </span><span class="delimiter">[</span><span>simp</span><span class="delimiter">]</span><span class="delimiter">:</span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">assumes</span></span><span> </span><span class="delimiter">[</span><span>simp</span><span class="delimiter">]</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">"a ∈ M"</span></span></span><span> </span><span class="string"><span class="delete"><span class="delete">"b ∈ M"</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">shows</span></span><span> </span><span class="string"><span class="delete"><span class="delete">"compose M (a)<span class="hidden">⇩</span><sub>L</sub> (b)<span class="hidden">⇩</span><sub>L</sub> = (a ⋅ b)<span class="hidden">⇩</span><sub>L</sub>"</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">unfolding</span></span><span> </span><span>translation_def</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>rule</span><span> </span><span class="delimiter">(</span><span>simp</span><span> </span><span>add</span><span class="delimiter">:</span><span> </span><span>associative</span><span> </span><span>compose_def</span><span class="delimiter">)</span><span>
</span><span>
</span><span class="comment"><span class="delete"><span class="delete"><span class="delete"><span class="delete">(* Activate @{locale monoid} to simplify subsequent proof. *)</span></span></span></span></span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹p 38, ll 7--9›</span></span></span><span>
</span><span class="keyword1"><span class="command">sublocale</span></span><span> </span><span>transformation</span><span class="delimiter">:</span><span> </span><span>transformations</span><span> </span><span>M</span><span> </span><span class="keyword1"><span class="command">.</span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹p 38, ll 7--9›</span></span></span><span>
</span><span class="keyword1"><span class="command">theorem</span></span><span> </span><span>Translations_transformation_monoid</span><span class="delimiter">:</span><span>
</span><span>  </span><span class="string"><span class="delete"><span class="delete">"transformation_monoid (translation ` M) M"</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>unfold_locales</span><span> </span><span>auto</span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹p 38, ll 7--9›</span></span></span><span>
</span><span class="keyword1"><span class="command">sublocale</span></span><span> </span><span>transformation</span><span class="delimiter">:</span><span> </span><span>transformation_monoid</span><span> </span><span class="string"><span class="delete"><span class="delete">"translation ` M"</span></span></span><span> </span><span>M</span><span>
</span><span>  </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>fact</span><span> </span><span>Translations_transformation_monoid</span><span class="delimiter">)</span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹p 38, l 12›</span></span></span><span>
</span><span class="keyword1"><span class="command">sublocale</span></span><span> </span><span>map</span><span> </span><span>translation</span><span> </span><span>M</span><span> </span><span class="string"><span class="delete"><span class="delete">"translation ` M"</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>unfold_locales</span><span> </span><span class="delimiter">(</span><span>simp</span><span> </span><span>add</span><span class="delimiter">:</span><span> </span><span>translation_def</span><span class="delimiter">)</span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹p 38, ll 12--16›</span></span></span><span>
</span><span class="keyword1"><span class="command">theorem</span></span><span> </span><span>translation_isomorphism</span><span> </span><span class="delimiter">[</span><span>intro</span><span class="delimiter">]</span><span class="delimiter">:</span><span>
</span><span>  </span><span class="string"><span class="delete"><span class="delete">"monoid_isomorphism translation M (⋅) 𝟭 (translation ` M) (compose M) (identity M)"</span></span></span><span>
</span><span class="keyword1"><span class="command">proof</span></span><span> </span><span>unfold_locales</span><span>
</span><span>  </span><span class="keyword1"><span class="command">have</span></span><span> </span><span class="string"><span class="delete"><span class="delete">"inj_on translation M"</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">proof</span></span><span> </span><span class="delimiter">(</span><span>rule</span><span> </span><span>inj_onI</span><span class="delimiter">)</span><span>
</span><span>    </span><span class="keyword3"><span class="command">fix</span></span><span> </span><span>a</span><span> </span><span>b</span><span>
</span><span>    </span><span class="keyword3"><span class="command">assume</span></span><span> </span><span class="delimiter">[</span><span>simp</span><span class="delimiter">]</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">"a ∈ M"</span></span></span><span> </span><span class="string"><span class="delete"><span class="delete">"b ∈ M"</span></span></span><span> </span><span class="string"><span class="delete"><span class="delete">"(a)<span class="hidden">⇩</span><sub>L</sub> = (b)<span class="hidden">⇩</span><sub>L</sub>"</span></span></span><span>
</span><span>    </span><span class="keyword1"><span class="command">have</span></span><span> </span><span class="string"><span class="delete"><span class="delete">"(a)<span class="hidden">⇩</span><sub>L</sub> 𝟭 = (b)<span class="hidden">⇩</span><sub>L</sub> 𝟭"</span></span></span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>simp</span><span>
</span><span>    </span><span class="keyword1"><span class="command">then</span></span><span> </span><span class="keyword3"><span class="command">show</span></span><span> </span><span class="string"><span class="delete"><span class="delete">"a = b"</span></span></span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>simp</span><span> </span><span>add</span><span class="delimiter">:</span><span> </span><span>translation_def</span><span class="delimiter">)</span><span>
</span><span>  </span><span class="keyword1"><span class="command">qed</span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">then</span></span><span> </span><span class="keyword3"><span class="command">show</span></span><span> </span><span class="string"><span class="delete"><span class="delete">"bij_betw translation M (translation ` M)"</span></span></span><span>
</span><span>    </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>simp</span><span> </span><span>add</span><span class="delimiter">:</span><span> </span><span>inj_on_imp_bij_betw</span><span class="delimiter">)</span><span>
</span><span class="keyword1"><span class="command">qed</span></span><span> </span><span>simp_all</span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹p 38, ll 12--16›</span></span></span><span>
</span><span class="keyword1"><span class="command">sublocale</span></span><span> </span><span>monoid_isomorphism</span><span> </span><span>translation</span><span> </span><span>M</span><span> </span><span class="string"><span class="delete"><span class="delete">"(⋅)"</span></span></span><span> </span><span>𝟭</span><span> </span><span class="string"><span class="delete"><span class="delete">"translation ` M"</span></span></span><span> </span><span class="string"><span class="delete"><span class="delete">"compose M"</span></span></span><span> </span><span class="string"><span class="delete"><span class="delete">"identity M"</span></span></span><span> </span><span class="keyword1"><span class="command">..</span></span><span>
</span><span>
</span><span class="keyword2"><span class="keyword">end</span></span><span> </span><span class="comment"><span class="delete"><span class="delete"><span class="delete"><span class="delete">(* left_translations_of_monoid *)</span></span></span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">context</span></span><span> </span><span>monoid</span><span> </span><span class="keyword2"><span class="keyword">begin</span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹p 38, ll 1--2›</span></span></span><span>
</span><span class="keyword1"><span class="command">interpretation</span></span><span> </span><span>left_translations_of_monoid</span><span> </span><span class="keyword1"><span class="command">..</span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹p 38, ll 1--2›</span></span></span><span>
</span><span class="keyword1"><span class="command">theorem</span></span><span> </span><span>cayley_monoid</span><span class="delimiter">:</span><span>
</span><span>  </span><span class="string"><span class="delete"><span class="delete">"∃M' composition' unit'. transformation_monoid M' M ∧ (M, (⋅), 𝟭) ≅<span class="hidden">⇩</span><sub>M</sub> (M', composition', unit')"</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>simp</span><span> </span><span>add</span><span class="delimiter">:</span><span> </span><span>isomorphic_as_monoids_def</span><span class="delimiter">)</span><span> </span><span class="delimiter">(</span><span>fast</span><span> </span><span>intro</span><span class="delimiter">:</span><span> </span><span>Translations_transformation_monoid</span><span class="delimiter">)</span><span>
</span><span>
</span><span class="keyword2"><span class="keyword">end</span></span><span> </span><span class="comment"><span class="delete"><span class="delete"><span class="delete"><span class="delete">(* monoid *)</span></span></span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹p 38, l 17›</span></span></span><span>
</span><span class="keyword1"><span class="command">locale</span></span><span> </span><span>left_translations_of_group</span><span> </span><span class="delimiter">=</span><span> </span><span>group</span><span> </span><span class="keyword2"><span class="keyword">begin</span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹p 38, ll 17--18›</span></span></span><span>
</span><span class="keyword1"><span class="command">sublocale</span></span><span> </span><span>left_translations_of_monoid</span><span> </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span>M</span><span> </span><span class="delimiter">=</span><span> </span><span>G</span><span> </span><span class="keyword1"><span class="command">..</span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹p 38, ll 17--18›</span></span></span><span>
</span><span class="keyword1"><span class="command">notation</span></span><span> </span><span>translation</span><span> </span><span class="delimiter">(</span><span class="string"><span class="delete"><span class="delete">"'(_')<span class="hidden">⇩</span><sub>L</sub>"</span></span></span><span class="delimiter">)</span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹
  The group of left translations is a subgroup of the symmetric group,
  hence @{term transformation.sub.invertible}.
›</span></span></span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹p 38, ll 20--22›</span></span></span><span>
</span><span class="keyword1"><span class="command">theorem</span></span><span> </span><span>translation_invertible</span><span> </span><span class="delimiter">[</span><span>intro</span><span class="delimiter">,</span><span> </span><span>simp</span><span class="delimiter">]</span><span class="delimiter">:</span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">assumes</span></span><span> </span><span class="delimiter">[</span><span>simp</span><span class="delimiter">]</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">"a ∈ G"</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">shows</span></span><span> </span><span class="string"><span class="delete"><span class="delete">"transformation.sub.invertible (a)<span class="hidden">⇩</span><sub>L</sub>"</span></span></span><span>
</span><span class="keyword1"><span class="command">proof</span></span><span>
</span><span>  </span><span class="keyword3"><span class="command">show</span></span><span> </span><span class="string"><span class="delete"><span class="delete">"compose G (a)<span class="hidden">⇩</span><sub>L</sub> (inverse a)<span class="hidden">⇩</span><sub>L</sub> = identity G"</span></span></span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>simp</span><span>
</span><span class="keyword1"><span class="command">next</span></span><span>
</span><span>  </span><span class="keyword3"><span class="command">show</span></span><span> </span><span class="string"><span class="delete"><span class="delete">"compose G (inverse a)<span class="hidden">⇩</span><sub>L</sub> (a)<span class="hidden">⇩</span><sub>L</sub> = identity G"</span></span></span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>simp</span><span>
</span><span class="keyword1"><span class="command">qed</span></span><span> </span><span>auto</span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹p 38, ll 19--20›</span></span></span><span>
</span><span class="keyword1"><span class="command">theorem</span></span><span> </span><span>translation_bijective</span><span> </span><span class="delimiter">[</span><span>intro</span><span class="delimiter">,</span><span> </span><span>simp</span><span class="delimiter">]</span><span class="delimiter">:</span><span>
</span><span>  </span><span class="string"><span class="delete"><span class="delete">"a ∈ G ⟹ bij_betw (a)<span class="hidden">⇩</span><sub>L</sub> G G"</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>blast</span><span> </span><span>intro</span><span class="delimiter">:</span><span> </span><span>transformation.invertible_is_bijective</span><span> </span><span class="delimiter">[</span><span>THEN</span><span> </span><span>iffD1</span><span class="delimiter">]</span><span class="delimiter">)</span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹p 38, ll 18--20›</span></span></span><span>
</span><span class="keyword1"><span class="command">theorem</span></span><span> </span><span>Translations_transformation_group</span><span class="delimiter">:</span><span>
</span><span>  </span><span class="string"><span class="delete"><span class="delete">"transformation_group (translation ` G) G"</span></span></span><span>
</span><span class="keyword1"><span class="command">proof</span></span><span> </span><span>unfold_locales</span><span>
</span><span>  </span><span class="keyword3"><span class="command">show</span></span><span> </span><span class="string"><span class="delete"><span class="delete">"(translation ` G) ⊆ transformation.Sym"</span></span></span><span>
</span><span>    </span><span class="keyword1"><span class="command">unfolding</span></span><span> </span><span>transformation.Units_bijective</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>auto</span><span>
</span><span class="keyword1"><span class="command">next</span></span><span>
</span><span>  </span><span class="keyword3"><span class="command">fix</span></span><span> </span><span>α</span><span>
</span><span>  </span><span class="keyword3"><span class="command">assume</span></span><span> </span><span>α</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">"α ∈ translation ` G"</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">then</span></span><span> </span><span class="keyword3"><span class="command">obtain</span></span><span> </span><span>a</span><span> </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span>a</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">"a ∈ G"</span></span></span><span> </span><span class="keyword2"><span class="keyword">and</span></span><span> </span><span>eq</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">"α = (a)<span class="hidden">⇩</span><sub>L</sub>"</span></span></span><span> </span><span class="keyword1"><span class="command">..</span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">with</span></span><span> </span><span>translation_invertible</span><span> </span><span class="keyword3"><span class="command">show</span></span><span> </span><span class="string"><span class="delete"><span class="delete">"transformation.sub.invertible α"</span></span></span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>simp</span><span>
</span><span class="keyword1"><span class="command">qed</span></span><span> </span><span>auto</span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹p 38, ll 18--20›</span></span></span><span>
</span><span class="keyword1"><span class="command">sublocale</span></span><span> </span><span>transformation</span><span class="delimiter">:</span><span> </span><span>transformation_group</span><span> </span><span class="string"><span class="delete"><span class="delete">"translation ` G"</span></span></span><span> </span><span>G</span><span>
</span><span>  </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>fact</span><span> </span><span>Translations_transformation_group</span><span class="delimiter">)</span><span>
</span><span>
</span><span class="keyword2"><span class="keyword">end</span></span><span> </span><span class="comment"><span class="delete"><span class="delete"><span class="delete"><span class="delete">(* left_translations_of_group *)</span></span></span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">context</span></span><span> </span><span>group</span><span> </span><span class="keyword2"><span class="keyword">begin</span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹p 38, ll 2--3›</span></span></span><span>
</span><span class="keyword1"><span class="command">interpretation</span></span><span> </span><span>left_translations_of_group</span><span> </span><span class="keyword1"><span class="command">..</span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹p 38, ll 2--3›</span></span></span><span>
</span><span class="keyword1"><span class="command">theorem</span></span><span> </span><span>cayley_group</span><span class="delimiter">:</span><span>
</span><span>  </span><span class="string"><span class="delete"><span class="delete">"∃G' composition' unit'. transformation_group G' G ∧ (G, (⋅), 𝟭) ≅<span class="hidden">⇩</span><sub>M</sub> (G', composition', unit')"</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>simp</span><span> </span><span>add</span><span class="delimiter">:</span><span> </span><span>isomorphic_as_monoids_def</span><span class="delimiter">)</span><span> </span><span class="delimiter">(</span><span>fast</span><span> </span><span>intro</span><span class="delimiter">:</span><span> </span><span>Translations_transformation_group</span><span class="delimiter">)</span><span>
</span><span>
</span><span class="keyword2"><span class="keyword">end</span></span><span> </span><span class="comment"><span class="delete"><span class="delete"><span class="delete"><span class="delete">(* group *)</span></span></span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹Exercise 3›</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹p 39, ll 9--10›</span></span></span><span>
</span><span class="keyword1"><span class="command">locale</span></span><span> </span><span>right_translations_of_group</span><span> </span><span class="delimiter">=</span><span> </span><span>group</span><span> </span><span class="keyword2"><span class="keyword">begin</span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹p 39, ll 9--10›</span></span></span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>translation</span><span> </span><span class="delimiter">(</span><span class="string"><span class="delete"><span class="delete">"'(_')<span class="hidden">⇩</span><sub>R</sub>"</span></span></span><span class="delimiter">)</span><span> </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">"translation = (λa ∈ G. λx ∈ G. x ⋅ a)"</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹p 39, ll 9--10›</span></span></span><span>
</span><span class="keyword1"><span class="command">abbreviation</span></span><span> </span><span class="string"><span class="delete"><span class="delete">"Translations ≡ translation ` G"</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹The isomorphism that will be established is a map different from @{term translation}.›</span></span></span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹p 39, ll 9--10›</span></span></span><span>
</span><span class="keyword1"><span class="command">interpretation</span></span><span> </span><span>aux</span><span class="delimiter">:</span><span> </span><span>map</span><span> </span><span>translation</span><span> </span><span>G</span><span> </span><span>Translations</span><span>
</span><span>  </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>unfold_locales</span><span> </span><span class="delimiter">(</span><span>simp</span><span> </span><span>add</span><span class="delimiter">:</span><span> </span><span>translation_def</span><span class="delimiter">)</span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹p 39, ll 9--10›</span></span></span><span>
</span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>translation_map</span><span> </span><span class="delimiter">[</span><span>intro</span><span class="delimiter">,</span><span> </span><span>simp</span><span class="delimiter">]</span><span class="delimiter">:</span><span>
</span><span>  </span><span class="string"><span class="delete"><span class="delete">"a ∈ G ⟹ (a)<span class="hidden">⇩</span><sub>R</sub> ∈ G →<span class="hidden">⇩</span><sub>E</sub> G"</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">unfolding</span></span><span> </span><span>translation_def</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>simp</span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹p 39, ll 9--10›</span></span></span><span>
</span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>Translation_maps</span><span> </span><span class="delimiter">[</span><span>intro</span><span class="delimiter">,</span><span> </span><span>simp</span><span class="delimiter">]</span><span class="delimiter">:</span><span>
</span><span>  </span><span class="string"><span class="delete"><span class="delete">"Translations ⊆ G →<span class="hidden">⇩</span><sub>E</sub> G"</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>simp</span><span> </span><span>add</span><span class="delimiter">:</span><span> </span><span>image_subsetI</span><span class="delimiter">)</span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹p 39, ll 9--10›</span></span></span><span>
</span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>translation_apply</span><span class="delimiter">:</span><span>
</span><span>  </span><span class="string"><span class="delete"><span class="delete">"⟦ a ∈ G; b ∈ G ⟧ ⟹ (a)<span class="hidden">⇩</span><sub>R</sub> b = b ⋅ a"</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">unfolding</span></span><span> </span><span>translation_def</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>auto</span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹p 39, ll 9--10›</span></span></span><span>
</span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>translation_exist</span><span class="delimiter">:</span><span>
</span><span>  </span><span class="string"><span class="delete"><span class="delete">"f ∈ Translations ⟹ ∃a ∈ G. f = (a)<span class="hidden">⇩</span><sub>R</sub>"</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>auto</span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹p 39, ll 9--10›</span></span></span><span>
</span><span class="keyword1"><span class="command">lemmas</span></span><span> </span><span>Translations_E</span><span> </span><span class="delimiter">[</span><span>elim</span><span class="delimiter">]</span><span> </span><span class="delimiter">=</span><span> </span><span>translation_exist</span><span> </span><span class="delimiter">[</span><span>THEN</span><span> </span><span>bexE</span><span class="delimiter">]</span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹p 39, ll 9--10›</span></span></span><span>
</span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>translation_unit_eq</span><span> </span><span class="delimiter">[</span><span>simp</span><span class="delimiter">]</span><span class="delimiter">:</span><span>
</span><span>  </span><span class="string"><span class="delete"><span class="delete">"identity G = (𝟭)<span class="hidden">⇩</span><sub>R</sub>"</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">unfolding</span></span><span> </span><span>translation_def</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>auto</span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹p 39, ll 10--11›</span></span></span><span>
</span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>translation_composition_eq</span><span> </span><span class="delimiter">[</span><span>simp</span><span class="delimiter">]</span><span class="delimiter">:</span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">assumes</span></span><span> </span><span class="delimiter">[</span><span>simp</span><span class="delimiter">]</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">"a ∈ G"</span></span></span><span> </span><span class="string"><span class="delete"><span class="delete">"b ∈ G"</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">shows</span></span><span> </span><span class="string"><span class="delete"><span class="delete">"compose G (a)<span class="hidden">⇩</span><sub>R</sub> (b)<span class="hidden">⇩</span><sub>R</sub> = (b ⋅ a)<span class="hidden">⇩</span><sub>R</sub>"</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">unfolding</span></span><span> </span><span>translation_def</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>rule</span><span> </span><span class="delimiter">(</span><span>simp</span><span> </span><span>add</span><span class="delimiter">:</span><span> </span><span>associative</span><span> </span><span>compose_def</span><span class="delimiter">)</span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹p 39, ll 10--11›</span></span></span><span>
</span><span class="keyword1"><span class="command">sublocale</span></span><span> </span><span>transformation</span><span class="delimiter">:</span><span> </span><span>transformations</span><span> </span><span>G</span><span> </span><span class="keyword1"><span class="command">.</span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹p 39, ll 10--11›</span></span></span><span>
</span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>Translations_transformation_monoid</span><span class="delimiter">:</span><span>
</span><span>  </span><span class="string"><span class="delete"><span class="delete">"transformation_monoid Translations G"</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>unfold_locales</span><span> </span><span>auto</span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹p 39, ll 10--11›</span></span></span><span>
</span><span class="keyword1"><span class="command">sublocale</span></span><span> </span><span>transformation</span><span class="delimiter">:</span><span> </span><span>transformation_monoid</span><span> </span><span>Translations</span><span> </span><span>G</span><span>
</span><span>  </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>fact</span><span> </span><span>Translations_transformation_monoid</span><span class="delimiter">)</span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹p 39, ll 10--11›</span></span></span><span>
</span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>translation_invertible</span><span> </span><span class="delimiter">[</span><span>intro</span><span class="delimiter">,</span><span> </span><span>simp</span><span class="delimiter">]</span><span class="delimiter">:</span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">assumes</span></span><span> </span><span class="delimiter">[</span><span>simp</span><span class="delimiter">]</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">"a ∈ G"</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">shows</span></span><span> </span><span class="string"><span class="delete"><span class="delete">"transformation.sub.invertible (a)<span class="hidden">⇩</span><sub>R</sub>"</span></span></span><span>
</span><span class="keyword1"><span class="command">proof</span></span><span>
</span><span>  </span><span class="keyword3"><span class="command">show</span></span><span> </span><span class="string"><span class="delete"><span class="delete">"compose G (a)<span class="hidden">⇩</span><sub>R</sub> (inverse a)<span class="hidden">⇩</span><sub>R</sub> = identity G"</span></span></span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>simp</span><span>
</span><span class="keyword1"><span class="command">next</span></span><span>
</span><span>  </span><span class="keyword3"><span class="command">show</span></span><span> </span><span class="string"><span class="delete"><span class="delete">"compose G (inverse a)<span class="hidden">⇩</span><sub>R</sub> (a)<span class="hidden">⇩</span><sub>R</sub> = identity G"</span></span></span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>simp</span><span>
</span><span class="keyword1"><span class="command">qed</span></span><span> </span><span>auto</span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹p 39, ll 10--11›</span></span></span><span>
</span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>translation_bijective</span><span> </span><span class="delimiter">[</span><span>intro</span><span class="delimiter">,</span><span> </span><span>simp</span><span class="delimiter">]</span><span class="delimiter">:</span><span>
</span><span>  </span><span class="string"><span class="delete"><span class="delete">"a ∈ G ⟹ bij_betw (a)<span class="hidden">⇩</span><sub>R</sub> G G"</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>blast</span><span> </span><span>intro</span><span class="delimiter">:</span><span> </span><span>transformation.invertible_is_bijective</span><span> </span><span class="delimiter">[</span><span>THEN</span><span> </span><span>iffD1</span><span class="delimiter">]</span><span class="delimiter">)</span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹p 39, ll 10--11›</span></span></span><span>
</span><span class="keyword1"><span class="command">theorem</span></span><span> </span><span>Translations_transformation_group</span><span class="delimiter">:</span><span>
</span><span>  </span><span class="string"><span class="delete"><span class="delete">"transformation_group Translations G"</span></span></span><span>
</span><span class="keyword1"><span class="command">proof</span></span><span> </span><span>unfold_locales</span><span>
</span><span>  </span><span class="keyword3"><span class="command">show</span></span><span> </span><span class="string"><span class="delete"><span class="delete">"Translations ⊆ transformation.Sym"</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">unfolding</span></span><span> </span><span>transformation.Units_bijective</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>auto</span><span>
</span><span class="keyword1"><span class="command">next</span></span><span>
</span><span>  </span><span class="keyword3"><span class="command">fix</span></span><span> </span><span>α</span><span>
</span><span>  </span><span class="keyword3"><span class="command">assume</span></span><span> </span><span>α</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">"α ∈ Translations"</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">then</span></span><span> </span><span class="keyword3"><span class="command">obtain</span></span><span> </span><span>a</span><span> </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span>a</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">"a ∈ G"</span></span></span><span> </span><span class="keyword2"><span class="keyword">and</span></span><span> </span><span>eq</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">"α = (a)<span class="hidden">⇩</span><sub>R</sub>"</span></span></span><span> </span><span class="keyword1"><span class="command">..</span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">with</span></span><span> </span><span>translation_invertible</span><span> </span><span class="keyword3"><span class="command">show</span></span><span> </span><span class="string"><span class="delete"><span class="delete">"transformation.sub.invertible α"</span></span></span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>simp</span><span>
</span><span class="keyword1"><span class="command">qed</span></span><span> </span><span>auto</span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹p 39, ll 10--11›</span></span></span><span>
</span><span class="keyword1"><span class="command">sublocale</span></span><span> </span><span>transformation</span><span class="delimiter">:</span><span> </span><span>transformation_group</span><span> </span><span>Translations</span><span> </span><span>G</span><span>
</span><span>  </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>rule</span><span> </span><span>Translations_transformation_group</span><span class="delimiter">)</span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹p 39, ll 10--11›</span></span></span><span>
</span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>translation_inverse_eq</span><span> </span><span class="delimiter">[</span><span>simp</span><span class="delimiter">]</span><span class="delimiter">:</span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">assumes</span></span><span> </span><span class="delimiter">[</span><span>simp</span><span class="delimiter">]</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">"a ∈ G"</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">shows</span></span><span> </span><span class="string"><span class="delete"><span class="delete">"transformation.sub.inverse (a)<span class="hidden">⇩</span><sub>R</sub> = (inverse a)<span class="hidden">⇩</span><sub>R</sub>"</span></span></span><span>
</span><span class="keyword1"><span class="command">proof</span></span><span> </span><span class="delimiter">(</span><span>rule</span><span> </span><span>transformation.sub.inverse_equality</span><span class="delimiter">)</span><span>
</span><span>  </span><span class="keyword3"><span class="command">show</span></span><span> </span><span class="string"><span class="delete"><span class="delete">"compose G (a)<span class="hidden">⇩</span><sub>R</sub> (inverse a)<span class="hidden">⇩</span><sub>R</sub> = identity G"</span></span></span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>simp</span><span>
</span><span class="keyword1"><span class="command">next</span></span><span>
</span><span>  </span><span class="keyword3"><span class="command">show</span></span><span> </span><span class="string"><span class="delete"><span class="delete">"compose G (inverse a)<span class="hidden">⇩</span><sub>R</sub> (a)<span class="hidden">⇩</span><sub>R</sub> = identity G"</span></span></span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>simp</span><span>
</span><span class="keyword1"><span class="command">qed</span></span><span> </span><span>auto</span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹p 39, ll 10--11›</span></span></span><span>
</span><span class="keyword1"><span class="command">theorem</span></span><span> </span><span>translation_inverse_monoid_isomorphism</span><span> </span><span class="delimiter">[</span><span>intro</span><span class="delimiter">]</span><span class="delimiter">:</span><span>
</span><span>  </span><span class="string"><span class="delete"><span class="delete">"monoid_isomorphism (λa∈G. transformation.symmetric.inverse (a)<span class="hidden">⇩</span><sub>R</sub>) G (⋅) 𝟭 Translations (compose G) (identity G)"</span></span></span><span>
</span><span>  </span><span class="delimiter">(</span><span class="keyword2"><span class="keyword">is</span></span><span> </span><span class="string"><span class="delete"><span class="delete">"monoid_isomorphism ?inv _ _ _ _ _ _"</span></span></span><span class="delimiter">)</span><span>
</span><span class="keyword1"><span class="command">proof</span></span><span> </span><span>unfold_locales</span><span>
</span><span>  </span><span class="keyword3"><span class="command">show</span></span><span> </span><span class="string"><span class="delete"><span class="delete">"?inv ∈ G →<span class="hidden">⇩</span><sub>E</sub> Translations"</span></span></span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>simp</span><span> </span><span>del</span><span class="delimiter">:</span><span> </span><span>translation_unit_eq</span><span class="delimiter">)</span><span>
</span><span class="keyword1"><span class="command">next</span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">note</span></span><span> </span><span>bij_betw_compose</span><span> </span><span class="delimiter">[</span><span>trans</span><span class="delimiter">]</span><span>
</span><span>  </span><span class="keyword1"><span class="command">have</span></span><span> </span><span class="string"><span class="delete"><span class="delete">"bij_betw inverse G G"</span></span></span><span>
</span><span>    </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>rule</span><span> </span><span>bij_betwI</span><span> </span><span class="delimiter">[</span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span>g</span><span> </span><span class="delimiter">=</span><span> </span><span>inverse</span><span class="delimiter">]</span><span class="delimiter">)</span><span> </span><span>auto</span><span>
</span><span>  </span><span class="keyword1"><span class="command">also</span></span><span> </span><span class="keyword1"><span class="command">have</span></span><span> </span><span class="string"><span class="delete"><span class="delete">"bij_betw translation G Translations"</span></span></span><span>
</span><span>    </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>rule</span><span> </span><span>bij_betwI</span><span> </span><span class="delimiter">[</span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span>g</span><span> </span><span class="delimiter">=</span><span> </span><span class="string"><span class="delete"><span class="delete">"λα∈Translations. α 𝟭"</span></span></span><span class="delimiter">]</span><span class="delimiter">)</span><span> </span><span class="delimiter">(</span><span>auto</span><span> </span><span>simp</span><span class="delimiter">:</span><span> </span><span>translation_apply</span><span class="delimiter">)</span><span>
</span><span>  </span><span class="keyword1"><span class="command">finally</span></span><span> </span><span class="keyword3"><span class="command">show</span></span><span> </span><span class="string"><span class="delete"><span class="delete">"bij_betw ?inv G Translations"</span></span></span><span>
</span><span>    </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>simp</span><span> </span><span>cong</span><span class="delimiter">:</span><span> </span><span>bij_betw_cong</span><span> </span><span>add</span><span class="delimiter">:</span><span> </span><span>compose_eq</span><span> </span><span>del</span><span class="delimiter">:</span><span> </span><span>translation_unit_eq</span><span class="delimiter">)</span><span>
</span><span class="keyword1"><span class="command">next</span></span><span>
</span><span>  </span><span class="keyword3"><span class="command">fix</span></span><span> </span><span>x</span><span> </span><span class="keyword2"><span class="keyword">and</span></span><span> </span><span>y</span><span>
</span><span>  </span><span class="keyword3"><span class="command">assume</span></span><span> </span><span class="delimiter">[</span><span>simp</span><span class="delimiter">]</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">"x ∈ G"</span></span></span><span> </span><span class="string"><span class="delete"><span class="delete">"y ∈ G"</span></span></span><span>
</span><span>  </span><span class="keyword3"><span class="command">show</span></span><span> </span><span class="string"><span class="delete"><span class="delete">"compose G (?inv x) (?inv y) = (?inv (x ⋅ y))"</span></span></span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>simp</span><span> </span><span>add</span><span class="delimiter">:</span><span> </span><span>inverse_composition_commute</span><span> </span><span>del</span><span class="delimiter">:</span><span> </span><span>translation_unit_eq</span><span class="delimiter">)</span><span>
</span><span class="keyword1"><span class="command">next</span></span><span>
</span><span>  </span><span class="keyword3"><span class="command">show</span></span><span> </span><span class="string"><span class="delete"><span class="delete">"?inv 𝟭 = identity G"</span></span></span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>simp</span><span> </span><span>del</span><span class="delimiter">:</span><span> </span><span>translation_unit_eq</span><span class="delimiter">)</span><span> </span><span>simp</span><span>
</span><span class="keyword1"><span class="command">qed</span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹p 39, ll 10--11›</span></span></span><span>
</span><span class="keyword1"><span class="command">sublocale</span></span><span> </span><span>monoid_isomorphism</span><span>
</span><span>  </span><span class="string"><span class="delete"><span class="delete">"λa∈G. transformation.symmetric.inverse (a)<span class="hidden">⇩</span><sub>R</sub>"</span></span></span><span> </span><span>G</span><span> </span><span class="string"><span class="delete"><span class="delete">"(⋅)"</span></span></span><span> </span><span>𝟭</span><span> </span><span>Translations</span><span> </span><span class="string"><span class="delete"><span class="delete">"compose G"</span></span></span><span> </span><span class="string"><span class="delete"><span class="delete">"identity G"</span></span></span><span> </span><span class="keyword1"><span class="command">..</span></span><span>
</span><span>
</span><span class="keyword2"><span class="keyword">end</span></span><span> </span><span class="comment"><span class="delete"><span class="delete"><span class="delete"><span class="delete">(* right_translations_of_group *)</span></span></span></span></span><span>
</span><span>
</span><span>
</span><span class="keyword1"><span class="command">subsection</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹Generalized Associativity.  Commutativity›</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹p 40, l 27; p 41, ll 1--2›</span></span></span><span>
</span><span class="keyword1"><span class="command">locale</span></span><span> </span><span>commutative_monoid</span><span> </span><span class="delimiter">=</span><span> </span><span>monoid</span><span> </span><span class="delimiter">+</span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">assumes</span></span><span> </span><span>commutative</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">"⟦ x ∈ M; y ∈ M ⟧ ⟹ x ⋅ y = y ⋅ x"</span></span></span><span>
</span><span>  
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹p 41, l 2›</span></span></span><span>
</span><span class="keyword1"><span class="command">locale</span></span><span> </span><span>abelian_group</span><span> </span><span class="delimiter">=</span><span> </span><span>group</span><span> </span><span class="delimiter">+</span><span> </span><span>commutative_monoid</span><span> </span><span>G</span><span> </span><span class="string"><span class="delete"><span class="delete">"(⋅)"</span></span></span><span> </span><span>𝟭</span><span>
</span><span>
</span><span>
</span><span class="keyword1"><span class="command">subsection</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹Orbits.  Cosets of a Subgroup›</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">context</span></span><span> </span><span>transformation_group</span><span> </span><span class="keyword2"><span class="keyword">begin</span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹p 51, ll 18--20›</span></span></span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>Orbit_Relation</span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">"Orbit_Relation = {(x, y). x ∈ S ∧ y ∈ S ∧ (∃α ∈ G. y = α x)}"</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹p 51, ll 18--20›</span></span></span><span>
</span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>Orbit_Relation_memI</span><span> </span><span class="delimiter">[</span><span>intro</span><span class="delimiter">]</span><span class="delimiter">:</span><span>
</span><span>  </span><span class="string"><span class="delete"><span class="delete">"⟦ ∃α ∈ G. y = α x; x ∈ S ⟧ ⟹ (x, y) ∈ Orbit_Relation"</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">unfolding</span></span><span> </span><span>Orbit_Relation_def</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>auto</span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹p 51, ll 18--20›</span></span></span><span>
</span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>Orbit_Relation_memE</span><span> </span><span class="delimiter">[</span><span>elim</span><span class="delimiter">]</span><span class="delimiter">:</span><span>
</span><span>  </span><span class="string"><span class="delete"><span class="delete">"⟦ (x, y) ∈ Orbit_Relation; ⋀α. ⟦ α ∈ G; x ∈ S; y = α x ⟧ ⟹ Q ⟧ ⟹ Q"</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">unfolding</span></span><span> </span><span>Orbit_Relation_def</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>auto</span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹p 51, ll 20--23, 26--27›</span></span></span><span>
</span><span class="keyword1"><span class="command">sublocale</span></span><span> </span><span>orbit</span><span class="delimiter">:</span><span> </span><span>equivalence</span><span> </span><span>S</span><span> </span><span>Orbit_Relation</span><span>
</span><span class="keyword1"><span class="command">proof</span></span><span> </span><span class="delimiter">(</span><span>unfold_locales</span><span class="delimiter">,</span><span> </span><span>auto</span><span> </span><span>simp</span><span class="delimiter">:</span><span> </span><span>Orbit_Relation_def</span><span class="delimiter">)</span><span>
</span><span>  </span><span class="keyword3"><span class="command">fix</span></span><span> </span><span>x</span><span>
</span><span>  </span><span class="keyword3"><span class="command">assume</span></span><span> </span><span>x</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">"x ∈ S"</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">then</span></span><span> </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>id</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">"x = identity S x"</span></span></span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>simp</span><span>
</span><span>  </span><span class="keyword1"><span class="command">with</span></span><span> </span><span>x</span><span> </span><span class="keyword3"><span class="command">show</span></span><span> </span><span class="string"><span class="delete"><span class="delete">"∃α ∈ G. x = α x"</span></span></span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>fast</span><span>
</span><span>  </span><span class="keyword3"><span class="command">fix</span></span><span> </span><span>α</span><span>
</span><span>  </span><span class="keyword3"><span class="command">assume</span></span><span> </span><span>α</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">"α ∈ G"</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">with</span></span><span> </span><span>x</span><span> </span><span>id</span><span> </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>y</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">"x = compose S (symmetric.inverse α) α x"</span></span></span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>auto</span><span>
</span><span>  </span><span class="keyword1"><span class="command">with</span></span><span> </span><span>x</span><span> </span><span>α</span><span> </span><span class="keyword3"><span class="command">show</span></span><span> </span><span class="string"><span class="delete"><span class="delete">"∃α' ∈ G. x = α' (α x)"</span></span></span><span>
</span><span>    </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>metis</span><span> </span><span>compose_eq</span><span> </span><span>symmetric.sub.invertible</span><span> </span><span>symmetric.submonoid_inverse_closed</span><span class="delimiter">)</span><span>
</span><span>  </span><span class="keyword3"><span class="command">fix</span></span><span> </span><span>β</span><span>
</span><span>  </span><span class="keyword3"><span class="command">assume</span></span><span> </span><span>β</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">"β ∈ G"</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">with</span></span><span> </span><span>x</span><span> </span><span class="keyword1"><span class="command">have</span></span><span> </span><span class="string"><span class="delete"><span class="delete">"β (α x) = compose S β α x"</span></span></span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>simp</span><span> </span><span>add</span><span class="delimiter">:</span><span> </span><span>compose_eq</span><span class="delimiter">)</span><span>
</span><span>  </span><span class="keyword1"><span class="command">with</span></span><span> </span><span>α</span><span> </span><span>β</span><span> </span><span class="keyword3"><span class="command">show</span></span><span> </span><span class="string"><span class="delete"><span class="delete">"∃γ ∈ G. β (α x) = γ x"</span></span></span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>fast</span><span>
</span><span class="keyword1"><span class="command">qed</span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹p 51, ll 23--24›</span></span></span><span>
</span><span class="keyword1"><span class="command">theorem</span></span><span> </span><span>orbit_equality</span><span class="delimiter">:</span><span>
</span><span>  </span><span class="string"><span class="delete"><span class="delete">"x ∈ S ⟹ orbit.Class x = {α x | α. α ∈ G}"</span></span></span><span>
</span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>simp</span><span> </span><span>add</span><span class="delimiter">:</span><span> </span><span>orbit.Class_def</span><span class="delimiter">)</span><span> </span><span class="delimiter">(</span><span>blast</span><span> </span><span>intro</span><span class="delimiter">:</span><span> </span><span>orbit.symmetric</span><span> </span><span>dest</span><span class="delimiter">:</span><span> </span><span>orbit.symmetric</span><span class="delimiter">)</span><span>
</span><span>
</span><span class="keyword2"><span class="keyword">end</span></span><span> </span><span class="comment"><span class="delete"><span class="delete"><span class="delete"><span class="delete">(* transformation_group *)</span></span></span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">context</span></span><span> </span><span>monoid_isomorphism</span><span> </span><span class="keyword2"><span class="keyword">begin</span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹p 52, ll 16--17›</span></span></span><span>
</span><span class="keyword1"><span class="command">theorem</span></span><span> </span><span>image_subgroup</span><span class="delimiter">:</span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">assumes</span></span><span> </span><span class="string"><span class="delete"><span class="delete">"subgroup G M (⋅) 𝟭"</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">shows</span></span><span> </span><span class="string"><span class="delete"><span class="delete">"subgroup (η ` G) M' (⋅') 𝟭'"</span></span></span><span>
</span><span class="keyword1"><span class="command">proof</span></span><span> </span><span>-</span><span>
</span><span>  </span><span class="keyword1"><span class="command">interpret</span></span><span> </span><span>subgroup</span><span> </span><span>G</span><span> </span><span>M</span><span> </span><span class="string"><span class="delete"><span class="delete">"(⋅)"</span></span></span><span> </span><span>𝟭</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>fact</span><span>
</span><span>  </span><span class="keyword1"><span class="command">interpret</span></span><span> </span><span>image</span><span class="delimiter">:</span><span> </span><span>monoid</span><span> </span><span class="string"><span class="delete"><span class="delete">"η ` G"</span></span></span><span> </span><span class="string"><span class="delete"><span class="delete">"(⋅')"</span></span></span><span> </span><span class="string"><span class="delete"><span class="delete">"𝟭'"</span></span></span><span>
</span><span>    </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>unfold_locales</span><span> </span><span class="delimiter">(</span><span>auto</span><span> </span><span>simp</span><span> </span><span>add</span><span class="delimiter">:</span><span> </span><span>commutes_with_composition</span><span> </span><span>commutes_with_unit</span><span> </span><span class="delimiter">[</span><span>symmetric</span><span class="delimiter">]</span><span class="delimiter">)</span><span>
</span><span>  </span><span class="keyword3"><span class="command">show</span></span><span> </span><span class="var">?thesis</span><span>
</span><span>  </span><span class="keyword1"><span class="command">proof</span></span><span> </span><span class="delimiter">(</span><span>unfold_locales</span><span class="delimiter">,</span><span> </span><span>auto</span><span class="delimiter">)</span><span>
</span><span>    </span><span class="keyword3"><span class="command">fix</span></span><span> </span><span>x</span><span>
</span><span>    </span><span class="keyword3"><span class="command">assume</span></span><span> </span><span>x</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">"x ∈ G"</span></span></span><span>
</span><span>    </span><span class="keyword3"><span class="command">show</span></span><span> </span><span class="string"><span class="delete"><span class="delete">"image.invertible (η x)"</span></span></span><span>
</span><span>    </span><span class="keyword1"><span class="command">proof</span></span><span>
</span><span>      </span><span class="keyword3"><span class="command">show</span></span><span> </span><span class="string"><span class="delete"><span class="delete">"η (sub.inverse x) ∈ η ` G"</span></span></span><span> </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>x</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>simp</span><span>
</span><span>    </span><span class="keyword1"><span class="command">qed</span></span><span> </span><span class="delimiter">(</span><span>auto</span><span> </span><span>simp</span><span class="delimiter">:</span><span> </span><span>x</span><span> </span><span>commutes_with_composition</span><span> </span><span>commutes_with_unit</span><span class="delimiter">)</span><span>
</span><span>  </span><span class="keyword1"><span class="command">qed</span></span><span>
</span><span class="keyword1"><span class="command">qed</span></span><span>
</span><span>
</span><span class="keyword2"><span class="keyword">end</span></span><span> </span><span class="comment"><span class="delete"><span class="delete"><span class="delete"><span class="delete">(* monoid_isomorphism *)</span></span></span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹
  Technical device to achieve Jacobson's notation for @{text Right_Coset} and @{text Left_Coset}.  The
  definitions are pulled out of @{text subgroup_of_group} to a context where @{text H} is not a parameter.
›</span></span></span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹p 52, l 20›</span></span></span><span>
</span><span class="keyword1"><span class="command">locale</span></span><span> </span><span>coset_notation</span><span> </span><span class="delimiter">=</span><span> </span><span class="keyword2"><span class="keyword">fixes</span></span><span> </span><span>composition</span><span> </span><span class="delimiter">(</span><span class="keyword2"><span class="keyword">infixl</span></span><span> </span><span class="string"><span class="delete"><span class="delete">"⋅"</span></span></span><span> </span><span>70</span><span class="delimiter">)</span><span>  </span><span class="keyword2"><span class="keyword">begin</span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹Equation 23›</span></span></span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹p 52, l 20›</span></span></span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>Right_Coset</span><span> </span><span class="delimiter">(</span><span class="keyword2"><span class="keyword">infixl</span></span><span> </span><span class="string"><span class="delete"><span class="delete">"|⋅"</span></span></span><span> </span><span>70</span><span class="delimiter">)</span><span> </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">"H |⋅ x = {h ⋅ x | h. h ∈ H}"</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹p 53, ll 8--9›</span></span></span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>Left_Coset</span><span> </span><span class="delimiter">(</span><span class="keyword2"><span class="keyword">infixl</span></span><span> </span><span class="string"><span class="delete"><span class="delete">"⋅|"</span></span></span><span> </span><span>70</span><span class="delimiter">)</span><span> </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">"x ⋅| H = {x ⋅ h | h. h ∈ H}"</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹p 52, l 20›</span></span></span><span>
</span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>Right_Coset_memI</span><span> </span><span class="delimiter">[</span><span>intro</span><span class="delimiter">]</span><span class="delimiter">:</span><span>
</span><span>  </span><span class="string"><span class="delete"><span class="delete">"h ∈ H ⟹ h ⋅ x ∈ H |⋅ x"</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">unfolding</span></span><span> </span><span>Right_Coset_def</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>blast</span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹p 52, l 20›</span></span></span><span>
</span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>Right_Coset_memE</span><span> </span><span class="delimiter">[</span><span>elim</span><span class="delimiter">]</span><span class="delimiter">:</span><span>
</span><span>  </span><span class="string"><span class="delete"><span class="delete">"⟦ a ∈ H |⋅ x; ⋀h. ⟦ h ∈ H; a = h ⋅ x ⟧ ⟹ P ⟧ ⟹ P"</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">unfolding</span></span><span> </span><span>Right_Coset_def</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>blast</span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹p 53, ll 8--9›</span></span></span><span>
</span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>Left_Coset_memI</span><span> </span><span class="delimiter">[</span><span>intro</span><span class="delimiter">]</span><span class="delimiter">:</span><span>
</span><span>  </span><span class="string"><span class="delete"><span class="delete">"h ∈ H ⟹ x ⋅ h ∈ x ⋅| H"</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">unfolding</span></span><span> </span><span>Left_Coset_def</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>blast</span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹p 53, ll 8--9›</span></span></span><span>
</span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>Left_Coset_memE</span><span> </span><span class="delimiter">[</span><span>elim</span><span class="delimiter">]</span><span class="delimiter">:</span><span>
</span><span>  </span><span class="string"><span class="delete"><span class="delete">"⟦ a ∈ x ⋅| H; ⋀h. ⟦ h ∈ H; a = x ⋅ h ⟧ ⟹ P ⟧ ⟹ P"</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">unfolding</span></span><span> </span><span>Left_Coset_def</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>blast</span><span>
</span><span>
</span><span class="keyword2"><span class="keyword">end</span></span><span> </span><span class="comment"><span class="delete"><span class="delete"><span class="delete"><span class="delete">(* coset_notation *)</span></span></span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹p 52, l 12›</span></span></span><span>
</span><span class="keyword1"><span class="command">locale</span></span><span> </span><span>subgroup_of_group</span><span> </span><span class="delimiter">=</span><span> </span><span>subgroup</span><span> </span><span>H</span><span> </span><span>G</span><span> </span><span class="string"><span class="delete"><span class="delete">"(⋅)"</span></span></span><span> </span><span>𝟭</span><span> </span><span class="delimiter">+</span><span> </span><span>coset_notation</span><span> </span><span class="string"><span class="delete"><span class="delete">"(⋅)"</span></span></span><span> </span><span class="delimiter">+</span><span> </span><span>group</span><span> </span><span>G</span><span> </span><span class="string"><span class="delete"><span class="delete">"(⋅)"</span></span></span><span> </span><span>𝟭</span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">for</span></span><span> </span><span>H</span><span> </span><span class="keyword2"><span class="keyword">and</span></span><span> </span><span>G</span><span> </span><span class="keyword2"><span class="keyword">and</span></span><span> </span><span>composition</span><span> </span><span class="delimiter">(</span><span class="keyword2"><span class="keyword">infixl</span></span><span> </span><span class="string"><span class="delete"><span class="delete">"⋅"</span></span></span><span> </span><span>70</span><span class="delimiter">)</span><span> </span><span class="keyword2"><span class="keyword">and</span></span><span> </span><span>unit</span><span> </span><span class="delimiter">(</span><span class="string"><span class="delete"><span class="delete">"𝟭"</span></span></span><span class="delimiter">)</span><span>
</span><span class="keyword2"><span class="keyword">begin</span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹p 52, ll 12--14›</span></span></span><span>
</span><span class="keyword1"><span class="command">interpretation</span></span><span> </span><span>left</span><span class="delimiter">:</span><span> </span><span>left_translations_of_group</span><span> </span><span class="keyword1"><span class="command">..</span></span><span>
</span><span class="keyword1"><span class="command">interpretation</span></span><span> </span><span>right</span><span class="delimiter">:</span><span> </span><span>right_translations_of_group</span><span> </span><span class="keyword1"><span class="command">..</span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹
  @{term "left.translation ` H"} denotes Jacobson's @{text "H<span class="hidden">⇩</span><sub>L</sub>(G)"} and
  @{term "left.translation ` G"} denotes Jacobson's @{text "G<span class="hidden">⇩</span><sub>L</sub>"}.
›</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹p 52, ll 16--18›</span></span></span><span>
</span><span class="keyword1"><span class="command">theorem</span></span><span> </span><span>left_translations_of_subgroup_are_transformation_group</span><span> </span><span class="delimiter">[</span><span>intro</span><span class="delimiter">]</span><span class="delimiter">:</span><span>
</span><span>  </span><span class="string"><span class="delete"><span class="delete">"transformation_group (left.translation ` H) G"</span></span></span><span>
</span><span class="keyword1"><span class="command">proof</span></span><span> </span><span>-</span><span>
</span><span>  </span><span class="keyword1"><span class="command">have</span></span><span> </span><span class="string"><span class="delete"><span class="delete">"subgroup (left.translation ` H) (left.translation ` G) (compose G) (identity G)"</span></span></span><span>
</span><span>    </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>rule</span><span> </span><span>left.image_subgroup</span><span class="delimiter">)</span><span> </span><span>unfold_locales</span><span>
</span><span>  </span><span class="keyword1"><span class="command">also</span></span><span> </span><span class="keyword1"><span class="command">have</span></span><span> </span><span class="string"><span class="delete"><span class="delete">"subgroup (left.translation ` G) left.transformation.Sym (compose G) (identity G)"</span></span></span><span> </span><span class="keyword1"><span class="command">..</span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">finally</span></span><span> </span><span class="keyword1"><span class="command">interpret</span></span><span> </span><span>right_coset</span><span class="delimiter">:</span><span> </span><span>subgroup</span><span> </span><span class="string"><span class="delete"><span class="delete">"left.translation ` H"</span></span></span><span> </span><span>left.transformation.Sym</span><span> </span><span class="string"><span class="delete"><span class="delete">"compose G"</span></span></span><span> </span><span class="string"><span class="delete"><span class="delete">"identity G"</span></span></span><span> </span><span class="keyword1"><span class="command">.</span></span><span>
</span><span>  </span><span class="keyword3"><span class="command">show</span></span><span> </span><span class="var">?thesis</span><span> </span><span class="keyword1"><span class="command">..</span></span><span>
</span><span class="keyword1"><span class="command">qed</span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹p 52, l 18›</span></span></span><span>
</span><span class="keyword1"><span class="command">interpretation</span></span><span> </span><span>transformation_group</span><span> </span><span class="string"><span class="delete"><span class="delete">"left.translation ` H"</span></span></span><span> </span><span>G</span><span> </span><span class="keyword1"><span class="command">..</span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹p 52, ll 19--20›</span></span></span><span>
</span><span class="keyword1"><span class="command">theorem</span></span><span> </span><span>Right_Coset_is_orbit</span><span class="delimiter">:</span><span>
</span><span>  </span><span class="string"><span class="delete"><span class="delete">"x ∈ G ⟹ H |⋅ x = orbit.Class x"</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>left.translation_apply</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>auto</span><span> </span><span>simp</span><span class="delimiter">:</span><span> </span><span>orbit_equality</span><span> </span><span>Right_Coset_def</span><span class="delimiter">)</span><span> </span><span class="delimiter">(</span><span>metis</span><span> </span><span>imageI</span><span> </span><span>sub</span><span class="delimiter">)</span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹p 52, ll 24--25›</span></span></span><span>
</span><span class="keyword1"><span class="command">theorem</span></span><span> </span><span>Right_Coset_Union</span><span class="delimiter">:</span><span>
</span><span>  </span><span class="string"><span class="delete"><span class="delete">"(⋃x∈G. H |⋅ x) = G"</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>simp</span><span> </span><span>add</span><span class="delimiter">:</span><span> </span><span>Right_Coset_is_orbit</span><span class="delimiter">)</span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹p 52, l 26›</span></span></span><span>
</span><span class="keyword1"><span class="command">theorem</span></span><span> </span><span>Right_Coset_bij</span><span class="delimiter">:</span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">assumes</span></span><span> </span><span>G</span><span> </span><span class="delimiter">[</span><span>simp</span><span class="delimiter">]</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">"x ∈ G"</span></span></span><span> </span><span class="string"><span class="delete"><span class="delete">"y ∈ G"</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">shows</span></span><span> </span><span class="string"><span class="delete"><span class="delete">"bij_betw (inverse x ⋅ y)<span class="hidden">⇩</span><sub>R</sub> (H |⋅ x) (H |⋅ y)"</span></span></span><span>
</span><span class="keyword1"><span class="command">proof</span></span><span> </span><span class="delimiter">(</span><span>rule</span><span> </span><span>bij_betw_imageI</span><span class="delimiter">)</span><span>
</span><span>  </span><span class="keyword3"><span class="command">show</span></span><span> </span><span class="string"><span class="delete"><span class="delete">"inj_on (inverse x ⋅ y)<span class="hidden">⇩</span><sub>R</sub> (H |⋅ x)"</span></span></span><span>
</span><span>    </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>fastforce</span><span> </span><span>intro</span><span class="delimiter">:</span><span> </span><span>inj_onI</span><span> </span><span>simp</span><span> </span><span>add</span><span class="delimiter">:</span><span> </span><span>Right_Coset_is_orbit</span><span> </span><span>right.translation_apply</span><span> </span><span>orbit.block_closed</span><span class="delimiter">)</span><span>
</span><span class="keyword1"><span class="command">next</span></span><span>
</span><span>  </span><span class="keyword3"><span class="command">show</span></span><span> </span><span class="string"><span class="delete"><span class="delete">"(inverse x ⋅ y)<span class="hidden">⇩</span><sub>R</sub> ` (H |⋅ x) = H |⋅ y"</span></span></span><span>
</span><span>    </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>force</span><span> </span><span>simp</span><span> </span><span>add</span><span class="delimiter">:</span><span> </span><span>right.translation_apply</span><span> </span><span>associative</span><span> </span><span>invertible_right_inverse2</span><span class="delimiter">)</span><span>
</span><span class="keyword1"><span class="command">qed</span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹p 52, ll 25--26›</span></span></span><span>
</span><span class="keyword1"><span class="command">theorem</span></span><span> </span><span>Right_Cosets_cardinality</span><span class="delimiter">:</span><span>
</span><span>  </span><span class="string"><span class="delete"><span class="delete">"⟦ x ∈ G; y ∈ G ⟧ ⟹ card (H |⋅ x) = card (H |⋅ y)"</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>fast</span><span> </span><span>intro</span><span class="delimiter">:</span><span> </span><span>bij_betw_same_card</span><span> </span><span>Right_Coset_bij</span><span class="delimiter">)</span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹p 52, l 27›</span></span></span><span>
</span><span class="keyword1"><span class="command">theorem</span></span><span> </span><span>Right_Coset_unit</span><span class="delimiter">:</span><span>
</span><span>  </span><span class="string"><span class="delete"><span class="delete">"H |⋅ 𝟭 = H"</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>force</span><span> </span><span>simp</span><span> </span><span>add</span><span class="delimiter">:</span><span> </span><span>Right_Coset_def</span><span class="delimiter">)</span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹p 52, l 27›</span></span></span><span>
</span><span class="keyword1"><span class="command">theorem</span></span><span> </span><span>Right_Coset_cardinality</span><span class="delimiter">:</span><span>
</span><span>  </span><span class="string"><span class="delete"><span class="delete">"x ∈ G ⟹ card (H |⋅ x) = card H"</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>Right_Coset_unit</span><span> </span><span>Right_Cosets_cardinality</span><span> </span><span>unit_closed</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>presburger</span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹p 52, ll 31--32›</span></span></span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span class="string"><span class="delete"><span class="delete">"index = card orbit.Partition"</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹Theorem 1.5›</span></span></span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹p 52, ll 33--35; p 53, ll 1--2›</span></span></span><span>
</span><span class="keyword1"><span class="command">theorem</span></span><span> </span><span>lagrange</span><span class="delimiter">:</span><span>
</span><span>  </span><span class="string"><span class="delete"><span class="delete">"finite G ⟹ card G = card H * index"</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">unfolding</span></span><span> </span><span>index_def</span><span>
</span><span>  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span> </span><span class="delimiter">(</span><span>subst</span><span> </span><span>card_partition</span><span class="delimiter">)</span><span>
</span><span>      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span> </span><span class="delimiter">(</span><span>auto</span><span> </span><span>simp</span><span class="delimiter">:</span><span> </span><span>finite_UnionD</span><span> </span><span>orbit.complete</span><span> </span><span>orbit.disjoint</span><span class="delimiter">)</span><span>
</span><span>  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span> </span><span class="delimiter">(</span><span>metis</span><span> </span><span>Right_Coset_cardinality</span><span> </span><span>Right_Coset_is_orbit</span><span> </span><span>orbit.Block_self</span><span> </span><span>orbit.element_exists</span><span class="delimiter">)</span><span>
</span><span>  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">done</span></span></span></span><span>
</span><span>
</span><span class="keyword2"><span class="keyword">end</span></span><span> </span><span class="comment"><span class="delete"><span class="delete"><span class="delete"><span class="delete">(* subgroup_of_group *)</span></span></span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹Left cosets›</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">context</span></span><span> </span><span>subgroup</span><span> </span><span class="keyword2"><span class="keyword">begin</span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹p 31, ll 11--12›</span></span></span><span>
</span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>image_of_inverse</span><span> </span><span class="delimiter">[</span><span>intro</span><span class="delimiter">,</span><span> </span><span>simp</span><span class="delimiter">]</span><span class="delimiter">:</span><span>
</span><span>  </span><span class="string"><span class="delete"><span class="delete">"x ∈ G ⟹ x ∈ inverse ` G"</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>metis</span><span> </span><span>image_eqI</span><span> </span><span>sub.invertible</span><span> </span><span>sub.invertible_inverse_closed</span><span> </span><span>sub.invertible_inverse_inverse</span><span> </span><span>subgroup_inverse_equality</span><span class="delimiter">)</span><span>
</span><span>
</span><span class="keyword2"><span class="keyword">end</span></span><span> </span><span class="comment"><span class="delete"><span class="delete"><span class="delete"><span class="delete">(* subgroup *)</span></span></span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">context</span></span><span> </span><span>group</span><span> </span><span class="keyword2"><span class="keyword">begin</span></span><span>
</span><span>
</span><span class="comment"><span class="delete"><span class="delete"><span class="delete"><span class="delete">(* Does Jacobson show this somewhere? *)</span></span></span></span></span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹p 53, ll 6--7›</span></span></span><span>
</span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>inverse_subgroupI</span><span class="delimiter">:</span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">assumes</span></span><span> </span><span>sub</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">"subgroup H G (⋅) 𝟭"</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">shows</span></span><span> </span><span class="string"><span class="delete"><span class="delete">"subgroup (inverse ` H) G (⋅) 𝟭"</span></span></span><span>
</span><span class="keyword1"><span class="command">proof</span></span><span> </span><span>-</span><span>
</span><span>  </span><span class="keyword1"><span class="command">from</span></span><span> </span><span>sub</span><span> </span><span class="keyword1"><span class="command">interpret</span></span><span> </span><span>subgroup</span><span> </span><span>H</span><span> </span><span>G</span><span> </span><span class="string"><span class="delete"><span class="delete">"(⋅)"</span></span></span><span> </span><span>𝟭</span><span> </span><span class="keyword1"><span class="command">.</span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">interpret</span></span><span> </span><span>inv</span><span class="delimiter">:</span><span> </span><span>monoid</span><span> </span><span class="string"><span class="delete"><span class="delete">"inverse ` H"</span></span></span><span> </span><span class="string"><span class="delete"><span class="delete">"(⋅)"</span></span></span><span> </span><span>𝟭</span><span>
</span><span>    </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>unfold_locales</span><span> </span><span class="delimiter">(</span><span>auto</span><span> </span><span>simp</span><span> </span><span>del</span><span class="delimiter">:</span><span> </span><span>subgroup_inverse_equality</span><span class="delimiter">)</span><span>
</span><span>  </span><span class="keyword1"><span class="command">interpret</span></span><span> </span><span>inv</span><span class="delimiter">:</span><span> </span><span>group</span><span> </span><span class="string"><span class="delete"><span class="delete">"inverse ` H"</span></span></span><span> </span><span class="string"><span class="delete"><span class="delete">"(⋅)"</span></span></span><span> </span><span>𝟭</span><span>
</span><span>    </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>unfold_locales</span><span> </span><span class="delimiter">(</span><span>force</span><span> </span><span>simp</span><span> </span><span>del</span><span class="delimiter">:</span><span> </span><span>subgroup_inverse_equality</span><span class="delimiter">)</span><span>
</span><span>  </span><span class="keyword3"><span class="command">show</span></span><span> </span><span class="var">?thesis</span><span>
</span><span>    </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>unfold_locales</span><span> </span><span class="delimiter">(</span><span>auto</span><span> </span><span>simp</span><span> </span><span>del</span><span class="delimiter">:</span><span> </span><span>subgroup_inverse_equality</span><span class="delimiter">)</span><span>
</span><span class="keyword1"><span class="command">qed</span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹p 53, ll 6--7›</span></span></span><span>
</span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>inverse_subgroupD</span><span class="delimiter">:</span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">assumes</span></span><span> </span><span>sub</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">"subgroup (inverse ` H) G (⋅) 𝟭"</span></span></span><span>
</span><span>    </span><span class="keyword2"><span class="keyword">and</span></span><span> </span><span>inv</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">"H ⊆ Units"</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">shows</span></span><span> </span><span class="string"><span class="delete"><span class="delete">"subgroup H G (⋅) 𝟭"</span></span></span><span>
</span><span class="keyword1"><span class="command">proof</span></span><span> </span><span>-</span><span>
</span><span>  </span><span class="keyword1"><span class="command">from</span></span><span> </span><span>sub</span><span> </span><span class="keyword1"><span class="command">have</span></span><span> </span><span class="string"><span class="delete"><span class="delete">"subgroup (inverse ` inverse ` H) G (⋅) 𝟭"</span></span></span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>rule</span><span> </span><span>inverse_subgroupI</span><span class="delimiter">)</span><span>
</span><span>  </span><span class="keyword1"><span class="command">moreover</span></span><span> </span><span class="keyword1"><span class="command">from</span></span><span> </span><span>inv</span><span> </span><span class="delimiter">[</span><span>THEN</span><span> </span><span>subsetD</span><span class="delimiter">,</span><span> </span><span>simplified</span><span> </span><span>Units_def</span><span class="delimiter">]</span><span> </span><span class="keyword1"><span class="command">have</span></span><span> </span><span class="string"><span class="delete"><span class="delete">"inverse ` inverse ` H = H"</span></span></span><span>
</span><span>    </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>simp</span><span> </span><span>cong</span><span class="delimiter">:</span><span> </span><span>image_cong</span><span> </span><span>add</span><span class="delimiter">:</span><span> </span><span>image_comp</span><span class="delimiter">)</span><span>
</span><span>  </span><span class="keyword1"><span class="command">ultimately</span></span><span> </span><span class="keyword3"><span class="command">show</span></span><span> </span><span class="var">?thesis</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>simp</span><span>
</span><span class="keyword1"><span class="command">qed</span></span><span>
</span><span>
</span><span class="keyword2"><span class="keyword">end</span></span><span> </span><span class="comment"><span class="delete"><span class="delete"><span class="delete"><span class="delete">(* group *)</span></span></span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">context</span></span><span> </span><span>subgroup_of_group</span><span> </span><span class="keyword2"><span class="keyword">begin</span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹p 53, l 6›</span></span></span><span>
</span><span class="keyword1"><span class="command">interpretation</span></span><span> </span><span>right_translations_of_group</span><span> </span><span class="keyword1"><span class="command">..</span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹
  @{term "translation ` H"} denotes Jacobson's @{text "H<span class="hidden">⇩</span><sub>R</sub>(G)"} and
  @{term "Translations"} denotes Jacobson's @{text "G<span class="hidden">⇩</span><sub>R</sub>"}.
›</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹p 53, ll 6--7›</span></span></span><span>
</span><span class="keyword1"><span class="command">theorem</span></span><span> </span><span>right_translations_of_subgroup_are_transformation_group</span><span> </span><span class="delimiter">[</span><span>intro</span><span class="delimiter">]</span><span class="delimiter">:</span><span>
</span><span>  </span><span class="string"><span class="delete"><span class="delete">"transformation_group (translation ` H) G"</span></span></span><span>
</span><span class="keyword1"><span class="command">proof</span></span><span> </span><span>-</span><span>
</span><span>  </span><span class="keyword1"><span class="command">have</span></span><span> </span><span class="string"><span class="delete"><span class="delete">"subgroup ((λa∈G. transformation.symmetric.inverse (a)<span class="hidden">⇩</span><sub>R</sub>) ` H) Translations (compose G) (identity G)"</span></span></span><span>
</span><span>    </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>rule</span><span> </span><span>image_subgroup</span><span class="delimiter">)</span><span> </span><span>unfold_locales</span><span>
</span><span>  </span><span class="keyword1"><span class="command">also</span></span><span> </span><span class="keyword1"><span class="command">have</span></span><span> </span><span class="string"><span class="delete"><span class="delete">"subgroup Translations transformation.Sym (compose G) (identity G)"</span></span></span><span> </span><span class="keyword1"><span class="command">..</span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">finally</span></span><span> </span><span class="keyword1"><span class="command">interpret</span></span><span> </span><span>left_coset</span><span class="delimiter">:</span><span> </span><span>subgroup</span><span> </span><span class="string"><span class="delete"><span class="delete">"translation ` H"</span></span></span><span> </span><span>transformation.Sym</span><span> </span><span class="string"><span class="delete"><span class="delete">"compose G"</span></span></span><span> </span><span class="string"><span class="delete"><span class="delete">"identity G"</span></span></span><span>
</span><span>    </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>auto</span><span> </span><span>intro</span><span class="delimiter">:</span><span> </span><span>transformation.symmetric.inverse_subgroupD</span><span> </span><span>cong</span><span class="delimiter">:</span><span> </span><span>image_cong</span><span>
</span><span>      </span><span>simp</span><span class="delimiter">:</span><span> </span><span>image_image</span><span> </span><span>transformation.symmetric.Units_def</span><span> </span><span>simp</span><span> </span><span>del</span><span class="delimiter">:</span><span> </span><span>translation_unit_eq</span><span class="delimiter">)</span><span>
</span><span>  </span><span class="keyword3"><span class="command">show</span></span><span> </span><span class="var">?thesis</span><span> </span><span class="keyword1"><span class="command">..</span></span><span>
</span><span class="keyword1"><span class="command">qed</span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹p 53, ll 6--7›</span></span></span><span>
</span><span class="keyword1"><span class="command">interpretation</span></span><span> </span><span>transformation_group</span><span> </span><span class="string"><span class="delete"><span class="delete">"translation ` H"</span></span></span><span> </span><span>G</span><span> </span><span class="keyword1"><span class="command">..</span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹Equation 23 for left cosets›</span></span></span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹p 53, ll 7--8›</span></span></span><span>
</span><span class="keyword1"><span class="command">theorem</span></span><span> </span><span>Left_Coset_is_orbit</span><span class="delimiter">:</span><span>
</span><span>  </span><span class="string"><span class="delete"><span class="delete">"x ∈ G ⟹ x ⋅| H = orbit.Class x"</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>translation_apply</span><span>
</span><span>  </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>auto</span><span> </span><span>simp</span><span class="delimiter">:</span><span> </span><span>orbit_equality</span><span> </span><span>Left_Coset_def</span><span class="delimiter">)</span><span> </span><span class="delimiter">(</span><span>metis</span><span> </span><span>imageI</span><span> </span><span>sub</span><span class="delimiter">)</span><span>
</span><span>
</span><span class="keyword2"><span class="keyword">end</span></span><span> </span><span class="comment"><span class="delete"><span class="delete"><span class="delete"><span class="delete">(* subgroup_of_group *)</span></span></span></span></span><span>
</span><span>
</span><span>
</span><span class="keyword1"><span class="command">subsection</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹Congruences.  Quotient Monoids and Groups›</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹Def 1.4›</span></span></span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹p 54, ll 19--22›</span></span></span><span>
</span><span class="keyword1"><span class="command">locale</span></span><span> </span><span>monoid_congruence</span><span> </span><span class="delimiter">=</span><span> </span><span>monoid</span><span> </span><span class="delimiter">+</span><span> </span><span>equivalence</span><span> </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span>S</span><span> </span><span class="delimiter">=</span><span> </span><span>M</span><span> </span><span class="delimiter">+</span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">assumes</span></span><span> </span><span>cong</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">"⟦ (a, a') ∈ E; (b, b') ∈ E ⟧ ⟹ (a ⋅ b, a' ⋅ b') ∈ E"</span></span></span><span>
</span><span class="keyword2"><span class="keyword">begin</span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹p 54, ll 26--28›</span></span></span><span>
</span><span class="keyword1"><span class="command">theorem</span></span><span> </span><span>Class_cong</span><span class="delimiter">:</span><span>
</span><span>  </span><span class="string"><span class="delete"><span class="delete">"⟦ Class a = Class a'; Class b = Class b'; a ∈ M; a' ∈ M; b ∈ M; b' ∈ M ⟧ ⟹ Class (a ⋅ b) = Class (a' ⋅ b')"</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>simp</span><span> </span><span>add</span><span class="delimiter">:</span><span> </span><span>Class_equivalence</span><span> </span><span>cong</span><span class="delimiter">)</span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹p 54, ll 28--30›</span></span></span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>quotient_composition</span><span> </span><span class="delimiter">(</span><span class="keyword2"><span class="keyword">infixl</span></span><span> </span><span class="string"><span class="delete"><span class="delete">"[⋅]"</span></span></span><span> </span><span>70</span><span class="delimiter">)</span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">"quotient_composition = (λA ∈ M / E. λB ∈ M / E. THE C. ∃a ∈ A. ∃b ∈ B. C = Class (a ⋅ b))"</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹p 54, ll 28--30›</span></span></span><span>
</span><span class="keyword1"><span class="command">theorem</span></span><span> </span><span>Class_commutes_with_composition</span><span class="delimiter">:</span><span>
</span><span>  </span><span class="string"><span class="delete"><span class="delete">"⟦ a ∈ M; b ∈ M ⟧ ⟹ Class a [⋅] Class b = Class (a ⋅ b)"</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>auto</span><span> </span><span>simp</span><span class="delimiter">:</span><span> </span><span>quotient_composition_def</span><span> </span><span>intro</span><span class="delimiter">:</span><span> </span><span>Class_cong</span><span> </span><span class="delimiter">[</span><span>OF</span><span> </span><span>Class_eq</span><span> </span><span>Class_eq</span><span class="delimiter">]</span><span> </span><span>del</span><span class="delimiter">:</span><span> </span><span>equalityI</span><span class="delimiter">)</span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹p 54, ll 30--31›</span></span></span><span>
</span><span class="keyword1"><span class="command">theorem</span></span><span> </span><span>quotient_composition_closed</span><span> </span><span class="delimiter">[</span><span>intro</span><span class="delimiter">,</span><span> </span><span>simp</span><span class="delimiter">]</span><span class="delimiter">:</span><span>
</span><span>  </span><span class="string"><span class="delete"><span class="delete">"⟦ A ∈ M / E; B ∈ M / E ⟧ ⟹ A [⋅] B ∈ M / E"</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>erule</span><span> </span><span>quotient_ClassE</span><span class="delimiter">)</span><span class="delimiter">+</span><span> </span><span class="delimiter">(</span><span>simp</span><span> </span><span>add</span><span class="delimiter">:</span><span> </span><span>Class_commutes_with_composition</span><span class="delimiter">)</span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹p 54, l 32; p 55, ll 1--3›</span></span></span><span>
</span><span class="keyword1"><span class="command">sublocale</span></span><span> </span><span>quotient</span><span class="delimiter">:</span><span> </span><span>monoid</span><span> </span><span class="string"><span class="delete"><span class="delete">"M / E"</span></span></span><span> </span><span class="string"><span class="delete"><span class="delete">"([⋅])"</span></span></span><span> </span><span class="string"><span class="delete"><span class="delete">"Class 𝟭"</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>unfold_locales</span><span> </span><span class="delimiter">(</span><span>auto</span><span> </span><span>simp</span><span class="delimiter">:</span><span> </span><span>Class_commutes_with_composition</span><span> </span><span>associative</span><span> </span><span>elim</span><span class="delimiter">!</span><span class="delimiter">:</span><span> </span><span>quotient_ClassE</span><span class="delimiter">)</span><span>
</span><span>
</span><span class="keyword2"><span class="keyword">end</span></span><span> </span><span class="comment"><span class="delete"><span class="delete"><span class="delete"><span class="delete">(* monoid_congruence *)</span></span></span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹p 55, ll 16--17›</span></span></span><span>
</span><span class="keyword1"><span class="command">locale</span></span><span> </span><span>group_congruence</span><span> </span><span class="delimiter">=</span><span> </span><span>group</span><span> </span><span class="delimiter">+</span><span> </span><span>monoid_congruence</span><span> </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span>M</span><span> </span><span class="delimiter">=</span><span> </span><span>G</span><span> </span><span class="keyword2"><span class="keyword">begin</span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹p 55, ll 16--17›</span></span></span><span>
</span><span class="keyword1"><span class="command">notation</span></span><span> </span><span>quotient_composition</span><span> </span><span class="delimiter">(</span><span class="keyword2"><span class="keyword">infixl</span></span><span> </span><span class="string"><span class="delete"><span class="delete">"[⋅]"</span></span></span><span> </span><span>70</span><span class="delimiter">)</span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹p 55, l 18›</span></span></span><span>
</span><span class="keyword1"><span class="command">theorem</span></span><span> </span><span>Class_right_inverse</span><span class="delimiter">:</span><span>
</span><span>  </span><span class="string"><span class="delete"><span class="delete">"a ∈ G ⟹ Class a [⋅] Class (inverse a) = Class 𝟭"</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>simp</span><span> </span><span>add</span><span class="delimiter">:</span><span> </span><span>Class_commutes_with_composition</span><span class="delimiter">)</span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹p 55, l 18›</span></span></span><span>
</span><span class="keyword1"><span class="command">theorem</span></span><span> </span><span>Class_left_inverse</span><span class="delimiter">:</span><span>
</span><span>  </span><span class="string"><span class="delete"><span class="delete">"a ∈ G ⟹ Class (inverse a) [⋅] Class a = Class 𝟭"</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>simp</span><span> </span><span>add</span><span class="delimiter">:</span><span> </span><span>Class_commutes_with_composition</span><span class="delimiter">)</span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹p 55, l 18›</span></span></span><span>
</span><span class="keyword1"><span class="command">theorem</span></span><span> </span><span>Class_invertible</span><span class="delimiter">:</span><span>
</span><span>  </span><span class="string"><span class="delete"><span class="delete">"a ∈ G ⟹ quotient.invertible (Class a)"</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>blast</span><span> </span><span>intro</span><span class="delimiter">!</span><span class="delimiter">:</span><span> </span><span>Class_right_inverse</span><span> </span><span>Class_left_inverse</span><span class="delimiter">)</span><span class="delimiter">+</span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹p 55, l 18›</span></span></span><span>
</span><span class="keyword1"><span class="command">theorem</span></span><span> </span><span>Class_commutes_with_inverse</span><span class="delimiter">:</span><span>
</span><span>  </span><span class="string"><span class="delete"><span class="delete">"a ∈ G ⟹ quotient.inverse (Class a) = Class (inverse a)"</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>rule</span><span> </span><span>quotient.inverse_equality</span><span class="delimiter">)</span><span> </span><span class="delimiter">(</span><span>auto</span><span> </span><span>simp</span><span class="delimiter">:</span><span> </span><span>Class_right_inverse</span><span> </span><span>Class_left_inverse</span><span class="delimiter">)</span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹p 55, l 17›</span></span></span><span>
</span><span class="keyword1"><span class="command">sublocale</span></span><span> </span><span>quotient</span><span class="delimiter">:</span><span> </span><span>group</span><span> </span><span class="string"><span class="delete"><span class="delete">"G / E"</span></span></span><span> </span><span class="string"><span class="delete"><span class="delete">"([⋅])"</span></span></span><span> </span><span class="string"><span class="delete"><span class="delete">"Class 𝟭"</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>unfold_locales</span><span> </span><span class="delimiter">(</span><span>metis</span><span> </span><span>Block_self</span><span> </span><span>Class_invertible</span><span> </span><span>element_exists</span><span class="delimiter">)</span><span>
</span><span>
</span><span class="keyword2"><span class="keyword">end</span></span><span> </span><span class="comment"><span class="delete"><span class="delete"><span class="delete"><span class="delete">(* group_congruence *)</span></span></span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹Def 1.5›</span></span></span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹p 55, ll 22--25›</span></span></span><span>
</span><span class="keyword1"><span class="command">locale</span></span><span> </span><span>normal_subgroup</span><span> </span><span class="delimiter">=</span><span>
</span><span>  </span><span>subgroup_of_group</span><span> </span><span>K</span><span> </span><span>G</span><span> </span><span class="string"><span class="delete"><span class="delete">"(⋅)"</span></span></span><span> </span><span>𝟭</span><span> </span><span class="keyword2"><span class="keyword">for</span></span><span> </span><span>K</span><span> </span><span class="keyword2"><span class="keyword">and</span></span><span> </span><span>G</span><span> </span><span class="keyword2"><span class="keyword">and</span></span><span> </span><span>composition</span><span> </span><span class="delimiter">(</span><span class="keyword2"><span class="keyword">infixl</span></span><span> </span><span class="string"><span class="delete"><span class="delete">"⋅"</span></span></span><span> </span><span>70</span><span class="delimiter">)</span><span> </span><span class="keyword2"><span class="keyword">and</span></span><span> </span><span>unit</span><span> </span><span class="delimiter">(</span><span class="string"><span class="delete"><span class="delete">"𝟭"</span></span></span><span class="delimiter">)</span><span> </span><span class="delimiter">+</span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">assumes</span></span><span> </span><span>normal</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">"⟦ g ∈ G; k ∈ K ⟧ ⟹ inverse g ⋅ k ⋅ g ∈ K"</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹Lemmas from the proof of Thm 1.6›</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">context</span></span><span> </span><span>subgroup_of_group</span><span> </span><span class="keyword2"><span class="keyword">begin</span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹We use @{term H} for @{term K}.›</span></span></span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹p 56, ll 14--16›</span></span></span><span>
</span><span class="keyword1"><span class="command">theorem</span></span><span> </span><span>Left_equals_Right_coset_implies_normality</span><span class="delimiter">:</span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">assumes</span></span><span> </span><span class="delimiter">[</span><span>simp</span><span class="delimiter">]</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">"⋀g. g ∈ G ⟹ g ⋅| H = H |⋅ g"</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">shows</span></span><span> </span><span class="string"><span class="delete"><span class="delete">"normal_subgroup H G (⋅) 𝟭"</span></span></span><span>
</span><span class="keyword1"><span class="command">proof</span></span><span>
</span><span>  </span><span class="keyword3"><span class="command">fix</span></span><span> </span><span>g</span><span> </span><span>k</span><span>
</span><span>  </span><span class="keyword3"><span class="command">assume</span></span><span> </span><span class="delimiter">[</span><span>simp</span><span class="delimiter">]</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">"g ∈ G"</span></span></span><span> </span><span class="string"><span class="delete"><span class="delete">"k ∈ H"</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">have</span></span><span> </span><span class="string"><span class="delete"><span class="delete">"k ⋅ g ∈ g ⋅| H"</span></span></span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>auto</span><span>
</span><span>  </span><span class="keyword1"><span class="command">then</span></span><span> </span><span class="keyword3"><span class="command">obtain</span></span><span> </span><span>k'</span><span> </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">"k ⋅ g = g ⋅ k'"</span></span></span><span> </span><span class="keyword2"><span class="keyword">and</span></span><span> </span><span class="string"><span class="delete"><span class="delete">"k' ∈ H"</span></span></span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>blast</span><span>
</span><span>  </span><span class="keyword1"><span class="command">then</span></span><span> </span><span class="keyword3"><span class="command">show</span></span><span> </span><span class="string"><span class="delete"><span class="delete">"inverse g ⋅ k ⋅ g ∈ H"</span></span></span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>simp</span><span> </span><span>add</span><span class="delimiter">:</span><span> </span><span>associative</span><span> </span><span>invertible_left_inverse2</span><span class="delimiter">)</span><span>
</span><span class="keyword1"><span class="command">qed</span></span><span>
</span><span>
</span><span class="keyword2"><span class="keyword">end</span></span><span> </span><span class="comment"><span class="delete"><span class="delete"><span class="delete"><span class="delete">(* subgroup_of_group *)</span></span></span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹Thm 1.6, first part›</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">context</span></span><span> </span><span>group_congruence</span><span> </span><span class="keyword2"><span class="keyword">begin</span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹Jacobson's $K$›</span></span></span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹p 56, l 29›</span></span></span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span class="string"><span class="delete"><span class="delete">"Normal = Class 𝟭"</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹p 56, ll 3--6›</span></span></span><span>
</span><span class="keyword1"><span class="command">interpretation</span></span><span> </span><span>subgroup</span><span> </span><span class="string"><span class="delete"><span class="delete">"Normal"</span></span></span><span> </span><span>G</span><span> </span><span class="string"><span class="delete"><span class="delete">"(⋅)"</span></span></span><span> </span><span>𝟭</span><span>
</span><span>  </span><span class="keyword1"><span class="command">unfolding</span></span><span> </span><span>Normal_def</span><span>
</span><span class="keyword1"><span class="command">proof</span></span><span> </span><span class="delimiter">(</span><span>rule</span><span> </span><span>subgroupI</span><span class="delimiter">)</span><span>
</span><span>  </span><span class="keyword3"><span class="command">fix</span></span><span> </span><span>k1</span><span> </span><span class="keyword2"><span class="keyword">and</span></span><span> </span><span>k2</span><span>
</span><span>  </span><span class="keyword3"><span class="command">assume</span></span><span> </span><span>K</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">"k1 ∈ Class 𝟭"</span></span></span><span> </span><span class="string"><span class="delete"><span class="delete">"k2 ∈ Class 𝟭"</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">then</span></span><span> </span><span class="keyword1"><span class="command">have</span></span><span> </span><span class="string"><span class="delete"><span class="delete">"k1 ⋅ k2 ∈ Class (k1 ⋅ k2)"</span></span></span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>blast</span><span>
</span><span>  </span><span class="keyword1"><span class="command">also</span></span><span> </span><span class="keyword1"><span class="command">have</span></span><span> </span><span class="string"><span class="delete"><span class="delete">"… = Class k1 [⋅] Class k2"</span></span></span><span> </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>K</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>auto</span><span> </span><span>simp</span><span> </span><span>add</span><span class="delimiter">:</span><span> </span><span>Class_commutes_with_composition</span><span> </span><span>Class_closed</span><span class="delimiter">)</span><span>
</span><span>  </span><span class="keyword1"><span class="command">also</span></span><span> </span><span class="keyword1"><span class="command">have</span></span><span> </span><span class="string"><span class="delete"><span class="delete">"… = Class 𝟭 [⋅] Class 𝟭"</span></span></span><span> </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>K</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>metis</span><span> </span><span>ClassD</span><span> </span><span>Class_eq</span><span> </span><span>unit_closed</span><span class="delimiter">)</span><span>
</span><span>  </span><span class="keyword1"><span class="command">also</span></span><span> </span><span class="keyword1"><span class="command">have</span></span><span> </span><span class="string"><span class="delete"><span class="delete">"… = Class 𝟭"</span></span></span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>simp</span><span>
</span><span>  </span><span class="keyword1"><span class="command">finally</span></span><span> </span><span class="keyword3"><span class="command">show</span></span><span> </span><span class="string"><span class="delete"><span class="delete">"k1 ⋅ k2 ∈ Class 𝟭"</span></span></span><span> </span><span class="keyword1"><span class="command">.</span></span><span>
</span><span class="keyword1"><span class="command">next</span></span><span>
</span><span>  </span><span class="keyword3"><span class="command">fix</span></span><span> </span><span>k</span><span>
</span><span>  </span><span class="keyword3"><span class="command">assume</span></span><span> </span><span>K</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">"k ∈ Class 𝟭"</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">then</span></span><span> </span><span class="keyword1"><span class="command">have</span></span><span> </span><span class="string"><span class="delete"><span class="delete">"inverse k ∈ Class (inverse k)"</span></span></span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>blast</span><span>
</span><span>  </span><span class="keyword1"><span class="command">also</span></span><span> </span><span class="keyword1"><span class="command">have</span></span><span> </span><span class="string"><span class="delete"><span class="delete">"… = quotient.inverse (Class k)"</span></span></span><span> </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>Class_commutes_with_inverse</span><span> </span><span>K</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>blast</span><span>
</span><span>  </span><span class="keyword1"><span class="command">also</span></span><span> </span><span class="keyword1"><span class="command">have</span></span><span> </span><span class="string"><span class="delete"><span class="delete">"… = quotient.inverse (Class 𝟭)"</span></span></span><span> </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>Block_self</span><span> </span><span>K</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>auto</span><span>
</span><span>  </span><span class="keyword1"><span class="command">also</span></span><span> </span><span class="keyword1"><span class="command">have</span></span><span> </span><span class="string"><span class="delete"><span class="delete">"… = Class 𝟭"</span></span></span><span> </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>quotient.inverse_unit</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>blast</span><span>
</span><span>  </span><span class="keyword1"><span class="command">finally</span></span><span> </span><span class="keyword3"><span class="command">show</span></span><span> </span><span class="string"><span class="delete"><span class="delete">"inverse k ∈ Class 𝟭"</span></span></span><span> </span><span class="keyword1"><span class="command">.</span></span><span>
</span><span class="keyword1"><span class="command">qed</span></span><span> </span><span>auto</span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹Coset notation›</span></span></span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹p 56, ll 5--6›</span></span></span><span>
</span><span class="keyword1"><span class="command">interpretation</span></span><span> </span><span>subgroup_of_group</span><span> </span><span class="string"><span class="delete"><span class="delete">"Normal"</span></span></span><span> </span><span>G</span><span> </span><span class="string"><span class="delete"><span class="delete">"(⋅)"</span></span></span><span> </span><span>𝟭</span><span> </span><span class="keyword1"><span class="command">..</span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹Equation 25 for right cosets›</span></span></span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹p 55, ll 29--30; p 56, ll 6--11›</span></span></span><span>
</span><span class="keyword1"><span class="command">theorem</span></span><span> </span><span>Right_Coset_Class_unit</span><span class="delimiter">:</span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">assumes</span></span><span> </span><span>g</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">"g ∈ G"</span></span></span><span> </span><span class="keyword2"><span class="keyword">shows</span></span><span> </span><span class="string"><span class="delete"><span class="delete">"Normal |⋅ g = Class g"</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">unfolding</span></span><span> </span><span>Normal_def</span><span>
</span><span class="keyword1"><span class="command">proof</span></span><span> </span><span>auto</span><span>
</span><span>  </span><span class="keyword3"><span class="command">fix</span></span><span> </span><span>a</span><span>  </span><span class="comment">― ‹ll 6--8›</span><span>
</span><span>  </span><span class="keyword3"><span class="command">assume</span></span><span> </span><span>a</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">"a ∈ Class g"</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">from</span></span><span> </span><span>a</span><span> </span><span>g</span><span> </span><span class="keyword1"><span class="command">have</span></span><span> </span><span class="string"><span class="delete"><span class="delete">"a ⋅ inverse g ∈ Class (a ⋅ inverse g)"</span></span></span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>blast</span><span>
</span><span>  </span><span class="keyword1"><span class="command">also</span></span><span> </span><span class="keyword1"><span class="command">from</span></span><span> </span><span>a</span><span> </span><span>g</span><span> </span><span class="keyword1"><span class="command">have</span></span><span> </span><span class="string"><span class="delete"><span class="delete">"… = Class a [⋅] Class (inverse g)"</span></span></span><span>
</span><span>    </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>simp</span><span> </span><span>add</span><span class="delimiter">:</span><span> </span><span>Class_commutes_with_composition</span><span> </span><span>block_closed</span><span class="delimiter">)</span><span>
</span><span>  </span><span class="keyword1"><span class="command">also</span></span><span> </span><span class="keyword1"><span class="command">from</span></span><span> </span><span>a</span><span> </span><span>g</span><span> </span><span class="keyword1"><span class="command">have</span></span><span> </span><span class="string"><span class="delete"><span class="delete">"… = Class g [⋅] quotient.inverse (Class g)"</span></span></span><span>
</span><span>    </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>Block_self</span><span> </span><span>Class_commutes_with_inverse</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>auto</span><span>
</span><span>  </span><span class="keyword1"><span class="command">also</span></span><span> </span><span class="keyword1"><span class="command">from</span></span><span> </span><span>g</span><span> </span><span class="keyword1"><span class="command">have</span></span><span> </span><span class="string"><span class="delete"><span class="delete">"… = Class 𝟭"</span></span></span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>simp</span><span>
</span><span>  </span><span class="keyword1"><span class="command">finally</span></span><span> </span><span class="keyword3"><span class="command">show</span></span><span> </span><span class="string"><span class="delete"><span class="delete">"a ∈ Class 𝟭 |⋅ g"</span></span></span><span>
</span><span>    </span><span class="keyword1"><span class="command">unfolding</span></span><span> </span><span>Right_Coset_def</span><span>
</span><span>    </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>simp</span><span> </span><span class="delimiter">(</span><span>metis</span><span> </span><span>Class_closed</span><span> </span><span>a</span><span> </span><span>associative</span><span> </span><span>g</span><span> </span><span>inverse_equality</span><span> </span><span>invertible</span><span> </span><span>invertible_def</span><span> </span><span>right_unit</span><span class="delimiter">)</span><span> 
</span><span class="keyword1"><span class="command">next</span></span><span>
</span><span>  </span><span class="keyword3"><span class="command">fix</span></span><span> </span><span>a</span><span>  </span><span class="comment">― ‹ll 8--9›</span><span>
</span><span>  </span><span class="keyword3"><span class="command">assume</span></span><span> </span><span>a</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">"a ∈ Class 𝟭 |⋅ g"</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">then</span></span><span> </span><span class="keyword3"><span class="command">obtain</span></span><span> </span><span>k</span><span> </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span>eq</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">"a = k ⋅ g"</span></span></span><span> </span><span class="keyword2"><span class="keyword">and</span></span><span> </span><span>k</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">"k ∈ Class 𝟭"</span></span></span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>blast</span><span>
</span><span>  </span><span class="keyword1"><span class="command">with</span></span><span> </span><span>g</span><span> </span><span class="keyword1"><span class="command">have</span></span><span> </span><span class="string"><span class="delete"><span class="delete">"Class a = Class k [⋅] Class g"</span></span></span><span> </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>Class_commutes_with_composition</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>auto</span><span>
</span><span>  </span><span class="keyword1"><span class="command">also</span></span><span> </span><span class="keyword1"><span class="command">from</span></span><span> </span><span>k</span><span> </span><span class="keyword1"><span class="command">have</span></span><span> </span><span class="string"><span class="delete"><span class="delete">"… = Class 𝟭 [⋅] Class g"</span></span></span><span> </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>Block_self</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>auto</span><span>
</span><span>  </span><span class="keyword1"><span class="command">also</span></span><span> </span><span class="keyword1"><span class="command">from</span></span><span> </span><span>g</span><span> </span><span class="keyword1"><span class="command">have</span></span><span> </span><span class="string"><span class="delete"><span class="delete">"… = Class g"</span></span></span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>simp</span><span>
</span><span>  </span><span class="keyword1"><span class="command">finally</span></span><span> </span><span class="keyword3"><span class="command">show</span></span><span> </span><span class="string"><span class="delete"><span class="delete">"a ∈ Class g"</span></span></span><span> </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>g</span><span> </span><span>eq</span><span> </span><span>k</span><span> </span><span>composition_closed</span><span> </span><span>quotient.unit_closed</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>blast</span><span>
</span><span class="keyword1"><span class="command">qed</span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹Equation 25 for left cosets›</span></span></span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹p 55, ll 29--30; p 56, ll 6--11›</span></span></span><span>
</span><span class="keyword1"><span class="command">theorem</span></span><span> </span><span>Left_Coset_Class_unit</span><span class="delimiter">:</span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">assumes</span></span><span> </span><span>g</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">"g ∈ G"</span></span></span><span> </span><span class="keyword2"><span class="keyword">shows</span></span><span> </span><span class="string"><span class="delete"><span class="delete">"g ⋅| Normal = Class g"</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">unfolding</span></span><span> </span><span>Normal_def</span><span>
</span><span class="keyword1"><span class="command">proof</span></span><span> </span><span>auto</span><span>
</span><span>  </span><span class="keyword3"><span class="command">fix</span></span><span> </span><span>a</span><span>  </span><span class="comment">― ‹ll 6--8›</span><span>
</span><span>  </span><span class="keyword3"><span class="command">assume</span></span><span> </span><span>a</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">"a ∈ Class g"</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">from</span></span><span> </span><span>a</span><span> </span><span>g</span><span> </span><span class="keyword1"><span class="command">have</span></span><span> </span><span class="string"><span class="delete"><span class="delete">"inverse g ⋅ a ∈ Class (inverse g ⋅ a)"</span></span></span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>blast</span><span>
</span><span>  </span><span class="keyword1"><span class="command">also</span></span><span> </span><span class="keyword1"><span class="command">from</span></span><span> </span><span>a</span><span> </span><span>g</span><span> </span><span class="keyword1"><span class="command">have</span></span><span> </span><span class="string"><span class="delete"><span class="delete">"… = Class (inverse g) [⋅] Class a"</span></span></span><span>
</span><span>    </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>simp</span><span> </span><span>add</span><span class="delimiter">:</span><span> </span><span>Class_commutes_with_composition</span><span> </span><span>block_closed</span><span class="delimiter">)</span><span>
</span><span>  </span><span class="keyword1"><span class="command">also</span></span><span> </span><span class="keyword1"><span class="command">from</span></span><span> </span><span>a</span><span> </span><span>g</span><span> </span><span class="keyword1"><span class="command">have</span></span><span> </span><span class="string"><span class="delete"><span class="delete">"… = quotient.inverse (Class g) [⋅] Class g"</span></span></span><span>
</span><span>    </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>Block_self</span><span> </span><span>Class_commutes_with_inverse</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>auto</span><span>
</span><span>  </span><span class="keyword1"><span class="command">also</span></span><span> </span><span class="keyword1"><span class="command">from</span></span><span> </span><span>g</span><span> </span><span class="keyword1"><span class="command">have</span></span><span> </span><span class="string"><span class="delete"><span class="delete">"… = Class 𝟭"</span></span></span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>simp</span><span>
</span><span>  </span><span class="keyword1"><span class="command">finally</span></span><span> </span><span class="keyword3"><span class="command">show</span></span><span> </span><span class="string"><span class="delete"><span class="delete">"a ∈ g ⋅| Class 𝟭"</span></span></span><span>
</span><span>    </span><span class="keyword1"><span class="command">unfolding</span></span><span> </span><span>Left_Coset_def</span><span>
</span><span>    </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>simp</span><span> </span><span class="delimiter">(</span><span>metis</span><span> </span><span>Class_closed</span><span> </span><span>a</span><span> </span><span>associative</span><span> </span><span>g</span><span> </span><span>inverse_equality</span><span> </span><span>invertible</span><span> </span><span>invertible_def</span><span> </span><span>right_unit</span><span class="delimiter">)</span><span> 
</span><span class="keyword1"><span class="command">next</span></span><span>
</span><span>  </span><span class="keyword3"><span class="command">fix</span></span><span> </span><span>a</span><span>  </span><span class="comment">― ‹ll 8--9, ``the same thing holds''›</span><span>
</span><span>  </span><span class="keyword3"><span class="command">assume</span></span><span> </span><span>a</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">"a ∈ g ⋅| Class 𝟭"</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">then</span></span><span> </span><span class="keyword3"><span class="command">obtain</span></span><span> </span><span>k</span><span> </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span>eq</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">"a = g ⋅ k"</span></span></span><span> </span><span class="keyword2"><span class="keyword">and</span></span><span> </span><span>k</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">"k ∈ Class 𝟭"</span></span></span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>blast</span><span>
</span><span>  </span><span class="keyword1"><span class="command">with</span></span><span> </span><span>g</span><span> </span><span class="keyword1"><span class="command">have</span></span><span> </span><span class="string"><span class="delete"><span class="delete">"Class a = Class g [⋅] Class k"</span></span></span><span> </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>Class_commutes_with_composition</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>auto</span><span>
</span><span>  </span><span class="keyword1"><span class="command">also</span></span><span> </span><span class="keyword1"><span class="command">from</span></span><span> </span><span>k</span><span> </span><span class="keyword1"><span class="command">have</span></span><span> </span><span class="string"><span class="delete"><span class="delete">"… = Class g [⋅] Class 𝟭"</span></span></span><span> </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>Block_self</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>auto</span><span>
</span><span>  </span><span class="keyword1"><span class="command">also</span></span><span> </span><span class="keyword1"><span class="command">from</span></span><span> </span><span>g</span><span> </span><span class="keyword1"><span class="command">have</span></span><span> </span><span class="string"><span class="delete"><span class="delete">"… = Class g"</span></span></span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>simp</span><span>
</span><span>  </span><span class="keyword1"><span class="command">finally</span></span><span> </span><span class="keyword3"><span class="command">show</span></span><span> </span><span class="string"><span class="delete"><span class="delete">"a ∈ Class g"</span></span></span><span> </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>g</span><span> </span><span>eq</span><span> </span><span>k</span><span> </span><span>composition_closed</span><span> </span><span>quotient.unit_closed</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>blast</span><span>
</span><span class="keyword1"><span class="command">qed</span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹Thm 1.6, statement of first part›</span></span></span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹p 55, ll 28--29; p 56, ll 12--16›</span></span></span><span>
</span><span class="keyword1"><span class="command">theorem</span></span><span> </span><span>Class_unit_is_normal</span><span class="delimiter">:</span><span>
</span><span>  </span><span class="string"><span class="delete"><span class="delete">"normal_subgroup Normal G (⋅) 𝟭"</span></span></span><span>
</span><span class="keyword1"><span class="command">proof</span></span><span> </span><span>-</span><span>
</span><span>  </span><span class="keyword1"><span class="command">{</span></span><span>
</span><span>    </span><span class="keyword3"><span class="command">fix</span></span><span> </span><span>g</span><span>
</span><span>    </span><span class="keyword3"><span class="command">assume</span></span><span> </span><span class="string"><span class="delete"><span class="delete">"g ∈ G"</span></span></span><span>
</span><span>    </span><span class="keyword1"><span class="command">then</span></span><span> </span><span class="keyword1"><span class="command">have</span></span><span> </span><span class="string"><span class="delete"><span class="delete">"g ⋅| Normal = Normal |⋅ g"</span></span></span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>simp</span><span> </span><span>add</span><span class="delimiter">:</span><span> </span><span>Right_Coset_Class_unit</span><span> </span><span>Left_Coset_Class_unit</span><span class="delimiter">)</span><span>
</span><span>  </span><span class="keyword1"><span class="command">}</span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">then</span></span><span> </span><span class="keyword3"><span class="command">show</span></span><span> </span><span class="var">?thesis</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>rule</span><span> </span><span>Left_equals_Right_coset_implies_normality</span><span class="delimiter">)</span><span>
</span><span class="keyword1"><span class="command">qed</span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">sublocale</span></span><span> </span><span>normal</span><span class="delimiter">:</span><span> </span><span>normal_subgroup</span><span> </span><span>Normal</span><span> </span><span>G</span><span> </span><span class="string"><span class="delete"><span class="delete">"(⋅)"</span></span></span><span> </span><span>𝟭</span><span>
</span><span>  </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>fact</span><span> </span><span>Class_unit_is_normal</span><span class="delimiter">)</span><span>
</span><span>
</span><span class="keyword2"><span class="keyword">end</span></span><span> </span><span class="comment"><span class="delete"><span class="delete"><span class="delete"><span class="delete">(* group_congruence *)</span></span></span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">context</span></span><span> </span><span>normal_subgroup</span><span> </span><span class="keyword2"><span class="keyword">begin</span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹p 56, ll 16--19›</span></span></span><span>
</span><span class="keyword1"><span class="command">theorem</span></span><span> </span><span>Left_equals_Right_coset</span><span class="delimiter">:</span><span>
</span><span>  </span><span class="string"><span class="delete"><span class="delete">"g ∈ G ⟹ g ⋅| K = K |⋅ g"</span></span></span><span>
</span><span class="keyword1"><span class="command">proof</span></span><span>
</span><span>  </span><span class="keyword3"><span class="command">assume</span></span><span> </span><span class="delimiter">[</span><span>simp</span><span class="delimiter">]</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">"g ∈ G"</span></span></span><span>
</span><span>  </span><span class="keyword3"><span class="command">show</span></span><span> </span><span class="string"><span class="delete"><span class="delete">"K |⋅ g ⊆ g ⋅| K"</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">proof</span></span><span>
</span><span>    </span><span class="keyword3"><span class="command">fix</span></span><span> </span><span>x</span><span>
</span><span>    </span><span class="keyword3"><span class="command">assume</span></span><span> </span><span>x</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">"x ∈ K |⋅ g"</span></span></span><span>
</span><span>    </span><span class="keyword1"><span class="command">then</span></span><span> </span><span class="keyword3"><span class="command">obtain</span></span><span> </span><span>k</span><span> </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">"x = k ⋅ g"</span></span></span><span> </span><span class="keyword2"><span class="keyword">and</span></span><span> </span><span class="delimiter">[</span><span>simp</span><span class="delimiter">]</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">"k ∈ K"</span></span></span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>auto</span><span> </span><span>simp</span><span> </span><span>add</span><span class="delimiter">:</span><span> </span><span>Right_Coset_def</span><span class="delimiter">)</span><span>
</span><span>    </span><span class="keyword1"><span class="command">then</span></span><span> </span><span class="keyword1"><span class="command">have</span></span><span> </span><span class="string"><span class="delete"><span class="delete">"x = g ⋅ (inverse g ⋅ k ⋅ g)"</span></span></span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>simp</span><span> </span><span>add</span><span class="delimiter">:</span><span> </span><span>associative</span><span> </span><span>invertible_right_inverse2</span><span class="delimiter">)</span><span>
</span><span>    </span><span class="keyword1"><span class="command">also</span></span><span> </span><span class="keyword1"><span class="command">from</span></span><span> </span><span>normal</span><span> </span><span class="keyword1"><span class="command">have</span></span><span> </span><span class="string"><span class="delete"><span class="delete">"… ∈ g ⋅| K"</span></span></span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>auto</span><span> </span><span>simp</span><span> </span><span>add</span><span class="delimiter">:</span><span> </span><span>Left_Coset_def</span><span class="delimiter">)</span><span>
</span><span>    </span><span class="keyword1"><span class="command">finally</span></span><span> </span><span class="keyword3"><span class="command">show</span></span><span> </span><span class="string"><span class="delete"><span class="delete">"x ∈ g ⋅| K"</span></span></span><span> </span><span class="keyword1"><span class="command">.</span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">qed</span></span><span>
</span><span class="keyword1"><span class="command">next</span></span><span>
</span><span>  </span><span class="keyword3"><span class="command">assume</span></span><span> </span><span class="delimiter">[</span><span>simp</span><span class="delimiter">]</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">"g ∈ G"</span></span></span><span>
</span><span>  </span><span class="keyword3"><span class="command">show</span></span><span> </span><span class="string"><span class="delete"><span class="delete">"g ⋅| K ⊆ K |⋅ g"</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">proof</span></span><span>
</span><span>    </span><span class="keyword3"><span class="command">fix</span></span><span> </span><span>x</span><span>
</span><span>    </span><span class="keyword3"><span class="command">assume</span></span><span> </span><span>x</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">"x ∈ g ⋅| K"</span></span></span><span>
</span><span>    </span><span class="keyword1"><span class="command">then</span></span><span> </span><span class="keyword3"><span class="command">obtain</span></span><span> </span><span>k</span><span> </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">"x = g ⋅ k"</span></span></span><span> </span><span class="keyword2"><span class="keyword">and</span></span><span> </span><span class="delimiter">[</span><span>simp</span><span class="delimiter">]</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">"k ∈ K"</span></span></span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>auto</span><span> </span><span>simp</span><span> </span><span>add</span><span class="delimiter">:</span><span> </span><span>Left_Coset_def</span><span class="delimiter">)</span><span>
</span><span>    </span><span class="keyword1"><span class="command">then</span></span><span> </span><span class="keyword1"><span class="command">have</span></span><span> </span><span class="string"><span class="delete"><span class="delete">"x = (inverse (inverse g) ⋅ k ⋅ inverse g) ⋅ g"</span></span></span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>simp</span><span> </span><span>add</span><span class="delimiter">:</span><span> </span><span>associative</span><span> </span><span>del</span><span class="delimiter">:</span><span> </span><span>invertible_right_inverse</span><span class="delimiter">)</span><span>
</span><span>    </span><span class="keyword1"><span class="command">also</span></span><span> </span><span class="keyword1"><span class="command">from</span></span><span> </span><span>normal</span><span> </span><span class="delimiter">[</span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span>g</span><span> </span><span class="delimiter">=</span><span> </span><span class="string"><span class="delete"><span class="delete">"inverse g"</span></span></span><span class="delimiter">]</span><span> </span><span class="keyword1"><span class="command">have</span></span><span> </span><span class="string"><span class="delete"><span class="delete">"… ∈ K |⋅ g"</span></span></span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>auto</span><span> </span><span>simp</span><span> </span><span>add</span><span class="delimiter">:</span><span> </span><span>Right_Coset_def</span><span class="delimiter">)</span><span>
</span><span>    </span><span class="keyword1"><span class="command">finally</span></span><span> </span><span class="keyword3"><span class="command">show</span></span><span> </span><span class="string"><span class="delete"><span class="delete">"x ∈ K |⋅ g"</span></span></span><span> </span><span class="keyword1"><span class="command">.</span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">qed</span></span><span>
</span><span class="keyword1"><span class="command">qed</span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹Thm 1.6, second part›</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹p 55, ll 31--32; p 56, ll 20--21›</span></span></span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span class="string"><span class="delete"><span class="delete">"Congruence = {(a, b). a ∈ G ∧ b ∈ G ∧ inverse a ⋅ b ∈ K}"</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹p 56, ll 21--22›</span></span></span><span>
</span><span class="keyword1"><span class="command">interpretation</span></span><span> </span><span>right_translations_of_group</span><span> </span><span class="keyword1"><span class="command">..</span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹p 56, ll 21--22›</span></span></span><span>
</span><span class="keyword1"><span class="command">interpretation</span></span><span> </span><span>transformation_group</span><span> </span><span class="string"><span class="delete"><span class="delete">"translation ` K"</span></span></span><span> </span><span>G</span><span> </span><span class="keyword2"><span class="keyword">rewrites</span></span><span> </span><span class="string"><span class="delete"><span class="delete">"Orbit_Relation = Congruence"</span></span></span><span>
</span><span class="keyword1"><span class="command">proof</span></span><span> </span><span>-</span><span>
</span><span>  </span><span class="keyword1"><span class="command">interpret</span></span><span> </span><span>transformation_group</span><span> </span><span class="string"><span class="delete"><span class="delete">"translation ` K"</span></span></span><span> </span><span>G</span><span> </span><span class="keyword1"><span class="command">..</span></span><span>
</span><span>  </span><span class="keyword3"><span class="command">show</span></span><span> </span><span class="string"><span class="delete"><span class="delete">"Orbit_Relation = Congruence"</span></span></span><span>
</span><span>    </span><span class="keyword1"><span class="command">unfolding</span></span><span> </span><span>Orbit_Relation_def</span><span> </span><span>Congruence_def</span><span>
</span><span>    </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>force</span><span> </span><span>simp</span><span class="delimiter">:</span><span> </span><span>invertible_left_inverse2</span><span> </span><span>invertible_right_inverse2</span><span> </span><span>translation_apply</span><span> </span><span>simp</span><span> </span><span>del</span><span class="delimiter">:</span><span> </span><span>restrict_apply</span><span class="delimiter">)</span><span>
</span><span class="keyword1"><span class="command">qed</span></span><span> </span><span>rule</span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹p 56, ll 20--21›</span></span></span><span>
</span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>CongruenceI</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">"⟦ a = b ⋅ k; a ∈ G; b ∈ G; k ∈ K ⟧ ⟹ (a, b) ∈ Congruence"</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>clarsimp</span><span> </span><span>simp</span><span class="delimiter">:</span><span> </span><span>Congruence_def</span><span> </span><span>associative</span><span> </span><span>inverse_composition_commute</span><span class="delimiter">)</span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹p 56, ll 20--21›</span></span></span><span>
</span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>CongruenceD</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">"(a, b) ∈ Congruence ⟹ ∃k∈K. a = b ⋅ k"</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>drule</span><span> </span><span>orbit.symmetric</span><span class="delimiter">)</span><span> </span><span class="delimiter">(</span><span>force</span><span> </span><span>simp</span><span class="delimiter">:</span><span> </span><span>Congruence_def</span><span> </span><span>invertible_right_inverse2</span><span class="delimiter">)</span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹
  ``We showed in the last section that the relation we are considering is an equivalence relation in
  @{term G} for any subgroup @{term K} of @{term G}.  We now proceed to show that normality of @{term K}
  ensures that [...] $a \equiv b \pmod{K}$ is a congruence.''
›</span></span></span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹p 55, ll 30--32; p 56, ll 1, 22--28›</span></span></span><span>
</span><span class="keyword1"><span class="command">sublocale</span></span><span> </span><span>group_congruence</span><span> </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span>E</span><span> </span><span class="delimiter">=</span><span> </span><span>Congruence</span><span> </span><span class="keyword2"><span class="keyword">rewrites</span></span><span> </span><span class="string"><span class="delete"><span class="delete">"Normal = K"</span></span></span><span>
</span><span class="keyword1"><span class="command">proof</span></span><span> </span><span>-</span><span>
</span><span>  </span><span class="keyword3"><span class="command">show</span></span><span> </span><span class="string"><span class="delete"><span class="delete">"group_congruence G (⋅) 𝟭 Congruence"</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">proof</span></span><span> </span><span>unfold_locales</span><span>
</span><span>    </span><span class="keyword1"><span class="command">note</span></span><span> </span><span>CongruenceI</span><span> </span><span class="delimiter">[</span><span>intro</span><span class="delimiter">]</span><span> </span><span>CongruenceD</span><span> </span><span class="delimiter">[</span><span>dest</span><span class="delimiter">]</span><span>
</span><span>    </span><span class="keyword3"><span class="command">fix</span></span><span> </span><span>a</span><span> </span><span>g</span><span> </span><span>b</span><span> </span><span>h</span><span>
</span><span>    </span><span class="keyword3"><span class="command">assume</span></span><span> </span><span>1</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">"(a, g) ∈ Congruence"</span></span></span><span> </span><span class="keyword2"><span class="keyword">and</span></span><span> </span><span>2</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">"(b, h) ∈ Congruence"</span></span></span><span>
</span><span>    </span><span class="keyword1"><span class="command">then</span></span><span> </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>G</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">"a ∈ G"</span></span></span><span> </span><span class="string"><span class="delete"><span class="delete">"g ∈ G"</span></span></span><span> </span><span class="string"><span class="delete"><span class="delete">"b ∈ G"</span></span></span><span> </span><span class="string"><span class="delete"><span class="delete">"h ∈ G"</span></span></span><span> </span><span class="keyword1"><span class="command">unfolding</span></span><span> </span><span>Congruence_def</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>clarify</span><span class="delimiter">+</span><span>
</span><span>    </span><span class="keyword1"><span class="command">from</span></span><span> </span><span>1</span><span> </span><span class="keyword3"><span class="command">obtain</span></span><span> </span><span>k1</span><span> </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span>a</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">"a = g ⋅ k1"</span></span></span><span> </span><span class="keyword2"><span class="keyword">and</span></span><span> </span><span>k1</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">"k1 ∈ K"</span></span></span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>blast</span><span>
</span><span>    </span><span class="keyword1"><span class="command">from</span></span><span> </span><span>2</span><span> </span><span class="keyword3"><span class="command">obtain</span></span><span> </span><span>k2</span><span> </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span>b</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">"b = h ⋅ k2"</span></span></span><span> </span><span class="keyword2"><span class="keyword">and</span></span><span> </span><span>k2</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">"k2 ∈ K"</span></span></span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>blast</span><span>
</span><span>    </span><span class="keyword1"><span class="command">from</span></span><span> </span><span>G</span><span> </span><span>Left_equals_Right_coset</span><span> </span><span class="keyword1"><span class="command">have</span></span><span> </span><span class="string"><span class="delete"><span class="delete">"K |⋅ h = h ⋅| K"</span></span></span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>blast</span><span>
</span><span>    </span><span class="keyword1"><span class="command">with</span></span><span> </span><span>k1</span><span> </span><span class="keyword3"><span class="command">obtain</span></span><span> </span><span>k3</span><span> </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span>c</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">"k1 ⋅ h = h ⋅ k3"</span></span></span><span> </span><span class="keyword2"><span class="keyword">and</span></span><span> </span><span>k3</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">"k3 ∈ K"</span></span></span><span>
</span><span>      </span><span class="keyword1"><span class="command">unfolding</span></span><span> </span><span>Left_Coset_def</span><span> </span><span>Right_Coset_def</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>blast</span><span>
</span><span>    </span><span class="keyword1"><span class="command">from</span></span><span> </span><span>G</span><span> </span><span>k1</span><span> </span><span>k2</span><span> </span><span>a</span><span> </span><span>b</span><span> </span><span class="keyword1"><span class="command">have</span></span><span> </span><span class="string"><span class="delete"><span class="delete">"a ⋅ b = g ⋅ k1 ⋅ h ⋅ k2"</span></span></span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>simp</span><span> </span><span>add</span><span class="delimiter">:</span><span> </span><span>associative</span><span class="delimiter">)</span><span>
</span><span>    </span><span class="keyword1"><span class="command">also</span></span><span> </span><span class="keyword1"><span class="command">from</span></span><span> </span><span>G</span><span> </span><span>k1</span><span> </span><span>k3</span><span> </span><span>c</span><span> </span><span class="keyword1"><span class="command">have</span></span><span> </span><span class="string"><span class="delete"><span class="delete">"… = g ⋅ h ⋅ k3 ⋅ k2"</span></span></span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>simp</span><span> </span><span>add</span><span class="delimiter">:</span><span> </span><span>associative</span><span class="delimiter">)</span><span>
</span><span>    </span><span class="keyword1"><span class="command">also</span></span><span> </span><span class="keyword1"><span class="command">have</span></span><span> </span><span class="string"><span class="delete"><span class="delete">"… = (g ⋅ h) ⋅ (k3 ⋅ k2)"</span></span></span><span> </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>G</span><span> </span><span>k2</span><span> </span><span>k3</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>simp</span><span> </span><span>add</span><span class="delimiter">:</span><span> </span><span>associative</span><span class="delimiter">)</span><span>
</span><span>    </span><span class="keyword1"><span class="command">finally</span></span><span> </span><span class="keyword3"><span class="command">show</span></span><span> </span><span class="string"><span class="delete"><span class="delete">"(a ⋅ b, g ⋅ h) ∈ Congruence"</span></span></span><span> </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>G</span><span> </span><span>k2</span><span> </span><span>k3</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>blast</span><span>
</span><span>  </span><span class="keyword1"><span class="command">qed</span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">then</span></span><span> </span><span class="keyword1"><span class="command">interpret</span></span><span> </span><span>group_congruence</span><span> </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span>E</span><span> </span><span class="delimiter">=</span><span> </span><span>Congruence</span><span> </span><span class="keyword1"><span class="command">.</span></span><span>
</span><span>  </span><span class="keyword3"><span class="command">show</span></span><span> </span><span class="string"><span class="delete"><span class="delete">"Normal = K"</span></span></span><span>
</span><span>    </span><span class="keyword1"><span class="command">unfolding</span></span><span> </span><span>Normal_def</span><span> </span><span>orbit.Class_def</span><span> </span><span class="keyword1"><span class="command">unfolding</span></span><span> </span><span>Congruence_def</span><span>
</span><span>    </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>invertible_inverse_inverse</span><span> </span><span>submonoid_inverse_closed</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>fastforce</span><span> 
</span><span class="keyword1"><span class="command">qed</span></span><span>
</span><span>
</span><span class="keyword2"><span class="keyword">end</span></span><span> </span><span class="comment"><span class="delete"><span class="delete"><span class="delete"><span class="delete">(* normal_subgroup *)</span></span></span></span></span><span>  </span><span class="comment"><span class="delete"><span class="delete"><span class="delete"><span class="delete">(* deletes translations and orbits, recovers Class for congruence class *)</span></span></span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">context</span></span><span> </span><span>group</span><span> </span><span class="keyword2"><span class="keyword">begin</span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹Pulled out of @{locale normal_subgroup} to achieve standard notation.›</span></span></span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹p 56, ll 31--32›</span></span></span><span>
</span><span class="keyword1"><span class="command">abbreviation</span></span><span> </span><span>Factor_Group</span><span> </span><span class="delimiter">(</span><span class="keyword2"><span class="keyword">infixl</span></span><span> </span><span class="string"><span class="delete"><span class="delete">"'/'/"</span></span></span><span> </span><span>75</span><span class="delimiter">)</span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">"S // K ≡ S / (normal_subgroup.Congruence K G (⋅) 𝟭)"</span></span></span><span>
</span><span>
</span><span class="keyword2"><span class="keyword">end</span></span><span> </span><span class="comment"><span class="delete"><span class="delete"><span class="delete"><span class="delete">(* group *)</span></span></span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">context</span></span><span> </span><span>normal_subgroup</span><span> </span><span class="keyword2"><span class="keyword">begin</span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹p 56, ll 28--29›</span></span></span><span>
</span><span class="keyword1"><span class="command">theorem</span></span><span> </span><span>Class_unit_normal_subgroup</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">"Class 𝟭 = K"</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">unfolding</span></span><span> </span><span>Class_def</span><span> </span><span class="keyword1"><span class="command">unfolding</span></span><span> </span><span>Congruence_def</span><span>
</span><span>  </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>invertible_inverse_inverse</span><span> </span><span>submonoid_inverse_closed</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>fastforce</span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹p 56, ll 1--2; p 56, l 29›</span></span></span><span>
</span><span class="keyword1"><span class="command">theorem</span></span><span> </span><span>Class_is_Left_Coset</span><span class="delimiter">:</span><span>
</span><span>  </span><span class="string"><span class="delete"><span class="delete">"g ∈ G ⟹ Class g = g ⋅| K"</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>Left_Coset_Class_unit</span><span> </span><span>Class_unit_normal_subgroup</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>simp</span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹p 56, l 29›</span></span></span><span>
</span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>Left_CosetE</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">"⟦ A ∈ G // K; ⋀a. a ∈ G ⟹ P (a ⋅| K) ⟧ ⟹ P A"</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>metis</span><span> </span><span>Class_is_Left_Coset</span><span> </span><span>quotient_ClassE</span><span class="delimiter">)</span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹Equation 26›</span></span></span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹p 56, ll 32--34›</span></span></span><span>
</span><span class="keyword1"><span class="command">theorem</span></span><span> </span><span>factor_composition</span><span> </span><span class="delimiter">[</span><span>simp</span><span class="delimiter">]</span><span class="delimiter">:</span><span>
</span><span>  </span><span class="string"><span class="delete"><span class="delete">"⟦ g ∈ G; h ∈ G ⟧ ⟹ (g ⋅| K) [⋅] (h ⋅| K) = g ⋅ h ⋅| K"</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>Class_commutes_with_composition</span><span> </span><span>Class_is_Left_Coset</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>auto</span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹p 56, l 35›</span></span></span><span>
</span><span class="keyword1"><span class="command">theorem</span></span><span> </span><span>factor_unit</span><span class="delimiter">:</span><span>
</span><span>  </span><span class="string"><span class="delete"><span class="delete">"K = 𝟭 ⋅| K"</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>Class_is_Left_Coset</span><span> </span><span>Class_unit_normal_subgroup</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>blast</span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹p 56, l 35›</span></span></span><span>
</span><span class="keyword1"><span class="command">theorem</span></span><span> </span><span>factor_inverse</span><span> </span><span class="delimiter">[</span><span>simp</span><span class="delimiter">]</span><span class="delimiter">:</span><span>
</span><span>  </span><span class="string"><span class="delete"><span class="delete">"g ∈ G ⟹ quotient.inverse (g ⋅| K) = (inverse g ⋅| K)"</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>Class_commutes_with_inverse</span><span> </span><span>Class_is_Left_Coset</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>auto</span><span>
</span><span>
</span><span class="keyword2"><span class="keyword">end</span></span><span> </span><span class="comment"><span class="delete"><span class="delete"><span class="delete"><span class="delete">(* normal_subgroup *)</span></span></span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹p 57, ll 4--5›</span></span></span><span>
</span><span class="keyword1"><span class="command">locale</span></span><span> </span><span>subgroup_of_abelian_group</span><span> </span><span class="delimiter">=</span><span> </span><span>subgroup_of_group</span><span> </span><span>H</span><span> </span><span>G</span><span> </span><span class="string"><span class="delete"><span class="delete">"(⋅)"</span></span></span><span> </span><span>𝟭</span><span> </span><span class="delimiter">+</span><span> </span><span>abelian_group</span><span> </span><span>G</span><span> </span><span class="string"><span class="delete"><span class="delete">"(⋅)"</span></span></span><span> </span><span>𝟭</span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">for</span></span><span> </span><span>H</span><span> </span><span class="keyword2"><span class="keyword">and</span></span><span> </span><span>G</span><span> </span><span class="keyword2"><span class="keyword">and</span></span><span> </span><span>composition</span><span> </span><span class="delimiter">(</span><span class="keyword2"><span class="keyword">infixl</span></span><span> </span><span class="string"><span class="delete"><span class="delete">"⋅"</span></span></span><span> </span><span>70</span><span class="delimiter">)</span><span> </span><span class="keyword2"><span class="keyword">and</span></span><span> </span><span>unit</span><span> </span><span class="delimiter">(</span><span class="string"><span class="delete"><span class="delete">"𝟭"</span></span></span><span class="delimiter">)</span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹p 57, ll 4--5›</span></span></span><span>
</span><span class="keyword1"><span class="command">sublocale</span></span><span> </span><span>subgroup_of_abelian_group</span><span> </span><span class="delimiter">⊆</span><span> </span><span>normal_subgroup</span><span> </span><span>H</span><span> </span><span>G</span><span> </span><span class="string"><span class="delete"><span class="delete">"(⋅)"</span></span></span><span> </span><span>𝟭</span><span>
</span><span>  </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>commutative</span><span> </span><span>invertible_right_inverse2</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>unfold_locales</span><span> </span><span>auto</span><span>
</span><span>
</span><span>
</span><span class="keyword1"><span class="command">subsection</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹Homomorphims›</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹Def 1.6›</span></span></span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹p 58, l 33; p 59, ll 1--2›</span></span></span><span>
</span><span class="keyword1"><span class="command">locale</span></span><span> </span><span>monoid_homomorphism</span><span> </span><span class="delimiter">=</span><span>
</span><span>  </span><span>map</span><span> </span><span>η</span><span> </span><span>M</span><span> </span><span>M'</span><span class="delimiter">+</span><span>  </span><span>source</span><span class="delimiter">:</span><span> </span><span>monoid</span><span> </span><span>M</span><span> </span><span class="string"><span class="delete"><span class="delete">"(⋅)"</span></span></span><span> </span><span>𝟭</span><span> </span><span class="delimiter">+</span><span> </span><span>target</span><span class="delimiter">:</span><span> </span><span>monoid</span><span> </span><span>M'</span><span> </span><span class="string"><span class="delete"><span class="delete">"(⋅')"</span></span></span><span> </span><span class="string"><span class="delete"><span class="delete">"𝟭'"</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">for</span></span><span> </span><span>η</span><span> </span><span class="keyword2"><span class="keyword">and</span></span><span> </span><span>M</span><span> </span><span class="keyword2"><span class="keyword">and</span></span><span> </span><span>composition</span><span> </span><span class="delimiter">(</span><span class="keyword2"><span class="keyword">infixl</span></span><span> </span><span class="string"><span class="delete"><span class="delete">"⋅"</span></span></span><span> </span><span>70</span><span class="delimiter">)</span><span> </span><span class="keyword2"><span class="keyword">and</span></span><span> </span><span>unit</span><span> </span><span class="delimiter">(</span><span class="string"><span class="delete"><span class="delete">"𝟭"</span></span></span><span class="delimiter">)</span><span>
</span><span>    </span><span class="keyword2"><span class="keyword">and</span></span><span> </span><span>M'</span><span> </span><span class="keyword2"><span class="keyword">and</span></span><span> </span><span>composition'</span><span> </span><span class="delimiter">(</span><span class="keyword2"><span class="keyword">infixl</span></span><span> </span><span class="string"><span class="delete"><span class="delete">"⋅''"</span></span></span><span> </span><span>70</span><span class="delimiter">)</span><span> </span><span class="keyword2"><span class="keyword">and</span></span><span> </span><span>unit'</span><span> </span><span class="delimiter">(</span><span class="string"><span class="delete"><span class="delete">"𝟭''"</span></span></span><span class="delimiter">)</span><span> </span><span class="delimiter">+</span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">assumes</span></span><span> </span><span>commutes_with_composition</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">"⟦ x ∈ M; y ∈ M ⟧ ⟹ η (x ⋅ y) = η x ⋅' η y"</span></span></span><span>
</span><span>    </span><span class="keyword2"><span class="keyword">and</span></span><span> </span><span>commutes_with_unit</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">"η 𝟭 = 𝟭'"</span></span></span><span>
</span><span class="keyword2"><span class="keyword">begin</span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹Jacobson notes that @{thm [source] commutes_with_unit} is not necessary for groups, but doesn't make use of that later.›</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹p 58, l 33; p 59, ll 1--2›</span></span></span><span>
</span><span class="keyword1"><span class="command">notation</span></span><span> </span><span>source.invertible</span><span> </span><span class="delimiter">(</span><span class="string"><span class="delete"><span class="delete">"invertible _"</span></span></span><span> </span><span class="delimiter">[</span><span>100</span><span class="delimiter">]</span><span> </span><span>100</span><span class="delimiter">)</span><span>
</span><span class="keyword1"><span class="command">notation</span></span><span> </span><span>source.inverse</span><span> </span><span class="delimiter">(</span><span class="string"><span class="delete"><span class="delete">"inverse _"</span></span></span><span> </span><span class="delimiter">[</span><span>100</span><span class="delimiter">]</span><span> </span><span>100</span><span class="delimiter">)</span><span>
</span><span class="keyword1"><span class="command">notation</span></span><span> </span><span>target.invertible</span><span> </span><span class="delimiter">(</span><span class="string"><span class="delete"><span class="delete">"invertible'' _"</span></span></span><span> </span><span class="delimiter">[</span><span>100</span><span class="delimiter">]</span><span> </span><span>100</span><span class="delimiter">)</span><span>
</span><span class="keyword1"><span class="command">notation</span></span><span> </span><span>target.inverse</span><span> </span><span class="delimiter">(</span><span class="string"><span class="delete"><span class="delete">"inverse'' _"</span></span></span><span> </span><span class="delimiter">[</span><span>100</span><span class="delimiter">]</span><span> </span><span>100</span><span class="delimiter">)</span><span>
</span><span>
</span><span class="keyword2"><span class="keyword">end</span></span><span> </span><span class="comment"><span class="delete"><span class="delete"><span class="delete"><span class="delete">(* monoid_homomorphism *)</span></span></span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹p 59, ll 29--30›</span></span></span><span>
</span><span class="keyword1"><span class="command">locale</span></span><span> </span><span>monoid_epimorphism</span><span> </span><span class="delimiter">=</span><span> </span><span>monoid_homomorphism</span><span> </span><span class="delimiter">+</span><span> </span><span>surjective_map</span><span> </span><span>η</span><span> </span><span>M</span><span> </span><span>M'</span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹p 59, l 30›</span></span></span><span>
</span><span class="keyword1"><span class="command">locale</span></span><span> </span><span>monoid_monomorphism</span><span> </span><span class="delimiter">=</span><span> </span><span>monoid_homomorphism</span><span> </span><span class="delimiter">+</span><span> </span><span>injective_map</span><span> </span><span>η</span><span> </span><span>M</span><span> </span><span>M'</span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹p 59, ll 30--31›</span></span></span><span>
</span><span class="keyword1"><span class="command">sublocale</span></span><span> </span><span>monoid_isomorphism</span><span> </span><span class="delimiter">⊆</span><span> </span><span>monoid_epimorphism</span><span>
</span><span>  </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>unfold_locales</span><span> </span><span class="delimiter">(</span><span>auto</span><span> </span><span>simp</span><span class="delimiter">:</span><span> </span><span>commutes_with_composition</span><span> </span><span>commutes_with_unit</span><span class="delimiter">)</span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹p 59, ll 30--31›</span></span></span><span>
</span><span class="keyword1"><span class="command">sublocale</span></span><span> </span><span>monoid_isomorphism</span><span> </span><span class="delimiter">⊆</span><span> </span><span>monoid_monomorphism</span><span>
</span><span>  </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>unfold_locales</span><span> </span><span class="delimiter">(</span><span>auto</span><span> </span><span>simp</span><span class="delimiter">:</span><span> </span><span>commutes_with_composition</span><span> </span><span>commutes_with_unit</span><span class="delimiter">)</span><span>
</span><span>
</span><span class="keyword1"><span class="command">context</span></span><span> </span><span>monoid_homomorphism</span><span> </span><span class="keyword2"><span class="keyword">begin</span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹p 59, ll 33--34›</span></span></span><span>
</span><span class="keyword1"><span class="command">theorem</span></span><span> </span><span>invertible_image_lemma</span><span class="delimiter">:</span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">assumes</span></span><span> </span><span class="string"><span class="delete"><span class="delete">"invertible a"</span></span></span><span> </span><span class="string"><span class="delete"><span class="delete">"a ∈ M"</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">shows</span></span><span> </span><span class="string"><span class="delete"><span class="delete">"η a ⋅' η (inverse a) = 𝟭'"</span></span></span><span> </span><span class="keyword2"><span class="keyword">and</span></span><span> </span><span class="string"><span class="delete"><span class="delete">"η (inverse a) ⋅' η a = 𝟭'"</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>assms</span><span> </span><span>commutes_with_composition</span><span> </span><span>commutes_with_unit</span><span> </span><span>source.inverse_equality</span><span>
</span><span>  </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>auto</span><span> </span><span class="delimiter">(</span><span>metis</span><span> </span><span>source.invertible_inverse_closed</span><span> </span><span>source.invertible_left_inverse</span><span class="delimiter">)</span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹p 59, l 34; p 60, l 1›</span></span></span><span>
</span><span class="keyword1"><span class="command">theorem</span></span><span> </span><span>invertible_target_invertible</span><span> </span><span class="delimiter">[</span><span>intro</span><span class="delimiter">,</span><span> </span><span>simp</span><span class="delimiter">]</span><span class="delimiter">:</span><span>
</span><span>  </span><span class="string"><span class="delete"><span class="delete">"⟦ invertible a; a ∈ M ⟧ ⟹ invertible' (η a)"</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>invertible_image_lemma</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>blast</span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹p 60, l 1›</span></span></span><span>
</span><span class="keyword1"><span class="command">theorem</span></span><span> </span><span>invertible_commutes_with_inverse</span><span class="delimiter">:</span><span>
</span><span>  </span><span class="string"><span class="delete"><span class="delete">"⟦ invertible a; a ∈ M ⟧ ⟹ η (inverse a) = inverse' (η a)"</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>invertible_image_lemma</span><span> </span><span>target.inverse_equality</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>fastforce</span><span>
</span><span>
</span><span class="keyword2"><span class="keyword">end</span></span><span> </span><span class="comment"><span class="delete"><span class="delete"><span class="delete"><span class="delete">(* monoid_homomorphism *)</span></span></span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹p 60, ll 32--34; p 61, l 1›</span></span></span><span>
</span><span class="keyword1"><span class="command">sublocale</span></span><span> </span><span>monoid_congruence</span><span> </span><span class="delimiter">⊆</span><span> </span><span>natural</span><span class="delimiter">:</span><span> </span><span>monoid_homomorphism</span><span> </span><span>Class</span><span> </span><span>M</span><span> </span><span class="string"><span class="delete"><span class="delete">"(⋅)"</span></span></span><span> </span><span>𝟭</span><span> </span><span class="string"><span class="delete"><span class="delete">"M / E"</span></span></span><span> </span><span class="string"><span class="delete"><span class="delete">"([⋅])"</span></span></span><span> </span><span class="string"><span class="delete"><span class="delete">"Class 𝟭"</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>unfold_locales</span><span> </span><span class="delimiter">(</span><span>auto</span><span> </span><span>simp</span><span class="delimiter">:</span><span> </span><span>PiE_I</span><span> </span><span>Class_commutes_with_composition</span><span class="delimiter">)</span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹Fundamental Theorem of Homomorphisms of Monoids›</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹p 61, ll 5, 14--16›</span></span></span><span>
</span><span class="keyword1"><span class="command">sublocale</span></span><span> </span><span>monoid_homomorphism</span><span> </span><span class="delimiter">⊆</span><span> </span><span>image</span><span class="delimiter">:</span><span> </span><span>submonoid</span><span> </span><span class="string"><span class="delete"><span class="delete">"η ` M"</span></span></span><span> </span><span>M'</span><span> </span><span class="string"><span class="delete"><span class="delete">"(⋅')"</span></span></span><span> </span><span class="string"><span class="delete"><span class="delete">"𝟭'"</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>unfold_locales</span><span> </span><span class="delimiter">(</span><span>auto</span><span> </span><span>simp</span><span class="delimiter">:</span><span> </span><span>commutes_with_composition</span><span> </span><span class="delimiter">[</span><span>symmetric</span><span class="delimiter">]</span><span> </span><span>commutes_with_unit</span><span> </span><span class="delimiter">[</span><span>symmetric</span><span class="delimiter">]</span><span class="delimiter">)</span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹p 61, l 4›</span></span></span><span>
</span><span class="keyword1"><span class="command">locale</span></span><span> </span><span>monoid_homomorphism_fundamental</span><span> </span><span class="delimiter">=</span><span> </span><span>monoid_homomorphism</span><span> </span><span class="keyword2"><span class="keyword">begin</span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹p 61, ll 17--18›</span></span></span><span>
</span><span class="keyword1"><span class="command">sublocale</span></span><span> </span><span>fiber_relation</span><span> </span><span>η</span><span> </span><span>M</span><span> </span><span>M'</span><span> </span><span class="keyword1"><span class="command">..</span></span><span>
</span><span class="keyword1"><span class="command">notation</span></span><span> </span><span>Fiber_Relation</span><span> </span><span class="delimiter">(</span><span class="string"><span class="delete"><span class="delete">"E'(_')"</span></span></span><span class="delimiter">)</span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹p 61, ll 6--7, 18--20›</span></span></span><span>
</span><span class="keyword1"><span class="command">sublocale</span></span><span> </span><span>monoid_congruence</span><span> </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span>E</span><span> </span><span class="delimiter">=</span><span> </span><span class="string"><span class="delete"><span class="delete">"E(η)"</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>Class_eq</span><span>
</span><span>  </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>unfold_locales</span><span> </span><span class="delimiter">(</span><span>rule</span><span> </span><span>Class_equivalence</span><span> </span><span class="delimiter">[</span><span>THEN</span><span> </span><span>iffD1</span><span class="delimiter">]</span><span class="delimiter">,</span><span>
</span><span>    </span><span>auto</span><span> </span><span>simp</span><span class="delimiter">:</span><span> </span><span>left_closed</span><span> </span><span>right_closed</span><span> </span><span>commutes_with_composition</span><span> </span><span>Fiber_equality</span><span class="delimiter">)</span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹p 61, ll 7--9›</span></span></span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹
  @{term induced} denotes Jacobson's $\bar{\eta}$.  We have the commutativity of the diagram, where
  @{term induced} is unique: @{thm [display] factorization} @{thm [display] uniqueness}.
›</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹p 61, l 20›</span></span></span><span>
</span><span class="keyword1"><span class="command">notation</span></span><span> </span><span>quotient_composition</span><span> </span><span class="delimiter">(</span><span class="keyword2"><span class="keyword">infixl</span></span><span> </span><span class="string"><span class="delete"><span class="delete">"[⋅]"</span></span></span><span> </span><span>70</span><span class="delimiter">)</span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹p 61, ll 7--8, 22--25›</span></span></span><span>
</span><span class="keyword1"><span class="command">sublocale</span></span><span> </span><span>induced</span><span class="delimiter">:</span><span> </span><span>monoid_homomorphism</span><span> </span><span>induced</span><span> </span><span class="string"><span class="delete"><span class="delete">"M / E(η)"</span></span></span><span> </span><span class="string"><span class="delete"><span class="delete">"([⋅])"</span></span></span><span> </span><span class="string"><span class="delete"><span class="delete">"Class 𝟭"</span></span></span><span> </span><span class="string"><span class="delete"><span class="delete">"M'"</span></span></span><span> </span><span class="string"><span class="delete"><span class="delete">"(⋅')"</span></span></span><span> </span><span class="string"><span class="delete"><span class="delete">"𝟭'"</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span> </span><span>unfold_locales</span><span>
</span><span>    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span> </span><span class="delimiter">(</span><span>auto</span><span> </span><span>simp</span><span class="delimiter">:</span><span> </span><span>commutes_with_unit</span><span class="delimiter">)</span><span>
</span><span>  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span> </span><span class="delimiter">(</span><span>fastforce</span><span> </span><span>simp</span><span class="delimiter">:</span><span> </span><span>commutes_with_composition</span><span> </span><span>commutes_with_unit</span><span> </span><span>Class_commutes_with_composition</span><span class="delimiter">)</span><span>
</span><span>  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">done</span></span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹p 61, ll 9, 26›</span></span></span><span>
</span><span class="keyword1"><span class="command">sublocale</span></span><span> </span><span>natural</span><span class="delimiter">:</span><span> </span><span>monoid_epimorphism</span><span> </span><span>Class</span><span> </span><span>M</span><span> </span><span class="string"><span class="delete"><span class="delete">"(⋅)"</span></span></span><span> </span><span>𝟭</span><span> </span><span class="string"><span class="delete"><span class="delete">"M / E(η)"</span></span></span><span> </span><span class="string"><span class="delete"><span class="delete">"([⋅])"</span></span></span><span> </span><span class="string"><span class="delete"><span class="delete">"Class 𝟭"</span></span></span><span> </span><span class="keyword1"><span class="command">..</span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹p 61, ll 9, 26--27›</span></span></span><span>
</span><span class="keyword1"><span class="command">sublocale</span></span><span> </span><span>induced</span><span class="delimiter">:</span><span> </span><span>monoid_monomorphism</span><span> </span><span>induced</span><span> </span><span class="string"><span class="delete"><span class="delete">"M / E(η)"</span></span></span><span> </span><span class="string"><span class="delete"><span class="delete">"([⋅])"</span></span></span><span> </span><span class="string"><span class="delete"><span class="delete">"Class 𝟭"</span></span></span><span> </span><span class="string"><span class="delete"><span class="delete">"M'"</span></span></span><span> </span><span class="string"><span class="delete"><span class="delete">"(⋅')"</span></span></span><span> </span><span class="string"><span class="delete"><span class="delete">"𝟭'"</span></span></span><span> </span><span class="keyword1"><span class="command">..</span></span><span>
</span><span>
</span><span class="keyword2"><span class="keyword">end</span></span><span> </span><span class="comment"><span class="delete"><span class="delete"><span class="delete"><span class="delete">(* monoid_homomorphism_fundamental *)</span></span></span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹p 62, ll 12--13›</span></span></span><span>
</span><span class="keyword1"><span class="command">locale</span></span><span> </span><span>group_homomorphism</span><span> </span><span class="delimiter">=</span><span>
</span><span>  </span><span>monoid_homomorphism</span><span> </span><span>η</span><span> </span><span>G</span><span> </span><span class="string"><span class="delete"><span class="delete">"(⋅)"</span></span></span><span> </span><span>𝟭</span><span> </span><span>G'</span><span> </span><span class="string"><span class="delete"><span class="delete">"(⋅')"</span></span></span><span> </span><span class="string"><span class="delete"><span class="delete">"𝟭'"</span></span></span><span> </span><span class="delimiter">+</span><span>
</span><span>  </span><span>source</span><span class="delimiter">:</span><span> </span><span>group</span><span> </span><span>G</span><span> </span><span class="string"><span class="delete"><span class="delete">"(⋅)"</span></span></span><span> </span><span>𝟭</span><span> </span><span class="delimiter">+</span><span> </span><span>target</span><span class="delimiter">:</span><span> </span><span>group</span><span> </span><span>G'</span><span> </span><span class="string"><span class="delete"><span class="delete">"(⋅')"</span></span></span><span> </span><span class="string"><span class="delete"><span class="delete">"𝟭'"</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">for</span></span><span> </span><span>η</span><span> </span><span class="keyword2"><span class="keyword">and</span></span><span> </span><span>G</span><span> </span><span class="keyword2"><span class="keyword">and</span></span><span> </span><span>composition</span><span> </span><span class="delimiter">(</span><span class="keyword2"><span class="keyword">infixl</span></span><span> </span><span class="string"><span class="delete"><span class="delete">"⋅"</span></span></span><span> </span><span>70</span><span class="delimiter">)</span><span> </span><span class="keyword2"><span class="keyword">and</span></span><span> </span><span>unit</span><span> </span><span class="delimiter">(</span><span class="string"><span class="delete"><span class="delete">"𝟭"</span></span></span><span class="delimiter">)</span><span>
</span><span>    </span><span class="keyword2"><span class="keyword">and</span></span><span> </span><span>G'</span><span> </span><span class="keyword2"><span class="keyword">and</span></span><span> </span><span>composition'</span><span> </span><span class="delimiter">(</span><span class="keyword2"><span class="keyword">infixl</span></span><span> </span><span class="string"><span class="delete"><span class="delete">"⋅''"</span></span></span><span> </span><span>70</span><span class="delimiter">)</span><span> </span><span class="keyword2"><span class="keyword">and</span></span><span> </span><span>unit'</span><span> </span><span class="delimiter">(</span><span class="string"><span class="delete"><span class="delete">"𝟭''"</span></span></span><span class="delimiter">)</span><span>
</span><span class="keyword2"><span class="keyword">begin</span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹p 62, l 13›</span></span></span><span>
</span><span class="keyword1"><span class="command">sublocale</span></span><span> </span><span>image</span><span class="delimiter">:</span><span> </span><span>subgroup</span><span> </span><span class="string"><span class="delete"><span class="delete">"η ` G"</span></span></span><span> </span><span>G'</span><span> </span><span class="string"><span class="delete"><span class="delete">"(⋅')"</span></span></span><span> </span><span class="string"><span class="delete"><span class="delete">"𝟭'"</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>invertible_image_lemma</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>unfold_locales</span><span> </span><span>auto</span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹p 62, ll 13--14›</span></span></span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span class="string"><span class="delete"><span class="delete">"Ker = η -` {𝟭'} ∩ G"</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹p 62, ll 13--14›</span></span></span><span>
</span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>Ker_equality</span><span class="delimiter">:</span><span>
</span><span>  </span><span class="string"><span class="delete"><span class="delete">"Ker = {a | a. a ∈ G ∧ η a = 𝟭'}"</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">unfolding</span></span><span> </span><span>Ker_def</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>auto</span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹p 62, ll 13--14›</span></span></span><span>
</span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>Ker_closed</span><span> </span><span class="delimiter">[</span><span>intro</span><span class="delimiter">,</span><span> </span><span>simp</span><span class="delimiter">]</span><span class="delimiter">:</span><span>
</span><span>  </span><span class="string"><span class="delete"><span class="delete">"a ∈ Ker ⟹ a ∈ G"</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">unfolding</span></span><span> </span><span>Ker_def</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>simp</span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹p 62, ll 13--14›</span></span></span><span>
</span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>Ker_image</span><span> </span><span class="delimiter">[</span><span>intro</span><span class="delimiter">]</span><span class="delimiter">:</span><span> </span><span class="comment"><span class="delete"><span class="delete"><span class="delete"><span class="delete">(* loops as a simprule *)</span></span></span></span></span><span>
</span><span>  </span><span class="string"><span class="delete"><span class="delete">"a ∈ Ker ⟹ η a = 𝟭'"</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">unfolding</span></span><span> </span><span>Ker_def</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>simp</span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹p 62, ll 13--14›</span></span></span><span>
</span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>Ker_memI</span><span> </span><span class="delimiter">[</span><span>intro</span><span class="delimiter">]</span><span class="delimiter">:</span><span> </span><span class="comment"><span class="delete"><span class="delete"><span class="delete"><span class="delete">(* loops as a simprule *)</span></span></span></span></span><span>
</span><span>  </span><span class="string"><span class="delete"><span class="delete">"⟦ η a = 𝟭'; a ∈ G ⟧ ⟹ a ∈ Ker"</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">unfolding</span></span><span> </span><span>Ker_def</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>simp</span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹p 62, ll 15--16›</span></span></span><span>
</span><span class="keyword1"><span class="command">sublocale</span></span><span> </span><span>kernel</span><span class="delimiter">:</span><span> </span><span>normal_subgroup</span><span> </span><span>Ker</span><span> </span><span>G</span><span>
</span><span class="keyword1"><span class="command">proof</span></span><span> </span><span>-</span><span>
</span><span>  </span><span class="keyword1"><span class="command">interpret</span></span><span> </span><span>kernel</span><span class="delimiter">:</span><span> </span><span>submonoid</span><span> </span><span>Ker</span><span> </span><span>G</span><span>
</span><span>    </span><span class="keyword1"><span class="command">unfolding</span></span><span> </span><span>Ker_def</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>unfold_locales</span><span> </span><span class="delimiter">(</span><span>auto</span><span> </span><span>simp</span><span class="delimiter">:</span><span> </span><span>commutes_with_composition</span><span> </span><span>commutes_with_unit</span><span class="delimiter">)</span><span>
</span><span>  </span><span class="keyword1"><span class="command">interpret</span></span><span> </span><span>kernel</span><span class="delimiter">:</span><span> </span><span>subgroup</span><span> </span><span>Ker</span><span> </span><span>G</span><span>
</span><span>    </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>unfold_locales</span><span> </span><span class="delimiter">(</span><span>force</span><span> </span><span>intro</span><span class="delimiter">:</span><span> </span><span>source.invertible_right_inverse</span><span> </span><span>simp</span><span class="delimiter">:</span><span> </span><span>Ker_image</span><span> </span><span>invertible_commutes_with_inverse</span><span class="delimiter">)</span><span>
</span><span>  </span><span class="keyword3"><span class="command">show</span></span><span> </span><span class="string"><span class="delete"><span class="delete">"normal_subgroup Ker G (⋅) 𝟭"</span></span></span><span>
</span><span>    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span> </span><span>unfold_locales</span><span>
</span><span>    </span><span class="keyword1"><span class="command">unfolding</span></span><span> </span><span>Ker_def</span><span>
</span><span>    </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>auto</span><span> </span><span>simp</span><span class="delimiter">:</span><span> </span><span>commutes_with_composition</span><span> </span><span>invertible_image_lemma</span><span class="delimiter">(</span><span>2</span><span class="delimiter">)</span><span class="delimiter">)</span><span>
</span><span class="keyword1"><span class="command">qed</span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹p 62, ll 17--20›</span></span></span><span>
</span><span class="keyword1"><span class="command">theorem</span></span><span> </span><span>injective_iff_kernel_unit</span><span class="delimiter">:</span><span>
</span><span>  </span><span class="string"><span class="delete"><span class="delete">"inj_on η G ⟷ Ker = {𝟭}"</span></span></span><span>
</span><span class="keyword1"><span class="command">proof</span></span><span> </span><span class="delimiter">(</span><span>rule</span><span> </span><span>Not_eq_iff</span><span> </span><span class="delimiter">[</span><span>THEN</span><span> </span><span>iffD1</span><span class="delimiter">,</span><span> </span><span>OF</span><span> </span><span>iffI</span><span class="delimiter">]</span><span class="delimiter">)</span><span>
</span><span>  </span><span class="keyword3"><span class="command">assume</span></span><span> </span><span class="string"><span class="delete"><span class="delete">"Ker ≠ {𝟭}"</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">then</span></span><span> </span><span class="keyword3"><span class="command">obtain</span></span><span> </span><span>b</span><span> </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span>b</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">"b ∈ Ker"</span></span></span><span> </span><span class="string"><span class="delete"><span class="delete">"b ≠ 𝟭"</span></span></span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>blast</span><span>
</span><span>  </span><span class="keyword1"><span class="command">then</span></span><span> </span><span class="keyword1"><span class="command">have</span></span><span> </span><span class="string"><span class="delete"><span class="delete">"η b = η 𝟭"</span></span></span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>simp</span><span> </span><span>add</span><span class="delimiter">:</span><span> </span><span>Ker_image</span><span class="delimiter">)</span><span>
</span><span>  </span><span class="keyword1"><span class="command">with</span></span><span> </span><span>b</span><span> </span><span class="keyword3"><span class="command">show</span></span><span> </span><span class="string"><span class="delete"><span class="delete">"¬ inj_on η G"</span></span></span><span>  </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>meson</span><span> </span><span>inj_onD</span><span> </span><span>kernel.sub</span><span> </span><span>source.unit_closed</span><span class="delimiter">)</span><span>
</span><span class="keyword1"><span class="command">next</span></span><span>
</span><span>  </span><span class="keyword3"><span class="command">assume</span></span><span> </span><span class="string"><span class="delete"><span class="delete">"¬ inj_on η G"</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">then</span></span><span> </span><span class="keyword3"><span class="command">obtain</span></span><span> </span><span>a</span><span> </span><span>b</span><span> </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">"a ≠ b"</span></span></span><span> </span><span class="keyword2"><span class="keyword">and</span></span><span> </span><span>ab</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">"a ∈ G"</span></span></span><span> </span><span class="string"><span class="delete"><span class="delete">"b ∈ G"</span></span></span><span> </span><span class="string"><span class="delete"><span class="delete">"η a = η b"</span></span></span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>meson</span><span> </span><span>inj_onI</span><span class="delimiter">)</span><span>
</span><span>  </span><span class="keyword1"><span class="command">then</span></span><span> </span><span class="keyword1"><span class="command">have</span></span><span> </span><span class="string"><span class="delete"><span class="delete">"inverse a ⋅ b ≠ 𝟭"</span></span></span><span> </span><span class="string"><span class="delete"><span class="delete">"η (inverse a ⋅ b) = 𝟭'"</span></span></span><span>
</span><span>    </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>ab</span><span> </span><span>source.invertible_right_inverse2</span><span>
</span><span>    </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>force</span><span> </span><span class="delimiter">(</span><span>metis</span><span> </span><span>ab</span><span> </span><span>commutes_with_composition</span><span> </span><span>invertible_image_lemma</span><span class="delimiter">(</span><span>2</span><span class="delimiter">)</span><span> </span><span>source.invertible</span><span> </span><span>source.invertible_inverse_closed</span><span class="delimiter">)</span><span>
</span><span>  </span><span class="keyword1"><span class="command">then</span></span><span> </span><span class="keyword1"><span class="command">have</span></span><span> </span><span class="string"><span class="delete"><span class="delete">"inverse a ⋅ b ∈ Ker"</span></span></span><span> </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>Ker_memI</span><span> </span><span>ab</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>blast</span><span>
</span><span>  </span><span class="keyword1"><span class="command">then</span></span><span> </span><span class="keyword3"><span class="command">show</span></span><span> </span><span class="string"><span class="delete"><span class="delete">"Ker ≠ {𝟭}"</span></span></span><span> </span><span class="keyword1"><span class="command">using</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹inverse a ⋅ b ≠ 𝟭›</span></span></span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>blast</span><span>
</span><span class="keyword1"><span class="command">qed</span></span><span>
</span><span>
</span><span class="keyword2"><span class="keyword">end</span></span><span> </span><span class="comment"><span class="delete"><span class="delete"><span class="delete"><span class="delete">(* group_homomorphism *)</span></span></span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹p 62, l 24›</span></span></span><span>
</span><span class="keyword1"><span class="command">locale</span></span><span> </span><span>group_epimorphism</span><span> </span><span class="delimiter">=</span><span> </span><span>group_homomorphism</span><span> </span><span class="delimiter">+</span><span> </span><span>monoid_epimorphism</span><span> </span><span>η</span><span> </span><span>G</span><span> </span><span class="string"><span class="delete"><span class="delete">"(⋅)"</span></span></span><span> </span><span>𝟭</span><span> </span><span>G'</span><span> </span><span class="string"><span class="delete"><span class="delete">"(⋅')"</span></span></span><span> </span><span class="string"><span class="delete"><span class="delete">"𝟭'"</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹p 62, l 21›</span></span></span><span>
</span><span class="keyword1"><span class="command">locale</span></span><span> </span><span>normal_subgroup_in_kernel</span><span> </span><span class="delimiter">=</span><span>
</span><span>  </span><span>group_homomorphism</span><span> </span><span class="delimiter">+</span><span> </span><span>contained</span><span class="delimiter">:</span><span> </span><span>normal_subgroup</span><span> </span><span>L</span><span> </span><span>G</span><span> </span><span class="string"><span class="delete"><span class="delete">"(⋅)"</span></span></span><span> </span><span>𝟭</span><span> </span><span class="keyword2"><span class="keyword">for</span></span><span> </span><span>L</span><span> </span><span class="delimiter">+</span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">assumes</span></span><span> </span><span>subset</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">"L ⊆ Ker"</span></span></span><span>
</span><span class="keyword2"><span class="keyword">begin</span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹p 62, l 21›</span></span></span><span>
</span><span class="keyword1"><span class="command">notation</span></span><span> </span><span>contained.quotient_composition</span><span> </span><span class="delimiter">(</span><span class="keyword2"><span class="keyword">infixl</span></span><span> </span><span class="string"><span class="delete"><span class="delete">"[⋅]"</span></span></span><span> </span><span>70</span><span class="delimiter">)</span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹"homomorphism onto @{term "G // L"}"›</span></span></span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹p 62, ll 23--24›</span></span></span><span>
</span><span class="keyword1"><span class="command">sublocale</span></span><span> </span><span>natural</span><span class="delimiter">:</span><span> </span><span>group_epimorphism</span><span> </span><span>contained.Class</span><span> </span><span>G</span><span> </span><span class="string"><span class="delete"><span class="delete">"(⋅)"</span></span></span><span> </span><span>𝟭</span><span> </span><span class="string"><span class="delete"><span class="delete">"G // L"</span></span></span><span> </span><span class="string"><span class="delete"><span class="delete">"([⋅])"</span></span></span><span> </span><span class="string"><span class="delete"><span class="delete">"contained.Class 𝟭"</span></span></span><span> </span><span class="keyword1"><span class="command">..</span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹p 62, ll 25--26›</span></span></span><span>
</span><span class="keyword1"><span class="command">theorem</span></span><span> </span><span>left_coset_equality</span><span class="delimiter">:</span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">assumes</span></span><span> </span><span>eq</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">"a ⋅| L = b ⋅| L"</span></span></span><span> </span><span class="keyword2"><span class="keyword">and</span></span><span> </span><span class="delimiter">[</span><span>simp</span><span class="delimiter">]</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">"a ∈ G"</span></span></span><span> </span><span class="keyword2"><span class="keyword">and</span></span><span> </span><span>b</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">"b ∈ G"</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">shows</span></span><span> </span><span class="string"><span class="delete"><span class="delete">"η a = η b"</span></span></span><span>
</span><span class="keyword1"><span class="command">proof</span></span><span> </span><span>-</span><span>
</span><span>  </span><span class="keyword3"><span class="command">obtain</span></span><span> </span><span>l</span><span> </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span>l</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">"b = a ⋅ l"</span></span></span><span> </span><span class="string"><span class="delete"><span class="delete">"l ∈ L"</span></span></span><span>
</span><span>    </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>metis</span><span> </span><span>b</span><span> </span><span>contained.Class_is_Left_Coset</span><span> </span><span>contained.Class_self</span><span> </span><span>eq</span><span> </span><span>kernel.Left_Coset_memE</span><span class="delimiter">)</span><span>
</span><span>  </span><span class="keyword1"><span class="command">then</span></span><span> </span><span class="keyword1"><span class="command">have</span></span><span> </span><span class="string"><span class="delete"><span class="delete">"η a = η a ⋅' η l"</span></span></span><span> </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>Ker_image</span><span> </span><span>monoid_homomorphism.commutes_with_composition</span><span> </span><span>subset</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>auto</span><span>
</span><span>  </span><span class="keyword1"><span class="command">also</span></span><span> </span><span class="keyword1"><span class="command">have</span></span><span> </span><span class="string"><span class="delete"><span class="delete">"… = η b"</span></span></span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>simp</span><span> </span><span>add</span><span class="delimiter">:</span><span> </span><span>commutes_with_composition</span><span> </span><span>l</span><span class="delimiter">)</span><span>
</span><span>  </span><span class="keyword1"><span class="command">finally</span></span><span> </span><span class="keyword3"><span class="command">show</span></span><span> </span><span class="var">?thesis</span><span> </span><span class="keyword1"><span class="command">.</span></span><span>
</span><span class="keyword1"><span class="command">qed</span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹$\bar{\eta}$›</span></span></span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹p 62, ll 26--27›</span></span></span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span class="string"><span class="delete"><span class="delete">"induced = (λA ∈ G // L. THE b. ∃a ∈ G. a ⋅| L = A ∧ b = η a)"</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹p 62, ll 26--27›</span></span></span><span>
</span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>induced_closed</span><span> </span><span class="delimiter">[</span><span>intro</span><span class="delimiter">,</span><span> </span><span>simp</span><span class="delimiter">]</span><span class="delimiter">:</span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">assumes</span></span><span> </span><span class="delimiter">[</span><span>simp</span><span class="delimiter">]</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">"A ∈ G // L"</span></span></span><span> </span><span class="keyword2"><span class="keyword">shows</span></span><span> </span><span class="string"><span class="delete"><span class="delete">"induced A ∈ G'"</span></span></span><span>
</span><span class="keyword1"><span class="command">proof</span></span><span> </span><span>-</span><span>
</span><span>  </span><span class="keyword3"><span class="command">obtain</span></span><span> </span><span>a</span><span> </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span>a</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">"a ∈ G"</span></span></span><span> </span><span class="string"><span class="delete"><span class="delete">"a ⋅| L = A"</span></span></span><span> </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>contained.Class_is_Left_Coset</span><span> </span><span>contained.Partition_def</span><span> </span><span>assms</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>auto</span><span>
</span><span>  </span><span class="keyword1"><span class="command">have</span></span><span> </span><span class="string"><span class="delete"><span class="delete">"(THE b. ∃a ∈ G. a ⋅| L = A ∧ b = η a) ∈ G'"</span></span></span><span>
</span><span>    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span> </span><span class="delimiter">(</span><span>rule</span><span> </span><span>theI2</span><span class="delimiter">)</span><span>
</span><span>    </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>a</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>auto</span><span> </span><span>intro</span><span class="delimiter">:</span><span> </span><span>left_coset_equality</span><span class="delimiter">)</span><span>
</span><span>  </span><span class="keyword1"><span class="command">then</span></span><span> </span><span class="keyword3"><span class="command">show</span></span><span> </span><span class="var">?thesis</span><span> </span><span class="keyword1"><span class="command">unfolding</span></span><span> </span><span>induced_def</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>simp</span><span>
</span><span class="keyword1"><span class="command">qed</span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹p 62, ll 26--27›</span></span></span><span>
</span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>induced_undefined</span><span> </span><span class="delimiter">[</span><span>intro</span><span class="delimiter">,</span><span> </span><span>simp</span><span class="delimiter">]</span><span class="delimiter">:</span><span>
</span><span>  </span><span class="string"><span class="delete"><span class="delete">"A ∉ G // L ⟹ induced A = undefined"</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">unfolding</span></span><span> </span><span>induced_def</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>simp</span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹p 62, ll 26--27›</span></span></span><span>
</span><span class="keyword1"><span class="command">theorem</span></span><span> </span><span>induced_left_coset_closed</span><span> </span><span class="delimiter">[</span><span>intro</span><span class="delimiter">,</span><span> </span><span>simp</span><span class="delimiter">]</span><span class="delimiter">:</span><span>
</span><span>  </span><span class="string"><span class="delete"><span class="delete">"a ∈ G ⟹ induced (a ⋅| L) ∈ G'"</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>contained.Class_is_Left_Coset</span><span> </span><span>contained.Class_in_Partition</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>auto</span><span> 
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹p 62, ll 26--27›</span></span></span><span>
</span><span class="keyword1"><span class="command">theorem</span></span><span> </span><span>induced_left_coset_equality</span><span> </span><span class="delimiter">[</span><span>simp</span><span class="delimiter">]</span><span class="delimiter">:</span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">assumes</span></span><span> </span><span class="delimiter">[</span><span>simp</span><span class="delimiter">]</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">"a ∈ G"</span></span></span><span> </span><span class="keyword2"><span class="keyword">shows</span></span><span> </span><span class="string"><span class="delete"><span class="delete">"induced (a ⋅| L) = η a"</span></span></span><span>
</span><span class="keyword1"><span class="command">proof</span></span><span> </span><span>-</span><span>
</span><span>  </span><span class="keyword1"><span class="command">have</span></span><span> </span><span class="string"><span class="delete"><span class="delete">"(THE b. ∃a' ∈ G. a' ⋅| L = a ⋅| L ∧ b = η a') = η a"</span></span></span><span>
</span><span>    </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>rule</span><span> </span><span>the_equality</span><span class="delimiter">)</span><span> </span><span class="delimiter">(</span><span>auto</span><span> </span><span>intro</span><span class="delimiter">:</span><span> </span><span>left_coset_equality</span><span class="delimiter">)</span><span>
</span><span>  </span><span class="keyword1"><span class="command">then</span></span><span> </span><span class="keyword3"><span class="command">show</span></span><span> </span><span class="var">?thesis</span><span> </span><span class="keyword1"><span class="command">unfolding</span></span><span> </span><span>induced_def</span><span>
</span><span>    </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>contained.Class_is_Left_Coset</span><span> </span><span>contained.Class_in_Partition</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>auto</span><span> 
</span><span class="keyword1"><span class="command">qed</span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹p 62, l 27›</span></span></span><span>
</span><span class="keyword1"><span class="command">theorem</span></span><span> </span><span>induced_Left_Coset_commutes_with_composition</span><span> </span><span class="delimiter">[</span><span>simp</span><span class="delimiter">]</span><span class="delimiter">:</span><span>
</span><span>  </span><span class="string"><span class="delete"><span class="delete">"⟦ a ∈ G; b ∈ G ⟧ ⟹ induced ((a ⋅| L) [⋅] (b ⋅| L)) = induced (a ⋅| L) ⋅' induced (b ⋅| L)"</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>simp</span><span> </span><span>add</span><span class="delimiter">:</span><span> </span><span>commutes_with_composition</span><span class="delimiter">)</span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹p 62, ll 27--28›</span></span></span><span>
</span><span class="keyword1"><span class="command">theorem</span></span><span> </span><span>induced_group_homomorphism</span><span class="delimiter">:</span><span>
</span><span>  </span><span class="string"><span class="delete"><span class="delete">"group_homomorphism induced (G // L) ([⋅]) (contained.Class 𝟭) G' (⋅') 𝟭'"</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span> </span><span>unfold_locales</span><span>
</span><span>    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span> </span><span class="delimiter">(</span><span>auto</span><span> </span><span>elim</span><span class="delimiter">!</span><span class="delimiter">:</span><span> </span><span>contained.Left_CosetE</span><span> </span><span>simp</span><span class="delimiter">:</span><span> </span><span>commutes_with_composition</span><span> </span><span>commutes_with_unit</span><span class="delimiter">)</span><span>
</span><span>  </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>contained.factor_unit</span><span> </span><span>induced_left_coset_equality</span><span> </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span> </span><span class="delimiter">(</span><span>fastforce</span><span> </span><span>simp</span><span class="delimiter">:</span><span> </span><span>contained.Class_unit_normal_subgroup</span><span class="delimiter">)</span><span>
</span><span>  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">done</span></span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹p 62, l 28›</span></span></span><span>
</span><span class="keyword1"><span class="command">sublocale</span></span><span> </span><span>induced</span><span class="delimiter">:</span><span> </span><span>group_homomorphism</span><span> </span><span>induced</span><span> </span><span class="string"><span class="delete"><span class="delete">"G // L"</span></span></span><span> </span><span class="string"><span class="delete"><span class="delete">"([⋅])"</span></span></span><span> </span><span class="string"><span class="delete"><span class="delete">"contained.Class 𝟭"</span></span></span><span> </span><span>G'</span><span> </span><span class="string"><span class="delete"><span class="delete">"(⋅')"</span></span></span><span> </span><span class="string"><span class="delete"><span class="delete">"𝟭'"</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>fact</span><span> </span><span>induced_group_homomorphism</span><span class="delimiter">)</span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹p 62, ll 28--29›</span></span></span><span>
</span><span class="keyword1"><span class="command">theorem</span></span><span> </span><span>factorization_lemma</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">"a ∈ G ⟹ compose G induced contained.Class a = η a"</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">unfolding</span></span><span> </span><span>compose_def</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>simp</span><span> </span><span>add</span><span class="delimiter">:</span><span> </span><span>contained.Class_is_Left_Coset</span><span class="delimiter">)</span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹p 62, ll 29--30›</span></span></span><span>
</span><span class="keyword1"><span class="command">theorem</span></span><span> </span><span>factorization</span><span> </span><span class="delimiter">[</span><span>simp</span><span class="delimiter">]</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">"compose G induced contained.Class = η"</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>rule</span><span> </span><span class="delimiter">(</span><span>simp</span><span> </span><span>add</span><span class="delimiter">:</span><span> </span><span>compose_def</span><span> </span><span>contained.Class_is_Left_Coset</span><span class="delimiter">)</span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹
  Jacobson does not state the uniqueness of @{term induced} explicitly but he uses it later,
  for rings, on p 107.
›</span></span></span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹p 62, l 30›</span></span></span><span>
</span><span class="keyword1"><span class="command">theorem</span></span><span> </span><span>uniqueness</span><span class="delimiter">:</span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">assumes</span></span><span> </span><span>map</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">"β ∈ G // L →<span class="hidden">⇩</span><sub>E</sub> G'"</span></span></span><span>
</span><span>    </span><span class="keyword2"><span class="keyword">and</span></span><span> </span><span>factorization</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">"compose G β contained.Class = η"</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">shows</span></span><span> </span><span class="string"><span class="delete"><span class="delete">"β = induced"</span></span></span><span>
</span><span class="keyword1"><span class="command">proof</span></span><span>
</span><span>  </span><span class="keyword3"><span class="command">fix</span></span><span> </span><span>A</span><span>
</span><span>  </span><span class="keyword3"><span class="command">show</span></span><span> </span><span class="string"><span class="delete"><span class="delete">"β A = induced A"</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">proof</span></span><span> </span><span class="delimiter">(</span><span>cases</span><span> </span><span class="string"><span class="delete"><span class="delete">"A ∈ G // L"</span></span></span><span class="delimiter">)</span><span>
</span><span>    </span><span class="keyword3"><span class="command">case</span></span><span> </span><span>True</span><span>
</span><span>    </span><span class="keyword1"><span class="command">then</span></span><span> </span><span class="keyword3"><span class="command">obtain</span></span><span> </span><span>a</span><span> </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="delimiter">[</span><span>simp</span><span class="delimiter">]</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">"A = contained.Class a"</span></span></span><span> </span><span class="string"><span class="delete"><span class="delete">"a ∈ G"</span></span></span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>fast</span><span>
</span><span>    </span><span class="keyword1"><span class="command">then</span></span><span> </span><span class="keyword1"><span class="command">have</span></span><span> </span><span class="string"><span class="delete"><span class="delete">"β (contained.Class a) = η a"</span></span></span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>metis</span><span> </span><span>compose_eq</span><span> </span><span>factorization</span><span class="delimiter">)</span><span>
</span><span>    </span><span class="keyword1"><span class="command">also</span></span><span> </span><span class="keyword1"><span class="command">have</span></span><span> </span><span class="string"><span class="delete"><span class="delete">"… = induced (contained.Class a)"</span></span></span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>simp</span><span> </span><span>add</span><span class="delimiter">:</span><span> </span><span>contained.Class_is_Left_Coset</span><span class="delimiter">)</span><span>
</span><span>    </span><span class="keyword1"><span class="command">finally</span></span><span> </span><span class="keyword3"><span class="command">show</span></span><span> </span><span class="var">?thesis</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>simp</span><span>
</span><span>  </span><span class="keyword1"><span class="command">qed</span></span><span> </span><span class="delimiter">(</span><span>simp</span><span> </span><span>add</span><span class="delimiter">:</span><span> </span><span>induced_def</span><span> </span><span>PiE_arb</span><span> </span><span class="delimiter">[</span><span>OF</span><span> </span><span>map</span><span class="delimiter">]</span><span class="delimiter">)</span><span>
</span><span class="keyword1"><span class="command">qed</span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹p 62, l 31›</span></span></span><span>
</span><span class="keyword1"><span class="command">theorem</span></span><span> </span><span>induced_image</span><span class="delimiter">:</span><span>
</span><span>  </span><span class="string"><span class="delete"><span class="delete">"induced ` (G // L) = η ` G"</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>metis</span><span> </span><span>factorization</span><span> </span><span>contained.natural.surjective</span><span> </span><span>surj_compose</span><span class="delimiter">)</span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹p 62, l 33›</span></span></span><span>
</span><span class="keyword1"><span class="command">interpretation</span></span><span> </span><span>L</span><span class="delimiter">:</span><span> </span><span>normal_subgroup</span><span> </span><span>L</span><span> </span><span>Ker</span><span>
</span><span>  </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>unfold_locales</span><span> </span><span class="delimiter">(</span><span>auto</span><span> </span><span>simp</span><span class="delimiter">:</span><span> </span><span>subset</span><span class="delimiter">,</span><span> </span><span>metis</span><span> </span><span>kernel.sub</span><span> </span><span>kernel.subgroup_inverse_equality</span><span> </span><span>contained.normal</span><span class="delimiter">)</span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹p 62, ll 31--33›</span></span></span><span>
</span><span class="keyword1"><span class="command">theorem</span></span><span> </span><span>induced_kernel</span><span class="delimiter">:</span><span>
</span><span>  </span><span class="string"><span class="delete"><span class="delete">"induced.Ker = Ker / L.Congruence"</span></span></span><span> </span><span class="comment"><span class="delete"><span class="delete"><span class="delete"><span class="delete">(* Ker // L is apparently not the right thing *)</span></span></span></span></span><span>
</span><span class="keyword1"><span class="command">proof</span></span><span> </span><span>-</span><span>
</span><span>  </span><span class="keyword1"><span class="command">have</span></span><span> </span><span class="string"><span class="delete"><span class="delete">"induced.Ker = { a ⋅| L | a. a ∈ G ∧ a ∈ Ker }"</span></span></span><span>
</span><span>    </span><span class="keyword1"><span class="command">unfolding</span></span><span> </span><span>induced.Ker_equality</span><span>
</span><span>    </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>simp</span><span> </span><span class="delimiter">(</span><span>metis</span><span> </span><span class="delimiter">(</span><span>hide_lams</span><span class="delimiter">)</span><span> </span><span>contained.Class_is_Left_Coset</span><span> </span><span>Ker_image</span><span> </span><span>Ker_memI</span><span>
</span><span>        </span><span>induced_left_coset_equality</span><span> </span><span>contained.Class_in_Partition</span><span> </span><span>contained.representant_exists</span><span class="delimiter">)</span><span>
</span><span>  </span><span class="keyword1"><span class="command">also</span></span><span> </span><span class="keyword1"><span class="command">have</span></span><span> </span><span class="string"><span class="delete"><span class="delete">"… = Ker / L.Congruence"</span></span></span><span>
</span><span>    </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>L.Class_is_Left_Coset</span><span> </span><span>L.Class_in_Partition</span><span>
</span><span>    </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>auto</span><span> </span><span class="delimiter">(</span><span>metis</span><span> </span><span>L.Class_is_Left_Coset</span><span> </span><span>L.representant_exists</span><span> </span><span>kernel.sub</span><span class="delimiter">)</span><span>
</span><span>  </span><span class="keyword1"><span class="command">finally</span></span><span> </span><span class="keyword3"><span class="command">show</span></span><span> </span><span class="var">?thesis</span><span> </span><span class="keyword1"><span class="command">.</span></span><span>
</span><span class="keyword1"><span class="command">qed</span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹p 62, ll 34--35›</span></span></span><span>
</span><span class="keyword1"><span class="command">theorem</span></span><span> </span><span>induced_inj_on</span><span class="delimiter">:</span><span>
</span><span>  </span><span class="string"><span class="delete"><span class="delete">"inj_on induced (G // L) ⟷ L = Ker"</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span> </span><span class="delimiter">(</span><span>simp</span><span> </span><span>add</span><span class="delimiter">:</span><span> </span><span>induced.injective_iff_kernel_unit</span><span> </span><span>induced_kernel</span><span> </span><span>contained.Class_unit_normal_subgroup</span><span class="delimiter">)</span><span>
</span><span>  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span> </span><span>rule</span><span>
</span><span>  </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>L.block_exists</span><span> </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span> </span><span>auto</span><span> </span><span class="delimiter">[</span><span>1</span><span class="delimiter">]</span><span>
</span><span>  </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>L.Block_self</span><span> </span><span>L.Class_unit_normal_subgroup</span><span> </span><span>L.quotient.unit_closed</span><span> </span><span>L.representant_exists</span><span>
</span><span>  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span> </span><span>auto</span><span>
</span><span>  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">done</span></span></span></span><span>
</span><span>
</span><span class="keyword2"><span class="keyword">end</span></span><span> </span><span class="comment"><span class="delete"><span class="delete"><span class="delete"><span class="delete">(* normal_subgroup_in_kernel *)</span></span></span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹Fundamental Theorem of Homomorphisms of Groups›</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹p 63, l 1›</span></span></span><span>
</span><span class="keyword1"><span class="command">locale</span></span><span> </span><span>group_homomorphism_fundamental</span><span> </span><span class="delimiter">=</span><span> </span><span>group_homomorphism</span><span> </span><span class="keyword2"><span class="keyword">begin</span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹p 63, l 1›</span></span></span><span>
</span><span class="keyword1"><span class="command">notation</span></span><span> </span><span>kernel.quotient_composition</span><span> </span><span class="delimiter">(</span><span class="keyword2"><span class="keyword">infixl</span></span><span> </span><span class="string"><span class="delete"><span class="delete">"[⋅]"</span></span></span><span> </span><span>70</span><span class="delimiter">)</span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹p 63, l 1›</span></span></span><span>
</span><span class="keyword1"><span class="command">sublocale</span></span><span> </span><span>normal_subgroup_in_kernel</span><span> </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span>L</span><span> </span><span class="delimiter">=</span><span> </span><span>Ker</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>unfold_locales</span><span> </span><span>rule</span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹p 62, ll 36--37; p 63, l 1›</span></span></span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹
  @{term induced} denotes Jacobson's $\bar{\eta}$.  We have the commutativity of the diagram, where
  @{term induced} is unique: @{thm [display] factorization} @{thm [display] uniqueness}
›</span></span></span><span>
</span><span>
</span><span class="keyword2"><span class="keyword">end</span></span><span> </span><span class="comment"><span class="delete"><span class="delete"><span class="delete"><span class="delete">(* group_homomorphism_fundamental *)</span></span></span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹p 63, l 5›</span></span></span><span>
</span><span class="keyword1"><span class="command">locale</span></span><span> </span><span>group_isomorphism</span><span> </span><span class="delimiter">=</span><span> </span><span>group_homomorphism</span><span> </span><span class="delimiter">+</span><span> </span><span>bijective_map</span><span> </span><span>η</span><span> </span><span>G</span><span> </span><span>G'</span><span> </span><span class="keyword2"><span class="keyword">begin</span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹p 63, l 5›</span></span></span><span>
</span><span class="keyword1"><span class="command">sublocale</span></span><span> </span><span>monoid_isomorphism</span><span> </span><span>η</span><span> </span><span>G</span><span> </span><span class="string"><span class="delete"><span class="delete">"(⋅)"</span></span></span><span> </span><span>𝟭</span><span> </span><span>G'</span><span> </span><span class="string"><span class="delete"><span class="delete">"(⋅')"</span></span></span><span> </span><span class="string"><span class="delete"><span class="delete">"𝟭'"</span></span></span><span> 
</span><span>  </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>unfold_locales</span><span> </span><span class="delimiter">(</span><span>auto</span><span> </span><span>simp</span><span class="delimiter">:</span><span> </span><span>commutes_with_composition</span><span class="delimiter">)</span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹p 63, l 6›</span></span></span><span>
</span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>inverse_group_isomorphism</span><span class="delimiter">:</span><span>
</span><span>  </span><span class="string"><span class="delete"><span class="delete">"group_isomorphism (restrict (inv_into G η) G') G' (⋅') 𝟭' G (⋅) 𝟭"</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>commutes_with_composition</span><span> </span><span>commutes_with_unit</span><span> </span><span>surjective</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>unfold_locales</span><span> </span><span>auto</span><span>
</span><span>
</span><span class="keyword2"><span class="keyword">end</span></span><span> </span><span class="comment"><span class="delete"><span class="delete"><span class="delete"><span class="delete">(* group_isomorphism *)</span></span></span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹p 63, l 6›</span></span></span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>isomorphic_as_groups</span><span> </span><span class="delimiter">(</span><span class="keyword2"><span class="keyword">infixl</span></span><span> </span><span class="string"><span class="delete"><span class="delete">"≅<span class="hidden">⇩</span><sub>G</sub>"</span></span></span><span> </span><span>50</span><span class="delimiter">)</span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">"𝒢 ≅<span class="hidden">⇩</span><sub>G</sub> 𝒢' ⟷ (let (G, composition, unit) = 𝒢; (G', composition', unit') = 𝒢' in
  (∃η. group_isomorphism η G composition unit G' composition' unit'))"</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹p 63, l 6›</span></span></span><span>
</span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>isomorphic_as_groups_symmetric</span><span class="delimiter">:</span><span>
</span><span>  </span><span class="string"><span class="delete"><span class="delete">"(G, composition, unit) ≅<span class="hidden">⇩</span><sub>G</sub> (G', composition', unit') ⟹ (G', composition', unit') ≅<span class="hidden">⇩</span><sub>G</sub> (G, composition, unit)"</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>simp</span><span> </span><span>add</span><span class="delimiter">:</span><span> </span><span>isomorphic_as_groups_def</span><span class="delimiter">)</span><span> </span><span class="delimiter">(</span><span>meson</span><span> </span><span>group_isomorphism.inverse_group_isomorphism</span><span class="delimiter">)</span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹p 63, l 1›</span></span></span><span>
</span><span class="keyword1"><span class="command">sublocale</span></span><span> </span><span>group_isomorphism</span><span> </span><span class="delimiter">⊆</span><span> </span><span>group_epimorphism</span><span> </span><span class="keyword1"><span class="command">..</span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹p 63, l 1›</span></span></span><span>
</span><span class="keyword1"><span class="command">locale</span></span><span> </span><span>group_epimorphism_fundamental</span><span> </span><span class="delimiter">=</span><span> </span><span>group_homomorphism_fundamental</span><span> </span><span class="delimiter">+</span><span> </span><span>group_epimorphism</span><span> </span><span class="keyword2"><span class="keyword">begin</span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹p 63, ll 1--2›</span></span></span><span>
</span><span class="keyword1"><span class="command">interpretation</span></span><span> </span><span>image</span><span class="delimiter">:</span><span> </span><span>group_homomorphism</span><span> </span><span>induced</span><span> </span><span class="string"><span class="delete"><span class="delete">"G // Ker"</span></span></span><span> </span><span class="string"><span class="delete"><span class="delete">"([⋅])"</span></span></span><span> </span><span class="string"><span class="delete"><span class="delete">"kernel.Class 𝟭"</span></span></span><span> </span><span class="string"><span class="delete"><span class="delete">"(η ` G)"</span></span></span><span> </span><span class="string"><span class="delete"><span class="delete">"(⋅')"</span></span></span><span> </span><span class="string"><span class="delete"><span class="delete">"𝟭'"</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>simp</span><span> </span><span>add</span><span class="delimiter">:</span><span> </span><span>surjective</span><span> </span><span>group_homomorphism_fundamental.intro</span><span> </span><span>induced_group_homomorphism</span><span class="delimiter">)</span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹p 63, ll 1--2›</span></span></span><span>
</span><span class="keyword1"><span class="command">sublocale</span></span><span> </span><span>image</span><span class="delimiter">:</span><span> </span><span>group_isomorphism</span><span> </span><span>induced</span><span> </span><span class="string"><span class="delete"><span class="delete">"G // Ker"</span></span></span><span> </span><span class="string"><span class="delete"><span class="delete">"([⋅])"</span></span></span><span> </span><span class="string"><span class="delete"><span class="delete">"kernel.Class 𝟭"</span></span></span><span> </span><span class="string"><span class="delete"><span class="delete">"(η ` G)"</span></span></span><span> </span><span class="string"><span class="delete"><span class="delete">"(⋅')"</span></span></span><span> </span><span class="string"><span class="delete"><span class="delete">"𝟭'"</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>induced_group_homomorphism</span><span>
</span><span>  </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>unfold_locales</span><span> </span><span class="delimiter">(</span><span>auto</span><span> </span><span>simp</span><span class="delimiter">:</span><span> </span><span>bij_betw_def</span><span> </span><span>induced_image</span><span> </span><span>induced_inj_on</span><span> </span><span>induced.commutes_with_composition</span><span class="delimiter">)</span><span>
</span><span>
</span><span class="keyword2"><span class="keyword">end</span></span><span> </span><span class="comment"><span class="delete"><span class="delete"><span class="delete"><span class="delete">(* group_epimorphism_fundamental *)</span></span></span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">context</span></span><span> </span><span>group_homomorphism</span><span> </span><span class="keyword2"><span class="keyword">begin</span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹p 63, ll 5--7›</span></span></span><span>
</span><span class="keyword1"><span class="command">theorem</span></span><span> </span><span>image_isomorphic_to_factor_group</span><span class="delimiter">:</span><span>
</span><span>  </span><span class="string"><span class="delete"><span class="delete">"∃K composition unit. normal_subgroup K G (⋅) 𝟭 ∧ (η ` G, (⋅'), 𝟭') ≅<span class="hidden">⇩</span><sub>G</sub> (G // K, composition, unit)"</span></span></span><span>
</span><span class="keyword1"><span class="command">proof</span></span><span> </span><span>-</span><span>
</span><span>  </span><span class="keyword1"><span class="command">interpret</span></span><span> </span><span>image</span><span class="delimiter">:</span><span> </span><span>group_epimorphism_fundamental</span><span> </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span>G'</span><span> </span><span class="delimiter">=</span><span> </span><span class="string"><span class="delete"><span class="delete">"η ` G"</span></span></span><span>
</span><span>    </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>unfold_locales</span><span> </span><span class="delimiter">(</span><span>auto</span><span> </span><span>simp</span><span class="delimiter">:</span><span> </span><span>commutes_with_composition</span><span class="delimiter">)</span><span>
</span><span>  </span><span class="keyword1"><span class="command">have</span></span><span> </span><span class="string"><span class="delete"><span class="delete">"group_isomorphism image.induced (G // Ker) ([⋅]) (kernel.Class 𝟭) (η ` G) (⋅') 𝟭'"</span></span></span><span> </span><span class="keyword1"><span class="command">..</span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">then</span></span><span> </span><span class="keyword1"><span class="command">have</span></span><span> </span><span class="string"><span class="delete"><span class="delete">"(η ` G, (⋅'), 𝟭') ≅<span class="hidden">⇩</span><sub>G</sub> (G // Ker, ([⋅]), kernel.Class 𝟭)"</span></span></span><span>
</span><span>    </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>simp</span><span> </span><span>add</span><span class="delimiter">:</span><span> </span><span>isomorphic_as_groups_def</span><span class="delimiter">)</span><span> </span><span class="delimiter">(</span><span>meson</span><span> </span><span>group_isomorphism.inverse_group_isomorphism</span><span class="delimiter">)</span><span>
</span><span>  </span><span class="keyword1"><span class="command">moreover</span></span><span> </span><span class="keyword1"><span class="command">have</span></span><span> </span><span class="string"><span class="delete"><span class="delete">"normal_subgroup Ker G (⋅) 𝟭"</span></span></span><span> </span><span class="keyword1"><span class="command">..</span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">ultimately</span></span><span> </span><span class="keyword3"><span class="command">show</span></span><span> </span><span class="var">?thesis</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>blast</span><span>
</span><span class="keyword1"><span class="command">qed</span></span><span>
</span><span>
</span><span class="keyword2"><span class="keyword">end</span></span><span> </span><span class="comment"><span class="delete"><span class="delete"><span class="delete"><span class="delete">(* group_homomorphism *)</span></span></span></span></span><span>
</span><span>
</span><span class="keyword2"><span class="keyword">end</span></span><span>
</span></pre>
</div>
</div><div id="Ring_Theory">
<div class="head"><h1>Theory Ring_Theory</h1>
<span class="command">theory</span> <span class="name">Ring_Theory</span><br/>
<span class="keyword">imports</span> <a href="Group_Theory.html"><span class="name">Group_Theory</span></a><br/>
</div>
<div class="source">
<pre class="source"><span class="comment"><span class="delete"><span class="delete"><span class="delete"><span class="delete">(*
  Copyright (c) 2015--2019 by Clemens Ballarin
  This file is licensed under the 3-clause BSD license.
*)</span></span></span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">theory</span></span><span> </span><span>Ring_Theory</span><span> </span><span class="keyword2"><span class="keyword">imports</span></span><span> </span><span>Group_Theory</span><span> </span><span class="keyword2"><span class="keyword">begin</span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">no_notation</span></span><span> </span><span>plus</span><span> </span><span class="delimiter">(</span><span class="keyword2"><span class="keyword">infixl</span></span><span> </span><span class="string"><span class="delete"><span class="delete">"+"</span></span></span><span> </span><span>65</span><span class="delimiter">)</span><span>
</span><span class="keyword1"><span class="command">no_notation</span></span><span> </span><span>minus</span><span> </span><span class="delimiter">(</span><span class="keyword2"><span class="keyword">infixl</span></span><span> </span><span class="string"><span class="delete"><span class="delete">"-"</span></span></span><span> </span><span>65</span><span class="delimiter">)</span><span>
</span><span class="keyword1"><span class="command">no_notation</span></span><span> </span><span>uminus</span><span> </span><span class="delimiter">(</span><span class="string"><span class="delete"><span class="delete">"- _"</span></span></span><span> </span><span class="delimiter">[</span><span>81</span><span class="delimiter">]</span><span> </span><span>80</span><span class="delimiter">)</span><span>
</span><span class="keyword1"><span class="command">no_notation</span></span><span> </span><span>quotient</span><span> </span><span class="delimiter">(</span><span class="keyword2"><span class="keyword">infixl</span></span><span> </span><span class="string"><span class="delete"><span class="delete">"'/'/"</span></span></span><span> </span><span>90</span><span class="delimiter">)</span><span>
</span><span>
</span><span>
</span><span class="keyword1"><span class="command">section</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹Rings›</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">subsection</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹Definition and Elementary Properties›</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹Def 2.1›</span></span></span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹p 86, ll 20--28›</span></span></span><span>
</span><span class="keyword1"><span class="command">locale</span></span><span> </span><span>ring</span><span> </span><span class="delimiter">=</span><span> </span><span>additive</span><span class="delimiter">:</span><span> </span><span>abelian_group</span><span> </span><span>R</span><span> </span><span class="string"><span class="delete"><span class="delete">"(+)"</span></span></span><span> </span><span>𝟬</span><span> </span><span class="delimiter">+</span><span> </span><span>multiplicative</span><span class="delimiter">:</span><span> </span><span>monoid</span><span> </span><span>R</span><span> </span><span class="string"><span class="delete"><span class="delete">"(⋅)"</span></span></span><span> </span><span>𝟭</span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">for</span></span><span> </span><span>R</span><span> </span><span class="keyword2"><span class="keyword">and</span></span><span> </span><span>addition</span><span> </span><span class="delimiter">(</span><span class="keyword2"><span class="keyword">infixl</span></span><span> </span><span class="string"><span class="delete"><span class="delete">"+"</span></span></span><span> </span><span>65</span><span class="delimiter">)</span><span> </span><span class="keyword2"><span class="keyword">and</span></span><span> </span><span>multiplication</span><span> </span><span class="delimiter">(</span><span class="keyword2"><span class="keyword">infixl</span></span><span> </span><span class="string"><span class="delete"><span class="delete">"⋅"</span></span></span><span> </span><span>70</span><span class="delimiter">)</span><span> </span><span class="keyword2"><span class="keyword">and</span></span><span> </span><span>zero</span><span> </span><span class="delimiter">(</span><span class="string"><span class="delete"><span class="delete">"𝟬"</span></span></span><span class="delimiter">)</span><span> </span><span class="keyword2"><span class="keyword">and</span></span><span> </span><span>unit</span><span> </span><span class="delimiter">(</span><span class="string"><span class="delete"><span class="delete">"𝟭"</span></span></span><span class="delimiter">)</span><span> </span><span class="delimiter">+</span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">assumes</span></span><span> </span><span>distributive</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">"⟦ a ∈ R; b ∈ R; c ∈ R ⟧ ⟹ a ⋅ (b + c) = a ⋅ b + a ⋅ c"</span></span></span><span>
</span><span>    </span><span class="string"><span class="delete"><span class="delete">"⟦ a ∈ R; b ∈ R; c ∈ R ⟧ ⟹ (b + c) ⋅ a = b ⋅ a + c ⋅ a"</span></span></span><span>
</span><span class="keyword2"><span class="keyword">begin</span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹p 86, ll 20--28›</span></span></span><span>
</span><span class="keyword1"><span class="command">notation</span></span><span> </span><span>additive.inverse</span><span> </span><span class="delimiter">(</span><span class="string"><span class="delete"><span class="delete">"- _"</span></span></span><span> </span><span class="delimiter">[</span><span>66</span><span class="delimiter">]</span><span> </span><span>65</span><span class="delimiter">)</span><span>
</span><span class="keyword1"><span class="command">abbreviation</span></span><span> </span><span>subtraction</span><span> </span><span class="delimiter">(</span><span class="keyword2"><span class="keyword">infixl</span></span><span> </span><span class="string"><span class="delete"><span class="delete">"-"</span></span></span><span> </span><span>65</span><span class="delimiter">)</span><span> </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">"a - b ≡ a + (- b)"</span></span></span><span>  </span><span class="comment"><span class="delete"><span class="delete"><span class="delete"><span class="delete">(* or, alternatively, a definition *)</span></span></span></span></span><span>
</span><span>
</span><span class="keyword2"><span class="keyword">end</span></span><span> </span><span class="comment"><span class="delete"><span class="delete"><span class="delete"><span class="delete">(* ring *)</span></span></span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹p 87, ll 10--12›</span></span></span><span>
</span><span class="keyword1"><span class="command">locale</span></span><span> </span><span>subring</span><span> </span><span class="delimiter">=</span><span>
</span><span>  </span><span>additive</span><span class="delimiter">:</span><span> </span><span>subgroup</span><span> </span><span>S</span><span> </span><span>R</span><span> </span><span class="string"><span class="delete"><span class="delete">"(+)"</span></span></span><span> </span><span>𝟬</span><span> </span><span class="delimiter">+</span><span> </span><span>multiplicative</span><span class="delimiter">:</span><span> </span><span>submonoid</span><span> </span><span>S</span><span> </span><span>R</span><span> </span><span class="string"><span class="delete"><span class="delete">"(⋅)"</span></span></span><span> </span><span>𝟭</span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">for</span></span><span> </span><span>S</span><span> </span><span class="keyword2"><span class="keyword">and</span></span><span> </span><span>R</span><span> </span><span class="keyword2"><span class="keyword">and</span></span><span> </span><span>addition</span><span> </span><span class="delimiter">(</span><span class="keyword2"><span class="keyword">infixl</span></span><span> </span><span class="string"><span class="delete"><span class="delete">"+"</span></span></span><span> </span><span>65</span><span class="delimiter">)</span><span> </span><span class="keyword2"><span class="keyword">and</span></span><span> </span><span>multiplication</span><span> </span><span class="delimiter">(</span><span class="keyword2"><span class="keyword">infixl</span></span><span> </span><span class="string"><span class="delete"><span class="delete">"⋅"</span></span></span><span> </span><span>70</span><span class="delimiter">)</span><span> </span><span class="keyword2"><span class="keyword">and</span></span><span> </span><span>zero</span><span> </span><span class="delimiter">(</span><span class="string"><span class="delete"><span class="delete">"𝟬"</span></span></span><span class="delimiter">)</span><span> </span><span class="keyword2"><span class="keyword">and</span></span><span> </span><span>unit</span><span> </span><span class="delimiter">(</span><span class="string"><span class="delete"><span class="delete">"𝟭"</span></span></span><span class="delimiter">)</span><span>
</span><span>
</span><span class="keyword1"><span class="command">context</span></span><span> </span><span>ring</span><span> </span><span class="keyword2"><span class="keyword">begin</span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹p 88, ll 26--28›</span></span></span><span>
</span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>right_zero</span><span> </span><span class="delimiter">[</span><span>simp</span><span class="delimiter">]</span><span class="delimiter">:</span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">assumes</span></span><span> </span><span class="delimiter">[</span><span>simp</span><span class="delimiter">]</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">"a ∈ R"</span></span></span><span> </span><span class="keyword2"><span class="keyword">shows</span></span><span> </span><span class="string"><span class="delete"><span class="delete">"a ⋅ 𝟬 = 𝟬"</span></span></span><span>
</span><span class="keyword1"><span class="command">proof</span></span><span> </span><span>-</span><span>
</span><span>  </span><span class="keyword1"><span class="command">have</span></span><span> </span><span class="string"><span class="delete"><span class="delete">"a ⋅ 𝟬 = a ⋅ (𝟬 + 𝟬)"</span></span></span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>simp</span><span>
</span><span>  </span><span class="keyword1"><span class="command">also</span></span><span> </span><span class="keyword1"><span class="command">have</span></span><span> </span><span class="string"><span class="delete"><span class="delete">"… = a ⋅ 𝟬 + a ⋅ 𝟬"</span></span></span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>simp</span><span> </span><span>add</span><span class="delimiter">:</span><span> </span><span>distributive</span><span> </span><span>del</span><span class="delimiter">:</span><span> </span><span>additive.left_unit</span><span> </span><span>additive.right_unit</span><span class="delimiter">)</span><span>
</span><span>  </span><span class="keyword1"><span class="command">finally</span></span><span> </span><span class="keyword1"><span class="command">have</span></span><span> </span><span class="string"><span class="delete"><span class="delete">"a ⋅ 𝟬 - a ⋅ 𝟬 = a ⋅ 𝟬 + a ⋅ 𝟬 - a ⋅ 𝟬"</span></span></span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>simp</span><span>
</span><span>  </span><span class="keyword1"><span class="command">then</span></span><span> </span><span class="keyword3"><span class="command">show</span></span><span> </span><span class="var">?thesis</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>simp</span><span> </span><span>add</span><span class="delimiter">:</span><span> </span><span>additive.associative</span><span> </span><span>del</span><span class="delimiter">:</span><span> </span><span>additive.invertible_left_cancel</span><span class="delimiter">)</span><span>
</span><span class="keyword1"><span class="command">qed</span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹p 88, l 29›</span></span></span><span>
</span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>left_zero</span><span> </span><span class="delimiter">[</span><span>simp</span><span class="delimiter">]</span><span class="delimiter">:</span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">assumes</span></span><span> </span><span class="delimiter">[</span><span>simp</span><span class="delimiter">]</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">"a ∈ R"</span></span></span><span> </span><span class="keyword2"><span class="keyword">shows</span></span><span> </span><span class="string"><span class="delete"><span class="delete">"𝟬 ⋅ a = 𝟬"</span></span></span><span>
</span><span class="keyword1"><span class="command">proof</span></span><span> </span><span>-</span><span>
</span><span>  </span><span class="keyword1"><span class="command">have</span></span><span> </span><span class="string"><span class="delete"><span class="delete">"𝟬 ⋅ a = (𝟬 + 𝟬) ⋅ a"</span></span></span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>simp</span><span>
</span><span>  </span><span class="keyword1"><span class="command">also</span></span><span> </span><span class="keyword1"><span class="command">have</span></span><span> </span><span class="string"><span class="delete"><span class="delete">"… = 𝟬 ⋅ a + 𝟬 ⋅ a"</span></span></span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>simp</span><span> </span><span>add</span><span class="delimiter">:</span><span> </span><span>distributive</span><span> </span><span>del</span><span class="delimiter">:</span><span> </span><span>additive.left_unit</span><span> </span><span>additive.right_unit</span><span class="delimiter">)</span><span>
</span><span>  </span><span class="keyword1"><span class="command">finally</span></span><span> </span><span class="keyword1"><span class="command">have</span></span><span> </span><span class="string"><span class="delete"><span class="delete">"𝟬 ⋅ a - 𝟬 ⋅ a = 𝟬 ⋅ a + 𝟬 ⋅ a - 𝟬 ⋅ a"</span></span></span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>simp</span><span>
</span><span>  </span><span class="keyword1"><span class="command">then</span></span><span> </span><span class="keyword3"><span class="command">show</span></span><span> </span><span class="var">?thesis</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>simp</span><span> </span><span>add</span><span class="delimiter">:</span><span> </span><span>additive.associative</span><span> </span><span>del</span><span class="delimiter">:</span><span> </span><span>additive.invertible_left_cancel</span><span class="delimiter">)</span><span>
</span><span class="keyword1"><span class="command">qed</span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹p 88, ll 29--30; p 89, ll 1--2›</span></span></span><span>
</span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>left_minus</span><span class="delimiter">:</span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">assumes</span></span><span> </span><span class="delimiter">[</span><span>simp</span><span class="delimiter">]</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">"a ∈ R"</span></span></span><span> </span><span class="string"><span class="delete"><span class="delete">"b ∈ R"</span></span></span><span> </span><span class="keyword2"><span class="keyword">shows</span></span><span> </span><span class="string"><span class="delete"><span class="delete">"(- a) ⋅ b = - a ⋅ b"</span></span></span><span>
</span><span class="keyword1"><span class="command">proof</span></span><span> </span><span>-</span><span>
</span><span>  </span><span class="keyword1"><span class="command">have</span></span><span> </span><span class="string"><span class="delete"><span class="delete">"𝟬 = 𝟬 ⋅ b"</span></span></span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>simp</span><span>
</span><span>  </span><span class="keyword1"><span class="command">also</span></span><span> </span><span class="keyword1"><span class="command">have</span></span><span> </span><span class="string"><span class="delete"><span class="delete">"… = (a - a) ⋅ b"</span></span></span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>simp</span><span>
</span><span>  </span><span class="keyword1"><span class="command">also</span></span><span> </span><span class="keyword1"><span class="command">have</span></span><span> </span><span class="string"><span class="delete"><span class="delete">"… = a ⋅ b + (- a) ⋅ b"</span></span></span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>simp</span><span> </span><span>add</span><span class="delimiter">:</span><span> </span><span>distributive</span><span> </span><span>del</span><span class="delimiter">:</span><span> </span><span>additive.invertible_right_inverse</span><span class="delimiter">)</span><span>
</span><span>  </span><span class="keyword1"><span class="command">finally</span></span><span> </span><span class="keyword1"><span class="command">have</span></span><span> </span><span class="string"><span class="delete"><span class="delete">"- a ⋅ b + 𝟬 = - a ⋅ b + a ⋅ b + (- a) ⋅ b"</span></span></span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>simp</span><span> </span><span>add</span><span class="delimiter">:</span><span> </span><span>additive.associative</span><span> </span><span>del</span><span class="delimiter">:</span><span> </span><span>additive.invertible_left_inverse</span><span class="delimiter">)</span><span>
</span><span>  </span><span class="keyword1"><span class="command">then</span></span><span> </span><span class="keyword3"><span class="command">show</span></span><span> </span><span class="var">?thesis</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>simp</span><span>
</span><span class="keyword1"><span class="command">qed</span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹p 89, l 3›</span></span></span><span>
</span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>right_minus</span><span class="delimiter">:</span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">assumes</span></span><span> </span><span class="delimiter">[</span><span>simp</span><span class="delimiter">]</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">"a ∈ R"</span></span></span><span> </span><span class="string"><span class="delete"><span class="delete">"b ∈ R"</span></span></span><span> </span><span class="keyword2"><span class="keyword">shows</span></span><span> </span><span class="string"><span class="delete"><span class="delete">"a ⋅ (- b) = - a ⋅ b"</span></span></span><span>
</span><span class="keyword1"><span class="command">proof</span></span><span> </span><span>-</span><span>
</span><span>  </span><span class="keyword1"><span class="command">have</span></span><span> </span><span class="string"><span class="delete"><span class="delete">"𝟬 = a ⋅ 𝟬"</span></span></span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>simp</span><span>
</span><span>  </span><span class="keyword1"><span class="command">also</span></span><span> </span><span class="keyword1"><span class="command">have</span></span><span> </span><span class="string"><span class="delete"><span class="delete">"… = a ⋅ (b - b)"</span></span></span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>simp</span><span>
</span><span>  </span><span class="keyword1"><span class="command">also</span></span><span> </span><span class="keyword1"><span class="command">have</span></span><span> </span><span class="string"><span class="delete"><span class="delete">"… = a ⋅ b + a ⋅ (- b)"</span></span></span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>simp</span><span> </span><span>add</span><span class="delimiter">:</span><span> </span><span>distributive</span><span> </span><span>del</span><span class="delimiter">:</span><span> </span><span>additive.invertible_right_inverse</span><span class="delimiter">)</span><span>
</span><span>  </span><span class="keyword1"><span class="command">finally</span></span><span> </span><span class="keyword1"><span class="command">have</span></span><span> </span><span class="string"><span class="delete"><span class="delete">"- a ⋅ b + 𝟬 = - a ⋅ b + a ⋅ b + a ⋅ (- b)"</span></span></span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>simp</span><span> </span><span>add</span><span class="delimiter">:</span><span> </span><span>additive.associative</span><span> </span><span>del</span><span class="delimiter">:</span><span> </span><span>additive.invertible_left_inverse</span><span class="delimiter">)</span><span>
</span><span>  </span><span class="keyword1"><span class="command">then</span></span><span> </span><span class="keyword3"><span class="command">show</span></span><span> </span><span class="var">?thesis</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>simp</span><span>
</span><span class="keyword1"><span class="command">qed</span></span><span>
</span><span>
</span><span class="keyword2"><span class="keyword">end</span></span><span> </span><span class="comment"><span class="delete"><span class="delete"><span class="delete"><span class="delete">(* ring *)</span></span></span></span></span><span>
</span><span>
</span><span>
</span><span class="keyword1"><span class="command">subsection</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹Ideals, Quotient Rings›</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹p 101, ll 2--5›</span></span></span><span>
</span><span class="keyword1"><span class="command">locale</span></span><span> </span><span>ring_congruence</span><span> </span><span class="delimiter">=</span><span> </span><span>ring</span><span> </span><span class="delimiter">+</span><span>
</span><span>  </span><span>additive</span><span class="delimiter">:</span><span> </span><span>group_congruence</span><span> </span><span>R</span><span> </span><span class="string"><span class="delete"><span class="delete">"(+)"</span></span></span><span> </span><span>𝟬</span><span> </span><span>E</span><span> </span><span class="delimiter">+</span><span>
</span><span>  </span><span>multiplicative</span><span class="delimiter">:</span><span> </span><span>monoid_congruence</span><span> </span><span>R</span><span> </span><span class="string"><span class="delete"><span class="delete">"(⋅)"</span></span></span><span> </span><span>𝟭</span><span> </span><span>E</span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">for</span></span><span> </span><span>E</span><span>
</span><span class="keyword2"><span class="keyword">begin</span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹p 101, ll 2--5›</span></span></span><span>
</span><span class="keyword1"><span class="command">notation</span></span><span> </span><span>additive.quotient_composition</span><span> </span><span class="delimiter">(</span><span class="keyword2"><span class="keyword">infixl</span></span><span> </span><span class="string"><span class="delete"><span class="delete">"[+]"</span></span></span><span> </span><span>65</span><span class="delimiter">)</span><span>
</span><span class="keyword1"><span class="command">notation</span></span><span> </span><span>additive.quotient.inverse</span><span> </span><span class="delimiter">(</span><span class="string"><span class="delete"><span class="delete">"[-] _"</span></span></span><span> </span><span class="delimiter">[</span><span>66</span><span class="delimiter">]</span><span> </span><span>65</span><span class="delimiter">)</span><span>
</span><span class="keyword1"><span class="command">notation</span></span><span> </span><span>multiplicative.quotient_composition</span><span> </span><span class="delimiter">(</span><span class="keyword2"><span class="keyword">infixl</span></span><span> </span><span class="string"><span class="delete"><span class="delete">"[⋅]"</span></span></span><span> </span><span>70</span><span class="delimiter">)</span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹p 101, ll 5--11›</span></span></span><span>
</span><span class="keyword1"><span class="command">sublocale</span></span><span> </span><span>quotient</span><span class="delimiter">:</span><span> </span><span>ring</span><span> </span><span class="string"><span class="delete"><span class="delete">"R / E"</span></span></span><span> </span><span class="string"><span class="delete"><span class="delete">"([+])"</span></span></span><span> </span><span class="string"><span class="delete"><span class="delete">"([⋅])"</span></span></span><span> </span><span class="string"><span class="delete"><span class="delete">"additive.Class 𝟬"</span></span></span><span> </span><span class="string"><span class="delete"><span class="delete">"additive.Class 𝟭"</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>unfold_locales</span><span>
</span><span>    </span><span class="delimiter">(</span><span>auto</span><span> </span><span>simp</span><span class="delimiter">:</span><span> </span><span>additive.Class_commutes_with_composition</span><span> </span><span>additive.associative</span><span> </span><span>additive.commutative</span><span>
</span><span>     </span><span>multiplicative.Class_commutes_with_composition</span><span> </span><span>distributive</span><span> </span><span>elim</span><span class="delimiter">!</span><span class="delimiter">:</span><span> </span><span>additive.quotient_ClassE</span><span class="delimiter">)</span><span>
</span><span>
</span><span class="keyword2"><span class="keyword">end</span></span><span> </span><span class="comment"><span class="delete"><span class="delete"><span class="delete"><span class="delete">(* ring_congruence *)</span></span></span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹p 101, ll 12--13›</span></span></span><span>
</span><span class="keyword1"><span class="command">locale</span></span><span> </span><span>subgroup_of_additive_group_of_ring</span><span> </span><span class="delimiter">=</span><span>
</span><span>  </span><span>additive</span><span class="delimiter">:</span><span> </span><span>subgroup</span><span> </span><span>I</span><span> </span><span>R</span><span> </span><span class="string"><span class="delete"><span class="delete">"(+)"</span></span></span><span> </span><span>𝟬</span><span> </span><span class="delimiter">+</span><span> </span><span>ring</span><span> </span><span>R</span><span> </span><span class="string"><span class="delete"><span class="delete">"(+)"</span></span></span><span> </span><span class="string"><span class="delete"><span class="delete">"(⋅)"</span></span></span><span> </span><span>𝟬</span><span> </span><span>𝟭</span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">for</span></span><span> </span><span>I</span><span> </span><span class="keyword2"><span class="keyword">and</span></span><span> </span><span>R</span><span> </span><span class="keyword2"><span class="keyword">and</span></span><span> </span><span>addition</span><span> </span><span class="delimiter">(</span><span class="keyword2"><span class="keyword">infixl</span></span><span> </span><span class="string"><span class="delete"><span class="delete">"+"</span></span></span><span> </span><span>65</span><span class="delimiter">)</span><span> </span><span class="keyword2"><span class="keyword">and</span></span><span> </span><span>multiplication</span><span> </span><span class="delimiter">(</span><span class="keyword2"><span class="keyword">infixl</span></span><span> </span><span class="string"><span class="delete"><span class="delete">"⋅"</span></span></span><span> </span><span>70</span><span class="delimiter">)</span><span> </span><span class="keyword2"><span class="keyword">and</span></span><span> </span><span>zero</span><span> </span><span class="delimiter">(</span><span class="string"><span class="delete"><span class="delete">"𝟬"</span></span></span><span class="delimiter">)</span><span> </span><span class="keyword2"><span class="keyword">and</span></span><span> </span><span>unit</span><span> </span><span class="delimiter">(</span><span class="string"><span class="delete"><span class="delete">"𝟭"</span></span></span><span class="delimiter">)</span><span>
</span><span class="keyword2"><span class="keyword">begin</span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹p 101, ll 13--14›</span></span></span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span class="string"><span class="delete"><span class="delete">"Ring_Congruence = {(a, b). a ∈ R ∧ b ∈ R ∧ a - b ∈ I}"</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹p 101, ll 13--14›</span></span></span><span>
</span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>Ring_CongruenceI</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">"⟦ a - b ∈ I; a ∈ R; b ∈ R ⟧ ⟹ (a, b) ∈ Ring_Congruence"</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>Ring_Congruence_def</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>blast</span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹p 101, ll 13--14›</span></span></span><span>
</span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>Ring_CongruenceD</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">"(a, b) ∈ Ring_Congruence ⟹ a - b ∈ I"</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>Ring_Congruence_def</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>blast</span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹
  Jacobson's definition of ring congruence deviates from that of group congruence; this complicates
  the proof.
›</span></span></span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹p 101, ll 12--14›</span></span></span><span>
</span><span class="keyword1"><span class="command">sublocale</span></span><span> </span><span>additive</span><span class="delimiter">:</span><span> </span><span>subgroup_of_abelian_group</span><span> </span><span>I</span><span> </span><span>R</span><span> </span><span class="string"><span class="delete"><span class="delete">"(+)"</span></span></span><span> </span><span>𝟬</span><span>  </span><span class="comment"><span class="delete"><span class="delete"><span class="delete"><span class="delete">(* implies normal_subgroup *)</span></span></span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">rewrites</span></span><span> </span><span>additive_congruence</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">"additive.Congruence = Ring_Congruence"</span></span></span><span>
</span><span class="keyword1"><span class="command">proof</span></span><span> </span><span>-</span><span>
</span><span>  </span><span class="keyword3"><span class="command">show</span></span><span> </span><span class="string"><span class="delete"><span class="delete">"subgroup_of_abelian_group I R (+) 𝟬"</span></span></span><span>
</span><span>    </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>additive.commutative</span><span> </span><span>additive.invertible_right_inverse2</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>unfold_locales</span><span> </span><span>auto</span><span>
</span><span>  </span><span class="keyword1"><span class="command">then</span></span><span> </span><span class="keyword1"><span class="command">interpret</span></span><span> </span><span>additive</span><span class="delimiter">:</span><span> </span><span>subgroup_of_abelian_group</span><span> </span><span>I</span><span> </span><span>R</span><span> </span><span class="string"><span class="delete"><span class="delete">"(+)"</span></span></span><span> </span><span>𝟬</span><span> </span><span class="keyword1"><span class="command">.</span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">{</span></span><span>
</span><span>    </span><span class="keyword3"><span class="command">fix</span></span><span> </span><span>a</span><span> </span><span>b</span><span>
</span><span>    </span><span class="keyword3"><span class="command">assume</span></span><span> </span><span class="delimiter">[</span><span>simp</span><span class="delimiter">]</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">"a ∈ R"</span></span></span><span> </span><span class="string"><span class="delete"><span class="delete">"b ∈ R"</span></span></span><span>
</span><span>    </span><span class="keyword1"><span class="command">have</span></span><span> </span><span class="string"><span class="delete"><span class="delete">"a - b ∈ I ⟷ - (a - b) ∈ I"</span></span></span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>auto</span><span>
</span><span>    </span><span class="keyword1"><span class="command">also</span></span><span> </span><span class="keyword1"><span class="command">have</span></span><span> </span><span class="string"><span class="delete"><span class="delete">"… ⟷ - a + b ∈ I"</span></span></span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>simp</span><span> </span><span>add</span><span class="delimiter">:</span><span> </span><span>additive.commutative</span><span> </span><span>additive.inverse_composition_commute</span><span class="delimiter">)</span><span>
</span><span>    </span><span class="keyword1"><span class="command">finally</span></span><span> </span><span class="keyword1"><span class="command">have</span></span><span> </span><span class="string"><span class="delete"><span class="delete">"a - b ∈ I ⟷ - a + b ∈ I"</span></span></span><span> </span><span class="keyword1"><span class="command">.</span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">}</span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">then</span></span><span> </span><span class="keyword3"><span class="command">show</span></span><span> </span><span class="string"><span class="delete"><span class="delete">"additive.Congruence = Ring_Congruence"</span></span></span><span>
</span><span>    </span><span class="keyword1"><span class="command">unfolding</span></span><span> </span><span>additive.Congruence_def</span><span> </span><span>Ring_Congruence_def</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>auto</span><span>
</span><span class="keyword1"><span class="command">qed</span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹p 101, l 14›</span></span></span><span>
</span><span class="keyword1"><span class="command">notation</span></span><span> </span><span>additive.Left_Coset</span><span> </span><span class="delimiter">(</span><span class="keyword2"><span class="keyword">infixl</span></span><span> </span><span class="string"><span class="delete"><span class="delete">"+|"</span></span></span><span> </span><span>65</span><span class="delimiter">)</span><span>
</span><span>
</span><span class="keyword2"><span class="keyword">end</span></span><span> </span><span class="comment"><span class="delete"><span class="delete"><span class="delete"><span class="delete">(* subgroup_of_additive_group_of_ring *)</span></span></span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹Def 2.2›</span></span></span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹p 101, ll 21--22›</span></span></span><span>
</span><span class="keyword1"><span class="command">locale</span></span><span> </span><span>ideal</span><span> </span><span class="delimiter">=</span><span> </span><span>subgroup_of_additive_group_of_ring</span><span> </span><span class="delimiter">+</span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">assumes</span></span><span> </span><span>ideal</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">"⟦ a ∈ R; b ∈ I ⟧ ⟹ a ⋅ b ∈ I"</span></span></span><span> </span><span class="string"><span class="delete"><span class="delete">"⟦ a ∈ R; b ∈ I ⟧ ⟹ b ⋅ a ∈ I"</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">context</span></span><span> </span><span>subgroup_of_additive_group_of_ring</span><span> </span><span class="keyword2"><span class="keyword">begin</span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹p 101, ll 14--17›</span></span></span><span>
</span><span class="keyword1"><span class="command">theorem</span></span><span> </span><span>multiplicative_congruence_implies_ideal</span><span class="delimiter">:</span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">assumes</span></span><span> </span><span class="string"><span class="delete"><span class="delete">"monoid_congruence R (⋅) 𝟭 Ring_Congruence"</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">shows</span></span><span> </span><span class="string"><span class="delete"><span class="delete">"ideal I R (+) (⋅) 𝟬 𝟭"</span></span></span><span>
</span><span class="keyword1"><span class="command">proof</span></span><span> </span><span>-</span><span>
</span><span>  </span><span class="keyword1"><span class="command">interpret</span></span><span> </span><span>multiplicative</span><span class="delimiter">:</span><span> </span><span>monoid_congruence</span><span> </span><span>R</span><span> </span><span class="string"><span class="delete"><span class="delete">"(⋅)"</span></span></span><span> </span><span>𝟭</span><span> </span><span>Ring_Congruence</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>fact</span><span>
</span><span>  </span><span class="keyword3"><span class="command">show</span></span><span> </span><span class="var">?thesis</span><span>
</span><span>  </span><span class="keyword1"><span class="command">proof</span></span><span>
</span><span>    </span><span class="keyword3"><span class="command">fix</span></span><span> </span><span>a</span><span> </span><span>b</span><span>
</span><span>    </span><span class="keyword3"><span class="command">assume</span></span><span> </span><span class="delimiter">[</span><span>simp</span><span class="delimiter">]</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">"a ∈ R"</span></span></span><span> </span><span class="string"><span class="delete"><span class="delete">"b ∈ I"</span></span></span><span>
</span><span>    </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>congs</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">"(a, a) ∈ Ring_Congruence"</span></span></span><span> </span><span class="string"><span class="delete"><span class="delete">"(b, 𝟬) ∈ Ring_Congruence"</span></span></span><span>
</span><span>      </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>auto</span><span> </span><span>simp</span><span class="delimiter">:</span><span> </span><span>additive.ClassD</span><span> </span><span>additive.Class_unit_normal_subgroup</span><span class="delimiter">)</span><span>
</span><span>    </span><span class="keyword1"><span class="command">from</span></span><span> </span><span>congs</span><span> </span><span class="keyword1"><span class="command">have</span></span><span> </span><span class="string"><span class="delete"><span class="delete">"(a ⋅ b, 𝟬) ∈ Ring_Congruence"</span></span></span><span> </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>multiplicative.cong</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>fastforce</span><span>
</span><span>    </span><span class="keyword1"><span class="command">then</span></span><span> </span><span class="keyword3"><span class="command">show</span></span><span> </span><span class="string"><span class="delete"><span class="delete">"a ⋅ b ∈ I"</span></span></span><span> </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>additive.Class_unit_normal_subgroup</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>blast</span><span>
</span><span>    </span><span class="keyword1"><span class="command">from</span></span><span> </span><span>congs</span><span> </span><span class="keyword1"><span class="command">have</span></span><span> </span><span class="string"><span class="delete"><span class="delete">"(b ⋅ a, 𝟬) ∈ Ring_Congruence"</span></span></span><span> </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>multiplicative.cong</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>fastforce</span><span>
</span><span>    </span><span class="keyword1"><span class="command">then</span></span><span> </span><span class="keyword3"><span class="command">show</span></span><span> </span><span class="string"><span class="delete"><span class="delete">"b ⋅ a ∈ I"</span></span></span><span>  </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>additive.Class_unit_normal_subgroup</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>blast</span><span>
</span><span>  </span><span class="keyword1"><span class="command">qed</span></span><span>
</span><span class="keyword1"><span class="command">qed</span></span><span>
</span><span>
</span><span class="keyword2"><span class="keyword">end</span></span><span> </span><span class="comment"><span class="delete"><span class="delete"><span class="delete"><span class="delete">(* subgroup_of_additive_group_of_ring *)</span></span></span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">context</span></span><span> </span><span>ideal</span><span> </span><span class="keyword2"><span class="keyword">begin</span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹p 101, ll 17--20›</span></span></span><span>
</span><span class="keyword1"><span class="command">theorem</span></span><span> </span><span>multiplicative_congruence</span><span> </span><span class="delimiter">[</span><span>intro</span><span class="delimiter">]</span><span class="delimiter">:</span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">assumes</span></span><span> </span><span>a</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">"(a, a') ∈ Ring_Congruence"</span></span></span><span> </span><span class="keyword2"><span class="keyword">and</span></span><span> </span><span>b</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">"(b, b') ∈ Ring_Congruence"</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">shows</span></span><span> </span><span class="string"><span class="delete"><span class="delete">"(a ⋅ b, a' ⋅ b') ∈ Ring_Congruence"</span></span></span><span>
</span><span class="keyword1"><span class="command">proof</span></span><span> </span><span>-</span><span>
</span><span>  </span><span class="keyword1"><span class="command">note</span></span><span> </span><span>Ring_CongruenceI</span><span> </span><span class="delimiter">[</span><span>intro</span><span class="delimiter">]</span><span> </span><span>Ring_CongruenceD</span><span> </span><span class="delimiter">[</span><span>dest</span><span class="delimiter">]</span><span>
</span><span>  </span><span class="keyword1"><span class="command">from</span></span><span> </span><span>a</span><span> </span><span>b</span><span> </span><span class="keyword1"><span class="command">have</span></span><span> </span><span class="delimiter">[</span><span>simp</span><span class="delimiter">]</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">"a ∈ R"</span></span></span><span> </span><span class="string"><span class="delete"><span class="delete">"a' ∈ R"</span></span></span><span> </span><span class="string"><span class="delete"><span class="delete">"b ∈ R"</span></span></span><span> </span><span class="string"><span class="delete"><span class="delete">"b' ∈ R"</span></span></span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>auto</span><span>
</span><span>  </span><span class="keyword1"><span class="command">from</span></span><span> </span><span>a</span><span> </span><span class="keyword1"><span class="command">have</span></span><span> </span><span class="delimiter">[</span><span>simp</span><span class="delimiter">]</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">"a - a' ∈ I"</span></span></span><span> </span><span class="keyword1"><span class="command">..</span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">have</span></span><span> </span><span class="string"><span class="delete"><span class="delete">"a ⋅ b - a' ⋅ b = (a - a') ⋅ b"</span></span></span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>simp</span><span> </span><span>add</span><span class="delimiter">:</span><span> </span><span>distributive</span><span> </span><span>left_minus</span><span class="delimiter">)</span><span>
</span><span>  </span><span class="keyword1"><span class="command">also</span></span><span> </span><span class="keyword1"><span class="command">have</span></span><span> </span><span class="string"><span class="delete"><span class="delete">"… ∈ I"</span></span></span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>simp</span><span> </span><span>add</span><span class="delimiter">:</span><span> </span><span>ideal</span><span class="delimiter">)</span><span>
</span><span>  </span><span class="keyword1"><span class="command">finally</span></span><span> </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>ab</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">"a ⋅ b - a' ⋅ b ∈ I"</span></span></span><span> </span><span class="keyword1"><span class="command">.</span></span><span>  </span><span class="comment">― ‹ll 18--19›</span><span>
</span><span>  </span><span class="keyword1"><span class="command">from</span></span><span> </span><span>b</span><span> </span><span class="keyword1"><span class="command">have</span></span><span> </span><span class="delimiter">[</span><span>simp</span><span class="delimiter">]</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">"b - b' ∈ I"</span></span></span><span> </span><span class="keyword1"><span class="command">..</span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">have</span></span><span> </span><span class="string"><span class="delete"><span class="delete">"a' ⋅ b - a' ⋅ b' = a' ⋅ (b - b')"</span></span></span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>simp</span><span> </span><span>add</span><span class="delimiter">:</span><span> </span><span>distributive</span><span> </span><span>right_minus</span><span class="delimiter">)</span><span>
</span><span>  </span><span class="keyword1"><span class="command">also</span></span><span> </span><span class="keyword1"><span class="command">have</span></span><span> </span><span class="string"><span class="delete"><span class="delete">"… ∈ I"</span></span></span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>simp</span><span> </span><span>add</span><span class="delimiter">:</span><span> </span><span>ideal</span><span class="delimiter">)</span><span>
</span><span>  </span><span class="keyword1"><span class="command">finally</span></span><span> </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>a'b'</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">"a' ⋅ b - a' ⋅ b' ∈ I"</span></span></span><span> </span><span class="keyword1"><span class="command">.</span></span><span>  </span><span class="comment">― ‹l 19›</span><span>
</span><span>  </span><span class="keyword1"><span class="command">have</span></span><span> </span><span class="string"><span class="delete"><span class="delete">"a ⋅ b - a' ⋅ b' = (a ⋅ b - a' ⋅ b) + (a' ⋅ b - a' ⋅ b')"</span></span></span><span>
</span><span>    </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>simp</span><span> </span><span>add</span><span class="delimiter">:</span><span> </span><span>additive.associative</span><span class="delimiter">)</span><span> </span><span class="delimiter">(</span><span>simp</span><span> </span><span>add</span><span class="delimiter">:</span><span> </span><span>additive.associative</span><span> </span><span class="delimiter">[</span><span>symmetric</span><span class="delimiter">]</span><span class="delimiter">)</span><span>
</span><span>  </span><span class="keyword1"><span class="command">also</span></span><span> </span><span class="keyword1"><span class="command">have</span></span><span> </span><span class="string"><span class="delete"><span class="delete">"… ∈ I"</span></span></span><span> </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>ab</span><span> </span><span>a'b'</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>simp</span><span>
</span><span>  </span><span class="keyword1"><span class="command">finally</span></span><span> </span><span class="keyword3"><span class="command">show</span></span><span> </span><span class="string"><span class="delete"><span class="delete">"(a ⋅ b, a' ⋅ b') ∈ Ring_Congruence"</span></span></span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>auto</span><span>  </span><span class="comment">― ‹ll 19--20›</span><span>
</span><span class="keyword1"><span class="command">qed</span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹p 101, ll 23--24›</span></span></span><span>
</span><span class="keyword1"><span class="command">sublocale</span></span><span> </span><span>ring_congruence</span><span> </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span>E</span><span> </span><span class="delimiter">=</span><span> </span><span>Ring_Congruence</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>unfold_locales</span><span> </span><span>rule</span><span>
</span><span>
</span><span class="keyword2"><span class="keyword">end</span></span><span> </span><span class="comment"><span class="delete"><span class="delete"><span class="delete"><span class="delete">(* ideal *)</span></span></span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">context</span></span><span> </span><span>ring</span><span> </span><span class="keyword2"><span class="keyword">begin</span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹Pulled out of @{locale ideal} to achieve standard notation.›</span></span></span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹p 101, ll 24--26›</span></span></span><span>
</span><span class="keyword1"><span class="command">abbreviation</span></span><span> </span><span>Quotient_Ring</span><span> </span><span class="delimiter">(</span><span class="keyword2"><span class="keyword">infixl</span></span><span> </span><span class="string"><span class="delete"><span class="delete">"'/'/"</span></span></span><span> </span><span>75</span><span class="delimiter">)</span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">"S // I ≡ S / (subgroup_of_additive_group_of_ring.Ring_Congruence I R (+) 𝟬)"</span></span></span><span>
</span><span>
</span><span class="keyword2"><span class="keyword">end</span></span><span> </span><span class="comment"><span class="delete"><span class="delete"><span class="delete"><span class="delete">(* ring *)</span></span></span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹p 101, ll 24--26›</span></span></span><span>
</span><span class="keyword1"><span class="command">locale</span></span><span> </span><span>quotient_ring</span><span> </span><span class="delimiter">=</span><span> </span><span>ideal</span><span> </span><span class="keyword2"><span class="keyword">begin</span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹p 101, ll 24--26›</span></span></span><span>
</span><span class="keyword1"><span class="command">sublocale</span></span><span> </span><span>quotient</span><span class="delimiter">:</span><span> </span><span>ring</span><span> </span><span class="string"><span class="delete"><span class="delete">"R // I"</span></span></span><span> </span><span class="string"><span class="delete"><span class="delete">"([+])"</span></span></span><span> </span><span class="string"><span class="delete"><span class="delete">"([⋅])"</span></span></span><span> </span><span class="string"><span class="delete"><span class="delete">"additive.Class 𝟬"</span></span></span><span> </span><span class="string"><span class="delete"><span class="delete">"additive.Class 𝟭"</span></span></span><span> </span><span class="keyword1"><span class="command">..</span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹p 101, l 26›</span></span></span><span>
</span><span class="keyword1"><span class="command">lemmas</span></span><span> </span><span>Left_Coset</span><span> </span><span class="delimiter">=</span><span> </span><span>additive.Left_CosetE</span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹Equation 17 (1)›</span></span></span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹p 101, l 28›</span></span></span><span>
</span><span class="keyword1"><span class="command">lemmas</span></span><span> </span><span>quotient_addition</span><span> </span><span class="delimiter">=</span><span> </span><span>additive.factor_composition</span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹Equation 17 (2)›</span></span></span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹p 101, l 29›</span></span></span><span>
</span><span class="keyword1"><span class="command">theorem</span></span><span> </span><span>quotient_multiplication</span><span> </span><span class="delimiter">[</span><span>simp</span><span class="delimiter">]</span><span class="delimiter">:</span><span>
</span><span>  </span><span class="string"><span class="delete"><span class="delete">"⟦ a ∈ R; b ∈ R ⟧ ⟹ (a +| I) [⋅] (b +| I) = a ⋅ b +| I"</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>multiplicative.Class_commutes_with_composition</span><span> </span><span>additive.Class_is_Left_Coset</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>auto</span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹p 101, l 30›</span></span></span><span>
</span><span class="keyword1"><span class="command">lemmas</span></span><span> </span><span>quotient_zero</span><span> </span><span class="delimiter">=</span><span> </span><span>additive.factor_unit</span><span>
</span><span class="keyword1"><span class="command">lemmas</span></span><span> </span><span>quotient_negative</span><span> </span><span class="delimiter">=</span><span> </span><span>additive.factor_inverse</span><span>
</span><span>
</span><span class="keyword2"><span class="keyword">end</span></span><span> </span><span class="comment"><span class="delete"><span class="delete"><span class="delete"><span class="delete">(* quotient_ring *)</span></span></span></span></span><span>
</span><span>
</span><span>
</span><span class="keyword1"><span class="command">subsection</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹Homomorphisms of Rings.  Basic Theorems›</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹Def 2.3›</span></span></span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹p 106, ll 7--9›</span></span></span><span>
</span><span class="keyword1"><span class="command">locale</span></span><span> </span><span>ring_homomorphism</span><span> </span><span class="delimiter">=</span><span>
</span><span>  </span><span>map</span><span> </span><span>η</span><span> </span><span>R</span><span> </span><span>R'</span><span> </span><span class="delimiter">+</span><span> </span><span>source</span><span class="delimiter">:</span><span> </span><span>ring</span><span> </span><span>R</span><span> </span><span class="string"><span class="delete"><span class="delete">"(+)"</span></span></span><span> </span><span class="string"><span class="delete"><span class="delete">"(⋅)"</span></span></span><span> </span><span>𝟬</span><span> </span><span>𝟭</span><span> </span><span class="delimiter">+</span><span> </span><span>target</span><span class="delimiter">:</span><span> </span><span>ring</span><span> </span><span>R'</span><span> </span><span class="string"><span class="delete"><span class="delete">"(+')"</span></span></span><span> </span><span class="string"><span class="delete"><span class="delete">"(⋅')"</span></span></span><span> </span><span class="string"><span class="delete"><span class="delete">"𝟬'"</span></span></span><span> </span><span class="string"><span class="delete"><span class="delete">"𝟭'"</span></span></span><span> </span><span class="delimiter">+</span><span>
</span><span>  </span><span>additive</span><span class="delimiter">:</span><span> </span><span>group_homomorphism</span><span> </span><span>η</span><span> </span><span>R</span><span> </span><span class="string"><span class="delete"><span class="delete">"(+)"</span></span></span><span> </span><span>𝟬</span><span> </span><span>R'</span><span> </span><span class="string"><span class="delete"><span class="delete">"(+')"</span></span></span><span> </span><span class="string"><span class="delete"><span class="delete">"𝟬'"</span></span></span><span> </span><span class="delimiter">+</span><span>
</span><span>  </span><span>multiplicative</span><span class="delimiter">:</span><span> </span><span>monoid_homomorphism</span><span> </span><span>η</span><span> </span><span>R</span><span> </span><span class="string"><span class="delete"><span class="delete">"(⋅)"</span></span></span><span> </span><span>𝟭</span><span> </span><span>R'</span><span> </span><span class="string"><span class="delete"><span class="delete">"(⋅')"</span></span></span><span> </span><span class="string"><span class="delete"><span class="delete">"𝟭'"</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">for</span></span><span> </span><span>η</span><span>
</span><span>    </span><span class="keyword2"><span class="keyword">and</span></span><span> </span><span>R</span><span> </span><span class="keyword2"><span class="keyword">and</span></span><span> </span><span>addition</span><span> </span><span class="delimiter">(</span><span class="keyword2"><span class="keyword">infixl</span></span><span> </span><span class="string"><span class="delete"><span class="delete">"+"</span></span></span><span> </span><span>65</span><span class="delimiter">)</span><span> </span><span class="keyword2"><span class="keyword">and</span></span><span> </span><span>multiplication</span><span> </span><span class="delimiter">(</span><span class="keyword2"><span class="keyword">infixl</span></span><span> </span><span class="string"><span class="delete"><span class="delete">"⋅"</span></span></span><span> </span><span>70</span><span class="delimiter">)</span><span> </span><span class="keyword2"><span class="keyword">and</span></span><span> </span><span>zero</span><span> </span><span class="delimiter">(</span><span class="string"><span class="delete"><span class="delete">"𝟬"</span></span></span><span class="delimiter">)</span><span> </span><span class="keyword2"><span class="keyword">and</span></span><span> </span><span>unit</span><span> </span><span class="delimiter">(</span><span class="string"><span class="delete"><span class="delete">"𝟭"</span></span></span><span class="delimiter">)</span><span>
</span><span>    </span><span class="keyword2"><span class="keyword">and</span></span><span> </span><span>R'</span><span> </span><span class="keyword2"><span class="keyword">and</span></span><span> </span><span>addition'</span><span> </span><span class="delimiter">(</span><span class="keyword2"><span class="keyword">infixl</span></span><span> </span><span class="string"><span class="delete"><span class="delete">"+''"</span></span></span><span> </span><span>65</span><span class="delimiter">)</span><span> </span><span class="keyword2"><span class="keyword">and</span></span><span> </span><span>multiplication'</span><span> </span><span class="delimiter">(</span><span class="keyword2"><span class="keyword">infixl</span></span><span> </span><span class="string"><span class="delete"><span class="delete">"⋅''"</span></span></span><span> </span><span>70</span><span class="delimiter">)</span><span> </span><span class="keyword2"><span class="keyword">and</span></span><span> </span><span>zero'</span><span> </span><span class="delimiter">(</span><span class="string"><span class="delete"><span class="delete">"𝟬''"</span></span></span><span class="delimiter">)</span><span> </span><span class="keyword2"><span class="keyword">and</span></span><span> </span><span>unit'</span><span> </span><span class="delimiter">(</span><span class="string"><span class="delete"><span class="delete">"𝟭''"</span></span></span><span class="delimiter">)</span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹p 106, l 17›</span></span></span><span>
</span><span class="keyword1"><span class="command">locale</span></span><span> </span><span>ring_epimorphism</span><span> </span><span class="delimiter">=</span><span> </span><span>ring_homomorphism</span><span> </span><span class="delimiter">+</span><span> </span><span>surjective_map</span><span> </span><span>η</span><span> </span><span>R</span><span> </span><span>R'</span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹p 106, ll 14--18›</span></span></span><span>
</span><span class="keyword1"><span class="command">sublocale</span></span><span> </span><span>quotient_ring</span><span> </span><span class="delimiter">⊆</span><span> </span><span>natural</span><span class="delimiter">:</span><span> </span><span>ring_epimorphism</span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span>η</span><span> </span><span class="delimiter">=</span><span> </span><span>additive.Class</span><span> </span><span class="keyword2"><span class="keyword">and</span></span><span> </span><span>R'</span><span> </span><span class="delimiter">=</span><span> </span><span class="string"><span class="delete"><span class="delete">"R // I"</span></span></span><span> </span><span class="keyword2"><span class="keyword">and</span></span><span> </span><span>addition'</span><span> </span><span class="delimiter">=</span><span> </span><span class="string"><span class="delete"><span class="delete">"([+])"</span></span></span><span> </span><span class="keyword2"><span class="keyword">and</span></span><span> </span><span>multiplication'</span><span> </span><span class="delimiter">=</span><span>  </span><span class="string"><span class="delete"><span class="delete">"([⋅])"</span></span></span><span>
</span><span>    </span><span class="keyword2"><span class="keyword">and</span></span><span> </span><span>zero'</span><span> </span><span class="delimiter">=</span><span> </span><span class="string"><span class="delete"><span class="delete">"additive.Class 𝟬"</span></span></span><span> </span><span class="keyword2"><span class="keyword">and</span></span><span> </span><span>unit'</span><span> </span><span class="delimiter">=</span><span> </span><span class="string"><span class="delete"><span class="delete">"additive.Class 𝟭"</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">..</span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">context</span></span><span> </span><span>ring_homomorphism</span><span> </span><span class="keyword2"><span class="keyword">begin</span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹
  Jacobson reasons via @{term "a - b ∈ additive.Ker"} being a congruence; we prefer the direct proof,
  since it is very simple.
›</span></span></span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹p 106, ll 19--21›</span></span></span><span>
</span><span class="keyword1"><span class="command">sublocale</span></span><span> </span><span>kernel</span><span class="delimiter">:</span><span> </span><span>ideal</span><span> </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span>I</span><span> </span><span class="delimiter">=</span><span> </span><span>additive.Ker</span><span>
</span><span>  </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>unfold_locales</span><span> </span><span class="delimiter">(</span><span>auto</span><span> </span><span>simp</span><span class="delimiter">:</span><span> </span><span>additive.Ker_image</span><span> </span><span>multiplicative.commutes_with_composition</span><span class="delimiter">)</span><span>
</span><span>
</span><span class="keyword2"><span class="keyword">end</span></span><span> </span><span class="comment"><span class="delete"><span class="delete"><span class="delete"><span class="delete">(* ring_homomorphism *)</span></span></span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹p 106, l 22›</span></span></span><span>
</span><span class="keyword1"><span class="command">locale</span></span><span> </span><span>ring_monomorphism</span><span> </span><span class="delimiter">=</span><span> </span><span>ring_homomorphism</span><span> </span><span class="delimiter">+</span><span> </span><span>injective_map</span><span> </span><span>η</span><span> </span><span>R</span><span> </span><span>R'</span><span>
</span><span>
</span><span class="keyword1"><span class="command">context</span></span><span> </span><span>ring_homomorphism</span><span> </span><span class="keyword2"><span class="keyword">begin</span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹p 106, ll 21--23›</span></span></span><span>
</span><span class="keyword1"><span class="command">theorem</span></span><span> </span><span>ring_monomorphism_iff_kernel_unit</span><span class="delimiter">:</span><span>
</span><span>  </span><span class="string"><span class="delete"><span class="delete">"ring_monomorphism η R (+) (⋅) 𝟬 𝟭 R' (+') (⋅') 𝟬' 𝟭' ⟷ additive.Ker = {𝟬}"</span></span></span><span> </span><span class="delimiter">(</span><span class="keyword2"><span class="keyword">is</span></span><span> </span><span class="string"><span class="delete"><span class="delete">"?monom ⟷ ?ker"</span></span></span><span class="delimiter">)</span><span>
</span><span class="keyword1"><span class="command">proof</span></span><span>
</span><span>  </span><span class="keyword3"><span class="command">assume</span></span><span> </span><span class="var">?monom</span><span> </span><span class="keyword1"><span class="command">then</span></span><span> </span><span class="keyword1"><span class="command">interpret</span></span><span> </span><span>ring_monomorphism</span><span> </span><span class="keyword1"><span class="command">.</span></span><span> </span><span class="keyword3"><span class="command">show</span></span><span> </span><span class="var">?ker</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>simp</span><span> </span><span>add</span><span class="delimiter">:</span><span> </span><span>additive.injective_iff_kernel_unit</span><span> </span><span class="delimiter">[</span><span>symmetric</span><span class="delimiter">]</span><span class="delimiter">)</span><span>
</span><span class="keyword1"><span class="command">next</span></span><span>
</span><span>  </span><span class="keyword3"><span class="command">assume</span></span><span> </span><span class="var">?ker</span><span> </span><span class="keyword1"><span class="command">then</span></span><span> </span><span class="keyword3"><span class="command">show</span></span><span> </span><span class="var">?monom</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>unfold_locales</span><span> </span><span class="delimiter">(</span><span>simp</span><span> </span><span>add</span><span class="delimiter">:</span><span> </span><span>additive.injective_iff_kernel_unit</span><span class="delimiter">)</span><span>
</span><span class="keyword1"><span class="command">qed</span></span><span>
</span><span>  
</span><span class="keyword2"><span class="keyword">end</span></span><span> </span><span class="comment"><span class="delete"><span class="delete"><span class="delete"><span class="delete">(* ring_homomorphism *)</span></span></span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹p 106, ll 23--25›</span></span></span><span>
</span><span class="keyword1"><span class="command">sublocale</span></span><span> </span><span>ring_homomorphism</span><span> </span><span class="delimiter">⊆</span><span> </span><span>image</span><span class="delimiter">:</span><span> </span><span>subring</span><span> </span><span class="string"><span class="delete"><span class="delete">"η ` R"</span></span></span><span> </span><span>R'</span><span> </span><span class="string"><span class="delete"><span class="delete">"(+')"</span></span></span><span> </span><span class="string"><span class="delete"><span class="delete">"(⋅')"</span></span></span><span> </span><span class="string"><span class="delete"><span class="delete">"𝟬'"</span></span></span><span> </span><span class="string"><span class="delete"><span class="delete">"𝟭'"</span></span></span><span> </span><span class="keyword1"><span class="command">..</span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹p 106, ll 26--27›</span></span></span><span>
</span><span class="keyword1"><span class="command">locale</span></span><span> </span><span>ideal_in_kernel</span><span> </span><span class="delimiter">=</span><span>
</span><span>  </span><span>ring_homomorphism</span><span> </span><span class="delimiter">+</span><span> </span><span>contained</span><span class="delimiter">:</span><span> </span><span>ideal</span><span> </span><span>I</span><span> </span><span>R</span><span> </span><span class="string"><span class="delete"><span class="delete">"(+)"</span></span></span><span> </span><span class="string"><span class="delete"><span class="delete">"(⋅)"</span></span></span><span> </span><span>𝟬</span><span> </span><span>𝟭</span><span> </span><span class="keyword2"><span class="keyword">for</span></span><span> </span><span>I</span><span> </span><span class="delimiter">+</span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">assumes</span></span><span> </span><span>subset</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">"I ⊆ additive.Ker"</span></span></span><span>
</span><span class="keyword2"><span class="keyword">begin</span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹p 106, ll 26--27›</span></span></span><span>
</span><span class="keyword1"><span class="command">notation</span></span><span> </span><span>contained.additive.quotient_composition</span><span> </span><span class="delimiter">(</span><span class="keyword2"><span class="keyword">infixl</span></span><span> </span><span class="string"><span class="delete"><span class="delete">"[+]"</span></span></span><span> </span><span>65</span><span class="delimiter">)</span><span>
</span><span class="keyword1"><span class="command">notation</span></span><span> </span><span>contained.multiplicative.quotient_composition</span><span> </span><span class="delimiter">(</span><span class="keyword2"><span class="keyword">infixl</span></span><span> </span><span class="string"><span class="delete"><span class="delete">"[⋅]"</span></span></span><span> </span><span>70</span><span class="delimiter">)</span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹Provides @{text additive.induced}, which Jacobson calls $\bar{\eta}$.›</span></span></span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹p 106, l 30›</span></span></span><span>
</span><span class="keyword1"><span class="command">sublocale</span></span><span> </span><span>additive</span><span class="delimiter">:</span><span> </span><span>normal_subgroup_in_kernel</span><span> </span><span>η</span><span> </span><span>R</span><span> </span><span class="string"><span class="delete"><span class="delete">"(+)"</span></span></span><span> </span><span>𝟬</span><span> </span><span>R'</span><span> </span><span class="string"><span class="delete"><span class="delete">"(+')"</span></span></span><span> </span><span class="string"><span class="delete"><span class="delete">"𝟬'"</span></span></span><span> </span><span>I</span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">rewrites</span></span><span> </span><span class="string"><span class="delete"><span class="delete">"normal_subgroup.Congruence I R addition zero = contained.Ring_Congruence"</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>unfold_locales</span><span> </span><span class="delimiter">(</span><span>rule</span><span> </span><span>subset</span><span> </span><span>contained.additive_congruence</span><span class="delimiter">)</span><span class="delimiter">+</span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹Only the multiplicative part needs some work.›</span></span></span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹p 106, ll 27--30›</span></span></span><span>
</span><span class="keyword1"><span class="command">sublocale</span></span><span> </span><span>induced</span><span class="delimiter">:</span><span> </span><span>ring_homomorphism</span><span> </span><span>additive.induced</span><span> </span><span class="string"><span class="delete"><span class="delete">"R // I"</span></span></span><span> </span><span class="string"><span class="delete"><span class="delete">"([+])"</span></span></span><span> </span><span class="string"><span class="delete"><span class="delete">"([⋅])"</span></span></span><span> </span><span class="string"><span class="delete"><span class="delete">"contained.additive.Class 𝟬"</span></span></span><span> </span><span class="string"><span class="delete"><span class="delete">"contained.additive.Class 𝟭"</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>contained.multiplicative.Class_commutes_with_composition</span><span>
</span><span>  </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>unfold_locales</span><span>
</span><span>    </span><span class="delimiter">(</span><span>auto</span><span> </span><span>elim</span><span class="delimiter">!</span><span class="delimiter">:</span><span> </span><span>contained.additive.Left_CosetE</span><span> </span><span>simp</span><span class="delimiter">:</span><span> </span><span>contained.additive.Class_is_Left_Coset</span><span> </span><span>multiplicative.commutes_with_composition</span><span> </span><span>multiplicative.commutes_with_unit</span><span class="delimiter">)</span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹p 106, l 30; p 107, ll 1--3›</span></span></span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹
  @{term additive.induced} denotes Jacobson's $\bar{\eta}$.  We have the commutativity of the diagram, where
  @{term additive.induced} is unique: @{thm [display] additive.factorization} @{thm [display] additive.uniqueness}
›</span></span></span><span>
</span><span>
</span><span class="keyword2"><span class="keyword">end</span></span><span> </span><span class="comment"><span class="delete"><span class="delete"><span class="delete"><span class="delete">(* ideal_in_kernel *)</span></span></span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹Fundamental Theorem of Homomorphisms of Rings›</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹p 107, l 6›</span></span></span><span>
</span><span class="keyword1"><span class="command">locale</span></span><span> </span><span>ring_homomorphism_fundamental</span><span> </span><span class="delimiter">=</span><span> </span><span>ring_homomorphism</span><span> </span><span class="keyword2"><span class="keyword">begin</span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹p 107, l 6›</span></span></span><span>
</span><span class="keyword1"><span class="command">notation</span></span><span> </span><span>kernel.additive.quotient_composition</span><span> </span><span class="delimiter">(</span><span class="keyword2"><span class="keyword">infixl</span></span><span> </span><span class="string"><span class="delete"><span class="delete">"[+]"</span></span></span><span> </span><span>65</span><span class="delimiter">)</span><span>
</span><span class="keyword1"><span class="command">notation</span></span><span> </span><span>kernel.multiplicative.quotient_composition</span><span> </span><span class="delimiter">(</span><span class="keyword2"><span class="keyword">infixl</span></span><span> </span><span class="string"><span class="delete"><span class="delete">"[⋅]"</span></span></span><span> </span><span>70</span><span class="delimiter">)</span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹p 107, l 6›</span></span></span><span>
</span><span class="keyword1"><span class="command">sublocale</span></span><span> </span><span>ideal_in_kernel</span><span> </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span>I</span><span> </span><span class="delimiter">=</span><span> </span><span>additive.Ker</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>unfold_locales</span><span> </span><span>rule</span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹p 107, ll 8--9›</span></span></span><span>
</span><span class="keyword1"><span class="command">sublocale</span></span><span> </span><span>natural</span><span class="delimiter">:</span><span> </span><span>ring_epimorphism</span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span>η</span><span> </span><span class="delimiter">=</span><span> </span><span>kernel.additive.Class</span><span> </span><span class="keyword2"><span class="keyword">and</span></span><span> </span><span>R'</span><span> </span><span class="delimiter">=</span><span> </span><span class="string"><span class="delete"><span class="delete">"R // additive.Ker"</span></span></span><span>
</span><span>    </span><span class="keyword2"><span class="keyword">and</span></span><span> </span><span>addition'</span><span> </span><span class="delimiter">=</span><span> </span><span class="string"><span class="delete"><span class="delete">"kernel.additive.quotient_composition"</span></span></span><span>
</span><span>    </span><span class="keyword2"><span class="keyword">and</span></span><span> </span><span>multiplication'</span><span> </span><span class="delimiter">=</span><span> </span><span class="string"><span class="delete"><span class="delete">"kernel.multiplicative.quotient_composition"</span></span></span><span>
</span><span>    </span><span class="keyword2"><span class="keyword">and</span></span><span> </span><span>zero'</span><span> </span><span class="delimiter">=</span><span> </span><span class="string"><span class="delete"><span class="delete">"kernel.additive.Class 𝟬"</span></span></span><span> </span><span class="keyword2"><span class="keyword">and</span></span><span> </span><span>unit'</span><span> </span><span class="delimiter">=</span><span> </span><span class="string"><span class="delete"><span class="delete">"kernel.additive.Class 𝟭"</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">..</span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹p 107, l 9›</span></span></span><span>
</span><span class="keyword1"><span class="command">sublocale</span></span><span> </span><span>induced</span><span class="delimiter">:</span><span> </span><span>ring_monomorphism</span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span>η</span><span> </span><span class="delimiter">=</span><span> </span><span>additive.induced</span><span> </span><span class="keyword2"><span class="keyword">and</span></span><span> </span><span>R</span><span> </span><span class="delimiter">=</span><span> </span><span class="string"><span class="delete"><span class="delete">"R // additive.Ker"</span></span></span><span>
</span><span>    </span><span class="keyword2"><span class="keyword">and</span></span><span> </span><span>addition</span><span> </span><span class="delimiter">=</span><span> </span><span class="string"><span class="delete"><span class="delete">"kernel.additive.quotient_composition"</span></span></span><span>
</span><span>    </span><span class="keyword2"><span class="keyword">and</span></span><span> </span><span>multiplication</span><span> </span><span class="delimiter">=</span><span> </span><span class="string"><span class="delete"><span class="delete">"kernel.multiplicative.quotient_composition"</span></span></span><span>
</span><span>    </span><span class="keyword2"><span class="keyword">and</span></span><span> </span><span>zero</span><span> </span><span class="delimiter">=</span><span> </span><span class="string"><span class="delete"><span class="delete">"kernel.additive.Class 𝟬"</span></span></span><span> </span><span class="keyword2"><span class="keyword">and</span></span><span> </span><span>unit</span><span> </span><span class="delimiter">=</span><span> </span><span class="string"><span class="delete"><span class="delete">"kernel.additive.Class 𝟭"</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>unfold_locales</span><span> </span><span class="delimiter">(</span><span>simp</span><span> </span><span>add</span><span class="delimiter">:</span><span> </span><span>additive.induced_inj_on</span><span class="delimiter">)</span><span>
</span><span>
</span><span class="keyword2"><span class="keyword">end</span></span><span> </span><span class="comment"><span class="delete"><span class="delete"><span class="delete"><span class="delete">(* ring_homomorphism_fundamental *)</span></span></span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹p 107, l 11›</span></span></span><span>
</span><span class="keyword1"><span class="command">locale</span></span><span> </span><span>ring_isomorphism</span><span> </span><span class="delimiter">=</span><span> </span><span>ring_homomorphism</span><span> </span><span class="delimiter">+</span><span> </span><span>bijective_map</span><span> </span><span>η</span><span> </span><span>R</span><span> </span><span>R'</span><span> </span><span class="keyword2"><span class="keyword">begin</span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹p 107, l 11›</span></span></span><span>
</span><span class="keyword1"><span class="command">sublocale</span></span><span> </span><span>ring_monomorphism</span><span> </span><span class="keyword1"><span class="command">..</span></span><span>
</span><span class="keyword1"><span class="command">sublocale</span></span><span> </span><span>ring_epimorphism</span><span> </span><span class="keyword1"><span class="command">..</span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹p 107, l 11›</span></span></span><span>
</span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>inverse_ring_isomorphism</span><span class="delimiter">:</span><span>
</span><span>  </span><span class="string"><span class="delete"><span class="delete">"ring_isomorphism (restrict (inv_into R η) R') R' (+') (⋅') 𝟬' 𝟭' R (+) (⋅) 𝟬 𝟭"</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>additive.commutes_with_composition</span><span> </span><span class="delimiter">[</span><span>symmetric</span><span class="delimiter">]</span><span> </span><span>additive.commutes_with_unit</span><span>
</span><span>    </span><span>multiplicative.commutes_with_composition</span><span> </span><span class="delimiter">[</span><span>symmetric</span><span class="delimiter">]</span><span> </span><span>multiplicative.commutes_with_unit</span><span> </span><span>surjective</span><span>
</span><span>  </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>unfold_locales</span><span> </span><span>auto</span><span>
</span><span>
</span><span class="keyword2"><span class="keyword">end</span></span><span> </span><span class="comment"><span class="delete"><span class="delete"><span class="delete"><span class="delete">(* ring_isomorphsim *)</span></span></span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹p 107, l 11›</span></span></span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>isomorphic_as_rings</span><span> </span><span class="delimiter">(</span><span class="keyword2"><span class="keyword">infixl</span></span><span> </span><span class="string"><span class="delete"><span class="delete">"≅<span class="hidden">⇩</span><sub>R</sub>"</span></span></span><span> </span><span>50</span><span class="delimiter">)</span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">"ℛ ≅<span class="hidden">⇩</span><sub>R</sub> ℛ' ⟷ (let (R, addition, multiplication, zero, unit) = ℛ; (R', addition', multiplication', zero', unit') = ℛ' in
  (∃η. ring_isomorphism η R addition multiplication zero unit R' addition' multiplication' zero' unit'))"</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹p 107, l 11›</span></span></span><span>
</span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>isomorphic_as_rings_symmetric</span><span class="delimiter">:</span><span>
</span><span>  </span><span class="string"><span class="delete"><span class="delete">"(R, addition, multiplication, zero, unit) ≅<span class="hidden">⇩</span><sub>R</sub> (R', addition', multiplication', zero', unit') ⟹
   (R', addition', multiplication', zero', unit') ≅<span class="hidden">⇩</span><sub>R</sub> (R, addition, multiplication, zero, unit)"</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>simp</span><span> </span><span>add</span><span class="delimiter">:</span><span> </span><span>isomorphic_as_rings_def</span><span class="delimiter">)</span><span> </span><span class="delimiter">(</span><span>meson</span><span> </span><span>ring_isomorphism.inverse_ring_isomorphism</span><span class="delimiter">)</span><span>
</span><span>
</span><span class="keyword1"><span class="command">context</span></span><span> </span><span>ring_homomorphism</span><span> </span><span class="keyword2"><span class="keyword">begin</span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹Corollary›</span></span></span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">‹p 107, ll 11--12›</span></span></span><span>
</span><span class="keyword1"><span class="command">theorem</span></span><span> </span><span>image_is_isomorphic_to_quotient_ring</span><span class="delimiter">:</span><span>
</span><span>  </span><span class="string"><span class="delete"><span class="delete">"∃K add mult zero one. ideal K R (+) (⋅) 𝟬 𝟭 ∧ (η ` R, (+'), (⋅'), 𝟬', 𝟭') ≅<span class="hidden">⇩</span><sub>R</sub> (R // K, add, mult, zero, one)"</span></span></span><span>
</span><span class="keyword1"><span class="command">proof</span></span><span> </span><span>-</span><span>
</span><span>  </span><span class="keyword1"><span class="command">interpret</span></span><span> </span><span>image</span><span class="delimiter">:</span><span> </span><span>ring_homomorphism_fundamental</span><span> </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span>R'</span><span> </span><span class="delimiter">=</span><span> </span><span class="string"><span class="delete"><span class="delete">"η ` R"</span></span></span><span>
</span><span>    </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>unfold_locales</span><span> </span><span class="delimiter">(</span><span>auto</span><span> </span><span>simp</span><span class="delimiter">:</span><span> </span><span>target.additive.commutative</span><span> </span><span>additive.commutes_with_composition</span><span>
</span><span>      </span><span>multiplicative.commutes_with_composition</span><span> </span><span>target.distributive</span><span> </span><span>multiplicative.commutes_with_unit</span><span class="delimiter">)</span><span>
</span><span>  </span><span class="keyword1"><span class="command">have</span></span><span> </span><span class="string"><span class="delete"><span class="delete">"ring_isomorphism image.additive.induced (R // additive.Ker) ([+]) ([⋅]) (kernel.additive.Class 𝟬) (kernel.additive.Class 𝟭) (η ` R) (+') (⋅') 𝟬' 𝟭'"</span></span></span><span>
</span><span>    </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>unfold_locales</span><span> </span><span class="delimiter">(</span><span>simp</span><span> </span><span>add</span><span class="delimiter">:</span><span> </span><span>image.additive.induced_image</span><span> </span><span>bij_betw_def</span><span class="delimiter">)</span><span>
</span><span>  </span><span class="keyword1"><span class="command">then</span></span><span> </span><span class="keyword1"><span class="command">have</span></span><span> </span><span class="string"><span class="delete"><span class="delete">"(η ` R, (+'), (⋅'), 𝟬', 𝟭') ≅<span class="hidden">⇩</span><sub>R</sub> (R // additive.Ker, ([+]), ([⋅]), kernel.additive.Class 𝟬, kernel.additive.Class 𝟭)"</span></span></span><span>
</span><span>    </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>simp</span><span> </span><span>add</span><span class="delimiter">:</span><span> </span><span>isomorphic_as_rings_def</span><span class="delimiter">)</span><span> </span><span class="delimiter">(</span><span>meson</span><span> </span><span>ring_isomorphism.inverse_ring_isomorphism</span><span class="delimiter">)</span><span>
</span><span>  </span><span class="keyword1"><span class="command">moreover</span></span><span> </span><span class="keyword1"><span class="command">have</span></span><span> </span><span class="string"><span class="delete"><span class="delete">"ideal additive.Ker R (+) (⋅) 𝟬 𝟭"</span></span></span><span> </span><span class="keyword1"><span class="command">..</span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">ultimately</span></span><span> </span><span class="keyword3"><span class="command">show</span></span><span> </span><span class="var">?thesis</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>blast</span><span>
</span><span class="keyword1"><span class="command">qed</span></span><span>
</span><span>
</span><span class="keyword2"><span class="keyword">end</span></span><span> </span><span class="comment"><span class="delete"><span class="delete"><span class="delete"><span class="delete">(* ring_homomorphism *)</span></span></span></span></span><span>
</span><span>
</span><span class="keyword2"><span class="keyword">end</span></span><span>
</span></pre>
</div>
</div>
<div id="NonInterferenceIntra">
<div class="head">
<h1>Theory NonInterferenceIntra</h1>
</div>
<pre class="source"><span class="keyword1"><span class="command">section</span></span> <span class="quoted"><span class="plain_text">‹Slicing guarantees IFC Noninterference›</span></span>

<span class="keyword1"><span class="command">theory</span></span> NonInterferenceIntra <span class="keyword2"><span class="keyword">imports</span></span> 
  <a href="../Slicing/Slice.html">Slicing.Slice</a> 
  <a href="../Slicing/CFGExit_wf.html">Slicing.CFGExit_wf</a>
<span class="keyword2"><span class="keyword">begin</span></span>

<span class="keyword1"><span class="command">subsection</span></span> <span class="quoted"><span class="plain_text">‹Assumptions of this Approach›</span></span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹
Classical IFC noninterference, a special case of a noninterference
definition using partial equivalence relations (per)
\cite{SabelfeldS:01}, partitions the variables (i.e.\ locations) into
security levels. Usually, only levels for secret or high, written
<span class="antiquoted"><span class="raw_text"><span class="antiquoted"><span class="raw_text"><span class="operator"><span class="operator">‹</span></span>H›</span></span></span></span>, and public or low, written <span class="antiquoted"><span class="raw_text"><span class="antiquoted"><span class="raw_text"><span class="operator"><span class="operator">‹</span></span>L›</span></span></span></span>, variables are
used. Basically, a program that is noninterferent has to fulfil one
basic property: executing the program in two different initial states
that may differ in the values of their <span class="antiquoted"><span class="raw_text"><span class="antiquoted"><span class="raw_text"><span class="operator"><span class="operator">‹</span></span>H›</span></span></span></span>-variables yields two
final states that again only differ in the values of their 
<span class="antiquoted"><span class="raw_text"><span class="antiquoted"><span class="raw_text"><span class="operator"><span class="operator">‹</span></span>H›</span></span></span></span>-variables; thus the values of the <span class="antiquoted"><span class="raw_text"><span class="antiquoted"><span class="raw_text"><span class="operator"><span class="operator">‹</span></span>H›</span></span></span></span>-variables did not
influence those of the <span class="antiquoted"><span class="raw_text"><span class="antiquoted"><span class="raw_text"><span class="operator"><span class="operator">‹</span></span>L›</span></span></span></span>-variables.

Every per-based approach makes certain
assumptions: (i) all \mbox{<span class="antiquoted"><span class="raw_text"><span class="antiquoted"><span class="raw_text"><span class="operator"><span class="operator">‹</span></span>H›</span></span></span></span>-variables} are defined at the
beginning of the program, (ii) all <span class="antiquoted"><span class="raw_text"><span class="antiquoted"><span class="raw_text"><span class="operator"><span class="operator">‹</span></span>L›</span></span></span></span>-variables are observed (or
used in our terms) at the end and (iii) every variable is either
<span class="antiquoted"><span class="raw_text"><span class="antiquoted"><span class="raw_text"><span class="operator"><span class="operator">‹</span></span>H›</span></span></span></span> or <span class="antiquoted"><span class="raw_text"><span class="antiquoted"><span class="raw_text"><span class="operator"><span class="operator">‹</span></span>L›</span></span></span></span>. This security label is fixed for a variable
and can not be altered during a program run. Thus, we have to extend 
the prerequisites of the slicing framework in \cite{Wasserrab:08} accordingly
in a new locale:

›</span></span>

<span class="keyword1"><span class="command">locale</span></span> NonInterferenceIntraGraph <span class="main">=</span> 
  BackwardSlice <span class="quoted"><span class="free">sourcenode</span></span> <span class="quoted"><span class="free">targetnode</span></span> <span class="quoted"><span class="free">kind</span></span> <span class="quoted"><span class="free">valid_edge</span></span> <span class="quoted"><span class="free">Entry</span></span> <span class="quoted"><span class="free">Def</span></span> <span class="quoted"><span class="free">Use</span></span> <span class="quoted"><span class="free">state_val</span></span> 
  <span class="quoted"><span class="free">backward_slice</span></span> <span class="main">+</span>
  CFGExit_wf <span class="quoted"><span class="free">sourcenode</span></span> <span class="quoted"><span class="free">targetnode</span></span> <span class="quoted"><span class="free">kind</span></span> <span class="quoted"><span class="free">valid_edge</span></span> <span class="quoted"><span class="free">Entry</span></span> <span class="quoted"><span class="free">Def</span></span> <span class="quoted"><span class="free">Use</span></span> <span class="quoted"><span class="free">state_val</span></span> <span class="quoted"><span class="free">Exit</span></span>
  <span class="keyword2"><span class="keyword">for</span></span> <span class="free">sourcenode</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'edge</span> <span class="main">⇒</span> <span class="tfree">'node</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="free">targetnode</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'edge</span> <span class="main">⇒</span> <span class="tfree">'node</span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> <span class="free">kind</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'edge</span> <span class="main">⇒</span> <span class="tfree">'state</span> edge_kind"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="free">valid_edge</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'edge</span> <span class="main">⇒</span> bool"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> <span class="free">Entry</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'node</span>"</span></span> <span class="main">(</span><span class="quoted">"<span class="keyword1">'('_Entry'_')</span>"</span><span class="main">)</span> <span class="keyword2"><span class="keyword">and</span></span> <span class="free">Def</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'node</span> <span class="main">⇒</span> <span class="tfree">'var</span> set"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> <span class="free">Use</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'node</span> <span class="main">⇒</span> <span class="tfree">'var</span> set"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="free">state_val</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'state</span> <span class="main">⇒</span> <span class="tfree">'var</span> <span class="main">⇒</span> <span class="tfree">'val</span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> <span class="free">backward_slice</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'node</span> set <span class="main">⇒</span> <span class="tfree">'node</span> set"</span></span> 
  <span class="keyword2"><span class="keyword">and</span></span> <span class="free">Exit</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'node</span>"</span></span> <span class="main">(</span><span class="quoted">"<span class="keyword1">'('_Exit'_')</span>"</span><span class="main">)</span> <span class="main">+</span>
  <span class="keyword2"><span class="keyword">fixes</span></span> <span class="free">H</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'var</span> set"</span></span>
  <span class="keyword2"><span class="keyword">fixes</span></span> <span class="free">L</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'var</span> set"</span></span>
  <span class="keyword2"><span class="keyword">fixes</span></span> <span class="free">High</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'node</span>"</span></span>  <span class="main">(</span><span class="quoted">"<span class="keyword1">'('_High'_')</span>"</span><span class="main">)</span>
  <span class="keyword2"><span class="keyword">fixes</span></span> <span class="free">Low</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'node</span>"</span></span>   <span class="main">(</span><span class="quoted">"<span class="keyword1">'('_Low'_')</span>"</span><span class="main">)</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> Entry_edge_Exit_or_High<span class="main">:</span>
  <span class="quoted"><span class="quoted">"<span class="main">⟦</span><span class="free">valid_edge</span> <span class="free">a</span><span class="main">;</span> <span class="free">sourcenode</span> <span class="free">a</span> <span class="main">=</span> <span class="keyword1"><span class="free">(_Entry_)</span></span><span class="main">⟧</span> 
    <span class="main">⟹</span> <span class="free">targetnode</span> <span class="free">a</span> <span class="main">=</span> <span class="keyword1"><span class="free">(_Exit_)</span></span> <span class="main">∨</span> <span class="free">targetnode</span> <span class="free">a</span> <span class="main">=</span> <span class="keyword1"><span class="free">(_High_)</span></span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> High_target_Entry_edge<span class="main">:</span>
  <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound">a</span><span class="main">.</span> <span class="free">valid_edge</span> <span class="bound">a</span> <span class="main">∧</span> <span class="free">sourcenode</span> <span class="bound">a</span> <span class="main">=</span> <span class="keyword1"><span class="free">(_Entry_)</span></span> <span class="main">∧</span> <span class="free">targetnode</span> <span class="bound">a</span> <span class="main">=</span> <span class="keyword1"><span class="free">(_High_)</span></span> <span class="main">∧</span>
       <span class="free">kind</span> <span class="bound">a</span> <span class="main">=</span> <span class="main">(</span><span class="main">λ</span><span class="bound">s</span><span class="main">.</span> True<span class="main">)<span class="hidden">⇩</span><sub>√</sub></span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> Entry_predecessor_of_High<span class="main">:</span>
  <span class="quoted"><span class="quoted">"<span class="main">⟦</span><span class="free">valid_edge</span> <span class="free">a</span><span class="main">;</span> <span class="free">targetnode</span> <span class="free">a</span> <span class="main">=</span> <span class="keyword1"><span class="free">(_High_)</span></span><span class="main">⟧</span> <span class="main">⟹</span> <span class="free">sourcenode</span> <span class="free">a</span> <span class="main">=</span> <span class="keyword1"><span class="free">(_Entry_)</span></span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> Exit_edge_Entry_or_Low<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">⟦</span><span class="free">valid_edge</span> <span class="free">a</span><span class="main">;</span> <span class="free">targetnode</span> <span class="free">a</span> <span class="main">=</span> <span class="keyword1"><span class="free">(_Exit_)</span></span><span class="main">⟧</span> 
    <span class="main">⟹</span> <span class="free">sourcenode</span> <span class="free">a</span> <span class="main">=</span> <span class="keyword1"><span class="free">(_Entry_)</span></span> <span class="main">∨</span> <span class="free">sourcenode</span> <span class="free">a</span> <span class="main">=</span> <span class="keyword1"><span class="free">(_Low_)</span></span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> Low_source_Exit_edge<span class="main">:</span>
  <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound">a</span><span class="main">.</span> <span class="free">valid_edge</span> <span class="bound">a</span> <span class="main">∧</span> <span class="free">sourcenode</span> <span class="bound">a</span> <span class="main">=</span> <span class="keyword1"><span class="free">(_Low_)</span></span> <span class="main">∧</span> <span class="free">targetnode</span> <span class="bound">a</span> <span class="main">=</span> <span class="keyword1"><span class="free">(_Exit_)</span></span> <span class="main">∧</span> 
       <span class="free">kind</span> <span class="bound">a</span> <span class="main">=</span> <span class="main">(</span><span class="main">λ</span><span class="bound">s</span><span class="main">.</span> True<span class="main">)<span class="hidden">⇩</span><sub>√</sub></span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> Exit_successor_of_Low<span class="main">:</span>
  <span class="quoted"><span class="quoted">"<span class="main">⟦</span><span class="free">valid_edge</span> <span class="free">a</span><span class="main">;</span> <span class="free">sourcenode</span> <span class="free">a</span> <span class="main">=</span> <span class="keyword1"><span class="free">(_Low_)</span></span><span class="main">⟧</span> <span class="main">⟹</span> <span class="free">targetnode</span> <span class="free">a</span> <span class="main">=</span> <span class="keyword1"><span class="free">(_Exit_)</span></span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> DefHigh<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">Def</span> <span class="keyword1"><span class="free">(_High_)</span></span> <span class="main">=</span> <span class="free">H</span>"</span></span> 
  <span class="keyword2"><span class="keyword">and</span></span> UseHigh<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">Use</span> <span class="keyword1"><span class="free">(_High_)</span></span> <span class="main">=</span> <span class="free">H</span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> UseLow<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">Use</span> <span class="keyword1"><span class="free">(_Low_)</span></span> <span class="main">=</span> <span class="free">L</span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> HighLowDistinct<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">H</span> <span class="main">∩</span> <span class="free">L</span> <span class="main">=</span> <span class="main">{}</span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> HighLowUNIV<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">H</span> <span class="main">∪</span> <span class="free">L</span> <span class="main">=</span> UNIV"</span></span>

<span class="keyword2"><span class="keyword">begin</span></span>

<span class="keyword1"><span class="command">lemma</span></span> Low_neq_Exit<span class="main">:</span> <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">L</span> <span class="main">≠</span> <span class="main">{}</span>"</span></span> <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1"><span class="free">(_Low_)</span></span> <span class="main">≠</span> <span class="keyword1"><span class="free">(_Exit_)</span></span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span>
  <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1"><span class="free">(_Low_)</span></span> <span class="main">=</span> <span class="keyword1"><span class="free">(_Exit_)</span></span>"</span></span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">Use</span> <span class="keyword1"><span class="free">(_Exit_)</span></span> <span class="main">=</span> <span class="main">{}</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">fastforce</span>
  <span class="keyword1"><span class="command">with</span></span> UseLow <span class="quoted"><span class="quoted">‹<span class="free">L</span> <span class="main">≠</span> <span class="main">{}</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="keyword1"><span class="free">(_Low_)</span></span> <span class="main">=</span> <span class="keyword1"><span class="free">(_Exit_)</span></span>›</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted">False</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">lemma</span></span> Entry_path_High_path<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1"><span class="free">(_Entry_)</span></span> <span class="main">-</span><span class="free">as</span><span class="main">→*</span> <span class="free">n</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"inner_node <span class="free">n</span>"</span></span>
  <span class="keyword2"><span class="keyword">obtains</span></span> <span class="free">a'</span> <span class="free">as'</span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="free">as</span> <span class="main">=</span> <span class="free">a'</span><span class="main">#</span><span class="free">as'</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1"><span class="free">(_High_)</span></span> <span class="main">-</span><span class="free">as'</span><span class="main">→*</span> <span class="free">n</span>"</span></span> 
  <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">kind</span> <span class="free">a'</span> <span class="main">=</span> <span class="main">(</span><span class="main">λ</span><span class="bound">s</span><span class="main">.</span> True<span class="main">)<span class="hidden">⇩</span><sub>√</sub></span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span><span class="main">(</span><span class="operator">atomize_elim</span><span class="main">)</span>
  <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="keyword1"><span class="free">(_Entry_)</span></span> <span class="main">-</span><span class="free">as</span><span class="main">→*</span> <span class="free">n</span>›</span></span> <span class="quoted"><span class="quoted">‹inner_node <span class="free">n</span>›</span></span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound">a'</span> <span class="bound">as'</span><span class="main">.</span> <span class="free">as</span> <span class="main">=</span> <span class="bound">a'</span><span class="main">#</span><span class="bound">as'</span> <span class="main">∧</span> <span class="keyword1"><span class="free">(_High_)</span></span> <span class="main">-</span><span class="bound">as'</span><span class="main">→*</span> <span class="free">n</span> <span class="main">∧</span> <span class="free">kind</span> <span class="bound">a'</span> <span class="main">=</span> <span class="main">(</span><span class="main">λ</span><span class="bound">s</span><span class="main">.</span> True<span class="main">)<span class="hidden">⇩</span><sub>√</sub></span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span><span class="main">(</span><span class="operator">induct</span> <span class="skolem">n'</span><span class="main"><span class="main">≡</span></span><span class="quoted"><span class="quoted">"<span class="keyword1"><span class="free">(_Entry_)</span></span>"</span></span> <span class="quoted"><span class="free">as</span></span> <span class="quoted"><span class="free">n</span></span> <span class="quasi_keyword">rule</span><span class="main"><span class="main">:</span></span>path.induct<span class="main">)</span>
    <span class="keyword3"><span class="command">case</span></span> <span class="main">(</span>Cons_path <span class="skolem">n''</span> <span class="skolem">as</span> <span class="skolem">n'</span> <span class="skolem">a</span><span class="main">)</span>
    <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">n''</span> <span class="main">-</span><span class="skolem">as</span><span class="main">→*</span> <span class="skolem">n'</span>›</span></span> <span class="quoted"><span class="quoted">‹inner_node <span class="skolem">n'</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">n''</span> <span class="main">≠</span> <span class="keyword1"><span class="free">(_Exit_)</span></span>"</span></span> 
      <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">fastforce</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span>inner_node_def<span class="main">)</span>
    <span class="keyword1"><span class="command">with</span></span> <span class="quoted"><span class="quoted">‹<span class="free">valid_edge</span> <span class="skolem">a</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="free">targetnode</span> <span class="skolem">a</span> <span class="main">=</span> <span class="skolem">n''</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="free">sourcenode</span> <span class="skolem">a</span> <span class="main">=</span> <span class="keyword1"><span class="free">(_Entry_)</span></span>›</span></span>
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">n''</span> <span class="main">=</span> <span class="keyword1"><span class="free">(_High_)</span></span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">-</span><span class="main">(</span><span class="operator">drule</span> Entry_edge_Exit_or_High<span class="main"><span class="keyword3">,</span></span><span class="operator">auto</span><span class="main">)</span>
    <span class="keyword1"><span class="command">from</span></span> High_target_Entry_edge
    <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">a'</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="free">valid_edge</span> <span class="skolem">a'</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">sourcenode</span> <span class="skolem">a'</span> <span class="main">=</span> <span class="keyword1"><span class="free">(_Entry_)</span></span>"</span></span>
      <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">targetnode</span> <span class="skolem">a'</span> <span class="main">=</span> <span class="keyword1"><span class="free">(_High_)</span></span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">kind</span> <span class="skolem">a'</span> <span class="main">=</span> <span class="main">(</span><span class="main">λ</span><span class="bound">s</span><span class="main">.</span> True<span class="main">)<span class="hidden">⇩</span><sub>√</sub></span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
    <span class="keyword1"><span class="command">with</span></span> <span class="quoted"><span class="quoted">‹<span class="free">valid_edge</span> <span class="skolem">a</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="free">sourcenode</span> <span class="skolem">a</span> <span class="main">=</span> <span class="keyword1"><span class="free">(_Entry_)</span></span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="free">targetnode</span> <span class="skolem">a</span> <span class="main">=</span> <span class="skolem">n''</span>›</span></span>
      <span class="quoted"><span class="quoted">‹<span class="skolem">n''</span> <span class="main">=</span> <span class="keyword1"><span class="free">(_High_)</span></span>›</span></span>
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">a</span> <span class="main">=</span> <span class="skolem">a'</span>"</span></span> <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">dest</span><span class="main"><span class="main">:</span></span>edge_det<span class="main">)</span>
    <span class="keyword1"><span class="command">with</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">n''</span> <span class="main">-</span><span class="skolem">as</span><span class="main">→*</span> <span class="skolem">n'</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">n''</span> <span class="main">=</span> <span class="keyword1"><span class="free">(_High_)</span></span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="free">kind</span> <span class="skolem">a'</span> <span class="main">=</span> <span class="main">(</span><span class="main">λ</span><span class="bound">s</span><span class="main">.</span> True<span class="main">)<span class="hidden">⇩</span><sub>√</sub></span>›</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?case</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">qed</span></span> <span class="operator">fastforce</span>
<span class="keyword1"><span class="command">qed</span></span>



<span class="keyword1"><span class="command">lemma</span></span> Exit_path_Low_path<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">n</span> <span class="main">-</span><span class="free">as</span><span class="main">→*</span> <span class="keyword1"><span class="free">(_Exit_)</span></span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"inner_node <span class="free">n</span>"</span></span>
  <span class="keyword2"><span class="keyword">obtains</span></span> <span class="free">a'</span> <span class="free">as'</span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="free">as</span> <span class="main">=</span> <span class="free">as'</span><span class="main">@</span><span class="main">[</span><span class="free">a'</span><span class="main">]</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">n</span> <span class="main">-</span><span class="free">as'</span><span class="main">→*</span> <span class="keyword1"><span class="free">(_Low_)</span></span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">kind</span> <span class="free">a'</span> <span class="main">=</span> <span class="main">(</span><span class="main">λ</span><span class="bound">s</span><span class="main">.</span> True<span class="main">)<span class="hidden">⇩</span><sub>√</sub></span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span><span class="main">(</span><span class="operator">atomize_elim</span><span class="main">)</span>
  <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="free">n</span> <span class="main">-</span><span class="free">as</span><span class="main">→*</span> <span class="keyword1"><span class="free">(_Exit_)</span></span>›</span></span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound">as'</span> <span class="bound">a'</span><span class="main">.</span> <span class="free">as</span> <span class="main">=</span> <span class="bound">as'</span><span class="main">@</span><span class="main">[</span><span class="bound">a'</span><span class="main">]</span> <span class="main">∧</span> <span class="free">n</span> <span class="main">-</span><span class="bound">as'</span><span class="main">→*</span> <span class="keyword1"><span class="free">(_Low_)</span></span> <span class="main">∧</span> <span class="free">kind</span> <span class="bound">a'</span> <span class="main">=</span> <span class="main">(</span><span class="main">λ</span><span class="bound">s</span><span class="main">.</span> True<span class="main">)<span class="hidden">⇩</span><sub>√</sub></span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span><span class="main">(</span><span class="operator">induct</span> <span class="quoted"><span class="free">as</span></span> <span class="quasi_keyword">rule</span><span class="main"><span class="main">:</span></span>rev_induct<span class="main">)</span>
    <span class="keyword3"><span class="command">case</span></span> Nil
    <span class="keyword1"><span class="command">with</span></span> <span class="quoted"><span class="quoted">‹inner_node <span class="free">n</span>›</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?case</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">fastforce</span>
  <span class="keyword1"><span class="command">next</span></span>
    <span class="keyword3"><span class="command">case</span></span> <span class="main">(</span>snoc <span class="skolem">a'</span> <span class="skolem">as'</span><span class="main">)</span>
    <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="free">n</span> <span class="main">-</span><span class="skolem">as'</span><span class="main">@</span><span class="main">[</span><span class="skolem">a'</span><span class="main">]</span><span class="main">→*</span> <span class="keyword1"><span class="free">(_Exit_)</span></span>›</span></span>
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">n</span> <span class="main">-</span><span class="skolem">as'</span><span class="main">→*</span> <span class="free">sourcenode</span> <span class="skolem">a'</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">valid_edge</span> <span class="skolem">a'</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">targetnode</span> <span class="skolem">a'</span> <span class="main">=</span> <span class="keyword1"><span class="free">(_Exit_)</span></span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">elim</span><span class="main"><span class="main">:</span></span>path_split_snoc<span class="main">)</span>
    <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="free">sourcenode</span> <span class="skolem">a'</span> <span class="main">=</span> <span class="keyword1"><span class="free">(_Entry_)</span></span>"</span></span>
      <span class="keyword1"><span class="command">with</span></span> <span class="quoted"><span class="quoted">‹<span class="free">n</span> <span class="main">-</span><span class="skolem">as'</span><span class="main">→*</span> <span class="free">sourcenode</span> <span class="skolem">a'</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">n</span> <span class="main">=</span> <span class="keyword1"><span class="free">(_Entry_)</span></span>"</span></span>
        <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">blast</span> <span class="quasi_keyword">intro</span><span class="main"><span class="main">!</span></span><span class="main"><span class="main">:</span></span>path_Entry_target<span class="main">)</span>
      <span class="keyword1"><span class="command">with</span></span> <span class="quoted"><span class="quoted">‹inner_node <span class="free">n</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted">False</span> <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span>inner_node_def<span class="main">)</span> <span class="keyword1"><span class="command">}</span></span>
    <span class="keyword1"><span class="command">with</span></span> <span class="quoted"><span class="quoted">‹<span class="free">valid_edge</span> <span class="skolem">a'</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="free">targetnode</span> <span class="skolem">a'</span> <span class="main">=</span> <span class="keyword1"><span class="free">(_Exit_)</span></span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">sourcenode</span> <span class="skolem">a'</span> <span class="main">=</span> <span class="keyword1"><span class="free">(_Low_)</span></span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">blast</span> <span class="quasi_keyword">dest</span><span class="main"><span class="main">!</span></span><span class="main"><span class="main">:</span></span>Exit_edge_Entry_or_Low<span class="main">)</span>
    <span class="keyword1"><span class="command">from</span></span> Low_source_Exit_edge
    <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">ax</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="free">valid_edge</span> <span class="skolem">ax</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">sourcenode</span> <span class="skolem">ax</span> <span class="main">=</span> <span class="keyword1"><span class="free">(_Low_)</span></span>"</span></span>
      <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">targetnode</span> <span class="skolem">ax</span> <span class="main">=</span> <span class="keyword1"><span class="free">(_Exit_)</span></span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">kind</span> <span class="skolem">ax</span> <span class="main">=</span> <span class="main">(</span><span class="main">λ</span><span class="bound">s</span><span class="main">.</span> True<span class="main">)<span class="hidden">⇩</span><sub>√</sub></span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
    <span class="keyword1"><span class="command">with</span></span> <span class="quoted"><span class="quoted">‹<span class="free">valid_edge</span> <span class="skolem">a'</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="free">targetnode</span> <span class="skolem">a'</span> <span class="main">=</span> <span class="keyword1"><span class="free">(_Exit_)</span></span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="free">sourcenode</span> <span class="skolem">a'</span> <span class="main">=</span> <span class="keyword1"><span class="free">(_Low_)</span></span>›</span></span>
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">a'</span> <span class="main">=</span> <span class="skolem">ax</span>"</span></span> <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">fastforce</span> <span class="quasi_keyword">intro</span><span class="main"><span class="main">:</span></span>edge_det<span class="main">)</span>
    <span class="keyword1"><span class="command">with</span></span> <span class="quoted"><span class="quoted">‹<span class="free">n</span> <span class="main">-</span><span class="skolem">as'</span><span class="main">→*</span> <span class="free">sourcenode</span> <span class="skolem">a'</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="free">sourcenode</span> <span class="skolem">a'</span> <span class="main">=</span> <span class="keyword1"><span class="free">(_Low_)</span></span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="free">kind</span> <span class="skolem">ax</span> <span class="main">=</span> <span class="main">(</span><span class="main">λ</span><span class="bound">s</span><span class="main">.</span> True<span class="main">)<span class="hidden">⇩</span><sub>√</sub></span>›</span></span>
    <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?case</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">qed</span></span>
<span class="keyword1"><span class="command">qed</span></span>


<span class="keyword1"><span class="command">lemma</span></span> not_Low_High<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">V</span> <span class="main">∉</span> <span class="free">L</span> <span class="main">⟹</span> <span class="free">V</span> <span class="main">∈</span> <span class="free">H</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> HighLowUNIV
  <span class="keyword1"><span class="command">by</span></span> <span class="operator">fastforce</span>

<span class="keyword1"><span class="command">lemma</span></span> not_High_Low<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">V</span> <span class="main">∉</span> <span class="free">H</span> <span class="main">⟹</span> <span class="free">V</span> <span class="main">∈</span> <span class="free">L</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> HighLowUNIV
  <span class="keyword1"><span class="command">by</span></span> <span class="operator">fastforce</span>


<span class="keyword1"><span class="command">subsection</span></span> <span class="quoted"><span class="plain_text">‹Low Equivalence›</span></span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹
In classical noninterference, an external observer can only see public values,
in our case the <span class="antiquoted"><span class="raw_text"><span class="antiquoted"><span class="raw_text"><span class="operator"><span class="operator">‹</span></span>L›</span></span></span></span>-variables. If two states agree in the values of all 
<span class="antiquoted"><span class="raw_text"><span class="antiquoted"><span class="raw_text"><span class="operator"><span class="operator">‹</span></span>L›</span></span></span></span>-variables, these states are indistinguishable for him. 
\emph{Low equivalence} groups those states in an equivalence class using 
the relation <span class="antiquoted"><span class="raw_text"><span class="antiquoted"><span class="raw_text"><span class="operator"><span class="operator">‹</span></span>≈<span class="hidden">⇩</span><sub>L</sub>›</span></span></span></span>:
›</span></span>

<span class="keyword1"><span class="command">definition</span></span> <span class="entity">lowEquivalence</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'state</span> <span class="main">⇒</span> <span class="tfree">'state</span> <span class="main">⇒</span> bool"</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">infixl</span></span> <span class="quoted">"<span class="keyword1">≈<span class="hidden">⇩</span><sub>L</sub></span>"</span> 50<span class="main">)</span>
  <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="free"><span class="bound"><span class="entity">s</span></span></span> <span class="keyword1"><span class="free">≈<span class="hidden">⇩</span><sub>L</sub></span></span> <span class="free"><span class="bound"><span class="entity">s'</span></span></span> <span class="main">≡</span> <span class="main">∀</span><span class="bound">V</span> <span class="main">∈</span> <span class="free">L</span><span class="main">.</span> <span class="free">state_val</span> <span class="free"><span class="bound"><span class="entity">s</span></span></span> <span class="bound">V</span> <span class="main">=</span> <span class="free">state_val</span> <span class="free"><span class="bound"><span class="entity">s'</span></span></span> <span class="bound">V</span>"</span></span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹The following lemmas connect low equivalent states with
relevant variables as necessary in the correctness proof for slicing.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> relevant_vars_Entry<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">V</span> <span class="main">∈</span> <span class="keyword1">rv</span> <span class="free">S</span> <span class="keyword1"><span class="free">(_Entry_)</span></span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1"><span class="free">(_High_)</span></span> <span class="main">∉</span> <span class="free">backward_slice</span> <span class="free">S</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">V</span> <span class="main">∈</span> <span class="free">L</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="free">V</span> <span class="main">∈</span> <span class="keyword1">rv</span> <span class="free">S</span> <span class="keyword1"><span class="free">(_Entry_)</span></span>›</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">as</span></span> <span class="skolem"><span class="skolem">n'</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1"><span class="free">(_Entry_)</span></span> <span class="main">-</span><span class="skolem">as</span><span class="main">→*</span> <span class="skolem">n'</span>"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">n'</span> <span class="main">∈</span> <span class="free">backward_slice</span> <span class="free">S</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">V</span> <span class="main">∈</span> <span class="free">Use</span> <span class="skolem">n'</span>"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">nx</span> <span class="main">∈</span> set<span class="main">(</span>sourcenodes <span class="skolem">as</span><span class="main">)</span><span class="main">.</span> <span class="free">V</span> <span class="main">∉</span> <span class="free">Def</span> <span class="bound">nx</span>"</span></span> <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">erule</span> rvE<span class="main">)</span>
  <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="keyword1"><span class="free">(_Entry_)</span></span> <span class="main">-</span><span class="skolem">as</span><span class="main">→*</span> <span class="skolem">n'</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"valid_node <span class="skolem">n'</span>"</span></span> <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">rule</span> path_valid_node<span class="main">)</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
  <span class="keyword1"><span class="command">proof</span></span><span class="main">(</span><span class="operator">cases</span> <span class="quoted"><span class="skolem">n'</span></span> <span class="quasi_keyword">rule</span><span class="main"><span class="main">:</span></span>valid_node_cases<span class="main">)</span>
    <span class="keyword3"><span class="command">case</span></span> Entry
    <span class="keyword1"><span class="command">with</span></span> <span class="quoted"><span class="quoted">‹<span class="free">V</span> <span class="main">∈</span> <span class="free">Use</span> <span class="skolem">n'</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted">False</span> <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span>Entry_empty<span class="main">)</span>
    <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">next</span></span>
    <span class="keyword3"><span class="command">case</span></span> Exit
    <span class="keyword1"><span class="command">with</span></span> <span class="quoted"><span class="quoted">‹<span class="free">V</span> <span class="main">∈</span> <span class="free">Use</span> <span class="skolem">n'</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted">False</span> <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span>Exit_empty<span class="main">)</span>
    <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">next</span></span>
    <span class="keyword3"><span class="command">case</span></span> inner
    <span class="keyword1"><span class="command">with</span></span> <span class="quoted"><span class="quoted">‹<span class="keyword1"><span class="free">(_Entry_)</span></span> <span class="main">-</span><span class="skolem">as</span><span class="main">→*</span> <span class="skolem">n'</span>›</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">a'</span></span> <span class="skolem"><span class="skolem">as'</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">as</span> <span class="main">=</span> <span class="skolem">a'</span><span class="main">#</span><span class="skolem">as'</span>"</span></span>
      <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1"><span class="free">(_High_)</span></span> <span class="main">-</span><span class="skolem">as'</span><span class="main">→*</span> <span class="skolem">n'</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">-</span><span class="main">(</span><span class="operator">erule</span> Entry_path_High_path<span class="main">)</span>
    <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="keyword1"><span class="free">(_Entry_)</span></span> <span class="main">-</span><span class="skolem">as</span><span class="main">→*</span> <span class="skolem">n'</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">as</span> <span class="main">=</span> <span class="skolem">a'</span><span class="main">#</span><span class="skolem">as'</span>›</span></span>
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">sourcenode</span> <span class="skolem">a'</span> <span class="main">=</span> <span class="keyword1"><span class="free">(_Entry_)</span></span>"</span></span> <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">fastforce</span> <span class="quasi_keyword">elim</span><span class="main"><span class="main">:</span></span>path.cases<span class="main">)</span>
    <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
    <span class="keyword1"><span class="command">proof</span></span><span class="main">(</span><span class="operator">cases</span> <span class="quoted"><span class="quoted">"<span class="skolem">as'</span> <span class="main">=</span> <span class="main">[]</span>"</span></span><span class="main">)</span>
      <span class="keyword3"><span class="command">case</span></span> True
      <span class="keyword1"><span class="command">with</span></span> <span class="quoted"><span class="quoted">‹<span class="keyword1"><span class="free">(_High_)</span></span> <span class="main">-</span><span class="skolem">as'</span><span class="main">→*</span> <span class="skolem">n'</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">n'</span> <span class="main">=</span> <span class="keyword1"><span class="free">(_High_)</span></span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">fastforce</span>
      <span class="keyword1"><span class="command">with</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">n'</span> <span class="main">∈</span> <span class="free">backward_slice</span> <span class="free">S</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="keyword1"><span class="free">(_High_)</span></span> <span class="main">∉</span> <span class="free">backward_slice</span> <span class="free">S</span>›</span></span>
      <span class="keyword1"><span class="command">have</span></span> <span class="quoted">False</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
      <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">next</span></span>
      <span class="keyword3"><span class="command">case</span></span> False
      <span class="keyword1"><span class="command">with</span></span> <span class="quoted"><span class="quoted">‹<span class="keyword1"><span class="free">(_High_)</span></span> <span class="main">-</span><span class="skolem">as'</span><span class="main">→*</span> <span class="skolem">n'</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"hd <span class="main">(</span>sourcenodes <span class="skolem">as'</span><span class="main">)</span> <span class="main">=</span> <span class="keyword1"><span class="free">(_High_)</span></span>"</span></span>
        <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">rule</span> path_sourcenode<span class="main">)</span>
      <span class="keyword1"><span class="command">from</span></span> False <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"hd <span class="main">(</span>sourcenodes <span class="skolem">as'</span><span class="main">)</span> <span class="main">∈</span> set <span class="main">(</span>sourcenodes <span class="skolem">as'</span><span class="main">)</span>"</span></span>
        <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">fastforce</span> <span class="quasi_keyword">intro</span><span class="main"><span class="main">:</span></span>hd_in_set <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span>sourcenodes_def<span class="main">)</span>
      <span class="keyword1"><span class="command">with</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">as</span> <span class="main">=</span> <span class="skolem">a'</span><span class="main">#</span><span class="skolem">as'</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"hd <span class="main">(</span>sourcenodes <span class="skolem">as'</span><span class="main">)</span> <span class="main">∈</span> set <span class="main">(</span>sourcenodes <span class="skolem">as</span><span class="main">)</span>"</span></span>
        <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span>sourcenodes_def<span class="main">)</span>
      <span class="keyword1"><span class="command">with</span></span> <span class="quoted"><span class="quoted">‹hd <span class="main">(</span>sourcenodes <span class="skolem">as'</span><span class="main">)</span> <span class="main">=</span> <span class="keyword1"><span class="free">(_High_)</span></span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="main">∀</span><span class="bound">nx</span> <span class="main">∈</span> set<span class="main">(</span>sourcenodes <span class="skolem">as</span><span class="main">)</span><span class="main">.</span> <span class="free">V</span> <span class="main">∉</span> <span class="free">Def</span> <span class="bound">nx</span>›</span></span>
      <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">V</span> <span class="main">∉</span> <span class="free">Def</span> <span class="keyword1"><span class="free">(_High_)</span></span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">fastforce</span>
      <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="free">V</span> <span class="main">∉</span> <span class="free">H</span>"</span></span> <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span>DefHigh<span class="main">)</span>
      <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">rule</span> not_High_Low<span class="main">)</span>
    <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">qed</span></span>
<span class="keyword1"><span class="command">qed</span></span>



<span class="keyword1"><span class="command">lemma</span></span> lowEquivalence_relevant_nodes_Entry<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">s</span> <span class="keyword1">≈<span class="hidden">⇩</span><sub>L</sub></span> <span class="free">s'</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1"><span class="free">(_High_)</span></span> <span class="main">∉</span> <span class="free">backward_slice</span> <span class="free">S</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">V</span> <span class="main">∈</span> <span class="keyword1">rv</span> <span class="free">S</span> <span class="keyword1"><span class="free">(_Entry_)</span></span><span class="main">.</span> <span class="free">state_val</span> <span class="free">s</span> <span class="bound">V</span> <span class="main">=</span> <span class="free">state_val</span> <span class="free">s'</span> <span class="bound">V</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span>
  <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">V</span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">V</span> <span class="main">∈</span> <span class="keyword1">rv</span> <span class="free">S</span> <span class="keyword1"><span class="free">(_Entry_)</span></span>"</span></span>
  <span class="keyword1"><span class="command">with</span></span> <span class="quoted"><span class="quoted">‹<span class="keyword1"><span class="free">(_High_)</span></span> <span class="main">∉</span> <span class="free">backward_slice</span> <span class="free">S</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">V</span> <span class="main">∈</span> <span class="free">L</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">-</span><span class="main">(</span><span class="operator">rule</span> relevant_vars_Entry<span class="main">)</span>
  <span class="keyword1"><span class="command">with</span></span> <span class="quoted"><span class="quoted">‹<span class="free">s</span> <span class="keyword1">≈<span class="hidden">⇩</span><sub>L</sub></span> <span class="free">s'</span>›</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="free">state_val</span> <span class="free">s</span> <span class="skolem">V</span> <span class="main">=</span> <span class="free">state_val</span> <span class="free">s'</span> <span class="skolem">V</span>"</span></span> <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span>lowEquivalence_def<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>



<span class="keyword1"><span class="command">lemma</span></span> rv_Low_Use_Low<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1"><span class="free">(_Low_)</span></span> <span class="main">∈</span> <span class="free">S</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">⟦</span><span class="free">n</span> <span class="main">-</span><span class="free">as</span><span class="main">→*</span> <span class="keyword1"><span class="free">(_Low_)</span></span><span class="main">;</span> <span class="free">n</span> <span class="main">-</span><span class="free">as'</span><span class="main">→*</span> <span class="keyword1"><span class="free">(_Low_)</span></span><span class="main">;</span>
    <span class="main">∀</span><span class="bound">V</span> <span class="main">∈</span> <span class="keyword1">rv</span> <span class="free">S</span> <span class="free">n</span><span class="main">.</span> <span class="free">state_val</span> <span class="free">s</span> <span class="bound">V</span> <span class="main">=</span> <span class="free">state_val</span> <span class="free">s'</span> <span class="bound">V</span><span class="main">;</span>
    preds <span class="main">(</span>slice_kinds <span class="free">S</span> <span class="free">as</span><span class="main">)</span> <span class="free">s</span><span class="main">;</span> preds <span class="main">(</span>slice_kinds <span class="free">S</span> <span class="free">as'</span><span class="main">)</span> <span class="free">s'</span><span class="main">⟧</span>
  <span class="main">⟹</span> <span class="main">∀</span><span class="bound">V</span> <span class="main">∈</span> <span class="free">Use</span> <span class="keyword1"><span class="free">(_Low_)</span></span><span class="main">.</span> <span class="free">state_val</span> <span class="main">(</span>transfers <span class="main">(</span>slice_kinds <span class="free">S</span> <span class="free">as</span><span class="main">)</span> <span class="free">s</span><span class="main">)</span> <span class="bound">V</span> <span class="main">=</span>
                       <span class="free">state_val</span> <span class="main">(</span>transfers <span class="main">(</span>slice_kinds <span class="free">S</span> <span class="free">as'</span><span class="main">)</span> <span class="free">s'</span><span class="main">)</span> <span class="bound">V</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span><span class="main">(</span><span class="operator">induct</span> <span class="quoted"><span class="free">n</span></span> <span class="quoted"><span class="free">as</span></span> <span class="skolem">n</span><span class="main"><span class="main">≡</span></span><span class="quoted"><span class="quoted">"<span class="keyword1"><span class="free">(_Low_)</span></span>"</span></span> <span class="quasi_keyword">arbitrary</span><span class="main"><span class="main">:</span></span><span class="quoted"><span class="free">as'</span></span> <span class="quoted"><span class="free">s</span></span> <span class="quoted"><span class="free">s'</span></span> <span class="quasi_keyword">rule</span><span class="main"><span class="main">:</span></span>path.induct<span class="main">)</span>
  <span class="keyword3"><span class="command">case</span></span> empty_path
  <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">V</span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">V</span> <span class="main">∈</span> <span class="free">Use</span> <span class="keyword1"><span class="free">(_Low_)</span></span>"</span></span>
    <span class="keyword1"><span class="command">moreover</span></span>
    <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹valid_node <span class="keyword1"><span class="free">(_Low_)</span></span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1"><span class="free">(_Low_)</span></span> <span class="main">-</span><span class="main">[]</span><span class="main">→*</span> <span class="keyword1"><span class="free">(_Low_)</span></span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">fastforce</span> <span class="quasi_keyword">intro</span><span class="main"><span class="main">:</span></span>path.empty_path<span class="main">)</span>
    <span class="keyword1"><span class="command">moreover</span></span>
    <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹valid_node <span class="keyword1"><span class="free">(_Low_)</span></span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="keyword1"><span class="free">(_Low_)</span></span> <span class="main">∈</span> <span class="free">S</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1"><span class="free">(_Low_)</span></span> <span class="main">∈</span> <span class="free">backward_slice</span> <span class="free">S</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">fastforce</span> <span class="quasi_keyword">intro</span><span class="main"><span class="main">:</span></span>refl<span class="main">)</span>
    <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">V</span> <span class="main">∈</span> <span class="keyword1">rv</span> <span class="free">S</span> <span class="keyword1"><span class="free">(_Low_)</span></span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">fastforce</span> <span class="quasi_keyword">intro</span><span class="main"><span class="main">:</span></span>rvI <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span>sourcenodes_def<span class="main">)</span> <span class="keyword1"><span class="command">}</span></span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">V</span> <span class="main">∈</span> <span class="free">Use</span> <span class="keyword1"><span class="free">(_Low_)</span></span><span class="main">.</span> <span class="bound">V</span> <span class="main">∈</span> <span class="keyword1">rv</span> <span class="free">S</span> <span class="keyword1"><span class="free">(_Low_)</span></span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?case</span></span></span>
  <span class="keyword1"><span class="command">proof</span></span><span class="main">(</span><span class="operator">cases</span> <span class="quoted"><span class="quoted">"<span class="free">L</span> <span class="main">=</span> <span class="main">{}</span>"</span></span><span class="main">)</span>
    <span class="keyword3"><span class="command">case</span></span> True <span class="keyword1"><span class="command">with</span></span> UseLow <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">next</span></span>
    <span class="keyword3"><span class="command">case</span></span> False
    <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="keyword1"><span class="free">(_Low_)</span></span> <span class="main">-</span><span class="skolem">as'</span><span class="main">→*</span> <span class="keyword1"><span class="free">(_Low_)</span></span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">as'</span> <span class="main">=</span> <span class="main">[]</span>"</span></span>
    <span class="keyword1"><span class="command">proof</span></span><span class="main">(</span><span class="operator">induct</span> <span class="skolem">n</span><span class="main"><span class="main">≡</span></span><span class="quoted"><span class="quoted">"<span class="keyword1"><span class="free">(_Low_)</span></span>"</span></span> <span class="quoted"><span class="skolem">as'</span></span> <span class="skolem">n'</span><span class="main"><span class="main">≡</span></span><span class="quoted"><span class="quoted">"<span class="keyword1"><span class="free">(_Low_)</span></span>"</span></span> <span class="quasi_keyword">rule</span><span class="main"><span class="main">:</span></span>path.induct<span class="main">)</span>
      <span class="keyword3"><span class="command">case</span></span> <span class="main">(</span>Cons_path <span class="skolem">n''</span> <span class="skolem">as</span> <span class="skolem">a</span><span class="main">)</span>
      <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="free">valid_edge</span> <span class="skolem">a</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="free">sourcenode</span> <span class="skolem">a</span> <span class="main">=</span> <span class="keyword1"><span class="free">(_Low_)</span></span>›</span></span>
      <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">targetnode</span> <span class="skolem">a</span> <span class="main">=</span> <span class="keyword1"><span class="free">(_Exit_)</span></span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">-</span><span class="main">(</span><span class="operator">rule</span> Exit_successor_of_Low<span class="main"><span class="keyword3">,</span></span><span class="operator">simp</span><span class="main"><span class="keyword3">+</span></span><span class="main">)</span>
      <span class="keyword1"><span class="command">with</span></span> <span class="quoted"><span class="quoted">‹<span class="free">targetnode</span> <span class="skolem">a</span> <span class="main">=</span> <span class="skolem">n''</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">n''</span> <span class="main">-</span><span class="skolem">as</span><span class="main">→*</span> <span class="keyword1"><span class="free">(_Low_)</span></span>›</span></span>
      <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1"><span class="free">(_Low_)</span></span> <span class="main">=</span> <span class="keyword1"><span class="free">(_Exit_)</span></span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">-</span><span class="main">(</span><span class="operator">rule</span> path_Exit_source<span class="main"><span class="keyword3">,</span></span><span class="operator">fastforce</span><span class="main">)</span>
      <span class="keyword1"><span class="command">with</span></span> False <span class="keyword1"><span class="command">have</span></span> <span class="quoted">False</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">-</span><span class="main">(</span><span class="operator">drule</span> Low_neq_Exit<span class="main"><span class="keyword3">,</span></span><span class="operator">simp</span><span class="main">)</span>
      <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?case</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">qed</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">with</span></span> <span class="quoted"><span class="quoted">‹<span class="main">∀</span><span class="bound">V</span> <span class="main">∈</span> <span class="free">Use</span> <span class="keyword1"><span class="free">(_Low_)</span></span><span class="main">.</span> <span class="bound">V</span> <span class="main">∈</span> <span class="keyword1">rv</span> <span class="free">S</span> <span class="keyword1"><span class="free">(_Low_)</span></span>›</span></span> 
      <span class="quoted"><span class="quoted">‹<span class="main">∀</span><span class="bound">V</span><span class="main">∈</span><span class="keyword1">rv</span> <span class="free">S</span> <span class="keyword1"><span class="free">(_Low_)</span></span><span class="main">.</span> <span class="free">state_val</span> <span class="skolem">s</span> <span class="bound">V</span> <span class="main">=</span> <span class="free">state_val</span> <span class="skolem">s'</span> <span class="bound">V</span>›</span></span>
    <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span>slice_kinds_def<span class="main">)</span>
  <span class="keyword1"><span class="command">qed</span></span>
<span class="keyword1"><span class="command">next</span></span>
  <span class="keyword3"><span class="command">case</span></span> <span class="main">(</span>Cons_path <span class="skolem">n''</span> <span class="skolem">as</span> <span class="skolem">a</span> <span class="skolem">n</span><span class="main">)</span>
  <span class="keyword1"><span class="command">note</span></span> IH <span class="main">=</span> <span class="quoted"><span class="quoted">‹<span class="main">⋀</span><span class="bound">as'</span> <span class="bound">s</span> <span class="bound">s'</span><span class="main">.</span> <span class="main">⟦</span><span class="skolem">n''</span> <span class="main">-</span><span class="bound">as'</span><span class="main">→*</span> <span class="keyword1"><span class="free">(_Low_)</span></span><span class="main">;</span>
    <span class="main">∀</span><span class="bound">V</span><span class="main">∈</span><span class="keyword1">rv</span> <span class="free">S</span> <span class="skolem">n''</span><span class="main">.</span> <span class="free">state_val</span> <span class="bound">s</span> <span class="bound">V</span> <span class="main">=</span> <span class="free">state_val</span> <span class="bound">s'</span> <span class="bound">V</span><span class="main">;</span>
   preds <span class="main">(</span>slice_kinds <span class="free">S</span> <span class="skolem">as</span><span class="main">)</span> <span class="bound">s</span><span class="main">;</span> preds <span class="main">(</span>slice_kinds <span class="free">S</span> <span class="bound">as'</span><span class="main">)</span> <span class="bound">s'</span><span class="main">⟧</span>
  <span class="main">⟹</span> <span class="main">∀</span><span class="bound">V</span><span class="main">∈</span><span class="free">Use</span> <span class="keyword1"><span class="free">(_Low_)</span></span><span class="main">.</span> <span class="free">state_val</span> <span class="main">(</span>transfers <span class="main">(</span>slice_kinds <span class="free">S</span> <span class="skolem">as</span><span class="main">)</span> <span class="bound">s</span><span class="main">)</span> <span class="bound">V</span> <span class="main">=</span>
                     <span class="free">state_val</span> <span class="main">(</span>transfers <span class="main">(</span>slice_kinds <span class="free">S</span> <span class="bound">as'</span><span class="main">)</span> <span class="bound">s'</span><span class="main">)</span> <span class="bound">V</span>›</span></span>
  <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?case</span></span></span>
  <span class="keyword1"><span class="command">proof</span></span><span class="main">(</span><span class="operator">cases</span> <span class="quoted"><span class="quoted">"<span class="free">L</span> <span class="main">=</span> <span class="main">{}</span>"</span></span><span class="main">)</span>
    <span class="keyword3"><span class="command">case</span></span> True <span class="keyword1"><span class="command">with</span></span> UseLow <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">next</span></span>
    <span class="keyword3"><span class="command">case</span></span> False
    <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
    <span class="keyword1"><span class="command">proof</span></span><span class="main">(</span><span class="operator">cases</span> <span class="quoted"><span class="skolem">as'</span></span><span class="main">)</span>
      <span class="keyword3"><span class="command">case</span></span> Nil
      <span class="keyword1"><span class="command">with</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">n</span> <span class="main">-</span><span class="skolem">as'</span><span class="main">→*</span> <span class="keyword1"><span class="free">(_Low_)</span></span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">n</span> <span class="main">=</span> <span class="keyword1"><span class="free">(_Low_)</span></span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">fastforce</span>
      <span class="keyword1"><span class="command">with</span></span> <span class="quoted"><span class="quoted">‹<span class="free">valid_edge</span> <span class="skolem">a</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="free">sourcenode</span> <span class="skolem">a</span> <span class="main">=</span> <span class="skolem">n</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">targetnode</span> <span class="skolem">a</span> <span class="main">=</span> <span class="keyword1"><span class="free">(_Exit_)</span></span>"</span></span>
        <span class="keyword1"><span class="command">by</span></span> <span class="operator">-</span><span class="main">(</span><span class="operator">rule</span> Exit_successor_of_Low<span class="main"><span class="keyword3">,</span></span><span class="operator">simp</span><span class="main"><span class="keyword3">+</span></span><span class="main">)</span>
      <span class="keyword1"><span class="command">from</span></span> Low_source_Exit_edge <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">ax</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="free">valid_edge</span> <span class="skolem">ax</span>"</span></span>
        <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">sourcenode</span> <span class="skolem">ax</span> <span class="main">=</span> <span class="keyword1"><span class="free">(_Low_)</span></span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">targetnode</span> <span class="skolem">ax</span> <span class="main">=</span> <span class="keyword1"><span class="free">(_Exit_)</span></span>"</span></span>
        <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">kind</span> <span class="skolem">ax</span> <span class="main">=</span> <span class="main">(</span><span class="main">λ</span><span class="bound">s</span><span class="main">.</span> True<span class="main">)<span class="hidden">⇩</span><sub>√</sub></span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
      <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="free">valid_edge</span> <span class="skolem">a</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="free">sourcenode</span> <span class="skolem">a</span> <span class="main">=</span> <span class="skolem">n</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">n</span> <span class="main">=</span> <span class="keyword1"><span class="free">(_Low_)</span></span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="free">targetnode</span> <span class="skolem">a</span> <span class="main">=</span> <span class="keyword1"><span class="free">(_Exit_)</span></span>›</span></span>
        <span class="quoted"><span class="quoted">‹<span class="free">valid_edge</span> <span class="skolem">ax</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="free">sourcenode</span> <span class="skolem">ax</span> <span class="main">=</span> <span class="keyword1"><span class="free">(_Low_)</span></span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="free">targetnode</span> <span class="skolem">ax</span> <span class="main">=</span> <span class="keyword1"><span class="free">(_Exit_)</span></span>›</span></span>
      <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">a</span> <span class="main">=</span> <span class="skolem">ax</span>"</span></span> <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">fastforce</span> <span class="quasi_keyword">dest</span><span class="main"><span class="main">:</span></span>edge_det<span class="main">)</span>
      <span class="keyword1"><span class="command">with</span></span> <span class="quoted"><span class="quoted">‹<span class="free">kind</span> <span class="skolem">ax</span> <span class="main">=</span> <span class="main">(</span><span class="main">λ</span><span class="bound">s</span><span class="main">.</span> True<span class="main">)<span class="hidden">⇩</span><sub>√</sub></span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">kind</span> <span class="skolem">a</span> <span class="main">=</span> <span class="main">(</span><span class="main">λ</span><span class="bound">s</span><span class="main">.</span> True<span class="main">)<span class="hidden">⇩</span><sub>√</sub></span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
      <span class="keyword1"><span class="command">with</span></span> <span class="quoted"><span class="quoted">‹<span class="free">targetnode</span> <span class="skolem">a</span> <span class="main">=</span> <span class="keyword1"><span class="free">(_Exit_)</span></span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="free">targetnode</span> <span class="skolem">a</span> <span class="main">=</span> <span class="skolem">n''</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">n''</span> <span class="main">-</span><span class="skolem">as</span><span class="main">→*</span> <span class="keyword1"><span class="free">(_Low_)</span></span>›</span></span>
      <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1"><span class="free">(_Low_)</span></span> <span class="main">=</span> <span class="keyword1"><span class="free">(_Exit_)</span></span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">-</span><span class="main">(</span><span class="operator">rule</span> path_Exit_source<span class="main"><span class="keyword3">,</span></span><span class="operator">auto</span><span class="main">)</span>
      <span class="keyword1"><span class="command">with</span></span> False <span class="keyword1"><span class="command">have</span></span> <span class="quoted">False</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">-</span><span class="main">(</span><span class="operator">drule</span> Low_neq_Exit<span class="main"><span class="keyword3">,</span></span><span class="operator">simp</span><span class="main">)</span>
      <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">next</span></span>
      <span class="keyword3"><span class="command">case</span></span> <span class="main">(</span>Cons <span class="skolem">ax</span> <span class="skolem">asx</span><span class="main">)</span>
      <span class="keyword1"><span class="command">with</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">n</span> <span class="main">-</span><span class="skolem">as'</span><span class="main">→*</span> <span class="keyword1"><span class="free">(_Low_)</span></span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">n</span> <span class="main">=</span> <span class="free">sourcenode</span> <span class="skolem">ax</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">valid_edge</span> <span class="skolem">ax</span>"</span></span> 
        <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">targetnode</span> <span class="skolem">ax</span> <span class="main">-</span><span class="skolem">asx</span><span class="main">→*</span> <span class="keyword1"><span class="free">(_Low_)</span></span>"</span></span> <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">elim</span><span class="main"><span class="main">:</span></span>path_split_Cons<span class="main">)</span>
      <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
      <span class="keyword1"><span class="command">proof</span></span><span class="main">(</span><span class="operator">cases</span> <span class="quoted"><span class="quoted">"<span class="free">targetnode</span> <span class="skolem">ax</span> <span class="main">=</span> <span class="skolem">n''</span>"</span></span><span class="main">)</span>
        <span class="keyword3"><span class="command">case</span></span> True
        <span class="keyword1"><span class="command">with</span></span> <span class="quoted"><span class="quoted">‹<span class="free">targetnode</span> <span class="skolem">ax</span> <span class="main">-</span><span class="skolem">asx</span><span class="main">→*</span> <span class="keyword1"><span class="free">(_Low_)</span></span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">n''</span> <span class="main">-</span><span class="skolem">asx</span><span class="main">→*</span> <span class="keyword1"><span class="free">(_Low_)</span></span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
        <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="free">valid_edge</span> <span class="skolem">ax</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="free">valid_edge</span> <span class="skolem">a</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">n</span> <span class="main">=</span> <span class="free">sourcenode</span> <span class="skolem">ax</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="free">sourcenode</span> <span class="skolem">a</span> <span class="main">=</span> <span class="skolem">n</span>›</span></span>
          True <span class="quoted"><span class="quoted">‹<span class="free">targetnode</span> <span class="skolem">a</span> <span class="main">=</span> <span class="skolem">n''</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">ax</span> <span class="main">=</span> <span class="skolem">a</span>"</span></span> <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">fastforce</span> <span class="quasi_keyword">intro</span><span class="main"><span class="main">:</span></span>edge_det<span class="main">)</span>
        <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹preds <span class="main">(</span>slice_kinds <span class="free">S</span> <span class="main">(</span><span class="skolem">a</span><span class="main">#</span><span class="skolem">as</span><span class="main">)</span><span class="main">)</span> <span class="skolem">s</span>›</span></span> 
        <span class="keyword1"><span class="command">have</span></span> preds1<span class="main">:</span><span class="quoted"><span class="quoted">"preds <span class="main">(</span>slice_kinds <span class="free">S</span> <span class="skolem">as</span><span class="main">)</span> <span class="main">(</span>transfer <span class="main">(</span>slice_kind <span class="free">S</span> <span class="skolem">a</span><span class="main">)</span> <span class="skolem">s</span><span class="main">)</span>"</span></span>
          <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span>slice_kinds_def<span class="main">)</span>
        <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹preds <span class="main">(</span>slice_kinds <span class="free">S</span> <span class="skolem">as'</span><span class="main">)</span> <span class="skolem">s'</span>›</span></span> Cons <span class="quoted"><span class="quoted">‹<span class="skolem">ax</span> <span class="main">=</span> <span class="skolem">a</span>›</span></span>
        <span class="keyword1"><span class="command">have</span></span> preds2<span class="main">:</span><span class="quoted"><span class="quoted">"preds <span class="main">(</span>slice_kinds <span class="free">S</span> <span class="skolem">asx</span><span class="main">)</span> 
          <span class="main">(</span>transfer <span class="main">(</span>slice_kind <span class="free">S</span> <span class="skolem">a</span><span class="main">)</span> <span class="skolem">s'</span><span class="main">)</span>"</span></span>
          <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span>slice_kinds_def<span class="main">)</span>
        <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="free">valid_edge</span> <span class="skolem">a</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="free">sourcenode</span> <span class="skolem">a</span> <span class="main">=</span> <span class="skolem">n</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="free">targetnode</span> <span class="skolem">a</span> <span class="main">=</span> <span class="skolem">n''</span>›</span></span>
          <span class="quoted"><span class="quoted">‹preds <span class="main">(</span>slice_kinds <span class="free">S</span> <span class="main">(</span><span class="skolem">a</span><span class="main">#</span><span class="skolem">as</span><span class="main">)</span><span class="main">)</span> <span class="skolem">s</span>›</span></span> <span class="quoted"><span class="quoted">‹preds <span class="main">(</span>slice_kinds <span class="free">S</span> <span class="skolem">as'</span><span class="main">)</span> <span class="skolem">s'</span>›</span></span>
          <span class="quoted"><span class="quoted">‹<span class="skolem">ax</span> <span class="main">=</span> <span class="skolem">a</span>›</span></span> Cons <span class="quoted"><span class="quoted">‹<span class="main">∀</span><span class="bound">V</span><span class="main">∈</span><span class="keyword1">rv</span> <span class="free">S</span> <span class="skolem">n</span><span class="main">.</span> <span class="free">state_val</span> <span class="skolem">s</span> <span class="bound">V</span> <span class="main">=</span> <span class="free">state_val</span> <span class="skolem">s'</span> <span class="bound">V</span>›</span></span>
        <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">V</span><span class="main">∈</span><span class="keyword1">rv</span> <span class="free">S</span> <span class="skolem">n''</span><span class="main">.</span> <span class="free">state_val</span> <span class="main">(</span>transfer <span class="main">(</span>slice_kind <span class="free">S</span> <span class="skolem">a</span><span class="main">)</span> <span class="skolem">s</span><span class="main">)</span> <span class="bound">V</span> <span class="main">=</span>
                                 <span class="free">state_val</span> <span class="main">(</span>transfer <span class="main">(</span>slice_kind <span class="free">S</span> <span class="skolem">a</span><span class="main">)</span> <span class="skolem">s'</span><span class="main">)</span> <span class="bound">V</span>"</span></span>
          <span class="keyword1"><span class="command">by</span></span> <span class="operator">-</span><span class="main">(</span><span class="operator">rule</span> rv_edge_slice_kinds<span class="main"><span class="keyword3">,</span></span><span class="operator">auto</span><span class="main">)</span>
        <span class="keyword1"><span class="command">from</span></span> IH<span class="main">[</span><span class="operator">OF</span> <span class="quoted"><span class="quoted">‹<span class="skolem">n''</span> <span class="main">-</span><span class="skolem">asx</span><span class="main">→*</span> <span class="keyword1"><span class="free">(_Low_)</span></span>›</span></span> this preds1 preds2<span class="main">]</span> 
          Cons <span class="quoted"><span class="quoted">‹<span class="skolem">ax</span> <span class="main">=</span> <span class="skolem">a</span>›</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span>slice_kinds_def<span class="main">)</span>
      <span class="keyword1"><span class="command">next</span></span>
        <span class="keyword3"><span class="command">case</span></span> False
        <span class="keyword1"><span class="command">with</span></span> <span class="quoted"><span class="quoted">‹<span class="free">valid_edge</span> <span class="skolem">a</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="free">valid_edge</span> <span class="skolem">ax</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="free">sourcenode</span> <span class="skolem">a</span> <span class="main">=</span> <span class="skolem">n</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">n</span> <span class="main">=</span> <span class="free">sourcenode</span> <span class="skolem">ax</span>›</span></span>
          <span class="quoted"><span class="quoted">‹<span class="free">targetnode</span> <span class="skolem">a</span> <span class="main">=</span> <span class="skolem">n''</span>›</span></span> <span class="quoted"><span class="quoted">‹preds <span class="main">(</span>slice_kinds <span class="free">S</span> <span class="main">(</span><span class="skolem">a</span><span class="main">#</span><span class="skolem">as</span><span class="main">)</span><span class="main">)</span> <span class="skolem">s</span>›</span></span>
          <span class="quoted"><span class="quoted">‹preds <span class="main">(</span>slice_kinds <span class="free">S</span> <span class="skolem">as'</span><span class="main">)</span> <span class="skolem">s'</span>›</span></span> Cons
          <span class="quoted"><span class="quoted">‹<span class="main">∀</span><span class="bound">V</span><span class="main">∈</span><span class="keyword1">rv</span> <span class="free">S</span> <span class="skolem">n</span><span class="main">.</span> <span class="free">state_val</span> <span class="skolem">s</span> <span class="bound">V</span> <span class="main">=</span> <span class="free">state_val</span> <span class="skolem">s'</span> <span class="bound">V</span>›</span></span>
        <span class="keyword1"><span class="command">have</span></span> <span class="quoted">False</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">-</span><span class="main">(</span><span class="operator">rule</span> rv_branching_edges_slice_kinds_False<span class="main"><span class="keyword3">,</span></span><span class="operator">auto</span><span class="main">)</span>
        <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
      <span class="keyword1"><span class="command">qed</span></span>
    <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">qed</span></span>
<span class="keyword1"><span class="command">qed</span></span>


<span class="keyword1"><span class="command">subsection</span></span> <span class="quoted"><span class="plain_text">‹The Correctness Proofs›</span></span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹
In the following, we present two correctness proofs that slicing guarantees
IFC noninterference. In both theorems, 
<span class="antiquoted"><span class="raw_text"><span class="antiquoted"><span class="raw_text"><span class="operator"><span class="operator">‹</span></span>(_High_) ∉ backward_slice S›</span></span></span></span>, where <span class="antiquoted"><span class="raw_text"><span class="antiquoted"><span class="raw_text"><span class="operator"><span class="operator">‹</span></span>(_Low_) ∈ S›</span></span></span></span>,
makes sure that no high variable (which are all defined in <span class="antiquoted"><span class="raw_text"><span class="antiquoted"><span class="raw_text"><span class="operator"><span class="operator">‹</span></span>(_High_)›</span></span></span></span>) 
can influence a low variable (which are all used in <span class="antiquoted"><span class="raw_text"><span class="antiquoted"><span class="raw_text"><span class="operator"><span class="operator">‹</span></span>(_Low_)›</span></span></span></span>).

First, a theorem regarding 
<span class="antiquoted"><span class="raw_text"><span class="antiquoted"><span class="raw_text"><span class="operator"><span class="operator">‹</span></span>(_Entry_) -as→* (_Exit_)›</span></span></span></span> paths in the control flow graph (CFG),
which agree to a complete program execution:›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> nonInterference_path_to_Low<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">s</span> <span class="keyword1">≈<span class="hidden">⇩</span><sub>L</sub></span> <span class="free">s'</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1"><span class="free">(_High_)</span></span> <span class="main">∉</span> <span class="free">backward_slice</span> <span class="free">S</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1"><span class="free">(_Low_)</span></span> <span class="main">∈</span> <span class="free">S</span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1"><span class="free">(_Entry_)</span></span> <span class="main">-</span><span class="free">as</span><span class="main">→*</span> <span class="keyword1"><span class="free">(_Low_)</span></span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"preds <span class="main">(</span>kinds <span class="free">as</span><span class="main">)</span> <span class="free">s</span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1"><span class="free">(_Entry_)</span></span> <span class="main">-</span><span class="free">as'</span><span class="main">→*</span> <span class="keyword1"><span class="free">(_Low_)</span></span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"preds <span class="main">(</span>kinds <span class="free">as'</span><span class="main">)</span> <span class="free">s'</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"transfers <span class="main">(</span>kinds <span class="free">as</span><span class="main">)</span> <span class="free">s</span> <span class="keyword1">≈<span class="hidden">⇩</span><sub>L</sub></span> transfers <span class="main">(</span>kinds <span class="free">as'</span><span class="main">)</span> <span class="free">s'</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="keyword1"><span class="free">(_Entry_)</span></span> <span class="main">-</span><span class="free">as</span><span class="main">→*</span> <span class="keyword1"><span class="free">(_Low_)</span></span>›</span></span> <span class="quoted"><span class="quoted">‹preds <span class="main">(</span>kinds <span class="free">as</span><span class="main">)</span> <span class="free">s</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="keyword1"><span class="free">(_Low_)</span></span> <span class="main">∈</span> <span class="free">S</span>›</span></span>
  <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">asx</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"preds <span class="main">(</span>slice_kinds <span class="free">S</span> <span class="skolem">asx</span><span class="main">)</span> <span class="free">s</span>"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">V</span> <span class="main">∈</span> <span class="free">Use</span> <span class="keyword1"><span class="free">(_Low_)</span></span><span class="main">.</span> <span class="free">state_val</span><span class="main">(</span>transfers <span class="main">(</span>slice_kinds <span class="free">S</span> <span class="skolem">asx</span><span class="main">)</span> <span class="free">s</span><span class="main">)</span> <span class="bound">V</span> <span class="main">=</span> 
                           <span class="free">state_val</span><span class="main">(</span>transfers <span class="main">(</span>kinds <span class="free">as</span><span class="main">)</span> <span class="free">s</span><span class="main">)</span> <span class="bound">V</span>"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"slice_edges <span class="free">S</span> <span class="free">as</span> <span class="main">=</span> slice_edges <span class="free">S</span> <span class="skolem">asx</span>"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1"><span class="free">(_Entry_)</span></span> <span class="main">-</span><span class="skolem">asx</span><span class="main">→*</span> <span class="keyword1"><span class="free">(_Low_)</span></span>"</span></span> <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">erule</span> fundamental_property_of_static_slicing<span class="main">)</span>
  <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="keyword1"><span class="free">(_Entry_)</span></span> <span class="main">-</span><span class="free">as'</span><span class="main">→*</span> <span class="keyword1"><span class="free">(_Low_)</span></span>›</span></span> <span class="quoted"><span class="quoted">‹preds <span class="main">(</span>kinds <span class="free">as'</span><span class="main">)</span> <span class="free">s'</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="keyword1"><span class="free">(_Low_)</span></span> <span class="main">∈</span> <span class="free">S</span>›</span></span>
  <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">asx'</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"preds <span class="main">(</span>slice_kinds <span class="free">S</span> <span class="skolem">asx'</span><span class="main">)</span> <span class="free">s'</span>"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">V</span> <span class="main">∈</span> <span class="free">Use</span> <span class="keyword1"><span class="free">(_Low_)</span></span><span class="main">.</span> <span class="free">state_val</span> <span class="main">(</span>transfers <span class="main">(</span>slice_kinds <span class="free">S</span> <span class="skolem">asx'</span><span class="main">)</span> <span class="free">s'</span><span class="main">)</span> <span class="bound">V</span> <span class="main">=</span> 
                           <span class="free">state_val</span> <span class="main">(</span>transfers <span class="main">(</span>kinds <span class="free">as'</span><span class="main">)</span> <span class="free">s'</span><span class="main">)</span> <span class="bound">V</span>"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"slice_edges <span class="free">S</span> <span class="free">as'</span> <span class="main">=</span> slice_edges <span class="free">S</span> <span class="skolem">asx'</span>"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1"><span class="free">(_Entry_)</span></span> <span class="main">-</span><span class="skolem">asx'</span><span class="main">→*</span> <span class="keyword1"><span class="free">(_Low_)</span></span>"</span></span> <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">erule</span> fundamental_property_of_static_slicing<span class="main">)</span>
  <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="free">s</span> <span class="keyword1">≈<span class="hidden">⇩</span><sub>L</sub></span> <span class="free">s'</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="keyword1"><span class="free">(_High_)</span></span> <span class="main">∉</span> <span class="free">backward_slice</span> <span class="free">S</span>›</span></span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">V</span> <span class="main">∈</span> <span class="keyword1">rv</span> <span class="free">S</span> <span class="keyword1"><span class="free">(_Entry_)</span></span><span class="main">.</span> <span class="free">state_val</span> <span class="free">s</span> <span class="bound">V</span> <span class="main">=</span> <span class="free">state_val</span> <span class="free">s'</span> <span class="bound">V</span>"</span></span> 
    <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">rule</span> lowEquivalence_relevant_nodes_Entry<span class="main">)</span>
  <span class="keyword1"><span class="command">with</span></span> <span class="quoted"><span class="quoted">‹<span class="keyword1"><span class="free">(_Entry_)</span></span> <span class="main">-</span><span class="skolem">asx</span><span class="main">→*</span> <span class="keyword1"><span class="free">(_Low_)</span></span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="keyword1"><span class="free">(_Entry_)</span></span> <span class="main">-</span><span class="skolem">asx'</span><span class="main">→*</span> <span class="keyword1"><span class="free">(_Low_)</span></span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="keyword1"><span class="free">(_Low_)</span></span> <span class="main">∈</span> <span class="free">S</span>›</span></span>
    <span class="quoted"><span class="quoted">‹preds <span class="main">(</span>slice_kinds <span class="free">S</span> <span class="skolem">asx</span><span class="main">)</span> <span class="free">s</span>›</span></span> <span class="quoted"><span class="quoted">‹preds <span class="main">(</span>slice_kinds <span class="free">S</span> <span class="skolem">asx'</span><span class="main">)</span> <span class="free">s'</span>›</span></span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">V</span> <span class="main">∈</span> <span class="free">Use</span> <span class="keyword1"><span class="free">(_Low_)</span></span><span class="main">.</span> <span class="free">state_val</span> <span class="main">(</span>transfers <span class="main">(</span>slice_kinds <span class="free">S</span> <span class="skolem">asx</span><span class="main">)</span> <span class="free">s</span><span class="main">)</span> <span class="bound">V</span> <span class="main">=</span>
                          <span class="free">state_val</span> <span class="main">(</span>transfers <span class="main">(</span>slice_kinds <span class="free">S</span> <span class="skolem">asx'</span><span class="main">)</span> <span class="free">s'</span><span class="main">)</span> <span class="bound">V</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">-</span><span class="main">(</span><span class="operator">rule</span> rv_Low_Use_Low<span class="main"><span class="keyword3">,</span></span><span class="operator">auto</span><span class="main">)</span>
  <span class="keyword1"><span class="command">with</span></span> <span class="quoted"><span class="quoted">‹<span class="main">∀</span><span class="bound">V</span> <span class="main">∈</span> <span class="free">Use</span> <span class="keyword1"><span class="free">(_Low_)</span></span><span class="main">.</span> <span class="free">state_val</span><span class="main">(</span>transfers <span class="main">(</span>slice_kinds <span class="free">S</span> <span class="skolem">asx</span><span class="main">)</span> <span class="free">s</span><span class="main">)</span> <span class="bound">V</span> <span class="main">=</span> 
                          <span class="free">state_val</span><span class="main">(</span>transfers <span class="main">(</span>kinds <span class="free">as</span><span class="main">)</span> <span class="free">s</span><span class="main">)</span> <span class="bound">V</span>›</span></span>
    <span class="quoted"><span class="quoted">‹<span class="main">∀</span><span class="bound">V</span> <span class="main">∈</span> <span class="free">Use</span> <span class="keyword1"><span class="free">(_Low_)</span></span><span class="main">.</span> <span class="free">state_val</span> <span class="main">(</span>transfers <span class="main">(</span>slice_kinds <span class="free">S</span> <span class="skolem">asx'</span><span class="main">)</span> <span class="free">s'</span><span class="main">)</span> <span class="bound">V</span> <span class="main">=</span> 
                       <span class="free">state_val</span> <span class="main">(</span>transfers <span class="main">(</span>kinds <span class="free">as'</span><span class="main">)</span> <span class="free">s'</span><span class="main">)</span> <span class="bound">V</span>›</span></span>
  <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span>lowEquivalence_def UseLow<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>


<span class="keyword1"><span class="command">theorem</span></span> nonInterference_path<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">s</span> <span class="keyword1">≈<span class="hidden">⇩</span><sub>L</sub></span> <span class="free">s'</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1"><span class="free">(_High_)</span></span> <span class="main">∉</span> <span class="free">backward_slice</span> <span class="free">S</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1"><span class="free">(_Low_)</span></span> <span class="main">∈</span> <span class="free">S</span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1"><span class="free">(_Entry_)</span></span> <span class="main">-</span><span class="free">as</span><span class="main">→*</span> <span class="keyword1"><span class="free">(_Exit_)</span></span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"preds <span class="main">(</span>kinds <span class="free">as</span><span class="main">)</span> <span class="free">s</span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1"><span class="free">(_Entry_)</span></span> <span class="main">-</span><span class="free">as'</span><span class="main">→*</span> <span class="keyword1"><span class="free">(_Exit_)</span></span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"preds <span class="main">(</span>kinds <span class="free">as'</span><span class="main">)</span> <span class="free">s'</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"transfers <span class="main">(</span>kinds <span class="free">as</span><span class="main">)</span> <span class="free">s</span> <span class="keyword1">≈<span class="hidden">⇩</span><sub>L</sub></span> transfers <span class="main">(</span>kinds <span class="free">as'</span><span class="main">)</span> <span class="free">s'</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="keyword1"><span class="free">(_Entry_)</span></span> <span class="main">-</span><span class="free">as</span><span class="main">→*</span> <span class="keyword1"><span class="free">(_Exit_)</span></span>›</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">x</span></span> <span class="skolem"><span class="skolem">xs</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="free">as</span> <span class="main">=</span> <span class="skolem">x</span><span class="main">#</span><span class="skolem">xs</span>"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1"><span class="free">(_Entry_)</span></span> <span class="main">=</span> <span class="free">sourcenode</span> <span class="skolem">x</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">valid_edge</span> <span class="skolem">x</span>"</span></span> 
    <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">targetnode</span> <span class="skolem">x</span> <span class="main">-</span><span class="skolem">xs</span><span class="main">→*</span> <span class="keyword1"><span class="free">(_Exit_)</span></span>"</span></span>
    <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="main">(</span><span class="operator">cases</span> <span class="quoted"><span class="quoted">"<span class="free">as</span> <span class="main">=</span> <span class="main">[]</span>"</span></span><span class="main">)</span>
     <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="main">(</span><span class="operator">simp</span><span class="main"><span class="keyword3">,</span></span><span class="operator">drule</span> empty_path_nodes<span class="main"><span class="keyword3">,</span></span><span class="operator">drule</span> Entry_noteq_Exit<span class="main"><span class="keyword3">,</span></span><span class="operator">simp</span><span class="main">)</span>
    <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">erule</span> path_split_Cons<span class="main">)</span>
  <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="free">valid_edge</span> <span class="skolem">x</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"valid_node <span class="main">(</span><span class="free">targetnode</span> <span class="skolem">x</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"inner_node <span class="main">(</span><span class="free">targetnode</span> <span class="skolem">x</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span><span class="main">(</span><span class="operator">cases</span> <span class="quasi_keyword">rule</span><span class="main"><span class="main">:</span></span>valid_node_cases<span class="main">)</span>
    <span class="keyword3"><span class="command">case</span></span> Entry
    <span class="keyword1"><span class="command">with</span></span> <span class="quoted"><span class="quoted">‹<span class="free">valid_edge</span> <span class="skolem">x</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted">False</span> <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">rule</span> Entry_target<span class="main">)</span>
    <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">next</span></span>
    <span class="keyword3"><span class="command">case</span></span> Exit
    <span class="keyword1"><span class="command">with</span></span> <span class="quoted"><span class="quoted">‹<span class="free">targetnode</span> <span class="skolem">x</span> <span class="main">-</span><span class="skolem">xs</span><span class="main">→*</span> <span class="keyword1"><span class="free">(_Exit_)</span></span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">xs</span> <span class="main">=</span> <span class="main">[]</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">-</span><span class="main">(</span><span class="operator">rule</span> path_Exit_source<span class="main"><span class="keyword3">,</span></span><span class="operator">simp</span><span class="main">)</span>
    <span class="keyword1"><span class="command">from</span></span> Entry_Exit_edge <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">z</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="free">valid_edge</span> <span class="skolem">z</span>"</span></span>
      <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">sourcenode</span> <span class="skolem">z</span> <span class="main">=</span> <span class="keyword1"><span class="free">(_Entry_)</span></span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">targetnode</span> <span class="skolem">z</span> <span class="main">=</span> <span class="keyword1"><span class="free">(_Exit_)</span></span>"</span></span>
      <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">kind</span> <span class="skolem">z</span> <span class="main">=</span> <span class="main">(</span><span class="main">λ</span><span class="bound">s</span><span class="main">.</span> False<span class="main">)<span class="hidden">⇩</span><sub>√</sub></span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
    <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="free">valid_edge</span> <span class="skolem">x</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="free">valid_edge</span> <span class="skolem">z</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="keyword1"><span class="free">(_Entry_)</span></span> <span class="main">=</span> <span class="free">sourcenode</span> <span class="skolem">x</span>›</span></span> 
      <span class="quoted"><span class="quoted">‹<span class="free">sourcenode</span> <span class="skolem">z</span> <span class="main">=</span> <span class="keyword1"><span class="free">(_Entry_)</span></span>›</span></span> Exit <span class="quoted"><span class="quoted">‹<span class="free">targetnode</span> <span class="skolem">z</span> <span class="main">=</span> <span class="keyword1"><span class="free">(_Exit_)</span></span>›</span></span>
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">=</span> <span class="skolem">z</span>"</span></span> <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">fastforce</span> <span class="quasi_keyword">intro</span><span class="main"><span class="main">:</span></span>edge_det<span class="main">)</span>
    <span class="keyword1"><span class="command">with</span></span> <span class="quoted"><span class="quoted">‹preds <span class="main">(</span>kinds <span class="free">as</span><span class="main">)</span> <span class="free">s</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="free">as</span> <span class="main">=</span> <span class="skolem">x</span><span class="main">#</span><span class="skolem">xs</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">xs</span> <span class="main">=</span> <span class="main">[]</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="free">kind</span> <span class="skolem">z</span> <span class="main">=</span> <span class="main">(</span><span class="main">λ</span><span class="bound">s</span><span class="main">.</span> False<span class="main">)<span class="hidden">⇩</span><sub>√</sub></span>›</span></span> 
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted">False</span> <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span>kinds_def<span class="main">)</span>
    <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">qed</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">with</span></span> <span class="quoted"><span class="quoted">‹<span class="free">targetnode</span> <span class="skolem">x</span> <span class="main">-</span><span class="skolem">xs</span><span class="main">→*</span> <span class="keyword1"><span class="free">(_Exit_)</span></span>›</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">x'</span></span> <span class="skolem"><span class="skolem">xs'</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">xs</span> <span class="main">=</span> <span class="skolem">xs'</span><span class="main">@</span><span class="main">[</span><span class="skolem">x'</span><span class="main">]</span>"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">targetnode</span> <span class="skolem">x</span> <span class="main">-</span><span class="skolem">xs'</span><span class="main">→*</span> <span class="keyword1"><span class="free">(_Low_)</span></span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">kind</span> <span class="skolem">x'</span> <span class="main">=</span> <span class="main">(</span><span class="main">λ</span><span class="bound">s</span><span class="main">.</span> True<span class="main">)<span class="hidden">⇩</span><sub>√</sub></span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">fastforce</span> <span class="quasi_keyword">elim</span><span class="main"><span class="main">:</span></span>Exit_path_Low_path<span class="main">)</span>
  <span class="keyword1"><span class="command">with</span></span> <span class="quoted"><span class="quoted">‹<span class="keyword1"><span class="free">(_Entry_)</span></span> <span class="main">=</span> <span class="free">sourcenode</span> <span class="skolem">x</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="free">valid_edge</span> <span class="skolem">x</span>›</span></span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1"><span class="free">(_Entry_)</span></span> <span class="main">-</span><span class="skolem">x</span><span class="main">#</span><span class="skolem">xs'</span><span class="main">→*</span> <span class="keyword1"><span class="free">(_Low_)</span></span>"</span></span> <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">fastforce</span> <span class="quasi_keyword">intro</span><span class="main"><span class="main">:</span></span>Cons_path<span class="main">)</span>
  <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="free">as</span> <span class="main">=</span> <span class="skolem">x</span><span class="main">#</span><span class="skolem">xs</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">xs</span> <span class="main">=</span> <span class="skolem">xs'</span><span class="main">@</span><span class="main">[</span><span class="skolem">x'</span><span class="main">]</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">as</span> <span class="main">=</span> <span class="main">(</span><span class="skolem">x</span><span class="main">#</span><span class="skolem">xs'</span><span class="main">)</span><span class="main">@</span><span class="main">[</span><span class="skolem">x'</span><span class="main">]</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">with</span></span> <span class="quoted"><span class="quoted">‹preds <span class="main">(</span>kinds <span class="free">as</span><span class="main">)</span> <span class="free">s</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"preds <span class="main">(</span>kinds <span class="main">(</span><span class="skolem">x</span><span class="main">#</span><span class="skolem">xs'</span><span class="main">)</span><span class="main">)</span> <span class="free">s</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span>kinds_def preds_split<span class="main">)</span>
  <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="keyword1"><span class="free">(_Entry_)</span></span> <span class="main">-</span><span class="free">as'</span><span class="main">→*</span> <span class="keyword1"><span class="free">(_Exit_)</span></span>›</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">y</span></span> <span class="skolem"><span class="skolem">ys</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="free">as'</span> <span class="main">=</span> <span class="skolem">y</span><span class="main">#</span><span class="skolem">ys</span>"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1"><span class="free">(_Entry_)</span></span> <span class="main">=</span> <span class="free">sourcenode</span> <span class="skolem">y</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">valid_edge</span> <span class="skolem">y</span>"</span></span> 
    <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">targetnode</span> <span class="skolem">y</span> <span class="main">-</span><span class="skolem">ys</span><span class="main">→*</span> <span class="keyword1"><span class="free">(_Exit_)</span></span>"</span></span>
    <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="main">(</span><span class="operator">cases</span> <span class="quoted"><span class="quoted">"<span class="free">as'</span> <span class="main">=</span> <span class="main">[]</span>"</span></span><span class="main">)</span>
     <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="main">(</span><span class="operator">simp</span><span class="main"><span class="keyword3">,</span></span><span class="operator">drule</span> empty_path_nodes<span class="main"><span class="keyword3">,</span></span><span class="operator">drule</span> Entry_noteq_Exit<span class="main"><span class="keyword3">,</span></span><span class="operator">simp</span><span class="main">)</span>
    <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">erule</span> path_split_Cons<span class="main">)</span>
  <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="free">valid_edge</span> <span class="skolem">y</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"valid_node <span class="main">(</span><span class="free">targetnode</span> <span class="skolem">y</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"inner_node <span class="main">(</span><span class="free">targetnode</span> <span class="skolem">y</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span><span class="main">(</span><span class="operator">cases</span> <span class="quasi_keyword">rule</span><span class="main"><span class="main">:</span></span>valid_node_cases<span class="main">)</span>
    <span class="keyword3"><span class="command">case</span></span> Entry
    <span class="keyword1"><span class="command">with</span></span> <span class="quoted"><span class="quoted">‹<span class="free">valid_edge</span> <span class="skolem">y</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted">False</span> <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">rule</span> Entry_target<span class="main">)</span>
    <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">next</span></span>
    <span class="keyword3"><span class="command">case</span></span> Exit
    <span class="keyword1"><span class="command">with</span></span> <span class="quoted"><span class="quoted">‹<span class="free">targetnode</span> <span class="skolem">y</span> <span class="main">-</span><span class="skolem">ys</span><span class="main">→*</span> <span class="keyword1"><span class="free">(_Exit_)</span></span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">ys</span> <span class="main">=</span> <span class="main">[]</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">-</span><span class="main">(</span><span class="operator">rule</span> path_Exit_source<span class="main"><span class="keyword3">,</span></span><span class="operator">simp</span><span class="main">)</span>
    <span class="keyword1"><span class="command">from</span></span> Entry_Exit_edge <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">z</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="free">valid_edge</span> <span class="skolem">z</span>"</span></span>
      <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">sourcenode</span> <span class="skolem">z</span> <span class="main">=</span> <span class="keyword1"><span class="free">(_Entry_)</span></span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">targetnode</span> <span class="skolem">z</span> <span class="main">=</span> <span class="keyword1"><span class="free">(_Exit_)</span></span>"</span></span>
      <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">kind</span> <span class="skolem">z</span> <span class="main">=</span> <span class="main">(</span><span class="main">λ</span><span class="bound">s</span><span class="main">.</span> False<span class="main">)<span class="hidden">⇩</span><sub>√</sub></span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
    <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="free">valid_edge</span> <span class="skolem">y</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="free">valid_edge</span> <span class="skolem">z</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="keyword1"><span class="free">(_Entry_)</span></span> <span class="main">=</span> <span class="free">sourcenode</span> <span class="skolem">y</span>›</span></span> 
      <span class="quoted"><span class="quoted">‹<span class="free">sourcenode</span> <span class="skolem">z</span> <span class="main">=</span> <span class="keyword1"><span class="free">(_Entry_)</span></span>›</span></span> Exit <span class="quoted"><span class="quoted">‹<span class="free">targetnode</span> <span class="skolem">z</span> <span class="main">=</span> <span class="keyword1"><span class="free">(_Exit_)</span></span>›</span></span>
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">y</span> <span class="main">=</span> <span class="skolem">z</span>"</span></span> <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">fastforce</span> <span class="quasi_keyword">intro</span><span class="main"><span class="main">:</span></span>edge_det<span class="main">)</span>
    <span class="keyword1"><span class="command">with</span></span> <span class="quoted"><span class="quoted">‹preds <span class="main">(</span>kinds <span class="free">as'</span><span class="main">)</span> <span class="free">s'</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="free">as'</span> <span class="main">=</span> <span class="skolem">y</span><span class="main">#</span><span class="skolem">ys</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">ys</span> <span class="main">=</span> <span class="main">[]</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="free">kind</span> <span class="skolem">z</span> <span class="main">=</span> <span class="main">(</span><span class="main">λ</span><span class="bound">s</span><span class="main">.</span> False<span class="main">)<span class="hidden">⇩</span><sub>√</sub></span>›</span></span> 
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted">False</span> <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span>kinds_def<span class="main">)</span>
    <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">qed</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">with</span></span> <span class="quoted"><span class="quoted">‹<span class="free">targetnode</span> <span class="skolem">y</span> <span class="main">-</span><span class="skolem">ys</span><span class="main">→*</span> <span class="keyword1"><span class="free">(_Exit_)</span></span>›</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">y'</span></span> <span class="skolem"><span class="skolem">ys'</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">ys</span> <span class="main">=</span> <span class="skolem">ys'</span><span class="main">@</span><span class="main">[</span><span class="skolem">y'</span><span class="main">]</span>"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">targetnode</span> <span class="skolem">y</span> <span class="main">-</span><span class="skolem">ys'</span><span class="main">→*</span> <span class="keyword1"><span class="free">(_Low_)</span></span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">kind</span> <span class="skolem">y'</span> <span class="main">=</span> <span class="main">(</span><span class="main">λ</span><span class="bound">s</span><span class="main">.</span> True<span class="main">)<span class="hidden">⇩</span><sub>√</sub></span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">fastforce</span> <span class="quasi_keyword">elim</span><span class="main"><span class="main">:</span></span>Exit_path_Low_path<span class="main">)</span>
  <span class="keyword1"><span class="command">with</span></span> <span class="quoted"><span class="quoted">‹<span class="keyword1"><span class="free">(_Entry_)</span></span> <span class="main">=</span> <span class="free">sourcenode</span> <span class="skolem">y</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="free">valid_edge</span> <span class="skolem">y</span>›</span></span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1"><span class="free">(_Entry_)</span></span> <span class="main">-</span><span class="skolem">y</span><span class="main">#</span><span class="skolem">ys'</span><span class="main">→*</span> <span class="keyword1"><span class="free">(_Low_)</span></span>"</span></span> <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">fastforce</span> <span class="quasi_keyword">intro</span><span class="main"><span class="main">:</span></span>Cons_path<span class="main">)</span>
  <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="free">as'</span> <span class="main">=</span> <span class="skolem">y</span><span class="main">#</span><span class="skolem">ys</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">ys</span> <span class="main">=</span> <span class="skolem">ys'</span><span class="main">@</span><span class="main">[</span><span class="skolem">y'</span><span class="main">]</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">as'</span> <span class="main">=</span> <span class="main">(</span><span class="skolem">y</span><span class="main">#</span><span class="skolem">ys'</span><span class="main">)</span><span class="main">@</span><span class="main">[</span><span class="skolem">y'</span><span class="main">]</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">with</span></span> <span class="quoted"><span class="quoted">‹preds <span class="main">(</span>kinds <span class="free">as'</span><span class="main">)</span> <span class="free">s'</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"preds <span class="main">(</span>kinds <span class="main">(</span><span class="skolem">y</span><span class="main">#</span><span class="skolem">ys'</span><span class="main">)</span><span class="main">)</span> <span class="free">s'</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span>kinds_def preds_split<span class="main">)</span>
  <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="free">s</span> <span class="keyword1">≈<span class="hidden">⇩</span><sub>L</sub></span> <span class="free">s'</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="keyword1"><span class="free">(_High_)</span></span> <span class="main">∉</span> <span class="free">backward_slice</span> <span class="free">S</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="keyword1"><span class="free">(_Low_)</span></span> <span class="main">∈</span> <span class="free">S</span>›</span></span>
    <span class="quoted"><span class="quoted">‹<span class="keyword1"><span class="free">(_Entry_)</span></span> <span class="main">-</span><span class="skolem">x</span><span class="main">#</span><span class="skolem">xs'</span><span class="main">→*</span> <span class="keyword1"><span class="free">(_Low_)</span></span>›</span></span> <span class="quoted"><span class="quoted">‹preds <span class="main">(</span>kinds <span class="main">(</span><span class="skolem">x</span><span class="main">#</span><span class="skolem">xs'</span><span class="main">)</span><span class="main">)</span> <span class="free">s</span>›</span></span>
    <span class="quoted"><span class="quoted">‹<span class="keyword1"><span class="free">(_Entry_)</span></span> <span class="main">-</span><span class="skolem">y</span><span class="main">#</span><span class="skolem">ys'</span><span class="main">→*</span> <span class="keyword1"><span class="free">(_Low_)</span></span>›</span></span> <span class="quoted"><span class="quoted">‹preds <span class="main">(</span>kinds <span class="main">(</span><span class="skolem">y</span><span class="main">#</span><span class="skolem">ys'</span><span class="main">)</span><span class="main">)</span> <span class="free">s'</span>›</span></span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"transfers <span class="main">(</span>kinds <span class="main">(</span><span class="skolem">x</span><span class="main">#</span><span class="skolem">xs'</span><span class="main">)</span><span class="main">)</span> <span class="free">s</span> <span class="keyword1">≈<span class="hidden">⇩</span><sub>L</sub></span> transfers <span class="main">(</span>kinds <span class="main">(</span><span class="skolem">y</span><span class="main">#</span><span class="skolem">ys'</span><span class="main">)</span><span class="main">)</span> <span class="free">s'</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">rule</span> nonInterference_path_to_Low<span class="main">)</span>
  <span class="keyword1"><span class="command">with</span></span> <span class="quoted"><span class="quoted">‹<span class="free">as</span> <span class="main">=</span> <span class="skolem">x</span><span class="main">#</span><span class="skolem">xs</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">xs</span> <span class="main">=</span> <span class="skolem">xs'</span><span class="main">@</span><span class="main">[</span><span class="skolem">x'</span><span class="main">]</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="free">kind</span> <span class="skolem">x'</span> <span class="main">=</span> <span class="main">(</span><span class="main">λ</span><span class="bound">s</span><span class="main">.</span> True<span class="main">)<span class="hidden">⇩</span><sub>√</sub></span>›</span></span>
    <span class="quoted"><span class="quoted">‹<span class="free">as'</span> <span class="main">=</span> <span class="skolem">y</span><span class="main">#</span><span class="skolem">ys</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">ys</span> <span class="main">=</span> <span class="skolem">ys'</span><span class="main">@</span><span class="main">[</span><span class="skolem">y'</span><span class="main">]</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="free">kind</span> <span class="skolem">y'</span> <span class="main">=</span> <span class="main">(</span><span class="main">λ</span><span class="bound">s</span><span class="main">.</span> True<span class="main">)<span class="hidden">⇩</span><sub>√</sub></span>›</span></span>
  <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span>kinds_def transfers_split<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>


<span class="keyword2"><span class="keyword">end</span></span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹The second theorem assumes that we have a operational semantics,
whose evaluations are written <span class="antiquoted"><span class="raw_text"><span class="antiquoted"><span class="raw_text"><span class="operator"><span class="operator">‹</span></span>⟨c,s⟩ ⇒ ⟨c',s'⟩›</span></span></span></span> and which conforms 
to the CFG. The correctness theorem then states that if no high variable
influenced a low variable and the initial states were low equivalent, the
reulting states are again low equivalent:›</span></span>


<span class="keyword1"><span class="command">locale</span></span> NonInterferenceIntra <span class="main">=</span> 
  NonInterferenceIntraGraph <span class="quoted"><span class="free">sourcenode</span></span> <span class="quoted"><span class="free">targetnode</span></span> <span class="quoted"><span class="free">kind</span></span> <span class="quoted"><span class="free">valid_edge</span></span> <span class="quoted"><span class="free">Entry</span></span> 
    <span class="quoted"><span class="free">Def</span></span> <span class="quoted"><span class="free">Use</span></span> <span class="quoted"><span class="free">state_val</span></span> <span class="quoted"><span class="free">backward_slice</span></span> <span class="quoted"><span class="free">Exit</span></span> <span class="quoted"><span class="free">H</span></span> <span class="quoted"><span class="free">L</span></span> <span class="quoted"><span class="free">High</span></span> <span class="quoted"><span class="free">Low</span></span> <span class="main">+</span>
  BackwardSlice_wf <span class="quoted"><span class="free">sourcenode</span></span> <span class="quoted"><span class="free">targetnode</span></span> <span class="quoted"><span class="free">kind</span></span> <span class="quoted"><span class="free">valid_edge</span></span> <span class="quoted"><span class="free">Entry</span></span> <span class="quoted"><span class="free">Def</span></span> <span class="quoted"><span class="free">Use</span></span> <span class="quoted"><span class="free">state_val</span></span> 
    <span class="quoted"><span class="free">backward_slice</span></span> <span class="quoted"><span class="free">sem</span></span> <span class="quoted"><span class="free">identifies</span></span>
  <span class="keyword2"><span class="keyword">for</span></span> <span class="free">sourcenode</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'edge</span> <span class="main">⇒</span> <span class="tfree">'node</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="free">targetnode</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'edge</span> <span class="main">⇒</span> <span class="tfree">'node</span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> <span class="free">kind</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'edge</span> <span class="main">⇒</span> <span class="tfree">'state</span> edge_kind"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="free">valid_edge</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'edge</span> <span class="main">⇒</span> bool"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> <span class="free">Entry</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'node</span>"</span></span> <span class="main">(</span><span class="quoted">"<span class="keyword1">'('_Entry'_')</span>"</span><span class="main">)</span> <span class="keyword2"><span class="keyword">and</span></span> <span class="free">Def</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'node</span> <span class="main">⇒</span> <span class="tfree">'var</span> set"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> <span class="free">Use</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'node</span> <span class="main">⇒</span> <span class="tfree">'var</span> set"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="free">state_val</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'state</span> <span class="main">⇒</span> <span class="tfree">'var</span> <span class="main">⇒</span> <span class="tfree">'val</span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> <span class="free">backward_slice</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'node</span> set <span class="main">⇒</span> <span class="tfree">'node</span> set"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> <span class="free">sem</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'com</span> <span class="main">⇒</span> <span class="tfree">'state</span> <span class="main">⇒</span> <span class="tfree">'com</span> <span class="main">⇒</span> <span class="tfree">'state</span> <span class="main">⇒</span> bool"</span></span> 
    <span class="main">(</span><span class="quoted">"<span class="keyword3">(</span><span class="keyword3">(1</span><span class="keyword1">⟨</span>_<span class="keyword1">,</span><span class="keyword3">/</span>_<span class="keyword1">⟩</span><span class="keyword3">)</span> <span class="keyword1">⇒</span><span class="keyword3">/ </span><span class="keyword3">(1</span><span class="keyword1">⟨</span>_<span class="keyword1">,</span><span class="keyword3">/</span>_<span class="keyword1">⟩</span><span class="keyword3">)</span><span class="keyword3">)</span>"</span> <span class="main">[</span>0<span class="main">,</span>0<span class="main">,</span>0<span class="main">,</span>0<span class="main">]</span> 81<span class="main">)</span>
  <span class="keyword2"><span class="keyword">and</span></span> <span class="free">identifies</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'node</span> <span class="main">⇒</span> <span class="tfree">'com</span> <span class="main">⇒</span> bool"</span></span> <span class="main">(</span><span class="quoted">"_ <span class="keyword1">≜</span> _"</span> <span class="main">[</span>51<span class="main">,</span> 0<span class="main">]</span> 80<span class="main">)</span>
  <span class="keyword2"><span class="keyword">and</span></span> <span class="free">Exit</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'node</span>"</span></span> <span class="main">(</span><span class="quoted">"<span class="keyword1">'('_Exit'_')</span>"</span><span class="main">)</span>
  <span class="keyword2"><span class="keyword">and</span></span> <span class="free">H</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'var</span> set"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="free">L</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'var</span> set"</span></span> 
  <span class="keyword2"><span class="keyword">and</span></span> <span class="free">High</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'node</span>"</span></span>  <span class="main">(</span><span class="quoted">"<span class="keyword1">'('_High'_')</span>"</span><span class="main">)</span> <span class="keyword2"><span class="keyword">and</span></span> <span class="free">Low</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'node</span>"</span></span>   <span class="main">(</span><span class="quoted">"<span class="keyword1">'('_Low'_')</span>"</span><span class="main">)</span> <span class="main">+</span>
  <span class="keyword2"><span class="keyword">fixes</span></span> <span class="free">final</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'com</span> <span class="main">⇒</span> bool"</span></span>
  <span class="keyword2"><span class="keyword">assumes</span></span> final_edge_Low<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">⟦</span><span class="free">final</span> <span class="free">c</span><span class="main">;</span> <span class="free">n</span> <span class="main"><span class="free">≜</span></span> <span class="free">c</span><span class="main">⟧</span> 
  <span class="main">⟹</span> <span class="main">∃</span><span class="bound">a</span><span class="main">.</span> <span class="free">valid_edge</span> <span class="bound">a</span> <span class="main">∧</span> <span class="free">sourcenode</span> <span class="bound">a</span> <span class="main">=</span> <span class="free">n</span> <span class="main">∧</span> <span class="free">targetnode</span> <span class="bound">a</span> <span class="main">=</span> <span class="keyword1"><span class="free">(_Low_)</span></span> <span class="main">∧</span> <span class="free">kind</span> <span class="bound">a</span> <span class="main">=</span> <span class="main">⇑</span>id"</span></span>
<span class="keyword2"><span class="keyword">begin</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹The following theorem needs the explicit edge from <span class="antiquoted"><span class="raw_text"><span class="antiquoted"><span class="raw_text"><span class="operator"><span class="operator">‹</span></span>(_High_)›</span></span></span></span>
  to <span class="antiquoted"><span class="raw_text"><span class="antiquoted"><span class="raw_text"><span class="operator"><span class="operator">‹</span></span>n›</span></span></span></span>. An approach using a <span class="antiquoted"><span class="raw_text"><span class="antiquoted"><span class="raw_text"><span class="operator"><span class="operator">‹</span></span>init›</span></span></span></span> predicate for initial statements,
  being reachable from <span class="antiquoted"><span class="raw_text"><span class="antiquoted"><span class="raw_text"><span class="operator"><span class="operator">‹</span></span>(_High_)›</span></span></span></span> via a <span class="antiquoted"><span class="raw_text"><span class="antiquoted"><span class="raw_text"><span class="operator"><span class="operator">‹</span></span>(λs. True)<span class="hidden">⇩</span><sub>√</sub>›</span></span></span></span> edge,
  does not work as the same statement could be identified by several nodes, some
  initial, some not. E.g., in the program \texttt{while (True) Skip;;Skip}
  two nodes identify this inital statement: the initial node and the node
  within the loop (because of loop unrolling).›</span></span>

<span class="keyword1"><span class="command">theorem</span></span> nonInterference<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">s<span class="hidden">⇩</span><sub>1</sub></span> <span class="keyword1">≈<span class="hidden">⇩</span><sub>L</sub></span> <span class="free">s<span class="hidden">⇩</span><sub>2</sub></span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1"><span class="free">(_High_)</span></span> <span class="main">∉</span> <span class="free">backward_slice</span> <span class="free">S</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1"><span class="free">(_Low_)</span></span> <span class="main">∈</span> <span class="free">S</span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">valid_edge</span> <span class="free">a</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">sourcenode</span> <span class="free">a</span> <span class="main">=</span> <span class="keyword1"><span class="free">(_High_)</span></span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">targetnode</span> <span class="free">a</span> <span class="main">=</span> <span class="free">n</span>"</span></span> 
  <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">kind</span> <span class="free">a</span> <span class="main">=</span> <span class="main">(</span><span class="main">λ</span><span class="bound">s</span><span class="main">.</span> True<span class="main">)<span class="hidden">⇩</span><sub>√</sub></span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">n</span> <span class="main"><span class="free">≜</span></span> <span class="free">c</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">final</span> <span class="free">c'</span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main"><span class="free">⟨</span></span><span class="free">c</span><span class="main"><span class="free">,</span></span><span class="free">s<span class="hidden">⇩</span><sub>1</sub></span><span class="main"><span class="free">⟩</span></span> <span class="main"><span class="free">⇒</span></span> <span class="main"><span class="free">⟨</span></span><span class="free">c'</span><span class="main"><span class="free">,</span></span><span class="free">s<span class="hidden">⇩</span><sub>1</sub>'</span><span class="main"><span class="free">⟩</span></span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main"><span class="free">⟨</span></span><span class="free">c</span><span class="main"><span class="free">,</span></span><span class="free">s<span class="hidden">⇩</span><sub>2</sub></span><span class="main"><span class="free">⟩</span></span> <span class="main"><span class="free">⇒</span></span> <span class="main"><span class="free">⟨</span></span><span class="free">c'</span><span class="main"><span class="free">,</span></span><span class="free">s<span class="hidden">⇩</span><sub>2</sub>'</span><span class="main"><span class="free">⟩</span></span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">s<span class="hidden">⇩</span><sub>1</sub>'</span> <span class="keyword1">≈<span class="hidden">⇩</span><sub>L</sub></span> <span class="free">s<span class="hidden">⇩</span><sub>2</sub>'</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">from</span></span> High_target_Entry_edge <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">ax</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="free">valid_edge</span> <span class="skolem">ax</span>"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">sourcenode</span> <span class="skolem">ax</span> <span class="main">=</span> <span class="keyword1"><span class="free">(_Entry_)</span></span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">targetnode</span> <span class="skolem">ax</span> <span class="main">=</span> <span class="keyword1"><span class="free">(_High_)</span></span>"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">kind</span> <span class="skolem">ax</span> <span class="main">=</span> <span class="main">(</span><span class="main">λ</span><span class="bound">s</span><span class="main">.</span> True<span class="main">)<span class="hidden">⇩</span><sub>√</sub></span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="free">n</span> <span class="main"><span class="free">≜</span></span> <span class="free">c</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="main"><span class="free">⟨</span></span><span class="free">c</span><span class="main"><span class="free">,</span></span><span class="free">s<span class="hidden">⇩</span><sub>1</sub></span><span class="main"><span class="free">⟩</span></span> <span class="main"><span class="free">⇒</span></span> <span class="main"><span class="free">⟨</span></span><span class="free">c'</span><span class="main"><span class="free">,</span></span><span class="free">s<span class="hidden">⇩</span><sub>1</sub>'</span><span class="main"><span class="free">⟩</span></span>›</span></span>
  <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">n<span class="hidden">⇩</span><sub>1</sub></span></span> <span class="skolem"><span class="skolem">as<span class="hidden">⇩</span><sub>1</sub></span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="free">n</span> <span class="main">-</span><span class="skolem">as<span class="hidden">⇩</span><sub>1</sub></span><span class="main">→*</span> <span class="skolem">n<span class="hidden">⇩</span><sub>1</sub></span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"transfers <span class="main">(</span>kinds <span class="skolem">as<span class="hidden">⇩</span><sub>1</sub></span><span class="main">)</span> <span class="free">s<span class="hidden">⇩</span><sub>1</sub></span> <span class="main">=</span> <span class="free">s<span class="hidden">⇩</span><sub>1</sub>'</span>"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"preds <span class="main">(</span>kinds <span class="skolem">as<span class="hidden">⇩</span><sub>1</sub></span><span class="main">)</span> <span class="free">s<span class="hidden">⇩</span><sub>1</sub></span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">n<span class="hidden">⇩</span><sub>1</sub></span> <span class="main"><span class="free">≜</span></span> <span class="free">c'</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">fastforce</span> <span class="quasi_keyword">dest</span><span class="main"><span class="main">:</span></span>fundamental_property<span class="main">)</span>
  <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="free">n</span> <span class="main">-</span><span class="skolem">as<span class="hidden">⇩</span><sub>1</sub></span><span class="main">→*</span> <span class="skolem">n<span class="hidden">⇩</span><sub>1</sub></span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="free">valid_edge</span> <span class="free">a</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="free">sourcenode</span> <span class="free">a</span> <span class="main">=</span> <span class="keyword1"><span class="free">(_High_)</span></span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="free">targetnode</span> <span class="free">a</span> <span class="main">=</span> <span class="free">n</span>›</span></span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1"><span class="free">(_High_)</span></span> <span class="main">-</span><span class="free">a</span><span class="main">#</span><span class="skolem">as<span class="hidden">⇩</span><sub>1</sub></span><span class="main">→*</span> <span class="skolem">n<span class="hidden">⇩</span><sub>1</sub></span>"</span></span> <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">rule</span> Cons_path<span class="main">)</span>
  <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="free">final</span> <span class="free">c'</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">n<span class="hidden">⇩</span><sub>1</sub></span> <span class="main"><span class="free">≜</span></span> <span class="free">c'</span>›</span></span>
  <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">a<span class="hidden">⇩</span><sub>1</sub></span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="free">valid_edge</span> <span class="skolem">a<span class="hidden">⇩</span><sub>1</sub></span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">sourcenode</span> <span class="skolem">a<span class="hidden">⇩</span><sub>1</sub></span> <span class="main">=</span> <span class="skolem">n<span class="hidden">⇩</span><sub>1</sub></span>"</span></span> 
    <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">targetnode</span> <span class="skolem">a<span class="hidden">⇩</span><sub>1</sub></span> <span class="main">=</span> <span class="keyword1"><span class="free">(_Low_)</span></span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">kind</span> <span class="skolem">a<span class="hidden">⇩</span><sub>1</sub></span> <span class="main">=</span> <span class="main">⇑</span>id"</span></span> <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">fastforce</span> <span class="quasi_keyword">dest</span><span class="main"><span class="main">:</span></span>final_edge_Low<span class="main">)</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">n<span class="hidden">⇩</span><sub>1</sub></span> <span class="main">-</span><span class="main">[</span><span class="skolem">a<span class="hidden">⇩</span><sub>1</sub></span><span class="main">]</span><span class="main">→*</span> <span class="keyword1"><span class="free">(_Low_)</span></span>"</span></span> <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">fastforce</span> <span class="quasi_keyword">intro</span><span class="main"><span class="main">:</span></span>path_edge<span class="main">)</span>
  <span class="keyword1"><span class="command">with</span></span> <span class="quoted"><span class="quoted">‹<span class="keyword1"><span class="free">(_High_)</span></span> <span class="main">-</span><span class="free">a</span><span class="main">#</span><span class="skolem">as<span class="hidden">⇩</span><sub>1</sub></span><span class="main">→*</span> <span class="skolem">n<span class="hidden">⇩</span><sub>1</sub></span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1"><span class="free">(_High_)</span></span> <span class="main">-</span><span class="main">(</span><span class="free">a</span><span class="main">#</span><span class="skolem">as<span class="hidden">⇩</span><sub>1</sub></span><span class="main">)</span><span class="main">@</span><span class="main">[</span><span class="skolem">a<span class="hidden">⇩</span><sub>1</sub></span><span class="main">]</span><span class="main">→*</span> <span class="keyword1"><span class="free">(_Low_)</span></span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">rule</span> path_Append<span class="main">)</span>
  <span class="keyword1"><span class="command">with</span></span> <span class="quoted"><span class="quoted">‹<span class="free">valid_edge</span> <span class="skolem">ax</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="free">sourcenode</span> <span class="skolem">ax</span> <span class="main">=</span> <span class="keyword1"><span class="free">(_Entry_)</span></span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="free">targetnode</span> <span class="skolem">ax</span> <span class="main">=</span> <span class="keyword1"><span class="free">(_High_)</span></span>›</span></span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1"><span class="free">(_Entry_)</span></span> <span class="main">-</span><span class="skolem">ax</span><span class="main">#</span><span class="main">(</span><span class="main">(</span><span class="free">a</span><span class="main">#</span><span class="skolem">as<span class="hidden">⇩</span><sub>1</sub></span><span class="main">)</span><span class="main">@</span><span class="main">[</span><span class="skolem">a<span class="hidden">⇩</span><sub>1</sub></span><span class="main">]</span><span class="main">)</span><span class="main">→*</span> <span class="keyword1"><span class="free">(_Low_)</span></span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">-</span><span class="main">(</span><span class="operator">rule</span> Cons_path<span class="main">)</span>
  <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="free">kind</span> <span class="skolem">ax</span> <span class="main">=</span> <span class="main">(</span><span class="main">λ</span><span class="bound">s</span><span class="main">.</span> True<span class="main">)<span class="hidden">⇩</span><sub>√</sub></span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="free">kind</span> <span class="free">a</span> <span class="main">=</span> <span class="main">(</span><span class="main">λ</span><span class="bound">s</span><span class="main">.</span> True<span class="main">)<span class="hidden">⇩</span><sub>√</sub></span>›</span></span> <span class="quoted"><span class="quoted">‹preds <span class="main">(</span>kinds <span class="skolem">as<span class="hidden">⇩</span><sub>1</sub></span><span class="main">)</span> <span class="free">s<span class="hidden">⇩</span><sub>1</sub></span>›</span></span>
    <span class="quoted"><span class="quoted">‹<span class="free">kind</span> <span class="skolem">a<span class="hidden">⇩</span><sub>1</sub></span> <span class="main">=</span> <span class="main">⇑</span>id›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"preds <span class="main">(</span>kinds <span class="main">(</span><span class="skolem">ax</span><span class="main">#</span><span class="main">(</span><span class="main">(</span><span class="free">a</span><span class="main">#</span><span class="skolem">as<span class="hidden">⇩</span><sub>1</sub></span><span class="main">)</span><span class="main">@</span><span class="main">[</span><span class="skolem">a<span class="hidden">⇩</span><sub>1</sub></span><span class="main">]</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="free">s<span class="hidden">⇩</span><sub>1</sub></span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span>kinds_def preds_split<span class="main">)</span>
  <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="free">n</span> <span class="main"><span class="free">≜</span></span> <span class="free">c</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="main"><span class="free">⟨</span></span><span class="free">c</span><span class="main"><span class="free">,</span></span><span class="free">s<span class="hidden">⇩</span><sub>2</sub></span><span class="main"><span class="free">⟩</span></span> <span class="main"><span class="free">⇒</span></span> <span class="main"><span class="free">⟨</span></span><span class="free">c'</span><span class="main"><span class="free">,</span></span><span class="free">s<span class="hidden">⇩</span><sub>2</sub>'</span><span class="main"><span class="free">⟩</span></span>›</span></span>
  <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">n<span class="hidden">⇩</span><sub>2</sub></span></span> <span class="skolem"><span class="skolem">as<span class="hidden">⇩</span><sub>2</sub></span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="free">n</span> <span class="main">-</span><span class="skolem">as<span class="hidden">⇩</span><sub>2</sub></span><span class="main">→*</span> <span class="skolem">n<span class="hidden">⇩</span><sub>2</sub></span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"transfers <span class="main">(</span>kinds <span class="skolem">as<span class="hidden">⇩</span><sub>2</sub></span><span class="main">)</span> <span class="free">s<span class="hidden">⇩</span><sub>2</sub></span> <span class="main">=</span> <span class="free">s<span class="hidden">⇩</span><sub>2</sub>'</span>"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"preds <span class="main">(</span>kinds <span class="skolem">as<span class="hidden">⇩</span><sub>2</sub></span><span class="main">)</span> <span class="free">s<span class="hidden">⇩</span><sub>2</sub></span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">n<span class="hidden">⇩</span><sub>2</sub></span> <span class="main"><span class="free">≜</span></span> <span class="free">c'</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">fastforce</span> <span class="quasi_keyword">dest</span><span class="main"><span class="main">:</span></span>fundamental_property<span class="main">)</span>
  <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="free">n</span> <span class="main">-</span><span class="skolem">as<span class="hidden">⇩</span><sub>2</sub></span><span class="main">→*</span> <span class="skolem">n<span class="hidden">⇩</span><sub>2</sub></span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="free">valid_edge</span> <span class="free">a</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="free">sourcenode</span> <span class="free">a</span> <span class="main">=</span> <span class="keyword1"><span class="free">(_High_)</span></span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="free">targetnode</span> <span class="free">a</span> <span class="main">=</span> <span class="free">n</span>›</span></span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1"><span class="free">(_High_)</span></span> <span class="main">-</span><span class="free">a</span><span class="main">#</span><span class="skolem">as<span class="hidden">⇩</span><sub>2</sub></span><span class="main">→*</span> <span class="skolem">n<span class="hidden">⇩</span><sub>2</sub></span>"</span></span> <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">rule</span> Cons_path<span class="main">)</span>
  <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="free">final</span> <span class="free">c'</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">n<span class="hidden">⇩</span><sub>2</sub></span> <span class="main"><span class="free">≜</span></span> <span class="free">c'</span>›</span></span>
  <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">a<span class="hidden">⇩</span><sub>2</sub></span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="free">valid_edge</span> <span class="skolem">a<span class="hidden">⇩</span><sub>2</sub></span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">sourcenode</span> <span class="skolem">a<span class="hidden">⇩</span><sub>2</sub></span> <span class="main">=</span> <span class="skolem">n<span class="hidden">⇩</span><sub>2</sub></span>"</span></span> 
    <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">targetnode</span> <span class="skolem">a<span class="hidden">⇩</span><sub>2</sub></span> <span class="main">=</span> <span class="keyword1"><span class="free">(_Low_)</span></span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">kind</span> <span class="skolem">a<span class="hidden">⇩</span><sub>2</sub></span> <span class="main">=</span> <span class="main">⇑</span>id"</span></span> <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">fastforce</span> <span class="quasi_keyword">dest</span><span class="main"><span class="main">:</span></span>final_edge_Low<span class="main">)</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">n<span class="hidden">⇩</span><sub>2</sub></span> <span class="main">-</span><span class="main">[</span><span class="skolem">a<span class="hidden">⇩</span><sub>2</sub></span><span class="main">]</span><span class="main">→*</span> <span class="keyword1"><span class="free">(_Low_)</span></span>"</span></span> <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">fastforce</span> <span class="quasi_keyword">intro</span><span class="main"><span class="main">:</span></span>path_edge<span class="main">)</span>
  <span class="keyword1"><span class="command">with</span></span> <span class="quoted"><span class="quoted">‹<span class="keyword1"><span class="free">(_High_)</span></span> <span class="main">-</span><span class="free">a</span><span class="main">#</span><span class="skolem">as<span class="hidden">⇩</span><sub>2</sub></span><span class="main">→*</span> <span class="skolem">n<span class="hidden">⇩</span><sub>2</sub></span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1"><span class="free">(_High_)</span></span> <span class="main">-</span><span class="main">(</span><span class="free">a</span><span class="main">#</span><span class="skolem">as<span class="hidden">⇩</span><sub>2</sub></span><span class="main">)</span><span class="main">@</span><span class="main">[</span><span class="skolem">a<span class="hidden">⇩</span><sub>2</sub></span><span class="main">]</span><span class="main">→*</span> <span class="keyword1"><span class="free">(_Low_)</span></span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">rule</span> path_Append<span class="main">)</span>
  <span class="keyword1"><span class="command">with</span></span> <span class="quoted"><span class="quoted">‹<span class="free">valid_edge</span> <span class="skolem">ax</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="free">sourcenode</span> <span class="skolem">ax</span> <span class="main">=</span> <span class="keyword1"><span class="free">(_Entry_)</span></span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="free">targetnode</span> <span class="skolem">ax</span> <span class="main">=</span> <span class="keyword1"><span class="free">(_High_)</span></span>›</span></span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1"><span class="free">(_Entry_)</span></span> <span class="main">-</span><span class="skolem">ax</span><span class="main">#</span><span class="main">(</span><span class="main">(</span><span class="free">a</span><span class="main">#</span><span class="skolem">as<span class="hidden">⇩</span><sub>2</sub></span><span class="main">)</span><span class="main">@</span><span class="main">[</span><span class="skolem">a<span class="hidden">⇩</span><sub>2</sub></span><span class="main">]</span><span class="main">)</span><span class="main">→*</span> <span class="keyword1"><span class="free">(_Low_)</span></span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">-</span><span class="main">(</span><span class="operator">rule</span> Cons_path<span class="main">)</span>
  <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="free">kind</span> <span class="skolem">ax</span> <span class="main">=</span> <span class="main">(</span><span class="main">λ</span><span class="bound">s</span><span class="main">.</span> True<span class="main">)<span class="hidden">⇩</span><sub>√</sub></span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="free">kind</span> <span class="free">a</span> <span class="main">=</span> <span class="main">(</span><span class="main">λ</span><span class="bound">s</span><span class="main">.</span> True<span class="main">)<span class="hidden">⇩</span><sub>√</sub></span>›</span></span> <span class="quoted"><span class="quoted">‹preds <span class="main">(</span>kinds <span class="skolem">as<span class="hidden">⇩</span><sub>2</sub></span><span class="main">)</span> <span class="free">s<span class="hidden">⇩</span><sub>2</sub></span>›</span></span>
    <span class="quoted"><span class="quoted">‹<span class="free">kind</span> <span class="skolem">a<span class="hidden">⇩</span><sub>2</sub></span> <span class="main">=</span> <span class="main">⇑</span>id›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"preds <span class="main">(</span>kinds <span class="main">(</span><span class="skolem">ax</span><span class="main">#</span><span class="main">(</span><span class="main">(</span><span class="free">a</span><span class="main">#</span><span class="skolem">as<span class="hidden">⇩</span><sub>2</sub></span><span class="main">)</span><span class="main">@</span><span class="main">[</span><span class="skolem">a<span class="hidden">⇩</span><sub>2</sub></span><span class="main">]</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="free">s<span class="hidden">⇩</span><sub>2</sub></span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span>kinds_def preds_split<span class="main">)</span>
  <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="free">s<span class="hidden">⇩</span><sub>1</sub></span> <span class="keyword1">≈<span class="hidden">⇩</span><sub>L</sub></span> <span class="free">s<span class="hidden">⇩</span><sub>2</sub></span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="keyword1"><span class="free">(_High_)</span></span> <span class="main">∉</span> <span class="free">backward_slice</span> <span class="free">S</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="keyword1"><span class="free">(_Low_)</span></span> <span class="main">∈</span> <span class="free">S</span>›</span></span>
    <span class="quoted"><span class="quoted">‹<span class="keyword1"><span class="free">(_Entry_)</span></span> <span class="main">-</span><span class="skolem">ax</span><span class="main">#</span><span class="main">(</span><span class="main">(</span><span class="free">a</span><span class="main">#</span><span class="skolem">as<span class="hidden">⇩</span><sub>1</sub></span><span class="main">)</span><span class="main">@</span><span class="main">[</span><span class="skolem">a<span class="hidden">⇩</span><sub>1</sub></span><span class="main">]</span><span class="main">)</span><span class="main">→*</span> <span class="keyword1"><span class="free">(_Low_)</span></span>›</span></span> <span class="quoted"><span class="quoted">‹preds <span class="main">(</span>kinds <span class="main">(</span><span class="skolem">ax</span><span class="main">#</span><span class="main">(</span><span class="main">(</span><span class="free">a</span><span class="main">#</span><span class="skolem">as<span class="hidden">⇩</span><sub>1</sub></span><span class="main">)</span><span class="main">@</span><span class="main">[</span><span class="skolem">a<span class="hidden">⇩</span><sub>1</sub></span><span class="main">]</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="free">s<span class="hidden">⇩</span><sub>1</sub></span>›</span></span>
    <span class="quoted"><span class="quoted">‹<span class="keyword1"><span class="free">(_Entry_)</span></span> <span class="main">-</span><span class="skolem">ax</span><span class="main">#</span><span class="main">(</span><span class="main">(</span><span class="free">a</span><span class="main">#</span><span class="skolem">as<span class="hidden">⇩</span><sub>2</sub></span><span class="main">)</span><span class="main">@</span><span class="main">[</span><span class="skolem">a<span class="hidden">⇩</span><sub>2</sub></span><span class="main">]</span><span class="main">)</span><span class="main">→*</span> <span class="keyword1"><span class="free">(_Low_)</span></span>›</span></span> <span class="quoted"><span class="quoted">‹preds <span class="main">(</span>kinds <span class="main">(</span><span class="skolem">ax</span><span class="main">#</span><span class="main">(</span><span class="main">(</span><span class="free">a</span><span class="main">#</span><span class="skolem">as<span class="hidden">⇩</span><sub>2</sub></span><span class="main">)</span><span class="main">@</span><span class="main">[</span><span class="skolem">a<span class="hidden">⇩</span><sub>2</sub></span><span class="main">]</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="free">s<span class="hidden">⇩</span><sub>2</sub></span>›</span></span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"transfers <span class="main">(</span>kinds <span class="main">(</span><span class="skolem">ax</span><span class="main">#</span><span class="main">(</span><span class="main">(</span><span class="free">a</span><span class="main">#</span><span class="skolem">as<span class="hidden">⇩</span><sub>1</sub></span><span class="main">)</span><span class="main">@</span><span class="main">[</span><span class="skolem">a<span class="hidden">⇩</span><sub>1</sub></span><span class="main">]</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="free">s<span class="hidden">⇩</span><sub>1</sub></span> <span class="keyword1">≈<span class="hidden">⇩</span><sub>L</sub></span> 
        transfers <span class="main">(</span>kinds <span class="main">(</span><span class="skolem">ax</span><span class="main">#</span><span class="main">(</span><span class="main">(</span><span class="free">a</span><span class="main">#</span><span class="skolem">as<span class="hidden">⇩</span><sub>2</sub></span><span class="main">)</span><span class="main">@</span><span class="main">[</span><span class="skolem">a<span class="hidden">⇩</span><sub>2</sub></span><span class="main">]</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="free">s<span class="hidden">⇩</span><sub>2</sub></span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">rule</span> nonInterference_path_to_Low<span class="main">)</span>
  <span class="keyword1"><span class="command">with</span></span> <span class="quoted"><span class="quoted">‹<span class="free">kind</span> <span class="skolem">ax</span> <span class="main">=</span> <span class="main">(</span><span class="main">λ</span><span class="bound">s</span><span class="main">.</span> True<span class="main">)<span class="hidden">⇩</span><sub>√</sub></span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="free">kind</span> <span class="free">a</span> <span class="main">=</span> <span class="main">(</span><span class="main">λ</span><span class="bound">s</span><span class="main">.</span> True<span class="main">)<span class="hidden">⇩</span><sub>√</sub></span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="free">kind</span> <span class="skolem">a<span class="hidden">⇩</span><sub>1</sub></span> <span class="main">=</span> <span class="main">⇑</span>id›</span></span> <span class="quoted"><span class="quoted">‹<span class="free">kind</span> <span class="skolem">a<span class="hidden">⇩</span><sub>2</sub></span> <span class="main">=</span> <span class="main">⇑</span>id›</span></span>
    <span class="quoted"><span class="quoted">‹transfers <span class="main">(</span>kinds <span class="skolem">as<span class="hidden">⇩</span><sub>1</sub></span><span class="main">)</span> <span class="free">s<span class="hidden">⇩</span><sub>1</sub></span> <span class="main">=</span> <span class="free">s<span class="hidden">⇩</span><sub>1</sub>'</span>›</span></span> <span class="quoted"><span class="quoted">‹transfers <span class="main">(</span>kinds <span class="skolem">as<span class="hidden">⇩</span><sub>2</sub></span><span class="main">)</span> <span class="free">s<span class="hidden">⇩</span><sub>2</sub></span> <span class="main">=</span> <span class="free">s<span class="hidden">⇩</span><sub>2</sub>'</span>›</span></span>
  <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span>kinds_def transfers_split<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>


<span class="keyword2"><span class="keyword">end</span></span>

<span class="keyword2"><span class="keyword">end</span></span>

</pre>
</div><div id="LiftingIntra">
<div class="head">
<h1>Theory LiftingIntra</h1>
</div>
<pre class="source"><span class="keyword1"><span class="command">section</span></span> <span class="quoted"><span class="plain_text">‹Framework Graph Lifting for Noninterference›</span></span>

<span class="keyword1"><span class="command">theory</span></span> LiftingIntra 
  <span class="keyword2"><span class="keyword">imports</span></span> <a href="NonInterferenceIntra.html">NonInterferenceIntra</a> <a href="../Slicing/CDepInstantiations.html">Slicing.CDepInstantiations</a> 
<span class="keyword2"><span class="keyword">begin</span></span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹In this section, we show how a valid CFG from the slicing framework in
\cite{Wasserrab:08} can be lifted to fulfil all properties of the 
<span class="antiquoted"><span class="raw_text"><span class="antiquoted"><span class="raw_text"><span class="operator"><span class="operator">‹</span></span>NonInterferenceIntraGraph›</span></span></span></span> locale. Basically, we redefine the
hitherto existing <span class="antiquoted"><span class="raw_text"><span class="antiquoted"><span class="raw_text"><span class="operator"><span class="operator">‹</span></span>Entry›</span></span></span></span> and <span class="antiquoted"><span class="raw_text"><span class="antiquoted"><span class="raw_text"><span class="operator"><span class="operator">‹</span></span>Exit›</span></span></span></span> nodes as new
<span class="antiquoted"><span class="raw_text"><span class="antiquoted"><span class="raw_text"><span class="operator"><span class="operator">‹</span></span>High›</span></span></span></span> and <span class="antiquoted"><span class="raw_text"><span class="antiquoted"><span class="raw_text"><span class="operator"><span class="operator">‹</span></span>Low›</span></span></span></span> nodes, and introduce two new nodes
<span class="antiquoted"><span class="raw_text"><span class="antiquoted"><span class="raw_text"><span class="operator"><span class="operator">‹</span></span>NewEntry›</span></span></span></span> and <span class="antiquoted"><span class="raw_text"><span class="antiquoted"><span class="raw_text"><span class="operator"><span class="operator">‹</span></span>NewExit›</span></span></span></span>. Then, we have to lift all functions
to operate on this new graph.›</span></span>

<span class="keyword1"><span class="command">subsection</span></span> <span class="quoted"><span class="plain_text">‹Liftings›</span></span>

<span class="keyword1"><span class="command">subsubsection</span></span> <span class="quoted"><span class="plain_text">‹The datatypes›</span></span>

<span class="keyword1"><span class="command">datatype</span></span> <span class="tfree">'node</span> LDCFG_node <span class="main">=</span> Node <span class="tfree"><span class="quoted"><span class="tfree">'node</span></span></span>
  <span class="main">|</span> NewEntry
  <span class="main">|</span> NewExit


<span class="keyword1"><span class="command">type_synonym</span></span> <span class="main">(</span><span class="tfree">'edge</span><span class="main">,</span><span class="tfree">'node</span><span class="main">,</span><span class="tfree">'state</span><span class="main">)</span> LDCFG_edge <span class="main">=</span> 
  <span class="quoted"><span class="quoted">"<span class="tfree">'node</span> LDCFG_node <span class="main">×</span> <span class="main">(</span><span class="tfree">'state</span> edge_kind<span class="main">)</span> <span class="main">×</span> <span class="tfree">'node</span> LDCFG_node"</span></span>


<span class="keyword1"><span class="command">subsubsection</span></span> <span class="quoted"><span class="plain_text">‹Lifting <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">term</span></span> <span class="quoted"><span class="free"><span class="quoted"><span class="free">valid_edge</span></span></span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span>›</span></span>

<span class="keyword1"><span class="command">inductive</span></span> <span class="entity">lift_valid_edge</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="tfree">'edge</span> <span class="main">⇒</span> bool<span class="main">)</span> <span class="main">⇒</span> <span class="main">(</span><span class="tfree">'edge</span> <span class="main">⇒</span> <span class="tfree">'node</span><span class="main">)</span> <span class="main">⇒</span> <span class="main">(</span><span class="tfree">'edge</span> <span class="main">⇒</span> <span class="tfree">'node</span><span class="main">)</span> <span class="main">⇒</span>
  <span class="main">(</span><span class="tfree">'edge</span> <span class="main">⇒</span> <span class="tfree">'state</span> edge_kind<span class="main">)</span> <span class="main">⇒</span> <span class="tfree">'node</span> <span class="main">⇒</span> <span class="tfree">'node</span> <span class="main">⇒</span> <span class="main">(</span><span class="tfree">'edge</span><span class="main">,</span><span class="tfree">'node</span><span class="main">,</span><span class="tfree">'state</span><span class="main">)</span> LDCFG_edge <span class="main">⇒</span> 
  bool"</span></span>
<span class="keyword2"><span class="keyword">for</span></span> <span class="entity">valid_edge</span><span class="main">::</span><span class="quoted"><span class="quoted">"<span class="tfree">'edge</span> <span class="main">⇒</span> bool"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="entity">src</span><span class="main">::</span><span class="quoted"><span class="quoted">"<span class="tfree">'edge</span> <span class="main">⇒</span> <span class="tfree">'node</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="entity">trg</span><span class="main">::</span><span class="quoted"><span class="quoted">"<span class="tfree">'edge</span> <span class="main">⇒</span> <span class="tfree">'node</span>"</span></span> 
  <span class="keyword2"><span class="keyword">and</span></span> <span class="entity">knd</span><span class="main">::</span><span class="quoted"><span class="quoted">"<span class="tfree">'edge</span> <span class="main">⇒</span> <span class="tfree">'state</span> edge_kind"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="entity">E</span><span class="main">::</span><span class="tfree"><span class="quoted"><span class="tfree">'node</span></span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="entity">X</span><span class="main">::</span><span class="tfree"><span class="quoted"><span class="tfree">'node</span></span></span>

<span class="keyword2"><span class="keyword">where</span></span> lve_edge<span class="main">:</span>
  <span class="quoted"><span class="quoted">"<span class="main">⟦</span><span class="free">valid_edge</span> <span class="free"><span class="bound"><span class="entity">a</span></span></span><span class="main">;</span> <span class="free">src</span> <span class="free"><span class="bound"><span class="entity">a</span></span></span> <span class="main">≠</span> <span class="free">E</span> <span class="main">∨</span> <span class="free">trg</span> <span class="free"><span class="bound"><span class="entity">a</span></span></span> <span class="main">≠</span> <span class="free">X</span><span class="main">;</span> 
    <span class="free"><span class="bound"><span class="entity">e</span></span></span> <span class="main">=</span> <span class="main">(</span>Node <span class="main">(</span><span class="free">src</span> <span class="free"><span class="bound"><span class="entity">a</span></span></span><span class="main">)</span><span class="main">,</span><span class="free">knd</span> <span class="free"><span class="bound"><span class="entity">a</span></span></span><span class="main">,</span>Node <span class="main">(</span><span class="free">trg</span> <span class="free"><span class="bound"><span class="entity">a</span></span></span><span class="main">)</span><span class="main">)</span><span class="main">⟧</span>
  <span class="main">⟹</span> <span class="free">lift_valid_edge</span> <span class="free">valid_edge</span> <span class="free">src</span> <span class="free">trg</span> <span class="free">knd</span> <span class="free">E</span> <span class="free">X</span> <span class="free"><span class="bound"><span class="entity">e</span></span></span>"</span></span>

  <span class="main">|</span> lve_Entry_edge<span class="main">:</span>
  <span class="quoted"><span class="quoted">"<span class="free"><span class="bound"><span class="entity">e</span></span></span> <span class="main">=</span> <span class="main">(</span>NewEntry<span class="main">,</span><span class="main">(</span><span class="main">λ</span><span class="bound">s</span><span class="main">.</span> True<span class="main">)<span class="hidden">⇩</span><sub>√</sub></span><span class="main">,</span>Node <span class="free">E</span><span class="main">)</span> 
  <span class="main">⟹</span> <span class="free">lift_valid_edge</span> <span class="free">valid_edge</span> <span class="free">src</span> <span class="free">trg</span> <span class="free">knd</span> <span class="free">E</span> <span class="free">X</span> <span class="free"><span class="bound"><span class="entity">e</span></span></span>"</span></span>

  <span class="main">|</span> lve_Exit_edge<span class="main">:</span>
  <span class="quoted"><span class="quoted">"<span class="free"><span class="bound"><span class="entity">e</span></span></span> <span class="main">=</span> <span class="main">(</span>Node <span class="free">X</span><span class="main">,</span><span class="main">(</span><span class="main">λ</span><span class="bound">s</span><span class="main">.</span> True<span class="main">)<span class="hidden">⇩</span><sub>√</sub></span><span class="main">,</span>NewExit<span class="main">)</span> 
  <span class="main">⟹</span> <span class="free">lift_valid_edge</span> <span class="free">valid_edge</span> <span class="free">src</span> <span class="free">trg</span> <span class="free">knd</span> <span class="free">E</span> <span class="free">X</span> <span class="free"><span class="bound"><span class="entity">e</span></span></span>"</span></span>

  <span class="main">|</span> lve_Entry_Exit_edge<span class="main">:</span>
  <span class="quoted"><span class="quoted">"<span class="free"><span class="bound"><span class="entity">e</span></span></span> <span class="main">=</span> <span class="main">(</span>NewEntry<span class="main">,</span><span class="main">(</span><span class="main">λ</span><span class="bound">s</span><span class="main">.</span> False<span class="main">)<span class="hidden">⇩</span><sub>√</sub></span><span class="main">,</span>NewExit<span class="main">)</span> 
  <span class="main">⟹</span> <span class="free">lift_valid_edge</span> <span class="free">valid_edge</span> <span class="free">src</span> <span class="free">trg</span> <span class="free">knd</span> <span class="free">E</span> <span class="free">X</span> <span class="free"><span class="bound"><span class="entity">e</span></span></span>"</span></span>


<span class="keyword1"><span class="command">lemma</span></span> <span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span><span class="quoted"><span class="quoted">"<span class="main">¬</span> lift_valid_edge <span class="free">valid_edge</span> <span class="free">src</span> <span class="free">trg</span> <span class="free">knd</span> <span class="free">E</span> <span class="free">X</span> <span class="main">(</span>Node <span class="free">E</span><span class="main">,</span><span class="free">et</span><span class="main">,</span>Node <span class="free">X</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">elim</span><span class="main"><span class="main">:</span></span>lift_valid_edge.cases<span class="main">)</span>


<span class="keyword1"><span class="command">subsubsection</span></span> <span class="quoted"><span class="plain_text">‹Lifting <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">term</span></span> <span class="quoted"><span class="free"><span class="quoted"><span class="free">Def</span></span></span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span> and <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">term</span></span> <span class="quoted"><span class="free"><span class="quoted"><span class="free">Use</span></span></span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span> sets›</span></span>

<span class="keyword1"><span class="command">inductive_set</span></span> <span class="entity">lift_Def_set</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="tfree">'node</span> <span class="main">⇒</span> <span class="tfree">'var</span> set<span class="main">)</span> <span class="main">⇒</span> <span class="tfree">'node</span> <span class="main">⇒</span> <span class="tfree">'node</span> <span class="main">⇒</span> 
                       <span class="tfree">'var</span> set <span class="main">⇒</span> <span class="tfree">'var</span> set <span class="main">⇒</span> <span class="main">(</span><span class="tfree">'node</span> LDCFG_node <span class="main">×</span> <span class="tfree">'var</span><span class="main">)</span> set"</span></span>
<span class="keyword2"><span class="keyword">for</span></span> <span class="entity">Def</span><span class="main">::</span><span class="quoted"><span class="quoted">"<span class="main">(</span><span class="tfree">'node</span> <span class="main">⇒</span> <span class="tfree">'var</span> set<span class="main">)</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="entity">E</span><span class="main">::</span><span class="tfree"><span class="quoted"><span class="tfree">'node</span></span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="entity">X</span><span class="main">::</span><span class="tfree"><span class="quoted"><span class="tfree">'node</span></span></span> 
  <span class="keyword2"><span class="keyword">and</span></span> <span class="entity">H</span><span class="main">::</span><span class="quoted"><span class="quoted">"<span class="tfree">'var</span> set"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="entity">L</span><span class="main">::</span><span class="quoted"><span class="quoted">"<span class="tfree">'var</span> set"</span></span>

<span class="keyword2"><span class="keyword">where</span></span> lift_Def_node<span class="main">:</span> 
  <span class="quoted"><span class="quoted">"<span class="free"><span class="bound"><span class="entity">V</span></span></span> <span class="main">∈</span> <span class="free">Def</span> <span class="free"><span class="bound"><span class="entity">n</span></span></span> <span class="main">⟹</span> <span class="main">(</span>Node <span class="free"><span class="bound"><span class="entity">n</span></span></span><span class="main">,</span><span class="free"><span class="bound"><span class="entity">V</span></span></span><span class="main">)</span> <span class="main">∈</span> <span class="free">lift_Def_set</span> <span class="free">Def</span> <span class="free">E</span> <span class="free">X</span> <span class="free">H</span> <span class="free">L</span>"</span></span>

  <span class="main">|</span> lift_Def_High<span class="main">:</span>
  <span class="quoted"><span class="quoted">"<span class="free"><span class="bound"><span class="entity">V</span></span></span> <span class="main">∈</span> <span class="free">H</span> <span class="main">⟹</span> <span class="main">(</span>Node <span class="free">E</span><span class="main">,</span><span class="free"><span class="bound"><span class="entity">V</span></span></span><span class="main">)</span> <span class="main">∈</span> <span class="free">lift_Def_set</span> <span class="free">Def</span> <span class="free">E</span> <span class="free">X</span> <span class="free">H</span> <span class="free">L</span>"</span></span>

<span class="keyword1"><span class="command">abbreviation</span></span> <span class="entity">lift_Def</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="tfree">'node</span> <span class="main">⇒</span> <span class="tfree">'var</span> set<span class="main">)</span> <span class="main">⇒</span> <span class="tfree">'node</span> <span class="main">⇒</span> <span class="tfree">'node</span> <span class="main">⇒</span> 
                       <span class="tfree">'var</span> set <span class="main">⇒</span> <span class="tfree">'var</span> set <span class="main">⇒</span> <span class="tfree">'node</span> LDCFG_node <span class="main">⇒</span> <span class="tfree">'var</span> set"</span></span>
  <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="free">lift_Def</span> <span class="free"><span class="bound"><span class="entity">Def</span></span></span> <span class="free"><span class="bound"><span class="entity">E</span></span></span> <span class="free"><span class="bound"><span class="entity">X</span></span></span> <span class="free"><span class="bound"><span class="entity">H</span></span></span> <span class="free"><span class="bound"><span class="entity">L</span></span></span> <span class="free"><span class="bound"><span class="entity">n</span></span></span> <span class="main">≡</span> <span class="main">{</span><span class="bound">V</span><span class="main">.</span> <span class="main">(</span><span class="free"><span class="bound"><span class="entity">n</span></span></span><span class="main">,</span><span class="bound">V</span><span class="main">)</span> <span class="main">∈</span> lift_Def_set <span class="free"><span class="bound"><span class="entity">Def</span></span></span> <span class="free"><span class="bound"><span class="entity">E</span></span></span> <span class="free"><span class="bound"><span class="entity">X</span></span></span> <span class="free"><span class="bound"><span class="entity">H</span></span></span> <span class="free"><span class="bound"><span class="entity">L</span></span></span><span class="main">}</span>"</span></span>


<span class="keyword1"><span class="command">inductive_set</span></span> <span class="entity">lift_Use_set</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="tfree">'node</span> <span class="main">⇒</span> <span class="tfree">'var</span> set<span class="main">)</span> <span class="main">⇒</span> <span class="tfree">'node</span> <span class="main">⇒</span> <span class="tfree">'node</span> <span class="main">⇒</span> 
                       <span class="tfree">'var</span> set <span class="main">⇒</span> <span class="tfree">'var</span> set <span class="main">⇒</span> <span class="main">(</span><span class="tfree">'node</span> LDCFG_node <span class="main">×</span> <span class="tfree">'var</span><span class="main">)</span> set"</span></span>
<span class="keyword2"><span class="keyword">for</span></span> <span class="entity">Use</span><span class="main">::</span><span class="quoted"><span class="quoted">"<span class="tfree">'node</span> <span class="main">⇒</span> <span class="tfree">'var</span> set"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="entity">E</span><span class="main">::</span><span class="tfree"><span class="quoted"><span class="tfree">'node</span></span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="entity">X</span><span class="main">::</span><span class="tfree"><span class="quoted"><span class="tfree">'node</span></span></span> 
  <span class="keyword2"><span class="keyword">and</span></span> <span class="entity">H</span><span class="main">::</span><span class="quoted"><span class="quoted">"<span class="tfree">'var</span> set"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="entity">L</span><span class="main">::</span><span class="quoted"><span class="quoted">"<span class="tfree">'var</span> set"</span></span>

<span class="keyword2"><span class="keyword">where</span></span> 
  lift_Use_node<span class="main">:</span> 
  <span class="quoted"><span class="quoted">"<span class="free"><span class="bound"><span class="entity">V</span></span></span> <span class="main">∈</span> <span class="free">Use</span> <span class="free"><span class="bound"><span class="entity">n</span></span></span> <span class="main">⟹</span> <span class="main">(</span>Node <span class="free"><span class="bound"><span class="entity">n</span></span></span><span class="main">,</span><span class="free"><span class="bound"><span class="entity">V</span></span></span><span class="main">)</span> <span class="main">∈</span> <span class="free">lift_Use_set</span> <span class="free">Use</span> <span class="free">E</span> <span class="free">X</span> <span class="free">H</span> <span class="free">L</span>"</span></span>

  <span class="main">|</span> lift_Use_High<span class="main">:</span>
  <span class="quoted"><span class="quoted">"<span class="free"><span class="bound"><span class="entity">V</span></span></span> <span class="main">∈</span> <span class="free">H</span> <span class="main">⟹</span> <span class="main">(</span>Node <span class="free">E</span><span class="main">,</span><span class="free"><span class="bound"><span class="entity">V</span></span></span><span class="main">)</span> <span class="main">∈</span> <span class="free">lift_Use_set</span> <span class="free">Use</span> <span class="free">E</span> <span class="free">X</span> <span class="free">H</span> <span class="free">L</span>"</span></span>

  <span class="main">|</span> lift_Use_Low<span class="main">:</span>
  <span class="quoted"><span class="quoted">"<span class="free"><span class="bound"><span class="entity">V</span></span></span> <span class="main">∈</span> <span class="free">L</span> <span class="main">⟹</span> <span class="main">(</span>Node <span class="free">X</span><span class="main">,</span><span class="free"><span class="bound"><span class="entity">V</span></span></span><span class="main">)</span> <span class="main">∈</span> <span class="free">lift_Use_set</span> <span class="free">Use</span> <span class="free">E</span> <span class="free">X</span> <span class="free">H</span> <span class="free">L</span>"</span></span>


<span class="keyword1"><span class="command">abbreviation</span></span> <span class="entity">lift_Use</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="tfree">'node</span> <span class="main">⇒</span> <span class="tfree">'var</span> set<span class="main">)</span> <span class="main">⇒</span> <span class="tfree">'node</span> <span class="main">⇒</span> <span class="tfree">'node</span> <span class="main">⇒</span> 
                       <span class="tfree">'var</span> set <span class="main">⇒</span> <span class="tfree">'var</span> set <span class="main">⇒</span> <span class="tfree">'node</span> LDCFG_node <span class="main">⇒</span> <span class="tfree">'var</span> set"</span></span>
  <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="free">lift_Use</span> <span class="free"><span class="bound"><span class="entity">Use</span></span></span> <span class="free"><span class="bound"><span class="entity">E</span></span></span> <span class="free"><span class="bound"><span class="entity">X</span></span></span> <span class="free"><span class="bound"><span class="entity">H</span></span></span> <span class="free"><span class="bound"><span class="entity">L</span></span></span> <span class="free"><span class="bound"><span class="entity">n</span></span></span> <span class="main">≡</span> <span class="main">{</span><span class="bound">V</span><span class="main">.</span> <span class="main">(</span><span class="free"><span class="bound"><span class="entity">n</span></span></span><span class="main">,</span><span class="bound">V</span><span class="main">)</span> <span class="main">∈</span> lift_Use_set <span class="free"><span class="bound"><span class="entity">Use</span></span></span> <span class="free"><span class="bound"><span class="entity">E</span></span></span> <span class="free"><span class="bound"><span class="entity">X</span></span></span> <span class="free"><span class="bound"><span class="entity">H</span></span></span> <span class="free"><span class="bound"><span class="entity">L</span></span></span><span class="main">}</span>"</span></span>



<span class="keyword1"><span class="command">subsection</span></span> <span class="quoted"><span class="plain_text">‹The lifting lemmas›</span></span>

<span class="keyword1"><span class="command">subsubsection</span></span> <span class="quoted"><span class="plain_text">‹Lifting the basic locales›</span></span>


<span class="keyword1"><span class="command">abbreviation</span></span> <span class="entity">src</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="tfree">'edge</span><span class="main">,</span><span class="tfree">'node</span><span class="main">,</span><span class="tfree">'state</span><span class="main">)</span> LDCFG_edge <span class="main">⇒</span> <span class="tfree">'node</span> LDCFG_node"</span></span>
  <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="free">src</span> <span class="free"><span class="bound"><span class="entity">a</span></span></span> <span class="main">≡</span> fst <span class="free"><span class="bound"><span class="entity">a</span></span></span>"</span></span>

<span class="keyword1"><span class="command">abbreviation</span></span> <span class="entity">trg</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="tfree">'edge</span><span class="main">,</span><span class="tfree">'node</span><span class="main">,</span><span class="tfree">'state</span><span class="main">)</span> LDCFG_edge <span class="main">⇒</span> <span class="tfree">'node</span> LDCFG_node"</span></span>
  <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="free">trg</span> <span class="free"><span class="bound"><span class="entity">a</span></span></span> <span class="main">≡</span> snd<span class="main">(</span>snd <span class="free"><span class="bound"><span class="entity">a</span></span></span><span class="main">)</span>"</span></span>

<span class="keyword1"><span class="command">definition</span></span> <span class="entity">knd</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="tfree">'edge</span><span class="main">,</span><span class="tfree">'node</span><span class="main">,</span><span class="tfree">'state</span><span class="main">)</span> LDCFG_edge <span class="main">⇒</span> <span class="tfree">'state</span> edge_kind"</span></span>
  <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="free">knd</span> <span class="free"><span class="bound"><span class="entity">a</span></span></span> <span class="main">≡</span> fst<span class="main">(</span>snd <span class="free"><span class="bound"><span class="entity">a</span></span></span><span class="main">)</span>"</span></span>


<span class="keyword1"><span class="command">lemma</span></span> lift_CFG<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> wf<span class="main">:</span><span class="quoted"><span class="quoted">"CFGExit_wf <span class="free">sourcenode</span> <span class="free">targetnode</span> <span class="free">kind</span> <span class="free">valid_edge</span> <span class="free">Entry</span> <span class="free">Def</span> <span class="free">Use</span>
                         <span class="free">state_val</span> <span class="free">Exit</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"CFG src trg
    <span class="main">(</span>lift_valid_edge <span class="free">valid_edge</span> <span class="free">sourcenode</span> <span class="free">targetnode</span> <span class="free">kind</span> <span class="free">Entry</span> <span class="free">Exit</span><span class="main">)</span> NewEntry"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">interpret</span></span> CFGExit_wf <span class="quoted"><span class="free">sourcenode</span></span> <span class="quoted"><span class="free">targetnode</span></span> <span class="quoted"><span class="free">kind</span></span> <span class="quoted"><span class="free">valid_edge</span></span> <span class="quoted"><span class="free">Entry</span></span> <span class="quoted"><span class="free">Def</span></span> <span class="quoted"><span class="free">Use</span></span>
                       <span class="quoted"><span class="free">state_val</span></span> <span class="quoted"><span class="free">Exit</span></span>
    <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">rule</span> wf<span class="main">)</span>
  <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> 
  <span class="keyword1"><span class="command">proof</span></span>
    <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">a</span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"lift_valid_edge <span class="free">valid_edge</span> <span class="free">sourcenode</span> <span class="free">targetnode</span> <span class="free">kind</span> <span class="free">Entry</span> <span class="free">Exit</span> <span class="skolem">a</span>"</span></span>
      <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"trg <span class="skolem">a</span> <span class="main">=</span> NewEntry"</span></span>
    <span class="keyword3"><span class="command">thus</span></span> <span class="quoted">False</span> <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">fastforce</span> <span class="quasi_keyword">elim</span><span class="main"><span class="main">:</span></span>lift_valid_edge.cases<span class="main">)</span>
  <span class="keyword1"><span class="command">next</span></span>
    <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">a</span> <span class="skolem">a'</span> 
    <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"lift_valid_edge <span class="free">valid_edge</span> <span class="free">sourcenode</span> <span class="free">targetnode</span> <span class="free">kind</span> <span class="free">Entry</span> <span class="free">Exit</span> <span class="skolem">a</span>"</span></span>
      <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"lift_valid_edge <span class="free">valid_edge</span> <span class="free">sourcenode</span> <span class="free">targetnode</span> <span class="free">kind</span> <span class="free">Entry</span> <span class="free">Exit</span> <span class="skolem">a'</span>"</span></span>
      <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"src <span class="skolem">a</span> <span class="main">=</span> src <span class="skolem">a'</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"trg <span class="skolem">a</span> <span class="main">=</span> trg <span class="skolem">a'</span>"</span></span>
    <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">a</span> <span class="main">=</span> <span class="skolem">a'</span>"</span></span>
    <span class="keyword1"><span class="command">proof</span></span><span class="main">(</span><span class="operator">induct</span> <span class="quasi_keyword">rule</span><span class="main"><span class="main">:</span></span>lift_valid_edge.induct<span class="main">)</span>
      <span class="keyword3"><span class="command">case</span></span> lve_edge <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?case</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">-</span><span class="main">(</span><span class="operator">erule</span> lift_valid_edge.cases<span class="main"><span class="keyword3">,</span></span><span class="operator">auto</span> <span class="quasi_keyword">dest</span><span class="main"><span class="main">:</span></span>edge_det<span class="main">)</span>
    <span class="keyword1"><span class="command">qed</span></span><span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">elim</span><span class="main"><span class="main">:</span></span>lift_valid_edge.cases<span class="main">)</span>
  <span class="keyword1"><span class="command">qed</span></span>
<span class="keyword1"><span class="command">qed</span></span>


<span class="keyword1"><span class="command">lemma</span></span> lift_CFG_wf<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> wf<span class="main">:</span><span class="quoted"><span class="quoted">"CFGExit_wf <span class="free">sourcenode</span> <span class="free">targetnode</span> <span class="free">kind</span> <span class="free">valid_edge</span> <span class="free">Entry</span> <span class="free">Def</span> <span class="free">Use</span>
                         <span class="free">state_val</span> <span class="free">Exit</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"CFG_wf src trg knd 
         <span class="main">(</span>lift_valid_edge <span class="free">valid_edge</span> <span class="free">sourcenode</span> <span class="free">targetnode</span> <span class="free">kind</span> <span class="free">Entry</span> <span class="free">Exit</span><span class="main">)</span> NewEntry
         <span class="main">(</span>lift_Def <span class="free">Def</span> <span class="free">Entry</span> <span class="free">Exit</span> <span class="free">H</span> <span class="free">L</span><span class="main">)</span> <span class="main">(</span>lift_Use <span class="free">Use</span> <span class="free">Entry</span> <span class="free">Exit</span> <span class="free">H</span> <span class="free">L</span><span class="main">)</span> <span class="free">state_val</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">interpret</span></span> CFGExit_wf <span class="quoted"><span class="free">sourcenode</span></span> <span class="quoted"><span class="free">targetnode</span></span> <span class="quoted"><span class="free">kind</span></span> <span class="quoted"><span class="free">valid_edge</span></span> <span class="quoted"><span class="free">Entry</span></span> <span class="quoted"><span class="free">Def</span></span> <span class="quoted"><span class="free">Use</span></span>
                       <span class="quoted"><span class="free">state_val</span></span> <span class="quoted"><span class="free">Exit</span></span>
    <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">rule</span> wf<span class="main">)</span>
  <span class="keyword1"><span class="command">interpret</span></span> CFG<span class="main">:</span>CFG <span class="quoted">src</span> <span class="quoted">trg</span> <span class="quoted">knd</span>
    <span class="quoted"><span class="quoted">"lift_valid_edge <span class="free">valid_edge</span> <span class="free">sourcenode</span> <span class="free">targetnode</span> <span class="free">kind</span> <span class="free">Entry</span> <span class="free">Exit</span>"</span></span> <span class="quoted">NewEntry</span>
    <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">fastforce</span> <span class="quasi_keyword">intro</span><span class="main"><span class="main">:</span></span>lift_CFG wf<span class="main">)</span>
  <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
  <span class="keyword1"><span class="command">proof</span></span>
    <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"lift_Def <span class="free">Def</span> <span class="free">Entry</span> <span class="free">Exit</span> <span class="free">H</span> <span class="free">L</span> NewEntry <span class="main">=</span> <span class="main">{}</span> <span class="main">∧</span>
          lift_Use <span class="free">Use</span> <span class="free">Entry</span> <span class="free">Exit</span> <span class="free">H</span> <span class="free">L</span> NewEntry <span class="main">=</span> <span class="main">{}</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">fastforce</span> <span class="quasi_keyword">elim</span><span class="main"><span class="main">:</span></span>lift_Use_set.cases lift_Def_set.cases<span class="main">)</span>
  <span class="keyword1"><span class="command">next</span></span>
    <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">a</span> <span class="skolem">V</span> <span class="skolem">s</span> 
    <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"lift_valid_edge <span class="free">valid_edge</span> <span class="free">sourcenode</span> <span class="free">targetnode</span> <span class="free">kind</span> <span class="free">Entry</span> <span class="free">Exit</span> <span class="skolem">a</span>"</span></span>
      <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">V</span> <span class="main">∉</span> lift_Def <span class="free">Def</span> <span class="free">Entry</span> <span class="free">Exit</span> <span class="free">H</span> <span class="free">L</span> <span class="main">(</span>src <span class="skolem">a</span><span class="main">)</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"pred <span class="main">(</span>knd <span class="skolem">a</span><span class="main">)</span> <span class="skolem">s</span>"</span></span>
    <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"<span class="free">state_val</span> <span class="main">(</span>transfer <span class="main">(</span>knd <span class="skolem">a</span><span class="main">)</span> <span class="skolem">s</span><span class="main">)</span> <span class="skolem">V</span> <span class="main">=</span> <span class="free">state_val</span> <span class="skolem">s</span> <span class="skolem">V</span>"</span></span>
    <span class="keyword1"><span class="command">proof</span></span><span class="main">(</span><span class="operator">induct</span> <span class="quasi_keyword">rule</span><span class="main"><span class="main">:</span></span>lift_valid_edge.induct<span class="main">)</span>
      <span class="keyword3"><span class="command">case</span></span> lve_edge
      <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?case</span></span></span> <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">fastforce</span> <span class="quasi_keyword">intro</span><span class="main"><span class="main">:</span></span>CFG_edge_no_Def_equal <span class="quasi_keyword">dest</span><span class="main"><span class="main">:</span></span>lift_Def_node<span class="main"><span class="main">[</span></span><span class="operator">of</span> <span class="main"><span class="main">_</span></span> <span class="quoted"><span class="free">Def</span></span><span class="main"><span class="main">]</span></span>
        <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span>knd_def<span class="main">)</span>
    <span class="keyword1"><span class="command">qed</span></span><span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span>knd_def<span class="main">)</span>
  <span class="keyword1"><span class="command">next</span></span>
    <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">a</span> <span class="skolem">s</span> <span class="skolem">s'</span>
    <span class="keyword3"><span class="command">assume</span></span> assms<span class="main">:</span><span class="quoted"><span class="quoted">"lift_valid_edge <span class="free">valid_edge</span> <span class="free">sourcenode</span> <span class="free">targetnode</span> <span class="free">kind</span> <span class="free">Entry</span> <span class="free">Exit</span> <span class="skolem">a</span>"</span></span>
      <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">V</span><span class="main">∈</span>lift_Use <span class="free">Use</span> <span class="free">Entry</span> <span class="free">Exit</span> <span class="free">H</span> <span class="free">L</span> <span class="main">(</span>src <span class="skolem">a</span><span class="main">)</span><span class="main">.</span> <span class="free">state_val</span> <span class="skolem">s</span> <span class="bound">V</span> <span class="main">=</span> <span class="free">state_val</span> <span class="skolem">s'</span> <span class="bound">V</span>"</span></span>
      <span class="quoted"><span class="quoted">"pred <span class="main">(</span>knd <span class="skolem">a</span><span class="main">)</span> <span class="skolem">s</span>"</span></span> <span class="quoted"><span class="quoted">"pred <span class="main">(</span>knd <span class="skolem">a</span><span class="main">)</span> <span class="skolem">s'</span>"</span></span>
    <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">V</span><span class="main">∈</span>lift_Def <span class="free">Def</span> <span class="free">Entry</span> <span class="free">Exit</span> <span class="free">H</span> <span class="free">L</span> <span class="main">(</span>src <span class="skolem">a</span><span class="main">)</span><span class="main">.</span>
             <span class="free">state_val</span> <span class="main">(</span>transfer <span class="main">(</span>knd <span class="skolem">a</span><span class="main">)</span> <span class="skolem">s</span><span class="main">)</span> <span class="bound">V</span> <span class="main">=</span> <span class="free">state_val</span> <span class="main">(</span>transfer <span class="main">(</span>knd <span class="skolem">a</span><span class="main">)</span> <span class="skolem">s'</span><span class="main">)</span> <span class="bound">V</span>"</span></span>
    <span class="keyword1"><span class="command">proof</span></span>
      <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">V</span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">V</span> <span class="main">∈</span> lift_Def <span class="free">Def</span> <span class="free">Entry</span> <span class="free">Exit</span> <span class="free">H</span> <span class="free">L</span> <span class="main">(</span>src <span class="skolem">a</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">with</span></span> assms
      <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="free">state_val</span> <span class="main">(</span>transfer <span class="main">(</span>knd <span class="skolem">a</span><span class="main">)</span> <span class="skolem">s</span><span class="main">)</span> <span class="skolem">V</span> <span class="main">=</span> <span class="free">state_val</span> <span class="main">(</span>transfer <span class="main">(</span>knd <span class="skolem">a</span><span class="main">)</span> <span class="skolem">s'</span><span class="main">)</span> <span class="skolem">V</span>"</span></span>
      <span class="keyword1"><span class="command">proof</span></span><span class="main">(</span><span class="operator">induct</span> <span class="quasi_keyword">rule</span><span class="main"><span class="main">:</span></span>lift_valid_edge.induct<span class="main">)</span>
        <span class="keyword3"><span class="command">case</span></span> <span class="main">(</span>lve_edge <span class="skolem">a</span> <span class="skolem">e</span><span class="main">)</span>
        <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?case</span></span></span>
        <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">cases</span> <span class="quoted"><span class="quoted">"Node <span class="main">(</span><span class="free">sourcenode</span> <span class="skolem">a</span><span class="main">)</span> <span class="main">=</span> Node <span class="free">Entry</span>"</span></span><span class="main">)</span>
          <span class="keyword3"><span class="command">case</span></span> True
          <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="free">sourcenode</span> <span class="skolem">a</span> <span class="main">=</span> <span class="free">Entry</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
          <span class="keyword1"><span class="command">from</span></span> Entry_Exit_edge <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">a'</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="free">valid_edge</span> <span class="skolem">a'</span>"</span></span>
            <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">sourcenode</span> <span class="skolem">a'</span> <span class="main">=</span> <span class="free">Entry</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">targetnode</span> <span class="skolem">a'</span> <span class="main">=</span> <span class="free">Exit</span>"</span></span>
            <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">kind</span> <span class="skolem">a'</span> <span class="main">=</span> <span class="main">(</span><span class="main">λ</span><span class="bound">s</span><span class="main">.</span> False<span class="main">)<span class="hidden">⇩</span><sub>√</sub></span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
          <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound">Q</span><span class="main">.</span> <span class="free">kind</span> <span class="skolem">a</span> <span class="main">=</span> <span class="main">(</span><span class="bound">Q</span><span class="main">)<span class="hidden">⇩</span><sub>√</sub></span>"</span></span>
          <span class="keyword1"><span class="command">proof</span></span><span class="main">(</span><span class="operator">cases</span> <span class="quoted"><span class="quoted">"<span class="free">targetnode</span> <span class="skolem">a</span> <span class="main">=</span> <span class="free">Exit</span>"</span></span><span class="main">)</span>
            <span class="keyword3"><span class="command">case</span></span> True
            <span class="keyword1"><span class="command">with</span></span> <span class="quoted"><span class="quoted">‹<span class="free">valid_edge</span> <span class="skolem">a</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="free">valid_edge</span> <span class="skolem">a'</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="free">sourcenode</span> <span class="skolem">a</span> <span class="main">=</span> <span class="free">Entry</span>›</span></span>
              <span class="quoted"><span class="quoted">‹<span class="free">sourcenode</span> <span class="skolem">a'</span> <span class="main">=</span> <span class="free">Entry</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="free">targetnode</span> <span class="skolem">a'</span> <span class="main">=</span> <span class="free">Exit</span>›</span></span>
            <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">a</span> <span class="main">=</span> <span class="skolem">a'</span>"</span></span> <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">fastforce</span> <span class="quasi_keyword">dest</span><span class="main"><span class="main">:</span></span>edge_det<span class="main">)</span>
            <span class="keyword1"><span class="command">with</span></span> <span class="quoted"><span class="quoted">‹<span class="free">kind</span> <span class="skolem">a'</span> <span class="main">=</span> <span class="main">(</span><span class="main">λ</span><span class="bound">s</span><span class="main">.</span> False<span class="main">)<span class="hidden">⇩</span><sub>√</sub></span>›</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
          <span class="keyword1"><span class="command">next</span></span>
            <span class="keyword3"><span class="command">case</span></span> False
            <span class="keyword1"><span class="command">with</span></span> <span class="quoted"><span class="quoted">‹<span class="free">valid_edge</span> <span class="skolem">a</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="free">valid_edge</span> <span class="skolem">a'</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="free">sourcenode</span> <span class="skolem">a</span> <span class="main">=</span> <span class="free">Entry</span>›</span></span>
              <span class="quoted"><span class="quoted">‹<span class="free">sourcenode</span> <span class="skolem">a'</span> <span class="main">=</span> <span class="free">Entry</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="free">targetnode</span> <span class="skolem">a'</span> <span class="main">=</span> <span class="free">Exit</span>›</span></span>
            <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">dest</span><span class="main"><span class="main">:</span></span>deterministic<span class="main">)</span>
          <span class="keyword1"><span class="command">qed</span></span>
          <span class="keyword1"><span class="command">from</span></span> True <span class="quoted"><span class="quoted">‹<span class="skolem">V</span> <span class="main">∈</span> lift_Def <span class="free">Def</span> <span class="free">Entry</span> <span class="free">Exit</span> <span class="free">H</span> <span class="free">L</span> <span class="main">(</span>src <span class="skolem">e</span><span class="main">)</span>›</span></span> Entry_empty
            <span class="quoted"><span class="quoted">‹<span class="skolem">e</span> <span class="main">=</span> <span class="main">(</span>Node <span class="main">(</span><span class="free">sourcenode</span> <span class="skolem">a</span><span class="main">)</span><span class="main">,</span> <span class="free">kind</span> <span class="skolem">a</span><span class="main">,</span> Node <span class="main">(</span><span class="free">targetnode</span> <span class="skolem">a</span><span class="main">)</span><span class="main">)</span>›</span></span>
          <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">V</span> <span class="main">∈</span> <span class="free">H</span>"</span></span> <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">fastforce</span> <span class="quasi_keyword">elim</span><span class="main"><span class="main">:</span></span>lift_Def_set.cases<span class="main">)</span>
          <span class="keyword1"><span class="command">from</span></span> True <span class="quoted"><span class="quoted">‹<span class="skolem">e</span> <span class="main">=</span> <span class="main">(</span>Node <span class="main">(</span><span class="free">sourcenode</span> <span class="skolem">a</span><span class="main">)</span><span class="main">,</span> <span class="free">kind</span> <span class="skolem">a</span><span class="main">,</span> Node <span class="main">(</span><span class="free">targetnode</span> <span class="skolem">a</span><span class="main">)</span><span class="main">)</span>›</span></span>
            <span class="quoted"><span class="quoted">‹<span class="free">sourcenode</span> <span class="skolem">a</span> <span class="main">≠</span> <span class="free">Entry</span> <span class="main">∨</span> <span class="free">targetnode</span> <span class="skolem">a</span> <span class="main">≠</span> <span class="free">Exit</span>›</span></span>
          <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">V</span><span class="main">∈</span><span class="free">H</span><span class="main">.</span> <span class="bound">V</span> <span class="main">∈</span> lift_Use <span class="free">Use</span> <span class="free">Entry</span> <span class="free">Exit</span> <span class="free">H</span> <span class="free">L</span> <span class="main">(</span>src <span class="skolem">e</span><span class="main">)</span>"</span></span>
            <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">fastforce</span> <span class="quasi_keyword">intro</span><span class="main"><span class="main">:</span></span>lift_Use_High<span class="main">)</span>
          <span class="keyword1"><span class="command">with</span></span> <span class="quoted"><span class="quoted">‹<span class="main">∀</span><span class="bound">V</span><span class="main">∈</span>lift_Use <span class="free">Use</span> <span class="free">Entry</span> <span class="free">Exit</span> <span class="free">H</span> <span class="free">L</span> <span class="main">(</span>src <span class="skolem">e</span><span class="main">)</span><span class="main">.</span> 
                            <span class="free">state_val</span> <span class="skolem">s</span> <span class="bound">V</span> <span class="main">=</span> <span class="free">state_val</span> <span class="skolem">s'</span> <span class="bound">V</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">V</span> <span class="main">∈</span> <span class="free">H</span>›</span></span>
          <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">state_val</span> <span class="skolem">s</span> <span class="skolem">V</span> <span class="main">=</span> <span class="free">state_val</span> <span class="skolem">s'</span> <span class="skolem">V</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
          <span class="keyword1"><span class="command">with</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">e</span> <span class="main">=</span> <span class="main">(</span>Node <span class="main">(</span><span class="free">sourcenode</span> <span class="skolem">a</span><span class="main">)</span><span class="main">,</span> <span class="free">kind</span> <span class="skolem">a</span><span class="main">,</span> Node <span class="main">(</span><span class="free">targetnode</span> <span class="skolem">a</span><span class="main">)</span><span class="main">)</span>›</span></span> 
            <span class="quoted"><span class="quoted">‹<span class="main">∃</span><span class="bound">Q</span><span class="main">.</span> <span class="free">kind</span> <span class="skolem">a</span> <span class="main">=</span> <span class="main">(</span><span class="bound">Q</span><span class="main">)<span class="hidden">⇩</span><sub>√</sub></span>›</span></span>
          <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">fastforce</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span>knd_def<span class="main">)</span>
        <span class="keyword1"><span class="command">next</span></span>
          <span class="keyword3"><span class="command">case</span></span> False
          <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">V'</span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">V'</span> <span class="main">∈</span> <span class="free">Use</span> <span class="main">(</span><span class="free">sourcenode</span> <span class="skolem">a</span><span class="main">)</span>"</span></span>
            <span class="keyword1"><span class="command">with</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">e</span> <span class="main">=</span> <span class="main">(</span>Node <span class="main">(</span><span class="free">sourcenode</span> <span class="skolem">a</span><span class="main">)</span><span class="main">,</span> <span class="free">kind</span> <span class="skolem">a</span><span class="main">,</span> Node <span class="main">(</span><span class="free">targetnode</span> <span class="skolem">a</span><span class="main">)</span><span class="main">)</span>›</span></span>
            <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">V'</span> <span class="main">∈</span> lift_Use <span class="free">Use</span> <span class="free">Entry</span> <span class="free">Exit</span> <span class="free">H</span> <span class="free">L</span> <span class="main">(</span>src <span class="skolem">e</span><span class="main">)</span>"</span></span>
              <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">fastforce</span> <span class="quasi_keyword">intro</span><span class="main"><span class="main">:</span></span>lift_Use_node<span class="main">)</span>
          <span class="keyword1"><span class="command">}</span></span>
          <span class="keyword1"><span class="command">with</span></span> <span class="quoted"><span class="quoted">‹<span class="main">∀</span><span class="bound">V</span><span class="main">∈</span>lift_Use <span class="free">Use</span> <span class="free">Entry</span> <span class="free">Exit</span> <span class="free">H</span> <span class="free">L</span> <span class="main">(</span>src <span class="skolem">e</span><span class="main">)</span><span class="main">.</span> 
                            <span class="free">state_val</span> <span class="skolem">s</span> <span class="bound">V</span> <span class="main">=</span> <span class="free">state_val</span> <span class="skolem">s'</span> <span class="bound">V</span>›</span></span>
          <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">V</span><span class="main">∈</span><span class="free">Use</span> <span class="main">(</span><span class="free">sourcenode</span> <span class="skolem">a</span><span class="main">)</span><span class="main">.</span> <span class="free">state_val</span> <span class="skolem">s</span> <span class="bound">V</span> <span class="main">=</span> <span class="free">state_val</span> <span class="skolem">s'</span> <span class="bound">V</span>"</span></span>
            <span class="keyword1"><span class="command">by</span></span> <span class="operator">fastforce</span>
          <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="free">valid_edge</span> <span class="skolem">a</span>›</span></span> this <span class="quoted"><span class="quoted">‹pred <span class="main">(</span>knd <span class="skolem">e</span><span class="main">)</span> <span class="skolem">s</span>›</span></span> <span class="quoted"><span class="quoted">‹pred <span class="main">(</span>knd <span class="skolem">e</span><span class="main">)</span> <span class="skolem">s'</span>›</span></span>
            <span class="quoted"><span class="quoted">‹<span class="skolem">e</span> <span class="main">=</span> <span class="main">(</span>Node <span class="main">(</span><span class="free">sourcenode</span> <span class="skolem">a</span><span class="main">)</span><span class="main">,</span> <span class="free">kind</span> <span class="skolem">a</span><span class="main">,</span> Node <span class="main">(</span><span class="free">targetnode</span> <span class="skolem">a</span><span class="main">)</span><span class="main">)</span>›</span></span>
          <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">V</span> <span class="main">∈</span> <span class="free">Def</span> <span class="main">(</span><span class="free">sourcenode</span> <span class="skolem">a</span><span class="main">)</span><span class="main">.</span> <span class="free">state_val</span> <span class="main">(</span>transfer <span class="main">(</span><span class="free">kind</span> <span class="skolem">a</span><span class="main">)</span> <span class="skolem">s</span><span class="main">)</span> <span class="bound">V</span> <span class="main">=</span>
            <span class="free">state_val</span> <span class="main">(</span>transfer <span class="main">(</span><span class="free">kind</span> <span class="skolem">a</span><span class="main">)</span> <span class="skolem">s'</span><span class="main">)</span> <span class="bound">V</span>"</span></span>
            <span class="keyword1"><span class="command">by</span></span> <span class="operator">-</span><span class="main">(</span><span class="operator">erule</span> CFG_edge_transfer_uses_only_Use<span class="main"><span class="keyword3">,</span></span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span>knd_def<span class="main">)</span>
          <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">V</span> <span class="main">∈</span> lift_Def <span class="free">Def</span> <span class="free">Entry</span> <span class="free">Exit</span> <span class="free">H</span> <span class="free">L</span> <span class="main">(</span>src <span class="skolem">e</span><span class="main">)</span>›</span></span> False
            <span class="quoted"><span class="quoted">‹<span class="skolem">e</span> <span class="main">=</span> <span class="main">(</span>Node <span class="main">(</span><span class="free">sourcenode</span> <span class="skolem">a</span><span class="main">)</span><span class="main">,</span> <span class="free">kind</span> <span class="skolem">a</span><span class="main">,</span> Node <span class="main">(</span><span class="free">targetnode</span> <span class="skolem">a</span><span class="main">)</span><span class="main">)</span>›</span></span>
          <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">V</span> <span class="main">∈</span> <span class="free">Def</span> <span class="main">(</span><span class="free">sourcenode</span> <span class="skolem">a</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">fastforce</span> <span class="quasi_keyword">elim</span><span class="main"><span class="main">:</span></span>lift_Def_set.cases<span class="main">)</span>
          <span class="keyword1"><span class="command">with</span></span> <span class="quoted"><span class="quoted">‹<span class="main">∀</span><span class="bound">V</span> <span class="main">∈</span> <span class="free">Def</span> <span class="main">(</span><span class="free">sourcenode</span> <span class="skolem">a</span><span class="main">)</span><span class="main">.</span> <span class="free">state_val</span> <span class="main">(</span>transfer <span class="main">(</span><span class="free">kind</span> <span class="skolem">a</span><span class="main">)</span> <span class="skolem">s</span><span class="main">)</span> <span class="bound">V</span> <span class="main">=</span>
            <span class="free">state_val</span> <span class="main">(</span>transfer <span class="main">(</span><span class="free">kind</span> <span class="skolem">a</span><span class="main">)</span> <span class="skolem">s'</span><span class="main">)</span> <span class="bound">V</span>›</span></span>
            <span class="quoted"><span class="quoted">‹<span class="skolem">e</span> <span class="main">=</span> <span class="main">(</span>Node <span class="main">(</span><span class="free">sourcenode</span> <span class="skolem">a</span><span class="main">)</span><span class="main">,</span> <span class="free">kind</span> <span class="skolem">a</span><span class="main">,</span> Node <span class="main">(</span><span class="free">targetnode</span> <span class="skolem">a</span><span class="main">)</span><span class="main">)</span>›</span></span>
          <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span>knd_def<span class="main">)</span>
        <span class="keyword1"><span class="command">qed</span></span>
      <span class="keyword1"><span class="command">next</span></span>
        <span class="keyword3"><span class="command">case</span></span> <span class="main">(</span>lve_Entry_edge <span class="skolem">e</span><span class="main">)</span>
        <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">V</span> <span class="main">∈</span> lift_Def <span class="free">Def</span> <span class="free">Entry</span> <span class="free">Exit</span> <span class="free">H</span> <span class="free">L</span> <span class="main">(</span>src <span class="skolem">e</span><span class="main">)</span>›</span></span> 
          <span class="quoted"><span class="quoted">‹<span class="skolem">e</span> <span class="main">=</span> <span class="main">(</span>NewEntry<span class="main">,</span> <span class="main">(</span><span class="main">λ</span><span class="bound">s</span><span class="main">.</span> True<span class="main">)<span class="hidden">⇩</span><sub>√</sub></span><span class="main">,</span> Node <span class="free">Entry</span><span class="main">)</span>›</span></span>
        <span class="keyword1"><span class="command">have</span></span> <span class="quoted">False</span> <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">fastforce</span> <span class="quasi_keyword">elim</span><span class="main"><span class="main">:</span></span>lift_Def_set.cases<span class="main">)</span>
        <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?case</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
      <span class="keyword1"><span class="command">next</span></span>
        <span class="keyword3"><span class="command">case</span></span> <span class="main">(</span>lve_Exit_edge <span class="skolem">e</span><span class="main">)</span>
        <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">V</span> <span class="main">∈</span> lift_Def <span class="free">Def</span> <span class="free">Entry</span> <span class="free">Exit</span> <span class="free">H</span> <span class="free">L</span> <span class="main">(</span>src <span class="skolem">e</span><span class="main">)</span>›</span></span> 
          <span class="quoted"><span class="quoted">‹<span class="skolem">e</span> <span class="main">=</span> <span class="main">(</span>Node <span class="free">Exit</span><span class="main">,</span> <span class="main">(</span><span class="main">λ</span><span class="bound">s</span><span class="main">.</span> True<span class="main">)<span class="hidden">⇩</span><sub>√</sub></span><span class="main">,</span> NewExit<span class="main">)</span>›</span></span>
        <span class="keyword1"><span class="command">have</span></span> <span class="quoted">False</span>
          <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">fastforce</span> <span class="quasi_keyword">elim</span><span class="main"><span class="main">:</span></span>lift_Def_set.cases <span class="quasi_keyword">intro</span><span class="main"><span class="main">!</span></span><span class="main"><span class="main">:</span></span>Entry_noteq_Exit <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span>Exit_empty<span class="main">)</span>
        <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?case</span></span></span>  <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
      <span class="keyword1"><span class="command">qed</span></span><span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span>knd_def<span class="main">)</span>
    <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">next</span></span>
    <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">a</span> <span class="skolem">s</span> <span class="skolem">s'</span>
    <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"lift_valid_edge <span class="free">valid_edge</span> <span class="free">sourcenode</span> <span class="free">targetnode</span> <span class="free">kind</span> <span class="free">Entry</span> <span class="free">Exit</span> <span class="skolem">a</span>"</span></span>
      <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"pred <span class="main">(</span>knd <span class="skolem">a</span><span class="main">)</span> <span class="skolem">s</span>"</span></span> 
      <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">V</span><span class="main">∈</span>lift_Use <span class="free">Use</span> <span class="free">Entry</span> <span class="free">Exit</span> <span class="free">H</span> <span class="free">L</span> <span class="main">(</span>src <span class="skolem">a</span><span class="main">)</span><span class="main">.</span> <span class="free">state_val</span> <span class="skolem">s</span> <span class="bound">V</span> <span class="main">=</span> <span class="free">state_val</span> <span class="skolem">s'</span> <span class="bound">V</span>"</span></span>
    <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"pred <span class="main">(</span>knd <span class="skolem">a</span><span class="main">)</span> <span class="skolem">s'</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">induct</span> <span class="quasi_keyword">rule</span><span class="main"><span class="main">:</span></span>lift_valid_edge.induct<span class="main"><span class="keyword3">,</span></span>
         <span class="operator">auto</span> <span class="quasi_keyword">elim</span><span class="main"><span class="main">!</span></span><span class="main"><span class="main">:</span></span>CFG_edge_Uses_pred_equal <span class="quasi_keyword">dest</span><span class="main"><span class="main">:</span></span>lift_Use_node <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span>knd_def<span class="main">)</span>
  <span class="keyword1"><span class="command">next</span></span>
    <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">a</span> <span class="skolem">a'</span>
    <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"lift_valid_edge <span class="free">valid_edge</span> <span class="free">sourcenode</span> <span class="free">targetnode</span> <span class="free">kind</span> <span class="free">Entry</span> <span class="free">Exit</span> <span class="skolem">a</span>"</span></span>
      <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"lift_valid_edge <span class="free">valid_edge</span> <span class="free">sourcenode</span> <span class="free">targetnode</span> <span class="free">kind</span> <span class="free">Entry</span> <span class="free">Exit</span> <span class="skolem">a'</span>"</span></span>
      <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"src <span class="skolem">a</span> <span class="main">=</span> src <span class="skolem">a'</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"trg <span class="skolem">a</span> <span class="main">≠</span> trg <span class="skolem">a'</span>"</span></span>
    <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound">Q</span> <span class="bound">Q'</span><span class="main">.</span> knd <span class="skolem">a</span> <span class="main">=</span> <span class="main">(</span><span class="bound">Q</span><span class="main">)<span class="hidden">⇩</span><sub>√</sub></span> <span class="main">∧</span> knd <span class="skolem">a'</span> <span class="main">=</span> <span class="main">(</span><span class="bound">Q'</span><span class="main">)<span class="hidden">⇩</span><sub>√</sub></span> <span class="main">∧</span> 
                 <span class="main">(</span><span class="main">∀</span><span class="bound">s</span><span class="main">.</span> <span class="main">(</span><span class="bound">Q</span> <span class="bound">s</span> <span class="main">⟶</span> <span class="main">¬</span> <span class="bound">Q'</span> <span class="bound">s</span><span class="main">)</span> <span class="main">∧</span> <span class="main">(</span><span class="bound">Q'</span> <span class="bound">s</span> <span class="main">⟶</span> <span class="main">¬</span> <span class="bound">Q</span> <span class="bound">s</span><span class="main">)</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">proof</span></span><span class="main">(</span><span class="operator">induct</span> <span class="quasi_keyword">rule</span><span class="main"><span class="main">:</span></span>lift_valid_edge.induct<span class="main">)</span>
      <span class="keyword3"><span class="command">case</span></span> <span class="main">(</span>lve_edge <span class="skolem">a</span> <span class="skolem">e</span><span class="main">)</span>
      <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹lift_valid_edge <span class="free">valid_edge</span> <span class="free">sourcenode</span> <span class="free">targetnode</span> <span class="free">kind</span> <span class="free">Entry</span> <span class="free">Exit</span> <span class="skolem">a'</span>›</span></span>
        <span class="quoted"><span class="quoted">‹<span class="free">valid_edge</span> <span class="skolem">a</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">e</span> <span class="main">=</span> <span class="main">(</span>Node <span class="main">(</span><span class="free">sourcenode</span> <span class="skolem">a</span><span class="main">)</span><span class="main">,</span> <span class="free">kind</span> <span class="skolem">a</span><span class="main">,</span> Node <span class="main">(</span><span class="free">targetnode</span> <span class="skolem">a</span><span class="main">)</span><span class="main">)</span>›</span></span>
        <span class="quoted"><span class="quoted">‹src <span class="skolem">e</span> <span class="main">=</span> src <span class="skolem">a'</span>›</span></span> <span class="quoted"><span class="quoted">‹trg <span class="skolem">e</span> <span class="main">≠</span> trg <span class="skolem">a'</span>›</span></span>
      <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?case</span></span></span>
      <span class="keyword1"><span class="command">proof</span></span><span class="main">(</span><span class="operator">induct</span> <span class="quasi_keyword">rule</span><span class="main"><span class="main">:</span></span>lift_valid_edge.induct<span class="main">)</span>
        <span class="keyword3"><span class="command">case</span></span> lve_edge <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?case</span></span></span> <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">dest</span><span class="main"><span class="main">:</span></span>deterministic <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span>knd_def<span class="main">)</span>
      <span class="keyword1"><span class="command">next</span></span>
        <span class="keyword3"><span class="command">case</span></span> <span class="main">(</span>lve_Exit_edge <span class="skolem">e'</span><span class="main">)</span>
        <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">e</span> <span class="main">=</span> <span class="main">(</span>Node <span class="main">(</span><span class="free">sourcenode</span> <span class="skolem">a</span><span class="main">)</span><span class="main">,</span> <span class="free">kind</span> <span class="skolem">a</span><span class="main">,</span> Node <span class="main">(</span><span class="free">targetnode</span> <span class="skolem">a</span><span class="main">)</span><span class="main">)</span>›</span></span>
          <span class="quoted"><span class="quoted">‹<span class="skolem">e'</span> <span class="main">=</span> <span class="main">(</span>Node <span class="free">Exit</span><span class="main">,</span> <span class="main">(</span><span class="main">λ</span><span class="bound">s</span><span class="main">.</span> True<span class="main">)<span class="hidden">⇩</span><sub>√</sub></span><span class="main">,</span> NewExit<span class="main">)</span>›</span></span> <span class="quoted"><span class="quoted">‹src <span class="skolem">e</span> <span class="main">=</span> src <span class="skolem">e'</span>›</span></span>
        <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">sourcenode</span> <span class="skolem">a</span> <span class="main">=</span> <span class="free">Exit</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
        <span class="keyword1"><span class="command">with</span></span> <span class="quoted"><span class="quoted">‹<span class="free">valid_edge</span> <span class="skolem">a</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted">False</span> <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">rule</span> Exit_source<span class="main">)</span>
        <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?case</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
      <span class="keyword1"><span class="command">qed</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">qed</span></span> <span class="main">(</span><span class="operator">fastforce</span> <span class="quasi_keyword">elim</span><span class="main"><span class="main">:</span></span>lift_valid_edge.cases <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span>knd_def<span class="main">)</span><span class="main"><span class="keyword3">+</span></span>
  <span class="keyword1"><span class="command">qed</span></span>
<span class="keyword1"><span class="command">qed</span></span>


<span class="keyword1"><span class="command">lemma</span></span> lift_CFGExit<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> wf<span class="main">:</span><span class="quoted"><span class="quoted">"CFGExit_wf <span class="free">sourcenode</span> <span class="free">targetnode</span> <span class="free">kind</span> <span class="free">valid_edge</span> <span class="free">Entry</span> <span class="free">Def</span> <span class="free">Use</span>
                         <span class="free">state_val</span> <span class="free">Exit</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"CFGExit src trg knd 
         <span class="main">(</span>lift_valid_edge <span class="free">valid_edge</span> <span class="free">sourcenode</span> <span class="free">targetnode</span> <span class="free">kind</span> <span class="free">Entry</span> <span class="free">Exit</span><span class="main">)</span> 
         NewEntry NewExit"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">interpret</span></span> CFGExit_wf <span class="quoted"><span class="free">sourcenode</span></span> <span class="quoted"><span class="free">targetnode</span></span> <span class="quoted"><span class="free">kind</span></span> <span class="quoted"><span class="free">valid_edge</span></span> <span class="quoted"><span class="free">Entry</span></span> <span class="quoted"><span class="free">Def</span></span> <span class="quoted"><span class="free">Use</span></span>
                       <span class="quoted"><span class="free">state_val</span></span> <span class="quoted"><span class="free">Exit</span></span>
    <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">rule</span> wf<span class="main">)</span>
  <span class="keyword1"><span class="command">interpret</span></span> CFG<span class="main">:</span>CFG <span class="quoted">src</span> <span class="quoted">trg</span> <span class="quoted">knd</span>
    <span class="quoted"><span class="quoted">"lift_valid_edge <span class="free">valid_edge</span> <span class="free">sourcenode</span> <span class="free">targetnode</span> <span class="free">kind</span> <span class="free">Entry</span> <span class="free">Exit</span>"</span></span> <span class="quoted">NewEntry</span>
    <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">fastforce</span> <span class="quasi_keyword">intro</span><span class="main"><span class="main">:</span></span>lift_CFG wf<span class="main">)</span>
  <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
  <span class="keyword1"><span class="command">proof</span></span>
    <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">a</span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"lift_valid_edge <span class="free">valid_edge</span> <span class="free">sourcenode</span> <span class="free">targetnode</span> <span class="free">kind</span> <span class="free">Entry</span> <span class="free">Exit</span> <span class="skolem">a</span>"</span></span>
      <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"src <span class="skolem">a</span> <span class="main">=</span> NewExit"</span></span>
    <span class="keyword3"><span class="command">thus</span></span> <span class="quoted">False</span> <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">fastforce</span> <span class="quasi_keyword">elim</span><span class="main"><span class="main">:</span></span>lift_valid_edge.cases<span class="main">)</span>
  <span class="keyword1"><span class="command">next</span></span>
    <span class="keyword1"><span class="command">from</span></span> lve_Entry_Exit_edge
    <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound">a</span><span class="main">.</span> lift_valid_edge <span class="free">valid_edge</span> <span class="free">sourcenode</span> <span class="free">targetnode</span> <span class="free">kind</span> <span class="free">Entry</span> <span class="free">Exit</span> <span class="bound">a</span> <span class="main">∧</span>
              src <span class="bound">a</span> <span class="main">=</span> NewEntry <span class="main">∧</span> trg <span class="bound">a</span> <span class="main">=</span> NewExit <span class="main">∧</span> knd <span class="bound">a</span> <span class="main">=</span> <span class="main">(</span><span class="main">λ</span><span class="bound">s</span><span class="main">.</span> False<span class="main">)<span class="hidden">⇩</span><sub>√</sub></span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">fastforce</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span>knd_def<span class="main">)</span>
  <span class="keyword1"><span class="command">qed</span></span>
<span class="keyword1"><span class="command">qed</span></span>


<span class="keyword1"><span class="command">lemma</span></span> lift_CFGExit_wf<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> wf<span class="main">:</span><span class="quoted"><span class="quoted">"CFGExit_wf <span class="free">sourcenode</span> <span class="free">targetnode</span> <span class="free">kind</span> <span class="free">valid_edge</span> <span class="free">Entry</span> <span class="free">Def</span> <span class="free">Use</span>
                         <span class="free">state_val</span> <span class="free">Exit</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"CFGExit_wf src trg knd 
        <span class="main">(</span>lift_valid_edge <span class="free">valid_edge</span> <span class="free">sourcenode</span> <span class="free">targetnode</span> <span class="free">kind</span> <span class="free">Entry</span> <span class="free">Exit</span><span class="main">)</span> NewEntry
        <span class="main">(</span>lift_Def <span class="free">Def</span> <span class="free">Entry</span> <span class="free">Exit</span> <span class="free">H</span> <span class="free">L</span><span class="main">)</span> <span class="main">(</span>lift_Use <span class="free">Use</span> <span class="free">Entry</span> <span class="free">Exit</span> <span class="free">H</span> <span class="free">L</span><span class="main">)</span> <span class="free">state_val</span> NewExit"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">interpret</span></span> CFGExit_wf <span class="quoted"><span class="free">sourcenode</span></span> <span class="quoted"><span class="free">targetnode</span></span> <span class="quoted"><span class="free">kind</span></span> <span class="quoted"><span class="free">valid_edge</span></span> <span class="quoted"><span class="free">Entry</span></span> <span class="quoted"><span class="free">Def</span></span> <span class="quoted"><span class="free">Use</span></span>
                       <span class="quoted"><span class="free">state_val</span></span> <span class="quoted"><span class="free">Exit</span></span>
    <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">rule</span> wf<span class="main">)</span>
  <span class="keyword1"><span class="command">interpret</span></span> CFGExit<span class="main">:</span>CFGExit <span class="quoted">src</span> <span class="quoted">trg</span> <span class="quoted">knd</span>
    <span class="quoted"><span class="quoted">"lift_valid_edge <span class="free">valid_edge</span> <span class="free">sourcenode</span> <span class="free">targetnode</span> <span class="free">kind</span> <span class="free">Entry</span> <span class="free">Exit</span>"</span></span> 
    <span class="quoted">NewEntry</span> <span class="quoted">NewExit</span>
    <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">fastforce</span> <span class="quasi_keyword">intro</span><span class="main"><span class="main">:</span></span>lift_CFGExit wf<span class="main">)</span>
  <span class="keyword1"><span class="command">interpret</span></span> CFG_wf<span class="main">:</span>CFG_wf <span class="quoted">src</span> <span class="quoted">trg</span> <span class="quoted">knd</span>
    <span class="quoted"><span class="quoted">"lift_valid_edge <span class="free">valid_edge</span> <span class="free">sourcenode</span> <span class="free">targetnode</span> <span class="free">kind</span> <span class="free">Entry</span> <span class="free">Exit</span>"</span></span> 
    <span class="quoted">NewEntry</span> <span class="quoted"><span class="quoted">"lift_Def <span class="free">Def</span> <span class="free">Entry</span> <span class="free">Exit</span> <span class="free">H</span> <span class="free">L</span>"</span></span> <span class="quoted"><span class="quoted">"lift_Use <span class="free">Use</span> <span class="free">Entry</span> <span class="free">Exit</span> <span class="free">H</span> <span class="free">L</span>"</span></span> <span class="quoted"><span class="free">state_val</span></span>
    <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">fastforce</span> <span class="quasi_keyword">intro</span><span class="main"><span class="main">:</span></span>lift_CFG_wf wf<span class="main">)</span>
  <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
  <span class="keyword1"><span class="command">proof</span></span>
    <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"lift_Def <span class="free">Def</span> <span class="free">Entry</span> <span class="free">Exit</span> <span class="free">H</span> <span class="free">L</span> NewExit <span class="main">=</span> <span class="main">{}</span> <span class="main">∧</span>
          lift_Use <span class="free">Use</span> <span class="free">Entry</span> <span class="free">Exit</span> <span class="free">H</span> <span class="free">L</span> NewExit <span class="main">=</span> <span class="main">{}</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">fastforce</span> <span class="quasi_keyword">elim</span><span class="main"><span class="main">:</span></span>lift_Use_set.cases lift_Def_set.cases<span class="main">)</span>
  <span class="keyword1"><span class="command">qed</span></span>
<span class="keyword1"><span class="command">qed</span></span>



<span class="keyword1"><span class="command">subsubsection</span></span> <span class="quoted"><span class="plain_text">‹Lifting <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">term</span></span> <span class="quoted"><span class="free"><span class="quoted"><span class="free">wod_backward_slice</span></span></span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span>›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> lift_wod_backward_slice<span class="main">:</span>
  <span class="keyword2"><span class="keyword">fixes</span></span> <span class="free">valid_edge</span> <span class="keyword2"><span class="keyword">and</span></span> <span class="free">sourcenode</span> <span class="keyword2"><span class="keyword">and</span></span> <span class="free">targetnode</span> <span class="keyword2"><span class="keyword">and</span></span> <span class="free">kind</span> <span class="keyword2"><span class="keyword">and</span></span> <span class="free">Entry</span> <span class="keyword2"><span class="keyword">and</span></span> <span class="free">Exit</span>
  <span class="keyword2"><span class="keyword">and</span></span> <span class="free">Def</span> <span class="keyword2"><span class="keyword">and</span></span> <span class="free">Use</span> <span class="keyword2"><span class="keyword">and</span></span> <span class="free">H</span> <span class="keyword2"><span class="keyword">and</span></span> <span class="free">L</span>
  <span class="keyword2"><span class="keyword">defines</span></span> lve<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="free">lve</span> <span class="main">≡</span> lift_valid_edge <span class="free">valid_edge</span> <span class="free">sourcenode</span> <span class="free">targetnode</span> <span class="free">kind</span> <span class="free">Entry</span> <span class="free">Exit</span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> lDef<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="free">lDef</span> <span class="main">≡</span> lift_Def <span class="free">Def</span> <span class="free">Entry</span> <span class="free">Exit</span> <span class="free">H</span> <span class="free">L</span>"</span></span> 
  <span class="keyword2"><span class="keyword">and</span></span> lUse<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="free">lUse</span> <span class="main">≡</span> lift_Use <span class="free">Use</span> <span class="free">Entry</span> <span class="free">Exit</span> <span class="free">H</span> <span class="free">L</span>"</span></span>
  <span class="keyword2"><span class="keyword">assumes</span></span> wf<span class="main">:</span><span class="quoted"><span class="quoted">"CFGExit_wf <span class="free">sourcenode</span> <span class="free">targetnode</span> <span class="free">kind</span> <span class="free">valid_edge</span> <span class="free">Entry</span> <span class="free">Def</span> <span class="free">Use</span>
                         <span class="free">state_val</span> <span class="free">Exit</span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">H</span> <span class="main">∩</span> <span class="free">L</span> <span class="main">=</span> <span class="main">{}</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">H</span> <span class="main">∪</span> <span class="free">L</span> <span class="main">=</span> UNIV"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"NonInterferenceIntraGraph src trg knd <span class="free">lve</span> NewEntry <span class="free">lDef</span> <span class="free">lUse</span> <span class="free">state_val</span> 
         <span class="main">(</span>CFG_wf.wod_backward_slice src trg <span class="free">lve</span> <span class="free">lDef</span> <span class="free">lUse</span><span class="main">)</span>
         NewExit <span class="free">H</span> <span class="free">L</span> <span class="main">(</span>Node <span class="free">Entry</span><span class="main">)</span> <span class="main">(</span>Node <span class="free">Exit</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">interpret</span></span> CFGExit_wf <span class="quoted"><span class="free">sourcenode</span></span> <span class="quoted"><span class="free">targetnode</span></span> <span class="quoted"><span class="free">kind</span></span> <span class="quoted"><span class="free">valid_edge</span></span> <span class="quoted"><span class="free">Entry</span></span> <span class="quoted"><span class="free">Def</span></span> <span class="quoted"><span class="free">Use</span></span>
                       <span class="quoted"><span class="free">state_val</span></span> <span class="quoted"><span class="free">Exit</span></span>
    <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">rule</span> wf<span class="main">)</span>
  <span class="keyword1"><span class="command">interpret</span></span> CFGExit_wf<span class="main">:</span>
    CFGExit_wf <span class="quoted">src</span> <span class="quoted">trg</span> <span class="quoted">knd</span> <span class="quoted"><span class="free">lve</span></span> <span class="quoted">NewEntry</span> <span class="quoted"><span class="free">lDef</span></span> <span class="quoted"><span class="free">lUse</span></span> <span class="quoted"><span class="free">state_val</span></span> <span class="quoted">NewExit</span>
    <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">fastforce</span> <span class="quasi_keyword">intro</span><span class="main"><span class="main">:</span></span>lift_CFGExit_wf wf <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span>lve lDef lUse<span class="main">)</span>
  <span class="keyword1"><span class="command">from</span></span> wf lve <span class="keyword1"><span class="command">have</span></span> CFG<span class="main">:</span><span class="quoted"><span class="quoted">"CFG src trg <span class="free">lve</span> NewEntry"</span></span>
    <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">fastforce</span> <span class="quasi_keyword">intro</span><span class="main"><span class="main">:</span></span>lift_CFG<span class="main">)</span>
  <span class="keyword1"><span class="command">from</span></span> wf lve lDef lUse <span class="keyword1"><span class="command">have</span></span> CFG_wf<span class="main">:</span><span class="quoted"><span class="quoted">"CFG_wf src trg knd <span class="free">lve</span> NewEntry
    <span class="free">lDef</span> <span class="free">lUse</span> <span class="free">state_val</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">fastforce</span> <span class="quasi_keyword">intro</span><span class="main"><span class="main">:</span></span>lift_CFG_wf<span class="main">)</span>
  <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
  <span class="keyword1"><span class="command">proof</span></span>
    <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">n</span> <span class="skolem">S</span>
    <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">n</span> <span class="main">∈</span> CFG_wf.wod_backward_slice src trg <span class="free">lve</span> <span class="free">lDef</span> <span class="free">lUse</span> <span class="skolem">S</span>"</span></span>
    <span class="keyword1"><span class="command">with</span></span> CFG_wf <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"CFG.valid_node src trg <span class="free">lve</span> <span class="skolem">n</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">-</span><span class="main">(</span><span class="operator">rule</span> CFG_wf.wod_backward_slice_valid_node<span class="main">)</span>
  <span class="keyword1"><span class="command">next</span></span>
    <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">n</span> <span class="skolem">S</span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"CFG.valid_node src trg <span class="free">lve</span> <span class="skolem">n</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">n</span> <span class="main">∈</span> <span class="skolem">S</span>"</span></span>
    <span class="keyword1"><span class="command">with</span></span> CFG_wf <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">n</span> <span class="main">∈</span> CFG_wf.wod_backward_slice src trg <span class="free">lve</span> <span class="free">lDef</span> <span class="free">lUse</span> <span class="skolem">S</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">-</span><span class="main">(</span><span class="operator">rule</span> CFG_wf.refl<span class="main">)</span>
  <span class="keyword1"><span class="command">next</span></span>
    <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">n'</span> <span class="skolem">S</span> <span class="skolem">n</span> <span class="skolem">V</span>
    <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">n'</span> <span class="main">∈</span> CFG_wf.wod_backward_slice src trg <span class="free">lve</span> <span class="free">lDef</span> <span class="free">lUse</span> <span class="skolem">S</span>"</span></span>
      <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"CFG_wf.data_dependence src trg <span class="free">lve</span> <span class="free">lDef</span> <span class="free">lUse</span> <span class="skolem">n</span> <span class="skolem">V</span> <span class="skolem">n'</span>"</span></span>
    <span class="keyword1"><span class="command">with</span></span> CFG_wf <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">n</span> <span class="main">∈</span> CFG_wf.wod_backward_slice src trg <span class="free">lve</span> <span class="free">lDef</span> <span class="free">lUse</span> <span class="skolem">S</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">-</span><span class="main">(</span><span class="operator">rule</span> CFG_wf.dd_closed<span class="main">)</span>
  <span class="keyword1"><span class="command">next</span></span>
    <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">n</span> <span class="skolem">S</span>
    <span class="keyword1"><span class="command">from</span></span> CFG_wf 
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">∃</span><span class="bound">m</span><span class="main">.</span> <span class="main">(</span>CFG.obs src trg <span class="free">lve</span> <span class="skolem">n</span>
        <span class="main">(</span>CFG_wf.wod_backward_slice src trg <span class="free">lve</span> <span class="free">lDef</span> <span class="free">lUse</span> <span class="skolem">S</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> <span class="main">{</span><span class="bound">m</span><span class="main">}</span><span class="main">)</span> <span class="main">∨</span>
      CFG.obs src trg <span class="free">lve</span> <span class="skolem">n</span> <span class="main">(</span>CFG_wf.wod_backward_slice src trg <span class="free">lve</span> <span class="free">lDef</span> <span class="free">lUse</span> <span class="skolem">S</span><span class="main">)</span> <span class="main">=</span> <span class="main">{}</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">rule</span> CFG_wf.obs_singleton<span class="main">)</span>
    <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"finite 
      <span class="main">(</span>CFG.obs src trg <span class="free">lve</span> <span class="skolem">n</span> <span class="main">(</span>CFG_wf.wod_backward_slice src trg <span class="free">lve</span> <span class="free">lDef</span> <span class="free">lUse</span> <span class="skolem">S</span><span class="main">)</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">fastforce</span>
  <span class="keyword1"><span class="command">next</span></span>
    <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">n</span> <span class="skolem">S</span>
    <span class="keyword1"><span class="command">from</span></span> CFG_wf 
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">∃</span><span class="bound">m</span><span class="main">.</span> <span class="main">(</span>CFG.obs src trg <span class="free">lve</span> <span class="skolem">n</span>
        <span class="main">(</span>CFG_wf.wod_backward_slice src trg <span class="free">lve</span> <span class="free">lDef</span> <span class="free">lUse</span> <span class="skolem">S</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> <span class="main">{</span><span class="bound">m</span><span class="main">}</span><span class="main">)</span> <span class="main">∨</span>
      CFG.obs src trg <span class="free">lve</span> <span class="skolem">n</span> <span class="main">(</span>CFG_wf.wod_backward_slice src trg <span class="free">lve</span> <span class="free">lDef</span> <span class="free">lUse</span> <span class="skolem">S</span><span class="main">)</span> <span class="main">=</span> <span class="main">{}</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">rule</span> CFG_wf.obs_singleton<span class="main">)</span>
    <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"card <span class="main">(</span>CFG.obs src trg <span class="free">lve</span> <span class="skolem">n</span>
                        <span class="main">(</span>CFG_wf.wod_backward_slice src trg <span class="free">lve</span> <span class="free">lDef</span> <span class="free">lUse</span> <span class="skolem">S</span><span class="main">)</span><span class="main">)</span> <span class="main">≤</span> <span class="main">1</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">fastforce</span>
  <span class="keyword1"><span class="command">next</span></span>
    <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">a</span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="free">lve</span> <span class="skolem">a</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"src <span class="skolem">a</span> <span class="main">=</span> NewEntry"</span></span>
    <span class="keyword1"><span class="command">with</span></span> lve <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"trg <span class="skolem">a</span> <span class="main">=</span> NewExit <span class="main">∨</span> trg <span class="skolem">a</span> <span class="main">=</span> Node <span class="free">Entry</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">fastforce</span> <span class="quasi_keyword">elim</span><span class="main"><span class="main">:</span></span>lift_valid_edge.cases<span class="main">)</span>
  <span class="keyword1"><span class="command">next</span></span>
    <span class="keyword1"><span class="command">from</span></span> lve_Entry_edge lve
    <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound">a</span><span class="main">.</span> <span class="free">lve</span> <span class="bound">a</span> <span class="main">∧</span> src <span class="bound">a</span> <span class="main">=</span> NewEntry <span class="main">∧</span> trg <span class="bound">a</span> <span class="main">=</span> Node <span class="free">Entry</span> <span class="main">∧</span> knd <span class="bound">a</span> <span class="main">=</span> <span class="main">(</span><span class="main">λ</span><span class="bound">s</span><span class="main">.</span> True<span class="main">)<span class="hidden">⇩</span><sub>√</sub></span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">fastforce</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span>knd_def<span class="main">)</span>
  <span class="keyword1"><span class="command">next</span></span>
    <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">a</span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="free">lve</span> <span class="skolem">a</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"trg <span class="skolem">a</span> <span class="main">=</span> Node <span class="free">Entry</span>"</span></span>
    <span class="keyword1"><span class="command">with</span></span> lve <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"src <span class="skolem">a</span> <span class="main">=</span> NewEntry"</span></span> <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">fastforce</span> <span class="quasi_keyword">elim</span><span class="main"><span class="main">:</span></span>lift_valid_edge.cases<span class="main">)</span>
  <span class="keyword1"><span class="command">next</span></span>
    <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">a</span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="free">lve</span> <span class="skolem">a</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"trg <span class="skolem">a</span> <span class="main">=</span> NewExit"</span></span>
    <span class="keyword1"><span class="command">with</span></span> lve <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"src <span class="skolem">a</span> <span class="main">=</span> NewEntry <span class="main">∨</span> src <span class="skolem">a</span> <span class="main">=</span> Node <span class="free">Exit</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">fastforce</span> <span class="quasi_keyword">elim</span><span class="main"><span class="main">:</span></span>lift_valid_edge.cases<span class="main">)</span>
  <span class="keyword1"><span class="command">next</span></span>
    <span class="keyword1"><span class="command">from</span></span> lve_Exit_edge lve
    <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound">a</span><span class="main">.</span> <span class="free">lve</span> <span class="bound">a</span> <span class="main">∧</span> src <span class="bound">a</span> <span class="main">=</span> Node <span class="free">Exit</span> <span class="main">∧</span> trg <span class="bound">a</span> <span class="main">=</span> NewExit <span class="main">∧</span> knd <span class="bound">a</span> <span class="main">=</span> <span class="main">(</span><span class="main">λ</span><span class="bound">s</span><span class="main">.</span> True<span class="main">)<span class="hidden">⇩</span><sub>√</sub></span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">fastforce</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span>knd_def<span class="main">)</span>
  <span class="keyword1"><span class="command">next</span></span>
    <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">a</span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="free">lve</span> <span class="skolem">a</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"src <span class="skolem">a</span> <span class="main">=</span> Node <span class="free">Exit</span>"</span></span>
    <span class="keyword1"><span class="command">with</span></span> lve <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"trg <span class="skolem">a</span> <span class="main">=</span> NewExit"</span></span> <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">fastforce</span> <span class="quasi_keyword">elim</span><span class="main"><span class="main">:</span></span>lift_valid_edge.cases<span class="main">)</span>
  <span class="keyword1"><span class="command">next</span></span>
    <span class="keyword1"><span class="command">from</span></span> lDef <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="free">lDef</span> <span class="main">(</span>Node <span class="free">Entry</span><span class="main">)</span> <span class="main">=</span> <span class="free">H</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">fastforce</span> <span class="quasi_keyword">elim</span><span class="main"><span class="main">:</span></span>lift_Def_set.cases <span class="quasi_keyword">intro</span><span class="main"><span class="main">:</span></span>lift_Def_High<span class="main">)</span>
  <span class="keyword1"><span class="command">next</span></span>
    <span class="keyword1"><span class="command">from</span></span> Entry_noteq_Exit lUse <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="free">lUse</span> <span class="main">(</span>Node <span class="free">Entry</span><span class="main">)</span> <span class="main">=</span> <span class="free">H</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">fastforce</span> <span class="quasi_keyword">elim</span><span class="main"><span class="main">:</span></span>lift_Use_set.cases <span class="quasi_keyword">intro</span><span class="main"><span class="main">:</span></span>lift_Use_High<span class="main">)</span>
  <span class="keyword1"><span class="command">next</span></span>
    <span class="keyword1"><span class="command">from</span></span> Entry_noteq_Exit lUse <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="free">lUse</span> <span class="main">(</span>Node <span class="free">Exit</span><span class="main">)</span> <span class="main">=</span> <span class="free">L</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">fastforce</span> <span class="quasi_keyword">elim</span><span class="main"><span class="main">:</span></span>lift_Use_set.cases <span class="quasi_keyword">intro</span><span class="main"><span class="main">:</span></span>lift_Use_Low<span class="main">)</span>
  <span class="keyword1"><span class="command">next</span></span>
    <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="free">H</span> <span class="main">∩</span> <span class="free">L</span> <span class="main">=</span> <span class="main">{}</span>›</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="free">H</span> <span class="main">∩</span> <span class="free">L</span> <span class="main">=</span> <span class="main">{}</span>"</span></span> <span class="keyword1"><span class="command">.</span></span>
  <span class="keyword1"><span class="command">next</span></span>
    <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="free">H</span> <span class="main">∪</span> <span class="free">L</span> <span class="main">=</span> UNIV›</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="free">H</span> <span class="main">∪</span> <span class="free">L</span> <span class="main">=</span> UNIV"</span></span> <span class="keyword1"><span class="command">.</span></span>
  <span class="keyword1"><span class="command">qed</span></span>
<span class="keyword1"><span class="command">qed</span></span>


<span class="keyword1"><span class="command">subsubsection</span></span> <span class="quoted"><span class="plain_text">‹Lifting <span class="antiquoted"><span class="raw_text"><span class="antiquoted"><span class="raw_text"><span class="operator"><span class="operator">‹</span></span>PDG_BS›</span></span></span></span> with <span class="antiquoted"><span class="raw_text"><span class="antiquoted"><span class="raw_text"><span class="operator"><span class="operator">‹</span></span>standard_control_dependence›</span></span></span></span>›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> lift_Postdomination<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> wf<span class="main">:</span><span class="quoted"><span class="quoted">"CFGExit_wf <span class="free">sourcenode</span> <span class="free">targetnode</span> <span class="free">kind</span> <span class="free">valid_edge</span> <span class="free">Entry</span> <span class="free">Def</span> <span class="free">Use</span>
                         <span class="free">state_val</span> <span class="free">Exit</span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> pd<span class="main">:</span><span class="quoted"><span class="quoted">"Postdomination <span class="free">sourcenode</span> <span class="free">targetnode</span> <span class="free">kind</span> <span class="free">valid_edge</span> <span class="free">Entry</span> <span class="free">Exit</span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> inner<span class="main">:</span><span class="quoted"><span class="quoted">"CFGExit.inner_node <span class="free">sourcenode</span> <span class="free">targetnode</span> <span class="free">valid_edge</span> <span class="free">Entry</span> <span class="free">Exit</span> <span class="free">nx</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"Postdomination src trg knd
  <span class="main">(</span>lift_valid_edge <span class="free">valid_edge</span> <span class="free">sourcenode</span> <span class="free">targetnode</span> <span class="free">kind</span> <span class="free">Entry</span> <span class="free">Exit</span><span class="main">)</span> NewEntry NewExit"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">interpret</span></span> Postdomination <span class="quoted"><span class="free">sourcenode</span></span> <span class="quoted"><span class="free">targetnode</span></span> <span class="quoted"><span class="free">kind</span></span> <span class="quoted"><span class="free">valid_edge</span></span> <span class="quoted"><span class="free">Entry</span></span> <span class="quoted"><span class="free">Exit</span></span>
    <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">rule</span> pd<span class="main">)</span>
  <span class="keyword1"><span class="command">interpret</span></span> CFGExit_wf<span class="main">:</span>CFGExit_wf <span class="quoted">src</span> <span class="quoted">trg</span> <span class="quoted">knd</span>
    <span class="quoted"><span class="quoted">"lift_valid_edge <span class="free">valid_edge</span> <span class="free">sourcenode</span> <span class="free">targetnode</span> <span class="free">kind</span> <span class="free">Entry</span> <span class="free">Exit</span>"</span></span> <span class="quoted">NewEntry</span>
    <span class="quoted"><span class="quoted">"lift_Def <span class="free">Def</span> <span class="free">Entry</span> <span class="free">Exit</span> <span class="free">H</span> <span class="free">L</span>"</span></span> <span class="quoted"><span class="quoted">"lift_Use <span class="free">Use</span> <span class="free">Entry</span> <span class="free">Exit</span> <span class="free">H</span> <span class="free">L</span>"</span></span> <span class="quoted"><span class="free">state_val</span></span> <span class="quoted">NewExit</span>
    <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">fastforce</span> <span class="quasi_keyword">intro</span><span class="main"><span class="main">:</span></span>lift_CFGExit_wf wf<span class="main">)</span>
  <span class="keyword1"><span class="command">from</span></span> wf <span class="keyword1"><span class="command">have</span></span> CFG<span class="main">:</span><span class="quoted"><span class="quoted">"CFG src trg
    <span class="main">(</span>lift_valid_edge <span class="free">valid_edge</span> <span class="free">sourcenode</span> <span class="free">targetnode</span> <span class="free">kind</span> <span class="free">Entry</span> <span class="free">Exit</span><span class="main">)</span> NewEntry"</span></span>
    <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">rule</span> lift_CFG<span class="main">)</span>
  <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
  <span class="keyword1"><span class="command">proof</span></span>
    <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">n</span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"CFG.valid_node src trg
      <span class="main">(</span>lift_valid_edge <span class="free">valid_edge</span> <span class="free">sourcenode</span> <span class="free">targetnode</span> <span class="free">kind</span> <span class="free">Entry</span> <span class="free">Exit</span><span class="main">)</span> <span class="skolem">n</span>"</span></span>
    <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound">as</span><span class="main">.</span> CFG.path src trg
      <span class="main">(</span>lift_valid_edge <span class="free">valid_edge</span> <span class="free">sourcenode</span> <span class="free">targetnode</span> <span class="free">kind</span> <span class="free">Entry</span> <span class="free">Exit</span><span class="main">)</span>
      NewEntry <span class="bound">as</span> <span class="skolem">n</span>"</span></span>
    <span class="keyword1"><span class="command">proof</span></span><span class="main">(</span><span class="operator">cases</span> <span class="quoted"><span class="skolem">n</span></span><span class="main">)</span>
      <span class="keyword3"><span class="command">case</span></span> NewEntry
      <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"lift_valid_edge <span class="free">valid_edge</span> <span class="free">sourcenode</span> <span class="free">targetnode</span> <span class="free">kind</span> <span class="free">Entry</span> <span class="free">Exit</span>
        <span class="main">(</span>NewEntry<span class="main">,</span><span class="main">(</span><span class="main">λ</span><span class="bound">s</span><span class="main">.</span> False<span class="main">)<span class="hidden">⇩</span><sub>√</sub></span><span class="main">,</span>NewExit<span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">fastforce</span> <span class="quasi_keyword">intro</span><span class="main"><span class="main">:</span></span>lve_Entry_Exit_edge<span class="main">)</span>
      <span class="keyword1"><span class="command">with</span></span> NewEntry <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"CFG.path src trg
        <span class="main">(</span>lift_valid_edge <span class="free">valid_edge</span> <span class="free">sourcenode</span> <span class="free">targetnode</span> <span class="free">kind</span> <span class="free">Entry</span> <span class="free">Exit</span><span class="main">)</span>
        NewEntry <span class="main">[]</span> <span class="skolem">n</span>"</span></span>
        <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">fastforce</span> <span class="quasi_keyword">intro</span><span class="main"><span class="main">:</span></span>CFG.empty_path<span class="main"><span class="main">[</span></span><span class="operator">OF</span> CFG<span class="main"><span class="main">]</span></span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span>CFG.valid_node_def<span class="main"><span class="main">[</span></span><span class="operator">OF</span> CFG<span class="main"><span class="main">]</span></span><span class="main">)</span>
      <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
    <span class="keyword1"><span class="command">next</span></span>
      <span class="keyword3"><span class="command">case</span></span> NewExit
      <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"lift_valid_edge <span class="free">valid_edge</span> <span class="free">sourcenode</span> <span class="free">targetnode</span> <span class="free">kind</span> <span class="free">Entry</span> <span class="free">Exit</span>
        <span class="main">(</span>NewEntry<span class="main">,</span><span class="main">(</span><span class="main">λ</span><span class="bound">s</span><span class="main">.</span> False<span class="main">)<span class="hidden">⇩</span><sub>√</sub></span><span class="main">,</span>NewExit<span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">fastforce</span> <span class="quasi_keyword">intro</span><span class="main"><span class="main">:</span></span>lve_Entry_Exit_edge<span class="main">)</span>
      <span class="keyword1"><span class="command">with</span></span> NewExit <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"CFG.path src trg
        <span class="main">(</span>lift_valid_edge <span class="free">valid_edge</span> <span class="free">sourcenode</span> <span class="free">targetnode</span> <span class="free">kind</span> <span class="free">Entry</span> <span class="free">Exit</span><span class="main">)</span>
        NewEntry <span class="main">[</span><span class="main">(</span>NewEntry<span class="main">,</span><span class="main">(</span><span class="main">λ</span><span class="bound">s</span><span class="main">.</span> False<span class="main">)<span class="hidden">⇩</span><sub>√</sub></span><span class="main">,</span>NewExit<span class="main">)</span><span class="main">]</span> <span class="skolem">n</span>"</span></span>
        <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">fastforce</span> <span class="quasi_keyword">intro</span><span class="main"><span class="main">:</span></span>CFG.Cons_path<span class="main"><span class="main">[</span></span><span class="operator">OF</span> CFG<span class="main"><span class="main">]</span></span> CFG.empty_path<span class="main"><span class="main">[</span></span><span class="operator">OF</span> CFG<span class="main"><span class="main">]</span></span>
                     <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span>CFG.valid_node_def<span class="main"><span class="main">[</span></span><span class="operator">OF</span> CFG<span class="main"><span class="main">]</span></span><span class="main">)</span>
      <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
    <span class="keyword1"><span class="command">next</span></span>
      <span class="keyword3"><span class="command">case</span></span> <span class="main">(</span>Node <span class="skolem">m</span><span class="main">)</span>
      <span class="keyword1"><span class="command">with</span></span> Entry_Exit_edge <span class="quoted"><span class="quoted">‹CFG.valid_node src trg
        <span class="main">(</span>lift_valid_edge <span class="free">valid_edge</span> <span class="free">sourcenode</span> <span class="free">targetnode</span> <span class="free">kind</span> <span class="free">Entry</span> <span class="free">Exit</span><span class="main">)</span> <span class="skolem">n</span>›</span></span>
      <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"valid_node <span class="skolem">m</span>"</span></span> 
        <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">elim</span><span class="main"><span class="main">:</span></span>lift_valid_edge.cases 
                <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span>CFG.valid_node_def<span class="main"><span class="main">[</span></span><span class="operator">OF</span> CFG<span class="main"><span class="main">]</span></span> valid_node_def<span class="main">)</span>
      <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
      <span class="keyword1"><span class="command">proof</span></span><span class="main">(</span><span class="operator">cases</span> <span class="quoted"><span class="skolem">m</span></span> <span class="quasi_keyword">rule</span><span class="main"><span class="main">:</span></span>valid_node_cases<span class="main">)</span>
        <span class="keyword3"><span class="command">case</span></span> Entry
        <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"lift_valid_edge <span class="free">valid_edge</span> <span class="free">sourcenode</span> <span class="free">targetnode</span> <span class="free">kind</span> <span class="free">Entry</span> <span class="free">Exit</span>
          <span class="main">(</span>NewEntry<span class="main">,</span><span class="main">(</span><span class="main">λ</span><span class="bound">s</span><span class="main">.</span> True<span class="main">)<span class="hidden">⇩</span><sub>√</sub></span><span class="main">,</span>Node <span class="free">Entry</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">fastforce</span> <span class="quasi_keyword">intro</span><span class="main"><span class="main">:</span></span>lve_Entry_edge<span class="main">)</span>
        <span class="keyword1"><span class="command">with</span></span> Entry Node <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"CFG.path src trg
          <span class="main">(</span>lift_valid_edge <span class="free">valid_edge</span> <span class="free">sourcenode</span> <span class="free">targetnode</span> <span class="free">kind</span> <span class="free">Entry</span> <span class="free">Exit</span><span class="main">)</span>
          NewEntry <span class="main">[</span><span class="main">(</span>NewEntry<span class="main">,</span><span class="main">(</span><span class="main">λ</span><span class="bound">s</span><span class="main">.</span> True<span class="main">)<span class="hidden">⇩</span><sub>√</sub></span><span class="main">,</span>Node <span class="free">Entry</span><span class="main">)</span><span class="main">]</span> <span class="skolem">n</span>"</span></span>
          <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">fastforce</span> <span class="quasi_keyword">intro</span><span class="main"><span class="main">:</span></span>CFG.Cons_path<span class="main"><span class="main">[</span></span><span class="operator">OF</span> CFG<span class="main"><span class="main">]</span></span> CFG.empty_path<span class="main"><span class="main">[</span></span><span class="operator">OF</span> CFG<span class="main"><span class="main">]</span></span>
                       <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span>CFG.valid_node_def<span class="main"><span class="main">[</span></span><span class="operator">OF</span> CFG<span class="main"><span class="main">]</span></span><span class="main">)</span>
        <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
      <span class="keyword1"><span class="command">next</span></span>
        <span class="keyword3"><span class="command">case</span></span> Exit
        <span class="keyword1"><span class="command">from</span></span> inner <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">ax</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="free">valid_edge</span> <span class="skolem">ax</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"inner_node <span class="main">(</span><span class="free">sourcenode</span> <span class="skolem">ax</span><span class="main">)</span>"</span></span>
          <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">targetnode</span> <span class="skolem">ax</span> <span class="main">=</span> <span class="free">Exit</span>"</span></span> <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">erule</span> inner_node_Exit_edge<span class="main">)</span>
        <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"lift_valid_edge <span class="free">valid_edge</span> <span class="free">sourcenode</span> <span class="free">targetnode</span> <span class="free">kind</span> <span class="free">Entry</span> <span class="free">Exit</span>
          <span class="main">(</span>Node <span class="main">(</span><span class="free">sourcenode</span> <span class="skolem">ax</span><span class="main">)</span><span class="main">,</span><span class="free">kind</span> <span class="skolem">ax</span><span class="main">,</span>Node <span class="free">Exit</span><span class="main">)</span>"</span></span>
          <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">intro</span><span class="main"><span class="main">:</span></span>lift_valid_edge.lve_edge <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span>inner_node_def<span class="main">)</span>
        <span class="keyword1"><span class="command">hence</span></span> path<span class="main">:</span><span class="quoted"><span class="quoted">"CFG.path src trg
          <span class="main">(</span>lift_valid_edge <span class="free">valid_edge</span> <span class="free">sourcenode</span> <span class="free">targetnode</span> <span class="free">kind</span> <span class="free">Entry</span> <span class="free">Exit</span><span class="main">)</span>
          <span class="main">(</span>Node <span class="main">(</span><span class="free">sourcenode</span> <span class="skolem">ax</span><span class="main">)</span><span class="main">)</span> <span class="main">[</span><span class="main">(</span>Node <span class="main">(</span><span class="free">sourcenode</span> <span class="skolem">ax</span><span class="main">)</span><span class="main">,</span><span class="free">kind</span> <span class="skolem">ax</span><span class="main">,</span>Node <span class="free">Exit</span><span class="main">)</span><span class="main">]</span> 
          <span class="main">(</span>Node <span class="free">Exit</span><span class="main">)</span>"</span></span>
          <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">fastforce</span> <span class="quasi_keyword">intro</span><span class="main"><span class="main">:</span></span>CFG.Cons_path<span class="main"><span class="main">[</span></span><span class="operator">OF</span> CFG<span class="main"><span class="main">]</span></span> CFG.empty_path<span class="main"><span class="main">[</span></span><span class="operator">OF</span> CFG<span class="main"><span class="main">]</span></span>
                       <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span>CFG.valid_node_def<span class="main"><span class="main">[</span></span><span class="operator">OF</span> CFG<span class="main"><span class="main">]</span></span><span class="main">)</span>
        <span class="keyword1"><span class="command">have</span></span> edge<span class="main">:</span><span class="quoted"><span class="quoted">"lift_valid_edge <span class="free">valid_edge</span> <span class="free">sourcenode</span> <span class="free">targetnode</span> <span class="free">kind</span> <span class="free">Entry</span> <span class="free">Exit</span>
          <span class="main">(</span>NewEntry<span class="main">,</span><span class="main">(</span><span class="main">λ</span><span class="bound">s</span><span class="main">.</span> True<span class="main">)<span class="hidden">⇩</span><sub>√</sub></span><span class="main">,</span>Node <span class="free">Entry</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">fastforce</span> <span class="quasi_keyword">intro</span><span class="main"><span class="main">:</span></span>lve_Entry_edge<span class="main">)</span>
        <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹inner_node <span class="main">(</span><span class="free">sourcenode</span> <span class="skolem">ax</span><span class="main">)</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"valid_node <span class="main">(</span><span class="free">sourcenode</span> <span class="skolem">ax</span><span class="main">)</span>"</span></span>
          <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">rule</span> inner_is_valid<span class="main">)</span>
        <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">asx</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="free">Entry</span> <span class="main">-</span><span class="skolem">asx</span><span class="main">→*</span> <span class="free">sourcenode</span> <span class="skolem">ax</span>"</span></span>
          <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">fastforce</span> <span class="quasi_keyword">dest</span><span class="main"><span class="main">:</span></span>Entry_path<span class="main">)</span>
        <span class="keyword1"><span class="command">from</span></span> this <span class="quoted"><span class="quoted">‹<span class="free">valid_edge</span> <span class="skolem">ax</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound">es</span><span class="main">.</span> CFG.path src trg
          <span class="main">(</span>lift_valid_edge <span class="free">valid_edge</span> <span class="free">sourcenode</span> <span class="free">targetnode</span> <span class="free">kind</span> <span class="free">Entry</span> <span class="free">Exit</span><span class="main">)</span>
          <span class="main">(</span>Node <span class="free">Entry</span><span class="main">)</span> <span class="bound">es</span> <span class="main">(</span>Node <span class="main">(</span><span class="free">sourcenode</span> <span class="skolem">ax</span><span class="main">)</span><span class="main">)</span>"</span></span>
        <span class="keyword1"><span class="command">proof</span></span><span class="main">(</span><span class="operator">induct</span> <span class="quoted"><span class="skolem">asx</span></span> <span class="quasi_keyword">arbitrary</span><span class="main"><span class="main">:</span></span><span class="quoted"><span class="skolem">ax</span></span> <span class="quasi_keyword">rule</span><span class="main"><span class="main">:</span></span>rev_induct<span class="main">)</span>
          <span class="keyword3"><span class="command">case</span></span> Nil
          <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="free">Entry</span> <span class="main">-</span><span class="main">[]</span><span class="main">→*</span> <span class="free">sourcenode</span> <span class="skolem">ax</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">sourcenode</span> <span class="skolem">ax</span> <span class="main">=</span> <span class="free">Entry</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">fastforce</span>
          <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"CFG.path src trg
            <span class="main">(</span>lift_valid_edge <span class="free">valid_edge</span> <span class="free">sourcenode</span> <span class="free">targetnode</span> <span class="free">kind</span> <span class="free">Entry</span> <span class="free">Exit</span><span class="main">)</span>
            <span class="main">(</span>Node <span class="free">Entry</span><span class="main">)</span> <span class="main">[]</span> <span class="main">(</span>Node <span class="main">(</span><span class="free">sourcenode</span> <span class="skolem">ax</span><span class="main">)</span><span class="main">)</span>"</span></span>
            <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="operator">simp</span> <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="main">(</span><span class="operator">rule</span> CFG.empty_path<span class="main"><span class="main">[</span></span><span class="operator">OF</span> CFG<span class="main"><span class="main">]</span></span><span class="main">)</span>
            <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">intro</span><span class="main"><span class="main">:</span></span>lve_Entry_edge <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span>CFG.valid_node_def<span class="main"><span class="main">[</span></span><span class="operator">OF</span> CFG<span class="main"><span class="main">]</span></span><span class="main">)</span>
          <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?case</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
        <span class="keyword1"><span class="command">next</span></span>
          <span class="keyword3"><span class="command">case</span></span> <span class="main">(</span>snoc <span class="skolem">x</span> <span class="skolem">xs</span><span class="main">)</span>
          <span class="keyword1"><span class="command">note</span></span> IH <span class="main">=</span> <span class="quoted"><span class="quoted">‹<span class="main">⋀</span><span class="bound">ax</span><span class="main">.</span> <span class="main">⟦</span><span class="free">Entry</span> <span class="main">-</span><span class="skolem">xs</span><span class="main">→*</span> <span class="free">sourcenode</span> <span class="bound">ax</span><span class="main">;</span> <span class="free">valid_edge</span> <span class="bound">ax</span><span class="main">⟧</span> <span class="main">⟹</span>
            <span class="main">∃</span><span class="bound">es</span><span class="main">.</span> CFG.path src trg
            <span class="main">(</span>lift_valid_edge <span class="free">valid_edge</span> <span class="free">sourcenode</span> <span class="free">targetnode</span> <span class="free">kind</span> <span class="free">Entry</span> <span class="free">Exit</span><span class="main">)</span>
            <span class="main">(</span>Node <span class="free">Entry</span><span class="main">)</span> <span class="bound">es</span> <span class="main">(</span>Node <span class="main">(</span><span class="free">sourcenode</span> <span class="bound">ax</span><span class="main">)</span><span class="main">)</span>›</span></span>
          <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="free">Entry</span> <span class="main">-</span><span class="skolem">xs</span><span class="main">@</span><span class="main">[</span><span class="skolem">x</span><span class="main">]</span><span class="main">→*</span> <span class="free">sourcenode</span> <span class="skolem">ax</span>›</span></span>
          <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">Entry</span> <span class="main">-</span><span class="skolem">xs</span><span class="main">→*</span> <span class="free">sourcenode</span> <span class="skolem">x</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">valid_edge</span> <span class="skolem">x</span>"</span></span>
            <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">targetnode</span> <span class="skolem">x</span> <span class="main">=</span> <span class="free">sourcenode</span> <span class="skolem">ax</span>"</span></span> <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">elim</span><span class="main"><span class="main">:</span></span>path_split_snoc<span class="main">)</span>
          <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="free">targetnode</span> <span class="skolem">x</span> <span class="main">=</span> <span class="free">Exit</span>"</span></span>
            <span class="keyword1"><span class="command">with</span></span> <span class="quoted"><span class="quoted">‹<span class="free">valid_edge</span> <span class="skolem">ax</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="free">targetnode</span> <span class="skolem">x</span> <span class="main">=</span> <span class="free">sourcenode</span> <span class="skolem">ax</span>›</span></span>
            <span class="keyword1"><span class="command">have</span></span> <span class="quoted">False</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">-</span><span class="main">(</span><span class="operator">rule</span> Exit_source<span class="main"><span class="keyword3">,</span></span><span class="operator">simp</span><span class="main"><span class="keyword3">+</span></span><span class="main">)</span> <span class="keyword1"><span class="command">}</span></span>
          <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="free">targetnode</span> <span class="skolem">x</span> <span class="main">≠</span> <span class="free">Exit</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">clarsimp</span>
          <span class="keyword1"><span class="command">with</span></span> <span class="quoted"><span class="quoted">‹<span class="free">valid_edge</span> <span class="skolem">x</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="free">targetnode</span> <span class="skolem">x</span> <span class="main">=</span> <span class="free">sourcenode</span> <span class="skolem">ax</span>›</span></span><span class="main">[</span><span class="operator">THEN</span> sym<span class="main">]</span>
          <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"lift_valid_edge <span class="free">valid_edge</span> <span class="free">sourcenode</span> <span class="free">targetnode</span> <span class="free">kind</span> <span class="free">Entry</span> <span class="free">Exit</span>
            <span class="main">(</span>Node <span class="main">(</span><span class="free">sourcenode</span> <span class="skolem">x</span><span class="main">)</span><span class="main">,</span><span class="free">kind</span> <span class="skolem">x</span><span class="main">,</span>Node <span class="main">(</span><span class="free">sourcenode</span> <span class="skolem">ax</span><span class="main">)</span><span class="main">)</span>"</span></span>
            <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">fastforce</span> <span class="quasi_keyword">intro</span><span class="main"><span class="main">:</span></span>lift_valid_edge.lve_edge<span class="main">)</span>
          <span class="keyword1"><span class="command">hence</span></span> path<span class="main">:</span><span class="quoted"><span class="quoted">"CFG.path src trg
            <span class="main">(</span>lift_valid_edge <span class="free">valid_edge</span> <span class="free">sourcenode</span> <span class="free">targetnode</span> <span class="free">kind</span> <span class="free">Entry</span> <span class="free">Exit</span><span class="main">)</span>
            <span class="main">(</span>Node <span class="main">(</span><span class="free">sourcenode</span> <span class="skolem">x</span><span class="main">)</span><span class="main">)</span> <span class="main">[</span><span class="main">(</span>Node <span class="main">(</span><span class="free">sourcenode</span> <span class="skolem">x</span><span class="main">)</span><span class="main">,</span><span class="free">kind</span> <span class="skolem">x</span><span class="main">,</span>Node <span class="main">(</span><span class="free">sourcenode</span> <span class="skolem">ax</span><span class="main">)</span><span class="main">)</span><span class="main">]</span> 
            <span class="main">(</span>Node <span class="main">(</span><span class="free">sourcenode</span> <span class="skolem">ax</span><span class="main">)</span><span class="main">)</span>"</span></span>
            <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">fastforce</span> <span class="quasi_keyword">intro</span><span class="main"><span class="main">:</span></span>CFG.Cons_path<span class="main"><span class="main">[</span></span><span class="operator">OF</span> CFG<span class="main"><span class="main">]</span></span> CFG.empty_path<span class="main"><span class="main">[</span></span><span class="operator">OF</span> CFG<span class="main"><span class="main">]</span></span>
                         <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span>CFG.valid_node_def<span class="main"><span class="main">[</span></span><span class="operator">OF</span> CFG<span class="main"><span class="main">]</span></span><span class="main">)</span>
          <span class="keyword1"><span class="command">from</span></span> IH<span class="main">[</span><span class="operator">OF</span> <span class="quoted"><span class="quoted">‹<span class="free">Entry</span> <span class="main">-</span><span class="skolem">xs</span><span class="main">→*</span> <span class="free">sourcenode</span> <span class="skolem">x</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="free">valid_edge</span> <span class="skolem">x</span>›</span></span><span class="main">]</span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">es</span></span>
            <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"CFG.path src trg
            <span class="main">(</span>lift_valid_edge <span class="free">valid_edge</span> <span class="free">sourcenode</span> <span class="free">targetnode</span> <span class="free">kind</span> <span class="free">Entry</span> <span class="free">Exit</span><span class="main">)</span>
            <span class="main">(</span>Node <span class="free">Entry</span><span class="main">)</span> <span class="skolem">es</span> <span class="main">(</span>Node <span class="main">(</span><span class="free">sourcenode</span> <span class="skolem">x</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
          <span class="keyword1"><span class="command">with</span></span> path <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"CFG.path src trg
            <span class="main">(</span>lift_valid_edge <span class="free">valid_edge</span> <span class="free">sourcenode</span> <span class="free">targetnode</span> <span class="free">kind</span> <span class="free">Entry</span> <span class="free">Exit</span><span class="main">)</span>
            <span class="main">(</span>Node <span class="free">Entry</span><span class="main">)</span> <span class="main">(</span><span class="skolem">es</span><span class="main">@</span><span class="main">[</span><span class="main">(</span>Node <span class="main">(</span><span class="free">sourcenode</span> <span class="skolem">x</span><span class="main">)</span><span class="main">,</span><span class="free">kind</span> <span class="skolem">x</span><span class="main">,</span>Node <span class="main">(</span><span class="free">sourcenode</span> <span class="skolem">ax</span><span class="main">)</span><span class="main">)</span><span class="main">]</span><span class="main">)</span>
            <span class="main">(</span>Node <span class="main">(</span><span class="free">sourcenode</span> <span class="skolem">ax</span><span class="main">)</span><span class="main">)</span>"</span></span>
            <span class="keyword1"><span class="command">by</span></span> <span class="operator">-</span><span class="main">(</span><span class="operator">rule</span> CFG.path_Append<span class="main"><span class="main">[</span></span><span class="operator">OF</span> CFG<span class="main"><span class="main">]</span></span><span class="main">)</span>
          <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?case</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
        <span class="keyword1"><span class="command">qed</span></span>
        <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">es</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"CFG.path src trg
          <span class="main">(</span>lift_valid_edge <span class="free">valid_edge</span> <span class="free">sourcenode</span> <span class="free">targetnode</span> <span class="free">kind</span> <span class="free">Entry</span> <span class="free">Exit</span><span class="main">)</span>
          <span class="main">(</span>Node <span class="free">Entry</span><span class="main">)</span> <span class="skolem">es</span> <span class="main">(</span>Node <span class="main">(</span><span class="free">sourcenode</span> <span class="skolem">ax</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
        <span class="keyword1"><span class="command">with</span></span> path <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"CFG.path src trg
          <span class="main">(</span>lift_valid_edge <span class="free">valid_edge</span> <span class="free">sourcenode</span> <span class="free">targetnode</span> <span class="free">kind</span> <span class="free">Entry</span> <span class="free">Exit</span><span class="main">)</span>
          <span class="main">(</span>Node <span class="free">Entry</span><span class="main">)</span> <span class="main">(</span><span class="skolem">es</span><span class="main">@</span> <span class="main">[</span><span class="main">(</span>Node <span class="main">(</span><span class="free">sourcenode</span> <span class="skolem">ax</span><span class="main">)</span><span class="main">,</span><span class="free">kind</span> <span class="skolem">ax</span><span class="main">,</span>Node <span class="free">Exit</span><span class="main">)</span><span class="main">]</span><span class="main">)</span> <span class="main">(</span>Node <span class="free">Exit</span><span class="main">)</span>"</span></span>
          <span class="keyword1"><span class="command">by</span></span> <span class="operator">-</span><span class="main">(</span><span class="operator">rule</span> CFG.path_Append<span class="main"><span class="main">[</span></span><span class="operator">OF</span> CFG<span class="main"><span class="main">]</span></span><span class="main">)</span>
        <span class="keyword1"><span class="command">with</span></span> edge <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"CFG.path src trg
          <span class="main">(</span>lift_valid_edge <span class="free">valid_edge</span> <span class="free">sourcenode</span> <span class="free">targetnode</span> <span class="free">kind</span> <span class="free">Entry</span> <span class="free">Exit</span><span class="main">)</span>
          NewEntry <span class="main">(</span><span class="main">(</span>NewEntry<span class="main">,</span><span class="main">(</span><span class="main">λ</span><span class="bound">s</span><span class="main">.</span> True<span class="main">)<span class="hidden">⇩</span><sub>√</sub></span><span class="main">,</span>Node <span class="free">Entry</span><span class="main">)</span><span class="main">#</span>
                      <span class="main">(</span><span class="skolem">es</span><span class="main">@</span> <span class="main">[</span><span class="main">(</span>Node <span class="main">(</span><span class="free">sourcenode</span> <span class="skolem">ax</span><span class="main">)</span><span class="main">,</span><span class="free">kind</span> <span class="skolem">ax</span><span class="main">,</span>Node <span class="free">Exit</span><span class="main">)</span><span class="main">]</span><span class="main">)</span><span class="main">)</span> <span class="main">(</span>Node <span class="free">Exit</span><span class="main">)</span>"</span></span>
          <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">fastforce</span> <span class="quasi_keyword">intro</span><span class="main"><span class="main">:</span></span>CFG.Cons_path<span class="main"><span class="main">[</span></span><span class="operator">OF</span> CFG<span class="main"><span class="main">]</span></span><span class="main">)</span>
        <span class="keyword1"><span class="command">with</span></span> Node Exit <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">fastforce</span>
      <span class="keyword1"><span class="command">next</span></span>
        <span class="keyword3"><span class="command">case</span></span> inner
        <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹valid_node <span class="skolem">m</span>›</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">as</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="free">Entry</span> <span class="main">-</span><span class="skolem">as</span><span class="main">→*</span> <span class="skolem">m</span>"</span></span>
          <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">fastforce</span> <span class="quasi_keyword">dest</span><span class="main"><span class="main">:</span></span>Entry_path<span class="main">)</span>
        <span class="keyword1"><span class="command">with</span></span> inner <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound">es</span><span class="main">.</span> CFG.path src trg
          <span class="main">(</span>lift_valid_edge <span class="free">valid_edge</span> <span class="free">sourcenode</span> <span class="free">targetnode</span> <span class="free">kind</span> <span class="free">Entry</span> <span class="free">Exit</span><span class="main">)</span>
          <span class="main">(</span>Node <span class="free">Entry</span><span class="main">)</span> <span class="bound">es</span> <span class="main">(</span>Node <span class="skolem">m</span><span class="main">)</span>"</span></span>
        <span class="keyword1"><span class="command">proof</span></span><span class="main">(</span><span class="operator">induct</span> <span class="quasi_keyword">arbitrary</span><span class="main"><span class="main">:</span></span><span class="quoted"><span class="skolem">m</span></span> <span class="quasi_keyword">rule</span><span class="main"><span class="main">:</span></span>rev_induct<span class="main">)</span>
          <span class="keyword3"><span class="command">case</span></span> Nil
          <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="free">Entry</span> <span class="main">-</span><span class="main">[]</span><span class="main">→*</span> <span class="skolem">m</span>›</span></span>
          <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">m</span> <span class="main">=</span> <span class="free">Entry</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">fastforce</span>
          <span class="keyword1"><span class="command">with</span></span> lve_Entry_edge <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"CFG.path src trg
            <span class="main">(</span>lift_valid_edge <span class="free">valid_edge</span> <span class="free">sourcenode</span> <span class="free">targetnode</span> <span class="free">kind</span> <span class="free">Entry</span> <span class="free">Exit</span><span class="main">)</span>
            <span class="main">(</span>Node <span class="free">Entry</span><span class="main">)</span> <span class="main">[]</span> <span class="main">(</span>Node <span class="skolem">m</span><span class="main">)</span>"</span></span>
            <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">fastforce</span> <span class="quasi_keyword">intro</span><span class="main"><span class="main">:</span></span>CFG.empty_path<span class="main"><span class="main">[</span></span><span class="operator">OF</span> CFG<span class="main"><span class="main">]</span></span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span>CFG.valid_node_def<span class="main"><span class="main">[</span></span><span class="operator">OF</span> CFG<span class="main"><span class="main">]</span></span><span class="main">)</span>
          <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?case</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
        <span class="keyword1"><span class="command">next</span></span>
          <span class="keyword3"><span class="command">case</span></span> <span class="main">(</span>snoc <span class="skolem">x</span> <span class="skolem">xs</span><span class="main">)</span>
          <span class="keyword1"><span class="command">note</span></span> IH <span class="main">=</span> <span class="quoted"><span class="quoted">‹<span class="main">⋀</span><span class="bound">m</span><span class="main">.</span> <span class="main">⟦</span>inner_node <span class="bound">m</span><span class="main">;</span> <span class="free">Entry</span> <span class="main">-</span><span class="skolem">xs</span><span class="main">→*</span> <span class="bound">m</span><span class="main">⟧</span>
            <span class="main">⟹</span> <span class="main">∃</span><span class="bound">es</span><span class="main">.</span> CFG.path src trg
            <span class="main">(</span>lift_valid_edge <span class="free">valid_edge</span> <span class="free">sourcenode</span> <span class="free">targetnode</span> <span class="free">kind</span> <span class="free">Entry</span> <span class="free">Exit</span><span class="main">)</span>
            <span class="main">(</span>Node <span class="free">Entry</span><span class="main">)</span> <span class="bound">es</span> <span class="main">(</span>Node <span class="bound">m</span><span class="main">)</span>›</span></span>
          <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="free">Entry</span> <span class="main">-</span><span class="skolem">xs</span><span class="main">@</span><span class="main">[</span><span class="skolem">x</span><span class="main">]</span><span class="main">→*</span> <span class="skolem">m</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">Entry</span> <span class="main">-</span><span class="skolem">xs</span><span class="main">→*</span> <span class="free">sourcenode</span> <span class="skolem">x</span>"</span></span>
            <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">valid_edge</span> <span class="skolem">x</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">m</span> <span class="main">=</span> <span class="free">targetnode</span> <span class="skolem">x</span>"</span></span> <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">elim</span><span class="main"><span class="main">:</span></span>path_split_snoc<span class="main">)</span>
          <span class="keyword1"><span class="command">with</span></span> <span class="quoted"><span class="quoted">‹inner_node <span class="skolem">m</span>›</span></span>
          <span class="keyword1"><span class="command">have</span></span> edge<span class="main">:</span><span class="quoted"><span class="quoted">"lift_valid_edge <span class="free">valid_edge</span> <span class="free">sourcenode</span> <span class="free">targetnode</span> <span class="free">kind</span> <span class="free">Entry</span> <span class="free">Exit</span>
            <span class="main">(</span>Node <span class="main">(</span><span class="free">sourcenode</span> <span class="skolem">x</span><span class="main">)</span><span class="main">,</span><span class="free">kind</span> <span class="skolem">x</span><span class="main">,</span>Node <span class="skolem">m</span><span class="main">)</span>"</span></span>
            <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">fastforce</span> <span class="quasi_keyword">intro</span><span class="main"><span class="main">:</span></span>lve_edge <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span>inner_node_def<span class="main">)</span>
          <span class="keyword1"><span class="command">hence</span></span> path<span class="main">:</span><span class="quoted"><span class="quoted">"CFG.path src trg
            <span class="main">(</span>lift_valid_edge <span class="free">valid_edge</span> <span class="free">sourcenode</span> <span class="free">targetnode</span> <span class="free">kind</span> <span class="free">Entry</span> <span class="free">Exit</span><span class="main">)</span>
            <span class="main">(</span>Node <span class="main">(</span><span class="free">sourcenode</span> <span class="skolem">x</span><span class="main">)</span><span class="main">)</span> <span class="main">[</span><span class="main">(</span>Node <span class="main">(</span><span class="free">sourcenode</span> <span class="skolem">x</span><span class="main">)</span><span class="main">,</span><span class="free">kind</span> <span class="skolem">x</span><span class="main">,</span>Node <span class="skolem">m</span><span class="main">)</span><span class="main">]</span> <span class="main">(</span>Node <span class="skolem">m</span><span class="main">)</span>"</span></span>
            <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">fastforce</span> <span class="quasi_keyword">intro</span><span class="main"><span class="main">:</span></span>CFG.Cons_path<span class="main"><span class="main">[</span></span><span class="operator">OF</span> CFG<span class="main"><span class="main">]</span></span> CFG.empty_path<span class="main"><span class="main">[</span></span><span class="operator">OF</span> CFG<span class="main"><span class="main">]</span></span>
                         <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span>CFG.valid_node_def<span class="main"><span class="main">[</span></span><span class="operator">OF</span> CFG<span class="main"><span class="main">]</span></span><span class="main">)</span>
          <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="free">valid_edge</span> <span class="skolem">x</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"valid_node <span class="main">(</span><span class="free">sourcenode</span> <span class="skolem">x</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
          <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?case</span></span></span>
          <span class="keyword1"><span class="command">proof</span></span><span class="main">(</span><span class="operator">cases</span> <span class="quoted"><span class="quoted">"<span class="free">sourcenode</span> <span class="skolem">x</span>"</span></span> <span class="quasi_keyword">rule</span><span class="main"><span class="main">:</span></span>valid_node_cases<span class="main">)</span>
            <span class="keyword3"><span class="command">case</span></span> Entry
            <span class="keyword1"><span class="command">with</span></span> edge <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"CFG.path src trg
              <span class="main">(</span>lift_valid_edge <span class="free">valid_edge</span> <span class="free">sourcenode</span> <span class="free">targetnode</span> <span class="free">kind</span> <span class="free">Entry</span> <span class="free">Exit</span><span class="main">)</span>
              <span class="main">(</span>Node <span class="free">Entry</span><span class="main">)</span> <span class="main">[</span><span class="main">(</span>Node <span class="free">Entry</span><span class="main">,</span><span class="free">kind</span> <span class="skolem">x</span><span class="main">,</span>Node <span class="skolem">m</span><span class="main">)</span><span class="main">]</span> <span class="main">(</span>Node <span class="skolem">m</span><span class="main">)</span>"</span></span>
              <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="operator">-</span> <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="main">(</span><span class="operator">rule</span> CFG.Cons_path<span class="main"><span class="main">[</span></span><span class="operator">OF</span> CFG<span class="main"><span class="main">]</span></span><span class="main">)</span>
              <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="main">(</span><span class="operator">rule</span> CFG.empty_path<span class="main"><span class="main">[</span></span><span class="operator">OF</span> CFG<span class="main"><span class="main">]</span></span><span class="main">)</span> 
              <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span>CFG.valid_node_def<span class="main"><span class="main">[</span></span><span class="operator">OF</span> CFG<span class="main"><span class="main">]</span></span><span class="main">)</span>
            <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
          <span class="keyword1"><span class="command">next</span></span>
            <span class="keyword3"><span class="command">case</span></span> Exit
            <span class="keyword1"><span class="command">with</span></span> <span class="quoted"><span class="quoted">‹<span class="free">valid_edge</span> <span class="skolem">x</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted">False</span> <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">rule</span> Exit_source<span class="main">)</span>
            <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
          <span class="keyword1"><span class="command">next</span></span>
            <span class="keyword3"><span class="command">case</span></span> inner
            <span class="keyword1"><span class="command">from</span></span> IH<span class="main">[</span><span class="operator">OF</span> this <span class="quoted"><span class="quoted">‹<span class="free">Entry</span> <span class="main">-</span><span class="skolem">xs</span><span class="main">→*</span> <span class="free">sourcenode</span> <span class="skolem">x</span>›</span></span><span class="main">]</span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">es</span></span> 
              <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"CFG.path src trg
              <span class="main">(</span>lift_valid_edge <span class="free">valid_edge</span> <span class="free">sourcenode</span> <span class="free">targetnode</span> <span class="free">kind</span> <span class="free">Entry</span> <span class="free">Exit</span><span class="main">)</span>
              <span class="main">(</span>Node <span class="free">Entry</span><span class="main">)</span> <span class="skolem">es</span> <span class="main">(</span>Node <span class="main">(</span><span class="free">sourcenode</span> <span class="skolem">x</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
            <span class="keyword1"><span class="command">with</span></span> path <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"CFG.path src trg
              <span class="main">(</span>lift_valid_edge <span class="free">valid_edge</span> <span class="free">sourcenode</span> <span class="free">targetnode</span> <span class="free">kind</span> <span class="free">Entry</span> <span class="free">Exit</span><span class="main">)</span>
              <span class="main">(</span>Node <span class="free">Entry</span><span class="main">)</span> <span class="main">(</span><span class="skolem">es</span><span class="main">@</span><span class="main">[</span><span class="main">(</span>Node <span class="main">(</span><span class="free">sourcenode</span> <span class="skolem">x</span><span class="main">)</span><span class="main">,</span><span class="free">kind</span> <span class="skolem">x</span><span class="main">,</span>Node <span class="skolem">m</span><span class="main">)</span><span class="main">]</span><span class="main">)</span> <span class="main">(</span>Node <span class="skolem">m</span><span class="main">)</span>"</span></span>
              <span class="keyword1"><span class="command">by</span></span> <span class="operator">-</span><span class="main">(</span><span class="operator">rule</span> CFG.path_Append<span class="main"><span class="main">[</span></span><span class="operator">OF</span> CFG<span class="main"><span class="main">]</span></span><span class="main">)</span>
            <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
          <span class="keyword1"><span class="command">qed</span></span>
        <span class="keyword1"><span class="command">qed</span></span>
        <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">es</span></span> <span class="keyword2"><span class="keyword">where</span></span> path<span class="main">:</span><span class="quoted"><span class="quoted">"CFG.path src trg
          <span class="main">(</span>lift_valid_edge <span class="free">valid_edge</span> <span class="free">sourcenode</span> <span class="free">targetnode</span> <span class="free">kind</span> <span class="free">Entry</span> <span class="free">Exit</span><span class="main">)</span>
          <span class="main">(</span>Node <span class="free">Entry</span><span class="main">)</span> <span class="skolem">es</span> <span class="main">(</span>Node <span class="skolem">m</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
        <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"lift_valid_edge <span class="free">valid_edge</span> <span class="free">sourcenode</span> <span class="free">targetnode</span> <span class="free">kind</span> <span class="free">Entry</span> <span class="free">Exit</span>
          <span class="main">(</span>NewEntry<span class="main">,</span><span class="main">(</span><span class="main">λ</span><span class="bound">s</span><span class="main">.</span> True<span class="main">)<span class="hidden">⇩</span><sub>√</sub></span><span class="main">,</span>Node <span class="free">Entry</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">fastforce</span> <span class="quasi_keyword">intro</span><span class="main"><span class="main">:</span></span>lve_Entry_edge<span class="main">)</span>
        <span class="keyword1"><span class="command">from</span></span> this path Node <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"CFG.path src trg
          <span class="main">(</span>lift_valid_edge <span class="free">valid_edge</span> <span class="free">sourcenode</span> <span class="free">targetnode</span> <span class="free">kind</span> <span class="free">Entry</span> <span class="free">Exit</span><span class="main">)</span>
          NewEntry <span class="main">(</span><span class="main">(</span>NewEntry<span class="main">,</span><span class="main">(</span><span class="main">λ</span><span class="bound">s</span><span class="main">.</span> True<span class="main">)<span class="hidden">⇩</span><sub>√</sub></span><span class="main">,</span>Node <span class="free">Entry</span><span class="main">)</span><span class="main">#</span><span class="skolem">es</span><span class="main">)</span> <span class="skolem">n</span>"</span></span>
          <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">fastforce</span> <span class="quasi_keyword">intro</span><span class="main"><span class="main">:</span></span>CFG.Cons_path<span class="main"><span class="main">[</span></span><span class="operator">OF</span> CFG<span class="main"><span class="main">]</span></span><span class="main">)</span>
        <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
      <span class="keyword1"><span class="command">qed</span></span>
    <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">next</span></span>
    <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">n</span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"CFG.valid_node src trg
      <span class="main">(</span>lift_valid_edge <span class="free">valid_edge</span> <span class="free">sourcenode</span> <span class="free">targetnode</span> <span class="free">kind</span> <span class="free">Entry</span> <span class="free">Exit</span><span class="main">)</span> <span class="skolem">n</span>"</span></span>
    <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound">as</span><span class="main">.</span> CFG.path src trg
      <span class="main">(</span>lift_valid_edge <span class="free">valid_edge</span> <span class="free">sourcenode</span> <span class="free">targetnode</span> <span class="free">kind</span> <span class="free">Entry</span> <span class="free">Exit</span><span class="main">)</span>
      <span class="skolem">n</span> <span class="bound">as</span> NewExit"</span></span>
    <span class="keyword1"><span class="command">proof</span></span><span class="main">(</span><span class="operator">cases</span> <span class="quoted"><span class="skolem">n</span></span><span class="main">)</span>
      <span class="keyword3"><span class="command">case</span></span> NewEntry
      <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"lift_valid_edge <span class="free">valid_edge</span> <span class="free">sourcenode</span> <span class="free">targetnode</span> <span class="free">kind</span> <span class="free">Entry</span> <span class="free">Exit</span>
        <span class="main">(</span>NewEntry<span class="main">,</span><span class="main">(</span><span class="main">λ</span><span class="bound">s</span><span class="main">.</span> False<span class="main">)<span class="hidden">⇩</span><sub>√</sub></span><span class="main">,</span>NewExit<span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">fastforce</span> <span class="quasi_keyword">intro</span><span class="main"><span class="main">:</span></span>lve_Entry_Exit_edge<span class="main">)</span>
      <span class="keyword1"><span class="command">with</span></span> NewEntry <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"CFG.path src trg
        <span class="main">(</span>lift_valid_edge <span class="free">valid_edge</span> <span class="free">sourcenode</span> <span class="free">targetnode</span> <span class="free">kind</span> <span class="free">Entry</span> <span class="free">Exit</span><span class="main">)</span>
        <span class="skolem">n</span> <span class="main">[</span><span class="main">(</span>NewEntry<span class="main">,</span><span class="main">(</span><span class="main">λ</span><span class="bound">s</span><span class="main">.</span> False<span class="main">)<span class="hidden">⇩</span><sub>√</sub></span><span class="main">,</span>NewExit<span class="main">)</span><span class="main">]</span> NewExit"</span></span>
        <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">fastforce</span> <span class="quasi_keyword">intro</span><span class="main"><span class="main">:</span></span>CFG.Cons_path<span class="main"><span class="main">[</span></span><span class="operator">OF</span> CFG<span class="main"><span class="main">]</span></span> CFG.empty_path<span class="main"><span class="main">[</span></span><span class="operator">OF</span> CFG<span class="main"><span class="main">]</span></span>
                     <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span>CFG.valid_node_def<span class="main"><span class="main">[</span></span><span class="operator">OF</span> CFG<span class="main"><span class="main">]</span></span><span class="main">)</span>
      <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
    <span class="keyword1"><span class="command">next</span></span>
      <span class="keyword3"><span class="command">case</span></span> NewExit
      <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"lift_valid_edge <span class="free">valid_edge</span> <span class="free">sourcenode</span> <span class="free">targetnode</span> <span class="free">kind</span> <span class="free">Entry</span> <span class="free">Exit</span>
        <span class="main">(</span>NewEntry<span class="main">,</span><span class="main">(</span><span class="main">λ</span><span class="bound">s</span><span class="main">.</span> False<span class="main">)<span class="hidden">⇩</span><sub>√</sub></span><span class="main">,</span>NewExit<span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">fastforce</span> <span class="quasi_keyword">intro</span><span class="main"><span class="main">:</span></span>lve_Entry_Exit_edge<span class="main">)</span>
      <span class="keyword1"><span class="command">with</span></span> NewExit <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"CFG.path src trg
        <span class="main">(</span>lift_valid_edge <span class="free">valid_edge</span> <span class="free">sourcenode</span> <span class="free">targetnode</span> <span class="free">kind</span> <span class="free">Entry</span> <span class="free">Exit</span><span class="main">)</span>
        <span class="skolem">n</span> <span class="main">[]</span> NewExit"</span></span>
        <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">fastforce</span> <span class="quasi_keyword">intro</span><span class="main"><span class="main">:</span></span>CFG.empty_path<span class="main"><span class="main">[</span></span><span class="operator">OF</span> CFG<span class="main"><span class="main">]</span></span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span>CFG.valid_node_def<span class="main"><span class="main">[</span></span><span class="operator">OF</span> CFG<span class="main"><span class="main">]</span></span><span class="main">)</span>
      <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
    <span class="keyword1"><span class="command">next</span></span>
      <span class="keyword3"><span class="command">case</span></span> <span class="main">(</span>Node <span class="skolem">m</span><span class="main">)</span>
      <span class="keyword1"><span class="command">with</span></span> Entry_Exit_edge <span class="quoted"><span class="quoted">‹CFG.valid_node src trg
        <span class="main">(</span>lift_valid_edge <span class="free">valid_edge</span> <span class="free">sourcenode</span> <span class="free">targetnode</span> <span class="free">kind</span> <span class="free">Entry</span> <span class="free">Exit</span><span class="main">)</span> <span class="skolem">n</span>›</span></span>
      <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"valid_node <span class="skolem">m</span>"</span></span> 
        <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">elim</span><span class="main"><span class="main">:</span></span>lift_valid_edge.cases 
                <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span>CFG.valid_node_def<span class="main"><span class="main">[</span></span><span class="operator">OF</span> CFG<span class="main"><span class="main">]</span></span> valid_node_def<span class="main">)</span>
      <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
      <span class="keyword1"><span class="command">proof</span></span><span class="main">(</span><span class="operator">cases</span> <span class="quoted"><span class="skolem">m</span></span> <span class="quasi_keyword">rule</span><span class="main"><span class="main">:</span></span>valid_node_cases<span class="main">)</span>
        <span class="keyword3"><span class="command">case</span></span> Entry
        <span class="keyword1"><span class="command">from</span></span> inner <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">ax</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="free">valid_edge</span> <span class="skolem">ax</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"inner_node <span class="main">(</span><span class="free">targetnode</span> <span class="skolem">ax</span><span class="main">)</span>"</span></span>
          <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">sourcenode</span> <span class="skolem">ax</span> <span class="main">=</span> <span class="free">Entry</span>"</span></span> <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">erule</span> inner_node_Entry_edge<span class="main">)</span>
        <span class="keyword1"><span class="command">hence</span></span> edge<span class="main">:</span><span class="quoted"><span class="quoted">"lift_valid_edge <span class="free">valid_edge</span> <span class="free">sourcenode</span> <span class="free">targetnode</span> <span class="free">kind</span> <span class="free">Entry</span> <span class="free">Exit</span>
          <span class="main">(</span>Node <span class="free">Entry</span><span class="main">,</span><span class="free">kind</span> <span class="skolem">ax</span><span class="main">,</span>Node <span class="main">(</span><span class="free">targetnode</span> <span class="skolem">ax</span><span class="main">)</span><span class="main">)</span>"</span></span>
          <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">intro</span><span class="main"><span class="main">:</span></span>lift_valid_edge.lve_edge <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span>inner_node_def<span class="main">)</span>
        <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"lift_valid_edge <span class="free">valid_edge</span> <span class="free">sourcenode</span> <span class="free">targetnode</span> <span class="free">kind</span> <span class="free">Entry</span> <span class="free">Exit</span>
          <span class="main">(</span>Node <span class="free">Exit</span><span class="main">,</span><span class="main">(</span><span class="main">λ</span><span class="bound">s</span><span class="main">.</span> True<span class="main">)<span class="hidden">⇩</span><sub>√</sub></span><span class="main">,</span>NewExit<span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">fastforce</span> <span class="quasi_keyword">intro</span><span class="main"><span class="main">:</span></span>lve_Exit_edge<span class="main">)</span>
        <span class="keyword1"><span class="command">hence</span></span> path<span class="main">:</span><span class="quoted"><span class="quoted">"CFG.path src trg
          <span class="main">(</span>lift_valid_edge <span class="free">valid_edge</span> <span class="free">sourcenode</span> <span class="free">targetnode</span> <span class="free">kind</span> <span class="free">Entry</span> <span class="free">Exit</span><span class="main">)</span>
          <span class="main">(</span>Node <span class="free">Exit</span><span class="main">)</span> <span class="main">[</span><span class="main">(</span>Node <span class="free">Exit</span><span class="main">,</span><span class="main">(</span><span class="main">λ</span><span class="bound">s</span><span class="main">.</span> True<span class="main">)<span class="hidden">⇩</span><sub>√</sub></span><span class="main">,</span>NewExit<span class="main">)</span><span class="main">]</span> <span class="main">(</span>NewExit<span class="main">)</span>"</span></span>
          <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">fastforce</span> <span class="quasi_keyword">intro</span><span class="main"><span class="main">:</span></span>CFG.Cons_path<span class="main"><span class="main">[</span></span><span class="operator">OF</span> CFG<span class="main"><span class="main">]</span></span> CFG.empty_path<span class="main"><span class="main">[</span></span><span class="operator">OF</span> CFG<span class="main"><span class="main">]</span></span>
                       <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span>CFG.valid_node_def<span class="main"><span class="main">[</span></span><span class="operator">OF</span> CFG<span class="main"><span class="main">]</span></span><span class="main">)</span>
        <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹inner_node <span class="main">(</span><span class="free">targetnode</span> <span class="skolem">ax</span><span class="main">)</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"valid_node <span class="main">(</span><span class="free">targetnode</span> <span class="skolem">ax</span><span class="main">)</span>"</span></span>
          <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">rule</span> inner_is_valid<span class="main">)</span>
        <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">asx</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="free">targetnode</span> <span class="skolem">ax</span> <span class="main">-</span><span class="skolem">asx</span><span class="main">→*</span> <span class="free">Exit</span>"</span></span> <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">fastforce</span> <span class="quasi_keyword">dest</span><span class="main"><span class="main">:</span></span>Exit_path<span class="main">)</span>
        <span class="keyword1"><span class="command">from</span></span> this <span class="quoted"><span class="quoted">‹<span class="free">valid_edge</span> <span class="skolem">ax</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound">es</span><span class="main">.</span> CFG.path src trg
          <span class="main">(</span>lift_valid_edge <span class="free">valid_edge</span> <span class="free">sourcenode</span> <span class="free">targetnode</span> <span class="free">kind</span> <span class="free">Entry</span> <span class="free">Exit</span><span class="main">)</span>
          <span class="main">(</span>Node <span class="main">(</span><span class="free">targetnode</span> <span class="skolem">ax</span><span class="main">)</span><span class="main">)</span> <span class="bound">es</span> <span class="main">(</span>Node <span class="free">Exit</span><span class="main">)</span>"</span></span>
        <span class="keyword1"><span class="command">proof</span></span><span class="main">(</span><span class="operator">induct</span> <span class="quoted"><span class="skolem">asx</span></span> <span class="quasi_keyword">arbitrary</span><span class="main"><span class="main">:</span></span><span class="quoted"><span class="skolem">ax</span></span><span class="main">)</span>
          <span class="keyword3"><span class="command">case</span></span> Nil
          <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="free">targetnode</span> <span class="skolem">ax</span> <span class="main">-</span><span class="main">[]</span><span class="main">→*</span> <span class="free">Exit</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">targetnode</span> <span class="skolem">ax</span> <span class="main">=</span> <span class="free">Exit</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">fastforce</span>
          <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"CFG.path src trg
            <span class="main">(</span>lift_valid_edge <span class="free">valid_edge</span> <span class="free">sourcenode</span> <span class="free">targetnode</span> <span class="free">kind</span> <span class="free">Entry</span> <span class="free">Exit</span><span class="main">)</span>
            <span class="main">(</span>Node <span class="main">(</span><span class="free">targetnode</span> <span class="skolem">ax</span><span class="main">)</span><span class="main">)</span> <span class="main">[]</span> <span class="main">(</span>Node <span class="free">Exit</span><span class="main">)</span>"</span></span>
            <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="operator">simp</span> <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="main">(</span><span class="operator">rule</span> CFG.empty_path<span class="main"><span class="main">[</span></span><span class="operator">OF</span> CFG<span class="main"><span class="main">]</span></span><span class="main">)</span>
            <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">intro</span><span class="main"><span class="main">:</span></span>lve_Exit_edge <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span>CFG.valid_node_def<span class="main"><span class="main">[</span></span><span class="operator">OF</span> CFG<span class="main"><span class="main">]</span></span><span class="main">)</span>
          <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?case</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
        <span class="keyword1"><span class="command">next</span></span>
          <span class="keyword3"><span class="command">case</span></span> <span class="main">(</span>Cons <span class="skolem">x</span> <span class="skolem">xs</span><span class="main">)</span>
          <span class="keyword1"><span class="command">note</span></span> IH <span class="main">=</span> <span class="quoted"><span class="quoted">‹<span class="main">⋀</span><span class="bound">ax</span><span class="main">.</span> <span class="main">⟦</span><span class="free">targetnode</span> <span class="bound">ax</span> <span class="main">-</span><span class="skolem">xs</span><span class="main">→*</span> <span class="free">Exit</span><span class="main">;</span> <span class="free">valid_edge</span> <span class="bound">ax</span><span class="main">⟧</span> <span class="main">⟹</span>
            <span class="main">∃</span><span class="bound">es</span><span class="main">.</span> CFG.path src trg
            <span class="main">(</span>lift_valid_edge <span class="free">valid_edge</span> <span class="free">sourcenode</span> <span class="free">targetnode</span> <span class="free">kind</span> <span class="free">Entry</span> <span class="free">Exit</span><span class="main">)</span>
            <span class="main">(</span>Node <span class="main">(</span><span class="free">targetnode</span> <span class="bound">ax</span><span class="main">)</span><span class="main">)</span> <span class="bound">es</span> <span class="main">(</span>Node <span class="free">Exit</span><span class="main">)</span>›</span></span>
          <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="free">targetnode</span> <span class="skolem">ax</span> <span class="main">-</span><span class="skolem">x</span><span class="main">#</span><span class="skolem">xs</span><span class="main">→*</span> <span class="free">Exit</span>›</span></span>
          <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">targetnode</span> <span class="skolem">x</span> <span class="main">-</span><span class="skolem">xs</span><span class="main">→*</span> <span class="free">Exit</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">valid_edge</span> <span class="skolem">x</span>"</span></span>
            <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">sourcenode</span> <span class="skolem">x</span> <span class="main">=</span> <span class="free">targetnode</span> <span class="skolem">ax</span>"</span></span> <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">elim</span><span class="main"><span class="main">:</span></span>path_split_Cons<span class="main">)</span>
          <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="free">sourcenode</span> <span class="skolem">x</span> <span class="main">=</span> <span class="free">Entry</span>"</span></span>
            <span class="keyword1"><span class="command">with</span></span> <span class="quoted"><span class="quoted">‹<span class="free">valid_edge</span> <span class="skolem">ax</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="free">sourcenode</span> <span class="skolem">x</span> <span class="main">=</span> <span class="free">targetnode</span> <span class="skolem">ax</span>›</span></span>
            <span class="keyword1"><span class="command">have</span></span> <span class="quoted">False</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">-</span><span class="main">(</span><span class="operator">rule</span> Entry_target<span class="main"><span class="keyword3">,</span></span><span class="operator">simp</span><span class="main"><span class="keyword3">+</span></span><span class="main">)</span> <span class="keyword1"><span class="command">}</span></span>
          <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="free">sourcenode</span> <span class="skolem">x</span> <span class="main">≠</span> <span class="free">Entry</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">clarsimp</span>
          <span class="keyword1"><span class="command">with</span></span> <span class="quoted"><span class="quoted">‹<span class="free">valid_edge</span> <span class="skolem">x</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="free">sourcenode</span> <span class="skolem">x</span> <span class="main">=</span> <span class="free">targetnode</span> <span class="skolem">ax</span>›</span></span><span class="main">[</span><span class="operator">THEN</span> sym<span class="main">]</span>
          <span class="keyword1"><span class="command">have</span></span> edge<span class="main">:</span><span class="quoted"><span class="quoted">"lift_valid_edge <span class="free">valid_edge</span> <span class="free">sourcenode</span> <span class="free">targetnode</span> <span class="free">kind</span> <span class="free">Entry</span> <span class="free">Exit</span>
            <span class="main">(</span>Node <span class="main">(</span><span class="free">targetnode</span> <span class="skolem">ax</span><span class="main">)</span><span class="main">,</span><span class="free">kind</span> <span class="skolem">x</span><span class="main">,</span>Node <span class="main">(</span><span class="free">targetnode</span> <span class="skolem">x</span><span class="main">)</span><span class="main">)</span>"</span></span>
            <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">fastforce</span> <span class="quasi_keyword">intro</span><span class="main"><span class="main">:</span></span>lift_valid_edge.lve_edge<span class="main">)</span>
          <span class="keyword1"><span class="command">from</span></span> IH<span class="main">[</span><span class="operator">OF</span> <span class="quoted"><span class="quoted">‹<span class="free">targetnode</span> <span class="skolem">x</span> <span class="main">-</span><span class="skolem">xs</span><span class="main">→*</span> <span class="free">Exit</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="free">valid_edge</span> <span class="skolem">x</span>›</span></span><span class="main">]</span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">es</span></span>
            <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"CFG.path src trg
            <span class="main">(</span>lift_valid_edge <span class="free">valid_edge</span> <span class="free">sourcenode</span> <span class="free">targetnode</span> <span class="free">kind</span> <span class="free">Entry</span> <span class="free">Exit</span><span class="main">)</span>
            <span class="main">(</span>Node <span class="main">(</span><span class="free">targetnode</span> <span class="skolem">x</span><span class="main">)</span><span class="main">)</span> <span class="skolem">es</span> <span class="main">(</span>Node <span class="free">Exit</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
          <span class="keyword1"><span class="command">with</span></span> edge <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"CFG.path src trg
            <span class="main">(</span>lift_valid_edge <span class="free">valid_edge</span> <span class="free">sourcenode</span> <span class="free">targetnode</span> <span class="free">kind</span> <span class="free">Entry</span> <span class="free">Exit</span><span class="main">)</span>
            <span class="main">(</span>Node <span class="main">(</span><span class="free">targetnode</span> <span class="skolem">ax</span><span class="main">)</span><span class="main">)</span> 
            <span class="main">(</span><span class="main">(</span>Node <span class="main">(</span><span class="free">targetnode</span> <span class="skolem">ax</span><span class="main">)</span><span class="main">,</span><span class="free">kind</span> <span class="skolem">x</span><span class="main">,</span>Node <span class="main">(</span><span class="free">targetnode</span> <span class="skolem">x</span><span class="main">)</span><span class="main">)</span><span class="main">#</span><span class="skolem">es</span><span class="main">)</span> <span class="main">(</span>Node <span class="free">Exit</span><span class="main">)</span>"</span></span>
            <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">fastforce</span> <span class="quasi_keyword">intro</span><span class="main"><span class="main">:</span></span>CFG.Cons_path<span class="main"><span class="main">[</span></span><span class="operator">OF</span> CFG<span class="main"><span class="main">]</span></span><span class="main">)</span>
          <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?case</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
        <span class="keyword1"><span class="command">qed</span></span>
        <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">es</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"CFG.path src trg
          <span class="main">(</span>lift_valid_edge <span class="free">valid_edge</span> <span class="free">sourcenode</span> <span class="free">targetnode</span> <span class="free">kind</span> <span class="free">Entry</span> <span class="free">Exit</span><span class="main">)</span>
          <span class="main">(</span>Node <span class="main">(</span><span class="free">targetnode</span> <span class="skolem">ax</span><span class="main">)</span><span class="main">)</span> <span class="skolem">es</span> <span class="main">(</span>Node <span class="free">Exit</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
        <span class="keyword1"><span class="command">with</span></span> edge <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"CFG.path src trg
          <span class="main">(</span>lift_valid_edge <span class="free">valid_edge</span> <span class="free">sourcenode</span> <span class="free">targetnode</span> <span class="free">kind</span> <span class="free">Entry</span> <span class="free">Exit</span><span class="main">)</span>
          <span class="main">(</span>Node <span class="free">Entry</span><span class="main">)</span> <span class="main">(</span><span class="main">(</span>Node <span class="free">Entry</span><span class="main">,</span> <span class="free">kind</span> <span class="skolem">ax</span><span class="main">,</span> Node <span class="main">(</span><span class="free">targetnode</span> <span class="skolem">ax</span><span class="main">)</span><span class="main">)</span><span class="main">#</span><span class="skolem">es</span><span class="main">)</span> <span class="main">(</span>Node <span class="free">Exit</span><span class="main">)</span>"</span></span>
          <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">fastforce</span> <span class="quasi_keyword">intro</span><span class="main"><span class="main">:</span></span>CFG.Cons_path<span class="main"><span class="main">[</span></span><span class="operator">OF</span> CFG<span class="main"><span class="main">]</span></span><span class="main">)</span>
        <span class="keyword1"><span class="command">with</span></span> path <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"CFG.path src trg
          <span class="main">(</span>lift_valid_edge <span class="free">valid_edge</span> <span class="free">sourcenode</span> <span class="free">targetnode</span> <span class="free">kind</span> <span class="free">Entry</span> <span class="free">Exit</span><span class="main">)</span>
          <span class="main">(</span>Node <span class="free">Entry</span><span class="main">)</span> <span class="main">(</span><span class="main">(</span><span class="main">(</span>Node <span class="free">Entry</span><span class="main">,</span><span class="free">kind</span> <span class="skolem">ax</span><span class="main">,</span>Node <span class="main">(</span><span class="free">targetnode</span> <span class="skolem">ax</span><span class="main">)</span><span class="main">)</span><span class="main">#</span><span class="skolem">es</span><span class="main">)</span><span class="main">@</span>
                        <span class="main">[</span><span class="main">(</span>Node <span class="free">Exit</span><span class="main">,</span> <span class="main">(</span><span class="main">λ</span><span class="bound">s</span><span class="main">.</span> True<span class="main">)<span class="hidden">⇩</span><sub>√</sub></span><span class="main">,</span> NewExit<span class="main">)</span><span class="main">]</span><span class="main">)</span> NewExit"</span></span>
          <span class="keyword1"><span class="command">by</span></span> <span class="operator">-</span><span class="main">(</span><span class="operator">rule</span> CFG.path_Append<span class="main"><span class="main">[</span></span><span class="operator">OF</span> CFG<span class="main"><span class="main">]</span></span><span class="main">)</span>
        <span class="keyword1"><span class="command">with</span></span> Node Entry <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">fastforce</span>
      <span class="keyword1"><span class="command">next</span></span>
        <span class="keyword3"><span class="command">case</span></span> Exit
        <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"lift_valid_edge <span class="free">valid_edge</span> <span class="free">sourcenode</span> <span class="free">targetnode</span> <span class="free">kind</span> <span class="free">Entry</span> <span class="free">Exit</span>
          <span class="main">(</span>Node <span class="free">Exit</span><span class="main">,</span><span class="main">(</span><span class="main">λ</span><span class="bound">s</span><span class="main">.</span> True<span class="main">)<span class="hidden">⇩</span><sub>√</sub></span><span class="main">,</span>NewExit<span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">fastforce</span> <span class="quasi_keyword">intro</span><span class="main"><span class="main">:</span></span>lve_Exit_edge<span class="main">)</span>
        <span class="keyword1"><span class="command">with</span></span> Exit Node <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"CFG.path src trg
          <span class="main">(</span>lift_valid_edge <span class="free">valid_edge</span> <span class="free">sourcenode</span> <span class="free">targetnode</span> <span class="free">kind</span> <span class="free">Entry</span> <span class="free">Exit</span><span class="main">)</span>
          <span class="skolem">n</span> <span class="main">[</span><span class="main">(</span>Node <span class="free">Exit</span><span class="main">,</span><span class="main">(</span><span class="main">λ</span><span class="bound">s</span><span class="main">.</span> True<span class="main">)<span class="hidden">⇩</span><sub>√</sub></span><span class="main">,</span>NewExit<span class="main">)</span><span class="main">]</span> NewExit"</span></span>
          <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">fastforce</span> <span class="quasi_keyword">intro</span><span class="main"><span class="main">:</span></span>CFG.Cons_path<span class="main"><span class="main">[</span></span><span class="operator">OF</span> CFG<span class="main"><span class="main">]</span></span> CFG.empty_path<span class="main"><span class="main">[</span></span><span class="operator">OF</span> CFG<span class="main"><span class="main">]</span></span>
                       <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span>CFG.valid_node_def<span class="main"><span class="main">[</span></span><span class="operator">OF</span> CFG<span class="main"><span class="main">]</span></span><span class="main">)</span>
        <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
      <span class="keyword1"><span class="command">next</span></span>
        <span class="keyword3"><span class="command">case</span></span> inner
        <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹valid_node <span class="skolem">m</span>›</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">as</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">m</span> <span class="main">-</span><span class="skolem">as</span><span class="main">→*</span> <span class="free">Exit</span>"</span></span>
          <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">fastforce</span> <span class="quasi_keyword">dest</span><span class="main"><span class="main">:</span></span>Exit_path<span class="main">)</span>
        <span class="keyword1"><span class="command">with</span></span> inner <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound">es</span><span class="main">.</span> CFG.path src trg
          <span class="main">(</span>lift_valid_edge <span class="free">valid_edge</span> <span class="free">sourcenode</span> <span class="free">targetnode</span> <span class="free">kind</span> <span class="free">Entry</span> <span class="free">Exit</span><span class="main">)</span>
          <span class="main">(</span>Node <span class="skolem">m</span><span class="main">)</span> <span class="bound">es</span> <span class="main">(</span>Node <span class="free">Exit</span><span class="main">)</span>"</span></span>
        <span class="keyword1"><span class="command">proof</span></span><span class="main">(</span><span class="operator">induct</span> <span class="quoted"><span class="skolem">as</span></span> <span class="quasi_keyword">arbitrary</span><span class="main"><span class="main">:</span></span><span class="quoted"><span class="skolem">m</span></span><span class="main">)</span>
          <span class="keyword3"><span class="command">case</span></span> Nil
          <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">m</span> <span class="main">-</span><span class="main">[]</span><span class="main">→*</span> <span class="free">Exit</span>›</span></span>
          <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">m</span> <span class="main">=</span> <span class="free">Exit</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">fastforce</span>
          <span class="keyword1"><span class="command">with</span></span> lve_Exit_edge <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"CFG.path src trg
            <span class="main">(</span>lift_valid_edge <span class="free">valid_edge</span> <span class="free">sourcenode</span> <span class="free">targetnode</span> <span class="free">kind</span> <span class="free">Entry</span> <span class="free">Exit</span><span class="main">)</span>
            <span class="main">(</span>Node <span class="skolem">m</span><span class="main">)</span> <span class="main">[]</span> <span class="main">(</span>Node <span class="free">Exit</span><span class="main">)</span>"</span></span>
            <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">fastforce</span> <span class="quasi_keyword">intro</span><span class="main"><span class="main">:</span></span>CFG.empty_path<span class="main"><span class="main">[</span></span><span class="operator">OF</span> CFG<span class="main"><span class="main">]</span></span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span>CFG.valid_node_def<span class="main"><span class="main">[</span></span><span class="operator">OF</span> CFG<span class="main"><span class="main">]</span></span><span class="main">)</span>
          <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?case</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
        <span class="keyword1"><span class="command">next</span></span>
          <span class="keyword3"><span class="command">case</span></span> <span class="main">(</span>Cons <span class="skolem">x</span> <span class="skolem">xs</span><span class="main">)</span>
          <span class="keyword1"><span class="command">note</span></span> IH <span class="main">=</span> <span class="quoted"><span class="quoted">‹<span class="main">⋀</span><span class="bound">m</span><span class="main">.</span> <span class="main">⟦</span>inner_node <span class="bound">m</span><span class="main">;</span> <span class="bound">m</span> <span class="main">-</span><span class="skolem">xs</span><span class="main">→*</span> <span class="free">Exit</span><span class="main">⟧</span>
            <span class="main">⟹</span> <span class="main">∃</span><span class="bound">es</span><span class="main">.</span> CFG.path src trg
            <span class="main">(</span>lift_valid_edge <span class="free">valid_edge</span> <span class="free">sourcenode</span> <span class="free">targetnode</span> <span class="free">kind</span> <span class="free">Entry</span> <span class="free">Exit</span><span class="main">)</span>
            <span class="main">(</span>Node <span class="bound">m</span><span class="main">)</span> <span class="bound">es</span> <span class="main">(</span>Node <span class="free">Exit</span><span class="main">)</span>›</span></span>
          <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">m</span> <span class="main">-</span><span class="skolem">x</span><span class="main">#</span><span class="skolem">xs</span><span class="main">→*</span> <span class="free">Exit</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">targetnode</span> <span class="skolem">x</span> <span class="main">-</span><span class="skolem">xs</span><span class="main">→*</span> <span class="free">Exit</span>"</span></span>
            <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">valid_edge</span> <span class="skolem">x</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">m</span> <span class="main">=</span> <span class="free">sourcenode</span> <span class="skolem">x</span>"</span></span> <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">elim</span><span class="main"><span class="main">:</span></span>path_split_Cons<span class="main">)</span>
          <span class="keyword1"><span class="command">with</span></span> <span class="quoted"><span class="quoted">‹inner_node <span class="skolem">m</span>›</span></span>
          <span class="keyword1"><span class="command">have</span></span> edge<span class="main">:</span><span class="quoted"><span class="quoted">"lift_valid_edge <span class="free">valid_edge</span> <span class="free">sourcenode</span> <span class="free">targetnode</span> <span class="free">kind</span> <span class="free">Entry</span> <span class="free">Exit</span>
            <span class="main">(</span>Node <span class="skolem">m</span><span class="main">,</span><span class="free">kind</span> <span class="skolem">x</span><span class="main">,</span>Node <span class="main">(</span><span class="free">targetnode</span> <span class="skolem">x</span><span class="main">)</span><span class="main">)</span>"</span></span>
            <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">fastforce</span> <span class="quasi_keyword">intro</span><span class="main"><span class="main">:</span></span>lve_edge <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span>inner_node_def<span class="main">)</span>
          <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="free">valid_edge</span> <span class="skolem">x</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"valid_node <span class="main">(</span><span class="free">targetnode</span> <span class="skolem">x</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
          <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?case</span></span></span>
          <span class="keyword1"><span class="command">proof</span></span><span class="main">(</span><span class="operator">cases</span> <span class="quoted"><span class="quoted">"<span class="free">targetnode</span> <span class="skolem">x</span>"</span></span> <span class="quasi_keyword">rule</span><span class="main"><span class="main">:</span></span>valid_node_cases<span class="main">)</span>
            <span class="keyword3"><span class="command">case</span></span> Entry
            <span class="keyword1"><span class="command">with</span></span> <span class="quoted"><span class="quoted">‹<span class="free">valid_edge</span> <span class="skolem">x</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted">False</span> <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">rule</span> Entry_target<span class="main">)</span>
            <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
          <span class="keyword1"><span class="command">next</span></span>
            <span class="keyword3"><span class="command">case</span></span> Exit
            <span class="keyword1"><span class="command">with</span></span> edge <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"CFG.path src trg
              <span class="main">(</span>lift_valid_edge <span class="free">valid_edge</span> <span class="free">sourcenode</span> <span class="free">targetnode</span> <span class="free">kind</span> <span class="free">Entry</span> <span class="free">Exit</span><span class="main">)</span>
              <span class="main">(</span>Node <span class="skolem">m</span><span class="main">)</span> <span class="main">[</span><span class="main">(</span>Node <span class="skolem">m</span><span class="main">,</span><span class="free">kind</span> <span class="skolem">x</span><span class="main">,</span>Node <span class="free">Exit</span><span class="main">)</span><span class="main">]</span> <span class="main">(</span>Node <span class="free">Exit</span><span class="main">)</span>"</span></span>
              <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="operator">-</span> <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="main">(</span><span class="operator">rule</span> CFG.Cons_path<span class="main"><span class="main">[</span></span><span class="operator">OF</span> CFG<span class="main"><span class="main">]</span></span><span class="main">)</span>
              <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="main">(</span><span class="operator">rule</span> CFG.empty_path<span class="main"><span class="main">[</span></span><span class="operator">OF</span> CFG<span class="main"><span class="main">]</span></span><span class="main">)</span> 
              <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span>CFG.valid_node_def<span class="main"><span class="main">[</span></span><span class="operator">OF</span> CFG<span class="main"><span class="main">]</span></span><span class="main">)</span>
            <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
          <span class="keyword1"><span class="command">next</span></span>
            <span class="keyword3"><span class="command">case</span></span> inner
            <span class="keyword1"><span class="command">from</span></span> IH<span class="main">[</span><span class="operator">OF</span> this <span class="quoted"><span class="quoted">‹<span class="free">targetnode</span> <span class="skolem">x</span> <span class="main">-</span><span class="skolem">xs</span><span class="main">→*</span> <span class="free">Exit</span>›</span></span><span class="main">]</span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">es</span></span> 
              <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"CFG.path src trg
              <span class="main">(</span>lift_valid_edge <span class="free">valid_edge</span> <span class="free">sourcenode</span> <span class="free">targetnode</span> <span class="free">kind</span> <span class="free">Entry</span> <span class="free">Exit</span><span class="main">)</span>
              <span class="main">(</span>Node <span class="main">(</span><span class="free">targetnode</span> <span class="skolem">x</span><span class="main">)</span><span class="main">)</span> <span class="skolem">es</span> <span class="main">(</span>Node <span class="free">Exit</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
            <span class="keyword1"><span class="command">with</span></span> edge <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"CFG.path src trg
              <span class="main">(</span>lift_valid_edge <span class="free">valid_edge</span> <span class="free">sourcenode</span> <span class="free">targetnode</span> <span class="free">kind</span> <span class="free">Entry</span> <span class="free">Exit</span><span class="main">)</span>
              <span class="main">(</span>Node <span class="skolem">m</span><span class="main">)</span> <span class="main">(</span><span class="main">(</span>Node <span class="skolem">m</span><span class="main">,</span><span class="free">kind</span> <span class="skolem">x</span><span class="main">,</span>Node <span class="main">(</span><span class="free">targetnode</span> <span class="skolem">x</span><span class="main">)</span><span class="main">)</span><span class="main">#</span><span class="skolem">es</span><span class="main">)</span> <span class="main">(</span>Node <span class="free">Exit</span><span class="main">)</span>"</span></span>
              <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">fastforce</span> <span class="quasi_keyword">intro</span><span class="main"><span class="main">:</span></span>CFG.Cons_path<span class="main"><span class="main">[</span></span><span class="operator">OF</span> CFG<span class="main"><span class="main">]</span></span><span class="main">)</span>
            <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
          <span class="keyword1"><span class="command">qed</span></span>
        <span class="keyword1"><span class="command">qed</span></span>
        <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">es</span></span> <span class="keyword2"><span class="keyword">where</span></span> path<span class="main">:</span><span class="quoted"><span class="quoted">"CFG.path src trg
          <span class="main">(</span>lift_valid_edge <span class="free">valid_edge</span> <span class="free">sourcenode</span> <span class="free">targetnode</span> <span class="free">kind</span> <span class="free">Entry</span> <span class="free">Exit</span><span class="main">)</span>
          <span class="main">(</span>Node <span class="skolem">m</span><span class="main">)</span> <span class="skolem">es</span> <span class="main">(</span>Node <span class="free">Exit</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
        <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"lift_valid_edge <span class="free">valid_edge</span> <span class="free">sourcenode</span> <span class="free">targetnode</span> <span class="free">kind</span> <span class="free">Entry</span> <span class="free">Exit</span>
          <span class="main">(</span>Node <span class="free">Exit</span><span class="main">,</span><span class="main">(</span><span class="main">λ</span><span class="bound">s</span><span class="main">.</span> True<span class="main">)<span class="hidden">⇩</span><sub>√</sub></span><span class="main">,</span>NewExit<span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">fastforce</span> <span class="quasi_keyword">intro</span><span class="main"><span class="main">:</span></span>lve_Exit_edge<span class="main">)</span>
        <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"CFG.path src trg
          <span class="main">(</span>lift_valid_edge <span class="free">valid_edge</span> <span class="free">sourcenode</span> <span class="free">targetnode</span> <span class="free">kind</span> <span class="free">Entry</span> <span class="free">Exit</span><span class="main">)</span>
          <span class="main">(</span>Node <span class="free">Exit</span><span class="main">)</span> <span class="main">[</span><span class="main">(</span>Node <span class="free">Exit</span><span class="main">,</span><span class="main">(</span><span class="main">λ</span><span class="bound">s</span><span class="main">.</span> True<span class="main">)<span class="hidden">⇩</span><sub>√</sub></span><span class="main">,</span>NewExit<span class="main">)</span><span class="main">]</span> NewExit"</span></span>
          <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">fastforce</span> <span class="quasi_keyword">intro</span><span class="main"><span class="main">:</span></span>CFG.Cons_path<span class="main"><span class="main">[</span></span><span class="operator">OF</span> CFG<span class="main"><span class="main">]</span></span> CFG.empty_path<span class="main"><span class="main">[</span></span><span class="operator">OF</span> CFG<span class="main"><span class="main">]</span></span>
                       <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span>CFG.valid_node_def<span class="main"><span class="main">[</span></span><span class="operator">OF</span> CFG<span class="main"><span class="main">]</span></span><span class="main">)</span>
        <span class="keyword1"><span class="command">with</span></span> path Node <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"CFG.path src trg
          <span class="main">(</span>lift_valid_edge <span class="free">valid_edge</span> <span class="free">sourcenode</span> <span class="free">targetnode</span> <span class="free">kind</span> <span class="free">Entry</span> <span class="free">Exit</span><span class="main">)</span>
          <span class="skolem">n</span> <span class="main">(</span><span class="skolem">es</span><span class="main">@</span><span class="main">[</span><span class="main">(</span>Node <span class="free">Exit</span><span class="main">,</span> <span class="main">(</span><span class="main">λ</span><span class="bound">s</span><span class="main">.</span> True<span class="main">)<span class="hidden">⇩</span><sub>√</sub></span><span class="main">,</span> NewExit<span class="main">)</span><span class="main">]</span><span class="main">)</span> NewExit"</span></span>
          <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">fastforce</span> <span class="quasi_keyword">intro</span><span class="main"><span class="main">:</span></span>CFG.path_Append<span class="main"><span class="main">[</span></span><span class="operator">OF</span> CFG<span class="main"><span class="main">]</span></span><span class="main">)</span>
        <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
      <span class="keyword1"><span class="command">qed</span></span>
    <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">qed</span></span>
<span class="keyword1"><span class="command">qed</span></span>


<span class="keyword1"><span class="command">lemma</span></span> lift_PDG_scd<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> PDG<span class="main">:</span><span class="quoted"><span class="quoted">"PDG <span class="free">sourcenode</span> <span class="free">targetnode</span> <span class="free">kind</span> <span class="free">valid_edge</span> <span class="free">Entry</span> <span class="free">Def</span> <span class="free">Use</span> <span class="free">state_val</span> <span class="free">Exit</span> 
  <span class="main">(</span>Postdomination.standard_control_dependence <span class="free">sourcenode</span> <span class="free">targetnode</span> <span class="free">valid_edge</span> <span class="free">Exit</span><span class="main">)</span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> pd<span class="main">:</span><span class="quoted"><span class="quoted">"Postdomination <span class="free">sourcenode</span> <span class="free">targetnode</span> <span class="free">kind</span> <span class="free">valid_edge</span> <span class="free">Entry</span> <span class="free">Exit</span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> inner<span class="main">:</span><span class="quoted"><span class="quoted">"CFGExit.inner_node <span class="free">sourcenode</span> <span class="free">targetnode</span> <span class="free">valid_edge</span> <span class="free">Entry</span> <span class="free">Exit</span> <span class="free">nx</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"PDG src trg knd 
  <span class="main">(</span>lift_valid_edge <span class="free">valid_edge</span> <span class="free">sourcenode</span> <span class="free">targetnode</span> <span class="free">kind</span> <span class="free">Entry</span> <span class="free">Exit</span><span class="main">)</span> NewEntry
  <span class="main">(</span>lift_Def <span class="free">Def</span> <span class="free">Entry</span> <span class="free">Exit</span> <span class="free">H</span> <span class="free">L</span><span class="main">)</span> <span class="main">(</span>lift_Use <span class="free">Use</span> <span class="free">Entry</span> <span class="free">Exit</span> <span class="free">H</span> <span class="free">L</span><span class="main">)</span> <span class="free">state_val</span> NewExit
  <span class="main">(</span>Postdomination.standard_control_dependence src trg 
    <span class="main">(</span>lift_valid_edge <span class="free">valid_edge</span> <span class="free">sourcenode</span> <span class="free">targetnode</span> <span class="free">kind</span> <span class="free">Entry</span> <span class="free">Exit</span><span class="main">)</span> NewExit<span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">interpret</span></span> PDG <span class="quoted"><span class="free">sourcenode</span></span> <span class="quoted"><span class="free">targetnode</span></span> <span class="quoted"><span class="free">kind</span></span> <span class="quoted"><span class="free">valid_edge</span></span> <span class="quoted"><span class="free">Entry</span></span> <span class="quoted"><span class="free">Def</span></span> <span class="quoted"><span class="free">Use</span></span> <span class="quoted"><span class="free">state_val</span></span> <span class="quoted"><span class="free">Exit</span></span>
    <span class="quoted"><span class="quoted">"Postdomination.standard_control_dependence <span class="free">sourcenode</span> <span class="free">targetnode</span> 
                                                           <span class="free">valid_edge</span> <span class="free">Exit</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">rule</span> PDG<span class="main">)</span>
  <span class="keyword1"><span class="command">have</span></span> wf<span class="main">:</span><span class="quoted"><span class="quoted">"CFGExit_wf <span class="free">sourcenode</span> <span class="free">targetnode</span> <span class="free">kind</span> <span class="free">valid_edge</span> <span class="free">Entry</span> <span class="free">Def</span> <span class="free">Use</span>
                            <span class="free">state_val</span> <span class="free">Exit</span>"</span></span> <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">unfold_locales</span><span class="main">)</span>
  <span class="keyword1"><span class="command">from</span></span> wf pd inner <span class="keyword1"><span class="command">have</span></span> pd'<span class="main">:</span><span class="quoted"><span class="quoted">"Postdomination src trg knd
    <span class="main">(</span>lift_valid_edge <span class="free">valid_edge</span> <span class="free">sourcenode</span> <span class="free">targetnode</span> <span class="free">kind</span> <span class="free">Entry</span> <span class="free">Exit</span><span class="main">)</span> 
    NewEntry NewExit"</span></span>
    <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">rule</span> lift_Postdomination<span class="main">)</span>
  <span class="keyword1"><span class="command">from</span></span> wf <span class="keyword1"><span class="command">have</span></span> CFG<span class="main">:</span><span class="quoted"><span class="quoted">"CFG src trg
    <span class="main">(</span>lift_valid_edge <span class="free">valid_edge</span> <span class="free">sourcenode</span> <span class="free">targetnode</span> <span class="free">kind</span> <span class="free">Entry</span> <span class="free">Exit</span><span class="main">)</span> NewEntry"</span></span>
    <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">rule</span> lift_CFG<span class="main">)</span>
  <span class="keyword1"><span class="command">from</span></span> wf <span class="keyword1"><span class="command">have</span></span> CFG_wf<span class="main">:</span><span class="quoted"><span class="quoted">"CFG_wf src trg knd
    <span class="main">(</span>lift_valid_edge <span class="free">valid_edge</span> <span class="free">sourcenode</span> <span class="free">targetnode</span> <span class="free">kind</span> <span class="free">Entry</span> <span class="free">Exit</span><span class="main">)</span> NewEntry
    <span class="main">(</span>lift_Def <span class="free">Def</span> <span class="free">Entry</span> <span class="free">Exit</span> <span class="free">H</span> <span class="free">L</span><span class="main">)</span> <span class="main">(</span>lift_Use <span class="free">Use</span> <span class="free">Entry</span> <span class="free">Exit</span> <span class="free">H</span> <span class="free">L</span><span class="main">)</span> <span class="free">state_val</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">rule</span> lift_CFG_wf<span class="main">)</span>
  <span class="keyword1"><span class="command">from</span></span> wf <span class="keyword1"><span class="command">have</span></span> CFGExit<span class="main">:</span><span class="quoted"><span class="quoted">"CFGExit src trg knd 
    <span class="main">(</span>lift_valid_edge <span class="free">valid_edge</span> <span class="free">sourcenode</span> <span class="free">targetnode</span> <span class="free">kind</span> <span class="free">Entry</span> <span class="free">Exit</span><span class="main">)</span> 
    NewEntry NewExit"</span></span>
    <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">rule</span> lift_CFGExit<span class="main">)</span>
  <span class="keyword1"><span class="command">from</span></span> wf <span class="keyword1"><span class="command">have</span></span> CFGExit_wf<span class="main">:</span><span class="quoted"><span class="quoted">"CFGExit_wf src trg knd 
    <span class="main">(</span>lift_valid_edge <span class="free">valid_edge</span> <span class="free">sourcenode</span> <span class="free">targetnode</span> <span class="free">kind</span> <span class="free">Entry</span> <span class="free">Exit</span><span class="main">)</span> NewEntry
    <span class="main">(</span>lift_Def <span class="free">Def</span> <span class="free">Entry</span> <span class="free">Exit</span> <span class="free">H</span> <span class="free">L</span><span class="main">)</span> <span class="main">(</span>lift_Use <span class="free">Use</span> <span class="free">Entry</span> <span class="free">Exit</span> <span class="free">H</span> <span class="free">L</span><span class="main">)</span> <span class="free">state_val</span> NewExit"</span></span>
    <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">rule</span> lift_CFGExit_wf<span class="main">)</span>
  <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
  <span class="keyword1"><span class="command">proof</span></span>
    <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">a</span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"lift_valid_edge <span class="free">valid_edge</span> <span class="free">sourcenode</span> <span class="free">targetnode</span> <span class="free">kind</span> <span class="free">Entry</span> <span class="free">Exit</span> <span class="skolem">a</span>"</span></span>
      <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"trg <span class="skolem">a</span> <span class="main">=</span> NewEntry"</span></span>
    <span class="keyword1"><span class="command">with</span></span> CFG <span class="keyword3"><span class="command">show</span></span> <span class="quoted">False</span> <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">rule</span> CFG.Entry_target<span class="main">)</span>
  <span class="keyword1"><span class="command">next</span></span>
    <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">a</span> <span class="skolem">a'</span> 
    <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"lift_valid_edge <span class="free">valid_edge</span> <span class="free">sourcenode</span> <span class="free">targetnode</span> <span class="free">kind</span> <span class="free">Entry</span> <span class="free">Exit</span> <span class="skolem">a</span>"</span></span>
      <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"lift_valid_edge <span class="free">valid_edge</span> <span class="free">sourcenode</span> <span class="free">targetnode</span> <span class="free">kind</span> <span class="free">Entry</span> <span class="free">Exit</span> <span class="skolem">a'</span>"</span></span>
      <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"src <span class="skolem">a</span> <span class="main">=</span> src <span class="skolem">a'</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"trg <span class="skolem">a</span> <span class="main">=</span> trg <span class="skolem">a'</span>"</span></span>
    <span class="keyword1"><span class="command">with</span></span> CFG <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">a</span> <span class="main">=</span> <span class="skolem">a'</span>"</span></span> <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">rule</span> CFG.edge_det<span class="main">)</span>
  <span class="keyword1"><span class="command">next</span></span>
    <span class="keyword1"><span class="command">from</span></span> CFG_wf
    <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"lift_Def <span class="free">Def</span> <span class="free">Entry</span> <span class="free">Exit</span> <span class="free">H</span> <span class="free">L</span> NewEntry <span class="main">=</span> <span class="main">{}</span> <span class="main">∧</span>
          lift_Use <span class="free">Use</span> <span class="free">Entry</span> <span class="free">Exit</span> <span class="free">H</span> <span class="free">L</span> NewEntry <span class="main">=</span> <span class="main">{}</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">rule</span> CFG_wf.Entry_empty<span class="main">)</span>
  <span class="keyword1"><span class="command">next</span></span>
    <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">a</span> <span class="skolem">V</span> <span class="skolem">s</span> 
    <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"lift_valid_edge <span class="free">valid_edge</span> <span class="free">sourcenode</span> <span class="free">targetnode</span> <span class="free">kind</span> <span class="free">Entry</span> <span class="free">Exit</span> <span class="skolem">a</span>"</span></span>
      <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">V</span> <span class="main">∉</span> lift_Def <span class="free">Def</span> <span class="free">Entry</span> <span class="free">Exit</span> <span class="free">H</span> <span class="free">L</span> <span class="main">(</span>src <span class="skolem">a</span><span class="main">)</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"pred <span class="main">(</span>knd <span class="skolem">a</span><span class="main">)</span> <span class="skolem">s</span>"</span></span>
    <span class="keyword1"><span class="command">with</span></span> CFG_wf <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="free">state_val</span> <span class="main">(</span>transfer <span class="main">(</span>knd <span class="skolem">a</span><span class="main">)</span> <span class="skolem">s</span><span class="main">)</span> <span class="skolem">V</span> <span class="main">=</span> <span class="free">state_val</span> <span class="skolem">s</span> <span class="skolem">V</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">rule</span> CFG_wf.CFG_edge_no_Def_equal<span class="main">)</span>
  <span class="keyword1"><span class="command">next</span></span>
    <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">a</span> <span class="skolem">s</span> <span class="skolem">s'</span>
    <span class="keyword3"><span class="command">assume</span></span> assms<span class="main">:</span><span class="quoted"><span class="quoted">"lift_valid_edge <span class="free">valid_edge</span> <span class="free">sourcenode</span> <span class="free">targetnode</span> <span class="free">kind</span> <span class="free">Entry</span> <span class="free">Exit</span> <span class="skolem">a</span>"</span></span>
      <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">V</span><span class="main">∈</span>lift_Use <span class="free">Use</span> <span class="free">Entry</span> <span class="free">Exit</span> <span class="free">H</span> <span class="free">L</span> <span class="main">(</span>src <span class="skolem">a</span><span class="main">)</span><span class="main">.</span> <span class="free">state_val</span> <span class="skolem">s</span> <span class="bound">V</span> <span class="main">=</span> <span class="free">state_val</span> <span class="skolem">s'</span> <span class="bound">V</span>"</span></span>
      <span class="quoted"><span class="quoted">"pred <span class="main">(</span>knd <span class="skolem">a</span><span class="main">)</span> <span class="skolem">s</span>"</span></span> <span class="quoted"><span class="quoted">"pred <span class="main">(</span>knd <span class="skolem">a</span><span class="main">)</span> <span class="skolem">s'</span>"</span></span>
    <span class="keyword1"><span class="command">with</span></span> CFG_wf <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">V</span><span class="main">∈</span>lift_Def <span class="free">Def</span> <span class="free">Entry</span> <span class="free">Exit</span> <span class="free">H</span> <span class="free">L</span> <span class="main">(</span>src <span class="skolem">a</span><span class="main">)</span><span class="main">.</span>
             <span class="free">state_val</span> <span class="main">(</span>transfer <span class="main">(</span>knd <span class="skolem">a</span><span class="main">)</span> <span class="skolem">s</span><span class="main">)</span> <span class="bound">V</span> <span class="main">=</span> <span class="free">state_val</span> <span class="main">(</span>transfer <span class="main">(</span>knd <span class="skolem">a</span><span class="main">)</span> <span class="skolem">s'</span><span class="main">)</span> <span class="bound">V</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">rule</span> CFG_wf.CFG_edge_transfer_uses_only_Use<span class="main">)</span>
  <span class="keyword1"><span class="command">next</span></span>
    <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">a</span> <span class="skolem">s</span> <span class="skolem">s'</span>
    <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"lift_valid_edge <span class="free">valid_edge</span> <span class="free">sourcenode</span> <span class="free">targetnode</span> <span class="free">kind</span> <span class="free">Entry</span> <span class="free">Exit</span> <span class="skolem">a</span>"</span></span>
      <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"pred <span class="main">(</span>knd <span class="skolem">a</span><span class="main">)</span> <span class="skolem">s</span>"</span></span> 
      <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">V</span><span class="main">∈</span>lift_Use <span class="free">Use</span> <span class="free">Entry</span> <span class="free">Exit</span> <span class="free">H</span> <span class="free">L</span> <span class="main">(</span>src <span class="skolem">a</span><span class="main">)</span><span class="main">.</span> <span class="free">state_val</span> <span class="skolem">s</span> <span class="bound">V</span> <span class="main">=</span> <span class="free">state_val</span> <span class="skolem">s'</span> <span class="bound">V</span>"</span></span>
    <span class="keyword1"><span class="command">with</span></span> CFG_wf <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"pred <span class="main">(</span>knd <span class="skolem">a</span><span class="main">)</span> <span class="skolem">s'</span>"</span></span> <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">rule</span> CFG_wf.CFG_edge_Uses_pred_equal<span class="main">)</span>
  <span class="keyword1"><span class="command">next</span></span>
    <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">a</span> <span class="skolem">a'</span>
    <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"lift_valid_edge <span class="free">valid_edge</span> <span class="free">sourcenode</span> <span class="free">targetnode</span> <span class="free">kind</span> <span class="free">Entry</span> <span class="free">Exit</span> <span class="skolem">a</span>"</span></span>
      <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"lift_valid_edge <span class="free">valid_edge</span> <span class="free">sourcenode</span> <span class="free">targetnode</span> <span class="free">kind</span> <span class="free">Entry</span> <span class="free">Exit</span> <span class="skolem">a'</span>"</span></span>
      <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"src <span class="skolem">a</span> <span class="main">=</span> src <span class="skolem">a'</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"trg <span class="skolem">a</span> <span class="main">≠</span> trg <span class="skolem">a'</span>"</span></span>
    <span class="keyword1"><span class="command">with</span></span> CFG_wf <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound">Q</span> <span class="bound">Q'</span><span class="main">.</span> knd <span class="skolem">a</span> <span class="main">=</span> <span class="main">(</span><span class="bound">Q</span><span class="main">)<span class="hidden">⇩</span><sub>√</sub></span> <span class="main">∧</span> knd <span class="skolem">a'</span> <span class="main">=</span> <span class="main">(</span><span class="bound">Q'</span><span class="main">)<span class="hidden">⇩</span><sub>√</sub></span> <span class="main">∧</span> 
                             <span class="main">(</span><span class="main">∀</span><span class="bound">s</span><span class="main">.</span> <span class="main">(</span><span class="bound">Q</span> <span class="bound">s</span> <span class="main">⟶</span> <span class="main">¬</span> <span class="bound">Q'</span> <span class="bound">s</span><span class="main">)</span> <span class="main">∧</span> <span class="main">(</span><span class="bound">Q'</span> <span class="bound">s</span> <span class="main">⟶</span> <span class="main">¬</span> <span class="bound">Q</span> <span class="bound">s</span><span class="main">)</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">rule</span> CFG_wf.deterministic<span class="main">)</span>
  <span class="keyword1"><span class="command">next</span></span>
    <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">a</span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"lift_valid_edge <span class="free">valid_edge</span> <span class="free">sourcenode</span> <span class="free">targetnode</span> <span class="free">kind</span> <span class="free">Entry</span> <span class="free">Exit</span> <span class="skolem">a</span>"</span></span>
      <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"src <span class="skolem">a</span> <span class="main">=</span> NewExit"</span></span>
    <span class="keyword1"><span class="command">with</span></span> CFGExit <span class="keyword3"><span class="command">show</span></span> <span class="quoted">False</span> <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">rule</span> CFGExit.Exit_source<span class="main">)</span>
  <span class="keyword1"><span class="command">next</span></span>
    <span class="keyword1"><span class="command">from</span></span> CFGExit
    <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound">a</span><span class="main">.</span> lift_valid_edge <span class="free">valid_edge</span> <span class="free">sourcenode</span> <span class="free">targetnode</span> <span class="free">kind</span> <span class="free">Entry</span> <span class="free">Exit</span> <span class="bound">a</span> <span class="main">∧</span>
              src <span class="bound">a</span> <span class="main">=</span> NewEntry <span class="main">∧</span> trg <span class="bound">a</span> <span class="main">=</span> NewExit <span class="main">∧</span> knd <span class="bound">a</span> <span class="main">=</span> <span class="main">(</span><span class="main">λ</span><span class="bound">s</span><span class="main">.</span> False<span class="main">)<span class="hidden">⇩</span><sub>√</sub></span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">rule</span> CFGExit.Entry_Exit_edge<span class="main">)</span>
  <span class="keyword1"><span class="command">next</span></span>
    <span class="keyword1"><span class="command">from</span></span> CFGExit_wf
    <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"lift_Def <span class="free">Def</span> <span class="free">Entry</span> <span class="free">Exit</span> <span class="free">H</span> <span class="free">L</span> NewExit <span class="main">=</span> <span class="main">{}</span> <span class="main">∧</span>
          lift_Use <span class="free">Use</span> <span class="free">Entry</span> <span class="free">Exit</span> <span class="free">H</span> <span class="free">L</span> NewExit <span class="main">=</span> <span class="main">{}</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">rule</span> CFGExit_wf.Exit_empty<span class="main">)</span>
  <span class="keyword1"><span class="command">next</span></span>
    <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">n</span> <span class="skolem">n'</span>
    <span class="keyword3"><span class="command">assume</span></span> scd<span class="main">:</span><span class="quoted"><span class="quoted">"Postdomination.standard_control_dependence src trg
      <span class="main">(</span>lift_valid_edge <span class="free">valid_edge</span> <span class="free">sourcenode</span> <span class="free">targetnode</span> <span class="free">kind</span> <span class="free">Entry</span> <span class="free">Exit</span><span class="main">)</span> NewExit <span class="skolem">n</span> <span class="skolem">n'</span>"</span></span>
    <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">n'</span> <span class="main">≠</span> NewExit"</span></span>
    <span class="keyword1"><span class="command">proof</span></span><span class="main">(</span><span class="operator">rule</span> ccontr<span class="main">)</span>
      <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> <span class="skolem">n'</span> <span class="main">≠</span> NewExit"</span></span>
      <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">n'</span> <span class="main">=</span> NewExit"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
      <span class="keyword1"><span class="command">with</span></span> scd pd' <span class="keyword3"><span class="command">show</span></span> <span class="quoted">False</span> 
        <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">fastforce</span> <span class="quasi_keyword">intro</span><span class="main"><span class="main">:</span></span>Postdomination.Exit_not_standard_control_dependent<span class="main">)</span>
    <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">next</span></span>
    <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">n</span> <span class="skolem">n'</span>
    <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"Postdomination.standard_control_dependence src trg
      <span class="main">(</span>lift_valid_edge <span class="free">valid_edge</span> <span class="free">sourcenode</span> <span class="free">targetnode</span> <span class="free">kind</span> <span class="free">Entry</span> <span class="free">Exit</span><span class="main">)</span> NewExit <span class="skolem">n</span> <span class="skolem">n'</span>"</span></span>
    <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound">as</span><span class="main">.</span> CFG.path src trg
               <span class="main">(</span>lift_valid_edge <span class="free">valid_edge</span> <span class="free">sourcenode</span> <span class="free">targetnode</span> <span class="free">kind</span> <span class="free">Entry</span> <span class="free">Exit</span><span class="main">)</span>
               <span class="skolem">n</span> <span class="bound">as</span> <span class="skolem">n'</span> <span class="main">∧</span> <span class="bound">as</span> <span class="main">≠</span> <span class="main">[]</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">fastforce</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span>Postdomination.standard_control_dependence_def<span class="main"><span class="main">[</span></span><span class="operator">OF</span> pd'<span class="main"><span class="main">]</span></span><span class="main">)</span>
  <span class="keyword1"><span class="command">qed</span></span>
<span class="keyword1"><span class="command">qed</span></span>




<span class="keyword1"><span class="command">lemma</span></span> lift_PDG_standard_backward_slice<span class="main">:</span>
  <span class="keyword2"><span class="keyword">fixes</span></span> <span class="free">valid_edge</span> <span class="keyword2"><span class="keyword">and</span></span> <span class="free">sourcenode</span> <span class="keyword2"><span class="keyword">and</span></span> <span class="free">targetnode</span> <span class="keyword2"><span class="keyword">and</span></span> <span class="free">kind</span> <span class="keyword2"><span class="keyword">and</span></span> <span class="free">Entry</span> <span class="keyword2"><span class="keyword">and</span></span> <span class="free">Exit</span>
  <span class="keyword2"><span class="keyword">and</span></span> <span class="free">Def</span> <span class="keyword2"><span class="keyword">and</span></span> <span class="free">Use</span> <span class="keyword2"><span class="keyword">and</span></span> <span class="free">H</span> <span class="keyword2"><span class="keyword">and</span></span> <span class="free">L</span>
  <span class="keyword2"><span class="keyword">defines</span></span> lve<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="free">lve</span> <span class="main">≡</span> lift_valid_edge <span class="free">valid_edge</span> <span class="free">sourcenode</span> <span class="free">targetnode</span> <span class="free">kind</span> <span class="free">Entry</span> <span class="free">Exit</span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> lDef<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="free">lDef</span> <span class="main">≡</span> lift_Def <span class="free">Def</span> <span class="free">Entry</span> <span class="free">Exit</span> <span class="free">H</span> <span class="free">L</span>"</span></span> 
  <span class="keyword2"><span class="keyword">and</span></span> lUse<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="free">lUse</span> <span class="main">≡</span> lift_Use <span class="free">Use</span> <span class="free">Entry</span> <span class="free">Exit</span> <span class="free">H</span> <span class="free">L</span>"</span></span>
  <span class="keyword2"><span class="keyword">assumes</span></span> PDG<span class="main">:</span><span class="quoted"><span class="quoted">"PDG <span class="free">sourcenode</span> <span class="free">targetnode</span> <span class="free">kind</span> <span class="free">valid_edge</span> <span class="free">Entry</span> <span class="free">Def</span> <span class="free">Use</span> <span class="free">state_val</span> <span class="free">Exit</span> 
  <span class="main">(</span>Postdomination.standard_control_dependence <span class="free">sourcenode</span> <span class="free">targetnode</span> <span class="free">valid_edge</span> <span class="free">Exit</span><span class="main">)</span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> pd<span class="main">:</span><span class="quoted"><span class="quoted">"Postdomination <span class="free">sourcenode</span> <span class="free">targetnode</span> <span class="free">kind</span> <span class="free">valid_edge</span> <span class="free">Entry</span> <span class="free">Exit</span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> inner<span class="main">:</span><span class="quoted"><span class="quoted">"CFGExit.inner_node <span class="free">sourcenode</span> <span class="free">targetnode</span> <span class="free">valid_edge</span> <span class="free">Entry</span> <span class="free">Exit</span> <span class="free">nx</span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">H</span> <span class="main">∩</span> <span class="free">L</span> <span class="main">=</span> <span class="main">{}</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">H</span> <span class="main">∪</span> <span class="free">L</span> <span class="main">=</span> UNIV"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"NonInterferenceIntraGraph src trg knd <span class="free">lve</span> NewEntry <span class="free">lDef</span> <span class="free">lUse</span> <span class="free">state_val</span> 
         <span class="main">(</span>PDG.PDG_BS src trg <span class="free">lve</span> <span class="free">lDef</span> <span class="free">lUse</span>
           <span class="main">(</span>Postdomination.standard_control_dependence src trg <span class="free">lve</span> NewExit<span class="main">)</span><span class="main">)</span>
         NewExit <span class="free">H</span> <span class="free">L</span> <span class="main">(</span>Node <span class="free">Entry</span><span class="main">)</span> <span class="main">(</span>Node <span class="free">Exit</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">interpret</span></span> PDG <span class="quoted"><span class="free">sourcenode</span></span> <span class="quoted"><span class="free">targetnode</span></span> <span class="quoted"><span class="free">kind</span></span> <span class="quoted"><span class="free">valid_edge</span></span> <span class="quoted"><span class="free">Entry</span></span> <span class="quoted"><span class="free">Def</span></span> <span class="quoted"><span class="free">Use</span></span> <span class="quoted"><span class="free">state_val</span></span> <span class="quoted"><span class="free">Exit</span></span>
    <span class="quoted"><span class="quoted">"Postdomination.standard_control_dependence <span class="free">sourcenode</span> <span class="free">targetnode</span> 
                                                           <span class="free">valid_edge</span> <span class="free">Exit</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">rule</span> PDG<span class="main">)</span>
  <span class="keyword1"><span class="command">have</span></span> wf<span class="main">:</span><span class="quoted"><span class="quoted">"CFGExit_wf <span class="free">sourcenode</span> <span class="free">targetnode</span> <span class="free">kind</span> <span class="free">valid_edge</span> <span class="free">Entry</span> <span class="free">Def</span> <span class="free">Use</span>
                            <span class="free">state_val</span> <span class="free">Exit</span>"</span></span> <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">unfold_locales</span><span class="main">)</span>
  <span class="keyword1"><span class="command">interpret</span></span> wf'<span class="main">:</span>CFGExit_wf <span class="quoted">src</span> <span class="quoted">trg</span> <span class="quoted">knd</span> <span class="quoted"><span class="free">lve</span></span> <span class="quoted">NewEntry</span> <span class="quoted"><span class="free">lDef</span></span> <span class="quoted"><span class="free">lUse</span></span> <span class="quoted"><span class="free">state_val</span></span> <span class="quoted">NewExit</span>
    <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">fastforce</span> <span class="quasi_keyword">intro</span><span class="main"><span class="main">:</span></span>lift_CFGExit_wf wf <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span>lve lDef lUse<span class="main">)</span>
  <span class="keyword1"><span class="command">from</span></span> PDG pd inner lve lDef lUse <span class="keyword1"><span class="command">have</span></span> PDG'<span class="main">:</span><span class="quoted"><span class="quoted">"PDG src trg knd 
    <span class="free">lve</span> NewEntry <span class="free">lDef</span> <span class="free">lUse</span> <span class="free">state_val</span> NewExit
    <span class="main">(</span>Postdomination.standard_control_dependence src trg <span class="free">lve</span> NewExit<span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">fastforce</span> <span class="quasi_keyword">intro</span><span class="main"><span class="main">:</span></span>lift_PDG_scd<span class="main">)</span>
  <span class="keyword1"><span class="command">from</span></span> wf pd inner <span class="keyword1"><span class="command">have</span></span> pd'<span class="main">:</span><span class="quoted"><span class="quoted">"Postdomination src trg knd
    <span class="main">(</span>lift_valid_edge <span class="free">valid_edge</span> <span class="free">sourcenode</span> <span class="free">targetnode</span> <span class="free">kind</span> <span class="free">Entry</span> <span class="free">Exit</span><span class="main">)</span> 
    NewEntry NewExit"</span></span>
    <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">rule</span> lift_Postdomination<span class="main">)</span>
  <span class="keyword1"><span class="command">from</span></span> wf lve <span class="keyword1"><span class="command">have</span></span> CFG<span class="main">:</span><span class="quoted"><span class="quoted">"CFG src trg <span class="free">lve</span> NewEntry"</span></span>
    <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">fastforce</span> <span class="quasi_keyword">intro</span><span class="main"><span class="main">:</span></span>lift_CFG<span class="main">)</span>
  <span class="keyword1"><span class="command">from</span></span> wf lve lDef lUse 
  <span class="keyword1"><span class="command">have</span></span> CFG_wf<span class="main">:</span><span class="quoted"><span class="quoted">"CFG_wf src trg knd <span class="free">lve</span> NewEntry <span class="free">lDef</span> <span class="free">lUse</span> <span class="free">state_val</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">fastforce</span> <span class="quasi_keyword">intro</span><span class="main"><span class="main">:</span></span>lift_CFG_wf<span class="main">)</span>
  <span class="keyword1"><span class="command">from</span></span> wf lve <span class="keyword1"><span class="command">have</span></span> CFGExit<span class="main">:</span><span class="quoted"><span class="quoted">"CFGExit src trg knd <span class="free">lve</span> NewEntry NewExit"</span></span>
    <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">fastforce</span> <span class="quasi_keyword">intro</span><span class="main"><span class="main">:</span></span>lift_CFGExit<span class="main">)</span>
  <span class="keyword1"><span class="command">from</span></span> wf lve lDef lUse 
  <span class="keyword1"><span class="command">have</span></span> CFGExit_wf<span class="main">:</span><span class="quoted"><span class="quoted">"CFGExit_wf src trg knd <span class="free">lve</span> NewEntry <span class="free">lDef</span> <span class="free">lUse</span> <span class="free">state_val</span> NewExit"</span></span>
    <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">fastforce</span> <span class="quasi_keyword">intro</span><span class="main"><span class="main">:</span></span>lift_CFGExit_wf<span class="main">)</span>
  <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
  <span class="keyword1"><span class="command">proof</span></span>
    <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">n</span> <span class="skolem">S</span>
    <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">n</span> <span class="main">∈</span> PDG.PDG_BS src trg <span class="free">lve</span> <span class="free">lDef</span> <span class="free">lUse</span>
      <span class="main">(</span>Postdomination.standard_control_dependence src trg <span class="free">lve</span> NewExit<span class="main">)</span> <span class="skolem">S</span>"</span></span>
    <span class="keyword1"><span class="command">with</span></span> PDG' <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"CFG.valid_node src trg <span class="free">lve</span> <span class="skolem">n</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">rule</span> PDG.PDG_BS_valid_node<span class="main">)</span>
  <span class="keyword1"><span class="command">next</span></span>
    <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">n</span> <span class="skolem">S</span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"CFG.valid_node src trg <span class="free">lve</span> <span class="skolem">n</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">n</span> <span class="main">∈</span> <span class="skolem">S</span>"</span></span>
    <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">n</span> <span class="main">∈</span> PDG.PDG_BS src trg <span class="free">lve</span> <span class="free">lDef</span> <span class="free">lUse</span>
      <span class="main">(</span>Postdomination.standard_control_dependence src trg <span class="free">lve</span> NewExit<span class="main">)</span> <span class="skolem">S</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">fastforce</span> <span class="quasi_keyword">intro</span><span class="main"><span class="main">:</span></span>PDG.PDG_path_Nil<span class="main"><span class="main">[</span></span><span class="operator">OF</span> PDG'<span class="main"><span class="main">]</span></span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span>PDG.PDG_BS_def<span class="main"><span class="main">[</span></span><span class="operator">OF</span> PDG'<span class="main"><span class="main">]</span></span><span class="main">)</span>
  <span class="keyword1"><span class="command">next</span></span>
    <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">n'</span> <span class="skolem">S</span> <span class="skolem">n</span> <span class="skolem">V</span>
    <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">n'</span> <span class="main">∈</span> PDG.PDG_BS src trg <span class="free">lve</span> <span class="free">lDef</span> <span class="free">lUse</span>
      <span class="main">(</span>Postdomination.standard_control_dependence src trg <span class="free">lve</span> NewExit<span class="main">)</span> <span class="skolem">S</span>"</span></span>
      <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"CFG_wf.data_dependence src trg <span class="free">lve</span> <span class="free">lDef</span> <span class="free">lUse</span> <span class="skolem">n</span> <span class="skolem">V</span> <span class="skolem">n'</span>"</span></span>
    <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">n</span> <span class="main">∈</span> PDG.PDG_BS src trg <span class="free">lve</span> <span class="free">lDef</span> <span class="free">lUse</span>
      <span class="main">(</span>Postdomination.standard_control_dependence src trg <span class="free">lve</span> NewExit<span class="main">)</span> <span class="skolem">S</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">fastforce</span> <span class="quasi_keyword">intro</span><span class="main"><span class="main">:</span></span>PDG.PDG_path_Append<span class="main"><span class="main">[</span></span><span class="operator">OF</span> PDG'<span class="main"><span class="main">]</span></span> PDG.PDG_path_ddep<span class="main"><span class="main">[</span></span><span class="operator">OF</span> PDG'<span class="main"><span class="main">]</span></span>
                        PDG.PDG_ddep_edge<span class="main"><span class="main">[</span></span><span class="operator">OF</span> PDG'<span class="main"><span class="main">]</span></span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span>PDG.PDG_BS_def<span class="main"><span class="main">[</span></span><span class="operator">OF</span> PDG'<span class="main"><span class="main">]</span></span>
                  <span class="quasi_keyword">split</span><span class="main"><span class="main">:</span></span>if_split_asm<span class="main">)</span>
  <span class="keyword1"><span class="command">next</span></span>
    <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">n</span> <span class="skolem">S</span>
    <span class="keyword1"><span class="command">interpret</span></span> PDGx<span class="main">:</span>PDG <span class="quoted">src</span> <span class="quoted">trg</span> <span class="quoted">knd</span> <span class="quoted"><span class="free">lve</span></span> <span class="quoted">NewEntry</span> <span class="quoted"><span class="free">lDef</span></span> <span class="quoted"><span class="free">lUse</span></span> <span class="quoted"><span class="free">state_val</span></span> <span class="quoted">NewExit</span>
      <span class="quoted"><span class="quoted">"Postdomination.standard_control_dependence src trg <span class="free">lve</span> NewExit"</span></span>
      <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">rule</span> PDG'<span class="main">)</span>
    <span class="keyword1"><span class="command">interpret</span></span> pdx<span class="main">:</span>Postdomination <span class="quoted">src</span> <span class="quoted">trg</span> <span class="quoted">knd</span> <span class="quoted"><span class="free">lve</span></span> <span class="quoted">NewEntry</span> <span class="quoted">NewExit</span>
      <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">fastforce</span> <span class="quasi_keyword">intro</span><span class="main"><span class="main">:</span></span>pd' <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span>lve<span class="main">)</span>
    <span class="keyword1"><span class="command">have</span></span> scd<span class="main">:</span><span class="quoted"><span class="quoted">"StandardControlDependencePDG src trg knd <span class="free">lve</span> NewEntry
      <span class="free">lDef</span> <span class="free">lUse</span> <span class="free">state_val</span> NewExit"</span></span> <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">unfold_locales</span><span class="main">)</span>
    <span class="keyword1"><span class="command">from</span></span> StandardControlDependencePDG.obs_singleton<span class="main">[</span><span class="operator">OF</span> scd<span class="main">]</span>
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">∃</span><span class="bound">m</span><span class="main">.</span> CFG.obs src trg <span class="free">lve</span> <span class="skolem">n</span>
      <span class="main">(</span>PDG.PDG_BS src trg <span class="free">lve</span> <span class="free">lDef</span> <span class="free">lUse</span>
        <span class="main">(</span>Postdomination.standard_control_dependence src trg <span class="free">lve</span> NewExit<span class="main">)</span> <span class="skolem">S</span><span class="main">)</span> <span class="main">=</span> <span class="main">{</span><span class="bound">m</span><span class="main">}</span><span class="main">)</span> <span class="main">∨</span>
      CFG.obs src trg <span class="free">lve</span> <span class="skolem">n</span>
      <span class="main">(</span>PDG.PDG_BS src trg <span class="free">lve</span> <span class="free">lDef</span> <span class="free">lUse</span>
        <span class="main">(</span>Postdomination.standard_control_dependence src trg <span class="free">lve</span> NewExit<span class="main">)</span> <span class="skolem">S</span><span class="main">)</span> <span class="main">=</span> <span class="main">{}</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">fastforce</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span>StandardControlDependencePDG.PDG_BS_s_def<span class="main"><span class="main">[</span></span><span class="operator">OF</span> scd<span class="main"><span class="main">]</span></span><span class="main">)</span>
    <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"finite <span class="main">(</span>CFG.obs src trg <span class="free">lve</span> <span class="skolem">n</span>
        <span class="main">(</span>PDG.PDG_BS src trg <span class="free">lve</span> <span class="free">lDef</span> <span class="free">lUse</span>
          <span class="main">(</span>Postdomination.standard_control_dependence src trg <span class="free">lve</span> NewExit<span class="main">)</span> <span class="skolem">S</span><span class="main">)</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">fastforce</span>
  <span class="keyword1"><span class="command">next</span></span>
    <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">n</span> <span class="skolem">S</span>
    <span class="keyword1"><span class="command">interpret</span></span> PDGx<span class="main">:</span>PDG <span class="quoted">src</span> <span class="quoted">trg</span> <span class="quoted">knd</span> <span class="quoted"><span class="free">lve</span></span> <span class="quoted">NewEntry</span> <span class="quoted"><span class="free">lDef</span></span> <span class="quoted"><span class="free">lUse</span></span> <span class="quoted"><span class="free">state_val</span></span> <span class="quoted">NewExit</span>
      <span class="quoted"><span class="quoted">"Postdomination.standard_control_dependence src trg <span class="free">lve</span> NewExit"</span></span>
      <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">rule</span> PDG'<span class="main">)</span>
    <span class="keyword1"><span class="command">interpret</span></span> pdx<span class="main">:</span>Postdomination <span class="quoted">src</span> <span class="quoted">trg</span> <span class="quoted">knd</span> <span class="quoted"><span class="free">lve</span></span> <span class="quoted">NewEntry</span> <span class="quoted">NewExit</span>
      <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">fastforce</span> <span class="quasi_keyword">intro</span><span class="main"><span class="main">:</span></span>pd' <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span>lve<span class="main">)</span>
    <span class="keyword1"><span class="command">have</span></span> scd<span class="main">:</span><span class="quoted"><span class="quoted">"StandardControlDependencePDG src trg knd <span class="free">lve</span> NewEntry
      <span class="free">lDef</span> <span class="free">lUse</span> <span class="free">state_val</span> NewExit"</span></span> <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">unfold_locales</span><span class="main">)</span>
    <span class="keyword1"><span class="command">from</span></span> StandardControlDependencePDG.obs_singleton<span class="main">[</span><span class="operator">OF</span> scd<span class="main">]</span>
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">∃</span><span class="bound">m</span><span class="main">.</span> CFG.obs src trg <span class="free">lve</span> <span class="skolem">n</span>
      <span class="main">(</span>PDG.PDG_BS src trg <span class="free">lve</span> <span class="free">lDef</span> <span class="free">lUse</span>
        <span class="main">(</span>Postdomination.standard_control_dependence src trg <span class="free">lve</span> NewExit<span class="main">)</span> <span class="skolem">S</span><span class="main">)</span> <span class="main">=</span> <span class="main">{</span><span class="bound">m</span><span class="main">}</span><span class="main">)</span> <span class="main">∨</span>
      CFG.obs src trg <span class="free">lve</span> <span class="skolem">n</span>
      <span class="main">(</span>PDG.PDG_BS src trg <span class="free">lve</span> <span class="free">lDef</span> <span class="free">lUse</span>
        <span class="main">(</span>Postdomination.standard_control_dependence src trg <span class="free">lve</span> NewExit<span class="main">)</span> <span class="skolem">S</span><span class="main">)</span> <span class="main">=</span> <span class="main">{}</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">fastforce</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span>StandardControlDependencePDG.PDG_BS_s_def<span class="main"><span class="main">[</span></span><span class="operator">OF</span> scd<span class="main"><span class="main">]</span></span><span class="main">)</span>
    <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"card <span class="main">(</span>CFG.obs src trg <span class="free">lve</span> <span class="skolem">n</span>
      <span class="main">(</span>PDG.PDG_BS src trg <span class="free">lve</span> <span class="free">lDef</span> <span class="free">lUse</span>
        <span class="main">(</span>Postdomination.standard_control_dependence src trg <span class="free">lve</span> NewExit<span class="main">)</span> <span class="skolem">S</span><span class="main">)</span><span class="main">)</span> <span class="main">≤</span> <span class="main">1</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">fastforce</span>
  <span class="keyword1"><span class="command">next</span></span>
    <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">a</span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="free">lve</span> <span class="skolem">a</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"src <span class="skolem">a</span> <span class="main">=</span> NewEntry"</span></span>
    <span class="keyword1"><span class="command">with</span></span> lve <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"trg <span class="skolem">a</span> <span class="main">=</span> NewExit <span class="main">∨</span> trg <span class="skolem">a</span> <span class="main">=</span> Node <span class="free">Entry</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">fastforce</span> <span class="quasi_keyword">elim</span><span class="main"><span class="main">:</span></span>lift_valid_edge.cases<span class="main">)</span>
  <span class="keyword1"><span class="command">next</span></span>
    <span class="keyword1"><span class="command">from</span></span> lve_Entry_edge lve
    <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound">a</span><span class="main">.</span> <span class="free">lve</span> <span class="bound">a</span> <span class="main">∧</span> src <span class="bound">a</span> <span class="main">=</span> NewEntry <span class="main">∧</span> trg <span class="bound">a</span> <span class="main">=</span> Node <span class="free">Entry</span> <span class="main">∧</span> knd <span class="bound">a</span> <span class="main">=</span> <span class="main">(</span><span class="main">λ</span><span class="bound">s</span><span class="main">.</span> True<span class="main">)<span class="hidden">⇩</span><sub>√</sub></span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">fastforce</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span>knd_def<span class="main">)</span>
  <span class="keyword1"><span class="command">next</span></span>
    <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">a</span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="free">lve</span> <span class="skolem">a</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"trg <span class="skolem">a</span> <span class="main">=</span> Node <span class="free">Entry</span>"</span></span>
    <span class="keyword1"><span class="command">with</span></span> lve <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"src <span class="skolem">a</span> <span class="main">=</span> NewEntry"</span></span> <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">fastforce</span> <span class="quasi_keyword">elim</span><span class="main"><span class="main">:</span></span>lift_valid_edge.cases<span class="main">)</span>
  <span class="keyword1"><span class="command">next</span></span>
    <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">a</span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="free">lve</span> <span class="skolem">a</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"trg <span class="skolem">a</span> <span class="main">=</span> NewExit"</span></span>
    <span class="keyword1"><span class="command">with</span></span> lve <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"src <span class="skolem">a</span> <span class="main">=</span> NewEntry <span class="main">∨</span> src <span class="skolem">a</span> <span class="main">=</span> Node <span class="free">Exit</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">fastforce</span> <span class="quasi_keyword">elim</span><span class="main"><span class="main">:</span></span>lift_valid_edge.cases<span class="main">)</span>
  <span class="keyword1"><span class="command">next</span></span>
    <span class="keyword1"><span class="command">from</span></span> lve_Exit_edge lve
    <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound">a</span><span class="main">.</span> <span class="free">lve</span> <span class="bound">a</span> <span class="main">∧</span> src <span class="bound">a</span> <span class="main">=</span> Node <span class="free">Exit</span> <span class="main">∧</span> trg <span class="bound">a</span> <span class="main">=</span> NewExit <span class="main">∧</span> knd <span class="bound">a</span> <span class="main">=</span> <span class="main">(</span><span class="main">λ</span><span class="bound">s</span><span class="main">.</span> True<span class="main">)<span class="hidden">⇩</span><sub>√</sub></span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">fastforce</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span>knd_def<span class="main">)</span>
  <span class="keyword1"><span class="command">next</span></span>
    <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">a</span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="free">lve</span> <span class="skolem">a</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"src <span class="skolem">a</span> <span class="main">=</span> Node <span class="free">Exit</span>"</span></span>
    <span class="keyword1"><span class="command">with</span></span> lve <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"trg <span class="skolem">a</span> <span class="main">=</span> NewExit"</span></span> <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">fastforce</span> <span class="quasi_keyword">elim</span><span class="main"><span class="main">:</span></span>lift_valid_edge.cases<span class="main">)</span>
  <span class="keyword1"><span class="command">next</span></span>
    <span class="keyword1"><span class="command">from</span></span> lDef <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="free">lDef</span> <span class="main">(</span>Node <span class="free">Entry</span><span class="main">)</span> <span class="main">=</span> <span class="free">H</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">fastforce</span> <span class="quasi_keyword">elim</span><span class="main"><span class="main">:</span></span>lift_Def_set.cases <span class="quasi_keyword">intro</span><span class="main"><span class="main">:</span></span>lift_Def_High<span class="main">)</span>
  <span class="keyword1"><span class="command">next</span></span>
    <span class="keyword1"><span class="command">from</span></span> Entry_noteq_Exit lUse <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="free">lUse</span> <span class="main">(</span>Node <span class="free">Entry</span><span class="main">)</span> <span class="main">=</span> <span class="free">H</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">fastforce</span> <span class="quasi_keyword">elim</span><span class="main"><span class="main">:</span></span>lift_Use_set.cases <span class="quasi_keyword">intro</span><span class="main"><span class="main">:</span></span>lift_Use_High<span class="main">)</span>
  <span class="keyword1"><span class="command">next</span></span>
    <span class="keyword1"><span class="command">from</span></span> Entry_noteq_Exit lUse <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="free">lUse</span> <span class="main">(</span>Node <span class="free">Exit</span><span class="main">)</span> <span class="main">=</span> <span class="free">L</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">fastforce</span> <span class="quasi_keyword">elim</span><span class="main"><span class="main">:</span></span>lift_Use_set.cases <span class="quasi_keyword">intro</span><span class="main"><span class="main">:</span></span>lift_Use_Low<span class="main">)</span>
  <span class="keyword1"><span class="command">next</span></span>
    <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="free">H</span> <span class="main">∩</span> <span class="free">L</span> <span class="main">=</span> <span class="main">{}</span>›</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="free">H</span> <span class="main">∩</span> <span class="free">L</span> <span class="main">=</span> <span class="main">{}</span>"</span></span> <span class="keyword1"><span class="command">.</span></span>
  <span class="keyword1"><span class="command">next</span></span>
    <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="free">H</span> <span class="main">∪</span> <span class="free">L</span> <span class="main">=</span> UNIV›</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="free">H</span> <span class="main">∪</span> <span class="free">L</span> <span class="main">=</span> UNIV"</span></span> <span class="keyword1"><span class="command">.</span></span>
  <span class="keyword1"><span class="command">qed</span></span>
<span class="keyword1"><span class="command">qed</span></span>



<span class="keyword1"><span class="command">subsubsection</span></span> <span class="quoted"><span class="plain_text">‹Lifting <span class="antiquoted"><span class="raw_text"><span class="antiquoted"><span class="raw_text"><span class="operator"><span class="operator">‹</span></span>PDG_BS›</span></span></span></span> with <span class="antiquoted"><span class="raw_text"><span class="antiquoted"><span class="raw_text"><span class="operator"><span class="operator">‹</span></span>weak_control_dependence›</span></span></span></span>›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> lift_StrongPostdomination<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> wf<span class="main">:</span><span class="quoted"><span class="quoted">"CFGExit_wf <span class="free">sourcenode</span> <span class="free">targetnode</span> <span class="free">kind</span> <span class="free">valid_edge</span> <span class="free">Entry</span> <span class="free">Def</span> <span class="free">Use</span>
                         <span class="free">state_val</span> <span class="free">Exit</span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> spd<span class="main">:</span><span class="quoted"><span class="quoted">"StrongPostdomination <span class="free">sourcenode</span> <span class="free">targetnode</span> <span class="free">kind</span> <span class="free">valid_edge</span> <span class="free">Entry</span> <span class="free">Exit</span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> inner<span class="main">:</span><span class="quoted"><span class="quoted">"CFGExit.inner_node <span class="free">sourcenode</span> <span class="free">targetnode</span> <span class="free">valid_edge</span> <span class="free">Entry</span> <span class="free">Exit</span> <span class="free">nx</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"StrongPostdomination src trg knd
  <span class="main">(</span>lift_valid_edge <span class="free">valid_edge</span> <span class="free">sourcenode</span> <span class="free">targetnode</span> <span class="free">kind</span> <span class="free">Entry</span> <span class="free">Exit</span><span class="main">)</span> NewEntry NewExit"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">interpret</span></span> StrongPostdomination <span class="quoted"><span class="free">sourcenode</span></span> <span class="quoted"><span class="free">targetnode</span></span> <span class="quoted"><span class="free">kind</span></span> <span class="quoted"><span class="free">valid_edge</span></span> <span class="quoted"><span class="free">Entry</span></span> <span class="quoted"><span class="free">Exit</span></span>
    <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">rule</span> spd<span class="main">)</span>
  <span class="keyword1"><span class="command">have</span></span> pd<span class="main">:</span><span class="quoted"><span class="quoted">"Postdomination <span class="free">sourcenode</span> <span class="free">targetnode</span> <span class="free">kind</span> <span class="free">valid_edge</span> <span class="free">Entry</span> <span class="free">Exit</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">unfold_locales</span><span class="main">)</span>
  <span class="keyword1"><span class="command">interpret</span></span> pd'<span class="main">:</span>Postdomination <span class="quoted">src</span> <span class="quoted">trg</span> <span class="quoted">knd</span>
    <span class="quoted"><span class="quoted">"lift_valid_edge <span class="free">valid_edge</span> <span class="free">sourcenode</span> <span class="free">targetnode</span> <span class="free">kind</span> <span class="free">Entry</span> <span class="free">Exit</span>"</span></span>
    <span class="quoted">NewEntry</span> <span class="quoted">NewExit</span>
    <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">fastforce</span> <span class="quasi_keyword">intro</span><span class="main"><span class="main">:</span></span>wf inner lift_Postdomination pd<span class="main">)</span>
  <span class="keyword1"><span class="command">interpret</span></span> CFGExit_wf<span class="main">:</span>CFGExit_wf <span class="quoted">src</span> <span class="quoted">trg</span> <span class="quoted">knd</span>
    <span class="quoted"><span class="quoted">"lift_valid_edge <span class="free">valid_edge</span> <span class="free">sourcenode</span> <span class="free">targetnode</span> <span class="free">kind</span> <span class="free">Entry</span> <span class="free">Exit</span>"</span></span> <span class="quoted">NewEntry</span>
    <span class="quoted"><span class="quoted">"lift_Def <span class="free">Def</span> <span class="free">Entry</span> <span class="free">Exit</span> <span class="free">H</span> <span class="free">L</span>"</span></span> <span class="quoted"><span class="quoted">"lift_Use <span class="free">Use</span> <span class="free">Entry</span> <span class="free">Exit</span> <span class="free">H</span> <span class="free">L</span>"</span></span> <span class="quoted"><span class="free">state_val</span></span> <span class="quoted">NewExit</span>
    <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">fastforce</span> <span class="quasi_keyword">intro</span><span class="main"><span class="main">:</span></span>lift_CFGExit_wf wf<span class="main">)</span>
  <span class="keyword1"><span class="command">from</span></span> wf <span class="keyword1"><span class="command">have</span></span> CFG<span class="main">:</span><span class="quoted"><span class="quoted">"CFG src trg
    <span class="main">(</span>lift_valid_edge <span class="free">valid_edge</span> <span class="free">sourcenode</span> <span class="free">targetnode</span> <span class="free">kind</span> <span class="free">Entry</span> <span class="free">Exit</span><span class="main">)</span> NewEntry"</span></span>
    <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">rule</span> lift_CFG<span class="main">)</span>
  <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
  <span class="keyword1"><span class="command">proof</span></span>
    <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">n</span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"CFG.valid_node src trg
      <span class="main">(</span>lift_valid_edge <span class="free">valid_edge</span> <span class="free">sourcenode</span> <span class="free">targetnode</span> <span class="free">kind</span> <span class="free">Entry</span> <span class="free">Exit</span><span class="main">)</span> <span class="skolem">n</span>"</span></span>
    <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"finite
      <span class="main">{</span><span class="bound">n'</span><span class="main">.</span> <span class="main">∃</span><span class="bound">a'</span><span class="main">.</span> lift_valid_edge <span class="free">valid_edge</span> <span class="free">sourcenode</span> <span class="free">targetnode</span> <span class="free">kind</span> <span class="free">Entry</span> <span class="free">Exit</span> <span class="bound">a'</span> <span class="main">∧</span>
                src <span class="bound">a'</span> <span class="main">=</span> <span class="skolem">n</span> <span class="main">∧</span> trg <span class="bound">a'</span> <span class="main">=</span> <span class="bound">n'</span><span class="main">}</span>"</span></span>
    <span class="keyword1"><span class="command">proof</span></span><span class="main">(</span><span class="operator">cases</span> <span class="quoted"><span class="skolem">n</span></span><span class="main">)</span>
      <span class="keyword3"><span class="command">case</span></span> NewEntry
      <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="main">{</span><span class="bound">n'</span><span class="main">.</span> <span class="main">∃</span><span class="bound">a'</span><span class="main">.</span> lift_valid_edge <span class="free">valid_edge</span> <span class="free">sourcenode</span> <span class="free">targetnode</span> <span class="free">kind</span> 
                     <span class="free">Entry</span> <span class="free">Exit</span> <span class="bound">a'</span> <span class="main">∧</span> src <span class="bound">a'</span> <span class="main">=</span> <span class="skolem">n</span> <span class="main">∧</span> trg <span class="bound">a'</span> <span class="main">=</span> <span class="bound">n'</span><span class="main">}</span> <span class="main">=</span> <span class="main">{</span>NewExit<span class="main">,</span>Node <span class="free">Entry</span><span class="main">}</span>"</span></span>
        <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">elim</span><span class="main"><span class="main">:</span></span>lift_valid_edge.cases <span class="quasi_keyword">intro</span><span class="main"><span class="main">:</span></span>lift_valid_edge.intros<span class="main">)</span>
      <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">next</span></span>
      <span class="keyword3"><span class="command">case</span></span> NewExit
      <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="main">{</span><span class="bound">n'</span><span class="main">.</span> <span class="main">∃</span><span class="bound">a'</span><span class="main">.</span> lift_valid_edge <span class="free">valid_edge</span> <span class="free">sourcenode</span> <span class="free">targetnode</span> <span class="free">kind</span> 
                     <span class="free">Entry</span> <span class="free">Exit</span> <span class="bound">a'</span> <span class="main">∧</span> src <span class="bound">a'</span> <span class="main">=</span> <span class="skolem">n</span> <span class="main">∧</span> trg <span class="bound">a'</span> <span class="main">=</span> <span class="bound">n'</span><span class="main">}</span> <span class="main">=</span> <span class="main">{}</span>"</span></span>
        <span class="keyword1"><span class="command">by</span></span> <span class="operator">fastforce</span>
      <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">next</span></span>
      <span class="keyword3"><span class="command">case</span></span> <span class="main">(</span>Node <span class="skolem">m</span><span class="main">)</span>
      <span class="keyword1"><span class="command">with</span></span> Entry_Exit_edge <span class="quoted"><span class="quoted">‹CFG.valid_node src trg
        <span class="main">(</span>lift_valid_edge <span class="free">valid_edge</span> <span class="free">sourcenode</span> <span class="free">targetnode</span> <span class="free">kind</span> <span class="free">Entry</span> <span class="free">Exit</span><span class="main">)</span> <span class="skolem">n</span>›</span></span>
      <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"valid_node <span class="skolem">m</span>"</span></span> 
        <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">elim</span><span class="main"><span class="main">:</span></span>lift_valid_edge.cases 
                <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span>CFG.valid_node_def<span class="main"><span class="main">[</span></span><span class="operator">OF</span> CFG<span class="main"><span class="main">]</span></span> valid_node_def<span class="main">)</span>
      <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"finite <span class="main">{</span><span class="bound">m'</span><span class="main">.</span> <span class="main">∃</span><span class="bound">a'</span><span class="main">.</span> <span class="free">valid_edge</span> <span class="bound">a'</span> <span class="main">∧</span> <span class="free">sourcenode</span> <span class="bound">a'</span> <span class="main">=</span> <span class="skolem">m</span> <span class="main">∧</span> <span class="free">targetnode</span> <span class="bound">a'</span> <span class="main">=</span> <span class="bound">m'</span><span class="main">}</span>"</span></span>
        <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">rule</span> successor_set_finite<span class="main">)</span>
      <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">{</span><span class="bound">m'</span><span class="main">.</span> <span class="main">∃</span><span class="bound">a'</span><span class="main">.</span> lift_valid_edge <span class="free">valid_edge</span> <span class="free">sourcenode</span> <span class="free">targetnode</span> <span class="free">kind</span> 
                      <span class="free">Entry</span> <span class="free">Exit</span> <span class="bound">a'</span> <span class="main">∧</span> src <span class="bound">a'</span> <span class="main">=</span> Node <span class="skolem">m</span> <span class="main">∧</span> trg <span class="bound">a'</span> <span class="main">=</span> Node <span class="bound">m'</span><span class="main">}</span> <span class="main">⊆</span> 
            <span class="main">{</span><span class="bound">m'</span><span class="main">.</span> <span class="main">∃</span><span class="bound">a'</span><span class="main">.</span> <span class="free">valid_edge</span> <span class="bound">a'</span> <span class="main">∧</span> <span class="free">sourcenode</span> <span class="bound">a'</span> <span class="main">=</span> <span class="skolem">m</span> <span class="main">∧</span> <span class="free">targetnode</span> <span class="bound">a'</span> <span class="main">=</span> <span class="bound">m'</span><span class="main">}</span>"</span></span>
        <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">fastforce</span> <span class="quasi_keyword">elim</span><span class="main"><span class="main">:</span></span>lift_valid_edge.cases<span class="main">)</span>
      <span class="keyword1"><span class="command">with</span></span> <span class="quoted"><span class="quoted">‹finite <span class="main">{</span><span class="bound">m'</span><span class="main">.</span> <span class="main">∃</span><span class="bound">a'</span><span class="main">.</span> <span class="free">valid_edge</span> <span class="bound">a'</span> <span class="main">∧</span> <span class="free">sourcenode</span> <span class="bound">a'</span> <span class="main">=</span> <span class="skolem">m</span> <span class="main">∧</span> <span class="free">targetnode</span> <span class="bound">a'</span> <span class="main">=</span> <span class="bound">m'</span><span class="main">}</span>›</span></span>
      <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"finite <span class="main">{</span><span class="bound">m'</span><span class="main">.</span> <span class="main">∃</span><span class="bound">a'</span><span class="main">.</span> lift_valid_edge <span class="free">valid_edge</span> <span class="free">sourcenode</span> <span class="free">targetnode</span> <span class="free">kind</span> 
                             <span class="free">Entry</span> <span class="free">Exit</span> <span class="bound">a'</span> <span class="main">∧</span> src <span class="bound">a'</span> <span class="main">=</span> Node <span class="skolem">m</span> <span class="main">∧</span> trg <span class="bound">a'</span> <span class="main">=</span> Node <span class="bound">m'</span><span class="main">}</span>"</span></span>
        <span class="keyword1"><span class="command">by</span></span> <span class="operator">-</span><span class="main">(</span><span class="operator">rule</span> finite_subset<span class="main">)</span>
      <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"finite <span class="main">(</span>Node <span class="main">`</span> <span class="main">{</span><span class="bound">m'</span><span class="main">.</span> <span class="main">∃</span><span class="bound">a'</span><span class="main">.</span> lift_valid_edge <span class="free">valid_edge</span> <span class="free">sourcenode</span> 
        <span class="free">targetnode</span> <span class="free">kind</span> <span class="free">Entry</span> <span class="free">Exit</span> <span class="bound">a'</span> <span class="main">∧</span> src <span class="bound">a'</span> <span class="main">=</span> Node <span class="skolem">m</span> <span class="main">∧</span> trg <span class="bound">a'</span> <span class="main">=</span> Node <span class="bound">m'</span><span class="main">}</span><span class="main">)</span>"</span></span>
        <span class="keyword1"><span class="command">by</span></span> <span class="operator">fastforce</span>
      <span class="keyword1"><span class="command">hence</span></span> fin<span class="main">:</span><span class="quoted"><span class="quoted">"finite <span class="main">(</span><span class="main">(</span>Node <span class="main">`</span> <span class="main">{</span><span class="bound">m'</span><span class="main">.</span> <span class="main">∃</span><span class="bound">a'</span><span class="main">.</span> lift_valid_edge <span class="free">valid_edge</span> <span class="free">sourcenode</span> 
        <span class="free">targetnode</span> <span class="free">kind</span> <span class="free">Entry</span> <span class="free">Exit</span> <span class="bound">a'</span> <span class="main">∧</span> src <span class="bound">a'</span> <span class="main">=</span> Node <span class="skolem">m</span> <span class="main">∧</span> trg <span class="bound">a'</span> <span class="main">=</span> Node <span class="bound">m'</span><span class="main">}</span><span class="main">)</span> <span class="main">∪</span>
        <span class="main">{</span>NewEntry<span class="main">,</span>NewExit<span class="main">}</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">fastforce</span>
      <span class="keyword1"><span class="command">with</span></span> Node <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">{</span><span class="bound">n'</span><span class="main">.</span> <span class="main">∃</span><span class="bound">a'</span><span class="main">.</span> lift_valid_edge <span class="free">valid_edge</span> <span class="free">sourcenode</span> <span class="free">targetnode</span> <span class="free">kind</span> 
        <span class="free">Entry</span> <span class="free">Exit</span> <span class="bound">a'</span> <span class="main">∧</span> src <span class="bound">a'</span> <span class="main">=</span> <span class="skolem">n</span> <span class="main">∧</span> trg <span class="bound">a'</span> <span class="main">=</span> <span class="bound">n'</span><span class="main">}</span> <span class="main">⊆</span>
        <span class="main">(</span>Node <span class="main">`</span> <span class="main">{</span><span class="bound">m'</span><span class="main">.</span> <span class="main">∃</span><span class="bound">a'</span><span class="main">.</span> lift_valid_edge <span class="free">valid_edge</span> <span class="free">sourcenode</span> 
        <span class="free">targetnode</span> <span class="free">kind</span> <span class="free">Entry</span> <span class="free">Exit</span> <span class="bound">a'</span> <span class="main">∧</span> src <span class="bound">a'</span> <span class="main">=</span> Node <span class="skolem">m</span> <span class="main">∧</span> trg <span class="bound">a'</span> <span class="main">=</span> Node <span class="bound">m'</span><span class="main">}</span><span class="main">)</span> <span class="main">∪</span>
        <span class="main">{</span>NewEntry<span class="main">,</span>NewExit<span class="main">}</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span> <span class="main">(</span><span class="operator">case_tac</span> <span class="quoted"><span class="improper">x</span></span><span class="main"><span class="keyword3">,</span></span><span class="operator">auto</span><span class="main">)</span>
      <span class="keyword1"><span class="command">with</span></span> fin <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">-</span><span class="main">(</span><span class="operator">rule</span> finite_subset<span class="main">)</span>
    <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">qed</span></span>
<span class="keyword1"><span class="command">qed</span></span>





<span class="keyword1"><span class="command">lemma</span></span> lift_PDG_wcd<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> PDG<span class="main">:</span><span class="quoted"><span class="quoted">"PDG <span class="free">sourcenode</span> <span class="free">targetnode</span> <span class="free">kind</span> <span class="free">valid_edge</span> <span class="free">Entry</span> <span class="free">Def</span> <span class="free">Use</span> <span class="free">state_val</span> <span class="free">Exit</span> 
  <span class="main">(</span>StrongPostdomination.weak_control_dependence <span class="free">sourcenode</span> <span class="free">targetnode</span> 
  <span class="free">valid_edge</span> <span class="free">Exit</span><span class="main">)</span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> spd<span class="main">:</span><span class="quoted"><span class="quoted">"StrongPostdomination <span class="free">sourcenode</span> <span class="free">targetnode</span> <span class="free">kind</span> <span class="free">valid_edge</span> <span class="free">Entry</span> <span class="free">Exit</span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> inner<span class="main">:</span><span class="quoted"><span class="quoted">"CFGExit.inner_node <span class="free">sourcenode</span> <span class="free">targetnode</span> <span class="free">valid_edge</span> <span class="free">Entry</span> <span class="free">Exit</span> <span class="free">nx</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"PDG src trg knd 
  <span class="main">(</span>lift_valid_edge <span class="free">valid_edge</span> <span class="free">sourcenode</span> <span class="free">targetnode</span> <span class="free">kind</span> <span class="free">Entry</span> <span class="free">Exit</span><span class="main">)</span> NewEntry
  <span class="main">(</span>lift_Def <span class="free">Def</span> <span class="free">Entry</span> <span class="free">Exit</span> <span class="free">H</span> <span class="free">L</span><span class="main">)</span> <span class="main">(</span>lift_Use <span class="free">Use</span> <span class="free">Entry</span> <span class="free">Exit</span> <span class="free">H</span> <span class="free">L</span><span class="main">)</span> <span class="free">state_val</span> NewExit
  <span class="main">(</span>StrongPostdomination.weak_control_dependence src trg 
    <span class="main">(</span>lift_valid_edge <span class="free">valid_edge</span> <span class="free">sourcenode</span> <span class="free">targetnode</span> <span class="free">kind</span> <span class="free">Entry</span> <span class="free">Exit</span><span class="main">)</span> NewExit<span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">interpret</span></span> PDG <span class="quoted"><span class="free">sourcenode</span></span> <span class="quoted"><span class="free">targetnode</span></span> <span class="quoted"><span class="free">kind</span></span> <span class="quoted"><span class="free">valid_edge</span></span> <span class="quoted"><span class="free">Entry</span></span> <span class="quoted"><span class="free">Def</span></span> <span class="quoted"><span class="free">Use</span></span> <span class="quoted"><span class="free">state_val</span></span> <span class="quoted"><span class="free">Exit</span></span>
    <span class="quoted"><span class="quoted">"StrongPostdomination.weak_control_dependence <span class="free">sourcenode</span> <span class="free">targetnode</span> 
                                                           <span class="free">valid_edge</span> <span class="free">Exit</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">rule</span> PDG<span class="main">)</span>
  <span class="keyword1"><span class="command">have</span></span> wf<span class="main">:</span><span class="quoted"><span class="quoted">"CFGExit_wf <span class="free">sourcenode</span> <span class="free">targetnode</span> <span class="free">kind</span> <span class="free">valid_edge</span> <span class="free">Entry</span> <span class="free">Def</span> <span class="free">Use</span>
                            <span class="free">state_val</span> <span class="free">Exit</span>"</span></span> <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">unfold_locales</span><span class="main">)</span>
  <span class="keyword1"><span class="command">from</span></span> wf spd inner <span class="keyword1"><span class="command">have</span></span> spd'<span class="main">:</span><span class="quoted"><span class="quoted">"StrongPostdomination src trg knd
    <span class="main">(</span>lift_valid_edge <span class="free">valid_edge</span> <span class="free">sourcenode</span> <span class="free">targetnode</span> <span class="free">kind</span> <span class="free">Entry</span> <span class="free">Exit</span><span class="main">)</span> 
    NewEntry NewExit"</span></span>
    <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">rule</span> lift_StrongPostdomination<span class="main">)</span>
  <span class="keyword1"><span class="command">from</span></span> wf <span class="keyword1"><span class="command">have</span></span> CFG<span class="main">:</span><span class="quoted"><span class="quoted">"CFG src trg
    <span class="main">(</span>lift_valid_edge <span class="free">valid_edge</span> <span class="free">sourcenode</span> <span class="free">targetnode</span> <span class="free">kind</span> <span class="free">Entry</span> <span class="free">Exit</span><span class="main">)</span> NewEntry"</span></span>
    <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">rule</span> lift_CFG<span class="main">)</span>
  <span class="keyword1"><span class="command">from</span></span> wf <span class="keyword1"><span class="command">have</span></span> CFG_wf<span class="main">:</span><span class="quoted"><span class="quoted">"CFG_wf src trg knd
    <span class="main">(</span>lift_valid_edge <span class="free">valid_edge</span> <span class="free">sourcenode</span> <span class="free">targetnode</span> <span class="free">kind</span> <span class="free">Entry</span> <span class="free">Exit</span><span class="main">)</span> NewEntry
    <span class="main">(</span>lift_Def <span class="free">Def</span> <span class="free">Entry</span> <span class="free">Exit</span> <span class="free">H</span> <span class="free">L</span><span class="main">)</span> <span class="main">(</span>lift_Use <span class="free">Use</span> <span class="free">Entry</span> <span class="free">Exit</span> <span class="free">H</span> <span class="free">L</span><span class="main">)</span> <span class="free">state_val</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">rule</span> lift_CFG_wf<span class="main">)</span>
  <span class="keyword1"><span class="command">from</span></span> wf <span class="keyword1"><span class="command">have</span></span> CFGExit<span class="main">:</span><span class="quoted"><span class="quoted">"CFGExit src trg knd 
    <span class="main">(</span>lift_valid_edge <span class="free">valid_edge</span> <span class="free">sourcenode</span> <span class="free">targetnode</span> <span class="free">kind</span> <span class="free">Entry</span> <span class="free">Exit</span><span class="main">)</span> 
    NewEntry NewExit"</span></span>
    <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">rule</span> lift_CFGExit<span class="main">)</span>
  <span class="keyword1"><span class="command">from</span></span> wf <span class="keyword1"><span class="command">have</span></span> CFGExit_wf<span class="main">:</span><span class="quoted"><span class="quoted">"CFGExit_wf src trg knd 
    <span class="main">(</span>lift_valid_edge <span class="free">valid_edge</span> <span class="free">sourcenode</span> <span class="free">targetnode</span> <span class="free">kind</span> <span class="free">Entry</span> <span class="free">Exit</span><span class="main">)</span> NewEntry
    <span class="main">(</span>lift_Def <span class="free">Def</span> <span class="free">Entry</span> <span class="free">Exit</span> <span class="free">H</span> <span class="free">L</span><span class="main">)</span> <span class="main">(</span>lift_Use <span class="free">Use</span> <span class="free">Entry</span> <span class="free">Exit</span> <span class="free">H</span> <span class="free">L</span><span class="main">)</span> <span class="free">state_val</span> NewExit"</span></span>
    <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">rule</span> lift_CFGExit_wf<span class="main">)</span>
  <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
  <span class="keyword1"><span class="command">proof</span></span>
    <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">a</span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"lift_valid_edge <span class="free">valid_edge</span> <span class="free">sourcenode</span> <span class="free">targetnode</span> <span class="free">kind</span> <span class="free">Entry</span> <span class="free">Exit</span> <span class="skolem">a</span>"</span></span>
      <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"trg <span class="skolem">a</span> <span class="main">=</span> NewEntry"</span></span>
    <span class="keyword1"><span class="command">with</span></span> CFG <span class="keyword3"><span class="command">show</span></span> <span class="quoted">False</span> <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">rule</span> CFG.Entry_target<span class="main">)</span>
  <span class="keyword1"><span class="command">next</span></span>
    <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">a</span> <span class="skolem">a'</span> 
    <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"lift_valid_edge <span class="free">valid_edge</span> <span class="free">sourcenode</span> <span class="free">targetnode</span> <span class="free">kind</span> <span class="free">Entry</span> <span class="free">Exit</span> <span class="skolem">a</span>"</span></span>
      <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"lift_valid_edge <span class="free">valid_edge</span> <span class="free">sourcenode</span> <span class="free">targetnode</span> <span class="free">kind</span> <span class="free">Entry</span> <span class="free">Exit</span> <span class="skolem">a'</span>"</span></span>
      <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"src <span class="skolem">a</span> <span class="main">=</span> src <span class="skolem">a'</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"trg <span class="skolem">a</span> <span class="main">=</span> trg <span class="skolem">a'</span>"</span></span>
    <span class="keyword1"><span class="command">with</span></span> CFG <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">a</span> <span class="main">=</span> <span class="skolem">a'</span>"</span></span> <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">rule</span> CFG.edge_det<span class="main">)</span>
  <span class="keyword1"><span class="command">next</span></span>
    <span class="keyword1"><span class="command">from</span></span> CFG_wf
    <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"lift_Def <span class="free">Def</span> <span class="free">Entry</span> <span class="free">Exit</span> <span class="free">H</span> <span class="free">L</span> NewEntry <span class="main">=</span> <span class="main">{}</span> <span class="main">∧</span>
          lift_Use <span class="free">Use</span> <span class="free">Entry</span> <span class="free">Exit</span> <span class="free">H</span> <span class="free">L</span> NewEntry <span class="main">=</span> <span class="main">{}</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">rule</span> CFG_wf.Entry_empty<span class="main">)</span>
  <span class="keyword1"><span class="command">next</span></span>
    <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">a</span> <span class="skolem">V</span> <span class="skolem">s</span> 
    <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"lift_valid_edge <span class="free">valid_edge</span> <span class="free">sourcenode</span> <span class="free">targetnode</span> <span class="free">kind</span> <span class="free">Entry</span> <span class="free">Exit</span> <span class="skolem">a</span>"</span></span>
      <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">V</span> <span class="main">∉</span> lift_Def <span class="free">Def</span> <span class="free">Entry</span> <span class="free">Exit</span> <span class="free">H</span> <span class="free">L</span> <span class="main">(</span>src <span class="skolem">a</span><span class="main">)</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"pred <span class="main">(</span>knd <span class="skolem">a</span><span class="main">)</span> <span class="skolem">s</span>"</span></span>
    <span class="keyword1"><span class="command">with</span></span> CFG_wf <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="free">state_val</span> <span class="main">(</span>transfer <span class="main">(</span>knd <span class="skolem">a</span><span class="main">)</span> <span class="skolem">s</span><span class="main">)</span> <span class="skolem">V</span> <span class="main">=</span> <span class="free">state_val</span> <span class="skolem">s</span> <span class="skolem">V</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">rule</span> CFG_wf.CFG_edge_no_Def_equal<span class="main">)</span>
  <span class="keyword1"><span class="command">next</span></span>
    <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">a</span> <span class="skolem">s</span> <span class="skolem">s'</span>
    <span class="keyword3"><span class="command">assume</span></span> assms<span class="main">:</span><span class="quoted"><span class="quoted">"lift_valid_edge <span class="free">valid_edge</span> <span class="free">sourcenode</span> <span class="free">targetnode</span> <span class="free">kind</span> <span class="free">Entry</span> <span class="free">Exit</span> <span class="skolem">a</span>"</span></span>
      <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">V</span><span class="main">∈</span>lift_Use <span class="free">Use</span> <span class="free">Entry</span> <span class="free">Exit</span> <span class="free">H</span> <span class="free">L</span> <span class="main">(</span>src <span class="skolem">a</span><span class="main">)</span><span class="main">.</span> <span class="free">state_val</span> <span class="skolem">s</span> <span class="bound">V</span> <span class="main">=</span> <span class="free">state_val</span> <span class="skolem">s'</span> <span class="bound">V</span>"</span></span>
      <span class="quoted"><span class="quoted">"pred <span class="main">(</span>knd <span class="skolem">a</span><span class="main">)</span> <span class="skolem">s</span>"</span></span> <span class="quoted"><span class="quoted">"pred <span class="main">(</span>knd <span class="skolem">a</span><span class="main">)</span> <span class="skolem">s'</span>"</span></span>
    <span class="keyword1"><span class="command">with</span></span> CFG_wf <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">V</span><span class="main">∈</span>lift_Def <span class="free">Def</span> <span class="free">Entry</span> <span class="free">Exit</span> <span class="free">H</span> <span class="free">L</span> <span class="main">(</span>src <span class="skolem">a</span><span class="main">)</span><span class="main">.</span>
             <span class="free">state_val</span> <span class="main">(</span>transfer <span class="main">(</span>knd <span class="skolem">a</span><span class="main">)</span> <span class="skolem">s</span><span class="main">)</span> <span class="bound">V</span> <span class="main">=</span> <span class="free">state_val</span> <span class="main">(</span>transfer <span class="main">(</span>knd <span class="skolem">a</span><span class="main">)</span> <span class="skolem">s'</span><span class="main">)</span> <span class="bound">V</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">rule</span> CFG_wf.CFG_edge_transfer_uses_only_Use<span class="main">)</span>
  <span class="keyword1"><span class="command">next</span></span>
    <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">a</span> <span class="skolem">s</span> <span class="skolem">s'</span>
    <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"lift_valid_edge <span class="free">valid_edge</span> <span class="free">sourcenode</span> <span class="free">targetnode</span> <span class="free">kind</span> <span class="free">Entry</span> <span class="free">Exit</span> <span class="skolem">a</span>"</span></span>
      <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"pred <span class="main">(</span>knd <span class="skolem">a</span><span class="main">)</span> <span class="skolem">s</span>"</span></span> 
      <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">V</span><span class="main">∈</span>lift_Use <span class="free">Use</span> <span class="free">Entry</span> <span class="free">Exit</span> <span class="free">H</span> <span class="free">L</span> <span class="main">(</span>src <span class="skolem">a</span><span class="main">)</span><span class="main">.</span> <span class="free">state_val</span> <span class="skolem">s</span> <span class="bound">V</span> <span class="main">=</span> <span class="free">state_val</span> <span class="skolem">s'</span> <span class="bound">V</span>"</span></span>
    <span class="keyword1"><span class="command">with</span></span> CFG_wf <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"pred <span class="main">(</span>knd <span class="skolem">a</span><span class="main">)</span> <span class="skolem">s'</span>"</span></span> <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">rule</span> CFG_wf.CFG_edge_Uses_pred_equal<span class="main">)</span>
  <span class="keyword1"><span class="command">next</span></span>
    <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">a</span> <span class="skolem">a'</span>
    <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"lift_valid_edge <span class="free">valid_edge</span> <span class="free">sourcenode</span> <span class="free">targetnode</span> <span class="free">kind</span> <span class="free">Entry</span> <span class="free">Exit</span> <span class="skolem">a</span>"</span></span>
      <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"lift_valid_edge <span class="free">valid_edge</span> <span class="free">sourcenode</span> <span class="free">targetnode</span> <span class="free">kind</span> <span class="free">Entry</span> <span class="free">Exit</span> <span class="skolem">a'</span>"</span></span>
      <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"src <span class="skolem">a</span> <span class="main">=</span> src <span class="skolem">a'</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"trg <span class="skolem">a</span> <span class="main">≠</span> trg <span class="skolem">a'</span>"</span></span>
    <span class="keyword1"><span class="command">with</span></span> CFG_wf <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound">Q</span> <span class="bound">Q'</span><span class="main">.</span> knd <span class="skolem">a</span> <span class="main">=</span> <span class="main">(</span><span class="bound">Q</span><span class="main">)<span class="hidden">⇩</span><sub>√</sub></span> <span class="main">∧</span> knd <span class="skolem">a'</span> <span class="main">=</span> <span class="main">(</span><span class="bound">Q'</span><span class="main">)<span class="hidden">⇩</span><sub>√</sub></span> <span class="main">∧</span> 
                             <span class="main">(</span><span class="main">∀</span><span class="bound">s</span><span class="main">.</span> <span class="main">(</span><span class="bound">Q</span> <span class="bound">s</span> <span class="main">⟶</span> <span class="main">¬</span> <span class="bound">Q'</span> <span class="bound">s</span><span class="main">)</span> <span class="main">∧</span> <span class="main">(</span><span class="bound">Q'</span> <span class="bound">s</span> <span class="main">⟶</span> <span class="main">¬</span> <span class="bound">Q</span> <span class="bound">s</span><span class="main">)</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">rule</span> CFG_wf.deterministic<span class="main">)</span>
  <span class="keyword1"><span class="command">next</span></span>
    <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">a</span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"lift_valid_edge <span class="free">valid_edge</span> <span class="free">sourcenode</span> <span class="free">targetnode</span> <span class="free">kind</span> <span class="free">Entry</span> <span class="free">Exit</span> <span class="skolem">a</span>"</span></span>
      <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"src <span class="skolem">a</span> <span class="main">=</span> NewExit"</span></span>
    <span class="keyword1"><span class="command">with</span></span> CFGExit <span class="keyword3"><span class="command">show</span></span> <span class="quoted">False</span> <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">rule</span> CFGExit.Exit_source<span class="main">)</span>
  <span class="keyword1"><span class="command">next</span></span>
    <span class="keyword1"><span class="command">from</span></span> CFGExit
    <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound">a</span><span class="main">.</span> lift_valid_edge <span class="free">valid_edge</span> <span class="free">sourcenode</span> <span class="free">targetnode</span> <span class="free">kind</span> <span class="free">Entry</span> <span class="free">Exit</span> <span class="bound">a</span> <span class="main">∧</span>
              src <span class="bound">a</span> <span class="main">=</span> NewEntry <span class="main">∧</span> trg <span class="bound">a</span> <span class="main">=</span> NewExit <span class="main">∧</span> knd <span class="bound">a</span> <span class="main">=</span> <span class="main">(</span><span class="main">λ</span><span class="bound">s</span><span class="main">.</span> False<span class="main">)<span class="hidden">⇩</span><sub>√</sub></span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">rule</span> CFGExit.Entry_Exit_edge<span class="main">)</span>
  <span class="keyword1"><span class="command">next</span></span>
    <span class="keyword1"><span class="command">from</span></span> CFGExit_wf
    <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"lift_Def <span class="free">Def</span> <span class="free">Entry</span> <span class="free">Exit</span> <span class="free">H</span> <span class="free">L</span> NewExit <span class="main">=</span> <span class="main">{}</span> <span class="main">∧</span>
          lift_Use <span class="free">Use</span> <span class="free">Entry</span> <span class="free">Exit</span> <span class="free">H</span> <span class="free">L</span> NewExit <span class="main">=</span> <span class="main">{}</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">rule</span> CFGExit_wf.Exit_empty<span class="main">)</span>
  <span class="keyword1"><span class="command">next</span></span>
    <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">n</span> <span class="skolem">n'</span>
    <span class="keyword3"><span class="command">assume</span></span> wcd<span class="main">:</span><span class="quoted"><span class="quoted">"StrongPostdomination.weak_control_dependence src trg
      <span class="main">(</span>lift_valid_edge <span class="free">valid_edge</span> <span class="free">sourcenode</span> <span class="free">targetnode</span> <span class="free">kind</span> <span class="free">Entry</span> <span class="free">Exit</span><span class="main">)</span> NewExit <span class="skolem">n</span> <span class="skolem">n'</span>"</span></span>
    <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">n'</span> <span class="main">≠</span> NewExit"</span></span>
    <span class="keyword1"><span class="command">proof</span></span><span class="main">(</span><span class="operator">rule</span> ccontr<span class="main">)</span>
      <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> <span class="skolem">n'</span> <span class="main">≠</span> NewExit"</span></span>
      <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">n'</span> <span class="main">=</span> NewExit"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
      <span class="keyword1"><span class="command">with</span></span> wcd spd' <span class="keyword3"><span class="command">show</span></span> <span class="quoted">False</span> 
        <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">fastforce</span> <span class="quasi_keyword">intro</span><span class="main"><span class="main">:</span></span>StrongPostdomination.Exit_not_weak_control_dependent<span class="main">)</span>
    <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">next</span></span>
    <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">n</span> <span class="skolem">n'</span>
    <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"StrongPostdomination.weak_control_dependence src trg
      <span class="main">(</span>lift_valid_edge <span class="free">valid_edge</span> <span class="free">sourcenode</span> <span class="free">targetnode</span> <span class="free">kind</span> <span class="free">Entry</span> <span class="free">Exit</span><span class="main">)</span> NewExit <span class="skolem">n</span> <span class="skolem">n'</span>"</span></span>
    <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound">as</span><span class="main">.</span> CFG.path src trg
               <span class="main">(</span>lift_valid_edge <span class="free">valid_edge</span> <span class="free">sourcenode</span> <span class="free">targetnode</span> <span class="free">kind</span> <span class="free">Entry</span> <span class="free">Exit</span><span class="main">)</span>
               <span class="skolem">n</span> <span class="bound">as</span> <span class="skolem">n'</span> <span class="main">∧</span> <span class="bound">as</span> <span class="main">≠</span> <span class="main">[]</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">fastforce</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span>StrongPostdomination.weak_control_dependence_def<span class="main"><span class="main">[</span></span><span class="operator">OF</span> spd'<span class="main"><span class="main">]</span></span><span class="main">)</span>
  <span class="keyword1"><span class="command">qed</span></span>
<span class="keyword1"><span class="command">qed</span></span>




<span class="keyword1"><span class="command">lemma</span></span> lift_PDG_weak_backward_slice<span class="main">:</span>
  <span class="keyword2"><span class="keyword">fixes</span></span> <span class="free">valid_edge</span> <span class="keyword2"><span class="keyword">and</span></span> <span class="free">sourcenode</span> <span class="keyword2"><span class="keyword">and</span></span> <span class="free">targetnode</span> <span class="keyword2"><span class="keyword">and</span></span> <span class="free">kind</span> <span class="keyword2"><span class="keyword">and</span></span> <span class="free">Entry</span> <span class="keyword2"><span class="keyword">and</span></span> <span class="free">Exit</span>
  <span class="keyword2"><span class="keyword">and</span></span> <span class="free">Def</span> <span class="keyword2"><span class="keyword">and</span></span> <span class="free">Use</span> <span class="keyword2"><span class="keyword">and</span></span> <span class="free">H</span> <span class="keyword2"><span class="keyword">and</span></span> <span class="free">L</span>
  <span class="keyword2"><span class="keyword">defines</span></span> lve<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="free">lve</span> <span class="main">≡</span> lift_valid_edge <span class="free">valid_edge</span> <span class="free">sourcenode</span> <span class="free">targetnode</span> <span class="free">kind</span> <span class="free">Entry</span> <span class="free">Exit</span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> lDef<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="free">lDef</span> <span class="main">≡</span> lift_Def <span class="free">Def</span> <span class="free">Entry</span> <span class="free">Exit</span> <span class="free">H</span> <span class="free">L</span>"</span></span> 
  <span class="keyword2"><span class="keyword">and</span></span> lUse<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="free">lUse</span> <span class="main">≡</span> lift_Use <span class="free">Use</span> <span class="free">Entry</span> <span class="free">Exit</span> <span class="free">H</span> <span class="free">L</span>"</span></span>
  <span class="keyword2"><span class="keyword">assumes</span></span> PDG<span class="main">:</span><span class="quoted"><span class="quoted">"PDG <span class="free">sourcenode</span> <span class="free">targetnode</span> <span class="free">kind</span> <span class="free">valid_edge</span> <span class="free">Entry</span> <span class="free">Def</span> <span class="free">Use</span> <span class="free">state_val</span> <span class="free">Exit</span> 
  <span class="main">(</span>StrongPostdomination.weak_control_dependence <span class="free">sourcenode</span> <span class="free">targetnode</span> 
  <span class="free">valid_edge</span> <span class="free">Exit</span><span class="main">)</span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> spd<span class="main">:</span><span class="quoted"><span class="quoted">"StrongPostdomination <span class="free">sourcenode</span> <span class="free">targetnode</span> <span class="free">kind</span> <span class="free">valid_edge</span> <span class="free">Entry</span> <span class="free">Exit</span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> inner<span class="main">:</span><span class="quoted"><span class="quoted">"CFGExit.inner_node <span class="free">sourcenode</span> <span class="free">targetnode</span> <span class="free">valid_edge</span> <span class="free">Entry</span> <span class="free">Exit</span> <span class="free">nx</span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">H</span> <span class="main">∩</span> <span class="free">L</span> <span class="main">=</span> <span class="main">{}</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">H</span> <span class="main">∪</span> <span class="free">L</span> <span class="main">=</span> UNIV"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"NonInterferenceIntraGraph src trg knd <span class="free">lve</span> NewEntry <span class="free">lDef</span> <span class="free">lUse</span> <span class="free">state_val</span> 
         <span class="main">(</span>PDG.PDG_BS src trg <span class="free">lve</span> <span class="free">lDef</span> <span class="free">lUse</span>
           <span class="main">(</span>StrongPostdomination.weak_control_dependence src trg <span class="free">lve</span> NewExit<span class="main">)</span><span class="main">)</span>
         NewExit <span class="free">H</span> <span class="free">L</span> <span class="main">(</span>Node <span class="free">Entry</span><span class="main">)</span> <span class="main">(</span>Node <span class="free">Exit</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">interpret</span></span> PDG <span class="quoted"><span class="free">sourcenode</span></span> <span class="quoted"><span class="free">targetnode</span></span> <span class="quoted"><span class="free">kind</span></span> <span class="quoted"><span class="free">valid_edge</span></span> <span class="quoted"><span class="free">Entry</span></span> <span class="quoted"><span class="free">Def</span></span> <span class="quoted"><span class="free">Use</span></span> <span class="quoted"><span class="free">state_val</span></span> <span class="quoted"><span class="free">Exit</span></span>
    <span class="quoted"><span class="quoted">"StrongPostdomination.weak_control_dependence <span class="free">sourcenode</span> <span class="free">targetnode</span> 
                                                           <span class="free">valid_edge</span> <span class="free">Exit</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">rule</span> PDG<span class="main">)</span>
  <span class="keyword1"><span class="command">have</span></span> wf<span class="main">:</span><span class="quoted"><span class="quoted">"CFGExit_wf <span class="free">sourcenode</span> <span class="free">targetnode</span> <span class="free">kind</span> <span class="free">valid_edge</span> <span class="free">Entry</span> <span class="free">Def</span> <span class="free">Use</span>
                            <span class="free">state_val</span> <span class="free">Exit</span>"</span></span> <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">unfold_locales</span><span class="main">)</span>
  <span class="keyword1"><span class="command">interpret</span></span> wf'<span class="main">:</span>CFGExit_wf <span class="quoted">src</span> <span class="quoted">trg</span> <span class="quoted">knd</span> <span class="quoted"><span class="free">lve</span></span> <span class="quoted">NewEntry</span> <span class="quoted"><span class="free">lDef</span></span> <span class="quoted"><span class="free">lUse</span></span> <span class="quoted"><span class="free">state_val</span></span> <span class="quoted">NewExit</span>
    <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">fastforce</span> <span class="quasi_keyword">intro</span><span class="main"><span class="main">:</span></span>lift_CFGExit_wf wf <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span>lve lDef lUse<span class="main">)</span>
  <span class="keyword1"><span class="command">from</span></span> PDG spd inner lve lDef lUse <span class="keyword1"><span class="command">have</span></span> PDG'<span class="main">:</span><span class="quoted"><span class="quoted">"PDG src trg knd 
    <span class="free">lve</span> NewEntry <span class="free">lDef</span> <span class="free">lUse</span> <span class="free">state_val</span> NewExit
    <span class="main">(</span>StrongPostdomination.weak_control_dependence src trg <span class="free">lve</span> NewExit<span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">fastforce</span> <span class="quasi_keyword">intro</span><span class="main"><span class="main">:</span></span>lift_PDG_wcd<span class="main">)</span>
  <span class="keyword1"><span class="command">from</span></span> wf spd inner <span class="keyword1"><span class="command">have</span></span> spd'<span class="main">:</span><span class="quoted"><span class="quoted">"StrongPostdomination src trg knd
    <span class="main">(</span>lift_valid_edge <span class="free">valid_edge</span> <span class="free">sourcenode</span> <span class="free">targetnode</span> <span class="free">kind</span> <span class="free">Entry</span> <span class="free">Exit</span><span class="main">)</span> 
    NewEntry NewExit"</span></span>
    <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">rule</span> lift_StrongPostdomination<span class="main">)</span>
  <span class="keyword1"><span class="command">from</span></span> wf lve <span class="keyword1"><span class="command">have</span></span> CFG<span class="main">:</span><span class="quoted"><span class="quoted">"CFG src trg <span class="free">lve</span> NewEntry"</span></span>
    <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">fastforce</span> <span class="quasi_keyword">intro</span><span class="main"><span class="main">:</span></span>lift_CFG<span class="main">)</span>
  <span class="keyword1"><span class="command">from</span></span> wf lve lDef lUse 
  <span class="keyword1"><span class="command">have</span></span> CFG_wf<span class="main">:</span><span class="quoted"><span class="quoted">"CFG_wf src trg knd <span class="free">lve</span> NewEntry <span class="free">lDef</span> <span class="free">lUse</span> <span class="free">state_val</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">fastforce</span> <span class="quasi_keyword">intro</span><span class="main"><span class="main">:</span></span>lift_CFG_wf<span class="main">)</span>
  <span class="keyword1"><span class="command">from</span></span> wf lve <span class="keyword1"><span class="command">have</span></span> CFGExit<span class="main">:</span><span class="quoted"><span class="quoted">"CFGExit src trg knd <span class="free">lve</span> NewEntry NewExit"</span></span>
    <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">fastforce</span> <span class="quasi_keyword">intro</span><span class="main"><span class="main">:</span></span>lift_CFGExit<span class="main">)</span>
  <span class="keyword1"><span class="command">from</span></span> wf lve lDef lUse 
  <span class="keyword1"><span class="command">have</span></span> CFGExit_wf<span class="main">:</span><span class="quoted"><span class="quoted">"CFGExit_wf src trg knd <span class="free">lve</span> NewEntry <span class="free">lDef</span> <span class="free">lUse</span> <span class="free">state_val</span> NewExit"</span></span>
    <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">fastforce</span> <span class="quasi_keyword">intro</span><span class="main"><span class="main">:</span></span>lift_CFGExit_wf<span class="main">)</span>
  <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
  <span class="keyword1"><span class="command">proof</span></span>
    <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">n</span> <span class="skolem">S</span>
    <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">n</span> <span class="main">∈</span> PDG.PDG_BS src trg <span class="free">lve</span> <span class="free">lDef</span> <span class="free">lUse</span>
      <span class="main">(</span>StrongPostdomination.weak_control_dependence src trg <span class="free">lve</span> NewExit<span class="main">)</span> <span class="skolem">S</span>"</span></span>
    <span class="keyword1"><span class="command">with</span></span> PDG' <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"CFG.valid_node src trg <span class="free">lve</span> <span class="skolem">n</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">rule</span> PDG.PDG_BS_valid_node<span class="main">)</span>
  <span class="keyword1"><span class="command">next</span></span>
    <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">n</span> <span class="skolem">S</span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"CFG.valid_node src trg <span class="free">lve</span> <span class="skolem">n</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">n</span> <span class="main">∈</span> <span class="skolem">S</span>"</span></span>
    <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">n</span> <span class="main">∈</span> PDG.PDG_BS src trg <span class="free">lve</span> <span class="free">lDef</span> <span class="free">lUse</span>
      <span class="main">(</span>StrongPostdomination.weak_control_dependence src trg <span class="free">lve</span> NewExit<span class="main">)</span> <span class="skolem">S</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">fastforce</span> <span class="quasi_keyword">intro</span><span class="main"><span class="main">:</span></span>PDG.PDG_path_Nil<span class="main"><span class="main">[</span></span><span class="operator">OF</span> PDG'<span class="main"><span class="main">]</span></span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span>PDG.PDG_BS_def<span class="main"><span class="main">[</span></span><span class="operator">OF</span> PDG'<span class="main"><span class="main">]</span></span><span class="main">)</span>
  <span class="keyword1"><span class="command">next</span></span>
    <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">n'</span> <span class="skolem">S</span> <span class="skolem">n</span> <span class="skolem">V</span>
    <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">n'</span> <span class="main">∈</span> PDG.PDG_BS src trg <span class="free">lve</span> <span class="free">lDef</span> <span class="free">lUse</span>
      <span class="main">(</span>StrongPostdomination.weak_control_dependence src trg <span class="free">lve</span> NewExit<span class="main">)</span> <span class="skolem">S</span>"</span></span>
      <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"CFG_wf.data_dependence src trg <span class="free">lve</span> <span class="free">lDef</span> <span class="free">lUse</span> <span class="skolem">n</span> <span class="skolem">V</span> <span class="skolem">n'</span>"</span></span>
    <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">n</span> <span class="main">∈</span> PDG.PDG_BS src trg <span class="free">lve</span> <span class="free">lDef</span> <span class="free">lUse</span>
      <span class="main">(</span>StrongPostdomination.weak_control_dependence src trg <span class="free">lve</span> NewExit<span class="main">)</span> <span class="skolem">S</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">fastforce</span> <span class="quasi_keyword">intro</span><span class="main"><span class="main">:</span></span>PDG.PDG_path_Append<span class="main"><span class="main">[</span></span><span class="operator">OF</span> PDG'<span class="main"><span class="main">]</span></span> PDG.PDG_path_ddep<span class="main"><span class="main">[</span></span><span class="operator">OF</span> PDG'<span class="main"><span class="main">]</span></span>
                        PDG.PDG_ddep_edge<span class="main"><span class="main">[</span></span><span class="operator">OF</span> PDG'<span class="main"><span class="main">]</span></span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span>PDG.PDG_BS_def<span class="main"><span class="main">[</span></span><span class="operator">OF</span> PDG'<span class="main"><span class="main">]</span></span>
                  <span class="quasi_keyword">split</span><span class="main"><span class="main">:</span></span>if_split_asm<span class="main">)</span>
  <span class="keyword1"><span class="command">next</span></span>
    <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">n</span> <span class="skolem">S</span>
    <span class="keyword1"><span class="command">interpret</span></span> PDGx<span class="main">:</span>PDG <span class="quoted">src</span> <span class="quoted">trg</span> <span class="quoted">knd</span> <span class="quoted"><span class="free">lve</span></span> <span class="quoted">NewEntry</span> <span class="quoted"><span class="free">lDef</span></span> <span class="quoted"><span class="free">lUse</span></span> <span class="quoted"><span class="free">state_val</span></span> <span class="quoted">NewExit</span>
      <span class="quoted"><span class="quoted">"StrongPostdomination.weak_control_dependence src trg <span class="free">lve</span> NewExit"</span></span>
      <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">rule</span> PDG'<span class="main">)</span>
    <span class="keyword1"><span class="command">interpret</span></span> spdx<span class="main">:</span>StrongPostdomination <span class="quoted">src</span> <span class="quoted">trg</span> <span class="quoted">knd</span> <span class="quoted"><span class="free">lve</span></span> <span class="quoted">NewEntry</span> <span class="quoted">NewExit</span>
      <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">fastforce</span> <span class="quasi_keyword">intro</span><span class="main"><span class="main">:</span></span>spd' <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span>lve<span class="main">)</span>
    <span class="keyword1"><span class="command">have</span></span> wcd<span class="main">:</span><span class="quoted"><span class="quoted">"WeakControlDependencePDG src trg knd <span class="free">lve</span> NewEntry
      <span class="free">lDef</span> <span class="free">lUse</span> <span class="free">state_val</span> NewExit"</span></span> <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">unfold_locales</span><span class="main">)</span>
    <span class="keyword1"><span class="command">from</span></span> WeakControlDependencePDG.obs_singleton<span class="main">[</span><span class="operator">OF</span> wcd<span class="main">]</span>
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">∃</span><span class="bound">m</span><span class="main">.</span> CFG.obs src trg <span class="free">lve</span> <span class="skolem">n</span>
      <span class="main">(</span>PDG.PDG_BS src trg <span class="free">lve</span> <span class="free">lDef</span> <span class="free">lUse</span>
       <span class="main">(</span>StrongPostdomination.weak_control_dependence src trg <span class="free">lve</span> NewExit<span class="main">)</span> <span class="skolem">S</span><span class="main">)</span> <span class="main">=</span> <span class="main">{</span><span class="bound">m</span><span class="main">}</span><span class="main">)</span> <span class="main">∨</span>
      CFG.obs src trg <span class="free">lve</span> <span class="skolem">n</span>
      <span class="main">(</span>PDG.PDG_BS src trg <span class="free">lve</span> <span class="free">lDef</span> <span class="free">lUse</span>
        <span class="main">(</span>StrongPostdomination.weak_control_dependence src trg <span class="free">lve</span> NewExit<span class="main">)</span> <span class="skolem">S</span><span class="main">)</span> <span class="main">=</span> <span class="main">{}</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">fastforce</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span>WeakControlDependencePDG.PDG_BS_w_def<span class="main"><span class="main">[</span></span><span class="operator">OF</span> wcd<span class="main"><span class="main">]</span></span><span class="main">)</span>
    <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"finite <span class="main">(</span>CFG.obs src trg <span class="free">lve</span> <span class="skolem">n</span>
        <span class="main">(</span>PDG.PDG_BS src trg <span class="free">lve</span> <span class="free">lDef</span> <span class="free">lUse</span>
          <span class="main">(</span>StrongPostdomination.weak_control_dependence src trg <span class="free">lve</span> NewExit<span class="main">)</span> <span class="skolem">S</span><span class="main">)</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">fastforce</span>
  <span class="keyword1"><span class="command">next</span></span>
    <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">n</span> <span class="skolem">S</span>
    <span class="keyword1"><span class="command">interpret</span></span> PDGx<span class="main">:</span>PDG <span class="quoted">src</span> <span class="quoted">trg</span> <span class="quoted">knd</span> <span class="quoted"><span class="free">lve</span></span> <span class="quoted">NewEntry</span> <span class="quoted"><span class="free">lDef</span></span> <span class="quoted"><span class="free">lUse</span></span> <span class="quoted"><span class="free">state_val</span></span> <span class="quoted">NewExit</span>
      <span class="quoted"><span class="quoted">"StrongPostdomination.weak_control_dependence src trg <span class="free">lve</span> NewExit"</span></span>
      <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">rule</span> PDG'<span class="main">)</span>
    <span class="keyword1"><span class="command">interpret</span></span> spdx<span class="main">:</span>StrongPostdomination <span class="quoted">src</span> <span class="quoted">trg</span> <span class="quoted">knd</span> <span class="quoted"><span class="free">lve</span></span> <span class="quoted">NewEntry</span> <span class="quoted">NewExit</span>
      <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">fastforce</span> <span class="quasi_keyword">intro</span><span class="main"><span class="main">:</span></span>spd' <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span>lve<span class="main">)</span>
    <span class="keyword1"><span class="command">have</span></span> wcd<span class="main">:</span><span class="quoted"><span class="quoted">"WeakControlDependencePDG src trg knd <span class="free">lve</span> NewEntry
      <span class="free">lDef</span> <span class="free">lUse</span> <span class="free">state_val</span> NewExit"</span></span> <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">unfold_locales</span><span class="main">)</span>
    <span class="keyword1"><span class="command">from</span></span> WeakControlDependencePDG.obs_singleton<span class="main">[</span><span class="operator">OF</span> wcd<span class="main">]</span>
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">∃</span><span class="bound">m</span><span class="main">.</span> CFG.obs src trg <span class="free">lve</span> <span class="skolem">n</span>
      <span class="main">(</span>PDG.PDG_BS src trg <span class="free">lve</span> <span class="free">lDef</span> <span class="free">lUse</span>
       <span class="main">(</span>StrongPostdomination.weak_control_dependence src trg <span class="free">lve</span> NewExit<span class="main">)</span> <span class="skolem">S</span><span class="main">)</span> <span class="main">=</span> <span class="main">{</span><span class="bound">m</span><span class="main">}</span><span class="main">)</span> <span class="main">∨</span>
      CFG.obs src trg <span class="free">lve</span> <span class="skolem">n</span>
      <span class="main">(</span>PDG.PDG_BS src trg <span class="free">lve</span> <span class="free">lDef</span> <span class="free">lUse</span>
        <span class="main">(</span>StrongPostdomination.weak_control_dependence src trg <span class="free">lve</span> NewExit<span class="main">)</span> <span class="skolem">S</span><span class="main">)</span> <span class="main">=</span> <span class="main">{}</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">fastforce</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span>WeakControlDependencePDG.PDG_BS_w_def<span class="main"><span class="main">[</span></span><span class="operator">OF</span> wcd<span class="main"><span class="main">]</span></span><span class="main">)</span>
    <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"card <span class="main">(</span>CFG.obs src trg <span class="free">lve</span> <span class="skolem">n</span>
      <span class="main">(</span>PDG.PDG_BS src trg <span class="free">lve</span> <span class="free">lDef</span> <span class="free">lUse</span>
        <span class="main">(</span>StrongPostdomination.weak_control_dependence src trg <span class="free">lve</span> NewExit<span class="main">)</span> <span class="skolem">S</span><span class="main">)</span><span class="main">)</span> <span class="main">≤</span> <span class="main">1</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">fastforce</span>
  <span class="keyword1"><span class="command">next</span></span>
    <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">a</span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="free">lve</span> <span class="skolem">a</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"src <span class="skolem">a</span> <span class="main">=</span> NewEntry"</span></span>
    <span class="keyword1"><span class="command">with</span></span> lve <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"trg <span class="skolem">a</span> <span class="main">=</span> NewExit <span class="main">∨</span> trg <span class="skolem">a</span> <span class="main">=</span> Node <span class="free">Entry</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">fastforce</span> <span class="quasi_keyword">elim</span><span class="main"><span class="main">:</span></span>lift_valid_edge.cases<span class="main">)</span>
  <span class="keyword1"><span class="command">next</span></span>
    <span class="keyword1"><span class="command">from</span></span> lve_Entry_edge lve
    <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound">a</span><span class="main">.</span> <span class="free">lve</span> <span class="bound">a</span> <span class="main">∧</span> src <span class="bound">a</span> <span class="main">=</span> NewEntry <span class="main">∧</span> trg <span class="bound">a</span> <span class="main">=</span> Node <span class="free">Entry</span> <span class="main">∧</span> knd <span class="bound">a</span> <span class="main">=</span> <span class="main">(</span><span class="main">λ</span><span class="bound">s</span><span class="main">.</span> True<span class="main">)<span class="hidden">⇩</span><sub>√</sub></span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">fastforce</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span>knd_def<span class="main">)</span>
  <span class="keyword1"><span class="command">next</span></span>
    <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">a</span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="free">lve</span> <span class="skolem">a</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"trg <span class="skolem">a</span> <span class="main">=</span> Node <span class="free">Entry</span>"</span></span>
    <span class="keyword1"><span class="command">with</span></span> lve <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"src <span class="skolem">a</span> <span class="main">=</span> NewEntry"</span></span> <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">fastforce</span> <span class="quasi_keyword">elim</span><span class="main"><span class="main">:</span></span>lift_valid_edge.cases<span class="main">)</span>
  <span class="keyword1"><span class="command">next</span></span>
    <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">a</span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="free">lve</span> <span class="skolem">a</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"trg <span class="skolem">a</span> <span class="main">=</span> NewExit"</span></span>
    <span class="keyword1"><span class="command">with</span></span> lve <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"src <span class="skolem">a</span> <span class="main">=</span> NewEntry <span class="main">∨</span> src <span class="skolem">a</span> <span class="main">=</span> Node <span class="free">Exit</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">fastforce</span> <span class="quasi_keyword">elim</span><span class="main"><span class="main">:</span></span>lift_valid_edge.cases<span class="main">)</span>
  <span class="keyword1"><span class="command">next</span></span>
    <span class="keyword1"><span class="command">from</span></span> lve_Exit_edge lve
    <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound">a</span><span class="main">.</span> <span class="free">lve</span> <span class="bound">a</span> <span class="main">∧</span> src <span class="bound">a</span> <span class="main">=</span> Node <span class="free">Exit</span> <span class="main">∧</span> trg <span class="bound">a</span> <span class="main">=</span> NewExit <span class="main">∧</span> knd <span class="bound">a</span> <span class="main">=</span> <span class="main">(</span><span class="main">λ</span><span class="bound">s</span><span class="main">.</span> True<span class="main">)<span class="hidden">⇩</span><sub>√</sub></span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">fastforce</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span>knd_def<span class="main">)</span>
  <span class="keyword1"><span class="command">next</span></span>
    <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">a</span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="free">lve</span> <span class="skolem">a</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"src <span class="skolem">a</span> <span class="main">=</span> Node <span class="free">Exit</span>"</span></span>
    <span class="keyword1"><span class="command">with</span></span> lve <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"trg <span class="skolem">a</span> <span class="main">=</span> NewExit"</span></span> <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">fastforce</span> <span class="quasi_keyword">elim</span><span class="main"><span class="main">:</span></span>lift_valid_edge.cases<span class="main">)</span>
  <span class="keyword1"><span class="command">next</span></span>
    <span class="keyword1"><span class="command">from</span></span> lDef <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="free">lDef</span> <span class="main">(</span>Node <span class="free">Entry</span><span class="main">)</span> <span class="main">=</span> <span class="free">H</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">fastforce</span> <span class="quasi_keyword">elim</span><span class="main"><span class="main">:</span></span>lift_Def_set.cases <span class="quasi_keyword">intro</span><span class="main"><span class="main">:</span></span>lift_Def_High<span class="main">)</span>
  <span class="keyword1"><span class="command">next</span></span>
    <span class="keyword1"><span class="command">from</span></span> Entry_noteq_Exit lUse <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="free">lUse</span> <span class="main">(</span>Node <span class="free">Entry</span><span class="main">)</span> <span class="main">=</span> <span class="free">H</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">fastforce</span> <span class="quasi_keyword">elim</span><span class="main"><span class="main">:</span></span>lift_Use_set.cases <span class="quasi_keyword">intro</span><span class="main"><span class="main">:</span></span>lift_Use_High<span class="main">)</span>
  <span class="keyword1"><span class="command">next</span></span>
    <span class="keyword1"><span class="command">from</span></span> Entry_noteq_Exit lUse <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="free">lUse</span> <span class="main">(</span>Node <span class="free">Exit</span><span class="main">)</span> <span class="main">=</span> <span class="free">L</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">fastforce</span> <span class="quasi_keyword">elim</span><span class="main"><span class="main">:</span></span>lift_Use_set.cases <span class="quasi_keyword">intro</span><span class="main"><span class="main">:</span></span>lift_Use_Low<span class="main">)</span>
  <span class="keyword1"><span class="command">next</span></span>
    <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="free">H</span> <span class="main">∩</span> <span class="free">L</span> <span class="main">=</span> <span class="main">{}</span>›</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="free">H</span> <span class="main">∩</span> <span class="free">L</span> <span class="main">=</span> <span class="main">{}</span>"</span></span> <span class="keyword1"><span class="command">.</span></span>
  <span class="keyword1"><span class="command">next</span></span>
    <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="free">H</span> <span class="main">∪</span> <span class="free">L</span> <span class="main">=</span> UNIV›</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="free">H</span> <span class="main">∪</span> <span class="free">L</span> <span class="main">=</span> UNIV"</span></span> <span class="keyword1"><span class="command">.</span></span>
  <span class="keyword1"><span class="command">qed</span></span>
<span class="keyword1"><span class="command">qed</span></span>


<span class="keyword2"><span class="keyword">end</span></span>




</pre>
</div><div id="NonInterferenceWhile">
<div class="head">
<h1>Theory NonInterferenceWhile</h1>
</div>
<pre class="source"><span class="keyword1"><span class="command">section</span></span> <span class="quoted"><span class="plain_text">‹Information Flow for While›</span></span>

<span class="keyword1"><span class="command">theory</span></span> NonInterferenceWhile <span class="keyword2"><span class="keyword">imports</span></span>
  <a href="../Slicing/SemanticsWellFormed.html">Slicing.SemanticsWellFormed</a>
  <a href="../Slicing/StaticControlDependences.html">Slicing.StaticControlDependences</a>
  <a href="LiftingIntra.html">LiftingIntra</a>
<span class="keyword2"><span class="keyword">begin</span></span>

<span class="keyword1"><span class="command">locale</span></span> SecurityTypes <span class="main">=</span>
  <span class="keyword2"><span class="keyword">fixes</span></span> <span class="free">H</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"vname set"</span></span>
  <span class="keyword2"><span class="keyword">fixes</span></span> <span class="free">L</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"vname set"</span></span>
  <span class="keyword2"><span class="keyword">assumes</span></span> HighLowDistinct<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">H</span> <span class="main">∩</span> <span class="free">L</span> <span class="main">=</span> <span class="main">{}</span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> HighLowUNIV<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">H</span> <span class="main">∪</span> <span class="free">L</span> <span class="main">=</span> UNIV"</span></span>
<span class="keyword2"><span class="keyword">begin</span></span>


<span class="keyword1"><span class="command">subsection</span></span> <span class="quoted"><span class="plain_text">‹Lifting <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">term</span></span> <span class="quoted"><span class="quoted">labels_nodes</span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span> and Defining <span class="antiquoted"><span class="raw_text"><span class="antiquoted"><span class="raw_text"><span class="operator"><span class="operator">‹</span></span>final›</span></span></span></span>›</span></span>

<span class="keyword1"><span class="command">fun</span></span> <span class="entity">labels_LDCFG_nodes</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"cmd <span class="main">⇒</span> w_node LDCFG_node <span class="main">⇒</span> cmd <span class="main">⇒</span> bool"</span></span>
  <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="free">labels_LDCFG_nodes</span> <span class="free"><span class="bound"><span class="entity">prog</span></span></span> <span class="main">(</span>Node <span class="free"><span class="bound"><span class="entity">n</span></span></span><span class="main">)</span> <span class="free"><span class="bound"><span class="entity">c</span></span></span> <span class="main">=</span> labels_nodes <span class="free"><span class="bound"><span class="entity">prog</span></span></span> <span class="free"><span class="bound"><span class="entity">n</span></span></span> <span class="free"><span class="bound"><span class="entity">c</span></span></span>"</span></span>
  <span class="main">|</span> <span class="quoted"><span class="quoted">"<span class="free">labels_LDCFG_nodes</span> <span class="free"><span class="bound"><span class="entity">prog</span></span></span> <span class="free"><span class="bound"><span class="entity">n</span></span></span> <span class="free"><span class="bound"><span class="entity">c</span></span></span> <span class="main">=</span> False"</span></span>



<span class="keyword1"><span class="command">lemmas</span></span> WCFG_path_induct<span class="main">[</span><span class="operator">consumes</span> 1<span class="main">,</span> <span class="operator">case_names</span> empty_path Cons_path<span class="main">]</span>
  <span class="main">=</span> CFG.path.induct<span class="main">[</span><span class="operator">OF</span> While_CFG_aux<span class="main">]</span>


<span class="keyword1"><span class="command">lemma</span></span> lift_valid_node<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"CFG.valid_node sourcenode targetnode <span class="main">(</span>valid_edge <span class="free">prog</span><span class="main">)</span> <span class="free">n</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"CFG.valid_node src trg
  <span class="main">(</span>lift_valid_edge <span class="main">(</span>valid_edge <span class="free">prog</span><span class="main">)</span> sourcenode targetnode kind <span class="keyword1">(_Entry_)</span> <span class="keyword1">(_Exit_)</span><span class="main">)</span>
  <span class="main">(</span>Node <span class="free">n</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹CFG.valid_node sourcenode targetnode <span class="main">(</span>valid_edge <span class="free">prog</span><span class="main">)</span> <span class="free">n</span>›</span></span>
  <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">a</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"valid_edge <span class="free">prog</span> <span class="skolem">a</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">n</span> <span class="main">=</span> sourcenode <span class="skolem">a</span> <span class="main">∨</span> <span class="free">n</span> <span class="main">=</span> targetnode <span class="skolem">a</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">fastforce</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span>While_CFG.valid_node_def<span class="main">)</span>
  <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="free">n</span> <span class="main">=</span> sourcenode <span class="skolem">a</span> <span class="main">∨</span> <span class="free">n</span> <span class="main">=</span> targetnode <span class="skolem">a</span>›</span></span>
  <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
  <span class="keyword1"><span class="command">proof</span></span>
    <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="free">n</span> <span class="main">=</span> sourcenode <span class="skolem">a</span>"</span></span>
    <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
    <span class="keyword1"><span class="command">proof</span></span><span class="main">(</span><span class="operator">cases</span> <span class="quoted"><span class="quoted">"sourcenode <span class="skolem">a</span> <span class="main">=</span> Entry"</span></span><span class="main">)</span>
      <span class="keyword3"><span class="command">case</span></span> True
      <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"lift_valid_edge <span class="main">(</span>valid_edge <span class="free">prog</span><span class="main">)</span> sourcenode targetnode kind Entry Exit 
        <span class="main">(</span>NewEntry<span class="main">,</span><span class="main">(</span><span class="main">λ</span><span class="bound">s</span><span class="main">.</span> True<span class="main">)<span class="hidden">⇩</span><sub>√</sub></span><span class="main">,</span>Node Entry<span class="main">)</span>"</span></span>
        <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">fastforce</span> <span class="quasi_keyword">intro</span><span class="main"><span class="main">:</span></span>lve_Entry_edge<span class="main">)</span>
      <span class="keyword1"><span class="command">with</span></span> While_CFGExit_wf_aux<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="free">prog</span></span><span class="main">]</span> <span class="quoted"><span class="quoted">‹<span class="free">n</span> <span class="main">=</span> sourcenode <span class="skolem">a</span>›</span></span> True <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
        <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">fastforce</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span>CFG.valid_node_def<span class="main"><span class="main">[</span></span><span class="operator">OF</span> lift_CFG<span class="main"><span class="main">]</span></span><span class="main">)</span>
    <span class="keyword1"><span class="command">next</span></span>
      <span class="keyword3"><span class="command">case</span></span> False
      <span class="keyword1"><span class="command">with</span></span> <span class="quoted"><span class="quoted">‹valid_edge <span class="free">prog</span> <span class="skolem">a</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="free">n</span> <span class="main">=</span> sourcenode <span class="skolem">a</span> <span class="main">∨</span> <span class="free">n</span> <span class="main">=</span> targetnode <span class="skolem">a</span>›</span></span>
      <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"lift_valid_edge <span class="main">(</span>valid_edge <span class="free">prog</span><span class="main">)</span> sourcenode targetnode kind Entry Exit 
        <span class="main">(</span>Node <span class="main">(</span>sourcenode <span class="skolem">a</span><span class="main">)</span><span class="main">,</span>kind <span class="skolem">a</span><span class="main">,</span>Node <span class="main">(</span>targetnode <span class="skolem">a</span><span class="main">)</span><span class="main">)</span>"</span></span>
        <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">fastforce</span> <span class="quasi_keyword">intro</span><span class="main"><span class="main">:</span></span>lve_edge<span class="main">)</span>
      <span class="keyword1"><span class="command">with</span></span> While_CFGExit_wf_aux<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="free">prog</span></span><span class="main">]</span> <span class="quoted"><span class="quoted">‹<span class="free">n</span> <span class="main">=</span> sourcenode <span class="skolem">a</span>›</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
        <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">fastforce</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span>CFG.valid_node_def<span class="main"><span class="main">[</span></span><span class="operator">OF</span> lift_CFG<span class="main"><span class="main">]</span></span><span class="main">)</span>
    <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">next</span></span>
    <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="free">n</span> <span class="main">=</span> targetnode <span class="skolem">a</span>"</span></span>
    <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
    <span class="keyword1"><span class="command">proof</span></span><span class="main">(</span><span class="operator">cases</span> <span class="quoted"><span class="quoted">"targetnode <span class="skolem">a</span> <span class="main">=</span> Exit"</span></span><span class="main">)</span>
      <span class="keyword3"><span class="command">case</span></span> True
      <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"lift_valid_edge <span class="main">(</span>valid_edge <span class="free">prog</span><span class="main">)</span> sourcenode targetnode kind Entry Exit 
        <span class="main">(</span>Node Exit<span class="main">,</span><span class="main">(</span><span class="main">λ</span><span class="bound">s</span><span class="main">.</span> True<span class="main">)<span class="hidden">⇩</span><sub>√</sub></span><span class="main">,</span>NewExit<span class="main">)</span>"</span></span>
        <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">fastforce</span> <span class="quasi_keyword">intro</span><span class="main"><span class="main">:</span></span>lve_Exit_edge<span class="main">)</span>
      <span class="keyword1"><span class="command">with</span></span> While_CFGExit_wf_aux<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="free">prog</span></span><span class="main">]</span> <span class="quoted"><span class="quoted">‹<span class="free">n</span> <span class="main">=</span> targetnode <span class="skolem">a</span>›</span></span> True <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
        <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">fastforce</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span>CFG.valid_node_def<span class="main"><span class="main">[</span></span><span class="operator">OF</span> lift_CFG<span class="main"><span class="main">]</span></span><span class="main">)</span>
    <span class="keyword1"><span class="command">next</span></span>
      <span class="keyword3"><span class="command">case</span></span> False
      <span class="keyword1"><span class="command">with</span></span> <span class="quoted"><span class="quoted">‹valid_edge <span class="free">prog</span> <span class="skolem">a</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="free">n</span> <span class="main">=</span> sourcenode <span class="skolem">a</span> <span class="main">∨</span> <span class="free">n</span> <span class="main">=</span> targetnode <span class="skolem">a</span>›</span></span>
      <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"lift_valid_edge <span class="main">(</span>valid_edge <span class="free">prog</span><span class="main">)</span> sourcenode targetnode kind Entry Exit 
        <span class="main">(</span>Node <span class="main">(</span>sourcenode <span class="skolem">a</span><span class="main">)</span><span class="main">,</span>kind <span class="skolem">a</span><span class="main">,</span>Node <span class="main">(</span>targetnode <span class="skolem">a</span><span class="main">)</span><span class="main">)</span>"</span></span>
        <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">fastforce</span> <span class="quasi_keyword">intro</span><span class="main"><span class="main">:</span></span>lve_edge<span class="main">)</span>
      <span class="keyword1"><span class="command">with</span></span> While_CFGExit_wf_aux<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="free">prog</span></span><span class="main">]</span> <span class="quoted"><span class="quoted">‹<span class="free">n</span> <span class="main">=</span> targetnode <span class="skolem">a</span>›</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
        <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">fastforce</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span>CFG.valid_node_def<span class="main"><span class="main">[</span></span><span class="operator">OF</span> lift_CFG<span class="main"><span class="main">]</span></span><span class="main">)</span>
    <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">qed</span></span>
<span class="keyword1"><span class="command">qed</span></span>



<span class="keyword1"><span class="command">lemma</span></span> lifted_CFG_fund_prop<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"labels_LDCFG_nodes <span class="free">prog</span> <span class="free">n</span> <span class="free">c</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">⟨</span><span class="free">c</span><span class="main">,</span><span class="free">s</span><span class="main">⟩</span> <span class="main">→*</span> <span class="main">⟨</span><span class="free">c'</span><span class="main">,</span><span class="free">s'</span><span class="main">⟩</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound">n'</span> <span class="bound">as</span><span class="main">.</span> CFG.path src trg
  <span class="main">(</span>lift_valid_edge <span class="main">(</span>valid_edge <span class="free">prog</span><span class="main">)</span> sourcenode targetnode kind <span class="keyword1">(_Entry_)</span> <span class="keyword1">(_Exit_)</span><span class="main">)</span>
  <span class="free">n</span> <span class="bound">as</span> <span class="bound">n'</span> <span class="main">∧</span> transfers <span class="main">(</span>CFG.kinds knd <span class="bound">as</span><span class="main">)</span> <span class="free">s</span> <span class="main">=</span> <span class="free">s'</span> <span class="main">∧</span>
  preds <span class="main">(</span>CFG.kinds knd <span class="bound">as</span><span class="main">)</span> <span class="free">s</span> <span class="main">∧</span> labels_LDCFG_nodes <span class="free">prog</span> <span class="bound">n'</span> <span class="free">c'</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹labels_LDCFG_nodes <span class="free">prog</span> <span class="free">n</span> <span class="free">c</span>›</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">nx</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="free">n</span> <span class="main">=</span> Node <span class="skolem">nx</span>"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"labels_nodes <span class="free">prog</span> <span class="skolem">nx</span> <span class="free">c</span>"</span></span> <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">cases</span> <span class="quoted"><span class="free">n</span></span><span class="main">)</span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹labels_nodes <span class="free">prog</span> <span class="skolem">nx</span> <span class="free">c</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="main">⟨</span><span class="free">c</span><span class="main">,</span><span class="free">s</span><span class="main">⟩</span> <span class="main">→*</span> <span class="main">⟨</span><span class="free">c'</span><span class="main">,</span><span class="free">s'</span><span class="main">⟩</span>›</span></span>
  <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">n'</span></span> <span class="skolem"><span class="skolem">as</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="free">prog</span> <span class="main">⊢</span> <span class="skolem">nx</span> <span class="main">-</span><span class="skolem">as</span><span class="main">→*</span> <span class="skolem">n'</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"transfers <span class="main">(</span>CFG.kinds kind <span class="skolem">as</span><span class="main">)</span> <span class="free">s</span> <span class="main">=</span> <span class="free">s'</span>"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"preds <span class="main">(</span>CFG.kinds kind <span class="skolem">as</span><span class="main">)</span> <span class="free">s</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"labels_nodes <span class="free">prog</span> <span class="skolem">n'</span> <span class="free">c'</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">dest</span><span class="main"><span class="main">:</span></span>While_semantics_CFG_wf.fundamental_property<span class="main">)</span>
  <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹labels_nodes <span class="free">prog</span> <span class="skolem">n'</span> <span class="free">c'</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"labels_LDCFG_nodes <span class="free">prog</span> <span class="main">(</span>Node <span class="skolem">n'</span><span class="main">)</span> <span class="free">c'</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="free">prog</span> <span class="main">⊢</span> <span class="skolem">nx</span> <span class="main">-</span><span class="skolem">as</span><span class="main">→*</span> <span class="skolem">n'</span>›</span></span> <span class="quoted"><span class="quoted">‹transfers <span class="main">(</span>CFG.kinds kind <span class="skolem">as</span><span class="main">)</span> <span class="free">s</span> <span class="main">=</span> <span class="free">s'</span>›</span></span> 
    <span class="quoted"><span class="quoted">‹preds <span class="main">(</span>CFG.kinds kind <span class="skolem">as</span><span class="main">)</span> <span class="free">s</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="free">n</span> <span class="main">=</span> Node <span class="skolem">nx</span>›</span></span>
    <span class="quoted"><span class="quoted">‹labels_nodes <span class="free">prog</span> <span class="skolem">nx</span> <span class="free">c</span>›</span></span> <span class="quoted"><span class="quoted">‹labels_nodes <span class="free">prog</span> <span class="skolem">n'</span> <span class="free">c'</span>›</span></span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound">es</span><span class="main">.</span> CFG.path src trg
    <span class="main">(</span>lift_valid_edge <span class="main">(</span>valid_edge <span class="free">prog</span><span class="main">)</span> sourcenode targetnode kind <span class="keyword1">(_Entry_)</span> <span class="keyword1">(_Exit_)</span><span class="main">)</span>
    <span class="main">(</span>Node <span class="skolem">nx</span><span class="main">)</span> <span class="bound">es</span> <span class="main">(</span>Node <span class="skolem">n'</span><span class="main">)</span> <span class="main">∧</span> transfers <span class="main">(</span>CFG.kinds knd <span class="bound">es</span><span class="main">)</span> <span class="free">s</span> <span class="main">=</span> <span class="free">s'</span> <span class="main">∧</span>
    preds <span class="main">(</span>CFG.kinds knd <span class="bound">es</span><span class="main">)</span> <span class="free">s</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span><span class="main">(</span><span class="operator">induct</span> <span class="quasi_keyword">arbitrary</span><span class="main"><span class="main">:</span></span><span class="quoted"><span class="free">n</span></span> <span class="quoted"><span class="free">s</span></span> <span class="quoted"><span class="free">c</span></span> <span class="quasi_keyword">rule</span><span class="main"><span class="main">:</span></span>WCFG_path_induct<span class="main">)</span>
    <span class="keyword3"><span class="command">case</span></span> <span class="main">(</span>empty_path <span class="skolem">n</span> <span class="skolem">nx</span><span class="main">)</span>
    <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹CFG.valid_node sourcenode targetnode <span class="main">(</span>valid_edge <span class="free">prog</span><span class="main">)</span> <span class="skolem">n</span>›</span></span>
    <span class="keyword1"><span class="command">have</span></span> valid_node<span class="main">:</span><span class="quoted"><span class="quoted">"CFG.valid_node src trg
     <span class="main">(</span>lift_valid_edge <span class="main">(</span>valid_edge <span class="free">prog</span><span class="main">)</span> sourcenode targetnode kind <span class="keyword1">(_Entry_)</span> <span class="keyword1">(_Exit_)</span><span class="main">)</span>
      <span class="main">(</span>Node <span class="skolem">n</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">rule</span> lift_valid_node<span class="main">)</span>
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"CFG.kinds knd 
      <span class="main">(</span><span class="main">[]</span><span class="main">::</span><span class="main">(</span>w_node LDCFG_node <span class="main">×</span> state edge_kind <span class="main">×</span> w_node LDCFG_node<span class="main">)</span> list<span class="main">)</span> <span class="main">=</span> <span class="main">[]</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span>CFG.kinds_def<span class="main"><span class="main">[</span></span><span class="operator">OF</span> lift_CFG<span class="main"><span class="main"><span class="main">[</span></span></span><span class="operator">OF</span> While_CFGExit_wf_aux<span class="main"><span class="main"><span class="main">]</span></span></span><span class="main"><span class="main">]</span></span><span class="main">)</span>
    <span class="keyword1"><span class="command">with</span></span> <span class="quoted"><span class="quoted">‹transfers <span class="main">(</span>CFG.kinds kind <span class="main">[]</span><span class="main">)</span> <span class="skolem">s</span> <span class="main">=</span> <span class="free">s'</span>›</span></span> <span class="quoted"><span class="quoted">‹preds <span class="main">(</span>CFG.kinds kind <span class="main">[]</span><span class="main">)</span> <span class="skolem">s</span>›</span></span>
      valid_node
    <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?case</span></span></span>
      <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">fastforce</span> <span class="quasi_keyword">intro</span><span class="main"><span class="main">:</span></span>CFG.empty_path<span class="main"><span class="main">[</span></span><span class="operator">OF</span> lift_CFG<span class="main"><span class="main"><span class="main">[</span></span></span><span class="operator">OF</span> While_CFGExit_wf_aux<span class="main"><span class="main"><span class="main">]</span></span></span><span class="main"><span class="main">]</span></span> 
                   <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span>While_CFG.kinds_def<span class="main">)</span>
  <span class="keyword1"><span class="command">next</span></span>
    <span class="keyword3"><span class="command">case</span></span> <span class="main">(</span>Cons_path <span class="skolem">n''</span> <span class="skolem">as</span> <span class="skolem">n'</span> <span class="skolem">a</span> <span class="skolem">nx</span><span class="main">)</span>
    <span class="keyword1"><span class="command">note</span></span> IH <span class="main">=</span> <span class="quoted"><span class="quoted">‹<span class="main">⋀</span><span class="bound">n</span> <span class="bound">s</span> <span class="bound">c</span><span class="main">.</span> <span class="main">⟦</span>transfers <span class="main">(</span>CFG.kinds kind <span class="skolem">as</span><span class="main">)</span> <span class="bound">s</span> <span class="main">=</span> <span class="free">s'</span><span class="main">;</span> 
      preds <span class="main">(</span>CFG.kinds kind <span class="skolem">as</span><span class="main">)</span> <span class="bound">s</span><span class="main">;</span> <span class="bound">n</span> <span class="main">=</span> LDCFG_node.Node <span class="skolem">n''</span><span class="main">;</span> 
      labels_nodes <span class="free">prog</span> <span class="skolem">n''</span> <span class="bound">c</span><span class="main">;</span> labels_nodes <span class="free">prog</span> <span class="skolem">n'</span> <span class="free">c'</span><span class="main">⟧</span>
      <span class="main">⟹</span> <span class="main">∃</span><span class="bound">es</span><span class="main">.</span> CFG.path src trg
     <span class="main">(</span>lift_valid_edge <span class="main">(</span>valid_edge <span class="free">prog</span><span class="main">)</span> sourcenode targetnode kind <span class="keyword1">(_Entry_)</span> <span class="keyword1">(_Exit_)</span><span class="main">)</span>
      <span class="main">(</span>LDCFG_node.Node <span class="skolem">n''</span><span class="main">)</span> <span class="bound">es</span> <span class="main">(</span>LDCFG_node.Node <span class="skolem">n'</span><span class="main">)</span> <span class="main">∧</span>
      transfers <span class="main">(</span>CFG.kinds knd <span class="bound">es</span><span class="main">)</span> <span class="bound">s</span> <span class="main">=</span> <span class="free">s'</span> <span class="main">∧</span> preds <span class="main">(</span>CFG.kinds knd <span class="bound">es</span><span class="main">)</span> <span class="bound">s</span>›</span></span>
    <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹transfers <span class="main">(</span>CFG.kinds kind <span class="main">(</span><span class="skolem">a</span> <span class="main">#</span> <span class="skolem">as</span><span class="main">)</span><span class="main">)</span> <span class="skolem">s</span> <span class="main">=</span> <span class="free">s'</span>›</span></span>
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"transfers <span class="main">(</span>CFG.kinds kind <span class="skolem">as</span><span class="main">)</span> <span class="main">(</span>transfer <span class="main">(</span>kind <span class="skolem">a</span><span class="main">)</span> <span class="skolem">s</span><span class="main">)</span> <span class="main">=</span> <span class="free">s'</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span>While_CFG.kinds_def<span class="main">)</span>
    <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹preds <span class="main">(</span>CFG.kinds kind <span class="main">(</span><span class="skolem">a</span> <span class="main">#</span> <span class="skolem">as</span><span class="main">)</span><span class="main">)</span> <span class="skolem">s</span>›</span></span>
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"preds <span class="main">(</span>CFG.kinds kind <span class="skolem">as</span><span class="main">)</span> <span class="main">(</span>transfer <span class="main">(</span>kind <span class="skolem">a</span><span class="main">)</span> <span class="skolem">s</span><span class="main">)</span>"</span></span>
      <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"pred <span class="main">(</span>kind <span class="skolem">a</span><span class="main">)</span> <span class="skolem">s</span>"</span></span> <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">simp_all</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span>While_CFG.kinds_def<span class="main">)</span>
    <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?case</span></span></span>
    <span class="keyword1"><span class="command">proof</span></span><span class="main">(</span><span class="operator">cases</span> <span class="quoted"><span class="quoted">"sourcenode <span class="skolem">a</span> <span class="main">=</span> <span class="keyword1">(_Entry_)</span>"</span></span><span class="main">)</span>
      <span class="keyword3"><span class="command">case</span></span> True
      <span class="keyword1"><span class="command">with</span></span> <span class="quoted"><span class="quoted">‹sourcenode <span class="skolem">a</span> <span class="main">=</span> <span class="skolem">nx</span>›</span></span> <span class="quoted"><span class="quoted">‹labels_nodes <span class="free">prog</span> <span class="skolem">nx</span> <span class="skolem">c</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted">False</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
      <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">next</span></span>
      <span class="keyword3"><span class="command">case</span></span> False
      <span class="keyword1"><span class="command">with</span></span> <span class="quoted"><span class="quoted">‹valid_edge <span class="free">prog</span> <span class="skolem">a</span>›</span></span>
      <span class="keyword1"><span class="command">have</span></span> edge<span class="main">:</span><span class="quoted"><span class="quoted">"lift_valid_edge <span class="main">(</span>valid_edge <span class="free">prog</span><span class="main">)</span> sourcenode targetnode kind 
        Entry Exit <span class="main">(</span>Node <span class="main">(</span>sourcenode <span class="skolem">a</span><span class="main">)</span><span class="main">,</span>kind <span class="skolem">a</span><span class="main">,</span>Node <span class="main">(</span>targetnode <span class="skolem">a</span><span class="main">)</span><span class="main">)</span>"</span></span>
        <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">fastforce</span> <span class="quasi_keyword">intro</span><span class="main"><span class="main">:</span></span>lve_edge<span class="main">)</span>
      <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="free">prog</span> <span class="main">⊢</span> <span class="skolem">n''</span> <span class="main">-</span><span class="skolem">as</span><span class="main">→*</span> <span class="skolem">n'</span>›</span></span>
      <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"CFG.valid_node sourcenode targetnode <span class="main">(</span>valid_edge <span class="free">prog</span><span class="main">)</span> <span class="skolem">n''</span>"</span></span>
        <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">rule</span> While_CFG.path_valid_node<span class="main">)</span>
      <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">c''</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"labels_nodes <span class="free">prog</span> <span class="skolem">n''</span> <span class="skolem">c''</span>"</span></span>
      <span class="keyword1"><span class="command">proof</span></span><span class="main">(</span><span class="operator">cases</span> <span class="quasi_keyword">rule</span><span class="main"><span class="main">:</span></span>While_CFGExit.valid_node_cases<span class="main">)</span>
        <span class="keyword3"><span class="command">case</span></span> Entry
        <span class="keyword1"><span class="command">with</span></span> <span class="quoted"><span class="quoted">‹targetnode <span class="skolem">a</span> <span class="main">=</span> <span class="skolem">n''</span>›</span></span> <span class="quoted"><span class="quoted">‹valid_edge <span class="free">prog</span> <span class="skolem">a</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted">False</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">fastforce</span>
        <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
      <span class="keyword1"><span class="command">next</span></span>
        <span class="keyword3"><span class="command">case</span></span> Exit
        <span class="keyword1"><span class="command">with</span></span> <span class="quoted"><span class="quoted">‹<span class="free">prog</span> <span class="main">⊢</span> <span class="skolem">n''</span> <span class="main">-</span><span class="skolem">as</span><span class="main">→*</span> <span class="skolem">n'</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">n'</span> <span class="main">=</span> <span class="keyword1">(_Exit_)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">fastforce</span>
        <span class="keyword1"><span class="command">with</span></span> <span class="quoted"><span class="quoted">‹labels_nodes <span class="free">prog</span> <span class="skolem">n'</span> <span class="free">c'</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted">False</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">fastforce</span>
        <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
      <span class="keyword1"><span class="command">next</span></span>
        <span class="keyword3"><span class="command">case</span></span> inner
        <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">l''</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">n''</span> <span class="main">=</span> <span class="main">(_</span> <span class="skolem">l''</span> <span class="main">_)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">cases</span> <span class="quoted"><span class="skolem">n''</span></span><span class="main">)</span> <span class="operator">auto</span>
        <span class="keyword1"><span class="command">with</span></span> <span class="quoted"><span class="quoted">‹valid_edge <span class="free">prog</span> <span class="skolem">a</span>›</span></span> <span class="quoted"><span class="quoted">‹targetnode <span class="skolem">a</span> <span class="main">=</span> <span class="skolem">n''</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">l''</span> <span class="main">&lt;</span> <span class="main">#:</span><span class="free">prog</span>"</span></span>
          <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">fastforce</span> <span class="quasi_keyword">intro</span><span class="main"><span class="main">:</span></span>WCFG_targetlabel_less_num_nodes <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span>valid_edge_def<span class="main">)</span>
        <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">c''</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"labels <span class="free">prog</span> <span class="skolem">l''</span> <span class="skolem">c''</span>"</span></span>
          <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">fastforce</span> <span class="quasi_keyword">dest</span><span class="main"><span class="main">:</span></span>less_num_inner_nodes_label<span class="main">)</span>
        <span class="keyword1"><span class="command">with</span></span> that <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">fastforce</span>
      <span class="keyword1"><span class="command">qed</span></span>
      <span class="keyword1"><span class="command">from</span></span> IH<span class="main">[</span><span class="operator">OF</span> <span class="quoted"><span class="quoted">‹transfers <span class="main">(</span>CFG.kinds kind <span class="skolem">as</span><span class="main">)</span> <span class="main">(</span>transfer <span class="main">(</span>kind <span class="skolem">a</span><span class="main">)</span> <span class="skolem">s</span><span class="main">)</span> <span class="main">=</span> <span class="free">s'</span>›</span></span>
        <span class="quoted"><span class="quoted">‹preds <span class="main">(</span>CFG.kinds kind <span class="skolem">as</span><span class="main">)</span> <span class="main">(</span>transfer <span class="main">(</span>kind <span class="skolem">a</span><span class="main">)</span> <span class="skolem">s</span><span class="main">)</span>›</span></span> _ this 
        <span class="quoted"><span class="quoted">‹labels_nodes <span class="free">prog</span> <span class="skolem">n'</span> <span class="free">c'</span>›</span></span><span class="main">]</span>
      <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">es</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"CFG.path src trg
        <span class="main">(</span>lift_valid_edge <span class="main">(</span>valid_edge <span class="free">prog</span><span class="main">)</span> sourcenode targetnode kind 
        <span class="keyword1">(_Entry_)</span> <span class="keyword1">(_Exit_)</span><span class="main">)</span> <span class="main">(</span>LDCFG_node.Node <span class="skolem">n''</span><span class="main">)</span> <span class="skolem">es</span> <span class="main">(</span>LDCFG_node.Node <span class="skolem">n'</span><span class="main">)</span>"</span></span>
        <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"transfers <span class="main">(</span>CFG.kinds knd <span class="skolem">es</span><span class="main">)</span> <span class="main">(</span>transfer <span class="main">(</span>kind <span class="skolem">a</span><span class="main">)</span> <span class="skolem">s</span><span class="main">)</span> <span class="main">=</span> <span class="free">s'</span>"</span></span>
        <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"preds <span class="main">(</span>CFG.kinds knd <span class="skolem">es</span><span class="main">)</span> <span class="main">(</span>transfer <span class="main">(</span>kind <span class="skolem">a</span><span class="main">)</span> <span class="skolem">s</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
      <span class="keyword1"><span class="command">with</span></span> <span class="quoted"><span class="quoted">‹targetnode <span class="skolem">a</span> <span class="main">=</span> <span class="skolem">n''</span>›</span></span> <span class="quoted"><span class="quoted">‹sourcenode <span class="skolem">a</span> <span class="main">=</span> <span class="skolem">nx</span>›</span></span> edge
      <span class="keyword1"><span class="command">have</span></span> path<span class="main">:</span><span class="quoted"><span class="quoted">"CFG.path src trg
        <span class="main">(</span>lift_valid_edge <span class="main">(</span>valid_edge <span class="free">prog</span><span class="main">)</span> sourcenode targetnode 
        kind <span class="keyword1">(_Entry_)</span> <span class="keyword1">(_Exit_)</span><span class="main">)</span>
        <span class="main">(</span>LDCFG_node.Node <span class="skolem">nx</span><span class="main">)</span> <span class="main">(</span><span class="main">(</span>Node <span class="main">(</span>sourcenode <span class="skolem">a</span><span class="main">)</span><span class="main">,</span>kind <span class="skolem">a</span><span class="main">,</span>Node <span class="main">(</span>targetnode <span class="skolem">a</span><span class="main">)</span><span class="main">)</span><span class="main">#</span><span class="skolem">es</span><span class="main">)</span> 
        <span class="main">(</span>LDCFG_node.Node <span class="skolem">n'</span><span class="main">)</span>"</span></span>
        <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">fastforce</span> <span class="quasi_keyword">intro</span><span class="main"><span class="main">:</span></span>CFG.Cons_path<span class="main"><span class="main">[</span></span><span class="operator">OF</span> lift_CFG<span class="main"><span class="main"><span class="main">[</span></span></span><span class="operator">OF</span> While_CFGExit_wf_aux<span class="main"><span class="main"><span class="main">]</span></span></span><span class="main"><span class="main">]</span></span><span class="main">)</span>
      <span class="keyword1"><span class="command">from</span></span> edge <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"knd <span class="main">(</span>Node <span class="main">(</span>sourcenode <span class="skolem">a</span><span class="main">)</span><span class="main">,</span>kind <span class="skolem">a</span><span class="main">,</span>Node <span class="main">(</span>targetnode <span class="skolem">a</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> kind <span class="skolem">a</span>"</span></span>
        <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span>knd_def<span class="main">)</span>
      <span class="keyword1"><span class="command">with</span></span> <span class="quoted"><span class="quoted">‹transfers <span class="main">(</span>CFG.kinds knd <span class="skolem">es</span><span class="main">)</span> <span class="main">(</span>transfer <span class="main">(</span>kind <span class="skolem">a</span><span class="main">)</span> <span class="skolem">s</span><span class="main">)</span> <span class="main">=</span> <span class="free">s'</span>›</span></span>
        <span class="quoted"><span class="quoted">‹preds <span class="main">(</span>CFG.kinds knd <span class="skolem">es</span><span class="main">)</span> <span class="main">(</span>transfer <span class="main">(</span>kind <span class="skolem">a</span><span class="main">)</span> <span class="skolem">s</span><span class="main">)</span>›</span></span> <span class="quoted"><span class="quoted">‹pred <span class="main">(</span>kind <span class="skolem">a</span><span class="main">)</span> <span class="skolem">s</span>›</span></span>
      <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"transfers 
        <span class="main">(</span>CFG.kinds knd <span class="main">(</span><span class="main">(</span>Node <span class="main">(</span>sourcenode <span class="skolem">a</span><span class="main">)</span><span class="main">,</span>kind <span class="skolem">a</span><span class="main">,</span>Node <span class="main">(</span>targetnode <span class="skolem">a</span><span class="main">)</span><span class="main">)</span><span class="main">#</span><span class="skolem">es</span><span class="main">)</span><span class="main">)</span> <span class="skolem">s</span> <span class="main">=</span> <span class="free">s'</span>"</span></span>
        <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"preds 
        <span class="main">(</span>CFG.kinds knd <span class="main">(</span><span class="main">(</span>Node <span class="main">(</span>sourcenode <span class="skolem">a</span><span class="main">)</span><span class="main">,</span>kind <span class="skolem">a</span><span class="main">,</span>Node <span class="main">(</span>targetnode <span class="skolem">a</span><span class="main">)</span><span class="main">)</span><span class="main">#</span><span class="skolem">es</span><span class="main">)</span><span class="main">)</span> <span class="skolem">s</span>"</span></span>
        <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span>CFG.kinds_def<span class="main"><span class="main">[</span></span><span class="operator">OF</span> lift_CFG<span class="main"><span class="main"><span class="main">[</span></span></span><span class="operator">OF</span> While_CFGExit_wf_aux<span class="main"><span class="main"><span class="main">]</span></span></span><span class="main"><span class="main">]</span></span><span class="main">)</span>
      <span class="keyword1"><span class="command">with</span></span> path <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
    <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">with</span></span> <span class="quoted"><span class="quoted">‹<span class="free">n</span> <span class="main">=</span> Node <span class="skolem">nx</span>›</span></span> <span class="quoted"><span class="quoted">‹labels_LDCFG_nodes <span class="free">prog</span> <span class="main">(</span>Node <span class="skolem">n'</span><span class="main">)</span> <span class="free">c'</span>›</span></span>
  <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">fastforce</span>
<span class="keyword1"><span class="command">qed</span></span>



<span class="keyword1"><span class="command">fun</span></span> <span class="entity">final</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"cmd <span class="main">⇒</span> bool"</span></span>
  <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="free">final</span> Skip <span class="main">=</span> True"</span></span>
  <span class="main">|</span> <span class="quoted"><span class="quoted">"<span class="free">final</span> <span class="free"><span class="bound"><span class="entity">c</span></span></span> <span class="main">=</span> False"</span></span>


<span class="keyword1"><span class="command">lemma</span></span> final_edge<span class="main">:</span>
  <span class="quoted"><span class="quoted">"labels_nodes <span class="free">prog</span> <span class="free">n</span> Skip <span class="main">⟹</span> <span class="free">prog</span> <span class="main">⊢</span> <span class="free">n</span> <span class="main">-</span><span class="main">⇑</span>id<span class="main">→</span> <span class="keyword1">(_Exit_)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span><span class="main">(</span><span class="operator">induct</span> <span class="quoted"><span class="free">prog</span></span> <span class="quasi_keyword">arbitrary</span><span class="main"><span class="main">:</span></span><span class="quoted"><span class="free">n</span></span><span class="main">)</span>
  <span class="keyword3"><span class="command">case</span></span> Skip
  <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹labels_nodes Skip <span class="skolem">n</span> Skip›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">n</span> <span class="main">=</span> <span class="main">(_</span> <span class="main">0</span> <span class="main">_)</span>"</span></span> 
    <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">cases</span> <span class="quoted"><span class="skolem">n</span></span><span class="main">)</span><span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">elim</span><span class="main"><span class="main">:</span></span>labels.cases<span class="main">)</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?case</span></span></span> <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">fastforce</span> <span class="quasi_keyword">intro</span><span class="main"><span class="main">:</span></span>WCFG_Skip<span class="main">)</span>
<span class="keyword1"><span class="command">next</span></span>
  <span class="keyword3"><span class="command">case</span></span> <span class="main">(</span>LAss <span class="skolem">V</span> <span class="skolem">e</span><span class="main">)</span>
  <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹labels_nodes <span class="main">(</span><span class="skolem">V</span><span class="main">:=</span><span class="skolem">e</span><span class="main">)</span> <span class="skolem">n</span> Skip›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">n</span> <span class="main">=</span> <span class="main">(_</span> <span class="main">1</span> <span class="main">_)</span>"</span></span> 
    <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">cases</span> <span class="quoted"><span class="skolem">n</span></span><span class="main">)</span><span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">elim</span><span class="main"><span class="main">:</span></span>labels.cases<span class="main">)</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?case</span></span></span> <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">fastforce</span> <span class="quasi_keyword">intro</span><span class="main"><span class="main">:</span></span>WCFG_LAssSkip<span class="main">)</span>
<span class="keyword1"><span class="command">next</span></span>
  <span class="keyword3"><span class="command">case</span></span> <span class="main">(</span>Seq <span class="skolem">c<span class="hidden">⇩</span><sub>1</sub></span> <span class="skolem">c<span class="hidden">⇩</span><sub>2</sub></span><span class="main">)</span>
  <span class="keyword1"><span class="command">note</span></span> IH2 <span class="main">=</span> <span class="quoted"><span class="quoted">‹<span class="main">⋀</span><span class="bound">n</span><span class="main">.</span> labels_nodes <span class="skolem">c<span class="hidden">⇩</span><sub>2</sub></span> <span class="bound">n</span> Skip <span class="main">⟹</span> <span class="skolem">c<span class="hidden">⇩</span><sub>2</sub></span> <span class="main">⊢</span> <span class="bound">n</span> <span class="main">-</span><span class="main">⇑</span>id<span class="main">→</span> <span class="keyword1">(_Exit_)</span>›</span></span>
  <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹labels_nodes <span class="main">(</span><span class="skolem">c<span class="hidden">⇩</span><sub>1</sub></span><span class="main">;;</span> <span class="skolem">c<span class="hidden">⇩</span><sub>2</sub></span><span class="main">)</span> <span class="skolem">n</span> Skip›</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">l</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">n</span> <span class="main">=</span> <span class="main">(_</span> <span class="skolem">l</span> <span class="main">_)</span>"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">l</span> <span class="main">≥</span> <span class="main">#:</span><span class="skolem">c<span class="hidden">⇩</span><sub>1</sub></span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"labels_nodes <span class="skolem">c<span class="hidden">⇩</span><sub>2</sub></span> <span class="main">(_</span> <span class="skolem">l</span> <span class="main">-</span> <span class="main">#:</span><span class="skolem">c<span class="hidden">⇩</span><sub>1</sub></span> <span class="main">_)</span> Skip"</span></span>
    <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">cases</span> <span class="quoted"><span class="skolem">n</span></span><span class="main">)</span><span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">elim</span><span class="main"><span class="main">:</span></span>labels.cases<span class="main">)</span>
  <span class="keyword1"><span class="command">from</span></span> IH2<span class="main">[</span><span class="operator">OF</span> <span class="quoted"><span class="quoted">‹labels_nodes <span class="skolem">c<span class="hidden">⇩</span><sub>2</sub></span> <span class="main">(_</span> <span class="skolem">l</span> <span class="main">-</span> <span class="main">#:</span><span class="skolem">c<span class="hidden">⇩</span><sub>1</sub></span> <span class="main">_)</span> Skip›</span></span><span class="main">]</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">c<span class="hidden">⇩</span><sub>2</sub></span> <span class="main">⊢</span> <span class="main">(_</span> <span class="skolem">l</span> <span class="main">-</span> <span class="main">#:</span><span class="skolem">c<span class="hidden">⇩</span><sub>1</sub></span> <span class="main">_)</span> <span class="main">-</span><span class="main">⇑</span>id<span class="main">→</span> <span class="keyword1">(_Exit_)</span>"</span></span> <span class="keyword1"><span class="command">.</span></span>
  <span class="keyword1"><span class="command">with</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">l</span> <span class="main">≥</span> <span class="main">#:</span><span class="skolem">c<span class="hidden">⇩</span><sub>1</sub></span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">c<span class="hidden">⇩</span><sub>1</sub></span><span class="main">;;</span><span class="skolem">c<span class="hidden">⇩</span><sub>2</sub></span> <span class="main">⊢</span> <span class="main">(_</span> <span class="skolem">l</span> <span class="main">-</span> <span class="main">#:</span><span class="skolem">c<span class="hidden">⇩</span><sub>1</sub></span> <span class="main">_)</span> <span class="main">⊕</span> <span class="main">#:</span><span class="skolem">c<span class="hidden">⇩</span><sub>1</sub></span> <span class="main">-</span><span class="main">⇑</span>id<span class="main">→</span> <span class="keyword1">(_Exit_)</span> <span class="main">⊕</span> <span class="main">#:</span><span class="skolem">c<span class="hidden">⇩</span><sub>1</sub></span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">fastforce</span> <span class="quasi_keyword">intro</span><span class="main"><span class="main">:</span></span>WCFG_SeqSecond<span class="main">)</span>
  <span class="keyword1"><span class="command">with</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">n</span> <span class="main">=</span> <span class="main">(_</span> <span class="skolem">l</span> <span class="main">_)</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">l</span> <span class="main">≥</span> <span class="main">#:</span><span class="skolem">c<span class="hidden">⇩</span><sub>1</sub></span>›</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?case</span></span></span> <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span>id_def<span class="main">)</span>
<span class="keyword1"><span class="command">next</span></span>
  <span class="keyword3"><span class="command">case</span></span> <span class="main">(</span>Cond <span class="skolem">b</span> <span class="skolem">c<span class="hidden">⇩</span><sub>1</sub></span> <span class="skolem">c<span class="hidden">⇩</span><sub>2</sub></span><span class="main">)</span>
  <span class="keyword1"><span class="command">note</span></span> IH1 <span class="main">=</span> <span class="quoted"><span class="quoted">‹<span class="main">⋀</span><span class="bound">n</span><span class="main">.</span> labels_nodes <span class="skolem">c<span class="hidden">⇩</span><sub>1</sub></span> <span class="bound">n</span> Skip <span class="main">⟹</span> <span class="skolem">c<span class="hidden">⇩</span><sub>1</sub></span> <span class="main">⊢</span> <span class="bound">n</span> <span class="main">-</span><span class="main">⇑</span>id<span class="main">→</span> <span class="keyword1">(_Exit_)</span>›</span></span>
  <span class="keyword1"><span class="command">note</span></span> IH2 <span class="main">=</span> <span class="quoted"><span class="quoted">‹<span class="main">⋀</span><span class="bound">n</span><span class="main">.</span> labels_nodes <span class="skolem">c<span class="hidden">⇩</span><sub>2</sub></span> <span class="bound">n</span> Skip <span class="main">⟹</span> <span class="skolem">c<span class="hidden">⇩</span><sub>2</sub></span> <span class="main">⊢</span> <span class="bound">n</span> <span class="main">-</span><span class="main">⇑</span>id<span class="main">→</span> <span class="keyword1">(_Exit_)</span>›</span></span>
  <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹labels_nodes <span class="main">(</span><span class="keyword1">if</span> <span class="main">(</span><span class="skolem">b</span><span class="main">)</span> <span class="skolem">c<span class="hidden">⇩</span><sub>1</sub></span> <span class="keyword1">else</span> <span class="skolem">c<span class="hidden">⇩</span><sub>2</sub></span><span class="main">)</span> <span class="skolem">n</span> Skip›</span></span>
  <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">l</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">n</span> <span class="main">=</span> <span class="main">(_</span> <span class="skolem">l</span> <span class="main">_)</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> disj<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">l</span> <span class="main">≥</span> <span class="main">1</span> <span class="main">∧</span> labels_nodes <span class="skolem">c<span class="hidden">⇩</span><sub>1</sub></span> <span class="main">(_</span> <span class="skolem">l</span> <span class="main">-</span> <span class="main">1</span> <span class="main">_)</span> Skip<span class="main">)</span> <span class="main">∨</span>
    <span class="main">(</span><span class="skolem">l</span> <span class="main">≥</span> <span class="main">#:</span><span class="skolem">c<span class="hidden">⇩</span><sub>1</sub></span> <span class="main">+</span> <span class="main">1</span> <span class="main">∧</span> labels_nodes <span class="skolem">c<span class="hidden">⇩</span><sub>2</sub></span> <span class="main">(_</span> <span class="skolem">l</span> <span class="main">-</span> <span class="main">#:</span><span class="skolem">c<span class="hidden">⇩</span><sub>1</sub></span> <span class="main">-</span> <span class="main">1</span> <span class="main">_)</span> Skip<span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">cases</span> <span class="quoted"><span class="skolem">n</span></span><span class="main">)</span> <span class="main">(</span><span class="operator">fastforce</span> <span class="quasi_keyword">elim</span><span class="main"><span class="main">:</span></span>labels.cases<span class="main">)</span><span class="main"><span class="keyword3">+</span></span>
  <span class="keyword1"><span class="command">from</span></span> disj <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?case</span></span></span>
  <span class="keyword1"><span class="command">proof</span></span>
    <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">1</span> <span class="main">≤</span> <span class="skolem">l</span> <span class="main">∧</span> labels_nodes <span class="skolem">c<span class="hidden">⇩</span><sub>1</sub></span> <span class="main">(_</span> <span class="skolem">l</span> <span class="main">-</span> <span class="main">1</span> <span class="main">_)</span> Skip"</span></span>
    <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="main">1</span> <span class="main">≤</span> <span class="skolem">l</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"labels_nodes <span class="skolem">c<span class="hidden">⇩</span><sub>1</sub></span> <span class="main">(_</span> <span class="skolem">l</span> <span class="main">-</span> <span class="main">1</span> <span class="main">_)</span> Skip"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp_all</span>
    <span class="keyword1"><span class="command">from</span></span> IH1<span class="main">[</span><span class="operator">OF</span> <span class="quoted"><span class="quoted">‹labels_nodes <span class="skolem">c<span class="hidden">⇩</span><sub>1</sub></span> <span class="main">(_</span> <span class="skolem">l</span> <span class="main">-</span> <span class="main">1</span> <span class="main">_)</span> Skip›</span></span><span class="main">]</span> 
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">c<span class="hidden">⇩</span><sub>1</sub></span> <span class="main">⊢</span> <span class="main">(_</span> <span class="skolem">l</span> <span class="main">-</span> <span class="main">1</span> <span class="main">_)</span> <span class="main">-</span><span class="main">⇑</span>id<span class="main">→</span> <span class="keyword1">(_Exit_)</span>"</span></span> <span class="keyword1"><span class="command">.</span></span>
    <span class="keyword1"><span class="command">with</span></span> <span class="quoted"><span class="quoted">‹<span class="main">1</span> <span class="main">≤</span> <span class="skolem">l</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">if</span> <span class="main">(</span><span class="skolem">b</span><span class="main">)</span> <span class="skolem">c<span class="hidden">⇩</span><sub>1</sub></span> <span class="keyword1">else</span> <span class="skolem">c<span class="hidden">⇩</span><sub>2</sub></span> <span class="main">⊢</span> <span class="main">(_</span> <span class="skolem">l</span> <span class="main">-</span> <span class="main">1</span> <span class="main">_)</span> <span class="main">⊕</span> <span class="main">1</span> <span class="main">-</span><span class="main">⇑</span>id<span class="main">→</span> <span class="keyword1">(_Exit_)</span> <span class="main">⊕</span> <span class="main">1</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">fastforce</span> <span class="quasi_keyword">intro</span><span class="main"><span class="main">:</span></span>WCFG_CondThen<span class="main">)</span>
    <span class="keyword1"><span class="command">with</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">n</span> <span class="main">=</span> <span class="main">(_</span> <span class="skolem">l</span> <span class="main">_)</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="main">1</span> <span class="main">≤</span> <span class="skolem">l</span>›</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?case</span></span></span> <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span>id_def<span class="main">)</span>
  <span class="keyword1"><span class="command">next</span></span>
    <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">#:</span><span class="skolem">c<span class="hidden">⇩</span><sub>1</sub></span> <span class="main">+</span> <span class="main">1</span> <span class="main">≤</span> <span class="skolem">l</span> <span class="main">∧</span> labels_nodes <span class="skolem">c<span class="hidden">⇩</span><sub>2</sub></span> <span class="main">(_</span> <span class="skolem">l</span> <span class="main">-</span> <span class="main">#:</span><span class="skolem">c<span class="hidden">⇩</span><sub>1</sub></span> <span class="main">-</span> <span class="main">1</span> <span class="main">_)</span> Skip"</span></span>
    <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="main">#:</span><span class="skolem">c<span class="hidden">⇩</span><sub>1</sub></span> <span class="main">+</span> <span class="main">1</span> <span class="main">≤</span> <span class="skolem">l</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"labels_nodes <span class="skolem">c<span class="hidden">⇩</span><sub>2</sub></span> <span class="main">(_</span> <span class="skolem">l</span> <span class="main">-</span> <span class="main">#:</span><span class="skolem">c<span class="hidden">⇩</span><sub>1</sub></span> <span class="main">-</span> <span class="main">1</span> <span class="main">_)</span> Skip"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp_all</span>
    <span class="keyword1"><span class="command">from</span></span> IH2<span class="main">[</span><span class="operator">OF</span> <span class="quoted"><span class="quoted">‹labels_nodes <span class="skolem">c<span class="hidden">⇩</span><sub>2</sub></span> <span class="main">(_</span> <span class="skolem">l</span> <span class="main">-</span> <span class="main">#:</span><span class="skolem">c<span class="hidden">⇩</span><sub>1</sub></span> <span class="main">-</span> <span class="main">1</span> <span class="main">_)</span> Skip›</span></span><span class="main">]</span>
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">c<span class="hidden">⇩</span><sub>2</sub></span> <span class="main">⊢</span> <span class="main">(_</span> <span class="skolem">l</span> <span class="main">-</span> <span class="main">#:</span><span class="skolem">c<span class="hidden">⇩</span><sub>1</sub></span> <span class="main">-</span> <span class="main">1</span> <span class="main">_)</span> <span class="main">-</span><span class="main">⇑</span>id<span class="main">→</span> <span class="keyword1">(_Exit_)</span>"</span></span> <span class="keyword1"><span class="command">.</span></span>
    <span class="keyword1"><span class="command">with</span></span> <span class="quoted"><span class="quoted">‹<span class="main">#:</span><span class="skolem">c<span class="hidden">⇩</span><sub>1</sub></span> <span class="main">+</span> <span class="main">1</span> <span class="main">≤</span> <span class="skolem">l</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">if</span> <span class="main">(</span><span class="skolem">b</span><span class="main">)</span> <span class="skolem">c<span class="hidden">⇩</span><sub>1</sub></span> <span class="keyword1">else</span> <span class="skolem">c<span class="hidden">⇩</span><sub>2</sub></span> <span class="main">⊢</span> <span class="main">(_</span> <span class="skolem">l</span> <span class="main">-</span> <span class="main">#:</span><span class="skolem">c<span class="hidden">⇩</span><sub>1</sub></span> <span class="main">-</span> <span class="main">1</span> <span class="main">_)</span> <span class="main">⊕</span> <span class="main">(</span><span class="main">#:</span><span class="skolem">c<span class="hidden">⇩</span><sub>1</sub></span> <span class="main">+</span> <span class="main">1</span><span class="main">)</span>
      <span class="main">-</span><span class="main">⇑</span>id<span class="main">→</span> <span class="keyword1">(_Exit_)</span> <span class="main">⊕</span> <span class="main">(</span><span class="main">#:</span><span class="skolem">c<span class="hidden">⇩</span><sub>1</sub></span> <span class="main">+</span> <span class="main">1</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">fastforce</span> <span class="quasi_keyword">intro</span><span class="main"><span class="main">:</span></span>WCFG_CondElse<span class="main">)</span>
    <span class="keyword1"><span class="command">with</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">n</span> <span class="main">=</span> <span class="main">(_</span> <span class="skolem">l</span> <span class="main">_)</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="main">#:</span><span class="skolem">c<span class="hidden">⇩</span><sub>1</sub></span> <span class="main">+</span> <span class="main">1</span> <span class="main">≤</span> <span class="skolem">l</span>›</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?case</span></span></span> <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span>id_def<span class="main">)</span>
  <span class="keyword1"><span class="command">qed</span></span>
<span class="keyword1"><span class="command">next</span></span>
  <span class="keyword3"><span class="command">case</span></span> <span class="main">(</span>While <span class="skolem">b</span> <span class="skolem">c</span><span class="main">)</span>
  <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹labels_nodes <span class="main">(</span><span class="keyword1">while</span> <span class="main">(</span><span class="skolem">b</span><span class="main">)</span> <span class="skolem">c</span><span class="main">)</span> <span class="skolem">n</span> Skip›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">n</span> <span class="main">=</span> <span class="main">(_</span> <span class="main">1</span> <span class="main">_)</span>"</span></span> 
    <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">cases</span> <span class="quoted"><span class="skolem">n</span></span><span class="main">)</span><span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">elim</span><span class="main"><span class="main">:</span></span>labels.cases<span class="main">)</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?case</span></span></span> <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">fastforce</span> <span class="quasi_keyword">intro</span><span class="main"><span class="main">:</span></span>WCFG_WhileFalseSkip<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>




<span class="keyword1"><span class="command">subsection</span></span> <span class="quoted"><span class="plain_text">‹Semantic Non-Interference for Weak Order Dependence›</span></span>

<span class="keyword1"><span class="command">lemmas</span></span> WODNonInterferenceGraph <span class="main">=</span> 
  lift_wod_backward_slice<span class="main">[</span><span class="operator">OF</span> While_CFGExit_wf_aux HighLowDistinct HighLowUNIV<span class="main">]</span>


<span class="keyword1"><span class="command">lemma</span></span> WODNonInterference<span class="main">:</span>
  <span class="quoted"><span class="quoted">"NonInterferenceIntra src trg knd
     <span class="main">(</span>lift_valid_edge <span class="main">(</span>valid_edge <span class="free">prog</span><span class="main">)</span> sourcenode targetnode kind
       <span class="keyword1">(_Entry_)</span> <span class="keyword1">(_Exit_)</span><span class="main">)</span>
     NewEntry <span class="main">(</span>lift_Def <span class="main">(</span>Defs <span class="free">prog</span><span class="main">)</span> <span class="keyword1">(_Entry_)</span> <span class="keyword1">(_Exit_)</span> <span class="free">H</span> <span class="free">L</span><span class="main">)</span>
     <span class="main">(</span>lift_Use <span class="main">(</span>Uses <span class="free">prog</span><span class="main">)</span> <span class="keyword1">(_Entry_)</span> <span class="keyword1">(_Exit_)</span> <span class="free">H</span> <span class="free">L</span><span class="main">)</span> id
     <span class="main">(</span>CFG_wf.wod_backward_slice src trg
       <span class="main">(</span>lift_valid_edge <span class="main">(</span>valid_edge <span class="free">prog</span><span class="main">)</span> sourcenode targetnode kind
         <span class="keyword1">(_Entry_)</span> <span class="keyword1">(_Exit_)</span><span class="main">)</span>
       <span class="main">(</span>lift_Def <span class="main">(</span>Defs <span class="free">prog</span><span class="main">)</span> <span class="keyword1">(_Entry_)</span> <span class="keyword1">(_Exit_)</span> <span class="free">H</span> <span class="free">L</span><span class="main">)</span>
       <span class="main">(</span>lift_Use <span class="main">(</span>Uses <span class="free">prog</span><span class="main">)</span> <span class="keyword1">(_Entry_)</span> <span class="keyword1">(_Exit_)</span> <span class="free">H</span> <span class="free">L</span><span class="main">)</span><span class="main">)</span>
     reds <span class="main">(</span>labels_LDCFG_nodes <span class="free">prog</span><span class="main">)</span>
     NewExit <span class="free">H</span> <span class="free">L</span> <span class="main">(</span>LDCFG_node.Node <span class="keyword1">(_Entry_)</span><span class="main">)</span> <span class="main">(</span>LDCFG_node.Node <span class="keyword1">(_Exit_)</span><span class="main">)</span> final"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">interpret</span></span> NonInterferenceIntraGraph <span class="quoted">src</span> <span class="quoted">trg</span> <span class="quoted">knd</span>
     <span class="quoted"><span class="quoted">"lift_valid_edge <span class="main">(</span>valid_edge <span class="free">prog</span><span class="main">)</span> sourcenode targetnode kind
       <span class="keyword1">(_Entry_)</span> <span class="keyword1">(_Exit_)</span>"</span></span>
     <span class="quoted">NewEntry</span> <span class="quoted"><span class="quoted">"lift_Def <span class="main">(</span>Defs <span class="free">prog</span><span class="main">)</span> <span class="keyword1">(_Entry_)</span> <span class="keyword1">(_Exit_)</span> <span class="free">H</span> <span class="free">L</span>"</span></span>
     <span class="quoted"><span class="quoted">"lift_Use <span class="main">(</span>Uses <span class="free">prog</span><span class="main">)</span> <span class="keyword1">(_Entry_)</span> <span class="keyword1">(_Exit_)</span> <span class="free">H</span> <span class="free">L</span>"</span></span> <span class="quoted">id</span>
     <span class="quoted"><span class="quoted">"CFG_wf.wod_backward_slice src trg
       <span class="main">(</span>lift_valid_edge <span class="main">(</span>valid_edge <span class="free">prog</span><span class="main">)</span> sourcenode targetnode kind
         <span class="keyword1">(_Entry_)</span> <span class="keyword1">(_Exit_)</span><span class="main">)</span>
       <span class="main">(</span>lift_Def <span class="main">(</span>Defs <span class="free">prog</span><span class="main">)</span> <span class="keyword1">(_Entry_)</span> <span class="keyword1">(_Exit_)</span> <span class="free">H</span> <span class="free">L</span><span class="main">)</span>
       <span class="main">(</span>lift_Use <span class="main">(</span>Uses <span class="free">prog</span><span class="main">)</span> <span class="keyword1">(_Entry_)</span> <span class="keyword1">(_Exit_)</span> <span class="free">H</span> <span class="free">L</span><span class="main">)</span>"</span></span>
     <span class="quoted">NewExit</span> <span class="quoted"><span class="free">H</span></span> <span class="quoted"><span class="free">L</span></span> <span class="quoted"><span class="quoted">"LDCFG_node.Node <span class="keyword1">(_Entry_)</span>"</span></span> <span class="quoted"><span class="quoted">"LDCFG_node.Node <span class="keyword1">(_Exit_)</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">rule</span> WODNonInterferenceGraph<span class="main">)</span>
  <span class="keyword1"><span class="command">interpret</span></span> BackwardSlice_wf <span class="quoted">src</span> <span class="quoted">trg</span> <span class="quoted">knd</span>
    <span class="quoted"><span class="quoted">"lift_valid_edge <span class="main">(</span>valid_edge <span class="free">prog</span><span class="main">)</span> sourcenode targetnode kind
      <span class="keyword1">(_Entry_)</span> <span class="keyword1">(_Exit_)</span>"</span></span>
    <span class="quoted">NewEntry</span> <span class="quoted"><span class="quoted">"lift_Def <span class="main">(</span>Defs <span class="free">prog</span><span class="main">)</span> <span class="keyword1">(_Entry_)</span> <span class="keyword1">(_Exit_)</span> <span class="free">H</span> <span class="free">L</span>"</span></span>
    <span class="quoted"><span class="quoted">"lift_Use <span class="main">(</span>Uses <span class="free">prog</span><span class="main">)</span> <span class="keyword1">(_Entry_)</span> <span class="keyword1">(_Exit_)</span> <span class="free">H</span> <span class="free">L</span>"</span></span> <span class="quoted">id</span>
    <span class="quoted"><span class="quoted">"CFG_wf.wod_backward_slice src trg
       <span class="main">(</span>lift_valid_edge <span class="main">(</span>valid_edge <span class="free">prog</span><span class="main">)</span> sourcenode targetnode kind
         <span class="keyword1">(_Entry_)</span> <span class="keyword1">(_Exit_)</span><span class="main">)</span>
       <span class="main">(</span>lift_Def <span class="main">(</span>Defs <span class="free">prog</span><span class="main">)</span> <span class="keyword1">(_Entry_)</span> <span class="keyword1">(_Exit_)</span> <span class="free">H</span> <span class="free">L</span><span class="main">)</span>
       <span class="main">(</span>lift_Use <span class="main">(</span>Uses <span class="free">prog</span><span class="main">)</span> <span class="keyword1">(_Entry_)</span> <span class="keyword1">(_Exit_)</span> <span class="free">H</span> <span class="free">L</span><span class="main">)</span>"</span></span> <span class="quoted">reds</span> <span class="quoted"><span class="quoted">"labels_LDCFG_nodes <span class="free">prog</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span><span class="main">(</span><span class="operator">unfold_locales</span><span class="main">)</span>
    <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">n</span> <span class="skolem">c</span> <span class="skolem">s</span> <span class="skolem">c'</span> <span class="skolem">s'</span>
    <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"labels_LDCFG_nodes <span class="free">prog</span> <span class="skolem">n</span> <span class="skolem">c</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">⟨</span><span class="skolem">c</span><span class="main">,</span><span class="skolem">s</span><span class="main">⟩</span> <span class="main">→*</span> <span class="main">⟨</span><span class="skolem">c'</span><span class="main">,</span><span class="skolem">s'</span><span class="main">⟩</span>"</span></span>
    <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound">n'</span> <span class="bound">as</span><span class="main">.</span> CFG.path src trg
     <span class="main">(</span>lift_valid_edge <span class="main">(</span>valid_edge <span class="free">prog</span><span class="main">)</span> sourcenode targetnode kind <span class="keyword1">(_Entry_)</span> <span class="keyword1">(_Exit_)</span><span class="main">)</span>
      <span class="skolem">n</span> <span class="bound">as</span> <span class="bound">n'</span> <span class="main">∧</span> transfers <span class="main">(</span>CFG.kinds knd <span class="bound">as</span><span class="main">)</span> <span class="skolem">s</span> <span class="main">=</span> <span class="skolem">s'</span> <span class="main">∧</span>
      preds <span class="main">(</span>CFG.kinds knd <span class="bound">as</span><span class="main">)</span> <span class="skolem">s</span> <span class="main">∧</span> labels_LDCFG_nodes <span class="free">prog</span> <span class="bound">n'</span> <span class="skolem">c'</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">rule</span> lifted_CFG_fund_prop<span class="main">)</span>
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> 
  <span class="keyword1"><span class="command">proof</span></span><span class="main">(</span><span class="operator">unfold_locales</span><span class="main">)</span>
    <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">c</span> <span class="skolem">n</span>
    <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"final <span class="skolem">c</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"labels_LDCFG_nodes <span class="free">prog</span> <span class="skolem">n</span> <span class="skolem">c</span>"</span></span>
    <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹final <span class="skolem">c</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">c</span> <span class="main">=</span> Skip"</span></span> <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">cases</span> <span class="quoted"><span class="skolem">c</span></span><span class="main">)</span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹labels_LDCFG_nodes <span class="free">prog</span> <span class="skolem">n</span> <span class="skolem">c</span>›</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">nx</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">n</span> <span class="main">=</span> Node <span class="skolem">nx</span>"</span></span>
      <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"labels_nodes <span class="free">prog</span> <span class="skolem">nx</span> Skip"</span></span> <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">cases</span> <span class="quoted"><span class="skolem">n</span></span><span class="main">)</span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹labels_nodes <span class="free">prog</span> <span class="skolem">nx</span> Skip›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">prog</span> <span class="main">⊢</span> <span class="skolem">nx</span> <span class="main">-</span><span class="main">⇑</span>id<span class="main">→</span> <span class="keyword1">(_Exit_)</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">rule</span> final_edge<span class="main">)</span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">a</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"valid_edge <span class="free">prog</span> <span class="skolem">a</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"sourcenode <span class="skolem">a</span> <span class="main">=</span> <span class="skolem">nx</span>"</span></span>
      <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"kind <span class="skolem">a</span> <span class="main">=</span> <span class="main">⇑</span>id"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"targetnode <span class="skolem">a</span> <span class="main">=</span> <span class="keyword1">(_Exit_)</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span>valid_edge_def<span class="main">)</span>
    <span class="keyword1"><span class="command">with</span></span> <span class="quoted"><span class="quoted">‹labels_nodes <span class="free">prog</span> <span class="skolem">nx</span> Skip›</span></span>
    <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound">a</span><span class="main">.</span> lift_valid_edge <span class="main">(</span>valid_edge <span class="free">prog</span><span class="main">)</span> sourcenode targetnode
      kind <span class="keyword1">(_Entry_)</span> <span class="keyword1">(_Exit_)</span> <span class="bound">a</span> <span class="main">∧</span>
      src <span class="bound">a</span> <span class="main">=</span> <span class="skolem">n</span> <span class="main">∧</span> trg <span class="bound">a</span> <span class="main">=</span> LDCFG_node.Node <span class="keyword1">(_Exit_)</span> <span class="main">∧</span> knd <span class="bound">a</span> <span class="main">=</span> <span class="main">⇑</span>id"</span></span>
      <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">rule_tac</span> x<span class="main"><span class="main">=</span></span><span class="quoted"><span class="quoted">"<span class="main">(</span>Node <span class="skolem">nx</span><span class="main">,</span><span class="main">⇑</span>id<span class="main">,</span>Node <span class="keyword1">(_Exit_)</span><span class="main">)</span>"</span></span> <span class="keyword2"><span class="keyword"><span class="quasi_keyword">in</span></span></span> exI<span class="main">)</span>
        <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">intro</span><span class="main"><span class="main">!</span></span><span class="main"><span class="main">:</span></span>lve_edge <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span>knd_def valid_edge_def<span class="main">)</span>
  <span class="keyword1"><span class="command">qed</span></span>
<span class="keyword1"><span class="command">qed</span></span>


<span class="keyword1"><span class="command">subsection</span></span> <span class="quoted"><span class="plain_text">‹Semantic Non-Interference for Standard Control Dependence›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> inner_node_exists<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound">n</span><span class="main">.</span> CFGExit.inner_node sourcenode targetnode 
  <span class="main">(</span>valid_edge <span class="free">prog</span><span class="main">)</span> <span class="keyword1">(_Entry_)</span> <span class="keyword1">(_Exit_)</span> <span class="bound">n</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">prog</span> <span class="main">⊢</span> <span class="keyword1">(_Entry_)</span> <span class="main">-</span><span class="main">(</span><span class="main">λ</span><span class="bound">s</span><span class="main">.</span> True<span class="main">)<span class="hidden">⇩</span><sub>√</sub></span><span class="main">→</span> <span class="main">(_</span><span class="main">0</span><span class="main">_)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">rule</span> WCFG_Entry<span class="main">)</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"CFG.valid_node sourcenode targetnode <span class="main">(</span>valid_edge <span class="free">prog</span><span class="main">)</span> <span class="main">(_</span><span class="main">0</span><span class="main">_)</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span>While_CFG.valid_node_def valid_edge_def<span class="main">)</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span>While_CFGExit.inner_node_def<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>


<span class="keyword1"><span class="command">lemmas</span></span> SCDNonInterferenceGraph <span class="main">=</span> 
  lift_PDG_standard_backward_slice<span class="main">[</span><span class="operator">OF</span> WStandardControlDependence.PDG_scd 
  WhilePostdomination_aux _ HighLowDistinct HighLowUNIV<span class="main">]</span>


<span class="keyword1"><span class="command">lemma</span></span> SCDNonInterference<span class="main">:</span>
  <span class="quoted"><span class="quoted">"NonInterferenceIntra src trg knd
     <span class="main">(</span>lift_valid_edge <span class="main">(</span>valid_edge <span class="free">prog</span><span class="main">)</span> sourcenode targetnode kind
       <span class="keyword1">(_Entry_)</span> <span class="keyword1">(_Exit_)</span><span class="main">)</span>
     NewEntry <span class="main">(</span>lift_Def <span class="main">(</span>Defs <span class="free">prog</span><span class="main">)</span> <span class="keyword1">(_Entry_)</span> <span class="keyword1">(_Exit_)</span> <span class="free">H</span> <span class="free">L</span><span class="main">)</span>
     <span class="main">(</span>lift_Use <span class="main">(</span>Uses <span class="free">prog</span><span class="main">)</span> <span class="keyword1">(_Entry_)</span> <span class="keyword1">(_Exit_)</span> <span class="free">H</span> <span class="free">L</span><span class="main">)</span> id
     <span class="main">(</span>PDG.PDG_BS src trg
       <span class="main">(</span>lift_valid_edge <span class="main">(</span>valid_edge <span class="free">prog</span><span class="main">)</span> sourcenode targetnode kind
         <span class="keyword1">(_Entry_)</span> <span class="keyword1">(_Exit_)</span><span class="main">)</span>
       <span class="main">(</span>lift_Def <span class="main">(</span>Defs <span class="free">prog</span><span class="main">)</span> <span class="keyword1">(_Entry_)</span> <span class="keyword1">(_Exit_)</span> <span class="free">H</span> <span class="free">L</span><span class="main">)</span>
       <span class="main">(</span>lift_Use <span class="main">(</span>Uses <span class="free">prog</span><span class="main">)</span> <span class="keyword1">(_Entry_)</span> <span class="keyword1">(_Exit_)</span> <span class="free">H</span> <span class="free">L</span><span class="main">)</span>
       <span class="main">(</span>Postdomination.standard_control_dependence src trg
         <span class="main">(</span>lift_valid_edge <span class="main">(</span>valid_edge <span class="free">prog</span><span class="main">)</span> sourcenode targetnode kind
           <span class="keyword1">(_Entry_)</span> <span class="keyword1">(_Exit_)</span><span class="main">)</span> NewExit<span class="main">)</span><span class="main">)</span>
     reds <span class="main">(</span>labels_LDCFG_nodes <span class="free">prog</span><span class="main">)</span>
     NewExit <span class="free">H</span> <span class="free">L</span> <span class="main">(</span>LDCFG_node.Node <span class="keyword1">(_Entry_)</span><span class="main">)</span> <span class="main">(</span>LDCFG_node.Node <span class="keyword1">(_Exit_)</span><span class="main">)</span> final"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">from</span></span> inner_node_exists <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">n</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"CFGExit.inner_node sourcenode targetnode 
    <span class="main">(</span>valid_edge <span class="free">prog</span><span class="main">)</span> <span class="keyword1">(_Entry_)</span> <span class="keyword1">(_Exit_)</span> <span class="skolem">n</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">interpret</span></span> NonInterferenceIntraGraph <span class="quoted">src</span> <span class="quoted">trg</span> <span class="quoted">knd</span>
     <span class="quoted"><span class="quoted">"lift_valid_edge <span class="main">(</span>valid_edge <span class="free">prog</span><span class="main">)</span> sourcenode targetnode kind
       <span class="keyword1">(_Entry_)</span> <span class="keyword1">(_Exit_)</span>"</span></span>
     <span class="quoted">NewEntry</span> <span class="quoted"><span class="quoted">"lift_Def <span class="main">(</span>Defs <span class="free">prog</span><span class="main">)</span> <span class="keyword1">(_Entry_)</span> <span class="keyword1">(_Exit_)</span> <span class="free">H</span> <span class="free">L</span>"</span></span>
     <span class="quoted"><span class="quoted">"lift_Use <span class="main">(</span>Uses <span class="free">prog</span><span class="main">)</span> <span class="keyword1">(_Entry_)</span> <span class="keyword1">(_Exit_)</span> <span class="free">H</span> <span class="free">L</span>"</span></span> <span class="quoted">id</span>
     <span class="quoted"><span class="quoted">"PDG.PDG_BS src trg
       <span class="main">(</span>lift_valid_edge <span class="main">(</span>valid_edge <span class="free">prog</span><span class="main">)</span> sourcenode targetnode kind
         <span class="keyword1">(_Entry_)</span> <span class="keyword1">(_Exit_)</span><span class="main">)</span>
       <span class="main">(</span>lift_Def <span class="main">(</span>Defs <span class="free">prog</span><span class="main">)</span> <span class="keyword1">(_Entry_)</span> <span class="keyword1">(_Exit_)</span> <span class="free">H</span> <span class="free">L</span><span class="main">)</span>
       <span class="main">(</span>lift_Use <span class="main">(</span>Uses <span class="free">prog</span><span class="main">)</span> <span class="keyword1">(_Entry_)</span> <span class="keyword1">(_Exit_)</span> <span class="free">H</span> <span class="free">L</span><span class="main">)</span>
       <span class="main">(</span>Postdomination.standard_control_dependence src trg
         <span class="main">(</span>lift_valid_edge <span class="main">(</span>valid_edge <span class="free">prog</span><span class="main">)</span> sourcenode targetnode kind
           <span class="keyword1">(_Entry_)</span> <span class="keyword1">(_Exit_)</span><span class="main">)</span> NewExit<span class="main">)</span>"</span></span>
     <span class="quoted">NewExit</span> <span class="quoted"><span class="free">H</span></span> <span class="quoted"><span class="free">L</span></span> <span class="quoted"><span class="quoted">"LDCFG_node.Node <span class="keyword1">(_Entry_)</span>"</span></span> <span class="quoted"><span class="quoted">"LDCFG_node.Node <span class="keyword1">(_Exit_)</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">fastforce</span> <span class="quasi_keyword">intro</span><span class="main"><span class="main">:</span></span>SCDNonInterferenceGraph<span class="main">)</span>
  <span class="keyword1"><span class="command">interpret</span></span> BackwardSlice_wf <span class="quoted">src</span> <span class="quoted">trg</span> <span class="quoted">knd</span>
    <span class="quoted"><span class="quoted">"lift_valid_edge <span class="main">(</span>valid_edge <span class="free">prog</span><span class="main">)</span> sourcenode targetnode kind
      <span class="keyword1">(_Entry_)</span> <span class="keyword1">(_Exit_)</span>"</span></span>
    <span class="quoted">NewEntry</span> <span class="quoted"><span class="quoted">"lift_Def <span class="main">(</span>Defs <span class="free">prog</span><span class="main">)</span> <span class="keyword1">(_Entry_)</span> <span class="keyword1">(_Exit_)</span> <span class="free">H</span> <span class="free">L</span>"</span></span>
    <span class="quoted"><span class="quoted">"lift_Use <span class="main">(</span>Uses <span class="free">prog</span><span class="main">)</span> <span class="keyword1">(_Entry_)</span> <span class="keyword1">(_Exit_)</span> <span class="free">H</span> <span class="free">L</span>"</span></span> <span class="quoted">id</span>
    <span class="quoted"><span class="quoted">"PDG.PDG_BS src trg
       <span class="main">(</span>lift_valid_edge <span class="main">(</span>valid_edge <span class="free">prog</span><span class="main">)</span> sourcenode targetnode kind
         <span class="keyword1">(_Entry_)</span> <span class="keyword1">(_Exit_)</span><span class="main">)</span>
       <span class="main">(</span>lift_Def <span class="main">(</span>Defs <span class="free">prog</span><span class="main">)</span> <span class="keyword1">(_Entry_)</span> <span class="keyword1">(_Exit_)</span> <span class="free">H</span> <span class="free">L</span><span class="main">)</span>
       <span class="main">(</span>lift_Use <span class="main">(</span>Uses <span class="free">prog</span><span class="main">)</span> <span class="keyword1">(_Entry_)</span> <span class="keyword1">(_Exit_)</span> <span class="free">H</span> <span class="free">L</span><span class="main">)</span>
       <span class="main">(</span>Postdomination.standard_control_dependence src trg
         <span class="main">(</span>lift_valid_edge <span class="main">(</span>valid_edge <span class="free">prog</span><span class="main">)</span> sourcenode targetnode kind
           <span class="keyword1">(_Entry_)</span> <span class="keyword1">(_Exit_)</span><span class="main">)</span> NewExit<span class="main">)</span>"</span></span> <span class="quoted">reds</span> <span class="quoted"><span class="quoted">"labels_LDCFG_nodes <span class="free">prog</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span><span class="main">(</span><span class="operator">unfold_locales</span><span class="main">)</span>
    <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">n</span> <span class="skolem">c</span> <span class="skolem">s</span> <span class="skolem">c'</span> <span class="skolem">s'</span>
    <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"labels_LDCFG_nodes <span class="free">prog</span> <span class="skolem">n</span> <span class="skolem">c</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">⟨</span><span class="skolem">c</span><span class="main">,</span><span class="skolem">s</span><span class="main">⟩</span> <span class="main">→*</span> <span class="main">⟨</span><span class="skolem">c'</span><span class="main">,</span><span class="skolem">s'</span><span class="main">⟩</span>"</span></span>
    <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound">n'</span> <span class="bound">as</span><span class="main">.</span> CFG.path src trg
     <span class="main">(</span>lift_valid_edge <span class="main">(</span>valid_edge <span class="free">prog</span><span class="main">)</span> sourcenode targetnode kind <span class="keyword1">(_Entry_)</span> <span class="keyword1">(_Exit_)</span><span class="main">)</span>
      <span class="skolem">n</span> <span class="bound">as</span> <span class="bound">n'</span> <span class="main">∧</span> transfers <span class="main">(</span>CFG.kinds knd <span class="bound">as</span><span class="main">)</span> <span class="skolem">s</span> <span class="main">=</span> <span class="skolem">s'</span> <span class="main">∧</span>
      preds <span class="main">(</span>CFG.kinds knd <span class="bound">as</span><span class="main">)</span> <span class="skolem">s</span> <span class="main">∧</span> labels_LDCFG_nodes <span class="free">prog</span> <span class="bound">n'</span> <span class="skolem">c'</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">rule</span> lifted_CFG_fund_prop<span class="main">)</span>
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> 
  <span class="keyword1"><span class="command">proof</span></span><span class="main">(</span><span class="operator">unfold_locales</span><span class="main">)</span>
    <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">c</span> <span class="skolem">n</span>
    <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"final <span class="skolem">c</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"labels_LDCFG_nodes <span class="free">prog</span> <span class="skolem">n</span> <span class="skolem">c</span>"</span></span>
    <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹final <span class="skolem">c</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">c</span> <span class="main">=</span> Skip"</span></span> <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">cases</span> <span class="quoted"><span class="skolem">c</span></span><span class="main">)</span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹labels_LDCFG_nodes <span class="free">prog</span> <span class="skolem">n</span> <span class="skolem">c</span>›</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">nx</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">n</span> <span class="main">=</span> Node <span class="skolem">nx</span>"</span></span>
      <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"labels_nodes <span class="free">prog</span> <span class="skolem">nx</span> Skip"</span></span> <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">cases</span> <span class="quoted"><span class="skolem">n</span></span><span class="main">)</span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹labels_nodes <span class="free">prog</span> <span class="skolem">nx</span> Skip›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">prog</span> <span class="main">⊢</span> <span class="skolem">nx</span> <span class="main">-</span><span class="main">⇑</span>id<span class="main">→</span> <span class="keyword1">(_Exit_)</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">rule</span> final_edge<span class="main">)</span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">a</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"valid_edge <span class="free">prog</span> <span class="skolem">a</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"sourcenode <span class="skolem">a</span> <span class="main">=</span> <span class="skolem">nx</span>"</span></span>
      <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"kind <span class="skolem">a</span> <span class="main">=</span> <span class="main">⇑</span>id"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"targetnode <span class="skolem">a</span> <span class="main">=</span> <span class="keyword1">(_Exit_)</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span>valid_edge_def<span class="main">)</span>
    <span class="keyword1"><span class="command">with</span></span> <span class="quoted"><span class="quoted">‹labels_nodes <span class="free">prog</span> <span class="skolem">nx</span> Skip›</span></span>
    <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound">a</span><span class="main">.</span> lift_valid_edge <span class="main">(</span>valid_edge <span class="free">prog</span><span class="main">)</span> sourcenode targetnode
      kind <span class="keyword1">(_Entry_)</span> <span class="keyword1">(_Exit_)</span> <span class="bound">a</span> <span class="main">∧</span>
      src <span class="bound">a</span> <span class="main">=</span> <span class="skolem">n</span> <span class="main">∧</span> trg <span class="bound">a</span> <span class="main">=</span> LDCFG_node.Node <span class="keyword1">(_Exit_)</span> <span class="main">∧</span> knd <span class="bound">a</span> <span class="main">=</span> <span class="main">⇑</span>id"</span></span>
      <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">rule_tac</span> x<span class="main"><span class="main">=</span></span><span class="quoted"><span class="quoted">"<span class="main">(</span>Node <span class="skolem">nx</span><span class="main">,</span><span class="main">⇑</span>id<span class="main">,</span>Node <span class="keyword1">(_Exit_)</span><span class="main">)</span>"</span></span> <span class="keyword2"><span class="keyword"><span class="quasi_keyword">in</span></span></span> exI<span class="main">)</span>
        <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">intro</span><span class="main"><span class="main">!</span></span><span class="main"><span class="main">:</span></span>lve_edge <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span>knd_def valid_edge_def<span class="main">)</span>
  <span class="keyword1"><span class="command">qed</span></span>
<span class="keyword1"><span class="command">qed</span></span>


<span class="keyword1"><span class="command">subsection</span></span> <span class="quoted"><span class="plain_text">‹Semantic Non-Interference for Weak Control Dependence›</span></span>

<span class="keyword1"><span class="command">lemmas</span></span> WCDNonInterferenceGraph <span class="main">=</span> 
  lift_PDG_weak_backward_slice<span class="main">[</span><span class="operator">OF</span> WWeakControlDependence.PDG_wcd 
  WhileStrongPostdomination_aux _ HighLowDistinct HighLowUNIV<span class="main">]</span>


<span class="keyword1"><span class="command">lemma</span></span> WCDNonInterference<span class="main">:</span>
  <span class="quoted"><span class="quoted">"NonInterferenceIntra src trg knd
     <span class="main">(</span>lift_valid_edge <span class="main">(</span>valid_edge <span class="free">prog</span><span class="main">)</span> sourcenode targetnode kind
       <span class="keyword1">(_Entry_)</span> <span class="keyword1">(_Exit_)</span><span class="main">)</span>
     NewEntry <span class="main">(</span>lift_Def <span class="main">(</span>Defs <span class="free">prog</span><span class="main">)</span> <span class="keyword1">(_Entry_)</span> <span class="keyword1">(_Exit_)</span> <span class="free">H</span> <span class="free">L</span><span class="main">)</span>
     <span class="main">(</span>lift_Use <span class="main">(</span>Uses <span class="free">prog</span><span class="main">)</span> <span class="keyword1">(_Entry_)</span> <span class="keyword1">(_Exit_)</span> <span class="free">H</span> <span class="free">L</span><span class="main">)</span> id
     <span class="main">(</span>PDG.PDG_BS src trg
       <span class="main">(</span>lift_valid_edge <span class="main">(</span>valid_edge <span class="free">prog</span><span class="main">)</span> sourcenode targetnode kind
         <span class="keyword1">(_Entry_)</span> <span class="keyword1">(_Exit_)</span><span class="main">)</span>
       <span class="main">(</span>lift_Def <span class="main">(</span>Defs <span class="free">prog</span><span class="main">)</span> <span class="keyword1">(_Entry_)</span> <span class="keyword1">(_Exit_)</span> <span class="free">H</span> <span class="free">L</span><span class="main">)</span>
       <span class="main">(</span>lift_Use <span class="main">(</span>Uses <span class="free">prog</span><span class="main">)</span> <span class="keyword1">(_Entry_)</span> <span class="keyword1">(_Exit_)</span> <span class="free">H</span> <span class="free">L</span><span class="main">)</span>
       <span class="main">(</span>StrongPostdomination.weak_control_dependence src trg
         <span class="main">(</span>lift_valid_edge <span class="main">(</span>valid_edge <span class="free">prog</span><span class="main">)</span> sourcenode targetnode kind
           <span class="keyword1">(_Entry_)</span> <span class="keyword1">(_Exit_)</span><span class="main">)</span> NewExit<span class="main">)</span><span class="main">)</span>
     reds <span class="main">(</span>labels_LDCFG_nodes <span class="free">prog</span><span class="main">)</span>
     NewExit <span class="free">H</span> <span class="free">L</span> <span class="main">(</span>LDCFG_node.Node <span class="keyword1">(_Entry_)</span><span class="main">)</span> <span class="main">(</span>LDCFG_node.Node <span class="keyword1">(_Exit_)</span><span class="main">)</span> final"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">from</span></span> inner_node_exists <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">n</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"CFGExit.inner_node sourcenode targetnode 
    <span class="main">(</span>valid_edge <span class="free">prog</span><span class="main">)</span> <span class="keyword1">(_Entry_)</span> <span class="keyword1">(_Exit_)</span> <span class="skolem">n</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">interpret</span></span> NonInterferenceIntraGraph <span class="quoted">src</span> <span class="quoted">trg</span> <span class="quoted">knd</span>
     <span class="quoted"><span class="quoted">"lift_valid_edge <span class="main">(</span>valid_edge <span class="free">prog</span><span class="main">)</span> sourcenode targetnode kind
       <span class="keyword1">(_Entry_)</span> <span class="keyword1">(_Exit_)</span>"</span></span>
     <span class="quoted">NewEntry</span> <span class="quoted"><span class="quoted">"lift_Def <span class="main">(</span>Defs <span class="free">prog</span><span class="main">)</span> <span class="keyword1">(_Entry_)</span> <span class="keyword1">(_Exit_)</span> <span class="free">H</span> <span class="free">L</span>"</span></span>
     <span class="quoted"><span class="quoted">"lift_Use <span class="main">(</span>Uses <span class="free">prog</span><span class="main">)</span> <span class="keyword1">(_Entry_)</span> <span class="keyword1">(_Exit_)</span> <span class="free">H</span> <span class="free">L</span>"</span></span> <span class="quoted">id</span>
     <span class="quoted"><span class="quoted">"PDG.PDG_BS src trg
       <span class="main">(</span>lift_valid_edge <span class="main">(</span>valid_edge <span class="free">prog</span><span class="main">)</span> sourcenode targetnode kind
         <span class="keyword1">(_Entry_)</span> <span class="keyword1">(_Exit_)</span><span class="main">)</span>
       <span class="main">(</span>lift_Def <span class="main">(</span>Defs <span class="free">prog</span><span class="main">)</span> <span class="keyword1">(_Entry_)</span> <span class="keyword1">(_Exit_)</span> <span class="free">H</span> <span class="free">L</span><span class="main">)</span>
       <span class="main">(</span>lift_Use <span class="main">(</span>Uses <span class="free">prog</span><span class="main">)</span> <span class="keyword1">(_Entry_)</span> <span class="keyword1">(_Exit_)</span> <span class="free">H</span> <span class="free">L</span><span class="main">)</span>
       <span class="main">(</span>StrongPostdomination.weak_control_dependence src trg
         <span class="main">(</span>lift_valid_edge <span class="main">(</span>valid_edge <span class="free">prog</span><span class="main">)</span> sourcenode targetnode kind
           <span class="keyword1">(_Entry_)</span> <span class="keyword1">(_Exit_)</span><span class="main">)</span> NewExit<span class="main">)</span>"</span></span>
     <span class="quoted">NewExit</span> <span class="quoted"><span class="free">H</span></span> <span class="quoted"><span class="free">L</span></span> <span class="quoted"><span class="quoted">"LDCFG_node.Node <span class="keyword1">(_Entry_)</span>"</span></span> <span class="quoted"><span class="quoted">"LDCFG_node.Node <span class="keyword1">(_Exit_)</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">fastforce</span> <span class="quasi_keyword">intro</span><span class="main"><span class="main">:</span></span>WCDNonInterferenceGraph<span class="main">)</span>
  <span class="keyword1"><span class="command">interpret</span></span> BackwardSlice_wf <span class="quoted">src</span> <span class="quoted">trg</span> <span class="quoted">knd</span>
    <span class="quoted"><span class="quoted">"lift_valid_edge <span class="main">(</span>valid_edge <span class="free">prog</span><span class="main">)</span> sourcenode targetnode kind
      <span class="keyword1">(_Entry_)</span> <span class="keyword1">(_Exit_)</span>"</span></span>
    <span class="quoted">NewEntry</span> <span class="quoted"><span class="quoted">"lift_Def <span class="main">(</span>Defs <span class="free">prog</span><span class="main">)</span> <span class="keyword1">(_Entry_)</span> <span class="keyword1">(_Exit_)</span> <span class="free">H</span> <span class="free">L</span>"</span></span>
    <span class="quoted"><span class="quoted">"lift_Use <span class="main">(</span>Uses <span class="free">prog</span><span class="main">)</span> <span class="keyword1">(_Entry_)</span> <span class="keyword1">(_Exit_)</span> <span class="free">H</span> <span class="free">L</span>"</span></span> <span class="quoted">id</span>
    <span class="quoted"><span class="quoted">"PDG.PDG_BS src trg
       <span class="main">(</span>lift_valid_edge <span class="main">(</span>valid_edge <span class="free">prog</span><span class="main">)</span> sourcenode targetnode kind
         <span class="keyword1">(_Entry_)</span> <span class="keyword1">(_Exit_)</span><span class="main">)</span>
       <span class="main">(</span>lift_Def <span class="main">(</span>Defs <span class="free">prog</span><span class="main">)</span> <span class="keyword1">(_Entry_)</span> <span class="keyword1">(_Exit_)</span> <span class="free">H</span> <span class="free">L</span><span class="main">)</span>
       <span class="main">(</span>lift_Use <span class="main">(</span>Uses <span class="free">prog</span><span class="main">)</span> <span class="keyword1">(_Entry_)</span> <span class="keyword1">(_Exit_)</span> <span class="free">H</span> <span class="free">L</span><span class="main">)</span>
       <span class="main">(</span>StrongPostdomination.weak_control_dependence src trg
         <span class="main">(</span>lift_valid_edge <span class="main">(</span>valid_edge <span class="free">prog</span><span class="main">)</span> sourcenode targetnode kind
           <span class="keyword1">(_Entry_)</span> <span class="keyword1">(_Exit_)</span><span class="main">)</span> NewExit<span class="main">)</span>"</span></span> <span class="quoted">reds</span> <span class="quoted"><span class="quoted">"labels_LDCFG_nodes <span class="free">prog</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span><span class="main">(</span><span class="operator">unfold_locales</span><span class="main">)</span>
    <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">n</span> <span class="skolem">c</span> <span class="skolem">s</span> <span class="skolem">c'</span> <span class="skolem">s'</span>
    <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"labels_LDCFG_nodes <span class="free">prog</span> <span class="skolem">n</span> <span class="skolem">c</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">⟨</span><span class="skolem">c</span><span class="main">,</span><span class="skolem">s</span><span class="main">⟩</span> <span class="main">→*</span> <span class="main">⟨</span><span class="skolem">c'</span><span class="main">,</span><span class="skolem">s'</span><span class="main">⟩</span>"</span></span>
    <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound">n'</span> <span class="bound">as</span><span class="main">.</span> CFG.path src trg
     <span class="main">(</span>lift_valid_edge <span class="main">(</span>valid_edge <span class="free">prog</span><span class="main">)</span> sourcenode targetnode kind <span class="keyword1">(_Entry_)</span> <span class="keyword1">(_Exit_)</span><span class="main">)</span>
      <span class="skolem">n</span> <span class="bound">as</span> <span class="bound">n'</span> <span class="main">∧</span> transfers <span class="main">(</span>CFG.kinds knd <span class="bound">as</span><span class="main">)</span> <span class="skolem">s</span> <span class="main">=</span> <span class="skolem">s'</span> <span class="main">∧</span>
      preds <span class="main">(</span>CFG.kinds knd <span class="bound">as</span><span class="main">)</span> <span class="skolem">s</span> <span class="main">∧</span> labels_LDCFG_nodes <span class="free">prog</span> <span class="bound">n'</span> <span class="skolem">c'</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">rule</span> lifted_CFG_fund_prop<span class="main">)</span>
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> 
  <span class="keyword1"><span class="command">proof</span></span><span class="main">(</span><span class="operator">unfold_locales</span><span class="main">)</span>
    <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">c</span> <span class="skolem">n</span>
    <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"final <span class="skolem">c</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"labels_LDCFG_nodes <span class="free">prog</span> <span class="skolem">n</span> <span class="skolem">c</span>"</span></span>
    <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹final <span class="skolem">c</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">c</span> <span class="main">=</span> Skip"</span></span> <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">cases</span> <span class="quoted"><span class="skolem">c</span></span><span class="main">)</span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹labels_LDCFG_nodes <span class="free">prog</span> <span class="skolem">n</span> <span class="skolem">c</span>›</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">nx</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">n</span> <span class="main">=</span> Node <span class="skolem">nx</span>"</span></span>
      <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"labels_nodes <span class="free">prog</span> <span class="skolem">nx</span> Skip"</span></span> <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">cases</span> <span class="quoted"><span class="skolem">n</span></span><span class="main">)</span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹labels_nodes <span class="free">prog</span> <span class="skolem">nx</span> Skip›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">prog</span> <span class="main">⊢</span> <span class="skolem">nx</span> <span class="main">-</span><span class="main">⇑</span>id<span class="main">→</span> <span class="keyword1">(_Exit_)</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">rule</span> final_edge<span class="main">)</span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">a</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"valid_edge <span class="free">prog</span> <span class="skolem">a</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"sourcenode <span class="skolem">a</span> <span class="main">=</span> <span class="skolem">nx</span>"</span></span>
      <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"kind <span class="skolem">a</span> <span class="main">=</span> <span class="main">⇑</span>id"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"targetnode <span class="skolem">a</span> <span class="main">=</span> <span class="keyword1">(_Exit_)</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span>valid_edge_def<span class="main">)</span>
    <span class="keyword1"><span class="command">with</span></span> <span class="quoted"><span class="quoted">‹labels_nodes <span class="free">prog</span> <span class="skolem">nx</span> Skip›</span></span>
    <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound">a</span><span class="main">.</span> lift_valid_edge <span class="main">(</span>valid_edge <span class="free">prog</span><span class="main">)</span> sourcenode targetnode
      kind <span class="keyword1">(_Entry_)</span> <span class="keyword1">(_Exit_)</span> <span class="bound">a</span> <span class="main">∧</span>
      src <span class="bound">a</span> <span class="main">=</span> <span class="skolem">n</span> <span class="main">∧</span> trg <span class="bound">a</span> <span class="main">=</span> LDCFG_node.Node <span class="keyword1">(_Exit_)</span> <span class="main">∧</span> knd <span class="bound">a</span> <span class="main">=</span> <span class="main">⇑</span>id"</span></span>
      <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">rule_tac</span> x<span class="main"><span class="main">=</span></span><span class="quoted"><span class="quoted">"<span class="main">(</span>Node <span class="skolem">nx</span><span class="main">,</span><span class="main">⇑</span>id<span class="main">,</span>Node <span class="keyword1">(_Exit_)</span><span class="main">)</span>"</span></span> <span class="keyword2"><span class="keyword"><span class="quasi_keyword">in</span></span></span> exI<span class="main">)</span>
        <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">intro</span><span class="main"><span class="main">!</span></span><span class="main"><span class="main">:</span></span>lve_edge <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span>knd_def valid_edge_def<span class="main">)</span>
  <span class="keyword1"><span class="command">qed</span></span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword2"><span class="keyword">end</span></span>

<span class="keyword2"><span class="keyword">end</span></span>
</pre>
</div>